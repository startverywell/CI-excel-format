/*!
 * 
 * SpreadJS Library 16.1.0
 *
 * Copyright(c) GrapeCity, Inc.  All rights reserved.
 *
 * Licensed under the SpreadJS Commercial License.
 * us.sales@grapecity.com
 * http://www.grapecity.com/en/licensing/grapecity/
 *
 *
 */
var GC;!function(){var e,i,t;function r(t){var n,n,n=i[t];return void 0!==n||(n=i[t]={exports:{}},e[t].call(n.exports,n,n.exports,r)),n.exports}e={"./all.entry.js":function(t,n,e){(GC=GC||{}).Spread=GC.Spread||{},GC.Spread=e("./node_modules_local/@grapecity/js-sheets-common/index.js"),GC.Spread.CalcEngine=e("./node_modules_local/@grapecity/js-calc/index.js"),GC.Spread.CalcEngine.BasicFunctions=e("./node_modules_local/@grapecity/js-calc-basicfunctions/index.js"),GC.Spread.CalcEngine.AdvancedFunctions=e("./node_modules_local/@grapecity/js-calc-advancedfunctions/index.js"),GC.Data=e("./node_modules_local/@grapecity/js-data-manager/index.js"),GC.Spread.Sheets=e("./dist/core/core.entry.js"),GC.Spread.Sheets.Bindings=e("./dist/plugins/data/data.entry.js"),GC.Spread.Sheets.Outlines=e("./dist/plugins/group/group.entry.js"),GC.Spread.Sheets.CalcEngine=e("./dist/plugins/sheetsCalc/sheetsCalc.entry.js"),GC.Spread.Sheets.ConditionalFormatting=e("./dist/plugins/conditional/conditional.entry.js"),GC.Spread.Sheets.DataValidation=e("./dist/plugins/validation/datavalidation.entry.js"),GC.Spread.Sheets.Search=e("./dist/plugins/search/search.entry.js"),GC.Spread.Sheets.Touch=e("./dist/plugins/touch/touch.entry.js"),GC.Spread.Sheets.FloatingObjects=e("./dist/plugins/floatingObject/floatingobject.entry.js"),GC.Spread.Sheets.Sparklines=e("./dist/plugins/sparkline/sparkline-wrapper.entry.js"),GC.Spread.Sheets.Comments=e("./dist/plugins/comment/comment.entry.js"),GC.Spread.Sheets.CellState=e("./dist/plugins/cellState/cellstate.entry.js"),GC.Spread.Sheets.CellTypes=e("./dist/plugins/celltype/celltypes.entry.js"),GC.Spread.Sheets.Filter=e("./dist/plugins/filter/filter.entry.js"),GC.Spread.Sheets.Tables=e("./dist/plugins/table/table.entry.js"),GC.Spread.Sheets.Fill=e("./dist/plugins/fill/fill.entry.js"),GC.Spread.Sheets.ContextMenu=e("./dist/plugins/contextMenu/context-menu.entry.js"),GC.Spread.Sheets.FormulaTextBox=e("./dist/plugins/formulaTextbox/formulaTextBox.entry.js"),GC.Spread.Sheets.OutlineColumn=e("./dist/plugins/outlineColumn/outlineColumn.entry.js"),GC.Spread.Sheets.DragMerge=e("./dist/plugins/dragMerge/dragMerge.entry.js"),GC.Spread.Sheets.StatusBar=e("./dist/plugins/statusBar/statusBar.entry.js"),GC.Spread.Sheets.AutoMerge=e("./dist/plugins/autoMerge/autoMerge.js"),GC.Spread.Sheets.Hyperlink=e("./dist/plugins/hyperlink/hyperlink.js"),GC.Spread.Sheets.NameBox=e("./dist/plugins/namebox/namebox.entry.js"),GC.Spread.Sheets.InputMask=e("./dist/plugins/inputMask/inputMask.entry.js"),t.exports=GC.Spread},"./dist/core/celltype/basecelltype.js":function(i,t,n){"use strict";var c,v,lt,ht,m,V,r,l,o,h,M,C,a,n,Y,u,Z,wt,W,dt,S,T,Q,L,x,g,F,_,w,J,K,X,E,B,b,D,A,vt,N,mt,gt,Mt,s,pt,j,O,R,bt,d,P,k,G,U,I,H,e,z;function q(t){var n=t.isPrinting,t=t.printZoomFactor;return n&&typeof t===b&&1!==t}function $(t){var n;return!(t instanceof CanvasRenderingContext2D)&&!g(t._ae)}function tt(t,n){var e,i,r,e=0,i=t.font+n,r=!$(t);return r&&P[i]?e=P[i]:(e=Q(t,t.font,n),r&&(P[i]=e)),e}function y(){}function nt(t,n){var e;return n/2-t/2+(8<t?vt((t-8)/5+2):1)-1}function et(t){var n=H[t.charCodeAt(0)];return n?String.fromCharCode(n):t}function it(t,n,e){return Y(t.x)||(t.x+=n.width),t.width=t.width-n.width-e.width,t}function Ct(t,n,e,i){var r,n,r=e.foreColor;r=lt.I.m(n,r),i=Y(e.opacity)?i:e.opacity,Y(i)||((n=a._(r)).a=i,r=a.j(n)),t.fillStyle!==r&&(t.fillStyle=r||"#000000")}function rt(t,n){return ht.W.dfe(t,V.IconPosition.left)&&(n+=1),ht.W.dfe(t,V.IconPosition.right)&&(n+=2),n}function ot(t,n){return ht.W.dfe(t,V.IconPosition.left)&&--n,ht.W.dfe(t,V.IconPosition.right)&&(n-=2),n}function f(){this.allowOverflow=!1,this.typeName="0"}function at(t,n,e,i){var r,o,r=t.conditionalFormats;return r&&(o=t.getValue(n,e,i),r.O(n,e,i))&&r.U(t,n,e,o,i).iconSet}function ut(t,n,e){for(var i,r,o,i=0,r=0;r<t.length;r++)o=void 0,o=t[r].style&&t[r].style.font?t[r].style.font:n,i=Math.max(Z(o,A,W(t[r].text))/e,i),(t[r].style&&1===t[r].style.vertAlign||2===t[r].style.vertAlign)&&(i=Math.max(Z(o,A,W(t[r].text))/e+2*ht.W.V(o,d).fontSize*.218,i));return i}function st(t,n,e,i,r){var o,a,u,s,c,f,o=lt.q.J();if(!o)return 0;for(u=a=0;u<t.length;u++)s=void 0,s=t[u].style&&t[u].style.font?t[u].style.font:n,t[u].style&&t[u].style.vertAlign&&(s=ht.W.V(s,d).font),dt(o,s),c="",c=u===t.length-1&&r?lt.q.tt(t[u].text):t[u].text,f=0,i?f=Z(s)*c.length/e:Y(t[u].text)||(f=Q(o,s,t[u].text)/e),a+=f;return a}function ct(t,n,e,i,r){var o,a,u,o;if(!lt.q.J())return 0;for(u=a=0;u<t.length;u++)a+=st(t[u],n,e,i,r);return a}function ft(t,n,e,i,r,o,a,u,s){var c,f,l,h,d,v,m,g,p,b,s,a,m,g,y,w,M,C,S,T,p,b,c=a.backColor,f=a.backgroundImage,l=a.textOrientation,h=a.isVerticalText,d=a.textIndent&&0!==a.textIndent,v=a.backgroundImageLayout,m=s.row,g=s.col,p=s.sheet,b=p.Jt,s=s.sheet&&s.sheet.getSpan(m,g,s.sheetArea),a=a&&(a.borderLeft||a.borderTop||a.borderRight||a.borderBottom),y=0,w=n;t.save(),g+1<p.getColumnCount()&&(S=b.qt(m,g+1)),0<=g-1&&(T=b.qt(m,g-1)),p=function(t){return t!==A&&t&&-90<=t&&t<=90},b=function(){t.fillRect(n,e,i,r)},l&&0!==l&&a&&u&&!s&&!h&&!d&&(m=pt(l*Math.PI/180),g=Mt(m),y=vt(r/g),-90<l&&l<0&&(S&&!p(S.textOrientation)&&(C=S.backColor),w=n-y),0<l&&l<90&&(T&&!p(T.textOrientation)&&(C=T.backColor),w=n+y),M=function(){t.beginPath(),t.moveTo(w,e),t.lineTo(w+i,e),t.lineTo(n+i,e+r),t.lineTo(n,e+r),t.fill()}),(c||f)&&(C&&ht.W.setFillStyle(t,C,n,e,i,r,b),M?ht.W.setFillStyle(t,c,Math.min(w,n),e,i+y,r,M):c&&ht.W.setFillStyle(t,c,n,e,i,r,b),I.nt(t,n,e,i,r,f,v,o)),t.restore()}function St(t,n,e,i,r,o,a){var t;(0===t||a)&&at(n,e,i,r)&&(t=Tt(n),o.x+=t,o.width-=t)}function Tt(t){return parseInt(E*t.zoom(),10)}function yt(t,n,e,i){var r=t.cellPadding,o=0,t=t.labelOptions;return(r=e?t?t.margin:"0":r)&&(o=typeof(o=parseInt(_t(r)[n],10))===b&&0<o?o:0),i===A?o:o*i}function At(t){var n={context:t,value:0};return e.et(t.sheet,"getOutlineColumnOffset",n),n.value}function It(t,n){var n={context:t,value:0,cellStyle:n};return e.et(t.sheet,"getCellButtonAutoWidth",n),n.value}function xt(t,n){var n={context:t,value:0,cellStyle:n};return ln(n),e.et(t.sheet,"getSpecialIconsAutoWidth",n),n.value}function Nt(t,n){var n={context:t,value:0,cellStyle:n};return e.et(t.sheet,"getCellButtonAutoHeight",n),n.value}function kt(t,n){var n={context:t,value:0,cellStyle:n};return hn(n),e.et(t.sheet,"getSpecialIconsAutoHeight",n),n.value}function Dt(t,n,e,i){var r,i,r,n,o,r=i&&i.sheet;r&&e&&(i=i.canvasOffset||r.rt.it(),r=r.ot(),(n=(n=n.backColor||"white").stops?(o=n.stops)[0]&&o[0].color:n).backgroundColor&&(n=n.backgroundColor),(0,v.GC$)(t).width(e.width).height(e.height).css({top:i.top+r.y+e.y-2,left:i.left+r.x+e.x-2,"background-color":n}))}function _t(t){var n,t,e,i,r,n=["0","0","0","0"];return typeof t===B&&(r=i=void 0,1===(e=(t=t.split(" ",4)).length)?n=[i=t[0],i,i,i]:2===e?n=[i=t[0],r=t[1],i,r]:3===e?(r=t[1],n=[t[0],r,t[2],r]):4===e&&(n=[t[0],t[1],t[2],t[3]])),n}function Et(t,n){var e,i,r,o,a,e=yt(t,0),i=yt(t,2),r=yt(t,0,!0),o=yt(t,2,!0);if(!(yt(t,3,!0)+yt(t,1,!0)>=n.width))if(0===(a=(a=t.labelOptions.alignment)===A?t.labelOptions.alignment=0:a)||1===a||2===a){if(0<e&&r+o<e)return 1}else if((3===a||4===a||5===a)&&e<n.height&&0<i&&r+o<i)return 1}function jt(t,n){var e,i,r,o,a,e=yt(n,0),i=yt(n,3,!0),r=yt(n,2,!0),o=t.clone(),a=n.labelOptions.alignment;return 0===a||1===a||2===a?e<t.height&&(o.height=e-r+1):3!==a&&4!==a&&5!==a||(o.height=t.height-r),o.x+=i,o.width-=i+yt(n,1,!0),o}function Ot(t){var n="left";return 1===t||4===t?n="center":2!==t&&5!==t||(n="right"),n}function Rt(t,n,e,i){var r,e,o,a,u,s,c,t,f,l,h,i,d,v,r=new lt.Point(t.x,t.y),e=parseInt(e.fontSize,10),o=yt(n,0),a=yt(n,2),u=yt(n,3,!0),s=yt(n,1,!0),c=t.width,t=t.height,f,l,h=8<e?1:2,i=i-(i/2-e/2+(8<e?Math.floor((e-8)/5+2):1)-1)+yt(n,0,!0),d=i+1,v=t<o+a?o+i:t-a+i-1;switch(n.labelOptions.alignment){case 0:r.x+=u+h+1,r.y+=d;break;case 1:r.x+=u+(c-u-s)/2,r.y+=d;break;case 2:r.x+=c-s-2,r.y+=d;break;case 3:r.x+=u+h+1,r.y+=v;break;case 4:r.x+=u+(c-u-s)/2,r.y+=v;break;case 5:r.x+=c-s-2,r.y+=v}return r}function Bt(t,n){var e,i,r,o,a,u,e=yt(n,3,!0),i=yt(n,1,!0),r=yt(n,0,!0),o=yt(n,2,!0),a=t.clone(),u=n.labelOptions.alignment;return a.x=e+1,a.width-=e+i,0===u||1===u||2===u?(a.y=r,a.height=yt(n,0)-r-o):3!==u&&4!==u&&5!==u||(a.y=t.height-yt(n,2)+r,a.height=yt(n,2)-r-o),2!==u&&5!==u||(a.width-=2),a}function Lt(t,n,e){var i,r;if(u(n,B))return tt(t,n);if(e&&n&&n[0]&&n[0].value)return n[0].value.length*Z(t.font);for(r=i=0;r<n.length;r++)"fillingChar"!==n[r].type&&(i+=tt(t,n[r].value));return i}function Ft(t){for(var n,e,i,r,o,n=t[0].type,e=0,i=[t[0]],r=1;r<t.length;r++)o=t[r],n===R&&o.type===R?i[e].value+=o.value:(i.push(o),n=o.type,e++);return i}function Pt(t,n,e,i,r){var i,i=i?Math.floor(n/r):Math.floor(n/Q(t,t.font,e));return new Array(i+1).join(e)}function Gt(t){var t=t.clone();return t.width--,t.height--,t}function Ut(t,n,e,i){for(var r,o,a,r=0;r<t.length;r++)o=void 0,t[r].style=t[r].style||{},o=(a=t[r].style).font?ht.W.V(a.font,e).font:"object"==typeof n?n.font:n,Y(i)||(o=ht.W.V(o,i).font),a.font=o}function Ht(t,n,e,i,r){var o=e*gt(-i)+r*mt(-i),e=e*gt(-i)+r*mt(-i),a,u;return new lt.Rect(t-o/2,n-e/2,o,e)}function zt(t){return"string"==typeof t.src&&0<t.src.length&&-1===t.src.indexOf("<script")}function Vt(t,n,e,i){g(e.decoration)||(e.decoration.cornerFold&&Yt(t,n,e.decoration.cornerFold,i),e.decoration.icons&&0<e.decoration.icons.length&&Zt(t,n,e.decoration.icons.filter(zt),e.vAlign,i))}function Yt(t,n,e,i){var r,o,e,a,u,s,n,c,r,i,e,f,l,h,d,r=e.size,o=e.position,e=e.color;g(r)&&(r=6),g(o)&&(o=m.CornerPosition.leftTop),a=n.x,u=n.y,s=n.height,n=n.width,r=r*(c=i.sheet).zoom(),t&&0<n&&0<s&&(t.save(),t.rect(a,u,n,s),t.clip(),t.fillStyle=e||"#FF3D00",t.beginPath(),t.fillStyle=e,d=h=l=f=e=i=void 0,o&m.CornerPosition.leftTop&&(f=i=a,l=(e=u)+r,h=i+r,d=e,t.moveTo(i,e),t.lineTo(f,l),t.lineTo(h,d),t.fill()),o&m.CornerPosition.rightBottom&&(l=(e=u+s)-r,h=(f=i=a+n)-r,d=e,t.moveTo(i,e),t.lineTo(f,l),t.lineTo(h,d),t.fill()),o&m.CornerPosition.leftBottom&&(f=i=a,l=(e=u+s)-r,h=i+r,d=e,t.moveTo(i,e),t.lineTo(f,l),t.lineTo(h,d),t.fill()),o&m.CornerPosition.rightTop&&(l=(e=u)+r,h=(f=i=a+n)-r,d=e,t.moveTo(i,e),t.lineTo(f,l),t.lineTo(h,d),t.fill()),t.closePath(),t.restore())}function Zt(t,n,e,i,r){var o,e,a,a,u,s,c;!r.cellOverflowLayout&&0<e.length&&(o=e.filter(function(t){return g(t.position)||t.position===V.IconPosition.left}),e=e.filter(function(t){return t.position===V.IconPosition.right}),0<(a=o.concat(e)).length)&&(cn(a,r),t)&&(a=fn(n.clone(),r),t.save(),t.rect(a.x,a.y,a.width,a.height),t.clip(),t.beginPath(),s=u=a.x,c=a.x+a.width,0<o.length&&(s=u=qt(t,o,a,i,r)),0<e.length&&(c=u=Kt(t,e,a,i,r)),t.restore(),n.width=n.x+n.width-(a.x+a.width-c)-s,n.x=s)}function Wt(t,n,e,i,r){var o,e,a,u;t&&0<e.length&&(o=e.filter(function(t){return t.position===V.IconPosition.outsideLeft&&zt(t)}),e=e.filter(function(t){return t.position===V.IconPosition.outsideRight&&zt(t)}),a=3,u=n.x,0<o.length||0<e.length)&&(cn(o,r),cn(e,r),2===r.columnHeaderFitMode&&r.cornerX&&((n=n.clone()).height=n.height-(r.cornerY-n.y)-1,n.y=r.cornerY-1),0<o.length&&(n.x=u-3,Qt(t,o,n,i,r)),0<e.length)&&(n.x=u+3,Jt(t,e,n,i,r))}function Qt(t,n,e,i,r){Xt(t,n,e.x,e,i,r)}function Jt(t,n,e,i,r){$t(t,n,e.x+e.width,e,i,r)}function Kt(t,n,e,i,r){return Xt(t,n,e.x+e.width,e,i,r)}function Xt(t,n,e,i,r,o){var a,u,s,c,a,u;for(e-=un(o),s=n.length-1;0<=s;s--)e-=c=p(o,n[s],"width"),nn(t,n[s],e,i.y,c,i.height,o,i,r);return e}function qt(t,n,e,i,r){return $t(t,n,e.x,e,i,r)}function $t(t,n,e,i,r,o){var a,u,s,c,a,u;for(e+=un(o),s=0;s<n.length;s++)c=p(o,n[s],"width"),nn(t,n[s],e,i.y,c,i.height,o,i,r),e+=c;return e}function tn(t,n){var e,i,r,o,n,a,t,u,u,n,e=n.ctx,i=n.style,r=n.context,o=n.textRect,n=n.availRect;!g(i.decoration)&&e&&(a="beforeFillTextArea"===t?V.IconPosition.leftOfText:V.IconPosition.rightOfText,t=i.decoration.icons&&i.decoration.icons.filter(function(t){return t.position===a&&zt(t)}))&&0<t.length&&(cn(t,r),2===r.columnHeaderFitMode&&r.cornerX&&(u=r.cellRect.x+r.cellRect.width-(n.x+n.width),(n=n.clone()).width=r.cornerX-n.x-u,n.height=n.height-(r.cornerY-n.y)-1,n.y=r.cornerY-1),u=void 0,n=on(n,o,a),e.save(),e.rect(n.x,n.y,n.width,n.height),e.clip(),e.beginPath(),a===V.IconPosition.leftOfText?(u=Kt(e,t,n,i.vAlign,r),o.x=u):(u=qt(e,t,n,i.vAlign,r),o.width=u-o.x),e.restore())}function nn(t,n,e,i,r,o,a,u,s){var c,f,l,e,i,r,h,o,n,e,s,a,d;t.save(),t.beginPath(),t.rect(e,i,r,o),t.clip(),c=0,f=sn(a),l=n.src,f.jt(l)?f.qh(l)&&(e=new lt.Rect(e,i,r,o),i=p(a,n,"width"),r=p(a,n,"height"),o=an(e,h=new lt.Rect(0,0,i,r),s,un(a)),e=(n=f.Ot(l)).width,s=n.height,lt.mt.Tt.msie&&(G[l]||(n.style.position="absolute",n.style.left="-10000px",n.style.top="-100000px",document.body.appendChild(n),G[l]={width:n.width,height:n.height},document.body.removeChild(n)),e=G[l].width,s=G[l].height),u&&lt.mt.Tt.msie&&o.x+o.width>u.x+u.width?0<(a=c=u.x+u.width-o.x)&&t.drawImage(n,0,0,a*(d=e/i),s,o.x,o.y,a,r):t.drawImage(n,0,0,e,s,o.x,o.y,c=i,r)):f.Rt(l,"anonymous"),t.restore()}function en(t){var n=t.context,e=t.style,t=t.externals;!n.cellOverflowLayout&&ht.W.ose(e)&&(t.left=t.left.concat(rn(n,e,V.IconPosition.leftOfText)),t.right=t.right.concat(rn(n,e,V.IconPosition.rightOfText)))}function rn(n,t,e){return t.decoration.icons.filter(function(t){return t.position===e}).map(function(t){return{width:p(n,t,"width"),height:p(n,t,"height")}})}function on(t,n,e){switch(e){case V.IconPosition.leftOfText:return new lt.Rect(t.x,t.y,n.x-t.x,t.height);case V.IconPosition.rightOfText:return new lt.Rect(n.x+n.width,t.y,t.x+t.width-n.x-n.width,t.height)}}function an(t,n,e,i){var r,o=2*i;switch(e){case V.VerticalAlign.top:r=0+o;break;case V.VerticalAlign.bottom:r=Math.max(0,t.height-n.height)-o;break;default:r=Math.max(0,(t.height-n.height)/2)}return new lt.Rect(t.x,t.y+r,Math.min(n.width,t.width),Math.min(n.height,t.height))}function un(t){return q(t)?t.printZoomFactor:t.sheet.zoom()}function p(t,n,e){var n=n[e],e=un(t);return(n=g(n)||isNaN(n)||n<=0?12:n)*e}function sn(t){var n=t.sheet,e;return n.MC||t.imageLoader||n.BO()}function cn(t,n){for(var e,i,r,e=sn(n),i=0;i<t.length;i++)(r=t[i].src)&&e.Rt(r,"anonymous")}function fn(t,n){return 2===n.columnHeaderFitMode&&n.cornerX&&(t.width=n.cornerX-t.x,t.height=t.height-(n.cornerY-t.y)-1,t.y=n.cornerY-1),t}function ln(t){dn(t,"width")}function hn(t){dn(t,"height")}function dn(t,n){var e,i,r,o,a,e=t.cellStyle;if(e.decoration&&e.decoration.icons&&0!==e.decoration.icons.length){for(i=e.decoration.icons,o=r=0;o<i.length;o++)a=i[o],ht.W.ise(a)&&(r+=p(t.context,a,n));t.value=r}}Object.defineProperty(t,"__esModule",{value:!0}),t.Context=t.Base=t.paintStyleDecorationOutSideIcons=t.paintDecoration=void 0,c=n("Common"),v=n("./dist/core/util/domUtil.js"),lt=n("./dist/core/util/common.js"),ht=n("./dist/core/worksheet/stylehelper.js"),m=n("./dist/core/core.interface.js"),V=n("./dist/core/core.enum.js"),r=n("./dist/core/celltype/celltype.ns.js"),l=n("CalcEngine"),o=c.Common.ut,h=c.Common.CultureManager,M=c.Common.st,C=c.Common.ct,a=c.Common.ft,n=c.Common.lt,Y=n.ht,u=n.dt,Z=lt.mt.vt,wt=lt.mt.gt,W=lt.mt.pt,dt=lt.mt.bt,S=lt.mt.yt,T=lt.mt.wt,Q=lt.mt.Mt,L=lt.mt.Ct,x=lt.mt.St,g=c.Common.lt.ht,F=v.GC$.extend,_=lt.mt.Tt,w="left",J="right",K="center",X="alphabetic",E=16,B="string",b="number",D=null,A=void 0,vt=Math.floor,N=Math.ceil,mt=Math.sin,gt=Math.cos,Mt=Math.tan,s=Math.PI,pt=Math.abs,j="none",O="General",R="text",bt=Math.max,d=.7,P={},k="...",G={},z=U={top:0,0:"top",right:1,1:"right",bottom:2,2:"bottom",left:3,3:"left"},y.At=function(t){var t,n,e,t=t.split("e")[1];if(t&&0<t.length&&("+"===t[0]?n=!0:"-"===t[0]&&(n=!1),e=t.slice(1)),void 0!==n)return{isAdd:n,length:e}},y.It=function(t,n,e){var i,r,i=y.xt,r=i[n+e];return r||(r=Q(t,n,e),i[n+e]=r),r},y.Nt=function(t,n,e,i,r){var o,r,a,a,r,a,u,s,s,c,u,f,a,l,h,o,d,v,m,g,p,o=i.font;if(e=e-1-ot(i,3)*r,r=i.textIndent&&0!==i.textIndent,a=i.isVerticalText,typeof n!==b||!0===i.shrinkToFit||a||r)return i._autoFormatter;if(a=n<0,n=pt(n),r=a?y.It(t,o,"-"):0,a=n.toString(),(u=y.At(a))&&!1===u.isAdd&&(s=lt.mt.toPlainString(n)).split(".")[1].length<10&&(a=s,u=A),s=void 0,c=y.Dt(i._autoFormatter,n),u)return s=u.length.toString().length,s=bt(s,2),y._t(t,e,i,s,r,u.isAdd,c);if(u=r,f=y.It(t,o,"0"),a=a.split("."),u+=h=f*(l=Math.round(n).toString().length),o=y.It(t,o,"."),d=void 0,h<=e){if(!a[1]||0===a[1].length)return i._autoFormatter;if((u=u+a[1].length*f+o)<=e)return i._autoFormatter;if(n<.001)return s=a[1].length.toString().length,s=bt(s,2),y._t(t,e,i,s,r,!1,c);for(m=Math.floor((v=e-r-h-o)/f),d="0",0<(m=Math.min(m,a[1].length))&&(d+="."),g=0;g<m;g++)d+="0";return d}return s=(p=Math.round(n)).toString().length.toString().length,s=bt(s,2),y._t(t,e,i,s,r,!0,c)},y._t=function(t,n,e,i,r,o,a){var e,u,s,c,f,l,h,n,r,d,v,m,e=e.font,u=y.It(t,e,"0"),s=y.It(t,e,"E"),c=y.It(t,e,"+"),f=y.It(t,e,"-"),l,h,n=n-r-i*u-s-(o?c:f)-u,r=n-y.It(t,e,".");if(r<=u)return o?"0E+00":0<n?"0E-00":"0";for(d=Math.floor(r/u),d=Math.min(d,a),v="0",m=0;m<d;m++)0===m&&(v+="."),v+="0";return v+=o?"E+00":"E-00"},y.Et=function(t,n,e,i,r){var o,r,a,u,s,r,c,f,l,o=i.font;if(e=e-1-ot(i,3)*r,r=i.textIndent||0,u=e,(u=1!==(a=i.hAlign)&&0<r?e-8*r:e)<(s=Q(t,i.font,n))){for(r=y.It(t,o,"#"),c=Math.floor(e/r),f="",l=0;l<c;l++)f+="#";return f}return n},y.nt=function(t,n,e,i,r,o,a,u){var s,c,f,l,h,d,v,m,g,p,b,y;if(o&&"none"!==o&&u)try{u.jt(o)?(s=u.Ot(o),c=void 0,_.msie&&((c=document.createElement("div")).appendChild(s),document.body.appendChild(c)),f=s.width,l=s.height,_.msie&&(c.removeChild(s),document.body.removeChild(c)),d=h=0,v=f,m=l,g=i,p=r,b=n,y=e,1===a?(v=f<=i?f:i,m=l<=r?l:r,b=f<i&&0<f?N(n+i/2-f/2):n,y=l<r&&0<l?N(e+r/2-l/2):e,g=v,p=m):2===a?0<r&&0<l&&f/l<i/r?b=n+i/2-(g=f/l*r)/2:0<i&&0<f&&l/f<r/i&&(y=e+r/2-(p=l/f*i)/2):3===a&&(g=v=f<=i?f:i,p=m=l<=r?l:r),t.drawImage(s,0,0,v,m,b,y,g,p)):u.Rt(o)}catch(t){}},y.Bt=function(t,n,e,i,r){var o,a,u,s,c,f,l,h,d,v,m,g,p,b,y,b,w,M,C,S,C,T,A,I,S,t,C,x,N,k,t,o=0,a=r&&r.sheet,u=r.sheetArea,s=r.row,c=r.col,f=e.textIndent,l=e.hAlign,h=e.isVerticalText,d,v=1===u&&1===a.Lt(c)?-90:e.textOrientation,m=e.borderTop||e.borderBottom||e.borderLeft||e.borderRight,y=e.font;if(v&&-90<=v&&v<=90&&(b=pt(v*Math.PI/180),p=mt(b),b=gt(b)),a&&typeof n===B&&n)if(w=[],M=void 0,t&&t.richText)if(C=e.formatter||e._autoFormatter,C=(S=a.getCellType(s,c,u)).Ft(C,t.text),Ut(M=F(!0,[],S.Pt(t,n,C,y,e.foreColor)),y,i),h)if(e.wordWrap){if(T=a.Gt(s,u),(A=a.Ut.findSpan(s,c,u))&&A.row>=s&&A.col>=c&&1<A.rowCount)for(I=s+1;I<s+A.rowCount;I++)T+=a.Gt(I,u);for((S=0)<f&&(S=8*f),0<(t=yt(e,0))&&(T-=t),0<(C=yt(e,2))&&(T-=C),w=lt.q.Ht(n,++T-ot(e,3)-S,y,M,h),g=0;g<w.length;g++)o+=ut(w[g].textInfos,y,i)}else o=ut(M,y,i);else{if(e.wordWrap){for(x=n.split(/\r\n|\r|\n/),g=0;g<x.length;g++)w.push((0,lt.zt)(x[g]));for(w=lt.q.Vt(w,lt.q.Yt(M)),g=0;g<w.length;g++)o=Math.max(o,ct(w[g],y,i,h,!0))}else o=st(M,y,i);1!==l&&0<f&&(o+=8*f/i),at(a,s,c,r.sheetArea)&&(o+=Tt(a))}else if(w=n.split(/\r\n|\r|\n/),N=e.font,k=Z(N)/i,h)if(e.wordWrap)for(g=0;g<w.length;g++)o+=k;else o=k;else{if(e.wordWrap){if(v)return t=a.Gt(s,u),lt.q.Zt(s,c,p,b,n,N,t);for(g=0;g<w.length;g++)o=Math.max(o,lt.q.Wt(w[g],N,!0)/i)}else o=v?m?(4+k)/p:b*(a.Qt(n,N)/i)+k*p:4===e.hAlign?a.Jt.Kt(c,u):a.Qt(n,N)/i;1!==l&&0<f&&(o+=8*f/i),at(a,s,c,r.sheetArea)&&(o+=E)}return o},y.Xt=function(t,n,e,i){for(var r,o,a,u,r=t.Jt.Kt(e,i),o=e+1;o<t.getColumnCount(i)&&(a=t.Jt.qt(n,o,i),u=t.Jt.$t(n,o,i,1,a),g(u))&&!a.watermark&&!(a.cellType&&"1"!==a.cellType.typeName||a.cellButtons&&0<a.cellButtons.length||ht.W.rse(a))&&4===a.hAlign;o++)r+=t.Jt.Kt(o,i);return r},y.tn=function(t,n,e,i,r){var o,a,u,s,c,f,l,h,d,v,m,g,p,b,y,w,M,C,S,T,A,I,x,N,N,k,I,A,D,A,_,D,E,j,l,O,R,o=0,u=r&&r.sheet,s=e.font,c=e.isVerticalText,f=e.textIndent,l=e.vAlign,h=e.textOrientation,d=r.row,v=r.col,m=r.sheetArea;if(h&&-90<=h&&h<=90&&(N=pt(h*Math.PI/180),x=mt(N),N=gt(N)),u&&typeof n===B&&n)if(k=[],I=void 0,t&&t.richText)if(A=e.formatter||e._autoFormatter,A=(D=u.getCellType(d,v,m)).Ft(A,t.text),Ut(I=F(!0,[],D.Pt(t,n,A,s,e.foreColor)),s,i),c){if(e.wordWrap){for(_=n.split(/\r\n|\r|\n/),a=0;a<_.length;a++)k.push((0,lt.zt)(_[a]));for(k=lt.q.Vt(k,lt.q.Yt(I)),a=0;a<k.length;a++)o=Math.max(o,ct(k[a],s,i,c,!0))}else o=st(I,s,i,c);1!==l&&0<f&&(o+=8*f/i)}else if(e.wordWrap){if(g=u.nn(v,m),(y=u.Ut.findSpan(d,v,m))&&y.row>=d&&y.col>=v&&1<y.colCount)for(w=v+1;w<v+y.colCount;w++)g+=u.nn(w,m);for((C=0)<f&&(C=8*f),S=yt(e,1),0<(T=yt(e,3))&&(g-=T),0<S&&(g-=S),k=lt.q.Ht(n,++g-ot(e,3)-C,s,I),a=0;a<k.length;a++)o+=ut(k[a].textInfos,s,i)}else o=ut(I,s,i);else if(D=e.font,E=Z(D)/i,c){if(e.wordWrap)for(k=n.split(/\r\n|\r|\n/),a=0;a<k.length;a++)j=k[a].length*E,o=Math.max(o,j);else o=n.length*E;1!==l&&0<f&&(o+=8*f/i)}else if(e.wordWrap){if(m=r.sheetArea,g=4===e.hAlign?this.Xt(r.sheet,d,v,m):u.nn(v,m),p=u.Gt(d,m),(y=u.Ut.findSpan(d,v,m))&&y.row>=d&&y.col>=v&&1<y.colCount){for(w=v+1;w<v+y.colCount;w++)g+=u.nn(w,m);for(M=d+1;M<d+y.colCount;M++)p+=u.Gt(M,m)}if((C=0)<f&&(C=8*f),S=yt(e,1),0<(T=yt(e,3))&&(g-=T),0<S&&(g-=S),0<(A=yt(e,0))&&(p-=A),0<(I=yt(e,2))&&(p-=I),e.cellButtons&&0<e.cellButtons.length&&(g-=It(r,e)),ht.W.rse(e)&&(g-=xt(r,e)),e.cellType&&e.cellType.Ife&&(g-=e.cellType.Ife(i)),1===m&&(O=!!((l=u.rowFilter&&u.rowFilter())&&l.rn(d,v,m)&&l.filterButtonVisible(v)))&&(g-=u.an(new lt.Rect(0,0,g,p),m).width),h)return k=lt.q.un(n,R=(p-E*N)/x,D),o=x*(b=u.Qt(k[0],D)/i)+E*N;o=(k=L(t)?[n]:lt.q.un(n,g-ot(e,3)-C,D)).length*E}else o=h?x*(b=u.Qt(n,D)/i)+E*N:E;return o},y.cn=function(t,n,e,i,r,o,a,u,s,c,f){var l;1===s?(t.beginPath(),(l=t.createLinearGradient(n,e+1,n,e+r-2)).addColorStop(0,u.borderLeftColor),l.addColorStop(1,u.borderRightColor),t.strokeStyle!==l&&(t.strokeStyle=l),o.borderLeft||(t.moveTo(n+.5,e),t.lineTo(n+.5,e+r)),o.borderRight||(t.moveTo(n+i-.5,e),t.lineTo(n+i-.5,e+r)),c&&!o.borderTop&&(t.moveTo(n,e+.5),t.lineTo(n+i,e+.5)),t.stroke(),u.borderBottomWidth&&!o.borderBottom&&(t.beginPath(),t.strokeStyle!==u.borderBottomColor&&(t.strokeStyle=u.borderBottomColor),t.moveTo(n+1,e+r-.5),t.lineTo(n+i,e+r-.5),t.stroke())):(t.beginPath(),(l=t.createLinearGradient(n,e,n+i-2,e)).addColorStop(0,u.borderTopColor),l.addColorStop(1,u.borderBottomColor),t.strokeStyle!==l&&(t.strokeStyle=l),o.borderTop||(t.moveTo(n,e+.5),t.lineTo(n+i,e+.5)),o.borderBottom||(t.moveTo(n,e+r-.5),t.lineTo(n+i,e+r-.5)),f&&!o.borderLeft&&(t.moveTo(n+.5,e),t.lineTo(n+.5,e+r)),t.stroke(),u.borderRightWidth&&!o.borderRight&&(t.beginPath(),t.strokeStyle!==u.borderRightColor&&(t.strokeStyle=u.borderRightColor),t.moveTo(n+i-.5,e+1),t.lineTo(n+i-.5,e+r),t.stroke()))},y.hn=function(t,n){var n,n=2===n?"active":4===n?"inactive":0===n?"disabled":"auto";(0,v.GC$)(t).css("ime-mode",n)},y.dn=function(t,n,e,i,r,o,a){var u,s,s,c,f;return!!(n&&"SparklineExValue"===n.typeName&&(s=(u=a.sheet)&&u.parent)&&(s=s.getSparklineEx(n.name)))&&(f={zoomFactor:c=q(a)?a.printZoomFactor:u.zoom(),sheet:u,rowIndex:a.row,columnIndex:a.col},2===a.columnHeaderFitMode&&(r=u.getColumnWidth(a.col,a.sheetArea)+1),s.paint(t,n.value,e,i,r,o,f),!0)},y.xt={},y.Dt=function(t,n){var e,t,n,n,t,t;return t&&t.vn&&(t=(e=t.vn(n)).format(n))&&t[1]&&"decimalSeparator"===t[1].type?(n=t[2])&&n.type===b?(n=n.value,t=(t=t[3])&&"exponent"===t.type&&t.value&&-1<t.value.indexOf("E"),!Y(n)&&t?n.length:5):0:5},y.gn=yt,I=y,t.Context=I,H={9001:65087,9002:65088,10216:65087,10217:65088,10092:65087,10093:65088,10096:65087,10097:65088,12296:65087,12297:65088,9121:65089,9126:65090,12300:65089,12301:65090,65378:65089,65379:65090,40:9180,41:9181,91:9140,93:9141,65339:9140,65341:9141,123:9182,125:9183,10100:9182,10101:9183,65115:9182,65116:9183,65371:9182,65373:9183,12310:65047,12311:65048,10098:65081,10099:65082,12308:65081,12309:65082,65117:65081,65118:65082,12304:65083,12305:65084,10218:65085,10219:65086,12298:65085,12299:65086,12302:65091,12303:65092},f.prototype.pn=function(t,n,e,i){var t={ctx:t,options:{rect:n,context:e,value:i}};return f.et(e.sheet,"paintCellPadding",t),t.options.rect},f.prototype.bn=function(t,n,e){var n={context:t,options:{dom:n,cellRect:e,contentRect:e.clone(),leftExternalRect:new lt.Rect(0,0,0,0),rightExternalRect:new lt.Rect(0,0,0,0)}};return f.et(t.sheet,"onCreateCellEditor",n),n.options.dom},f.prototype.yn=function(t,n,e){var n={ctx:null,options:{rect:n.clone(),context:t,value:null,style:e}};return f.et(t.sheet,"getCellButtonRect",n),n.options.rect},f.prototype.wn=function(t,n,e,i){var n={context:t,options:{dom:n,cellRect:e,cellStyle:i,contentRect:e.clone(),leftExternalRect:new lt.Rect(0,0,0,0),rightExternalRect:new lt.Rect(0,0,0,0)}};return f.et(t.sheet,"onActivateCellEditor",n),n},f.prototype.Mn=function(t,n,e,i){var n={context:t,contentContainer:n,editorBounds:e,cellStyle:i,contentRect:e.clone(),leftExternalRect:new lt.Rect(0,0,0,0),rightExternalRect:new lt.Rect(0,0,0,0)};return f.et(t.sheet,"onUpdateContainer",n),n},f.prototype.Cn=function(t,n,e){var n={context:t,options:{dom:n,cellRect:e,contentRect:e.clone(),leftExternalRect:new lt.Rect(0,0,0,0),rightExternalRect:new lt.Rect(0,0,0,0)}};return f.et(t.sheet,"onDeactivateCellEditor",n),n.options.dom},f.prototype.Sn=function(t,n,e){var i=this;i.deactivateEditor(t,n),i.Cn(n,t,e)},f.prototype.Tn=function(t,n,e,i){var r,o,a,u,i,u,o,i,o,u,s,r=e.labelOptions;r&&(o=i.sheet,a=e.watermark)&&(u=r.visibility,i=o.getText(i.row,i.col,i.sheetArea),1!==u)&&(2!==u&&u!==A||""!==i)&&(u=o.zoom(),i=void 0,i=(o=r.font)?ht.W.V(o,u):ht.W.V(e.font,1),o=Z(i.font),u=jt(n,e),s=void 0,s=Et(e,n)?Rt(n,e,i,o):s)&&(t.save(),t.textAlign=Ot(r.alignment),t.textBaseline="alphabetic",dt(t,i.font),t.fillStyle=r.foreColor||e.foreColor||"grey",t.rect(u.x,u.y,u.width,u.height),t.clip(),t.beginPath(),t.fillText(a,s.x,s.y),t.restore())},f.prototype.An=function(t,n,e){var i,r,o,a,n,i=t.clone(),r=yt(n,0,!1,e),o=yt(n,1,!1,e),a=yt(n,2,!1,e),n=yt(n,3,!1,e);return 0<r&&(i.y+=r,i.height-=r),0<a&&(i.height-=a),0<n&&(i.x+=n,i.width-=n),0<o&&(i.width-=o),o+n>=t.width&&(i.width=0),r+a>=t.height&&(i.height=0),i},f.prototype.In=function(t,n,e,i){var r,o,r,r=this,o=q(i)?i.printZoomFactor:i.sheet.zoom();return n=r.An(n,e,o),f.et(i.sheet,"getCellPaddingRect",r={ctx:t,options:{rect:n,context:i}}),r.options.rect},f.prototype.xn=function(t,n,e,i){var r,o,i,a,u,s,c,o,f,l,a,n,h,d,r=e.labelOptions;r&&(i=(o=i.sheet).getText(i.row,i.col,i.sheetArea),a=e.watermark,1!==(u=r.visibility))&&a&&(s=r.font||e.font||o.Dn.Nn(),1!==(c=o.zoom())&&(s=o.Dn._n(s)),o=Z(s),f=Et(e,n)?Bt(n,e):f)&&((l=(0,v.GC$)(lt.mt.En("span"))).text(a),n=f.height-o,h=f.y+((a=(2===u||u===A)&&""===i)&&0<n?n:0),l.css({display:"block",position:"absolute",left:f.x,top:h,width:f.width,height:f.height,font:S(s),color:r.foreColor||e.foreColor||"grey",textAlign:Ot(r.alignment),overflow:"hidden",whiteSpace:"nowrap"}).attr("gcUIElement","gcEditorLabel"),(0,v.GC$)(t).append(l),a)&&(d=setInterval(function(){h--,l.css("top",h),h<=f.y&&clearInterval(d)},20))},f.prototype.jn=function(t){var n,e,i,r,i,n=this,e=lt.mt.En("div");return e.style.cssText="position: absolute; margin: 0;padding: 0 ;overflow: hidden; box-sizing: content-box;resize: none;outline: none;border: 2px #5292f7 solid;box-shadow: 1px 2px 5px rgba(0,0,0,0.4);background-color: white",(i=lt.mt.En("div")).style.cssText="position: absolute; outline: none; border: none",(0,v.GC$)(e).append((0,v.GC$)(i)),(r=n.createEditorElement(t,e))&&(0,v.GC$)(i).append((0,v.GC$)(r)),i=t.sheetArea,n.bn(t,e,t.sheet.getCellRect(t.row,t.col,1===i?-1:A,2===i?-1:A)),e},f.prototype.On=function(t,n,e,i){var r,e,e,o,a,u,e,s,o,c;t&&t.firstChild&&(r=this,Dt(t,n,e=Gt(e),i),o=(e=r.wn(i,t,e,n)).options.contentRect,a=e.options.cellRect,u=e.options.leftExternalRect,e=e.options.rightExternalRect,r.xn&&r.xn(t,o,n,i),s=i.sheet.zoom(),o=it(o=r.An?r.An(o,n,s):o,u,e),c=t.firstChild,(0,v.GC$)(c).css({left:(+(0,v.GC$)(c).css("left").replace("px","")||0)+yt(n,3,!1,s),top:(+(0,v.GC$)(c).css("top").replace("px","")||0)+yt(n,0,!1,s)}),r.activateEditor(t.firstChild.firstChild,n,o,i,a,u,e))},f.prototype.updateEditorContainer=function(t,n,e,i,r,o,a){var n,t,n,u,s,t;t&&n&&(t=(n=t.parentNode)?n.parentNode:A)&&r&&(n=(0,v.GC$)(t),u=r.width,s=r.height,0<u&&(n.width(u),t=t.lastChild,e)&&"gcEditorLabel"===t.getAttribute("gcUIElement")&&(0,v.GC$)(t).width(u-yt(e,3,!0)-yt(e,1,!0)-2),0<s&&n.height(s),Y(r.x)||n.css("left",r.x+"px"),Y(r.y)||n.css("top",r.y+"px"))},f.prototype.Rn=function(t,n,e,i){var r,o,e,t,e,a,u,t,o,a,a,u,t,s,c,e,r=this,o=t.firstChild,e=Gt(e);Dt(t,n,e,i),e=(t=r.Mn(i,o,e,n)).editorBounds,a=t.contentRect,u=t.leftExternalRect,t=t.rightExternalRect,o=o.firstChild,a=it(a=r.An?r.An(a,n,i.sheet.zoom()):a,u,t),a=r.updateEditor(o,n,a,i,e,u,t),u={width:u.width,height:u.height},t={width:t.width,height:t.height},c=!isNaN(a&&a.width)&&a.width+u.width+t.width>e.width?a.width+u.width+t.width:e.width,e=!isNaN(a&&a.height)&&a.height+u.height+t.height>e.height?a.height+u.height+t.height:e.height,r.updateEditorContainer(o,a,n,i,s={width:c,height:e},u,t)},f.prototype.Bn=function(t,n,e,i,r){return this.getCellAndPaddingHitInfo(t,n,e,i,r)},f.prototype.Ln=function(t,n,e,i,r){var o,t,o=It(r,e)+At(r)+xt(r,e),t=this.getAutoFitWidth(t,n,e,i,r);return 0<t&&(o+=t+yt(e,3,!1)+yt(e,1,!1)),o},f.prototype.Fn=function(t,n,e,i,r){var o,t,o=0,t=this.getAutoFitHeight(t,n,e,i,r);return 0<t&&(o+=t+yt(e,0,!1)+yt(e,2,!1)),o=Math.max(kt(r,e),o),Math.max(Nt(r,e),o)},f.prototype.paintValue=function(t,n,e,i,r,o,a,u){var s,c,f,l,l,s=this,c={};u.quotePrefix=a.quotePrefix,(f=this.format(T(n),a.formatter||a._autoFormatter,c,u))&&(l=new lt.Rect(e,i,r,o),this.adjustRectForIconSet(a.hAlign,u.sheet,u.row,u.col,u.sheetArea,l,c.content&&this.hasInfilling(c.content)),e=l.x,r=l.width,l=s.Pn(t,f,a,u,e,i,r,o),this.paintText(t,n,e,i,r,o,a,u,f,c,A,l.externals))},f.prototype.Gn=function(t,n,e){var t=0<t?8*t:0;return t=n&&n.Un(e)?0:t},f.prototype.Ft=function(t,n){return!!(!t||u(t,B)&&t===O||t&&t.formatString&&t.formatString()===O)||!(n&&(!isNaN(n)||"TRUE"===n.toUpperCase()||"FALSE"===n.toUpperCase())&&"@"!==t)},f.prototype.Hn=function(t){for(var n,e,n=0,e=0;e<t.length;e++)n+=t[e].width;return n},f.prototype.zn=function(t){for(var n,e,n=0,e=0;e<t.length;e++)n+=t[e].height;return n},f.prototype.Vn=function(t,n,e,i,r){var o;f.et(n.sheet,"beforePaintLabel",{ctx:t,options:{rect:e,context:n,value:i,style:r}})},f.prototype.Pn=function(t,n,e,i,r,o,a,u){var t={ctx:t,text:n,rect:new lt.Rect(r,o,a,u),style:e,context:i,externals:{left:[],right:[]}};return f.et(i.sheet,"beforePaintText",t),en(t),t},f.prototype.Yn=function(t,n,e,i,r,o,a,u,s){var t={ctx:t,style:n,context:e,textRect:new lt.Rect(i,r,o,a),availRect:u};return f.et(e.sheet,s,t),tn(s,t),t},f.prototype.Zn=function(t,n,e,i,r,o,a,u){return this.Yn(t,n,e,i,r,o,a,u,"beforeFillTextArea")},f.prototype.Wn=function(t,n,e,i,r,o,a,u){return this.Yn(t,n,e,i,r,o,a,u,"afterFillTextArea")},f.prototype.paintText=function(t,n,e,i,r,o,a,u,s,c,f,l){var h,d,v,m,g,h=this;t.save(),t.beginPath(),d=a.textOrientation,v=a.textIndent&&0!==a.textIndent,m=a.hAlign,g=a.isVerticalText&&4!==m,4===m&&(d=0,v=!1),n&&n.richText&&0<n.richText.length||g?h.Qn(t,n,e,i,r,o,a,u,s,c,f,l):0!==d&&!Y(d)&&-90<=d&&d<=90&&!v&&!g?h.Kn(t,n,e,i,r,o,a,u,s,c,f,l):h.Jn(t,n,e,i,r,o,a,u,s,c,f,l),t.restore()},f.prototype.Xn=function(t,n,e,i,r,o,a,u,s,c){for(var f,l,h,d,v,m,g,p,b,y,w,M,C,S,T,A,I,x,f=n.sheet,l=n.row,h=n.col,d=r.vAlign,v=n.sheetArea,m=0;m<e.length;m++)if(g=e[m].text,p=i[m].lineHeight,b=1===d?0:u,y=this.qn(t,"0"),w="",(M=o)-1-2-b<g.length*p){if(M<3*y)c.push(0),w=k;else if(C=vt((M-1-2-3*y-(1===d?0:u))/p),(S=0)===d){for(T=0;T<C;T++)w+=g[T];A=w.length,3*y+((w+=k).length-3)*p+u>M-1-2?(w=w.substring(0,w.length-4)+k,c.push(w.split(k)[0].length)):c.push(A)}else if(1===d){for(I=0;I<N(C/2);I++)w+=x=g.charAt(I),S=I;for(A=w.length,w+=k,I=N(g.length-C/2);I<g.length;I++)w+=x=g.charAt(I);3*y+(w.length-3)*p+u>M-1-2?(w=w.replace(g[S],""),c.push(w.split(k)[0].length)):c.push(A),s[m].y=a+(o-(3*y+(w.length-3)*p))/2}else{for(c.push(0),T=g.length-1;T>=g.length-C;T--)w=g[T]+w;3*y+((w=k+w).length-3)*p+u>M-1-2&&(w=w.replace(g[g.length-C],"")),s[m].y=a+o-u-(3*y+(w.length-3)*p)-2}e[m].textInfos[0].text=w,f.Ut.$n(l,h,g,v)}else f.Ut.$n(l,h,null,v)},f.prototype.Qn=function(t,n,e,i,r,o,a,u,s,c,f,l){var h,d,v,m,g,p,b,y,w,p,M,C,S,C,S,l,C,T,A,S,m,I,x,N,w,l,k,h=this,d=new lt.Rect(e,i,r,o),v=h.Gn(a.textIndent,u.sheet.outlineColumn,u.col),m=u.cellOverflowLayout&&u.cellOverflowLayout.expandedWidth,g=a.hAlign,p=a.formatter||a._autoFormatter;if(3===g&&(g=wt(g,n,p)),y=!!(b=a.isVerticalText&&4!==g)&&W(s),w=a.font,p=h.Ft(p,n.text),M=F(!0,[],h.Pt(n,s,p,w,a.foreColor)),Ct(t,u.sheet,a,f),n&&n.richText&&0<n.richText.length&&(C=u.sheet?u.sheet.zoom():1,S=u.printZoomFactor,S=q(u)?S:D,h.te(M,w,C,S)),S=C=0,l&&(C=h.Hn(l.left),S=h.Hn(l.right)),l=C+S,C={left:C,right:S},!a.wordWrap&&a.shrinkToFit&&(4===a.hAlign?h.ne(M,m-l,o,a,w,1,b):h.ne(M,r-l,o,a,w,1,b)),T=h.ee(t,s,a.font,b?o:r-l,v,b?a.vAlign:a.hAlign,a.wordWrap,b,M),A=h.re(T,a,g,f),S=h.oe(t,a,e,i,r,o,a.wordWrap,u.cellOverflowLayout,g,v,b,T[0].textLength,A[0].lineHeight),m=!1,a.showEllipsis&&b&&!n.richText&&(m=!0),I=[],I=4===g?h.ae(e,i,u.cellOverflowLayout.expandedWidth,o,g,a.vAlign,v,b,y,T,A,C,m,a):h.ae(e,i,r,o,g,a.vAlign,v,b,y,T,A,C,m,a),x=T.length,N=[],m&&c&&(c.content&&1===c.content.length&&"text"===c.content[0].type||!c.content&&1===T.length&&T[0].text)&&this.Xn(t,u,T,A,a,o,i,v,I,N),1===x&&c&&!p)h.ue(t,u.sheet,s,c,I[0].x,I[0].y,r,o,g,a,S.width,S.height,v,b,T[0].textLength,u,C,d);else{for(w=h.se(T),l=I[0].x,t.textAlign===K?l-=w/2:t.textAlign===J&&(l-=w),h.Zn(t,a,u,l,I[0].y,w,0,d),k=0;k<x;k++)h.ce(t,u.sheet,I[k].x,I[k].y,A[k],g,T[k],N[k]);h.Zn(t,a,u,l,I[0].x,w,0,d)}},f.prototype.se=function(t){for(var n,e,n=t[0].textLength,e=0;e<t.length;e++)n=bt(n,t[e].textLength);return n},f.prototype.qn=tt,f.prototype.fe=function(t,n,e,i,r,o,a){var u,s,e,c,f,t,l,h,r,d,v,m,g,p,b,y,w,M,C,S,C,s=t.sheetArea,u=e,e=this.qn(i,u),c=t.sheet,f=t.row,t=t.col,l=r,h=0,r=this.qn(i,"0"),d;if(h=this.qn(i,k),l-1-2-(v=1===o?0:a)<e){if(m="",2===o)for(g=u.length-1;0<=g;g--){if(l-1-2-a<h){p=m.length,m=k+m.substring(1,p);break}m=(b=u.charAt(g))+m,h+=y=this.qn(i,b)}else if(1===o){for(w=N((l-h)/r),g=0;g<w/2;g++)m+=b=u.charAt(g);for(m+=k,g=vt(u.length-w/2);g<u.length;g++)m+=b=u.charAt(g);for(M=this.qn(i,m);l-1-2<M&&m!==k;)S=(C=m.split(k))[0],C=C[1],m=S.length>C.length?S.substring(0,S.length-1)+k+C:S+k+C.substring(1,C.length),M=this.qn(i,m)}else for(g=0;g<u.length;g++){if(l-1-2-a<h){p=m.length,m=m.substring(0,p-1)+k;break}m+=b=u.charAt(g),h+=y=this.qn(i,b)}n.content=[{value:m,type:"text"}],c.Ut.$n(f,t,u,s)}},f.prototype.Jn=function(t,n,e,i,r,o,a,u,s,c,f,l){var h,d,v,m,g,p,b,y,w,M,C,S,B,L,T,A,F,P,I,x,N,f,v,k,D,l,_,G,E,j,O,A,n,b,U,A,v,k,w,b,p,A,f,o,R,k,w,m,k,n,I,H,z,h=this,d=0,v=a.textIndent,m=a.wordWrap,g=a.hAlign,p=a.vAlign,b=a.shrinkToFit,y=a.textDecoration,w="left",M=2,C=2,S=a.font,B=0,L=[],T=0,A=u.sheet,F=new lt.Rect(e,i,r,o),P=u.cellOverflowLayout&&u.cellOverflowLayout.expandedWidth,I=u.offsetX;if(I=I||0,4===g&&(v=y=0),Y(u.fontInfo)&&(u.fontInfo=ht.W.V(a.font,A.zoom()),q(u))&&(u.fontInfo=ht.W.V(u.fontInfo.font,u.printZoomFactor)),x=parseInt(u.fontInfo.fontSize,10),Y(u.lineHeight)&&(u.lineHeight=Z(ht.W.V(a.font,A.zoom()).font,!1,W(s))),N=u.lineHeight,Ct(t,A,a,f),0<v&&(d=8*v),A.outlineColumn&&A.outlineColumn.Un(u.col)&&(d=0),3===g&&(g=wt(g,n,a.formatter||a._autoFormatter)),f=1,dt(t,S),k=v=0,l&&(v=h.Hn(l.left),k=h.Hn(l.right)),D=v+k,l={left:v,right:k},!m&&b){for(G={value:!1},E=void(_=0),j=0;j<3&&!1===G.value&&(O=t.measureText(s).width,_=bt(0,r-4-(1===g?0:d)-D),(_=4===g?bt(0,P-4-d-D):_)<O);j++)S=(E=ht.W.V(S,_/O,G,!0)).font,dt(t,S);E&&(f=x/E.fontSize,x=E.fontSize)}if(A=(A=A.parent&&A.parent.options.numbersFitMode===V.NumbersFitMode.overflow||!1)||(c&&c.content?!(!c.content||1!==c.content.length||"text"!==c.content[0].type):"string"==typeof n&&n===s),!m&&!b&&a.showEllipsis&&A&&this.fe(u,c,s,t,r,g,d),M+=d+v,1===g||4===g?(M=(r+v-k)/2,w=K):2===g&&(M=r-k-1-2,w=J,M=rt(a,M-=d)),t.textAlign!==w&&(t.textAlign=w),n=0,m&&(n=r-D-(b=ot(a,3))-d,4===g&&(n=P-D-b-d),1<(T=(L=lt.q.un(s,--n,S,!1,t)).length))&&0!==p&&(B=(T-1)*N),C=(C+(N-(A=N/2-x/2+(U=8<x?vt((x-8)/5+2):1)-1)))/f,1===p?C=(o-B)/2+N/2-A:2===p&&(C=o-(B+2+A)/f),t.textBaseline!==X&&(t.textBaseline=X),w={x:(k=(v=u.cellOverflowLayout)&&v.layout)?k.x:e+1,y:k?k.y:i+1,width:k?k.width:r-2,height:k?k.height:o-2},v&&4===g&&(M+=(v.expandedWidth-r)/2),M+=I,b=k&&k.width>r||4===g,p=w.x,A=w.y,f=w.width,o=w.height,m)if(t.rect(p,A,f,o),t.clip(),t.beginPath(),R=i+C,1<T){for(k=e+M,t.textAlign===K?k-=n/2:t.textAlign===J&&(k-=n),h.Zn(t,a,u,k,R,n,N*T,F),j=0;j<T;j++)t.fillText(L[j],e+M,R),y&&(O=t.measureText(L[j]).width,h.le(t,y,e+M,R,O,x,U)),R+=N;h.Zn(t,a,u,k,R,n,N*T,F)}else h.he(t,s,c,e+M,i+C,g,f,d,y,U,x,u,a,l,F,b);else m=f-(e+1-p)<(w=Q(t,t.font,s)+D)||o<N||0!==I,4===g&&(m=!0),k=yt(a,0),n=yt(a,1),I=yt(a,2),H=yt(a,3),m||(1===g||4===g?v&&((z=w/2)>v.backgroundLeftWidth||z>v.backgroundRightWidth)&&(m=!0):(f<w+d+k+I||o<B+H+n)&&(m=!0)),m&&(t.rect(p,A,f,o),t.clip(),t.beginPath()),h.he(t,s,c,e+M,i+C,g,f,d,y,U,x,u,a,l,F,b)},f.prototype.Kn=function(t,B,L,n,e,i,r,o,a,u,F,s){var c,f,l,P,G,U,h,d,v,H,m,g,p,z,b,y,w,V,M,M,C,S,Y,T,Z,A,I,x,W,M,Q,J,K,M,N,k,X,q,D,_,E,$,tt,j,nt,et,it,rt,ot,O,R,at,ut,st,ct,ft,u,F,B,s,G,Z,P,f,c=this,f=r.wordWrap,l=r.hAlign,P=r.vAlign,G=r.shrinkToFit,U=r.textDecoration,h=2,d=2,v=r.font,H=[],m=0,b=parseInt(o.fontInfo.fontSize,10),y=o.sheet,V=new lt.Rect(L,n,e,i),M=o.cellOverflowLayout,M=M&&M.layout,C=r&&(r.borderLeft||r.borderTop||r.borderRight||r.borderBottom)&&!y.getSpan(o.row,o.col,o.sheetArea),S=r.textOrientation,Y=S*Math.PI/180,T=pt(Y),Z=gt(T),A=mt(T),I=Mt(T),x=o.lineHeight,W=90===S||-90===S;if(C&&(-90<S&&S<0&&(w=!1),0<S)&&S<90&&(w=!0),Q=(M={x:M?M.x:L+1,y:M?M.y:n+1,width:M?M.width:e-2,height:M?M.height:i-2}).x,J=M.y,K=M.width,M=M.height,N=x/2*mt(T),k=x/2*gt(T),q=x/2-b/2+(X=8<b?vt((b-8)/5+2):1)-1,u&&u.content&&0<u.content.length&&!G&&(a=c.de(t,u.content,i-4,v)),D=y.Qt(a,v),Ct(t,y,r,F),3===l&&(l=wt(l,B,r.formatter||r._autoFormatter,S)),dt(t,v),E=_=0,s&&(_=c.Hn(s.left),E=c.Hn(s.right)),!f&&G)for(tt={value:!1},j=$=0;j<3&&!1===tt.value&&($=bt(0,(i-4-2*k)/A))<D;j++)v=ht.W.V(v,$/D,tt,!0).font,dt(t,v),b=parseInt(o.fontInfo.fontSize,10),D=y.Qt(a,v),N=(x=lt.mt.vt(v))/2*mt(T),k=x/2*gt(T);if(et=nt=0,f)for(m=(H=lt.q.un(a,et=(i-4-2*k)/A,v,!1,t)).length,D=y.Qt(H[0],v),it=0;it<m;it++)nt<(rt=y.Qt(H[it],v))&&(nt=rt);switch(g=D/2*Z,p=(f?nt:D)/2*A,ot=""+l+(P=i<=(z=(f?nt:D)*A+2*k)?2:P)){case"00":h+=g+N+_,d+=p,W||(d+=k),C&&(h=(i-d)/I*(w?1:-1)+(x/2+2)/A+_);break;case"01":h+=g+N+_,d=i/2,C&&(h=(i-d)/I*(w?1:-1)+(x/2+2)/A+_);break;case"02":h+=g+N+_,d+=p,W||(d+=k),C&&(h=d/I*(w?1:-1)+(x/2+2)/A+_),d=i-d;break;case"10":h=(e+_-E)/2,d+=p,W||(d+=k),C&&(h+=(w?1:-1)*(i-d)/I);break;case"11":h=(e+_-E)/2,d=i/2,C&&(h+=(w?1:-1)*(i-d)/I);break;case"12":h=(e+_-E)/2,d+=p,W||(d+=k),C&&(h+=(w?1:-1)*d/I),d=i-d;break;case"20":h=e-2-g-N-E,d+=p,W||(d+=k),C&&(h=e+(i-d)/I*(w?1:-1)-(x/2+2)/A-E);break;case"21":h=e-2-g-N-E,d=i/2,C&&(h=e+(i-d)/I*(w?1:-1)-(x/2+2)/A-E);break;case"22":h=e-2-g-N-E,d+=p,W||(d+=k),C&&(h=e+d/I*(w?1:-1)-(x/2+2)/A-E),d=i-d}if(f)if(O=L+h,R=x/A,at=void 0,90===Math.abs(S)&&(ct=K<D*m+(ut=yt(r,1))+(st=yt(r,3)))&&(t.rect(Q,J,K,M),t.clip()),1<m){for(1===l&&(O-=(ft=m%2!=0)?R*(m-1)/2:m/2*R-.5*R),F=(u=Ht(O,n+d,D,Y,x)).width+R*(m-1),B=u.height,s=2===l?u.x-R*(m-1):u.x+R*(m-1),G=u.y,c.Zn(t,r,o,s,G,F,B,V),j=0;j<m;j++)at=j,(0<r.textOrientation&&2===l||r.textOrientation<0&&(0===l||1===l))&&(at=m-j-1),c.ve(t,Y,H[at],O,n+d,U,b,X,q),O=2===l?O-R:O+R;c.Zn(t,r,o,s,G,F,B,V)}else c.me(t,a,L,n,h,d,o,r,D,Y,U,b,X,x,q,V);else Z=D*A+b*A+2,P=yt(r,0),f=yt(r,2),(ct=M-(n+1-J)<Z||M<x||M<Z+P+f)&&(t.rect(Q,J,K,M),t.clip()),c.me(t,a,L,n,h,d,o,r,D,Y,U,b,X,x,q,V)},f.prototype.me=function(t,n,e,i,r,o,a,u,s,c,f,l,h,d,v,m){var g,p,b,y,w,p,M,g=this,p=Ht(e,i,s,c,d),b=p.width,y=p.height,w=p.x,p=p.y;(ht.W.dfe(u,V.IconPosition.leftOfText)||ht.W.dfe(u,V.IconPosition.rightOfText))&&(M=pt(c),w=e+r-(b=s*gt(M)+d*mt(M))/2,p=i+o-(y=s*mt(M)+d*gt(M))/2),g.Zn(t,u,a,w,p,b,y,m),g.ve(t,c,n,e+r,i+o,f,l,h,v),g.Wn(t,u,a,w,p,b,y,m)},f.prototype.te=function(t,n,e,i){Ut(t,n,e,i)},f.prototype.ne=function(t,n,e,i,r,o,a){for(var u,s,c,f,l,u=0,s={value:!1},c=0;c<3&&!1===s.value&&(f=st(t,r,o,a),u=bt(0,(a?e:n)-4),(u=(a?i.vAlign:1!==i.hAlign&&i.textIndent)?bt(0,u-8*i.textIndent):u)<f);c++)for(l=0;l<t.length;l++)t[l].style.font=ht.W.V(t[l].style.font,u/f,s,!0).font},f.prototype.Pt=function(t,n,e,i,r){var t=t.richText;return t=!Y(t)&&e?t:[{style:{font:i,foreColor:r},text:n}]},f.prototype.oe=function(t,n,e,i,r,o,a,u,s,c,f,l,h){var d,r,d,o,v,m,g,d=u&&u.layout,r={x:d?d.x:e+1,y:d?d.y:i+1,width:d?d.width:r-2,height:d?d.height:o-2},d=r.x,o=r.y,v=r.width,m=r.height;return(a||(g=this.ge(n,s,n.vAlign,e,i,m,v,d,o,l,h,c,f,u)))&&(t.rect(d,o,v,m),t.clip(),t.beginPath()),r},f.prototype.ge=function(t,n,e,i,r,o,a,u,s,c,f,l,h,d){var v,m,g,p,t,h,m=yt(t,0),g=yt(t,1),p=yt(t,2),t=yt(t,3);return h?(!(v=o-(r+1-s)<c||a<f)&&1!==e&&o<c+l+m+p||a<f+t+g)&&(v=!0):(v=a-(i+1-u)<c||o<f)||(1===n?d&&((h=c/2)>d.backgroundLeftWidth||h>d.backgroundRightWidth)&&(v=!0):(a<c+l+t+g||o<f+m+p)&&(v=!0)),v},f.prototype.ee=function(t,n,e,i,r,o,a,u,s){var c,f,l,h,h;if(1!==o?i=i-3-r:i-=3,a)return lt.q.Ht(n,i,e,s,u,t);for(f=c=0;f<s.length;f++)l=s[f].text,u?c+=Z(s[f].style.font)*(l?l.length:0):(h=ht.W.V(s[f].style.font,1),h=s[f].style.vertAlign?h.fontSize*d+"px "+h.fontFamily:s[f].style.font,c+=Q(t,h,l));return[{textLength:c,text:n,textInfos:s}]},f.prototype.ue=function(t,n,e,i,r,o,a,u,s,c,f,l,h,d,v,m,g,p){var b,b,y,w,b=c.font,b=ht.W.V(b,1).fontSize,y=8<b?vt((b-8)/5+2):1;this.pe(t,n,c),d?this.be(t,e,i,c,r,o,l,h,l,m,g,p):this.he(t,e,i,r,o,s,f,h,c.textDecoration,y,b,m,c,g,p,w=a<f,v)},f.prototype.be=function(t,n,e,i,r,o,a,u,s,c,f,l){var h,d,v,e,m,g,p,b,h=this,d=e.content,e=o;if(h.Zn(t,i,c,r,e,s,s*n.length,l),d&&0<d.length)for(g=0<(g=a-u-(m=Lt(t,d,!0))-2)?g:0,p=void 0,v=0;v<d.length;v++)"fillingChar"===d[v].type?(b=Pt(t,g,d[v].value,!0),this.ye(t,b,r,o),o+=g):"placeholder"===d[v].type?o+=d[v].value?d[v].value.length*s:0:"numberPlaceholder"===d[v].type?o+=s:(this.ye(t,d[v].value,r,o),o+=p=d[v].value?d[v].value.length*s:0);else if(n)for(v=0;v<n.length;v++)o=this.ye(t,n[v],r,o,s).y;h.Wn(t,i,c,r,e,s,o-e,l)},f.prototype.we=function(t){var n=w;return 1===t?n=K:2===t&&(n=J),n},f.prototype.ce=function(t,n,e,i,r,o,a,u){for(var s,c,f,l,s=[],c=a.textInfos,f=0;f<c.length;f++)s.push(F(!0,{},r,c[f].style));for(f=0;f<c.length;f++)e=(l=this.Me(t,n,e,i,s[f],c[f].text,u)).x,i=l.y},f.prototype.re=function(t,n,e,i){for(var r,o,a,u,r=[],o=t.length,a=0;a<o;a++)u=this.Ce(n,e,i,t[a].textInfos),r.push(u);return r},f.prototype.Ce=function(t,n,e,i){var r,o,a,u,s,c,f,r=this,o=0,a=0;if(i)for(u=0;u<i.length;u++)s=void 0,s=(i[u].style&&i[u].style.font?i[u].style:t).font,o=Math.max(Z(s,A,W(i[u].text)),o),a=Math.max(ht.W.V(s,1).fontSize,a),(i[u].style&&1===i[u].style.vertAlign||2===i[u].style.vertAlign)&&(o=Math.max(Z(s,A,W(i[u].text))+2*ht.W.V(s,d).fontSize*.218,o));return{lineHeight:o,fontSize:a,baselineOffset:c=8<a?vt((a-8)/5+2):1,lineOffset:f=o/2-a/2+c-1,font:t.font,foreColor:t.foreColor,textDecoration:t.textDecoration,isVerticalText:t.isVerticalText,textAlign:r.we(n),textBaseline:X,opacity:e}},f.prototype.Se=function(t,n,e){for(var i=0,r=0,o,o=0;o<t.length;o++)r+=n[o].lineHeight,i=Math.max(t[o].textLength,i);return{width:e?r:i,height:e?i:r}},f.prototype.ae=function(t,n,e,i,r,o,a,u,s,c,f,l,h,d){var v,m,g,p,b,v=this.Se(c,f,u),m=v.height,g=v.width,p=[];if(u)for(b=0;b<c.length;b++)p.push(this.Te(t,n,e,i,r,o,a,g,c[b].textLength,f[b].lineHeight,f[b].lineOffset,s,l,c[b],h,d)),s?t-=f[b].lineHeight:t+=f[b].lineHeight;else for(b=0;b<c.length;b++)p.push(this.Ae(t,n,e,i,r,o,a,c[b].textLength,m,f[b].lineHeight,f[b].lineOffset,l,d)),n+=f[b].lineHeight;return p},f.prototype.Ae=function(t,n,e,i,r,o,a,u,s,c,f,l,h){var d,v,m,l,d=0,v=0,m=l.left,l=l.right;return v=1===o?(i-s)/2+c-f:2===o?i-s-2+c-f:2+c-f,1===r||4===r?d=(e-u+m-l)/2:2===r?(d=rt(h,d=e-1-2-u-l),d-=a):d=2+a+m,{x:t+d,y:n+v}},f.prototype.Te=function(t,n,e,i,r,o,a,u,s,c,f,l,h,d,v,m){var g,p,b,y,h,g=0,p=0,y=h.left,h=h.right;return l?0===r?g=2+u+h-c/2:1===r?g=(e-y+h+u)/2-c/2:2===r&&(g=rt(m,g=e-y-1-2-c/2)):1===r?g=(e-u+y-h)/2+c/2:2===r?g=rt(m,g=e-1-2-h-u+c/2):0===r&&(g=2+y+c/2),{x:t+g,y:n+(p=1===o?(i-s)/2:2===o?i-a-s-2:2+a)}},f.prototype.Me=function(t,n,e,i,r,o,a){var n,a;return t.save(),this.pe(t,n,r),n=r.vertAlign,a=r.isVerticalText?this.ye(t,o,e,i,r.textDecoration,r.baselineOffset,a):this.Ie(t,e,i,r,o,n),t.restore(),a},f.prototype.pe=function(t,n,e){Ct(t,n,e);var n=e.vertAlign?this.xe(e.font):e.font;Y(e.textBaseline)||t.textBaseline===e.textBaseline?Y(t.textBaseline)&&t.textBaseline!==X&&(t.textBaseline=X):t.textBaseline=e.textBaseline,e.isVerticalText?t.textAlign!==K&&(t.textAlign=K):t.textAlign!==w&&(t.textAlign=w),dt(t,n)},f.prototype.xe=function(t){var t,n,t=ht.W.Ne(t),n=parseFloat(t.fontSize)*d;return t.fontSize=n+"px",this.ke(t)},f.prototype.ke=function(t){var n,e,i,r,o,a,t,n="",e="normal",i,r=t.fontStyle,o=t.fontSize,a=t.fontWeight,t=t.fontFamily;return n=void 0!==r?r:e,n=(n=(n+=void 0!==a?(n?" ":"")+a:(n?" ":"")+e)+((n?" ":"")+o))+(void 0!==t?(n?" ":"")+t:(n?" ":"")+"Calibri")},f.prototype.ye=function(t,n,e,i,r,o,a){var u,s,c,f,l,h,d,v,m,v;if(n&&0<n.length)for(u=t.font,s=Z(u,A,W(n)),c=nt(ht.W.V(u,1).fontSize,s),l=(f=this.qn(t,"0"))/2,h=0;h<n.length;h++)d=et(n[h]),v=void 0!==a&&a<=h&&h<=a+2&&(a+3===n.length||0===a&&a+3<n.length||0!==a&&a+3<n.length),t.fillText(d,e,i=i+(m=v?f:s)-(v=v?l:c)),this.De(t,r,e,i,Q(t,t.font,d),ht.W.V(t.font,1).fontSize,o),i+=v;return{x:e,y:i}},f.prototype.De=function(t,n,e,i,r,o,a){var u,s,c,f,s;t.strokeStyle!==t.fillStyle&&(t.strokeStyle=t.fillStyle),s=u=0,c=.5,s=vt(((f=o<=12?12:o)-12)/21+1),t.lineWidth!==s&&(t.lineWidth=s),0==(1&s)&&(c=0),(s=t.textAlign)===K?e-=r/2:s===J&&(e-=r),t.beginPath(),2==(2&n)&&(u=N(i+a-o/2)-c,t.moveTo(e,u),t.lineTo(e+r,u)),t.stroke()},f.prototype.Ie=function(t,n,e,i,r,o){var a,u,s,o,r;return Y(r)?{x:n,y:e}:(u=8<(a=ht.W.V(t.font,1).fontSize)?vt((a-8)/5+2):1,s=0,o?t.fillText(r,n,e-(s=1===o?.74*a:.28*-a)):t.fillText(r,n,e),o=Q(t,t.font,r),r=i.textDecoration,this.le(t,r,n,e,o,a,u-s),{x:n+o,y:e})},f.prototype._e=function(t,n,e,i,r,o,a,u){var s={row:u.row,col:u.col,sheet:u.sheet,sheetArea:u.sheetArea,style:a,underline:a.textDecoration,foreColor:a.foreColor};f.et(u.sheet,"applyHyperlinkStyle",s),this.paint(t,n,e,i,r,o,a,u)},f.prototype.paint=function(t,n,e,i,r,o,a,u){var s,s,c,f,c,f,c;t&&(s=a.backColor,u.parentBackColor!==s&&ft(t,e,i,r,o,u.imageLoader,a,n,u),2!==(s=u.sheetArea)&&1!==s||(c=u.visualState||0,f="columnHeader",c=this.getThemeStyle(u.visualState,"gc-"+(f=2===s?"rowHeader":f)+"-"+lt.I.Ee(c)),I.cn(t,e,i,r,o,a,f,c,s)),f=this,c=new lt.Rect(e,i,r,o),u.cellRect=c.clone(),f.Vn(t,u,c,n,a),Vt(t,c,a,u),f.Tn&&(f.Tn(t,c,a,u),c=f.An(c,a,q(u)?u.printZoomFactor:u.sheet.zoom())),u.cellOverflowLayout||f.pn(t,c,u,T(n)),0<c.width)&&0<c.height&&(a&&a.showEllipsis&&u.sheet.Ut.$n(u.row,u.col,null,u.sheetArea),f.paintContent(t,n,c.x,c.y,c.width,c.height,a,u))},f.prototype.paintContent=function(t,n,e,i,r,o,a,u){var s,c,c,c,s,c=u.conditionalFormats;c&&(s=c._e(t,T(n),e,i,r,o,a,u)),u.showBarIconOnly=s,(c=u.sparkline)&&c.paintSparkline(t,e,i,r,o),c=I.dn(t,T(n),e,i,r,o,u),u.cellOverflowLayout||s||c||(s=new lt.Rect(e,i,r,o),this.paintValue(t,n,s.x,s.y,s.width,s.height,a,u))},f.prototype.adjustRectForIconSet=function(t,n,e,i,r,o,a){St(t,n,e,i,r,o,a)},f.prototype.hasInfilling=function(t){for(var n=0;n<t.length;n++)if("fillingChar"===t[n].type)return!0;return!1},f.prototype.createEditorElement=function(t,n){return D},f.prototype.getEditorValue=function(t,n){return D},f.prototype.je=function(t,n,e,i){return e},f.prototype.setEditorValue=function(t,n,e){},f.prototype.getEditingElement=function(){return D},f.prototype.parse=function(t,n,e){var i,r,o,a,i=Y(n),r=Y(t);try{if(o=c.Formatter&&c.Formatter.GeneralFormatter,!i&&!r&&o)return(a=typeof n===B?new o(n):n).parse(t)}catch(t){}return r?"":t.toString()},f.prototype.format=function(n,t,e,i){var r,o,a,a,i,u,s,r=x(t);if(i&&r&&(a=(o=i.sheet).Oe(i.row,i.col,t),Y(a)||(n=a)),Y(n)||""===n)return"";if(i&&i.quotePrefix&&typeof n===B)return n.toString();if(!r&&typeof t===B&&"object"!=typeof n)return lt.Be.Re(n,t,e);if(!t||"General"===t||r)return"boolean"==typeof n||n instanceof Boolean?(n=l?n?l.getBoolean().boolean_true:l.getBoolean().boolean_false:n).toString().toUpperCase():n instanceof Date?(i=(a=h.Fe(h.culture()).DateTimeFormat).shortDatePattern,0===n.getHours()&&0===n.getMinutes()&&0===n.getSeconds()&&0===n.getMilliseconds()||(i=a.defaultDatePattern),C.Pe(n,i)):(n=typeof n===b?M.Ge(n.toString()):n).toString();try{return(u=c.Formatter&&c.Formatter.GeneralFormatter)?(s=void 0,(s=typeof t===B?lt.Be.Ue(t):t).format(n,e)):n.toString()}catch(t){return n.toString()}},f.prototype.focus=function(t,n){t&&t.focus&&t.focus()},f.prototype.getThemeStyle=function(t,n){return lt.I.He(t,n)},f.prototype.activateEditor=function(t,n,e,i,r,o,a){},f.prototype.deactivateEditor=function(t,n){},f.prototype.selectAll=function(t,n){t&&t.select&&t.select()},f.prototype.updateEditor=function(t,n,e,i,r,o,a){},f.prototype.setImeMode=function(t,n,e){this.isImeAware(e)?this.updateImeMode(t,n,e):t&&I.hn(t,0)},f.prototype.updateImeMode=function(t,n,e){t&&I.hn(t,n)},f.prototype.getHitInfo=function(t,n,e,i,r){return D},f.prototype.getCellAndPaddingHitInfo=function(t,n,e,i,r){var o,a,u,o=this;if(r){if(a={x:t,y:n,context:r,cellStyle:e,cellRect:i,paddingHitInfo:null},f.et(r.sheet,"getCellButtonHitInfo",a,function(){return null!==a.paddingHitInfo&&void 0!==a.paddingHitInfo}),u=a.paddingHitInfo,a.paddingHitInfo&&!Y(a.paddingHitInfo.cellButtonHitInfo)&&!Y(a.paddingHitInfo.cellButtonHitInfo.buttonConfig))return a.paddingHitInfo;if(a.cellRect=o.An?o.An(a.cellRect,e,r.sheet.zoom()):a.cellRect,f.et(r.sheet,"getCellTextHitInfo",a,function(){return!Y(a.paddingHitInfo)&&a.paddingHitInfo.isReservedLocation}),a.paddingHitInfo&&a.paddingHitInfo.isReservedLocation)return a.paddingHitInfo;if(3===r.sheetArea)return f.et(r.sheet,"getCellPaddingHitInfo",a,function(){return!Y(a.paddingHitInfo)&&a.paddingHitInfo.isReservedLocation}),a.paddingHitInfo||u||this.getHitInfo(t,n,e,i,r)}return this.getHitInfo(t,n,e,i,r)},f.prototype.processCellAndPaddingMouseDown=function(t){return f.et(t.sheet,"processMouseDownOnCellPadding",t),this.processMouseDown(t)},f.prototype.processMouseDown=function(t){return!1},f.prototype.ze=function(t){return f.et(t.sheet,"processMouseMoveOnCellPadding",t),this.processMouseMove(t)},f.prototype.processMouseMove=function(t){return!1},f.prototype.Ve=function(t){return f.et(t.sheet,"processMouseUpOnCellPadding",t),this.processMouseUp(t)},f.prototype.processMouseUp=function(t){return!1},f.prototype.processMouseEnter=function(t){return!1},f.prototype.Ye=function(t){return f.et(t.sheet,"processMouseLeaveOnCellPadding",t),this.processMouseLeave(t)},f.prototype.processMouseLeave=function(t){return!1},f.prototype.isReservedKey=function(t,n){return!1},f.prototype.isEditingValueChanged=function(t,n,e){var i,r,o,e,i,i=e.sheet,r=e.row,o=e.col,e=e.sheetArea||V.SheetArea.viewport,i=i&&i.getValue(r,o,e,V.ValueType.richText);return(t=(t=i&&i.richText?t.replace(/\r\n?/g,"\n"):t)===D?A:t)!==(n=n===D?A:n)},f.prototype.processCompositionStart=function(t,n){return!1},f.prototype.processKeyDown=function(t,n){return!1},f.prototype.processKeyUp=function(t,n){return!1},f.prototype.getAutoFitWidth=function(t,n,e,i,r){return I.Bt(t,n,e,i,r)},f.prototype.getAutoFitHeight=function(t,n,e,i,r){return I.tn(t,n,e,i,r)},f.prototype.he=function(t,n,e,i,r,o,a,u,s,c,f,l,h,d,v,m,g,p){var b,p,b=this;e&&e.content&&0<e.content.length&&(p||!m||4===o)?this.Ze(t,e.content,i,r,o,a,u,s,c,f,l,h,d,v,g):(g=g||Q(t,t.font,n),p=i,t.textAlign===K?p-=g/2:t.textAlign===J&&(p-=g),b.Zn(t,h,l,p,r,g,l.lineHeight,v),t.fillText(n,i,r),s&&this.le(t,s,i,r,g,f,c),b.Wn(t,h,l,p,r,g,l.lineHeight,v))},f.prototype.ve=function(t,n,e,i,r,o,a,u,s){var i;t.save(),t.textAlign="center",t.textBaseline="middle",t.translate(i,r),t.rotate(-n),t.fillText(e,0,0),o&&(i=t.measureText(e).width,this.le(t,o,0,s,i,a,u)),t.restore()},f.prototype.de=function(t,n,e,i){var r,o,a,u;for(t.font||dt(t,i),o=0<(o=e-(r=Lt(t,n)))?o:0,a=[],u=0;u<n.length;u++)"fillingChar"===n[u].type?a.push(Pt(t,o,n[u].value)):"placeholder"!==n[u].type&&"numberPlaceholder"!==n[u].type&&a.push(n[u].value);return a.join("")},f.prototype.Ze=function(t,n,e,i,r,o,a,u,s,c,f,l,h,d,v){var m,g,p,h,b,y,o;t.save(),t.textAlign!==w&&(t.textAlign=w),m=this,y=0<(y=o-a-(g=Lt(t,n=Ft(JSON.parse(JSON.stringify(n)))))-(b=(p=h?h.left:0)+(h=h?h.right:0))-2)?y:0,Y(v)?this.hasInfilling(n)?1===r||4===r?e=e-(o+p-h)/2+(a+p):2===r&&(e=e-o+h+2,e+=a+p):Y(g)||(1===r||4===r?e-=g/2:2===r&&(e-=g)):this.hasInfilling(n)?1===r?(e=e+(v||g)/2-(o+p-h)/2,e+=a+p):2===r&&(e=e+(v||g)-o+h+2,e+=a+p):Y(g)||(1===r?e=e+v/2-g/2:2===r&&(e=e+v-g)),m.Zn(t,l,f,e,i,g,f.lineHeight,d),o=this.We(t,n,e,i,y,u,s,c),m.Wn(t,l,f,e,i,o-e,f.lineHeight,d),t.restore()},f.prototype.We=function(t,n,e,i,r,o,a,u,s){for(var c,f,l,l,c=this.qn(t,"0"),f=0;f<n.length;f++)"fillingChar"===n[f].type?(t.fillText(Pt(t,r,n[f].value),e,i),o&&this.le(t,o,e,i,r,u,a),e+=r):"placeholder"===n[f].type?e+=Q(t,t.font,n[f].value):"numberPlaceholder"===n[f].type?e+=c:((l=n[f].value)!==D&&t.fillText(l,e,i),l=Q(t,t.font,l),o&&this.le(t,o,e,i,l,u,a),e+=l);return e},f.prototype.le=function(t,n,e,i,r,o,a){var u,s,c,f,l;t.strokeStyle!==t.fillStyle&&(t.strokeStyle=t.fillStyle),u=t.textAlign,c=s=0,f=.5,c=vt(((l=o<=12?12:o)-12)/21+1),t.lineWidth!==c&&(t.lineWidth=c),0==(1&c)&&(f=0),u===K?e-=r/2:u===J&&(e-=r),t.beginPath(),4==(4&n)&&(s=N(i+a-o-1)-f,t.moveTo(e,s),t.lineTo(e+r,s)),2==(2&n)&&(s=N(i+a-o/2)-f,t.moveTo(e,s),t.lineTo(e+r,s)),1==(1&n)&&(s=N(i+a-1)-f,t.moveTo(e,s),t.lineTo(e+r,s)),8==(8&n)&&(s=N(i+a-1)-f,t.moveTo(e,s-c),t.lineTo(e+r,s-c),t.moveTo(e,s+c),t.lineTo(e+r,s+c)),t.stroke()},f.prototype.Qe=function(t,n){var e=4==(4&n)?"overline":"";2==(2&n)&&(e+=" line-through"),1==(1&n)&&(e+=" underline"),t.css("text-decoration",e)},f.prototype.Ke=function(){return D},f.prototype.isImeAware=function(t){return!1},f.prototype.isEditing=function(){return!1},f.prototype.Je=function(t){},f.prototype.Xe=function(t,n,e,i,r){},f.prototype.qe=function(t,n,e,i,r){},f.prototype.cfe=function(t,n){return t},f.prototype.toJSON=function(){var t,n,e,t={},n=this;for(e in n)n.hasOwnProperty(e)&&(t[e]=n[e]);return t},f.prototype.fromJSON=function(t){if(t)for(var n in t)Y(t[n])||(this[n]=t[n])},e=f,t.Base=e,(0,lt.$e)(e),r.ti[0]=e,t.paintDecoration=Vt,t.paintStyleDecorationOutSideIcons=Wt},"./dist/core/celltype/cellType.entry.js":function(t,n,e){"use strict";var i,r,o,a,i=this&&this.__createBinding||(Object.create?function(t,n,e,i){void 0===i&&(i=e);var r=Object.getOwnPropertyDescriptor(n,e);r&&("get"in r?n.__esModule:!r.writable&&!r.configurable)||(r={enumerable:!0,get:function(){return n[e]}}),Object.defineProperty(t,i,r)}:function(t,n,e,i){t[i=void 0===i?e:i]=n[e]}),r=this&&this.__exportStar||function(t,n){for(var e in t)"default"===e||Object.prototype.hasOwnProperty.call(n,e)||i(n,t,e)};Object.defineProperty(n,"__esModule",{value:!0}),o=e("./dist/core/celltype/headercelltype.js"),a=e("./dist/core/celltype/textcelltype.js"),Object.defineProperty(n,"Corner",{set:function(t){t!==o.Corner&&(o.Corner=t)},get:function(){return o.Corner}}),Object.defineProperty(n,"ColumnHeader",{set:function(t){t!==o.ColumnHeader&&(o.ColumnHeader=t)},get:function(){return o.ColumnHeader}}),Object.defineProperty(n,"RowHeader",{set:function(t){t!==o.RowHeader&&(o.RowHeader=t)},get:function(){return o.RowHeader}}),Object.defineProperty(n,"Text",{set:function(t){t!==a.Text&&(a.Text=t)},get:function(){return a.Text}}),r(e("./dist/core/celltype/celltype.ns.js"),n),r(e("./dist/core/celltype/basecelltype.js"),n),r(e("./dist/core/celltype/textcelltype.js"),n),r(e("./dist/core/celltype/headercelltype.js"),n)},"./dist/core/celltype/celltype.ns.js":function(t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.ti=void 0,n.ti={}},"./dist/core/celltype/headercelltype.js":function(p,t,n){"use strict";var e,i,r,b,L,o,S,F,y,P,T,D,G,U,_,E,A,j,H,z,n,i,r,a,u,s,c;function d(t,n){return y.He(t=t||0,"gc-"+n+"-"+y.Ee(t))}function I(t,n,e,i,r,o){var a,o,a=new Image,o=o;o=(o=o.replace('url("',"")).replace('")',""),a.src=o,t.drawImage(a,n,e,i,r)}function v(t,n,e,i,r,o,a,u,s){var c,f,l,h,d,v,m,g,p,b,y,w,M;function C(){t.fillRect(n+1,e+1,i-1,r-1)}if(!U(u)){if(t.save(),t.beginPath(),c=o.backColor,0===u&&c)L.W.setFillStyle(t,c,n,e,i,r,C);else try{if(c=s&&s.backgroundColor,f=s&&s.backgroundImage,l=a.sheet,h=a.row,d=a.col,v=a.sheetArea,m=void 0,g=!1,l.cellStates&&u===F.VisualState.hover&&(m=l.cellStates.getStyle(h,d,v))&&m.backColor&&(c=m.backColor,g=!0),!g&&f&&-1!==f.indexOf("linear-gradient")){for(p=T(f),b={degree:90,stops:[]},y=0,w=p.length;y<w;y++)M=p[y],b.stops.push({position:M.point,color:M.color});L.W.setFillStyleGradient(t,b,n,e,i,r,C)}else c?(t.fillStyle=c,C()):f&&f!==A&&I(t,n+1,e+1,i-1,r-1,f)}catch(t){}2===a.columnHeaderFitMode&&(i=a.sheet.getColumnWidth(a.col)+1),S.Context.nt(t,n,e,i,r,o.backgroundImage,o.backgroundImageLayout,a.imageLoader),t.restore()}}function f(t,n,e,i,r,o,a,u,s,c,f,l){var h,h,c,h,f;n&&(v(n,i,r,o,a,u,s,h=s.visualState||0,h=d(h,c)),S.Context.cn(n,i,r,o,a,u,c,h,f,s.needTopGridline,s.needLeftGridline),c=new b.Rect(i,r,o,a),s.cellRect=c.clone(),t.Vn(n,s,c,e,u),(0,S.paintDecoration)(n,c,u,s),t.Tn&&(t.Tn(n,c,u,s),h=s.printZoomFactor,f=s.isPrinting&&"number"==typeof h&&1!==h?h:s.sheet.zoom(),c=t.An(c,u,f)),0<c.width)&&0<c.height&&t.paintContent(n,e,c.x,c.y,c.width,c.height,u,s,l)}function V(t,n,e,i,r,o){var n,e,o,n={font:n,fillStyle:e},e=i.sheet;return 0!==i.visualState&&2007<parseInt(o.zIndex,10)&&e.ni(i.row,i.col,r)&&(o=void 0,o=e.ei(i.row,i.col,r)?t(i.visualState,"gc-columnHeader-selected"):t(i.visualState,"gc-columnHeader-highlight"),n.fillStyle=o.color,n.font=L.W.ii(n.font,"bold")),n}function l(t,n,e,i,r,o,a,u,s,c,f,l){var h,d,v,m,g,p,m,l,m,l,m,v,h={},d=t.format(_(e),u.formatter,h),v=s.sheet;d&&(n.save(),n.beginPath(),m=v.rowFilter&&v.rowFilter(),g=s.columnHeaderFitMode,!(p=!!(m&&m.rn(s.row,s.col,c)&&m.filterButtonVisible(s.col)))&&!l||g!==F.ColumnHeaderFitMode.normal&&g!==F.ColumnHeaderFitMode.vertical||(U(s.cornerX)||(o=s.cornerX-i),o-=v.an(new b.Rect(i,r,o,a),c).width),(m=(m=u.foreColor)||f.color)&&n.fillStyle!==m&&(n.fillStyle=m),l=u.textOrientation,m=u.isVerticalText,l=0===g&&v.NMi&&0!==l&&!U(l)&&-90<=l&&l<=90&&!m,e&&e.richText&&0<e.richText.length||m?w(t,v,n,e,i,r,o,a,u,d,h,s,c,f):1===g||l?(m=V(t.getThemeStyle,u.font||n.font,n.fillStyle,s,c,f),u.foreColor=m.fillStyle,u.font=b.util.yt(m.font),1===g&&(u.textOrientation=-90),v=t.Pn(n,d,u,s,i,r,o,a),t.Kn(n,e,i,r,o,a,u,s,d,h,j,v.externals)):M(t,n,e,i,r,o,a,u,d,h,s,c,f),n.restore())}function w(t,n,e,i,r,o,a,u,s,c,f,l,h,d){var v,h,d,m,g,p,b,y,w,y,w,y,M,w,C,S,y,h,T,A,I,x,N,k,v=new z(r,o,a,u),h=V(t.getThemeStyle,s.font||e.font,e.fillStyle,l,h,d),d=s.isVerticalText,m=s.hAlign,g=R(s),p=t.Ft(s.formatter||s._autoFormatter,i.text),b=E(!0,[],t.Pt(i,c,p,h.font,h.fillStyle));if(i&&i.richText&&0<i.richText.length&&(y=l.sheet?l.sheet.zoom():1,w=l.printZoomFactor,w=l.isPrinting&&"number"==typeof w&&1!==w?w:j,t.te(b,h,y,w)),y=t.Pn(e,_(i),s,l,r,o,a,u),M=(w=t.Hn(y.externals.left))+(y=t.Hn(y.externals.right)),w={left:w,right:y},!s.wordWrap&&s.shrinkToFit&&t.ne(b,a-M,u,s,h,1,d),C=t.ee(e,c,s.font,d?u:a-M,g,d?s.vAlign:s.hAlign,s.wordWrap,d,b),S=t.re(C,s,m),O(e,s,r,o,a,u,g,C[0].textLength,S[0].lineHeight),y=d?D(c):j,h=!1,s.wordWrap||s.shrinkToFit||!s.showEllipsis||!d||i.richText||(h=!0),T=t.ae(v.x,v.y,v.width,v.height,m,s.vAlign,g,d,y,C,S,w,h),A=[],h&&f&&(f.content&&1===f.content.length&&"text"===f.content[0].type||!f.content&&1===C.length&&C[0].text)&&t.Xn(e,l,C,S,s,u,o,g,T,A),1===(I=C.length)&&f.content&&!p)t.ue(e,n,c,f,T[0].x,T[0].y,a,u,m,s,v.width,v.height,g,d,C[0].textLength,l,w,v);else for(x=0;x<I;x++)N=t.se(C),k=T[0].x,"center"===e.textAlign?k-=N/2:"right"===e.textAlign&&(k-=N),t.Zn(e,s,l,k,T[0].y,N,0,v),t.ce(e,n,T[x].x,T[x].y,S[x],m,C[x],A[x]),t.Zn(e,s,l,k,T[0].x,N,0,v)}function M(t,n,B,e,i,r,o,a,u,s,c,f,l){var h,d,f,v,l,m,g,l,p,b,y,w,y,M,C,d,S,d,w,y,p,T,A,I,x,N,k,D,_,p,E,M,j,f,y,l,o,O,R,h=new z(e,i,r,o),d=c.columnHeaderFitMode,f=V(t.getThemeStyle,a.font||n.font,n.fillStyle,c,f,l);if(G(n,f.font),n.fillStyle=f.fillStyle,(v=0)<(l=a.textIndent)&&(v=8*l),m=parseInt(c.fontInfo.fontSize,10),g=a.hAlign,l=a.vAlign,p="left",b=2,y=t.Pn(n,u,a,c,e,i,r,o),M=(w=t.Hn(y.externals.left))+(y=t.Hn(y.externals.right)),C={left:w,right:y},b+=v+w,1===(g=d!==F.ColumnHeaderFitMode.stack||U(c.cornerX)||(o=c.cornerY-i,(d=c.colStyle)&&!U(d.hAlign))?g:0)?(b=(r+w-y)/2,p="center"):2===g&&(b=r-y-1,b-=v,p="right"),n.textAlign!==p&&(n.textAlign=p),d="alphabetic",w=2,y=a.wordWrap,p=a.shrinkToFit,T=a.font,A=c.lineHeight,I=[],x=S=0,!y&&p)for(k={value:!1},D=N=0;D<3&&!1===k.value&&(_=n.measureText(u).width,(N=Math.max(0,r-4-(1===g?0:v)))<_);D++)T=L.W.V(T,N/_,k,!0).font,G(n,T);if(p=0,y&&(p=r-M-3-v,1<(x=(I=P.un(u,--p,f.font)).length))&&0!==l&&(S=(x-1)*A),M=A/2-m/2+(E=8<m?H((m-8)/5+2):1)-1,!y&&a.showEllipsis&&t.fe(c,s,u,n,r,g,v),w+=A-M,1===l?w=(o-S)/2+A/2-M:2===l&&(w=o-S-2-M),n.textBaseline!==d&&(n.textBaseline=d),j=a.textDecoration,f=h.x,y=h.y,l=h.width,o=h.height,a.wordWrap)if(n.rect(f,y,l,o),n.clip(),n.beginPath(),O=i+w,1<x){for(t.Zn(n,a,c,e+b,O,p,A*x,h),D=0;D<x;D++)n.fillText(I[D],e+b,O),j&&(_=n.measureText(I[D]).width,t.le(n,j,e+b,O,_,m,E)),O+=A;t.Zn(n,a,c,e+b,O,p,A*x,h)}else t.he(n,u,s,e+b,i+w,g,l,v,j,E,m,c,a,C,h);else(l<(R=n.measureText(u).width)||o<A)&&(n.rect(f,y,l,o),n.clip(),n.beginPath()),t.he(n,u,s,e+b,i+w,g,l,v,j,E,m,c,a,C,h,void 0,void 0,a.showEllipsis)}function O(t,n,e,i,r,o,a,u,s){var c=!1,c;(c=!!n.wordWrap||(n.isVerticalText?o<u+a||r<s:r<u+a||o<s))&&(t.rect(e,i,r,o),t.clip(),t.beginPath())}function R(t){var n=0,t=t.textIndent;return n=0<t?8*t:n}function h(){var t=u.call(this)||this;return t.typeName="2",t}function m(){var t=s.call(this)||this;return t.typeName="3",t}function g(){var t=c.call(this)||this;return t.typeName="4",t}e=this&&this.__extends||(a=function(t,n){return(a=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(t,n){t.__proto__=n}:function(t,n){for(var e in n)Object.prototype.hasOwnProperty.call(n,e)&&(t[e]=n[e])}))(t,n)},function(t,n){if("function"!=typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function e(){this.constructor=t}a(t,n),t.prototype=null===n?Object.create(n):(e.prototype=n.prototype,new e)}),Object.defineProperty(t,"__esModule",{value:!0}),t.RowHeader=t.ColumnHeader=t.Corner=void 0,i=n("Common"),r=n("./dist/core/util/domUtil.js"),b=n("./dist/core/util/common.js"),L=n("./dist/core/worksheet/stylehelper.js"),o=n("./dist/core/celltype/celltype.ns.js"),S=n("./dist/core/celltype/basecelltype.js"),F=n("./dist/core/core.enum.js"),y=b.I,P=b.q,T=b.mt.ri,D=b.mt.pt,G=b.mt.bt,U=i.Common.lt.ht,_=b.mt.wt,E=r.GC$.extend,A="none",j=void 0,H=Math.floor,z=b.Rect,u=S.Base,e(h,u),h.prototype.paint=function(t,n,e,i,r,o,a,u,s){f(this,t,n,e,i,r,o,a,u,"columnHeader",1,s)},h.prototype.paintContent=function(t,n,e,i,r,o,a,u,s){var c,f,c;S.Context.dn(t,_(n),e,i,r,o,u)||l(this,t,n,e,i,r,o,a,u,1,f=d(u.visualState,"columnHeader"),s)},t.ColumnHeader=n=h,o.ti[2]=n,s=S.Base,e(m,s),m.prototype.paint=function(t,n,e,i,r,o,a,u){f(this,t,n,e,i,r,o,a,u,"rowHeader",2)},m.prototype.paintContent=function(t,n,e,i,r,o,a,u){var s,c,s;S.Context.dn(t,_(n),e,i,r,o,u)||l(this,t,n,e,i,r,o,a,u,2,c=d(u.visualState,"rowHeader"))},t.RowHeader=i=m,o.ti[3]=i,c=S.Base,e(g,c),g.prototype.paint=function(t,n,e,i,r,o,a,u){var s,c,f,l,h,f,l,h,d,v,m,g,p,s,c,b,l;if(t){t.save(),t.rect(e,i,r,o),t.clip(),t.beginPath(),s=this,c=u.visualState||0;try{l=(f=s.getThemeStyle(u.visualState,"gc-corner-"+y.Ee(c)))&&f.backgroundColor,h=f&&f.backgroundImage,l?(t.fillStyle=l,t.fillRect(e,i,r,o)):h&&h!==A&&I(t,e,i,r,o,h)}catch(t){}if(l=(f=s.getThemeStyle(4,"gc-corner-triangle-"+y.Ee(c)))&&f.backgroundImage,h=f&&f.backgroundColor,d=t.createLinearGradient(e+r/2,i,e+r/2,i+o),l&&-1!==l.indexOf("linear-gradient")){for(m=0,g=(v=T(l)).length;m<g;m++)p=v[m],d.addColorStop(p.point,p.color);t.fillStyle=d}else h&&(d.addColorStop(.125,"#f6fafb"),d.addColorStop(1,h),t.fillStyle=d);(s=t.createLinearGradient(e+r,i+1,e+r,i+o-2)).addColorStop(0,f.borderLeftColor),s.addColorStop(1,f.borderRightColor),t.beginPath(),t.strokeStyle=s,t.moveTo(e+r-.5,i),t.lineTo(e+r-.5,i+o),t.stroke(),u.needLeftGridline&&(t.beginPath(),t.strokeStyle=f.borderLeftColor,t.moveTo(e+.5,i),t.lineTo(e+.5,i+o),t.stroke()),(c=t.createLinearGradient(e,i,e+r-2,i)).addColorStop(0,f.borderTopColor),c.addColorStop(1,f.borderBottomColor),t.beginPath(),t.strokeStyle=c,t.moveTo(e,i+o-.5),t.lineTo(e+r,i+o-.5),t.stroke(),u.needTopGridline&&(t.beginPath(),t.strokeStyle=f.borderTopColor,t.moveTo(e,i+.5),t.lineTo(e+r,i+.5),t.stroke()),t.beginPath(),t.moveTo(e+r-(l=r<(l=o)?r:o)+(b=3),i+o-3),t.lineTo(e+r-3,i+o-3),t.lineTo(e+r-3,i+o-l+3),t.fill(),t.restore()}},t.Corner=r=g,o.ti[4]=r},"./dist/core/celltype/textcelltype.js":function(o,t,n){"use strict";var a,u,d,j,e,v,O,A,R,n,k,B,J,D,g,i,s,_,p,c,L,E,K,w,X,b,y,f,q,$,tt,nt,et,it,rt,F,ot,at,ut,M,P,C,S,G,U,st,H,z,V,ct,Y,ft,lt,ht,dt,vt,T,I,mt,gt,pt,x,N,bt,yt,wt,Mt,Ct,St,Z,Tt,h,At,It,xt,Nt,kt,u,Dt,n,l;function _t(t){return pt||0===t}function Et(t){return _t(t)?(0,j.GC$)(p("textarea")):(0,j.GC$)(p("div"))}function W(t){return t&&"DIV"===t.tagName&&"true"===t.contentEditable}function Q(t){return W(t)?L&&parseFloat(c.version)<10?i.oi(t):t.innerText:t.value}function jt(t,n){W(t)?t.innerText=B(n)?"":n:t.value=n}function Ot(t){var n;W(t)?((n=T.getSelection()).selectAllChildren(t),0<n.rangeCount&&n.collapseToEnd()):t.selectionStart=t.selectionEnd=t.value.length}function Rt(t){var n,e;return W(t)?0<(n=T.getSelection()).rangeCount?(e=n.getRangeAt(0)).startOffset:0:t.selectionStart}function Bt(t){var n,e;return W(t)?0<(n=T.getSelection()).rangeCount?(e=n.getRangeAt(0)).endOffset:0:t.selectionEnd}function Lt(t){var n,t,e,i,r,o,n=t.keyCode,t=t.shiftKey,e={106:42,107:43,109:45,110:46,111:47,173:45},i={186:59,187:61,188:44,189:45,190:46,191:47,192:96,219:91,220:92,221:93,222:39},r={186:58,187:43,188:60,189:95,190:62,191:63,192:126,219:123,220:124,221:125,222:34},o=n;return 96<=n&&n<=105?o=n-48:e[n]?o=e[n]:t&&r[n]?o=r[n]:!t&&i[n]?o=i[n]:!t&&65<=n&&n<=90&&(o=n+32),o}function Ft(t){return t&&"BR"===t.tagName}function Pt(t){return t&&"SPAN"===t.tagName}function Gt(t){return t&&"DIV"===t.tagName}function m(t){return t instanceof Text}function Ut(t){return t===h}function Ht(t,n,e,i){var r,o,r,o;return t.substr(0,n)+i+t.substr(e,t.length-e)}function zt(t,n,e,i,r,o){for(var a,u,s,c,f,l,h,d,a="",u=t.childNodes,s=u.length,c=0;c<s;c++)Pt(f=u[c])?a+=zt(f,n,e,i,r,o):m(f)?(l=n&&n.startContainer,h=n&&n.endContainer,d=f.textContent,f===l||f===h?l!==h?o=f===l?(a+=Ht(d,e,d.length,r),!0):(a+=Ht(d,0,i,""),!1):a+=Ht(d,e,i,r):o||(a+=d)):Ft(f)&&!o&&(a+="\n");return a}function Vt(t,n,e,i,r){var r,o,a,r=String.fromCharCode(Lt(r));return W(t)?0<(o=T.getSelection()).rangeCount&&m((a=o.getRangeAt(0)).startContainer)?zt(t,a,e,i,r):a&&a.startOffset===a.endOffset?n+r:r:Ht(n,e,i,r)}function Yt(t){var t=Jt(t);return t=t&&0<=t.indexOf(" ")?nt(t," ",Tt):t}function Zt(t,n,e,i,r,o){var a,u,s,e,c,f,l,f,c,l,e,f,a=t.srcElement||t.target;a&&a.getAttribute(M)===S&&13===t.keyCode&&(t.ctrlKey||t.altKey)&&((u=g.ai())instanceof d.Worksheet&&(s=u.getCellType(u.ui,u.ci))&&(W(a)?(e&&(a.blur(),a.focus()),0<(e=T.getSelection()).rangeCount&&(c=e.getRangeAt(0),f=I.createElement("br"),l=I.createTextNode(h),c.insertNode(l),c.insertNode(f),Wt(c),(f=I.createRange()).setStartAfter(l),f.setEndAfter(l),f.collapse(!1),e.removeAllRanges(),e.addRange(f))):(c=a.selectionStart,e=(l=a.value).substr(0,c),f=l.substr(c,l.length-c),a.value=e+"\n"+f,a.selectionStart=c+1,a.selectionEnd=c+1),s.fi(u.li,x,x,t,n,!0)),w(t))}function Wt(t){var t,n,e,t=t.endContainer,n=t.lastChild;m(n)&&0===n.textContent.length&&t.removeChild(n),e=(n=t.lastChild).previousSibling,Ut(n.textContent)&&!Ft(e)&&0===e.textContent.length&&t.removeChild(e)}function Qt(t){var n,t,n=t;return n&&(n.indexOf(h)<0&&n.indexOf("\n")<0?n:((t=t.split("\n")).forEach(function(t,n,e){Ut(t[0])&&(e[n]=t.substr(1))}),t.join("\n")))}function Jt(t){var t,n,t=t;return t=t&&0<(n=t.length)?t.replace(/\n/g,"\n"+h):t}function Kt(t){var n,e,i,r,o,n,a,u,s,n,c,f,l,h,d,n=T.getSelection(),e=!1,i=0,r=0,o="";if(0<n.rangeCount){if(n=n.getRangeAt(0),a=Rt(t),u=Bt(t),s=n.startContainer,n=n.endContainer,Gt(s))e=!0,i=a;else if(l=void 0,0<(f=(c=s.childNodes).length))for(l=0;l<f;l++){if(!(h=c[l]).tagName||"br"!==h.tagName.toLocaleLowerCase()){s=h;break}o+="\n"}return o+(d=Xt(t,a,u,s,n,e,i,r=Gt(n)?u:r)).content}}function Xt(t,n,e,i,r,o,a,u){var s,c,f,l,h,d,v;if(i===r&&!o)return{content:Qt(i.textContent.slice(n,e))};for(s="",c=a,h=t.childNodes,d=u||h.length;c<d;c++)if(Pt(v=h[c])){if(s+=(f=Xt(v,n,e,i,r,o,0,0)).content,f.startFlag&&(o=!0),f.endFlag){l=!0;break}}else if(m(v)&&v===i)s+=v.textContent.slice(n,v.textContent.length),o=!0;else{if(m(v)&&v===r){s+=v.textContent.slice(0,e),l=!0;break}o&&(Ft(v)?s+="\n":s+=v.innerText||v.textContent)}return{content:Qt(s),startFlag:o,endFlag:l}}function qt(t,n){for(var e,i,r,e=t.length,i=[],r=0;r<e;r++)i.push($(t[r],n));return i}function $t(t){for(var n,e,i,n=t.length,e=0,i=0;i<n;i++)e+=t[i];return e}function tn(t,n,e,i){for(var r,o,a,u,r=0,o=e,a=0;a<t.length;a++)K&&(o=i[a]),t[a]>n?r+=o*(u=bt(t[a]/n)):r+=o;return r}function nn(t,n,e){var t=Q(t);return t&&"="===t[0]||""===t&&"="===n[0]||0===e&&"="===n[0]}function en(t){var t=t&&t.tagName;return"TEXTAREA"===t||"INPUT"===t}function rn(t){return(t.ctrlKey||t.metaKey)&&t.keyCode===(t.shiftKey?It:At)}function on(t){return(t.ctrlKey||t.metaKey)&&t.keyCode===(t.shiftKey?At:It)}function r(t){var n=l.call(this)||this;return n.allowOverflow=!0,n.typeName="1",n.editorType=B(t)?1:t,n}function an(t){var n,t,e,i,r,n=["0","0","0","0"];return typeof t===xt&&(r=i=void 0,1===(e=(t=t.split(" ",4)).length)?n=[i=t[0],i,i,i]:2===e?n=[i=t[0],r=t[1],i,r]:3===e?(r=t[1],n=[t[0],r,t[2],r]):4===e&&(n=[t[0],t[1],t[2],t[3]])),n}a=this&&this.__extends||(Dt=function(t,n){return(Dt=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(t,n){t.__proto__=n}:function(t,n){for(var e in n)Object.prototype.hasOwnProperty.call(n,e)&&(t[e]=n[e])}))(t,n)},function(t,n){if("function"!=typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function e(){this.constructor=t}Dt(t,n),t.prototype=null===n?Object.create(n):(e.prototype=n.prototype,new e)}),Object.defineProperty(t,"__esModule",{value:!0}),t.Text=t.EditorType=void 0,u=n("Common"),d=n("./dist/core/worksheet/worksheet.js"),j=n("./dist/core/util/domUtil.js"),e=n("./dist/core/util/common.js"),v=n("./dist/core/celltype/celltype.ns.js"),O=n("./dist/core/celltype/basecelltype.js"),A=n("./dist/core/core.enum.js"),R=n("./dist/core/util/common.js"),n=n("CalcEngine"),k=!!n,B=u.Common.lt.ht,J=e.q,D=e.Events.EditChange,g=e.hi,i=e.mt,s=e.di,_=i.St,p=i.En,c=i.Tt,L=c.msie,E=c.edge,K=c.chrome,w=i.vi,X=i.gt,b=i.mi,y=i.gi,f=i.pi(),q=i.vt,$=i.bi,tt=i.Mt,nt=i.yi,et=i.yt,it=i.wt,rt=i.Ct,F="left",ot="right",at="center",ut="top",M="gcUIElement",P="none",C=".gcEditingInput",S="gcEditingInput",G="width",U="height",st="text-align",H="hidden",z="word-wrap",V="overflow",ct="vertical-align",Y="normal",ft="break-word",lt="overflow-y",ht="scroll",dt="word-break",vt="float",T=window,I=document,mt=.337,gt=f.ipad,pt=f.iphone||gt||f.android,x=null,N=void 0,bt=Math.ceil,yt=Math.min,wt=Math.sin,Mt=Math.cos,Ct=Math.abs,St=Math.max,Z=parseInt,Tt="\xa0",h="\u200b",At=90,It=89,xt="string",Nt="number",(n=kt=t.EditorType||(t.EditorType={}))[n.textarea=0]="textarea",n[n.editableDiv=1]="editableDiv",l=O.Base,a(r,l),r.prototype.getText=function(t,n){return t},r.prototype.paintValue=function(t,n,e,i,r,o,a,u){var s,c,f,l,h,d,v,m,g,p,b,y,p,g,w,p,M,C,M,S,C,T,p,v,M,s=this,c=u.sheet,f=c.zoom?c.zoom():1;if(n=s.getText(n,u),l={},u.quotePrefix=a.quotePrefix,v=(d=a.formatter)&&"General"!==d,m=_(d),"string"==typeof d&&(v=v&&!m),g=a.textOrientation,p=a.textIndent&&0!==a.textIndent,b=a.isVerticalText,y=r,g&&-90<=g&&g<=90&&!p&&!b&&(p=Ct(g*Math.PI/180),y=(o-u.lineHeight*Mt(p))/wt(p)),g=(w=s.Pn(t,h,a,u,e,i,r,o)).externals,p=s.Hn(g.left),M=s.Hn(g.right),2===(C=3===(C=a.hAlign)?X(C,n,a.formatter||a._autoFormatter):C)?y-=M:0===C&&(y-=p),M=a._autoFormatter&&a._autoFormatter.formatCached&&"General"!==a._autoFormatter.formatCached,v?S=a.formatter:M?S=a._autoFormatter:c.parent&&c.parent.options.numbersFitMode===A.NumbersFitMode.mask?S=O.Context.Nt(t,n,y,a,f):c.parent&&c.parent.options.numbersFitMode===A.NumbersFitMode.overflow&&(S=a._autoFormatter),h=m&&(n instanceof Date||"boolean"==typeof n||n instanceof Boolean||"number"==typeof n)?s.format(n,d,{}):s.format(it(n),S,l,u),C=new R.Rect(e,i,r,o),this.adjustRectForIconSet(a.hAlign,u.sheet,u.row,u.col,u.sheetArea,C,l.content&&this.hasInfilling(l.content)),e=C.x,r=C.width,!0!==a.shrinkToFit&&!b)if(rt(n)){if(c.parent){switch(T=h,c.parent.options.numbersFitMode){case A.NumbersFitMode.mask:T=this.wi(t,h,y,a,f,u,l,c);break;case A.NumbersFitMode.overflow:T=this.Mi(t,u,n,a,c,h,l)}h=T}}else void 0===c.Ut.Ci(u.row,u.col,u.sheetArea)||a.showEllipsis||c.Ut.$n(u.row,u.col,void 0,u.sheetArea);p=a.labelOptions,v=a.watermark,M=!p||0!==p.visibility,v&&!h&&M?s.paintText(t,v,e,i,r,o,a,u,v,l,mt):(h||l.content&&l.content.length)&&s.paintText(t,n,e,i,r,o,a,u,h,l,N,g)},r.prototype.wi=function(t,n,e,i,r,o,a,u){var s,t,e,s,s=o.cellOverflowLayout&&o.cellOverflowLayout.expandedWidth,t=O.Context.Et(t,n,B(s)?e:s,i,r),e=o.row,s=o.col;return n!==t?(delete a.content,i.textIndent=0,u.Ut.$n(e,s,u.getText(e,s,o.sheetArea),o.sheetArea)):u.Ut.$n(e,s,void 0,o.sheetArea),t},r.prototype.Mi=function(t,n,e,i,r,o,a){var u,s,t,c,f,l,h,u=n.row,s=n.col;if(i.wordWrap&&(i.wordWrap=!1),t=tt(t,i.font,o),c=r.Jt.Kt(s),l=void 0,!(f=n.cellOverflowLayout)&&c<t)l=r.getText(u,s,n.sheetArea);else if(f&&c<t&&this.Si(f.backgroundWidth)&&this.Si(f.valueWidth)){if(!this.Si(i.hAlign))return;h=void 0,l=(h=1!==i.hAlign?f.valueWidth>f.backgroundWidth:f.valueWidth/2>f.backgroundLeftWidth||f.valueWidth/2>f.backgroundRightWidth)?r.getText(u,s,n.sheetArea):void 0}return r.Ut.$n(u,s,l,n.sheetArea),o},r.prototype.Si=function(t){return null!=t},r.prototype.createEditorElement=function(t,n){var t,t,n,e,t=t&&t.sheet&&t.sheet.parent&&t.sheet.parent.Ti,t=y(t)+1e3;return(0,j.GC$)(n).css("z-index",t),n=Et(this.editorType),(0,j.GC$)(n).css({font:"normal 11pt calibri",outline:P,resize:P,border:P,"vertical-align":"top","min-height":"0px","box-sizing":"content-box",background:"transparent"}).css(z,Y).attr({tabindex:-1,autocomplete:"off",contenteditable:!0}).css(V,H).attr(M,S),c.safari&&(0,j.GC$)(n).css("-webkit-user-select","auto"),(e=W((0,j.GC$)(n)[0]))&&((0,j.GC$)(n).css("display","table-cell"),(0,j.GC$)(n).css(dt,Y)),(0,j.GC$)(n)[0]},r.prototype.getEditorValue=function(t,n){var e,i,n,t;return t&&(e=Q(t),i=!B(e)&&0<e.length,O.Base.et(n&&n.sheet,"getEditorValue",n={editor:t,ns:C,editorValue:e}),i)?(t=(t=Qt(e=n.editorValue)).replace(/\r\n?/g,"\n")).indexOf(Tt)<0?t:nt(t,Tt," "):x},r.prototype.setEditorValue=function(t,n,e,i,r){var o,a,n,a;t&&(a=o=void 0,e&&e.sheet&&(o=e.sheet.Ai,a=e.sheet.getValue(e.row,e.col)),n=Yt(n),O.Base.et(e&&e.sheet,"setEditorValue",a={editor:t,ns:C,editorValue:n,originValue:a,startEditByKeydown:o,addPercent:i||r,cancel:!1}),!0===a.cancel?(jt(t,a.editorValue),this.qmt(t,a.caret)):L?o&&e.isImeInput||jt(t,n=B(n)?i?"%":"":n):jt(t,n=o?i?"%":"":n))},r.prototype.selectAll=function(t,n){var e;t&&t.select?t.select():T.getSelection().selectAllChildren(t)},r.prototype.focus=function(t,n){var e,i,t,n,e=this;e.isImeAware()&&t?Ot(i=t):i=t.parentNode.parentNode,i.focus(),t=e.Xmt(i),O.Base.et(n&&n.sheet,"afterSetEditorFocus",n={editor:i,caret:t,cancel:!1}),!0===n.cancel&&n.caret&&e.qmt(i,n.caret)},r.prototype.je=function(t,n,e,i){var r,o,n,r=t&&i&&i.sheet,o={},n=b(n,e,r,i,o);return t.Ii=o.formatter||N,n},r.prototype.Xmt=function(t){var n,e,i,r,o,r;return t&&(n=I.activeElement===t)?(i=e=-1,o=r=void 0,en(t)?(e=t.selectionStart,i=t.selectionEnd):W(t)&&0<(r=T.getSelection()).rangeCount&&((r=(o=r.getRangeAt(0)).cloneRange()).selectNodeContents(t),r.setEnd(o.endContainer,o.endOffset),i=r.toString().length,(r=o.cloneRange()).selectNodeContents(t),r.setEnd(o.startContainer,o.startOffset),e=r.toString().length,r.detach()),{start:e,end:i,length:i-e}):null},r.prototype.qmt=function(t,n){var e,i,r,o,a,u,e=n.start,i=n.end,r=document.createRange(),o=window.getSelection();if(t.childNodes[0]){if((a=t.childNodes[0].textContent.length)<e){for(u=0;t.childNodes[u]&&0<=e;)e-=t.childNodes[u].textContent.length,u++;r.setStart(t.childNodes[u-1],e+t.childNodes[u-1].textContent.length)}else r.setStart(t.childNodes[0],e);if(a<(i=i>n.start?i-1:i)){for(u=0;t.childNodes[u]&&0<=i;)i-=t.childNodes[u].textContent.length,u++;r.setEnd(t.childNodes[u-1],i+t.childNodes[u-1].textContent.length)}else r.setEnd(t.childNodes[0],i);r.collapse(!0),o.removeAllRanges(),o.addRange(r)}},r.prototype.activateEditor=function(n,l,h,d,v,m,g){var p,b,y,n,o,n,t,e,i,r,a,u,e,p=d&&d.sheet;if(p&&(b=this,y=n)){if(n=(0,j.GC$)(y),o=W(y),b._editingElement=y,n.attr(M)||n.attr(M,S),f.android&&n.bind("input"+C,function(t){try{b.fi(y,l,h,t,d,!1,v,m,g)}catch(t){}}),n.bind("keydown"+C,function(t){var n,e,i;try{n=t.keyCode,o&&(e={event:t,editor:y,value:y.innerText,caret:b.Xmt(y),cancel:!1},8===n?(O.Base.et(p,"editorBackspace",e),!0===e.cancel?(w(t),y.innerText=e.value,b.qmt(y,e.caret),p.ki(R.Events.FormulaTextBoxTextChanged,{sheet:p,sheetName:p.name(),text:e.value})):s.processBackspaceAndLeftArrowKeyEvent(t,!0)):46===n?(O.Base.et(p,"editorDelete",e),!0===e.cancel?(w(t),y.innerText=e.value,b.qmt(y,e.caret),p.ki(R.Events.FormulaTextBoxTextChanged,{sheet:p,sheetName:p.name(),text:e.value})):s.processDeleteAndRightArrowKeyEvent(t,!0)):37===n?s.processBackspaceAndLeftArrowKeyEvent(t,!1):39===n&&s.processDeleteAndRightArrowKeyEvent(t,!1),rn(t)?(O.Base.et(p,"editorUndo",e),!0===e.cancel&&(w(t),y.innerText=e.value,b.qmt(y,e.caret),p.ki(R.Events.FormulaTextBoxTextChanged,{sheet:p,sheetName:p.name(),text:e.value}))):on(t)&&(O.Base.et(p,"editorRedo",e),!0===e.cancel)&&(w(t),y.innerText=e.value,b.qmt(y,e.caret),p.ki(R.Events.FormulaTextBoxTextChanged,{sheet:p,sheetName:p.name(),text:e.value}))),((i=229===n||0===n)||b.Ni)&&!f.android||b.fi(y,l,h,t,d,!0,v,m,g),Zt(t,d,b.Ni,v,m,g)}catch(t){}}),n.bind("keyup"+C,function(t){var n,e,i,r,n=t.keyCode,e=t.ctrlKey,i=t.altKey,r;(!(229===n||0===n)&&!b.Ni||f.android)&&(46!==n&&8!==n&&(90!==n&&89!==n||!e||i)||(o&&"\n"===y.innerText&&(0,j.GC$)(y).empty(),b.fi(y,l,h,t,d,!1,v,m,g)),13!==n&&9!==n&&27!==n&&16!==n||e||i)&&p.ki(D,{sheet:p,sheetName:p.name(),row:p.ui,col:p.ci,editingText:b.getEditorValue(y,d)})}),n.bind("mousedown"+C,function(){1===p.Di&&(p.Di=2,p._i(1,2))}),n.bind("textInput"+C,function(t){var n,n,e,e;if(c.safari){if(t.metaKey||t.altKey||t.ctrlKey||"Enter"===t.key)return;n=t.key||t.data,n={editor:y,value:n,caret:b.Xmt(y),cancel:!1},O.Base.et(p,"editorInput",n),!0===n.cancel&&(w(t),y.innerText=n.value,e=p.getCellType(d.row,d.col),y.parentNode&&y.parentNode.parentNode&&e&&e.Rn(y.parentNode.parentNode,l,p.getCellRect(d.row,d.col),d),b.qmt(y,n.caret),p.ki(R.Events.FormulaTextBoxTextChanged,{sheet:p,sheetName:p.name(),text:n.value}))}t.data&&(b.probabilityAddPercentSpec||b.probabilityAddPercent)&&/^[0-9]+.?[0-9]*/.test(t.data)&&((e=document.createElement("span")).innerText="%",e.id="updateEditorImpAddPercent",("#text"===y.firstChild.nodeName?y:y.firstChild).appendChild(e),delete b.probabilityAddPercentSpec,delete b.probabilityAddPercent)}),n.bind("compositionstart"+C,function(){b.Ni=!0,b.Ei=Q(y)}),n.bind("compositionupdate"+C,function(t){b.fi(y,l,h,t||x,d,!0,v,m,g)}),n.bind("compositionend"+C,function(t){var n,n,e,e,n,t,i,n=t.data,n={editor:y,value:n,caret:b.Xmt(y),isImeInputting:!0,cancel:!1};O.Base.et(p,"editorInput",n),!0===n.cancel&&(w(t),y.innerText=n.value,e=p.getCellType(d.row,d.col),y.parentNode&&y.parentNode.parentNode&&e&&e.Rn(y.parentNode.parentNode,l,p.getCellRect(d.row,d.col),d),b.qmt(y,n.caret),p.ki(R.Events.FormulaTextBoxTextChanged,{sheet:p,sheetName:p.name(),text:n.value})),b.fi(y,l,h,t||x,d,!1,v,m,g),b.Ni=!1,e=t.keyCode,n=t.ctrlKey,t=t.altKey,i=b.getEditorValue(y,d)||"",b.Ei!==i&&(e===N||13!==e&&9!==e||n||t)&&p.ki(D,{sheet:p,sheetName:p.name(),row:p.ui,col:p.ci,editingText:i})}),o&&(n.bind("copy"+C,function(t){var n=T.clipboardData,e=t.clipboardData,i=Kt(t.currentTarget);B(i)||(n&&n.setData?(n.setData("text",i),w(t)):e&&e.setData&&(e.setData("text/plain",i),w(t)))}),n.bind("cut"+C,function(t){var n,n,e,i,r,r,n=Kt(t.currentTarget),e="editorCut";!B(n)&&y.jse&&(T.clipboardData&&T.clipboardData.setData?(i="text",r=T.clipboardData):t.clipboardData&&t.clipboardData.setData&&(i="text/plain",r=t.clipboardData),n={editor:y,clipboardData:r,dataName:i,caret:b.Xmt(y)},O.Base.et(p,e,n),w(t),y.innerText=n.value,r=p.getCellType(d.row,d.col),y.parentNode&&y.parentNode.parentNode&&r&&r.Rn(y.parentNode.parentNode,l,p.getCellRect(d.row,d.col),d),b.qmt(y,n.caret))}),n.bind("paste"+C,function(t){var n,e,i,r,o,a,u,s,c,f,n=!1;try{e=void 0,L&&!E&&T.clipboardData&&T.clipboardData.getData?e=T.clipboardData.getData("text"):t.clipboardData&&t.clipboardData.getData&&(e=t.clipboardData.getData("text/plain")),e=Yt(e=e.replace(/\r\n?/g,"\n")),i={editor:y,pasteValue:e,caret:b.Xmt(y),cancel:!1},O.Base.et(p,"editorPaste",i),!0===i.cancel?(n=!0,y.innerText=i.pasteValue,b.qmt(y,i.caret),p.ki(R.Events.FormulaTextBoxTextChanged,{sheet:p,sheetName:p.name(),text:i.pasteValue})):0<(r=T.getSelection()).rangeCount&&((a=(o=r.getRangeAt(0)).startOffset)!==(u=o.endOffset)&&o.deleteContents(),nn(y,e,a)||(s=I.createElement("span"),"\n"===(e=e.replace(/\u200B/g,""))[(c=e.length)-1]&&(e="\r"===e[c-2]?e.substr(0,c-2):e.substr(0,c-1)),s.innerText=e,o.insertNode(s),(f=document.createRange()).setStartAfter(s),f.setEndAfter(s),f.collapse(!1),r.removeAllRanges(),r.addRange(f),n=!0))}catch(t){}if(b.ji=T.setTimeout(function(){b.fi(y,l,h,t,d,!1,v,m,g),p.parent&&p.parent.ki(R.Events.FormulaTextBoxUpdatePosition,void 0),b.ji&&(clearTimeout(b.ji),delete b.ji)},10),n)return!1}),n.bind("keypress"+C,function(t){var n,n,t;t.metaKey||t.altKey||t.ctrlKey||"Enter"===t.key||(n=t.key||t.data,n={editor:y,value:n,caret:b.Xmt(y),cancel:!1},O.Base.et(p,"editorInput",n),!0===n.cancel&&(w(t),y.innerText=n.value,t=p.getCellType(d.row,d.col),y.parentNode&&y.parentNode.parentNode&&t&&t.Rn(y.parentNode.parentNode,l,p.getCellRect(d.row,d.col),d),b.qmt(y,n.caret),p.ki(R.Events.FormulaTextBoxTextChanged,{sheet:p,sheetName:p.name(),text:n.value})))})),t=n=void 0,(n=!d||(t=k&&p.getFormula(d.row,d.col))?n:l.mask)&&n.pattern&&"="===n.pattern[0]){e=p.Lp,i=p.Uw(3),r=0<=d.row?d.row:0,a=0<=d.col?d.col:0;try{u=e.evaluate(i,n.pattern,r,a),n.pattern="object"==typeof u?"":""+u}catch(t){n.pattern=""}}e={editor:y,ns:C,mask:n,text:Q(y)},O.Base.et(p,"activateEditor",e)}},r.prototype.deactivateEditor=function(t,n){var e,i,r,o,a,u,s,c,f,l,e=this;if(O.Base.et(n&&n.sheet,"deactivateEditor",{editor:t}),t&&n&&n.sheet){if(i=n.sheet,e.Ni&&gt&&i.Oi)try{(0,j.GC$)(t).trigger("compositionend"+C)}catch(t){}if(r=i.getActualStyle(n.row,n.col,n.sheetArea).cellPadding)for(o=[F,ut],a=[3,0],u=0;u<o.length;u++)s=parseInt(an(r)[a[u]],10),e.shiftPadding(t,o[u],s=typeof s==Nt&&0<s?s:0);(0,j.GC$)(t).unbind(C),c=i.getActiveRowIndex(),f=i.getActiveColumnIndex(),l=i.getActualStyle(c,f),i.Ri(e,t,c,f,l,N,N,N,N,n.sheetArea)}e._editingElement=x},r.prototype.shiftPadding=function(t,n,e){var t=(0,j.GC$)(t).parent();t&&(n===F?t.css({left:(+(0,j.GC$)(t).css(F).replace("px","")||0)-e}):n===ut&&t.css({top:(+(0,j.GC$)(t).css(ut).replace("px","")||0)-e}))},r.prototype.getEditingElement=function(){return this._editingElement},r.prototype.Bi=function(t,n,e,i,r,o,a,u,s){var c,f,l,h,d,v,r,m,g,p,b,y,w,M,C,S,T,A,w,A,t,b,a,b,l,t,e,I,v,e,x,N,k,D,v,I,_,E,e,a,b,m,f,i,c=r&&r.sheet,f=this,l=c.options.sheetAreaOffset,h=t;if(h&&c&&(d=(0,j.GC$)(h),v=c.Dn,r=r.preventOverflow,m=Q(h),c.isEditing())){if(g=W(h),b=F,y=p=void 0,w=O.Context.gn,T=S=C=M=0,n&&(M=w(n,0,!1,A=c.zoom()),C=w(n,1,!1,A),S=w(n,2,!1,A),T=w(n,3,!1,A),1===(p=X(n.hAlign,t.Li))?b=at:2===p&&(b=ot),d.css(st,b),n.foreColor&&d.css("color",n.foreColor),(y=n.font||v.Nn())&&(1<c.zoom()&&(y=v._n(y)),d.css("font",et(y))),n.textDecoration)&&f.Qe(d,n.textDecoration),w=(Z(d.css("padding-left"),10)||0)+(Z(d.css("padding-right"),10)||0),A=(Z(d.css("padding-top"),10)||0)+(Z(d.css("padding-bottom"),10)||0),e||(w+=2*Number(d.parent().css("left").replace("px","")),A+=2*Number(d.parent().css("top").replace("px",""))),(a=B(a)?e:a)&&(t=c.Fi(),b=e.width,a.x+a.width-l.left>t.width&&(e.width=t.width-e.x,a.width=t.width-a.x),d.css(G,b-w).css(U,e.height-A),h.maxWidth=l.left+t.width-e.x-w-C,d.css("max-width",h.maxWidth+"px"),h.maxHeight=l.top+t.height-e.y-A-S,h.minWidth=Z(h.style.width,10),h.minHeight=Z(h.style.height,10)),a=Rt(h),b=Bt(h),l=(o=(o=o&&i&&i.keyCode&&c.rt.Pi(i)&&0===a&&b===m.length)||c.Ai)&&!n.mask?"":m,y=(y=h.style.font)||v._n(v.Nn()),t=q(y),i&&f.probabilityAddPercent&&(e=i.key)&&-1!==R.NUMBER_ARRAY.indexOf(e)&&(c.parent.options.enableFormulaTextbox?(v=h.innerText,/[a-z]/i.test(v)?f.probabilityAddPercent=!1:((I=document.createElement("span")).innerText="%",I.id="updateEditorImpAddPercent",h.appendChild(I),delete f.probabilityAddPercent)):((I=document.createElement("span")).innerText="%",I.id="updateEditorImpAddPercent",h.firstChild.appendChild(I),delete f.probabilityAddPercent)),!o&&i&&(e=c.parent,c.rt.Pi(i)&&8!==i.keyCode&&B(e.contextMenu.menuView.getHost())&&(l=Vt(h,l,a,b,i)),f.Ni)&&(l=L?m:f.Ei+i.data),x=[],k=N=void 0,D=(x=n&&n.wordWrap?J.un(l,Z(h.style.width)-w,y):l.split(/\r\n|\r|\n/)).length,h.minWidth=yt(h.minWidth,h.maxWidth),h.minHeight=yt(h.minHeight,h.maxHeight),n&&n.wordWrap||0<D){if(I=v=void 0,v=K?$t(I=qt(x,y)):D*t,n&&n.wordWrap)d.css(z,ft).css(V,H).css("max-width",h.style.width);else{for(E=[],N=_=0;N<D;N++)k=bt(c.Gi(x[N],y)),E.push(k),_=St(_,k);e=d.css(z),a=Z(h.style.width),n||e!==ft?_<=h.minWidth?(d.css(G,h.minWidth).css(z,Y).css(V,H),g&&d.css(dt,Y)):_>h.minWidth&&_<=h.maxWidth&&!r?(d.css(G,_).css(z,Y).css(V,H),g&&d.css(dt,Y)):_>h.maxWidth&&!r&&(d.css(G,h.maxWidth-2).css(z,ft).css(V,H),v=tn(E,h.maxWidth,t,I)):a<_&&!r&&(v=tn(E,a,t,I))}v<=h.minHeight?d.css(U,h.minHeight).css(vt,P):v>h.minHeight&&v<=h.maxHeight?d.css(U,v).css(vt,P):v>h.maxHeight&&d.css(U,h.maxHeight-1).css(lt,ht).css(vt,F)}return p=d.css(st),b=d.width()-h.minWidth,B(p)||p===F||(p===at?d.css(F,h.originalLeft-b/2):p===ot&&d.css(F,h.originalLeft-b)),n&&g&&(1===(m=n.vAlign)?d.css(ct,"middle"):2===m&&d.css(ct,"bottom")),f=Z(h.style.height)+A+M+S,i=w+T+C,d.css(lt)===ht?{width:h.offsetWidth+i,height:o?0:f}:{width:Z(h.style.width)+i,height:f}}},r.prototype.updateEditor=function(t,n,e,i,r,o,a){var n,i,u;return e=this.Bi(t,n,e,x,i,!1,r,o,a),L&&t&&(i=(n=(0,j.GC$)(t))[0].style.width,n.width(i+1).width(i)),u=!B(e)&&t?new R.Rect(t.style.left?parseFloat(t.style.left):0,t.style.top?parseFloat(t.style.top):0,e.width,e.height):u},r.prototype.fi=function(t,n,e,i,r,o,a,u,s){var i,o;e=this.Bi(t,n,e,i,r,o,a,u,s),L&&t&&(o=(i=(0,j.GC$)(t))[0].style.width,i.width(o+1).width(o)),!B(e)&&t&&(B(a)?a=e:(a.x=N,a.y=N),this.updateEditorContainer(t,e,n,r,a,u,s))},r.prototype.updateEditorContainer=function(t,n,e,i,r,o,a){var u,u,s;i&&i.preventOverflow?(l.prototype.updateEditorContainer.call(this,t,n,e,i,r,o,a),(u=t.parentNode)&&n&&(u=(0,j.GC$)(u),0<(s=n.width))&&u.width(s)):(n&&n.width&&r&&r.width&&(r.width=n.width),n&&n.height&&r&&r.height&&(r.height=n.height),l.prototype.updateEditorContainer.call(this,t,n,e,i,r,o,a))},r.prototype.updateImeMode=function(t,n,e){this.isImeAware()&&t&&O.Context.hn(t,n)},r.prototype.isReservedKey=function(t,n){var e=t.srcElement||t.target,i=t.keyCode,r=t.ctrlKey,o=t.altKey,a=t.metaKey;return!!(e&&n&&n.isEditing&&e.getAttribute(M)===S)&&(13===i&&(r&&!t.shiftKey||o)||90===i&&r&&!o||89===i&&r&&!o||67===i&&(r||a)&&!o||88===i&&(r||a)&&!o)},r.prototype.isImeAware=function(t){return!0},r.prototype.toJSON=function(){var t,n,e,t={},n=this;for(e in n)n.hasOwnProperty(e)&&"_editingElement"!==e&&(t[e]=n[e]);return t},r.prototype.cfe=function(t,n){var n={eventName:n,eventArg:t};return O.Base.et(t.sheet,"onCreateEventArg",n),n.eventArg},t.Text=u=r,v.ti[1]=u},"./dist/core/core.definition.js":function(){},"./dist/core/core.entry.js":function(t,n,e){"use strict";var i,r,o,a,u,s,s,r,e,i=this&&this.__createBinding||(Object.create?function(t,n,e,i){void 0===i&&(i=e);var r=Object.getOwnPropertyDescriptor(n,e);r&&("get"in r?n.__esModule:!r.writable&&!r.configurable)||(r={enumerable:!0,get:function(){return n[e]}}),Object.defineProperty(t,i,r)}:function(t,n,e,i){t[i=void 0===i?e:i]=n[e]}),r=this&&this.__exportStar||function(t,n){for(var e in t)"default"===e||Object.prototype.hasOwnProperty.call(n,e)||i(n,t,e)};Object.defineProperty(n,"__esModule",{value:!0}),n.CellTypes=void 0,e("./dist/core/core.res.en.js"),o=e("./dist/core/util/common.js"),Object.defineProperty(n,"getTypeFromString",{set:function(t){o.getTypeFromString=t},get:function(){return o.getTypeFromString}}),r(e("./dist/core/core.ns.js"),n),r(e("./dist/core/core.interface.js"),n),r(e("./dist/core/core.enum.js"),n),r(e("./dist/core/util/common.js"),n),r(e("./dist/core/excel-io-util/common.js"),n),r(e("./dist/core/excel-io-util/excel-types.js"),n),r(e("./dist/core/excel-io-util/range-parser.js"),n),r(e("./dist/core/excel-io-util/excel-helper.js"),n),r(e("./dist/core/excel-io-util/excel-style.js"),n),r(e("./dist/core/util/domUtil.js"),n),e("./dist/core/core.definition.js"),s=-1,1===(u=(a=e("./dist/core/lc/releaseLc.js"))._pt)&&(s=Math.floor(5*Math.random()),n["G".concat("C","$")]["s".concat("d")]=s),r(e("./dist/core/util/theme.js"),n),r(e("./dist/core/util/basedialog.js"),n),r(e("./dist/core/util/imageLoader.js"),n),r(e("./dist/core/util/tasks.js"),n),r(e("./dist/core/util/crypto.js"),n),0===s&&e("./dist/core/lc/lcRegister.js"),r(e("./dist/core/worksheet/stylehelper.js"),n),1===s&&e("./dist/core/lc/lcRegister.js"),r(e("./dist/core/worksheet/style.js"),n),2===s&&e("./dist/core/lc/lcRegister.js"),r(e("./dist/core/worksheet/clipboardhelper.js"),n),3===s&&e("./dist/core/lc/lcRegister.js"),r(e("./dist/core/worksheet/worksheet-model.js"),n),4===s&&e("./dist/core/lc/lcRegister.js"),r(e("./dist/core/worksheet/worksheet.js"),n),r(e("./dist/core/worksheet/worksheet-formatter.js"),n),r(e("./dist/core/worksheet/worksheet-actions.js"),n),r(e("./dist/core/worksheet/worksheet-border.js"),n),e("./dist/core/worksheet/worksheet-edit.js"),r(e("./dist/core/worksheet/worksheet-event.js"),n),e("./dist/core/worksheet/worksheet-json.js"),r(e("./dist/core/worksheet/worksheet-render.js"),n),e("./dist/core/worksheet/worksheet-selection.js"),e("./dist/core/worksheet/worksheet-sort.js"),r(e("./dist/core/worksheet/worksheet-ui.js"),n),r(e("./dist/core/worksheet/worksheet-static.js"),n),r(e("./dist/core/workbook/workbook.js"),n),r(e("./dist/core/workbook/workbook-json.js"),n),r(e("./dist/core/workbook/sheettabbase.js"),n),r(e("./dist/core/workbook/sheettab.js"),n),r(e("./dist/core/workbook/sheettab2007.js"),n),r(e("./dist/core/workbook/workbookpanelex.js"),n),r(e("./dist/core/util/styleManager.js"),n),s=e("./dist/core/celltype/cellType.entry.js"),n.CellTypes=s,r=e("./dist/core/celltype/headercelltype.js"),e=e("./dist/core/celltype/textcelltype.js"),s.Hi=r,s.zi=e,1!==u&&2!==u||a.Vi(n)},"./dist/core/core.enum.js":function(B,t){"use strict";var n,e,i,r,o,a,u,s,c,f,l,h,d,v,m,g,p,b,y,w,M,C,S,T,A,I,x,N,k,D,_,E,j,L,F,P,G,U,H,z,O,V,Y,Z,W,Q,J,K,X,q,$,tt,nt,et,it,rt,ot,at,ut,st,ct,ft,lt,ht,dt,vt,mt,gt,O,O,O,O,O,O,O,O,O,O,O,O,O,O,O,O,O,O,O,O,O,O,O,O,O,O,O,O,O,O,O,O,O,O,O,O,O,O,O,O,R,R,O,R,O,R,O,R,O,R,O,R,O,R,O,R,O,R,O,R,O,R,O,R,O,R,O,R;Object.defineProperty(t,"__esModule",{value:!0}),t.GroupSort=t.CalendarStartDay=t.CalendarPage=t.LayoutDisplayAs=t.LayoutDirection=t.CaptionAlignment=t.IconPosition=t.ButtonPosition=t.DropDownType=t.ButtonImageType=t.ButtonVisibility=t.RowColumnStates=t.CellStatesType=t.SortState=t.SheetArea=t.VerticalPosition=t.HorizontalPosition=t.Yi=t.ImageLayout=t.ValueType=t.RangeChangedAction=t.HeaderAutoText=t.StorageType=t.SelectionUnit=t.SelectionPolicy=t.ImeMode=t.EditorStatus=t.VisualState=t.Zi=t.VertAlign=t.VerticalAlign=t.HorizontalAlign=t.TextDecorationType=t.LabelVisibility=t.LabelAlignment=t.CopyToOptions=t.ClipboardPasteOptions=t.AutoFitType=t.InvalidOperationType=t.ResizeZeroIndicator=t.HeaderOptions=t.CopyPasteHeaderOptions=t.ResizeMode=t.InsertShiftCell=t.ShowScrollTip=t.ScrollbarAppearance=t.ShowResizeTip=t.ScrollbarState=t.AxisInfoChangeType=t.ScrollType=void 0,t.ClipboardActionType=t.OpenMode=t.OpenSaveFileType=t.FileType=t.TableStyleElement=t.SortBy=t.UsedRangeType=t.ColumnHeaderFitMode=t.AllSheetsListVisibility=t.SheetTabVisible=t.SheetType=t.HyperlinkTargetType=t.TabStripPosition=t.NumbersFitMode=t.PatternType=t.DropDownAlignment=t.DropDownDirection=t.DropdownListValue=void 0,(O=n=t.ScrollType||(t.ScrollType={}))[O.pixels=0]="pixels",O[O.continuous=1]="continuous",(O=e=t.AxisInfoChangeType||(t.AxisInfoChangeType={}))[O.setRowCount=0]="setRowCount",O[O.setColumnCount=1]="setColumnCount",O[O.addRows=2]="addRows",O[O.deleteRows=3]="deleteRows",O[O.addColumns=4]="addColumns",O[O.deleteColumns=5]="deleteColumns",O[O.setRowHeight=6]="setRowHeight",O[O.setColumnWidth=7]="setColumnWidth",O[O.setRowVisible=8]="setRowVisible",O[O.setColumnVisible=9]="setColumnVisible",O[O.filterRows=10]="filterRows",O[O.outlineExpandRows=11]="outlineExpandRows",O[O.outlineExpandColumns=12]="outlineExpandColumns",(O=i=t.ScrollbarState||(t.ScrollbarState={}))[O.hide=0]="hide",O[O.show=1]="show",O[O.active=2]="active",O[O.inactive=3]="inactive",(O=r=t.ShowResizeTip||(t.ShowResizeTip={}))[O.none=0]="none",O[O.column=1]="column",O[O.row=2]="row",O[O.both=3]="both",(O=o=t.ScrollbarAppearance||(t.ScrollbarAppearance={}))[O.skin=0]="skin",O[O.mobile=1]="mobile",(O=a=t.ShowScrollTip||(t.ShowScrollTip={}))[O.none=0]="none",O[O.horizontal=1]="horizontal",O[O.vertical=2]="vertical",O[O.both=3]="both",(O=u=t.InsertShiftCell||(t.InsertShiftCell={}))[O.right=0]="right",O[O.down=1]="down",(O=s=t.ResizeMode||(t.ResizeMode={}))[O.normal=0]="normal",O[O.split=1]="split",(O=c=t.CopyPasteHeaderOptions||(t.CopyPasteHeaderOptions={}))[O.noHeaders=0]="noHeaders",O[O.rowHeaders=1]="rowHeaders",O[O.columnHeaders=2]="columnHeaders",O[O.allHeaders=3]="allHeaders",(O=f=t.HeaderOptions||(t.HeaderOptions={}))[O.noHeaders=0]="noHeaders",O[O.rowHeaders=1]="rowHeaders",O[O.columnHeaders=2]="columnHeaders",O[O.allHeaders=3]="allHeaders",(O=l=t.ResizeZeroIndicator||(t.ResizeZeroIndicator={}))[O.default=0]="default",O[O.enhanced=1]="enhanced",(O=h=t.InvalidOperationType||(t.InvalidOperationType={}))[O.setFormula=0]="setFormula",O[O.copyPaste=1]="copyPaste",O[O.dragFill=2]="dragFill",O[O.dragDrop=3]="dragDrop",O[O.changePartOfArrayFormula=4]="changePartOfArrayFormula",O[O.changeSheetName=5]="changeSheetName",O[O.table=6]="table",O[O.filter=7]="filter",O[O.hideSheet=8]="hideSheet",O[O.sort=9]="sort",O[O.pivotTable=10]="pivotTable",O[O.ptOverlapValue=11]="ptOverlapValue",O[O.groupProtected=12]="groupProtected",O[O.editProtected=13]="editProtected",O[O.cutProtected=14]="cutProtected",O[O.customName=15]="customName",O[O.dataObjectCellTypeInsertData=16]="dataObjectCellTypeInsertData",(O=d=t.AutoFitType||(t.AutoFitType={}))[O.cell=0]="cell",O[O.cellWithHeader=1]="cellWithHeader",(O=v=t.ClipboardPasteOptions||(t.ClipboardPasteOptions={}))[O.all=0]="all",O[O.values=1]="values",O[O.formatting=2]="formatting",O[O.formulas=3]="formulas",O[O.valuesAndFormatting=4]="valuesAndFormatting",O[O.formulasAndFormatting=5]="formulasAndFormatting",(O=m=t.CopyToOptions||(t.CopyToOptions={}))[O.value=1]="value",O[O.formula=2]="formula",O[O.comment=4]="comment",O[O.outline=8]="outline",O[O.sparkline=16]="sparkline",O[O.span=32]="span",O[O.style=64]="style",O[O.tag=128]="tag",O[O.bindingPath=256]="bindingPath",O[O.conditionalFormat=512]="conditionalFormat",O[O.hyperlink=1024]="hyperlink",O[O.all=2047]="all",(O=g=t.LabelAlignment||(t.LabelAlignment={}))[O.topLeft=0]="topLeft",O[O.topCenter=1]="topCenter",O[O.topRight=2]="topRight",O[O.bottomLeft=3]="bottomLeft",O[O.bottomCenter=4]="bottomCenter",O[O.bottomRight=5]="bottomRight",(O=p=t.LabelVisibility||(t.LabelVisibility={}))[O.visible=0]="visible",O[O.hidden=1]="hidden",O[O.auto=2]="auto",(O=b=t.TextDecorationType||(t.TextDecorationType={}))[O.underline=1]="underline",O[O.lineThrough=2]="lineThrough",O[O.overline=4]="overline",O[O.doubleUnderline=8]="doubleUnderline",O[O.none=0]="none",(O=y=t.HorizontalAlign||(t.HorizontalAlign={}))[O.left=0]="left",O[O.center=1]="center",O[O.right=2]="right",O[O.general=3]="general",O[O.centerContinuous=4]="centerContinuous",(O=w=t.VerticalAlign||(t.VerticalAlign={}))[O.top=0]="top",O[O.center=1]="center",O[O.bottom=2]="bottom",(O=M=t.VertAlign||(t.VertAlign={}))[O.normal=0]="normal",O[O.superscript=1]="superscript",O[O.subscript=2]="subscript",(O=C=t.Zi||(t.Zi={}))[O.smallDecrement=0]="smallDecrement",O[O.smallIncrement=1]="smallIncrement",O[O.largeDecrement=2]="largeDecrement",O[O.largeIncrement=3]="largeIncrement",O[O.thumbPosition=4]="thumbPosition",O[O.thumbTrack=5]="thumbTrack",O[O.endScroll=6]="endScroll",(O=S=t.VisualState||(t.VisualState={}))[O.normal=0]="normal",O[O.highlight=1]="highlight",O[O.selected=2]="selected",O[O.active=3]="active",O[O.hover=4]="hover",O[O.activeNotSelected=5]="activeNotSelected",(O=T=t.EditorStatus||(t.EditorStatus={}))[O.ready=0]="ready",O[O.enter=1]="enter",O[O.edit=2]="edit",(O=A=t.ImeMode||(t.ImeMode={}))[O.auto=1]="auto",O[O.active=2]="active",O[O.inactive=4]="inactive",O[O.disabled=0]="disabled",(O=I=t.SelectionPolicy||(t.SelectionPolicy={}))[O.single=0]="single",O[O.range=1]="range",O[O.multiRange=2]="multiRange",(O=x=t.SelectionUnit||(t.SelectionUnit={}))[O.cell=0]="cell",O[O.row=1]="row",O[O.column=2]="column",(O=N=t.StorageType||(t.StorageType={}))[O.data=1]="data",O[O.style=2]="style",O[O.comment=4]="comment",O[O.tag=8]="tag",O[O.sparkline=16]="sparkline",O[O.axis=32]="axis",O[O.bindingPath=64]="bindingPath",O[O.hyperlink=256]="hyperlink",(O=k=t.HeaderAutoText||(t.HeaderAutoText={}))[O.blank=0]="blank",O[O.numbers=1]="numbers",O[O.letters=2]="letters",(O=D=t.RangeChangedAction||(t.RangeChangedAction={}))[O.dragDrop=0]="dragDrop",O[O.dragFill=1]="dragFill",O[O.clear=2]="clear",O[O.paste=3]="paste",O[O.sort=4]="sort",O[O.setArrayFormula=5]="setArrayFormula",O[O.evaluateFormula=6]="evaluateFormula",(O=_=t.ValueType||(t.ValueType={}))[O.normal=0]="normal",O[O.richText=1]="richText",(O=E=t.ImageLayout||(t.ImageLayout={}))[O.stretch=0]="stretch",O[O.center=1]="center",O[O.zoom=2]="zoom",O[O.none=3]="none",(O=j=t.Yi||(t.Yi={})).ThumbButton="thumbButton",O.TrackButton="trackButton",O.LeftButton="leftButton",O.RightButton="rightButton",O.UpButton="upButton",O.DownButton="downButton",(O=L=t.HorizontalPosition||(t.HorizontalPosition={}))[O.left=0]="left",O[O.center=1]="center",O[O.right=2]="right",O[O.nearest=3]="nearest",(O=F=t.VerticalPosition||(t.VerticalPosition={}))[O.top=0]="top",O[O.center=1]="center",O[O.bottom=2]="bottom",O[O.nearest=3]="nearest",(O=P=t.SheetArea||(t.SheetArea={}))[O.corner=0]="corner",O[O.colHeader=1]="colHeader",O[O.rowHeader=2]="rowHeader",O[O.viewport=3]="viewport",(O=G=t.SortState||(t.SortState={}))[O.none=0]="none",O[O.ascending=1]="ascending",O[O.descending=2]="descending",(O=U=t.CellStatesType||(t.CellStatesType={}))[O.hover=1]="hover",O[O.invalid=2]="invalid",O[O.readonly=4]="readonly",O[O.edit=8]="edit",O[O.active=16]="active",O[O.selected=32]="selected",O[O.dirty=64]="dirty",O[O.invalidFormula=128]="invalidFormula",(O=H=t.RowColumnStates||(t.RowColumnStates={}))[O.hover=1]="hover",O[O.invalid=2]="invalid",O[O.edit=8]="edit",O[O.active=16]="active",O[O.selected=32]="selected",O[O.dirty=64]="dirty",O[O.inserted=128]="inserted",O[O.invalidFormula=512]="invalidFormula",(O=z=t.ButtonVisibility||(t.ButtonVisibility={}))[O.always=0]="always",O[O.onSelected=1]="onSelected",O[O.onEditing=2]="onEditing",(R=O=t.ButtonImageType||(t.ButtonImageType={}))[R.none=0]="none",R[R.custom=1]="custom",R[R.clear=2]="clear",R[R.cancel=3]="cancel",R[R.ok=4]="ok",R[R.dropdown=5]="dropdown",R[R.ellipsis=6]="ellipsis",R[R.left=7]="left",R[R.right=8]="right",R[R.plus=9]="plus",R[R.minus=10]="minus",R[R.undo=11]="undo",R[R.redo=12]="redo",R[R.search=13]="search",R[R.separator=14]="separator",R[R.spinLeft=15]="spinLeft",R[R.spinRight=16]="spinRight",R[R.collapse=17]="collapse",R[R.expand=18]="expand",O.calcel=O.cancel,(R=V=t.DropDownType||(t.DropDownType={}))[R.colorPicker=0]="colorPicker",R[R.dateTimePicker=1]="dateTimePicker",R[R.timePicker=2]="timePicker",R[R.monthPicker=3]="monthPicker",R[R.list=4]="list",R[R.slider=5]="slider",R[R.calculator=6]="calculator",R[R.workflowList=7]="workflowList",R[R.multiColumn=8]="multiColumn",(O=Y=t.ButtonPosition||(t.ButtonPosition={}))[O.left=0]="left",O[O.right=1]="right",O[O.leftOfText=2]="leftOfText",O[O.rightOfText=3]="rightOfText",(R=Z=t.IconPosition||(t.IconPosition={}))[R.left=0]="left",R[R.right=1]="right",R[R.leftOfText=2]="leftOfText",R[R.rightOfText=3]="rightOfText",R[R.outsideLeft=4]="outsideLeft",R[R.outsideRight=5]="outsideRight",(O=W=t.CaptionAlignment||(t.CaptionAlignment={}))[O.left=0]="left",O[O.right=1]="right",(R=Q=t.LayoutDirection||(t.LayoutDirection={}))[R.horizontal=0]="horizontal",R[R.vertical=1]="vertical",(O=J=t.LayoutDisplayAs||(t.LayoutDisplayAs={}))[O.inline=0]="inline",O[O.popup=1]="popup",O[O.tree=2]="tree",(R=K=t.CalendarPage||(t.CalendarPage={}))[R.year=1]="year",R[R.month=2]="month",R[R.day=3]="day",(O=X=t.CalendarStartDay||(t.CalendarStartDay={}))[O.monday=1]="monday",O[O.tuesday=2]="tuesday",O[O.wednesday=3]="wednesday",O[O.thursday=4]="thursday",O[O.friday=5]="friday",O[O.saturday=6]="saturday",O[O.sunday=7]="sunday",(R=q=t.GroupSort||(t.GroupSort={}))[R.none=0]="none",R[R.group=1]="group",R[R.child=2]="child",R[R.full=3]="full",(O=$=t.DropdownListValue||(t.DropdownListValue={}))[O.string=0]="string",O[O.array=1]="array",(R=tt=t.DropDownDirection||(t.DropDownDirection={}))[R.Down=0]="Down",R[R.Up=1]="Up",R[R.Left=2]="Left",R[R.Right=3]="Right",(O=nt=t.DropDownAlignment||(t.DropDownAlignment={}))[O.Near=0]="Near",O[O.Center=1]="Center",O[O.Far=2]="Far",(R=et=t.PatternType||(t.PatternType={}))[R.solid=1]="solid",R[R.darkGray=2]="darkGray",R[R.mediumGray=3]="mediumGray",R[R.lightGray=4]="lightGray",R[R.gray125=5]="gray125",R[R.gray0625=6]="gray0625",R[R.darkHorizontal=7]="darkHorizontal",R[R.darkVertical=8]="darkVertical",R[R.darkDown=9]="darkDown",R[R.darkUp=10]="darkUp",R[R.darkGrid=11]="darkGrid",R[R.darkTrellis=12]="darkTrellis",R[R.lightHorizontal=13]="lightHorizontal",R[R.lightVertical=14]="lightVertical",R[R.lightDown=15]="lightDown",R[R.lightUp=16]="lightUp",R[R.lightGrid=17]="lightGrid",R[R.lightTrellis=18]="lightTrellis",(O=it=t.NumbersFitMode||(t.NumbersFitMode={}))[O.mask=0]="mask",O[O.overflow=1]="overflow",(R=rt=t.TabStripPosition||(t.TabStripPosition={}))[R.bottom=0]="bottom",R[R.top=1]="top",R[R.left=2]="left",R[R.right=3]="right",(O=ot=t.HyperlinkTargetType||(t.HyperlinkTargetType={}))[O.blank=0]="blank",O[O.self=1]="self",O[O.parent=2]="parent",O[O.top=3]="top",(R=at=t.SheetType||(t.SheetType={}))[R.tableSheet=0]="tableSheet",R[R.ganttSheet=1]="ganttSheet",R[R.customSheetTab=2]="customSheetTab",(O=ut=t.SheetTabVisible||(t.SheetTabVisible={}))[O.hidden=0]="hidden",O[O.visible=1]="visible",O[O.veryHidden=2]="veryHidden",(R=st=t.AllSheetsListVisibility||(t.AllSheetsListVisibility={}))[R.hide=0]="hide",R[R.show=1]="show",R[R.auto=2]="auto",(O=ct=t.ColumnHeaderFitMode||(t.ColumnHeaderFitMode={}))[O.normal=0]="normal",O[O.vertical=1]="vertical",O[O.stack=2]="stack",(R=ft=t.UsedRangeType||(t.UsedRangeType={}))[R.all=262143]="all",R[R.axis=1]="axis",R[R.style=2]="style",R[R.rowStyle=4]="rowStyle",R[R.colStyle=8]="colStyle",R[R.data=16]="data",R[R.formula=32]="formula",R[R.span=64]="span",R[R.shape=128]="shape",R[R.table=256]="table",R[R.sparkLine=512]="sparkLine",R[R.comment=1024]="comment",R[R.slicer=2048]="slicer",R[R.pivottable=4096]="pivottable",R[R.filter=8192]="filter",R[R.dataValidation=16384]="dataValidation",R[R.conditionFormat=32768]="conditionFormat",R[R.chart=65536]="chart",R[R.picture=131072]="picture",(O=lt=t.SortBy||(t.SortBy={})).cellColor="cellColor",O.fontColor="fontColor",O.icon="icon",O.value="value",(R=ht=t.TableStyleElement||(t.TableStyleElement={})).wholeTable="wholeTable",R.firstColumnStripe="firstColumnStripe",R.secondColumnStripe="secondColumnStripe",R.firstRowStripe="firstRowStripe",R.secondRowStripe="secondRowStripe",R.lastColumn="lastColumn",R.firstColumn="firstColumn",R.headerRow="headerRow",R.totalRow="totalRow",R.firstHeaderCell="firstHeaderCell",R.lastHeaderCell="lastHeaderCell",R.firstTotalCell="firstTotalCell",R.lastTotalCell="lastTotalCell",(O=dt=t.FileType||(t.FileType={}))[O.excel=0]="excel",O[O.ssjson=1]="ssjson",O[O.csv=2]="csv",(R=vt=t.OpenSaveFileType||(t.OpenSaveFileType={}))[R.excel=0]="excel",R[R.sjs=1]="sjs",(O=mt=t.OpenMode||(t.OpenMode={}))[O.normal=0]="normal",O[O.lazy=1]="lazy",O[O.incremental=2]="incremental",(R=gt=t.ClipboardActionType||(t.ClipboardActionType={}))[R.copy=1]="copy",R[R.cut=2]="cut",R[R.reset=3]="reset"},"./dist/core/core.interface.js":function(t,n){"use strict";var e,n;Object.defineProperty(n,"__esModule",{value:!0}),n.CornerPosition=void 0,(n=e=n.CornerPosition||(n.CornerPosition={}))[n.leftTop=1]="leftTop",n[n.rightTop=2]="rightTop",n[n.leftBottom=4]="leftBottom",n[n.rightBottom=8]="rightBottom"},"./dist/core/core.ns.js":function(t,n,e){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.SR=void 0;var e=e("./dist/core/core.res.en.js");n.SR={en:e}},"./dist/core/core.res.en.js":function(t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.ARIA_HasValue=n.ARIA_Cell=n.ARIA_Scrollbar_TRACK_Button=n.ARIA_Scrollbar_Bottom_Button=n.ARIA_Scrollbar_Right_Button=n.ARIA_Scrollbar_Thumb_Button=n.ARIA_Scrollbar_Top_Button=n.ARIA_Scrollbar_Left_Button=n.ARIA_Blank=n.ARIA_NewSheet=n.ARIA_SheetTab=n.ARIA_NextButton=n.ARIA_PreviousButton=n.ARIA_Last=n.ARIA_NextArrow=n.ARIA_PreviousArrow=n.ARIA_First=n.ARIA_Resize=n.NeedCanvasSupport=n.Exp_OverlappingSpans=n.Exp_SheetIsNull=n.Exp_DestSheetIsNull=n.Exp_ArrayFormulaSpan=n.Exp_SheetNameConflict=n.Exp_SheetNameInvalid=n.Exp_EmptyNamedStyle=n.NewTab=n.Tip_Width=n.Tip_Height=n.Tip_Column_Offset=n.Tip_Column=n.Tip_Row=n.Exp_PasteChangeMergeCell=n.Exp_PasteDestinationCellsLocked=n.Exp_InvalidCopyPasteSize=n.Exp_PasteSourceCellsLocked=n.Exp_ArgumentOutOfRange=n.Exp_NotAFunction=n.Exp_InvalidRange=n.Exp_IndexOutOfRange=n.Exp_InvalidCustomName=n.Exp_InvalidCustomFunction=n.Exp_DestIsNull=n.Exp_SrcIsNull=n.Exp_InvalidAndSpace=n.Exp_ChangePartOfArray=n.Exp_MultipleSelections=n.Exp_InvalidPastedArea=n.Exp_PasteExtentIsNull=n.Exp_NotSupported=void 0,n.STEP=n.EXP_UNSUPPORT_CRYPTO_ALGORITHM=n.NORMAL=n.EXP_INVALID_PASSWORD=n.EXP_NO_PASSWORD=n.EXP_FILE_FORMAT=n.EXP_IO=n.Exp_InvalidOperationInProtect=n.Exp_InvalidSortPartTableOrMultiTableInRange=n.Exp_InvalidSortSpanInRange=n.Exp_InvalidSortArrayFormulaInRange=n.Exp_InsertCopiedCutCellsAffectTable=n.Exp_InsertCopiedCutCellsOverlap=n.Exp_InsertCopiedCutCellsNoRange=n.Exp_InsertCopiedCutCellsOnSpanTable=n.Exp_InsertCopiedCutCells=n.ls8=n.ls7=n.ls6=n.ls5=n.ls4=n.ls3=n.ls2=n.ls1=n.lsde=n.lsru=n.SHEET_NAME=n.ARIA_ColumnHeader=n.ARIA_RowHeader=n.ARIA_HasComment=n.ARIA_HasFormula=void 0,n.Exp_NotSupported="Not supported exception",n.Exp_PasteExtentIsNull="pasteExtent is null",n.Exp_InvalidPastedArea="The pasted area should have the same size as the copy or cut area.",n.Exp_MultipleSelections="This action won't work on multiple selections.",n.Exp_ChangePartOfArray="Cannot change part of an array.",n.Exp_InvalidAndSpace="Invalid {0}: {1} (must be between {2} and {3}).",n.Exp_SrcIsNull="The argument 'src' is null",n.Exp_DestIsNull="The argument 'dest' is null",n.Exp_InvalidCustomFunction="invalid custom function",n.Exp_InvalidCustomName="invalid custom name",n.Exp_IndexOutOfRange="Index is out of range!",n.Exp_InvalidRange="Invalid range",n.Exp_NotAFunction="Not A Function",n.Exp_ArgumentOutOfRange="ArgumentOutOfRange",n.Exp_PasteSourceCellsLocked="Source sheet's cells are locked.",n.Exp_InvalidCopyPasteSize="The copy and paste areas are not the same size.",n.Exp_PasteDestinationCellsLocked="The cell you are trying to change is protected and therefore read-only.",n.Exp_PasteChangeMergeCell="Cannot change part of a merged cell.",n.Tip_Row="Row: ",n.Tip_Column="Column: ",n.Tip_Column_Offset="Offset: ",n.Tip_Height="Height: {0} pixels",n.Tip_Width="Width: {0} pixels",n.NewTab="New...",n.Exp_EmptyNamedStyle="The name of named style cannot be empty or null",n.Exp_SheetNameInvalid="The sheet name can not be blank or contains these characters : *, :, [, ], ?, \\, /",n.Exp_SheetNameConflict="That name is already taken. Try a different one.",n.Exp_ArrayFormulaSpan="Array formulas are not valid in merged cells.",n.Exp_DestSheetIsNull="destSheet is null",n.Exp_SheetIsNull="sheet is null.",n.Exp_OverlappingSpans="This operation will cause overlapping spans.",n.NeedCanvasSupport="You need a browser which full supports HTML5 Canvas to run SpreadJS",n.ARIA_Resize="resize",n.ARIA_First="first",n.ARIA_PreviousArrow="previous arrow",n.ARIA_NextArrow="next arrow",n.ARIA_Last="last",n.ARIA_PreviousButton="previous button",n.ARIA_NextButton="next button",n.ARIA_SheetTab="sheet tab",n.ARIA_NewSheet="new sheet",n.ARIA_Blank="blank",n.ARIA_Scrollbar_Left_Button="scrollbar left button",n.ARIA_Scrollbar_Top_Button="scrollbar top button",n.ARIA_Scrollbar_Thumb_Button="scrollbar thumb button",n.ARIA_Scrollbar_Right_Button="scrollbar right button",n.ARIA_Scrollbar_Bottom_Button="scrollbar bottom button",n.ARIA_Scrollbar_TRACK_Button="scrollbar track button",n.ARIA_Cell="cell",n.ARIA_HasValue="has value {0}",n.ARIA_HasFormula="has formula {0}",n.ARIA_HasComment="has comment {0}",n.ARIA_RowHeader="row header",n.ARIA_ColumnHeader="column header",n.SHEET_NAME="Sheet",n.lsru=["","6465706c6f796d656e74"],n.lsde=["","64657369676e6572"],n.ls1=["","506f776572656420627920477261706543697479205370726561644a532e0d0a596f752063616e206f6e6c79206465706c6f792074686973204556414c554154494f4e2076657273696f6e206c6f63616c6c792e0d0a54656d706f72617279207b317d206b6579732061726520617661696c61626c6520666f722074657374696e672e0d0a456d61696c2075732e73616c6573406772617065636974792e636f6d2e"],n.ls2=["","506f776572656420627920477261706543697479205370726561644a532e0d0a596f75722074656d706f72617279207b317d206b6579206578706972657320696e207b307d206461792873292e"],n.ls3=["","4c6963656e7365204e6f7420466f756e640d0a596f75206e65656420612076616c6964206c6963656e7365206b657920746f2072756e205370726561644a532e0d0a54656d706f72617279206b6579732061726520617661696c61626c6520666f72206576616c756174696f6e2e0d0a496620796f75207075726368617365642061206c6963656e73652c20796f7572206b657920697320696e20796f757220707572636861736520636f6e6669726d6174696f6e20656d61696c2e0d0a456d61696c2075732e73616c6573406772617065636974792e636f6d20696620796f75206e65656420617373697374616e6365206f7220726571756573742061206b6579206174206763676f2e746f2f736a736b65792e"],n.ls4=["","496e76616c6964206c6963656e7365206b65792e20456d61696c2075732e73616c6573406772617065636974792e636f6d20696620796f75206e6565642068656c702e"],n.ls5=["","506f776572656420627920477261706543697479205370726561644a532e0d0a596f75722074656d706f72617279207b317d206b65792068617320657870697265642e0d0a456d61696c2075732e73616c6573406772617065636974792e636f6d20666f722068656c702e"],n.ls6=["","506f776572656420627920477261706543697479205370726561644a53204576616c756174696f6e2056657273696f6e0d0a4e6f74204c6963656e73656420666f7220446973747269627574696f6e"],n.ls7=["","457863656c20494f204c6963656e7365204e6f7420466f756e640d0a596f75206e65656420612076616c6964206c6963656e7365206b657920746f2072756e205370726561644a5320457863656c20494f2e2054656d706f72617279206b6579732061726520617661696c61626c6520666f72206576616c756174696f6e2e20496620796f75207075726368617365642061206c6963656e73652c20796f7572206b657920697320696e20796f757220707572636861736520636f6e6669726d6174696f6e20656d61696c2e20456d61696c2075732e73616c6573406772617065636974792e636f6d20696620796f75206e65656420617373697374616e63652e"],n.ls8=["","496e76616c696420457863656c20494f206c6963656e7365206b65792e200d0a456d61696c2075732e73616c6573406772617065636974792e636f6d20696620796f75206e65656420617373697374616e63652e"],n.Exp_InsertCopiedCutCells="This selection is not valid. The copy/paste area must be the same size",n.Exp_InsertCopiedCutCellsOnSpanTable="This won\u2019t work because it would move cells in a table on your worksheet or will cause some merged cells to unmerge.",n.Exp_InsertCopiedCutCellsNoRange="New cells can not be inserted as there are non-empty cells that would extend beyond the worksheet.",n.Exp_InsertCopiedCutCellsOverlap="This selection isn't valid. Make sure the copy and paste areas don't overlap unless they are the same size and shape.",n.Exp_InsertCopiedCutCellsAffectTable="You can't rearrange cells within a table this way, because it might affect other table cells in an unexpected way.",n.Exp_InvalidSortArrayFormulaInRange="Can't sort current range as array formula exist.",n.Exp_InvalidSortSpanInRange="Can't sort current range as span exist.",n.Exp_InvalidSortPartTableOrMultiTableInRange="Can't sort current range as part table or more than one table exist.",n.Exp_InvalidOperationInProtect="The cell or chart you're trying to change is on a protected sheet. To make a change, unprotect the sheet.",n.EXP_IO="File read and write exception.",n.EXP_FILE_FORMAT="Incorrect file format.",n.EXP_NO_PASSWORD="The Excel file cannot be opened because the workbook/worksheet is password protected.",n.EXP_INVALID_PASSWORD="The specified password is incorrect.",n.NORMAL="Normal",n.EXP_UNSUPPORT_CRYPTO_ALGORITHM="Unsupported cryptographic algorithms",n.STEP={start:"start load {0}",loadFileData:"load {0}'s data to spread",loadSheetData:"load {0}'s data",startCalc:"start reCalc",loadSheetFormula:"load {0}'s formula",parseFile:"parse {0} content"}},"./dist/core/excel-io-util/common.js":function(t,n,e){"use strict";var i,r,f,v,m,c,s,l,h,d,o,a,u,g,p,e,b,y,w,M,C;function S(){}function T(){}function A(){}function I(t,n){var n,n,e,n=n.toUpperCase(),n=b[n];return n?(e=p,(e=n.reg?n.prefix:p)+t):t}function x(n,t,e){var i,r,e,t,i,r=function(t){return n.getColumnWidth(t)},e=N(e,function(t){return n.getRowHeight(t)},n.getRowCount(),n.defaults.rowHeight),t=N(t,r,n.getColumnCount(),n.defaults.colWidth);return{rowIndex:e.index,rowOffset:e.offset,colIndex:t.index,colOffset:t.offset}}function N(t,n,e,i){for(var r,o,a,u,s,c,r=-1,o=-1,a=0,u=0;u<e;u++)if(t<(a+=s=n(u))){r=u,o=t-(a-s);break}return-1===r&&a<t&&(r=e+(c=Math.floor((t-a)/i)),o=t-(a+c*i)),{index:r,offset:o}}function k(t,n){for(var e=n;e<t.length;e++)if("'"===t[e]||'"'===t[e])return e;return e}function D(t,n){var e,i,r,o;if(t&&"string"==typeof t){for(e=[],i=0;i<t.length&&(r=k(t,i),e.push(n(t.substring(i,r))),r<t.length);i++)o=void 0,o=-1===(i=t.indexOf(t[r],r+1))?t.substring(r):t.substring(r,i+1),e.push(o);return e.join("")}return t}function _(){}Object.defineProperty(n,"__esModule",{value:!0}),n.excelSupportProtectionOptions=n.protectionOptionsMap=n.SJSStylePropsToStyleProps=n.Util=n.NodeHelper=n.IndexHelper=n.StringEx=n.STEP_RATE=void 0,i=e("Common"),r=e("./dist/core/core.enum.js"),f=e("./dist/core/util/domUtil.js"),v=e("./dist/core/util/common.js"),m=e("./dist/core/excel-io-util/excel-types.js"),c=e("./dist/core/excel-io-util/excel-helper.js"),s=/_x00[0-1][0-9A-Fa-f]_/,l=i.Common.lt.ht,h=null,d=void 0,o=m.XFileConstants.Wi,a=m.XFileConstants.Qi,u=m.XFileConstants.Ki,g=/([A-Z][A-Z.]+)\(/gi,p="_xlfn.",b={AVERAGEIF:/\bAVERAGEIF\b\(/gi,AVERAGEIFS:/\bAVERAGEIFS\b\(/gi,CUBEKPIMEMBER:/\bCUBEKPIMEMBER\b\(/gi,CUBEMEMBER:/\bCUBEMEMBER\b\(/gi,CUBEMEMBERPROPERTY:/\bCUBEMEMBERPROPERTY\b\(/gi,CUBERANKEDMEMBER:/\bCUBERANKEDMEMBER\b\(/gi,CUBESET:/\bCUBESET\b\(/gi,CUBESETCOUNT:/\bCUBESETCOUNT\b\(/gi,CUBEVALUE:/\bCUBEVALUE\b\(/gi,COUNTIFS:/\bCOUNTIFS\b\(/gi,IFERROR:/\bIFERROR\b\(/gi,SUMIFS:/\bSUMIFS\b\(/gi,ACOT:/\bACOT\b\(/gi,ACOTH:/\bACOTH\b\(/gi,AGGREGATE:/\bAGGREGATE\b\(/gi,ARABIC:/\bARABIC\b\(/gi,BASE:/\bBASE\b\(/gi,"BETA.DIST":/\bBETA\.DIST\b\(/gi,"BETA.INV":/\bBETA\.INV\b\(/gi,"BINOM.DIST":/\bBINOM\.DIST\b\(/gi,"BINOM.DIST.RANGE":/\bBINOM\.DIST\.RANGE\b\(/gi,"BINOM.INV":/\bBINOM\.INV\b\(/gi,BITAND:/\bBITAND\b\(/gi,BITLSHIFT:/\bBITLSHIFT\b\(/gi,BITOR:/\bBITOR\b\(/gi,BITRSHIFT:/\bBITRSHIFT\b\(/gi,BITXOR:/\bBITXOR\b\(/gi,"CEILING.MATH":/\bCEILING\.MATH\b\(/gi,"CEILING.PRECISE":/\bCEILING\.PRECISE\b\(/gi,"CHISQ.DIST":/\bCHISQ\.DIST\b\(/gi,"CHISQ.DIST.RT":/\bCHISQ\.DIST\.RT\b\(/gi,"CHISQ.INV":/\bCHISQ\.INV\b\(/gi,"CHISQ.INV.RT":/\bCHISQ\.INV\.RT\b\(/gi,"CHISQ.TEST":/\bCHISQ\.TEST\b\(/gi,COMBINA:/\bCOMBINA\b\(/gi,CONCAT:/\bCONCAT\b\(/gi,"CONFIDENCE.T":/\bCONFIDENCE\.T\b\(/gi,"CONFIDENCE.NORM":/\bCONFIDENCE\.NORM\b\(/gi,COT:/\bCOT\b\(/gi,"COVARIANCE.P":/\bCOVARIANCE\.P\b\(/gi,"COVARIANCE.S":/\bCOVARIANCE\.S\b\(/gi,CSC:/\bCSC\b\(/gi,CSCH:/\bCSCH\b\(/gi,DAYS:/\bDAYS\b\(/gi,DECIMAL:/\bDECIMAL\b\(/gi,ENCODEURL:/\bENCODEURL\b\(/gi,"ERF.PRECISE":/\bERF\.PRECISE\b\(/gi,"ERFC.PRECISE":/\bERFC\.PRECISE\b\(/gi,"EXPON.DIST":/\bEXPON\.DIST\b\(/gi,"F.DIST":/\bF\.DIST\b\(/gi,"F.DIST.RT":/\bF\.DIST\.RT\b\(/gi,"F.INV":/\bF\.INV\b\(/gi,"F.INV.RT":/\bF\.INV\.RT\b\(/gi,FILTERXML:/\bFILTERXML\b\(/gi,"FLOOR.MATH":/\bFLOOR\.MATH\b\(/gi,"FLOOR.PRECISE":/\bFLOOR\.PRECISE\b\(/gi,FORMULATEXT:/\bFORMULATEXT\b\(/gi,GAMMA:/\bGAMMA\b\(/gi,"GAMMA.DIST":/\bGAMMA\.DIST\b\(/gi,"GAMMA.INV":/\bGAMMA\.INV\b\(/gi,"GAMMALN.PRECISE":/\bGAMMALN\.PRECISE\b\(/gi,"HYPGEOM.DIST":/\bHYPGEOM\.DIST\b\(/gi,IFNA:/\bIFNA\b\(/gi,IFS:/\bIFS\b\(/gi,IMCOSH:/\bIMCOSH\b\(/gi,IMCOT:/\bIMCOT\b\(/gi,IMCSCH:/\bIMCSCH\b\(/gi,IMSEC:/\bIMSEC\b\(/gi,IMSECH:/\bIMSECH\b\(/gi,IMSINH:/\bIMSINH\b\(/gi,IMTAN:/\bIMTAN\b\(/gi,ISFORMULA:/\bISFORMULA\b\(/gi,ISOWEEKNUM:/\bISOWEEKNUM\b\(/gi,"LOGNORM.DIST":/\bLOGNORM\.DIST\b\(/gi,"LOGNORM.INV":/\bLOGNORM\.INV\b\(/gi,MAXIFS:/\bMAXIFS\b\(/gi,MINIFS:/\bMINIFS\b\(/gi,"MODE.MULT":/\bMODE\.MULT\b\(/gi,"MODE.SNGL":/\bMODE\.SNGL\b\(/gi,MUNIT:/\bMUNIT\b\(/gi,"NEGBINOM.DIST":/\bNEGBINOM\.DIST\b\(/gi,"NORM.DIST":/\bNORM\.DIST\b\(/gi,"NORM.INV":/\bNORM\.INV\b\(/gi,"NORM.S.DIST":/\bNORM\.S\.DIST\b\(/gi,"NORM.S.INV":/\bNORM\.S\.INV\b\(/gi,NUMBERVALUE:/\bNUMBERVALUE\b\(/gi,PDURATION:/\bPDURATION\b\(/gi,"PERCENTILE.EXC":/\bPERCENTILE\.EXC\b\(/gi,"PERCENTILE.INC":/\bPERCENTILE\.INC\b\(/gi,"PERCENTRANK.EXC":/\bPERCENTRANK\.EXC\b\(/gi,"PERCENTRANK.INC":/\bPERCENTRANK\.INC\b\(/gi,PERMUTATIONA:/\bPERMUTATIONA\b\(/gi,PHI:/\bPHI\b\(/gi,"POISSON.DIST":/\bPOISSON\.DIST\b\(/gi,"QUARTILE.EXC":/\bQUARTILE\.EXC\b\(/gi,"QUARTILE.INC":/\bQUARTILE\.INC\b\(/gi,"RANK.AVG":/\bRANK\.AVG\b\(/gi,"RANK.EQ":/\bRANK\.EQ\b\(/gi,RRI:/\bRRI\b\(/gi,SECH:/\bSECH\b\(/gi,SHEET:/\bSHEET\b\(/gi,SHEETS:/\bSHEETS\b\(/gi,"STDEV.P":/\bSTDEV\.P\b\(/gi,"STDEV.S":/\bSTDEV\.S\b\(/gi,SWITCH:/\bSWITCH\b\(/gi,"T.DIST":/\bT\.DIST\b\(/gi,"T.DIST.2T":/\bT\.DIST\.2T\b\(/gi,"T.DIST.RT":/\bT\.DIST\.RT\b\(/gi,"T.INV":/\bT\.INV\b\(/gi,"T.INV.2T":/\bT\.INV\.2T\b\(/gi,TEXTJOIN:/\bTEXTJOIN\b\(/gi,UNICHAR:/\bUNICHAR\b\(/gi,UNICODE:/\bUNICODE\b\(/gi,"VAR.P":/\bVAR\.P\b\(/gi,"VAR.S":/\bVAR\.S\b\(/gi,WEBSERVICE:/\bWEBSERVICE\b\(/gi,"WEIBULL.DIST":/\bWEIBULL\.DIST\b\(/gi,XOR:/\bXOR\b\(/gi,"Z.TEST":/\bZ\.TEST\b\(/gi,XMATCH:/\bXLOOKUP\b\(/gi,XLOOKUP:/\bXLOOKUP\b\(/gi,RANDARRAY:/RANDARRAY\(/gi,SEQUENCE:/SEQUENCE\(/gi,SORTBY:/SORTBY\(/gi,UNIQUE:/UNIQUE\(/gi,ANCHORARRAY:/ANCHORARRAY\(/gi,SINGLE:/SINGLE\(/gi,LET:/\bLET\b\(/gi,LAMBDA:/\bLAMBDA\b\(/gi,MAP:/\bMAP\b\(/gi,REDUCE:/\bREDUCE\b\(/gi,SCAN:/\bSCAN\b\(/gi,MAKEARRAY:/\bMAKEARRAY\b\(/gi,BYCOL:/\bBYCOL\b\(/gi,BYROW:/\bBYROW\b\(/gi,ISOMITTED:/\bISOMITTED\b\(/gi,FILTER:{reg:/FILTER\(/gi,prefix:e="_xlfn._xlws."},SORT:{reg:/SORT\(/gi,prefix:e},TEXTBEFORE:/\bTEXTBEFORE\b\(/gi,TEXTAFTER:/\bTEXTAFTER\b\(/gi,TEXTSPLIT:/\bTEXTSPLIT\b\(/gi,VSTACK:/\bVSTACK\b\(/gi,HSTACK:/\bHSTACK\b\(/gi,TOROW:/\bTOROW\b\(/gi,TOCOL:/\bTOCOL\b\(/gi,WRAPROWS:/\bWRAPROWS\b\(/gi,WRAPCOLS:/\bWRAPCOLS\b\(/gi,TAKE:/\bTAKE\b\(/gi,DROP:/\bDROP\b\(/gi,EXPAND:/\bEXPAND\b\(/gi,CHOOSEROWS:/\bCHOOSEROWS\b\(/gi,CHOOSECOLS:/\bCHOOSECOLS\b\(/gi},n.STEP_RATE={start:0,loadFileData:.1,loadSheetData:.4,loadSheetDataWithCalc:.3,startCalc:.2,loadSheetFormula:.4,loadSheetFormulaWithCalc:.3,parseFile:.1,end:1},S.Ji=function(t){return!t||""===t},S.Xi=function(t){return!t||" "===t},y=S,n.StringEx=y,T.qi=function(t){if(y.Ji(t))return 0;for(var n=0,e=0;e<t.length&&isNaN(parseInt(t[e],10));)e++;return(n=e<t.length?parseInt(t.substring(e),10):n)-1},T.$i=function(t){for(var n,e,i,r,o,a,n=0,e=t.length,i=0;i<e&&!(25<(a=(o=(r=t[i]).charCodeAt())-97))&&!((a=a<0?o-65:a)<0);i++)n=26*n+a+1;return--n},T.nr=function(t){var n,e,i,r,o,a;if(t<0)return"";if(!(n=T.er[t])){for(e=t,r=(i="").length,t+=1;0<t;t=Math.floor((t-1)/26))o=i.substring(0,r),a=i.substring(r),i=o+String.fromCharCode(65+(t-1)%26)+a;n=i.toString(),T.er[e]=n}return n},T.ir=function(t){var n,e,i,n=function(t){for(var n,e,i,n=!0,e=0;e<t.length;e++){if(i=t[e],T.rr[i])return!1;n&&/\D/.test(i)&&(n=!1)}return!n},e;return"'"===t[0]&&"'"===t.substr(-1)||(i=n(t))?t:"'"+t+"'"},T.er=["A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z"],T.rr={" ":!0,"'":!0,"[":!0,"]":!0,"?":!0,"\\":!0,"%":!0,'"':!0,"(":!0,")":!0,"|":!0,"{":!0,"}":!0,"#":!0,"@":!0,"!":!0,$:!0,"^":!0,"\uff08":!0,"\uff09":!0,";":!0,":":!0,",":!0,"+":!0,"-":!0,"*":!0,"/":!0,"&":!0,"=":!0,"<":!0,">":!0,"\u3000":!0},w=T,n.IndexHelper=w,A.ar=function(t,n){if(!l(t)){var t=parseFloat(t);if(!isNaN(t))return t}return n},A.ur=function(t,n){return"1"===t||"true"===t||"0"!==t&&"false"!==t&&n},A.sr=function(t,n){if(!isNaN(t)){var t=parseInt(t,10);if(!isNaN(t))return t}return n},A.cr=function(t){return t=Array.isArray(t)?t:t?[t]:[]},A.fr=function(t,n){return"1"===t||"t"===t||"0"!==t&&"f"!==t&&!!n},A.lr=function(t,n){var e,i,r;if(t){for(e=n.split("."),i=t;e.length;){if(r=e.shift(),l(i[r]))return;i=i[r]}return i}},A.dr=function(t,n){return l(t)?n:t?"1":"0"},n.NodeHelper=A,_.vr=function(t){return t.split("/").pop().slice(0,-4)},_.mr=function(t){return D(t,function(t){return 0<=t.toLowerCase().indexOf("_xlfn.")?t.replace(/_xlfn\.|_xlws\./gi,""):t})},_.gr=function(t,n,e){return t.split(n).join(e)},_.pr=function(t,n){var e,i,r,o,a,u;if(l(t)||""===t)return t;for(t.match(s)!==h&&(t=t.replace(e=/(_x00[0-1][0-9A-Fa-f]_)/g,function(t){return"_x005F"+t})),i=["_x0000_","_x0001_","_x0002_","_x0003_","_x0004_","_x0005_","_x0006_","_x0007_","_x0008_","_x0009_","_x000A_","_x000B_","_x000C_","_x000D_","_x000E_","_x000F_","_x0010_","_x0011_","_x0012_","_x0013_","_x0014_","_x0015_","_x0016_","_x0017_","_x0018_","_x0019_","_x001A_","_x001B_","_x001C_","_x001D_","_x001E_","_x001F_"],r=[],o=0;o<t.length;o++)a=t.charCodeAt(o),u=t[o],r.push(31<a||(10===a||13===a)&&n?u:i[a]);return r.join("")},_.addXLFNPrefix=function(t){return D(t,function(t){return t.replace(g,I)})},_.wr=function(t){return t.c_||(t.c_=[]),t.c_.length+1},_.Mr=function(t){return t+"."+m.XFileConstants.Cr},_.Sr=function(t,n){for(var e,i,r,e=0,i=t;e<i.length;e++)if((r=i[e]).Id===n)return r},_.Tr=function(t,n,e){var t,n,t,t=t&&_.Sr(t.c_,n);if(t)return n=_.vr(t.Target),(t=e.drawings)&&t[n]},_.Ir=function(t,n){var e=v.util.xr(t,o);if(e)return _.Tr(t.rels,e[u],n)},_.Nr=function(t){t.rels||(t.rels={n_:m.XFileConstants.Dr,xmlns:m.RelationshipConstants._r,c_:[]})},_.Er=function(t,n){var e,n,e,n,e=v.util.xr(n,o),n=e&&_.Sr(n.rels.c_,e[u]),e=n&&_.vr(n.Target);if(e)return t.drawings||(t.drawings={}),(n=t.drawings)[e]||(n[e]={n_:"wsDr",r_:[5,4],c_:[],rels:{n_:m.XFileConstants.Dr,xmlns:m.RelationshipConstants._r,c_:[]}}),n[e]},_.jr=function(t,n){var e,i,i,n,e=t.rels;v.util.xr(t,o)||(n.drawing++,i=_.wr(e),i=m.XFileConstants.Rr+i,n=m.XFileConstants.Wi+n.drawing,e.c_.push({n_:m.XFileConstants.Lr,Id:i,Type:m.RelationshipConstants.Fr,Target:"../drawings/"+n+"."+m.XFileConstants.Cr}),t.c_||(t.c_=[]),t.c_.push({n_:o,"r:id":i}),v.util.Pr(t,m.WorkSheetNodeOrder))},_.Gr=function(t,n,e){return _.Tr(t,n,e)},_.Ur=function(t,n,e){var e,n,e,n,i,e=v.util.xr(n,e||a),n=e&&_.Sr(n.rels.c_,e[u]),e=n&&_.vr(n.Target);if(e)return t.drawings||(t.drawings={}),(n=t.drawings)[e]||(n[e]={n_:"xml",r_:[10,11,12],c_:[i={n_:"shapelayout","v:ext":"edit",c_:[{n_:"idmap","v:ext":"edit",data:"1"}]}]}),n[e]},_.Hr=function(t,n,e){var i,n,r,r,n,i=t.rels;v.util.xr(t,e=e||a)||(n.vmlDrawing++,n=n.vmlDrawing,r=_.wr(i),r=m.XFileConstants.Rr+r,n=m.XFileConstants.zr+n,i.c_.push({n_:m.XFileConstants.Lr,Id:r,Type:m.RelationshipConstants.Vr,Target:"../drawings/"+n+"."+m.XFileConstants.Yr}),t.c_||(t.c_=[]),t.c_.push({n_:e,"r:id":r}))},_.Zr=function(t,n,e){var n,t,i,n,n,n=_.Sr(n.c_,t),t=n&&n.Target;if(t)return-1!==(n=(t=-1!==(n=t.lastIndexOf("/"))?t.substring(n+1):t).lastIndexOf("."))&&(i=t.substring(n+1)),{blob:n=(n=e.media[t])&&i?_.Wr(n,i):n,type:i}},_.Wr=function(t,n){var n=n;return"data:image/".concat(n="svg"===n?"svg+xml":n,";base64,").concat(t)},_.Qr=function(t){var n,e,i,n=t.indexOf(";base64,");if(-1!==n)return e=t.substring(n+8),{type:i=t.substring(11,n),base64Content:e}},_.Kr=function(t,n,e){var t,i,i,e,t=_.Qr(t);if(t)return e.media||(e.media={}),"svg+xml"===(i=t.type)?i="svg":"x-icon"===i&&(i="png"),i=m.XFileConstants.Jr+Object.keys(e.media).length+"."+i,e.media[i]=t.base64Content,e=m.XFileConstants.Rr+_.wr(n),n.c_.push({n_:m.XFileConstants.Lr,Id:e,Type:m.RelationshipConstants.Xr,Target:"../media/"+i}),e},_.qr=function(t,n){var t=1024*(t+1)+1;return n&&(t+=n.c_.filter(function(t){return t.n_===m.XFileConstants.$r}).length),t},_.StringToByteArray=function(t){var n,e,i,n=[];if(t&&!(t instanceof Array))for(e=t.length,i=0;i<e;i+=2)n[i/2]=parseInt(t.substr(i,2),16);return n},_.no=function(){return"{xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx}".replace(/[xy]/g,function(t){var n=16*Math.random()|0,e;return("x"===t?n:3&n|8).toString(16)})},_.eo=function(t,n){var e,i,r,e=t.split("/"),i=n.split("/");for(e.pop();0<i.length;)if(".."===(r=i[0]))i.shift(),e.pop();else{if("."!==r)break;i.shift()}return e.concat(i).join("/")},_.io=function(t){var n;return l(t)||t.match(s)===h?t:t.replace(/(_x005[fF])?_x00([0-1][0-9A-Fa-f])_/g,function(t,n,e){var i=0;return e&&(i=parseInt(e,16)),n?"_x00"+e+"_":String.fromCharCode(i)}).replace(/(\r)+\n/g,"\r\n")},_.ro=function(){var t,n,e,i;try{n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol?"symbol":typeof t},e="object"===("undefined"==typeof global?"undefined":n(global))&&global&&global.Object===Object&&global,i="object"===("undefined"==typeof self?"undefined":n(self))&&self&&self.Object===Object&&self,t=e||i||Function("return this")()}catch(t){}return t},_.oo=function(){var t=_.ro();return t&&t.gcCultureInfo},_.ao=function(){var t=_.ro();return t&&t.gcCultureObj},_.uo=function(t){var n,e,e,n=!0,e=_.ro(),e=e&&e.GC&&e.GC.Spread&&e.GC.Spread.Formatter&&e.GC.Spread.Formatter.GeneralFormatter;if(t&&"="!==t[0]&&!l(e))try{new e(t)}catch(t){n=!1}return n},_.so=function(t,o){var a;return f.GC$.each(t,function(t,n){var e,i,r,e=n.rels&&n.rels.c_;if(e&&e.length)for(i=0;i<e.length;i++)if((r=_.vr(e[i].Target))===o)return a=t,!1}),a},_.co=function(t,n){var e,i,r,o,a,u,s,c;if(n&&n.rels&&n.c_&&n.c_.length){for(e=n.rels.c_,i={},r=0;r<e.length;r++)(o=e[r]).Type===m.RelationshipConstants.fo&&(i[o.Id]=_.vr(o.Target));for(r=0;r<n.c_.length;r++)if("sheets"===(a=n.c_[r]).n_)for(u=a.c_,s=0;s<u.length;s++)if(i[(c=u[s])[m.XFileConstants.Ki]]===t)return c.name}},_.lo=function(t,n,u){var s,c,c=n.split(".");return f.GC$.each(t,function(t,n){var e,i,r,o,a,e=n.c_;if(e&&e.length)for(i=0;i<e.length;i++){for(o=e[i][c[r=0]],a=e[i];r<c.length&&(a=a[c[r]])!==d;)r++;if(a===u)return s=o,!1}}),s},_.ho=function(t,n){var e,i,r,o,a,u,s,c,f,l,h,d;for(n=v.util.vo(n),i=t.workbook,o=-1,u=0,s=r=v.util.xr(i,m.XFileConstants.mo).c_;u<s.length;u++)if(n===(c=s[u]).name){o=c[m.XFileConstants.Ki];break}if(-1!==o){for(l=0,h=f=v.util.go(i.rels,m.XFileConstants.Lr);l<h.length;l++)if(o===(d=h[l]).Id){a=_.vr(d.Target);break}a&&(e=t.sheets[a])}return e},_.po=function(t,n){var t=_.ho(t,n);return t&&v.util.xr(t,m.XFileConstants.bo)},_.yo=function(t,n,e,i,r){var o,a;l(i)||t&&((a=(a=(o=(o=t[n])||(t[n]={}))[e])||(o[e]={})).v=r.getTextIndex(i))},_.wo=function(t,n){return t&&t.openMode&r.OpenMode.lazy&&!l(n)},_.Mo=function(t){return t&&t.openMode&r.OpenMode.incremental},_.Co=function(t){return t&&t.fileType===r.OpenSaveFileType.excel},_.So=function(t,n,e,i){var r,o,a,u,r=t.getRowCount(),o=t.getColumnCount(),u=i&&i.dataEffectByInflate&&i.dataEffectByInflate[t.name()];r<n&&(a=new v.Range(r,-1,n-r,-1),t.setRowCount(n),u)&&Object.keys(u).forEach(function(t){u[t](a)}),o<e&&(a=new v.Range(-1,o,-1,e-o),t.setColumnCount(e),u)&&Object.keys(u).forEach(function(t){u[t](a)})},_.To=function(t,n,e,i){var r,o,a,u,n,s,a,s,a,o,u;void 0===e&&(e=2),o=n.from,a=n.to,u=n.pos,n=n.ext,a?(s=+a.row.v_,a=+a.col.v_,_.So(t,s+e,a+e,i)):n&&(o||u)&&(s={x:0,y:0},o?s=_.Lce(t,o):(s.x=c.ExcelHelper.emuToPixles(parseInt(u.x,10)),s.y=c.ExcelHelper.emuToPixles(parseInt(u.y,10))),s.x+=c.ExcelHelper.emuToPixles(parseInt(n.cx,10)),s.y+=c.ExcelHelper.emuToPixles(parseInt(n.cy,10)),o=(a=x(t,s.x,s.y)).rowIndex,u=a.colIndex,_.So(t,o+e,u+e,i))},_.Ao=function(e,t,i,r){t&&t.forEach(function(t){var n,t,n=t.row+(0<t.rowCount?t.rowCount:1),t=t.col+(0<t.colCount?t.colCount:1);i&&(n>=m.XmlConstants.Io||t>=m.XmlConstants.xo)||_.So(e,n,t,r)})},_.Fce=function(t){var n,e,i,r;function o(t,n){var t=parseInt(t.v_||0,10);return n?c.ExcelHelper.emuToPixles(t):t}return{row:n=o(t.row),col:e=o(t.col),rowOff:i=o(t.rowOff,!0),colOff:r=o(t.colOff,!0)}},_.Lce=function(t,n){var n,e,i,n=_.Fce(n),e,i;return{x:v.util.w0(t,0,n.col,!1)+n.colOff,y:v.util.w0(t,0,n.row,!0)+n.rowOff}},_.No=function(t){return t=Math.min(t,m.XmlConstants.xo-1),w.nr(t)},_.ko=function(t){return!t||l(t.fileType)||t.fileType===r.OpenSaveFileType.sjs},n.Util=_,n.SJSStylePropsToStyleProps={wholeSlicerStyle:"wholeTable",headerStyle:"headerRow",wholeTableStyle:"wholeTable",headerRowStyle:"headerRow",footerRowStyle:"totalRow",highlightFirstColumnStyle:"firstColumn",highlightLastColumnStyle:"lastColumn",firstRowStripStyle:"firstRowStripe",secondRowStripStyle:"secondRowStripe",firstColumnStripStyle:"firstColumnStripe",secondColumnStripStyle:"secondColumnStripe",firstHeaderCellStyle:"firstHeaderCell",lastHeaderCellStyle:"lastHeaderCell",firstFooterCellStyle:"firstTotalCell",lastFooterCellStyle:"lastTotalCell",reportFilterLabelsStyle:"pageFieldLabels",reportFilterValuesStyle:"pageFieldValues",firstRowStripeStyle:"firstRowStripe",secondRowStripeStyle:"secondRowStripe",firstColumnStripeStyle:"firstColumnStripe",secondColumnStripeStyle:"secondColumnStripe",subtotalColumn1Style:"firstSubtotalColumn",subtotalColumn2Style:"secondSubtotalColumn",subtotalColumn3Style:"thirdSubtotalColumn",subtotalRow1Style:"firstSubtotalRow",subtotalRow2Style:"secondSubtotalRow",subtotalRow3Style:"thirdSubtotalRow",columnSubheading1Style:"firstColumnSubheading",columnSubheading2Style:"secondColumnSubheading",columnSubheading3Style:"thirdColumnSubheading",rowSubheading1Style:"firstRowSubheading",rowSubheading2Style:"secondRowSubheading",rowSubheading3Style:"thirdRowSubheading",blankRowStyle:"blankRow",grandTotalColumnStyle:"lastColumn",grandTotalRowStyle:"totalRow",firstHeaderCellStyleL:"firstHeaderCell",firstColumnStyle:"firstColumn"},n.protectionOptionsMap={allowSelectLockedCells:"selectLockedCells",allowSelectUnlockedCells:"selectUnlockedCells",allowFilter:"autoFilter",allowSort:"sort",allowInsertColumns:"insertColumns",allowInsertRows:"insertRows",allowDeleteColumns:"deleteColumns",allowDeleteRows:"deleteRows",allowEditObjects:"objects"},n.excelSupportProtectionOptions={formatCells:!0,formatColumns:!0,formatRows:!0,insertColumns:!0,insertRows:!0,insertHyperlinks:!0,deleteColumns:!0,deleteRows:!0,sort:!0,autoFilter:!0,pivotTables:!0}},"./dist/core/excel-io-util/excel-helper.js":function(t,n){"use strict";function e(t,n){var n=Math.pow(10,n);return Math.round(t*n)/n}var i;function r(){}Object.defineProperty(n,"__esModule",{value:!0}),n.ExcelHelper=void 0,r.pointToPixel=function(t){return e(96*t/72,2)},r.pixelToPoint=function(t){return 72*t/96},r.emuToPixles=function(t,n){return e(96*t/914400,n||2)},r.pixelToEMU=function(t){return Math.round(914400*t/96)},r.getActualColumnWidth=function(t,n,e){for(var i,r,i=0,r=n;r<e;r++)t.getColumnVisible(r)&&(i+=t.Do(r,3));return i},r.getActualRowHeight=function(t,n,e){for(var i,r,i=0,r=n;r<e;r++)t.getRowVisible(r)&&(i+=t._o(r,3));return i},r.getImageContent=function(t,n){var e,i,i,e="png",i=t.lastIndexOf(".");return"svg"===(e=-1!==i?t.substr(i+1):e)&&(e="svg+xml"),(i=n(t,!0))?"data:image/"+e+";base64,"+i:null},n.ExcelHelper=r},"./dist/core/excel-io-util/excel-style.js":function(t,n){"use strict";var e,n;Object.defineProperty(n,"__esModule",{value:!0}),n.ExcelBorderStyle=void 0,(n=e=n.ExcelBorderStyle||(n.ExcelBorderStyle={}))[n.none=0]="none",n[n.thin=1]="thin",n[n.medium=2]="medium",n[n.dashed=3]="dashed",n[n.dotted=4]="dotted",n[n.thick=5]="thick",n[n.double=6]="double",n[n.hair=7]="hair",n[n.mediumDashed=8]="mediumDashed",n[n.dashDot=9]="dashDot",n[n.mediumDashDot=10]="mediumDashDot",n[n.dashDotDot=11]="dashDotDot",n[n.mediumDashDotDot=12]="mediumDashDotDot",n[n.slantDashDot=13]="slantDashDot"},"./dist/core/excel-io-util/excel-types.js":function(t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.WorkSheetNodeOrder=n.WorkbookNodeOrder=n.RelationshipConstants=n.XFileConstants=n.XmlConstants=void 0,n.XmlConstants={xo:16384,Io:1048576},n.XFileConstants={Eo:"_rels",jo:"/xl",Oo:"[Content_Types].xml",Rr:"rId",Ki:"r:id",Dr:"Relationships",Lr:"Relationship",Qi:"legacyDrawing",Ro:"legacyDrawingHF",Bo:"AlternateContent",Lo:"Choice",Fo:"controls",Po:"control",$r:"shape",Go:"bin",Uo:"application/vnd.openxmlformats-officedocument.spreadsheetml.printerSettings",Ho:"rels",zo:"application/vnd.openxmlformats-package.relationships+xml",Vo:"application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml",Yo:"application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml",Zo:"application/vnd.openxmlformats-officedocument.theme+xml",Wo:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml",Qo:"application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml",Ko:"application/vnd.openxmlformats-officedocument.spreadsheetml.externalLink+xml",Jo:"application/vnd.openxmlformats-officedocument.spreadsheetml.table+xml",Xo:"application/vnd.openxmlformats-officedocument.drawing+xml",qo:"application/vnd.openxmlformats-officedocument.drawingml.chart+xml",$o:"application/vnd.ms-office.chartex+xml",ta:"application/vnd.ms-office.chartstyle+xml",na:"application/vnd.ms-office.chartcolorstyle+xml",ia:"application/vnd.openxmlformats-officedocument.drawingml.chartshapes+xml",ra:"application/vnd.openxmlformats-officedocument.drawingml.diagramColors+xml",oa:"application/vnd.openxmlformats-officedocument.drawingml.diagramData+xml",aa:"application/vnd.ms-office.drawingml.diagramDrawing+xml",ua:"application/vnd.openxmlformats-officedocument.drawingml.diagramLayout+xml",sa:"application/vnd.openxmlformats-officedocument.drawingml.diagramStyle+xml",ca:"application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml",fa:"application/vnd.ms-excel.threadedcomments+xml",la:"application/vnd.ms-excel.person+xml",ha:"application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheDefinition+xml",da:"application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheRecords+xml",va:"application/vnd.openxmlformats-officedocument.spreadsheetml.pivotTable+xml",ma:"application/vnd.ms-excel.slicer+xml",ga:"application/vnd.ms-excel.slicerCache+xml",pa:"application/vnd.ms-excel.timeline+xml",ba:"application/vnd.ms-excel.timelineCache+xml",ya:"application/vnd.ms-office.vbaProject",wa:"application/vnd.openxmlformats-officedocument.vmlDrawing",Ma:"application/vnd.ms-excel.controlproperties+xml",Cr:"xml",Yr:"vml",Ca:"application/xml",Sa:"jpg",Ta:"image/jpg",Aa:"tiff",Ia:"image/tiff",xa:"jpeg",Na:"image/jpeg",ka:"svg",Da:"image/svg+xml",_a:"png",Ea:"image/png",ja:"bmp",Oa:"image/bmp",Ra:"gif",Ba:"image/gif",La:"emf",Fa:"image/x-emf",Pa:"wmf",Ga:"image/x-wmf",Ua:"drawings",zr:"vmlDrawing",Ha:"/xl/charts",za:"/xl/drawings",Va:"/xl/persons",Ya:"/xl/media",Za:"/xl/threadedComments",Wa:"/xl/worksheets",Qa:"/xl/tables",Ka:"/xl/slicers",Ja:"/xl/slicerCaches",Xa:"/xl/timelines",qa:"/xl/timelineCaches",$a:"/xl/ctrlProps",tu:"externalLink",nu:"/xl/externalLinks",eu:"/xl/pivotCache",iu:"/xl/pivotTables",mo:"sheets",ru:"sheet",ou:"comments",au:"chart",uu:"chartEx",su:"style",cu:"person",fu:"colors",Wi:"drawing",lu:"ctrlProp",hu:"threadedComment",Jr:"image",du:"table",vu:"slicer",mu:"slicerCache",gu:"timeline",pu:"timelineCache",bu:"pivotCacheDefinition",yu:"pivotCache",wu:"pivotCacheRecords",Mu:"pivotTable",Cu:"External",Su:"sheetPr",Tu:"dimension",Au:"extLst",Iu:"mergeCells",xu:"mergeCell",Nu:"hyperlinks",ku:"hyperlink",Du:"sheetViews",_u:"sheetFormatPr",Eu:"cols",bo:"sheetData",ju:"conditionalFormatting",Ou:"dataValidations",Ru:"dataValidation",Bu:"tableParts",Lu:"/xl/sharedStrings.xml",Fu:"/xl/theme/theme1.xml",Pu:"/xl/worksheets",Gu:"/xl/workbook.xml",Uu:"/docProps/core.xml",Hu:"/docProps/app.xml",zu:"/docProps/custom.xml",Vu:"/xl/styles.xml",Yu:"/xl/theme/theme1.xml",Zu:"metadata.xml",Wu:"/xl/_rels/workbook.xml.rels",Qu:"http://schemas.openxmlformats.org/spreadsheetml/2006/main",Ku:"http://schemas.openxmlformats.org/markup-compatibility/2006",Ju:"http://schemas.openxmlformats.org/drawingml/2006/spreadsheetDrawing",Xu:"http://schemas.openxmlformats.org/drawingml/2006/main",qu:"http://schemas.microsoft.com/office/spreadsheetml/2009/9/ac",$u:"x14ac",ts:"x14ac xr xr2 xr3",ns:"xr",os:"http://schemas.microsoft.com/office/spreadsheetml/2014/revision",as:"http://schemas.microsoft.com/office/spreadsheetml/2015/revision2",us:"http://schemas.microsoft.com/office/spreadsheetml/2016/revision3",ss:"http://schemas.openxmlformats.org/officeDocument/2006/relationships",fs:"http://schemas.openxmlformats.org/package/2006/content-types",_r:"http://schemas.openxmlformats.org/package/2006/relationships",ls:"http://schemas.openxmlformats.org/drawingml/2006/main",hs:"http://schemas.microsoft.com/office/drawing/2010/main",vs:"http://schemas.microsoft.com/office/drawing/2016/SVG/main",ms:"http://schemas.microsoft.com/office/spreadsheetml/2009/9/main",ps:"http://schemas.microsoft.com/office/excel/2006/main",bs:"http://schemas.openxmlformats.org/markup-compatibility/2006",ys:"http://schemas.microsoft.com/office/spreadsheetml/2009/9/main",ws:"http://schemas.openxmlformats.org/spreadsheetml/2006/main",Ms:"http://schemas.microsoft.com/office/spreadsheetml/2010/11/main",Cs:"http://schemas.microsoft.com/office/spreadsheetml/2018/calcfeatures",Ss:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml",Ts:"http://schemas.microsoft.com/office/spreadsheetml/2017/dynamicarray",As:"http://schemas.microsoft.com/office/spreadsheetml/2017/richdata",Is:"http://schemas.microsoft.com/office/spreadsheetml/2018/threadedcomments",xs:"http://schemas.microsoft.com/office/spreadsheetml/2018/threadedcomments",Ns:"http://schemas.microsoft.com/office/spreadsheetml/2014/revision",ks:"http://schemas.openxmlformats.org/package/2006/metadata/core-properties",Ds:"http://purl.org/dc/elements/1.1/",_s:"http://purl.org/dc/terms/",Es:"http://purl.org/dc/dcmitype/",js:"http://www.w3.org/2001/XMLSchema-instance",Os:"application/vnd.openxmlformats-package.core-properties+xml",Ls:"http://schemas.openxmlformats.org/officeDocument/2006/extended-properties",Fs:"http://schemas.openxmlformats.org/officeDocument/2006/docPropsVTypes",Ps:"application/vnd.openxmlformats-officedocument.extended-properties+xml",Gs:"http://schemas.openxmlformats.org/officeDocument/2006/custom-properties",Us:"http://schemas.openxmlformats.org/officeDocument/2006/docPropsVTypes",Hs:"application/vnd.openxmlformats-officedocument.custom-properties+xml"},n.RelationshipConstants={zs:"rId",_r:"http://schemas.openxmlformats.org/package/2006/relationships",Vs:"http://schemas.openxmlformats.org/package/2006/relationships/metadata/core-properties",Ys:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/extended-properties",Zs:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/custom-properties",Ws:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/officeDocument",Qs:"http://purl.oclc.org/ooxml/officeDocument/relationships/officeDocument",Ks:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/styles",Js:"http://purl.oclc.org/ooxml/officeDocument/relationships/styles",fo:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/worksheet",Xs:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sharedStrings",qs:"http://purl.oclc.org/ooxml/officeDocument/relationships/sharedStrings",$s:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/theme",tc:"http://purl.oclc.org/ooxml/officeDocument/relationships/theme",ec:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/pivotCacheDefinition",ic:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/pivotCacheRecords",oc:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/pivotTable",uc:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLink",fc:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLinkPath",lc:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/table",hc:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/comments",Vr:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/vmlDrawing",dc:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/ctrlProp",vc:"http://purl.oclc.org/ooxml/officeDocument/relationships/extendedProperties",Fr:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/drawing",gc:"http://purl.oclc.org/ooxml/officeDocument/relationships/drawing",pc:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/hyperlink",Xr:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/image",bc:"http://purl.oclc.org/ooxml/officeDocument/relationships/image",yc:"http://schemas.microsoft.com/office/2007/relationships/slicer",wc:"http://schemas.microsoft.com/office/2007/relationships/slicerCache",Mc:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/chart",Cc:"http://schemas.microsoft.com/office/2014/relationships/chartEx",Sc:"http://purl.oclc.org/ooxml/officeDocument/relationships/chart",Tc:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/chartUserShapes",Ac:"http://schemas.microsoft.com/office/2011/relationships/chartColorStyle",Ic:"http://schemas.microsoft.com/office/2011/relationships/chartStyle",xc:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sheetMetadata",Nc:"http://schemas.microsoft.com/office/2011/relationships/timeline",kc:"http://schemas.microsoft.com/office/2011/relationships/timelineCache"},n.WorkbookNodeOrder=["bookViews",n.XFileConstants.mo,"externalReferences","definedNames","calcPr","pivotCaches","extLst"],n.WorkSheetNodeOrder=[n.XFileConstants.Su,n.XFileConstants.Tu,n.XFileConstants.Du,n.XFileConstants._u,n.XFileConstants.Eu,n.XFileConstants.bo,"sheetProtection","autoFilter",n.XFileConstants.Iu,n.XFileConstants.ju,n.XFileConstants.Ou,n.XFileConstants.Nu,"printOptions","pageMargins","pageSetup","headerFooter","rowBreaks","colBreaks","picture","drawing",n.XFileConstants.Qi,n.XFileConstants.Ro,n.XFileConstants.Po,n.XFileConstants.Bo,n.XFileConstants.Bu,n.XFileConstants.Au]},"./dist/core/excel-io-util/range-parser.js":function(t,n,e){"use strict";var i,c,u,f,l,r;function h(t){return-1===t.col||-1===t.colCount}function d(t){return-1===t.row||-1===t.rowCount}function a(){}Object.defineProperty(n,"__esModule",{value:!0}),n.range_parser=void 0,i=e("./dist/core/excel-io-util/excel-types.js"),c=e("./dist/core/excel-io-util/common.js"),u=e("./dist/core/util/common.js"),f=i.XmlConstants.Io,l=i.XmlConstants.xo,a.Dc=function(t,n){var e,i,e=[];return null!==t&&(i=t.replace(/('.+')/g,"").split(" ")).forEach(function(t){var t=a._c(t,n);!t||t.row>f||t.col>l||t.rowCount>f||t.col>l||e.push(t)}),e},a._c=function(t,n){var e,i,i,r,o,i,a,a,t,e=(0,u.Ec)(0,0,0,0),i=t.indexOf("!");if(1===(i=(i=(t=-1<i?t.substr(i+1):t).split("$").join("")).split(":")).length){if(a=i[0],r=c.IndexHelper.qi(a),o=c.IndexHelper.$i(a),-1===r&&-1===o)return null;e.row=r,e.col=o,e.rowCount=1,e.colCount=1}else 2===i.length&&(a=i[0],t=i[1],r=c.IndexHelper.qi(a),o=c.IndexHelper.$i(a),i=c.IndexHelper.qi(t),a=c.IndexHelper.$i(t),e.row=r,e.col=o,e.rowCount=i-r+1,e.colCount=a-o+1,n||0!==r||e.rowCount!==f||(e.row=-1,e.rowCount=-1),n||0!==o||e.colCount!==l||(e.col=-1,e.colCount=-1));return e},a.jc=function(t,n){var n,e,i,r,t,o;if(t)return n=n?"$":"",e=t.row,i=t.col,r=t.rowCount,t=t.colCount,o=c.IndexHelper.nr(i),1===r&&1===t?n+o+n+(e+1):-1===e||-1===r?n+o+n+"1:"+n+c.IndexHelper.nr(i+t-1)+n+f:-1===i||-1===t?n+"A"+n+(e+1)+":"+n+c.IndexHelper.nr(l)+n+(e+r):0===r&&0===t?n+o+n+(e+1):n+o+n+(e+1)+":"+n+c.IndexHelper.nr(i+t-1)+n+(e+r)},a.Oc=function(t,n){var e,i,r,o;if(t){for(e=[],i=0,r=t;i<r.length;i++)o=r[i],e.push(a.jc(o,n));return e.join(" ")}},a.getRangeString=function(t){for(var n,e,i,r,o,a,u,s,u,n=[],e=0,i=t;e<i.length;e++)h(r=i[e])&&(r.col=0,r.colCount=l),d(r)&&(r.row=0,r.rowCount=f),o=r.row,a=r.row+r.rowCount-1,u=r.col,s=r.col+r.colCount-1,u=c.IndexHelper.nr(u)+(o+1),(1<r.rowCount||1<r.colCount)&&(u+=":"+c.IndexHelper.nr(s)+(1+a)),n.push(u);return n.join(" ")},n.range_parser=a},"./dist/core/lc/common.js":function(B,t,n){"use strict";var e,i,o,r,l,r,u,a,n,r,s,c,f,v,m,g,p,b,y,w,M,C,S,T,A,I,x,h,d,N;function L(){return N}function k(t,n){for(var e,i,r,o,a,u,i="",a=0,e=0;e<t.length;e++)a=Math.max(a,t[e].length);for(e=0;e<a;e++){for(n&&(r=""),u=0;u<t.length;u++)n?e>=t[u].length?r+="00":r+=t[u].charAt(e)+t[u].charAt(e+1):e<t[u].length&&(i+=t[u].charAt(e));n&&(o=parseInt(r,16),i+=String.fromCharCode(o),e++)}return i}function D(n,e,i){var t,r,o,a,t=k(["Lcnee","iesKy"]),r=N[t],o="ZCTW";return u(r,{pK:"l6/zrbWoSbcLFwEetFh38rH3ErBZE9H+Cqix3R+wTlfA1wD5B+lUcCQn+EJ60I4RGrm0x1sFjkiLWwB0jAn6BWZv0W4WbqAKriOdeoivxDp1Wmjs3qkEDhvbsjPtfvwx2BHil6o+/tDrdMJQSGs18WZm2PoQLQuL+9VhZ4FNRHUQU3Jtioke/OZEGHJOdYVwvCGalzBad6QFOiVbDBQPePpS3++GJzOxN8SN/7lyS5/IdKiy3WJRaVGkB370+HbN6hKraDfUgReLX26yxRaKC/5aWnGAJ2NnWLoGyAGRcwT9dVjo4bcAZNrrA0U9JVKQxaSskhdv2p49XzJkltXx5w==",aC:"B1"},function(t){(a=_(t,o)).hl=!!r,a.m=r?a.m:-1,e.call(n,a),j(a,n,r,i)},function(){(a=_()).hl=!!r,a.m=r?a.m:-1,e.call(n,a),j(a,n,r,i)}),a}function _(u,s){var t,c,f,l,h,d,n,t={isVd:function(t){var n=this;return t=1===N.Workbook.lm||t,n.s&&!n.e&&(!n.adr||!!n.adr.dsr==!!t)}},d=Y(),n=function(){var t,n,e,i,r,o,a;if(!u)return!1;if(!(t=u[M])||!t.length)return!1;for(i=0,r=t.length;i<r;i++)if(e=(n=t[i])&&n[S]===s){c=n[C];break}if(!e)return!1;if(u[x]&&(h=u[x]),u[I]){if(o=new Date,a=F(u[I]),l=Math.ceil((a-o)/864e5),f=l<=0)return!1}else l=void 0;return!!(d||!u[T]&&!u[A]||z(u[T],u[A])||V(u[T],u[A]))};return t[g]=d,t.s=n(),t[v]=u?u[w]?-1:1:0,t[m]=c,(t[b]=f)||(t[p]=l),t[y]=h,t}function F(t){return new Date(E(t.substr(0,4))||0,E(t.substr(4,2))-1||0,E(t.substr(6,2))||0)}function E(t){return parseInt(t,10)}function j(t,n,e,i){var r,r,o,a,u,s;O(t)?(t&&t.adr&&!0!==t.adr.dsr&&(r=t.adr.flg||[],o=t.m,a=t.d,N.Workbook.et(n,"adlc",{flg:r,checkRs:r={},m:o,d:a,fn:P}),void 0!==r.nwm)&&(t.wm=r.wm,t.nwm=r.nwm,r.dis&&((u=t.disL||[]).push(k(["",r.dis],!0)),t.disL=u),r.state)&&(t[r.state[0]]=r.state[1]),e||(r={},o=t.m,a=t.d,(s=1)!==N.Workbook.lm&&N.Workbook.et(n,"adlc",{flg:[],checkRs:r,m:o,d:a,nl:1}),void 0!==r.nwm&&(t.wm=r.wm,t.nwm=r.nwm)),i||n.repaint&&!n.xT&&n.repaint()):q(n,t)}function P(t,n,e){var i,n,i=["rs"];t&&t[n=k(["",n],!0)]&&t[n][e+i]&&t[n][e+i]()}function G(t,n){var t,e,i,r,o;if(t&&0===t.indexOf("//")&&!((t=t.slice(2).split("/")).length<1))for(e=t[0],i=0,r=n.length;i<r;i++)if((o=n[i])===e)return 1}function U(t,n){for(var e,i,r,o,o,e=0,i=n.length;e<i;e++){if(o=!1,(r=(o=(r=n[e])&&0===r.lastIndexOf("*.",0)?!0:o)?r.slice(2):r)===t)return 1;if(o&&0<(o=t.indexOf("."+r))&&o===t.length-r.length-1)return 1}}function H(t,n){var e,i,r,o;if(t&&4===t.split(".").length)for(e=0,i=n.length;e<i;e++)if((r=n[e])&&0<(o=r.length-2)&&(r===t||".*"===r.substr(o)&&t.substr(0,o)===r.substr(0,o)&&f.test(t)))return 1}function z(t,n){var e,i,e,i;return!!(J()&&(e=a(h),i=a("1agFGc#UHbw5"),e=s[e]&&s[e][i])&&(e=e.toLowerCase(),i=t.split(","),t)&&G(e,i))}function V(t,n){var e,i,e,i,e=a(h),i=a("Zdg3Ga#UHbw5"),e=s[e]&&s[e][i];return!e||(e=e.toLowerCase(),i=t.split(","),t&&U(e,i))||!(!t||!H(e,i))}function Y(){var t=a(h);return Z(s[t])}function Z(t){var n,e,n=a("VdgJHc#wJb59"),e=a("Zdg3Ga#UHbw5");return t&&(W(t[n])||Q(t[n])||K(t[e]))}function W(t){var n=a("MlSZto#Z");return t&&t===n}function Q(t){var n=a("yXbog&w");return t&&t===n}function J(){var t,n,e,t,t=a(h),n=a("VdgJHc#wJb59"),e=a("Udg36Y#oUddV"),t=s[t];return t&&t[n]===e}function K(t){var n,e,i,r,r,n=a("4LJITMx8UMcA"),e=a("jOxo"),i=a("JYw3Gb4NOb6x"),r=a("g1Jbww#Y"),r=new RegExp("^[\\w\\-]+\\."+r+"$","i");return t&&(t===n||t===e||t===i||c.test(t)||r.test(t))}function O(t){return t&&(t.isVd(!1)||t.b&&!t.hl)}function X(e,t){var i,n,r,n,o,n,a,n,u,s,n=(N=t).Workbook.prototype,r=n.Hc;n.Hc=function(){var n=this;if(D(n,function(t){n.ls=t,i=t,n.ul=function(){D(n,function(t){n.ls=t,i=t})}}),!i||O(i))return r.apply(n,arguments)},n.nslc=function(){this.xU=!0},t.PivotTableManager&&(n=t.PivotTableManager.prototype,o=n._Qt,n._Qt=function(){o.apply(this,arguments),i||this.parent||D(this,function(t){i=t})}),n=t.Worksheet.prototype,a=n.Hc,n.Hc=function(){if(i||this.parent||D(this,function(t){i=t}),!i||O(i))return a.apply(this,arguments)},n=t.g7.prototype,u=n.jy,n.jy=function(t,n){u.apply(this,arguments),i&&(-1===i.m||!i.hl&&i.b||i.m&&i.nwm&&(1===i.m||1===i.m&&void 0===i.d))&&e(this.Mf,t,n,i)},s=n.cet,n.cet=function(t,n){s.apply(this,arguments),i&&(-1===i.m||!i.hl&&i.b)&&e(this.Mf,t,n,i)}}function q(t,n){var e,i;function r(){i.width=(0,o.GC$)(e).width(),i.height=(0,o.GC$)(e).height(),et(i.getContext("2d"),i.width,i.height,n)}t.yoe||(t.yoe=!0,e=t.Ti,t.sheets=[],t.mp=[],t.hse=[],t.L0(),e&&(i=document.createElement("canvas"),e.appendChild(i),r(),(0,o.GC$)(window).bind("resize",function(){setTimeout(r,100)})))}function R(t){var n;return new e.Common.ResourceManager(i.SR).getResource()[t]}function $(t,n,e){var t,i,r,o,a,u,s,c,f,l,h,t=R(k([t,"s"])),i=1===N.Workbook.lm?R(k(["ld","se"])):R(k(["lr","su"])),r=nt(t,n);for(i=nt(i,n),r=(r=r.replace("{0}",e.d)).replace("{1}",i).replace("{1}",i),o=[],u=a=0;u<r.length;u++)"\r"!==r[u]&&"\n"!==r[u]||(o.push(r.substring(a,u)),"\r"===r[u]&&u<r.length-1&&"\n"===r[u+1]&&u++,a=u+1);for(a<r.length&&o.push(r.substring(a,r.length)),c=[],f=0,l=(s=e.wm||[]).length;f<l;f++)h=s[f],c.push(""),h instanceof Array?c.push(k(h,!0)):c.push(k(["",h],!0));return 1===e.m&&e.nwm?[].concat(c):e.wm&&0<e.wm.length?o.concat(c):o}function tt(t){return R(k([t,"sa"]))}function nt(t,n){var e,i,r,o,a,e=!0,i="";if(t)if("string"==typeof t)(t=t.trim())&&(r=[t]);else if(Array.isArray(t)){for(o=!0,r=[],a=0;a<t.length;a++)i=t[a].trim(),r.push(i),o&&i&&(o=!1);o&&(r=null)}return r||(e=!1,r=n),k(r,e)}function et(t,n,e,i){var r,o,a,u,s,c,f,r="16pt calibri";if(!i||!i.isVd(!1))for(a=$(o=i.hl?(!i.adr||!i.adr.dsr)&&i.e?"l5":"l4":"l3",d,i),l(t,r),t.fillStyle="black",t.fillRect(0,0,n,e),t.fillStyle="white",u=20,s=30,c=0;c<a.length;c++)f=a[c],t.fillText(f,20,s),s+=25}Object.defineProperty(t,"__esModule",{value:!0}),t.Moe=t.Toe=t.eG=t.Vi=t.Aoe=void 0,e=n("Common"),i=n("./dist/core/core.ns.js"),o=n("./dist/core/util/domUtil.js"),r=n("./dist/core/util/common.js"),l=r.mt.bt,r=n("./dist/core/lc/lcValidator.js"),u=r.Aoe,a=r.Ioe,n="object"==typeof global&&global&&global.Object===Object&&global,r="object"==typeof self&&self&&self.Object===Object&&self,s=n||r||Function("return this")(),c=/^[\w\-]+$/i,f=/^[0-9.]+$/,v="m",m="n",g="b",p="d",b="e",y="adr",w=a("XRsZ"),M=a("HUkJ"),C=a("T&g"),S=a("Q&w"),T=a("GRz1"),A=a("XSzB"),I=a("XRwh"),x=a("WQs5"),h="JYx3Gb#8Pb5R",d=["Ivldlcneky mi pedslsgaeiycmi o edassac.","nai ies e.Ealsra.ae@rpct.o fyune sitne"],t.Aoe=D,t.Vi=X,t.eG=q,t.Toe=$,t.Moe=tt},"./dist/core/lc/lcRegister.js":function(t,n,e){"use strict";var l,n,e,i,r;function o(c){if(r=null,i[0])try{var f=i[0].jS;f&&f.Ti&&l.Aoe(f,function(t){var n,e,i,r,o,a,u,s,n=f.getActiveSheet();if(n&&((e=n.l)&&(t=e),c||e||t.b||-1!==t.m||!t.d||(t.s=!1,l.eG(f,t)),t.nwm))for(r=0,o=i=t.disL||[];r<o.length;r++)(u=n[a=o[r]])&&(s=u.adrs)&&s.apply(u)},!0)}finally{i=[]}}Object.defineProperty(n,"__esModule",{value:!0}),l=e("./dist/core/lc/releaseLc.js"),e=(n=e("./dist/core/util/domUtil.js")).GC$.sd,i=[],n.GC$[e]=function(t,n){i.push(t),n?o(n):r=r||setTimeout(o,5e3*Math.random()+3e3)}},"./dist/core/lc/lcValidator.js":function(t){var n=(e=[function(t,D){!function(t){"use strict";var i,h,d,o,v,t,n,m,e,r;function a(t){var n,e;if("number"==typeof t)for(n=new Array(t),e=0;e<t;++e)n[e]=0;else n=t.slice(0);return(n.buffer=n).byteLength=n.length,"object"===(void 0===t?"undefined":i(t))&&t.buffer&&(n.buffer=t.buffer),n}function u(t,n,e,i){1!=t.length&&t.splice(e,1,i(t.splice(n,1,i(t[e]))[0]))}function s(t,n){var n,e,n=1<arguments.length&&void 0!==n?n:1,e=t.charCodeAt(0);return 65<=e&&e<=90?t.toLowerCase():97<=e&&e<=122?t.toUpperCase():48<=e&&e<=57?d(48+(e-48+10+n)%10):t}function c(t){for(var n,e,i,n=t.split(""),e=function t(n){return s(n,-1)},i=n.length-5;0<=i;i--)u(n,i+1,i+3,e),u(n,i,i+2,e);return n.join("")}function f(t){return t.split("").reverse().join("")}function l(t){var n,e,i,r,o,a,u,s,c,f,l,h,t,d,c=[],f="",d=v,h=t,l=h.length%3;if(0<l)for(;l++<3;)f+="=",h+="\0";for(l=0;l<h.length;l+=3)a=(r=(n=h.charCodeAt(l))<<16|(e=h.charCodeAt(l+1))<<8|(i=h.charCodeAt(l+2)))>>12&63,u=r>>6&63,s=63&r,c[l/3]=d.charAt(o=r>>18&63)+d.charAt(a)+d.charAt(u)+d.charAt(s);return t=(t=c.join("")).slice(0,t.length-f.length)+f}function g(t){for(var n,e,i,r,n,o,a,r,u,s,c,f,l,u=[],f=v,c=t,l=0;l<c.length;l+=4)r=f.indexOf(c.charAt(l)),n=f.indexOf(c.charAt(l+1)),o=f.indexOf(c.charAt(l+2)),a=f.indexOf(c.charAt(l+3)),u[l/4]=d(n=(r=r<<18|n<<12|o<<6|a)>>>16&255,e=r>>>8&255,i=255&r),64==a&&(u[l/4]=d(n,e)),64==o&&(u[l/4]=d(n));return s=u.join("")}function p(t){return(h&&window.atob||g)(t)}function b(t){return(h&&window.btoa||l)(t)}function y(t){return decodeURIComponent(Array.prototype.map.call(p(t),function(t){return"%"+("00"+t.charCodeAt(0).toString(16)).slice(-2)}).join(""))}function w(t){return b(encodeURIComponent(t).replace(/%([0-9A-F]{2})/g,function(t,n){return d(parseInt(n,16))}))}function M(t){var t,n;return t?(t=f(t=c(t)),n=Math.ceil(t.length/2),y(t=(t=(t=t.substr(n)+t.substr(0,n)).replace("#","=")).replace("&","=="))):""}function C(t){for(var n,e,i,r,n=p(t),e=n.length,i=new o(e),r=0;r<e;r++)i[r]=n.charCodeAt(r);return i.buffer}function S(t){for(var n,e,i,r,n=new ArrayBuffer(t.length),e=new o(n),i=0,r=t.length;i<r;i++)e[i]=t.charCodeAt(i);return n}function T(t){return d.apply(null,new o(t))}function A(t){return t.replace(/\+/g,"-").replace(/\//g,"_").replace(/\=+$/,"")}function I(t){for(var n,e,i,r,o,a,n=0,e=5381,i=0,r=t.length-1;0<=r;r--)n=(o=t.charCodeAt(r))+(n<<6)+(n<<16)-n,e=o+((e<<5)+e),i=o+((i<<5)-i),i&=i;return(a=(a=n^e^i)<0?~a:a).toString(16).toUpperCase()}function x(t){t&&JSON.parse(t)}function N(t,n){try{n="#"+n;var e=t.indexOf(n);if(-1<e)return{prefix:t.substring(0,e),licData:JSON.parse(M(t.substr(e+n.length)))}}catch(t){}return!1}function k(e){return"oncomplete"in e&&(e.then=function(t,n){e.resolve=t,e.reject=n},e.oncomplete=function(t){e.resolve(e.result)},e.onerror=function(){e.reject()}),e}Object.defineProperty(D,"__esModule",{value:!0}),i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},h="undefined"!=typeof window,d=String.fromCharCode,o=h&&window.Uint8Array||a,v="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",t="object"==(void 0===t?"undefined":i(t))&&t&&t.Object===Object&&t,n="object"==("undefined"==typeof self?"undefined":i(self))&&self&&self.Object===Object&&self,m=t||n,e=D.iDe=M,D.attorn=function t(n,e,i,r){var o,n,a,u,s,n,c,n,f,o=h?window.msCrypto||window.crypto:void 0,n=N(n,e.aC);return n?(a=n.licData,u=n.prefix+"#"+e.aC,s=T(C(w(u+JSON.stringify(a.D)))),n=M("JYx3Gb#8Pb5R"),c=M("VdgJHc#wJb59"),(!m[n]||!m[n][c]||location.protocol.match(/^https/i))&&o&&o.subtle?(n={alg:"PS256",e:"AQAB",kty:"RSA",n:A(e.pK)},n=window.msCrypto?S(JSON.stringify(n)):n,void k(o.subtle.importKey("jwk",n,f={name:"RSA-PSS",saltLength:32,hash:{name:"SHA-256"}},!1,["verify"])).then(function(t){k(o.subtle.verify(f,t,C(a.S),S(s))).then(function(t){return t?i(a.D):r()})},l)):l()):r();function l(){return I(u+JSON.stringify(a.D))===a.H?i(a.D):r()}}}.call(D,function(){return this}())}],i={},r.m=e,r.c=i,r.p="dist",r(0)),e,i;function r(t){var n;return(i[t]||(n=i[t]={exports:{},id:t,loaded:!1},e[t].call(n.exports,n,n.exports,r),n.loaded=!0,n)).exports}t.exports={Aoe:n.attorn,Ioe:n.iDe}},"./dist/core/lc/releaseLc.js":function(t,n,e){"use strict";var M,e,C,S,T;function i(n,t,e,i){var r,o,a,u,s,c,f,l,h,d,v,m,g,p,b,y,w,r=n.Fi(),o=203,a=n.parent,u="11pt calibri",s=i.hl&&i.isVd(!1)&&i.d,c=a&&a.xU,f="";for(s?l="l2":i.e?l="l5":i.hl&&!i.d?l="l6":h=M.Moe(l="l1"),r=r||n.Fi(),d=M.Toe(l,S,i),v=0,h&&d.forEach(function(t){v=T(v,n.Qt(t,u))}),n.l=d[0]?i:void 0,m=0;m<d.length&&(203<r.width||203<r.height)&&!c;m++)f=d[m],g=v||n.Qt(f,u),y=r.width-g-(p=10),w=r.height-10-(b=20)*(d.length-m),!t||e&&!e.intersect(y,w,g,20)||(t.save(),t.fillStyle="rgba(0, 0, 0, 0.5)",C(t,u),e&&(t.rect(e.x,e.y,e.width,e.height),t.clip(),t.beginPath()),t.fillText(f,y,20+w),f&&(n.l=i),t.restore())}function r(t){M.Vi(i,t)}Object.defineProperty(n,"__esModule",{value:!0}),n.eG=n.Aoe=n._pt=n.Vi=void 0,M=e("./dist/core/lc/common.js"),e=e("./dist/core/util/common.js"),C=e.mt.bt,S=["LcneNtFud\no edavldlcnekyt u pedSet.\neprr esaeaalbefreauto.\nfyuprhsdalcne orkyi nyu ucaecnimto mi.\nmi sslsgaeiycmi o edassac.","ies o on\rYune  ai ies e ornSra.hes\rTmoayky r vial o vlain\rI o ucae  ies,yu e si orprhs ofraineal\rEalu.ae@rpct.o fyune sitne"],T=Math.max,n.Vi=r,n._pt=1,n.Aoe=M.Aoe,n.eG=M.eG},"./dist/core/util/basedialog.js":function(t,n,e){"use strict";var i,r,e,l,a,u,s,h,c,o,f,d,v,e,m,g,p;function b(t,n,e){this.Bc="gc-popup",this.Lc="gc-overlay",this.Fc=null;var i=this;i.Ti=t,i.Pc=e,i.Gc={position:"fixed",width:"100%",height:"100%",margin:0,padding:0,top:0,left:0,border:"none",zIndex:n=n||0,backgroundColor:"rgba(0,0,0,0)"},i.Uc={position:"absolute",padding:0,margin:0,height:"auto",zIndex:n+1,outline:"none"},i.Hc()}function y(t,n,e){var o=p.call(this,t,n,e)||this;return o.wse=!1,o.Mse={mouseOriginalX:0,mouseOriginalY:0,domOriginalX:0,domOriginalY:0,domWidth:0,domHeight:0,parentRect:null,screenWidth:0,screenHeight:0},o.Cse=function(t){var n,e,t,e,i,t,r,i,t,n=o;n.wse&&n.mouseInScreen(t.pageX-window.scrollX,t.pageY-window.scrollY)&&(e=t.pageX,t=t.pageY,i=e-(e=n.Mse).mouseOriginalX,t=t-e.mouseOriginalY,e.parentRect)&&(r=n.Wc[0],i=Math.max(0,e.domOriginalX+Math.min(i,e.screenWidth-e.domOriginalX-e.domWidth+(n.Pc?0:window.scrollX))),t=Math.max(0,e.domOriginalY+Math.min(t,e.screenHeight-e.domOriginalY-e.domHeight+(n.Pc?0:window.scrollY))),r.style.left="".concat(i,"px"),r.style.top="".concat(t,"px"))},o.Ase=function(){window.removeEventListener("mousemove",o.Cse),o.wse=!1},o}i=this&&this.__extends||(g=function(t,n){return(g=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(t,n){t.__proto__=n}:function(t,n){for(var e in n)Object.prototype.hasOwnProperty.call(n,e)&&(t[e]=n[e])}))(t,n)},function(t,n){if("function"!=typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function e(){this.constructor=t}g(t,n),t.prototype=null===n?Object.create(n):(e.prototype=n.prototype,new e)}),Object.defineProperty(n,"__esModule",{value:!0}),n.Tse=n.zc=void 0,r=e("./dist/core/util/common.js"),e=e("./dist/core/util/domUtil.js"),l=e.GC$,a=r.util.En,u=r.util.Tt,s=r.util.vi,h=document,c=window,o=c.Vc,f="touchstart",d="MSPointerDown",v="pointerdown",b.prototype.Hc=function(){var t=this;t.Yc(t.Zc)?t.Wc=l("#"+t.Zc):(t.Zc=t.Qc(),t.Kc=t.Lc+"-"+t.Zc,t.Jc=t.Bc+"-"+t.Zc,t.Wc=l(a("div")).addClass(t.Jc+" ui-widget").attr({id:t.Zc,tabIndex:-1}).css(t.Uc))},b.prototype.Qc=function(){for(var t,n,t=0,n="gc-dialog";this.Yc(n+t.toString());)t++;return n+t.toString()},b.prototype.Xc=function(){if(this.Wc)return this.Wc},b.prototype.qc=function(){return this.Ti||h.body},b.prototype.$c=function(t){var n=this,e=n.Wc;n.tf()||n.nf(),o.ef(),n.Yc(n.Zc)||(l(n.qc()).append(e),n.if(),e.css("display","none")),e.show(t)},b.prototype.rf=function(){return"block"===this.Wc.css("display")},b.prototype.close=function(){var t=this;t.af(),t.Yc(t.Zc)&&t.Wc.remove(),l("."+t.Jc).isVisible()||t.uf(),o.cf()},b.prototype.uf=function(){l("."+this.Kc).remove(),this.Fc=null},b.prototype.af=function(){var n=this.Zc;[f,d,v].forEach(function(t){l(h).unbind(t+"."+n)})},b.prototype.if=function(){var t,n,n,e,i,r,o,a,u,s,c,s,f,t=this.Wc,n=this.qc();0===t.length||(n=l(n).offset(),e=parseInt(t.css("left"),10)+n.left,i=parseInt(t.css("top"),10)+n.top,r=t.width(),o=t.height(),isNaN(e))||isNaN(i)||isNaN(r)||isNaN(o)||(c=(s=h.documentElement).clientWidth,s=s.clientHeight,(f=t[u=a=0].getBoundingClientRect()).left+r>c&&(u=f.left+r-c),f.top+o>s&&(a=f.top+o-s),(e<0||i<0||0<a||0<u)&&t.css({left:(e=(e-=u)<0?0:e)-n.left+"px",top:(i=(i-=a)<0?0:i)-n.top+"px"}))},b.prototype.Yc=function(t){return 0<l("#"+t).length},b.prototype.nf=function(){var e,n,t,i,r,o,e=this,n=e.Zc,t=l(a("div")).addClass(e.Kc),i=e.Wc;(e.Fc=t).css(e.Gc),l(e.qc()).append(t),(r=u&&u.mozilla)&&(o=(new Date).valueOf()),t.bind("mousedown",function(t){if(!e.Pc){var n;if(r)if((new Date).valueOf()-o<100)return;e.close(),r&&e.ff&&clearTimeout(e.ff)}s(t)}),t.bind("contextmenu",function(t){e.Pc&&s(t)}),i.bind("contextmenu",function(t){s(t)}),[f,d,v].forEach(function(t){l(h).bind(t+"."+n,function(t){var n=t.target;e.Fc&&!e.lf(n)&&(e.Pc||(r?e.ff=c.setTimeout(function(){e.close()},100):e.close()),s(t))})})},b.prototype.hf=function(t,n){for(var e=t;n&&n!==document.body;){if(n===e)return!0;n=n.parentNode}return!1},b.prototype.lf=function(t){return!!this.Wc&&this.hf(this.Wc.get(0),t)},b.prototype.tf=function(){return 0<l("."+this.Kc).length},n.zc=e=b,i(y,p=e),y.prototype.bindMoveEvent=function(t){var i=this;t.addEventListener("mousedown",function(t){var n,e,t,t,n=i.Wc[0],e=i.Mse;e.mouseOriginalX=t.pageX,e.mouseOriginalY=t.pageY,t=n.getBoundingClientRect(),e.domOriginalX=t.left+(i.Pc?0:window.scrollX),e.domOriginalY=t.top+(i.Pc?0:window.scrollY),e.domWidth=t.width,e.domHeight=t.height,(t=n.offsetParent)?e.parentRect=t.getBoundingClientRect():"fixed"===n.style.position&&(e.parentRect=n.getBoundingClientRect()),e.screenWidth=window.innerWidth,e.screenHeight=window.innerHeight,i.wse=!0,window.addEventListener("mousemove",i.Cse)}),document.addEventListener("mouseup",i.Ase)},y.prototype.mouseInScreen=function(t,n){return 0<=t&&t<=this.Mse.screenWidth&&0<=n&&n<=this.Mse.screenHeight},n.Tse=y},"./dist/core/util/common.js":function(a,f,t){"use strict";var h,s,n,T,F,P,G,C,U,H,z,d,V,A,Y,Z,W,t,Q,J,l,v,K,X,q,$,m,I,tt,x,N,g,nt,et,it,rt,ot,at,ut,st,p,b,ct,ft,lt,ht,dt,vt,mt,gt,pt,bt,yt,wt,Mt,Ct,St,Tt,At,y,w,It,xt,u,Nt,kt,Dt,_t,Et,jt,Ot,Rt,s,Bt,Lt,Ft,Pt,Gt,Ut,Ht,zt,Vt,Yt,Zt,Wt,Qt,Jt,s,n,t,Kt,Xt;function qt(t){return t!==m}function $t(t){return v.createElement(t)}function tn(t){v.body&&v.body.insertBefore(t,I)}function nn(t,e,i){Object.defineProperty(t,e,{get:function(){return this._ps[e]},set:function(t){var n=this._ps[e];n!==t&&(this._ps[e]=t,i)&&i(e,t,n)},enumerable:!0})}function en(t,n){var t;return t.style&&t.style.vertAlign?(t=G.W.V(n,1)).fontSize*ot+"px "+t.fontFamily:n}function rn(t){return t.preventDefault?(t.preventDefault(),t.stopPropagation()):(t.cancelBubble=!1,t.returnValue=!1),!1}function on(t){var n,e,i,n=!1;if(t)for(e=0;e<t.length;e++)if(11904<=(i=t.charCodeAt(e))&&i<12032||12288<=i&&i<40960||43360<=i&&i<43392||63744<=i&&i<64256){n=!0;break}return n}function an(t){return Math.random().toString(16).slice(-t)}function un(e){return function(t,n){return String.fromCharCode(parseInt(n,e))}}function sn(t){if(!t||"string"!=typeof t)return!1;var n;switch((t=t.toLowerCase())[0]){case"b":return 0===t.indexOf("background ");case"t":return 0===t.indexOf("text ");case"a":return 0===t.indexOf("accent ");case"h":return 0===t.indexOf("hyperlink");case"f":return 0===t.indexOf("followedhyperlink");default:return!1}}function cn(t,n,e){var i,r,o,a,i=0,o=t.split(" ");if(3<=o.length&&(i=parseFloat(o[2]),isNaN(i)||(i/=100)),"Background 1"===t.substring(0,12)&&(r=n?243:0),"Text 1"===t.substring(0,6)&&(r=n?241:1),"Background 2"===t.substring(0,12)&&(r=n?244:2),"Text 2"===t.substring(0,6)&&(r=n?242:3),"Accent 1"===t.substring(0,8)&&(r=4),"Accent 2"===t.substring(0,8)&&(r=5),"Accent 3"===t.substring(0,8)&&(r=6),"Accent 4"===t.substring(0,8)&&(r=7),"Accent 5"===t.substring(0,8)&&(r=8),"Accent 6"===t.substring(0,8)&&(r=9),"hyperlink"===t.substring(0,8)&&(r=10),(r="followedHyperlink"===t.substring(0,8)?11:r)!==m)return{n_:a=e||"color",theme:r,tint:i}}function fn(t,n){var e=t.tint?Math.round(100*t.tint):0,t=+t.theme;return 0==t||243==t?"Background 1 "+e:1==t||241==t?"Text 1 "+e:2==t||244==t?"Background 2 "+e:3==t||242==t?"Text 2 "+e:4==t?"Accent 1 "+e:5==t?"Accent 2 "+e:6==t?"Accent 3 "+e:7==t?"Accent 4 "+e:8==t?"Accent 5 "+e:9==t?"Accent 6 "+e:10==t?"hyperlink":11==t?"followedHyperlink":void 0}function c(){}function ln(t){return bt.getIndexedColor(+t.indexed)}function hn(t,n){var t,e,t=bt.convertColorToHex(t);if(t)return{n_:e=n||"color",rgb:t}}function k(){}function dn(t){t=t.toLowerCase();var t=/(chrome)[ \/]([\w.]+)/.exec(t)||/(webkit)[ \/]([\w.]+)/.exec(t)||/(opera)(?:.*version|)[ \/]([\w.]+)/.exec(t)||/(msie) ([\w.]+)/.exec(t)||t.indexOf("compatible")<0&&/(mozilla)(?:.*? rv:([\w.]+)|)/.exec(t)||[];return{browser:t[1]||"",version:t[2]||"0"}}function vn(){var n,e,n=I,e=!1;try{new ActiveXObject("")}catch(t){n=t.name}try{e=!!new ActiveXObject("htmlfile")}catch(t){e=!1}return!(e="ReferenceError"===n||!1!==e)}function mn(){}function gn(t,n){var e=$t("span");return e.className=t,n&&(e.id=n),e.style.display="none",tn(e),e}function pn(t,n,e,i){t.addEventListener(n,e,i)}function bn(t){var n,e,n=t.currentStyle,e=v.defaultView;return n=e&&e.getComputedStyle?e.getComputedStyle(t,""):n}function yn(t){var n,n,e,i,e,n,r,o,n=l.Vc;0<n.vf||(16!==t.keyCode&&(n.mf=!0),(e=(n=It.ai())&&n.gf)&&(i=C(e)).isVisible())||n&&n.rt&&n.rt.pf&&(n.rt.pf(t),n.isEditing()||(e=t.keyCode,n=t.ctrlKey,r=t.altKey,o=t.shiftKey,90!==e&&89!==e||!n||r?86!==e||!n||r||o||t.stopPropagation&&t.stopPropagation():rn(t)))}function wn(t){var n,n,n=l.Vc;0<n.vf||(n.mf=!1,(n=It.ai())&&n.rt&&n.rt.bf&&n.rt.bf(t))}function Mn(t){var n,e,n;0<l.Vc.vf||(e=It.ai())&&e.rt&&e.rt.yf&&e.rt.yf(t)}function Cn(t){var n,n,n=l.Vc;0<n.vf||!0!==n.mf&&(n=It.ai())&&n.rt&&n.rt.yf&&n.rt.yf(t)}function Sn(t){return v.all===m&&It.ai()&&rn(t),!1}function e(){this.vf=0,this.wf=[],this.mf=!1,this.Hc()}function r(){}function Tn(t,n){this.x=t,this.y=n}function M(t,n,e,i){var r=this;r.x=t,r.y=n,r.width=e,r.height=i}function S(t,n,e,i){var r=this;r.row=t,r.rowCount=e,r.col=n,r.colCount=i}function An(t,n,e,i){return new _t(t,n,e,i)}function In(t,n){var e,i,r,t;if(t&&n){if(e=N(t.row,n.row),i=N(t.col,n.col),r=g(t.row+t.rowCount-1,n.row+n.rowCount-1),t=g(t.col+t.colCount-1,n.col+n.colCount-1),0<=e&&0<=i)return new _t(e,i,r-e+1,t-i+1);if(0<=e)return new _t(e,-1,r-e+1,-1);if(0<=i)return new _t(-1,i,-1,t-i+1)}return new _t(-1,-1,-1,-1)}function xn(){}function i(){}function o(t){this.Mf=t}function D(){}function Nn(t){var n=t.Cf||{scaleX:1,scaleY:1,translateX:0,translateY:0,skewX:0,skewY:0,orgTranslateX:0,orgTranslateY:0};return t.Cf=n}function kn(){}function Dn(t,n){t&&(t.Sf=n)}function _n(t,n){t&&(t.Tf=n)}function En(t,n){t.Af=n}function jn(t,n){t.If=n}function _(){}function E(){return Ft.xf||(Ft.xf=$t("canvas").getContext("2d")),Ft.xf}function On(t){return h.Common.CultureManager.Fe().lse(t)}function j(t){for(var n=t.length-1;" "===t.charAt(n);)n--;return t=n!==t.length-1?t.substring(0,n+1):t}function Rn(t){var n,e,n=t instanceof Array?[]:{};for(e in t)t.hasOwnProperty(e)&&(n[e]="object"==typeof t[e]&&t[e]!==I?Rn(t[e]):t[e]);return n}function Bn(t,n,e,i,r){var o,a,u,s,c,f,l,h,d,v,h,o=[],a=r||E();if(a){for(s=e?(c=t.length*i,x(n/i)):(u=(c=w(a,a.font,t))/t.length,x(n/u));n<c&&t;)for(f=!1,l=s;;){if(t.length<l){o.push(t),t="";break}if(h=t.substring(0,l),d=e?l*i:w(a,a.font,h),(d="-"===h.charAt(h.length-1)?e?l*i:w(a,a.font,h)-w(a,a.font,"-"):d)===n||f&&d<n){o.push(h),t=t.substring(l),c-=d;break}if(n<d){if(1===h.length){(v=t.substring(h.length)).trim()?(o.push(h),t=t.substring(l),c-=d):(o.push(t),t="");break}--l,f=!0}else l+=h=1<=(h=e?(n-d)/i:(n-d)/u)?h:1}t&&-1===t.search(/^[ ]*$/)&&o.push(t)}return o}function Ln(t,n,e,i,r,o){var a,u,s,c,f,l,h,d,v,m,g,p,a=o||E();if(!a)return[t];for(u=[],c=n,f=[],l=s=0;l<t.length;l++)if(h=t[l].style&&t[l].style.font||r,d=y.vt(h),h=en(t[l],h),t[l].text&&0<t[l].text.length?s+=i?d*t[l].text.length:w(a,h,t[l].text):s=0,s<c)f.push(t[l]);else for(s-=i?d*t[l].text.length:w(a,h,t[l].text),v=0,m=t[l].text.length;v<m;v++){if(e<(g=i?d:w(a,h,t[l].text.charAt(v)))&&0===v){0<f.length&&(u.push(f),f=[]),f.push({style:t[l].style,text:t[l].text.substring(0,1)}),u.push(f),f=[],(p=t[l].text.substring(1,t[l].text.length)).length&&t.splice(l+1,0,{style:t[l].style,text:p}),s=0,c=e;break}if(c<(s+=g)){f.push({style:t[l].style,text:t[l].text.substring(0,v)}),u.push(f),f=[],(p=t[l].text.substring(v,t[l].text.length)).length&&t.splice(l+1,0,{style:t[l].style,text:p}),s=0,c=e;break}v===m-1&&(f.push({style:t[l].style,text:t[l].text}),u.push(f),f=[],s=0,c=e)}return 0<f.length&&u.push(f),u}function Fn(t,n,e,i,r){var o,a,u,r,r,s,c,f,l,h,d,v,m,m,g,p,b,o=[],a=On(t),u=r||E();if(u){for(r=w(u,u.font,t),r=e?i:r/t.length,s=et(n/r+"",10),h=l=f=c=0,v=!(d=[]);h<a.length;){if(!1===v){if(m=a[h],d.push(m),(f+=m.length)<s&&h<a.length-1){h++;continue}l=f,f=0}if(n<(m=e?d.join("").length*i:Ft.Wt(d.join(""),u.font,!0,u)))if(g=d.pop(),0===d.length){for(p=Bn(g,n,e,i,u),b=0;b<p.length-1;b++)o[c]=p[b],c++;1===p.length&&(o[c]=p[0],c++),2<=p.length?a[h]=p[p.length-1]:h++,v=!1}else v=!0,h--;else m<n&&!0===v||m===n?(v=!1,o[c]=j(d.join("")),c++,d=[],h++):m<n&&(h++,f=l)}0!==d.length&&(o[c]=j(d.join("")))}return o}function Pn(t,n,e,i,r){var o,a,u,s,c,f,l,h,d,v,m,g,p,o=[],a=r||E();if(a)if(0===t.length)o.push({textLength:0,text:"",textInfos:[{style:{font:e},text:""}]});else{for(s=[],c=u=0;c<t.length;c++){for(f=t[c],d=h=l=0;d<f.length;d++)v=void 0,v=f[d].style&&f[d].style.font?f[d].style.font:e,i?l+=(h=y.vt(v))*f[d].text.length:A(f[d].text)||(v=en(f[d],v),l+=w(a,v,f[d].text));if(n<l){for(0<s.length&&(o.push({textLength:u,text:j(Un(s)),textInfos:Rn(s)}),s=[],u=0),m=Ln(f,n-u,n,i,e,a),s=s.concat(m[0]),A(m[0])||o.push({textLength:u+Gn(m[0],e,i,a),text:j(Un(s)),textInfos:Rn(s)}),s=[],u=0,g=1;g<m.length-1;g++)A(m[g])||o.push({textLength:Gn(m[g],e,i,a),text:j(Un(m[g])),textInfos:Rn(m[g])});1<m.length&&(p=m[m.length-1],s=s.concat(p),A(p)||(u+=Gn(p,e,i,a)))}else n<u+l?(o.push({textLength:u,text:j(Un(s)),textInfos:Rn(s)}),s=(s=[]).concat(f),u=l):(s=s.concat(f),u+=l)}0<s.length&&o.push({textLength:u,text:j(Un(s)),textInfos:Rn(s)})}return o}function Gn(t,n,e,i){for(var r,o,a,u,s,r=0,o=i||E(),a=0;a<t.length;a++)u=t[a].style&&t[a].style.font||n,s=en(t[a],u),r+=e?y.vt(u)*t[a].text.length:w(o,s,t[a].text);return r}function Un(t){for(var n,e,n="",e=0;e<t.length;e++)n+=t[e].text;return n}function Hn(t,n,e,i){for(var r,o,a,u,s,c,c,r=-1,o=!0,a=0;a<n.length;a++)if(!A(n[a].text))for(u=0;u<n[a].text.length;u++)s=n[a].text.charAt(u),c=n[a].style?n[a].style.font:e,y.bt(t,c),c=y.vt(c)," "===s||o?" "!==s&&o&&(r=i?c:w(t,e,s),o=!1):r=N(r,i?c:w(t,e,s));return r}function O(){}function zn(){this.Nf={}}function Vn(){}function Yn(t){var n,e,n,i,e,n,e,e,n=t.getRangeAt(0),e=n.startContainer,n=n.startOffset,i;Wn(e)&&(e=ne(e,n))&&e.zeroWidthCharNode&&(n=e.zeroWidthCharNode,(e=t.getRangeAt(0)).setStart(n,1),e.deleteContents(),(e=v.createRange()).setStart(n,1),e.setEnd(n,1),t.removeAllRanges(),t.addRange(e),rn(event))}function Zn(t){return t.textContent&&1===t.textContent.length&&t.textContent.split("")[0]===dt}function Wn(t){return t.textContent&&t.textContent.split("")[0]===dt}function Qn(t,n,e){if(1===n&&R(e.firstChild)&&R(e.firstChild.firstChild)){var n=e.firstChild.firstChild.lastChild,i=void 0;if(t===e)return 1===(i=n.textContent).length&&i[0]!==dt&&Jn(n.previousSibling);if(n===t||Jn(n)&&t===n.previousSibling)return 1===(i=t.textContent).length&&i[0]!==dt&&Jn(t.previousSibling)}}function R(t){return t&&"SPAN"===t.tagName}function Jn(t){return t&&"BR"===t.tagName}function Kn(t){return t&&"DIV"===t.tagName}function Xn(t){return t instanceof Text}function qn(t){var n;return!!t&&(n=t.childNodes,R(t))&&2===n.length&&Jn(n[0])&&te(n[1])}function $n(t,n){var e;if(t)return e=t.childNodes,R(t)&&Jn(e[n-2])&&te(e[n-1])}function te(t){if(t&&Xn(t)){var t=t.textContent;if(1===t.length&&oe(t[0]))return!0}return!1}function ne(t,n){var e,i,r,o,i,e,n,e=t.childNodes.length,o;if(!oe((t.innerText||t.textContent)[0])||0!==n&&1!==n)if(0===n)i=(i=ae(r=(r=t)===t.parentNode.firstChild?t.parentNode:r,qn))&&i.lastChild;else{if(Kn(t))return 1===e&&1===n?i=t.firstChild.firstChild.lastChild:1<e&&n===e&&(i=t.lastChild),te(i)?{zeroWidthCharNode:i,previousTextNode:i.previousSibling.previousSibling}:qn(i)?{zeroWidthCharNode:i,previousTextNode:ae(r,Xn)}:I;!R(t)||n!==e&&n!==e-1||(qn(t)?i=t:qn(t.lastChild)?i=t.lastChild:$n(t,n)&&(i=t.childNodes[n-1]))}else i=t;return i?(R(i)?r=i:Xn(i)&&(r=(e=i.previousSibling)===(n=i.parentNode).firstChild?n:e),{zeroWidthCharNode:i,previousTextNode:ae(r,Xn)}):I}function ee(t){var n,t,e,i,r,t,n=t.anchorNode,t=t.anchorOffset,e=n.textContent,i;if(t!==e.length)return 0===t&&oe(e[0])?{node:n,offset:0}:I;if(t=void 0,!(r=ue(n)))return I;if(R(r)&&oe(r.textContent[0])){for(;R(r.firstChild);)r=r.firstChild;t=r.childNodes[1]}else Jn(r)&&oe(r.nextSibling.textContent[0])&&(t=r.nextSibling);return{node:t,offset:1}}function ie(t,n,e,i,r,o){for(var a,u,s,c,f,l,h,d,a="",u=t.childNodes,s=u.length,c=0;c<s;c++)R(f=u[c])?a+=ie(f,n,e,i,r,o):Xn(f)?(l=n&&n.startContainer,h=n&&n.endContainer,d=f.textContent,f===l||f===h?l!==h?o=f===l?(a+=re(d,e,d.length,r),!0):(a+=re(d,0,i,""),!1):a+=re(d,e,i,r):o||(a+=d)):Jn(f)&&!o&&(a+="\n");return a}function re(t,n,e,i){var r,o,r,o;return t.substr(0,n)+i+t.substr(e,t.length-e)}function oe(t){return t===dt}function ae(t,n){for(var e=t&&t.previousSibling;e;){if(n(e))return e;e=e.lastChild}return I}function ue(t){for(var n,e,n=t;n;){if(n!==(e=n.parentNode).lastChild)return n.nextSibling;n=e}return I}function se(t){var n,t;return n=t&&!(n=t.getActiveSheet())&&(t=t.getActiveSheetTab())?t.Mf:n}function ce(t,n){var e,i;t&&((e=t._f(n))?t.setActiveSheet(n):(i=t.Efe(n))&&t.setActiveSheetTab(n))}function fe(t,n){var e,t,e=t._f(n);return e||(t=t.Efe(n))&&(e=t.Mf),e}function le(t){return"="===t||"+"===t||"-"===t}function he(t){var n=0;return"+"!==t[n]&&"-"!==t[n]||(n+=1),t.length>n&&"%"===t[n]?t.length>n+1&&("-"===t[n+1]||"+"===t[n+1])?NaN:Number(t.slice(n+1)):0<t.length&&"%"===t[t.length-1]?Number(t.slice(0,t.length-1)):Number(t)}function de(t){return t&&0<t.length&&le(t[0])&&isNaN(he(t))&&!le(t)}function ve(){}function me(){var t=this;t.rowInfo={},t.colInfo={},t.wholeCols={},t.wholeRows={}}function ge(){this.reset()}function pe(t,n){var n=Math.pow(10,n);return Math.round(t*n)/n}function B(){}function L(){}function be(){var t,n,e,i,r,t=this;try{e="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol?"symbol":typeof t},i="object"===("undefined"==typeof global?"undefined":e(global))&&global&&global.Object===Object&&global,r="object"===("undefined"==typeof self?"undefined":e(self))&&self&&self.Object===Object&&self,n=i||r||t}catch(t){}return n}function ye(t,n){this.numberFormatId=t,this.numberFormatCode=n}function we(t){return!1===t}function Me(t){var n,e,i,r,o,a;t&&(n=t.applyFont,e=t.applyFill,i=t.applyBorder,r=t.applyAlignment,o=t.applyNumberFormat,a=t.applyProtection,!1===n&&(delete t.foreColor,delete t.textDecoration,delete t.themeFont,delete t.font),!1===e&&delete t.backColor,!1===i&&(delete t.borderLeft,delete t.borderTop,delete t.borderRight,delete t.borderBottom,delete t.diagonalDown,delete t.diagonalUp),!1===r&&(delete t.textIndent,delete t.wordWrap,delete t.hAlign,delete t.vAlign,delete t.isVerticalText,delete t.shrinkToFit,delete t.textOrientation),!1===o&&delete t.formatter,!1===a)&&delete t.locked}Object.defineProperty(f,"__esModule",{value:!0}),f.AL=f.ExcelNumerFormat=f.ExtendedNumberFormatHelper=f.SJSColumnWidthHelper=f.unknownFontMaxDigitWidthMap=f.SharedStrings=f.NUMBER_ARRAY=f.BaseUsedRange=f.UsedRangeUtil=f.kf=f.Df=f._f=f.Ef=f.jf=f.Of=f.di=f.Rf=f.$e=f.q=f.zt=f.Bf=f.Lf=f.Be=f.Ff=f.Events=f.Pf=f.getUnionRange=f.Ec=f.Range=f.Rect=f.Point=f.I=f.hi=f.mt=f.util=f.ColorHelper=f.isThemeColor=f.findControl=f.getTypeFromString=f.CursorResource=f.productInfo=f.isDefined=f.FormulaPrefix=f.FallbackFontFamily=void 0,h=t("Common"),s=t("./dist/core/util/domUtil.js"),n=t("./dist/core/core.ns.js"),T=t("./dist/core/core.enum.js"),F=t("./dist/core/excel-io-util/common.js"),P=t("CalcEngine"),G=t("./dist/core/worksheet/stylehelper.js"),C=s.GC$,U=C.extend,H=h.Common.st,z=h.Common.Uf.Gf,d=h.Formatter&&h.Formatter.GeneralFormatter,V=h.Formatter&&h.Formatter.Hf,A=h.Common.lt.ht,Y=F.StringEx.Xi,Z=h.Common.zf,W=!!P,t=new h.Common.ResourceManager(n.SR),Q=t.getResource.bind(t),f.FallbackFontFamily='"Helvetica Neue", Arial, sans-serif',J=F.Util.addXLFNPrefix,l=window,v=document,K="boolean",X="date",q="undefined",$="function",m=void 0,I=null,tt=Math.floor,x=Math.ceil,N=Math.min,g=Math.max,nt=Math.round,et=parseInt,it=parseFloat,rt=isNaN,ot=.7,at="px",ut=" ",st=".",p="string",b="number",ct="touch",ft="MSPOINTER_TYPE_TOUCH",lt=new RegExp("^/Date\\((-?\\d+)([-+]{1}\\d+)?\\)/\\s*$"),ht=new RegExp("^/OADate\\(([-+]?(\\d+(\\.\\d*)?|\\.\\d+)([eE][-+]?\\d+)?)\\)/\\s*$"),dt="\u200b",f.FormulaPrefix=["=","+","-"],f.isDefined=qt,f.productInfo={productVersion:"16.1.0"},f.CursorResource={ResizeCol:"col-Resize",ResizeRow:"row-resize",ResizeHiddenCol:"w-resize",ResizeHiddenRow:"n-resize"},f.getTypeFromString=vt=function(t){var n,e,i,r,o,n=!1,e=l;if(typeof t==p){for(r=0,o=(i=t.split(".")).length;r<o&&e;r++)e=e[i[r]];e&&r===o&&0<o&&(n=!0)}return n?e:m},f.findControl=mt=function(t){return typeof t==p&&(t=v.getElementById(t)),C(t).data("workbook")},f.isThemeColor=sn,gt=[4278190080,4294967295,4294901760,4278255360,4278190335,4294967040,4294902015,4278255615,4278190080,4294967295,4294901760,4278255360,4278190335,4294967040,4294902015,4278255615,4286578688,4278222848,4278190208,4286611456,4286578816,4278222976,4290822336,4286611584,4288256511,4288230246,4294967244,4291624959,4284874854,4294934656,4278216396,4291611903,4278190208,4294902015,4294967040,4278255615,4286578816,4286578688,4278222976,4278190335,4278242559,4291624959,4291624908,4294967193,4288269567,4294941132,4291598847,4294954137,4281558783,4281584844,4288269312,4294953984,4294940928,4294927872,4284901017,4288059030,4278203238,4281571686,4278203136,4281545472,4288230144,4288230246,4281545625,4281545523,4278190080,4294967295],pt={aliceblue:4293982463,antiquewhite:4294634455,aqua:4278255615,aquamarine:4286578644,azure:4293984255,beige:4294309340,bisque:4294960324,black:4278190080,blanchedalmond:4294962125,blue:4278190335,blueviolet:4287245282,brown:4289014314,burlywood:4292786311,cadetblue:4284456608,chartreuse:4286578432,chocolate:4291979550,coral:4294934352,cornflowerblue:4284782061,cornsilk:4294965468,crimson:4292613180,cyan:4278255615,darkblue:4278190219,darkcyan:4278225803,darkgoldenrod:4290283019,darkgray:4289309097,darkgreen:4278215680,darkkhaki:4290623339,darkmagenta:4287299723,darkolivegreen:4283788079,darkorange:4294937600,darkorchid:4288230092,darkred:4287299584,darksalmon:4293498490,darkseagreen:4287609999,darkslateblue:4282924427,darkslategray:4281290575,darkturquoise:4278243025,darkviolet:4287889619,deeppink:4294907027,deepskyblue:4278239231,dimgray:4285098345,dodgerblue:4280193279,feldspar:4291924597,firebrick:4289864226,floralwhite:4294966e3,forestgreen:4280453922,fuchsia:4294902015,gainsboro:4292664540,ghostwhite:4294506751,gold:4294956800,goldenrod:4292519200,gray:4286611584,green:4278222848,greenyellow:4289593135,honeydew:4293984240,hotpink:4294928820,"indianred ":4291648604,"indigo ":4283105410,ivory:4294967280,khaki:4293977740,lavender:4293322490,lavenderblush:4294963445,lawngreen:4286381056,lemonchiffon:4294965965,lightblue:4289583334,lightcoral:4293951616,lightcyan:4292935679,lightgoldenrodyellow:4294638290,lightgrey:4292072403,lightgreen:4287688336,lightpink:4294948545,lightsalmon:4294942842,lightseagreen:4280332970,lightskyblue:4287090426,lightslateblue:4286869759,lightslategray:4286023833,lightsteelblue:4289774814,lightyellow:4294967264,lime:4278255360,limegreen:4281519410,linen:4294635750,magenta:4294902015,maroon:4286578688,mediumaquamarine:4284927402,mediumblue:4278190285,mediumorchid:4290401747,mediumpurple:4287852760,mediumseagreen:4282168177,mediumslateblue:4286277870,mediumspringgreen:4278254234,mediumturquoise:4282962380,mediumvioletred:4291237253,midnightblue:4279834992,mintcream:4294311930,mistyrose:4294960353,moccasin:4294960309,navajowhite:4294958765,navy:4278190208,oldlace:4294833638,olive:4286611456,olivedrab:4285238819,orange:4294944e3,orangered:4294919424,orchid:4292505814,palegoldenrod:4293847210,palegreen:4288215960,paleturquoise:4289720046,palevioletred:4292374675,papayawhip:4294963157,peachpuff:4294957753,peru:4291659071,pink:4294951115,plum:4292714717,powderblue:4289781990,purple:4286578816,red:4294901760,rosybrown:4290547599,royalblue:4282477025,saddlebrown:4287317267,salmon:4294606962,sandybrown:4294222944,seagreen:4281240407,seashell:4294964718,sienna:4288696877,silver:4290822336,skyblue:4287090411,slateblue:4285160141,slategray:4285563024,snow:4294966010,springgreen:4278255487,steelblue:4282811060,tan:4291998860,teal:4278222976,thistle:4292394968,tomato:4294927175,turquoise:4282441936,violet:4293821166,violetred:4291829904,wheat:4294303411,white:4294967295,whitesmoke:4294309365,yellow:4294967040,yellowgreen:4288335154,transparent:16777215},c.hexToARGB=function(t){return{r:(t="string"==typeof t?parseInt(t,16):t)>>16&255,g:t>>8&255,b:255&t,a:t>>24&255}},c.getClosestColorIndex=function(t,n){var e,i,r,o,a,u,s,o;for(n===m&&(n=64),e=-1,i=Number.MAX_VALUE,r=Math.min(c.palette.length-1,n);0<=r;r--)u=(65280&(o=c.palette[r]))>>8,s=255&o,(o=Math.abs(.3*((a=(16711680&o)>>16)-t.r))+Math.abs(.59*(u-t.g))+Math.abs(.11*(s-t.b)))<i&&(i=o,e=r);return e},c.getHexNumString=function(t){var n,n,n=+t;return isNaN(n)?t+"":(n=(t=n).toString(16),t<16?"0"+n:n)},c.convertColorToHex=function(t){var t,n,e,i,r,o;if(t)return"string"!=typeof t?t:("#"===(t=t.toLowerCase()).substring(0,1)?7===t.length?n="FF"+t.substring(1).toUpperCase():4===t.length&&(n="FF"+(e=t[1]+t[1]+t[2]+t[2]+t[3]+t[3]).toUpperCase()):"rgb("===t.substring(0,4)?(r=t.indexOf("("),o=t.indexOf(")"),i=t.substring(r+1,o).split(","),n="FF"+(e=c.getHexNumString(i[0])+c.getHexNumString(i[1])+c.getHexNumString(i[2])).toUpperCase()):"rgba("===t.substring(0,5)?(r=t.indexOf("("),o=t.indexOf(")"),i=t.substring(r+1,o).split(","),n=(e=c.getHexNumString(i[3])+c.getHexNumString(i[0])+c.getHexNumString(i[1])+c.getHexNumString(i[2])).toUpperCase()):pt[t]&&(n=pt[t].toString(16).toUpperCase()),n)},c.convertHexColorToArgb=function(t){return c.hexToARGB(c.convertColorToHex(t))},c.getIndexedColor=function(t){var t,n,e,i;return 32767===t?"#000000":64===t||65===t?m:t<0||gt.length<=t?"#000000":gt[t]!==m?"rgb("+(n=(t=gt[t])>>16&255)+","+(e=t>>8&255)+","+(i=255&t)+")":void 0},c.palette=[4278190080,4294967295,4294901760,4278255360,4278190335,4294967040,4294902015,4278255615,4278190080,4294967295,4294901760,4278255360,4278190335,4294967040,4294902015,4278255615,4286578688,4278222848,4278190208,4286611456,4286578816,4278222976,4290822336,4286611584,4288256511,4288230246,4294967244,4291624959,4284874854,4294934656,4278216396,4291611903,4278190208,4294902015,4294967040,4278255615,4286578816,4286578688,4278222976,4278190335,4278242559,4291624959,4291624908,4294967193,4288269567,4294941132,4291598847,4294954137,4281558783,4281584844,4288269312,4294953984,4294940928,4294927872,4284901017,4288059030,4278203238,4281571686,4278203136,4281545472,4288230144,4288230246,4281545625,4281545523,4278190080],bt=c,f.ColorHelper=bt,yt=/&#(\d+);/g,wt=/&#x([0-9A-F]+);/gi,Mt=/&amp;/g,Ct=/&gt;/g,St=/&lt;/g,Tt=/&quot;/g,At=/&apos;/g,k.Vf=function(t){for(var n,e,n="";0<t;t=parseInt((t-1)/26+"",10))n=String.fromCharCode(65+(e=(t-1)%26))+n;return n},k.gt=function(t,n,e,i){var r;return 3===t&&(r=C.getType(n),t=!e||"@"!==e&&"@"!==e.formatCached?r===K?1:r===b||r===X||r===p&&k.Yf(n)?2:0:0,i)&&0!==i&&(0<i?t=0:i<0&&(t=2),-90===i?t=0:90===i&&(t=2)),t},k.Yf=function(t){return k.Zf.test(t)},k.j=function(t){var n,n,n=C.getType(t);return t=t===I||t===m?"":n===K?t.toString().toUpperCase():n===X?(n=0===t.getHours()&&0===t.getMinutes()&&0===t.getSeconds()&&0===t.getMilliseconds(),h.Common.ct.Pe(t,n?"M/d/yyyy":"M/d/yyyy h:mm:ss")):t.richText?k.wt(t):t.toString()},k.Wf=function(t,n,e,i,r,o,a){var u,s,c,f,l,h,d,v,m,g,p,b,y,w,M,u=C(t),s=n,c=e,f="background-position",l="background-size",h="auto",d="0%",v="50%",m="100%";switch(o){case 0:a?u.css(f,a.position).css(l,a.size):u.css(f,"0% 0%").css(l,"100% 100%");break;case 1:p=g=v,u.css(f,(g=s<i?d:v)+" "+(p=c<r?d:v)).css(l,"auto auto");break;case 2:w=s,(y=b=0)<(M=c)&&0<r&&i/r<s/c?b=b+s/2-(w=i/r*c)/2:0<s&&0<i&&r/i<c/s&&(y=y+c/2-(M=r/i*s)/2),u.css(f,b+at+" "+y+at).css(l,w+at+" "+M+at);break;case 3:u.css(f,"0% 0%").css(l,"auto auto")}},k.device=function(){var t,n,e,i,r,o,t=navigator.userAgent,n=t.match(/iPad/i);if(n)(e=n[0])&&(i="ipad"===e.toLowerCase());else if((n=t.match(/Macintosh/i))&&(e=n[0]))try{document.createEvent("TouchEvent"),i="macintosh"===e.toLowerCase()}catch(t){}return{ipad:i,iphone:r=(n=t.match(/iPhone/i))&&(e=n[0])?"iphone"===e.toLowerCase():r,android:o=(n=t.match(/android/i))&&(e=n[0])?"android"===e.toLowerCase():o}},k.Qf=function(){var t=navigator.platform;return t&&-1<t.indexOf("Mac")},k.Kf=function(t){var t,t;return t!==m&&t!==I&&(t=t.toString(),t=H.Jf(t),!rt(Number(""===t.trim()?NaN:t))||/^[1-9]\d{0,2}(?:(,\d{3})*|\d*)(?:\.\d*)?$/.test(t))},k.Xf=function(t,n,e,i,r){var o,a,u,u,s,t,o,a,o=I,a=!1;if(t&&((u=t.formatter)?(r?o=r:k.St(u)||(o=u,a=!0),typeof o==p&&d&&(o=new d(o))):o=t._autoFormatter),o&&!o.isAuto){u=I;try{if(u=o.parse(n),typeof(u=a&&u instanceof Date&&(s=(new d).getPreferredDisplayFormatter(n,r))?s.parse(n):u)==b)return u}catch(t){}return u===m||u===I?n:u}if(e){if(t=void 0,t={},o=void 0,a=I,d)try{a=(new d).getPreferredDisplayFormatter(n,t)}catch(t){}return typeof(o=t.value)==b?n=o:k.Kf(n)&&(o=t.value=n),i&&(i.value=a),o!==m&&o!==I?o:n}return n},k.gi=function(t){for(var n,e,t,i,n=v.body,e=t;e&&e.parentElement&&e.parentElement!==n;)e=e.parentElement;return t=1e3,e&&e.parentElement===n&&(i=et(C(e).css("z-index")),rt(i)||(t+=i)),t},k.ri=function(t){var n,e,i,r,o,a,u,s,c,f,l,h,d,v,d;if(!t)return[];if(n=t.indexOf("("),e=t.lastIndexOf(")"),!(i=t.substring(n+1,e)))return[];for(r=[],a="",s=u=o=0;s<i.length;)u=i.indexOf("rgb",o),-1===(s=i.indexOf("rgb",o+1))&&(s=i.length),a=i.substring(u,s),r.push(a),o=s;for(c=[],f=0,l=r.length;f<l;f++)d=(h=r[f]).indexOf(")"),v=h.substring(0,d+1),d=it(h.substring(d+1,h.length)),rt(d)&&(f===l-1?d=100:f<=1&&(d=0)),!v&&0===f||c.push({color:v,point:d/=100});return c},k.qf=function(t,n,e,i,r){var o,a,u,s,c,f,l,h,d,v,d,m,g,g,g,p,p,b,y,w,M,C,y,S,o=n.Dn,a=0,u=[e],s=n.zoom();for(i===T.AutoFitType.cellWithHeader&&(e===T.SheetArea.viewport?u.push(1):e===T.SheetArea.rowHeader&&u.push(0)),c=0;c<u.length;c++)for(f=0,l=u[c],h=r||n.getRowCount(l);0<=f&&f<h;)(d=n.Ut.findSpan(f,t,l))&&(d.col<t||1<d.colCount||d.row<f)?f=d.row+d.rowCount:(d=0,(m=(v=n.getActualStyle(f,t,l)).cellType||n.$f(l))&&(g=v.font||o.Nn(),v.font=o._n(g),(g=!(!(g=n.rowFilter&&n.rowFilter())||!g.rn(f,t,l)))||3!==l||(p=n.tables?n.tables.find(f,t):I)&&p.showHeader()&&p.headerIndex()===f&&p.rowFilter()&&p.filterButtonVisible(t-p.range().col)&&(g=!0),p=v.formatter||v._autoFormatter,b={sheet:n,row:f,col:t,sheetArea:l,quotePrefix:v.quotePrefix},y={},w=n.getValue(f,t,l,T.ValueType.richText),M=n.t0(f,t,e),C="",C=w&&w.richText?n.getText(f,t,l):A(M)?m.format(w,p,y,b):M,d=m.Ln(w,C,v,s,b),g)&&(y=N(s,1),d+=S=et((n.defaults.rowHeight*y).toString(),10)),a<d&&(a=d),l===T.SheetArea.viewport?f=k.n0(f,t,n,l):f++);return 0===a?a=n.defaults.colWidth:a+=x(3),x(a)},k.n0=function(t,n,e,i){for(var r,o,a,u,s,r=-1,o=e.getRowCount(i),a=t+1;a<o;a++){if(u=e.getText(a,n,i)){r=a;break}if((s=e.getActualStyle(a,n,i))&&(s.cellType||s.cellButtons&&0<s.cellButtons.length||G.W.rse(s))){r=a;break}}return r},k.e0=function(t,n,e,i){var r,o,a,u,s,c,f,l,h,d,v,v,m,m,s,g,p,b,r=n.Dn,o=0,a=[e],u=n.zoom();for(1===i&&(3===e?a.push(2):1===e&&a.push(0)),f=!1,l=c=0;l<a.length;l++)for(h=0,d=n.getColumnCount(e=a[l]);0<=h&&h<d;)(v=n.Ut.findSpan(t,h,e))&&(v.row<t||1<v.rowCount||v.col<h)?h=v.col+v.colCount:(0<n.getColumnWidth(h,e)&&(m=(v=n.getActualStyle(t,h,e)).font||r.Nn(),v.font=r._n(m),m=0,(s=n.getCellType(t,h,e))&&(g=n.getText(t,h,e),p=n.getValue(t,h,e,1),m=s.Fn(p,g,v,u,b={sheet:n,row:t,col:h,sheetArea:e})),2===(s=n.Lt(h))?c=c+m+x(3):(c&&(m+=c,c=0),1===s&&(f=!0)),o<(m=c?c:m))&&(o=m),3===e?h=k.i0(t,h,n,e):h++);return 0===(o=f&&o<60?60:o)?o=n.defaults.rowHeight:o+=x(3),x(o)},k.i0=function(t,n,e,i){for(var r,o,a,u,s,r=-1,o=e.getColumnCount(i),a=n+1;a<o;a++){if(u=e.getText(t,a,i)){r=a;break}if((s=e.getActualStyle(t,a,i))&&s.cellType){r=a;break}}return r},k.mi=function(t,n,e,i,r){var o,a,i,t,r,u,s,c,f,l;if(e&&(o=i.row,a=i.col,i=i.sheetArea,t=t.formatter||t._autoFormatter,r=r||{},d)&&n!==I&&n!==m)if(u=void 0,t&&t.isAuto)u=typeof n==b,s=k.Kf(n),!u&&s&&(n=H.Jf(n)),n=t.getPreferredEditingFormatter?t.getPreferredEditingFormatter(n).format(n):n;else if(t=typeof t!=p||k.St(t)?t:new d(t))try{n instanceof Date?((c=P&&P.Convert.r0(n))&&(n=c),f=h.Common.CultureManager.Fe().DateTimeFormat,l=h.Common.ct.o0(n),t=!V.a0(t.formatString(),["d","y"])&&0<=l&&l<1?new d(f.longTimePattern):0===n.getHours()&&0===n.getMinutes()&&0===n.getSeconds()&&0===n.getMilliseconds()?new d(f.shortDatePattern):new d(f.shortDatePattern+" "+f.longTimePattern),e.u0=!0,n=t.format(n),r.formatter=t):typeof n==b&&(n=t.getPreferredEditingFormatter?t.getPreferredEditingFormatter(n).format(n):H.Ge(n.toString()))}catch(t){n=e.getText(o,a,i)}else n=0===n?"0":e.getText(o,a,i);return n=n!==I&&n!==m?k.j(n):n},k.s0=function(t,n,e,i){var e,i,r,o,a,u;if(e&&(e=i||{},d)&&n!==I&&n!==m)if(i=void 0,t&&t.isAuto)i=typeof n==b,r=k.Kf(n),!i&&r&&(n=H.Jf(n)),n=t.getPreferredEditingFormatter?t.getPreferredEditingFormatter(n).format(n):n;else if(t)try{n instanceof Date?(typeof t!=p||k.St(t)||(t=new d(t)),(o=P&&P.Convert.r0(n))&&(n=o),a=h.Common.CultureManager.Fe().DateTimeFormat,u=h.Common.ct.o0(n),n=(t=!V.a0(t.formatString(),["d","y"])&&0<=u&&u<1?new d(a.longTimePattern):0===n.getHours()&&0===n.getMinutes()&&0===n.getSeconds()&&0===n.getMilliseconds()?new d(a.shortDatePattern):new d(a.shortDatePattern+" "+a.longTimePattern)).format(n),e.formatter=t):typeof n==b&&(n=H.Ge(n.toString()))}catch(t){}return n=n!==I&&n!==m?k.j(n):n},k.c0=function(t,n,e,i){return!A(t)&&"string"==typeof t&&!!(n||-1===f.FormulaPrefix.indexOf(t)&&0<t.length&&-1!==f.FormulaPrefix.indexOf(t[0])&&e&&!i)},k.f0=function(t,n,e){var i,r,r,i="";if(t)if((r=t.getFormulaInformation(n,e,3))&&r.hasFormula){if(i="="+r.formulaWithCulture,r.isDynamicArray)return""}else{if(r=t.getValue(n,e),A(r))return r;i=k.s0(t.getFormatter(n,e)||t.l0(n,e,"_autoFormatter"),r,t)||""}return i},k.h0=function(t,n){var e,n,i,r,e=t,n=h.Common.CultureManager.Fe(n).NumberFormat,i;return!!(n&&n.percentSymbol&&t)&&"object"!=typeof(e="object"==typeof t&&t.formatCached?t.formatCached:e)&&"string"==typeof e&&0<(r=H.v0(e)).d0},k.m0=function(t){var n,e,t,n=k.Tt.msie||k.Tt.edge,e=n&&l.MSPointerEvent&&1<(navigator.msMaxTouchPoints||0);return t?e:(t=n&&l.PointerEvent&&1<(navigator.maxTouchPoints||0),e||t)},k.wt=function(t){return t&&t.richText&&0<t.richText.length?(t=t.text?t:k.g0(t)).text:t},k.g0=function(t){var n,e,i;if(t&&(n=t.richText)&&0<n.length){for(e=[],i=0;i<n.length;i++)e.push(n[i].text||"");t.text=e.join("")}return t},k.St=function(t){return"string"==typeof t&&("="===t.charAt(0)||0<=t.indexOf("{{")&&0<=t.indexOf("}}"))},k.p0=function(t,n,o,a){var u,s,t,u=t,s=n,t=function(t,n){var e,i,r,e=this;return e.hasOwnProperty("_ps")||(e._ps={}),i=e._ps,0===arguments.length?i[u]!==m?i[u]:s:(!1!==n&&a&&!a.call(e,t)||(r=i[u]!==m?i[u]:s)!==t&&(i[u]=t,!1!==n)&&o&&o.call(e,t,r),e)};return t.isDefault=function(t){return t===s},t},k.b0=function(t,n){var e={_ps:{}};return h.Common.lt.y0(t,function(t){nn(e,t,n)}),e},k.w0=function(t,n,e,i,r,o,a){for(var u,s,c,f,u=N(n,e),s=g(n,e),c=0,f=u;f<s&&(c+=i?o?t.getRowHeight(f,3):t.Gt(f,3,a):o?t.getColumnWidth(f,3):t.nn(f,3,a),!(r&&r<c));f++);return c},k.M0=function(t,n,e,i,r){for(var o,a,u,s,c,o=N(n,e),a=g(n,e),u=0,s=o;s<a&&(i?(c=t.C0(s),t.getViewportTopRow(c)<=s&&t.getViewportBottomRow(c)>=s&&(u+=t.Gt(s,3))):(c=t.S0(s),t.getViewportLeftColumn(c)<=s&&t.getViewportRightColumn(c)>=s&&(u+=t.nn(s,3))),!(r&&r<u));s++);return u},k.T0=function(t,n){var e,i,t,n,e=0,i=0;return t!==n&&(t=C(t).offset(),n=C(n).offset(),e=t.left-n.left,i=t.top-n.top),{A0:i,I0:e}},k.x0=function(t,n,e,i){var r,o,a,u,s,r=i||{};if(!t||"string"!=typeof t)return r.message=Q().Exp_SheetNameInvalid,!1;for(a=0;a<t.length;a++)if("*"===(o=t.charAt(a))||":"===o||"["===o||"]"===o||"?"===o||"\\"===o||"/"===o)return r.message=Q().Exp_SheetNameInvalid,!1;if("'"===t.charAt(0)||"'"===t.charAt(t.length-1))return r.message=Q().Exp_SheetNameInvalid,!1;if(n)for(u=n.length,a=0;a<u;a++)if(e!==(s=n[a])&&t.toUpperCase()===s.name().toUpperCase())return r.message=Q().Exp_SheetNameConflict,!1;return!0},k.yi=function(t,n,e){var i,r,o;if(!t)return t;for(i=0,r=t.length,o=[];i<r;)t[i]===n?o[i]=e:o[i]=t[i],i++;return o.join("")},k.N0=function(){var t,n,e,i,t=k;return t.k0||(i="-10000px",(e=(n=$t("span")).style).visibility="hidden",e.top=i,e.left=i,e.position="absolute",n.setAttribute("gcUIElement","gcStringWidthSpan"),v.body.insertBefore(n,I),t.k0=n),t.k0},k.vt=function(t,n,e){var i,r,o,o,i,i=k,r=i.D0;if(!n)if(r){if(o=(r=e?r.CJKFontCache:r)[t])return o}else r=i.D0={CJKFontCache:{}},e&&(r=r.CJKFontCache);return(o=i.N0()).style.font=k.yt(t),k.Tt&&k.Tt.safari&&(o.style.lineHeight="normal"),o.innerHTML=e?String.fromCharCode(20013):"H",i=o.offsetHeight,n||(r[t]=i),i},k._0=function(t){var n,e,i,n,n=k,e=n.E0;if(e){if(e[t])return e[t]}else e=n.E0={};return(n=n.N0()).style.font=t,n.innerHTML="H",(i={}).fontFamily=n.style.fontFamily,i.fontSize=n.style.fontSize,i.fontStyle=n.style.fontStyle,i.fontWeight=n.style.fontWeight,e[t]=i},k.bi=function(t,n){var e=k.N0();return e.style.font=k.yt(n),k.Tt&&k.Tt.safari&&(e.style.lineHeight="normal"),e.innerHTML=Z.j0(t||"H"),e.offsetHeight},k.O0=function(t){var n,e,n,n=k;return 0<=t.indexOf(f.FallbackFontFamily)?t:(t=t.replace("("+String.fromCharCode(27491)+String.fromCharCode(25991)+")","").replace("(Body)","").replace("("+String.fromCharCode(26631)+String.fromCharCode(39064)+")",""),(n=(e=n.N0()).style).font=t,n.fontFamily=[].concat(n.fontFamily.split(","),f.FallbackFontFamily.split(",")).join(","),n.font)},k.yt=function(t){var n,e,i,n=k;return t&&n.R0?(i=(e=(e=n.B0)||(n.B0={}))[t])||(e[t]=n.O0(t)):t},k.bt=function(t,n){n&&(n=k.yt(n),t.font!==n)&&(t.font=n)},k.Mt=function(t,n,e){return!n||A(e)?0:(k.bt(t,n),t.measureText(e).width)},k.L0=function(){var t,n,t=k,n=t.k0;n&&(C(n).remove(),t.k0=m),t.D0=m,t.E0=m,k.F0&&(k.F0=m),t.B0=m},k.oi=function(t){var n,t,n=k.F0;return n=n||(k.F0=$t("div")),t=t.innerHTML,n.innerHTML=t,n.innerText},k.P0=function(t){return t&&/^[A-Za-z_\\\u0080-\uFFFF][A-Za-z0-9_\.\\\?\u0080-\uFFFF]*$/.test(t)&&!(-1!==["C","c","R","r"].indexOf(t)||/^[A-Za-z]{1,3}(\$)?\d+$/.test(t)||/^[Rr]\d*[Cc]\d*$/.test(t)||255<=t.length)},k.G0=function(t){t&&(t.U0(!0),t.initExpression(),t.H0())},k.z0=function(t){var n,e,i,r,o,n=0,e=0,i=t.length;for(0<i&&(n=t[0].row,e=t[0].col),r=1;r<i;r++)n>(o=t[r]).row&&(n=o.row),e>o.col&&(e=o.col);return{r:n=n<0?0:n,c:e=e<0?0:e}},k.V0=function(t){var n,n,n=typeof t==p&&"/"===t.charAt(0)?(n=void 0,ht.test(t)?(n=t.match(ht),h.Common.ct.Y0(it(n[1]))):lt.test(t)?(n=t.match(lt),new Date(it(n[1]))):t):t;return n},k.Z0=function(t){var t,t=!A(t)&&h.Common.ct.W0(t)?h.Common.ct.Q0(t):t;return t},k.K0=function(t,n){for(var e,i,r,o,e=t.getImageData(n.x,n.y,n.width,n.height),i=e.data,r=0;r<i.length-4;r+=4)o=tt((30*i[r]+59*i[r+1]+11*i[r+2]+50)/100),i[r]=o,i[r+1]=o,i[r+2]=o;t.putImageData(e,n.x,n.y)},k.J0=function(t,n,e){t.rowCount>n&&(t.rowCount=n),t.colCount>e&&(t.colCount=e)},k.X0=function(t,n,e,i){for(var r=e;r<e+i;r++)if(!A(t.getValue(n,r)))return!0;return!1},k.q0=function(t,n,e,i){for(var r=n;r<n+i;r++)if(!A(t.getValue(r,e)))return!0},k.$0=function(t){return!t||""===t},k.qi=function(t){if(k.$0(t))return 0;for(var n=0,e=0;e<t.length&&isNaN(parseInt(t[e],10));)e++;return(n=e<t.length?parseInt(t.substring(e),10):n)-1},k.$i=function(t){for(var n,e,i,r,o,n=0,e=t.length,i=0;i<e&&!(25<(o=(r=t[i].charCodeAt())-97))&&!((o=o<0?r-65:o)<0);i++)n=26*n+o+1;return--n},k.t1=function(t){var t=""+t;return"="===t.charAt(0)?t.substr(1):t},k.getFormulaString=function(t){return"string"==typeof t?(t="="===t[0]?t.substr(1):t,J(t)):t},k.vo=function(t,n){return!A(t)&&(n=n||/(&)|(<)|(>)|(")|(')/g).test(t)?typeof t==p?t.replace(n,function(t){switch(t){case"&":return"&amp;";case"<":return"&lt;";case">":return"&gt;";case'"':return"&quot;";case"'":return"&apos;"}}):""+t:t},k.xfe=function(t,n){return(n=void 0!==n&&n)?t&&t.replace(/\%/g,"%25").replace(/\ /g,"%20").replace(/\#/g,"%23").replace(/\[/g,"%5b").replace(/\]/g,"%5d").replace(/\^/g,"%5e").replace(/\`/g,"%60").replace(/\{/g,"%7b").replace(/\}/g,"%7d").replace(/\&/g,"&amp;").replace(/\"/g,"&quot;"):t&&t.replace(/\&/g,"&amp;").replace(/\"/g,"&quot;").replace(/\>/g,"&gt;").replace(/\</g,"&lt;")},k.Nfe=function(t,n){return(n=void 0!==n&&n)?t&&t.replace(/&amp;/g,"&").replace(/&quot;/g,'"').replace(/%20/g," ").replace(/%23/g,"#").replace(/%5[bB]/g,"[").replace(/%5[cC]/g,"\\").replace(/%5[dD]/g,"]").replace(/%5[eE]/g,"^").replace(/%60/g,"`").replace(/%7[bB]/g,"{").replace(/%7[dD]/g,"}").replace(/%25/g,"%"):t&&t.replace(/&amp;/g,"&").replace(/&quot;/g,'"').replace(/&gt;/g,">").replace(/&lt;/g,"<")},k.n1=function(t){var n,e;return A(t)?t:!(n=typeof t==p)||-1===t.indexOf("&")?""+t:(e=/(&amp;)|(&gt;)|(&lt;)|(&quot;)|(&apos;)/g,(t=-1!==t.indexOf("&#")?t.replace(yt,un(10)).replace(wt,un(16)):t).replace(e,function(t){switch(t){case"&amp;":return"&";case"&gt;":return">";case"&lt;":return"<";case"&quot;":return'"';case"&apos;":return"'"}}))},k.e1=function(t,n,e){var i,r;if(t&&typeof t==p)for(i=0;i<e.length;i++)if((r=e[i])!==n&&(-1<t.indexOf(r+"!")||-1<t.indexOf("'"+r+"'!")))return!0;return!1},k.i1=function(t){var n,e,n;return"string"==typeof t&&(n=t.indexOf("/OADate(")+1,e=t.indexOf(")"),0!==n)&&n<e&&(n=parseFloat(t.substring(n+7,e)),isNaN(n)||(t=""+n)),t},k.r1=function(t){var n,e,i;if(!t)return null;if(n=-1!==(n=t).indexOf(e=",")?n.split(",")[0]:n){for(i=n.length-1;0<=i&&"/"!==n[i];)i--;'"'===(n=(n=0<=i?n.substring(i):n)&&"/#"===n.substring(0,2)?n.substring(2):n)[0]&&'"'===n[n.length-1]&&(n=n.substring(1,n.length-1))}return n},k.o1=function(t,n){for(var e,i,r,o,a,o,e=n.split("&"),i=0,r=e.length;i<r;i++){if(a=(o=e[i].split("."))[0],o=o[1],!t)return;t=k.xr(t,a,o)}return t},k.Lue=function(t,n){var e,i,r;if(t&&t.c_){for(i=t.c_,r=0;r<i.length&&!(e=k.xr(i[r],n));r++);return e}},k.xr=function(t,n,e){var i,r,o,a;if(!t||!t.c_)return m;for(e=e?+e:0,r=0,o=(i=t.c_).length;r<o;r++)if((a=i[r])&&a.n_===n){if(0===e)return a;e--}},k.u1=function(t,n){var e,i;if(t)for(e=t.c_||[],i=0;i<e.length;i++)if(e[i][n])return e[i][n]},k.s1=function(t,n){var e,i,r,o,o;if(!t||!t.c_)return m;for(i=0,r=(e=t.c_).length;i<r;i++){if((o=e[i])&&o.n_===n)return o;if(o=k.s1(o,n),!A(o))return o}},k.c1=function(t){return t&&t.c_?t.c_[0]:m},k.go=function(t,n){var e,i,r,o,a;if(!t||!t.c_)return m;for(i=[],r=0,o=(e=t.c_).length;r<o;r++)(a=e[r])&&a.n_===n&&i.push(a);return i},k.Pr=function(t,n){var e,i,r,o,o;if(t&&t.c_){for(e=[],i=0,r=n.length;i<r;i++)o=n[i],(o=k.go(t,o))&&0<o.length&&(e=e.concat(o));t.c_=e}},k.f1=function(t,n,e){var i,r,o;if(t&&n)for(e=e||n.name,i=0,r=t.length;i<r;i++)(o=t[i])&&o.n_===e&&(t[i]=n)},k.l1=function(){var t;return("{"+an(8)+"-"+an(4)+"-"+an(4)+"-"+an(4)+"-"+an(12)+"}").toUpperCase()},k.h1=function(t,n,e){if(t)return sn(t)?cn(t,n,e):hn(t,e)},k.d1=function(t,n){var n;if(t)return"1"===t.auto?"#000000":t.theme!==m?fn(t,n):t.rgb?"#"+(n="number"==typeof(n=t.rgb)?n.toString(16):n).substring(2,n.length):t.indexed!==m?ln(t):void 0},k.hueToRGB=function(t,n,e){return e<0&&(e+=255),255<e&&(e-=255),e<42?t+((n-t)*e+21)/42:e<127?n:e<170?t+((n-t)*(170-e)+21)/42:t},k.v1=function(t,n,e){var i,r,o,a,n,i=0,r=0,o=0;return o=0===e?r=i=255*n/255|0:(a=void 0,n=2*n-(a=n<=127?(n*(255+e)+127)/255:n+e-(n*e+127)/255),i=parseInt(((255*k.hueToRGB(n,a,t+85)+127)/255).toString(),10),r=parseInt(((255*k.hueToRGB(n,a,t)+127)/255).toString(),10),parseInt(((255*k.hueToRGB(n,a,t-85)+127)/255).toString(),10)),{r:i=(i=0<i?i:0)<255?i:255,g:r=(r=0<r?r:0)<255?r:255,b:o=255<(o=0<o?o:0)?o:255,a:0}},k.m1=function(t){var t=pt[t];if(t!==m)return bt.hexToARGB(t)},k.g1=function(t){if(!Y(t))return"="===t[0]?t:"="+t},k.p1=function(t){return Y(t)||t.length<=2?t:t.substr(1,t.length-2)},k.b1=function(t){if(!A(t))return"="===t[0]?t.substring(1,t.length):t},k.w1=function(t,n){if(t&&n)for(var e in n)n.hasOwnProperty(e)&&(t[e]=n[e]);return t},k.C1=function(t){var n,e,i,r;if("string"==typeof t){if(n=/\[[^\]]+\]|@/,(e=t.split(/\'|\"/g))&&0<e.length)for(i=0;i<e.length;i++)if(r=e[i],i%2==0&&r.match(n))return!0;return!1}},k.S1=function(t,n){var e,i,r,n,o,t,e=n.row,i=n.col,r=n.rowCount,n=n.colCount,o=t.getRowCount(),t=t.getColumnCount();return-1===e&&(e=0,r=o),-1===i&&(i=0,n=t),An(e,i,r=o<e+r?o-e:r,n=t<i+n?t-i:n)},k.isInfinityNumberString=function(t){return"string"==typeof t&&(parseFloat(t)===Number.POSITIVE_INFINITY||parseFloat(t)===Number.NEGATIVE_INFINITY)},k.repeatString=function(t,n){var e="";if(!(!t||n<1||n>Number.POSITIVE_INFINITY))for(;n%2&&(e+=t),(n=Math.floor(n/2))&&(t+=t),n;);return e},k.toPlainString=function(t){var n,e;return(""+t).replace(/(-?)(\d*)\.?(\d*)e([+-]\d+)/,function(t,n,e,i,r){return+r<0?n+"0."+k.repeatString("0",1-+r-e.length-1)+e+i:n+e+i+k.repeatString("0",+r-i.length)})},k.Ese=function(t){var n=document.createElement("div");return n.innerHTML=t.trim(),n.firstChild},k.Uce=function(t,n){var e,i,r,o;if(t===I||n===I||"object"!=typeof t||"object"!=typeof n)return t===n;if(e=Object.keys(t),i=Object.keys(n),e.length!==i.length)return!1;for(r=0;r<e.length;r++)if(o=e[r],!k.Uce(t[o],n[o]))return!1;return!0},k.Zf=/[\u0600-\u06FF\u0750-\u077F]/,k.vi=rn,k.pi=k.device,k.Tt=(n=dn(s=navigator.userAgent),t={version:m,chrome:m,webkit:m,safari:m,mozilla:m,msie:m,metroMode:m,edge:m},n.browser&&(t[n.browser]=!0,t.version=n.version),t.chrome?t.webkit=!0:t.webkit&&(t.safari=!0),(Kt=0<=s.indexOf("PhantomJS"))&&(t.safari=!1,t.chrome=!0),(Xt=(n=s.toLowerCase()).indexOf("compatible")<0&&/(trident)(?:.*? rv ([\w.]+)|)/.exec(n)!==I)&&(t.mozilla=m,t.msie=!0),(n=/Edge\/\d+/.exec(s))!==I&&0<n.length&&(t.webkit=m,t.chrome=m,t.msie=!0,t.edge=!0,t.version=n[0].substr(n[0].indexOf("/")+1)),t.msie&&vn()&&(t.metroMode=!0),t),k.browser=k.Tt,k.En=$t,k.T1=qt,k.pt=on,k.R0=k.Qf(),k.Ct=function(t){return!A(t)&&(typeof t==b||typeof t==K||t instanceof Date||P&&t instanceof P.CalcError)},y=k,f.util=y,f.mt=y,w=y.Mt,mn.A1=function(t){return!(mn.ai()!==t||!t.rt||!t.rt.I1)},mn.ai=function(){return l&&l.Vc&&l.Vc.activeElement},mn.N1=function(i){var r,o,a,t,n,t,e,u,s,c,f;function l(t){for(var n,e,n=0;n<=2;n++)(e=t.call(r,n))&&0!==e.width&&0!==e.height&&(i.k1=!0,o.D1(a,e))}if(i&&!mn.A1(i)&&i.parent&&i.parent.options.hideSelection)if(r=i.Fi(),o=i.Dn,a=o.J(),n=(t=i._1)&&t.isEnable(T.RowColumnStates.selected,!0),t=t&&t.isEnable(T.RowColumnStates.selected,!1),e=i.getSelections(),s=u=void 0,n||t){for(c=void 0,u=0;u<e.length;u++)f=e[u],c=c?c.union(f):f;c&&o.E1(c)}else{for(u=0;u<e.length;u++)f=e[u],0<=(s=i.j1(f)).width&&0<=s.height&&(s.x-=9,s.y-=9,s.width+=18,s.height+=30,o.O1(s));s=r.R1(),i.k1=!0,o.D1(a,s),l(r.B1),l(r.L1)}},mn.F1=function(t,n){var e=mn.ai();(l.Vc.activeElement=t)===e||n||(e&&(e.endEdit(),mn.N1(e),e.G1)&&e.G1(),t&&t.Dn.E1())},It=mn,f.hi=It,e.prototype.U1=function(){var t="gc-theme-version ui-widget-header ui-state-default wijmoThemeHelper btn-default",n="span."+t.split(" ").join(".");return u.H1?C(v).find(n).length<=0&&tn(u.H1):u.H1=gn(t),u.H1},e.prototype.z1=function(){var t="gc-theme-version ui-widget-content wijmoThemeHelper btn-default",n="span."+t.split(" ").join(".");return u.V1?C(v).find(n).length<=0&&tn(u.V1):u.V1=gn(t),u.V1},e.prototype.Y1=function(){var t="gc-theme-version ui-state-hover wijmoThemeHelper btn-primary",n="span."+t.split(" ").join(".");return u.Z1?C(v).find(n).length<=0&&tn(u.Z1):u.Z1=gn(t),u.Z1},e.prototype.W1=function(){var t="gc-theme-version ui-state-highlight wijmoThemeHelper btn-warning",n="span."+t.split(" ").join(".");return u.K1?C(v).find(n).length<=0&&tn(u.K1):u.K1=gn(t),u.K1},e.prototype.J1=function(){var t="gc-theme-version",n="gcDummyElement";return u.X1?C(v).find("#"+n).length<=0&&tn(u.X1):u.X1=gn(t,n),u.X1},e.prototype.nl=function(){u.U1(),u.z1(),u.Y1(),u.W1()},e.prototype.Hc=function(){var r,t,o;function a(t,n){for(var e,i,e=!1,i=t;i;){if("gcSpread"===C(i).attr("gcUIElement")){e=n.qc()!==i;break}i=i.parentElement}return e}function e(t){var n,e,i,i,n=It.ai();if(n&&(e=u.el(t.target),i=n.il&&n.il.rl,r.wf.forEach(function(t){t&&t(n,e)}),!e||a(e,n)))if(n.ol(m,m,i))o&&(i=n.rt)&&i.al&&i.al(),It.F1(I);else if(t.cancelable)return!1}function n(t){var n=t.pointerType;n!==t[ft]&&n!==ct||e(t)}(r=this).vf=0,pn(l,"keydown",yn,!0),pn(l,"keyup",wn,!0),pn(l,"compositionstart",Mn,!0),pn(l,"selectstart",Sn,!0),t=y.pi(),o=t.ipad||t.iphone,y.browser.safari&&!o&&pn(l,"textInput",Cn,!0),y.m0()?(C(v).bind("MSPointerDown",n),C(v).bind("pointerdown",n)):C(v).bind("touchstart",e),pn(v,"mousedown",function(t){var n;!1===e(t)&&rn(t)},!0),C(v).bind("DOMContentLoaded",function(){u.nl()})},e.prototype.el=function(t){for(var n,e,n=t;n&&"BODY"!==n.tagName&&typeof n.getAttribute==$;){if(e=(e=n.getAttribute("gcUIElement"))||n.gcUIElement)return n;n=n.parentNode}return I},e.prototype.ul=function(t,n){var e,t,i,r,o,a,t,e=u.U1();return t===T.VisualState.highlight||t===T.VisualState.selected?e=u.W1():t===T.VisualState.hover&&(e=u.Y1()),t=e.className,C(e).removeClass(t).addClass(n),o=(i=bn(e)).backgroundColor,a=i.backgroundImage,C(e).addClass(t),(t={backgroundColor:(i=bn(e)).backgroundColor,backgroundImage:i.backgroundImage,color:i.color,zIndex:i.zIndex}).borderLeftColor=i.borderLeftColor,t.borderRightColor=i.borderRightColor,t.borderBottomColor=i.borderBottomColor,t.borderBottomWidth=i.borderBottomWidth,t.borderTopColor=i.borderTopColor,t.borderRightWidth=i.borderRightWidth,t.backgroundImage===a&&t.backgroundColor!==o&&(t.backgroundImage=m),C(e).removeClass(n),t},e.prototype.sl=function(t){var n,t,n=u.J1();return C(n).removeClass(n.className).addClass("gc-theme-version "+t),t=bn(n),U({},t)},e.prototype.cl=function(t){var n,t,n=u.z1();return C(n).removeClass(n.className).addClass("gc-theme-version ui-widget-content wijmoThemeHelper btn-default "+t),t=bn(n),U({},t)},e.prototype.ef=function(){var t;l.Vc.vf++},e.prototype.cf=function(){var t=l.Vc;t.vf--,t.vf<0&&(t.vf=0)},u=e.prototype,l.Vc||(l.Vc=new e),r.Ee=function(t){var n;return{0:"normal",1:"highlight",2:"selected",3:"active",4:"hover",5:"activeNotSelected"}[t]||""},r.He=function(t,n){var e=r.Ee(t)+n,i=r.styleCache;return i[e]||(i[e]=u.ul(t,n)),i[e]},r.fl=function(t){var n=t,e=r.styleCache;return e[n]||(e[n]=u.sl(t)),e[n]},r.ll=function(t){var n="content"+t,e=r.styleCache;return e[n]||(e[n]=u.cl(t)),e[n]},r.m=function(t,n){var t=t.hl;return n=t&&t.getColor?t.getColor(n):n},r.dl=function(){r.styleCache={}},r.styleCache={},f.I=r,Tn.prototype.clone=function(){return new Tn(this.x,this.y)},f.Point=Tn,M.prototype.intersect=function(t,n,e,i){var r=this;return t<r.x+r.width&&r.x<t+e&&n<r.y+r.height&&r.y<n+i},M.prototype.intersectRect=function(t){return this.intersect(t.x,t.y,t.width,t.height)},M.prototype.contains=function(t,n,e){var i=this;return e?i.x<=t&&t<=i.x+i.width&&i.y<=n&&n<=i.y+i.height:i.x<t&&t<i.x+i.width&&i.y<n&&n<i.y+i.height},M.prototype.containsRect=function(t,n){return this.contains(t.x,t.y,n)&&this.contains(t.x+t.width,t.y+t.height,n)},M.prototype.getIntersectRect=function(t){return this.getIntersect(t.x,t.y,t.width,t.height)},M.prototype.getIntersect=function(t,n,e,i){var r=this,o=r.x,a=r.y,u=r.x+r.width,r=r.y+r.height,s,c=n,e=t+e,n=n+i,i=g(o,t),o=g(a,c),f,l,h,d,t=N(u,e)-i,a=N(r,n)-o;return 0<t&&0<a?new M(i,o,t,a):I},M.prototype.round=function(){var t=this;t.x=tt(t.x),t.y=tt(t.y),t.width=x(t.width),t.height=x(t.height)},M.prototype.clone=function(){var t=this;return new M(t.x,t.y,t.width,t.height)},f.Rect=M,S.prototype.intersect=function(t,n,e,i){var r=this;return(-1===t||-1===r.row||r.row<t+e&&t<r.row+r.rowCount)&&(-1===n||-1===r.col||r.col<n+i&&n<r.col+r.colCount)},S.prototype.getIntersect=function(t,n,e){var i,r,e,o,n,a,r,e,i,u,s,i=this;return t&&i.intersect(t.row,t.col,t.rowCount,t.colCount)?(r=-1===i.col?e-1:i.col+i.colCount-1,e=-1===t.col?e-1:t.col+t.colCount-1,o=-1===i.row?n-1:i.row+i.rowCount-1,n=-1===t.row?n-1:t.row+t.rowCount-1,a=g(i.col,t.col),r=N(r,e),e=g(i.row,t.row),i=N(o,n),new S(e,a,u=-1===e?-1:i-e+1,s=-1===a?-1:r-a+1)):I},S.prototype.contains=function(t,n,e,i){var r=this,o=arguments.length,a=!1;return 2!==o&&4!==o||(2===o&&(i=e=1),a=(-1===r.row||r.row<=t&&t+e<=r.row+r.rowCount)&&(-1===r.col||r.col<=n&&n+i<=r.col+r.colCount)),a},S.prototype.containsRange=function(t){return this.contains(t.row,t.col,t.rowCount,t.colCount)},S.prototype.offset=function(t,n){var e,i,r,e=this,i=e.col,r=e.row;return-1!==i&&(i+=t),-1!==r&&(r+=n),new S(r,i,e.rowCount,e.colCount)},S.prototype.union=function(t){return In(this,t)},S.prototype.equals=function(t){var n=this;return t instanceof S&&n.row===t.row&&n.col===t.col&&n.rowCount===t.rowCount&&n.colCount===t.colCount},S.prototype.toJSON=function(){var t=this;return{row:t.row,col:t.col,rowCount:t.rowCount,colCount:t.colCount}},S.prototype.fromJSON=function(t){var n=this;t&&(n.row=t.row,n.col=t.col,n.rowCount=t.rowCount,n.colCount=t.colCount)},_t=S,f.Range=_t,f.Ec=An,f.getUnionRange=In,xn.vl=function(t,n){if(t&&n){var t=t.currentTheme();if(t)return t.getColor(n)}return n},xn.ml=function(t,n){var t;return t&&n?(t=t.currentTheme())?t.getFont(n):n:I},f.Pf=xn,i.ValidationError="ValidationError",i.CellClick="CellClick",i.CellDoubleClick="CellDoubleClick",i.ColumnChanging="ColumnChanging",i.RowChanging="RowChanging",i.EnterCell="EnterCell",i.LeaveCell="LeaveCell",i.ValueChanged="ValueChanged",i.TopRowChanged="TopRowChanged",i.SheetChanging="SheetChanging",i.SheetChanged="SheetChanged",i.PivotTableChanged="PivotTableChanged",i.LeftColumnChanged="LeftColumnChanged",i.InvalidOperation="InvalidOperation",i.RangeFiltering="RangeFiltering",i.RangeFiltered="RangeFiltered",i.RangeFilterClearing="RangeFilterClearing",i.TableFilterClearing="TableFilterClearing",i.RangeFilterCleared="RangeFilterCleared",i.TableFilterCleared="TableFilterCleared",i.TableFiltering="TableFiltering",i.TableFiltered="TableFiltered",i.RangeSorting="RangeSorting",i.RangeSorted="RangeSorted",i.ClipboardChanging="ClipboardChanging",i.ClipboardChanged="ClipboardChanged",i.ClipboardPasting="ClipboardPasting",i.ClipboardPasted="ClipboardPasted",i.ColumnWidthChanging="ColumnWidthChanging",i.ColumnWidthChanged="ColumnWidthChanged",i.RowHeightChanging="RowHeightChanging",i.RowHeightChanged="RowHeightChanged",i.DragDropBlock="DragDropBlock",i.DragDropBlockCompleted="DragDropBlockCompleted",i.DragFillBlock="DragFillBlock",i.DragFillBlockCompleted="DragFillBlockCompleted",i.EditStarting="EditStarting",i.EditStarted="EditStarted",i.EditChange="EditChange",i.EditEnding="EditEnding",i.EditEnd="EditEnd",i.EditEnded="EditEnded",i.RangeGroupStateChanging="RangeGroupStateChanging",i.RangeGroupStateChanged="RangeGroupStateChanged",i.InternalSelectionChanging="InternalSelectionChanging",i.SelectionChanging="SelectionChanging",i.SelectionChanged="SelectionChanged",i.SheetTabClick="SheetTabClick",i.SheetTabDoubleClick="SheetTabDoubleClick",i.SheetNameChanging="SheetNameChanging",i.SheetNameChanged="SheetNameChanged",i.ViewZooming="ViewZooming",i.ViewZoomed="ViewZoomed",i.UserZooming="UserZooming",i.UserFormulaEntered="UserFormulaEntered",i.CellChanged="CellChanged",i.ColumnChanged="ColumnChanged",i.RowChanged="RowChanged",i.ActiveSheetChanging="ActiveSheetChanging",i.ActiveSheetChanged="ActiveSheetChanged",i.SparklineChanged="SparklineChanged",i.OutlineColumnCheckStatusChanged="OutlineColumnCheckStatusChanged",i.RangeChanged="RangeChanged",i.ButtonClicked="ButtonClicked",i.EditorStatusChanged="EditorStatusChanged",i.FloatingObjectChanged="FloatingObjectChanged",i.DrawingElementZIndexChanged="DrawingElementZIndexChanged",i.ProgressChanged="ProgressChanged",i.FloatingObjectSelectionChanged="FloatingObjectSelectionChanged",i.ShapeChanged="ShapeChanged",i.ShapeSelectionChanged="ShapeSelectionChanged",i.FormControlButtonClicked="FormControlButtonClicked",i.FormControlValueChanged="FormControlValueChanged",i.PictureChanged="PictureChanged",i.FloatingObjectRemoving="FloatingObjectRemoving",i.ShapeRemoving="ShapeRemoving",i.FloatingObjectRemoved="FloatingObjectRemoved",i.ShapeRemoved="ShapeRemoved",i.PictureSelectionChanged="PictureSelectionChanged",i.FloatingObjectLoaded="FloatingObjectLoaded",i.TouchToolStripOpening="TouchToolStripOpening",i.CommentChanged="CommentChanged",i.CommentRemoving="CommentRemoving",i.CommentRemoved="CommentRemoved",i.SlicerChanged="SlicerChanged",i.BeforeDragDrop="BeforeDragDrop",i.FormulaTextboxActiveSheetChanging="FormulaTextboxActiveSheetChanging",i.FormulaTextboxActiveSheetChanged="FormulaTextboxActiveSheetChanged",i.FormulaTextboxEditStarted="FormulaTextboxEditStarted",i.FormulaTextboxEnterCell="FormulaTextboxEnterCell",i.FormulaTextboxEditEnded="FormulaTextboxEditEnded",i.FormulaTextboxRangeChanged="FormulaTextboxRangeChanged",i.SheetMoving="SheetMoving",i.SheetMoved="SheetMoved",i.DragMerging="DragMerging",i.DragMerged="DragMerged",i.ChartClicked="ChartClicked",i.FloatingElementSelected="FloatingElementSelected",i.BeforePrint="BeforePrint",i.TableResizing="TableResizing",i.TableResized="TableResized",i.TableRowsChanged="TableRowsChanged",i.TableColumnsChanged="TableColumnsChanged",i.DropdownSpreadMouseClick="DropdownSpreadMouseClick",i.DropdownSpreadKeyboardEnter="DropdownSpreadKeyboardEnter",i.PasteEnd="PasteEnd",i.SheetTabAllSheetsListContextMenuOpening="SheetTabAllSheetsListContextMenuOpening",i.SheetTabAllSheetsListContextMenuOpened="SheetTabAllSheetsListContextMenuOpened",i.WorksheetDataChanged="WorksheetDataChanged",f.Events=i,o.prototype.L0=function(){this.Mf=I},o.prototype.gl=function(t,n,e){var i,t,n,i=this.pl,t=t<<4+n;return i?((n=i[t])||(n=e(),i[t]=n),n):e()},o.prototype.yl=function(t,n){var e,e,e=this.wl;return e&&(e=e[t])?e[n]:I},o.prototype.Ml=function(t,n,e,i){var r,o,r=this.wl;r&&(r[t]||(r[t]={}),(o=r[t])[n]={d:e,i:i})},o.prototype.$t=function(t,n,e,i,r){var o,a,u,o=this,a=o.Mf;return u=a.t0(t,n,e=e===m?3:e),A(u)?!A(r)&&y.St(r.formatter)?Rt.Cl(a,r,o.Sl(t,n,e,0),{},{row:t,col:n,sheet:a}):o.Sl(t,n,e,i):u},o.prototype.Sl=function(t,n,e,i){var r,o,r,a,r,a,r=this,o=r.Mf,r=r.Tl;return e===m&&(e=3),r?((a=r[e])||(r[e]=a={}),(r=a[t])||(a[t]=r={}),(a=r[n])===m&&(a=o.getValue(t,n,e,i),r[n]=a),a):o.getValue(t,n,e,i)},o.prototype.qt=function(t,n,e){var i,r,i,o,i,o,i=this,r=i.Mf,i=i.Al;return e===m&&(e=3),i?((o=i[e])||(i[e]=o={}),(i=o[t])||(o[t]=i={}),(o=i[n])||(o=r.Il(t,n,e,!1,!0),i[n]=o),o.clone(!0)):r.Il(t,n,e,!1,!1)},o.prototype.Gt=function(t,n){var e,i,e,r,e;return void 0===n&&(n=T.SheetArea.viewport),i=(e=this).Mf,(e=e.xl)?(e=(r=(r=e[n])===m?e[n]={}:r)[t])===m?r[t]=i.Gt(t,n):e:i.Gt(t,n)},o.prototype.Kt=function(t,n){var e,i,e,r,e;return void 0===n&&(n=T.SheetArea.viewport),i=(e=this).Mf,(e=e.Nl)?(e=(r=(r=e[n])===m?e[n]={}:r)[t])===m?r[t]=i.nn(t,n):e:i.nn(t,n)},o.prototype.kl=function(t){var n=this;return n.Tl?(n.Dl||(n.Dl=t()),n.Dl):t()},o.prototype._l=function(t){var n=this;return n.Tl?(n.El||(n.El=t()),n.El):t()},o.prototype.jl=function(){var t=this;t.Ol=!0,t.pl={},t.wl={},t.Tl={},t.Al={},t.xl={},t.Nl={}},o.prototype.Rl=function(){this.Ol=!1},o.prototype.Bl=function(){var t=this;t.Ol=!1,t.pl=I,t.wl=I,t.Tl=I,t.Al=I,t.Nl=I,t.xl=I,t.Dl=I,t.El=I},f.Ff=o,D.Ll=function(t,n,e,i,r){var o,a,u,s;if(D.Fl=!0,(o=t.tables)&&o.Pl(n,e,i-n+1,r-e+1))for(a=-1,u=D.Gl=[],s=0;s<=i;s++)t.getRowVisible(s)?u[s]=++a:u[s]=-1},D.dl=function(){D.Gl=I,D.Fl=!1},D.Ue=function(t){var n=D.Ul;return n[t]||(n[t]=d?new d(t):I),n[t]},D.Re=function(t,n,e){var i,r,i,o,o,a,o,n,i,i=D.Hl,r=t+"_"+typeof t;return d?(i[n]||(i[n]={}),(o=(i=i[n])[r])?(e&&(e.conditionalForeColor=e.value=o.color,e.content=z(o.content)),o.text):((o=D.Ul)[n]||(o[n]=new d(n)),n=(a=o[n]).format(t,o={}),(i=i[r]={}).text=n,i.color=o.conditionalForeColor,i.content=o.content,e&&(e.conditionalForeColor=e.value=o.conditionalForeColor,e.content=z(o.content)),n)):t.toString()},D.Cl=function(t,n,e,i,r){var t,n;return e&&"SparklineExValue"===e.typeName?"":(t=n.cellType||t.$f(),n=n.formatter||n._autoFormatter,t.format(e,n,i,r))},D.zl=function(){D.Ul={},D.Hl={}},D.Fl=!1,D.Ul={},D.Hl={},D.Gl=[],Rt=D,f.Be=Rt,kn.Vl=function(t,n,e){var i=Nn(t);i.scaleX=n,i.scaleY=e,i.translateX=i.orgTranslateX*n,i.translateY=i.orgTranslateY*e,t.setTransform(i.scaleX,i.skewX,i.skewY,i.scaleY,i.translateX,i.translateY)},kn.Yl=function(t,n,e){var i=Nn(t);i.orgTranslateX+=n,i.orgTranslateY+=e,i.translateX=i.orgTranslateX*i.scaleX,i.translateY=i.orgTranslateY*i.scaleY,t.setTransform(i.scaleX,i.skewX,i.skewY,i.scaleY,i.translateX,i.translateY)},f.Lf=s=kn,Bt=s,_.Zl=function(){var t,n,n,t,e,t=l.screen,n=t.deviceXDPI,n=l.devicePixelRatio||(n?n/t.logicalXDPI:1),t=20*n,e=nt(t);return.82<e-t?e/20:nt(100*n)/100},_.Wl=function(t,n,e){var i,r,o,a,u,s,c,f,l,i=_;if(Dn(t,1),_n(t,1),(1!==(r=_.Zl())||1!==i.dpr)&&(i.dpr=r,o=n||e&&e.parent)){for(a=i.Ql,u=void 0,s=0;s<a.length;s++)if(o===a[s].workbook){u=a[s];break}if(u||a.push(u={workbook:o,sheets:[],canvases:[]}),n)u.canvases.push(t);else{for(c=void 0,f=u.sheets,l=0;l<f.length;l++)if(f[l].sheet===e){c=f[l];break}c||f.push(c={sheet:e,canvases:[]}),c.canvases.push(t)}}},_.Kl=function(t){return t&&t.Sf||1},_.Jl=function(t){return t&&t.Tf||1},_.Xl=function(t){return t.Af},_.ql=function(t){return t.If},_.$l=function(t,n,e){var i,r,o,i,a,r,n,i=_,r=i.dpr,o=i.Kl(t),i=i.Jl(t);En(t,n),jn(t,e),1===r&&1===o&&1===i?(t.width=n,t.height=e):(a=t.getContext("2d"),Bt.Vl(a,1,1),y.Tt.mozilla?(t.width=x(n*r),t.height=x(e*r)):(t.width=nt(n*r),t.height=nt(e*r)),t.style.width=n+at,t.style.height=e+at,r=t.width/n,n=t.height/e,r===o&&n===i||(Dn(t,r),_n(t,n)),Bt.Vl(a,r,n))},_.th=function(t,n){for(var e,i,r,o,a,u,s,e=_.Ql,i=t.parent,a=0;a<e.length;a++)if(!i||e[a].workbook===i)for(r=e[a].sheets,u=0;u<r.length;u++)if(r[u].sheet===t){for(o=r[u].canvases,s=0;s<o.length;s++)if(o[s]===n){o.splice(s,1);break}break}},_.nh=function(t,n){for(var e,i,r,o,e=_.Ql,r=0;r<e.length;r++)if(e[r].workbook===t)for(i=e[r].canvases,o=0;o<i.length;o++)if(i[o]===n){i.splice(o,1);break}},_.eh=function(t){for(var n,e,i,r,o,n=_.Ql,e=t.parent,r=0;r<n.length;r++)if(!e||n[r].workbook===e){for(i=n[r].sheets,o=0;o<i.length;o++)i[o].sheet===t&&i.splice(o,1);return}},_.ih=function(t){for(var n,e,n=_.Ql,e=0;e<n.length;e++)if(n[e].workbook===t)return void n.splice(e,1)},_.rh=function(){var t,n,e,i,r,o,a,u,s,c,t=_,n=t.Zl();if(t.dpr!==n)for(e=t.Ql,a=o=r=i=void 0,t.dpr=n,u=0;u<e.length;u++){for(o=(r=e[u]).canvases,i=r.sheets,s=0;s<i.length;s++)o=o.concat(i[s].canvases);for(c=0;c<o.length;c++)a=o[c],t.$l(a,t.Xl(a),t.ql(a))}},_.dpr=1,_.Ql=[],f.Bf=_,f.zt=On,O.un=function(t,n,e,i,r){var o,a,u,s,c,f,l,h,d,v,m,o=[];if(t&&0!==t.length&&!isNaN(n)&&(a=r||E())){if(y.bt(a,e),u=y.vt(e),n<=0){for(s=-1,c=!0,f=0;f<t.length;f++)" "===(l=t.charAt(f))||c?" "!==l&&c&&(s=i?u:w(a,a.font,l),c=!1):s=N(s,i?u:w(a,a.font,l));if((n=s)<=0)return[t]}for(h=t.split(/\r\n|\r|\n/),d=0;d<h.length;d++)if(v=Fn(h[d],n,i,u,a))if(0===v.length)o.push("");else for(m=0;m<v.length;m++)o.push(v[m])}return o},O.oh=function(t,n,e,i,r){var o,a,u,s,c,o=[];if(0!==n.length)if(i)o=O.un(n,r,e,!0);else for(a=n.split(/\r\n|\r|\n/),u=0;u<a.length;u++){for(s=[],c=0;c<a[u].length;c++)s.push(a[u][c]);o.push(s)}return o},O.Ht=function(t,n,e,i,r,o){var a,u,s,c,o,f,l,h,a=[];if(0!==t.length&&(u=o||E())){if(n<=0&&(n=Hn(u,i,e,r))<=0){for(c=[],s=0;s<i.length;s++)A(i[s].text)||c.push({textLength:O.ah([i[s]],e,1,r,!1,u),text:i[s].text,textInfos:[i[s]]});return c}for(o=O.uh(t),f=O.Vt(o,O.Yt(i)),s=0;s<f.length;s++)if(l=Pn(f[s],n,e,r,u))if(0===l.length)a.push("");else for(h=0;h<l.length;h++)a.push(l[h])}return a},O.uh=function(t){for(var n,e,i,n=[],e=t.split(/\r\n|\r|\n/),i=0;i<e.length;i++)n.push(On(e[i]));return n},O.Vt=function(t,n){for(var e,i,r,o,a,u,s,c,f,e=[],i=0,r=0,o=0;o<t.length;o++){for(a=[],u=0;u<t[o].length&&i<n.length;u++)if((s=t[o][u]).length<=n[i].text.length-r)a.push([{style:n[i].style,text:s}]),r+=s.length;else{for((c=[]).push({style:n[i].style,text:n[i].text.substring(r)}),f=s.length-(n[i].text.length-r),i++;i<n.length;i++){if(f<n[i].text.length){c.push({style:n[i].style,text:s.substring(s.length-f)}),r=f;break}if(f===n[i].text.length){c.push({style:n[i].style,text:s.substring(s.length-f)}),i++,r=0;break}c.push({style:n[i].style,text:n[i].text}),f-=n[i].text.length}a.push(c)}e.push(a)}return e},O.Wt=function(t,n,e,i){var i,n,i=i||E();return i?(n&&y.bt(i,n),n=e?j(t):t,w(i,i.font,n)):0},O.Yt=function(t){for(var n,e,n=[],e=0;e<t.length;e++)n.push({style:t[e].style,text:t[e].text&&t[e].text.replace(/\r\n|\r|\n/g,"")});return n},O.ah=function(t,n,e,i,r,o){var a,u,s,c,f,l,a=o||E();if(!a)return 0;for(s=u=0;s<t.length;s++)c=void 0,c=t[s].style&&t[s].style.font?t[s].style.font:n,y.bt(a,c),f="",f=s===t.length-1&&r?j(t[s].text):t[s].text,l=0,i?l=y.vt(c)*f.length/e:A(t[s].text)||(l=w(a,a.font,t[s].text)/e),t[s].style&&t[s].style.vertAlign&&(l*=ot),u+=l;return u},O.Zt=function(t,n,e,i,r,o,a,u){var s,c,f,r,a,l,h,s=0,c=y.vt(o),f,r=O.un(r,(a-4-c*i)/e,o),a=r.length,l,h=c*e;return s=(a-1)*(c/e),s=(s+=O.Wt(r[0],o)/2*i+h)+(O.Wt(r[a-1],o)/2*i+h)},O.tt=j,O.J=E,Ft=O,f.q=Ft,f.$e=Pt=function(s){s.ch=function(t,n){var e,i;for(s.fh||(s.fh=[]),s.lh={},e=s.fh,n.name=t,n.priority=n.priority||5e3,i=0;;i++)if(i>=e.length||n.priority>e[i].priority){e.splice(i,0,n);break}},s.et=function(t,n,e,i){var r,o,a,u,r=s.fh;if(r){if(!(o=s.lh[n]))for(o=s.lh[n]=[],a=0;a<r.length;a++)(u=r[a][n])&&o.push(u);for(a=0;a<o.length&&(o[a].call(t,e),!i||!i());a++);}}},zn.prototype.get=function(t,n){var t=this.Nf[t];return t?t[n]:m},zn.prototype.set=function(t,n,e){var i,i;(i=(i=this.Nf[t])||(this.Nf[t]={}))[n]=e},f.Rf=zn,Vn.processBackspaceAndLeftArrowKeyEvent=function(t,n){var e,i,r,o,a,u,u,o,s,c,u,f,o,s,c,u,i,e=l.getSelection();if(!(e.rangeCount<=0))if(i=e.anchorNode,r=e.anchorOffset,o=t.target,y.browser.msie&&!y.browser.edge&&n&&Qn(i,r,o))u=(a=parseFloat(y.browser.version)<10?ie(o):o.innerText).slice(0,-1),o.innerHTML=u.replace(/\r/g,"").replace(/\n/g,"<br>\u200b"),e.selectAllChildren(o),0<e.rangeCount&&e.collapseToEnd(),rn(t);else if(o=(u=e.getRangeAt(0)).startContainer,s=u.endContainer,c=u.startOffset,u=u.endOffset,f=o===s&&c===u){if((o=ne(i,r))&&o.zeroWidthCharNode){if(s=o.zeroWidthCharNode,c=o.previousTextNode,n)if(R(s))s.parentNode.removeChild(s);else{if(s.parentNode.removeChild(s.previousSibling),Jn(c))return void rn(t);(u=e.getRangeAt(0)).setStart(s,0),u.setEnd(s,1),u.deleteContents()}i=v.createRange(),Zn(c)?(i.setStart(c,1),i.setEnd(c,1)):(i.setStartAfter(c),i.setEndAfter(c)),i.collapse(!1),e.removeAllRanges(),e.addRange(i),rn(t)}}else n&&Yn(e)},Vn.processDeleteAndRightArrowKeyEvent=function(t,n){var e,i,r,o,a,i,u,r,o,a,i,r,i,s,e=l.getSelection();e.rangeCount<=0||(r=(i=e.getRangeAt(0)).startContainer,o=i.endContainer,a=i.startOffset,i=i.endOffset,(u=r===o&&a===i)?(r=ee(e))&&r.node&&(i=ne(o=r.node,a=r.offset),n?(r=e.getRangeAt(0),1===a?(r.setStart(o,0),r.setEnd(o,1),o.parentNode.removeChild(o.previousSibling),r.deleteContents(),i&&i.previousTextNode&&(i=i.previousTextNode,s=v.createRange(),Zn(i)?(s.setStart(i,1),s.setEnd(i,1)):(s.setStartAfter(i),s.setEndAfter(i)),s.collapse(!1),e.removeAllRanges(),e.addRange(s))):0===a&&(r.setStart(o,1),r.setEnd(o,2),r.deleteContents())):((s=v.createRange()).setStart(o,a),s.setEnd(o,a),s.collapse(!1),e.removeAllRanges(),e.addRange(s)),rn(t)):n&&Yn(e))},f.di=Vn,f.Of={touch:!1},f.jf=se,f.Ef=ce,f._f=fe,f.Df=le,f.kf=de,ve.hh=function(t){var n,e,i;if(!A(t))return e=t.row+t.rowCount-1,i=t.col+t.colCount-1,(n={}).minRow=t.row,n.minCol=t.col,n.maxRow=e,n.maxCol=i,n},ve.vh=function(t,n){if(A(n)||A(n.minRow))return t;t.minRow=A(t.minRow)?n.minRow:N(t.minRow,n.minRow),t.minCol=A(t.minCol)?n.minCol:N(t.minCol,n.minCol),t.maxRow=A(t.maxRow)?n.maxRow:g(t.maxRow,n.maxRow),t.maxCol=A(t.maxCol)?n.maxCol:g(t.maxCol,n.maxCol)},ve.updateUsedRangeByData=function(t,n,e,i,r){i===r||!A(i)&&!A(r)||A(t)||(!A(i)&&A(r)&&t.removeRowAndColInfo(n,e),A(i)&&!A(r)&&t.addRowAndColInfo(n,e))},f.UsedRangeUtil=ve,me.prototype.getRowUsedRange=function(){var t,n,n,e,i,r,o,t,n=this.wholeRows,n=Object.keys(n);return 0<n.length&&(e=+n[0],i=-1,r=+n[n.length-1],o=0),{minRow:e,minCol:i,maxRow:r,maxCol:o}},me.prototype.getColUsedRange=function(){var t,n,n,e,i,r,o,t,n=this.wholeCols,n=Object.keys(n);return 0<n.length&&(i=+n[0],e=-1,o=+n[n.length-1],r=0),{minRow:e,minCol:i,maxRow:r,maxCol:o}},me.prototype.getUsedRange=function(){var t,n,t,e,i,r,o,t=this,n=Object.keys(t.rowInfo),t=Object.keys(t.colInfo);return n&&0<n.length&&t&&0<t.length&&(e=+n[0],i=+t[0],r=+n[n.length-1],o=+t[t.length-1]),{minRow:e,minCol:i,maxRow:r,maxCol:o}},me.prototype.addRowAndColInfo=function(t,n){var e=this,i=e.rowInfo,r=e.colInfo;A(t)||A(n)||-1===t&&-1===n||(-1===t?e.wholeCols[n]=!0:-1===n?e.wholeRows[t]=!0:(A(i[t])?i[t]=1:i[t]++,A(r[n])?r[n]=1:r[n]++))},me.prototype.removeRowAndColInfo=function(t,n){var e=this,i=e.rowInfo,r=e.colInfo;-1===t&&-1===n||(-1===t?delete e.wholeCols[n]:-1===n?delete e.wholeRows[t]:(A(i[t])||(1===i[t]?delete i[t]:i[t]--),A(r[n])||(1===r[n]?delete r[n]:r[n]--)))},me.prototype.addHeadInfo=function(t,n,e){for(var i,r,o,a,u,i=this,r=e?i.rowInfo:i.colInfo,o=Object.keys(r),a=o.length-1,u=+o[a];t<=u;)r[u+n]=r[u],u=+o[--a]},me.prototype.removeHeadInfo=function(t,n,e){for(var i,r,o,a,u,s,c,f,i=this,r=e?i.rowInfo:i.colInfo,o,a=t+n,u=0,s=Object.keys(r);u<s.length;u++)t<=(f=+(c=s[u]))&&f<a?delete r[c]:a<=f&&(r[f-n]=r[c],delete r[c])},me.prototype.dispose=function(){var t=this;t.rowInfo=m,t.colInfo=m,t.wholeCols=m,t.wholeRows=m},f.BaseUsedRange=me,f.NUMBER_ARRAY=["0","1","2","3","4","5","6","7","8","9"],ge.prototype.getTextIndex=function(t){var n,e,i,r,o,a,n=this;if(t.richText)if((i=t.text)===m&&(i=t.text=y.g0(t).text),(e=n.mh[i])===m||n.gh[i]===m)e=n.ph.push(t)-1,n.mh[i]=e,n.gh[i]=[],n.gh[i].push({i:e,v:t});else{for(r=void 0,o=0,a=n.gh[i].length;o<a;o++)if(n.gh[i][o]&&n.gh[i][o].v===t){r=o;break}0<=r?e=n.gh[i][r].i:(e=n.ph.push(t)-1,n.gh[i].push({i:e,v:t}))}else(e=n.mh[t])!==m&&!n.gh[t]||(e=n.ph.push(t)-1,n.mh[t]=e);return e},ge.prototype.getText=function(t){var n=this.ph[t];return A(n)?t:n},ge.prototype.getCount=function(){return this.bh},ge.prototype.reset=function(){var t=this;t.ph=[],t.mh={},t.gh={},t.bh=0},ge.prototype.rebuildSSTDict=function(){var i=this;i.ph.forEach(function(t,n){var e;t.richText?((e=t.text)===m&&(e=t.text=y.g0(t).text),i.mh[e]=n):i.mh[t]=n})},ge.prototype.yh=function(t){var n;t&&0<t.length&&((n=this).reset(),n.ph=t)},ge.prototype.wh=function(){return this.ph},f.SharedStrings=ge,Yt={8:{"Gill Sans MT":6,Abadi:7,"Abadi Extra Light":6,"Agency FB":5,Aharoni:5,Aldhabi:4,Algerian:7,"Ami R":5,"Angsana New":4,AngsanaUPC:4,Aparajita:4,"Arabic Typesetting":4,Arial:6,"Arial Black":7,"Arial Narrow":5,"Arial Nova":6,"Arial Nova Cond":6,"Arial Nova Cond Light":5,"Arial Nova Light":6,"Arial Rounded MT Bold":7,"Baskerville Old Face":5,Batang:6,BatangChe:6,"Bauhaus 93":6,"Bell MT":6,Bembo:5,"Berlin Sans FB":7,"Berlin Sans FB Demi":7,"Bernard MT Condensed":5,"Blackadder ITC":4,"Bodoni MT":5,"Bodoni MT Black":7,"Bodoni MT Condensed":4,"Bodoni MT Poster Compressed":4,"Book Antiqua":6,"Bookman Old Style":7,"Bookshelf Symbol 7":8,"Bradley Hand ITC":7,"Britannic Bold":7,Broadway:7,"Browallia New":4,BrowalliaUPC:4,"Brush Script MT":6,Calibri:6,"Calibri Light":6,"Californian FB":5,"Calisto MT":6,Cambria:6,"Cambria Math":6,Candara:6,Castellar:8,Centaur:5,Century:6,"Century Gothic":6,"Century Schoolbook":6,Chiller:5,"Colonna MT":6,"Comic Sans MS":7,Consolas:6,Constantia:6,"Cooper Black":7,"Copperplate Gothic Bold":8,"Copperplate Gothic Light":8,Corbel:6,"Cordia New":4,CordiaUPC:4,"Courier New":7,"Curlz MT":6,Dante:5,DaunPenh:4,David:5,DilleniaUPC:3,DokChampa:6,Dotum:6,DotumChe:6,Dubai:6,"Dubai Light":6,"Dubai Medium":6,Ebrima:6,"Edwardian Script ITC":5,Elephant:8,"Engravers MT":7,"Eras Bold ITC":7,"Eras Demi ITC":7,"Eras Light ITC":6,"Eras Medium ITC":6,EucrosiaUPC:4,Euphemia:6,"Expo M":10,FangSong:6,"Felix Titling":6,"Footlight MT Light":6,Forte:6,"Franklin Gothic Book":6,"Franklin Gothic Demi":6,"Franklin Gothic Demi Cond":6,"Franklin Gothic Heavy":6,"Franklin Gothic Medium":6,"Franklin Gothic Medium Cond":6,FrankRuehl:5,FreesiaUPC:5,"Freestyle Script":4,"French Script MT":4,Gabriola:4,Gadugi:6,Garamond:5,Gautami:7,Georgia:8,"Georgia Pro":6,"Georgia Pro Black":8,"Georgia Pro Cond":6,"Georgia Pro Cond Black":7,"Georgia Pro Cond Light":6,"Georgia Pro Cond Semibold":6,"Georgia Pro Light":6,"Georgia Pro Semibold":7,Gigi:5,"Gill Sans MT Condensed":4,"Gill Sans MT Ext Condensed Bold":4,"Gill Sans Nova":6,"Gill Sans Nova Cond":4,"Gill Sans Nova Cond Lt":3,"Gill Sans Nova Cond Ultra Bold":6,"Gill Sans Nova Cond XBd":6,"Gill Sans Nova Light":6,"Gill Sans Nova Ultra Bold":9,"Gill Sans Ultra Bold":9,"Gill Sans Ultra Bold Condensed":6,Gisha:6,"Gloucester MT Extra Condensed":4,"Goudy Old Style":6,"Goudy Stout":9,Grotesque:5,"Grotesque Light":5,Gulim:6,GulimChe:6,Gungsuh:6,GungsuhChe:6,"Hadassah Friedlaender":6,Haettenschweiler:5,"Harlow Solid Italic":5,Harrington:6,"Headline R":8,HGGothicE:6,HGGothicM:6,HGGyoshotai:6,HGKyokashotai:6,HGMaruGothicMPRO:8,HGMinchoB:7,HGMinchoE:7,HGPGothicE:7,HGPGothicM:7,HGPGyoshotai:6,HGPKyokashotai:6,HGPMinchoB:6,HGPMinchoE:7,HGPSoeiKakugothicUB:8,HGPSoeiKakupoptai:8,HGPSoeiPresenceEB:7,HGSeikaishotaiPRO:7,HGSGothicE:6,HGSGothicM:6,HGSGyoshotai:5,HGSKyokashotai:5,HGSMinchoB:6,HGSMinchoE:7,HGSoeiKakugothicUB:7,HGSoeiKakupoptai:7,HGSoeiPresenceEB:7,HGSSoeiKakugothicUB:7,HGSSoeiKakupoptai:7,HGSSoeiPresenceEB:6,"High Tower Text":5,"HYGothic-Extra":7,"HYGothic-Medium":6,"HYGraphic-Medium":6,"HYGungSo-Bold":6,"HYHeadLine-Medium":6,"HYMyeongJo-Extra":7,"HYPMokGak-Bold":8,"HYPost-Light":7,"HYPost-Medium":8,"HYShortSamul-Medium":4,"HYSinMyeongJo-Medium":7,Impact:6,"Imprint MT Shadow":6,"Informal Roman":6,"Ink Free":6,IrisUPC:6,"Iskoola Pota":6,JasmineUPC:6,"Javanese Text":6,Jokerman:8,"Juice ITC":4,KaiTi:6,Kalinga:6,Kartika:6,"Khmer UI":6,KodchiangUPC:6,Kokila:6,"Kristen ITC":7,"Kunstler Script":4,"Lao UI":6,Latha:6,Leelawadee:6,"Leelawadee UI":6,"Leelawadee UI Semilight":6,"Levenim MT":6,LilyUPC:6,"Lucida Bright":7,"Lucida Calligraphy":7,"Lucida Console":8,"Lucida Fax":7,"Lucida Handwriting":8,"Lucida Sans":7,"Lucida Sans Typewriter":7,"Lucida Sans Unicode":8,"Magic R":7,Magneto:8,"Maiandra GD":7,"Malgun Gothic":6,"Malgun Gothic Semilight":7,Mangal:7,Marlett:12,"Matura MT Script Capitals":8,Meiryo:7,"Meiryo UI":7,"Microsoft GothicNeo":7,"Microsoft Himalaya":5,"Microsoft JhengHei":7,"Microsoft JhengHei Light":7,"Microsoft JhengHei UI":7,"Microsoft JhengHei UI Light":7,"Microsoft New Tai Lue":6,"Microsoft PhagsPa":6,"Microsoft Sans Serif":7,"Microsoft Tai Le":6,"Microsoft Uighur":4,"Microsoft YaHei Light":7,"Microsoft YaHei UI":7,"Microsoft YaHei UI Light":7,"Microsoft Yi Baiti":7,MingLiU:7,MingLiU_HKSCS:7,"MingLiU_HKSCS-ExtB":7,"MingLiU-ExtB":7,Miriam:7,"Miriam Fixed":7,Mistral:6,"Modern No. 20":6,"MoeumT R":7,"Mongolian Baiti":7,"Monotype Corsiva":6,MoolBoran:7,"MS Gothic":7,"MS Mincho":7,"MS Outlook":7,"MS PGothic":7,"MS PMincho":7,"MS Reference Sans Serif":8,"MS Reference Specialty":14,"MS UI Gothic":7,"MT Extra":12,"MV Boli":9,"Myanmar Text":6,Narkisim:7,"Neue Haas Grotesk Text Pro":7,"New Gulim":7,"News Gothic MT":7,"Niagara Engraved":5,"Niagara Solid":5,"Nirmala UI":6,"Nirmala UI Semilight":7,Nyala:7,"OCR A Extended":8,OCRB:8,"Old English Text MT":7,Onyx:5,"Palace Script MT":4,"Palatino Linotype":6,Papyrus:7,Parchment:3,Perpetua:5,"Perpetua Titling MT":7,"Plantagenet Cherokee":7,Playbill:5,PMingLiU:6,"PMingLiU-ExtB":6,"Poor Richard":7,Pristina:6,"Pyunji R":6,Raavi:7,"Rage Italic":7,Ravie:11,Rockwell:6,"Rockwell Condensed":5,"Rockwell Extra Bold":8,"Rockwell Light":7,"Rockwell Nova":7,"Rockwell Nova Cond":7,"Rockwell Nova Cond Light":7,"Rockwell Nova Extra Bold":7,"Rockwell Nova Light":7,Rod:7,"Sakkal Majalla":7,"Sanskrit Text":7,"Script MT Bold":6,"Segoe MDL2 Assets":4,"Segoe Print":8,"Segoe Script":8,"Segoe UI":6,"Segoe UI Black":7,"Segoe UI Emoji":6,"Segoe UI Historic":6,"Segoe UI Light":6,"Segoe UI Semibold":6,"Segoe UI Semilight":6,"Segoe UI Symbol":6,Selawik:6,"Selawik Light":6,"Selawik Semibold":6,"Shonar Bangla":6,"Showcard Gothic":6,Shruti:6,"Simplified Arabic":6,"Simplified Arabic Fixed":6,"SimSun-ExtB":6,"Sitka Banner":6,"Sitka Display":6,"Sitka Heading":6,"Sitka Small":8,"Sitka Subheading":6,"Sitka Text":7,"Snap ITC":10,"Source Sans Pro":6,"Source Sans Pro Black":6,"Source Sans Pro ExtraLight":6,"Source Sans Pro Light":6,"Source Sans Pro SemiBold":6,Stencil:6,Sylfaen:6,Symbol:6,Tahoma:6,"Tempus Sans ITC":7,"TH SarabunPSK":6,"Times New Roman":6,"Traditional Arabic":6,"Trebuchet MS":6,Tunga:6,"Tw Cen MT":6,"Tw Cen MT Condensed":4,"Tw Cen MT Condensed Extra Bold":5,"UD Digi Kyokasho N-B":6,"UD Digi Kyokasho NK-B":6,"UD Digi Kyokasho NK-R":6,"UD Digi Kyokasho NP-B":6,"UD Digi Kyokasho NP-R":6,"UD Digi Kyokasho N-R":6,Univers:6,"Univers Condensed":6,"Univers Condensed Light":6,"Univers Light":6,"Urdu Typesetting":6,Utsaah:6,Vani:6,Verdana:7,"Verdana Pro":6,"Verdana Pro Black":6,"Verdana Pro Cond":6,"Verdana Pro Cond Black":6,"Verdana Pro Cond Light":6,"Verdana Pro Cond SemiBold":6,"Verdana Pro Light":6,"Verdana Pro SemiBold":6,Vijaya:6,"Viner Hand ITC":7,Vivaldi:5,"Vladimir Script":5,Vrinda:6,Webdings:11,"Wide Latin":14,Wingdings:15,"Wingdings 2":12,"Wingdings 3":10,"Yet R":6,"Yu Gothic":6,"Yu Gothic Light":6,"Yu Gothic Medium":6,"Yu Gothic UI":6,"Yu Gothic UI Light":6,"Yu Gothic UI Semibold":6,"Yu Gothic UI Semilight":6,"Yu Mincho":6,"Yu Mincho Demibold":6,"Yu Mincho Light":6,"\u4eff\u5b8b":6,"\u534e\u6587\u4e2d\u5b8b":7,"\u534e\u6587\u4eff\u5b8b":5,"\u534e\u6587\u5b8b\u4f53":5,"\u534e\u6587\u5f69\u4e91":6,"\u534e\u6587\u65b0\u9b4f":6,"\u534e\u6587\u6977\u4f53":5,"\u534e\u6587\u7425\u73c0":6,"\u534e\u6587\u7ec6\u9ed1":6,"\u534e\u6587\u884c\u6977":6,"\u534e\u6587\u96b6\u4e66":5,"\u5b8b\u4f53":6,"\u5e7c\u5706":6,"\u5fae\u8f6f\u96c5\u9ed1":6,"\u5fae\u8f6f\u96c5\u9ed1 Light":6,"\u65b0\u5b8b\u4f53":6,"\u65b9\u6b63\u59da\u4f53":6,"\u65b9\u6b63\u8212\u4f53":6,"\u6977\u4f53":6,"\u7b49\u7ebf":6,"\u7b49\u7ebf Light":6,"\u96b6\u4e66":6,"\u9ed1\u4f53":6,"\u6e38\u30b4\u30b7\u30c3\u30af":6,"\uff2d\uff33 \uff30\u660e\u671d":6,'"\uff2d\uff33 \uff30\u30b4\u30b7\u30c3\u30af"':6,"\u30e1\u30a4\u30ea\u30aa":7,"HG\uff7a\uff9e\uff7c\uff6f\uff78E":6,"HG\u660e\u671dB":6,"HG\uff7a\uff9e\uff7c\uff6f\uff78M":6},9:{"Gill Sans MT":6,Abadi:7,"Abadi Extra Light":7,"Agency FB":5,Aharoni:5,Aldhabi:4,Algerian:7,"Ami R":5,"Angsana New":4,AngsanaUPC:4,Aparajita:5,"Arabic Typesetting":4,Arial:7,"Arial Black":8,"Arial Narrow":5,"Arial Nova":7,"Arial Nova Cond":6,"Arial Nova Cond Light":5,"Arial Nova Light":7,"Arial Rounded MT Bold":7,"Baskerville Old Face":6,Batang:6,BatangChe:6,"Bauhaus 93":7,"Bell MT":6,Bembo:6,"Berlin Sans FB":7,"Berlin Sans FB Demi":8,"Bernard MT Condensed":6,"Blackadder ITC":5,"Bodoni MT":6,"Bodoni MT Black":8,"Bodoni MT Condensed":4,"Bodoni MT Poster Compressed":4,"Book Antiqua":6,"Bookman Old Style":7,"Bookshelf Symbol 7":9,"Bradley Hand ITC":8,"Britannic Bold":7,Broadway:8,"Browallia New":4,BrowalliaUPC:4,"Brush Script MT":6,Calibri:6,"Calibri Light":6,"Californian FB":7,"Calisto MT":6,Cambria:7,"Cambria Math":7,Candara:7,Castellar:9,Centaur:6,Century:7,"Century Gothic":7,"Century Schoolbook":7,Chiller:6,"Colonna MT":6,"Comic Sans MS":7,Consolas:7,Constantia:7,"Cooper Black":7,"Copperplate Gothic Bold":9,"Copperplate Gothic Light":9,Corbel:6,"Cordia New":4,CordiaUPC:4,"Courier New":7,"Curlz MT":6,Dante:5,DaunPenh:4,David:5,DilleniaUPC:4,DokChampa:7,Dotum:6,DotumChe:6,Dubai:6,"Dubai Light":6,"Dubai Medium":6,Ebrima:6,"Edwardian Script ITC":6,Elephant:9,"Engravers MT":8,"Eras Bold ITC":8,"Eras Demi ITC":7,"Eras Light ITC":6,"Eras Medium ITC":7,EucrosiaUPC:5,Euphemia:7,"Expo M":10,FangSong:6,"Felix Titling":7,"Footlight MT Light":7,Forte:6,"Franklin Gothic Book":7,"Franklin Gothic Demi":7,"Franklin Gothic Demi Cond":6,"Franklin Gothic Heavy":7,"Franklin Gothic Medium":7,"Franklin Gothic Medium Cond":6,FrankRuehl:5,FreesiaUPC:5,"Freestyle Script":5,"French Script MT":4,Gabriola:5,Gadugi:6,Garamond:6,Gautami:7,Georgia:8,"Georgia Pro":7,"Georgia Pro Black":9,"Georgia Pro Cond":6,"Georgia Pro Cond Black":8,"Georgia Pro Cond Light":6,"Georgia Pro Cond Semibold":7,"Georgia Pro Light":7,"Georgia Pro Semibold":7,Gigi:7,"Gill Sans MT Condensed":4,"Gill Sans MT Ext Condensed Bold":4,"Gill Sans Nova":6,"Gill Sans Nova Cond":4,"Gill Sans Nova Cond Lt":4,"Gill Sans Nova Cond Ultra Bold":7,"Gill Sans Nova Cond XBd":6,"Gill Sans Nova Light":6,"Gill Sans Nova Ultra Bold":10,"Gill Sans Ultra Bold":10,"Gill Sans Ultra Bold Condensed":7,Gisha:6,"Gloucester MT Extra Condensed":5,"Goudy Old Style":6,"Goudy Stout":10,Grotesque:6,"Grotesque Light":6,Gulim:6,GulimChe:6,Gungsuh:6,GungsuhChe:6,"Hadassah Friedlaender":7,Haettenschweiler:5,"Harlow Solid Italic":6,Harrington:7,"Headline R":9,HGGothicE:6,HGGothicM:6,HGGyoshotai:6,HGKyokashotai:6,HGMaruGothicMPRO:9,HGMinchoB:7,HGMinchoE:7,HGPGothicE:8,HGPGothicM:8,HGPGyoshotai:7,HGPKyokashotai:7,HGPMinchoB:7,HGPMinchoE:7,HGPSoeiKakugothicUB:9,HGPSoeiKakupoptai:9,HGPSoeiPresenceEB:8,HGSeikaishotaiPRO:7,HGSGothicE:7,HGSGothicM:7,HGSGyoshotai:6,HGSKyokashotai:6,HGSMinchoB:7,HGSMinchoE:7,HGSoeiKakugothicUB:7,HGSoeiKakupoptai:7,HGSoeiPresenceEB:7,HGSSoeiKakugothicUB:8,HGSSoeiKakupoptai:8,HGSSoeiPresenceEB:7,"High Tower Text":6,"HYGothic-Extra":8,"HYGothic-Medium":7,"HYGraphic-Medium":7,"HYGungSo-Bold":7,"HYHeadLine-Medium":7,"HYMyeongJo-Extra":8,"HYPMokGak-Bold":9,"HYPost-Light":8,"HYPost-Medium":9,"HYShortSamul-Medium":5,"HYSinMyeongJo-Medium":8,Impact:7,"Imprint MT Shadow":6,"Informal Roman":7,"Ink Free":6,IrisUPC:6,"Iskoola Pota":6,JasmineUPC:6,"Javanese Text":7,Jokerman:9,"Juice ITC":4,KaiTi:6,Kalinga:6,Kartika:6,"Khmer UI":6,KodchiangUPC:6,Kokila:6,"Kristen ITC":7,"Kunstler Script":4,"Lao UI":6,Latha:6,Leelawadee:6,"Leelawadee UI":6,"Leelawadee UI Semilight":7,"Levenim MT":6,LilyUPC:6,"Lucida Bright":7,"Lucida Calligraphy":9,"Lucida Console":8,"Lucida Fax":8,"Lucida Handwriting":9,"Lucida Sans":8,"Lucida Sans Typewriter":7,"Lucida Sans Unicode":9,"Magic R":8,Magneto:9,"Maiandra GD":8,"Malgun Gothic":7,"Malgun Gothic Semilight":8,Mangal:7,Marlett:13,"Matura MT Script Capitals":9,Meiryo:8,"Meiryo UI":8,"Microsoft GothicNeo":7,"Microsoft Himalaya":5,"Microsoft JhengHei":7,"Microsoft JhengHei Light":8,"Microsoft JhengHei UI":7,"Microsoft JhengHei UI Light":8,"Microsoft New Tai Lue":7,"Microsoft PhagsPa":7,"Microsoft Sans Serif":8,"Microsoft Tai Le":7,"Microsoft Uighur":5,"Microsoft YaHei Light":8,"Microsoft YaHei UI":7,"Microsoft YaHei UI Light":8,"Microsoft Yi Baiti":7,MingLiU:7,MingLiU_HKSCS:7,"MingLiU_HKSCS-ExtB":7,"MingLiU-ExtB":7,Miriam:7,"Miriam Fixed":7,Mistral:6,"Modern No. 20":6,"MoeumT R":8,"Mongolian Baiti":7,"Monotype Corsiva":6,MoolBoran:7,"MS Gothic":7,"MS Mincho":7,"MS Outlook":7,"MS PGothic":7,"MS PMincho":7,"MS Reference Sans Serif":9,"MS Reference Specialty":15,"MS UI Gothic":7,"MT Extra":13,"MV Boli":9,"Myanmar Text":7,Narkisim:7,"Neue Haas Grotesk Text Pro":7,"New Gulim":8,"News Gothic MT":7,"Niagara Engraved":5,"Niagara Solid":5,"Nirmala UI":7,"Nirmala UI Semilight":8,Nyala:7,"OCR A Extended":8,OCRB:8,"Old English Text MT":7,Onyx:5,"Palace Script MT":5,"Palatino Linotype":6,Papyrus:8,Parchment:4,Perpetua:6,"Perpetua Titling MT":8,"Plantagenet Cherokee":7,Playbill:5,PMingLiU:7,"PMingLiU-ExtB":7,"Poor Richard":8,Pristina:6,"Pyunji R":7,Raavi:7,"Rage Italic":7,Ravie:12,Rockwell:7,"Rockwell Condensed":5,"Rockwell Extra Bold":8,"Rockwell Light":7,"Rockwell Nova":7,"Rockwell Nova Cond":7,"Rockwell Nova Cond Light":7,"Rockwell Nova Extra Bold":7,"Rockwell Nova Light":7,Rod:7,"Sakkal Majalla":7,"Sanskrit Text":7,"Script MT Bold":6,"Segoe MDL2 Assets":5,"Segoe Print":9,"Segoe Script":9,"Segoe UI":6,"Segoe UI Black":7,"Segoe UI Emoji":6,"Segoe UI Historic":6,"Segoe UI Light":6,"Segoe UI Semibold":7,"Segoe UI Semilight":7,"Segoe UI Symbol":6,Selawik:6,"Selawik Light":6,"Selawik Semibold":6,"Shonar Bangla":6,"Showcard Gothic":8,Shruti:6,"Simplified Arabic":6,"Simplified Arabic Fixed":6,"SimSun-ExtB":6,"Sitka Banner":6,"Sitka Display":6,"Sitka Heading":7,"Sitka Small":8,"Sitka Subheading":7,"Sitka Text":8,"Snap ITC":10,"Source Sans Pro":6,"Source Sans Pro Black":6,"Source Sans Pro ExtraLight":6,"Source Sans Pro Light":6,"Source Sans Pro SemiBold":6,Stencil:7,Sylfaen:6,Symbol:6,Tahoma:7,"Tempus Sans ITC":8,"TH SarabunPSK":6,"Times New Roman":6,"Traditional Arabic":6,"Trebuchet MS":6,Tunga:6,"Tw Cen MT":7,"Tw Cen MT Condensed":4,"Tw Cen MT Condensed Extra Bold":6,"UD Digi Kyokasho N-B":6,"UD Digi Kyokasho NK-B":6,"UD Digi Kyokasho NK-R":6,"UD Digi Kyokasho NP-B":6,"UD Digi Kyokasho NP-R":6,"UD Digi Kyokasho N-R":6,Univers:6,"Univers Condensed":6,"Univers Condensed Light":6,"Univers Light":6,"Urdu Typesetting":6,Utsaah:6,Vani:6,Verdana:8,"Verdana Pro":6,"Verdana Pro Black":6,"Verdana Pro Cond":6,"Verdana Pro Cond Black":6,"Verdana Pro Cond Light":6,"Verdana Pro Cond SemiBold":6,"Verdana Pro Light":6,"Verdana Pro SemiBold":6,Vijaya:6,"Viner Hand ITC":8,Vivaldi:5,"Vladimir Script":6,Vrinda:6,Webdings:12,"Wide Latin":15,Wingdings:16,"Wingdings 2":14,"Wingdings 3":11,"Yet R":6,"Yu Gothic":7,"Yu Gothic Light":6,"Yu Gothic Medium":7,"Yu Gothic UI":6,"Yu Gothic UI Light":6,"Yu Gothic UI Semibold":7,"Yu Gothic UI Semilight":7,"Yu Mincho":7,"Yu Mincho Demibold":6,"Yu Mincho Light":6,"\u4eff\u5b8b":6,"\u534e\u6587\u4e2d\u5b8b":7,"\u534e\u6587\u4eff\u5b8b":6,"\u534e\u6587\u5b8b\u4f53":6,"\u534e\u6587\u5f69\u4e91":7,"\u534e\u6587\u65b0\u9b4f":7,"\u534e\u6587\u6977\u4f53":6,"\u534e\u6587\u7425\u73c0":7,"\u534e\u6587\u7ec6\u9ed1":7,"\u534e\u6587\u884c\u6977":6,"\u534e\u6587\u96b6\u4e66":5,"\u5b8b\u4f53":6,"\u5e7c\u5706":6,"\u5fae\u8f6f\u96c5\u9ed1":7,"\u5fae\u8f6f\u96c5\u9ed1 Light":7,"\u65b0\u5b8b\u4f53":6,"\u65b9\u6b63\u59da\u4f53":6,"\u65b9\u6b63\u8212\u4f53":7,"\u6977\u4f53":6,"\u7b49\u7ebf":6,"\u7b49\u7ebf Light":6,"\u96b6\u4e66":6,"\u9ed1\u4f53":6,"\u6e38\u30b4\u30b7\u30c3\u30af":7,"\uff2d\uff33 \uff30\u660e\u671d":6,'"\uff2d\uff33 \uff30\u30b4\u30b7\u30c3\u30af"':6,"\u30e1\u30a4\u30ea\u30aa":7,"HG\uff7a\uff9e\uff7c\uff6f\uff78E":6,"HG\u660e\u671dB":6,"HG\uff7a\uff9e\uff7c\uff6f\uff78M":6},10:{"Gill Sans MT":7,Abadi:8,"Abadi Extra Light":7,"Agency FB":5,Aharoni:5,Aldhabi:4,Algerian:8,"Ami R":5,"Angsana New":4,AngsanaUPC:4,Aparajita:5,"Arabic Typesetting":4,Arial:7,"Arial Black":9,"Arial Narrow":6,"Arial Nova":7,"Arial Nova Cond":7,"Arial Nova Cond Light":6,"Arial Nova Light":7,"Arial Rounded MT Bold":8,"Baskerville Old Face":6,Batang:7,BatangChe:7,"Bauhaus 93":7,"Bell MT":7,Bembo:6,"Berlin Sans FB":8,"Berlin Sans FB Demi":8,"Bernard MT Condensed":6,"Blackadder ITC":5,"Bodoni MT":6,"Bodoni MT Black":9,"Bodoni MT Condensed":4,"Bodoni MT Poster Compressed":5,"Book Antiqua":7,"Bookman Old Style":8,"Bookshelf Symbol 7":10,"Bradley Hand ITC":8,"Britannic Bold":8,Broadway:8,"Browallia New":5,BrowalliaUPC:5,"Brush Script MT":7,Calibri:7,"Calibri Light":7,"Californian FB":7,"Calisto MT":7,Cambria:7,"Cambria Math":7,Candara:7,Castellar:9,Centaur:6,Century:7,"Century Gothic":7,"Century Schoolbook":7,Chiller:6,"Colonna MT":7,"Comic Sans MS":8,Consolas:7,Constantia:7,"Cooper Black":8,"Copperplate Gothic Bold":9,"Copperplate Gothic Light":9,Corbel:7,"Cordia New":5,CordiaUPC:5,"Courier New":8,"Curlz MT":7,Dante:6,DaunPenh:4,David:6,DilleniaUPC:4,DokChampa:7,Dotum:6,DotumChe:7,Dubai:7,"Dubai Light":7,"Dubai Medium":7,Ebrima:7,"Edwardian Script ITC":6,Elephant:10,"Engravers MT":8,"Eras Bold ITC":8,"Eras Demi ITC":8,"Eras Light ITC":7,"Eras Medium ITC":7,EucrosiaUPC:5,Euphemia:8,"Expo M":11,FangSong:7,"Felix Titling":8,"Footlight MT Light":7,Forte:7,"Franklin Gothic Book":8,"Franklin Gothic Demi":8,"Franklin Gothic Demi Cond":7,"Franklin Gothic Heavy":8,"Franklin Gothic Medium":8,"Franklin Gothic Medium Cond":7,FrankRuehl:5,FreesiaUPC:6,"Freestyle Script":5,"French Script MT":5,Gabriola:5,Gadugi:7,Garamond:6,Gautami:8,Georgia:9,"Georgia Pro":7,"Georgia Pro Black":9,"Georgia Pro Cond":7,"Georgia Pro Cond Black":8,"Georgia Pro Cond Light":7,"Georgia Pro Cond Semibold":7,"Georgia Pro Light":7,"Georgia Pro Semibold":8,Gigi:7,"Gill Sans MT Condensed":5,"Gill Sans MT Ext Condensed Bold":4,"Gill Sans Nova":7,"Gill Sans Nova Cond":4,"Gill Sans Nova Cond Lt":4,"Gill Sans Nova Cond Ultra Bold":8,"Gill Sans Nova Cond XBd":7,"Gill Sans Nova Light":7,"Gill Sans Nova Ultra Bold":11,"Gill Sans Ultra Bold":11,"Gill Sans Ultra Bold Condensed":8,Gisha:7,"Gloucester MT Extra Condensed":5,"Goudy Old Style":7,"Goudy Stout":11,Grotesque:6,"Grotesque Light":6,Gulim:7,GulimChe:7,Gungsuh:6,GungsuhChe:7,"Hadassah Friedlaender":7,Haettenschweiler:6,"Harlow Solid Italic":6,Harrington:7,"Headline R":9,HGGothicE:7,HGGothicM:7,HGGyoshotai:7,HGKyokashotai:7,HGMaruGothicMPRO:10,HGMinchoB:8,HGMinchoE:8,HGPGothicE:8,HGPGothicM:9,HGPGyoshotai:7,HGPKyokashotai:7,HGPMinchoB:7,HGPMinchoE:8,HGPSoeiKakugothicUB:9,HGPSoeiKakupoptai:9,HGPSoeiPresenceEB:8,HGSeikaishotaiPRO:8,HGSGothicE:7,HGSGothicM:8,HGSGyoshotai:6,HGSKyokashotai:6,HGSMinchoB:7,HGSMinchoE:8,HGSoeiKakugothicUB:8,HGSoeiKakupoptai:8,HGSoeiPresenceEB:8,HGSSoeiKakugothicUB:8,HGSSoeiKakupoptai:8,HGSSoeiPresenceEB:7,"High Tower Text":6,"HYGothic-Extra":8,"HYGothic-Medium":8,"HYGraphic-Medium":8,"HYGungSo-Bold":8,"HYHeadLine-Medium":8,"HYMyeongJo-Extra":9,"HYPMokGak-Bold":9,"HYPost-Light":9,"HYPost-Medium":9,"HYShortSamul-Medium":5,"HYSinMyeongJo-Medium":8,Impact:7,"Imprint MT Shadow":7,"Informal Roman":7,"Ink Free":7,IrisUPC:7,"Iskoola Pota":7,JasmineUPC:7,"Javanese Text":8,Jokerman:9,"Juice ITC":5,KaiTi:7,Kalinga:7,Kartika:7,"Khmer UI":7,KodchiangUPC:4,Kokila:7,"Kristen ITC":8,"Kunstler Script":5,"Lao UI":7,Latha:7,Leelawadee:7,"Leelawadee UI":7,"Leelawadee UI Semilight":7,"Levenim MT":7,LilyUPC:7,"Lucida Bright":8,"Lucida Calligraphy":10,"Lucida Console":9,"Lucida Fax":9,"Lucida Handwriting":10,"Lucida Sans":9,"Lucida Sans Typewriter":8,"Lucida Sans Unicode":9,"Magic R":8,Magneto:10,"Maiandra GD":9,"Malgun Gothic":8,"Malgun Gothic Semilight":8,Mangal:8,Marlett:14,"Matura MT Script Capitals":10,Meiryo:9,"Meiryo UI":9,"Microsoft GothicNeo":8,"Microsoft Himalaya":5,"Microsoft JhengHei":8,"Microsoft JhengHei Light":8,"Microsoft JhengHei UI":8,"Microsoft JhengHei UI Light":8,"Microsoft New Tai Lue":7,"Microsoft PhagsPa":7,"Microsoft Sans Serif":8,"Microsoft Tai Le":7,"Microsoft Uighur":5,"Microsoft YaHei Light":8,"Microsoft YaHei UI":8,"Microsoft YaHei UI Light":8,"Microsoft Yi Baiti":8,MingLiU:8,MingLiU_HKSCS:8,"MingLiU_HKSCS-ExtB":8,"MingLiU-ExtB":8,Miriam:8,"Miriam Fixed":8,Mistral:7,"Modern No. 20":7,"MoeumT R":8,"Mongolian Baiti":8,"Monotype Corsiva":7,MoolBoran:8,"MS Gothic":8,"MS Mincho":8,"MS Outlook":8,"MS PGothic":8,"MS PMincho":8,"MS Reference Sans Serif":9,"MS Reference Specialty":17,"MS UI Gothic":8,"MT Extra":14,"MV Boli":10,"Myanmar Text":7,Narkisim:8,"Neue Haas Grotesk Text Pro":8,"New Gulim":8,"News Gothic MT":8,"Niagara Engraved":5,"Niagara Solid":5,"Nirmala UI":7,"Nirmala UI Semilight":8,Nyala:8,"OCR A Extended":9,OCRB:9,"Old English Text MT":8,Onyx:6,"Palace Script MT":5,"Palatino Linotype":7,Papyrus:9,Parchment:4,Perpetua:6,"Perpetua Titling MT":9,"Plantagenet Cherokee":8,Playbill:6,PMingLiU:7,"PMingLiU-ExtB":7,"Poor Richard":8,Pristina:8,"Pyunji R":7,Raavi:8,"Rage Italic":8,Ravie:13,Rockwell:7,"Rockwell Condensed":6,"Rockwell Extra Bold":9,"Rockwell Light":8,"Rockwell Nova":8,"Rockwell Nova Cond":8,"Rockwell Nova Cond Light":8,"Rockwell Nova Extra Bold":8,"Rockwell Nova Light":8,Rod:8,"Sakkal Majalla":8,"Sanskrit Text":8,"Script MT Bold":7,"Segoe MDL2 Assets":5,"Segoe Print":10,"Segoe Script":10,"Segoe UI":7,"Segoe UI Black":8,"Segoe UI Emoji":7,"Segoe UI Historic":7,"Segoe UI Light":7,"Segoe UI Semibold":7,"Segoe UI Semilight":7,"Segoe UI Symbol":7,Selawik:7,"Selawik Light":7,"Selawik Semibold":7,"Shonar Bangla":7,"Showcard Gothic":8,Shruti:7,"Simplified Arabic":7,"Simplified Arabic Fixed":7,"SimSun-ExtB":7,"Sitka Banner":7,"Sitka Display":7,"Sitka Heading":7,"Sitka Small":9,"Sitka Subheading":8,"Sitka Text":8,"Snap ITC":11,"Source Sans Pro":7,"Source Sans Pro Black":7,"Source Sans Pro ExtraLight":7,"Source Sans Pro Light":7,"Source Sans Pro SemiBold":7,Stencil:7,Sylfaen:7,Symbol:7,Tahoma:7,"Tempus Sans ITC":9,"TH SarabunPSK":7,"Times New Roman":7,"Traditional Arabic":7,"Trebuchet MS":7,Tunga:7,"Tw Cen MT":7,"Tw Cen MT Condensed":5,"Tw Cen MT Condensed Extra Bold":6,"UD Digi Kyokasho N-B":7,"UD Digi Kyokasho NK-B":7,"UD Digi Kyokasho NK-R":7,"UD Digi Kyokasho NP-B":7,"UD Digi Kyokasho NP-R":7,"UD Digi Kyokasho N-R":7,Univers:7,"Univers Condensed":7,"Univers Condensed Light":7,"Univers Light":7,"Urdu Typesetting":7,Utsaah:7,Vani:7,Verdana:8,"Verdana Pro":8,"Verdana Pro Black":7,"Verdana Pro Cond":7,"Verdana Pro Cond Black":7,"Verdana Pro Cond Light":7,"Verdana Pro Cond SemiBold":7,"Verdana Pro Light":7,"Verdana Pro SemiBold":7,Vijaya:7,"Viner Hand ITC":9,Vivaldi:6,"Vladimir Script":6,Vrinda:7,Webdings:13,"Wide Latin":16,Wingdings:17,"Wingdings 2":15,"Wingdings 3":12,"Yet R":7,"Yu Gothic":7,"Yu Gothic Light":7,"Yu Gothic Medium":7,"Yu Gothic UI":7,"Yu Gothic UI Light":7,"Yu Gothic UI Semibold":7,"Yu Gothic UI Semilight":7,"Yu Mincho":7,"Yu Mincho Demibold":7,"Yu Mincho Light":7,"\u4eff\u5b8b":7,"\u534e\u6587\u4e2d\u5b8b":8,"\u534e\u6587\u4eff\u5b8b":6,"\u534e\u6587\u5b8b\u4f53":6,"\u534e\u6587\u5f69\u4e91":7,"\u534e\u6587\u65b0\u9b4f":8,"\u534e\u6587\u6977\u4f53":6,"\u534e\u6587\u7425\u73c0":7,"\u534e\u6587\u7ec6\u9ed1":7,"\u534e\u6587\u884c\u6977":7,"\u534e\u6587\u96b6\u4e66":6,"\u5b8b\u4f53":7,"\u5e7c\u5706":7,"\u5fae\u8f6f\u96c5\u9ed1":8,"\u5fae\u8f6f\u96c5\u9ed1 Light":7,"\u65b0\u5b8b\u4f53":7,"\u65b9\u6b63\u59da\u4f53":7,"\u65b9\u6b63\u8212\u4f53":7,"\u6977\u4f53":7,"\u7b49\u7ebf":7,"\u7b49\u7ebf Light":7,"\u96b6\u4e66":7,"\u9ed1\u4f53":7,"\u6e38\u30b4\u30b7\u30c3\u30af":7,"\uff2d\uff33 \uff30\u660e\u671d":7,'"\uff2d\uff33 \uff30\u30b4\u30b7\u30c3\u30af"':7,"\u30e1\u30a4\u30ea\u30aa":8,"HG\uff7a\uff9e\uff7c\uff6f\uff78E":7,"HG\u660e\u671dB":7,"HG\uff7a\uff9e\uff7c\uff6f\uff78M":7},11:{"Gill Sans MT":8,Abadi:9,"Abadi Extra Light":8,"Agency FB":6,Aharoni:6,Aldhabi:5,Algerian:9,"Ami R":6,"Angsana New":5,AngsanaUPC:5,Aparajita:6,"Arabic Typesetting":5,Arial:8,"Arial Black":10,"Arial Narrow":7,"Arial Nova":8,"Arial Nova Cond":8,"Arial Nova Cond Light":7,"Arial Nova Light":8,"Arial Rounded MT Bold":9,"Baskerville Old Face":7,Batang:8,BatangChe:8,"Bauhaus 93":9,"Bell MT":8,Bembo:7,"Berlin Sans FB":9,"Berlin Sans FB Demi":9,"Bernard MT Condensed":7,"Blackadder ITC":6,"Bodoni MT":7,"Bodoni MT Black":10,"Bodoni MT Condensed":5,"Bodoni MT Poster Compressed":5,"Book Antiqua":8,"Bookman Old Style":9,"Bookshelf Symbol 7":11,"Bradley Hand ITC":10,"Britannic Bold":9,Broadway:10,"Browallia New":5,BrowalliaUPC:5,"Brush Script MT":8,Calibri:7,"Calibri Light":8,"Californian FB":9,"Calisto MT":8,Cambria:8,"Cambria Math":8,Candara:8,Castellar:11,Centaur:7,Century:8,"Century Gothic":8,"Century Schoolbook":8,Chiller:7,"Colonna MT":8,"Comic Sans MS":9,Consolas:8,Constantia:8,"Cooper Black":9,"Copperplate Gothic Bold":11,"Copperplate Gothic Light":11,Corbel:8,"Cordia New":5,CordiaUPC:5,"Courier New":9,"Curlz MT":8,Dante:7,DaunPenh:5,David:7,DilleniaUPC:5,DokChampa:8,Dotum:9,DotumChe:8,Dubai:8,"Dubai Light":8,"Dubai Medium":8,Ebrima:8,"Edwardian Script ITC":7,Elephant:11,"Engravers MT":10,"Eras Bold ITC":10,"Eras Demi ITC":9,"Eras Light ITC":8,"Eras Medium ITC":9,EucrosiaUPC:6,Euphemia:9,"Expo M":13,FangSong:8,"Felix Titling":9,"Footlight MT Light":8,Forte:8,"Franklin Gothic Book":9,"Franklin Gothic Demi":9,"Franklin Gothic Demi Cond":8,"Franklin Gothic Heavy":9,"Franklin Gothic Medium":9,"Franklin Gothic Medium Cond":8,FrankRuehl:6,FreesiaUPC:7,"Freestyle Script":6,"French Script MT":5,Gabriola:6,Gadugi:8,Garamond:7,Gautami:9,Georgia:9,"Georgia Pro":8,"Georgia Pro Black":11,"Georgia Pro Cond":8,"Georgia Pro Cond Black":10,"Georgia Pro Cond Light":8,"Georgia Pro Cond Semibold":8,"Georgia Pro Light":8,"Georgia Pro Semibold":9,Gigi:7,"Gill Sans MT Condensed":5,"Gill Sans MT Ext Condensed Bold":5,"Gill Sans Nova":8,"Gill Sans Nova Cond":5,"Gill Sans Nova Cond Lt":5,"Gill Sans Nova Cond Ultra Bold":9,"Gill Sans Nova Cond XBd":8,"Gill Sans Nova Light":8,"Gill Sans Nova Ultra Bold":13,"Gill Sans Ultra Bold":13,"Gill Sans Ultra Bold Condensed":9,Gisha:8,"Gloucester MT Extra Condensed":6,"Goudy Old Style":8,"Goudy Stout":12,Grotesque:7,"Grotesque Light":7,Gulim:8,GulimChe:8,Gungsuh:7,GungsuhChe:8,"Hadassah Friedlaender":9,Haettenschweiler:7,"Harlow Solid Italic":7,Harrington:8,"Headline R":11,HGGothicE:8,HGGothicM:8,HGGyoshotai:8,HGKyokashotai:8,HGMaruGothicMPRO:11,HGMinchoB:9,HGMinchoE:9,HGPGothicE:9,HGPGothicM:10,HGPGyoshotai:8,HGPKyokashotai:8,HGPMinchoB:8,HGPMinchoE:9,HGPSoeiKakugothicUB:10,HGPSoeiKakupoptai:11,HGPSoeiPresenceEB:9,HGSeikaishotaiPRO:9,HGSGothicE:8,HGSGothicM:9,HGSGyoshotai:7,HGSKyokashotai:7,HGSMinchoB:8,HGSMinchoE:9,HGSoeiKakugothicUB:9,HGSoeiKakupoptai:9,HGSoeiPresenceEB:9,HGSSoeiKakugothicUB:9,HGSSoeiKakupoptai:10,HGSSoeiPresenceEB:8,"High Tower Text":7,"HYGothic-Extra":9,"HYGothic-Medium":9,"HYGraphic-Medium":9,"HYGungSo-Bold":9,"HYHeadLine-Medium":9,"HYMyeongJo-Extra":10,"HYPMokGak-Bold":11,"HYPost-Light":10,"HYPost-Medium":11,"HYShortSamul-Medium":6,"HYSinMyeongJo-Medium":9,Impact:8,"Imprint MT Shadow":8,"Informal Roman":8,"Ink Free":8,IrisUPC:8,"Iskoola Pota":8,JasmineUPC:8,"Javanese Text":9,Jokerman:11,"Juice ITC":6,KaiTi:8,Kalinga:8,Kartika:8,"Khmer UI":8,KodchiangUPC:5,Kokila:8,"Kristen ITC":9,"Kunstler Script":5,"Lao UI":8,Latha:8,Leelawadee:8,"Leelawadee UI":8,"Leelawadee UI Semilight":8,"Levenim MT":9,LilyUPC:8,"Lucida Bright":9,"Lucida Calligraphy":11,"Lucida Console":10,"Lucida Fax":10,"Lucida Handwriting":11,"Lucida Sans":10,"Lucida Sans Typewriter":9,"Lucida Sans Unicode":10,"Magic R":9,Magneto:12,"Maiandra GD":10,"Malgun Gothic":9,"Malgun Gothic Semilight":9,Mangal:9,Marlett:16,"Matura MT Script Capitals":11,Meiryo:9,"Meiryo UI":10,"Microsoft GothicNeo":9,"Microsoft Himalaya":6,"Microsoft JhengHei":9,"Microsoft JhengHei Light":10,"Microsoft JhengHei UI":9,"Microsoft JhengHei UI Light":10,"Microsoft New Tai Lue":9,"Microsoft PhagsPa":9,"Microsoft Sans Serif":9,"Microsoft Tai Le":9,"Microsoft Uighur":6,"Microsoft YaHei Light":10,"Microsoft YaHei UI":9,"Microsoft YaHei UI Light":10,"Microsoft Yi Baiti":9,MingLiU:9,MingLiU_HKSCS:9,"MingLiU_HKSCS-ExtB":9,"MingLiU-ExtB":9,Miriam:9,"Miriam Fixed":10,Mistral:8,"Modern No. 20":8,"MoeumT R":9,"Mongolian Baiti":9,"Monotype Corsiva":8,MoolBoran:9,"MS Gothic":9,"MS Mincho":9,"MS Outlook":9,"MS PGothic":9,"MS PMincho":9,"MS Reference Sans Serif":11,"MS Reference Specialty":19,"MS UI Gothic":9,"MT Extra":16,"MV Boli":12,"Myanmar Text":9,Narkisim:7,"Neue Haas Grotesk Text Pro":9,"New Gulim":10,"News Gothic MT":9,"Niagara Engraved":5,"Niagara Solid":6,"Nirmala UI":9,"Nirmala UI Semilight":9,Nyala:9,"OCR A Extended":10,OCRB:10,"Old English Text MT":9,Onyx:6,"Palace Script MT":6,"Palatino Linotype":8,Papyrus:10,Parchment:4,Perpetua:7,"Perpetua Titling MT":10,"Plantagenet Cherokee":9,Playbill:6,PMingLiU:8,"PMingLiU-ExtB":8,"Poor Richard":9,Pristina:9,"Pyunji R":8,Raavi:9,"Rage Italic":9,Ravie:15,Rockwell:8,"Rockwell Condensed":6,"Rockwell Extra Bold":10,"Rockwell Light":9,"Rockwell Nova":9,"Rockwell Nova Cond":9,"Rockwell Nova Cond Light":9,"Rockwell Nova Extra Bold":9,"Rockwell Nova Light":9,Rod:9,"Sakkal Majalla":9,"Sanskrit Text":9,"Script MT Bold":8,"Segoe MDL2 Assets":6,"Segoe Print":11,"Segoe Script":11,"Segoe UI":8,"Segoe UI Black":9,"Segoe UI Emoji":8,"Segoe UI Historic":8,"Segoe UI Light":8,"Segoe UI Semibold":9,"Segoe UI Semilight":8,"Segoe UI Symbol":8,Selawik:8,"Selawik Light":8,"Selawik Semibold":8,"Shonar Bangla":8,"Showcard Gothic":9,Shruti:8,"Simplified Arabic":8,"Simplified Arabic Fixed":8,"SimSun-ExtB":8,"Sitka Banner":8,"Sitka Display":8,"Sitka Heading":8,"Sitka Small":10,"Sitka Subheading":9,"Sitka Text":9,"Snap ITC":13,"Source Sans Pro":8,"Source Sans Pro Black":8,"Source Sans Pro ExtraLight":8,"Source Sans Pro Light":8,"Source Sans Pro SemiBold":8,Stencil:9,Sylfaen:8,Symbol:8,Tahoma:8,"Tempus Sans ITC":10,"TH SarabunPSK":8,"Times New Roman":8,"Traditional Arabic":8,"Trebuchet MS":8,Tunga:8,"Tw Cen MT":8,"Tw Cen MT Condensed":5,"Tw Cen MT Condensed Extra Bold":7,"UD Digi Kyokasho N-B":8,"UD Digi Kyokasho NK-B":8,"UD Digi Kyokasho NK-R":8,"UD Digi Kyokasho NP-B":8,"UD Digi Kyokasho NP-R":8,"UD Digi Kyokasho N-R":8,Univers:8,"Univers Condensed":8,"Univers Condensed Light":8,"Univers Light":8,"Urdu Typesetting":8,Utsaah:8,Vani:8,Verdana:10,"Verdana Pro":10,"Verdana Pro Black":8,"Verdana Pro Cond":8,"Verdana Pro Cond Black":8,"Verdana Pro Cond Light":8,"Verdana Pro Cond SemiBold":8,"Verdana Pro Light":8,"Verdana Pro SemiBold":8,Vijaya:8,"Viner Hand ITC":10,Vivaldi:6,"Vladimir Script":7,Vrinda:9,Webdings:15,"Wide Latin":19,Wingdings:20,"Wingdings 2":17,"Wingdings 3":13,"Yet R":8,"Yu Gothic":8,"Yu Gothic Light":8,"Yu Gothic Medium":8,"Yu Gothic UI":8,"Yu Gothic UI Light":8,"Yu Gothic UI Semibold":9,"Yu Gothic UI Semilight":8,"Yu Mincho":8,"Yu Mincho Demibold":8,"Yu Mincho Light":8,"\u4eff\u5b8b":8,"\u534e\u6587\u4e2d\u5b8b":9,"\u534e\u6587\u4eff\u5b8b":7,"\u534e\u6587\u5b8b\u4f53":7,"\u534e\u6587\u5f69\u4e91":9,"\u534e\u6587\u65b0\u9b4f":9,"\u534e\u6587\u6977\u4f53":7,"\u534e\u6587\u7425\u73c0":9,"\u534e\u6587\u7ec6\u9ed1":8,"\u534e\u6587\u884c\u6977":8,"\u534e\u6587\u96b6\u4e66":7,"\u5b8b\u4f53":8,"\u5e7c\u5706":8,"\u5fae\u8f6f\u96c5\u9ed1":9,"\u5fae\u8f6f\u96c5\u9ed1 Light":9,"\u65b0\u5b8b\u4f53":8,"\u65b9\u6b63\u59da\u4f53":8,"\u65b9\u6b63\u8212\u4f53":8,"\u6977\u4f53":8,"\u7b49\u7ebf":8,"\u7b49\u7ebf Light":8,"\u96b6\u4e66":8,"\u9ed1\u4f53":8,"\u6e38\u30b4\u30b7\u30c3\u30af":8,"\uff2d\uff33 \uff30\u660e\u671d":8,'"\uff2d\uff33 \uff30\u30b4\u30b7\u30c3\u30af"':8,"\u30e1\u30a4\u30ea\u30aa":9,"HG\uff7a\uff9e\uff7c\uff6f\uff78E":8,"HG\u660e\u671dB":8,"HG\uff7a\uff9e\uff7c\uff6f\uff78M":8},12:{"Gill Sans MT":8,Abadi:10,"Abadi Extra Light":9,"Agency FB":6,Aharoni:7,Aldhabi:5,Algerian:10,"Ami R":7,"Angsana New":5,AngsanaUPC:5,Aparajita:6,"Arabic Typesetting":5,Arial:9,"Arial Black":11,"Arial Narrow":7,"Arial Nova":9,"Arial Nova Cond":8,"Arial Nova Cond Light":7,"Arial Nova Light":9,"Arial Rounded MT Bold":10,"Baskerville Old Face":8,Batang:9,BatangChe:8,"Bauhaus 93":9,"Bell MT":8,Bembo:8,"Berlin Sans FB":10,"Berlin Sans FB Demi":10,"Bernard MT Condensed":8,"Blackadder ITC":6,"Bodoni MT":8,"Bodoni MT Black":11,"Bodoni MT Condensed":5,"Bodoni MT Poster Compressed":6,"Book Antiqua":8,"Bookman Old Style":10,"Bookshelf Symbol 7":12,"Bradley Hand ITC":10,"Britannic Bold":10,Broadway:10,"Browallia New":6,BrowalliaUPC:6,"Brush Script MT":8,Calibri:8,"Calibri Light":8,"Californian FB":9,"Calisto MT":8,Cambria:9,"Cambria Math":9,Candara:9,Castellar:12,Centaur:8,Century:9,"Century Gothic":9,"Century Schoolbook":9,Chiller:8,"Colonna MT":8,"Comic Sans MS":10,Consolas:9,Constantia:9,"Cooper Black":10,"Copperplate Gothic Bold":11,"Copperplate Gothic Light":12,Corbel:8,"Cordia New":6,CordiaUPC:6,"Courier New":10,"Curlz MT":9,Dante:7,DaunPenh:5,David:7,DilleniaUPC:5,DokChampa:9,Dotum:8,DotumChe:8,Dubai:9,"Dubai Light":9,"Dubai Medium":9,Ebrima:9,"Edwardian Script ITC":8,Elephant:12,"Engravers MT":10,"Eras Bold ITC":10,"Eras Demi ITC":10,"Eras Light ITC":9,"Eras Medium ITC":9,EucrosiaUPC:6,Euphemia:9,"Expo M":14,FangSong:8,"Felix Titling":9,"Footlight MT Light":9,Forte:8,"Franklin Gothic Book":9,"Franklin Gothic Demi":9,"Franklin Gothic Demi Cond":8,"Franklin Gothic Heavy":9,"Franklin Gothic Medium":9,"Franklin Gothic Medium Cond":8,FrankRuehl:7,FreesiaUPC:7,"Freestyle Script":6,"French Script MT":6,Gabriola:6,Gadugi:9,Garamond:8,Gautami:10,Georgia:10,"Georgia Pro":9,"Georgia Pro Black":11,"Georgia Pro Cond":8,"Georgia Pro Cond Black":10,"Georgia Pro Cond Light":8,"Georgia Pro Cond Semibold":9,"Georgia Pro Light":9,"Georgia Pro Semibold":10,Gigi:7,"Gill Sans MT Condensed":6,"Gill Sans MT Ext Condensed Bold":6,"Gill Sans Nova":8,"Gill Sans Nova Cond":5,"Gill Sans Nova Cond Lt":5,"Gill Sans Nova Cond Ultra Bold":9,"Gill Sans Nova Cond XBd":8,"Gill Sans Nova Light":8,"Gill Sans Nova Ultra Bold":14,"Gill Sans Ultra Bold":14,"Gill Sans Ultra Bold Condensed":9,Gisha:9,"Gloucester MT Extra Condensed":6,"Goudy Old Style":8,"Goudy Stout":13,Grotesque:8,"Grotesque Light":8,Gulim:9,GulimChe:8,Gungsuh:9,GungsuhChe:8,"Hadassah Friedlaender":9,Haettenschweiler:7,"Harlow Solid Italic":7,Harrington:9,"Headline R":11,HGGothicE:8,HGGothicM:8,HGGyoshotai:8,HGKyokashotai:8,HGMaruGothicMPRO:12,HGMinchoB:9,HGMinchoE:9,HGPGothicE:10,HGPGothicM:10,HGPGyoshotai:9,HGPKyokashotai:8,HGPMinchoB:9,HGPMinchoE:9,HGPSoeiKakugothicUB:11,HGPSoeiKakupoptai:11,HGPSoeiPresenceEB:10,HGSeikaishotaiPRO:10,HGSGothicE:9,HGSGothicM:9,HGSGyoshotai:8,HGSKyokashotai:7,HGSMinchoB:9,HGSMinchoE:9,HGSoeiKakugothicUB:9,HGSoeiKakupoptai:9,HGSoeiPresenceEB:9,HGSSoeiKakugothicUB:10,HGSSoeiKakupoptai:10,HGSSoeiPresenceEB:9,"High Tower Text":8,"HYGothic-Extra":10,"HYGothic-Medium":9,"HYGraphic-Medium":9,"HYGungSo-Bold":9,"HYHeadLine-Medium":9,"HYMyeongJo-Extra":11,"HYPMokGak-Bold":11,"HYPost-Light":11,"HYPost-Medium":11,"HYShortSamul-Medium":6,"HYSinMyeongJo-Medium":10,Impact:9,"Imprint MT Shadow":8,"Informal Roman":9,"Ink Free":8,IrisUPC:8,"Iskoola Pota":8,JasmineUPC:8,"Javanese Text":9,Jokerman:11,"Juice ITC":6,KaiTi:8,Kalinga:9,Kartika:8,"Khmer UI":8,KodchiangUPC:5,Kokila:8,"Kristen ITC":10,"Kunstler Script":6,"Lao UI":8,Latha:8,Leelawadee:9,"Leelawadee UI":9,"Leelawadee UI Semilight":9,"Levenim MT":9,LilyUPC:7,"Lucida Bright":10,"Lucida Calligraphy":12,"Lucida Console":11,"Lucida Fax":11,"Lucida Handwriting":12,"Lucida Sans":11,"Lucida Sans Typewriter":10,"Lucida Sans Unicode":11,"Magic R":10,Magneto:12,"Maiandra GD":10,"Malgun Gothic":9,"Malgun Gothic Semilight":10,Mangal:9,Marlett:17,"Matura MT Script Capitals":12,Meiryo:11,"Meiryo UI":11,"Microsoft GothicNeo":9,"Microsoft Himalaya":6,"Microsoft JhengHei":10,"Microsoft JhengHei Light":10,"Microsoft JhengHei UI":10,"Microsoft JhengHei UI Light":10,"Microsoft New Tai Lue":9,"Microsoft PhagsPa":9,"Microsoft Sans Serif":10,"Microsoft Tai Le":9,"Microsoft Uighur":6,"Microsoft YaHei Light":10,"Microsoft YaHei UI":10,"Microsoft YaHei UI Light":10,"Microsoft Yi Baiti":9,MingLiU:9,MingLiU_HKSCS:9,"MingLiU_HKSCS-ExtB":9,"MingLiU-ExtB":9,Miriam:9,"Miriam Fixed":11,Mistral:8,"Modern No. 20":8,"MoeumT R":10,"Mongolian Baiti":9,"Monotype Corsiva":8,MoolBoran:7,"MS Gothic":9,"MS Mincho":9,"MS Outlook":9,"MS PGothic":9,"MS PMincho":9,"MS Reference Sans Serif":11,"MS Reference Specialty":20,"MS UI Gothic":9,"MT Extra":17,"MV Boli":12,"Myanmar Text":9,Narkisim:8,"Neue Haas Grotesk Text Pro":9,"New Gulim":10,"News Gothic MT":9,"Niagara Engraved":6,"Niagara Solid":6,"Nirmala UI":9,"Nirmala UI Semilight":10,Nyala:9,"OCR A Extended":11,OCRB:11,"Old English Text MT":9,Onyx:7,"Palace Script MT":6,"Palatino Linotype":8,Papyrus:10,Parchment:4,Perpetua:7,"Perpetua Titling MT":11,"Plantagenet Cherokee":9,Playbill:7,PMingLiU:9,"PMingLiU-ExtB":9,"Poor Richard":10,Pristina:9,"Pyunji R":9,Raavi:8,"Rage Italic":9,Ravie:16,Rockwell:9,"Rockwell Condensed":7,"Rockwell Extra Bold":11,"Rockwell Light":10,"Rockwell Nova":9,"Rockwell Nova Cond":9,"Rockwell Nova Cond Light":9,"Rockwell Nova Extra Bold":9,"Rockwell Nova Light":9,Rod:9,"Sakkal Majalla":9,"Sanskrit Text":9,"Script MT Bold":8,"Segoe MDL2 Assets":7,"Segoe Print":12,"Segoe Script":12,"Segoe UI":9,"Segoe UI Black":10,"Segoe UI Emoji":9,"Segoe UI Historic":9,"Segoe UI Light":8,"Segoe UI Semibold":9,"Segoe UI Semilight":9,"Segoe UI Symbol":9,Selawik:8,"Selawik Light":8,"Selawik Semibold":8,"Shonar Bangla":8,"Showcard Gothic":9,Shruti:8,"Simplified Arabic":8,"Simplified Arabic Fixed":8,"SimSun-ExtB":8,"Sitka Banner":8,"Sitka Display":8,"Sitka Heading":9,"Sitka Small":11,"Sitka Subheading":9,"Sitka Text":10,"Snap ITC":14,"Source Sans Pro":8,"Source Sans Pro Black":8,"Source Sans Pro ExtraLight":8,"Source Sans Pro Light":8,"Source Sans Pro SemiBold":8,Stencil:9,Sylfaen:8,Symbol:8,Tahoma:9,"Tempus Sans ITC":11,"TH SarabunPSK":8,"Times New Roman":8,"Traditional Arabic":8,"Trebuchet MS":8,Tunga:8,"Tw Cen MT":9,"Tw Cen MT Condensed":6,"Tw Cen MT Condensed Extra Bold":8,"UD Digi Kyokasho N-B":8,"UD Digi Kyokasho NK-B":8,"UD Digi Kyokasho NK-R":8,"UD Digi Kyokasho NP-B":8,"UD Digi Kyokasho NP-R":8,"UD Digi Kyokasho N-R":8,Univers:8,"Univers Condensed":8,"Univers Condensed Light":8,"Univers Light":8,"Urdu Typesetting":8,Utsaah:6,Vani:8,Verdana:10,"Verdana Pro":10,"Verdana Pro Black":8,"Verdana Pro Cond":8,"Verdana Pro Cond Black":8,"Verdana Pro Cond Light":8,"Verdana Pro Cond SemiBold":8,"Verdana Pro Light":8,"Verdana Pro SemiBold":8,Vijaya:8,"Viner Hand ITC":11,Vivaldi:7,"Vladimir Script":7,Vrinda:9,Webdings:16,"Wide Latin":20,Wingdings:22,"Wingdings 2":18,"Wingdings 3":14,"Yet R":9,"Yu Gothic":9,"Yu Gothic Light":9,"Yu Gothic Medium":9,"Yu Gothic UI":9,"Yu Gothic UI Light":9,"Yu Gothic UI Semibold":9,"Yu Gothic UI Semilight":9,"Yu Mincho":9,"Yu Mincho Demibold":8,"Yu Mincho Light":8,"\u4eff\u5b8b":8,"\u534e\u6587\u4e2d\u5b8b":10,"\u534e\u6587\u4eff\u5b8b":8,"\u534e\u6587\u5b8b\u4f53":8,"\u534e\u6587\u5f69\u4e91":9,"\u534e\u6587\u65b0\u9b4f":9,"\u534e\u6587\u6977\u4f53":8,"\u534e\u6587\u7425\u73c0":9,"\u534e\u6587\u7ec6\u9ed1":9,"\u534e\u6587\u884c\u6977":8,"\u534e\u6587\u96b6\u4e66":7,"\u5b8b\u4f53":8,"\u5e7c\u5706":8,"\u5fae\u8f6f\u96c5\u9ed1":9,"\u5fae\u8f6f\u96c5\u9ed1 Light":9,"\u65b0\u5b8b\u4f53":8,"\u65b9\u6b63\u59da\u4f53":8,"\u65b9\u6b63\u8212\u4f53":9,"\u6977\u4f53":8,"\u7b49\u7ebf":8,"\u7b49\u7ebf Light":8,"\u96b6\u4e66":8,"\u9ed1\u4f53":8,"\u6e38\u30b4\u30b7\u30c3\u30af":9,"\uff2d\uff33 \uff30\u660e\u671d":8,'"\uff2d\uff33 \uff30\u30b4\u30b7\u30c3\u30af"':8,"\u30e1\u30a4\u30ea\u30aa":10,"HG\uff7a\uff9e\uff7c\uff6f\uff78E":8,"HG\u660e\u671dB":8,"HG\uff7a\uff9e\uff7c\uff6f\uff78M":8},14:{"Gill Sans MT":10,Abadi:11,"Abadi Extra Light":11,"Agency FB":8,Aharoni:8,Aldhabi:6,Algerian:11,"Ami R":8,"Angsana New":6,AngsanaUPC:6,Aparajita:8,"Arabic Typesetting":6,Arial:11,"Arial Black":13,"Arial Narrow":9,"Arial Nova":11,"Arial Nova Cond":10,"Arial Nova Cond Light":9,"Arial Nova Light":11,"Arial Rounded MT Bold":11,"Baskerville Old Face":9,Batang:10,BatangChe:10,"Bauhaus 93":11,"Bell MT":10,Bembo:9,"Berlin Sans FB":11,"Berlin Sans FB Demi":12,"Bernard MT Condensed":9,"Blackadder ITC":8,"Bodoni MT":9,"Bodoni MT Black":12,"Bodoni MT Condensed":6,"Bodoni MT Poster Compressed":6,"Book Antiqua":10,"Bookman Old Style":12,"Bookshelf Symbol 7":14,"Bradley Hand ITC":12,"Britannic Bold":12,Broadway:12,"Browallia New":7,BrowalliaUPC:7,"Brush Script MT":10,Calibri:10,"Calibri Light":10,"Californian FB":11,"Calisto MT":10,Cambria:11,"Cambria Math":11,Candara:10,Castellar:14,Centaur:9,Century:11,"Century Gothic":11,"Century Schoolbook":11,Chiller:9,"Colonna MT":10,"Comic Sans MS":12,Consolas:10,Constantia:10,"Cooper Black":11,"Copperplate Gothic Bold":14,"Copperplate Gothic Light":14,Corbel:10,"Cordia New":7,CordiaUPC:7,"Courier New":11,"Curlz MT":10,Dante:9,DaunPenh:6,David:8,DilleniaUPC:6,DokChampa:11,Dotum:10,DotumChe:10,Dubai:10,"Dubai Light":10,"Dubai Medium":10,Ebrima:10,"Edwardian Script ITC":9,Elephant:14,"Engravers MT":12,"Eras Bold ITC":12,"Eras Demi ITC":12,"Eras Light ITC":10,"Eras Medium ITC":11,EucrosiaUPC:8,Euphemia:11,"Expo M":16,FangSong:10,"Felix Titling":11,"Footlight MT Light":11,Forte:10,"Franklin Gothic Book":11,"Franklin Gothic Demi":11,"Franklin Gothic Demi Cond":10,"Franklin Gothic Heavy":11,"Franklin Gothic Medium":11,"Franklin Gothic Medium Cond":10,FrankRuehl:8,FreesiaUPC:8,"Freestyle Script":7,"French Script MT":7,Gabriola:8,Gadugi:10,Garamond:9,Gautami:11,Georgia:12,"Georgia Pro":11,"Georgia Pro Black":13,"Georgia Pro Cond":10,"Georgia Pro Cond Black":12,"Georgia Pro Cond Light":10,"Georgia Pro Cond Semibold":11,"Georgia Pro Light":10,"Georgia Pro Semibold":12,Gigi:10,"Gill Sans MT Condensed":7,"Gill Sans MT Ext Condensed Bold":7,"Gill Sans Nova":10,"Gill Sans Nova Cond":6,"Gill Sans Nova Cond Lt":6,"Gill Sans Nova Cond Ultra Bold":11,"Gill Sans Nova Cond XBd":10,"Gill Sans Nova Light":10,"Gill Sans Nova Ultra Bold":16,"Gill Sans Ultra Bold":16,"Gill Sans Ultra Bold Condensed":11,Gisha:10,"Gloucester MT Extra Condensed":7,"Goudy Old Style":10,"Goudy Stout":16,Grotesque:9,"Grotesque Light":9,Gulim:10,GulimChe:10,Gungsuh:10,GungsuhChe:10,"Hadassah Friedlaender":11,Haettenschweiler:8,"Harlow Solid Italic":9,Harrington:11,"Headline R":14,HGGothicE:10,HGGothicM:10,HGGyoshotai:10,HGKyokashotai:10,HGMaruGothicMPRO:14,HGMinchoB:11,HGMinchoE:11,HGPGothicE:11,HGPGothicM:12,HGPGyoshotai:10,HGPKyokashotai:10,HGPMinchoB:10,HGPMinchoE:11,HGPSoeiKakugothicUB:13,HGPSoeiKakupoptai:13,HGPSoeiPresenceEB:12,HGSeikaishotaiPRO:11,HGSGothicE:10,HGSGothicM:11,HGSGyoshotai:9,HGSKyokashotai:9,HGSMinchoB:10,HGSMinchoE:11,HGSoeiKakugothicUB:11,HGSoeiKakupoptai:11,HGSoeiPresenceEB:11,HGSSoeiKakugothicUB:12,HGSSoeiKakupoptai:12,HGSSoeiPresenceEB:11,"High Tower Text":9,"HYGothic-Extra":12,"HYGothic-Medium":11,"HYGraphic-Medium":11,"HYGungSo-Bold":11,"HYHeadLine-Medium":11,"HYMyeongJo-Extra":13,"HYPMokGak-Bold":13,"HYPost-Light":13,"HYPost-Medium":13,"HYShortSamul-Medium":7,"HYSinMyeongJo-Medium":12,Impact:10,"Imprint MT Shadow":10,"Informal Roman":10,"Ink Free":10,IrisUPC:10,"Iskoola Pota":10,JasmineUPC:10,"Javanese Text":11,Jokerman:14,"Juice ITC":7,KaiTi:10,Kalinga:11,Kartika:11,"Khmer UI":10,KodchiangUPC:7,Kokila:10,"Kristen ITC":11,"Kunstler Script":7,"Lao UI":10,Latha:10,Leelawadee:10,"Leelawadee UI":10,"Leelawadee UI Semilight":10,"Levenim MT":11,LilyUPC:8,"Lucida Bright":12,"Lucida Calligraphy":14,"Lucida Console":12,"Lucida Fax":13,"Lucida Handwriting":14,"Lucida Sans":13,"Lucida Sans Typewriter":11,"Lucida Sans Unicode":13,"Magic R":12,Magneto:15,"Maiandra GD":12,"Malgun Gothic":11,"Malgun Gothic Semilight":12,Mangal:11,Marlett:20,"Matura MT Script Capitals":13,Meiryo:13,"Meiryo UI":13,"Microsoft GothicNeo":11,"Microsoft Himalaya":7,"Microsoft JhengHei":11,"Microsoft JhengHei Light":12,"Microsoft JhengHei UI":11,"Microsoft JhengHei UI Light":12,"Microsoft New Tai Lue":11,"Microsoft PhagsPa":11,"Microsoft Sans Serif":11,"Microsoft Tai Le":11,"Microsoft Uighur":7,"Microsoft YaHei Light":12,"Microsoft YaHei UI":12,"Microsoft YaHei UI Light":12,"Microsoft Yi Baiti":11,MingLiU:11,MingLiU_HKSCS:11,"MingLiU_HKSCS-ExtB":11,"MingLiU-ExtB":11,Miriam:10,"Miriam Fixed":12,Mistral:10,"Modern No. 20":10,"MoeumT R":11,"Mongolian Baiti":11,"Monotype Corsiva":9,MoolBoran:8,"MS Gothic":11,"MS Mincho":11,"MS Outlook":11,"MS PGothic":11,"MS PMincho":11,"MS Reference Sans Serif":13,"MS Reference Specialty":24,"MS UI Gothic":11,"MT Extra":20,"MV Boli":14,"Myanmar Text":11,Narkisim:9,"Neue Haas Grotesk Text Pro":11,"New Gulim":12,"News Gothic MT":12,"Niagara Engraved":7,"Niagara Solid":7,"Nirmala UI":11,"Nirmala UI Semilight":11,Nyala:11,"OCR A Extended":12,OCRB:12,"Old English Text MT":11,Onyx:7,"Palace Script MT":7,"Palatino Linotype":10,Papyrus:12,Parchment:5,Perpetua:9,"Perpetua Titling MT":13,"Plantagenet Cherokee":11,Playbill:8,PMingLiU:10,"PMingLiU-ExtB":10,"Poor Richard":11,Pristina:10,"Pyunji R":10,Raavi:10,"Rage Italic":11,Ravie:19,Rockwell:10,"Rockwell Condensed":8,"Rockwell Extra Bold":13,"Rockwell Light":11,"Rockwell Nova":11,"Rockwell Nova Cond":11,"Rockwell Nova Cond Light":11,"Rockwell Nova Extra Bold":11,"Rockwell Nova Light":11,Rod:11,"Sakkal Majalla":11,"Sanskrit Text":12,"Script MT Bold":10,"Segoe MDL2 Assets":8,"Segoe Print":14,"Segoe Script":14,"Segoe UI":10,"Segoe UI Black":12,"Segoe UI Emoji":10,"Segoe UI Historic":10,"Segoe UI Light":10,"Segoe UI Semibold":11,"Segoe UI Semilight":10,"Segoe UI Symbol":10,Selawik:10,"Selawik Light":10,"Selawik Semibold":10,"Shonar Bangla":10,"Showcard Gothic":11,Shruti:11,"Simplified Arabic":10,"Simplified Arabic Fixed":11,"SimSun-ExtB":10,"Sitka Banner":10,"Sitka Display":10,"Sitka Heading":11,"Sitka Small":13,"Sitka Subheading":11,"Sitka Text":12,"Snap ITC":16,"Source Sans Pro":9,"Source Sans Pro Black":10,"Source Sans Pro ExtraLight":9,"Source Sans Pro Light":10,"Source Sans Pro SemiBold":10,Stencil:11,Sylfaen:10,Symbol:10,Tahoma:10,"Tempus Sans ITC":13,"TH SarabunPSK":7,"Times New Roman":10,"Traditional Arabic":10,"Trebuchet MS":10,Tunga:10,"Tw Cen MT":10,"Tw Cen MT Condensed":7,"Tw Cen MT Condensed Extra Bold":9,"UD Digi Kyokasho N-B":10,"UD Digi Kyokasho NK-B":10,"UD Digi Kyokasho NK-R":10,"UD Digi Kyokasho NP-B":10,"UD Digi Kyokasho NP-R":10,"UD Digi Kyokasho N-R":10,Univers:10,"Univers Condensed":10,"Univers Condensed Light":8,"Univers Light":10,"Urdu Typesetting":10,Utsaah:8,Vani:11,Verdana:12,"Verdana Pro":12,"Verdana Pro Black":10,"Verdana Pro Cond":10,"Verdana Pro Cond Black":10,"Verdana Pro Cond Light":10,"Verdana Pro Cond SemiBold":10,"Verdana Pro Light":10,"Verdana Pro SemiBold":10,Vijaya:10,"Viner Hand ITC":13,Vivaldi:8,"Vladimir Script":9,Vrinda:11,Webdings:19,"Wide Latin":24,Wingdings:26,"Wingdings 2":22,"Wingdings 3":17,"Yet R":10,"Yu Gothic":11,"Yu Gothic Light":10,"Yu Gothic Medium":11,"Yu Gothic UI":10,"Yu Gothic UI Light":10,"Yu Gothic UI Semibold":11,"Yu Gothic UI Semilight":10,"Yu Mincho":10,"Yu Mincho Demibold":10,"Yu Mincho Light":10,"\u4eff\u5b8b":10,"\u534e\u6587\u4e2d\u5b8b":12,"\u534e\u6587\u4eff\u5b8b":9,"\u534e\u6587\u5b8b\u4f53":9,"\u534e\u6587\u5f69\u4e91":11,"\u534e\u6587\u65b0\u9b4f":11,"\u534e\u6587\u6977\u4f53":9,"\u534e\u6587\u7425\u73c0":11,"\u534e\u6587\u7ec6\u9ed1":11,"\u534e\u6587\u884c\u6977":10,"\u534e\u6587\u96b6\u4e66":8,"\u5b8b\u4f53":10,"\u5e7c\u5706":10,"\u5fae\u8f6f\u96c5\u9ed1":11,"\u5fae\u8f6f\u96c5\u9ed1 Light":11,"\u65b0\u5b8b\u4f53":10,"\u65b9\u6b63\u59da\u4f53":10,"\u65b9\u6b63\u8212\u4f53":10,"\u6977\u4f53":10,"\u7b49\u7ebf":10,"\u7b49\u7ebf Light":10,"\u96b6\u4e66":10,"\u9ed1\u4f53":10,"\u6e38\u30b4\u30b7\u30c3\u30af":11,"\uff2d\uff33 \uff30\u660e\u671d":10,'"\uff2d\uff33 \uff30\u30b4\u30b7\u30c3\u30af"':10,"\u30e1\u30a4\u30ea\u30aa":12,"HG\uff7a\uff9e\uff7c\uff6f\uff78E":10,"HG\u660e\u671dB":10,"HG\uff7a\uff9e\uff7c\uff6f\uff78M":10},16:{"Gill Sans MT":11,Abadi:13,"Abadi Extra Light":12,"Agency FB":9,Aharoni:9,Aldhabi:7,Algerian:13,"Ami R":9,"Angsana New":7,AngsanaUPC:7,Aparajita:8,"Arabic Typesetting":7,Arial:12,"Arial Black":14,"Arial Narrow":10,"Arial Nova":12,"Arial Nova Cond":11,"Arial Nova Cond Light":9,"Arial Nova Light":12,"Arial Rounded MT Bold":12,"Baskerville Old Face":10,Batang:10,BatangChe:11,"Bauhaus 93":12,"Bell MT":11,Bembo:10,"Berlin Sans FB":13,"Berlin Sans FB Demi":13,"Bernard MT Condensed":10,"Blackadder ITC":8,"Bodoni MT":10,"Bodoni MT Black":14,"Bodoni MT Condensed":7,"Bodoni MT Poster Compressed":7,"Book Antiqua":11,"Bookman Old Style":13,"Bookshelf Symbol 7":16,"Bradley Hand ITC":14,"Britannic Bold":13,Broadway:14,"Browallia New":8,BrowalliaUPC:8,"Brush Script MT":11,Calibri:11,"Calibri Light":11,"Californian FB":12,"Calisto MT":11,Cambria:12,"Cambria Math":12,Candara:12,Castellar:15,Centaur:10,Century:12,"Century Gothic":12,"Century Schoolbook":12,Chiller:10,"Colonna MT":11,"Comic Sans MS":13,Consolas:12,Constantia:11,"Cooper Black":13,"Copperplate Gothic Bold":15,"Copperplate Gothic Light":15,Corbel:11,"Cordia New":8,CordiaUPC:8,"Courier New":13,"Curlz MT":11,Dante:9,DaunPenh:7,David:9,DilleniaUPC:7,DokChampa:12,Dotum:11,DotumChe:11,Dubai:11,"Dubai Light":11,"Dubai Medium":11,Ebrima:11,"Edwardian Script ITC":10,Elephant:16,"Engravers MT":14,"Eras Bold ITC":14,"Eras Demi ITC":13,"Eras Light ITC":11,"Eras Medium ITC":12,EucrosiaUPC:9,Euphemia:12,"Expo M":18,FangSong:11,"Felix Titling":12,"Footlight MT Light":12,Forte:11,"Franklin Gothic Book":12,"Franklin Gothic Demi":12,"Franklin Gothic Demi Cond":11,"Franklin Gothic Heavy":12,"Franklin Gothic Medium":12,"Franklin Gothic Medium Cond":11,FrankRuehl:9,FreesiaUPC:9,"Freestyle Script":8,"French Script MT":8,Gabriola:8,Gadugi:11,Garamond:10,Gautami:13,Georgia:13,"Georgia Pro":12,"Georgia Pro Black":15,"Georgia Pro Cond":11,"Georgia Pro Cond Black":13,"Georgia Pro Cond Light":11,"Georgia Pro Cond Semibold":12,"Georgia Pro Light":12,"Georgia Pro Semibold":13,Gigi:12,"Gill Sans MT Condensed":8,"Gill Sans MT Ext Condensed Bold":7,"Gill Sans Nova":11,"Gill Sans Nova Cond":7,"Gill Sans Nova Cond Lt":6,"Gill Sans Nova Cond Ultra Bold":12,"Gill Sans Nova Cond XBd":11,"Gill Sans Nova Light":11,"Gill Sans Nova Ultra Bold":18,"Gill Sans Ultra Bold":18,"Gill Sans Ultra Bold Condensed":12,Gisha:11,"Gloucester MT Extra Condensed":8,"Goudy Old Style":11,"Goudy Stout":17,Grotesque:10,"Grotesque Light":10,Gulim:11,GulimChe:11,Gungsuh:11,GungsuhChe:11,"Hadassah Friedlaender":12,Haettenschweiler:9,"Harlow Solid Italic":10,Harrington:12,"Headline R":15,HGGothicE:11,HGGothicM:11,HGGyoshotai:11,HGKyokashotai:11,HGMaruGothicMPRO:16,HGMinchoB:12,HGMinchoE:12,HGPGothicE:12,HGPGothicM:13,HGPGyoshotai:11,HGPKyokashotai:11,HGPMinchoB:11,HGPMinchoE:12,HGPSoeiKakugothicUB:14,HGPSoeiKakupoptai:15,HGPSoeiPresenceEB:13,HGSeikaishotaiPRO:12,HGSGothicE:11,HGSGothicM:12,HGSGyoshotai:10,HGSKyokashotai:10,HGSMinchoB:11,HGSMinchoE:12,HGSoeiKakugothicUB:12,HGSoeiKakupoptai:12,HGSoeiPresenceEB:12,HGSSoeiKakugothicUB:13,HGSSoeiKakupoptai:14,HGSSoeiPresenceEB:12,"High Tower Text":10,"HYGothic-Extra":13,"HYGothic-Medium":12,"HYGraphic-Medium":12,"HYGungSo-Bold":12,"HYHeadLine-Medium":12,"HYMyeongJo-Extra":14,"HYPMokGak-Bold":15,"HYPost-Light":14,"HYPost-Medium":15,"HYShortSamul-Medium":8,"HYSinMyeongJo-Medium":13,Impact:11,"Imprint MT Shadow":11,"Informal Roman":11,"Ink Free":11,IrisUPC:11,"Iskoola Pota":11,JasmineUPC:10,"Javanese Text":12,Jokerman:15,"Juice ITC":8,KaiTi:11,Kalinga:12,Kartika:12,"Khmer UI":11,KodchiangUPC:7,Kokila:8,"Kristen ITC":13,"Kunstler Script":7,"Lao UI":11,Latha:11,Leelawadee:11,"Leelawadee UI":11,"Leelawadee UI Semilight":12,"Levenim MT":12,LilyUPC:9,"Lucida Bright":13,"Lucida Calligraphy":15,"Lucida Console":14,"Lucida Fax":14,"Lucida Handwriting":15,"Lucida Sans":14,"Lucida Sans Typewriter":13,"Lucida Sans Unicode":14,"Magic R":13,Magneto:16,"Maiandra GD":13,"Malgun Gothic":12,"Malgun Gothic Semilight":13,Mangal:12,Marlett:22,"Matura MT Script Capitals":15,Meiryo:14,"Meiryo UI":14,"Microsoft GothicNeo":12,"Microsoft Himalaya":8,"Microsoft JhengHei":13,"Microsoft JhengHei Light":13,"Microsoft JhengHei UI":13,"Microsoft JhengHei UI Light":13,"Microsoft New Tai Lue":12,"Microsoft PhagsPa":12,"Microsoft Sans Serif":13,"Microsoft Tai Le":12,"Microsoft Uighur":8,"Microsoft YaHei Light":13,"Microsoft YaHei UI":13,"Microsoft YaHei UI Light":13,"Microsoft Yi Baiti":12,MingLiU:12,MingLiU_HKSCS:12,"MingLiU_HKSCS-ExtB":12,"MingLiU-ExtB":12,Miriam:11,"Miriam Fixed":14,Mistral:10,"Modern No. 20":11,"MoeumT R":13,"Mongolian Baiti":12,"Monotype Corsiva":10,MoolBoran:8,"MS Gothic":12,"MS Mincho":12,"MS Outlook":12,"MS PGothic":12,"MS PMincho":12,"MS Reference Sans Serif":14,"MS Reference Specialty":26,"MS UI Gothic":12,"MT Extra":22,"MV Boli":16,"Myanmar Text":12,Narkisim:10,"Neue Haas Grotesk Text Pro":12,"New Gulim":13,"News Gothic MT":14,"Niagara Engraved":8,"Niagara Solid":8,"Nirmala UI":12,"Nirmala UI Semilight":13,Nyala:12,"OCR A Extended":14,OCRB:14,"Old English Text MT":12,Onyx:8,"Palace Script MT":8,"Palatino Linotype":11,Papyrus:14,Parchment:5,Perpetua:10,"Perpetua Titling MT":14,"Plantagenet Cherokee":12,Playbill:8,PMingLiU:11,"PMingLiU-ExtB":11,"Poor Richard":13,Pristina:11,"Pyunji R":11,Raavi:11,"Rage Italic":12,Ravie:21,Rockwell:11,"Rockwell Condensed":9,"Rockwell Extra Bold":14,"Rockwell Light":12,"Rockwell Nova":12,"Rockwell Nova Cond":12,"Rockwell Nova Cond Light":12,"Rockwell Nova Extra Bold":12,"Rockwell Nova Light":12,Rod:12,"Sakkal Majalla":12,"Sanskrit Text":13,"Script MT Bold":11,"Segoe MDL2 Assets":8,"Segoe Print":15,"Segoe Script":15,"Segoe UI":11,"Segoe UI Black":13,"Segoe UI Emoji":11,"Segoe UI Historic":11,"Segoe UI Light":11,"Segoe UI Semibold":12,"Segoe UI Semilight":11,"Segoe UI Symbol":11,Selawik:11,"Selawik Light":11,"Selawik Semibold":12,"Shonar Bangla":11,"Showcard Gothic":12,Shruti:13,"Simplified Arabic":11,"Simplified Arabic Fixed":13,"SimSun-ExtB":11,"Sitka Banner":11,"Sitka Display":11,"Sitka Heading":12,"Sitka Small":14,"Sitka Subheading":12,"Sitka Text":13,"Snap ITC":18,"Source Sans Pro":10,"Source Sans Pro Black":11,"Source Sans Pro ExtraLight":10,"Source Sans Pro Light":11,"Source Sans Pro SemiBold":11,Stencil:12,Sylfaen:11,Symbol:11,Tahoma:11,"Tempus Sans ITC":14,"TH SarabunPSK":8,"Times New Roman":11,"Traditional Arabic":10,"Trebuchet MS":11,Tunga:11,"Tw Cen MT":12,"Tw Cen MT Condensed":8,"Tw Cen MT Condensed Extra Bold":10,"UD Digi Kyokasho N-B":11,"UD Digi Kyokasho NK-B":11,"UD Digi Kyokasho NK-R":11,"UD Digi Kyokasho NP-B":11,"UD Digi Kyokasho NP-R":11,"UD Digi Kyokasho N-R":11,Univers:11,"Univers Condensed":11,"Univers Condensed Light":9,"Univers Light":11,"Urdu Typesetting":11,Utsaah:8,Vani:13,Verdana:13,"Verdana Pro":13,"Verdana Pro Black":11,"Verdana Pro Cond":11,"Verdana Pro Cond Black":11,"Verdana Pro Cond Light":11,"Verdana Pro Cond SemiBold":11,"Verdana Pro Light":11,"Verdana Pro SemiBold":11,Vijaya:11,"Viner Hand ITC":14,Vivaldi:9,"Vladimir Script":10,Vrinda:12,Webdings:21,"Wide Latin":26,Wingdings:28,"Wingdings 2":24,"Wingdings 3":19,"Yet R":11,"Yu Gothic":12,"Yu Gothic Light":11,"Yu Gothic Medium":12,"Yu Gothic UI":11,"Yu Gothic UI Light":11,"Yu Gothic UI Semibold":12,"Yu Gothic UI Semilight":12,"Yu Mincho":11,"Yu Mincho Demibold":11,"Yu Mincho Light":11,"\u4eff\u5b8b":11,"\u534e\u6587\u4e2d\u5b8b":13,"\u534e\u6587\u4eff\u5b8b":10,"\u534e\u6587\u5b8b\u4f53":10,"\u534e\u6587\u5f69\u4e91":12,"\u534e\u6587\u65b0\u9b4f":12,"\u534e\u6587\u6977\u4f53":10,"\u534e\u6587\u7425\u73c0":12,"\u534e\u6587\u7ec6\u9ed1":12,"\u534e\u6587\u884c\u6977":11,"\u534e\u6587\u96b6\u4e66":9,"\u5b8b\u4f53":11,"\u5e7c\u5706":11,"\u5fae\u8f6f\u96c5\u9ed1":12,"\u5fae\u8f6f\u96c5\u9ed1 Light":12,"\u65b0\u5b8b\u4f53":11,"\u65b9\u6b63\u59da\u4f53":11,"\u65b9\u6b63\u8212\u4f53":11,"\u6977\u4f53":11,"\u7b49\u7ebf":11,"\u7b49\u7ebf Light":11,"\u96b6\u4e66":11,"\u9ed1\u4f53":11,"\u6e38\u30b4\u30b7\u30c3\u30af":12,"\uff2d\uff33 \uff30\u660e\u671d":11,'"\uff2d\uff33 \uff30\u30b4\u30b7\u30c3\u30af"':11,"\u30e1\u30a4\u30ea\u30aa":13,"HG\uff7a\uff9e\uff7c\uff6f\uff78E":11,"HG\u660e\u671dB":11,"HG\uff7a\uff9e\uff7c\uff6f\uff78M":11},18:{"Gill Sans MT":12,Abadi:15,"Abadi Extra Light":13,"Agency FB":10,Aharoni:10,Aldhabi:8,Algerian:14,"Ami R":10,"Angsana New":8,AngsanaUPC:8,Aparajita:10,"Arabic Typesetting":8,Arial:13,"Arial Black":16,"Arial Narrow":11,"Arial Nova":13,"Arial Nova Cond":12,"Arial Nova Cond Light":11,"Arial Nova Light":13,"Arial Rounded MT Bold":14,"Baskerville Old Face":12,Batang:12,BatangChe:12,"Bauhaus 93":14,"Bell MT":12,Bembo:12,"Berlin Sans FB":14,"Berlin Sans FB Demi":15,"Bernard MT Condensed":12,"Blackadder ITC":9,"Bodoni MT":12,"Bodoni MT Black":16,"Bodoni MT Condensed":8,"Bodoni MT Poster Compressed":8,"Book Antiqua":12,"Bookman Old Style":15,"Bookshelf Symbol 7":18,"Bradley Hand ITC":15,"Britannic Bold":15,Broadway:16,"Browallia New":9,BrowalliaUPC:9,"Brush Script MT":12,Calibri:12,"Calibri Light":12,"Californian FB":13,"Calisto MT":12,Cambria:13,"Cambria Math":13,Candara:13,Castellar:17,Centaur:12,Century:13,"Century Gothic":13,"Century Schoolbook":13,Chiller:11,"Colonna MT":12,"Comic Sans MS":15,Consolas:13,Constantia:13,"Cooper Black":14,"Copperplate Gothic Bold":17,"Copperplate Gothic Light":17,Corbel:13,"Cordia New":9,CordiaUPC:9,"Courier New":14,"Curlz MT":13,Dante:11,DaunPenh:8,David:11,DilleniaUPC:7,DokChampa:13,Dotum:13,DotumChe:12,Dubai:13,"Dubai Light":13,"Dubai Medium":13,Ebrima:13,"Edwardian Script ITC":11,Elephant:18,"Engravers MT":16,"Eras Bold ITC":16,"Eras Demi ITC":15,"Eras Light ITC":13,"Eras Medium ITC":14,EucrosiaUPC:10,Euphemia:14,"Expo M":21,FangSong:12,"Felix Titling":14,"Footlight MT Light":13,Forte:13,"Franklin Gothic Book":14,"Franklin Gothic Demi":14,"Franklin Gothic Demi Cond":12,"Franklin Gothic Heavy":14,"Franklin Gothic Medium":14,"Franklin Gothic Medium Cond":12,FrankRuehl:10,FreesiaUPC:11,"Freestyle Script":9,"French Script MT":9,Gabriola:10,Gadugi:13,Garamond:11,Gautami:14,Georgia:15,"Georgia Pro":14,"Georgia Pro Black":17,"Georgia Pro Cond":13,"Georgia Pro Cond Black":15,"Georgia Pro Cond Light":12,"Georgia Pro Cond Semibold":13,"Georgia Pro Light":13,"Georgia Pro Semibold":15,Gigi:12,"Gill Sans MT Condensed":9,"Gill Sans MT Ext Condensed Bold":8,"Gill Sans Nova":12,"Gill Sans Nova Cond":8,"Gill Sans Nova Cond Lt":7,"Gill Sans Nova Cond Ultra Bold":14,"Gill Sans Nova Cond XBd":13,"Gill Sans Nova Light":12,"Gill Sans Nova Ultra Bold":20,"Gill Sans Ultra Bold":21,"Gill Sans Ultra Bold Condensed":14,Gisha:13,"Gloucester MT Extra Condensed":9,"Goudy Old Style":12,"Goudy Stout":20,Grotesque:12,"Grotesque Light":12,Gulim:13,GulimChe:12,Gungsuh:13,GungsuhChe:12,"Hadassah Friedlaender":14,Haettenschweiler:11,"Harlow Solid Italic":11,Harrington:13,"Headline R":17,HGGothicE:12,HGGothicM:12,HGGyoshotai:12,HGKyokashotai:12,HGMaruGothicMPRO:18,HGMinchoB:13,HGMinchoE:13,HGPGothicE:14,HGPGothicM:15,HGPGyoshotai:12,HGPKyokashotai:12,HGPMinchoB:12,HGPMinchoE:13,HGPSoeiKakugothicUB:16,HGPSoeiKakupoptai:17,HGPSoeiPresenceEB:14,HGSeikaishotaiPRO:14,HGSGothicE:13,HGSGothicM:14,HGSGyoshotai:11,HGSKyokashotai:11,HGSMinchoB:12,HGSMinchoE:13,HGSoeiKakugothicUB:13,HGSoeiKakupoptai:13,HGSoeiPresenceEB:13,HGSSoeiKakugothicUB:15,HGSSoeiKakupoptai:16,HGSSoeiPresenceEB:13,"High Tower Text":12,"HYGothic-Extra":15,"HYGothic-Medium":14,"HYGraphic-Medium":14,"HYGungSo-Bold":14,"HYHeadLine-Medium":14,"HYMyeongJo-Extra":16,"HYPMokGak-Bold":17,"HYPost-Light":16,"HYPost-Medium":17,"HYShortSamul-Medium":9,"HYSinMyeongJo-Medium":15,Impact:13,"Imprint MT Shadow":12,"Informal Roman":13,"Ink Free":12,IrisUPC:12,"Iskoola Pota":12,JasmineUPC:11,"Javanese Text":14,Jokerman:17,"Juice ITC":8,KaiTi:12,Kalinga:13,Kartika:14,"Khmer UI":13,KodchiangUPC:8,Kokila:9,"Kristen ITC":14,"Kunstler Script":8,"Lao UI":13,Latha:12,Leelawadee:13,"Leelawadee UI":13,"Leelawadee UI Semilight":13,"Levenim MT":14,LilyUPC:11,"Lucida Bright":15,"Lucida Calligraphy":17,"Lucida Console":15,"Lucida Fax":16,"Lucida Handwriting":17,"Lucida Sans":16,"Lucida Sans Typewriter":14,"Lucida Sans Unicode":16,"Magic R":14,Magneto:19,"Maiandra GD":15,"Malgun Gothic":14,"Malgun Gothic Semilight":14,Mangal:14,Marlett:25,"Matura MT Script Capitals":17,Meiryo:16,"Meiryo UI":16,"Microsoft GothicNeo":13,"Microsoft Himalaya":9,"Microsoft JhengHei":14,"Microsoft JhengHei Light":15,"Microsoft JhengHei UI":14,"Microsoft JhengHei UI Light":15,"Microsoft New Tai Lue":14,"Microsoft PhagsPa":14,"Microsoft Sans Serif":14,"Microsoft Tai Le":14,"Microsoft Uighur":9,"Microsoft YaHei Light":15,"Microsoft YaHei UI":15,"Microsoft YaHei UI Light":15,"Microsoft Yi Baiti":13,MingLiU:13,MingLiU_HKSCS:13,"MingLiU_HKSCS-ExtB":13,"MingLiU-ExtB":13,Miriam:12,"Miriam Fixed":15,Mistral:12,"Modern No. 20":12,"MoeumT R":14,"Mongolian Baiti":13,"Monotype Corsiva":12,MoolBoran:9,"MS Gothic":13,"MS Mincho":13,"MS Outlook":13,"MS PGothic":13,"MS PMincho":13,"MS Reference Sans Serif":16,"MS Reference Specialty":30,"MS UI Gothic":13,"MT Extra":25,"MV Boli":18,"Myanmar Text":14,Narkisim:11,"Neue Haas Grotesk Text Pro":13,"New Gulim":15,"News Gothic MT":16,"Niagara Engraved":9,"Niagara Solid":9,"Nirmala UI":14,"Nirmala UI Semilight":14,Nyala:13,"OCR A Extended":15,OCRB:15,"Old English Text MT":13,Onyx:9,"Palace Script MT":9,"Palatino Linotype":12,Papyrus:15,Parchment:6,Perpetua:11,"Perpetua Titling MT":16,"Plantagenet Cherokee":13,Playbill:10,PMingLiU:12,"PMingLiU-ExtB":12,"Poor Richard":14,Pristina:13,"Pyunji R":13,Raavi:12,"Rage Italic":13,Ravie:24,Rockwell:13,"Rockwell Condensed":10,"Rockwell Extra Bold":17,"Rockwell Light":14,"Rockwell Nova":13,"Rockwell Nova Cond":13,"Rockwell Nova Cond Light":13,"Rockwell Nova Extra Bold":13,"Rockwell Nova Light":13,Rod:15,"Sakkal Majalla":10,"Sanskrit Text":15,"Script MT Bold":13,"Segoe MDL2 Assets":10,"Segoe Print":18,"Segoe Script":18,"Segoe UI":13,"Segoe UI Black":15,"Segoe UI Emoji":13,"Segoe UI Historic":13,"Segoe UI Light":12,"Segoe UI Semibold":14,"Segoe UI Semilight":13,"Segoe UI Symbol":13,Selawik:12,"Selawik Light":13,"Selawik Semibold":14,"Shonar Bangla":12,"Showcard Gothic":14,Shruti:14,"Simplified Arabic":13,"Simplified Arabic Fixed":14,"SimSun-ExtB":12,"Sitka Banner":12,"Sitka Display":13,"Sitka Heading":13,"Sitka Small":16,"Sitka Subheading":14,"Sitka Text":15,"Snap ITC":21,"Source Sans Pro":12,"Source Sans Pro Black":12,"Source Sans Pro ExtraLight":11,"Source Sans Pro Light":12,"Source Sans Pro SemiBold":12,Stencil:14,Sylfaen:12,Symbol:12,Tahoma:13,"Tempus Sans ITC":16,"TH SarabunPSK":9,"Times New Roman":12,"Traditional Arabic":12,"Trebuchet MS":13,Tunga:13,"Tw Cen MT":13,"Tw Cen MT Condensed":9,"Tw Cen MT Condensed Extra Bold":12,"UD Digi Kyokasho N-B":12,"UD Digi Kyokasho NK-B":12,"UD Digi Kyokasho NK-R":12,"UD Digi Kyokasho NP-B":17,"UD Digi Kyokasho NP-R":12,"UD Digi Kyokasho N-R":12,Univers:12,"Univers Condensed":12,"Univers Condensed Light":11,"Univers Light":12,"Urdu Typesetting":12,Utsaah:10,Vani:15,Verdana:15,"Verdana Pro":15,"Verdana Pro Black":12,"Verdana Pro Cond":12,"Verdana Pro Cond Black":12,"Verdana Pro Cond Light":12,"Verdana Pro Cond SemiBold":12,"Verdana Pro Light":12,"Verdana Pro SemiBold":12,Vijaya:12,"Viner Hand ITC":16,Vivaldi:10,"Vladimir Script":11,Vrinda:14,Webdings:24,"Wide Latin":30,Wingdings:32,"Wingdings 2":27,"Wingdings 3":21,"Yet R":13,"Yu Gothic":13,"Yu Gothic Light":13,"Yu Gothic Medium":13,"Yu Gothic UI":13,"Yu Gothic UI Light":13,"Yu Gothic UI Semibold":14,"Yu Gothic UI Semilight":13,"Yu Mincho":13,"Yu Mincho Demibold":13,"Yu Mincho Light":12,"\u4eff\u5b8b":12,"\u534e\u6587\u4e2d\u5b8b":15,"\u534e\u6587\u4eff\u5b8b":11,"\u534e\u6587\u5b8b\u4f53":11,"\u534e\u6587\u5f69\u4e91":14,"\u534e\u6587\u65b0\u9b4f":14,"\u534e\u6587\u6977\u4f53":11,"\u534e\u6587\u7425\u73c0":14,"\u534e\u6587\u7ec6\u9ed1":13,"\u534e\u6587\u884c\u6977":12,"\u534e\u6587\u96b6\u4e66":11,"\u5b8b\u4f53":12,"\u5e7c\u5706":12,"\u5fae\u8f6f\u96c5\u9ed1":14,"\u5fae\u8f6f\u96c5\u9ed1 Light":14,"\u65b0\u5b8b\u4f53":12,"\u65b9\u6b63\u59da\u4f53":12,"\u65b9\u6b63\u8212\u4f53":13,"\u6977\u4f53":12,"\u7b49\u7ebf":13,"\u7b49\u7ebf Light":12,"\u96b6\u4e66":12,"\u9ed1\u4f53":12,"\u6e38\u30b4\u30b7\u30c3\u30af":13,"\uff2d\uff33 \uff30\u660e\u671d":12,'"\uff2d\uff33 \uff30\u30b4\u30b7\u30c3\u30af"':12,"\u30e1\u30a4\u30ea\u30aa":15,"HG\uff7a\uff9e\uff7c\uff6f\uff78E":12,"HG\u660e\u671dB":12,"HG\uff7a\uff9e\uff7c\uff6f\uff78M":12},20:{"Gill Sans MT":14,Abadi:16,"Abadi Extra Light":15,"Agency FB":11,Aharoni:11,Aldhabi:9,Algerian:16,"Ami R":11,"Angsana New":9,AngsanaUPC:9,Aparajita:11,"Arabic Typesetting":9,Arial:15,"Arial Black":18,"Arial Narrow":12,"Arial Nova":15,"Arial Nova Cond":14,"Arial Nova Cond Light":12,"Arial Nova Light":15,"Arial Rounded MT Bold":16,"Baskerville Old Face":13,Batang:16,BatangChe:14,"Bauhaus 93":15,"Bell MT":14,Bembo:13,"Berlin Sans FB":16,"Berlin Sans FB Demi":17,"Bernard MT Condensed":13,"Blackadder ITC":11,"Bodoni MT":13,"Bodoni MT Black":18,"Bodoni MT Condensed":9,"Bodoni MT Poster Compressed":8,"Book Antiqua":14,"Bookman Old Style":17,"Bookshelf Symbol 7":20,"Bradley Hand ITC":17,"Britannic Bold":17,Broadway:17,"Browallia New":10,BrowalliaUPC:10,"Brush Script MT":14,Calibri:14,"Calibri Light":14,"Californian FB":14,"Calisto MT":14,Cambria:15,"Cambria Math":15,Candara:15,Castellar:19,Centaur:13,Century:15,"Century Gothic":15,"Century Schoolbook":15,Chiller:13,"Colonna MT":14,"Comic Sans MS":16,Consolas:15,Constantia:15,"Cooper Black":16,"Copperplate Gothic Bold":19,"Copperplate Gothic Light":19,Corbel:14,"Cordia New":10,CordiaUPC:10,"Courier New":16,"Curlz MT":15,Dante:12,DaunPenh:9,David:12,DilleniaUPC:8,DokChampa:15,Dotum:16,DotumChe:14,Dubai:15,"Dubai Light":15,"Dubai Medium":15,Ebrima:15,"Edwardian Script ITC":13,Elephant:20,"Engravers MT":17,"Eras Bold ITC":18,"Eras Demi ITC":16,"Eras Light ITC":14,"Eras Medium ITC":15,EucrosiaUPC:11,Euphemia:16,"Expo M":23,FangSong:14,"Felix Titling":16,"Footlight MT Light":15,Forte:14,"Franklin Gothic Book":16,"Franklin Gothic Demi":16,"Franklin Gothic Demi Cond":14,"Franklin Gothic Heavy":16,"Franklin Gothic Medium":16,"Franklin Gothic Medium Cond":14,FrankRuehl:11,FreesiaUPC:12,"Freestyle Script":10,"French Script MT":10,Gabriola:11,Gadugi:15,Garamond:13,Gautami:16,Georgia:17,"Georgia Pro":15,"Georgia Pro Black":19,"Georgia Pro Cond":14,"Georgia Pro Cond Black":17,"Georgia Pro Cond Light":14,"Georgia Pro Cond Semibold":15,"Georgia Pro Light":15,"Georgia Pro Semibold":17,Gigi:14,"Gill Sans MT Condensed":10,"Gill Sans MT Ext Condensed Bold":9,"Gill Sans Nova":14,"Gill Sans Nova Cond":9,"Gill Sans Nova Cond Lt":8,"Gill Sans Nova Cond Ultra Bold":16,"Gill Sans Nova Cond XBd":14,"Gill Sans Nova Light":14,"Gill Sans Nova Ultra Bold":23,"Gill Sans Ultra Bold":23,"Gill Sans Ultra Bold Condensed":16,Gisha:15,"Gloucester MT Extra Condensed":10,"Goudy Old Style":14,"Goudy Stout":22,Grotesque:13,"Grotesque Light":13,Gulim:16,GulimChe:14,Gungsuh:16,GungsuhChe:14,"Hadassah Friedlaender":15,Haettenschweiler:12,"Harlow Solid Italic":13,Harrington:15,"Headline R":19,HGGothicE:14,HGGothicM:14,HGGyoshotai:14,HGKyokashotai:14,HGMaruGothicMPRO:20,HGMinchoB:15,HGMinchoE:15,HGPGothicE:16,HGPGothicM:17,HGPGyoshotai:14,HGPKyokashotai:14,HGPMinchoB:14,HGPMinchoE:15,HGPSoeiKakugothicUB:18,HGPSoeiKakupoptai:19,HGPSoeiPresenceEB:16,HGSeikaishotaiPRO:16,HGSGothicE:15,HGSGothicM:16,HGSGyoshotai:13,HGSKyokashotai:13,HGSMinchoB:14,HGSMinchoE:15,HGSoeiKakugothicUB:15,HGSoeiKakupoptai:15,HGSoeiPresenceEB:15,HGSSoeiKakugothicUB:17,HGSSoeiKakupoptai:18,HGSSoeiPresenceEB:15,"High Tower Text":13,"HYGothic-Extra":17,"HYGothic-Medium":16,"HYGraphic-Medium":16,"HYGungSo-Bold":16,"HYHeadLine-Medium":16,"HYMyeongJo-Extra":18,"HYPMokGak-Bold":19,"HYPost-Light":18,"HYPost-Medium":19,"HYShortSamul-Medium":10,"HYSinMyeongJo-Medium":17,Impact:15,"Imprint MT Shadow":14,"Informal Roman":15,"Ink Free":14,IrisUPC:14,"Iskoola Pota":14,JasmineUPC:12,"Javanese Text":16,Jokerman:19,"Juice ITC":10,KaiTi:14,Kalinga:15,Kartika:16,"Khmer UI":15,KodchiangUPC:9,Kokila:10,"Kristen ITC":16,"Kunstler Script":10,"Lao UI":15,Latha:14,Leelawadee:15,"Leelawadee UI":15,"Leelawadee UI Semilight":15,"Levenim MT":15,LilyUPC:12,"Lucida Bright":16,"Lucida Calligraphy":19,"Lucida Console":17,"Lucida Fax":18,"Lucida Handwriting":19,"Lucida Sans":18,"Lucida Sans Typewriter":16,"Lucida Sans Unicode":18,"Magic R":16,Magneto:21,"Maiandra GD":17,"Malgun Gothic":16,"Malgun Gothic Semilight":16,Mangal:16,Marlett:28,"Matura MT Script Capitals":19,Meiryo:18,"Meiryo UI":18,"Microsoft GothicNeo":15,"Microsoft Himalaya":10,"Microsoft JhengHei":16,"Microsoft JhengHei Light":17,"Microsoft JhengHei UI":16,"Microsoft JhengHei UI Light":17,"Microsoft New Tai Lue":16,"Microsoft PhagsPa":16,"Microsoft Sans Serif":16,"Microsoft Tai Le":16,"Microsoft Uighur":10,"Microsoft YaHei Light":16,"Microsoft YaHei UI":17,"Microsoft YaHei UI Light":16,"Microsoft Yi Baiti":15,MingLiU:15,MingLiU_HKSCS:15,"MingLiU_HKSCS-ExtB":15,"MingLiU-ExtB":15,Miriam:14,"Miriam Fixed":17,Mistral:13,"Modern No. 20":13,"MoeumT R":16,"Mongolian Baiti":15,"Monotype Corsiva":13,MoolBoran:10,"MS Gothic":15,"MS Mincho":15,"MS Outlook":15,"MS PGothic":15,"MS PMincho":15,"MS Reference Sans Serif":18,"MS Reference Specialty":33,"MS UI Gothic":15,"MT Extra":29,"MV Boli":20,"Myanmar Text":16,Narkisim:12,"Neue Haas Grotesk Text Pro":15,"New Gulim":17,"News Gothic MT":18,"Niagara Engraved":9,"Niagara Solid":9,"Nirmala UI":16,"Nirmala UI Semilight":16,Nyala:15,"OCR A Extended":17,OCRB:17,"Old English Text MT":15,Onyx:9,"Palace Script MT":9,"Palatino Linotype":14,Papyrus:16,Parchment:7,Perpetua:12,"Perpetua Titling MT":18,"Plantagenet Cherokee":15,Playbill:11,PMingLiU:14,"PMingLiU-ExtB":14,"Poor Richard":16,Pristina:14,"Pyunji R":14,Raavi:14,"Rage Italic":15,Ravie:27,Rockwell:15,"Rockwell Condensed":12,"Rockwell Extra Bold":19,"Rockwell Light":15,"Rockwell Nova":15,"Rockwell Nova Cond":15,"Rockwell Nova Cond Light":15,"Rockwell Nova Extra Bold":15,"Rockwell Nova Light":15,Rod:17,"Sakkal Majalla":11,"Sanskrit Text":17,"Script MT Bold":14,"Segoe MDL2 Assets":11,"Segoe Print":20,"Segoe Script":20,"Segoe UI":15,"Segoe UI Black":17,"Segoe UI Emoji":15,"Segoe UI Historic":15,"Segoe UI Light":14,"Segoe UI Semibold":15,"Segoe UI Semilight":15,"Segoe UI Symbol":15,Selawik:14,"Selawik Light":14,"Selawik Semibold":15,"Shonar Bangla":14,"Showcard Gothic":16,Shruti:16,"Simplified Arabic":14,"Simplified Arabic Fixed":16,"SimSun-ExtB":14,"Sitka Banner":14,"Sitka Display":14,"Sitka Heading":15,"Sitka Small":18,"Sitka Subheading":16,"Sitka Text":17,"Snap ITC":23,"Source Sans Pro":13,"Source Sans Pro Black":14,"Source Sans Pro ExtraLight":12,"Source Sans Pro Light":12,"Source Sans Pro SemiBold":14,Stencil:16,Sylfaen:14,Symbol:14,Tahoma:15,"Tempus Sans ITC":18,"TH SarabunPSK":10,"Times New Roman":14,"Traditional Arabic":13,"Trebuchet MS":14,Tunga:14,"Tw Cen MT":15,"Tw Cen MT Condensed":10,"Tw Cen MT Condensed Extra Bold":13,"UD Digi Kyokasho N-B":14,"UD Digi Kyokasho NK-B":14,"UD Digi Kyokasho NK-R":14,"UD Digi Kyokasho NP-B":19,"UD Digi Kyokasho NP-R":14,"UD Digi Kyokasho N-R":14,Univers:14,"Univers Condensed":14,"Univers Condensed Light":12,"Univers Light":14,"Urdu Typesetting":14,Utsaah:11,Vani:17,Verdana:17,"Verdana Pro":17,"Verdana Pro Black":14,"Verdana Pro Cond":14,"Verdana Pro Cond Black":14,"Verdana Pro Cond Light":14,"Verdana Pro Cond SemiBold":14,"Verdana Pro Light":14,"Verdana Pro SemiBold":14,Vijaya:14,"Viner Hand ITC":18,Vivaldi:12,"Vladimir Script":13,Vrinda:16,Webdings:27,"Wide Latin":33,Wingdings:36,"Wingdings 2":31,"Wingdings 3":24,"Yet R":14,"Yu Gothic":15,"Yu Gothic Light":14,"Yu Gothic Medium":15,"Yu Gothic UI":15,"Yu Gothic UI Light":14,"Yu Gothic UI Semibold":16,"Yu Gothic UI Semilight":15,"Yu Mincho":15,"Yu Mincho Demibold":14,"Yu Mincho Light":14,"\u4eff\u5b8b":14,"\u534e\u6587\u4e2d\u5b8b":17,"\u534e\u6587\u4eff\u5b8b":13,"\u534e\u6587\u5b8b\u4f53":13,"\u534e\u6587\u5f69\u4e91":15,"\u534e\u6587\u65b0\u9b4f":16,"\u534e\u6587\u6977\u4f53":13,"\u534e\u6587\u7425\u73c0":15,"\u534e\u6587\u7ec6\u9ed1":15,"\u534e\u6587\u884c\u6977":14,"\u534e\u6587\u96b6\u4e66":12,"\u5b8b\u4f53":14,"\u5e7c\u5706":14,"\u5fae\u8f6f\u96c5\u9ed1":16,"\u5fae\u8f6f\u96c5\u9ed1 Light":15,"\u65b0\u5b8b\u4f53":14,"\u65b9\u6b63\u59da\u4f53":14,"\u65b9\u6b63\u8212\u4f53":15,"\u6977\u4f53":14,"\u7b49\u7ebf":14,"\u7b49\u7ebf Light":14,"\u96b6\u4e66":14,"\u9ed1\u4f53":14,"\u6e38\u30b4\u30b7\u30c3\u30af":15,"\uff2d\uff33 \uff30\u660e\u671d":14,'"\uff2d\uff33 \uff30\u30b4\u30b7\u30c3\u30af"':14,"\u30e1\u30a4\u30ea\u30aa":17,"HG\uff7a\uff9e\uff7c\uff6f\uff78E":14,"HG\u660e\u671dB":14,"HG\uff7a\uff9e\uff7c\uff6f\uff78M":14},22:{"Gill Sans MT":15,Abadi:18,"Abadi Extra Light":16,"Agency FB":11,Aharoni:12,Aldhabi:9,Algerian:17,"Ami R":12,"Angsana New":10,AngsanaUPC:10,Aparajita:12,"Arabic Typesetting":10,Arial:16,"Arial Black":19,"Arial Narrow":13,"Arial Nova":16,"Arial Nova Cond":15,"Arial Nova Cond Light":13,"Arial Nova Light":16,"Arial Rounded MT Bold":17,"Baskerville Old Face":14,Batang:17,BatangChe:15,"Bauhaus 93":16,"Bell MT":15,Bembo:14,"Berlin Sans FB":17,"Berlin Sans FB Demi":18,"Bernard MT Condensed":14,"Blackadder ITC":11,"Bodoni MT":14,"Bodoni MT Black":19,"Bodoni MT Condensed":10,"Bodoni MT Poster Compressed":9,"Book Antiqua":15,"Bookman Old Style":18,"Bookshelf Symbol 7":21,"Bradley Hand ITC":19,"Britannic Bold":18,Broadway:19,"Browallia New":11,BrowalliaUPC:11,"Brush Script MT":15,Calibri:15,"Calibri Light":15,"Californian FB":15,"Calisto MT":15,Cambria:16,"Cambria Math":16,Candara:16,Castellar:21,Centaur:14,Century:16,"Century Gothic":16,"Century Schoolbook":16,Chiller:14,"Colonna MT":15,"Comic Sans MS":18,Consolas:16,Constantia:16,"Cooper Black":17,"Copperplate Gothic Bold":21,"Copperplate Gothic Light":21,Corbel:15,"Cordia New":11,CordiaUPC:11,"Courier New":17,"Curlz MT":16,Dante:13,DaunPenh:10,David:13,DilleniaUPC:9,DokChampa:16,Dotum:17,DotumChe:15,Dubai:16,"Dubai Light":16,"Dubai Medium":16,Ebrima:16,"Edwardian Script ITC":14,Elephant:22,"Engravers MT":19,"Eras Bold ITC":19,"Eras Demi ITC":18,"Eras Light ITC":16,"Eras Medium ITC":17,EucrosiaUPC:12,Euphemia:17,"Expo M":25,FangSong:15,"Felix Titling":17,"Footlight MT Light":16,Forte:15,"Franklin Gothic Book":17,"Franklin Gothic Demi":17,"Franklin Gothic Demi Cond":15,"Franklin Gothic Heavy":17,"Franklin Gothic Medium":17,"Franklin Gothic Medium Cond":15,FrankRuehl:12,FreesiaUPC:13,"Freestyle Script":10,"French Script MT":11,Gabriola:12,Gadugi:16,Garamond:14,Gautami:17,Georgia:18,"Georgia Pro":16,"Georgia Pro Black":21,"Georgia Pro Cond":15,"Georgia Pro Cond Black":18,"Georgia Pro Cond Light":15,"Georgia Pro Cond Semibold":16,"Georgia Pro Light":16,"Georgia Pro Semibold":18,Gigi:14,"Gill Sans MT Condensed":11,"Gill Sans MT Ext Condensed Bold":10,"Gill Sans Nova":15,"Gill Sans Nova Cond":10,"Gill Sans Nova Cond Lt":9,"Gill Sans Nova Cond Ultra Bold":17,"Gill Sans Nova Cond XBd":15,"Gill Sans Nova Light":15,"Gill Sans Nova Ultra Bold":25,"Gill Sans Ultra Bold":25,"Gill Sans Ultra Bold Condensed":17,Gisha:16,"Gloucester MT Extra Condensed":11,"Goudy Old Style":15,"Goudy Stout":24,Grotesque:14,"Grotesque Light":14,Gulim:17,GulimChe:15,Gungsuh:17,GungsuhChe:15,"Hadassah Friedlaender":17,Haettenschweiler:13,"Harlow Solid Italic":14,Harrington:16,"Headline R":21,HGGothicE:15,HGGothicM:15,HGGyoshotai:15,HGKyokashotai:15,HGMaruGothicMPRO:22,HGMinchoB:16,HGMinchoE:16,HGPGothicE:17,HGPGothicM:18,HGPGyoshotai:15,HGPKyokashotai:14,HGPMinchoB:15,HGPMinchoE:16,HGPSoeiKakugothicUB:19,HGPSoeiKakupoptai:20,HGPSoeiPresenceEB:17,HGSeikaishotaiPRO:17,HGSGothicE:16,HGSGothicM:17,HGSGyoshotai:14,HGSKyokashotai:13,HGSMinchoB:15,HGSMinchoE:16,HGSoeiKakugothicUB:16,HGSoeiKakupoptai:16,HGSoeiPresenceEB:16,HGSSoeiKakugothicUB:18,HGSSoeiKakupoptai:19,HGSSoeiPresenceEB:16,"High Tower Text":14,"HYGothic-Extra":18,"HYGothic-Medium":17,"HYGraphic-Medium":17,"HYGungSo-Bold":17,"HYHeadLine-Medium":17,"HYMyeongJo-Extra":19,"HYPMokGak-Bold":21,"HYPost-Light":19,"HYPost-Medium":21,"HYShortSamul-Medium":11,"HYSinMyeongJo-Medium":18,Impact:16,"Imprint MT Shadow":15,"Informal Roman":16,"Ink Free":15,IrisUPC:15,"Iskoola Pota":15,JasmineUPC:13,"Javanese Text":17,Jokerman:21,"Juice ITC":11,KaiTi:15,Kalinga:16,Kartika:17,"Khmer UI":16,KodchiangUPC:10,Kokila:11,"Kristen ITC":17,"Kunstler Script":10,"Lao UI":16,Latha:15,Leelawadee:16,"Leelawadee UI":16,"Leelawadee UI Semilight":16,"Levenim MT":17,LilyUPC:13,"Lucida Bright":18,"Lucida Calligraphy":20,"Lucida Console":18,"Lucida Fax":19,"Lucida Handwriting":21,"Lucida Sans":19,"Lucida Sans Typewriter":17,"Lucida Sans Unicode":19,"Magic R":17,Magneto:22,"Maiandra GD":18,"Malgun Gothic":17,"Malgun Gothic Semilight":17,Mangal:17,Marlett:30,"Matura MT Script Capitals":20,Meiryo:20,"Meiryo UI":20,"Microsoft GothicNeo":16,"Microsoft Himalaya":11,"Microsoft JhengHei":17,"Microsoft JhengHei Light":18,"Microsoft JhengHei UI":17,"Microsoft JhengHei UI Light":18,"Microsoft New Tai Lue":17,"Microsoft PhagsPa":17,"Microsoft Sans Serif":17,"Microsoft Tai Le":17,"Microsoft Uighur":11,"Microsoft YaHei Light":18,"Microsoft YaHei UI":18,"Microsoft YaHei UI Light":18,"Microsoft Yi Baiti":16,MingLiU:16,MingLiU_HKSCS:16,"MingLiU_HKSCS-ExtB":16,"MingLiU-ExtB":16,Miriam:15,"Miriam Fixed":18,Mistral:14,"Modern No. 20":14,"MoeumT R":17,"Mongolian Baiti":16,"Monotype Corsiva":14,MoolBoran:11,"MS Gothic":16,"MS Mincho":16,"MS Outlook":16,"MS PGothic":16,"MS PMincho":16,"MS Reference Sans Serif":19,"MS Reference Specialty":36,"MS UI Gothic":16,"MT Extra":31,"MV Boli":21,"Myanmar Text":17,Narkisim:13,"Neue Haas Grotesk Text Pro":16,"New Gulim":18,"News Gothic MT":19,"Niagara Engraved":10,"Niagara Solid":10,"Nirmala UI":17,"Nirmala UI Semilight":17,Nyala:16,"OCR A Extended":19,OCRB:18,"Old English Text MT":16,Onyx:10,"Palace Script MT":10,"Palatino Linotype":15,Papyrus:18,Parchment:7,Perpetua:13,"Perpetua Titling MT":20,"Plantagenet Cherokee":16,Playbill:11,PMingLiU:15,"PMingLiU-ExtB":15,"Poor Richard":17,Pristina:15,"Pyunji R":15,Raavi:15,"Rage Italic":16,Ravie:29,Rockwell:16,"Rockwell Condensed":12,"Rockwell Extra Bold":20,"Rockwell Light":16,"Rockwell Nova":16,"Rockwell Nova Cond":16,"Rockwell Nova Cond Light":16,"Rockwell Nova Extra Bold":16,"Rockwell Nova Light":16,Rod:18,"Sakkal Majalla":12,"Sanskrit Text":18,"Script MT Bold":15,"Segoe MDL2 Assets":12,"Segoe Print":21,"Segoe Script":21,"Segoe UI":16,"Segoe UI Black":18,"Segoe UI Emoji":16,"Segoe UI Historic":16,"Segoe UI Light":15,"Segoe UI Semibold":17,"Segoe UI Semilight":16,"Segoe UI Symbol":16,Selawik:15,"Selawik Light":15,"Selawik Semibold":16,"Shonar Bangla":15,"Showcard Gothic":17,Shruti:17,"Simplified Arabic":15,"Simplified Arabic Fixed":17,"SimSun-ExtB":15,"Sitka Banner":15,"Sitka Display":15,"Sitka Heading":16,"Sitka Small":20,"Sitka Subheading":17,"Sitka Text":18,"Snap ITC":25,"Source Sans Pro":14,"Source Sans Pro Black":15,"Source Sans Pro ExtraLight":13,"Source Sans Pro Light":13,"Source Sans Pro SemiBold":14,Stencil:17,Sylfaen:15,Symbol:15,Tahoma:16,"Tempus Sans ITC":19,"TH SarabunPSK":11,"Times New Roman":15,"Traditional Arabic":14,"Trebuchet MS":15,Tunga:15,"Tw Cen MT":16,"Tw Cen MT Condensed":11,"Tw Cen MT Condensed Extra Bold":14,"UD Digi Kyokasho N-B":15,"UD Digi Kyokasho NK-B":15,"UD Digi Kyokasho NK-R":15,"UD Digi Kyokasho NP-B":21,"UD Digi Kyokasho NP-R":15,"UD Digi Kyokasho N-R":15,Univers:15,"Univers Condensed":15,"Univers Condensed Light":13,"Univers Light":15,"Urdu Typesetting":15,Utsaah:12,Vani:18,Verdana:18,"Verdana Pro":18,"Verdana Pro Black":15,"Verdana Pro Cond":15,"Verdana Pro Cond Black":15,"Verdana Pro Cond Light":15,"Verdana Pro Cond SemiBold":15,"Verdana Pro Light":15,"Verdana Pro SemiBold":15,Vijaya:12,"Viner Hand ITC":20,Vivaldi:12,"Vladimir Script":13,Vrinda:17,Webdings:29,"Wide Latin":36,Wingdings:39,"Wingdings 2":33,"Wingdings 3":26,"Yet R":16,"Yu Gothic":16,"Yu Gothic Light":16,"Yu Gothic Medium":16,"Yu Gothic UI":16,"Yu Gothic UI Light":15,"Yu Gothic UI Semibold":17,"Yu Gothic UI Semilight":16,"Yu Mincho":16,"Yu Mincho Demibold":15,"Yu Mincho Light":15,"\u4eff\u5b8b":15,"\u534e\u6587\u4e2d\u5b8b":18,"\u534e\u6587\u4eff\u5b8b":14,"\u534e\u6587\u5b8b\u4f53":14,"\u534e\u6587\u5f69\u4e91":16,"\u534e\u6587\u65b0\u9b4f":17,"\u534e\u6587\u6977\u4f53":14,"\u534e\u6587\u7425\u73c0":16,"\u534e\u6587\u7ec6\u9ed1":16,"\u534e\u6587\u884c\u6977":15,"\u534e\u6587\u96b6\u4e66":13,"\u5b8b\u4f53":15,"\u5e7c\u5706":15,"\u5fae\u8f6f\u96c5\u9ed1":17,"\u5fae\u8f6f\u96c5\u9ed1 Light":17,"\u65b0\u5b8b\u4f53":15,"\u65b9\u6b63\u59da\u4f53":15,"\u65b9\u6b63\u8212\u4f53":16,"\u6977\u4f53":15,"\u7b49\u7ebf":15,"\u7b49\u7ebf Light":15,"\u96b6\u4e66":15,"\u9ed1\u4f53":15,"\u6e38\u30b4\u30b7\u30c3\u30af":16,"\uff2d\uff33 \uff30\u660e\u671d":15,'"\uff2d\uff33 \uff30\u30b4\u30b7\u30c3\u30af"':15,"\u30e1\u30a4\u30ea\u30aa":18,"HG\uff7a\uff9e\uff7c\uff6f\uff78E":15,"HG\u660e\u671dB":15,"HG\uff7a\uff9e\uff7c\uff6f\uff78M":15},24:{"Gill Sans MT":16,Abadi:19,"Abadi Extra Light":18,"Agency FB":14,Aharoni:13,Aldhabi:10,Algerian:19,"Ami R":13,"Angsana New":11,AngsanaUPC:11,Aparajita:13,"Arabic Typesetting":11,Arial:18,"Arial Black":21,"Arial Narrow":15,"Arial Nova":18,"Arial Nova Cond":16,"Arial Nova Cond Light":14,"Arial Nova Light":18,"Arial Rounded MT Bold":19,"Baskerville Old Face":16,Batang:19,BatangChe:16,"Bauhaus 93":18,"Bell MT":16,Bembo:16,"Berlin Sans FB":19,"Berlin Sans FB Demi":20,"Bernard MT Condensed":16,"Blackadder ITC":13,"Bodoni MT":16,"Bodoni MT Black":21,"Bodoni MT Condensed":11,"Bodoni MT Poster Compressed":9,"Book Antiqua":16,"Bookman Old Style":20,"Bookshelf Symbol 7":24,"Bradley Hand ITC":21,"Britannic Bold":20,Broadway:21,"Browallia New":12,BrowalliaUPC:12,"Brush Script MT":16,Calibri:16,"Calibri Light":16,"Californian FB":17,"Calisto MT":16,Cambria:18,"Cambria Math":18,Candara:18,Castellar:23,Centaur:16,Century:18,"Century Gothic":18,"Century Schoolbook":18,Chiller:15,"Colonna MT":16,"Comic Sans MS":20,Consolas:18,Constantia:17,"Cooper Black":19,"Copperplate Gothic Bold":23,"Copperplate Gothic Light":23,Corbel:17,"Cordia New":12,CordiaUPC:12,"Courier New":19,"Curlz MT":17,Dante:14,DaunPenh:11,David:14,DilleniaUPC:10,DokChampa:18,Dotum:19,DotumChe:16,Dubai:17,"Dubai Light":17,"Dubai Medium":17,Ebrima:17,"Edwardian Script ITC":15,Elephant:24,"Engravers MT":21,"Eras Bold ITC":21,"Eras Demi ITC":20,"Eras Light ITC":17,"Eras Medium ITC":18,EucrosiaUPC:13,Euphemia:19,"Expo M":28,FangSong:16,"Felix Titling":19,"Footlight MT Light":18,Forte:17,"Franklin Gothic Book":19,"Franklin Gothic Demi":19,"Franklin Gothic Demi Cond":16,"Franklin Gothic Heavy":19,"Franklin Gothic Medium":19,"Franklin Gothic Medium Cond":16,FrankRuehl:13,FreesiaUPC:14,"Freestyle Script":12,"French Script MT":12,Gabriola:13,Gadugi:17,Garamond:15,Gautami:19,Georgia:20,"Georgia Pro":18,"Georgia Pro Black":23,"Georgia Pro Cond":17,"Georgia Pro Cond Black":20,"Georgia Pro Cond Light":16,"Georgia Pro Cond Semibold":18,"Georgia Pro Light":18,"Georgia Pro Semibold":20,Gigi:17,"Gill Sans MT Condensed":12,"Gill Sans MT Ext Condensed Bold":11,"Gill Sans Nova":16,"Gill Sans Nova Cond":11,"Gill Sans Nova Cond Lt":10,"Gill Sans Nova Cond Ultra Bold":19,"Gill Sans Nova Cond XBd":17,"Gill Sans Nova Light":16,"Gill Sans Nova Ultra Bold":27,"Gill Sans Ultra Bold":27,"Gill Sans Ultra Bold Condensed":19,Gisha:17,"Gloucester MT Extra Condensed":12,"Goudy Old Style":16,"Goudy Stout":26,Grotesque:15,"Grotesque Light":15,Gulim:18,GulimChe:16,Gungsuh:19,GungsuhChe:16,"Hadassah Friedlaender":18,Haettenschweiler:14,"Harlow Solid Italic":15,Harrington:18,"Headline R":23,HGGothicE:16,HGGothicM:16,HGGyoshotai:16,HGKyokashotai:16,HGMaruGothicMPRO:24,HGMinchoB:17,HGMinchoE:17,HGPGothicE:18,HGPGothicM:20,HGPGyoshotai:16,HGPKyokashotai:16,HGPMinchoB:16,HGPMinchoE:18,HGPSoeiKakugothicUB:21,HGPSoeiKakupoptai:22,HGPSoeiPresenceEB:19,HGSeikaishotaiPRO:19,HGSGothicE:17,HGSGothicM:19,HGSGyoshotai:15,HGSKyokashotai:15,HGSMinchoB:16,HGSMinchoE:18,HGSoeiKakugothicUB:17,HGSoeiKakupoptai:17,HGSoeiPresenceEB:17,HGSSoeiKakugothicUB:20,HGSSoeiKakupoptai:21,HGSSoeiPresenceEB:18,"High Tower Text":15,"HYGothic-Extra":20,"HYGothic-Medium":19,"HYGraphic-Medium":19,"HYGungSo-Bold":19,"HYHeadLine-Medium":19,"HYMyeongJo-Extra":21,"HYPMokGak-Bold":23,"HYPost-Light":21,"HYPost-Medium":23,"HYShortSamul-Medium":12,"HYSinMyeongJo-Medium":20,Impact:17,"Imprint MT Shadow":16,"Informal Roman":17,"Ink Free":16,IrisUPC:16,"Iskoola Pota":16,JasmineUPC:15,"Javanese Text":19,Jokerman:23,"Juice ITC":11,KaiTi:16,Kalinga:18,Kartika:18,"Khmer UI":17,KodchiangUPC:11,Kokila:12,"Kristen ITC":19,"Kunstler Script":11,"Lao UI":17,Latha:16,Leelawadee:17,"Leelawadee UI":17,"Leelawadee UI Semilight":18,"Levenim MT":18,LilyUPC:14,"Lucida Bright":19,"Lucida Calligraphy":22,"Lucida Console":20,"Lucida Fax":21,"Lucida Handwriting":23,"Lucida Sans":21,"Lucida Sans Typewriter":19,"Lucida Sans Unicode":21,"Magic R":19,Magneto:25,"Maiandra GD":20,"Malgun Gothic":19,"Malgun Gothic Semilight":19,Mangal:18,Marlett:33,"Matura MT Script Capitals":22,Meiryo:22,"Meiryo UI":22,"Microsoft GothicNeo":17,"Microsoft Himalaya":12,"Microsoft JhengHei":19,"Microsoft JhengHei Light":19,"Microsoft JhengHei UI":19,"Microsoft JhengHei UI Light":19,"Microsoft New Tai Lue":18,"Microsoft PhagsPa":18,"Microsoft Sans Serif":19,"Microsoft Tai Le":18,"Microsoft Uighur":12,"Microsoft YaHei Light":19,"Microsoft YaHei UI":20,"Microsoft YaHei UI Light":19,"Microsoft Yi Baiti":17,MingLiU:17,MingLiU_HKSCS:17,"MingLiU_HKSCS-ExtB":17,"MingLiU-ExtB":17,Miriam:16,"Miriam Fixed":20,Mistral:15,"Modern No. 20":16,"MoeumT R":19,"Mongolian Baiti":17,"Monotype Corsiva":15,MoolBoran:12,"MS Gothic":17,"MS Mincho":17,"MS Outlook":17,"MS PGothic":17,"MS PMincho":17,"MS Reference Sans Serif":21,"MS Reference Specialty":39,"MS UI Gothic":17,"MT Extra":34,"MV Boli":23,"Myanmar Text":18,Narkisim:14,"Neue Haas Grotesk Text Pro":17,"New Gulim":19,"News Gothic MT":21,"Niagara Engraved":11,"Niagara Solid":11,"Nirmala UI":18,"Nirmala UI Semilight":19,Nyala:17,"OCR A Extended":20,OCRB:20,"Old English Text MT":17,Onyx:10,"Palace Script MT":11,"Palatino Linotype":16,Papyrus:20,Parchment:8,Perpetua:15,"Perpetua Titling MT":22,"Plantagenet Cherokee":18,Playbill:12,PMingLiU:16,"PMingLiU-ExtB":16,"Poor Richard":19,Pristina:16,"Pyunji R":17,Raavi:16,"Rage Italic":18,Ravie:31,Rockwell:17,"Rockwell Condensed":14,"Rockwell Extra Bold":22,"Rockwell Light":18,"Rockwell Nova":17,"Rockwell Nova Cond":17,"Rockwell Nova Cond Light":17,"Rockwell Nova Extra Bold":17,"Rockwell Nova Light":17,Rod:20,"Sakkal Majalla":13,"Sanskrit Text":19,"Script MT Bold":17,"Segoe MDL2 Assets":13,"Segoe Print":23,"Segoe Script":23,"Segoe UI":17,"Segoe UI Black":20,"Segoe UI Emoji":17,"Segoe UI Historic":17,"Segoe UI Light":16,"Segoe UI Semibold":18,"Segoe UI Semilight":17,"Segoe UI Symbol":17,Selawik:17,"Selawik Light":17,"Selawik Semibold":18,"Shonar Bangla":13,"Showcard Gothic":19,Shruti:19,"Simplified Arabic":17,"Simplified Arabic Fixed":19,"SimSun-ExtB":16,"Sitka Banner":16,"Sitka Display":17,"Sitka Heading":18,"Sitka Small":22,"Sitka Subheading":19,"Sitka Text":20,"Snap ITC":28,"Source Sans Pro":15,"Source Sans Pro Black":17,"Source Sans Pro ExtraLight":15,"Source Sans Pro Light":15,"Source Sans Pro SemiBold":16,Stencil:18,Sylfaen:16,Symbol:16,Tahoma:17,"Tempus Sans ITC":21,"TH SarabunPSK":12,"Times New Roman":16,"Traditional Arabic":16,"Trebuchet MS":17,Tunga:17,"Tw Cen MT":18,"Tw Cen MT Condensed":12,"Tw Cen MT Condensed Extra Bold":16,"UD Digi Kyokasho N-B":16,"UD Digi Kyokasho NK-B":16,"UD Digi Kyokasho NK-R":16,"UD Digi Kyokasho NP-B":23,"UD Digi Kyokasho NP-R":16,"UD Digi Kyokasho N-R":16,Univers:16,"Univers Condensed":16,"Univers Condensed Light":14,"Univers Light":16,"Urdu Typesetting":16,Utsaah:13,Vani:20,Verdana:20,"Verdana Pro":20,"Verdana Pro Black":16,"Verdana Pro Cond":16,"Verdana Pro Cond Black":16,"Verdana Pro Cond Light":16,"Verdana Pro Cond SemiBold":16,"Verdana Pro Light":16,"Verdana Pro SemiBold":16,Vijaya:13,"Viner Hand ITC":22,Vivaldi:14,"Vladimir Script":15,Vrinda:18,Webdings:32,"Wide Latin":40,Wingdings:43,"Wingdings 2":36,"Wingdings 3":29,"Yet R":17,"Yu Gothic":18,"Yu Gothic Light":17,"Yu Gothic Medium":18,"Yu Gothic UI":17,"Yu Gothic UI Light":17,"Yu Gothic UI Semibold":18,"Yu Gothic UI Semilight":18,"Yu Mincho":17,"Yu Mincho Demibold":17,"Yu Mincho Light":16,"\u4eff\u5b8b":16,"\u534e\u6587\u4e2d\u5b8b":20,"\u534e\u6587\u4eff\u5b8b":15,"\u534e\u6587\u5b8b\u4f53":15,"\u534e\u6587\u5f69\u4e91":18,"\u534e\u6587\u65b0\u9b4f":19,"\u534e\u6587\u6977\u4f53":15,"\u534e\u6587\u7425\u73c0":18,"\u534e\u6587\u7ec6\u9ed1":18,"\u534e\u6587\u884c\u6977":16,"\u534e\u6587\u96b6\u4e66":14,"\u5b8b\u4f53":16,"\u5e7c\u5706":16,"\u5fae\u8f6f\u96c5\u9ed1":19,"\u5fae\u8f6f\u96c5\u9ed1 Light":18,"\u65b0\u5b8b\u4f53":16,"\u65b9\u6b63\u59da\u4f53":16,"\u65b9\u6b63\u8212\u4f53":18,"\u6977\u4f53":16,"\u7b49\u7ebf":17,"\u7b49\u7ebf Light":16,"\u96b6\u4e66":16,"\u9ed1\u4f53":16,"\u6e38\u30b4\u30b7\u30c3\u30af":18,"\uff2d\uff33 \uff30\u660e\u671d":16,'"\uff2d\uff33 \uff30\u30b4\u30b7\u30c3\u30af"':16,"\u30e1\u30a4\u30ea\u30aa":20,"HG\uff7a\uff9e\uff7c\uff6f\uff78E":16,"HG\u660e\u671dB":16,"HG\uff7a\uff9e\uff7c\uff6f\uff78M":16}},f.unknownFontMaxDigitWidthMap={},B.pixelToPoint=function(t){return 72*t/96},B.pointToPixel=function(t,n){return pe(96*t/72,n=void 0===n?2:n)},B.setMaxDigitWidth=function(t){var n,e,i,r,o,a,u,s,c,n=0;try{if((e=$t("span")).style.font=t,i=e.style.fontSize,r=void 0,-1!==i.indexOf("px")?r=Math.round(B.pixelToPoint(parseFloat(i))):-1!==i.indexOf("pt")&&(r=Math.round(parseFloat(i))),!isNaN(r)&&r||(r=Math.round(B.pixelToPoint(parseFloat(t.match(/(\d|\.)+/)+"")))),(o=e.style.fontFamily)||t.split(" ").forEach(function(t){"normal"!==t&&"italic"!==t&&"bold"!==t&&-1===t.indexOf("px")&&-1===t.indexOf("pt")&&isNaN(+t)&&(o=t)}),o&&'"'===o[0]&&(o=o.slice(1,o.length-1)),f.unknownFontMaxDigitWidthMap[r]&&f.unknownFontMaxDigitWidthMap[r][o]?n=f.unknownFontMaxDigitWidthMap[r][o]:Yt[r]&&Yt[r][o]&&(n=Yt[r][o]),0<n)return void(B.maxDigitWidth=n)}catch(t){}for(a="0123456789",u=0,(s=E()).font=t,c=0;c<a.length;c++)n<(u=s.measureText(a.charAt(c)).width)&&(n=u);return B.maxDigitWidth=0<n?n:B.maxDigitWidth},B.defaultColumnWidthToPixel=function(t){var n,t,n=2*Math.ceil(B.maxDigitWidth/4)+1,t=B.columnWidthToPixel(t)+n;return 8*Math.ceil(t/8)},B.columnWidthToPixel=function(t){return 0===t?0:Math.floor(Math.floor(256*t)/256*B.maxDigitWidth+.5)},B.pixelToColumnWidth=function(t){var n,t;return 0===t?0:(n=B.maxDigitWidth,t=Math.floor((t-5)/n*100+.5)/100,Math.floor((t*n+5)/n*256)/256)},B.maxDigitWidth=7,f.SJSColumnWidthHelper=B,L.builtInNumberFomrat=function(){return 0===(L.Mh=L.Mh?L.Mh:{count:0}).count&&L.initBuintNumberFormat(),L.Mh},L.languageIndepedentNumberFormat=function(){return 0===(L.Ch=L.Ch?L.Ch:{count:0}).count&&L.initLanguageIndepedentNumberFormat(),L.Ch},L.formatCodeTable=function(){return L.Sh=L.Sh?L.Sh:[]},L.customNumberFormat=function(){return L.Th=L.Th?L.Th:{count:0}},L.getCultureInfo=function(){var t,n,t=be(),n;return t&&t.GC&&t.GC.Spread&&t.GC.Spread.Common&&be().GC.Spread.Common.CultureManager.getCultureInfo()||Qt()},L.initBuintNumberFormat=function(){var t,n,n,e,i,r,o,a,t=L.Mh;if(t[0]="General",t[1]="0",t[2]="0.00",t[3]="#,##0",t[4]="#,##0.00",t[9]="0%",t[10]="0.00%",t[11]="0.00E+00",t[12]="# ?/?",t[13]="# ??/??",t[14]="m/d/yyyy",t[15]="d-mmm-yy",t[16]="d-mmm",t[17]="mmm-yy",t[18]="h:mm AM/PM",t[19]="h:mm:ss AM/PM",t[20]="h:mm",t[21]="h:mm:ss",t[22]="m/d/yyyy h:mm",t[37]="#,##0 ;(#,##0)",t[38]="#,##0 ;[Red](#,##0)",t[39]="#,##0.00;(#,##0.00)",t[40]="#,##0.00;[Red](#,##0.00)",t[45]="mm:ss",t[46]="[h]:mm:ss",t[47]="mm:ss.0",t[48]="##0.0E+0",t[49]="@",t.count=49,Qt())if("zh-cn"===(n=Qt()))t[14]="yyyy/m/d",t[17]="mmm-yy",t[22]="yyyy/m/d h:mm",t[27]='yyyy"\u5e74"m"\u6708"',t[28]='m"\u6708"d"\u65e5"',t[29]='m"\u6708"d"\u65e5"',t[30]="m-d-yy",t[31]='yyyy"\u5e74"m"\u6708"d"\u65e5"',t[32]='h"\u65f6"mm"\u5206"',t[33]='h"\u65f6"mm"\u5206"ss"\u79d2"',t[34]='\u4e0a\u5348/\u4e0b\u5348h"\u65f6"mm"\u5206"',t[35]='\u4e0a\u5348/\u4e0b\u5348h"\u65f6"mm"\u5206"ss"\u79d2"',t[36]='yyyy"\u5e74"m"\u6708"',t[39]="#,##0.00;-#,##0.00",t[40]="#,##0.00;[Red]-#,##0.00",t[50]='yyyy"\u5e74"m"\u6708"',t[51]='m"\u6708"d"\u65e5"',t[52]='yyyy"\u5e74"m"\u6708"',t[53]='m"\u6708"d"\u65e5"',t[54]='m"\u6708"d"\u65e5"',t[55]='\u4e0a\u5348/\u4e0b\u5348h"\u65f6"mm"\u5206"',t[56]='\u4e0a\u5348/\u4e0b\u5348h"\u65f6"mm"\u5206"ss"\u79d2"',t[57]='yyyy"\u5e74"m"\u6708"',t[58]='m"\u6708"d"\u65e5"',t.count=58;else if("ja-jp"===n)t[14]="yyyy/m/d",t[15]="dd-mmm-yy",t[16]="dd-mmm",t[17]="mmm-yy",t[22]="yyyy/mm/dd h:mm",t[27]="[$-411]ge.m.d",t[28]='[$-411]ggge"\u5e74"m"\u6708"d"',t[29]='[$-411]ggge"\u5e74"m"\u6708"d"',t[30]="m/d/yy",t[31]='yyyy"\u5e74"m"\u6708"d"\u65e5"',t[32]='h"\u6642"mm"\u5206"',t[33]='h"\u6642"mm"\u5206"ss"\u79d2"',t[34]='yyyy"\u5e74"m"\u6708"',t[35]='m"\u6708"d"\u65e5"',t[36]="[$-411]ge.m.d",t[38]="#,##0;[Red]-#,##0",t[39]="#,##0.00;-#,##0.00",t[40]="#,##0.00;[Red]-#,##0.00",t[50]="[$-411]ge.m.d",t[51]='[$-411]ggge"\u5e74"m"\u6708"d"\u65e5"',t[52]='yyyy"\u5e74"m"\u6708"',t[53]='m"\u6708"d"\u65e5"',t[54]='[$-411]ggge"\u5e74"m"\u6708"d"\u65e5"',t[55]='yyyy"\u5e74"m"\u6708"',t[56]='m"\u6708"d"\u65e5"',t[57]="[$-411]ge.m.d",t[58]='[$-411]ggge"\u5e74"m"\u6708"d"\u65e5"',t.count=58;else if(e=(n=L.getCultureInfo())&&n.LocalNumberFormat,!A(e)&&!Array.isArray(e)&&"object"==typeof e){for(i in e)isNaN(Number(i))||(r=e[i],F.Util.uo(r)&&(t[i]=e[i]));for(i in o=0,t)isNaN(Number(i))||o<(a=Number(i))&&(o=a);t.count=o}},L.initLanguageIndepedentNumberFormat=function(){var t=L.Ch;t[27]="m/d/yyyy",t[28]="m/d/yyyy",t[29]="m/d/yyyy",t[30]="m/d/yyyy",t[31]="m/d/yyyy",t[32]="h:mm:ss",t[33]="h:mm:ss",t[34]="m/d/yyyy",t[35]="m/d/yyyy",t[36]="m/d/yyyy",t[50]="m/d/yyyy",t[51]="m/d/yyyy",t[52]="m/d/yyyy",t[53]="m/d/yyyy",t[54]="m/d/yyyy",t[55]="m/d/yyyy",t[56]="m/d/yyyy",t[57]="m/d/yyyy",t[58]="m/d/yyyy"},L.getFormatCode=function(t){var n,e,i,r,t,o,t,n=L.builtInNumberFomrat(),e=L.customNumberFormat(),i=L.languageIndepedentNumberFormat(),r=t.numberFormatIndex;return t.numberFormat?(o=(t=t.numberFormat).numberFormatId,t=t.numberFormatCode,n[o]&&n[o]!==t?n[o]=t:(e[t]||(e[t]=o,e.count++),t)):n[r]||i[r]||"General"},L.getFormatId=function(t){var n,e,i,r,o,a,u,s,n=L.Ah();if(n[t])return n[t];if(i=L.builtInNumberFomrat())for(r in i)if(i[r]===t)return e={isBuiltIn:!0,id:parseInt(r,10)},n[t]=e;if((o=L.customNumberFormat())&&o[t])return e={isBuiltIn:!1,id:o[t]},n[t]=e;if((a=0)<o.count){for(s in u=0,o)o[s]>u&&(u=o[s]);a=u}return a=Math.max(L.Ih,a)+1,L.Ih++,e={isBuiltIn:!1,id:o[t]=a}},L.Ah=function(){return L.xh=L.xh?L.xh:{}},L.Sh=null,L.xh=null,L.Mh={count:0},L.Ch={count:0},L.Th={count:0},L.Ih=170,f.ExtendedNumberFormatHelper=L,Qt=function(){var t=be();return t&&t.gcCultureObj},ye.prototype.equals=function(t){var n=this;return n===t||!!t&&n.numberFormatId===t.numberFormatId&&n.numberFormatCode===t.numberFormatCode},ye.prototype.compose=function(t){var n=this;n.numberFormatId===m&&(n.numberFormatId=t.numberFormatId),n.numberFormatCode===m&&(n.numberFormatCode=t.numberFormatCode)},ye.prototype.clone=function(){var t=this;return new ye(t.numberFormatId,t.numberFormatCode)},f.ExcelNumerFormat=ye,f.AL=Me},"./dist/core/util/crypto.js":function(t,n){"use strict";var s,c,p,e,f,nt,i,r,o,l,a,u;function h(t,n){n?(i[0]=i[1]=i[2]=i[3]=i[4]=i[5]=i[6]=i[7]=i[8]=i[9]=i[10]=i[11]=i[12]=i[13]=i[14]=i[15]=i[16]=i[17]=i[18]=i[19]=i[20]=i[21]=i[22]=i[23]=i[24]=i[25]=i[26]=i[27]=i[28]=i[29]=i[30]=i[31]=i[32]=0,this.blocks=i):this.blocks=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],384===t?(this.h0h=3418070365,this.h0l=3238371032,this.h1h=1654270250,this.h1l=914150663,this.h2h=2438529370,this.h2l=812702999,this.h3h=355462360,this.h3l=4144912697,this.h4h=1731405415,this.h4l=4290775857,this.h5h=2394180231,this.h5l=1750603025,this.h6h=3675008525,this.h6l=1694076839,this.h7h=1203062813,this.h7l=3204075428):256===t?(this.h0h=573645204,this.h0l=4230739756,this.h1h=2673172387,this.h1l=3360449730,this.h2h=596883563,this.h2l=1867755857,this.h3h=2520282905,this.h3l=1497426621,this.h4h=2519219938,this.h4l=2827943907,this.h5h=3193839141,this.h5l=1401305490,this.h6h=721525244,this.h6l=746961066,this.h7h=246885852,this.h7l=2177182882):224===t?(this.h0h=2352822216,this.h0l=424955298,this.h1h=1944164710,this.h1l=2312950998,this.h2h=502970286,this.h2l=855612546,this.h3h=1738396948,this.h3l=1479516111,this.h4h=258812777,this.h4l=2077511080,this.h5h=2011393907,this.h5l=79989058,this.h6h=1067287976,this.h6l=1780299464,this.h7h=286451373,this.h7l=2446758561):(this.h0h=1779033703,this.h0l=4089235720,this.h1h=3144134277,this.h1l=2227873595,this.h2h=1013904242,this.h2l=4271175723,this.h3h=2773480762,this.h3l=1595750129,this.h4h=1359893119,this.h4l=2917565137,this.h5h=2600822924,this.h5l=725511199,this.h6h=528734635,this.h6l=4215389547,this.h7h=1541459225,this.h7l=327033209),this.bits=t,this.block=this.start=this.bytes=this.hBytes=0,this.finalized=this.hashed=!1}for(Object.defineProperty(n,"__esModule",{value:!0}),n.Qoe=void 0,s="input is invalid type",c="finalize already called",p="0123456789abcdef".split(""),e=[-2147483648,8388608,32768,128],f=[24,16,8,0],nt=[1116352408,3609767458,1899447441,602891725,3049323471,3964484399,3921009573,2173295548,961987163,4081628472,1508970993,3053834265,2453635748,2937671579,2870763221,3664609560,3624381080,2734883394,310598401,1164996542,607225278,1323610764,1426881987,3590304994,1925078388,4068182383,2162078206,991336113,2614888103,633803317,3248222580,3479774868,3835390401,2666613458,4022224774,944711139,264347078,2341262773,604807628,2007800933,770255983,1495990901,1249150122,1856431235,1555081692,3175218132,1996064986,2198950837,2554220882,3999719339,2821834349,766784016,2952996808,2566594879,3210313671,3203337956,3336571891,1034457026,3584528711,2466948901,113926993,3758326383,338241895,168717936,666307205,1188179964,773529912,1546045734,1294757372,1522805485,1396182291,2643833823,1695183700,2343527390,1986661051,1014477480,2177026350,1206759142,2456956037,344077627,2730485921,1290863460,2820302411,3158454273,3259730800,3505952657,3345764771,106217008,3516065817,3606008344,3600352804,1432725776,4094571909,1467031594,275423344,851169720,430227734,3100823752,506948616,1363258195,659060556,3750685593,883997877,3785050280,958139571,3318307427,1322822218,3812723403,1537002063,2003034995,1747873779,3602036899,1955562222,1575990012,2024104815,1125592928,2227730452,2716904306,2361852424,442776044,2428436474,593698344,2756734187,3733110249,3204031479,2999351573,3329325298,3815920427,3391569614,3928383900,3515267271,566280711,3940187606,3454069534,4118630271,4000239992,116418474,1914138554,174292421,2731055270,289380356,3203993006,460393269,320620315,685471733,587496836,852142971,1086792851,1017036298,365543100,1126000580,2618297676,1288033470,3409855158,1501505948,4234509866,1607167915,987167468,1816402316,1246189591],i=[],h.prototype.update=function(t){var n,e,i,r,o,a,u;if(this.finalized)throw new Error(c);if("string"!=(e=typeof t)){if("object"!=e)throw new Error(s);if(null===t)throw new Error(s);if(!Array.isArray(t)&&!ArrayBuffer.isView(t))throw new Error(s);n=!0}for(r=0,a=t.length,u=this.blocks;r<a;){if(this.hashed&&(this.hashed=!1,u[0]=this.block,u[1]=u[2]=u[3]=u[4]=u[5]=u[6]=u[7]=u[8]=u[9]=u[10]=u[11]=u[12]=u[13]=u[14]=u[15]=u[16]=u[17]=u[18]=u[19]=u[20]=u[21]=u[22]=u[23]=u[24]=u[25]=u[26]=u[27]=u[28]=u[29]=u[30]=u[31]=u[32]=0),n)for(o=this.start;r<a&&o<128;++r)u[o>>2]|=t[r]<<f[3&o++];else for(o=this.start;r<a&&o<128;++r)(i=t.charCodeAt(r))<128?u[o>>2]|=i<<f[3&o++]:(i<2048?u[o>>2]|=(192|i>>6)<<f[3&o++]:(i<55296||57344<=i?u[o>>2]|=(224|i>>12)<<f[3&o++]:(i=65536+((1023&i)<<10|1023&t.charCodeAt(++r)),u[o>>2]|=(240|i>>18)<<f[3&o++],u[o>>2]|=(128|i>>12&63)<<f[3&o++]),u[o>>2]|=(128|i>>6&63)<<f[3&o++]),u[o>>2]|=(128|63&i)<<f[3&o++]);this.lastByteIndex=o,this.bytes+=o-this.start,128<=o?(this.block=u[32],this.start=o-128,this.hash(),this.hashed=!0):this.start=o}return 4294967295<this.bytes&&(this.hBytes+=this.bytes/4294967296<<0,this.bytes=this.bytes%4294967296),this},h.prototype.finalize=function(){var t,n;this.finalized||(this.finalized=!0,t=this.blocks,n=this.lastByteIndex,t[32]=this.block,t[n>>2]|=e[3&n],this.block=t[32],112<=n&&(this.hashed||this.hash(),t[0]=this.block,t[1]=t[2]=t[3]=t[4]=t[5]=t[6]=t[7]=t[8]=t[9]=t[10]=t[11]=t[12]=t[13]=t[14]=t[15]=t[16]=t[17]=t[18]=t[19]=t[20]=t[21]=t[22]=t[23]=t[24]=t[25]=t[26]=t[27]=t[28]=t[29]=t[30]=t[31]=t[32]=0),t[30]=this.hBytes<<3|this.bytes>>>29,t[31]=this.bytes<<3,this.hash())},h.prototype.hash=function(){for(var B,L,F,P,G,U,H,z,V,Y,Z,W,Q,J,K,X,t,n,e,i,r,o,a,u,s,c,f,l,q,f,l,q,$,tt,h,d,v,m,g,p,b,y,w,M,C,S,T,A,I,x,N,k,D,_,E,j,O,R,B=this.h0h,L=this.h0l,F=this.h1h,P=this.h1l,G=this.h2h,U=this.h2l,H=this.h3h,z=this.h3l,V=this.h4h,Y=this.h4l,Z=this.h5h,W=this.h5l,Q=this.h6h,J=this.h6l,K=this.h7h,X=this.h7l,t=this.blocks,n=32;n<160;n+=2)e=((v=t[n-30])>>>1|(m=t[n-29])<<31)^(v>>>8|m<<24)^v>>>7,i=(m>>>1|v<<31)^(m>>>8|v<<24)^(m>>>7|v<<25),r=((v=t[n-4])>>>19|(m=t[n-3])<<13)^(m>>>29|v<<3)^v>>>6,o=(m>>>19|v<<13)^(v>>>29|m<<3)^(m>>>6|v<<26),v=t[n-32],m=t[n-31],g=t[n-14],p=t[n-13],t[n]=(c=(g>>>16)+(v>>>16)+(e>>>16)+(r>>>16)+((s=(65535&g)+(65535&v)+(65535&e)+(65535&r)+((u=(p>>>16)+(m>>>16)+(i>>>16)+(o>>>16)+((a=(65535&p)+(65535&m)+(65535&i)+(65535&o))>>>16))>>>16))>>>16))<<16|65535&s,t[n+1]=u<<16|65535&a;for(w=B,M=L,I=H,x=z,N=V,k=Y,D=Z,_=W,E=Q,j=J,O=K,R=X,$=(C=F)&(T=G),tt=(S=P)&(A=U),n=0;n<160;n+=8)v=t[n],m=t[n+1],v=(c=((g=nt[n])>>>16)+(v>>>16)+((b=N&D^~N&E)>>>16)+((r=(N>>>14|k<<18)^(N>>>18|k<<14)^(k>>>9|N<<23))>>>16)+(O>>>16)+((s=(65535&g)+(65535&v)+(65535&b)+(65535&r)+(65535&O)+((u=((p=nt[n+1])>>>16)+(m>>>16)+((y=k&_^~k&j)>>>16)+((o=(k>>>14|N<<18)^(k>>>18|N<<14)^(N>>>9|k<<23))>>>16)+(R>>>16)+((a=(65535&p)+(65535&m)+(65535&y)+(65535&o)+(65535&R))>>>16))>>>16))>>>16))<<16|65535&s,m=u<<16|65535&a,g=(c=((h=(f=w&C)^w&T^$)>>>16)+((e=(w>>>28|M<<4)^(M>>>2|w<<30)^(M>>>7|w<<25))>>>16)+((s=(65535&h)+(65535&e)+((u=((d=(l=M&S)^M&A^tt)>>>16)+((i=(M>>>28|w<<4)^(w>>>2|M<<30)^(w>>>7|M<<25))>>>16)+((a=(65535&d)+(65535&i))>>>16))>>>16))>>>16))<<16|65535&s,p=u<<16|65535&a,O=(c=(I>>>16)+(v>>>16)+((s=(65535&I)+(65535&v)+((u=(x>>>16)+(m>>>16)+((a=(65535&x)+(65535&m))>>>16))>>>16))>>>16))<<16|65535&s,R=u<<16|65535&a,I=(c=(g>>>16)+(v>>>16)+((s=(65535&g)+(65535&v)+((u=(p>>>16)+(m>>>16)+((a=(65535&p)+(65535&m))>>>16))>>>16))>>>16))<<16|65535&s,x=u<<16|65535&a,v=t[n+2],m=t[n+3],v=(c=((g=nt[n+2])>>>16)+(v>>>16)+((b=O&N^~O&D)>>>16)+((r=(O>>>14|R<<18)^(O>>>18|R<<14)^(R>>>9|O<<23))>>>16)+(E>>>16)+((s=(65535&g)+(65535&v)+(65535&b)+(65535&r)+(65535&E)+((u=((p=nt[n+3])>>>16)+(m>>>16)+((y=R&k^~R&_)>>>16)+((o=(R>>>14|O<<18)^(R>>>18|O<<14)^(O>>>9|R<<23))>>>16)+(j>>>16)+((a=(65535&p)+(65535&m)+(65535&y)+(65535&o)+(65535&j))>>>16))>>>16))>>>16))<<16|65535&s,m=u<<16|65535&a,g=(c=((h=(q=I&w)^I&C^f)>>>16)+((e=(I>>>28|x<<4)^(x>>>2|I<<30)^(x>>>7|I<<25))>>>16)+((s=(65535&h)+(65535&e)+((u=((d=(f=x&M)^x&S^l)>>>16)+((i=(x>>>28|I<<4)^(I>>>2|x<<30)^(I>>>7|x<<25))>>>16)+((a=(65535&d)+(65535&i))>>>16))>>>16))>>>16))<<16|65535&s,p=u<<16|65535&a,E=(c=(T>>>16)+(v>>>16)+((s=(65535&T)+(65535&v)+((u=(A>>>16)+(m>>>16)+((a=(65535&A)+(65535&m))>>>16))>>>16))>>>16))<<16|65535&s,j=u<<16|65535&a,T=(c=(g>>>16)+(v>>>16)+((s=(65535&g)+(65535&v)+((u=(p>>>16)+(m>>>16)+((a=(65535&p)+(65535&m))>>>16))>>>16))>>>16))<<16|65535&s,A=u<<16|65535&a,v=t[n+4],m=t[n+5],v=(c=((g=nt[n+4])>>>16)+(v>>>16)+((b=E&O^~E&N)>>>16)+((r=(E>>>14|j<<18)^(E>>>18|j<<14)^(j>>>9|E<<23))>>>16)+(D>>>16)+((s=(65535&g)+(65535&v)+(65535&b)+(65535&r)+(65535&D)+((u=((p=nt[n+5])>>>16)+(m>>>16)+((y=j&R^~j&k)>>>16)+((o=(j>>>14|E<<18)^(j>>>18|E<<14)^(E>>>9|j<<23))>>>16)+(_>>>16)+((a=(65535&p)+(65535&m)+(65535&y)+(65535&o)+(65535&_))>>>16))>>>16))>>>16))<<16|65535&s,m=u<<16|65535&a,g=(c=((h=(l=T&I)^T&w^q)>>>16)+((e=(T>>>28|A<<4)^(A>>>2|T<<30)^(A>>>7|T<<25))>>>16)+((s=(65535&h)+(65535&e)+((u=((d=(q=A&x)^A&M^f)>>>16)+((i=(A>>>28|T<<4)^(T>>>2|A<<30)^(T>>>7|A<<25))>>>16)+((a=(65535&d)+(65535&i))>>>16))>>>16))>>>16))<<16|65535&s,p=u<<16|65535&a,D=(c=(C>>>16)+(v>>>16)+((s=(65535&C)+(65535&v)+((u=(S>>>16)+(m>>>16)+((a=(65535&S)+(65535&m))>>>16))>>>16))>>>16))<<16|65535&s,_=u<<16|65535&a,C=(c=(g>>>16)+(v>>>16)+((s=(65535&g)+(65535&v)+((u=(p>>>16)+(m>>>16)+((a=(65535&p)+(65535&m))>>>16))>>>16))>>>16))<<16|65535&s,S=u<<16|65535&a,v=t[n+6],m=t[n+7],v=(c=((g=nt[n+6])>>>16)+(v>>>16)+((b=D&E^~D&O)>>>16)+((r=(D>>>14|_<<18)^(D>>>18|_<<14)^(_>>>9|D<<23))>>>16)+(N>>>16)+((s=(65535&g)+(65535&v)+(65535&b)+(65535&r)+(65535&N)+((u=((p=nt[n+7])>>>16)+(m>>>16)+((y=_&j^~_&R)>>>16)+((o=(_>>>14|D<<18)^(_>>>18|D<<14)^(D>>>9|_<<23))>>>16)+(k>>>16)+((a=(65535&p)+(65535&m)+(65535&y)+(65535&o)+(65535&k))>>>16))>>>16))>>>16))<<16|65535&s,m=u<<16|65535&a,g=(c=((h=($=C&T)^C&I^l)>>>16)+((e=(C>>>28|S<<4)^(S>>>2|C<<30)^(S>>>7|C<<25))>>>16)+((s=(65535&h)+(65535&e)+((u=((d=(tt=S&A)^S&x^q)>>>16)+((i=(S>>>28|C<<4)^(C>>>2|S<<30)^(C>>>7|S<<25))>>>16)+((a=(65535&d)+(65535&i))>>>16))>>>16))>>>16))<<16|65535&s,p=u<<16|65535&a,N=(c=(w>>>16)+(v>>>16)+((s=(65535&w)+(65535&v)+((u=(M>>>16)+(m>>>16)+((a=(65535&M)+(65535&m))>>>16))>>>16))>>>16))<<16|65535&s,k=u<<16|65535&a,w=(c=(g>>>16)+(v>>>16)+((s=(65535&g)+(65535&v)+((u=(p>>>16)+(m>>>16)+((a=(65535&p)+(65535&m))>>>16))>>>16))>>>16))<<16|65535&s,M=u<<16|65535&a;this.h0h=(c=(B>>>16)+(w>>>16)+((s=(65535&B)+(65535&w)+((u=(L>>>16)+(M>>>16)+((a=(65535&L)+(65535&M))>>>16))>>>16))>>>16))<<16|65535&s,this.h0l=u<<16|65535&a,this.h1h=(c=(F>>>16)+(C>>>16)+((s=(65535&F)+(65535&C)+((u=(P>>>16)+(S>>>16)+((a=(65535&P)+(65535&S))>>>16))>>>16))>>>16))<<16|65535&s,this.h1l=u<<16|65535&a,this.h2h=(c=(G>>>16)+(T>>>16)+((s=(65535&G)+(65535&T)+((u=(U>>>16)+(A>>>16)+((a=(65535&U)+(65535&A))>>>16))>>>16))>>>16))<<16|65535&s,this.h2l=u<<16|65535&a,this.h3h=(c=(H>>>16)+(I>>>16)+((s=(65535&H)+(65535&I)+((u=(z>>>16)+(x>>>16)+((a=(65535&z)+(65535&x))>>>16))>>>16))>>>16))<<16|65535&s,this.h3l=u<<16|65535&a,this.h4h=(c=(V>>>16)+(N>>>16)+((s=(65535&V)+(65535&N)+((u=(Y>>>16)+(k>>>16)+((a=(65535&Y)+(65535&k))>>>16))>>>16))>>>16))<<16|65535&s,this.h4l=u<<16|65535&a,this.h5h=(c=(Z>>>16)+(D>>>16)+((s=(65535&Z)+(65535&D)+((u=(W>>>16)+(_>>>16)+((a=(65535&W)+(65535&_))>>>16))>>>16))>>>16))<<16|65535&s,this.h5l=u<<16|65535&a,this.h6h=(c=(Q>>>16)+(E>>>16)+((s=(65535&Q)+(65535&E)+((u=(J>>>16)+(j>>>16)+((a=(65535&J)+(65535&j))>>>16))>>>16))>>>16))<<16|65535&s,this.h6l=u<<16|65535&a,this.h7h=(c=(K>>>16)+(O>>>16)+((s=(65535&K)+(65535&O)+((u=(X>>>16)+(R>>>16)+((a=(65535&X)+(65535&R))>>>16))>>>16))>>>16))<<16|65535&s,this.h7l=u<<16|65535&a},h.prototype.hex=function(){var t,n,e,i,r,o,a,u,s,c,f,l,h,d,v,m,g,t;return this.finalize(),t=this.h0h,n=this.h0l,e=this.h1h,i=this.h1l,r=this.h2h,o=this.h2l,a=this.h3h,u=this.h3l,s=this.h4h,c=this.h4l,f=this.h5h,l=this.h5l,h=this.h6h,d=this.h6l,v=this.h7h,m=this.h7l,g=this.bits,t=p[t>>28&15]+p[t>>24&15]+p[t>>20&15]+p[t>>16&15]+p[t>>12&15]+p[t>>8&15]+p[t>>4&15]+p[15&t]+p[n>>28&15]+p[n>>24&15]+p[n>>20&15]+p[n>>16&15]+p[n>>12&15]+p[n>>8&15]+p[n>>4&15]+p[15&n]+p[e>>28&15]+p[e>>24&15]+p[e>>20&15]+p[e>>16&15]+p[e>>12&15]+p[e>>8&15]+p[e>>4&15]+p[15&e]+p[i>>28&15]+p[i>>24&15]+p[i>>20&15]+p[i>>16&15]+p[i>>12&15]+p[i>>8&15]+p[i>>4&15]+p[15&i]+p[r>>28&15]+p[r>>24&15]+p[r>>20&15]+p[r>>16&15]+p[r>>12&15]+p[r>>8&15]+p[r>>4&15]+p[15&r]+p[o>>28&15]+p[o>>24&15]+p[o>>20&15]+p[o>>16&15]+p[o>>12&15]+p[o>>8&15]+p[o>>4&15]+p[15&o]+p[a>>28&15]+p[a>>24&15]+p[a>>20&15]+p[a>>16&15]+p[a>>12&15]+p[a>>8&15]+p[a>>4&15]+p[15&a],256<=g&&(t+=p[u>>28&15]+p[u>>24&15]+p[u>>20&15]+p[u>>16&15]+p[u>>12&15]+p[u>>8&15]+p[u>>4&15]+p[15&u]),384<=g&&(t+=p[s>>28&15]+p[s>>24&15]+p[s>>20&15]+p[s>>16&15]+p[s>>12&15]+p[s>>8&15]+p[s>>4&15]+p[15&s]+p[c>>28&15]+p[c>>24&15]+p[c>>20&15]+p[c>>16&15]+p[c>>12&15]+p[c>>8&15]+p[c>>4&15]+p[15&c]+p[f>>28&15]+p[f>>24&15]+p[f>>20&15]+p[f>>16&15]+p[f>>12&15]+p[f>>8&15]+p[f>>4&15]+p[15&f]+p[l>>28&15]+p[l>>24&15]+p[l>>20&15]+p[l>>16&15]+p[l>>12&15]+p[l>>8&15]+p[l>>4&15]+p[15&l]),512===g&&(t+=p[h>>28&15]+p[h>>24&15]+p[h>>20&15]+p[h>>16&15]+p[h>>12&15]+p[h>>8&15]+p[h>>4&15]+p[15&h]+p[d>>28&15]+p[d>>24&15]+p[d>>20&15]+p[d>>16&15]+p[d>>12&15]+p[d>>8&15]+p[d>>4&15]+p[15&d]+p[v>>28&15]+p[v>>24&15]+p[v>>20&15]+p[v>>16&15]+p[v>>12&15]+p[v>>8&15]+p[v>>4&15]+p[15&v]+p[m>>28&15]+p[m>>24&15]+p[m>>20&15]+p[m>>16&15]+p[m>>12&15]+p[m>>8&15]+p[m>>4&15]+p[15&m]),t},h.prototype.digest=function(){var t,n,e,i,r,o,a,u,s,c,f,l,h,d,v,m,n,t;return this.finalize(),t=this.h0h,n=this.h0l,e=this.h1h,i=this.h1l,r=this.h2h,o=this.h2l,a=this.h3h,u=this.h3l,s=this.h4h,c=this.h4l,f=this.h5h,l=this.h5l,h=this.h6h,d=this.h6l,v=this.h7h,m=this.h7l,t=[t>>24&255,t>>16&255,t>>8&255,255&t,n>>24&255,n>>16&255,n>>8&255,255&n,e>>24&255,e>>16&255,e>>8&255,255&e,i>>24&255,i>>16&255,i>>8&255,255&i,r>>24&255,r>>16&255,r>>8&255,255&r,o>>24&255,o>>16&255,o>>8&255,255&o,a>>24&255,a>>16&255,a>>8&255,255&a],256<=(n=this.bits)&&t.push(u>>24&255,u>>16&255,u>>8&255,255&u),384<=n&&t.push(s>>24&255,s>>16&255,s>>8&255,255&s,c>>24&255,c>>16&255,c>>8&255,255&c,f>>24&255,f>>16&255,f>>8&255,255&f,l>>24&255,l>>16&255,l>>8&255,255&l),512===n&&t.push(h>>24&255,h>>16&255,h>>8&255,255&h,d>>24&255,d>>16&255,d>>8&255,255&d,v>>24&255,v>>16&255,v>>8&255,255&v,m>>24&255,m>>16&255,m>>8&255,255&m),t},h.prototype.arrayBuffer=function(){var t,n,e;return this.finalize(),t=this.bits,n=new ArrayBuffer(t/8),(e=new DataView(n)).setUint32(0,this.h0h),e.setUint32(4,this.h0l),e.setUint32(8,this.h1h),e.setUint32(12,this.h1l),e.setUint32(16,this.h2h),e.setUint32(20,this.h2l),e.setUint32(24,this.h3h),256<=t&&e.setUint32(28,this.h3l),384<=t&&(e.setUint32(32,this.h4h),e.setUint32(36,this.h4l),e.setUint32(40,this.h5h),e.setUint32(44,this.h5l)),512===t&&(e.setUint32(48,this.h6h),e.setUint32(52,this.h6l),e.setUint32(56,this.h7h),e.setUint32(60,this.h7l)),n},h.prototype.clone=function(){var t=new h(this.bits,!1);return this.copyTo(t),t},h.prototype.copyTo=function(t){for(var n,e=["h0h","h0l","h1h","h1l","h2h","h2l","h3h","h3l","h4h","h4l","h5h","h5l","h6h","h6l","h7h","h7l","start","bytes","hBytes","finalized","hashed","lastByteIndex"],n=0;n<e.length;++n)t[e[n]]=this[e[n]];for(n=0;n<this.blocks.length;++n)t.blocks[n]=this.blocks[n]},r=h,o="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",l=new Uint8Array(255),a=0;a<o.length;a++)l[o.charCodeAt(a)]=a;function d(){}d.Koe=function(t){var n=new Uint8Array(4);return n[0]=255&t,n[1]=(65280&t)>>8,n[2]=(16711680&t)>>16,n[3]=(4278190080&t)>>24,n},d.Joe=function(t){var n,e,i,r,o,a,u,s,n,c,n=.75*t.length,e=t.length,r=0;for("="===t[t.length-1]&&(n--,"="===t[t.length-2])&&n--,n=new ArrayBuffer(n),c=new Uint8Array(n),i=0;i<e;i+=4)o=l[t.charCodeAt(i)],a=l[t.charCodeAt(i+1)],u=l[t.charCodeAt(i+2)],s=l[t.charCodeAt(i+3)],c[r++]=o<<2|a>>4,c[r++]=(15&a)<<4|u>>2,c[r++]=(3&u)<<6|63&s;return new Uint8Array(n)},d.Xoe=function(t){for(var n,e=t.length,i="",n=0;n<e;n+=3)i=(i=(i=(i+=o[t[n]>>2])+o[(3&t[n])<<4|t[n+1]>>4])+o[(15&t[n+1])<<2|t[n+2]>>6])+o[63&t[n+2]];return e%3==2?i=i.substring(0,i.length-1)+"=":e%3==1&&(i=i.substring(0,i.length-2)+"=="),i},d.qoe=function(t){for(var n,e,n=new DataView(new ArrayBuffer(2*t.length)),e=0;e<t.length;e++)n.setUint16(2*e,t.charCodeAt(e),!0);return new Uint8Array(n.buffer)},d.$oe=function(t,n){var e,i,e=t.length,i=new Uint8Array(e+n.length);return i.set(t,0),i.set(n,e),i},d.tue=function(t,n,e,i){for(var r,o,a,r,o=i(d.$oe(d.Joe(n),d.qoe(t))),a=0;a<e;a++)o=i(d.$oe(new Uint8Array(o),d.Koe(a)));return o},d.nue=function(t,n,e,i){return d.Xoe(new Uint8Array(d.tue(t,n,e,i)))},d.eue=function(t){var n;return new r(512,!0).update(t).arrayBuffer()},d.iue=function(){for(var t,n,t=new Uint8Array(256),n=0;n<=255;n++)t[n]=Date.now()*Math.random()+Date.now()&255;return d.Xoe(new Uint8Array(d.eue(t)).slice(0,16))},d.rue=function(t,n,e,i,r){var o;return d.nue(t,e,i,r)===n},n.Qoe=d},"./dist/core/util/domUtil.js":function(a,t,n){"use strict";var e,L,r,m,v,g,s,f,l,p,c,u,h,d,b,y,w,M,C,S,i,T,A,I,F,P,o,x,N,G,U,k,n,e,D,H;function z(t,n){var e,i;for(Array.call(this),"string"==typeof t?e=(n||f).querySelectorAll(t):t&&(e=r.Nh(t)||t instanceof HTMLCollection?t:[t]),i=0;e&&i<e.length;i++)this.push(e[i])}function V(t){for(var n,e,n=Y(t);t.parentElement;)n<(e=Y(t=t.parentElement))&&(n=e);return n}function Y(t){var t=getComputedStyle(t).zIndex;return"auto"===t||""===t?0:Number(t)}function Z(t){return k.isWindow(t)?t:9===t.nodeType&&(t.defaultView||t.parentWindow)}function W(t,n){var t=t.nodeName;return t&&t.toLowerCase()===n.toLowerCase()}function Q(t,n){return 0<="top left right bottom width height border-radius border-width border-left-width border-right-width border-top-width border-bottom-width line-height padding padding-left padding-right padding-top padding-bottom margin margin-left margin-right margin-top margin-bottom".split(" ").indexOf(t)&&isFinite(n)?(n=0<="width height".split(" ").indexOf(t)&&n<0?0:n)+"px":n}function J(t,n,e){var i,r,o,a=t.nodeType;if(t&&3!==a&&8!==a&&2!==a)return(o=1!==a)&&(r=P[n=F[n]||n]),R(e)?r&&c in r&&(i=r.get(t,n))!==g?i:t[n]:r&&u in r&&!R(i=r.set(t,e,n))?i:t[n]=e}function K(t){var n,e,n,n,n=t.nodeType;return!(n&&1!==n&&9!==n||(n=(n=t.nodeName)&&(e={embed:!0,object:"clsid:D27CDB6E-AE6D-11cf-96B8-444553540000",applet:!0})[n.toLowerCase()])&&(!0===n||t.getAttribute("classid")!==n))}function _(t){return t.replace(/^-ms-/,"ms-").replace(/-([\da-z])/gi,function(t,n){return n.toUpperCase()})}function E(t,n,e,i){if(K(t)){var t,r,o=N,a=j(n),u=t.nodeType,s=u?x:t,c=u?t[o]:t[o]&&o;if(c&&s[c]&&(i||s[c].data)||!a||!R(e))return c||(u?(t[o]=c=G,G++):c=o),s[c]||(s[c]={},u)||(s[c].toJSON=function(){}),!O(n)&&"function"!=typeof n||(i?s[c]=k.extend(s[c],n):s[c].data=k.extend(s[c].data,n)),t=s[c],i||(t.data||(t.data={}),t=t.data),R(e)||(t[_(n)]=e),a?(r=t[n])!==g&&r!==v||(r=t[_(n)]):r=t,r}}function X(t){var n;for(n in t)if(("data"!==n||!k.isEmptyObject(t[n]))&&"toJSON"!==n)return;return 1}function q(t,n,e){if(K(t)){var i,r,o,a=t.nodeType,u=a?x:t,s=a?t[N]:N;if(u[s]){if(n&&(o=e?u[s]:u[s].data)){r=(n=k.isArray(n)?n.concat(k.map(n,_)):n in o||(n=_(n))in o?[n]:n.split(" ")).length;for(i=0;i<r;i++)delete o[n[i]];if(!(e?X:k.isEmptyObject)(o))return}(e||(delete u[s].data,X(u[s])))&&(a?$([t],!0):u!==u.window?delete u[s]:u[s]=g)}}}function $(t,n){for(var e,i,r,o,a,u,s,c,f,l,h,d,v,o=0,a=N,u=x,e=t[o];e!==g&&void 0!==e;){if((n||K(e))&&(r=(i=e[a])&&u[i])){if(s=r.events)for(c in s)if(m(s,c)&&(f=s[c]))for(l in f)if(m(f,l)&&(h=f[l]))for(d=0,v=h.length;d<v;d++)B(e,c,h[d]);u[i]&&(delete u[i],delete e[a])}e=t[++o]}}function j(t){return"string"==typeof t}function O(t){return"object"==typeof t}function R(t){return typeof t==typeof v}function tt(t){var u=t;return function(t){var n,e,i,r,o,a,n=this,e="border-box"===n.css("box-sizing"),r=u?h:d,o=u?b:w,a=u?y:M;return 0===arguments.length?(i=Math.round(s(n.css(r)))||0,e&&(i-=s(n.css("padding-"+o))+s(n.css("padding-"+a))+s(n.css("border-"+o+"-"+h))+s(n.css("border-"+a+"-"+h))),i):(n.css(r,t),n)}}function nt(t){var i=t;return function(){var t,n,e,t=this,n=i?b:w,e=i?y:M;return i?t.width():t.height()+s(t.css("padding-"+n))+s(t.css("padding-"+e))}}function et(t){var o=t;return function(t){var n,e,i,r,n=o?b:w,e=o?y:M,i=this,r=o?i.innerWidth():i.innerHeight();return r+=s(i.css("border-"+n+"-"+h))+s(i.css("border-"+e+"-"+h)),t&&(r+=s(i.css("margin-"+n))+s(i.css("margin-"+e))),r}}function it(t){var e=t;return function(n){return this.forEach(function(t){t.style[I]=e?S:i,n&&n.apply(t)}),this}}function rt(t){var s=t;return function(t){var n,e,i,r,o,a,u,n="scrollLeft",e="scrollTop",i=s?n:e,r=s?"pageXOffset":"pageYOffset",o=this,a=o[0],u=Z(a);return R(t)?u?r in u?u[r]:f.documentElement[i]:a[i]:(u?u.scrollTo(s?t:k(u)[n](),s?k(u)[e]():t):a[i]=t,o)}}function B(t,n,e){t.removeEventListener(n,e)}function ot(i,r,t){var o,a,u,s,c,f,l,n,h,e,l=0,n=!1,h=!1,e=!0;if("function"!=typeof i)throw new TypeError("Expected a function");function d(t){var n,e,n=o,e=a;return o=a=void 0,l=t,s=i.apply(e,n)}function v(t,n){return setTimeout(t,n)}function m(t){clearTimeout(t)}function g(t){return l=t,c=v(y,r),n?d(t):s}function p(t){var n,e,t,n,e=t-l,t=r-(t-f);return h?Math.min(t,u-e):t}function b(t){var n,e,n=t-f,e;return void 0===f||r<=n||n<0||h&&u<=t-l}function y(){var t=Date.now();if(b(t))return w(t);c=v(y,p(t))}function w(t){return c=void 0,e&&o?d(t):(o=a=void 0,s)}function M(){void 0!==c&&m(c),o=f=a=c=void(l=0)}function C(){return void 0===c?s:w(Date.now())}function S(){return void 0!==c}function T(){for(var t,n,e,i,t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];if(i=b(e=Date.now()),o=t,a=this,f=e,i){if(void 0===c)return g(f);if(h)return c=v(y,r),d(f)}return void 0===c&&(c=v(y,r)),s}return r=+r||0,O(t)&&(n=!!t.leading,h="maxWait"in t,u=h?Math.max(+t.maxWait||0,r):u,e="trailing"in t?!!t.trailing:e),T.cancel=M,T.flush=C,T.pending=S,T}function at(t,n,e){var i,r,i=!0,r=!0;if("function"!=typeof t)throw new TypeError("Expected a function");return O(e)&&(i="leading"in e?!!e.leading:i,r="trailing"in e?!!e.trailing:r),ot(t,n,{leading:i,trailing:r,maxWait:n})}function ut(t,n,e){this.Hue=t.clientHeight,this.zue=t.clientWidth,this.use=L.mt.Tt.safari,this.sse(t,n,e)}Object.defineProperty(t,"__esModule",{value:!0}),t.Mfe=t.GC$=t.getHostMaxZIndex=void 0,e=n("Common"),L=n("./dist/core/util/common.js"),r=e.Common.lt,m=e.Common.kh,v=void 0,g=null,s=parseFloat,f=document,l="_nonamespace",p="events",c="get",u="set",h="width",d="height",b="left",y="right",w="top",M="bottom",C="hidden",S="block",i="none",T="position",A="visibility",I="display",F={tabindex:"tabIndex",readonly:"readOnly",for:"htmlFor",class:"className",maxlength:"maxLength",cellspacing:"cellSpacing",cellpadding:"cellPadding",rowspan:"rowSpan",colspan:"colSpan",usemap:"useMap",frameborder:"frameBorder",contenteditable:"contentEditable"},P={tabIndex:{get:function(t){var n,e,i,r,n=t.getAttributeNode("tabindex"),e=/^(?:input|select|textarea|button|object)$/i,i=/^(?:a|area)$/i,r=t.nodeName;return n&&n.specified?parseInt(n.value,10):e.test(r)||i.test(r)&&t.href?0:v}}},o={option:{get:function(t){var n=t.attributes.value;return!n||n.specified?t.value:t.text}},select:{get:function(t){var n,n,e=t.options,i=t.selectedIndex,r="select-one"===t.type||i<0,o=r?g:[],a=r?i+1:e.length,u=r?i:0;for(i<0&&(u=a);u<a;u++)if(((n=e[u]).selected||u===i)&&!n.disabled&&(!n.parentNode.disabled||!W(n.parentNode,"optgroup"))){if(n=k(n).val(),r)return n;o.push(n)}return o},set:function(t,n){var e,i,e=k.makeArray(n),i;return k(t).find("option").getAll().forEach(function(t){t.selected=0<=k.inArray(k(t).val(),e)}),e.length||(t.selectedIndex=-1),e}}},x={},N="$"+(""+Math.random()).replace(/\D/g,""),G=1,U={},[d,h].forEach(function(c){U[c]={get:function(t){var n,e,i,r,o,a,n,u,s,n=getComputedStyle(t),e=t.style,i=e[T],r=e[A],o=e[I],a=0===t.offsetWidth&&/^(none|table(?!-c[ea]).+)/.test(n[I]);if(a&&(e[T]="absolute",e[A]=C,e[I]=S),n=n&&n[c],a&&(e[T]=i,e[A]=r,e[I]=o),""===n){for(u=t.parentElement,s=f.body;u&&u!==s;)u=u.parentElement;u!==s&&(n=e[c])}return n}}}),k=function(t,n){return t instanceof z?t:new z(t,n)},t.GC$=k,n={get:function(t){return this[t]},getAll:function(){return this},bind:function(a,u,s){var t=this;return R(s)&&(s=u,u=v),t.forEach(function(e){var t,n,i,n,r,t,o,t=E(e,p,v,!0);t||E(e,p,t={},!0),i=(n=a.split("."))[0],r=(r=t[n=n[1]||l])||(t[n]={}),(t=function(t){R(u)||(t.data=u);var n=s.apply(e,arguments);!1===(t.result=n)&&(t.preventDefault?(t.preventDefault(),t.stopPropagation()):(t.cancelBubble=!1,t.returnValue=!1))}).original=s,(o=(o=r[i])||(r[i]=[])).push(t),e.addEventListener(i,t)}),t},unbind:function(c,f){var t=this;return t.forEach(function(t){var n,e,n,i,r,o,a,u,s,n=c.split("."),e=n[0],n=n[1]||l,i=E(t,p,v,!0),r=i&&i[n];if(f){if(r&&e&&(o=r[e]))for(u=o.length,a=0;a<u;a++)if(o[a].original===f){B(t,e,o[a]),o.splice(a,1);break}}else if(r)if(e){if(o=r[e])for(u=o.length,a=0;a<u;a++)B(t,e,o[a]);r[e]=v}else{for(s in r)if(m(r,s)&&(o=r[s]))for(u=o.length,a=0;a<u;a++)B(t,s,o[a]);i[n]=v}}),t},trigger:function(t,n){var e,i,r,o,a,u,s,c,f,l,h,d,e=this;if(t)for(i=0,r=e.length;i<r;i++)if(a=E(o=e[i],p,v,!0))for(c in s=(u=t.split("."))[0],a)if(m(a,c)&&(l=(f=a[c])&&f[s]))for(h=0,d=l.length;h<d;h++)l[h].apply(o,[{type:s},n]);return e},css:function(e,i){var t,r,n,o,a,a;function u(n,e){r.forEach(function(t){t.style[n]=Q(n,e)})}if(r=t=this,1===(n=arguments.length)){if(!O(e))return o=t[0],(a=U[e])&&c in a?a.get(o):(a=getComputedStyle(o))&&a[e];r.forEach(function(t){for(var n in e)m(e,n)&&(t.style[n]=Q(n,e[n]))})}else 2===n&&(Array.isArray(e)&&Array.isArray(i)&&e.length===i.length?e.forEach(function(t,n){u(t,i[n])}):u(e,i));return t},width:tt(!0),height:tt(),innerWidth:nt(!0),innerHeight:nt(),outerWidth:et(!0),outerHeight:et(),append:function(t){var n,t,e,n=[t];return t instanceof k&&(n=t.getAll()),e=(t=this)[0],n.forEach(function(t){t&&e.appendChild(t)}),t},appendTo:function(t){var n,t,n=t;return t instanceof k&&(n=t[0]),(t=this).forEach(function(t){n.appendChild(t)}),t},prepend:function(t){var n=this,e=n[0];return e.insertBefore(t,e.firstChild),n},insertBefore:function(n){var t=this,e=n.parentElement;return t.forEach(function(t){e.insertBefore(t,n)}),t},addClass:function(t){for(var n,e,i,r,o,a=0,u=this,s=u.length,c,f=/[\t\r\n]/g,n=(t||"").match(/\S+/g)||[];a<s;a++)if(i=1===(e=u[a]).nodeType&&(e.className?(" "+e.className+" ").replace(f," "):" ")){for(r=n[o=0];r;)i.indexOf(" "+r+" ")<0&&(i+=r+" "),r=n[++o];e.className=k.trim(i)}return this},removeClass:function(t){for(var n,e,i,r,o,a=0,u=this,s=u.length,c,f=/[\t\r\n]/g,n=(t||"").match(/\S+/g)||[];a<s;a++)if(i=1===(e=u[a]).nodeType&&(e.className?(" "+e.className+" ").replace(f," "):"")){for(r=n[o=0];r;){for(;0<=i.indexOf(" "+r+" ");)i=i.replace(" "+r+" "," ");r=n[++o]}e.className=t?k.trim(i):""}return this},hasClass:function(t){var n,e,i,r,o,n=0,e=this,i=e.length,r=/[\t\r\n]/g;for(t=" "+t+" ";n<i;n++)if(1===(o=e[n]).nodeType&&0<=(" "+o.className+" ").replace(r," ").indexOf(t))return!0;return!1},toggle:function(){var t,n,t=this,n;return t[0].style[I]===i?t.show():t.hide(),t},show:it(!0),hide:it(),attr:function(e,n){var t=this,i=t,r=arguments.length;if(1===r){if(!O(e))return t[0].getAttribute(e);i.forEach(function(t){for(var n in e)m(e,n)&&t.setAttribute(n,e[n])})}else 2===r&&i.forEach(function(t){t.setAttribute(e,n)});return t},removeAttr:function(n){return this.forEach(function(t){t.removeAttribute(n)}),this},prop:function(e,n){var t=this,i=t,r=arguments.length;if(1===r){if(!O(e))return J(t[0],e);i.forEach(function(t){for(var n in e)m(e,n)&&J(t,n,e[n])})}else 2===r&&i.forEach(function(t){J(t,e,n)});return t},removeProp:function(n){n=F[n]||n;var t=this,e;return t.forEach(function(t){try{t[n]=v,delete t[n]}catch(t){}}),t},text:function(n){var t=this,e=t;return 0===arguments.length?t[0].textContent:(e.forEach(function(t){t.textContent=n}),t)},val:function(e){var t,i,t,n,r,t=this;return arguments.length?(r=k.isFunction(e),t.forEach(function(t,n){var n;1!==t.nodeType||((n=r?e.call(t,n,k(t).val()):e)===g||n===v?n="":"number"==typeof n?n+="":k.isArray(n)&&(n=k.map(n,function(t){return t===g||t===v?"":t+""})),(i=o[t.type]||o[t.nodeName.toLowerCase()])&&u in i&&!R(i.set(t,n,"value")))||(t.value=n)}),t):(n=void 0,(t=t[0])?(i=o[t.type]||o[t.nodeName.toLowerCase()])&&c in i&&!R(n=i.get(t,"value"))?n:j(n=t.value)?n.replace(/\r/g,""):n===g||n===v?"":n:void 0)},position:function(){var t,n,e,i,r,t=this[0];if(t){if(n={top:0,left:0},e={top:0,left:0},"fixed"===k(t).css(T))try{n=t.getBoundingClientRect()}catch(t){}else i=this.offsetParent(),n=this.offset(),W(r=i[0],"html")||((e=i.offset()).left-=r.scrollLeft,e.top-=r.scrollTop),e.top+=s(k(r).css("borderTopWidth")),e.left+=s(k(r).css("borderLeftWidth"));return{top:n.top-e.top-s(k(t).css("marginTop")),left:n.left-e.left-s(k(t).css("marginLeft"))}}},offsetParent:function(){var t=k.map(this,function(t){for(var n,e,n=f.documentElement,e=t.offsetParent||n;e&&!W(e,"html")&&"static"===k(e).css(T);)e=e.offsetParent;return e||n});return k(t)},offset:function(){var t,n,e={top:0,left:0},n=this[0],i=n&&n.ownerDocument;if(i){if(t=i.documentElement,!R(n.getBoundingClientRect))try{e=n.getBoundingClientRect()}catch(t){}return n=Z(i),{top:e.top+(n.pageYOffset||t.scrollTop)-(t.clientTop||0),left:e.left+(n.pageXOffset||t.scrollLeft)-(t.clientLeft||0)}}},scrollLeft:rt(!0),scrollTop:rt(),html:function(n){var t=this,e=t;return 0===arguments.length?t[0].innerHTML:(e.forEach(function(t){t.innerHTML=n}),t)},remove:function(){var t;this.forEach(function(t){var n=t.parentElement;n&&(n.removeChild(t),$([t]))})},empty:function(){return this.forEach(function(t){k(t.children).remove()}),this},find:function(n){var e=[];return j(n)&&this.forEach(function(t){var t=t.querySelectorAll(n);k.merge(e,t)}),k(e)},parent:function(){var n=[];return this.forEach(function(t){var t=t.parentElement;t&&n.push(t)}),k(n)},index:function(t){var n=this[0];return t?j(t)?k.inArray(n,k(t).getAll()):k.inArray(t,this):n&&n.parentElement?k.inArray(n,n.parentElement.children):-1},focus:function(){var t=this,n=t[0];return n!==f.activeElement&&n.focus&&n.focus(),t},isVisible:function(){var n=0;return this.forEach(function(t){var t=getComputedStyle(t);t[A]!==C&&t[I]!==i&&n++}),0<n},data:function(e,i){var r,o,r=this,o=R(i);return o&&(r=void 0),k.each(this,function(t,n){var n=E(n,e,i);if(o)return r=n,!1}),r},removeData:function(e){return k.each(this,function(t,n){q(n,e)}),this}},e=z.prototype=[],r.Dh(e,n),k.prototype=e,k.each=r.y0,k.isEmptyObject=r._h,k.isFunction=r.Eh,k.isArray=r.Nh,k.isNumeric=r.jh,k.getType=r.Oh,k.inArray=r.Rh,k.merge=r.Bh,k.map=r.Lh,k.extend=r.Dh,k.inherit=r.Fh,k.isPlainObject=r.Ph,k.isArraylike=r.Gh,k.isWindow=r.Uh,k.makeArray=r.Hh,k.trim=function(t){var n;return t.trim?t.trim():t===g||t===v?"":(t+"").replace(/(^[\s\uFEFF\xA0]+)|([\s\uFEFF\xA0]+$)/g,"")},k.En=function(t,n,e,i,r){var t=k(f.createElement(t));return n&&e&&t.css(n,e),i&&t.addClass(i),r&&(r instanceof k?r:k(r)).append(t),t},t.getHostMaxZIndex=V,D="px",ut.prototype.sse=function(r,o,t){var a=this;this.use?this.cse=setInterval(function(){var t;r.style.width===a.zue+D&&r.style.height===a.Hue+D||o()},100):(this.Vue=new MutationObserver(at(function(t){for(var n,e,i,n=0;n<t.length;n++)if("attributes"===(e=t[n]).type&&(i=r.style.width!==a.zue+D||r.style.height!==a.Hue+D))return void o()},t)),this.Vue.observe(r,{attributes:!0}))},ut.prototype.disconnect=function(){this.use?clearInterval(this.cse):(this.Vue.disconnect(),this.Vue=null)},t.Mfe=ut},"./dist/core/util/imageLoader.js":function(t,n,e){"use strict";var e,s,c,i;function r(t){var n;this.zh=0,this.Vh=0,this.Yh={},this.Zh=t}Object.defineProperty(n,"__esModule",{value:!0}),n.Wh=void 0,e=e("./dist/core/util/domUtil.js"),s=e.GC$,c=".gcSheet",r.prototype.Rt=function(t,n){var e,i,r,o;function a(){e.Qh(t,!0)}function u(){e.Qh(t,!1)}(r=(i=(e=this).Yh)[t])||(o=s(document.createElement("img")),n&&o.attr("crossOrigin",n),o.bind("load"+c,a),o.bind("error"+c,u),o.bind("abort"+c,u),e.zh++,i[t]={Kh:!1,Jh:o[0],Xh:!1},o[0].src=t)},r.prototype.jt=function(t){var t=this.Yh[t];return!!t&&t.Kh},r.prototype.qh=function(t){var t=this.Yh[t];return!!t&&t.Xh},r.prototype.Ot=function(t){var t=this.Yh[t];return t?t.Jh:null},r.prototype.Qh=function(t,n){var e=this;e.Vh++,e.Yh[t].Kh=!0,e.Yh[t].Xh=n,e.$h()&&e.Zh&&e.Zh()},r.prototype.$h=function(){return this.Vh>=this.zh},r.prototype.L0=function(){var t,n,e,t=this.Yh;if(t)for(n in t)t[n]&&(e=s(t[n].Jh)).unbind(c);this.Zh=null},n.Wh=r},"./dist/core/util/styleManager.js":function(B,t,n){"use strict";var L,F,d,v,s,u,P,a,c,m,g,f,p,r,o,l,e,G,h,b,U,y,w,M,C,H,z,i,n;function S(t,n){var e=this;this.td=[],this.Lh={},t&&(n?t.forEach(function(t,n){e.Lh[t]=""+n,e.td[n]=t}):t.forEach(function(t,n){e.getTextIndex(t)}))}function T(){this.td=[]}function A(t){return t?1:0}function I(t,n){var e,i;return t?(e="{",m(t.style)||"object"!=typeof(i="string"==typeof(i=t.style)?'"'+P.ExcelBorderStyle[i]+'"':i)&&(e+='"s":'+i+","),m(t.color)||(e+='"c":'+n.getTextIndex(t.color)+","),e.substring(0,e.length-1)+"}"):""}function V(t,n){var e,t;if(t)return e=new v.LineBorder,t=JSON.parse(t),m(t.s)||(e.style=+t.s),m(t.c)||(e.color=n.getText(+t.c)),e}function Y(){var t,n,t=e(),n;return t&&t.GC&&t.GC.Spread&&t.GC.Spread.Common&&e().GC.Spread.Common.CultureManager.getCultureInfo()||G()}function x(t,n){var e=this;e.nd=[],e.ed=new b(n),e.rd=t}function N(t,n){var e=this;e.od=[],e.ad=new b,e.ud=new b,e.rd=t,e.cd=n}function k(t){var n=this;n.fd=[],n.ld=[],n.hd=new b,n.dd=new b,n.rd=t,n.hd.getTextIndex('{"s":0}'),n.dd.getTextIndex("l:0,r:0,t:0,b:0")}function D(t,n){var e=this;e.Ih=170,e.vd=[],e.md=new b,e.pd=new b,e.bd={},e.cd=t,e.yd=n,e.wd={},D.initBuiltNumberFormat(),Object.keys(D.Md).forEach(function(t){"count"!==t&&(D.Cd[D.Md[t]]=t)}),D.initLanguageIndependentNumberFormat(),Object.keys(D.Sd).forEach(function(t){"count"!==t&&(D.Cd[D.Sd[t]]=t)})}function _(){var t=this;t.Td=[],t.Ad=new b}function E(){var t=this;t.xd=[],t.Nd=new b}function j(t,n){if(t&&n)for(var e in n)n.hasOwnProperty(e)&&(t[e]=n[e])}function O(t,n,e){var i=this;i.kd=new b,i.Dd=new C(n,e),i._d=new w(t,n),i.Bfe=new w(t,n),i.Ed=new y(t),i.jd=new M(t)}function R(){var t=this;t.Od=new b,t.cd=new b,t.yd=new U,t.Dd=new C(t.cd,t.yd),t._d=new w(t.Od,t.cd),t.Ed=new y(t.Od,['{"t":0}','{"t":5}']),t.jd=new M(t.Od),t.Rd=new b,t.Bd=new b,t.Ld=new b,t.kd=new i(t.Od,t.cd,t.yd),t.Fd={},t.Pd={},t.Gd={},t.Ud={},t.Hd={},t.zd=[],t.Vd={},t.Yd={},t.Zd={},t.originCellXfs=new b,t.originNamedStylesXfs=new b,t.Wd={},t.Qd={},t.Kd={},t.Jd="__builtInStyle",t.Xd="__builtInTableStyle",t.qd=/^(__builtInTableStyle\d+)?__builtInStyle\d+$/,t.$d=0}Object.defineProperty(t,"__esModule",{value:!0}),t.StyleManager=t.SharedDxfs=t.SimpleSharedStrings=void 0,L=n("./dist/core/util/common.js"),F=n("./dist/core/celltype/celltype.ns.js"),d=n("./dist/core/util/common.js"),v=n("./dist/core/worksheet/style.js"),s=n("./dist/core/util/common.js"),u=n("./dist/core/excel-io-util/common.js"),P=n("./dist/core/excel-io-util/excel-style.js"),a=n("Common"),c=n("./dist/core/util/domUtil.js"),m=a.Common.lt.ht,g=void 0,f=null,p=u.NodeHelper.ur,r=c.GC$.each,o=a.Common.lt.tv,l=u.Util.oo,e=u.Util.ro,G=u.Util.ao,h=L.mt.St,S.prototype.dispose=function(){this.td=g,this.Lh=g},S.prototype.getTextIndex=function(t){var n;return this.Lh[t]===g&&(n=this.td.push(t)-1,this.Lh[t]=n),this.Lh[t]},S.prototype.getText=function(t){return this.td[t]},S.prototype.setTextIndex=function(t,n){this.td[n]=t,this.Lh[t]=n},S.prototype.replaceText=function(t,n){this.td[t]=n},S.prototype.getCount=function(){return this.td.length},S.prototype.yh=function(t){var n,e,i,r,n=this,e=n.Lh;if(t)for(i=0,r=(n.td=t).length;i<r;i++)e[t[i]]=""+i},S.prototype.wh=function(){return this.td},b=S,t.SimpleSharedStrings=b,T.prototype.dispose=function(){this.td=g},T.prototype.getObjectIndex=function(t){var n,e=this.td,i=0,r=e.length,o;if(t.toJSON?o=t.toJSON():!m(t)&&t instanceof Object&&(o=JSON.stringify(t)),o){for(;i<r;i++)if(e[i]===o)return i;return e[i]=o,i}},T.prototype.getObject=function(t){return this.td[t]},T.prototype.yh=function(t){this.td=t},T.prototype.wh=function(){return this.td},U=T,x.prototype.dispose=function(){var t=this;t.ed&&(t.ed.dispose(),t.ed=g),t.nd=g,t.rd=g},x.prototype.nv=function(t){var n,e,i,t,r,o,a,u,n=this,e=n.rd;return t.backColor===f?n.ed.getTextIndex('{"t":0}'):t.backColor!==g?("object"==typeof(a=o=r=t=t.backColor)?(i="{",o.stops?(i+='"s":[',(u=o.stops).forEach(function(t){i+='{"p":'+t.position+',"c":'+e.getTextIndex(t.color)+"},"}),i=i.substring(0,i.length-1),i+="],","path"===a.type?(i+='"t":"p"',(0,s.isDefined)(a.left)&&(i+=',"l":'+a.left),(0,s.isDefined)(a.right)&&(i+=',"r":'+a.right),(0,s.isDefined)(a.top)&&(i+=',"a":'+a.top),(0,s.isDefined)(a.bottom)&&(i+=',"c":'+a.bottom)):i+='"d":'+(o.degree||0)):r.type!==g&&(i+='"t":'+r.type,(0,s.isDefined)(r.patternColor)&&""!==r.patternColor&&(i+=',"p":'+e.getTextIndex(r.patternColor)),(0,s.isDefined)(r.backgroundColor))&&""!==r.backgroundColor&&(i+=',"b":'+e.getTextIndex(r.backgroundColor)),i+="}"):i=""===t?'{"t":0}':e.getTextIndex(t),n.ed.getTextIndex(i)):void 0},x.prototype.ev=function(t,n){var e,i,r,o,e,a,u,s,u,e=this,i=e.rd,r=e.nd;return r[t]||("string"==typeof(e=e.ed.getText(+t))&&"{"===e[0]?(u=(a=JSON.parse(e)).s,o={},0===a.t?f:(u&&0<u.length?(s=o.stops=[],u.forEach(function(t){var n={};m(t.p)||(n.position=t.p),m(t.c)||(n.color=i.getText(t.c)),s.push(n)}),"p"===a.t?(o.type="path",m(a.l)||(o.left=a.l),m(a.r)||(o.right=a.r),m(a.a)||(o.top=a.a),m(a.c)||(o.bottom=a.c)):m(a.d)||(o.degree=a.d)):m(a.t)?m(a.b)||(o=i.getText(a.b)):1===(u=a.t)?n||m(a.p)?m(a.b)||(o=i.getText(a.b)):o=i.getText(a.p):(o.type=u,m(a.p)||(o.patternColor=i.getText(a.p)),m(a.b)||(o.backgroundColor=i.getText(a.b))),o=c.GC$.isEmptyObject(o)?g:o,r[t]=o)):(o=i.getText(e),o=c.GC$.isEmptyObject(o)?g:o,r[t]=o))},x.prototype.iv=function(t){t.fills=this.ed.wh()},x.prototype.rv=function(t){this.ed.yh(t.fills)},y=x,N.prototype.dispose=function(){var t=this;t.ad&&(t.ad.dispose(),t.ad=g),t.ud&&(t.ud.dispose(),t.ud=g),t.od=g,t.rd=g,t.cd=g},N.prototype.nv=function(t){var n,e,n=this;if(!(m(t.font)&&m(t.vertAlign)&&m(t.textDecoration)&&t.foreColor===g&&m(t.themeFont)))return e="",m(t.font)||(e+="f:"+n.ud.getTextIndex(t.font)+","),m(t.vertAlign)||(e+="v:"+t.vertAlign+","),m(t.textDecoration)||(e+="d:"+t.textDecoration+","),t.foreColor!==g&&(e+="c:"+n.rd.getTextIndex(t.foreColor)+","),m(t.themeFont)||(e+="t:"+n.cd.getTextIndex(t.themeFont)+","),n.ad.getTextIndex(e.substring(0,e.length-1))},N.prototype.ev=function(t){var i,r,n,e,o,i=this,r=i.rd,n=i.od;return n[t]||((e=i.ad.getText(+t))?(o={},e.split(",").forEach(function(t){var t=t.split(":"),n=t[0],e=t[1];switch(n){case"f":o.font=i.ud.getText(+e);break;case"v":o.vertAlign=+e;break;case"d":o.textDecoration=+e;break;case"c":o.foreColor=r.getText(+e);break;case"t":o.themeFont=i.cd.getText(+e)}}),n[t]=o):void 0)},N.prototype.iv=function(t,n){var e=this;n?(t.partFonts=e.ad.wh(),t.partHtmlFonts=e.ud.wh()):(t.fonts=e.ad.wh(),t.htmlFonts=e.ud.wh())},N.prototype.rv=function(t,n){var e=this;n?(e.ad.yh(t.partFonts),e.ud.yh(t.partHtmlFonts)):(e.ad.yh(t.fonts),e.ud.yh(t.htmlFonts))},w=N,k.prototype.dispose=function(){var t=this;t.hd&&(t.hd.dispose(),t.hd=g),t.dd&&(t.dd.dispose(),t.dd=g),t.fd=g,t.ld=g,t.rd=g},k.prototype.nv=function(t){var n,e,i,n=this,e=n.rd;if(!(m(t.borderLeft)&&m(t.borderTop)&&m(t.borderRight)&&m(t.borderBottom)&&m(t.borderVertical)&&m(t.borderHorizontal)&&m(t.diagonalDown)&&m(t.diagonalUp)))return i="",m(t.borderLeft)||(i+="l:"+n.hd.getTextIndex(I(t.borderLeft,e))+","),m(t.borderRight)||(i+="r:"+n.hd.getTextIndex(I(t.borderRight,e))+","),m(t.borderTop)||(i+="t:"+n.hd.getTextIndex(I(t.borderTop,e))+","),m(t.borderBottom)||(i+="b:"+n.hd.getTextIndex(I(t.borderBottom,e))+","),m(t.borderVertical)||(i+="v:"+n.hd.getTextIndex(I(t.borderVertical,e))+","),m(t.borderHorizontal)||(i+="h:"+n.hd.getTextIndex(I(t.borderHorizontal,e))+","),m(t.diagonalUp)||(i+="u:"+n.hd.getTextIndex(I(t.diagonalUp,e))+","),m(t.diagonalDown)||(i+="d:"+n.hd.getTextIndex(I(t.diagonalDown,e))+","),n.dd.getTextIndex(i.substring(0,i.length-1))},k.prototype.ov=function(t){var n,e,i,n,i,r,n=this,e=n.ld;return e[t]||(i=n.hd,n=n.rd,r=void 0,r='{"s":0}'===(i=i.getText(+t))?f:V(i,n),e[t]=r)},k.prototype.ev=function(t){var i,n,e,r,i=this,n=i.fd;return n[t]||(e=i.dd.getText(t),r={},e?(e.split(",").forEach(function(t){var t=t.split(":"),n=t[0],e=t[1];switch(n){case"l":r.borderLeft=i.ov(e);break;case"r":r.borderRight=i.ov(e);break;case"t":r.borderTop=i.ov(e);break;case"b":r.borderBottom=i.ov(e);break;case"v":r.borderVertical=i.ov(e);break;case"h":r.borderHorizontal=i.ov(e);break;case"u":r.diagonalUp=i.ov(e);break;case"d":r.diagonalDown=i.ov(e)}}),n[t]=r):void 0)},k.prototype.iv=function(t){var n=this;t.borderItems=n.hd.wh(),t.borders=n.dd.wh()},k.prototype.rv=function(t){var n=this;n.dd.yh(t.borders),n.hd.yh(t.borderItems)},M=k,D.prototype.dispose=function(){var t=this;t.md&&(t.md.dispose(),t.md=g),t.pd&&(t.pd.dispose(),t.pd=g),t.vd=g,t.bd=g},D.prototype.nv=function(t){var n,e,i,t,r,o,a,n=this,e="",i=t._autoFormatter,t=t.formatter;if(!m(i)){if(r=(o=n.av(i))&&"a"+o.c,!o)return;n.bd[r]!==g?e+="a:"+n.bd[r]+",":(a=n.pd.getTextIndex(JSON.stringify(o)),e+="a:"+(n.bd[r]=a)+",")}if(!m(t)&&!h(t)){if(r=(o=n.av(t))&&"f"+o.c,!o)return;n.bd[r]!==g?e+="f:"+n.bd[r]+",":(a=n.pd.getTextIndex(JSON.stringify(o)),e+="f:"+(n.bd[r]=a)+",")}if(e)return n.md.getTextIndex(e.substring(0,e.length-1))},D.prototype.ev=function(t){var r,n,e,o,r=this,n=r.vd;return n[t]||(e=r.md.getText(t),o={},e.split(",").forEach(function(t){var t,n,t,e,i,i,t=t.split(":"),n=t[0],t=t[1];"a"===n?(e=r.fromSJSFormatString(r.pd.getText(+t)),(i=(i=a.Formatter)&&i.GeneralFormatter)&&(o._autoFormatter=new i(e.formatCached,e.customerCultureName),o._autoFormatter.isAuto=!0)):"f"===n&&(o.formatter=r.fromSJSFormatString(r.pd.getText(+t)))}),n[t]=o)},D.prototype.uv=function(t){var n=this,e=n.wd;return e[t]||n.sv(t)},D.prototype.sv=function(t){if(t!==g)return D.Md[t]!==g?D.Md[t]:D.Sd[t]!==g?D.Sd[t]:void 0},D.prototype.fromSJSFormatString=function(t){var n,e,t,i,r,t,t,n=this,e=n.wd,t=JSON.parse(t),i=t.n,r=t.c;return"string"==typeof(r=m(t.json)?r:JSON.parse(n.yd.getObject(t.json)))?e[i]=r:r&&!m(r.typeName)&&(t=d.getTypeFromString(r.typeName))?((t=new t).fromJSON(r),e[i]=t):(m(i)||r&&r.formatCached||(r=n.sv(i)),e[i]=r)},D.prototype.av=function(t){var n,t,e,i,n=this,t=t;if("object"==typeof t&&(t.toJSON&&(e=t.toJSON()),t.formatCached?t=t.formatCached:e&&(t=JSON.stringify(e))),t)return(i=D.Cd[t])===g&&this.bd[t]===g&&(i=this.Ih,this.Ih++),{n:i,c:t,json:e&&n.yd.getObjectIndex(e)}},D.prototype.iv=function(t){var n=this;t.numFmts=n.md.wh(),t.formatStrings=n.pd.wh()},D.prototype.rv=function(t){var n,e,i,n=this;if(n.md.yh(t.numFmts),n.pd.yh(t.formatStrings),t.numFmts&&0<t.numFmts.length)for(e=0,i=t.numFmts.length;e<i;e++)n.ev(e)},D.initBuiltNumberFormat=function(){var t,n,n,e,i,r,o,a,t=D.Md;if(t[0]="General",t[1]="0",t[2]="0.00",t[3]="#,##0",t[4]="#,##0.00",t[9]="0%",t[10]="0.00%",t[11]="0.00E+00",t[12]="# ?/?",t[13]="# ??/??",t[14]="m/d/yyyy",t[15]="d-mmm-yy",t[16]="d-mmm",t[17]="mmm-yy",t[18]="h:mm AM/PM",t[19]="h:mm:ss AM/PM",t[20]="h:mm",t[21]="h:mm:ss",t[22]="m/d/yyyy h:mm",t[37]="#,##0 ;(#,##0)",t[38]="#,##0 ;[Red](#,##0)",t[39]="#,##0.00;(#,##0.00)",t[40]="#,##0.00;[Red](#,##0.00)",t[45]="mm:ss",t[46]="[h]:mm:ss",t[47]="mm:ss.0",t[48]="##0.0E+0",t[49]="@",t.count=49,l())if("zh-cn"===(n=l()))t[14]="yyyy/m/d",t[17]="mmm-yy",t[22]="yyyy/m/d h:mm",t[27]='yyyy"\u5e74"m"\u6708"',t[28]='m"\u6708"d"\u65e5"',t[29]='m"\u6708"d"\u65e5"',t[30]="m-d-yy",t[31]='yyyy"\u5e74"m"\u6708"d"\u65e5"',t[32]='h"\u65f6"mm"\u5206"',t[33]='h"\u65f6"mm"\u5206"ss"\u79d2"',t[34]='\u4e0a\u5348/\u4e0b\u5348h"\u65f6"mm"\u5206"',t[35]='\u4e0a\u5348/\u4e0b\u5348h"\u65f6"mm"\u5206"ss"\u79d2"',t[36]='yyyy"\u5e74"m"\u6708"',t[39]="#,##0.00;-#,##0.00",t[40]="#,##0.00;[Red]-#,##0.00",t[50]='yyyy"\u5e74"m"\u6708"',t[51]='m"\u6708"d"\u65e5"',t[52]='yyyy"\u5e74"m"\u6708"',t[53]='m"\u6708"d"\u65e5"',t[54]='m"\u6708"d"\u65e5"',t[55]='\u4e0a\u5348/\u4e0b\u5348h"\u65f6"mm"\u5206"',t[56]='\u4e0a\u5348/\u4e0b\u5348h"\u65f6"mm"\u5206"ss"\u79d2"',t[57]='yyyy"\u5e74"m"\u6708"',t[58]='m"\u6708"d"\u65e5"',t.count=58;else if("ja-jp"===n)t[14]="yyyy/m/d",t[15]="dd-mmm-yy",t[16]="dd-mmm",t[17]="mmm-yy",t[22]="yyyy/mm/dd h:mm",t[27]="[$-411]ge.m.d",t[28]='[$-411]ggge"\u5e74"m"\u6708"d"',t[29]='[$-411]ggge"\u5e74"m"\u6708"d"',t[30]="m/d/yy",t[31]='yyyy"\u5e74"m"\u6708"d"\u65e5"',t[32]='h"\u6642"mm"\u5206"',t[33]='h"\u6642"mm"\u5206"ss"\u79d2"',t[34]='yyyy"\u5e74"m"\u6708"',t[35]='m"\u6708"d"\u65e5"',t[36]="[$-411]ge.m.d",t[38]="#,##0;[Red]-#,##0",t[39]="#,##0.00;-#,##0.00",t[40]="#,##0.00;[Red]-#,##0.00",t[50]="[$-411]ge.m.d",t[51]='[$-411]ggge"\u5e74"m"\u6708"d"\u65e5"',t[52]='yyyy"\u5e74"m"\u6708"',t[53]='m"\u6708"d"\u65e5"',t[54]='[$-411]ggge"\u5e74"m"\u6708"d"\u65e5"',t[55]='yyyy"\u5e74"m"\u6708"',t[56]='m"\u6708"d"\u65e5"',t[57]="[$-411]ge.m.d",t[58]='[$-411]ggge"\u5e74"m"\u6708"d"\u65e5"',t.count=58;else if(e=(n=Y())&&n.LocalNumberFormat,!m(e)&&!Array.isArray(e)&&"object"==typeof e){for(i in e)isNaN(Number(i))||(r=e[i],u.Util.uo(r)&&(t[i]=e[i]));for(i in o=0,t)isNaN(Number(i))||o<(a=Number(i))&&(o=a);t.count=o}},D.initLanguageIndependentNumberFormat=function(){var t=D.Sd;t[27]="m/d/yyyy",t[28]="m/d/yyyy",t[29]="m/d/yyyy",t[30]="m/d/yyyy",t[31]="m/d/yyyy",t[32]="h:mm:ss",t[33]="h:mm:ss",t[34]="m/d/yyyy",t[35]="m/d/yyyy",t[36]="m/d/yyyy",t[50]="m/d/yyyy",t[51]="m/d/yyyy",t[52]="m/d/yyyy",t[53]="m/d/yyyy",t[54]="m/d/yyyy",t[55]="m/d/yyyy",t[56]="m/d/yyyy",t[57]="m/d/yyyy",t[58]="m/d/yyyy"},D.Md={count:0},D.Sd={count:0},D.Cd={},C=D,_.prototype.dispose=function(){var t=this;t.Ad&&(t.Ad.dispose(),t.Ad=g),t.Td=g},_.prototype.nv=function(t,n){var e,i,r,i,e="",i=t.hAlign;if(m(i)||(3===n||!n)&&3===i||2===n&&1===i||1===n&&1===i||(e+="h:"+(r=[1,2,3,0,6])[i]+","),i=t.vAlign,m(i)||(3===n||!n)&&2===i||2===n&&1===i||1===n&&1===i||(e+="v:"+i+","),m(t.textOrientation)||(e+="x:"+t.textOrientation+","),m(t.textIndent)||(e+="i:"+t.textIndent+","),m(t.shrinkToFit)||(e+="s:"+A(t.shrinkToFit)+","),m(t.wordWrap)||(e+="w:"+A(t.wordWrap)+","),e)return this.Ad.getTextIndex(e.substring(0,e.length-1))},_.prototype.ev=function(t){var n,e,e,i,n=this,e=n.Td;return e[t]||(e=n.Ad.getText(t),i=new v.Style,e.split(",").forEach(function(t){var t=t.split(":"),n=t[0],e=t[1];switch(n){case"h":i.hAlign=+e;break;case"v":i.vAlign=+e;break;case"x":i.textOrientation=+e;break;case"i":i.textIndent=+e;break;case"s":i.shrinkToFit=p(e);break;case"w":i.wordWrap=p(e)}}),i)},_.prototype.iv=function(t){t.alignments=this.Ad.wh()},_.prototype.rv=function(t){this.Ad.yh(t.alignments)},H=_,E.prototype.dispose=function(){var t=this;t.Nd&&(t.Nd.dispose(),t.Nd=g),t.xd=g},E.prototype.nv=function(t){var n;if(!m(t.locked))return n="",n+="l:"+A(t.locked)+",",this.Nd.getTextIndex(n.substring(0,n.length-1))},E.prototype.ev=function(t){var n,e,e,i,n=this,e=n.xd;return e[t]||(e=n.Nd.getText(t),i=new v.Style,e.split(",").forEach(function(t){var t=t.split(":"),n=t[0],t=t[1];"l"===n&&(i.locked=p(t))}),i)},E.prototype.iv=function(t){t.protections=this.Nd.wh()},E.prototype.rv=function(t){this.Nd.yh(t.protections)},z=E,O.prototype.dispose=function(){var t=this;t.kd&&(t.kd.dispose(),t.kd=g),t.Dd&&(t.Dd.dispose(),t.Dd=g),t._d&&(t._d.dispose(),t._d=g),t.Ed&&(t.Ed.dispose(),t.Ed=g),t.jd&&(t.jd.dispose(),t.jd=g)},O.prototype.cv=function(t,n){var e,i,r,r,n,r,e=this,i="",r=e.Ed.nv(t);if(r!==g&&(i+="c:"+r+","),(r=(n?e.Bfe:e._d).nv(t))!==g&&(i+=(n?"pf:":"f:")+r+","),(n=e.jd.nv(t))!==g&&(i+="b:"+n+","),(r=e.Dd.nv(t))!==g&&(i+="j:"+r+","),""!==(i=i.substring(0,i.length-1)))return e.kd.getTextIndex(i)},O.prototype.fv=function(t,o,a){var u=this,t=u.kd.getText(t);if(t)return o=o||new v.Style,t.split(",").forEach(function(t){var t,n,e,i,r,i,r,t=t.split(":"),n=t[0],e=t[1];switch(n){case"c":i=u.Ed.ev(+e,a),o.backColor=i;break;case"f":r=u._d.ev(+e),j(o,r);break;case"pf":r=u.Bfe.ev(+e),j(o,r);break;case"b":i=u.jd.ev(+e),j(o,i);break;case"j":r=u.Dd.ev(+e),j(o,r)}}),o},O.prototype.iv=function(){var t=this,n={};return n.cellXfs=t.kd.wh(),t.Dd.iv(n),t._d.iv(n),t.Bfe.iv(n,!0),t.Ed.iv(n),t.jd.iv(n),n},O.prototype.rv=function(t){var n;t&&(n=this,t)&&(n.kd.yh(t.cellXfs),n.Dd.rv(t),n._d.rv(t),n.Bfe.rv(t,!0),n.Ed.rv(t),n.jd.rv(t))},i=O,t.SharedDxfs=i,R.prototype.dispose=function(){var t=this;t.Od&&(t.Od.dispose(),t.Od=g),t.cd&&(t.cd.dispose(),t.cd=g),t.yd&&(t.yd.dispose(),t.yd=g),t.Dd&&(t.Dd.dispose(),t.Dd=g),t._d&&(t._d.dispose(),t._d=g),t.Ed&&(t.Ed.dispose(),t.Ed=g),t.jd&&(t.jd.dispose(),t.jd=g),t.Rd&&(t.Rd.dispose(),t.Rd=g),t.Bd&&(t.Bd.dispose(),t.Bd=g),t.Ld&&(t.Ld.dispose(),t.Ld=g),t.kd&&(t.kd.dispose(),t.kd=g),t.Fd={},t.Pd={},t.Gd={},t.Ud={},t.Hd={},t.Vd={},t.zd.length=0,t.Yd={},t.Zd={},t.originCellXfs&&(t.originCellXfs.dispose(),t.originCellXfs=g),t.originNamedStylesXfs&&(t.originNamedStylesXfs.dispose(),t.originNamedStylesXfs=g),t.Wd={},t.Qd={},t.Kd={}},R.prototype.lv=function(t,n,e,i){var r,o,a,u,e,e,e,e,n,i,e,n,i,e,n,s,i,r=this,o=r.cd,a=r.yd,u="";return e!==g&&(u+="t:"+e+","),(e=r.Ed.nv(t))!==g&&(u+="c:"+e+","),(e=r._d.nv(t))!==g&&(u+="f:"+e+","),e=t.hAlign,m(e)||!i&&((3===n||!n)&&3===e||2===n&&1===e||1===n&&1===e)||(u+="h:"+e+","),e=t.vAlign,2===n&&1===e||1===n&&1===e||(m(e)?i||(u+="v:0,"):u+="v:"+e+","),(n=r.jd.nv(t))!==g&&(u+="b:"+n+","),m(t.locked)||(u+="l:"+A(t.locked)+","),m(t.wordWrap)||(u+="w:"+A(t.wordWrap)+","),m(t.showEllipsis)||(u+="se:"+A(t.showEllipsis)+","),m(t.hv)||(u+="st:"+A(t.hv)+","),m(t.shrinkToFit)||(u+="s:"+A(t.shrinkToFit)+","),m(t.tabStop)||(u+="ts:"+A(t.tabStop)+","),m(t.quotePrefix)||(u+="q:"+A(t.quotePrefix)+","),m(t.isVerticalText)||(u+="va:"+A(t.isVerticalText)+","),m(t.applyFont)||(u+="y:"+A(t.applyFont)+","),m(t.applyFill)||(u+="z:"+A(t.applyFill)+","),m(t.applyAlignment)||(u+="r:"+A(t.applyAlignment)+","),m(t.applyBorder)||(u+="e:"+A(t.applyBorder)+","),m(t.applyProtection)||(u+="u:"+A(t.applyProtection)+","),m(t.applyNumberFormat)||(u+="g:"+A(t.applyNumberFormat)+","),m(t.textIndent)||(u+="i:"+t.textIndent+","),i=t.imeMode,m(i)||1===i||(u+="im:"+i+","),m(t.opacity)||(u+="o:"+t.opacity+","),m(t.backgroundImageLayout)||(u+="bl:"+t.backgroundImageLayout+","),m(t.textOrientation)||(u+="x:"+t.textOrientation+","),m(t.backgroundImage)||(u+="bi:"+o.getTextIndex(t.backgroundImage)+","),m(t.watermark)||(u+="k:"+o.getTextIndex(t.watermark)+","),m(t.cellPadding)||(u+="p:"+o.getTextIndex(t.cellPadding)+","),m(t.textBaseline)||(u+="tb:"+o.getTextIndex(t.textBaseline)+","),m(t.labelOptions)||(u+="lo:"+o.getTextIndex(JSON.stringify(t.labelOptions))+","),m(t.cellType)||(e=a.getObjectIndex(t.cellType),m(e))||(u+="ct:"+e+","),m(t.cellButtons)||(n=a.getObjectIndex(t.cellButtons),m(n))||(u+="cb:"+n+","),m(t.dropDowns)||(i=a.getObjectIndex(t.dropDowns),m(i))||(u+="dd:"+i+","),m(t.decoration)||(e=a.getObjectIndex(t.decoration),m(e))||(u+="dc:"+e+","),m(t.mask)||(n=a.getObjectIndex(t.mask),m(n))||(u+="ma:"+n+","),!m(t.formatter)&&h(t.formatter)&&(u+="fs:"+(s=o.getTextIndex(t.formatter))+","),(i=r.Dd.nv(t))!==g&&(u+="j:"+i+","),u.substring(0,u.length-1)},R.prototype.vv=function(t,u){var s,c,f,l,h;if(t)return s=new v.Style,f=(c=this).cd,l=c.yd,h=c.Hd,t.split(",").forEach(function(t){var t,n,e,i,i,i,i,r,o,a,i,o,t=t.split(":"),n=t[0],e=t[1];switch(n){case"t":s.sheetId=+e;break;case"c":i=c.Ed.ev(+e),s.backColor=i;break;case"f":i=c._d.ev(+e),j(s,i);break;case"h":s.hAlign=+e;break;case"v":s.vAlign=+e;break;case"b":i=c.jd.ev(+e),j(s,i);break;case"l":s.locked=p(e);break;case"w":s.wordWrap=p(e);break;case"se":s.showEllipsis=p(e);break;case"st":s.hv=p(e);break;case"s":s.shrinkToFit=p(e);break;case"ts":s.tabStop=p(e);break;case"q":s.quotePrefix=p(e);break;case"va":s.isVerticalText=p(e);break;case"y":s.applyFont=p(e);break;case"z":s.applyFill=p(e);break;case"r":s.applyAlignment=p(e);break;case"e":s.applyBorder=p(e);break;case"u":s.applyProtection=p(e);break;case"g":s.applyNumberFormat=p(e);break;case"i":s.textIndent=+e;break;case"im":s.imeMode=+e;break;case"o":s.opacity=+e;break;case"bl":s.backgroundImageLayout=+e;break;case"x":s.textOrientation=+e;break;case"bi":s.backgroundImage=f.getText(+e);break;case"n":s.parentName=m(e)||!u&&0==+e?g:h[e];break;case"k":s.watermark=f.getText(+e);break;case"p":s.cellPadding=f.getText(+e);break;case"tb":s.textBaseline=f.getText(+e);break;case"lo":s.labelOptions=JSON.parse(f.getText(+e));break;case"ct":i=F.ti,(r=l.getObject(+e))&&(o=r.typeName,a=void 0,(i=i[r.type]||i[o]||d.getTypeFromString(o))&&(a=new i).fromJSON(r,!0),s.cellType=a);break;case"cb":s.cellButtons=JSON.parse(l.getObject(+e));break;case"dd":s.dropDowns=JSON.parse(l.getObject(+e));break;case"dc":s.decoration=JSON.parse(l.getObject(+e));break;case"ma":s.mask=JSON.parse(l.getObject(+e));break;case"fs":s.formatter=f.getText(+e);break;case"j":o=c.Dd.ev(+e),j(s,o)}}),s},R.prototype.mv=function(t,n){var e=this;if(!m(t))return t=n&&e.gv&&e.gv[t]&&e.gv[t][n]?e.gv[t][n]:t},R.prototype.getNamedStyle=function(t,n,e){var i,r,o,o,i=this,r,o=i.Rd.getText(t);if(o!==g)return(o=o?i.vv(o,e):new v.Style).name=n,i.Hd[t]=n,o},R.prototype.getNamedStyleIndex=function(t,n,e,i,r){var o,a,u,s,c,f,l,e;if(t)return a=(o=this).Rd,u=o.Pd,s=o.qd,f=o.Kd,l=t.name,l=o.mv(l,e),e=o.lv(t,n,i,!0),r&&(!l||s.test(l))||(c=a.getTextIndex(e),f[u[l]=c]={parentName:t.parentName,name:l}),c},R.prototype.updateNamedStylesParentName=function(){var t=this,i=t.Rd,r=t.Pd,o=t.Kd;Object.keys(o).forEach(function(t){var n,e,n,t,t,n=o[t],e=n.parentName,n=n.name;m(e)||m(r[e])||(t=i.getText(+t),t=i.getTextIndex(t+(0<t.length?",n:":"n")+r[e]),r[n]=+t)})},R.prototype.getStyle=function(t){var n,e,i,i,r,o,o,n=this,e,i=n.Yd[t];return i!==g?i:(r=(i=n.Ud)[t])!==g?r:(o=(o=n.Bd)&&o.getText(t))!==g?(r=n.vv(o,!1),i[t]=r):void 0},R.prototype.getStyleIndex=function(t,n,e){var i,r,o,a,u,s,c,f,a,f,l;if(t)return o=(i=this).Pd,a=i.Rd,u=i.Bd,s=i.qd,"string"==typeof t?(f=o[t=i.mv(t,e)],(c=a.getText(f)).length&&","!==c[c.length-1]&&(c+=","),+u.getTextIndex(c+="d:"+f)):(a=t._id,f=i.Fd,a!==g&&(r=f[a])!==g||((l=t.name)!==g&&!s.test(l)||(l=t.parentName),l=i.mv(l,e),(c=i.lv(t,n)).length&&","!==c[c.length-1]&&(c+=","),l!==g&&o[l]!==g?c+="n:"+o[l]:c+="n:0",r=u.getTextIndex(c),f[a]=r),r)},R.prototype.getOriginNamedStyleIndex=function(t){var n,e;return+this.originNamedStylesXfs.getTextIndex(t)},R.prototype.getOriginStyleIndex=function(t,n){var e,i,r,i,o,o,i,e=this,i=e.Wd,r=e.originCellXfs;return t?(o=t._id)!==g&&(i=i[o])!==g?i:(o=e.Pd,i=e.lv(t,n,void 0,!0),t.name&&!m(o[t.name])&&(i.length&&","!==i[i.length-1]&&(i+=","),i+="d:"+o[t.name]),t.parentName&&!m(o[t.parentName])&&(i.length&&","!==i[i.length-1]&&(i+=","),i+="n:"+o[t.parentName]),+r.getTextIndex(i)):+r.getTextIndex(f)},R.prototype.getOriginStyle=function(t){var n,e,i,e,n,n=this,e=n.originCellXfs,i=n.Qd;return i[t]!==g?i[t]:(e=e.getText(t))?(n=n.vv(e,!0),i[t]=n):f},R.prototype.getOriginNamedStyle=function(t){var n,e;return this.originNamedStylesXfs.getText(t)},R.prototype.getDxf=function(t,n,e){var i,r;return this.kd.fv(t,n,e)},R.prototype.getDxfIndex=function(t,n){var e,i=this.kd;return t?i.cv(t,n):g},R.prototype.addTableStyle=function(n){0<this.zd.filter(function(t){return t.name===n.name}).length||this.zd.push(n)},R.prototype.addDefaultStyleName=function(t,n){this.Vd[t]=n},R.prototype.getDefaultStyleName=function(t){return this.Vd[t]},R.prototype.getFormatCodeByNumFmtId=function(t){return this.Dd.uv(t)},R.prototype.buildDummyNamedStyles=function(t){var n,e,i,r,o,a,u,s,n=this,e=n.Bd,i=n.Jd,r=e.td.length,o=n.Yd;if(0<r)for(a=0;a<r;a++)(u=n.getStyle(a)).name=s=i+a,t.addNamedStyle(u),o[a]=s},R.prototype.yh=function(e,t){var i=this;e&&(e.sharedColors&&i.Od.yh(e.sharedColors),e.commonSharedStrings&&i.cd.yh(e.commonSharedStrings),e.cellXfs&&i.Bd.yh(e.cellXfs),e.cellStyleXfs&&i.Rd.yh(e.cellStyleXfs),e.sharedObjects&&i.yd.yh(e.sharedObjects),e.originCellXfs&&i.originCellXfs.yh(e.originCellXfs),e.originNamedStylesXfs&&i.originNamedStylesXfs.yh(e.originNamedStylesXfs),i.Ed.rv(e),i.Dd.rv(e),i._d.rv(e),i.jd.rv(e),i.kd.rv(e.dxfs),i.Vd=o(e.defaultStyleNames)||{},R.fh)&&r(R.fh,function(t,n){n.yh&&n.yh.call(i,e)})},R.prototype.wh=function(t){var e=this,i={sharedColors:e.Od.wh(),commonSharedStrings:e.cd.wh(),cellXfs:e.Bd.wh(),cellStyleXfs:e.Rd.wh(),sharedObjects:e.yd.wh(),namedStylesMap:e.Pd,defaultStyleNames:o(e.Vd),originCellXfs:e.originCellXfs.wh(),originNamedStylesXfs:e.originNamedStylesXfs.wh()};return e.Dd.iv(i),e._d.iv(i),e.Ed.iv(i),e.jd.iv(i),i.dxfs=e.kd.iv(),0<e.zd.length&&(i.tableStyles={n_:"tableStyles",c_:[].concat(e.zd),defaultPivotStyle:e.getDefaultStyleName("defaultPivotStyle")||"PivotStyleLight16",defaultTableStyle:e.getDefaultStyleName("defaultTableStyle")||"TableStyleMedium2",count:e.zd.length}),R.fh&&r(R.fh,function(t,n){n.wh&&n.wh.call(e,i)}),i},R.prototype.bv=function(t,n){for(var e in n)n.hasOwnProperty(e)&&(t[e]=n[e]);return t},t.StyleManager=n=R,(0,s.$e)(n)},"./dist/core/util/tasks.js":function(t,n){"use strict";var e,i,r,o,a,u,s,c,f,l;function h(t,n){this.fn=t,this.args=n}function d(t,n){var e=this;e.tasks=[],e.nextTaskFunc=t.bind(e),e.isBusyFunc=n.bind(e)}function v(t,n,e,i,r){var t=f.call(this,t,n)||this;return t.description=e,t.progress=i,t.sheetName=r,t}function m(t,n,e){void 0===e&&(e=function(t){});var t=l.call(this,t,n)||this;return t.progress=e,t}e=this&&this.__extends||(c=function(t,n){return(c=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(t,n){t.__proto__=n}:function(t,n){for(var e in n)Object.prototype.hasOwnProperty.call(n,e)&&(t[e]=n[e])}))(t,n)},function(t,n){if("function"!=typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function e(){this.constructor=t}c(t,n),t.prototype=null===n?Object.create(n):(e.prototype=n.prototype,new e)}),Object.defineProperty(n,"__esModule",{value:!0}),n.LoadTasks=n.LoadTask=n.Tasks=n.Task=void 0,i=100,r=10,h.prototype.dispose=function(){this.fn=void 0,this.args=void 0},h.prototype.run=function(){this.fn.apply(null,this.args)},o=h,n.Task=o,d.prototype.addTask=function(t,n,e){this.tasks.splice(0,0,new o(t,n))},d.prototype.pushTask=function(t,n,e){this.tasks.push(new o(t,n))},d.prototype.runNextTask=function(){var t,n,e,t=this,n=t.tasks;t.isTerminated||(n.length<1?t.endingCallback&&t.endingCallback():t.isBusyFunc()?setTimeout(function(){t.runNextTask()},100):((e=t.nextTaskFunc()).run(),setTimeout(function(){t.runNextTask()},10)))},d.prototype.start=function(){var t;this.runNextTask()},d.prototype.terminate=function(){var t=this;t.tasks&&(t.tasks.forEach(function(t){t.dispose()}),t.tasks=[]),t.endingCallback=void 0,t.isTerminated=!0},n.Tasks=a=d,e(v,f=o),v.prototype.dispose=function(){this.description=void 0,this.progress=void 0,this.sheetName=void 0,f.prototype.dispose.call(this)},u=v,n.LoadTask=u,e(m,l=a),m.prototype.runNextTask=function(){var t,n,e,n,t=this,n=t.tasks,e=t.progress;t.isTerminated||(n.length<1?t.endingCallback&&t.endingCallback():t.isBusyFunc()?setTimeout(function(){t.runNextTask()},100):((n=t.nextTaskFunc()).description&&e({progress:n.progress&&n.progress(),step:n.description,sheetName:n.sheetName}),n.run(),n.dispose(),setTimeout(function(){t.runNextTask()},0)))},m.prototype.addTask=function(t,n,e,i,r){this.tasks.splice(0,0,new u(t,n,e,i,r))},m.prototype.pushTask=function(t,n,e,i,r){this.tasks.push(new u(t,n,e,i,r))},m.prototype.terminate=function(){this.progress=void 0,l.prototype.terminate.call(this)},n.LoadTasks=m},"./dist/core/util/theme.js":function(B,t,n){"use strict";var e,i,a,p,o,v,u,s,r,c,n,e,i,f,l,h,d,m,g,b,y,L,F,P,G,w,M,C,S,T,A,A,I,S;function x(n){var e=n;return function(t){return 0===arguments.length?this.yv[e]:(this.yv[n]=v(t),this)}}function N(t){return t<=0?0:t<=.0031308?255*t*12.92+.5:t<1?255*(1.055*Math.pow(t,.4166666666666667)-.055)+.5:255}function U(t){var n,e,i,i,r,i,r,o,i,r,o,n=t.n_.split(":").pop(),e=t.val;return"sysClr"===n?void 0!==(i=w[e.toUpperCase()])?a.ColorHelper.hexToARGB(i):(i=t.lastClr)?(r=4278190080+(16777215&parseInt(i,16)),a.ColorHelper.hexToARGB(r)):void 0:"srgbClr"===n&&e?(r=4278190080+(16777215&parseInt(e,16)),a.ColorHelper.hexToARGB(r)):"scrgbClr"===n?(i=parseFloat(t._r),r=parseFloat(t.g),o=parseFloat(t.b),{a:255,r:N(i),g:N(r),b:N(o)}):"hslClr"===n?(i=parseFloat(t.wv),r=parseFloat(t.sat),o=parseFloat(t.lum),a.util.v1(i,o,r)):"prstClr"===n&&e?a.util.m1(e):void 0}function k(t){var t=t.toString(16).toUpperCase();return t=1===t.length?"0"+t:t}function D(t,n){return{n_:t,c_:[{n_:"srgbClr",val:k(n.r)+k(n.g)+k(n.b)}]}}function _(t,n,e,i,r,o,a,u,s,c,f,l,h){this.background1=x(0),this.background2=x(1),this.textColor1=x(2),this.textColor2=x(3),this.accent1=x(4),this.accent2=x(5),this.accent3=x(6),this.accent4=x(7),this.accent5=x(8),this.accent6=x(9),this.hyperlink=x(10),this.followedHyperlink=x(11),this.Zc=t,this.yv=[];for(var d=1;d<13;d++)this.yv.push(v(arguments[d]))}function E(t){return t=t&&"'"===t[0]?t.slice(1,t.length-1):t}function j(t,n,e,i){var r,o,r=this;this.name=s("name"),this.colors=s("colors"),this.headerFont=s("headerFont"),this.bodyFont=s("bodyFont"),this.fmtTheme=s("fmtTheme",void 0,function(){r.Mv={}}),(o=this).name(t),o.colors(n||new C(t)),o.headerFont(e),o.bodyFont(i)}function O(){}function R(){}Object.defineProperty(t,"__esModule",{value:!0}),t.Themes=t.ThemeColors=t.Theme=t.ColorScheme=void 0,e=n("Common"),i=n("./dist/core/util/common.js"),a=n("./dist/core/util/common.js"),p=e.Common.lt.ht,o=e.Common.ft,v=o._,u=parseInt,s=i.util.p0,r=a.util.xr,c=a.util.o1,n="Gill Sans MT",e="Franklin Gothic Book",i="Trebuchet MS",l=1,h=2,d=3,m=4,g=5,b=6,y=7,L=8,F=9,P=10,G=11,w={"3DDKSHADOW":4288716960,"3DLIGHT":4293125091,ACTIVEBORDER:4290032820,ACTIVECAPTION:4288263377,APPWORKSPACE:4289440683,BACKGROUND:1044480,BTNFACE:4293980400,BTNHIGHLIGHT:4294967295,BTNSHADOW:4288716960,BTNTEXT:1044480,CAPTIONTEXT:1044480,GRAYTEXT:4285361517,HIGHLIGHT:4281571839,HIGHLIGHTTEXT:4294967295,INACTIVEBORDER:4294244348,INACTIVECAPTION:4290760155,INACTIVECAPTIONTEXT:4282601044,INFOBK:4294967265,INFOTEXT:1044480,MENU:4293980400,GRADIENTACTIVECAPTION:4290367978,HOTLIGHT:267413196,GRADIENTINACTIVECAPTION:4292338930,MENUBAR:4293980400,MENUHIGHLIGHT:4281571839,MENUTEXT:1044480,SCROLLBAR:4291348680,WINDOW:4294967295,WINDOWFRAME:4284769380,WINDOWTEXT:4278190080},(S=M=M||{})[S.lt1=f=0]="lt1",S[S.lt2=1]="lt2",S[S.dk1=2]="dk1",S[S.dk2=3]="dk2",S[S.accent1=4]="accent1",S[S.accent2=5]="accent2",S[S.accent3=6]="accent3",S[S.accent4=7]="accent4",S[S.accent5=8]="accent5",S[S.accent6=9]="accent6",S[S.hlink=10]="hlink",S[S.folHlink=11]="folHlink",_.prototype.name=function(t){return 0===arguments.length?this.Zc:(this.Zc=t,this)},_.prototype.getColor=function(t){var n,e,i,r,e;if(t&&"string"==typeof t&&(e=void 0,n=t.split(" "))){if(i=-1,1<(r=n.length)){if(!n[0])return t;"background"===(e=n[0].toLowerCase())?i=u(n[1],10)-1:"text"===e?i=u(n[1],10)+1:"accent"===e&&(i=u(n[1],10)+3)}else 1===r&&("hyperlink"===(e=n[0].toLowerCase())?i=10:"followedhyperlink"===e&&(i=11));if(0<=i&&i<=11)return 2<r?(e=u(n[2],10)/100,o.j(o.Cv(this.yv[i],e))):o.j(this.yv[i])}return t},_.prototype.toJSON=function(){var t=this,n=t.yv;return{name:t.Zc,background1:n[0],background2:n[1],text1:n[2],text2:n[3],accent1:n[4],accent2:n[5],accent3:n[6],accent4:n[7],accent5:n[8],accent6:n[9],hyperlink:n[10],followedHyperlink:n[11]}},_.prototype.fromJSON=function(t,n){var e,i,r,o,a,u,s,c,f,l,h,d,v,m,i,n,n;function g(t,n){p(n)||(e.yv[t]={a:n.a,r:n.r,g:n.g,b:n.b})}t&&(e=this,i="_colorList",i=n?(n=t.name||t[r="_name"],p(n)||(e.Zc=n),o=(n=t.colorList||t[i])[0],a=n[1],u=n[2],s=n[3],c=n[4],f=n[5],l=n[6],h=n[7],d=n[8],v=n[9],m=n[10],n[11]):(p(t.name)||(e.Zc=t.name),o=t.background1,a=t.background2,u=t.text1,s=t.text2,c=t.accent1,f=t.accent2,l=t.accent3,h=t.accent4,d=t.accent5,v=t.accent6,m=t.hyperlink,t.followedHyperlink),g(0,o),g(1,a),g(2,u),g(3,s),g(4,c),g(5,f),g(6,l),g(7,h),g(8,d),g(9,v),g(10,m),g(11,i))},_.prototype.yh=function(t){var n,e,i,r,o,a,o;if(t)for(e=t.c_,(n=this).Zc=t.name,i=0,r=e.length;i<r;i++)(o=e[i])&&(a=o.n_.split(":").pop(),o=o.c_[0],n.yv[M[a]]=U(o))},_.prototype.wh=function(){for(var t,n,e,i,r,o,a,t=this,n={n_:"clrScheme",name:t.name()},e=[],i=t.yv,r=0,o=i.length;r<o;r++)a=i[r],2===r?e[0]={n_:"dk1",c_:[{n_:"sysClr",val:"windowText",lastClr:k(a.r)+k(a.g)+k(a.b)}]}:0===r?e[1]={n_:"lt1",c_:[{n_:"sysClr",val:"window",lastClr:k(a.r)+k(a.g)+k(a.b)}]}:3===r?e[2]=D("dk2",a):1===r?e[3]=D("lt2",a):e.push(D(""+M[r],a));return n.c_=e,n},_.prototype.Sv=function(t){var n,e,i,r;if(this.name()!==t.name())return!1;for(e=0,i=(n=["textColor1","textColor2","background1","background2","accent1","accent2","accent3","accent4","accent5","accent6","hyperlink","followedHyperlink"]).length;e<i;e++)if(!o.Tv(this[r=n[e]](),t[r]()))return!1;return!0},C=_,t.ColorScheme=C,j.prototype.getColor=function(t){return this.colors().getColor(t)},j.prototype.getFont=function(t){return"Body"===t?this.bodyFont():"Headings"===t?this.headerFont():t},j.prototype.toJSON=function(){var t=this,n=t.name();return j.Av(t)?n:{name:n,themeColor:t.colors()?t.colors().toJSON():void 0,headingFont:t.headerFont(),bodyFont:t.bodyFont()}},j.prototype.wh=function(){var t,n,e,i,r,t=this,n=t.name();return j.Av(t)?n:(r={n_:"themeElements",c_:[]},(i=(e=t.colors())?e.wh():i)&&r.c_.push(i),r.c_.push({n_:"fontScheme",c_:[{n_:"majorFont",c_:[{n_:"latin",typeface:E(t.headerFont())}]},{n_:"minorFont",c_:[{n_:"latin",typeface:E(t.bodyFont())}]}]}),{n_:"theme",name:n,c_:[r]})},j.prototype.yh=function(t){var n,t,e,i,e,i,n=this;"string"==typeof t?n.Iv(t):(n.Iv(t.name),t=r(t,"themeElements"),e=r(t,"clrScheme"),(i=new C).yh(e),n.colors(i),(e=r(t,"fontScheme"))&&(n.headerFont(c(e,"majorFont&latin").typeface),n.bodyFont(c(e,"minorFont&latin").typeface)),(i=r(t,"fmtScheme"))&&n.fmtTheme(i))},j.prototype.Iv=function(t){var n,t,n=this;t&&"OFFICE"===t.toUpperCase().substring(0,6)&&(t="Office"),n.name(t),(t=I[t])&&(n.colors(t.colors()),n.headerFont(t.headerFont()),n.bodyFont(t.bodyFont()))},j.Av=function(t){var n,n,n=t.name();return!!I[n]&&(n=I[n],t.bodyFont()===n.bodyFont())&&t.headerFont()===n.headerFont()&&t.colors().Sv(n.colors())},S=j,t.Theme=S,O.Default=new C("Default",A="#FFFFFF","#EEECE1",T="#000000","#1F497D","#4F81BD","#C0504D","#9BBB59","#8064A2","#4BACC6","#F79646","#0000FF","#800080"),O.Office2007=new C("Office2007",A,"#EEECE1",T,"#1F497D","#4F81BD","#C0504D","#9BBB59","#8064A2","#4BACC6","#F79646","#0000FF","#800080"),O.Office=new C("Office",A,"#E7E6E6",T,"#44546A","#5B9BD5","#ED7D31","#A5A5A5","#FFC000","#4472C4","#70AD47","#0563C1","#954F72"),O.Apex=new C("Apex",A,"#C9C2D1",T,"#69676D","#CEB966","#9CB084","#6BB1C9","#6585CF","#7E6BC9","#A379BB","#410082","#932968"),O.Aspect=new C("Aspect",A,"#E3DED1",T,"#323232","#F07F09","#9F2936","#1B587C","#4E8542","#604878","#C19859","#6B9F25","#B26B02"),O.Concourse=new C("Concourse",A,"#DEF5FA",T,"#464646","#2DA2BF","#DA1F28","#EB641B","#39639D","#474B78","#7D3C4A","#FF8119","#44B9E8"),O.Civic=new C("Civic",A,"#C5D1D7",T,"#646B86","#D16349","#CCB400","#8CADAE","#8C7B70","#8FB08C","#D19049","#00A3D6","#694F07"),O.Oriel=new C("Oriel",A,"#FFF39D",T,"#575F6D","#FE8637","#7598D9","#B32C16","#F5CD2D","#AEBAD5","#777C84","#D2611C","#3B435B"),O.Origin=new C("Origin",A,"#DDE9EC",T,"#464653","#727CA3","#9FB8CD","#D2DA7A","#FADA7A","#B88472","#8E736A","#B292CA","#6B5680"),O.Paper=new C("Paper",A,"#FEFAC9",T,"#444D26","#A5B592","#F3A447","#E7BC29","#D092A7","#9C85C0","#809EC2","#8E58B6","#7F6F6F"),O.Solstice=new C("Solstice",A,"#E7DEC9",T,"#4F271C","#3891A7","#FEB80A","#C32D2E","#84AA33","#964305","#475A8D","#8DC765","#AA8A14"),O.Technic=new C("Technic",A,"#D4D2D0",T,"#3B3B3B","#6EA0B0","#CCAF0A","#8D89A4","#748560","#9E9273","#7E848D","#00C8C3","#A116E0"),O.Trek=new C("Trek",A,"#FBEEC9",T,"#4E3B30","#F0A22E","#A5644E","#B58B80","#C3986D","#A19574","#C17529","#AD1F1F","#FFC42F"),O.Urban=new C("Urban",A,"#DEDEDE",T,"#424456","#53548A","#438086","#A04DA3","#C4652D","#8B5D3D","#5C92B5","#67AFBD","#C2A874"),O.Verve=new C("Verve",A,"#D2D2D2",T,"#666666","#FF388C","#E40059","#9C007F","#68007F","#005BD3","#00349E","#17BBFD","#FF79C2"),O.Equity=new C("Equity",A,"#E9E5DC",T,"#696464","#D34817","#9B2D1F","#A28E6A","#956251","#918485","#855D5D","#CC9900","#96A9A9"),O.Flow=new C("Flow",A,"#DBF5F9",T,"#04617B","#0F6FC6","#009DD9","#0BD0D9","#10CF9B","#7CCA62","#A5C249","#E2D700","#85DFD0"),O.Foundry=new C("Foundry",A,"#EAEBDE",T,"#676A55","#72A376","#B0CCB0","#A8CDD7","#C0BEAF","#CEC597","#E8B7B7","#DB5353","#903638"),O.Median=new C("Median",A,"#EBDDC3",T,"#775F55","#94B6D2","#DD8047","#A5AB81","#D8B25C","#7BA79D","#968C8C","#F7B615","#704404"),O.Metro=new C("Metro",A,"#D6ECFF",T,"#4E5B6F","#7FD13B","#EA157A","#FEB80A","#00ADDC","#738AC8","#1AB39F","#EB8803","#5F7791"),O.Module=new C("Module",A,"#D4D4D6",T,"#5A6378","#F0AD00","#60B5CC","#E66C7D","#6BB76D","#E88651","#C64847","#168BBA","#680000"),O.Opulent=new C("Opulent",A,"#F4E7ED",T,"#B13F9A","#B83D68","#AC66BB","#DE6C36","#F9B639","#CF6DA4","#FA8D3D","#FFDE66","#D490C5"),t.ThemeColors=A=O,R.Default=new S("Default",A.Default,"Cambria","Calibri"),R.Office=new S("Office",A.Office,"Calibri Light","Calibri"),R.Office2007=new S("Office2007",A.Office2007,"Cambria","Calibri"),R.Apex=new S("Apex",A.Apex,"Lucida Sans","Book Antiqua"),R.Aspect=new S("Aspect",A.Aspect,"Verdana","Verdana"),R.Concourse=new S("Concourse",A.Concourse,"Lucida Sans Unicode","Lucida Sans Unicode"),R.Civic=new S("Civic",A.Civic,"Georgia","Georgia"),R.Oriel=new S("Oriel",A.Oriel,"Century Schoolbook","Century Schoolbook"),R.Origin=new S("Origin",A.Origin,"Bookman Old Style",n),R.Paper=new S("Paper",A.Paper,"Constantia","Constantia"),R.Solstice=new S("Solstice",A.Solstice,n,n),R.Technic=new S("Technic",A.Technic,e,"Arial"),R.Trek=new S("Trek",A.Trek,"Franklin Gothic Medium",e),R.Urban=new S("Urban",A.Urban,i,"Georgia"),R.Verve=new S("Verve",A.Verve,"Century Gothic","Century Gothic"),R.Equity=new S("Equity",A.Equity,e,"Perpetua"),R.Flow=new S("Flow",A.Flow,"Calibri","Constantia"),R.Foundry=new S("Foundry",A.Foundry,"Rockwell","Rockwell"),R.Median=new S("Median",A.Median,"Tw Cen MT","Tw Cen MT"),R.Metro=new S("Metro",A.Metro,"Consolas","Corbel"),R.Module=new S("Module",A.Module,"Corbel","Corbel"),R.Opulent=new S("Opulent",A.Opulent,i,i),I=R,t.Themes=I},"./dist/core/workbook/sheettab.js":function(t,n,e){"use strict";var i,r,m,y,g,w,M,o,a,f,u,s,c,l,h;function d(t){var t,n,t=h.call(this,t)||this;return t.xv=4,t.Nv="white",(n=t).kv=13,n.Dv=12,n._v=0,n.Ev=30,n.jv=28,n.Ov=28,n.Rv=g.NEW_TAB_SIZE_ASIDE,n.Bv=15,n.Lv=28,n.Fv=0,n._font="10pt Segoe UI",t}i=this&&this.__extends||(l=function(t,n){return(l=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(t,n){t.__proto__=n}:function(t,n){for(var e in n)Object.prototype.hasOwnProperty.call(n,e)&&(t[e]=n[e])}))(t,n)},function(t,n){if("function"!=typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function e(){this.constructor=t}l(t,n),t.prototype=null===n?Object.create(n):(e.prototype=n.prototype,new e)}),Object.defineProperty(n,"__esModule",{value:!0}),n.Gv=void 0,r=e("Common"),m=e("./dist/core/util/common.js"),y=e("./dist/core/worksheet/stylehelper.js"),g=e("./dist/core/workbook/sheettabbase.js"),w=e("./dist/core/core.enum.js"),M=r.Common.ft,o=M.Uv,a=M._,f=null,u="blank",s="nextButton",h=g.Hv,i(d,h),d.prototype.zv=function(){var t=this.Vv,t=t&&t.options;return t&&t.tabNavigationVisible?this.jv*(t.useTouchLayout?1.5:1):0},d.prototype.Yv=function(){var t=this.Vv;return t&&t.options.tabNavigationVisible?t.Zv():0},d.prototype.Wv=function(){return this.Ov},d.prototype.Qv=function(){return this.Kv?0:this.Ov},d.prototype.Jv=function(){var t,n,t,n;return!this.Vv.options.newTabVisible||this.Kv?0:this.Rv},d.prototype.Xv=function(){var t,n,e,i,r,o,a,u,s,t=this,n=t.Vv.qv(),e=t.$v,i=t.tm();for(t.nm()&&(i-=t.em()),r=t.im(),o=t.ot(),a=r?o.x+o.width-t.rm()-t.Jv()-t.Qv():o.y+o.height-t.Yv(),u=t.om,s=n.length;u<s;u++)if(n[u].visible()===w.SheetTabVisible.visible&&(i+=r?e[u]:t.am),a<i){i=a;break}return i},d.prototype.tm=function(){var t,n,e,n,e,n,t=this,n=t.Vv.options,e=t.im(),n=n.tabNavigationVisible;return e?(e=2*t.em(),n&&(e-=t.em()),2*t.zv()+t.Wv()+t.um()+e):(n=t.cm(),t.nm()&&(n=0),Math.max(t.Jv(),n))},d.prototype.um=function(){var t=this,n=t.Vv;return n&&n.options.tabNavigationVisible?t.rm()/2:0},d.prototype.getResizeBarBounds=function(){var t,n,t=this,n=t.ot();return{x:n.x+n.width-t.rm(),y:f,width:t.rm(),height:f}},d.prototype.getNavButtonBounds=function(){var t,n,e,i,r,o,a,u,o,s,t,t=this,n,o=t.im()?(e=t.rm()/2,i=f,r=t.zv(),f):(o=t.ot(),s=t.Yv(),t=t.zv(),e=o.width/2-t,i=o.height-s,r=t,s),a=1,u=3;return{x:e,y:i,width:r,height:o,startIndex:1,endIndex:3}},d.prototype.getSheetTabBounds=function(){var t,n,e,i,t=this,n=t.ot(),e=t.Qv(),i=t.tm();return t.nm()&&(i-=t.em()),{x:i,y:f,height:f,secondMoreTabWidth:t.Qv(),moreTabPos:n.x+n.width-t.rm()-t.Jv()-e}},d.prototype.getPreMoreTabBounds=function(){var t,n,t=this,n=t.tm();return t.nm()&&(n-=t.em()),{x:n-t.Wv(),width:t.Wv()}},d.prototype.getAllSheetsBounds=function(){var t,n,e,i,r,o,a,u,s,c,f,r,n,n,a,i,t=this,n=t.im(),e=t.Vv.options.newTabVisible,i=t.Vv.options.tabNavigationVisible,r=t.Vv.options.useTouchLayout,o=t.ot(),a=t.getNavButtonBounds(),u=t.em(),s=t.cm(),n=(r=n?(c=a.x+2*a.width,c+=t.em()-t.rm()/2,0===t.rm()&&i&&(c-=t.em()),f=o.y,u):r?(n=o.x,a=o.width,e&&(n=o.x+o.width/2,a=o.width/2),c=n,f=o.y,a):(i=e?0:t.Bv/-2,c=(o.x+o.width)/2+i,f=5,u+4),s);return{x:c,y:f,width:r,height:n}},d.prototype.fm=function(){var t,n,t=this,n;return t.im()?t.lm+t.$v[t.hm]>t.dm():t.lm+2*t.am>t.dm()},d.prototype.dm=function(){var t,n,t=this,n;return t.im()?t.ot().width-t.rm()-t.Jv()-t.Qv():t.ot().height-t.Yv()},d.prototype.vm=function(){return 6},d.prototype.mm=function(){return[u,s]},d.prototype.gm=function(){return this.tm()},d.prototype.pm=function(t,n){var e,i,e=this;t.save(),t.beginPath(),i=m.I.He(0,"gc-tabStripBackground").backgroundColor,e.bm=a(i),t.fillStyle=i,t.fillRect(n.x,n.y,n.width,n.height),t.restore()},d.prototype.ym=function(t,n){var e,i,i,r,o,a,u,s,e,i=this.Vv,i=i&&i.options.tabStripPosition,r=m.I.He(0,"gc-tabStripBackground").borderTopColor;t.save(),t.beginPath(),t.strokeStyle=r,i===w.TabStripPosition.bottom?(o=n.x,a=n.y,u=n.x+n.width,s=n.y+.5):i===w.TabStripPosition.top?(o=n.x,a=n.height-.5,u=n.x+n.width,s=n.y+n.height-.5):i===w.TabStripPosition.left?(o=n.x+n.width-.5,a=n.y,u=n.x+n.width-.5,s=n.y+n.height):i===w.TabStripPosition.right&&(o=n.x+.5,a=n.y,u=n.x+.5,s=n.y+n.height),t.moveTo(o,a),t.lineTo(u,s),t.stroke(),t.restore()},d.prototype.wm=function(t,n){var e=this;e.pm(t,n),e.ym(t,n)},d.prototype.Mm=function(t,n,e){var i,r,o,a,u,s,e,c,f,l,a,l,l,s,i=this,r,o=i.Vv.options.newTabVisible,a=i.im(),u=i.tm(),s=i.jv,e=e,c=0,f=s;a?(i.nm()&&(u-=i.em()),e+=a=i.Qv(),(l=n.x+n.width-i.rm()-i.Jv())<e&&((l=(e=l)-a)<u&&(e=(l=u)+s),i.Cm(t,l,0,a,n.height)),l=n.height):(s=i.em(),i.nm()&&(s=0),e=(n.width-u)/2-s,f=l=u),o&&i.Sm(t,e,0,f,l,-2===i.Tm)},d.prototype.Am=function(t,n,e,i){var r=this.Wv();this.Cm(t,i-r,0,r,n.height)},d.prototype.Im=function(t,n){var e,i,r,o,a,u,s,c,e=this,i=e.im(),r=e.xm,o=e.zv(),a=e.Yv(),u=e.Nm;i?(s=e.rm()/2+o/2,e.km(t,s,c=a/2,s+r,c+r,s+r,c-r,g.NavButtonDirection.left,f,1===u),e.km(t,s+=o,c,s-r,c+r,s-r,c-r,g.NavButtonDirection.right,f,2===u)):(s=(n.width-o)/2,c=n.height-a/2,e.km(t,s,c,s+r,c+r,s-r,c+r,g.NavButtonDirection.top,f,1===u),e.km(t,s+=o,c,s-r,c+r,s-r,c-r,g.NavButtonDirection.bottom,f,2===u))},d.prototype.Dm=function(t,n){var e,i,r,o,i,a,u,s,c,a,e=this,i=e.Vv.options,r=i.allSheetsListVisible,o=i.newTabVisible,i=i.tabNavigationVisible,a=e.im(),u=e.tm();e.nm()&&(u-=e.em()),s=0,c=10,a?(s=2*e.zv()+e.em(),0===e.rm()&&i&&(s-=e.em())):(a=o?e.em():e.em()/2,s=(n.width-u)/2+a),r!==w.AllSheetsListVisibility.hide&&e._m(t,s,10,-3===e.Tm)},d.prototype.Em=function(t,n){var e,e,i,i,r,e=this,i=e.rm(),r=m.I.He(0,"gc-tabStripResizeBarInner");e.Vv.options.showHorizontalScrollbar&&(t.beginPath(),t.rect(n.x+n.width-i,0,i,n.height),t.clip(),e=n.x+n.width-i/2,i=n.y+n.height/2,t.fillStyle=r.color,t.fillRect(e,i,2,2),t.fillRect(e,i-4,2,2),t.fillRect(e,i+4,2,2))},d.prototype.jm=function(t,n,e,i,r,o,a,u){var s,c,f,l,h,d,v,s,s=this,c,f=s.Vv.options.tabStripPosition,l=s.Om,h=s.Nv,d=s.xv,v=s.Rm,s=s.im();t.save(),u&&a&&(t.fillStyle=h,f===w.TabStripPosition.bottom?t.fillRect(n,e,i,r-d):f===w.TabStripPosition.top?t.fillRect(n,e+d,i,r):f===w.TabStripPosition.left?t.fillRect(n+l,e,i-l,r):t.fillRect(n,e,i-l,r)),a?(t.fillStyle=h,f===w.TabStripPosition.bottom?t.fillRect(n,e+1,i,r-d):f===w.TabStripPosition.top?t.fillRect(n,e+d-1,i,r):u?f===w.TabStripPosition.left?t.fillRect(n+l,e,i-l,r+1):t.fillRect(n,e,i-l,r+1):t.fillRect(n+l,e,i-2*l,r+1)):u&&(t.fillStyle=h,f===w.TabStripPosition.bottom?t.fillRect(n,e,i,1):f===w.TabStripPosition.top?t.fillRect(n,e+r,i,1):f===w.TabStripPosition.left?t.fillRect(n+l,e,i-l,r+1):t.fillRect(n,e,i-l,r+1)),t.fillStyle=o,s?t.fillRect(n+v,e+v,i-2*v+1,r-2*v):u?f===w.TabStripPosition.left?t.fillRect(n+l,e,i-l,r+1):t.fillRect(n,e,i-l,r+1):t.fillRect(n+l,e,i-2*l,r+1),t.restore()},d.prototype.Bm=function(t,n,e,i,r,o,a){var u,s,c,f,l,u,u=this,s,c=u.Vv.options.tabStripPosition,f=u.xv,l=u.Om,u=u.im();t.save(),u?(t.beginPath(),t.lineWidth=1,t.strokeStyle=o&&o.borderLeftColor,a?c===w.TabStripPosition.bottom?(t.moveTo(n+.5,e),t.lineTo(n+.5,e+r-f),t.moveTo(n+i+.5,e),t.lineTo(n+i+.5,e+r-f)):c===w.TabStripPosition.top&&(t.moveTo(n+.5,e+f),t.lineTo(n+.5,e+r),t.moveTo(n+i+.5,e+f),t.lineTo(n+i+.5,e+r)):(t.moveTo(n+.5,e+f),t.lineTo(n+.5,e+r-f),t.moveTo(n+i+.5,e+f),t.lineTo(n+i+.5,e+r-f))):(t.beginPath(),t.lineWidth=1,t.strokeStyle=o&&o.borderLeftColor,a?c===w.TabStripPosition.left?(t.moveTo(n+l,e+.5),t.lineTo(n+l+i,e+.5),t.moveTo(n+l,e+r+.5),t.lineTo(n+l+i,e+r+.5)):(t.moveTo(n,e+.5),t.lineTo(n+i-l,e+.5),t.moveTo(n,e+r+.5),t.lineTo(n+i-l,e+r+.5)):(t.moveTo(n+l,e+.5),t.lineTo(n-l+i,e+.5),t.moveTo(n+l,e+r+.5),t.lineTo(n-l+i,e+r+.5))),t.stroke(),t.restore()},d.prototype.Lm=function(t,n,e,i,r,o,a){var u,s,c,f,u,u=this,s,c=u.Vv.options.tabStripPosition,f=u.xv,u=u.Om;a&&(t.save(),t.beginPath(),t.strokeStyle=o&&o.borderBottomColor,t.lineWidth=2,c===w.TabStripPosition.bottom?(t.moveTo(n,e+r-f),t.lineTo(n+i+1,e+r-f)):c===w.TabStripPosition.top?(t.moveTo(n,e+f),t.lineTo(n+i+1,e+f)):c===w.TabStripPosition.left?(t.moveTo(n+u,e),t.lineTo(n+u,e+r+1)):(t.moveTo(i-u,e),t.lineTo(i-u,e+r+1)),t.stroke(),t.restore())},d.prototype.Fm=function(t,n,e,i,r,o,a,u,s,c,f){var l,h,d,v,m,g,g,g,p,a,p,f,h,b,p,l=this,h=l.Vv.options.tabStripPosition,d=l.Om,v=l.Rm,m=l.Pm,g=l.Vv.Gm(o),g=g&&g.options,g=g&&g.sheetTabColor;t.save(),t.textBaseline="top",a=l.Um(a,p="string"==typeof u?u:p),t.fillStyle=a,(f||c||s)&&(t.font=y.W.ii(t.font,"bold")),p=l.kv,t.textBaseline="middle",h===w.TabStripPosition.bottom?t.fillText(o,n+p,e+r/2-1):h===w.TabStripPosition.top?t.fillText(o,n+p,e+r/2+1):(t.beginPath(),t.rect(n+d,e+.5,(f=n+i-2*d-2*v-2-1)+v,r+.5),t.clip(),t.fillText(o,n+d+v,e+r/2+2),h=t.measureText(m).width,f<(b=t.measureText(o).width)-h&&(t.beginPath(),p=void 0,p=g?u:c||s?l.Nv:M.j(l.bm),t.fillStyle=p,t.fillRect(n+d+v+f-h,e+1.5,f,r-1.5),t.fillStyle=a,t.fillText(m,n+d+v+f-h,e+r/2+2))),t.restore()},d.prototype.Hm=function(t,n,e,i,r,o,a,u,s,c){var f,l,l,h,d,f=this,l=w.VisualState.normal;u&&(l=w.VisualState.hover),c&&(l=w.VisualState.selected),a&&(l=w.VisualState.active),a&&!c&&(l=w.VisualState.activeNotSelected),l=m.I.He(l,"gc-tab-"+m.I.Ee(l)),h=m.I.He(0,"gc-tab-"+m.I.Ee(0)),d=f.zm(t,a,s,h,e),f.jm(t,n,e,i,r,d,c,a),f.Bm(t,n,e,i,r,h,a),f.Lm(t,n,e,i,r,l,c),f.Fm(t,n,e,i,r,s,l,d,c,a,u)},d.prototype.km=function(t,n,e,i,r,o,a,u,s,c){var f,l,h,d,v,c,f;t.save(),f=this,l=u===g.NavButtonDirection.left||u===g.NavButtonDirection.top,h=w.VisualState.highlight,c&&(h=w.VisualState.hover),l?(u===g.NavButtonDirection.left?n-=2:e-=2,-1===(d=f.Vm(f.om))&&(h=w.VisualState.normal)):(u===g.NavButtonDirection.right?n+=2:e+=2,-1===(v=f.Ym(f.Zm()))&&(h=w.VisualState.normal)),c=m.I.He(h,"gc-navButton-"+m.I.Ee(h)),t.strokeStyle=this.Wm(c.borderTopColor),t.beginPath(),f=l?1:-1,u===g.NavButtonDirection.left||u===g.NavButtonDirection.right?(t.moveTo(n-.5,e),t.lineTo(n-.5,e+1),t.moveTo(n+f-.5,e-1),t.lineTo(n+f-.5,e+2),t.moveTo(n+2*f-.5,e-2),t.lineTo(n+2*f-.5,e+3),t.moveTo(n+3*f-.5,e-3),t.lineTo(n+3*f-.5,e+4)):u!==g.NavButtonDirection.top&&u!==g.NavButtonDirection.bottom||(t.moveTo(n,e-.5),t.lineTo(n+1,e-.5),t.moveTo(n-1,e+f-.5),t.lineTo(n+2,e+f-.5),t.moveTo(n-2,e+2*f-.5),t.lineTo(n+3,e+2*f-.5),t.moveTo(n-3,e+3*f-.5),t.lineTo(n+4,e+3*f-.5)),t.stroke(),t.restore()},d.prototype.Sm=function(t,n,e,i,r,o){var a,u,s,o,a=this;t.save(),t.beginPath(),u=(r-2*a.Qm)/2,s=w.VisualState.highlight,o&&(s=w.VisualState.hover),o=m.I.He(s,"gc-tabStripNewTab-"+m.I.Ee(s)),t.lineWidth=1.5,t.strokeStyle=a.Wm(o.borderTopColor),t.arc(n+i/2,e+r/2,u,0,2*Math.PI),t.stroke(),t.beginPath(),t.lineWidth=2,t.moveTo(n+i/2-4,e+r/2),t.lineTo(n+i/2+4,e+r/2),t.moveTo(n+i/2,e+r/2-4),t.lineTo(n+i/2,e+r/2+4),t.stroke(),t.restore()},d.prototype._m=function(t,n,e,i){var r,o,a,u,i,r=this,o=15,a=5;r.nm()&&(o=0),t.save(),t.beginPath(),u=w.VisualState.highlight,i&&(u=w.VisualState.hover),i=m.I.He(u,"gc-tab-strip-all-sheets-"+m.I.Ee(u)),t.strokeStyle=r.Wm(i.borderTopColor),t.lineWidth=2,t.moveTo(n,e),t.lineTo(n+o,e),t.moveTo(n,e+5),t.lineTo(n+o,e+5),t.moveTo(n,e+10),t.lineTo(n+o,e+10),t.stroke(),t.restore()},d.prototype.Cm=function(t,n,e,i,r){var o,a,a;t.save(),t.beginPath(),o=w.VisualState.highlight,5!==(a=this.Nm)&&6!==a||(o=w.VisualState.hover),a=m.I.He(o,"gc-navMoreButton-"+m.I.Ee(o)),t.fillStyle=this.Wm(a.borderTopColor),t.fillRect(n+i/2,e+r/2,2,2),t.fillRect(n+i/2-4,e+r/2,2,2),t.fillRect(n+i/2+4,e+r/2,2,2),t.restore()},d.prototype.Wm=function(t){var n=a(t),e=this.bm;return n.a<=.01?o(e):M.Km(e,n)?o(n):t},n.Gv=d},"./dist/core/workbook/sheettab2007.js":function(t,n,e){"use strict";var i,r,o,S,T,M,C,A,I,x,N,k,a,D,e,h,u,s,c;function f(t){var t,n,t=c.call(this,t)||this,n=t;return n.kv=12,n.Dv=8,n._v=3,n.Ev=12,n.Rv=48,n.Bv=15,n.Lv=28,n.Fv=5,n._font="10pt Arial",t}i=this&&this.__extends||(s=function(t,n){return(s=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(t,n){t.__proto__=n}:function(t,n){for(var e in n)Object.prototype.hasOwnProperty.call(n,e)&&(t[e]=n[e])}))(t,n)},function(t,n){if("function"!=typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function e(){this.constructor=t}s(t,n),t.prototype=null===n?Object.create(n):(e.prototype=n.prototype,new e)}),Object.defineProperty(n,"__esModule",{value:!0}),n.Jm=void 0,r=e("./dist/core/core.ns.js"),o=e("Common"),S=e("./dist/core/util/common.js"),T=e("./dist/core/workbook/sheettabbase.js"),M=e("./dist/core/worksheet/stylehelper.js"),C=e("./dist/core/core.enum.js"),A=S.mt.ri,I=null,x=Math.min,N=Math.max,k="#92A5C7",a="newSheet",D="linear-gradient",e=new o.Common.ResourceManager(r.SR,"Sheets"),h=e.getResource.bind(e),c=T.Hv,i(f,c),f.prototype.zv=function(){var t,n,e,t=this.Vv,n=t&&t.options,e=0;return e=n&&n.tabNavigationVisible?t.Xm()*(n.useTouchLayout?2:1):e},f.prototype.Yv=function(){var t=this.Vv;return t&&t.options.tabNavigationVisible?t.Xm():0},f.prototype.tm=function(){var t,n,e,t=this,n;return t.im()?4*t.zv()+t.qm()+t.em():(e=t.cm(),t.nm()&&(e=0),Math.max(t.Jv(),e))},f.prototype.qm=function(){var t,n=this.Vv;return n&&n.options.tabNavigationVisible?2:0},f.prototype.getResizeBarBounds=function(){var t,n,t=this,n=t.ot();return{x:n.x+n.width-t.rm(),y:I,width:t.rm(),height:I}},f.prototype.getNavButtonBounds=function(){var t,n,e,i,r,o,a,u,o,s,t,t=this,n,o=t.im()?(e=0,i=I,r=t.zv(),I):(o=t.ot(),s=t.Yv(),t=t.zv(),e=o.width/2-2*t,i=o.height-s,r=t,s),a=0,u=4;return{x:e,y:i,width:r,height:o,startIndex:0,endIndex:4}},f.prototype.getSheetTabBounds=function(){var t,n,t=this,n=t.tm();return t.nm()&&(n-=t.em()),{x:n,y:I,height:I,secondMoreTabWidth:0,moreTabPos:0}},f.prototype.getPreMoreTabBounds=function(){var t,n,t=this,n=t.tm();return t.nm()&&(n-=t.em()),{x:n,width:t._v+t.Fv}},f.prototype.getAllSheetsBounds=function(){var t,n,e,i,r,o,a,u,s,c,f,r,n,n,a,i,t=this,n=t.im(),e=t.Vv.options.newTabVisible,i=t.Vv.options.tabNavigationVisible,r=t.Vv.options.useTouchLayout,o=t.ot(),a=t.getNavButtonBounds(),u=t.em(),s=t.cm(),n=(r=n?(c=a.x+4*a.width,c+=t.em()/2-t.rm()/2,0===t.rm()&&i&&(c-=t.em()/2),f=o.y,u):r?(n=o.x,a=o.width,e&&(n=o.x+o.width/2,a=o.width/2),c=n,f=o.y,a):(i=e?0:t.Bv/-2,c=(o.x+o.width)/2+i,f=5,u+4),s);return{x:c,y:f,width:r,height:n}},f.prototype.fm=function(){var t,n,t=this,n;return t.im()?t.lm+t.$v[t.hm]+t.Jv()>t.dm():t.lm+2*t.am>t.dm()},f.prototype.dm=function(){var t,n,t=this,n;return t.im()?t.ot().width-t.rm():t.ot().height-t.Yv()},f.prototype.vm=function(){var t;return this.im()?1:4},f.prototype.mm=function(){return[a]},f.prototype.gm=function(){var t,n,e,t=this,n=t.im(),e=t.tm();return e=n&&(e+=t.ot().height,t.Vv.options.newTabVisible)?(e+=t.Jv())+t._v:e},f.prototype.wm=function(t,n){var e,i,r,i,o,a,u,s;if(t.save(),t.beginPath(),e=t.createLinearGradient(n.x,n.y,n.width,n.height),r=(i=S.I.He(0,"gc-tabStripBackground"))&&i.backgroundImage,i=i&&i.backgroundColor,r&&-1!==r.indexOf(D))for(a=0,u=(o=A(r)).length;a<u;a++)s=o[a],e.addColorStop(s.point,s.color);else i&&(e.addColorStop(0,"#DDDDDD"),e.addColorStop(1,i));t.fillStyle=e,t.fillRect(n.x,n.y,n.width,n.height),t.restore()},f.prototype.Mm=function(t,n,e){var i,r,o,a,u,r,s,c,f,l,a,e,i=this,r=i.Vv,o=h().NewTab,a=i.im(),u;r.options.newTabVisible&&(r=void 0,f=c=void(s=0),l=-2===i.Tm,a?(i.Rv=t.measureText(o).width+i.kv,r=e,c=i.Jv(),f=n.height,i.Hm(t,r,0,c,f,void 0,!1,l,o,!1)):(a=i.em(),i.nm()&&(a=0),e=T.NEW_TAB_SIZE_ASIDE,i.Rv=e,r=(n.width-e)/2-a,i.$m(t,r,0,c=e,f=e,l)))},f.prototype.$m=function(t,n,e,i,r,o){var a,a,u,u,o,s,c,f,l,h,a=this;if(t.save(),t.beginPath(),a=(r-2*a.Qm)/2,u=C.VisualState.normal,o&&(u=C.VisualState.hover),u=S.I.He(u,"gc-tab-"+S.I.Ee(u)),(o=o?u.backgroundColor:u.backgroundImage)&&-1!==o.indexOf(D))for(s=t.createLinearGradient(n+.7*r,e+0,.7*r,r),f=0,l=(c=A(o)).length;f<l;f++)h=c[f],s.addColorStop(h.point,h.color);else s=o;t.lineWidth=1.5,t.strokeStyle=s,t.arc(n+i/2,e+r/2,a,0,2*Math.PI),t.stroke(),t.beginPath(),t.lineWidth=2,t.moveTo(n+i/2-4,e+r/2),t.lineTo(n+i/2+4,e+r/2),t.moveTo(n+i/2,e+r/2-4),t.lineTo(n+i/2,e+r/2+4),t.stroke(),t.restore()},f.prototype.Am=function(t,n,e,i){var r=this,e=e-1;r.Hm(t,i,0,r.Fv,n.height,e,r.hm===e,r.Tm===e,"",!1)},f.prototype.Im=function(t,n){var e,i,r,o,a,u,s,c,f,e=this,i=e.im(),r=e.tm(),o=e.xm,a=e.zv(),u=e.Yv(),s=e.Nm;t.fillStyle=k,i?t.fillRect(n.x,n.y,r-e.em()-2,n.height):t.fillRect(n.x,n.height-u,n.width,u),i?(e.km(t,c=a/2,f=u/2,c+o,f+o,c+o,f-o,T.NavButtonDirection.left,c-o,0===s),e.km(t,c+=a,f,c+o,f+o,c+o,f-o,T.NavButtonDirection.left,I,1===s),e.km(t,c+=a,f,c-o,f+o,c-o,f-o,T.NavButtonDirection.right,I,2===s),e.km(t,c+=a,f,c-o,f+o,c-o,f-o,T.NavButtonDirection.right,c+4,3===s)):(c=n.width/2-1.5*a,f=n.height-u/2,e.km(t,c,f,c+o,f+o,c-o,f+o,T.NavButtonDirection.top,f-o,0===s),e.km(t,c+=a,f,c+o,f+o,c-o,f+o,T.NavButtonDirection.top,I,1===s),e.km(t,c+=a,f,c+o,f-o,c-o,f-o,T.NavButtonDirection.bottom,I,2===s),e.km(t,c+=a,f,c+o,f-o,c-o,f-o,T.NavButtonDirection.bottom,f+o,3===s))},f.prototype.Dm=function(t,n){var e,i,r,i,o,a,u,s,o,e=this,i=e.Vv.options,r=i.allSheetsListVisible,i=i.newTabVisible,o=e.im(),a=e.tm();e.nm()&&(a-=e.em()),s=u=0,s=o?(u=4*e.zv()+1,5):(o=i?e.em():e.em()/2,u=(n.width-a)/2+o,10),r!==C.AllSheetsListVisibility.hide&&e._m(t,u,s,-3===e.Tm)},f.prototype._m=function(t,n,e,i){var r,o,a,u,s,c,s,f,l,h,d,v,m,g,l,f,u,a,p,b,y,c;if(t.save(),t.beginPath(),o=(r=this).im(),a=r.ot(),u=r.em(),c=(s=S.I.He)(4,"gc-all-sheets-button-hover"),f=(s=s(0,"gc-all-sheets-button-normal"))&&s.backgroundColor,(l=s&&s.backgroundImage)&&-1!==l.indexOf(D))for(h=t.createLinearGradient(a.x+.7*a.height,a.y+0,.7*a.height,a.height),v=0,m=(d=A(l)).length;v<m;v++)g=d[v],h.addColorStop(g.point,g.color);if(o&&(i?(t.fillStyle=c.backgroundColor,t.fillRect(n+2,a.y+2,u-4,a.height-4)):(h?t.fillStyle=h:f&&(t.fillStyle=f),t.fillRect(n-u/2,a.y+1,r.cm(),a.height-2))),o)t.strokeStyle=(i?c:s).color;else{if(l=C.VisualState.normal,i&&(l=C.VisualState.hover),g=void 0,f=S.I.He(l,"gc-all-sheets-button-"+S.I.Ee(l)),(u=i?f.backgroundColor:f.backgroundImage)&&-1!==u.indexOf(D))for(a=r.em(),g=t.createLinearGradient(n+.7*a,e+0,.7*a,a),v=0,m=(d=A(u)).length;v<m;v++)p=d[v],g.addColorStop(p.point,p.color);else g=u;t.strokeStyle=g}c=o?(b=3,y=12,4):(b=0,y=15,5),r.nm()&&(b=c=y=0),t.stroke(),t.lineWidth=1,t.moveTo(n+b,e),t.lineTo(n+y,e),t.moveTo(n+b,e+c),t.lineTo(n+y,e+c),t.moveTo(n+b,e+2*c),t.lineTo(n+y,e+2*c),t.stroke(),t.fill(),t.restore()},f.prototype.Em=function(t,n){var e,i,i,e,r,o,r,e=this,i=e.Vv,e=e.rm(),r=S.I.He,o=r(4,"gc-tabStripResizeBarInner"),r=r(0,"gc-tabStripResizeBarOuter");i.options.showHorizontalScrollbar&&(i=n.x+n.width-e,t.fillStyle=r.backgroundColor,t.fillRect(i,n.y,e,n.height),t.fillStyle=o.backgroundColor,t.fillRect(1+i,n.y+1,e-2,n.height-2),t.fillStyle=o.color,t.fillRect(i+e/2-1,n.y+4,2,n.height-8))},f.prototype.Hm=function(t,n,e,i,r,o,a,u,s,c){var f,l,h,h,f=this,l=f.im(),h=C.VisualState.normal;(u||c)&&(h=C.VisualState.hover),h=S.I.He(h,"gc-tab-"+S.I.Ee(h)),l?f.tg(t,n,e,i,r,s,h,c,a,u):f.ng(t,n,e,i,r,o,s,h,c,a,u)},f.prototype.tg=function(t,n,e,i,r,o,a,u,s,c){var f,l,h,l,d,h,f=this,l=f.Vv.options.tabStripPosition,h=f.eg;t.save(),t.beginPath(),l===C.TabStripPosition.bottom?(t.moveTo(n,e),t.lineTo(n,e+r-h),t.arcTo(n,e+r,n+i,e+r,h),t.lineTo(n+i,e+r),t.lineTo(n+i+r,e),s||t.lineTo(n,e)):(t.moveTo(n,e+r),t.lineTo(n,e-h),t.arcTo(n,e,n+i,e,h),t.lineTo(n+i,e),t.lineTo(n+i+r,e+r),s||t.lineTo(n,e+r)),l=f.zm(t,u||c,o,a),t.fillStyle=l,t.fill(),t.strokeStyle=k,t.stroke(),t.textBaseline="top",t.fillStyle=f.Um(a,d="string"==typeof l?l:d),s&&(t.font=M.W.ii(t.font,"bold")),h=f.kv,t.textBaseline="middle",t.fillText(o,n+h,e+r/2),t.restore()},f.prototype.ng=function(t,n,e,i,r,o,a,u,s,c,f){var l,h,d,o,v,m,g,p,b,h,y,v,o,g,w,l=this,h=l.Vv.options.tabStripPosition,d,o=o===l.Vv.sheets.length-1,v=l.eg,m=l.Om,g=l.xm,p=l.Rm,b=l.Pm;t.save(),t.beginPath(),h===C.TabStripPosition.left?(t.moveTo((n+=m)+(i-=m),e),t.lineTo(n+v,e),t.arcTo(n,e,n,e+v,v),t.lineTo(n,e+r-v),t.arcTo(n,e+r,n+v,e+r,v),o?t.lineTo(n+i,e+r):(t.lineTo(n+i-g,e+r),t.lineTo(n+i,e+r+g)),c||t.lineTo(n+i,e)):(i-=m,t.moveTo(n,e),t.lineTo(n+i-v,e),t.arcTo(n+i,e,n+i,e+v,v),t.lineTo(n+i,e+r-v),t.arcTo(n+i,e+r,n+i-v,e+r,v),o?t.lineTo(n,e+r):(t.lineTo(n+g,e+r),t.lineTo(n,e+r+g)),c||t.lineTo(n,e)),h=l.zm(t,s||f,a,u,e),t.fillStyle=h,t.fill(),t.strokeStyle=k,t.stroke(),t.textBaseline="top",v=l.Um(u,y="string"==typeof h?h:y),t.fillStyle=v,c&&(t.font=M.W.ii(t.font,"bold")),t.textBaseline="middle",t.beginPath(),t.rect(n,e,o=i-2*m,r),t.clip(),t.fillText(a,n+m+p,e+r/2+2),g=t.measureText(b).width,o<(w=t.measureText(a).width)-g&&(t.beginPath(),t.fillStyle=h,t.fillRect(n+o-g,e+1.5,o,r-2.5),t.fillStyle=v,t.fillText(b,n+o-g,e+r/2+2)),t.restore()},f.prototype.km=function(t,n,e,i,r,o,a,u,s,c){var f,l,h,d,f,v,m,v,g,p,b,y,w,M,C;if(t.save(),l=(f=this).im(),h=u===T.NavButtonDirection.left||u===T.NavButtonDirection.top,d=f.ot(),f=f.zv(),m=(v=S.I.He)(4,"gc-navButton-hover"),g=(v=v(0,"gc-navButton-normal"))&&v.backgroundColor,(p=v&&v.backgroundImage)&&-1!==p.indexOf(D))for(b=t.createLinearGradient(d.x+.7*d.height,d.y+0,.7*d.height,d.height),w=0,M=(y=A(p)).length;w<M;w++)C=y[w],b.addColorStop(C.point,C.color);l&&(c?(t.fillStyle=m.backgroundColor,t.fillRect(n-f/2+2,d.y+2,f-4,d.height-4)):(b?t.fillStyle=b:g&&(t.fillStyle=g),t.fillRect(n-f/2,d.y+1,f,d.height-2))),t.fillStyle=l?(c?m:v).color:!c&&b||g,void 0!==s&&s!==I&&(u===T.NavButtonDirection.left||u===T.NavButtonDirection.right?t.fillRect(s,x(r,a),1,N(r,a)-x(r,a)):t.fillRect(x(i,o),s,N(i,o)-x(i,o),1)),h?u===T.NavButtonDirection.left?(n-=2,i-=2,o-=2):(e-=2,r-=2,a-=2):u===T.NavButtonDirection.right?(n+=2,i+=2,o+=2):(e+=2,r+=2,a+=2),t.beginPath(),t.moveTo(n,e),t.lineTo(i,r),t.lineTo(o,a),t.lineTo(n,e),t.fill(),t.restore()},n.Jm=f},"./dist/core/workbook/sheettabbase.js":function(v,t,n){"use strict";var e,i,g,p,L,y,r,m,F,b,w,P,G,U,M,a,C,S,T,f,H,A,I,n,o,u,s,c,l,h,n,z,V,n,Y,Z,W,Q,x,N,k,D,_,E,j,J,O,K,X,R,B,n,q,$,e,i;function tt(t,n,e){t.ki(p.Events.SheetTabClick,{sheet:n,sheetName:n?n.name():C,sheetTabIndex:b(e)?-1:e})}function d(t){this.Zc=t,this.Kv=!1,this.Fv=0,this._v=0,this.Om=6,this.ig=3,this.eg=5,this.xm=5,this.Rm=3,this.Qm=7,this.Pm="...",this.buffer=null;var t=this;t.Vv=C,t.hm=0,t.om=0,t.lm=70,t.Nm=-1,t.Tm=-1,t._font="",t.$v=[],t.am=0,t.rg=-1,t.og=-1,t.ag=C,t.ug=C,t.sg=0,t.cg(new p.Rect(0,0,200,28))}Object.defineProperty(t,"__esModule",{value:!0}),t.Hv=t.NavButtonDirection=t.NEW_TAB_SIZE_ASIDE=void 0,e=n("./dist/core/core.ns.js"),i=n("Common"),g=n("./dist/core/util/domUtil.js"),p=n("./dist/core/util/common.js"),L=n("./dist/core/worksheet/stylehelper.js"),y=n("./dist/core/core.enum.js"),r=i.Common.ft,m=p.mt.ri,F=p.mt.x0,b=i.Common.lt.ht,w=p.mt.En,P=p.mt.vt,G=p.mt.bt,U=parseInt,M=window,a=document,C=null,S=Math.max,T=Math.min,f=Math.pow,H=Math.round,A="px",I="none",o="mousedown"+(n=".gcTab"),u="mousemove"+n,s="mouseup"+n,c="mouseout"+n,l="dblclick"+n,h="mousewheel"+n,z="mousemove"+(n=".spliter"),V="mouseup"+n,Y="keydown"+(n=".tabNameEditor"),Z="focus"+n,W="blur"+n,Q="canvas",x="2d",N="resize",D="tab",_="newSheet",E="blank",j="allSheets",J="black",O="white",K=7,X=10,R=k="navButton",B="sheetTab",t.NEW_TAB_SIZE_ASIDE=28,n=new i.Common.ResourceManager(e.SR,"Sheets"),q=n.getResource.bind(n),(i=$=t.NavButtonDirection||(t.NavButtonDirection={}))[i.left=0]="left",i[i.right=1]="right",i[i.top=2]="top",i[i.bottom=3]="bottom",d.prototype.getNewTabBounds=function(){var t,n,e,i,r,o,a,u,t,n,n,t=this,n=t.Vv.options.useTouchLayout,e=t.ot(),i=t.Jv(),r=(i-2*t.Qm)/2,t=n?(n=e.width,t.nm()||(n/=2),o=e.x,a=e.y,u=n,i):(n=(e.x+e.width-2*r)/2,t.nm()||(n-=t.em()),o=n,a=(e.y+i-2*r)/2,u=2*r);return{x:o,y:a,width:u,height:t}},d.prototype.getCanvas=function(){return this.fg},d.prototype.im=function(){var t,n,t,n=this.Vv.options.tabStripPosition;return n===y.TabStripPosition.bottom||n===y.TabStripPosition.top},d.prototype.hg=function(t){var n,e,i;t&&((e=(n=this).fg)&&n.L0(!0),i=w(Q),p.Bf.Wl(i,n.Vv),i.setAttribute("id",n.Zc),n.dg=n.vg(),n.mg(),t.appendChild(n.dg[0]),t.appendChild(i),n.fg=i,(0,g.GC$)(i).bind(o,function(t){return n.gg(t)}).bind(u,function(t){return n.pg(t)}).bind(s,function(t){return n.bg(t)}).bind(c,function(t){return n.yg(t)}).bind(l,function(t){return n.wg(t)}).bind(h,function(t){return n.Mg(t)}),n.Cg(),d.et(n,"setHost"))},d.prototype.Sg=function(t){var n,t,n=this;(n.Vv=t)&&((t=t.options.font)&&0<t.length&&(n._font=t),n.mg())},d.prototype.Tg=function(t){var n=this.Vv;n.suspendPaint(),this.Ag(t),n.resumePaint()},d.prototype.Ag=function(t){var n,e,i,r,n=this,e=-1,i=n.Zm();if(!(i.length<=0))for(;;){if(e===(r=n.Ig().tabsInfo)[0].index)return;if(e=r[0].index,r[0].index>t)n.xg(i);else{if(!(r[r.length-1].index<t||r[r.length-1].index===t&&1<r.length))return;n.Ng(i)}}},d.prototype.ot=function(){var t=this.kg;return new p.Rect(t.x,t.y,t.width,t.height)},d.prototype.cg=function(t){var n=this.kg=new p.Rect(0,0,0,0);n.x=t.x,n.y=t.y,n.width=t.width,n.height=t.height},d.prototype.Jv=function(){var t,n,t,n;return this.Vv.options.newTabVisible?this.Rv:0},d.prototype.em=function(){var t,n,e,t,n,e;return this.Vv.options.allSheetsListVisible!==y.AllSheetsListVisibility.hide?this.Bv:0},d.prototype.cm=function(){var t,n,e,t,n,e;return this.Vv.options.allSheetsListVisible!==y.AllSheetsListVisibility.hide?this.Lv:0},d.prototype.Xv=function(){var t,n,e,t=this,n=t.ot(),e;return t.im()?n.x+n.width-t.rm():n.y+n.height-t.Yv()},d.prototype.tm=function(){return 0},d.prototype.rm=function(){var t,n,e,t=this,n=y.TabStripPosition.bottom,e=t.Vv;return(n=e?e.options.tabStripPosition:n)===y.TabStripPosition.bottom?t.Ev:0},d.prototype.Cg=function(){var t,n,e,i,e,r,t=this,n=t.Dg();n&&n.parentNode&&0!==(e=(0,g.GC$)(n.parentNode)).width()&&0!==e.height()&&(i=S(e.width(),0),e=S(e.height(),0),n.style.display=I,n.width=i,n.height=e,n.style.display="",n.style.width=i+A,n.style.height=e+A,i=n.clientWidth||n.width,e=n.clientHeight||n.height,r=t.ot(),t.cg(new p.Rect(r.x,r.y,i,e)),p.Bf.$l(n,i,e),t.repaint())},d.prototype.fm=function(){return!1},d.prototype.Yv=function(){return 0},d.prototype.dm=function(){return 0},d.prototype.vm=function(){return 0},d.prototype.mm=function(){return[]},d.prototype.gm=function(){return 0},d.prototype.vg=function(){return this.dg||(0,g.GC$)(w("div"))},d.prototype.mg=function(){var t,n,t,t,e,t=this,n=t.dg;n&&(e=void 0,(t=(t=t.Vv)?t.options.tabStripPosition:y.TabStripPosition.bottom)===y.TabStripPosition.bottom?e="gc-tab-indicator-bottom":t===y.TabStripPosition.top?e="gc-tab-indicator-top":t===y.TabStripPosition.left?e="gc-tab-indicator-left":t===y.TabStripPosition.right&&(e="gc-tab-indicator-right"),n.removeClass(),n.addClass(e))},d.prototype.L0=function(t){var n,e,i,n=this,e=n.fg;e&&(i=e.parentNode,(0,g.GC$)(e).unbind(o).unbind(u).unbind(s).unbind(l).unbind(c).unbind(h),i)&&i.removeChild(e),(0,g.GC$)(n.dg).remove(),d.et(n,"dispose"),t||(n.Vv=C)},d.prototype._g=function(t,n){var e,i,r,o,a,o,u,s,r,c,f,l,h,o,a,r,a,o,d,v,m,g,p,b,e=this,i=e.Vv,r=i.options.scrollbarAppearance===y.ScrollbarAppearance.mobile,o=i.options.showHorizontalScrollbar,a=e.ot();if(o&&!r&&(o=e.getResizeBarBounds(),i.options.showHorizontalScrollbar)&&t>o.x&&t<a.x+a.width)return{type:"resize",element:N};for(s=-1,r=(u=e.getNavButtonBounds()).startIndex,c=u.x,f=u.endIndex,l=["first","prevArrow","nextArrow","last","","prevButton","nextButton"],h=r;h<f;h++){if(c<t&&t<c+u.width){k=l[s=h];break}c+=u.width}if(-1!==s)return{type:R,element:k,index:h};if(c=(o=e.getAllSheetsBounds()).x,a=i.options.allSheetsListVisible,r=!0,e.nm()&&(r=!1),a!==y.AllSheetsListVisibility.hide&&c<=t&&t<c+o.width&&r)return{type:B,element:j,position:c,index:-1};if(c=(a=e.getPreMoreTabBounds()).x,o=0,-1!==(d=e.Vm(e.om))){if(c<=t&&t<c+a.width)return{type:R,element:k=l[5],index:5,position:c};o=e.Fv}if(v=e.getSheetTabBounds(),m=i.qv(),g=e.$v,p=e._v,b=0,c=v.x+o,-1<e.om)for(h=e.om;h<m.length&&h<g.length;h++)if(m[h].visible()===y.SheetTabVisible.visible){if(b=g[h],c<t&&t<c+b+p&&(0<v.moreTabPos&&t<v.moreTabPos||0===v.moreTabPos))return{type:B,element:D,index:h,position:c};c+=b+p}if(c>v.moreTabPos&&0<v.moreTabPos&&(c=v.moreTabPos),-1!==e.Ym(e.Zm())){if(c<t&&t<c+v.secondMoreTabWidth)return{type:R,element:k=l[6],index:6,position:c}}else if(c<t&&t<c+v.secondMoreTabWidth)return{element:E,position:c};return c+=v.secondMoreTabWidth,i.options.newTabVisible&&c<t&&t<c+e.Jv()?{type:B,element:_,position:c,index:-1}:{element:E}},d.prototype.Eg=function(t,n){for(var e,i,r,o,a,u,s,c,f,l,c,h,d,v,m,g,p,c,d,e=this,i=e.Vv,o=e.getNavButtonBounds(),a=-1,u=o.x,s=o.y,c=o.startIndex,f=o.endIndex,l=["first","prevArrow","nextArrow","last","","prevButton","nextButton"],r=c;r<f;r++){if(u<t&&t<u+o.width&&s<n&&n<s+o.height){k=l[a=r];break}u+=o.width}if(-1!==a)return{type:R,element:k,index:r};if(c=e.Jv(),h=i.options.allSheetsListVisible,d=e.cm(),v=!0,e.nm()&&(d=0,v=!1),s=S(c,d),m=i.qv(),g=e.$v,p=e.am,-1<e.om)for(r=e.om;r<m.length&&r<g.length;r++)if(m[r].visible()===y.SheetTabVisible.visible){if(s<n&&n<s+p)return{type:B,element:D,index:r,position:s};s+=p}return c=e.getNewTabBounds(),i.options.newTabVisible&&c.x<t&&t<c.x+c.width&&c.y<n&&n<c.y+c.height?{type:B,element:_,position:s,index:-1}:(d=e.getAllSheetsBounds(),h!==y.AllSheetsListVisibility.hide&&d.x<t&&t<d.x+d.width&&d.y<n&&n<d.y+d.height&&v?{type:B,element:j,position:s,index:-1}:s<n&&n<s+o.y?-1!==e.Ym(e.Zm())?{type:R,element:k=l[6],index:6,position:s}:{element:E,position:s}:{element:E})},d.prototype.hitTest=function(t,n){var e,i,e,e=this,i,e=e.im()?e._g(t,n):e.Eg(t,n);return e},d.prototype.gg=function(t){var n,e,e,i,r,i,o,o,r,n=this,e={e:t,r:C};return d.et(n,"preProcessMouseDown",e),b(e=e.r)?(i=(0,g.GC$)(n.Dg()).offset(),r=t.pageX-i.left,i=t.pageY-i.top,o=n.Vv.jg(),n.Og&&n.Rg(o,!1),r=(o=n.hitTest(r,i)).element,0===t.button&&(r===N?(n.Bg=!0,n.Lg=t.pageX,n.Fg()):r===k?n.Pg(o.index):r===D?(n.Gg(o.index,o.position,t),n.Ug(t,o)):r===_?n.Hg(o.position):r===j&&n.zg(t),n.Vg()),!(n.Yg=!0)):e},d.prototype.Vg=function(){var t,n,t,n=this.Vv.jg();n&&!n.isEditing()&&n.Zg()},d.prototype.zg=function(t){var n,e,n,e;return this.Vv.commandManager().execute({cmd:"showAllSheetsDialog",mouseEvent:t})},d.prototype.pg=function(t){var n,e,i,r,r,r,o,a,u,s,i,i,s,c,s,i,e,t,s,i,n=this,e=n.Vv,i=(0,p.jf)(e),r={e:t,r:C};if(d.et(n,"preProcessMouseMove",r),!b(r=r.r))return r;if(r=n.fg.style,o="default",a="w-resize",n.Wg&&!n.Qg&&10<(u=Math.sqrt(f(n.Wg.x-t.pageX,2)+f(n.Wg.y-t.pageY,2)))&&(n.Qg=!0),n.Bg)r.cursor=a,s=t.pageX-n.Lg,i=i.getHDockScrollbarWidth(),i=n.Vv.Kg.clientWidth-i,e.options.tabStripRatio=e.Jg()+s/i,s=n.rm()/i,c=1,e.Jg()<s?(e.options.tabStripRatio=s,n.Lg=n.rm()):1<=e.Jg()?(e.options.tabStripRatio=1,n.Lg=i):n.Lg=t.pageX,e.Xg();else if(n.Qg)n.qg(t.pageX,t.pageY),n.$g(t);else{if(n.Nm=-1,n.Tm=-1,s=(0,g.GC$)(n.Dg()).offset(),i=t.pageX-s.left,e=t.pageY-s.top,s=(t=n.hitTest(i,e)).element,n.Vv&&n.Vv.options.enableAccessibility&&(i=n.t2(t),n.Vv.n2(i)),""===s)return r.cursor=o,n.repaint(),!1;s===N?r.cursor=a:(r.cursor=o,s===k?n.Nm=t.index:s===D?n.Tm=t.index:s===_?n.Tm=-2:s===j&&(n.Tm=-3)),n.repaint()}return!1},d.prototype.t2=function(t){var n,e,i,r,t,n=q(),e="",i=t.element;return i===N?e=n.ARIA_Resize:i===k?e=(r={first:n.ARIA_First,prevArrow:n.ARIA_PreviousArrow,nextArrow:n.ARIA_NextArrow,last:n.ARIA_Last,prevButton:n.ARIA_PreviousButton,nextButton:n.ARIA_NextButton})[k]||"":i===D?(t=this.Vv.e2(t.index).name(),e=n.ARIA_SheetTab+" "+t.replace(/([0-9]+)/," $1 ")):i===_?e=n.ARIA_NewSheet:i===E&&(e=n.ARIA_Blank),e},d.prototype.bg=function(t){var n,t,t,n=this,t={e:t,r:C};return d.et(n,"preProcessMouseUp",t),b(t=t.r)?(n.Bg&&(n.Bg=!1,n.Vv.Xg()),n.i2(),n.Qg&&(n.Qg=!1,n.r2.remove(),n.o2(),n.dg.hide()),n.Wg=C,n.a2(),n.u2(),!n.Yg||(n.Yg=!1)):t},d.prototype.yg=function(t){var n,t,t,e,i,n=this,t={e:t,r:C};return d.et(n,"preProcessMouseOut",t),b(t=t.r)?(n.a2(),e=n.Nm,n.Nm=-1,i=n.Tm,n.Tm=-1,n.Nm===e&&n.Tm===i||n.repaint(),!1):t},d.prototype.Fg=function(){var n=this;n.s2||((0,g.GC$)(a).bind(z,function(t){n.pg(t)}).bind(V,function(t){n.bg(t)}),n.c2(!0),n.s2=!0)},d.prototype.c2=function(t){var n,e,n,e=this.Vv.getActiveSheet();e&&(e.f2=t)},d.prototype.u2=function(){var t;this.s2&&((this.s2=!1,g.GC$)(a).unbind(z).unbind(V),t=this.Vv.getActiveSheet())&&delete t.f2},d.prototype.Pg=function(t,n){var e,i,r,e=this;e.a2(),(i=e.Zm()).length<=0||(r=200,0===(t%=4)?e.l2(i):1===t?(n||(e.h2=M.setTimeout(function(){e.Pg(1)},200)),e.xg(i)):2===t?(n||(e.h2=M.setTimeout(function(){e.Pg(2)},200)),e.Ng(i)):3===t&&e.d2(i))},d.prototype.Gg=function(t,n,e){var i,r,o,r,o,i=this,r=i.Vv,o=r.v2,r=r.e2(t),o=o&&o.sheetsState;o&&0===o[r.name()]?(i.ug!==C&&clearTimeout(i.ug),i.ug=setTimeout(function(){i.m2(t,n,e),i.c2(!0),i.ug=C,i.Vg()})):i.m2(t,n,e)},d.prototype.m2=function(t,n,e){var i,r,n,o,n,i=this,r=i.Vv;i.hm=t,i.lm=n,r.suspendPaint(),n=r.getActiveSheet(),(o=r.e2(t))&&o.isEditing()&&o!==n&&(n=n&&n.il&&n.il.rl,!o.ol(void 0,void 0,n))||(tt(r,o,t),i.g2(t,e),r.resumePaint(),i.repaint())},d.prototype.p2=function(t,n,e,i,r,o){var e={oldValue:e,newValue:i,sheetName:r,propertyName:"isSelected",cancel:!1,sheetIndex:o,sheetPosition:t.getSheetPosition(r)};t.ki(p.Events.SheetChanging,e),e.cancel||(n.b2(i),t&&t.w2&&t.w2.repaint(),delete e.cancel,t.ki(p.Events.SheetChanged,e))},d.prototype.Hg=function(t){var n,e,i,r,r,o,a,r,u,n=this,e=n.Vv,i=n.im(),r=e.getActiveSheet();if((!n.C2||n.C2(r))&&(tt(e,C,C),r=e.qv(),o=e.getSheetCount(),a=e.S2(e.T2(o)),r.forEach(function(t){t.b2(!1,!0)}),u={sheetName:r=a.name(),propertyName:"insertSheet",cancel:!1,sheetIndex:o,sheetPosition:e.getSheetPosition(r)},n.p2(e,a,!1,!0,r,o),e.ki(p.Events.SheetChanging,u),!u.cancel)){for(e.A2(o,1,a),e.ki(p.Events.SheetChanged,{sheetName:a.name(),propertyName:"insertSheet",sheetIndex:o,sheetPosition:e.getSheetPosition(a.name())}),n.hm=o,n.lm=t,e.I2(e.qv().length-1,1,!1,!0);n.hm>n.om&&(n.fm()||n.om<n.N2(-1));)n.k2(n.om)&&(n.lm-=i?n.$v[n.om]:n.am),n.om++;n.repaint()}},d.prototype.g2=function(t,n){var e,i,r,o,a,u,s,c,f,l,h,n,c,d,a,n,c,e=this,i=e.Vv,r=i.qv(),o=e.im(),a=i.getActiveSheet();e.D2&&!e.D2(a)||(u=!1,a&&a.il&&a.il.rl&&(u=!0),(s=!!n)&&(c=(l=p.mt.Qf())?n.metaKey:n.ctrlKey,f=n.shiftKey),t!==i.ep()?(c?(h=r[t]).b2()?h.b2(!1,!0):(h.b2(!0,!0),a&&!a.b2()&&a.b2(!0,!0)):f?(c=(n=i.jg())?i.getSheetPosition(n.name()):-1,d=r.slice(T(c,t),S(c,t)+1),r.forEach(function(t){t.visible()===y.SheetTabVisible.visible&&(-1!==d.indexOf(t)?t.b2()||t.b2(!0,!0):t.b2()&&t.b2(!1,!0))})):(a=r.every(function(t){return t.visible()!==y.SheetTabVisible.visible||t.b2()}),r[t].b2()&&!a||r.forEach(function(t){t.b2(!1,!0)}),(h=r[t]).b2()||h.b2(!0,!0),i.I2(t,1,u,!0)),n=e.N2(e.om),c=!1,c=o?e.lm+e.$v[e.hm]>e.dm():e.lm+e.am>=e.dm(),e.hm>e.om&&c&&-1!==n&&(e.om=n)):f&&r.forEach(function(t){var n,e,n=t.name(),e;i.getSheetPosition(n)!==i.ep()&&t.b2()&&t.visible()===y.SheetTabVisible.visible&&t.b2(!1,!0)}),e.hm<e.om&&(e.om=e.Vm(e.om)))},d.prototype.E2=function(t,n){var e,i,r,o,a,t,n,u,t,t,i,s,c,f,l,h,d,v,m,n,r,e=this,i=e.Vv,r=e.im(),o=i.options.tabStripPosition,a=U(p.I.fl("").zIndex),t=e.hitTest(t,n);if(t.element===D){if(n=e.hm,u=i.e2(n),t.index!==n)return;if(i.ki(p.Events.SheetTabDoubleClick,{sheet:u,sheetName:u.name(),sheetTabIndex:n}),!i.options.tabEditable)return!1;if((t=p.hi.ai())&&t.endEdit&&!t.endEdit())return;p.hi.F1(C),t=(0,g.GC$)(e.Dg()).offset(),i=i.j2(),s=(0,g.GC$)(i).offset(),c=(0,g.GC$)(i).width(),l=(f=w("input")).style,f.type="text",f.value=u.name(),f.setAttribute("contentEditable","true"),f.setAttribute("autocomplete","off"),l.position="absolute",l.margin="0px",l.padding="0px",m=v=d=h=void 0,n=e.$v[n],r?(m=n-e.kv-e.Dv+2,v=t.top-s.top+e.vm(),h=t.left-s.left+e.lm+e.kv):(r=e.ot(),m=n-e.kv-e.Dv+2,v=t.top-s.top+e.lm+e.vm(),h=t.left-s.left+r.x+e.Om+e.Rm,o===y.TabStripPosition.left&&2007===a&&(h+=e.Om),o===y.TabStripPosition.right&&c<h+m&&(d=t.left+r.width-c+e.Om+e.Rm)),d?l.right=d+A:h&&(l.left=h+A),l.top=v+A,l.width=m+A,l.backgroundColor=O,l.borderWidth="0px",l.outline=I,l.zIndex="1",(0,g.GC$)(f).appendTo(i),e.Og=f,(0,g.GC$)(f).addClass("gc-sheetTabEditor").bind(Y,function(t){return 13===t.keyCode?(e.Rg(u,!1),!1):27===t.keyCode?(e.Rg(u,!0),!1):void 0}).bind(Z,function(){f.selectionStart=0,f.selectionEnd=f.value.length}).bind(W,function(){e.Rg(u,!1)}),f.focus()}return!1},d.prototype.wg=function(t){var n,e,e,i,r,t,n=this,e={e:t,r:C};return d.et(n,"preProcessMouseDbClick",e),b(e=e.r)?(i=(0,g.GC$)(n.Dg()).offset(),r=t.pageX-i.left,t=t.pageY-i.top,n.E2(r,t)):e},d.prototype.Mg=function(t){var n,e,i,e,i,n=this,e=n.im(),i=!b(n.Og);return e||i||(b(t.wheelDelta)&&b(t.detail)&&(t.wheelDelta=t.originalEvent.wheelDelta,t.detail=t.originalEvent.detail),e=t.detail||t.wheelDelta,i=n.Zm(),0<e?n.xg(i):n.Ng(i)),!1},d.prototype.Rg=function(t,n){var e,i,r,n,o,e=this,i=e.Og;i&&((0,g.GC$)(i).unbind(Y).unbind(Z).unbind(W),r=i.value,!1===n&&r!==(n=t.name())&&(o={message:""},F(r,e.Vv.qv(),t,o)&&!b(r)&&""!==r?t.getParent().commandManager().execute({cmd:"renameSheet",sheetName:n,name:r}):t.ki(p.Events.InvalidOperation,{sheet:t,sheetName:t.name(),invalidType:5,message:o.message})),i.parentNode.removeChild(i),delete e.Og)},d.prototype.O2=function(){return this.Vv.options.allowSheetReorder},d.prototype.Ug=function(t,n){var e=this;e.O2()?(e.og=n.index,e.r2=e.R2(e.og),e.Wg=new p.Point(t.pageX,t.pageY),e.Fg()):e.Qg=!1},d.prototype.R2=function(t){var n,e,e,n,n=this.Vv.qv(),e=n.length;if(!(e<=t||t<0))return e=(e=n[t].name())||"sheet",(n=(0,g.GC$)(w("span")).text(e).css({position:"absolute",cursor:"default","border-radius":"5px",opacity:".7"})).addClass("ui-widget-header gc-tab-tip-span btn-primary"),n},d.prototype.a2=function(){var t=this.h2;t&&(clearTimeout(t),this.h2=C)},d.prototype.qg=function(t,n){var e,i,r,o,e,i=this.r2;i&&0===(0,g.GC$)(".gc-tab-tip-span").length&&(i.appendTo(a.body),i.hide()),r=i.width(),o=i.height(),i.css({left:t-r/2,top:n-o/2}),i.show()},d.prototype.$g=function(t){var n,e,i,r,i,o,t,i,a,u,s,c,f,l,e,h,d,o,t,v,m,e,t,o,n=this,e=n.Vv,i=(0,g.GC$)(n.Dg()),r=i.position(),i=i.offset(),o=t.pageX-i.left,t=t.pageY-i.top,i=n.hitTest(o,t),a=i.element,u=n.ot(),s=n.tm(),c=n.Vv.qv().length,f=100,l=e.options.tabStripPosition,e=n.im(),h=n.Jv(),d=n.dg,o=e?o:t,t=e?u.x+n.dm():u.y+n.dm()+h;t<o?n.ag===C&&n.rg<c&&(n.ag=M.setInterval(function(){n.Ng(n.Zm()),n.rg===c?(n.i2(),l===y.TabStripPosition.bottom?(v=r.left+n.B2()-3.5,m=r.top-3.5):l===y.TabStripPosition.top?(v=r.left+n.B2()-3.5,m=r.top+u.height):l===y.TabStripPosition.left?(v=r.left+u.width,m=r.top+n.B2()-3.5):l===y.TabStripPosition.right&&(v=r.left-3.5,m=r.top+n.B2()-3.5),d.show()):(n.rg++,d.hide()),d.css({left:v,top:m})},100)):o<s?n.ag===C&&0<n.rg&&(n.ag=M.setInterval(function(){n.xg(n.Zm()),0===n.rg?(n.i2(),l===y.TabStripPosition.bottom?(v=r.left+s-3.5,m=r.top-3.5):l===y.TabStripPosition.top?(v=r.left+s-3.5,m=r.top+u.height):l===y.TabStripPosition.left?(v=r.left+u.width,m=r.top+h-3.5):l===y.TabStripPosition.right&&(v=r.left-7,m=r.top+h-3.5),d.show()):(n.rg--,d.hide()),d.css({left:v,top:m})},100)):(n.i2(),a!==D&&-1===n.mm().indexOf(a)||(e=i.index,a===E&&(e=n.rg),t=e=a===D&&!b(e)?e:c,o=i.position,n.rg=t,l===y.TabStripPosition.bottom?(v=r.left+o-3.5,m=r.top-7):l===y.TabStripPosition.top?(v=r.left+o-3.5,m=r.top+u.height):l===y.TabStripPosition.left?(v=r.left+u.width,m=r.top+o-3.5):l===y.TabStripPosition.right&&(v=r.left-7,m=r.top+o-3.5),d.css({left:v,top:m}),d.show()))},d.prototype.B2=function(){for(var t,n,e,i,r,o,a,u,s,c,t=this,n=t.im(),e=t.$v,i=t.Zm(),r=t.L2(t.om,i),o=0,a=t.tm(),u=t.am,s=n?a+t.Fv:a,c=r;c<i.length;c++)o=i[c],n?s=(s+=e[o])+t._v:s+=u;return s},d.prototype.i2=function(){var t=this.ag;t&&(clearInterval(t),this.ag=C)},d.prototype.o2=function(){var t,n,e,i,r,o,a,u,t=this,n=t.Vv,e=t.rg,i=t.og,r=n.qv();if(n.suspendPaint(),this.F2(r)){for(o=[],a=0;a<r.length;a++)r[a].b2()&&(r[a].b2(!1),o.push(r[a]));for(a=o.length-1;0<=a&&!(n.getSheetPosition(o[a].name())<=e);a--)n.commandManager().execute({cmd:"moveSheet",sheetName:o[a].name(),targetIndex:e});for(e-=1,a=0;a<o.length&&!(n.getSheetPosition(o[a].name())>e);a++)n.commandManager().execute({cmd:"moveSheet",sheetName:o[a].name(),targetIndex:e})}else u=n.e2(i),-1!==e&&-1!==i&&i!==e&&i!==e-1&&t.dg.isVisible()&&(i<e-1&&(e-=1),n.commandManager().execute({cmd:"moveSheet",sheetName:u.name(),targetIndex:e}));n.resumePaint()},d.prototype.F2=function(t){for(var n,e,n=[],e=0;e<t.length;e++)if(t[e].b2()&&(n.push(t[e]),1<n.length))return!0;return!1},d.prototype.G2=function(t,n){var e,i,r,o,e=this,i=e.Vv,r=e.Zm();n===i.getSheetCount()?(e.d2(r),e.Cg()):0===n?(e.l2(r),e.Cg()):(o=e.U2(t,n))&&(t<n&&n++,e.Tg(n))},d.prototype.U2=function(t,n){for(var e,i,r,o,a,e=this,i=e.Ig().tabsInfo,r=!1,o=!1,a=0;a<i.length-2;a++)if(t===i[a].index&&(r=!0),n===i[a].index&&(o=!0),r&&o)return e.Cg(),!1;return!0},d.prototype.Zm=function(){for(var t,n,e,t=[],e=this.Vv.qv(),n=0;n<e.length;n++)this.k2(n)&&t.push(n);return t},d.prototype.l2=function(t){0<t.length&&this.om!==t[0]&&this.Vv.startSheetIndex(t[0])},d.prototype.xg=function(t){var n,t;0<t.length&&(n=this).om>t[0]&&-1!==(t=n.Vm(n.om))&&n.Vv.startSheetIndex(t)},d.prototype.Ng=function(t){var n,e;0<t.length&&(n=this).om<t[t.length-1]&&-1!==(e=n.Ym(t))&&n.Vv.startSheetIndex(n.N2(n.om))},d.prototype.d2=function(t){var t;0<t.length&&this.om<t[t.length-1]&&-1!==(t=this.Ym(t))&&this.Vv.startSheetIndex(t)},d.prototype.Ym=function(t){var n,e,i,r,o,a,u,s,c,f,l,h,h;if(0<t.length)for(e=(n=this).im(),i=n.am,r=n.dm(),a=n.$v,s=u=void(o=0),c=n.gm(),-1===(f=n.L2(n.om,t))&&(f=0),u=t.length-1;f<=u;u--)if(s=t[u],o+=l=e?a[s]:i,u!==t.length-1&&(o+=e?n._v:0),h=c+o,0!==u&&(h+=e?n.Fv:i),r<h)return h=void 0,h=u+1<t.length?t[u+1]:t[t.length-1],n.om<h?h:-1;return-1},d.prototype.Vm=function(t){for(var n,n=t-1;0<=n;n--)if(this.k2(n))return n;return-1},d.prototype.N2=function(t){for(var n,e,n=this.Vv.qv().length,e=t+1;e<n;e++)if(this.k2(e))return e;return-1},d.prototype.L2=function(t,n){for(var e,e=0;e<=n.length-1;e++)if(t===n[e])return e;return-1},d.prototype.k2=function(t){var t=this.Vv.e2(t);return!(!t||t.visible()!==y.SheetTabVisible.visible)},d.prototype.H2=function(){var t,n,e,i,r,o,a,t=this,n=t.Vm(t.om),e=t.Zm().length*t.am,i=t.Lv,r=t.Yv()/2,o,a;return t.ot().height<e+i+r||-1!==n},d.prototype.z2=function(){var t,n,t,t=this,n=t.Vm(t.om),t=t.Ym(t.Zm());return-1!==n||-1!==t},d.prototype.nm=function(){var t,n,e,i,t=this,n,e=t.Vv.options.allSheetsListVisible,i;if(t.im()){if(!t.z2()&&e===y.AllSheetsListVisibility.auto)return!0}else if(!t.H2()&&e===y.AllSheetsListVisibility.auto)return!0},d.prototype.V2=function(){this.sg++},d.prototype.Y2=function(){var t=this;t.sg--,t.sg<=0&&(t.sg=0,t.repaint())},d.prototype.repaint=function(t){var n=this.Dg();n&&n.getContext&&this._e(n.getContext(x),t)},d.prototype._e=function(t,n){var e,i,r,o,o,a,u,s,c,f,l,h,d,v,e=this;if(!(0<e.sg)){if(i=e.ot(),r=e.fg,n){if(n.x>=i.x+i.width)return;if(n.y>=i.y+i.height)return;if(n.x+n.width>i.width&&(n.width=i.width-n.x,n.width<=0))return;if(n.y+n.height>i.height&&(n.height=i.height-n.y,n.height<=0))return;if(n.width<=0||n.height<=0)return}if((o=e.buffer)&&o.width===r.width&&o.height===r.height&&(o||o.width===i.width&&o.height===i.height)||(o&&p.Bf.nh(e.Vv,o),e.buffer=o=w(Q),p.Bf.Wl(o,e.Vv),p.Bf.$l(o,i.width,i.height)),!(i.width<=0||i.height<=0||n&&(n.width<=0||n.height<=0))){(o=e.buffer.getContext(x)).clearRect(0,0,i.width,i.height),p.Lf.Yl(o,-i.x,-i.y),e.Z2(o,n),p.Lf.Yl(o,i.x,i.y),s=a=0<=i.x?0:-i.x,c=u=0<=i.y?0:-i.y,n&&(s=i.x+n.x,c=i.y+n.y,i=new p.Rect(s,c,n.width,n.height)),a=0<=i.x?i.x:0,u=0<=i.y?i.y:0,h=C,d=p.Bf.Kl(r),v=p.Bf.Jl(r),r&&1!==d&&(s*=d,c*=v,i.x*=d,i.y*=v,i.width*=d,i.height*=v);try{l=r?n?(f=S(i.width-s,0),S(i.height-c,0)):(f=T(i.width-s,S(r.width-i.x,3)),T(i.height-c,S(r.height-i.y,3))):(s=n.x,c=n.y,f=n.width,n.height),r?(p.Lf.Vl(t,1,1),t.clearRect(a,u,f,l),t.drawImage(e.buffer,s,c,f,l,a,u,f,l),p.Lf.Vl(t,d,v)):h=(o=e.buffer.getContext(x)).getImageData(s,c,f,l)}catch(t){return}!r&&h&&0<i.width&&0<i.height&&t.putImageData(h,a,u)}}},d.prototype.W2=function(t,n){var e,i,e,i=this.ot();n?t.rect(n.x,n.y,n.width,n.height):t.rect(i.x,i.y,i.width,i.height),t.clip()},d.prototype.K2=function(t){var n,e,i,r,o,a,n=this,e=n.Vv,i=n.im();for(t.save(),t.font=L.W.ii(t.font,"bold"),n.$v=[],a=e.qv(),o=0;o<a.length;o++)r=Math.round(t.measureText(a[o].name()).width)+n.Dv+n.kv,n.$v.push(r);i||(n.am=P(t.font)+2*n.ig),t.restore()},d.prototype.Ig=function(){var t,n,e,i,r,o,a,u,s,a,c,f,t=this,n,e=t.Vv.qv(),i=t.im(),r=t.ot(),o=[],a=t.tm();for(t.nm()&&i&&(a-=t.em()),u=a,a=t.om,i&&0<a&&0<=t.Vm(a)&&(u+=t.Fv),a<0&&(t.om=0),c=t.om;c<e.length;c++){if(f=e[c].visible(),s=t.$v[c],i){if(u>r.x+r.width)break}else if(u>r.y+r.height)break;o.push({index:c,position:u,width:s,text:e[c].name(),visible:f}),f===y.SheetTabVisible.visible&&(u+=i?s+t._v:t.am)}return{tabsInfo:o,newTabStartPosition:u}},d.prototype.Z2=function(t,n){var e,i,r,o,a,i,n,e=this,i=e.Vv,r=i.options.scrollbarAppearance===y.ScrollbarAppearance.mobile,o=i.options.tabStripPosition,a=i.options.showHorizontalScrollbar;t&&i&&(i=e.ot(),t.save(),G(t,e._font),e.W2(t,n),t.beginPath(),e.K2(t),n=e.Ig(),e.wm(t,i),e.Mm(t,i,n.newTabStartPosition),e.Dm(t,i),n=e.Ig(),e.J2(t,i,n.tabsInfo),e.Vv&&e.Vv.options.tabNavigationVisible&&e.Im(t,i),a&&!r&&o===y.TabStripPosition.bottom&&e.Em(t,i),t.beginPath(),t.restore())},d.prototype.wm=function(t,n){},d.prototype.Mm=function(t,n,e){},d.prototype.X2=function(t,n){var e,i,r,i,i,e=this,i=e.im(),r=e.tm();e.nm()&&(r-=e.em()),i?(i=n.x+e.dm(),t.rect(r,0,i-r,n.height)):(i=e.Yv(),t.rect(0,r,n.width,n.height-r-i)),t.clip()},d.prototype.q2=function(t,n,e){for(var i,r,o,a,u,s,c,f,i=this,r=i.Vv,o=i.im(),a=i.hm,u=i.Tm,s=e.length-1;0<=s;s--)(c=e[s]).index!==a&&c.visible===y.SheetTabVisible.visible&&(f=r.Gm(c.text).b2(),o?i.Hm(t,c.position,0,c.width,n.height,c.index,!1,c.index===u,c.text,f):i.Hm(t,0,c.position,n.width,i.am,c.index,!1,c.index===u,c.text,f))},d.prototype.tp=function(t,n,e){var i,r,o,a,u,s,e,s,o,i=this,r=i.Vv,o=r.qv(),a=i.im(),u=i.hm,s=i.om,e=e[u-s];s<=u&&u<o.length&&e&&e.visible&&(s=r.jg())&&(o=s.b2(),a?i.Hm(t,e.position,0,e.width,n.height,u,!0,!1,e.text,o):i.Hm(t,0,e.position,n.width,i.am,u,!0,!1,e.text,o))},d.prototype.np=function(t,n){var e,i,r,o,e=this,i=e.om,r=e.im(),o=e.tm();0<i&&0<=e.Vm(i)&&r&&e.Am(t,n,i,o)},d.prototype.J2=function(t,n,e){var i,r,o,i=this,r=i.Vv,o=r.qv();i.hm=r.ep(),0<o.length&&(t.save(),t.beginPath(),i.X2(t,n),i.q2(t,n,e),i.tp(t,n,e),t.restore(),t.save(),t.beginPath(),i.np(t,n),t.restore())},d.prototype.Am=function(t,n,e,i){},d.prototype.Im=function(t,n){},d.prototype.Dm=function(t,n){},d.prototype.Em=function(t,n){},d.prototype.km=function(t,n,e,i,r,o,a,u,s,c){},d.prototype.Hm=function(t,n,e,i,r,o,a,u,s,c){},d.prototype.Dg=function(){return this.fg},d.prototype.ip=function(t,n){var e,t,n,t,i,r,o,a,e=t.createLinearGradient(n.x,n.y,n.width,n.height),t=p.I.He(y.VisualState.normal,"gc-tabStripBackground"),n=t&&t.backgroundImage,t=t&&t.backgroundColor;if(n&&-1!==n.indexOf("linear-gradient"))for(r=0,o=(i=m(n)).length;r<o;r++)a=i[r],e.addColorStop(a.point,a.color);else t&&(e.addColorStop(0,"#DDDDDD"),e.addColorStop(1,t));return e},d.prototype.zm=function(t,n,e,i,r){var o,a,u,s,a,c,r,u,a,f,c,e,o,u,l,h,d,v,o=this,a=o.im(),u=o.ot(),s=a?t.createLinearGradient(u.x+.7*u.height,u.y+0,.7*u.height,u.height):(a=u.y,(c=0)<=r&&(a=r,c=o.am),t.createLinearGradient(u.x+.7*c,a,.7*c,a+c)),r=o.Vv.Gm(e);if(a=(u=(r=""===e&&0<o.om?o.Vv.e2(o.om-1):r)&&r.options)&&u.sheetTabColor)t.fillStyle=f="rgba(0, 0, 0, 0)",c=t.fillStyle,t.fillStyle=p.Pf.vl(r,a),(e=t.fillStyle)!==c&&(n?(s.addColorStop(0,O),s.addColorStop(.45,"#F1F6FD"),s.addColorStop(.9,e),s.addColorStop(1,O)):s=e);else if(i)if(o=i.backgroundImage,u=i.backgroundColor,o&&-1!==o.indexOf("linear-gradient"))for(h=0,d=(l=m(o)).length;h<d;h++)v=l[h],s.addColorStop(v.point,v.color);else u&&s.addColorStop(0,u);return s},d.prototype.Um=function(t,n){var e=J;return t&&(e=t.color),e=n&&r.rp(r._(n))<127.5?O:e},t.Hv=e=d,(0,p.$e)(e)},"./dist/core/workbook/workbook-json.js":function(i,t,n){"use strict";var o,Z,j,W,G,Q,J,e,K,X,q,Y,$,r,u,tt,O,R,U,nt,a,H,ht,h,d,dt,vt,s,mt,gt,et,pt,c,f,it,rt,ot,v,bt,yt,at,ut,n,st,l,ct,z,m;function B(t,n){return t.hasOwnProperty(n)}function L(t){var t,n,e,n;if(t&&"string"==typeof t){if(3<(n=(t=t.split(".")).length))return 3;if(e=m(t[0]),n<=2)return isNaN(e)?1:e;if(n=m(t[1]),10<=e)return e;if(3<=e){if(20143<=n)return 3;if(20142<=n)return 2}}return 1}function wt(t){var n,e,i,t,r,o,a,u,s,n=this,e=t&&t.frozenColumnsAsRowHeaders,i=t&&t.frozenRowsAsColumnHeaders;if(e||i)for(tt&&(t=n.op()).isAdjustSuspended()&&t.resumeAdjust(),o=(r=n.sheets).length,a=0;a<o;a++)s=(u=r[a]).Ut,i&&z(s.ap)&&(u.cp=!0,u.deleteRows(0,s.ap)),e&&z(s.fp)&&u.deleteColumns(0,s.fp)}function F(t,n){var e,i,r,o,a,u,s,c,a,e=this,i=n&&n.frozenColumnsAsRowHeaders,r=n&&n.frozenRowsAsColumnHeaders,o=0,u=t.sheets;if(r||i)for(s in u)"string"==typeof s&&(c=u[s],a=z(c.index)?c.index:c.lp,a=e.sheets[z(a)?a:o],r&&z(c.frozenRowCount)&&(a.cp=!0,a.deleteRows(0,c.frozenRowCount)),i&&z(c.frozenColCount)&&a.deleteColumns(0,c.frozenColCount),o++)}function P(t,n){var n=n.sheetTabCount;z(n)&&t.hp(n,0)}function g(p,b,y){return function(){for(var g,t,n,e,i,g=b.dataManager(),t=function(t){var n,d,v,m,n=t[1].dataView,d=g.tables[n&&n.tableName];d&&(v=d.views[n.name])&&((m=v).dp=function(){y(t),delete m.dp},v.vp=function(){for(var t,n,e,i,r,o,a,u,s,c,f,l,h,h,t=function(t){var n=t[1].dataView;(d=g.tables[n&&n.tableName])&&(v=d.views[n.name])&&m!==v&&v.fetch().then(function(){y(t)})},n=0,e=p;n<e.length;n++)t(i=e[n]);for(o in r=g.tables)if(r.hasOwnProperty(o))for(s in u=(a=r[o]).views)u.hasOwnProperty(s)&&delete(c=u[s]).vp;for(f=0,l=p;f<l.length;f++)if(h=(i=l[f])[1].dataView,(d=g.tables[h&&h.tableName])&&(v=d.views[h.name],m===v)){h=i[0],b.suspendPaint(),h.Mf.recalcAll(!0),b.resumePaint();break}})},n=0,e=p;n<e.length;n++)t(i=e[n])}}function Mt(o,a,u,i){var s,t,n,c,f,l;if(0<o.length){for(s=a.dataManager(),t=void 0,n=0;n<o.length&&!(t=o[n][1].dataView);n++);(c=s.tables[t&&t.tableName])&&(f=c.views[t.name])&&(l=function(t){var n=t[0],e=t[1],t=t[2];n.ANi(e,i),t&&b(a,t,n)},f.fetch().then(function(){var e,t,n,i,r;for(l(o[0]),e=[],t=function(t){var n=t[1].dataView;(c=s.tables[n&&n.tableName])&&(f=c.views[n.name])&&e.push(f.fetch().then(function(){l(t)}))},n=0,i=o.slice(1);n<i.length;n++)t(r=i[n]);Promise.all(e).then(function(){a.suspendPaint(),u&&a.mp[0].Mf.recalcAll(!0),a.resumePaint()})}).catch(g(o,a,l)))}}function p(t,n,e){var i,e,e,i=n.dataView;return i&&(e=e.tables[i&&i.tableName])&&(e=e.views[i.name])?e.fetch().then(function(){t.ANi(n,!0)}):void 0}function Ct(t,n,e,i){var r,o,a,u,s,c,f,l,h,d,v,m,r=0,o=n.sheetTabs,a=[],u=i&&i.gp,s=t.mp;if(s&&s.length&&o){for(c in o)if("string"==typeof c&&(f=o[c],l=t.mp[r])){if(l.fromJSON(f,!1,e,i,!0),l.E0i=f.order,!u){for(h=n.formatStringNames,d=[],v=0;h&&v<h.length;v++)(m=h[v]).sheetTabName===l.name()&&d.push(m);a[r]=[l,f.addition,d]}r++}Mt(a,t,!(i&&i.doNotRecalculateAfterLoad),!1)}}function b(t,n,e){var i,r;if(n)for(i=0;i<n.length;i++)r=n[i],t.pp(t.bp,r.name,r.formula,r.row,r.col,!0,r.comment,e)}function St(t,n){var n,t,n=n.activeSheetTabIndex;z(n)&&(t.yp(n,0),t=t.mp[n])&&t.b2(!0,!1)}function Tt(t,n,e,i,r){var o;return e===ut&&i===ut&&t===ut&&n===ut?ut:(o="",e!==ut&&(o+="$"+a(e)),t!==ut&&(o+="$"+(t+1)),o+=":",i!==ut&&(o+="$"+a(i)),n!==ut&&(o+="$"+(n+1)),r?s(r)+"!"+o:o)}function At(e,i,r){Z.Workbook.fh&&ct(Z.Workbook.fh,function(t,n){var n=n[i];n&&n.call.apply(n,o([e],r,!1))})}function It(t,n){for(var e,i,r,o,a,u,s,c,f,l,l,l,l,f,e=ft(t),i=[],r=0,o=0,a=0,u=0,s=0,c=0;c<e;c++)(f=lt(t,c))&&(f.wp=c+1,(l=f.tables)&&0<l.all().length&&l.all().forEach(function(t){++r,t._id=r+""}),(l=f.charts)&&0<l.all().length&&l.all().forEach(function(t){++o,t.wp=o}),(l=f.pictures)&&0<l.all().length&&l.all().forEach(function(t){++a,t.wp=a}),(l=f.pivotTables)&&0<l.all().length&&l.all().forEach(function(t){++s,t.Mp=s}),f=h(n),i.push(f),n.c_.push({n_:v,Id:ot+f,Type:J.RelationshipConstants.fo,Target:d("worksheets/"+it+f)}));return y(n),t.Cp={slicer:0,timeline:0,drawing:0,vmlDrawing:0},i}function y(t){var n=ot+h(t);t.c_.push({n_:v,Id:n,Type:J.RelationshipConstants.Xs,Target:d("sharedStrings")}),n=ot+h(t),t.c_.push({n_:v,Id:n,Type:J.RelationshipConstants.Ks,Target:d("styles")}),n=ot+h(t),t.c_.push({n_:v,Id:n,Type:J.RelationshipConstants.$s,Target:d("theme/theme1")})}function ft(t){return t.getSheetCount()+t.getSheetTabCount()}function lt(t,n){var t=t.e2(n);return t instanceof u.Worksheet?t:t&&t.Mf}function xt(t){return t.substring(0,19)===f}function Nt(t){return t.substring(0,23)===c}function kt(t,n){var e=t;return 255<e.length?e=e.slice(-240):250<(e=n+" "+e).length&&(e=t+" "+Math.random().toString(36).slice(-6)),e}function w(t){for(var n,e,i,n=ft(t),e=0;e<n;e++)if(i=lt(t,e).hl)return i}function Dt(t,n,e,i){var r,o,a,u,e,a=t.themeFont;return"Body"===a?o=e||(u=w(n))&&u.bodyFont():"Headings"===a&&(o=i||(u=w(n))&&u.headerFont()),r=o&&t.font?(e=K.util._0(t.font)).fontWeight+" "+e.fontStyle+" "+e.fontSize+" "+o:t.font||l}function _t(){return{fileVer:"1.0",proName:"sjs",proVer:K.productInfo.productVersion}}function Et(){var t=new j.Style;return t.font="14.67px Calibri",t.foreColor="Text 1",t.borderLeft=new j.LineBorder,t.borderRight=new j.LineBorder,t.borderTop=new j.LineBorder,t.borderBottom=new j.LineBorder,t.name="Normal",t.backColor={type:0},t}function M(t,n){var n=n.state;"hidden"===n?t.visible($.SheetTabVisible.hidden):"veryHidden"===n&&t.visible($.SheetTabVisible.veryHidden)}function jt(t,n,e,i,r,o,a){var t,u,n,i,i,t=lt(t,i),u=o.loadStatus,n=n[i];t.loading=!0,i=(i=H(e,"sheetData"))&&i.rowCount||200,u.total+=i,t.NMi?(t.NMi.yh(e,r,o),t.NMi.E0i=e.order):(t.yh(e,r,o,a),t.E0i=e.order),M(t,n)}function V(t){var n,t,n=t.getActiveSheet();return n||(t=t.getActiveSheetTab())&&(n=t.Mf),n}function Ot(t){for(var n=0,e=ft(t);n<e;n++)delete lt(t,n).loading}function Rt(t,n,e,i){var t=t;U.culture(n),t.Bp=!1,e&&i&&i.Zg(),t.resumeEvent(),t.Cg(),t.resumePaint()}o=this&&this.__spreadArray||function(t,n,e){if(e||2===arguments.length)for(var i=0,r=n.length,o;i<r;i++)!o&&i in n||((o=o||Array.prototype.slice.call(n,0,i))[i]=n[i]);return t.concat(o||Array.prototype.slice.call(n))},Object.defineProperty(t,"__esModule",{value:!0}),t.Sp=t.Tp=t.Ap=t.Ip=void 0,Z=n("./dist/core/workbook/workbook.js"),j=n("./dist/core/worksheet/style.js"),W=n("./dist/core/util/domUtil.js"),G=n("./dist/core/util/tasks.js"),Q=n("./dist/core/excel-io-util/common.js"),J=n("./dist/core/excel-io-util/excel-types.js"),e=n("Common"),K=n("./dist/core/util/common.js"),X=n("CalcEngine"),q=n("./dist/core/util/styleManager.js"),Y=n("./dist/core/util/theme.js"),$=n("./dist/core/core.enum.js"),r=n("./dist/core/core.ns.js"),u=n("./dist/core/worksheet/worksheet.js"),tt=!!X,O=j.Style.xp,R=e.Commands.UndoManager,U=e.Common.CultureManager,nt=e.Common.lt.tv,a=Q.IndexHelper.nr,H=K.util.xr,ht=K.util.o1,h=Q.Util.wr,d=Q.Util.Mr,dt=Q.Util.Sr,vt=Q.Util.addXLFNPrefix,s=Q.IndexHelper.ir,mt=K.util.Pr,gt=K.mt.n1,et=K.mt.vo,pt=Q.Util.io,c="__builtInValidatorStyle",f="__builtInTableStyle",it=J.XFileConstants.ru,rt=J.XFileConstants.mo,ot=J.XFileConstants.Rr,v=J.XFileConstants.Lr,bt=J.XFileConstants.Ki,yt=J.XFileConstants.ou,at=e.Common.lt.ht,ut=void 0,n=new e.Common.ResourceManager(r.SR,"Sheets"),st=n.getResource.bind(n),l="normal normal normal 11pt/normal Calibri",ct=W.GC$.each,z=K.mt.T1,m=parseFloat,t.Ip=p,Z.Workbook.prototype.toJSON=function(t){return this.Np(t)},Z.Workbook.prototype.Np=function(e,t){var i,r,n,o,a,u,s,c,f,l,h,d,v,m,g,p,l,f,l,b,y,w,w,M,C,S,T,A,I,x,N,k,D,_,i=this,r={version:K.productInfo.productVersion},a=e&&e.rowHeadersAsFrozenColumns,u=e&&e.columnHeadersAsFrozenRows,s=a||u;if(s&&(e.kp=!0),i.Dp&&(r.docProps=nt(i.Dp)),tt&&(n=X.Functions.setLanguagepackage)&&(o=n(),n("en")),this._p&&this._p.Ep(this),c=i.getSheetCount(),r.sheetCount=c,s)for(f=new Z.Workbook,l=e&&e.includeAutoMergedCells,f.fromJSON(i.toJSON({includeBindingSource:!0,includeAutoMergedCells:l}),{gp:!0}),i=f,h=0;h<c;h++)v=(d=i.getSheet(h)).getRowCount(1),m=d.getColumnCount(2),p=u&&0<v,(g=a&&0<m)&&d.addColumns(0,m),p&&d.sfe(0,v,3,p),g&&d.jp(m,p?v:0),p&&d.Op(v,g?m:0);for(i.Bp=!0,i.suspendPaint(),i.suspendEvent(),tt&&((l=i.Lp).calcOnDemand&&(l.calcOnDemand=!1,i.Fp(),l.suspend(!0),l.resume(!0),l.calcOnDemand=!0),l.forceR1C1Formula=e&&e.forceR1C1Formula,l.suspend(!0)),(f=i.startSheetIndex())&&(r.startSheetIndex=f),ct(i.options,function(t,n){"_ps"!==t&&Z.Workbook.Pp[t]!==n&&(r[t]=n)}),(l=i.getActiveSheetIndex())!==Z.Workbook.Gp&&(r.activeSheetIndex=l),b={},y=0;y<c;y++)d=i.getSheet(y),w=e,at(t)||y===t||(w={}),(w=d.toJSON(w)).index=y,w.order=d.E0i,b[d.name()]=w;for(W.GC$.isEmptyObject(b)||(r.sheets=b),M={},C=i.getSheetTabCount(),S=i.getActiveSheetTabIndex(),I=A=T=0;I<C;I++)(N=(x=i.Efe(I)).toJSON(e))?(N.index=c+I-T,N.order=x.E0i,M[x.name()]=N,A++):(T++,I<=S&&S--);if(r.sheetTabCount=A,-1!==S&&(r.activeSheetTabIndex=S),W.GC$.isEmptyObject(M)||(r.sheetTabs=M),k=[],D=i.Hp){for(_ in D)B(D,_)&&k.push(D[_]);0<k.length&&(r.namedStyles=k)}return Z.Workbook.fh&&ct(Z.Workbook.fh,function(t,n){n.toJson&&n.toJson.call(i,r,e)}),tt&&n&&n(o),i.Bp=!1,tt&&(delete i.Lp.forceR1C1Formula,i.Lp.resume(!1)),i.resumeEvent(),i.resumePaint(),s&&delete e.kp,r},Z.Workbook.prototype.fromJSON=function(e,i){var r,t,o,n,t,a,u,s,c,f,l,h,d,v,m,g,p,b,y,w,M,C,S,T,A,I,x,N,k,D,_,E,r=this;if(r.zp(),e){if(r.Vp&&r.Vp.terminate(),i&&i.incrementalLoading)return!0===i.incrementalLoading&&(i.incrementalLoading={}),r.Yp(e,i);t=L(e.version),n={noSchema:o=t<3,version:t},t=K.hi.ai(),r.Bp=!0,r.suspendPaint(),r.suspendEvent(),a=U.culture(),U.culture("");try{for(l in r.Zp(),r.Wp=new R(r,-1,r.options.allowUndo),tt&&(r.Qp(!0),r.Lp.suspendAdjust(),r.Lp.forceR1C1Formula=i&&i.forceR1C1Formula),r.Kp=-1,r.clearSheets(),r.clearSheetTabs(),u=r.options,s=e.canUserEditFormula,z(s)&&(u.allowUserEditFormula=s),c=e.allowDragDrop,z(c)&&(u.allowUserDragDrop=c),f=e.allowDragFill,z(f)&&(u.allowUserDragFill=f),u)B(u,l)&&(h=e[l],z(h))&&(u[l]=h);if(r.Dp=nt(e.docProps),At(r,"preFromJson",[e,o,i]),d=e.sheetCount,z(d)||(d=Z.Workbook.Jp),r.Xp(d,0),r.Hp={},r.qp={},v=e.namedStyles)for(m=0,g=v;m<g.length;m++)p=g[m],b=new j.Style,O(p,r),b.fromJSON(p,o,r),r.$p(b);if(w=void(y=0),M=e.sheets,S=C=void 0,A=!(T=!1),M)for(I in M)"string"==typeof I&&(x=M[I],N=z(x.index)?x.index:x.lp,w=r.sheets[z(N)?N:y])&&(x.isApplyRefilter=i&&i.isApplyRefilter,w.fromJSON(x,!1,n,i,!0),w.E0i=x.order,y++,S=x.allowUndo,T?A=A&&S===C:(C=S,T=!0));z(C)&&A&&(u.allowUndo=C),P(r,e),0<r.mp.length?(Ct(r,e,n,i),St(r,e)):0<=e.activeSheetTabIndex&&(e.activeSheetIndex=0),k=e.activeSheetIndex,z(k)||(k=Z.Workbook.Gp),r.tb(k,0,ut,ut,!0),(D=r.sheets[k])&&D.b2(!0,!1),r.hse=r.dse(r.sheets,r.mp),_=e.startSheetIndex,z(_)&&r.startSheetIndex(_),E=e.backgroundImage,z(E)&&r.nb(),Z.Workbook.fh&&ct(Z.Workbook.fh,function(t,n){var n=n.fromJson;n&&n.call(r,e,o,i)}),tt&&r.Lp.resumeAdjust(),F.call(r,e,i),Z.Workbook.et(r,"initCustomName")}finally{tt&&(r.Lp.resumeAdjust(),delete r.Lp.forceR1C1Formula),U.culture(a),r.Bp=!1,D=r.getActiveSheet(),t&&D&&D.Zg(),r.resumeEvent(),r.Cg(),r.resumePaint(),D&&r.ki(K.Events.FormulaTextboxActiveSheetChanged,{oldSheet:void 0,newSheet:D}),tt&&r.Lp.processDynamicRef()}}},Z.Workbook.prototype.Yp=function(e,i){var o,t,n,r,t,a,u,s,c,f,l,h,d,v,m,g,p,b,y,w,M,C,S,T,A,I,x,N,k,D,_,o=this;o.Vp=new G.Tasks(function(){var t,n,e,e,t=o.getActiveSheet();if(t&&!t.loaded)for(n=this.tasks.length-1;0<=n;n--)if((e=this.tasks[n].args[0])&&e.Ut&&e.name&&e.name()===t.name())return e=this.tasks[n],this.tasks.splice(n,1),e;return this.tasks.pop()},function(){var t=o.getActiveSheet();return t&&(o.ib.eb||t.isEditing()||t.rt.rb||t.rt.ob||t.rt.ab)}),t=L(e.version),r={noSchema:n=t<3,version:t},t=K.hi.ai(),o.Bp=!0,o.suspendPaint(),o.suspendEvent(),a=U.culture(),U.culture("");try{for(l in o.Zp(),o.Wp=new R(o,-1,o.options.allowUndo),tt&&(o.Qp(!0),o.Lp.suspendAdjust()),o.Kp=-1,o.clearSheets(),o.clearSheetTabs(),u=o.options,s=e.canUserEditFormula,z(s)&&(u.allowUserEditFormula=s),c=e.allowDragDrop,z(c)&&(u.allowUserDragDrop=c),f=e.allowDragFill,z(f)&&(u.allowUserDragFill=f),u)B(u,l)&&(h=e[l],z(h))&&(u[l]=h);if(o.Dp=nt(e.docProps),At(o,"preFromJson",[e,n,i]),d=e.sheetCount,z(d)||(d=Z.Workbook.Jp),o.Xp(d,0),o.Hp={},v=e.namedStyles)for(m=0;m<v.length;m++)g=v[m],p=new j.Style,O(g,o),p.fromJSON(g,n,o),o.$p(p);if(b=0,w=e.sheets,C=M=void 0,T=!(S=!1),w)for(I in A={total:0,valuesLoad:0,formulaLoad:0},i.incrementLoadTask=o.Vp,i.incrementalLoading.loadStatus=A,w)"string"==typeof I&&(x=w[I],N=z(x.index)?x.index:x.lp,(y=o.sheets[z(N)?N:b]).loading=!0,y.ub(x.name+"",!0),y.b2(x.isSelected),y.setRowCount(x.rowCount),y.setColumnCount(x.columnCount),z(x.visible)&&y.visible(x.visible),A.total+=y.getRowCount(),o.Vp.addTask(function(t,n){n.isApplyRefilter=i&&i.isApplyRefilter,t.Yp(n,!1,r,i,!0),t.E0i=n.order},[y,x]),b++,C=x.allowUndo,S?T=T&&C===M:(M=C,S=!0));z(M)&&T&&(u.allowUndo=M),P(o,e),0<o.mp.length?(Ct(o,e,r,i),St(o,e)):0<=e.activeSheetTabIndex&&(e.activeSheetIndex=0),k=e.activeSheetIndex,z(k)||(k=Z.Workbook.Gp),o.tb(k,0,ut,ut,!0),(D=o.sheets[k])&&D.b2(!0,!1),_=e.startSheetIndex,z(_)&&o.startSheetIndex(_),o.Vp.endingCallback=function(){Z.Workbook.fh&&ct(Z.Workbook.fh,function(t,r){r.Yp?o.Vp.addTask(function(t,n,e,i){r.Yp.call(t,n,e,i)},[o,e,n,i]):r.fromJson&&r.fromJson.call(o,e,n,i)}),o.Vp.endingCallback=function(){var t,n,n;for(o.hse=o.dse(o.sheets,o.mp),tt&&o.Lp.resumeAdjust(),F.call(o,e,i),Z.Workbook.et(o,"initCustomName"),tt&&o.Lp.processDynamicRef(),t=0;t<o.sheets.length;t++)delete o.sheets[t].loading;(y=o.getActiveSheet())&&o.ki(K.Events.FormulaTextboxActiveSheetChanged,{oldSheet:void 0,newSheet:y}),i&&i.incrementalLoading&&(n=i.incrementalLoading,o.ki(K.Events.ProgressChanged,{loadStatus:n.loadStatus,progress:1,sheet:y}),n.loading)&&n.loading(1,{sheet:y}),(n=i&&i.incrementalLoading&&i.incrementalLoading.loaded)&&n(),y&&y.repaint(),o.w2.repaint(),o.Vp.endingCallback=void 0},o.Vp.start()},o.Vp.start()}finally{U.culture(a),o.Bp=!1,D=o.getActiveSheet(),t&&D&&D.Zg(),o.resumeEvent(),o.Cg(),o.resumePaint()}},Z.Workbook.prototype.getSheetRelsName=function(t){var t,n,t=t.split("/").pop(),n=t.lastIndexOf(".xml");return t.substring(0,n)},Z.Workbook.prototype.getSheetRelsDir=function(t){var t,t,t=t.split("/"),t=t[t.length-2];return"worksheets"!==t?t:"sheets"},t.Ap=ft,t.Tp=lt,Z.Workbook.prototype.wh=function(e){var i,t,n,r,o,B,n,r,t,a,u,r,n,s,c,f,L,s,l,F,h,d,v,m,s,g,p,b,y,w,P,G,M,C,S,U,r,H,z,n,V,Y,T,A,I,x,I,N,k,D,_,E,j,O,_,E,j,O,R,j,_,E,O,R,_,j,D,r,i=this;if(i._p&&i._p.Ep(i),t=0<i.mp.length&&(e&&e.fileType)===$.OpenSaveFileType.excel,n=e&&e.rowHeadersAsFrozenColumns,r=e&&e.columnHeadersAsFrozenRows,o=!e||!1!==e.includeStyles,(B=n||r||t)&&(n=new Z.Workbook,r=e&&e.includeAutoMergedCells,n.fromJSON(i.toJSON({includeBindingSource:!0,includeAutoMergedCells:r}),{sb:!0,cb:e&&e.fileType}),i=n),t=i.options,(u=(a={}).workbook={n_:"workbook",c_:[],lossless:{version:_t(),renamedStylesMap:{},customData:e&&e.customData},rels:{}}).c_.push(r={n_:"bookViews",c_:[]}),!(n={n_:"workbookView"})===t.showHorizontalScrollbar&&(n.showHorizontalScroll="0"),!1===t.showVerticalScrollbar&&(n.showVerticalScroll="0"),!1===t.tabStripVisible&&(n.showSheetTabs="0"),(s=i.startSheetIndex())&&(n.firstSheet=s),-1!==(c=i.ep()))for(f=c;0<=f;f--)2===(L=i.e2(f))._gi&&c--;for(c!==Z.Workbook.Gp&&(n.activeTab=c),"number"==typeof(s=t.tabStripRatio)&&.6!==s&&(n.tabRatio=1e3*s),r.c_.push(n),i.Dp&&(a.docProps=nt(i.Dp)),ct(i.options,function(t,n){"_ps"!==t&&Z.Workbook.Pp[t]!==n&&(u.lossless[t]=n)}),tt&&(l=X.Functions.setLanguagepackage)&&(F=l(),l("en")),h={},d=ft(i),v=i.getNamedStyles(),m=new q.StyleManager,s=new K.SharedStrings,p=!(g={styleManager:m,sharedStrings:s}),b=[{style:null}],y={},w={},P=u.lossless.renamedStylesMap,Object.keys(v).forEach(function(t){var n=v[t].name;n!==st().NORMAL?b.push({style:v[t]}):(b[0].style=v[t],p=!0),y[n]=1}),G=function(r){var o,a,o=lt(i,r);if(!o)return"continue";a=o.getNamedStyles(),Object.keys(a).forEach(function(t){var n,e,i,n=a[t].name;if(!Nt(n)&&!xt(n)){for(e=n,i=nt(a[t]);y[e]||255<e.length;)e=kt(e,o.name());i.name=e,p||i.name!==st().NORMAL?b.push({sheetId:r,style:i}):(b[0]={sheetId:r,style:a[t]},p=!0),y[e]=1,n!==e&&(w[n]=w[n]||{},w[n][o.name()]=e,P[e]=n)}})},f=0;f<d;f++)G(f);for(m.gv=w,(M=Q.Util.ko(e))||o&&b[0]&&b[0].style?!M||b[0]&&b[0].style||b.shift():(S=lt(i,0),C=o&&S&&!S.NMi?S.getDefaultStyle():{},U=Et(),Object.keys(C).forEach(function(t){"_id"!==t&&"name"!==t&&(U[t]=C[t])}),b[0]={style:U},p=!0),b.forEach(function(t){m.getNamedStyleIndex(t.style,3,ut,t.sheetId,!M)}),M||(r=b[0].style.clone(!0),(0,K.AL)(r),m.getStyleIndex(r)),m.updateNamedStylesParentName(),C=p?b[0]&&b[0].style:(S=lt(i,0),o&&S&&!S.NMi?S.getDefaultStyle():Et()),K.SJSColumnWidthHelper.setMaxDigitWidth(Dt(C,i)),Z.Workbook.fh&&ct(Z.Workbook.fh,function(t,n){n.preToSJSFormat&&n.preToSJSFormat.call(i,a,g,e)}),z={n_:rt,c_:[]},n={n_:J.XFileConstants.Dr,xmlns:J.RelationshipConstants._r},V=It(i,n),Y=0,a.workbook.rels=n,T=0;T<d;T++)if(S=lt(i,T)){if(A=V[Y],Y++,I=it+A,(x=(S.NMi||S).wh(a,g,e)).order=(S.NMi||S).E0i,h[I]=x,I=S.name(),o&&S.hl&&!H&&(a.theme=H=x&&x.lossless&&x.lossless.theme),(N=x.lossless.definedNames||[])&&N.length)for(f=0;f<N.length;f++)k=N[f],N[f]={n_:"definedName",name:k.name,localSheetId:T,e:k.e,comment:k.comment,c_:[k.formula]};(D=x.printInfo)&&(_=D.rowStart,E=D.rowEnd,j=D.columnStart,O=D.columnEnd,-1===_&&-1===E&&-1===j&&-1===O||(_=S.getCalcService(),E=S.Uw(),_&&E&&(j=S.getCustomName("Print_Area"))&&(O=j.getExpression(),R=j.getRow(),j=j.getColumn(),_=_.unparse(E,O,R,j,!1,!0,!0),N.push({n_:"definedName",name:"_xlnm.Print_Area",localSheetId:T,c_:[et(vt(_))]}))),E=Tt(D.repeatRowStart,D.repeatRowEnd,ut,ut,I),O=Tt(ut,ut,D.repeatColumnStart,D.repeatColumnEnd,I),R=void 0,E&&O?R=O+","+E:E?R=E:O&&(R=O),R&&N.push({n_:"definedName",name:"_xlnm.Print_Titles",localSheetId:T,c_:[et(vt(R))]}),delete x.printInfo),x.lossless.definedNames=N,j=void 0,(_=S.visible())===$.SheetTabVisible.hidden?j="hidden":_===$.SheetTabVisible.veryHidden&&(j="veryHidden"),D={n_:it,"r:id":ot+A,name:et(I),sheetId:A,state:j,lossless:{tabSelected:S.b2()?"1":ut}},z.c_.push(D)}return a.workbook.c_.push(z),W.GC$.isEmptyObject(h)||(a.sheets=h),a.styles={},Z.Workbook.fh&&ct(Z.Workbook.fh,function(t,n){n.wh&&n.wh.call(i,a,g,e)}),a.styles=m.bv(a.styles,m.wh(e)),a.sharedStrings=s.wh(),m.dispose(),1!==t.referenceStyle&&at(t.iterativeCalculation)&&at(t.iterativeCalculationMaximumIterations)&&at(t.iterativeCalculationMaximumChange)||(r={n_:"calcPr",calcId:0},1===t.referenceStyle&&(r.refMode="R1C1"),!0===t.iterativeCalculation&&(r.iterate=1),at(t.iterativeCalculationMaximumIterations)||(r.iterateCount=t.iterativeCalculationMaximumIterations),at(t.iterativeCalculationMaximumChange)||(r.iterateDelta=t.iterativeCalculationMaximumChange),a.workbook.c_.push(r)),mt(a.workbook,J.WorkbookNodeOrder),tt&&l&&l(F),a},Z.Workbook.prototype.fb=function(t,n){var e,t,e=this;U.culture(""),e.Zp(),n&&n.calcOnDemand&&(e.options.calcOnDemand=!0),n&&!1===n.dynamicReferences&&(e.options.dynamicReferences=!1),!0===t&&(e.options.allowDynamicArray=!0),e.Wp=new R(e,-1,e.options.allowUndo),tt&&(e.Qp(!0),(t=e.Lp).suspendAdjust(),t.suspend(),t.lb=n&&!n.fullRecalc),e.Kp=-1,e.clearSheets(),e.clearSheetTabs()},Z.Workbook.prototype.hb=function(t){var n,e,i,r,r,r,o,a,r,r,n,e=this.options,i=t.workbook.lossless;if(i)for(o in r=i.canUserEditFormula,z(r)&&(e.allowUserEditFormula=r),r=i.allowDragDrop,z(r)&&(e.allowUserDragDrop=r),r=i.allowDragFill,z(r)&&(e.allowUserDragFill=r),e)B(e,o)&&(a=i[o],z(a))&&(e[o]=a);(r=H(t.workbook,"extLst"))&&r.c_&&r.c_[0]&&r.c_[0]["xmlns:xcalcf"]===J.XFileConstants.Cs&&(e.allowDynamicArray=!0),(r=H(t.workbook,"calcPr"))&&("R1C1"===r.refMode&&(e.referenceStyle=1),e.iterativeCalculation=1===parseInt(r.iterate,10),e.iterativeCalculationMaximumIterations=at(r.iterateCount)?100:parseInt(r.iterateCount,10),e.iterativeCalculationMaximumChange=at(r.iterateDelta)?.001:parseFloat(r.iterateDelta))},Z.Workbook.prototype.db=function(t){var n,e,t,t,e,n=this,e=n.options,t=H(t.workbook,"bookViews"),t=H(t,"workbookView");t&&(t.showHorizontalScroll&&(e.showHorizontalScrollbar="0"!==t.showHorizontalScroll),t.showVerticalScroll&&(e.showVerticalScrollbar="0"!==t.showVerticalScroll),t.showSheetTabs&&(e.tabStripVisible="0"!==t.showSheetTabs),e.tabStripRatio=at(t.tabRatio)?.6:t.tabRatio/1e3,t.firstSheet&&n.startSheetIndex(+t.firstSheet),e=+t.activeTab||0,n.I2(e,2))},Z.Workbook.prototype.mb=function(t,n,e,i,r,o,a){var u,s,c,f,l,h,d,v,m,g,p,b,g,p,g,y,p,g,w,g,u=this,s=r.sheetNamedStyles;for(d in o=o||{},c=!(u.Hp={})!==a.includeUnusedStyles,f=n.styles&&n.styles.namedStylesMap,l=Q.Util.ko(a),h=!0,f)f.hasOwnProperty(d)&&(v=h&&(d===st().NORMAL||!l&&0===f[d]),!c&&!v&&at(t.originNamedStylesXfs.Lh[d])||(m=t.getNamedStyle(f[d],d,l),at(m)&&(m={foreColor:"Text 1 0",themeFont:"Body",font:"normal normal 14.7px Calibri",locked:!0,textIndent:0,wordWrap:!1,vAlign:2,hAlign:3}),v&&(h=!1,m.name="Normal",m.font=Dt(m,u,i,e),K.SJSColumnWidthHelper.setMaxDigitWidth(m.font),r.defaultStyle=m),m.name=o[m.name]||m.name,m.sheetId!==ut?(s[m.sheetId]||(s[m.sheetId]=[]),s[m.sheetId].push(m)):u.$p(m)));!1!==h&&(g=H(n.workbook,rt).c_,p=n.workbook.rels&&n.workbook.rels.c_,g=(b=g[0])[bt],w=y=void 0,w=(w=(y=(g=(p=dt(p,g))&&p.Target)?(p=u.getSheetRelsName(g),n[g=u.getSheetRelsDir(g)]&&n[g][p]):n.sheets.sheet1)?y.lossless&&y.lossless.defaultStyle:w)||{hAlign:3,imeMode:1,themeFont:"Body",vAlign:0},(g=new j.Style).fromJSON(w,ut,ut),g.font=Dt(g,u,i,e),K.SJSColumnWidthHelper.setMaxDigitWidth(g.font),r.defaultStyle=g),a&&a.fileType===$.OpenSaveFileType.excel&&t.buildDummyNamedStyles(u)},t.Sp=V,Z.Workbook.prototype.yh=function(r,o,e){var t,n,a,u,i,s,c,f,l,h,d,v,m,g,p,b,y,w,M,C,S,T,A,I,x,N,k,B,D,L,F,_,E,j,O,P,R,a=this;if(a.zp(),r){e=e||function(){},u=Q.Util.Mo(o),(o=o||{}).progress||(o.progress=function(t){}),o.loadStatus={total:0,valuesLoad:0,formulaLoad:0},i=function(t){a.pb(K.Events.ProgressChanged,{loadStatus:o.loadStatus,progress:t.progress,sheetName:t.sheetName}),o.progress({step:t.step,sheetName:t.sheetName,progress:t.progress})},a.Vp&&a.Vp.terminate(),a.Vp=new G.LoadTasks(function(){var t,n,e,e,t=V(a);if(t&&!t.loaded)for(n=this.tasks.length-1;0<=n;n--)if((e=this.tasks[n].args[0])&&e.Ut&&e.name&&e.name()===t.name())return e=this.tasks[n],this.tasks.splice(n,1),e;return this.tasks.pop()},function(){var t=V(a);return u&&t&&(a.ib.eb||t.isEditing()||t.rt.rb||t.rt.ob||t.rt.ab)},i),a.suspendPaint(),a.suspendEvent(),s=K.hi.ai(),a.Bp=!0,c=U.culture(),f=!1;try{if(a.fb(r.workbook.lossless&&r.workbook.lossless.allowDynamicArray,o),a.hb(r),a.Dp=nt(r.docProps),(l=new q.StyleManager).yh(r.styles),(h=new K.SharedStrings).yh(r.sharedStrings),d={},Object.keys(r).forEach(function(t){-1<t.indexOf(yt)&&(d[t]=r[t])}),v=void 0,v=(r.sheets&&r.sheets.sheet1&&r.sheets.sheet1.lossless&&r.sheets.sheet1.lossless.theme?r.sheets.sheet1.lossless:r).theme,g=m=void 0,v&&"string"!=typeof v?v&&(b=H(v,"themeElements"),y=H(b,"fontScheme"),m=ht(y,"majorFont&latin").typeface,g=ht(y,"minorFont&latin").typeface):((p=new Y.Theme(ut)).yh("string"==typeof v?v:"Office"),m=p.headerFont(),g=p.bodyFont()),w={drawings:r.drawings,tables:r.tables,charts:r.charts,media:r.media,ctrlProps:r.ctrlProps,comments:d,pivotTables:r.pivotTables,slicers:r.slicers,slicerCaches:r.slicerCaches,timelineCaches:r.timelineCaches,timelines:r.timelines,styleManager:l,sharedStrings:h,theme:r.theme,sheetNamedStyles:{},dataEffectByInflate:{}},a.mb(l,r,m,g,w,r.workbook.lossless&&r.workbook.lossless.renamedStylesMap,o),M=H(r.workbook,rt).c_.length,z(M)||(M=Z.Workbook.Jp),Z.Workbook.fh&&ct(Z.Workbook.fh,function(t,n){var n=n.preFromSJSFormat;n&&n.call(a,r,w,o)}),C=H(r.workbook,"definedNames"),w.workbookNames=C&&C.c_,S=H(r.workbook,rt).c_,T=r.workbook.rels&&r.workbook.rels.c_,o&&(o.incrementLoadTask=a.Vp),S&&T){for(A=[],I=[],x=0;x<M;x++)k=(N=S[x])[bt],(D=(B=dt(T,k))&&B.Target)&&(L=a.getSheetRelsName(D),F=a.getSheetRelsDir(D),E=(_=r[F][L]).lossless&&_.lossless.addition,j=pt(gt(N.name)),E?(O=a.bb(j,0),a.yb(x-a.sheets.length,0,O),A.push([O,E])):(P=a.S2(j),a.A2(x,0,P)),I[x]=_);for(x=0;x<M;x++)(_=I[x])&&jt(a,S,_,x,w,o,!Q.Util.wo(o,a.v2));Mt(A,a,o&&o.fullRecalc,!0)}a.db(r),R={},null!=(n=null==(t=r.workbook)?void 0:t.lossless)&&n.customData&&(R.customData=r.workbook.lossless.customData),a.Vp.endingCallback=function(){a.wb(),Z.Workbook.fh&&ct(Z.Workbook.fh,function(t,n){var i=u&&n.Mb||n.yh;i&&a.Vp.addTask(function(t,n,e){i.call(a,r,w,o)},[a,r,o])}),a.Vp.endingCallback=function(){var t,n,n;l.dispose(),Q.Util.wo(o,a.v2)||wt.call(a,o),t=!1,tt&&((n=a.Lp).resumeAdjust(),o.fullRecalc?(Ot(a),n.resume(!(t=!0))):(n.resumeWithoutCalc(),delete n.lb,a.Lp.processDynamicRef())),Z.Workbook.et(a,"initCustomName"),t||Ot(a),a.options.backgroundImage&&a.nb(),n=V(a),i({progress:1,step:"whole workbook loaded.",sheetName:n&&n.name()}),u?n&&n.repaint():Rt(a,c,s,n),n&&a.ki(K.Events.FormulaTextboxActiveSheetChanged,{oldSheet:void 0,newSheet:n}),e(R)},a.Vp.start()},a.Vp.start()}catch(t){f=!0}finally{(u||f)&&Rt(a,c,s,V(a))}}}},"./dist/core/workbook/workbook.js":function(D,L,t){"use strict";var u,n,o,w,_,F,P,G,U,H,z,f,V,Y,M,Z,W,Q,J,K,X,b,E,c,t,q,$,tt,y,j,l,O,nt,R,et,B,it,rt,ot,at,a,s,ut,st,ct,v,ft,e,lt,h,ht,d,dt,m,g,p,vt,mt,gt,pt,bt,yt,C,wt,Mt,Ct,S,T,A,St,I,x,Tt,At,It,xt,Nt,kt,n,N,Dt,_t,Et,r,jt,n;function Ot(t){t.getActiveSheet()}function Rt(t,n){return _.Bf.Zl()%1!=0||t.zoom()%1!=0||t.parent&&t.parent.options.scrollByPixel&&n&&t.Cb&&t.Cb.Sb((0,_.Ec)(t.Tb,t.Ab,1,1))}function Bt(n,e){return j.setTimeout(function(){n.invalidateLayout(),n.repaint(),e.Ib=O;var t=n.ot();e.xb(n,t.x,t.width),e.Nb(n,t.y,t.height)},200)}function Lt(t,n,e){t.ki(_.Events.ActiveSheetChanged,{oldSheet:n,newSheet:e})}function Ft(t,n){t.ki(_.Events.ActiveSheetChanging,n)}function Pt(t,n){t.ki(_.Events.FormulaTextboxActiveSheetChanging,n)}function Gt(t,n,e){t.ki(_.Events.FormulaTextboxActiveSheetChanged,{oldSheet:n,newSheet:e})}function Ut(t,n){return void 0===n&&(n=12),+parseFloat(t.toPrecision(n))}function i(t){this.kb=t}function Ht(t,n){n?(0,w.GC$)(t).removeClass(S):(0,w.GC$)(t).addClass(S)}function zt(t,n,e){var i,r,n,o,n,i=_.I.fl("gc-vertical-scrollbar"+yt),o=2007<y(i.zIndex)?1:0,n=n-e,n=n%2==0?(r=n/2)-o:r=(n-o)/2;(0,w.GC$)(t).css({"box-sizing":pt,border:p,"border-color":p,"border-left-style":bt,"border-left-width":o+d,"border-left-color":i.borderLeftColor,"background-color":i.backgroundColor,width:e,padding:"0px "+r+"px 0px "+n+d,margin:0})}function Vt(t,n,e){var i,r,n,o,n,i=_.I.fl("gc-horizontal-scrollbar"+yt),o=2007<y(i.zIndex)?1:0,n=n-e,n=n%2==0?(r=n/2)-o:r=(n-o)/2;(0,w.GC$)(t).css({"box-sizing":pt,border:p,"border-color":p,"border-top-style":bt,"border-top-width":o+d,"border-top-color":i.borderTopColor,"background-color":i.backgroundColor,height:e,padding:n+"px 0px "+r+"px 0px",margin:0})}function Yt(t){var n=_.I.fl("gc-footer-corner"+yt);(0,w.GC$)(t).css({border:p,padding:0,margin:0,"background-color":n.backgroundColor})}function Zt(t,n,e,i,r){var o,a,n,o=t._b(),a=n.left-e.left,n=n.top-e.top;if(a<i&&i<o.width+a&&n<r&&r<o.height+n)return{horizontalScrollBarHitInfo:{element:t.hitTest(i-a,r-n).element},x:i,y:r}}function Wt(t,n,e,i,r){var o,a,n,o=t._b(),a=n.left-e.left,n=n.top-e.top;if(a<i&&i<o.width+a&&n<r&&r<o.height+n)return{verticalScrollBarHitInfo:{element:t.hitTest(i-a,r-n).element},x:i,y:r}}function Qt(t){var t=(0,w.GC$)(t);return{top:Jt(t,"borderTopWidth"),right:Jt(t,"borderRightWidth"),bottom:Jt(t,"borderBottomWidth"),left:Jt(t,"borderLeftWidth")}}function Jt(t,n){var e=t.css(n);switch(e){case"thin":return 1;case"medium":return 3;case"thick":return 5;default:return parseFloat(e)}}function Kt(t){var t=(0,w.GC$)(t);return{top:parseFloat(t.css("paddingTop")),right:parseFloat(t.css("paddingRight")),bottom:parseFloat(t.css("paddingBottom")),left:parseFloat(t.css("paddingLeft"))}}function Xt(t){var n,e,i,e,t,r,o,n=t.getBoundingClientRect().width,e=Qt(t),i=e.left,e=e.right,t=Kt(t),r,o;return n-i-e-t.left-t.right}function qt(t){return M.SheetType[t]}function $t(t){var n,e,i,r,o,n=t.getSheetCount(),e=t.getSheetTabCount();if(0!==n&&0!==e)for(i=t.qv(),r=0;r<i.length;r++)if(o=i[r],r<n&&o.NMi||n<=r&&!o.NMi)return;return 1}function k(t,n){var i,e,n,i=this;i.name="",i.Eb=!1,i.Kp=-1,i._2=0,i.jb=-1,i.Bp=!1,i.options=q(jt,function(t,n,e){i.Ob(t,n,e)}),i.Zp(n),n&&"white"===n.backColor?i.Rb=!0:i.Rb=!1,e=1,n&&typeof(n=n.sheetCount)==it&&(e=n),"string"==typeof t&&(t=l.getElementById(t)),i.Ti=t,i.Hc(e,t)}Object.defineProperty(L,"__esModule",{value:!0}),L.Workbook=void 0,u=t("./dist/core/workbook/workbookpanelex.js"),n=t("./dist/core/core.ns.js"),o=t("Common"),w=t("./dist/core/util/domUtil.js"),_=t("./dist/core/util/common.js"),F=t("./dist/core/util/imageLoader.js"),P=t("./dist/core/worksheet/worksheet-actions.js"),G=t("./dist/core/workbook/sheettab.js"),U=t("./dist/core/workbook/sheettab2007.js"),H=t("./dist/core/worksheet/stylehelper.js"),z=t("./dist/core/worksheet/clipboardhelper.js"),f=t("./dist/core/worksheet/worksheet.js"),V=t("CalcEngine"),Y=!!V,M=t("./dist/core/core.enum.js"),Z=t("DataManager"),W=o.Common.zf,Q=o.Commands.UndoManager,J=o.Commands.CommandManager,K=w.GC$.each,X=w.GC$.extend,b=Y,E=o.Common.lt.ht,c=_.mt.En,t=_.mt.p0,q=_.mt.b0,$=_.mt.yt,tt=o.Common.CultureManager,y=parseInt,j=window,l=document,O=null,nt=Math.round,R=Math.min,et=Math.floor,B=Math.abs,it="number",rt="mousedown",ot="mousemove",at="mouseup",a="mouseenter",s="mouseleave",ut="scroll",st="resize",ct="focus",v=".gcSpread",ft=".gcSpreadInternal",e=".gcScrollbar",lt="span",h="div",ht="table",d="px",dt="100%",m="gc-scroll-handle",g="gc-scroll-bar",p="none",vt="display",mt="block",gt="absolute",pt="content-box",bt="solid",yt=" ui-widget-header ui-state-default btn btn-default",C="gc-scroll-mobile-container",wt="gc-scroll-mobile-container-horizontal",Mt="gc-scroll-mobile-container-vertical",Ct="gc-scroll-mobile-spread-hovering",S="gc-scroll-mobile-state-hide",T="gc-scroll-mobile-state-hover",A=j.jQuery,St="cultureChanged",I="workbook",x="gcUIElement",Tt="gc-no-user-select",At="visible",It="overflow",xt="en-US",Nt=80,kt=1,n=new o.Common.ResourceManager(n.SR,"Sheets"),N=n.getResource.bind(n),Dt=100,_t=30,Et=40,i.Bb=function(t,n){var t,e,e,t=t.data,e=t.ib;e.Lb&&(j.clearTimeout(e.Lb),e.Lb=O),(e=t.jg())&&n&&e.Fb(t,n)},i.Pb=function(t){var t,n,t=t.data,n=t.jg();n&&n.Gb(t)},i.Ub=function(t,n){var e,i,r,r,i,r,i,e=t.data;e&&((i=e.getActiveSheet())?((r=e.zb.Hb)&&r.Vb&&(i.Oi=!0),i.Zg()):(r=e.getActiveSheetTab())&&r.Zg(),1===(i=e.options.showScrollTip)||3===i)&&(i=(r=(0,w.GC$)(t.srcElement||t.target)).parent(),r&&(r.hasClass(m)||r.hasClass(g))||i&&(i.hasClass(m)||i.hasClass(g)))&&e.ib.Yb(!1,t,n)},i.Zb=function(t,n){var t,e,e,t=t.data,e=t.ib;e.Lb&&(j.clearTimeout(e.Lb),e.Lb=O),(e=t.jg())&&n&&e.Wb(t,n)},i.Qb=function(t){var t,n,t=t.data,n=t.jg();n&&n.Kb(t)},i.Jb=function(t){var n,e,i,i,e,i,e,n=t.data;n&&((e=n.getActiveSheet())?((i=n.Xb.Hb)&&i.Vb&&(e.Oi=!0),e.Zg()):(i=n.getActiveSheetTab())&&i.Zg(),2!==(e=n.options.showScrollTip)&&3!==e||(i=(0,w.GC$)(t.srcElement||t.target))&&(e=i.parent(),i.hasClass(m)||e&&e.hasClass(m)||i.hasClass(g)||e&&e.hasClass(g))&&n.ib.Yb(!0,t))},i.qb=function(t,n){var t,e,e,e,n,t=t.data,e=t.ib;e.Lb&&(j.clearTimeout(e.Lb),e.Lb=O),(e=t.jg())&&n&&(e.onHorizontalDockScroll(t,n),1!==(e=t.options.showScrollTip)&&3!==e||(n=t.ib.$b(!1,!0),t.ny(n)))},i.ey=function(t){var t=t.data;t&&t.iy()},i.ry=function(t){var n,e,i,r,i,o,t,n=N(),e=t.data,i=t.scrollbar;e.options.enableAccessibility&&(r=(0,w.GC$)(i.oy()).offset(),i=i.hitTest(t.x-r.left,t.y-r.top),t=(o={thumbButton:n.ARIA_Scrollbar_Thumb_Button,trackButton:n.ARIA_Scrollbar_TRACK_Button,leftButton:n.ARIA_Scrollbar_Left_Button,rightButton:n.ARIA_Scrollbar_Right_Button,upButton:n.ARIA_Scrollbar_Top_Button,downButton:n.ARIA_Scrollbar_Bottom_Button})[i.element],e.n2(t))},i.prototype.L0=function(){this.kb=O},i.prototype.ay=function(t,n,e,i){var r=this;t&&(r.eb=!0,r.uy=i?t.Tb:n,r.fy=i?t.ly:e,r.hy=i?n:t.Ab,r.vy=i?e:t.my,j.setTimeout(function(){r.gy(t)},0))},i.prototype.gy=function(t){var n=this;t&&n.eb&&(n.eb=!1,n.py(t))},i.prototype.py=function(t){var n,e,i,r,o,a,u,n=this;n.by||(n.by=!0,e=n.kb,t&&(i=e.options.showScrollTip,r=n.uy,o=n.fy,a=n.hy,u=n.vy,r!==t.Tb||o!==t.ly?(n.yy(t,r,o),2!==i&&3!==i||e.ny(n.$b(!0))):a===t.Ab&&u===t.my||(n.wy(t,a,u),1!==i&&3!==i)||e.ny(n.$b(!1))),n.by=!1)},i.prototype.yy=function(t,n,e,i){var r,o,a,u,u,i,s,c,f,l,h,d,v,m,g,p,b,y,w,M,C,S,T,T,A,I,x,T,N,k,c,i,T,e,D,l,f,r=this;if(r.Ib&&(j.clearTimeout(r.Ib),r.Ib=O),t&&(o=t.Tb,a=t.ly,(u=!E(i))||n!==o||e!==a))if(u&&(o=i),t.Tb=n,t.ly=e,0<t.My)o!==n&&t.ki(_.Events.TopRowChanged,{sheet:t,sheetName:t.name(),oldTopRow:o,newTopRow:n});else{if(u=!1,c=(s=(i=t.options).sheetAreaOffset.top)+2,f=t.kg,h=(l=t.Fi()).Cy,d=t.Sy(l),v=l.Ty,m=l.Ay,g=l.Iy,p=l.width+i.sheetAreaOffset.left,w=y=b=void 0,C=(M=t.Dn).J(),S=t.Ny,t.tables&&0===t.frozenRowCount()&&(T=t.tables.Dy())&&(T.x=T.x-2,T.width=T.width+4,T.y=s,T.height=h,t.k1=!0,M.D1(C,T)),o<n||n===o&&B(e)>B(a)){if(A=T=void 0,T=(I=t._y(1))&&0<I.length?I.findRow(n):T){for(A=I[x=I.length-1];A&&A.y+A.height>h+d;)A=I[x-=1];A&&A.row>n&&(u=!0,y=(f||l).x,w=T.y+B(e),b=A.y+A.height-w-c,M.Ey(y,w,p,b,y,h),i.colHeaderVisible||(t.invalidateLayout(),M.D1(C,new _.Rect(y,0,p,s))),t.invalidateLayout(),M.D1(C,new _.Rect(y,h+b,p,(T=S?d:d+g+v)-b)),M.jy(C,new _.Rect(y,h-2,p,2+(T-=S?0:v))),this.xb(t,y,p))}}else{for(N=0,k=n;k<o&&N<d;k++)N+=t.Gt(k);(N+=B(a)-B(e))<d&&(u=!0,y=(f||l).x,w=h,b=d-N,0<t.frozenTrailingRowCount()&&--b,c=0,!S&&0<v&&(i=R(f.height-(c=g)-1,m-1+N),M.Ey(y,m-1,p,c+1,y,i)),T=S?0:R(N,v)-1,M.Ey(y,w,p,b+T,y,w+N),t.invalidateLayout(),e=t.rowOutlines&&!t.rowOutlines.Oy()?t.rowOutlines.Ry()+s+1:0,M.D1(C,new _.Rect(y,w-s,p,N+s+e+5)),M.jy(C,new _.Rect(y,w-2,p,D=d+T+c+2)),this.xb(t,y,p))}u||(t.invalidateLayout(),t.repaint()),o!==n&&t.ki(_.Events.TopRowChanged,{sheet:t,sheetName:t.name(),oldTopRow:o,newTopRow:n}),(l=t.rt)&&l.By(),f=o===t.Tb&&a!==t.ly,u&&Rt(t,f)&&(r.Ib=Bt(t,r))}},i.prototype.xb=function(t,n,e){var i=t.Dn,r=i.J();this.Ly(t).concat(this.Fy(t)).forEach(function(t){var t=t.layout,t=new _.Rect(n,t.y,e,t.height);i.O1(t),i.jy(r,t)})},i.prototype.Ly=function(t){var n,e,n,i,r,o,e,a,e,n=this,e=t.getSelections();return!(1===e.length&&0<t.frozenRowCount())||(n=n.kb.options.scrollByPixel,i=t.Tb,r=t.ly,o=e[0].row,e=e[0].row+e[0].rowCount-1,n&&e==i-1)?[]:(a=[],(o===i+1||o<i&&i<=e||e==i-1||n&&o===i&&0!==r)&&(e=t._y(0))&&0<e.length&&a.push({layout:e[e.length-1]}),a)},i.prototype.Fy=function(t){var n,e,n,i,r,e,o,a,u,a,t,s,t,s,n=this,e=t.getSelections();return 1===e.length&&0<t.frozenTrailingRowCount()?(n=n.kb.options.scrollByPixel,i=t.getViewportBottomRow(1),r=e[0].row,e=e[0].row+e[0].rowCount-1,o=[],a=(u=(a=t._y(2))&&0<a.length)?a[0]:O,t=(s=(t=t._y(1))&&0<t.length)?t.findRow(i):O,s=u&&s&&a.y!==t.y+t.height,(e==i-1||r<=i&&i<e||r===i+1||n&&e===i&&s)&&u&&o.push({layout:a}),o):[]},i.prototype.wy=function(t,n,e,i){var r,o,a,u,u,i,s,c,f,l,h,d,v,m,g,p,b,y,w,M,C,S,T,A,I,x,T,N,k,c,i,T,e,D,l,f,r=this;if(r.Ib&&(j.clearTimeout(r.Ib),r.Ib=O),t&&(o=t.Ab,a=t.my,(u=!E(i))||n!==o||e!==a))if(u&&(o=i),t.Ab=n,t.my=e,0<t.My)o!==n&&t.ki(_.Events.LeftColumnChanged,{sheet:t,sheetName:t.name(),oldLeftCol:o,newLeftCol:n});else{if(u=!1,c=(s=(i=t.options).sheetAreaOffset.left)+2,f=t.kg,h=(l=t.Fi()).Py,d=t.Gy(l),v=l.Uy,m=l.Hy,g=l.zy,p=l.height+i.sheetAreaOffset.top,w=y=b=void 0,C=(M=t.Dn).J(),S=t.Vy,o<n||n===o&&B(e)>B(a)){if(A=T=void 0,T=(I=t.Yy(1))&&0<I.length?I.findCol(n):T){for(A=I[x=I.length-1];A&&A.x+A.width>h+d;)A=I[x-=1];A&&A.col>n&&(u=!0,b=T.x+B(e),y=(f||l).y,w=A.x+A.width-b-c,M.Ey(b,y,w,p,h,y),i.rowHeaderVisible||(t.invalidateLayout(),M.D1(C,new _.Rect(0,y,s,p))),t.invalidateLayout(),M.D1(C,new _.Rect(h+w,y,(T=S?d:d+g+v)-w,p)),M.jy(C,new _.Rect(h-2,y,2+(T-=S?0:v),p)),this.Nb(t,y,p))}}else{for(N=0,k=n;k<o&&N<d;k++)N+=t.nn(k);(N+=B(a)-B(e))<d&&(u=!0,b=h,y=(f||l).y,w=d-N,0<t.frozenTrailingColumnCount()&&--w,c=0,!S&&0<v&&(i=R(f.width-(c=g)-1,m-1+N),M.Ey(m-1,y,c+1,p,i,y)),T=S?0:R(N,v)-1,M.Ey(b,y,w+T,p,b+N,y),t.invalidateLayout(),e=t.columnOutlines&&!t.columnOutlines.Oy()?t.columnOutlines.Ry()+s+1:0,M.D1(C,new _.Rect(b-s,y,N+s+e+5,p)),M.jy(C,new _.Rect(h-2,y,D=d+T+c+2,p)),this.Nb(t,y,p))}u||(t.invalidateLayout(),t.repaint()),o!==n&&t.ki(_.Events.LeftColumnChanged,{sheet:t,sheetName:t.name(),oldLeftCol:o,newLeftCol:n}),(l=t.rt)&&l.By(),f=o===t.Ab&&a!==t.my,u&&Rt(t,f)&&(r.Ib=Bt(t,r))}},i.prototype.Nb=function(t,n,e){var i=t.Dn,r=i.J();this.Zy(t).concat(this.Wy(t)).forEach(function(t){var t=t.layout,t=new _.Rect(t.x,n,t.width,e);i.O1(t),i.jy(r,t)})},i.prototype.Zy=function(t){var n,e,n,i,r,o,e,a,e,n=this,e=t.getSelections();return!(1===e.length&&0<t.frozenColumnCount())||(n=n.kb.options.scrollByPixel,i=t.Ab,r=t.my,o=e[0].col,e=e[0].col+e[0].colCount-1,n&&e==i-1)?[]:(a=[],(o===i+1||o<i&&i<=e||e==i-1||n&&o===i&&0!==r)&&(e=t.Yy(0))&&0<e.length&&a.push({layout:e[e.length-1]}),a)},i.prototype.Wy=function(t){var n,e,n,i,r,e,o,a,u,a,t,s,t,s,n=this,e=t.getSelections();return 1===e.length&&0<t.frozenTrailingColumnCount()?(n=n.kb.options.scrollByPixel,i=t.getViewportRightColumn(1),r=e[0].col,e=e[0].col+e[0].colCount-1,o=[],a=(u=(a=t.Yy(2))&&0<a.length)?a[0]:O,t=(s=(t=t.Yy(1))&&0<t.length)?t.findCol(i):O,s=u&&s&&a.x!==t.x+t.width,(e==i-1||r<=i&&i<e||r===i+1||n&&e===i&&s)&&u&&o.push({layout:a}),o):[]},i.prototype.Mg=function(t,n,e,i){var r,o,a,u,s,c,f,l,h,o,d,v,h,h,o,d,v,e,d,h,o,s,v,e,o,d,h,l,r=this,o=r.kb,a=!1,u=!1,s=o.Xb,c=o.zb,f=o.options.scrollbarShowMax,l=o.options.scrollbarAppearance===M.ScrollbarAppearance.mobile;if(t){if(h=t.name(),n.ctrlKey){if(!o.options.allowUserZoom)return!0;if(d=Ut((o=t.zoom())-.05*e),t.isEditing()&&!t.endEdit())return;if(v={sheet:t,sheetName:t.name(),oldZoomFactor:o,newZoomFactor:d,cancel:!1},t.ki(_.Events.ViewZooming,v),v&&!0===v.cancel)return!1;h={cmd:"zoom",sheetName:h,oldZoomFactor:o,zoomFactor:v.newZoomFactor},t.Qy().execute(h),o!==(d=t.zoom())&&(delete v.cancel,t.ki(_.Events.ViewZoomed,v),t.ki(_.Events.UserZooming,v))}else i=i||0,h=t.Tb,o=t.ly,v=(d=r.Jy(t,e)).Ky,e=d.Xy,h!==v||o!==e?(l&&(s.qy(M.ScrollbarState.show),r.$y(!0)),r.yy(t,v,e),t.tw(),f||t.ew()):a=!0,d=t.Ab,h=t.my,s=(o=r.rw(t,i)).iw,v=o.Xy,d===s&&h===v||(l&&(c.qy(M.ScrollbarState.show),r.$y(!1)),r.wy(t,s,v),t.ow(),f)||t.aw();e=t.uw(),o=t.hitTest(n.pageX-e.left,n.pageY-e.top),(h=(d=t.sw)&&d.cellTypeHitInfo)&&(h.cellRect=t.getCellRect(d.row,d.col)),(l=t.rt).cw(o),l.fw(o)}return a&&0===i},i.prototype.hw=function(t,n){var e,i,r,o,a,u,s,c,n,o,o,n,r,f,n,r,e=t.Tb,i=t.ly,r=t.parent,o=t.zoom(),a=nt(n*r.options.scrollPixel*o),u=0,n=t.Fi().Cy,o=t.dw(1).findRow(e);if(o)if(a<0){for(s=t.vw(-1),u=-(n-o.y);s<e&&a<=u;)u-=t.Gt(--e);i=u-a,e===s&&0<i&&(i=0)}else if(0<a){for(c=t.mw(),u=o.y+o.height-n;e<c&&u<=a;)u+=t.Gt(++e);i=u-a-(o=t.Gt(e)),r.options.scrollbarMaxAlign?(n=t.Fi(),r=t.frozenRowCount(),f=t.getRowCount()-t.frozenTrailingRowCount()-1,c=(n=t.gw(t.Sy(n),r,f)).Ky,r=n.Xy,c<e?(e=c,i=r):e===c&&B(i)>B(r)&&(i=r)):e<c&&u-a==0?(e++,i=0):e===c&&u-a<0&&(i=-o)}return{Ky:e,Xy:i}},i.prototype.Jy=function(t,n){var e,i,r,r,o,o,n,e=t.Tb,i=t.ly,r=t.parent;return r&&r.options.scrollByPixel?r.ib.hw(t,n):(0<(r=t.frozenRowCount())&&(0===e&&0<n?e=r:n<0&&e===r-n&&(e=0)),-1!==(o=t.vw(e+n,n<0))?e=o:e+=n,o=t.pw(),n=t.mw(),t.getRowCount()-r-t.frozenTrailingRowCount()<=0||o===O?e=t.Tb:(e<o?e=o:n<e&&(e=n),e===O&&(e=-1)),{Ky:e,Xy:i})},i.prototype.bw=function(t,n){var e,i,r,o,a,u,s,c,n,o,o,n,r,f,n,r,e=t.Ab,i=t.my,r=t.parent,o=t.zoom(),a=nt(n*r.options.scrollPixel*o),u=0,n=t.Fi().Py,o=t.yw(1).findCol(e);if(o)if(a<0){for(s=t.ww(-1),u=-(n-o.x);s<e&&a<=u;)u-=t.nn(--e);i=u-a,e===s&&0<i&&(i=0)}else if(0<a){for(c=t.Mw(),u=o.x+o.width-n;e<c&&u<=a;)u+=t.nn(++e);i=u-a-(o=t.nn(e)),r.options.scrollbarMaxAlign?(n=t.Fi(),r=t.frozenColumnCount(),f=t.getColumnCount()-t.frozenTrailingColumnCount()-1,c=(n=t.Cw(t.Gy(n),r,f)).iw,r=n.Xy,c<e?(e=c,i=r):e===c&&B(i)>B(r)&&(i=r)):e<c&&u-a==0?(e++,i=0):e===c&&u-a<0&&(i=-o)}return{iw:e,Xy:i}},i.prototype.rw=function(t,n){var e,i,r,r,o,o,n,e=t.Ab,i=t.my,r=t.parent;return r&&r.options.scrollByPixel?r.ib.bw(t,n):(0<(r=t.frozenColumnCount())&&(0===e&&0<n?e=r:n<0&&e===r-n&&(e=0)),-1!==(o=t.ww(e+n,n<0))?e=o:e+=n,o=t.Sw(),n=t.Mw(),t.getColumnCount()-r-t.frozenTrailingColumnCount()<=0||o===O?e=t.Ab:(e<o?e=o:n<e&&(e=n),e===O&&(e=-1)),{iw:e,Xy:i})},i.prototype.Yb=function(t,n,e){var i,r,o,e,a,i,i=this,r=i.kb,a;(0,_.jf)(r)&&(i=i.$b(t,e),e=t?(o=n.pageY,n.pageX-100):(o=n.pageY-40,n.pageX-30),r.Tw(W.j0(i),e,o,!0))},i.prototype.$b=function(t,n){var e,i,e=(0,_.jf)(this.kb);return i=e?e.getScrollTooltipContent(t,n):i},i.prototype.Aw=function(t){(0,w.GC$)(t).addClass(S)},i.prototype.Iw=function(t){(0,w.GC$)(t).removeClass(S)},i.prototype.xw=function(t){(0,w.GC$)(t).addClass(T)},i.prototype.Nw=function(t){(0,w.GC$)(t).removeClass(T)},i.prototype.$y=function(t,n){var e,i,r,o,a;void 0===n&&(n=1e3),i=(e=this).kb,r=t?i.kw:i.Dw,a=function(){e.Nw(r),e.Aw(r)},(o=i.options.scrollbarAppearance=M.ScrollbarAppearance.mobile)&&(e._w(t),t?e.Ew=setTimeout(a,n):e.jw=setTimeout(a,n))},i.prototype._w=function(t){var n=this;t&&n.Ew?(clearTimeout(n.Ew),n.Ew=null):!t&&n.jw&&(clearTimeout(n.jw),n.jw=null)},r=i,jt={allowUserDragDrop:!0,allowUserDragFill:!0,allowUserZoom:!0,allowUserResize:!0,allowUndo:!0,allowSheetReorder:!0,allowContextMenu:!0,allowUserDeselect:!0,defaultDragFillType:5,showDragFillSmartTag:!0,showHorizontalScrollbar:!0,showVerticalScrollbar:!0,scrollbarShowMax:!0,scrollbarMaxAlign:!1,tabStripVisible:!0,tabStripRatio:.5,tabStripPosition:M.TabStripPosition.bottom,tabStripWidth:80,tabEditable:!0,newTabVisible:!0,allSheetsListVisible:M.AllSheetsListVisibility.auto,cutCopyIndicatorVisible:!0,cutCopyIndicatorBorderColor:"#217346",tabNavigationVisible:!0,backColor:"white",backgroundImage:O,backgroundImageLayout:0,showResizeTip:M.ShowResizeTip.none,showDragDropTip:!0,showDragFillTip:!0,scrollIgnoreHidden:!1,highlightInvalidData:!1,showScrollTip:M.ShowScrollTip.none,grayAreaBackColor:O,useTouchLayout:!1,hideSelection:!1,resizeZeroIndicator:M.ResizeZeroIndicator.enhanced,allowUserEditFormula:!0,pivotAreaReference:1,enableFormulaTextbox:!0,referenceStyle:0,allowDynamicArray:!1,iterativeCalculation:!0,iterativeCalculationMaximumIterations:1e3,iterativeCalculationMaximumChange:.01,calcOnDemand:!1,dynamicReferences:!0,autoFitType:M.AutoFitType.cell,allowCopyPasteExcelStyle:!0,allowExtendPasteRange:!1,copyPasteHeaderOptions:M.CopyPasteHeaderOptions.allHeaders,allowUserDragMerge:!1,rowResizeMode:M.ResizeMode.normal,columnResizeMode:M.ResizeMode.normal,scrollByPixel:!1,scrollPixel:5,enableAccessibility:!1,allowAutoCreateHyperlink:!0,scrollbarAppearance:M.ScrollbarAppearance.skin,font:O,customList:[],numbersFitMode:M.NumbersFitMode.mask,pasteSkipInvisibleRange:!1,allowAutoExtendFilterRange:!1,allowInvalidFormula:!1,formulaFormatHint:!0},k.prototype.commandManager=function(){return this.Qy},k.prototype.undoManager=function(){return this.Wp},k.prototype.Ow=function(){var t=this.Rw(),n=this.Bw;return n instanceof Array?n.concat(t):t},k.prototype.Rw=function(){var t=tt.culture(),n=[],e=[],i=tt.Fe(xt).DateTimeFormat,r=tt.Fe(t).DateTimeFormat,n=this.Lw(i);return t!==xt&&(e=this.Lw(r)),n.concat(e)},k.prototype.Lw=function(n){var e=[],i,r;return this.Fw=["abbreviatedDayNames","dayNames","abbreviatedMonthNames","monthNames"],this.Fw.forEach(function(t){(i=n[t])instanceof Array&&0<i.length&&(r=-1<t.indexOf("month")||-1<t.indexOf("Month"),i=r?i.slice(0,12):i,e.push(i))}),e},k.prototype.Fp=function(){var t,n,t,n=b&&this.op();n&&n.Pw(),this.sheets.forEach(function(t){var n;t.Uw().Gw()})},k.prototype.Ob=function(t,n,e){var i,r,o,a,i=this,r=(0,_.jf)(i),o=b&&i.op();switch(t){case"allowUndo":i.Wp&&(i.Wp.Hw=n);break;case"backColor":i.Rb=!0,r&&r.zw();break;case"cutCopyIndicatorBorderColor":case"cutCopyIndicatorVisible":case"grayAreaBackColor":case"hideSelection":case"highlightInvalidData":case"resizeZeroIndicator":case"allowUserDragFill":case"allowUserDragMerge":case"numbersFitMode":case"pasteSkipInvisibleRange":r&&r.zw();break;case"backgroundImage":case"backgroundImageLayout":i.nb(),r&&r.zw();break;case"newTabVisible":case"allSheetsListVisible":case"tabNavigationVisible":(a=i.w2)&&a.repaint();break;case"tabStripPosition":n!==e&&i.Vw(n);break;case"tabStripWidth":n!==e&&i.Yw(n);break;case"showHorizontalScrollbar":case"showVerticalScrollbar":case"useTouchLayout":case"tabStripVisible":i.Cg();break;case"tabStripRatio":i.Xg();break;case"scrollIgnoreHidden":case"scrollbarMaxAlign":case"scrollbarShowMax":r&&(r.Zw=!0,r.Ww=!0,r.zw());break;case"scrollByPixel":r&&(r.Zw=!0,r.Ww=!0,r.ly=0,r.my=0,r.zw());break;case"scrollPixel":n<=0&&(i.options.scrollPixel=e);break;case"scrollbarAppearance":i.ib&&n!==e&&i.Qw(n);break;case"calcOnDemand":o&&(!n&&o.calcOnDemand&&i.Fp(),o.calcOnDemand=n);break;case"dynamicReferences":o&&(o.dynamicReferences=n);break;case"customList":i.Bw=n;break;case"referenceStyle":case"allowDynamicArray":case"iterativeCalculation":case"iterativeCalculationMaximumIterations":case"iterativeCalculationMaximumChange":i.Kw(t,n),r&&r.zw()}},k.prototype.Qw=function(t){var n,e,e=(t=E(t)?M.ScrollbarAppearance.skin:t)===M.ScrollbarAppearance.mobile;(n=this).Xb.Jw(t),n.zb.Jw(t),n.Xw.Jw(t),n.qw(),e?n.$w():n.tM(),n.refresh()},k.prototype.Vw=function(t){var n=this;E(t)&&(t=M.TabStripPosition.bottom,n.options.tabStripPosition=t),n.nM&&(n.eM(),n.iM(),n.Cg())},k.prototype.Yw=function(t){var n=this;E(t)?n.options.tabStripWidth=t=80:t<80&&(n.options.tabStripWidth=80),n.nM&&(n.iM(),n.Cg())},k.prototype.Kw=function(t,n){var e,i,e,i=b&&this.op();if(i)switch(t){case"referenceStyle":i.useR1C1=1===n;break;case"allowDynamicArray":case"iterativeCalculation":case"iterativeCalculationMaximumIterations":case"iterativeCalculationMaximumChange":i[t]=n}},k.prototype.Hc=function(t,n){var r,e,i,o,e,r=this;for(b&&r.Qp(),r.rM=[],r.oM=c("input"),r.vf=0,r.sg=0,r.aM={fromSheet:O,isCutting:!1},r.uM={fromSheet:O,isCutting:!1},r.sM=O,r.sheets=[],r.mp=[],r.hse=[],r.Hp={},r.Bw=r.options.customList,r.Wp=new Q(r,-1,r.options.allowUndo),(e=r.Qy=new J(r)).cM("beforeWorkbookExecute",function(t){r.fM(t)}),e.addListener("workbookUndo",function(t){var n,e,i,i,n=t.command,e=P.Commands.lM(n),i=r.Qy[n.cmd];i&&i.canUndo()&&!e&&!n.hM&&((i=r.getSheetFromName(n.sheetName))&&(n.sheetId=i._id),r.undoManager().dM(n,t.vM)),1!==t.vM&&2!==t.vM||r.mM(t)}),P.Commands.gM(e),k.et(r,"init"),i=0;i<t;i++)o=r.S2(r.T2(i)),r.sheets.push(o),r.hse.push(o),o.E0i=i,o.pM(r);(e=r.sheets[r._2])&&e.isSelected(!0),r.suspendPaint(),n&&r.hg(n),r.bM=new z.yM(r),r.resumePaint()},k.prototype.hitTest=function(t,n,e){var i,r,o,a,u,s,c,s,f,l,c,h,c,c,d,v,c,d,r,v,c,m,g,p,e,b,y,d,r,o,v,c,e,d,r,a,o,v,c,e,i=this,r=i.jg(),o=i.w2,a=i.zb,u=i.Xb,s=(0,w.GC$)(i.getHost()).width(),c=(0,w.GC$)(i.getHost()).height();if(t<0||s<t||n<0||c<n)return O;if(s=i.wM(),f=i.options.scrollbarAppearance===M.ScrollbarAppearance.mobile){if(c=Zt(a,l=(0,w.GC$)(i.Dw).offset(),s,t,n))return c;if(c=Wt(u,h=(0,w.GC$)(i.kw).offset(),s,t,n))return c}if(r&&(c=r.uw(),d=r.ot(),v=c.left-s.left,c=c.top-s.top,v<t)&&t<d.width+v&&c<n&&n<d.height+c)return{worksheetHitInfo:r.hitTest(t-v,n-c,!1,e),x:t,y:n};if(d=(0,w.GC$)(o.Dg()).offset(),r=o.ot(),v=d.left-s.left,c=d.top-s.top,v<t&&t<r.width+v&&c<n&&n<r.height+c){switch(g={},p=(m=o.hitTest(t-v,n-c)).index,b=(e=i.e2(p))&&e.name(),y=O,e&&qt(e._gi)&&(y=e._gi),m.type){case"navButton":g={navButton:m.element};break;case"sheetTab":g={sheetTab:{sheetName:b||m.element,sheetIndex:p}},y!==O&&(g.sheetTab.sheetType=y);break;case"resize":g={resize:!0};break;default:g={blank:!0}}return{tabStripHitInfo:g,x:t,y:n}}return d=(0,w.GC$)(a.oy()).offset(),r=a._b(),o=d.left-s.left,v=d.top-s.top,o<t&&t<r.width+o&&v<n&&n<r.height+v?{horizontalScrollBarHitInfo:{element:a.hitTest(t-o,n-v).element},x:t,y:n}:(c=(0,w.GC$)(u.oy()).offset(),e=u._b(),d=c.left-s.left,r=c.top-s.top,d<t&&t<e.width+d&&r<n&&n<e.height+r?{verticalScrollBarHitInfo:{element:u.hitTest(t-d,n-r).element},x:t,y:n}:(a=(0,w.GC$)(i.MM).offset(),o=parseInt(i.MM.style.width.substr(0,i.MM.style.width.indexOf("px")),10),v=parseInt(i.MM.style.height.substr(0,i.MM.style.height.indexOf("px")),10),c=a.left-s.left,e=a.top-s.top,c<t&&t<o+c&&e<n&&n<v+e?{footerCornerHitInfo:{element:"footerCorner"},x:t,y:n}:void 0))},k.prototype.wM=function(){var t=this,t,t=(A||w.GC$)(t.Ti).offset();return t?(t.top+=l.body.clientTop||0,t.left+=l.body.clientLeft||0):t={top:0,left:0},t},k.prototype.Zp=function(t){var e,t,e=this.options,t=t||{};t=X(!0,{},jt,t),K(t,function(t,n){e.hasOwnProperty(t)&&(e[t]=n)})},k.prototype.j2=function(){var t=this;return!t.sM&&t.Ti&&(t.sM=c(h),(0,w.GC$)(t.sM).css({position:"relative",left:0,top:0,height:0}).attr(x,"gcLayerContainer"),(0,w.GC$)(t.Ti).prepend(t.sM)),t.sM},k.prototype.T2=function(t){var n,e,i,r,o,a,u,s,n=this,e=n.getSheetCount();n.Kp<e?n.Kp=e:n.Kp++,(E(t)||t<n.Kp)&&(t=n.Kp),i=!1,o=n.qv();do{for(r=(N().SHEET_NAME||"Sheet")+(t+1),a=o.length,u=0;u<a;u++)if(s=o[u]){if(s.name().toUpperCase()===r.toUpperCase()){t++,i=!0;break}i=i&&!1}}while(i);return r},k.prototype.S2=function(t){return new f.Worksheet(t)},k.prototype.setHost=function(t){this.hg(t)},k.prototype.hg=function(t){var n=this;t&&(n.Ti=t,n.CM(),n.nl(),n.SM(),n.TM(),n.AM(),n.IM(),n.xM(),n.NM(),n.kM(),n.DM(),n._M(),n.$w(),n.EM(),n.jM(),n.OM(),n.BM(),n.iM(),n.Cg(),n.LM(t),k.et(n,"setHost",t))},k.prototype.CM=function(){var t,n,t=this,n=t.Ti;A&&A(n).data(I,t),(0,w.GC$)(n).data(I,t).attr(x,"gcSpread").addClass(Tt).css(It,At)},k.prototype.nl=function(){j.Vc.nl()},k.prototype.SM=function(){var t=this;t.cultureChangedHandler=function(){t.FM()},l.addEventListener(St,t.cultureChangedHandler)},k.prototype.TM=function(){var t=this;t.PM(),t.GM(),t.HM()},k.prototype.GM=function(){var t,n,e,i,r,o,a,u,s,t=this,n=t.Ti,e=c(ht),i=e.style;for(e.cellSpacing="0px",e.cellPadding="0px",e.border="0",i.width=dt,i.height=dt,i.border="0",i.margin="0",i.borderCollapse="collapse",i.float="left",r=0;r<3;r++){for(o=c("tr"),a=0;a<2;a++)(s=(u=c("td")).style).padding="0",s.border="0",o.appendChild(u);e.appendChild(o)}n.appendChild(e),t.nM=e},k.prototype.PM=function(){var t,n,e,i,t=this,n=t.Ti,e=c(h),i=e.style;i.width="0",i.height="0",i.float="left",n.appendChild(e),t.zM=e},k.prototype.HM=function(){var t,n,e,i,t=this,n=t.Ti,e=c(h),i=e.style;i.width="0",i.height="0",i.float="left",n.appendChild(e),t.VM=e},k.prototype.AM=function(){var t,n,e,i,r,t=this,n=t.Ti,e,i=t.nM.rows[1].cells[0],r=c(h);r.id=n.id+"vp",(0,w.GC$)(i).append(r),t.Kg=r},k.prototype.IM=function(){var t,n,e,i,r,i,r,r,i,o,t=this,n,e=t.nM.rows[1].cells[1],i=t.options,r=i.scrollByPixel,i=i.scrollbarAppearance,r=r?M.ScrollType.pixels:M.ScrollType.continuous,r=new u.YM(!1,O,O,O,O,O,r,i,function(){t.ZM(!0)}),i=c(h),o=r.oy();(0,w.GC$)(i).append(o),t.Xb=r,t.kw=i,t.WM=e},k.prototype.QM=function(){var i,t,i=this,t=i.Xb.oy();(0,w.GC$)(t).bind(ut+e,function(t,n){var e=n.scrollEventType;t.data=i,n.scrollOrientation===u.ScrollOrientation.verticalScroll&&(e===M.Zi.smallDecrement||e===M.Zi.smallIncrement||e===M.Zi.largeDecrement||e===M.Zi.largeIncrement||e===M.Zi.thumbTrack?r.Zb(t,n):e===M.Zi.thumbPosition&&r.Qb(t))}).bind(rt+e,function(t){t.data=i,r.Jb(t)}).bind(at+e,function(t){t.data=i,r.ey(t)}).bind(ot+e,function(t){t.data=i,t.scrollbar=i.Xb,r.ry(t)})},k.prototype.xM=function(){var t,n,e,i,r,o,a,u,s,t=this,n,e=t.nM.rows[2].cells[0],i=c(ht),r=i.style;for(i.cellSpacing="0",i.cellPadding="0",i.border="0",r.border="0",r.margin="0",(0,w.GC$)(i).css("user-select",p),o=c("tr"),a=0;a<2;a++)(s=(u=c("td")).style).padding="0",s.border="0",o.appendChild(u);i.appendChild(o),(0,w.GC$)(e).append(i),t.JM=i},k.prototype.NM=function(){var t,n,e,i,t=this,n=t.Ti,e=c(h),i=e.style;i.width=t.Jg()*(0,w.GC$)(n).width()+d,i.height=t.Zv()+d,i.fontSize="10pt",i.fontFamily="Arial",t.XM=e},k.prototype.kM=function(){var t,n,e,i,r,i,r,r,o,a,o,r,t=this,n,e=t.JM.rows[0].cells[1],i=t.options,r=i.scrollByPixel,i=i.scrollbarAppearance,r=r?M.ScrollType.pixels:M.ScrollType.continuous,r=new u.YM(!0,O,O,O,O,O,r,i,function(){t.ZM(!1)}),o=r.oy(),a=c(h);(0,w.GC$)(a).append(o),t.zb=r,r=(o=new u.YM(!0,O,O,O,O,O,M.ScrollType.pixels,i,function(){t.ZM(!1)})).oy(),(0,w.GC$)(a).append(r),t.Xw=o,t.Dw=a,t.qM=e},k.prototype.$M=function(){var i,t,i=this,t=i.zb.oy();(0,w.GC$)(t).bind(ut+e,function(t,n){var e=n.scrollEventType;t.data=i,n.scrollOrientation===u.ScrollOrientation.horizontalScroll&&(e===M.Zi.smallDecrement||e===M.Zi.smallIncrement||e===M.Zi.largeDecrement||e===M.Zi.largeIncrement||e===M.Zi.thumbTrack?r.Bb(t,n):e===M.Zi.thumbPosition&&i.iy())}).bind(rt+e,function(t){t.data=i,r.Ub(t)}).bind(at+e,function(t){t.data=i,r.ey(t)}).bind(ot+e,function(t){t.data=i,t.scrollbar=i.zb,r.ry(t)})},k.prototype.tC=function(){var i,t,i=this,t=i.Xw.oy();(0,w.GC$)(t).bind(ut+e,function(t,n){var e=n.scrollEventType;t.data=i,n.scrollOrientation===u.ScrollOrientation.horizontalScroll&&(e===M.Zi.smallDecrement||e===M.Zi.smallIncrement||e===M.Zi.largeDecrement||e===M.Zi.largeIncrement||e===M.Zi.thumbTrack?r.qb(t,n):e===M.Zi.thumbPosition&&r.Pb(t))}).bind(rt+e,function(t){t.data=i,r.Ub(t,!0)}).bind(at+e,function(t){t.data=i,r.ey(t)}).bind(ot+e,function(t){t.data=i,t.scrollbar=i.Xw,r.ry(t)})},k.prototype.DM=function(){var t=this;t.nC(),t.eC()},k.prototype.nC=function(){var t,n,e,i,t=this,n,e=t.nM.rows[0].cells[1],i=c(h);(0,w.GC$)(e).append(i),t.iC=i},k.prototype.eC=function(){var t,n,e,i,t=this,n,e=t.nM.rows[2].cells[1],i=c(h);(0,w.GC$)(e).append(i),t.MM=i},k.prototype.EM=function(){var t=this;t.ib=new r(t)},k.prototype._M=function(){var t=this;t.QM(),t.$M(),t.tC()},k.prototype.$w=function(){var t,n,e,i,r,o,t=this,n,e;t.options.scrollbarAppearance===M.ScrollbarAppearance.mobile&&(i=t.Ti,r=t.kw,o=t.Dw,(0,w.GC$)(r).bind(a,function(){t.Xb.qy(M.ScrollbarState.active)}).bind(s,function(){t.Xb.qy(M.ScrollbarState.inactive)}),(0,w.GC$)(o).bind(a,function(){t.zb.qy(M.ScrollbarState.active),t.Xw.qy(M.ScrollbarState.active)}).bind(s,function(){t.zb.qy(M.ScrollbarState.inactive),t.Xw.qy(M.ScrollbarState.inactive)}),(0,w.GC$)(i).bind(a,t.oC).bind(s,t.aC))},k.prototype.tM=function(){var t,n,e,t=this,n=t.kw,e=t.Dw;n&&((0,w.GC$)(n).unbind(a).unbind(s),t.ib._w(!0)),e&&((0,w.GC$)(e).unbind(a).unbind(s),t.ib._w(!1)),(0,w.GC$)(t.Ti).unbind(a,t.oC).bind(s,t.aC)},k.prototype.oC=function(){(0,w.GC$)(this).find("."+C).addClass(Ct)},k.prototype.aC=function(){(0,w.GC$)(this).find("."+C).removeClass(Ct)},k.prototype.jM=function(){var t=this;t.eM(),t.qw()},k.prototype.uC=function(){var t,n,e,t,i,r,t,t=this,n=t.w2,e=t.options.tabStripPosition,t=t.options.tabStripVisible,i=0,r=0;return n&&t&&(t=n.ot(),e===M.TabStripPosition.top?r=t.height:e===M.TabStripPosition.left&&(i=t.width)),{left:i,top:r}},k.prototype.sC=function(){var t,n,t,t=this,n=t.j2(),t=t.uC();(0,w.GC$)(n).css({left:t.left,top:t.top})},k.prototype.qw=function(){var t,n,e,i,r,o,a,e,t=this,n=t.Ti;t.ib&&(e=t.options.scrollbarAppearance===M.ScrollbarAppearance.mobile,i=t.WM,r=t.qM,o=t.kw,a=t.Dw,(0,w.GC$)(o).removeAttr("style"),(0,w.GC$)(a).removeAttr("style"),(0,w.GC$)(a).addClass("gc-clear-float"),e?(e=t.j2(),o.style.position="absolute",o.style.top="0px",o.style.left="0px",(0,w.GC$)(o).addClass(C+" "+Mt),(0,w.GC$)(e).append(o),a.style.position="absolute",a.style.top="0px",a.style.left="0px",(0,w.GC$)(a).addClass(C+" "+wt),(0,w.GC$)(e).append(a)):((0,w.GC$)(i).append(o),(0,w.GC$)(r).append(a),(0,w.GC$)(o).removeClass(C+" "+S+" "+Mt+" "+T),(0,w.GC$)(a).removeClass(C+" "+S+" "+wt+" "+T),(0,w.GC$)(n).css("position","auto")))},k.prototype.eM=function(){var t,n,e,i,r,o,a,t,u,t=this,n=t.nM,e=t.zM,i=t.VM,r=t.JM,o=t.XM,a=t.options.tabStripPosition,t=t.options.tabStripVisible;a===M.TabStripPosition.bottom?u=r.rows[0].cells[0]:a===M.TabStripPosition.top?u=n.rows[0].cells[0]:a===M.TabStripPosition.left?u=e:a===M.TabStripPosition.right&&(u=i),a!==M.TabStripPosition.bottom&&a!==M.TabStripPosition.top&&t?n.style.tableLayout="fixed":n.style.tableLayout="",(0,w.GC$)(u).append(o)},k.prototype.LM=function(t){var n,e,i,r,n=this,e="tabindex",i=y((0,w.GC$)(t).attr(e),10)||0,r=c(h);(0,w.GC$)(r).css({position:gt,overflow:"hidden"}).attr(x,"gcSheetFocusElementForTab").attr(e,i).bind(ct,function(){n.fC||(0,_.jf)(n).Zg(),n.fC=!1}),t.insertBefore(r,O),n.lC=r},k.prototype.OM=function(){var t,n,t=this,n=function(){t.hC()};(0,w.GC$)(j).bind(st+v,n),t.dC=n},k.prototype.BM=function(){var t,n,t=this,n=(0,_.jf)(t);n&&n.hg(t.Kg)},k.prototype.vC=function(){var t=this,n=t.lC;n&&(t.fC=!0,n.focus())},k.prototype.mC=function(){var t,n,e,i,r,o,t=this.getActiveSheet();if(t)if(_.hi.A1(t)){if(e=this.Ti)for(i=document.activeElement,r=document.body,o=i;o;){if(o===e){n=i;break}if(o===r)break;o=o.parentElement}}else t.fg&&(n=t.fg);return n},k.prototype.n2=function(e){var i=this;i.gC&&(j.clearTimeout(i.gC),i.gC=O),i.gC=j.setTimeout(function(){var t,n,t=i.mC();t&&"gcWorksheetCanvas"!==(n=t.getAttribute(x))&&"gcSheetClipboard"!==n&&t.setAttribute("aria-label",e),j.clearTimeout(i.gC),i.gC=O},50)},k.prototype.L0=function(){var t,n,e,i,r,o,a,u,n,n,s,e,i,t=this,n=t.zb,e=t.Xb,i=t.Xw,o=t.sheets,a=t.options.scrollbarAppearance===M.ScrollbarAppearance.mobile;for(t.zp(),_.Bf.ih(t),_.mt.L0(),t.dC&&(0,w.GC$)(j).unbind(st+v,t.dC),t.dC=O,t.pC&&clearTimeout(t.pC),n&&n.dispose(),e&&e.dispose(),i&&i.dispose(),t.bC(),t.iy(),_.hi.ai()===t.getActiveSheet()&&_.hi.F1(O),r=0;r<o.length;r++)o[r].L0(!0);for(o.splice(0,o.length),u=t.mp,r=0;r<u.length;r++)u[r].L0(!0);u.splice(0,u.length),t.hse.splice(0,t.hse.length),(n=t.bM)&&(n.L0(),t.bM=O),e="class",i="unselectable",(n=t.Ti)&&(s=(0,w.GC$)(n),l.removeEventListener(St,t.cultureChangedHandler),s.html("").removeAttr(x).removeClass(Tt),s.attr(e)||s.removeAttr(e),s.attr(i)||s.removeAttr(i),s.data(I)&&s.data(I,O),A)&&A(n).data(I)&&A(n).data(I,O),a&&t.tM(),t.Dw=O,t.kw=O,t.Wp&&(t.Wp.L0(),t.Wp=O),t.w2&&(t.w2.L0(),t.w2=O),k.et(t,"dispose"),t.lC&&((0,w.GC$)(t.lC).unbind(ct),t.lC=O),t.Lp&&(t.Lp.dispose(),t.Lp=O,t.yC=O,t.wC=O),t.MC&&(t.MC.L0(),t.MC=O),H.W.L0(),t.Qy&&(t.Qy.L0(),t.Qy=O),t.ib&&(t.ib.L0(),t.ib=O),t.v2&&(t.v2.dispose(),t.v2=O)},k.prototype.bC=function(){var t,n,e,i,r,o,a,u,t=this,n=t.sheets;for((0,w.GC$)(t.oM).unbind(v),e=0;e<n.length;e++)(i=n[e]).bC();for(o=0,a=r=t.mp;o<a.length;o++)(u=a[o]).bC();t.rM&&(t.rM.length=0)},k.prototype.zp=function(){var t,n,e,i,r,t=this,n=t.CC;if(n)for(e=0,i=n;e<i.length;e++)(r=i[e]).close&&r.close();t.CC=[]},k.prototype.iM=function(){var t,n,e,t=this,n=y(_.I.fl("").zIndex),e=n!==t.SC;e&&t.TC(n),t.AC(e),t.IC(),t.xC()},k.prototype.TC=function(t){this.SC=t},k.prototype.AC=function(t){var n,e,i,e,r,n=this,e=n.Ti,i=n.SC,e=e.getAttribute("id")+"_tabStrip",r=n.w2;r&&!t?(r.mg(),r.repaint()):(r&&r.L0(),r=new(2007<i?G.Gv:U.Jm)(e),(n.w2=r).Sg(n),r.hg(n.XM))},k.prototype.IC=function(){var t,n,e,i,r,t=this,n=t.options.scrollbarAppearance===M.ScrollbarAppearance.mobile,e=t.Zv(),i=t.Xm(),r=t.NC();n?t.kC():(zt(t.kw,r,i),Vt(t.Dw,e,i))},k.prototype.xC=function(){var t=this;Yt(t.MM),Yt(t.iC)},k.prototype.hC=function(){var t=this,n=t.pC;n&&clearTimeout(n),t.pC=j.setTimeout(function(){_.Bf.rh(),t.Cg(),t.pC=O},100)},k.prototype.Cg=function(){var t=this;t.Eb||(t.Eb=!0,t.DC(),t.Eb=!1)},k.prototype.DC=function(){var t,n,t=this,n;t.Ti&&(t._C(),t.EC(),t.jC(),t.OC(),t.RC(),t.BC(),t.LC(),t.PC(),t.GC(),t.UC(),t.HC(),t.sC(),t.zC())},k.prototype._C=function(){var t,n,n,e,i,r,i,e,t,o,e,t=this,n=t.zM;n&&(n=n.style,i=(e=t.options).tabStripVisible,r=e.tabStripPosition,i=i?e.tabStripWidth:0,e=t.Ti,t=(0,w.GC$)(e).height(),e=r===M.TabStripPosition.left?(o=i,t):o=0,n.width=o+d,n.height=e+d)},k.prototype.EC=function(){var t,n,n,e,i,r,e,o,i,a,t=this,n=t.nM;n&&(n=n.style,i=(e=t.options).tabStripVisible,r=e.tabStripPosition,e=e.tabStripWidth,o=(0,w.GC$)(t.Ti).width(),i=!i||r!==M.TabStripPosition.left&&r!==M.TabStripPosition.right?o+d:(a=et(Xt(t.Ti)))-e+d,n.width=i)},k.prototype.OC=function(){var t,n,n,e,i,r,i,e,t,o,e,t=this,n=t.VM;n&&(n=n.style,i=(e=t.options).tabStripVisible,r=e.tabStripPosition,i=i?e.tabStripWidth:0,e=t.Ti,t=(0,w.GC$)(e).height(),e=r===M.TabStripPosition.right?(o=i,t):o=0,n.width=o+d,n.height=e+d)},k.prototype.jC=function(){var t,n,e,i,i,r,e,o,a,t,u,s,c,f,l,t,c,h,n,r,t=this,n=t.Ti,e=(0,w.GC$)(n),i=t.Kg;i&&(i=i.style,r=e.width(),e=e.height(),o=t.NC(),a=t.Zv(),u=(t=t.options).showVerticalScrollbar,s=t.showHorizontalScrollbar,c=t.scrollbarAppearance,f=t.tabStripVisible,l=t.tabStripPosition,t=f?t.tabStripWidth:0,c=c===M.ScrollbarAppearance.mobile,n=(h=l===M.TabStripPosition.left||l===M.TabStripPosition.right)?et(Xt(n)):r,u&&!c&&(n-=o),h&&(n-=t),r=e,l===M.TabStripPosition.top?(s&&!c&&(r-=a),f&&(r-=a)):(s&&!c||f&&l===M.TabStripPosition.bottom)&&(r-=a),r<2&&(r=2),i.width=n+d,i.height=r+d)},k.prototype.RC=function(t){var n,e,e,i,e,i,r,o,a,u,s,c,f,l,a,c,h,d,v,m,m,g,n,e,o,n=this,e=n.Ti,e=(0,w.GC$)(e),i=n.Kg;i&&(E(t)&&(t=e.width()),e=(0,w.GC$)(i).height(),i=n.zb,r=n.Xw,o=n.Xb,u=(a=n.options).showVerticalScrollbar,s=a.showHorizontalScrollbar,c=a.scrollbarAppearance,f=a.tabStripVisible,l=a.tabStripPosition,a=f?a.tabStripWidth:0,c=c===M.ScrollbarAppearance.mobile,h=n.Xm(),d=n.NC(),v=n.VC(),m=(m=(0,_.jf)(n))?m.getHDockScrollbarWidth():0,u?((0,w.GC$)(n.kw).show(),(0,w.GC$)(o.oy()).show()):((0,w.GC$)(n.kw).hide(),(0,w.GC$)(o.oy()).hide()),s?((0,w.GC$)(n.Dw).show(),(0,w.GC$)(i.oy()).show(),(0,w.GC$)(r.oy()).show()):((0,w.GC$)(n.Dw).hide(),(0,w.GC$)(i.oy()).hide(),(0,w.GC$)(r.oy()).hide()),0===m?(0,w.GC$)(r.oy()).hide():(0,w.GC$)(r.oy()).show(),n=e,o.YC(h),o.ZC(n),e=t-m,l!==M.TabStripPosition.left&&l!==M.TabStripPosition.right||(e-=a),f&&!c&&l===M.TabStripPosition.bottom&&(e-=v),u&&!c&&(e-=d),o=h,s||f||l!==M.TabStripPosition.bottom||(o=0),i.YC(e=e<=0?1:e),i.ZC(o),r.YC(m),r.ZC(o))},k.prototype.VC=function(){var t,n,e,i,r,e,o,n,a,u,t=this,n=t.Kg,e=t.options,i=e.tabStripPosition,r=e.tabStripWidth,e=e.scrollbarAppearance,o=(0,_.jf)(t),n=(0,w.GC$)(n).width();return i===M.TabStripPosition.bottom||i===M.TabStripPosition.top?(o&&i===M.TabStripPosition.bottom&&e===M.ScrollbarAppearance.skin&&(n-=u=o.getHDockScrollbarWidth()),a=nt(t.Jg()*n),i===M.TabStripPosition.bottom&&a===n&&(a=n-1)):a=r,a},k.prototype.BC=function(){var t,n,n,e,e,i,r,i,o,t,i,t=this,n=t.Ti,n=(0,w.GC$)(n).height(),e=t.XM;e&&(e=e.style,r=(i=t.options).tabStripVisible,i=i.tabStripPosition,o=t.Zv(),t=t.VC(),i=i===M.TabStripPosition.bottom||i===M.TabStripPosition.top?o:n,r||(i=0),e.width=t+d,e.height=i+d)},k.prototype.LC=function(){var t,n,e,i,r,o,a,u,i,s,t,c,f,c,l,t=this,n=t.iC,e=t.MM,i=t.options,r=i.showVerticalScrollbar,o=i.showHorizontalScrollbar,a=i.tabStripVisible,u=i.tabStripPosition,i=i.scrollbarAppearance===M.ScrollbarAppearance.mobile,s=t.NC(),t=t.Zv(),f=u===M.TabStripPosition.top?(c=r&&!i?s:0,a?t:0):c=0;(0,w.GC$)(n).css("width",c+d),(0,w.GC$)(n).css("height",f+d),c=r&&!i?s:0,(o||a&&u===M.TabStripPosition.bottom)&&(l=t,!i||a&&u===M.TabStripPosition.bottom)||(l=0),(0,w.GC$)(e).css("width",c+d),(0,w.GC$)(e).css("height",l+d)},k.prototype.PC=function(){var t,n,e,i,e,t,t=this;t.Kg&&(n=t.nM,i=(e=t.options).scrollbarAppearance===M.ScrollbarAppearance.mobile,e=e.showVerticalScrollbar,t=[(0,w.GC$)(t.Kg).width(),t.NC()],!i&&e||(t[1]=0),n.rows[0].cells[0].style.width=t[0]+d,n.rows[0].cells[1].style.width=t[1]+d)},k.prototype.UC=function(){var t,n,e,t=this,n,e=t.options.scrollbarAppearance===M.ScrollbarAppearance.mobile;e&&t.kC(),t.WC(),t.QC(),e&&(t.Xb.qy(M.ScrollbarState.hide),t.zb.qy(M.ScrollbarState.hide))},k.prototype.HC=function(){var t,n,e,t=this,n,e;t.options.tabStripVisible?(0,w.GC$)(t.XM).show():(0,w.GC$)(t.XM).hide(),t.w2&&t.w2.Cg()},k.prototype.GC=function(t){var n,e,t;void 0===t&&(t=!0),(e=(0,_.jf)(n=this))?(0===e.Tb&&(e.Tb=e.pw()),0===e.Ab&&(e.Ab=e.Sw()),t&&e.Cg()):(t=n.getActiveSheetTab())&&t.Cg()},k.prototype.zC=function(){var t,n,e,t=this,n=(0,_.jf)(t);n&&(n.invalidateLayout(),n.repaint()),(e=t.KC())&&!t.JC&&(t.JC=!0,setTimeout(function(){delete t.JC,t.DC()},1))},k.prototype.KC=function(){var t,n,e,i,n,e,r,o,a,u,o,a,u,u,o,a,n,s,c,t=this,n=(0,w.GC$)(t.Ti),e=n.width(),i=2,n=n.width(),e=e!==n&&2<B(e-n),r=!1,o=t.zM,a=t.VM,u=t.nM;return o&&a&&u&&(o=(0,w.GC$)(o).width(),a=(0,w.GC$)(a).width(),u=(0,w.GC$)(u).width(),r=2<B(o+u+a-n)),o=t.Xw,a=(u=!1,_.jf)(t),o&&a&&(n=a.getDockScrollbarAttachedIndex(),E(n)||(s=o.YC())!==(c=a.getHDockScrollbarWidth())&&(u=!0)),e||r||u},k.prototype.kC=function(){var t,n,e,i,r,o,a,n,u,s,c,f,l,s,c,e,h,o,f,n,c,o,d,v,m,a,l,s,h,g,p,b,t=this;!E(t.Ti)&&(n=(0,w.GC$)(t.Ti),e=(0,_.jf)(t))&&(i=(0,w.GC$)(t.kw),r=(0,w.GC$)(t.Dw),o=e.Fi(),a=n.width(),n=n.height(),u=2,c=(s=t.options).tabStripVisible,f=s.showVerticalScrollbar,l=s.tabStripPosition,s=c?s.tabStripWidth:0,c=c?t.Zv():0,e=e.getHDockScrollbarWidth(),h=o.x+o.XC,o=o.y+o.qC,f=f?i.width():0,n=n-o,l!==M.TabStripPosition.bottom&&l!==M.TabStripPosition.top||(n-=c),c=0,l!==M.TabStripPosition.right&&l!==M.TabStripPosition.left||(c+=s),o=o,m=n-(d=y(i.css("padding-top")))-(v=y(i.css("padding-bottom"))),a=a-h,0===e&&(a-=f),l!==M.TabStripPosition.left&&l!==M.TabStripPosition.right||(a-=s),l=r.height(),s=-(n+o),h=h,b=a-(g=y(r.css("padding-left")))-(p=y(r.css("padding-right")))-e,0===e?b-=2:e-=f+p+2,t.Xb.YC(f),t.Xb.ZC(m),t.zb.YC(b),t.zb.ZC(l),t.Xw.YC(e),t.Xw.ZC(l),i.css(["height","left","right","top"],[n,"auto",c,o]),r.css(["width","top","bottom","left"],[a,"auto",s,h]))},k.prototype.WC=function(){var t=this,n=t.jg(),e=t.options;n&&(n.WC(e.scrollbarMaxAlign,e.scrollbarShowMax,t.zb),n.$C(t.Xw))},k.prototype.QC=function(){var t=this,n=t.jg(),e=t.options;n&&n.QC(e.scrollbarMaxAlign,e.scrollbarShowMax,t.Xb)},k.prototype.Xg=function(){var t,n,e,t=this,n;t.Ti&&(e=t.t3(),t.BC(),t.RC(e),t.GC(!1),t.UC(),t.HC())},k.prototype.t3=function(){var t,n,e,i,t=this.Ti,n=t.parentNode;return e=n&&"flex"===(i=n.style.display||getComputedStyle(n).display)?(0,w.GC$)(t).width():e},k.prototype.suspendPaint=function(){var t,n,e,i,r,o,a,u,s,c,t=this,n=t.w2,e=t.sheets,i=t.mp;for(t.sg++,r=0,o=e;r<o.length;r++)(a=o[r]).suspendPaint();for(u=0,s=i;u<s.length;u++)(c=s[u]).suspendPaint();n&&n.V2()},k.prototype.resumePaint=function(){var t,n,e,i,r,o,a,u,s,c,t=this,n=t.w2,e=t.sheets,i=t.mp;for(t.sg-=0<t.sg?1:0,r=0,o=e;r<o.length;r++)(a=o[r]).resumePaint();for(u=0,s=i;u<s.length;u++)(c=s[u]).resumePaint();n&&n.Y2()},k.prototype.wb=function(){var t,n,e,i,t=this,n=t.getActiveSheet();try{n&&(e=n.My,n.My=0,n.n3(),n.repaint(),n.My=e),t.w2&&(i=t.w2.sg,t.w2.sg=0,t.w2.repaint(),t.w2.sg=i)}catch(t){}},k.prototype.isPaintSuspended=function(){return 0<this.sg},k.prototype.nb=function(){var t,n,e,i,r,o,a,u,s,c,t=this,n=t.options.backgroundImage,e=t.options.backgroundImageLayout,i=(0,_.jf)(t);if(i&&n&&((r=(o=void 0,w.GC$)(i.Dg())).css({"background-image":"url('"+n+"')","background-repeat":"no-repeat"}),!E(e))){o=(o=t.MC)||(t.MC=new F.Wh(function(){t.MC&&t.nb()}));try{o.jt(n)?(a=o.Ot(n),s=(u=i.ot()).width,c=u.height,_.mt.Wf(i.Dg(),s,c,a.width,a.height,e)):o.Rt(n)}catch(t){}}},k.prototype.e3=function(t){var n,t,t,n=this,t=t.name(),t=n.getSheetPosition(t);n.w2.g2(t)},k.prototype.startSheetIndex=function(t){var n=this,e=n.w2;return 0===arguments.length?e?e.om:0:(e&&(e.k2(t)||-1===(t=e.N2(t))&&(t=e.Vm(t)),e.om=t),n.Xg(),n)},k.prototype.Jg=function(){var t,n,e,i,e,i,n,t,n,t=this,n=t.options,e=t.options.scrollbarAppearance===M.ScrollbarAppearance.mobile,i=n.tabStripPosition;return n.showHorizontalScrollbar&&!e&&i===M.TabStripPosition.bottom?(e=n.tabStripRatio,isNaN(e)?.5:(i=0,n=t.Kg,t=t.w2,n&&t&&(n=(0,w.GC$)(n).width(),i=t.rm()/n),e<i?e=i:1<e&&(e=1),e)):1},k.prototype.destroy=function(){this.dC&&(0,w.GC$)(j).unbind(st+v,this.dC),this.L0()},k.prototype.repaint=function(){var t,n,n,t=this,n=t.w2;n&&n.repaint(),(n=(0,_.jf)(t))&&n.repaint()},k.prototype.refresh=function(){var t=this;t.Ti&&(_.I.dl(),t.r3(),t.iM(),t.Cg(),t.repaint())},k.prototype.getHost=function(){return this.Ti},k.prototype.invalidateLayout=function(){var t=(0,_.jf)(this);t&&t.invalidateLayout()},k.prototype.addNamedStyle=function(t){this.$p(t);var t=(0,_.jf)(this);t&&t.zw()},k.prototype.$p=function(t){if(t){if(!t.name)throw new Error(N().Exp_EmptyNamedStyle);var n=t.name.toUpperCase();this.Hp[n]=t,this.r3()}},k.prototype.getNamedStyle=function(t){return this.i3(t,!0)},k.prototype.i3=function(t,n){var e,e,e=this.Hp;return e&&t?((e=e[t=t.toUpperCase()])&&n&&this.r3(),e):O},k.prototype.r3=function(){for(var t,n,e,i,t,n=0,e=this.sheets;n<e.length;n++)(i=e[n]).r3()},k.prototype.removeNamedStyle=function(t){var n,e,e,n=this.Hp;n&&t&&(t=t.toUpperCase(),n.hasOwnProperty(t))&&((e=n[t].formatter)&&"string"==typeof e&&this.bp[e]&&this.o3(e),delete n[t],this.r3(),e=(0,_.jf)(this))&&e.zw()},k.prototype.getNamedStyles=function(){var e=[],t=this.Hp;return t&&K(t,function(t,n){e.push(n)}),e},k.prototype.getActiveSheet=function(){return this.sheets&&0<this.sheets.length?this.sheets[this._2]:O},k.prototype.getActiveSheetTab=function(){return this.mp&&0<this.mp.length?this.mp[this.jb]:O},k.prototype.setActiveSheet=function(t){var n,e,n=this.getActiveSheet(),e=this.getActiveSheetTab();this.vb(t,2),this.a3(n),this.u3(e)},k.prototype.setActiveSheetTab=function(t){var n,e,n=this.getActiveSheet(),e=this.getActiveSheetTab();"number"==typeof t?this.yp(t,2):"string"==typeof t&&this.s3(t,2),this.a3(n),this.u3(e)},k.prototype.vb=function(t,n,e,i){for(var r,o,r=this.sheets,o=0;o<r.length;o++)if(r[o].name()===t){this.tb(o,n,e,i);break}},k.prototype.s3=function(t,n,e,i){for(var r,o,r=this.mp,o=0;o<r.length;o++)if(r[o].name()===t){this.yp(o,n,e,i);break}},k.prototype.getActiveSheetIndex=function(){return this._2},k.prototype.getActiveSheetTabIndex=function(){return this.jb},k.prototype.setActiveSheetIndex=function(t){var n,e,n=this.getActiveSheet(),e=this.getActiveSheetTab();this.tb(t,2),this.a3(n),this.u3(e)},k.prototype.tb=function(t,n,e,i,r){var o,a,r,u,u,s,c,c,f,c;typeof t==it&&t!==(o=this)._2&&((a=o.sheets[t])&&a.visible()===M.SheetTabVisible.visible||r)&&!(((r=_.mt.pi()).ipad||r.iphone)&&(u=o.c3)&&(new Date).valueOf()-u<300)&&(s=(s=u=o.getActiveSheet())||(c=o.getActiveSheetTab())&&c.Mf,Pt(o,c={oldSheet:s,newSheet:a,needTriggerSheetChange:!0}),f={oldSheet:s,newSheet:a,cancel:!1},(c=c.needTriggerSheetChange&&i)&&Ft(o,f),!1===f.cancel&&(o._2=t,o.f3(),a!==u&&(u&&(u.L0(!1),u.charts)&&u.charts.all().forEach(function(t){t.clearflexDVs()}),a)&&o.l3(a,n,!1,c,e),o.Cg(),Gt(o,s,a),c)&&Lt(o,s,a),r.ipad||r.iphone)&&(o.c3=(new Date).valueOf())},k.prototype.yp=function(t,n,e,i){var r,o,a,u,s,s,c,f,l,f;typeof t==it&&t!==(r=this).jb&&(o=r.mp[t])&&o.visible()===M.SheetTabVisible.visible&&(a=o.Mf,((u=_.mt.pi()).ipad||u.iphone)&&(s=r.c3)&&(new Date).valueOf()-s<300||(c=(s=r.getActiveSheetTab())?s.Mf:r.getActiveSheet(),Pt(r,f={oldSheet:c,newSheet:a,needTriggerSheetChange:!0}),l={oldSheet:c,newSheet:a,cancel:!1},(f=f.needTriggerSheetChange&&i)&&Ft(r,l),!1===l.cancel&&(r.jb=t,r.h3(),o!==s&&(s&&s.L0(!1),r.d3(o,n,!1,f,e)),r.Cg(),Gt(r,c,a),f)&&Lt(r,c,a),(u.ipad||u.iphone)&&(r.c3=(new Date).valueOf())))},k.prototype.l3=function(t,n,e,i,r){var e,e,e;e||t.hg(this.Kg),e=(e=_.hi.ai())&&e.parent===this,e=2===n?e:1===n,_.hi.F1(O),!this.Bp&&e&&t.Zg(r),t.aw(),t.tw()},k.prototype.d3=function(t,n,e,i,r){var e,e,e;e||t.hg(this.Kg),e=(e=_.hi.ai())&&e.parent===this,e=2===n?e:1===n,_.hi.F1(O),!this.Bp&&e&&t.Zg(r),t.aw(),t.tw()},k.prototype.a3=function(t){var n=this.getActiveSheet();t&&t.b2(!1,!1),n&&n.b2(!0,!1)},k.prototype.u3=function(t){var n=this.getActiveSheetTab();t&&t.b2(!1,!1),n&&n.b2(!0,!1)},k.prototype.addSheet=function(t,n){var e,i,e=this.getActiveSheet(),i=this.getActiveSheetTab();this.A2(t,2,n),this.a3(e),this.u3(i)},k.prototype.addSheetTab=function(t,n,e){var i,r,n,i=this.getActiveSheet(),r=this.getActiveSheetTab(),n=this.bb(n,e);if(n)return this.suspendPaint(),this.yb(t,2,n),this.a3(i),this.u3(r),this.resumePaint(),n},k.prototype.mse=function(t,n,e){for(var i,r,o,i=t.length,r=[],o=0;o<e&&0<i;o++)r.push(t.pop());for(t.push(n);0<r.length;)t.push(r.pop())},k.prototype.gse=function(t,n,e){for(var i,r,o,a,u,s,i=t.length,r=[],o=0,a=n instanceof f.Worksheet;o<e&&0<i;)u=t[t.length-1]instanceof f.Worksheet,(a&&u||!a&&!u)&&o++,r.push(t.pop());for(t.push(n),n.E0i=t.length-1;0<r.length;)s=r.pop(),t.push(s),s.E0i=t.length-1},k.prototype.pse=function(t,n){for(var e,i,r,e=0;e<t.length;e++)if(t[e].name()===n){for(i=e;i<t.length-1;i++)(r=t[i+1]).E0i--,t[i]=r;t.length=t.length-1;break}},k.prototype.A2=function(t,n,e){var i,r,o,a,u,s,c,t,i=this;if(e=e||i.S2(i.T2(t)),a=(o=i.sheets).length,e.name()){for(u=i.qv(),r=0;r<u.length;r++)if(u[r].name()===e.name())throw N().Exp_NotSupported}else e.ub(i.T2(t));i.v3(e),s=i.getActiveSheet(),c=i._2,i.mse(o,e,a-t),e.pM(i),i.gse(i.hse,e,a-t),i.f3(),1===(a=o.length)?(i.Kg&&e.hg(i.Kg),i._2=0):(c<0&&i.w2&&(c=i.w2.N2(c)),i._2=c),(t=i.getActiveSheet())!==s&&(s&&s.L0(!1),t&&i.l3(t,n,1===a,!0),i.Cg()),i.w2&&(i.w2.om<0&&(i.w2.om=i._2),i.w2.repaint())},k.prototype.yb=function(t,n,e){var i,r,o,a,u,s,c,t;if(e){for(a=(o=(i=this).mp).length,u=i.qv(),r=0;r<u.length;r++)if(u[r].name()===e.name())throw N().Exp_NotSupported;i.v3(e),s=i.getActiveSheetTab(),c=i.jb,i.mse(o,e,a-t),e.pM(i),i.gse(i.hse,e,a-t),1===(a=o.length)?(i.Kg&&e.hg(i.Kg),i.jb=0):(c<0&&i.w2&&(c=i.w2.N2(c)),i.jb=c),i.h3(),(t=i.getActiveSheetTab())!==s&&(s&&s.L0(!1),t&&i.d3(t,n,1===a,!0),i.Cg()),i.w2&&(i.w2.om<0&&(i.w2.om=i.jb),i.w2.repaint())}},k.prototype.removeSheet=function(t){this.m3(t,2)},k.prototype.removeSheetTab=function(t){"string"==typeof t&&(t=this.getSheetTabIndex(t)),this.g3(t,2)},k.prototype.m3=function(t,n){var e,i,r,o,a,u,s,c,f,l,s,h,d,v,m,g,p,u,c,s,n,t,e=this,i=e.sheets,r=e.Lp,o=e.w2,a=i.length;if(isNaN(t)||t<0||a<=t)throw new Error(N().Exp_IndexOutOfRange);if(u=e._2,s=t<=e._2||t===a-1,c=e.getActiveSheet(),t<e._2&&e._2--,(f=i[t]).bC(),i.splice(t,1),e.pse(e.hse,f.name()),0===(a=i.length))e._2=-1;else if(e._2>=a)e._2=o.Vm(a);else{for(l=void 0,l=Math.max(0,e._2);l<a;l++)if(i[l].visible()===M.SheetTabVisible.visible){e._2=l;break}a<=l&&(e._2=o.Vm(a))}if(e.f3(),(s||u!==e._2)&&c!==(s=i[e._2])&&(c&&c.L0(!1),s)&&e.l3(s,n,!1,!0),r){if(r.suspend(),f.b3().p3(),h={},d=r.y3)for(m in v=f.b3().getSource().id,d)if(d.hasOwnProperty(m))for(h[m]=[],g=d[m];g;)v!==(p=g.w3&&g.w3.getSource().id)&&h[m].push(g),g=g.C3;for(m in(u=f.Uw()).S3=t,r.removeSource(u),c=f.T3,r.removeSource(c),s=f.A3,r.removeSource(s),n=f.Dnn,E(n)||r.removeSource(n),h)if(h.hasOwnProperty(m))for(g=h[m],l=0;l<g.length;l++)r.I3(g[l],parseInt(m,10));r.resume(!1)}f.L0(!0,-1!==e._2),b&&!r.x3&&e.sheets&&0<e.sheets.length&&(t=e.sheets[0],r.initParserContext(t.Uw())),o&&(o.om>=a?e.startSheetIndex(o.Vm(a)):o.om<0?e.startSheetIndex(o.N2(-1)):e.Cg())},k.prototype.g3=function(t,n){var e,i,r,o,a,u,s,c,f,l,s,u,s,n,c,t,e=this,i=e.mp,r=e.Lp,o=e.w2,a=i.length;if(isNaN(t)||t<0||a<=t)throw new Error(N().Exp_IndexOutOfRange);if(u=e.jb,s=t<=e.jb||t===a-1,c=e.getActiveSheetTab(),t<e.jb&&e.jb--,(f=i[t]).bC(),i.splice(t,1),e.pse(e.hse,f.name()),0===(a=i.length))e.jb=-1;else if(e.jb>=a)e.jb=o.Vm(a);else{for(l=void 0,l=Math.max(0,e.jb);l<a;l++)if(i[l].visible()===M.SheetTabVisible.visible){e.jb=l;break}a<=l&&(e.jb=o.Vm(a))}e.h3(),!s&&u===e.jb||c===(s=i[e.jb])||(c&&c.L0(!1),s&&e.d3(s,n,!1,!0),e.u3(c)),r&&(r.suspend(),(s=(u=f.Mf).Uw()).S3=t,r.removeSource(s),n=u.T3,r.removeSource(n),c=u.A3,r.removeSource(c),t=u.Dnn,E(t)||r.removeSource(t),r.resume(!1)),f.L0(!0,-1!==e.jb),o&&(o.om>=a?e.startSheetIndex(o.Vm(a)):o.om<0?e.startSheetIndex(o.N2(-1)):e.Cg())},k.prototype.clearSheets=function(){for(var t,n,e,i,r,o,a,t=this,n=t.sheets,e=t.Lp,i=t.w2,r=0,o=n;r<o.length;r++)(a=o[r]).bC(),a.L0(!0);n.splice(0,n.length),t.hse=t.bse(t.mp),e&&e.clearSource(),t._2=-1,i&&(i.om=-1,i.repaint())},k.prototype.clearSheetTabs=function(){for(var t,n,e,i,r,o,t=this,n=t.mp,e=t.w2,i=0,r=n;i<r.length;i++)(o=r[i]).bC(),o.L0(!0);n.splice(0,n.length),t.hse=t.bse(t.sheets),t.jb=-1,e&&(e.om=-1,e.repaint())},k.prototype.getSheet=function(t){var n=this.sheets;return 0<=t&&t<n.length?n[t]:O},k.prototype.getSheetTab=function(t){return this.Efe(t)},k.prototype.Efe=function(t){var n,e,i,r,n=this.mp;if("number"==typeof t)return 0<=t&&t<n.length?n[t]:O;if("string"==typeof t)for(e=0,i=n;e<i.length;e++)if((r=i[e]).name()===t)return r;return O},k.prototype.getSheetFromName=function(t){return this._f(t)},k.prototype._f=function(t){for(var n,e,i,r,n,e=0,i=this.sheets;e<i.length;e++)if((r=i[e]).name()===t)return r;return O},k.prototype.getSheetIndex=function(t){for(var n,e,n=this.sheets,e=0;e<n.length;e++)if(n[e].name()===t)return e;return O},k.prototype.getSheetTabIndex=function(t){for(var n,e,n=this.mp,e=0;e<n.length;e++)if(n[e].name()===t)return e;return O},k.prototype.getSheetPosition=function(t){for(var n,e,n=this.hse,e=0;e<n.length;e++)if(n[e].name()===t)return e;return-1},k.prototype.getSheetCount=function(){return this.sheets.length},k.prototype.getSheetTabCount=function(){return this.mp.length},k.prototype.setSheetCount=function(t){var n,e,i,n=this,e=n.getActiveSheet(),i=n.getActiveSheetTab();n.Xp(t,2),n.a3(e),n.u3(i)},k.prototype.Xp=function(t,n){var e,i,r,e=this;if(t<0)throw N().Exp_ArgumentOutOfRange;if(0===t&&e.clearSheets(),t<(i=e.sheets.length))for(r=i-1;t<=r;r--)e.m3(r,n);else if(i<t)for(r=i;r<t;r++)e.A2(r,n)},k.prototype.hp=function(t,n){var e,i,r,o,e=this;if(t<0)throw N().Exp_ArgumentOutOfRange;if(0===t&&e.clearSheetTabs(),t<(i=e.mp.length))for(r=i-1;t<=r;r--)e.g3(r,n);else if(i<t)for(r=i;r<t;r++)o=e.bb(O,M.SheetType.tableSheet),e.yb(r,n,o)},k.prototype.bb=function(t,n){var e={name:t,type:n,sheetTab:O};return k.et(this,"createSheetTab",e,function(){return e.sheetTab!==O}),e.sheetTab},k.prototype.dataManager=function(){var t=this,n=t.N3;return n=!n&&Z.DataManager?t.N3=new Z.DataManager(t.Lp):n},k.prototype.bind=function(t,n,e){var i,r,o,a,u,s,c,f,l,i=this,r=i.sheets;for(i.rM&&i.rM.push({type:t,data:n,fn:e}),(0,w.GC$)(i.oM).bind(t+v,n,e),o=0,a=r;o<a.length;o++)(u=a[o]).bind(t,n,e);for(c=0,f=s=i.mp;c<f.length;c++)(l=f[c]).bind(t,n,e)},k.prototype.unbind=function(t,n){var e,i,r,o,a,u,s,c,f,l,h,d,e=this,i=e.sheets,r=e.rM;if(r)for(o=r.length-1;0<=o;o--)(a=r[o]).type!==t&&!e.k3(a.type,t)||r.splice(o,1);for((0,w.GC$)(e.oM).unbind(t+v,n),u=0,s=i;u<s.length;u++)(c=s[u]).unbind(t,n);for(l=0,h=f=e.mp;l<h.length;l++)(d=h[l]).unbind(t,n)},k.prototype.k3=function(t,n){return 0===n.indexOf(".")&&t.substring(t.length-n.length)===n},k.prototype.unbindAll=function(){var t,n,e,i,r,o,a,u,s,t=this,n=t.sheets;for((t.rM.length=0,w.GC$)(t.oM).unbind(v),e=0,i=n;e<i.length;e++)(r=i[e]).unbindAll();for(a=0,u=o=t.mp;a<u.length;a++)(s=u[a]).unbindAll()},k.prototype.D3=function(t,n,e){var i,r,o,a,u,s,c,f,l,i=this,r=i.sheets;for(i.rM.push({type:t,data:n,fn:e}),(0,w.GC$)(i.oM).bind(t+ft,n,e),o=0,a=r;o<a.length;o++)(u=a[o]).D3(t,n,e);for(c=0,f=s=i.mp;c<f.length;c++)(l=f[c]).D3(t,n,e)},k.prototype._3=function(t,n){for(var e,i,r,o,a,u,s,c,f,l,h,d,e=this,i=e.sheets,r=e.rM,o=0;o<r.length;o++)(a=r[o]).type!==t&&!e.k3(a.type,t)||r.splice(o,1);for((0,w.GC$)(e.oM).unbind(t+ft,n),u=0,s=i;u<s.length;u++)(c=s[u])._3(t,n);for(l=0,h=f=e.mp;l<h.length;l++)(d=h[l])._3(t,n)},k.prototype.E3=function(){var t,n,e,i,r,o,a,u,s,t=this,n=t.sheets;for((t.rM.length=0,w.GC$)(t.oM).unbind(ft),e=0,i=n;e<i.length;e++)(r=i[e]).E3();for(a=0,u=o=t.mp;a<u.length;a++)(s=u[a]).E3()},k.prototype.ki=function(t,n){0===this.vf&&(0,w.GC$)(this.oM).trigger(t,n)},k.prototype.pb=function(t,n){(0,w.GC$)(this.oM).trigger(t,n)},k.prototype.j3=function(t,n,e,i){this.ki(_.Events.ButtonClicked,{sheet:t,sheetName:t.name(),row:n,col:e,sheetArea:i})},k.prototype.v3=function(t){for(var n,e,i,r,n,e=0,i=this.rM;e<i.length;e++)r=i[e],t.bind(r.type,r.data,r.fn)},k.prototype.suspendEvent=function(){var t,n,e,i,r,o,a,u,s,t=this,n=t.sheets;for(t.vf++,e=0,i=n;e<i.length;e++)(r=i[e]).suspendEvent();for(a=0,u=o=t.mp;a<u.length;a++)(s=u[a]).suspendEvent()},k.prototype.resumeEvent=function(){var t,n,e,i,r,o,a,u,s,t=this,n=t.sheets;for(t.vf--,t.vf<0&&(t.vf=0),e=0,i=n;e<i.length;e++)(r=i[e]).resumeEvent();for(a=0,u=o=t.mp;a<u.length;a++)(s=u[a]).resumeEvent()},k.prototype.focus=function(t){var t,t;!1===t?_.hi.F1(O):(t=this.getActiveSheet())?t.Zg():(t=this.getActiveSheetTab())&&t.Zg()},k.prototype.Xm=function(){return 2007<this.SC?15:18},k.prototype.NC=function(){return 2007<this.SC?22:this.Xm()},k.prototype.ZM=function(t){var n,e,i,r,o,a,n=this,e=t?n.kw:n.Dw,i=t?n.Xb:n.zb,r=n.options.scrollbarAppearance===M.ScrollbarAppearance.mobile;if(e&&i&&r)switch(o=n.ib,a=i.O3){case M.ScrollbarState.hide:o.$y(t);break;case M.ScrollbarState.show:o.Iw(e),o._w(t);break;case M.ScrollbarState.active:o.Iw(e),o._w(t),o.xw(e);break;case M.ScrollbarState.inactive:o.Nw(e),o.$y(t)}},k.prototype.Zv=function(){return 2007<this.SC?28:this.Xm()},k.prototype.Tw=function(t,n,e,i,r){var o,a,u,s,o="auto",a=this;a.R3||(u=(0,w.getHostMaxZIndex)(a.Ti)+1,s=c(h),r?(0,w.GC$)(s).addClass("gc-spread-pivot-toolTip"):(0,w.GC$)(s).addClass("gc-spread-toolTip"),(0,w.GC$)(s).addClass("ui-state-default ui-widget-content btn-default").css({position:gt,padding:"0px 3px 0px 3px",font:$("normal normal normal 11pt calibri"),"box-shadow":"1px 2px 5px rgba(0,0,0,0.4)","white-space":"pre-wrap","z-index":u}).width(o).height(o).appendTo(l.body),a.R3=s),a.ny(t,n,e,i)},k.prototype.ny=function(t,n,e,i){var r,o,r,r,t,i,o,i,r=this,o=r.jg();o&&(r=r.R3)&&(r=(0,w.GC$)(r),t?(r.html(t),r.show()):r.hide(),t=o.uw(),i&&(e-=t.top,n-=t.left),o=(i=o.ot()).x+i.width-r.outerWidth(),i=i.y+i.height-r.outerHeight(),o<0?n=0:i<0?e=0:(e=R(e,i),n=R(n,o)),E(e)||r.css("top",e+t.top),E(n)||r.css("left",n+t.left))},k.prototype.iy=function(){var t=this,n=t.R3;n&&((0,w.GC$)(n).remove(),t.R3=O)},k.prototype.FM=function(){var t,n,e,i,r,t=this,n=t.qv();for(_.Be.zl(),t.invalidateLayout(),e=0,i=n.length;e<i;e++)(r=n[e]).FM();N(),o.Common.B3(),Y&&V.sR(),t.repaint(),k.et(t,"onCultureChanged")},k.prototype.getTab=function(){return this.w2},k.prototype.changeSheetIndex=function(t,n){var e,i,r,o,o,t,e=this,i=e.getSheetPosition(t),r=e.getTab(),o=e.getSheetCount()+e.getSheetTabCount();return!("number"!=typeof n||-1===i||i===n||n<0||o<=n||n%1!=0||e.L3(t)||((o=e.jg().name())!==t?(e.suspendPaint(),e.setActiveSheetOrSheetTabIndex(i,2),e.o2(i,n),t=e.getSheetPosition(o),e.setActiveSheetOrSheetTabIndex(t,2),e.resumePaint()):(e.o2(i,n),r.G2(i,n)),0))},k.prototype.changeSheetPosition=function(t,n){var e,i,r,o,o,t,e=this,i=e.getSheetPosition(t),r=e.getTab(),o=e.getSheetCount()+e.getSheetTabCount();return!("number"!=typeof n||-1===i||i===n||n<0||o<=n||n%1!=0||e.L3(t)||((o=e.jg().name())!==t?(e.suspendPaint(),e.setActiveSheetOrSheetTabIndex(i,2),e.Dse(i,n),t=e.getSheetPosition(o),e.setActiveSheetOrSheetTabIndex(t,2),e.resumePaint()):(e.Dse(i,n),r.G2(i,n)),0))},k.prototype.L3=function(t){for(var n,e,i,r,o,a,u,s,c,n=this,e,i=0,r=n.sheets;i<r.length;i++)if((o=r[i]).name()===t)return!1;for(u=0,s=a=n.mp;u<s.length;u++)if((c=s[u]).name()===t)return!1;return!0},k.prototype.o2=function(t,n){var e,i,r,o,a,u,s,c,f,l,h,d,e=this,i=-1,r=e.qv(),a=r[t],u=e.sheets.length;if($t(e)){if(n<t)if(u<=t&&n<u)r.splice(t,1),r.splice(u,0,a),i=u;else{for(o=t;n<o;o--)r[o]=r[o-1];r[n]=a,i=n}else if(t<n)if(t<u&&u<=n)r.splice(u,0,a),r.splice(t,1),i=u-1;else{for(o=t;o<n;o++)r[o]=r[o+1];r[n]=a,i=n}}else if(s=e.getSheetTabCount(),l=void(f=c=0),h=E(a._gi),0<=t&&t<u&&0<=n&&n<u||u<=t&&t<u+s&&u<=n&&n<u+s){for(o=0;o<r.length;o++)if(d=r[o],E(d._gi)?c++:f++,h&&c-1===n||!h&&f-1===n){l=o;break}if(l<t){for(o=t;l<o;o--)r[o]=r[o-1];r[l]=a,i=l}else if(t<l){for(o=t;o<l;o++)r[o]=r[o+1];r[l]=a,i=l}}e.P3(r),e.setActiveSheetOrSheetTabIndex(i,2)},k.prototype.Dse=function(t,n){var e,i,r,o,a,e=this,i=-1,r=e.qv(),a=r[t];if(n<t){for(o=t;n<o;o--)r[o]=r[o-1];r[n]=a,i=n}else if(t<n){for(o=t;o<n;o++)r[o]=r[o+1];r[n]=a,i=n}e.P3(r),e.setActiveSheetOrSheetTabIndex(i,2)},k.prototype.F3=function(t,n){t?this.setActiveSheetTab(n):this.setActiveSheet(n)},k.prototype.setActiveSheetOrSheetTab=function(t){var n=this.getSheetIndex(t),e=!1;E(n)&&(n=this.getSheetTabIndex(t),e=!0),E(n)||this.F3(e,t)},k.prototype.clone=function(t,n,e,i){var r,t,o,a,u,s,c,f,l,h,r=this,t=r.getSheetFromName(t);if(E(i)&&(i=!0),!(E(t)||E(e)||r.getSheetFromName(e))){for(r.suspendPaint(),r.suspendCalcService(),o=JSON.stringify(t.toJSON({newWorkSheetName:e})),n<0&&(n=0),a=r.S2(e),r.addSheet(n,a),r.getSheetPosition(e)!==n&&r.changeSheetPosition(e,n),a.Uw().G3=!0,a.fromJSON(JSON.parse(o)),r.setActiveSheet(a.name()),u=t.tables.U3,s=a.tables.U3,l=0;l<u.length;l++)u[l].H3&&i&&(c=u[l].z3(),s[l].V3(c)),f=s[l].range(),a.Q1i&&a.Q1i(f.row,f.col,f.rowCount,f.colCount,M.SheetArea.viewport);return(c=t.H3._dataSource)&&i&&(h=a.H3).bind(c),r.resumeCalcService(!1),r.resumePaint(),a}},k.prototype.fM=function(t){var n,e,t,n,i,t,n=this,e=t.command;0!==t.vM&&e.hM||(t=e.sheetName?(0,_._f)(n,e.sheetName):(0,_.jf)(n))&&(n=t.getActiveRowIndex(),i=t.getActiveColumnIndex(),t=t.getSelections(),e.Z3={W3:t,K3:{row:n,col:i}})},k.prototype.mM=function(t){var n,t,e,i,r,t,o,a,e,u,s,c,f,l,h,n=this,t=t.command,e=t.Z3,i=(0,_.jf)(n),r;if((i&&i.name())!==t.sheetName&&((0,_.Ef)(n,t.sheetName),i=(0,_.jf)(n)),!E(e)&&i){if(i.suspendPaint(),t=e.K3,o=e.W3,a=e.J3,e=e.X3,E(t)||i.t4(t.row,t.col),!E(o))if(1===(u=o.length))i.setSelection(o[0].row,o[0].col,o[0].rowCount,o[0].colCount);else for(s=0;s<u;s++)c=o[s].row,f=o[s].col,l=o[s].rowCount,h=o[s].colCount,i.n4(c,f,l,h);if(k.et(n,"onCommandExecuting",i),!E(a)){for(s=0;s<a.length;s++)a[s].isSelected&&a[s].isSelected(!0);e||i.e4()}i.showCell(t.row,t.col,3,3),i.resumePaint()}},k.prototype.changeSelectionInCommandExecuting=function(t,n,e,i,r){var t,o;t&&t.Z3&&(o=(t=t.Z3).K3,E(o)||(E(n)||(o.row=n),E(e))||(o.col=e),E(i)||(t.W3=i),E(r)||(t.J3=r))},k.prototype.h3=function(){var t=this.getActiveSheet();t&&(t.L0(!1),t.b2(!1,!1)),this._2=-1},k.prototype.f3=function(){var t=this.getActiveSheetTab();t&&(t.L0(!1),t.b2(!1,!1)),this.jb=-1},k.prototype.bse=function(t){for(var n,e,i,n=[],e=0;e<t.length;e++)n[(i=t[e]).E0i=e]=i;return n},k.prototype.dse=function(t,n){for(var e,i,e=[],i=0;i<t.length;i++)e.push(t[i]);for(i=0;i<n.length;i++)e.push(n[i]);for(e.sort(function(t,n){return t.E0i-n.E0i}),i=0;i<e.length;i++)e[i].E0i=i;return e},k.prototype.qv=function(){var t=this;return t.sheets.length+t.mp.length!==t.hse.length&&(t.hse=[].concat(t.sheets).concat(t.mp)),t.hse},k.prototype.P3=function(t){var n,e,i,r,o,a,u,s,c,n=this,r=n.getActiveSheet(),o=n.getActiveSheetTab();for(r?e=r.name():o&&(i=o.name()),n.sheets.length=0,n.mp.length=0,a=n.sheets,u=n.mp,s=0;s<t.length;s++)(c=t[s]).E0i=s,(c instanceof f.Worksheet?a:u).push(c);e?n._2=n.getSheetIndex(e):i&&(n.jb=n.getSheetTabIndex(i)),n.hse=t},k.prototype.Gm=function(t){return this._f(t)||this.Efe(t)},k.prototype.e2=function(t){return this.qv()[t]},k.prototype.getActiveSheetOrSheetTab=function(){return this.jg()},k.prototype.jg=function(){return this.getActiveSheet()||this.getActiveSheetTab()},k.prototype.I2=function(t,n,e,i){var t=this.e2(t);t&&(t instanceof f.Worksheet?this.vb(t.name(),n,e,i):this.s3(t.name(),n,e,i))},k.prototype.setActiveSheetOrSheetTabIndex=function(t,n,e,i){var r,o,r=this.getActiveSheet(),o=this.getActiveSheetTab();this.I2(t,E(n)?2:n,e,i),this.a3(r),this.u3(o)},k.prototype.getActiveSheetOrSheetTabIndex=function(){return this.ep()},k.prototype.ep=function(){var t=this.jg();return t?t.E0i:-1},k.prototype.i4=function(){var n=[].concat(this.sheets);return this.mp.forEach(function(t){t.Mf&&n.push(t.Mf)}),n},k.prototype.r4=function(){for(var t,n,e,i,r,o,t,n=this.sheets,e=n.length,i=[],r=0;r<e;r++)(o=n[r])&&i.push(o.name());return i},k.prototype._se=function(t){var n=this.getSheetIndex(t);return n=E(n)?this.getSheetTabIndex(t):n},k.Pp=jt,k.Jp=1,k.Gp=0,L.Workbook=n=k,(0,_.$e)(n),n.prototype.nextControl=t("nextControl",O),n.prototype.previousControl=t("previousControl",O)},"./dist/core/workbook/workbookpanelex.js":function(g,t,n){"use strict";var j,e,i,O,n,f,p,y,w,X,i,a,M,R,C,q,$,tt,nt,et,it,rt,ot,at,ut,st,S,ct,ft,lt,B,L,s,ht,F,dt,P,vt,mt,G,U,H,z,gt,V,pt,Y,bt,Z,W,Q,yt,r,T,o,A,I,x,u,J,K,c,b,N,l,k,h,D,e,h;function d(t){t.preventDefault?t.preventDefault():t.returnValue=!1}function v(t,n,e,i,r,o,a,u,s){this.updateStateFn=s;var s=this;s.o4=u,s.a4=!1,s.u4=!1,s.s4=p,s.c4=p,s.f4=300,s.l4=70,s.h4=t,s.qy(O.ScrollbarState.show),s.YC("number"==typeof n?n:0),s.ZC("number"==typeof e?e:0),s.d4("number"==typeof i?i:0),s.v4("number"==typeof r?r:0),s.m4("number"==typeof o?o:0),s.g4="number"==typeof a?a:1,s.p4=!1,s.b4=0,s.y4=s.m4(),s.w4()}function wt(t,n){var t=t.get(0);t&&(t.style[n]="")}function m(t,n){var e=this;e.C4=!0,e.S4=!0,e.T4=18,e.A4=t&&(0,j.GC$)(t),e.I4=n&&(0,j.GC$)(n),e.w4(!0)}Object.defineProperty(t,"__esModule",{value:!0}),t.x4=t.YM=t.ScrollOrientation=void 0,j=n("./dist/core/util/domUtil.js"),e=n("./dist/core/util/common.js"),i=n("Common"),O=n("./dist/core/core.enum.js"),n=n("./dist/core/workbook/sheettabbase.js"),f=i.Common.lt.ht,p=null,y=e.mt.Tt,w=e.mt.vi,X=e.mt.En,i=e.mt.p0,a=document,M=window,R=Math.round,C=Math.ceil,q="gc-scroll-container",$="gc-scroll-corner-all",tt="gc-scroll-arrow",nt="gc-scrollbar-wrapper",et="gc-scroll-bar",it="gc-scroll-arrowUp",rt="gc-scroll-arrowDown",ot="gc-scroll-arrowLeft",at="gc-scroll-arrowRight",ut="gc-scroll-mobile-track",st="gc-scroll-mobile-thumb",S="gc-scroll-mobile-state-active",ct="gc-scrollbar-vertical",ft="gc-scrollbar-horizontal",lt="gc-no-user-select",B="width",L="height",s="gc-scrollbar-stateActive ui-state-active",ht="float",F="left",dt="right",P="top",vt="bottom",mt="margin-left",G="position",U="border",H="padding",z="margin",gt="overflow",V="display",pt="outline",Y="100%",bt="borderWidth",Z="boxSizing",W="absolute",Q="relative",yt="margin-top",T="mousedown"+(r=".gcScrollbar"),o="mouseup"+r,A="mousemove"+r,I="mouseover"+r,x="mouseout"+r,u="mousewheel",J="inline-block",K="content-box",c="DOMMouseScroll",b="scroll"+r,N="scrollbar",(h=l=t.ScrollOrientation||(t.ScrollOrientation={}))[h.horizontalScroll=0]="horizontalScroll",h[h.verticalScroll=1]="verticalScroll",v.prototype.oy=function(){return this.N4},v.prototype.qy=function(t){t===O.ScrollbarState.inactive&&this.a4||(this.O3=t,this.updateStateFn&&this.updateStateFn())},v.prototype.value=function(t){var n,t,n=this;return 0===arguments.length?n.y4:("number"==typeof t&&t<=n.v4()&&t>=n.m4()&&(t=((n.y4=t)-n.m4())*n.k4,n.scrollTo(t,!0)),n)},v.prototype.w4=function(){var n,t,e,i,r,o,a,u,s,c,f,l,h,d,v,m,g,p,b,y,w,M,C,S,T,A,I,x;function N(){n.N4=X("div"),n.D4=(0,j.GC$)(n.N4),n.D4.css([G,F,P,gt,pt,H,z],[Q,0,0,"hidden","none",0,0]).addClass(q+" "+$+" "+u+" "),n.h4&&n.D4.css(ht,F)}function k(t){n._4=j.GC$.En("div",[G,V,bt,H,z,Z],[W,J,"1px",0,0,K],tt+" "+y,t),n.E4=j.GC$.En("span",[V,U,H,z],["block","none",0,0],m+" "+w,n._4)}function D(t){n.j4=j.GC$.En("div",[G,V,Z,U,H,z],[W,J,K,"none",0,0],nt+" "+nt,t)}function _(t){n.O4=j.GC$.En("div",[],[],lt+" "+M+" "+et,t),n.R4=j.GC$.En("span",[V,U,H,z],["block","none",0,0],p+" "+C,n.O4)}function E(t){n.B4=j.GC$.En("div",[G,V,bt,H,z,Z],[W,J,"1px",0,0,K],tt+" "+S,t),n.L4=j.GC$.En("span",[V,U,H,z],["block","none",0,0],g+" "+T,n.B4)}e=t=0,i=!1,a=(o=(r=(n=this).o4)===O.ScrollbarAppearance.mobile)?0:2,u="ui-widget ui-corner-all",s=n.ZC(),c=n.YC(),h=f=o?0:s,d=F,v=dt,m=ot,g=at,p=ft,b=mt,y="ui-button ui-state-default ui-corner-bl btn btn-default",w="ui-icon ui-icon-triangle-1-w",M="gc-scroll-handle ui-button ui-state-default ui-corner-all ui-draggable btn btn-default",C="ui-icon ui-icon-grip-solid-vertical",S="ui-button ui-state-default ui-corner-br btn btn-default",T="ui-icon ui-icon-triangle-1-e",n.F4=l=c-2*f,n.h4||(l=f=o?0:c,d=P,v=vt,m=it,g=rt,p=ct,b=yt,y="ui-button ui-state-default ui-corner-tr btn btn-default",w="ui-icon ui-icon-triangle-1-n",M="gc-scroll-handle ui-button ui-state-default ui-corner-all ui-draggable btn btn-default",C="ui-icon ui-icon-grip-solid-horizontal",S="ui-button ui-state-default ui-corner-br btn btn-default",T="ui-icon ui-icon-triangle-1-s",n.F4=h=s-2*f),A=n.F4,I=n.v4()-n.m4(),n.P4=n.d4()*A/(I+n.d4()),n.P4>A&&(n.P4=A),n.P4<10&&(n.P4=10),x=n.P4,n.k4=0==I?1:(A-x)/I,e=n.h4?(t=x,f):(t=f,x),n.D4||(i=!0,N()),o?n.D4.addClass(ut):n.D4.removeClass(ut),n._4||k(n.D4),n.j4||D(n.D4),n.O4?n.O4.removeAttr("style"):_(n.j4),o?n.O4.css(G,W).addClass(st):n.O4.css([G,bt,H,z,Z],[W,"1px",0,0,K]).removeClass(st),n.B4||E(n.D4),o?(wt(n.D4,U),wt(n.D4,z),n.h4?(n.D4.css([B,L],[c,Y]),n.j4.css([d,B,L],[f,Y,Y]),n.O4.css([d,B,L],[n.b4,R(t-a),Y])):(n.D4.css([B,L,z],[Y,Y,0]),n.j4.css([d,B,L],[f,Y,Y]),n.O4.css([d,B,L],[n.b4,Y,R(e-a)])),n.R4.remove(),n._4.remove(),n.B4.remove()):(n.D4.css([B,L,U],[c,s,"none"]),n.j4.css([d,B,L],[f,l,h]),n.O4.css([d,B,L],[n.b4,R(t-a),R(e-a)]),n._4.css([d,B,L],[0,f-a,f-a]),n.E4.css([B,L],[Y,Y]),n.B4.css([v,B,L],[0,f-a,f-a]),n.L4.css([B,L],[Y,Y]),n.R4.css([B,L,b],[f-a,f-a,Math.floor((n.P4-f)/2)]),n.O4.append(n.R4),n.D4.append(n._4),n.D4.append(n.B4)),i&&n.G4()},v.prototype.G4=function(){var r=this;function t(t,n){t.bind(T,function(t){r.U4(t,n)}).bind(o,function(t){r.H4(t,n)}).bind(I,function(t){r.z4(t,n)}).bind(x,function(t){r.V4(t,n)})}t(r._4,!0),t(r.B4,!1),r.O4.bind(T,function(t){r.Y4(t)}).bind(A,function(t){r.Z4(t)}).bind(o,function(t){r.W4(t)}).bind(I,function(t){r.K4(t)}).bind(x,function(t){r.J4(t)}),r.j4.bind(T,function(t){var n,e,i,n;y&&y.mozilla&&(e=(new Date).valueOf(),i=r.X4,r.X4=e,i)&&e-i<100||r.q4(t)}).bind(o,function(t){r.tS(t)}),r.nS=function(t){r.eS(t)},r.D4.bind(u,r.nS),r.D4.bind(c,r.nS),v.et(r,"initEvents",r.N4)},v.prototype.Jw=function(t){this.o4=t},v.prototype.dispose=function(){var t=this;function n(t){t&&t.unbind(r)}n(t.B4),n(t.O4),n(t._4),n(t.j4),t.D4&&(t.nS&&(t.D4.unbind(u,t.nS),t.D4.unbind(c,t.nS)),v.et(t,"dispose",t.N4),t.D4.unbind(r).remove())},v.prototype.Fg=function(){var n=this;n.p4||((0,j.GC$)(a).bind(A,function(t){n.Z4(t)}).bind(o,function(t){n.W4(t)}),n.p4=!0)},v.prototype.u2=function(){this.p4&&(this.p4=!1,j.GC$)(a).unbind(A).unbind(o)},v.prototype.U4=function(t,n){var e,i,r,o,e=0,i=this,r=!0;i.u4=!0,null===i.s4&&(n?(i._4.addClass(s),e=0-i.iS(),i.rS=O.Zi.smallDecrement):(i.B4.addClass(s),e=i.iS(),i.rS=1),(o=function(){i.scrollTo(i.b4+e*i.k4,!1),i.s4=M.setTimeout(o,r?i.f4:i.l4),r=!1})(),d(t))},v.prototype.H4=function(t,n){var e,i,e=this,i;(n?e._4:e.B4).removeClass(s),e.oS(),d(t)},v.prototype.z4=function(t,n){var e,i,e=this,i;(n?e._4:e.B4).addClass("gc-scroll-arrow-hover ui-state-hover"),d(t)},v.prototype.V4=function(t,n){var e,i,e=this,i;(n?e._4:e.B4).removeClass("gc-scroll-arrow-hover ui-state-hover "+s),e.oS(),d(t)},v.prototype.Y4=function(t){var n,e,i,r,o,a,u,n=this;0===t.button&&(n.a4=!0,n.Z3={x:t.pageX,y:t.pageY},n.qy(O.ScrollbarState.show),n.Fg(),n.D4.addClass(S),n.O4.addClass(s),e=n.O4.offset(),i=n.O4.outerWidth(!0),r=n.O4.outerHeight(!0),o=n.j4.offset(),a=n.j4.outerWidth(!0),u=n.j4.outerHeight(!0),n.aS={isBeyondEdge:!1,startEdgePosition:{x:o.left+t.pageX-e.left,y:o.top+t.pageY-e.top},endEdgePosition:{x:o.left+a-(i-t.pageX+e.left),y:o.top+u-(r-t.pageY+e.top)}}),d(t)},v.prototype.Z4=function(t){var n=this;n.a4&&(n.qy(O.ScrollbarState.active),n.uS={x:t.pageX,y:t.pageY},n.sS(),n.Z3=n.uS,(0,j.GC$)(a.body).attr("unselectable","on").addClass(lt)),d(t)},v.prototype.W4=function(t){var n,e,i,r,o,o,n=this;n.a4=!1,n.rS=O.Zi.thumbPosition,n.aS=null,n.D4.trigger(b,{newValue:n.y4,oldValue:n.y4,scrollOrientation:n.h4?l.horizontalScroll:l.verticalScroll,scrollEventType:n.rS}),i=((e=n.y4)-n.m4())*n.k4,r="left",o=(o=t.target.classList)&&o.contains(st),n.h4||(r="top"),o?n.qy(O.ScrollbarState.hide):n.qy(O.ScrollbarState.inactive),n.b4=i,n.O4.css(r,R(i)),n.u2(),(0,j.GC$)(a.body).removeClass(lt),(0,j.GC$)(a.body).attr("unselectable")&&(0,j.GC$)(a.body).removeAttr("unselectable"),n.O4.removeClass(s),n.D4.removeClass(S),n.rS=6,n.D4.trigger(b,{newValue:n.y4,oldValue:n.y4,scrollOrientation:n.h4?l.horizontalScroll:l.verticalScroll,scrollEventType:n.rS}),d(t)},v.prototype.K4=function(t){this.O4.addClass("gc-scrollbar-stateHover ui-state-hover"),d(t)},v.prototype.J4=function(t){this.O4.removeClass("gc-scrollbar-stateHover ui-state-hover"),d(t)},v.prototype.eS=function(t){var n,e,i,i,n=this;f(t.wheelDelta)&&f(t.detail)&&(t.wheelDelta=t.originalEvent.wheelDelta,t.detail=t.originalEvent.detail),i=(e=t.detail||t.wheelDelta/-40)/3*n.iS()*n.k4,n.rS=0<=i?1:0,n.scrollTo(n.b4+i,!1),n.rS=6,i={newValue:n.y4,oldValue:n.y4,scrollOrientation:n.h4?l.horizontalScroll:l.verticalScroll,scrollEventType:n.rS},n.D4.trigger(b,i),d(t)},v.prototype.q4=function(t){var e,i,r,o,a,u,s,c,e=this,i=!0,r=t.pageX,o=t.pageY,a=0,u=e.j4.offset(),s=e.cS();null===e.c4&&(a=e.h4?r-u.left-e.b4:o-u.top-e.b4,(c=function(){var t=0,n=e.b4,t;if((t=e.h4?r-u.left-n:o-u.top-n)*a<0||0<=t&&t<e.P4)e.fS();else{if(a<0)e.rS=O.Zi.largeDecrement,e.scrollTo(n-s*e.k4,!1);else{if(!(0<a))return void e.fS();e.rS=O.Zi.largeIncrement,e.scrollTo(n+s*e.k4,!1)}e.c4=M.setTimeout(c,i?e.f4:e.l4),i=!1}})(),d(t))},v.prototype.tS=function(t){this.fS(),d(t)},v.prototype.fS=function(){var t,n,t=this;t.c4&&clearTimeout(t.c4),t.c4=p,t.rS=O.Zi.endScroll,n={newValue:t.y4,oldValue:t.y4,scrollOrientation:t.h4?l.horizontalScroll:l.verticalScroll,scrollEventType:t.rS},t.D4.trigger(b,n)},v.prototype.oS=function(){var t,n,t=this;t.u4&&(t.u4=!1,t.s4&&clearTimeout(t.s4),t.s4=p,t.rS=6,n={newValue:t.y4,oldValue:t.y4,scrollOrientation:t.h4?l.horizontalScroll:l.verticalScroll,scrollEventType:t.rS},t.D4.trigger(b,n))},v.prototype.sS=function(){var e,t,n,i,r,o,n,a,u,i,s,u;function c(t){return e.h4?t.x:t.y}function f(t,n){e.h4?t.x=n:t.y=n}if(t=(e=this).b4,n=e.uS,i=e.aS,n=c(n),a=c(e.Z3),i&&i.isBeyondEdge){if(u=c(i.startEdgePosition),i=c(i.endEdgePosition),(r=n<u)||(o=i<n))return;a<u&&f(e.Z3,u),i<a&&f(e.Z3,i)}(u=t+(s=n-a))!==t&&(e.rS=5,e.scrollTo(u,!1))},v.prototype.scrollTo=function(t,n){var e,i,r,o,a,u,r,u,s,c,n,e=this,i=P,r=e.F4-e.P4;e.h4&&(i=F),u=a=o=!1,r<t&&(t=r,a=u=!0),t<0&&(o=u=!(t=0)),e.aS&&(e.aS.isBeyondEdge=u),r=e.g4===O.ScrollType.continuous?R(t/e.k4)+e.m4():t/e.k4+e.m4(),u=e.y4,s=!1,n||(n={newValue:r,oldValue:u,scrollOrientation:e.h4?l.horizontalScroll:l.verticalScroll,scrollEventType:e.rS,isBeyondMaxEdge:a,isBeyondMinEdge:o},e.D4.trigger(b,n),s=n.ignoreUpdatePosition,n.newValue>e.v4()&&(n.newValue=e.v4()),r=n.newValue,c=n.newValueWithOffset),f(c)&&(c=r),e.y4=r,5!==e.rS&&(t=(c-e.m4())*e.k4),e.b4=t,s||e.O4.css(i,R(t))},v.prototype.hitTest=function(t,n){var e,i,r,o,a,u,s,c,f,u,o,f,a,e=this,i=0,r=0,o=e.O4.outerWidth(),a=e._4.outerWidth(),u=e.j4.outerWidth(),s=e.O4.offset(),c=(0,j.GC$)(e.oy()).offset(),f=s.left-c.left-18;return e.h4?t<0+u+a&&0+a<t?t<f+o+a&&f<t?{element:O.Yi.ThumbButton,x:t,y:n}:{element:O.Yi.TrackButton}:t<=0+a&&0<t?{element:O.Yi.LeftButton,x:t,y:n}:{element:O.Yi.RightButton,x:t,y:n}:(u=e.O4.outerHeight(),o=e._4.outerHeight(),f=e.j4.outerHeight(),a=s.top-c.top-18,n<0+f+o&&0+o<n?n<a+u+o&&a<n?{element:O.Yi.ThumbButton,x:t,y:n}:{element:O.Yi.TrackButton}:n<=0+o&&0<n?{element:O.Yi.UpButton,x:t,y:n}:{element:O.Yi.DownButton,x:t,y:n})},v.prototype._b=function(){var t=this;return{x:0,y:0,width:t.YC(),height:t.ZC()}},v.prototype.show=function(){this.j4.show()},v.prototype.hide=function(){this.j4.hide()},v.prototype.lS=function(t){var n,n,n=this,n=n.D4.parent()&&n.D4.parent().parent();return n?t?n.height():n.width():p},k=v,t.YM=k,(0,e.$e)(k),(h=k.prototype).iS=i("smallChange",1),h.cS=i("largeChange",10),h.d4=i("pageValue",10,function(t){t<=0&&this.d4(1)}),h.v4=i("maximum",100,function(t){t<=0&&this.v4(0)}),h.m4=i("minimum",0,function(t){t<=0&&this.m4(0)}),h.YC=i("width",0),h.ZC=i("height",0),m.prototype.w4=function(t){var a,n,e,i,r,o,u,s,c,t,r,o,f,l;function h(t){return t===W?j.GC$.En("div",[G,F,P,U,H,z],[W,0,0,"none",0,0]):t===Q?j.GC$.En("div",[G,F,P,U,H,z],[Q,0,0,"none",0,0]):p}function d(t,n){var e,e,i,n,e=n?a.hS:a.dS;return e||(e=new k(n),i=j.GC$.En("div"),n?(a.vS=i,a.hS=e,i.css([G,F,vt,U,H,z],[W,0,0,"none",0,0])):(a.mS=i,a.dS=e,i.css([G,dt,P,U,H,z],[W,0,0,"none",0,0])),n=(n?a.hS:a.dS).oy(),i.append(n),t.append(i),e)}function v(t,n,e,i,r,o){o?(a.vS.css([B,L],[n,i]),t.YC(n),t.ZC(i)):(a.mS.css([B,L],[i,n]),t.YC(i),t.ZC(n)),t.m4(0),t.v4(r-n),t.d4(n),t.iS(o?a.gS():a.pS()),t.cS(n),t.w4(),(0,j.GC$)(t.oy()).bind(b,function(t,n){e.css(o?F:P,0-n.newValue)}),(o?a.vS:a.mS).show()}function m(t){a.bS||(a.bS=h(Q),a.bS.css([gt,V,B],["hidden",J,Y]),t.append(a.bS))}function g(t){a.yS||(a.yS=j.GC$.En("div",G,Q,p,t))}(a=this).A4&&a.I4&&(n=a.T4,e=a.I4.width(),i=a.I4.height(),u=(r=a.A4.width())-n,s=(o=a.A4.height())-n,c=!1,a.wS||(a.wS=h(Q),a.wS.css([G,gt],[Q,"hidden"]),c=!0),a.wS.css(L,o),m(a.wS),g(a.bS),t&&a.yS.append(a.I4).css([P,F],[0,0]),y.chrome&&(e=R(e),i=R(i),r=C(r),o=C(o)),r=(t=a.CS(e,i,r,o)).MS,(o=t.SS)?(r||(u+=n),v(f=d(a.wS,!0),u,a.yS,n,e,!0)):a.vS&&a.vS.hide(),r?(o||(s+=n),v(l=d(a.wS,!1),s,a.yS,n,i,!1)):a.mS&&a.mS.hide(),o||r||(u+=n,s+=n),a.C4=o,a.S4=r,a.TS=u,a.AS=s,a.bS.css(L,s),c)&&(a.A4.append(a.wS),a.IS())},m.prototype.xS=function(t){var n,t,e,t,n=this,t=n.NS(t),e=t.I0,t=t.A0;!f(e)&&n.hS&&n.wy(e),!f(t)&&n.dS&&n.yy(t)},m.prototype.wy=function(t){var n,e,i,n=this;n.hS.value(t),e=n.TS,i=n.I4.width(),0<=t&&t<=i-e&&n.yS.css(F,0-t)},m.prototype.yy=function(t){var n,e,i,n=this;n.dS.value(t),e=n.AS,i=n.I4.height(),0<=t&&t<=i-e&&n.yS.css(P,0-t)},m.prototype.CS=function(t,n,e,i){var r,o=e,a=i-this.T4,u={SS:!1,MS:!1};return e<t&&(u.SS=!0,u.MS=a<n),i<n&&(u.MS=!0,u.SS=o<t),u},m.prototype.NS=function(t){var n=(0,j.GC$)(t),e=this.bS,i=this.yS,t,i,r,n,o,n,o,a={I0:p,A0:p};return t&&(t=n.offset(),i=i.offset(),r=e.offset(),t.leftWidth=t.left+n.outerWidth(),t.topHeight=t.top+n.outerHeight(),r.leftWidth=r.left+e.outerWidth(),r.topHeight=r.top+e.outerHeight(),n=t.left-i.left,t.left<r.left?a.I0=n:t.leftWidth>r.leftWidth&&(o=t.leftWidth-i.left-e.innerWidth(),a.I0=n<o?n:o),n=t.top-i.top,t.top<r.top?a.A0=n:t.topHeight>r.topHeight&&(o=t.topHeight-i.top-e.innerHeight(),a.A0=n<o?n:o)),a},m.prototype.IS=function(){var n=this;this.yS&&(n.nS=function(t){n.kS(t)},n.yS.bind(u,n.nS),n.yS.bind(c,n.nS))},m.prototype.kS=function(t){var n,e,i,r,o,a,u,i,n=this;f(t.wheelDelta)&&f(t.detail)&&(t.wheelDelta=t.originalEvent.wheelDelta,t.detail=t.originalEvent.detail),i=e=t.detail||t.wheelDelta/-40,r=n.dS,o=parseInt(n.yS.css(P),10),a=n.AS,(u=n.I4.height())<a&&(u=a),(i=(i=0<=(i=(o=isNaN(o)?0:o)-i*n.pS())?0:i)<0&&u-a<0-i?0-(u-a):i)!==o&&(n.yS.css(P,i),n.S4)&&r.value(0-i),w(t)},m.prototype.dispose=function(){var t=this;t.wS&&(t.hS&&t.hS.dispose(),t.dS&&t.dS.dispose(),t.yS&&t.nS&&(t.yS.unbind(u,t.nS),t.yS.unbind(c,t.nS)),(0,j.GC$)(t.wS).remove())},(e=(t.x4=D=m).prototype).gS=i("horizontalSmallChange",10),e.pS=i("verticalSmallChange",10),n.Hv.ch(N,{preProcessMouseMove:function(t){var n=this.Vv,e;(n.Xb.a4||n.zb.a4)&&(t.r=!0)}})},"./dist/core/worksheet/clipboardhelper.js":function(t,n,e){"use strict";var B,i,f,l,I,L,h,F,d,P,G,r,x,o;function a(t){return t&&t.options.allowCopyPasteExcelStyle}function v(t,n){var e,i;if(F.msie){for(e=[],i=0;i<t.length;i++)n&&""===t[i].trim()||e.push(t[i]);return e.join("")}return t.join("")}function u(t){for(var n,e,i,n="picture",e=1,i=n+e.toString();t.get(i);)i=n+(++e).toString();return i}function N(t,n,e,i){for(var r,o,a,r=[],o=0,a=e;o<a;o++)r[n+o]=t.getRowHeight(n+o,i);return r}function k(t,n,e,i){for(var r,o,a,r=[],o=0,a=e;o<a;o++)r[n+o]=t.getColumnWidth(n+o,i);return r}function b(t,n,e){var i,r;if(n=n||"\x3c!--",e=e||"--\x3e",t)for(;;){if((i=t.indexOf(n))<0)break;if((r=t.indexOf(e))<0)break;t=t.substring(0,i)+t.substring(r+e.length)}return t}function c(t,n,e){var i,r,i=-1;if(e)for(r=i=0;r<n;r++)i+=e[t+r]||0;return i}function m(t,n,e){var i,r,i=-1;if(e)for(r=i=0;r<n;r++)i+=e[t+r]||0;return i}function s(t){this.Nf=[],this.Zc=t}function g(t){this.Nf={},this.Doe=t,this.joe=t.map(function(t){return new r(t)}),this.Lre=1}function U(t){var n=this;n.DS=G,n._S=G,n.ES=!1,n.jS=t,n.En()}Object.defineProperty(n,"__esModule",{value:!0}),n.yM=n.Ooe=n.Boe=void 0,B=e("./dist/core/util/common.js"),i=e("Common"),f=e("./dist/core/worksheet/stylehelper.js"),l=e("./dist/core/worksheet/style.js"),I=e("./dist/core/core.enum.js"),L=i.Common.zf,h=/<img[^>]+>/g,F=B.mt.Tt,d=i.Common.lt.ht,P=i.Common.Uf.OS,G=null,s.prototype.add=function(t){var n=this.Nf,e=n.indexOf(t);return-1===e&&(n.push(t),e=n.length-1),e},s.prototype.toString=function(t){var t=this.Nf[t];return d(t)?"":this.Zc+":"+t},r=s,n.Boe=r,g.prototype.Loe=function(e){var i=this.joe;return this.Doe.map(function(t,n){return i[n].add(e[t])}).join("_")},g.prototype.add=function(t){var n=this.Nf,t=this.Loe(t);return n[t]||(n[t]="sjs"+this.Lre,this.Lre++),n[t]},g.prototype.toString=function(){var t,n,e,i,r,o,a,u,s,t=this.joe,n=[],e=this.Nf;for(i in e)if(e.hasOwnProperty(i)){for(r=i.split("_"),o=[],a=0;a<this.Doe.length;a++)(u=t[a].toString(+r[a]))&&o.push(u);s="."+e[i]+"{\r\n"+o.join(";\r\n")+"\r\n}\r\n",n.push(s)}return n.join("")},x=g,n.Ooe=x,U.prototype.En=function(){var c,t,n,e,i,c=this,t=document.createElement("div");t.style.position="fixed",t.style.top="0px",t.style.left="0px",t.style.width="0px",t.style.height="0px",t.style.overflow="hidden",(n=document.createElement("div")).setAttribute("contenteditable","true"),n.setAttribute("gcUIElement","gcSheetClipboard"),n.setAttribute("tabindex","-1"),n.style.position="absolute",n.style.overflow="hidden",n.style.background="white",n.style.webkitUserSelect="text",t.appendChild(n),c.RS=n,(e=document.createElement("textarea")).setAttribute("gcUIElement","gcSheetClipboard"),c.jS&&c.jS.options.enableAccessibility&&(e.setAttribute("aria-hidden","true"),e.setAttribute("role","none"),e.setAttribute("title","")),e.setAttribute("tabindex","-1"),e.style.position="absolute",e.style.overflow="hidden",e.style.background="white",e.style.webkitUserSelect="text",t.appendChild(e),c.BS=e,(i=c.jS.getHost())&&i.appendChild(t),F.msie||F.edge||(c.FS=function(t){var e,n,i,r,o,a,u,s,r,e=(0,B.jf)(c.jS),n=t.clipboardData;if(n)if(i=(i=n.getData("text/html")).replace(h,""),(r=c.PS()).innerHTML=i,o=i?c.GS(r,!0):U.formatClipboardData(n.getData("text/plain")),r.innerHTML="",o||i&&0<=i.indexOf("<table"))e.US(o,i);else{for(a=void 0,u=n.items,s=0;s<u.length&&(0!==u[s].type.indexOf("image")||!(a=u[s].getAsFile()));s++);a&&((r=new FileReader).onload=function(t){var n=new Image;n.src=t.target.result,n.onload=function(){e.US(o,i,n.src)}},r.readAsDataURL(a))}t.preventDefault()},n.addEventListener("paste",c.FS),c.HS=function(t){var n,e,i,e,r,n=(0,B.jf)(c.jS),e=t.clipboardData;e&&((i=U.formatClipboardData(e.getData("text/plain")))||(e=e.getData("text/html"))&&((r=c.PS()).innerHTML=e,i=c.GS(r,!1),r.innerHTML=""),n.US(i,"")),t.preventDefault()},e.addEventListener("paste",c.HS))},U.prototype.L0=function(){var t,n,n,e,e,n,n,e,t=this,n=t.RS;n&&(F.msie||F.edge||(n.removeEventListener("paste",t.FS),t.BS.removeEventListener("paste",t.HS)),(n=n.parentElement)&&(e=n.parentElement)&&e.removeChild(n),t.RS=G,t.BS=G),(e=t.zS)&&((n=e.parentElement)&&n.removeChild(e),t.zS=G),(n=t.VS)&&((e=n.parentElement)&&e.removeChild(n),t.VS=G),t.jS=G},U.prototype.YS=function(t){a(this.jS)?this.RS.innerHTML=t:this.BS.value=t},U.prototype.ZS=function(){(a(this.jS)?this.RS:this.BS).focus()},U.prototype.WS=function(){a(this.jS)?document.execCommand("selectAll"):this.BS.select()},U.prototype.QS=function(){var t,n,e,i,r,r,t="",n="",e="";return n=a(this.jS)?((i=this.RS)&&(0<(r=i.getElementsByTagName("table")).length?t=r[0].outerHTML:0<(r=i.getElementsByTagName("img")).length&&(e=r[0].src)),this.GS(this.RS,!0)):U.formatClipboardData(this.BS.value),{html:t,text:n,image:e}},U.KS=function(t,n,e,i,r,o,a,u,s,c,f,l,h,d){var v,m,g,p,b,n,f,y,w,M,C,C,S,T,A,n,b,b;return d||!F.chrome&&!F.edge||(U.Foe=new x(["background-color","color","font","white-space","vertical-align","text-align","border-left","border-right","border-top","border-bottom"])),v=t.JS((0,B.Ec)(e,r,i,o),a),m=new RegExp(String.fromCharCode(32),"g"),b=p=!(g="&nbsp;"),a===I.SheetArea.viewport&&(e<0&&2==(2&n)&&(p=!0),r<0)&&1==(1&n)&&(b=!0),e=v.row,r=v.col,i=v.rowCount,o=v.colCount,n=f?t.options.gridline:G,f=f?{color:"#d4d4d4",showHorizontalGridline:!0,showVerticalGridline:!0}:G,y=h?N(t,e,i,a):G,w=h?k(t,r,o,a):G,M=!d&&4e3<i*o&&(F.safari||F.mozilla||B.mt.Qf()&&F.chrome),a===I.SheetArea.viewport?(S=C=void 0,A=T=G,n=U.XS(t,e,i,r,o,3,s,c,u,v,m,g,n,l,y,w,d),b&&(C=h?k(t,r,o,2):G,b=t.getColumnCount(2),T=U.XS(t,e,i,0,b,2,s,[],u,v,m,g,f,l,y,C,d)),p&&(S=h?N(t,e,i,1):G,b=t.getRowCount(1),A=U.XS(t,0,b,r,o,1,[],c,u,v,m,g,f,l,S,w,d)),C=U.qS(n,T,A,d,M)):a===I.SheetArea.rowHeader?(T=U.XS(t,e,i,r,o,2,s,c,u,v,m,g,f,l,y,w,d),C=U.qS(T,G,G,d,M)):a===I.SheetArea.colHeader&&(A=U.XS(t,e,i,r,o,1,s,c,u,v,m,g,f,l,y,w,d),C=U.qS(A,G,G,d,M)),U.Foe&&(U.Foe=G),C},U.qS=function(t,n,e,i,r){var o,a,u,n,s,o=t,a=0,u=function(t,n){for(var e,i,r,e=[],i=t.length,r=0;r<i;r++)e.push(t[r].concat(n[r]));return e};return n&&(a=n[0].length,o=u(n,t)),e&&(n=e.length,o=(e=a?u(s=U.XS(G,0,n,0,a,G,[],[],!1,G,G,G,G,!1,[],[],i),e):e).concat(o)),r&&U.$S(o),U.t5(o,i)},U.$S=function(t){for(var n,e,n=t.length,e=t.length-1;0<=e&&-1===t[e].join("").search(/>\S+</);e--)n=e;t.length=n},U.t5=function(t,n){var e,i,r,o,e="",i=t.length;for(e+=n?'<table style="border-collapse: collapse">':'<table gc-sjs-clipboard="true" style="min-width:1px;min-height:1px;">',r=0;r<i;r++){for(e+="<tr>",o=0;o<t[r].length;o++)e+=t[r][o];e+="</tr>"}return e+="</table>",e=U.Foe?(e+="\r\n<style>\r\n")+U.Foe.toString()+"</style>":e},U.n5=function(t){return t&&0<=t.indexOf('gc-sjs-clipboard="true"')},U.vI=function(t,n,e,i,r,o,a){var u,s,c,i,r,f,l,l,l,o,l,u,o,s,a,n,l,u,l,u,l,u=U.convertVAlign,s=U.convertHAlign,c=U.convertLineBorder,i=i,r=r,f={},l=t.backColor;return l&&(f["background-color"]=l,r=i=!1),(l=t.foreColor)&&(f.color=l),(l=t.font)&&(o&&(l=l+", "+B.FallbackFontFamily),f.font=l.replace(/"/g,"'").replace(/([\.\d]+px)/,function(t){return(3*parseFloat(t.substring(0,t.length-2))/4).toFixed(2)+"pt"})),f["white-space"]=t.wordWrap?a?"pre":"normal":"nowrap",o=t.vAlign,d(o)||(f["vertical-align"]=u(o)),l=t.hAlign,d(l)||(u=s(l=a?B.mt.gt(l,n):l))&&(f["text-align"]=u),o="border-left",s="border-right",a="border-top",n="border-bottom",(l=t.borderLeft)&&(f[o]=c(l),r=!1),(u=t.borderRight)&&(f[s]=c(u),r=!1),(l=t.borderTop)&&(f[a]=c(l),i=!1),(u=t.borderBottom)&&(f[n]=c(u),i=!1),l="1px solid "+e,i&&(f[a]=l,f[n]=l),r&&(f[o]=l,f[s]=l),f},U.XS=function(t,n,e,i,r,o,a,u,s,c,f,l,h,d,v,m,g){var p,b,y,w,M,C,S,T,A,I,x,N,k,D,_,_,E,j,O,R,x,k,D,x,N;for(h&&(p=h.color,b=h.showHorizontalGridline,y=h.showVerticalGridline),w=[],M=0;M<e;M++)if(!(P(a,C=n+M)||g&&v&&v[C]<=0)){for(S=[],T=0;T<r;T++)if(!(P(u,A=i+T)||g&&m&&m[A]<=0)){if(I="",N=x=void 0,D=k=1,s&&t&&(x=(x=t.getSpan(C,A,o))&&U.isPartSpan(x,c,a,u)?G:x)){if(x.row!==C||x.col!==A)continue;N=t.getActualStyle(C,A,o),_=t.getActualStyle(x.row+x.rowCount-1,x.col+x.colCount-1,o),!N.borderRight&&_.borderRight&&(N.borderRight=_.borderRight),!N.borderBottom&&_.borderBottom&&(N.borderBottom=_.borderBottom)}if(I+="<td",_=t&&t.getValue(C,A,o),s&&t){if(x&&(1<(k=x.rowCount)&&(I+=" rowSpan="+k),1<(D=x.colCount))&&(I+=" colSpan="+D),N=N||t.getActualStyle(C,A,o),E=g?"padding: 0; ":"",j=U.vI(N,_,p,b,y,d,g),U.Foe)I+=' class="'+(O=U.Foe.add(j))+'"';else for(R in j)j.hasOwnProperty(R)&&(E+=R+": "+j[R]+"; ");x=j.font?B.mt.vt(j.font):0,(E+=U.e5(C,A,k,D,v,m,x))&&(I+=' style="'+E+'"')}I+=">",D=k=void 0,s&&t&&((k=2==(2&(x=N.textDecoration)))&&(I+="<s>"),D=(D=1==(1&x))||8==(8&x))&&(I+="<u>"),(N=t?t.getText(C,A,o):"")?(" "!==N[0]&&" "!==N[N.length-1]||"number"!=typeof _||(N=N.trim()),"number"!=typeof _&&(N=L.j0(N).replace(f,l))):F.chrome?N=" ":F.safari&&(N="&nbsp;"),I+=N,s&&(D&&(I+="</u>"),k)&&(I+="</s>"),S.push(I+="</td>")}w.push(S)}return w},U.e5=function(t,n,e,i,r,o,a){var u,t,e,s,u="",t=c(t,e,r);return 0<t&&(t-=1),0<(e=m(n,i,o))&&(e-=1),u=0<=t&&0<=e?"overflow: hidden;height: "+t+"px;line-height: "+(s=Math.min(a,t))+"px; width: "+e+"px;max-width: "+e+"px;min-width: "+e+"px;":u},U.prototype.PS=function(){var t,n,e,t=this;return t.zS||((n=document.createElement("div")).style.display="none",(e=t.jS.getHost())&&e.appendChild(n),t.zS=n),t.zS},U.prototype.i5=function(){var t,n,e,t=this;return t.VS||((n=document.createElement("div")).style.display="none",(e=t.jS.getHost())&&e.appendChild(n),t.VS=n),t.VS},U.prototype.r5=function(t,n,e,i){var r,t,o,a,u,s,c,f,l,h,d,h,v,r=this.PS();if(r.innerHTML=t,t=r.getElementsByTagName("table"),o=n.o5(),0<t.length)for(a=this.a5(t[0],!0),s=e+(u=0);u<a.length;u++,s++){if(c=a[u],o)for(;0===n.getRowHeight(s);)s++;for(l=i+(f=0);f<c.length;f++,l++)if(h=c[f]){if(o)for(;0===n.getColumnWidth(l);)l++;n.u5(s,l,h.style),d=h.rowSpan,h=h.colSpan,(1<d||1<h)&&((v=n.getSpan(s,l))?(v.row=s,v.col=l,v.rowCount=d,v.colCount=h):n.addSpan(s,l,d,h))}}r.innerHTML=""},U.prototype.s5=function(t,n,e,i){var r,r,n,r;n.shapes?((r=n.shapes.addPictureShape("",t,0,0)).startRow(e),r.startColumn(i)):n.pictures&&(n=u(r=n.pictures),(r=r.add(n,t,0,0)).startRow(e),r.startColumn(i))},U.prototype.a5=function(t,n){for(var e,i,r,o,a,u,s,c,f,l,h,d,v,d,m,g,p,e=this.i5(),i=[],r=/ +/g,o=0;o<t.rows.length;o++)for(a=t.rows[o],i[o]||(i[o]=[]),u=i[o],c=s=0;s<a.cells.length;s++){for(f=a.cells[s];u[c];)c++;for(l=u[c]={},h=void 0,n&&(h=U.getStyleFromDOM(f),l.style=h),d=b(d=f.innerHTML,"\x3c!--[if","[endif]--\x3e"),e.innerHTML=d.replace(r," "),v=e.innerText,0<=d.indexOf("<table")&&(v=v.trim()),l.text=v,l.rowSpan=f.rowSpan,(d=f.getAttribute("style"))&&0<=d.search(/mso-ignore:\s*colspan/)?l.colSpan=1:l.colSpan=f.colSpan,m=0;m<f.rowSpan;m++)for(g=0;g<f.colSpan;g++)0===m&&0===g||(i[o+m]||(i[o+m]=[]),(p=i[o+m])[c+g]={style:h,text:"",rowSpan:1,colSpan:1});c+=f.colSpan}return e.innerHTML="",i},U.prototype.GS=function(t,n){var e,i,r,o,a,u,s,c,f,l,h,e=[];if(t)if(0<(i=t.getElementsByTagName("table")).length)for(r=this.a5(i[0],!1),o=new RegExp(String.fromCharCode(160),"g"),a=String.fromCharCode(32),u=0,s=r.length;u<s;u++){for(f=0,l=(c=r[u]).length;f<l;f++)0<=(h=c[f]?c[f].text:"").indexOf("\n")&&(h=n?(0<=h.indexOf("\r\n")&&(h=v(h.split("\r\n"),!0)),v(h.split("\n"),!0)):'"'+h+'"'),e.push(h.replace(o,a)),f<l-1&&e.push("\t");u<s-1&&e.push("\r\n")}else e.push(b(t.innerText).trim());return e.join("")},U.prototype.c5=function(t){var n,e,n=this,e=n.QS();n.DS&&n.DS.ki(B.Events.ClipboardChanging,{sheet:n.DS,sheetName:n.DS.name(),copyData:{text:e.text,html:e.html},ranges:n._S,cancel:!1,action:I.ClipboardActionType.reset},!0),n.DS=G,n._S=G,n.ES=!1,n.TT=!1,n.jS.ki("ClipboardStatusChanged",{isReset:!0,isSystemPasted:!!t})},U.isPartSpan=function(t,n,e,i){var r,o,a,u,s,c;if(!n.containsRange(t))return!0;for(r=0,o=e;r<o.length;r++)if(a=o[r],t.row<=a&&a<t.row+t.rowCount)return!0;for(u=0,s=i;u<s.length;u++)if(c=s[u],t.col<=c&&c<t.col+t.colCount)return!0;return!1},U.formatClipboardData=function(t){var n,e,i,r,o,a,n=[];if(t){for(i=!(e='"'),r=0;r<t.length;r++)o=0<r?t[r-1]:"",'"'===(a=t[r])?(i=!i,n.push('"')):n.push(i||"\n"!==a||"\r"===o?a:"\r\n");return n.join("")}return""},U.convertHAlign=function(t){var n;return{0:"left",1:"center",2:"right"}[t]},U.convertVAlign=function(t){var n;return{0:"top",1:"middle",2:"bottom"}[t]},U.convertLineBorder=function(t){var n,e,n,e;return{9:.5,1:.5,3:.5,4:.5,7:.5,11:.5,2:1,10:1,12:1,8:1,13:1,5:1.5,6:1.5}[t.style]+"pt "+{0:"none",1:"solid",2:"solid",3:"dashed",4:"dotted",5:"solid",6:"double",7:"dotted",8:"dashed",9:"dashed",10:"dashed",11:"dashed",12:"dashed",13:"dashed"}[t.style]+" "+t.color},U.convertToHAlign=function(t){var n;return{left:0,center:1,right:2}[t]},U.convertToVAlign=function(t){var n;return{top:0,middle:1,bottom:2}[t]},U.convertToLineBorder=function(t,n,e){var i={none:0,solid:1,dashed:3,dotted:4,double:6};return(F.msie||F.edge)&&"2px"===e?i.solid=5:(e=Math.round(10*parseFloat(e)*3/4)/10)<=.8?i.solid=1:e<=1?(i.solid=2,i.dashed=8):e<=1.5&&(i.solid=5),new l.LineBorder(t,i[n])},U.convertToTextDecoration=function(t){var n;return{underline:1,"line-through":2,"underline line-through":3,none:0}[t]},U.isTransparent=function(t){return 0===i.Common.ft._(t).a},U.isBlack=function(t){var t=i.Common.ft._(t);return 0!==t.a&&0===t.r&&0===t.g&&0===t.b},U.getStyleFromDOM=function(t){var n,e,i,r,o,o,o,a,n,u,o,s,c,n,i,n,o,i,n,o,n=t.getElementsByTagName("font")[0],e=getComputedStyle(t),i=t.style,r=new l.Style,o=e.backgroundColor;return o&&!U.isTransparent(o)&&(r.backColor=o),o=e.color,(o=n?n.color:o)&&!U.isBlack(o)&&(r.foreColor=o),n?r.font=f.W.f5(getComputedStyle(n)):(o=f.W.f5(e))&&(o=o.replace(/\/.+?\s/gi," "),r.font=o),"normal"===(a=e.whiteSpace)&&(r.wordWrap=!0),n=e.verticalAlign,o=U.convertToHAlign,s=U.convertToLineBorder,c=U.convertToTextDecoration,n&&(r.vAlign=(u=U.convertToVAlign)(n)),n=i.textAlign,i=e.textAlign,F.msie||F.edge?r.hAlign=o(""!==n?n:"general"):i&&(r.hAlign=o(i)),"none"!==(n=e.borderLeftStyle)&&(r.borderLeft=s(e.borderLeftColor,n,e.borderLeftWidth)),"none"!==(o=e.borderRightStyle)&&(r.borderRight=s(e.borderRightColor,o,e.borderRightWidth)),"none"!==(i=e.borderTopStyle)&&(r.borderTop=s(e.borderTopColor,i,e.borderTopWidth)),"none"!==(n=e.borderBottomStyle)&&(r.borderBottom=s(e.borderBottomColor,n,e.borderBottomWidth)),o=c(e.textDecorationLine||e.textDecoration),0<t.getElementsByTagName("u").length&&(o|=c("underline")),0<t.getElementsByTagName("s").length&&(o|=c("line-through")),0!==o&&(r.textDecoration=o),r},n.yM=U},"./dist/core/worksheet/style.js":function(B,t,n){"use strict";var a,o,u,s,g,c,r,i,n,f,p,l,b,h,d,n,v,m,y,w,M,C,S,e,T,A,L,F,P,G,U,H,I,x,N,k,k,k;function z(t){var n,e,n={};return t&&t.option&&t.option.dataSource?(e=t.option.dataSource,t.option.dataSource=b,(n=p(t)).option.dataSource=e,t.option.dataSource=e):n=p(t),n}function D(t,n,e){this.color=t||"black",this.style=n||0,this.level=e}function V(t){return!(!t||"object"!=typeof t||t.patternColor||t.stops)}function Y(t){return(!t||!t.stops)&&t&&t.type?{type:O(r.PatternType,t.type,b),patternColor:t.patternColor,backgroundColor:t.backgroundColor}:t}function _(t){return t?new I(t.color,O(U,t.style,b)):b}function Z(t){var n,e,e,e;if(t){if(!(e=(n={checkbox:"5",combobox:"7",hyperlink:"8",radioButtonList:"11",checkboxList:"12"})[t.type]))return it(t,!0,void 0);if(e=c.ti[e])return(e=new e).Je(t),e}return t}function W(t){return t?{alignment:O(r.LabelAlignment,t.alignment,b),visibility:O(r.LabelVisibility,t.visibility,b),font:t.font,foreColor:t.foreColor,margin:t.margin}:b}function Q(t){return t?{cornerFold:t.cornerFold,icons:t.icons&&0<t.icons.length?t.icons.map(function(t){return{src:t.src,width:t.width,height:t.height,position:O(r.IconPosition,t.position,b)}}):b}:b}function J(t){return t?t.map(function(t){return{position:O(r.ButtonPosition,t.position,b),useButtonStyle:t.useButtonStyle,enabled:t.enabled,width:t.width,caption:t.caption,imageSrc:t.imageSrc,imageSize:t.imageSize,captionAlign:O(r.CaptionAlignment,t.captionAlign,b),command:t.command,imageType:O(r.ButtonImageType,t.imageType,b),visibility:O(r.ButtonVisibility,t.visibility,b),hoverBackColor:t.hoverBackColor,buttonBackColor:t.buttonBackColor}}):b}function K(t){var n,e,e,e,i,i,e,i;if(t)return n=u.GC$.extend(!0,{},t),e=t.calendarPage,l(e)||(n.calendarPage=O(r.CalendarPage,e)),e=t.startDay,l(e)||(n.startDay=r.CalendarStartDay[e]),(e=t.layout)&&(i=e.direction,l(i)||(n.layout.direction=r.LayoutDirection[i]),i=e.displayAs,l(i)||(n.layout.displayAs=r.LayoutDisplayAs[i])),e=t.valueType,l(e)||(n.valueType=r.DropdownListValue[e]),i=t.direction,l(i)||(n.direction=r.LayoutDirection[i]),n}function X(t){return t?t.map(function(t){return{type:O(r.DropDownType,t.type,b),option:K(t.option),submitCommand:t.submitCommand}}):b}function q(t){var t,t="lineThroughUnderline"===t?r.TextDecorationType.lineThrough|r.TextDecorationType.underline:"lineThroughDoubleUnderline"===t?r.TextDecorationType.lineThrough|r.TextDecorationType.doubleUnderline:O(r.TextDecorationType,t,r.TextDecorationType.none);return t}function $(t){var n,e,i,r,n=p(t.decoration);if(!l(n)&&!l(n.icons))for(n.icons=[],e=t.decoration.icons,i=0;i<e.length;i++)r=e[i],n.icons.push(p(r));return n}function tt(t,n){var e,i,r,o;for(l(t.decoration)&&(t.decoration={}),l(t.decoration.icons)&&(t.decoration.icons=[]),e=t.decoration.icons,i=n.decoration.icons,r=0;r<i.length;r++)o=i[r],e.push(p(o))}function E(e){var i;return e&&e instanceof Object?(i={},Object.keys(e).forEach(function(t){var n=e[t];l(n)||(n instanceof Array?i[t]=JSON.parse(JSON.stringify(n)):n instanceof Object?i[t]=E(n):i[t]=n)}),i):e}function j(){for(var t,n,e,i,r,t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];if((e=this)._id=j.l5,j.l5++,0!==t.length)if(i=t[0],1===t.length&&V(i))e.Je(i);else for(r=0;r<x.length;r++)e[x[r]]=t[r]}function nt(t,n){l(t.applyFill)||(n.applyFill=t.applyFill),l(t.applyFont)||(n.applyFont=t.applyFont),l(t.applyAlignment)||(n.applyAlignment=t.applyAlignment),l(t.applyBorder)||(n.applyBorder=t.applyBorder),l(t.applyProtection)||(n.applyProtection=t.applyProtection),l(t.applyNumberFormat)||(n.applyNumberFormat=t.applyNumberFormat)}function O(t,n,e){var i;if(e=e||b,!l(n)){if(!isNaN(n))return parseInt(n,10);i=t[n]}return l(i)?e:i}function et(t,n,e,i){var n=it(n,e,i);t.cellType=n}function it(t,n,e){var i,r,n,o,n,i=t;if(n&&t){if(r=t.Ke&&t.Ke())return i;t.toJSON&&(t=t.toJSON()),n=c.ti,o=t.typeName,(n=n[t.type]||n[o]||s.getTypeFromString(o))?(i=new n).fromJSON(t,e):i=b}return i}function rt(t,n,e,i){var r,o;if(n===h&&(t.cellButtons=n),n){if(r=n,e)for(r=[],o=0;o<n.length;o++)r.push(p(n[o]));t.cellButtons=r}}function ot(t,n,e,i){var r;n===h&&(t.decoration=n),n&&(r=n,e&&(r=p(n),n.icons)&&0<n.icons.length&&(r.icons=n.icons.map(function(t){return p(t)})),t.decoration=r)}function at(t,n,e,i){var r,o;if(n===h&&(t.dropDowns=n),n){if(r=a([],n,!0),e)for(r=[],o=0;o<n.length;o++)r.push(p(n[o]));t.dropDowns=r}}function ut(t,n,e){var i,e,e,r,r,i=n;e&&n&&"object"==typeof n&&(n.toJSON&&(n=n.toJSON()),e=(e=o.Formatter)&&e.GeneralFormatter)&&((r=n.typeName)?(r=s.getTypeFromString(r))&&(i=new r).fromJSON(n):i=new e(n.formatCached,n.customerCultureName)),t.formatter=i}function st(t,n,e){var i,e,e,i=n;e&&n&&(n.toJSON&&(n=n.toJSON()),e=(e=o.Formatter)&&e.GeneralFormatter)&&((i=new e(n.formatCached,n.customerCultureName)).isAuto=!0),t._autoFormatter=i}function R(t,n,e){(n=n&&t.getColor(n))&&e(n)}function ct(t,n,e){return t===m?2===e||1===e?1===n:3===n:t===y?2===e||1===e?1===n:0===n:t===w?1===n:t===d&&n===b}a=this&&this.__spreadArray||function(t,n,e){if(e||2===arguments.length)for(var i=0,r=n.length,o;i<r;i++)!o&&i in n||((o=o||Array.prototype.slice.call(n,0,i))[i]=n[i]);return t.concat(o||Array.prototype.slice.call(n))},Object.defineProperty(t,"__esModule",{value:!0}),t.Style=t.LineBorder=t.LineBorderComposeLevel=t.LineStyle=void 0,o=n("Common"),u=n("./dist/core/util/domUtil.js"),s=n("./dist/core/util/common.js"),g=n("./dist/core/worksheet/stylehelper.js"),c=n("./dist/core/celltype/celltype.ns.js"),r=n("./dist/core/core.enum.js"),i=u.GC$.each,n=s.mt,f=n.T1,p=o.Common.lt.tv,l=o.Common.lt.ht,d="autoFormatter",n="formatter",v="cellType",m="hAlign",y="vAlign",w="imeMode",M="labelOptions",C="cellButtons",S="dropDowns",e="applyFont",T="applyFill",A="applyAlignment",L="applyBorder",F="applyNumberFormat",P="applyProtection",G={borderLeft:!(h=null),borderRight:!(b=void 0),borderTop:!0,borderBottom:!0,diagonalDown:!0,diagonalUp:!0},(k=U=t.LineStyle||(t.LineStyle={}))[k.empty=0]="empty",k[k.thin=1]="thin",k[k.medium=2]="medium",k[k.dashed=3]="dashed",k[k.dotted=4]="dotted",k[k.thick=5]="thick",k[k.double=6]="double",k[k.hair=7]="hair",k[k.mediumDashed=8]="mediumDashed",k[k.dashDot=9]="dashDot",k[k.mediumDashDot=10]="mediumDashDot",k[k.dashDotDot=11]="dashDotDot",k[k.mediumDashDotDot=12]="mediumDashDotDot",k[k.slantedDashDot=13]="slantedDashDot",(k=H=t.LineBorderComposeLevel||(t.LineBorderComposeLevel={}))[k.conditionalFormat=1]="conditionalFormat",k[k.cell=10]="cell",k[k.table=20]="table",k[k.row=30]="row",k[k.column=40]="column",k[k.sheet=50]="sheet",D.prototype.Gf=function(){return new D(this.color,this.style,this.level)},D.prototype.toJSON=function(){var t,n,e,n,t={},n=this,e=n.color,n=n.style;return"black"!==e&&(t.color=e),t.style=n,t},D.prototype.fromJSON=function(t,n){var e,i,t;t&&(e=this,i=t.color,t=t.style,f(i)&&(e.color=i),f(t))&&(e.style=t)},D.YC=function(t){var n,e,n,e;return{9:1,1:1,3:1,4:1,7:1,11:1,2:2,10:2,12:2,8:2,13:2,5:3,6:3}[t&&t.style]||0},I=D,t.LineBorder=I,x=["backColor","foreColor",m,y,"font","themeFont",n,"borderLeft","borderTop","borderRight","borderBottom","locked","textIndent","wordWrap","showEllipsis","_showTip","shrinkToFit","backgroundImage",v,"backgroundImageLayout","tabStop","textDecoration",w,"name","parentName","watermark","cellPadding",M,"quotePrefix","diagonalDown","diagonalUp","isVerticalText",C,S,"textOrientation","decoration","mask"],N=[e,T,A,L,F,P],j.xp=function(t,n){var e=t.parentName;e&&!n.getNamedStyle(e)&&delete t.parentName},j.prototype.compose=function(t,n,e,i,r){this.h5(t,n,e,i,r)},j.prototype.h5=function(t,n,e,i,r){var o,a,u,s,c,f,l,h,d,v,m,n,o=this,h=t.labelOptions,d=t.cellButtons;if(t.cellButtons&&0<t.cellButtons.length)for(d=[],v=0;v<t.cellButtons.length;v++)d.push(p(t.cellButtons[v]));if(m=t.dropDowns,t.dropDowns&&0<t.dropDowns.length)for(m=[],v=0;v<t.dropDowns.length;v++)m.push(z(t.dropDowns[v]));n?(o._autoFormatter=t._autoFormatter,o.backgroundImage=t.backgroundImage,o.backgroundImageLayout=t.backgroundImageLayout,o.backColor=E(t.backColor),o.foreColor=t.foreColor,o.hAlign=t.hAlign,o.vAlign=t.vAlign,o.font=t.font,o.themeFont=t.themeFont,o.formatter=t.formatter,o.mask=E(t.mask),o.showEllipsis=t.showEllipsis,o.hv=t.hv,a=t.borderLeft,o.borderLeft=a&&a.Gf&&a.Gf()||a,o.borderLeft&&e&&(o.borderLeft.level=e),u=t.borderTop,o.borderTop=u&&u.Gf&&u.Gf()||u,o.borderTop&&e&&(o.borderTop.level=e),s=t.borderRight,o.borderRight=s&&s.Gf&&s.Gf()||s,o.borderRight&&e&&(o.borderRight.level=e),c=t.borderBottom,o.borderBottom=c&&c.Gf&&c.Gf()||c,o.borderBottom&&e&&(o.borderBottom.level=e),f=t.diagonalDown,o.diagonalDown=f&&f.Gf&&f.Gf()||f,o.diagonalDown&&e&&(o.diagonalDown.level=e),l=t.diagonalUp,o.diagonalUp=l&&l.Gf&&l.Gf()||l,o.diagonalUp&&e&&(o.diagonalUp.level=e),o.locked=t.locked,o.textIndent=t.textIndent,o.wordWrap=t.wordWrap,o.shrinkToFit=t.shrinkToFit,o.cellType=t.cellType,o.name=t.name,o.parentName=t.parentName,o.tabStop=t.tabStop,o.textDecoration=t.textDecoration,o.imeMode=t.imeMode,o.watermark=t.watermark,o.cellPadding=t.cellPadding,o.isVerticalText=t.isVerticalText,o.textOrientation=t.textOrientation,h&&(o.labelOptions={alignment:h.alignment,font:h.font,foreColor:h.foreColor,visibility:h.visibility,margin:h.margin}),o.quotePrefix=t.quotePrefix,o.cellButtons=d,o.dropDowns=m,o.decoration=$(t)):(o.backgroundImage===b&&(o.backgroundImage=t.backgroundImage),o.backgroundImageLayout===b&&(o.backgroundImageLayout=t.backgroundImageLayout),o.backColor===b&&(o.backColor=E(t.backColor)),o.foreColor===b&&(o.foreColor=t.foreColor),o.hAlign===b&&(o.hAlign=t.hAlign),o.vAlign===b&&(o.vAlign=t.vAlign),o.themeFont===b&&o.font===b?(o.themeFont=t.themeFont,o.font=t.font):o.themeFont!==b&&o.font===b&&(o.font=t.font),o.formatter===b&&(o.formatter=t.formatter),o.showEllipsis===b&&(o.showEllipsis=t.showEllipsis),o.hv===b&&(o.hv=t.hv),o._autoFormatter===b&&(o._autoFormatter=t._autoFormatter),o.mask===b&&(o.mask=E(t.mask)),o.borderLeft===b&&(a=t.borderLeft,o.borderLeft=a&&a.Gf&&a.Gf()||a,o.borderLeft)&&e&&(o.borderLeft.level=e),o.borderTop===b&&(u=t.borderTop,o.borderTop=u&&u.Gf&&u.Gf()||u,o.borderTop)&&e&&(o.borderTop.level=e),o.borderRight===b&&(s=t.borderRight,o.borderRight=s&&s.Gf&&s.Gf()||s,o.borderRight)&&e&&(o.borderRight.level=e),o.borderBottom===b&&(c=t.borderBottom,o.borderBottom=c&&c.Gf&&c.Gf()||c,o.borderBottom)&&e&&(o.borderBottom.level=e),o.diagonalDown===b&&(f=t.diagonalDown,o.diagonalDown=f&&f.Gf&&f.Gf()||f,o.diagonalDown)&&e&&(o.diagonalDown.level=e),o.diagonalUp===b&&(l=t.diagonalUp,o.diagonalUp=l&&l.Gf&&l.Gf()||l,o.diagonalUp)&&e&&(o.diagonalUp.level=e),o.locked===b&&(o.locked=t.locked),o.textIndent===b&&(o.textIndent=t.textIndent),o.wordWrap===b&&(o.wordWrap=t.wordWrap),o.shrinkToFit===b&&(o.shrinkToFit=t.shrinkToFit),o.cellType===b&&(o.cellType=t.cellType),o.tabStop===b&&(o.tabStop=t.tabStop),o.textDecoration===b&&(o.textDecoration=t.textDecoration),o.imeMode===b&&(o.imeMode=t.imeMode),o.name===b&&(o.name=t.name),o.parentName===b&&(o.parentName=t.parentName),o.watermark===b&&(o.watermark=t.watermark),o.cellPadding===b&&(o.cellPadding=t.cellPadding),!o.labelOptions&&h&&(o.labelOptions={}),(n=o.labelOptions)&&h&&(n.alignment===b&&(n.alignment=h.alignment),n.font===b&&(n.font=h.font),n.foreColor===b&&(n.foreColor=h.foreColor),n.visibility===b&&(n.visibility=h.visibility),n.margin===b)&&(n.margin=h.margin),i||o.quotePrefix!==b||(o.quotePrefix=t.quotePrefix),o.isVerticalText===b&&(o.isVerticalText=t.isVerticalText),o.textOrientation===b&&(o.textOrientation=t.textOrientation),o.cellButtons===b&&(o.cellButtons=d),o.dropDowns===b&&(o.dropDowns=m),o.decoration===b?o.decoration=$(t):r&&g.W.ose(t)&&tt(o,t))},j.prototype.d5=function(t){var e=this;0===arguments.length?(i(x,function(t,n){e[n]=b}),i(N,function(t,n){f(e[n])&&(e[n]=b)})):e[t]=b},j.prototype.clone=function(t){var n,e,i,r,o,a,u,s,n=this,e=n.borderLeft,i=n.borderTop,r=n.borderRight,o=n.borderBottom,a=n.diagonalDown,u=n.diagonalUp,s=new j;return s.backColor=E(n.backColor),s.foreColor=n.foreColor,s.hAlign=n.hAlign,s.vAlign=n.vAlign,s.font=n.font,s.themeFont=n.themeFont,s.formatter=b,s.mask=E(n.mask),s.borderLeft=e&&!t&&e.Gf()||e,s.borderTop=i&&!t&&i.Gf()||i,s.borderRight=r&&!t&&r.Gf()||r,s.borderBottom=o&&!t&&o.Gf()||o,s.locked=n.locked,s.textIndent=n.textIndent,s.wordWrap=n.wordWrap,s.shrinkToFit=n.shrinkToFit,s.backgroundImage=n.backgroundImage,s.cellType=b,s.backgroundImageLayout=n.backgroundImageLayout,s.tabStop=n.tabStop,s.textDecoration=n.textDecoration,s.imeMode=n.imeMode,s.name=n.name,s.parentName=n.parentName,s.watermark=n.watermark,s.cellPadding=n.cellPadding,s.labelOptions=n.labelOptions,s.quotePrefix=n.quotePrefix,s.diagonalDown=a&&!t&&a.Gf()||a,s.diagonalUp=u&&!t&&u.Gf()||u,s.isVerticalText=n.isVerticalText,s.showEllipsis=n.showEllipsis,s.hv=n.hv,s.textOrientation=n.textOrientation,ot(s,n.decoration,!t,!0),nt(n,s),ut(s,n.formatter,!t),st(s,n._autoFormatter,!t),et(s,n.cellType,!t,!0),rt(s,n.cellButtons,!t,!0),at(s,n.dropDowns,!t,!0),s},j.prototype.v5=function(i){var n,e,t,r,o,a,u,s,c,n=this;if(i&&i.getColor){if(R(i,n.foreColor,function(t){n.foreColor=t}),"string"==typeof(e=n.backColor))R(i,e,function(t){n.backColor=t});else if(e&&(e.backgroundColor&&R(i,e.backgroundColor,function(t){e.backgroundColor=t}),e.patternColor&&R(i,e.patternColor,function(t){e.patternColor=t}),e.stops))for(t=function(n){R(i,e.stops[n].color,function(t){e.stops[n].color=t})},r=0;r<e.stops.length;r++)t(r);for(a=function(t,n){var e=o[t];e&&e.color&&R(i,e.color,function(t){e.color=t})},r=0,u=(o=[n.borderLeft,n.borderTop,n.borderRight,n.borderBottom,n.diagonalDown,n.diagonalUp]).length;r<u;r++)a(r,u)}return s=n.themeFont,c=n.font,i&&i.getFont&&(s?n.font=g.W.m5(c,i.getFont(s)):c||(n.font=g.W.m5(c,i.bodyFont()))),n},j.prototype.g5=function(t){var n,e,e,n=this,e=n._autoFormatter;e&&t!==h&&((e=e.getPreferredEditingFormatter(t)).isAuto=!0,n._autoFormatter=e)},j.prototype.toJSON=function(t,n){var e,i,r,o,a,e=this,i={},r=e._autoFormatter;for(!f(r)||n&&ct(d,r,t)||(r.toJSON&&(r=r.toJSON()),u.GC$.isEmptyObject(r))||(i[d]=r),o=0;o<x.length;o++)r=e[a=x[o]],a!==M||u.GC$.isEmptyObject(r)?a!==S&&a!==C||u.GC$.isEmptyObject(r)?!f(r)||n&&ct(a,r,t)||(i[a]=r&&r.toJSON?r.toJSON():r):i[a]=r:i[M]=r;for(o=0;o<N.length;o++)r=e[a=N[o]],f(r)&&(i[a]=r);return u.GC$.isEmptyObject(i)?b:i},j.prototype.fromJSON=function(t,n,e){var i,r,o,a,a;if(t)for(r in i=this,t)t.hasOwnProperty(r)&&(o=t[r],f(o))&&((a={p:r,v:o,r:!1}).noSchema=n,a.context=e,j.et(i,"fromJson",a),a.r||("formatter"===r?ut(i,o,!0):"autoFormatter"===r?st(i,o,!0):r===v?et(i,o,!0,n):G[r]?o===h?i[r]=null:((a=new I).fromJSON(o,n),i[r]=a):i[r]=o))},j.prototype.Je=function(t){var n=this;n.backColor=Y(t.backColor),n.foreColor=t.foreColor,n.hAlign=O(r.HorizontalAlign,t.hAlign,b),n.vAlign=O(r.VerticalAlign,t.vAlign,b),n.font=t.font,n.themeFont=t.themeFont,n.formatter=t.formatter,n.borderLeft=_(t.borderLeft),n.borderTop=_(t.borderTop),n.borderRight=_(t.borderRight),n.borderBottom=_(t.borderBottom),n.diagonalDown=_(t.diagonalDown),n.diagonalUp=_(t.diagonalUp),n.locked=t.locked,n.textIndent=t.textIndent,n.wordWrap=t.wordWrap,n.shrinkToFit=t.shrinkToFit,n.backgroundImage=t.backgroundImage,n.cellType=Z(t.cellType),n.backgroundImageLayout=O(r.ImageLayout,t.backgroundImageLayout,b),n.tabStop=t.tabStop,n.textDecoration=q(t.textDecoration),n.imeMode=O(r.ImeMode,t.imeMode,b),n.name=t.name,n.parentName=t.parentName,n.watermark=t.watermark,n.cellPadding=t.cellPadding,n.labelOptions=W(t.labelOptions),n.isVerticalText=t.isVerticalText,n.textOrientation=t.textOrientation,n.showEllipsis=t.showEllipsis,n.cellButtons=J(t.cellButtons),n.dropDowns=X(t.dropDowns),n.decoration=Q(t.decoration),nt(t,n)},k=j,t.Style=k,s.$e(k),k.l5=0},"./dist/core/worksheet/stylehelper.js":function(t,o,n){"use strict";var a,h,i,d,v,e,r,u,m,g,p,b,y,w,M,C,S,s;function c(t){return t=v(t=t||0,0),t=e(t,1)}function T(){}Object.defineProperty(o,"__esModule",{value:!0}),o.W=o.p5=void 0,a=n("./dist/core/util/domUtil.js"),h=n("./dist/core/util/common.js"),i=n("./dist/core/core.enum.js"),d=document,v=Math.max,e=Math.min,r=void 0,u=null,m="#FFFFFF",g="#000000",p=Math.abs,b=Math.PI,y=Math.cos,w=Math.sin,M=Math.atan,C=Math.tan,o.p5="11pt",S={1:[[1]],2:[[1,0,1,1],[1,1,1,0]],3:[[0,1],[1,0]],4:[[0,0,1,0],[1,0,0,0]],5:[[0,0,0,0],[0,0,1,0],[0,0,0,0],[1,0,0,0]],6:[[0,0,0,0,0,0,0,0],[1,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0],[0,0,0,0,1,0,0,0]],7:[[0],[1],[1],[0]],8:[[1,1,0,0]],9:[[0,1,1,0],[0,0,1,1],[1,0,0,1],[1,1,0,0]],10:[[0,1,1,0],[1,1,0,0],[1,0,0,1],[0,0,1,1]],11:[[0,0,1,1],[0,0,1,1],[1,1,0,0],[1,1,0,0]],12:[[0,1,1,0],[1,1,1,1],[1,0,0,1],[1,1,1,1]],13:[[0],[1],[0],[0]],14:[[1,0,0,0]],15:[[0,1,0,0],[0,0,1,0],[0,0,0,1],[1,0,0,0]],16:[[0,0,1,0],[0,1,0,0],[1,0,0,0],[0,0,0,1]],17:[[0,0,1,0],[1,1,1,1],[0,0,1,0],[0,0,1,0]],18:[[1,0,1,0],[0,0,0,1],[1,0,1,0],[0,1,0,0]]},T.m5=function(t,n){return n?T.b5(t,n):t},T.Ne=function(t){var n,t;return t?((n=T.y5()).style.font=t,{fontFamily:(t=n.style).fontFamily,fontSize:t.fontSize,fontStyle:t.fontStyle,fontWeight:t.fontWeight}):{}},T.f5=function(t){var n,e,i,r,o,a,u,s,c,f,l;return h.mt.Tt.safari?t.font:(n="",e="normal",a=t.fontStyle,u=t.fontVariant,s=t.fontWeight,c=t.lineHeight,a&&a!==e&&(n=a),u&&u!==e&&(n+=(n?" ":"")+u),s&&s!==e&&s!==(i="400")&&(n+=(n?" ":"")+s),n+=(n?" ":"")+(f=(f=t.fontSize)||(r="11pt")),c&&c!==e&&(n+="/"+c),n+(" "+(l=(l=t.fontFamily)||(o="Calibri"))))},T.b5=function(t,n){var e,i,r,t,n;if(!t&&!n)return t;if(t){if(r=T.w5[i=n?t+"+"+n:t])return r;e=T.y5(),(0,a.GC$)(e).css("font",t)}else{if(r=T.w5[i=n])return r;e=T.y5(),(0,a.GC$)(e).css("fontSize",o.p5)}return n&&(0,a.GC$)(e).css("fontFamily",n),t=e.currentStyle,(n=d.defaultView)&&n.getComputedStyle&&(t=n.getComputedStyle(e,"")),r=T.f5(t),T.w5[i]=r,T.w5[r]=r},T.V=function(t,n,e,i){var r,o,a,u,s,s,c,f,e,l,r=T.C5[n];if(!i)if(r){if(o=r[t])return o}else r=T.C5[n]={};return(a=T.y5()).style.font=t,u=a.currentStyle,-1!==(s=(u=(s=d.defaultView)&&s.getComputedStyle?s.getComputedStyle(a,""):u).fontSize).indexOf(c="px")&&(f=v(1,parseFloat(s.replace(c,""))*n),e&&1===f&&(e.value=!0),s=f+c),-1!==(e=u.lineHeight).indexOf(c)&&(e=(l=v(1,parseFloat(e.replace(c,""))*n))+c),o=1===n?{font:t,fontFamily:a.style.fontFamily,fontSize:f}:(a.style.fontSize=s,a.style.lineHeight=e,{font:a.style.font,fontFamily:a.style.fontFamily,fontSize:f}),i||(r[t]=o),o},T.y5=function(){var t,n,e;return T.S5?T.S5.style.cssText=T.T5:(t="-10000px",(e=(n=h.mt.En("span")).style).visibility="hidden",e.top=t,e.left=t,e.lineHeight="normal",e.position="absolute",e.fontWeight="normal",e.fontStretch="normal",e.fontVariant="normal",e.fontStyle="normal",d.body.insertBefore(n,null),T.S5=n,T.T5=e.cssText),T.S5},T.L0=function(){var t=T.S5;t&&((0,a.GC$)(t).remove(),T.S5=r,T.T5=r)},T.stringFontCatch={},T.ii=function(t,n){var e,i,r,o,e=t+","+n,i=T.stringFontCatch,r=i[e];return r||((o=T.y5()).style.font=t,n&&(o.style.fontWeight=n),r=i[e]=o.style.font),r},T.w5={},T.C5={},T.A5=function(t){var n;return t<=0?"none":(n="",(1|t)===t&&(n+="underline "),(2|t)===t&&(n+="line-through "),(4|t)===t&&(n+="overline "),n.trim())},T.setFillStyle=function(t,n,e,i,r,o,a){"string"==typeof n?(t.fillStyle!==n&&(t.fillStyle=n),a()):"path"===n.type?T.setFillStylePath(t,n,e,i,r,o,a):n.stops?T.setFillStyleGradient(t,n,e,i,r,o,a):n.type&&T.setFillStylepatternFill(t,n,e,i,r,o,a)},T.setFillStylepatternFill=function(t,n,e,i,r,o,a){var u,s,c,f,l,h,d,v,n,u=S[n.type],s=u.length,c=u[0].length,f=document.createElement("canvas");for(f.width=c,f.height=s,(l=f.getContext("2d")).fillStyle=n.backgroundColor||m,l.fillRect(0,0,c,s),l.fillStyle=n.patternColor||g,h=0;h<s;h++)for(d=0;d<c;d++)(v=u[h][d])&&l.fillRect(d,h,1,1);t.createPattern(f,"repeat"),n=t.createPattern(f,"repeat"),t.fillStyle=n,a()},T.processStops=function(t){var n,e;if(t.stops||"path"===t.type){if(n=t.stops)if(0===n.length)n=[{position:0,color:g},{position:1,color:g}];else{for((n=n.filter(function(t,n,e){return t.position<=1&&0<=t.position})).sort(function(t,n){return t.position-n.position}),e=0;e<n.length;e++)n[e].color=n[e].color||g;0!==n[0].position&&n.splice(0,0,{position:0,color:g}),1!==n[n.length-1].position&&n.push({position:1,color:g})}else n=[{position:0,color:m},{position:1,color:m}];t.stops=n}"path"===t.type?(t.left=c(t.left),t.right=c(t.right),t.top=c(t.top),t.bottom=c(t.bottom)):t.stops&&(delete t.type,t.degree=t.degree||0)},T.setFillStyleGradient=function(t,n,e,i,r,o,a){var u,s,c,f,u,l,h,d,u=n.degree||0;for(u%90==0?(c=u/180*b,f=p(u%180/180*b)-M(o/r)):(c=M(r/o*C(u/180*b)),f=p(c)-M(o/r),c=Math.round(u/180)*b+c),u=Math.sqrt(r*r+o*o)/2,s=t.createLinearGradient(e+r/2-u*y(f)*y(c),i+o/2-u*y(f)*w(c),e+r/2+u*y(f)*y(c),i+o/2+u*y(f)*w(c)),h=0,d=(l=n.stops).length;h<d;h++)s.addColorStop(l[h].position,l[h].color||m);t.fillStyle=s,a()},T.setFillStylePath=function(t,n,e,i,r,o,a){var u,s,c,f,l,h,d,v,u=n.left||0,s=n.right||0,c=n.top||0,f=n.bottom||0,l=n.stops;if(s<u&&(s=u),f<c&&(f=c),0<u){for(t.save(),t.beginPath(),h=t.createLinearGradient(e+r*u,0,e,0),d=0,v=l.length;d<v;d++)h.addColorStop(l[d].position,l[d].color||m);t.fillStyle=h,t.moveTo(e,i-1),t.lineTo(e+r*u+1,i+o*c),t.lineTo(e+r*u+1,i+o*f),t.lineTo(e,i+o+1),t.clip(),a(),t.restore()}if(s<1){for(t.save(),t.beginPath(),h=t.createLinearGradient(e+r*s,0,e+r,0),d=0,v=l.length;d<v;d++)h.addColorStop(l[d].position,l[d].color||m);t.fillStyle=h,t.moveTo(e+r,i-1),t.lineTo(e+r,i+o+1),t.lineTo(e+r*s-1,i+o*f),t.lineTo(e+r*s-1,i+o*c),t.clip(),a(),t.restore()}if(0<c){for(t.save(),t.beginPath(),h=t.createLinearGradient(0,i+o*c,0,i),d=0,v=l.length;d<v;d++)h.addColorStop(l[d].position,l[d].color||m);t.fillStyle=h,t.moveTo(e,i),t.lineTo(e+r,i),t.lineTo(e+r*s,i+o*c+1),t.lineTo(e+r*u,i+o*c+1),t.clip(),a(),t.restore()}if(f<1){for(t.save(),t.beginPath(),h=t.createLinearGradient(0,i+o*f,0,i+o),d=0,v=l.length;d<v;d++)h.addColorStop(l[d].position,l[d].color||m);t.fillStyle=h,t.moveTo(e+r,i+o),t.lineTo(e,i+o),t.lineTo(e+r*u,i+o*f-1),t.lineTo(e+r*s,i+o*f-1),t.clip(),a(),t.restore()}u<s&&c<f&&(t.save(),t.beginPath(),t.fillStyle=l[0].color,t.rect(e+r*u,i+o*c,r*(s-u),o*(f-c)),t.clip(),a(),t.restore())},T.ose=function(t){return t&&t.decoration&&t.decoration.icons&&0<t.decoration.icons.length},T.dfe=function(t,n){var e=n===i.IconPosition.left;return T.ose(t)&&t.decoration.icons.some(function(t){return e?t.position===i.IconPosition.left||t.position===u||t.position===r:t.position===n})},T.rse=function(t){return T.ose(t)&&t.decoration.icons.some(function(t){return T.ise(t)})},T.ise=function(t){return t.position===u||t.position===r||t.position===i.IconPosition.left||t.position===i.IconPosition.leftOfText||t.position===i.IconPosition.right||t.position===i.IconPosition.rightOfText},o.W=T},"./dist/core/worksheet/worksheet-actions.js":function(f,l,t){"use strict";var n,e,B,C,T,tt,H,h,nt,b,L,A,d,I,F,et,z,v,x,m,y,w,N,k,S,g,h,D,it,rt,P,_,V,E,j,O,Y,Z,R,W,t,ot,at,Q,J,K,X,q,$,vt,mt,gt,pt,bt,yt,wt,Mt,Ct,St,Tt,At,It,xt,Nt,kt,Dt,_t,Et,jt,Ot,Rt,Bt,Lt,Ft,Pt,Gt,Ut,Ht,zt,Vt,Yt,Zt,Wt,Qt,Jt,Kt,Xt,qt,$t,tn,nn,en,rn,on,an,un,sn,cn,fn,ln,hn,dn,vn,u,mn,gn,e,pn,bn,yn,wn,Mn,Cn,Sn,Tn,An,In,xn,Nn,kn,Dn,_n,En,jn,On,Rn,Bn,Ln,Fn,Pn,Gn,Un,Hn,zn;function ut(t,n){return t.getRowCount(n)}function st(t,n){return t.getColumnCount(n)}function ct(t){return t.rowCount}function ft(t){return t.colCount}function Vn(t){var t=t.parent;return t&&t.options.allowExtendPasteRange}function G(t){var t=t.parent;return t&&t.options.allowCopyPasteExcelStyle}function U(t){var t=t.parent;return t&&t.options.copyPasteHeaderOptions}function Yn(t){return(t&nt.CopyToOptions.style)<=0}function Zn(t,n,e,i){throw new Error(v.I5(ot().Exp_InvalidAndSpace,[t,n,e,i]))}function Wn(t){t.suspendPaint()}function lt(t){t.resumePaint()}function Qn(t){t.suspendEvent()}function ht(t){t.resumeEvent()}function Jn(t,n){t&&F&&t.suspendCalcService(n)}function Kn(t,n){t&&F&&t.resumeCalcService(n)}function Xn(t,n,e,i,r){var i=t.getSpan(n,e,i);return!(!(i&&r&&t.getRowVisible(i.row)&&t.getColumnVisible(i.col))||i.row===n&&i.col===e)}function qn(t){var n=this;n.x5=1==(1&t),n.N5=2==(2&t),n.k5=8==(8&t),n.D5=F&&16==(16&t),n._5=!0,n.E5=!0}function $n(t,n,e,i,r,o){var a,u,s,c,f,l,h,d,v,m,g,p,b,y,w,r,r;if(et(t)||""===t)return it;for(!et(n)&&""!==n||(n="\r\n"),a="\n",!et(e)&&""!==e||(e="\t"),!et(i)&&""!==i||(i='"'),x(t,n)||(t+=n),u=!r,s=[],f="",h=!(c=[]),d=i.length,v=n.length,m=a.length,g=e.length,p=t.length,b=0;b<p;b++)l=(f+=t[b]).length,u&&(l===d&&i===f||d<l&&i===f.substr(l-d,d))?h&&b+1+d<=p&&i===t.substr(b+1,d)?b+=d:h?(f=f.substr(0,l-d),h=!1):0===f.indexOf(i)&&(f=f.substr(0,l-d),h=!0):!h&&(l===g&&e===f||g<l&&e===f.substr(l-g,g))?(f=f.substr(0,l-g),c.push(f),f=""):!h&&(l===v&&n===f||v<l&&n===f.substr(l-v,v))?(f=f.substr(0,l-v),c.push(f),s.push(c),c=[],f=""):!h&&(l===m&&a===f||m<l&&a===f.substr(l-m,m))?(f=f.substr(0,l-m),c.push(f),s.push(c),c=[],f=""):h&&b+1+g<=p&&e===t.substr(b+1,g)&&","!==e&&(b+=d);if(h){if(0<c.length){for(w=void 0,w=0;w<s.length&&s[w]!==c;w++);s.length<=w&&s.push(c)}(r=f.toString())&&(r=r.replace(new RegExp(e,"g"),""),x(r,n)&&(r=r.substr(0,r.length-v)),0===s.length)&&s.push([r])}return 0===s.length&&(x(r=t,n)&&(r=r.substr(0,r.length-v)),s.push([r])),o&&te(s)&&/^(\s)*$/.test(t)&&t.substr(t.length-m,m)===a&&s.push([""]),s}function te(t){var n,e;if(t){for(n=0;n<t.length&&((e=t[n])&&1===e.length);n++);if(n===t.length)return 1}}function ne(t,n,e,i,r){var o,a,u,s,c,r,f,l,h,d,v,o=i.length,a=re(i);if(0!==o&&0!==a)for(u=new qn(r),t&&(st(t,2)<=0&&(u.x5=!1),ut(t,1)<=0)&&(u.N5=!1),(a-=s=u.x5?st(t,2):0)<=(r=0)&&(a=0),(o=(o-=c=u.N5?ut(t,1):0)-(r=o<=0?0:r))<=0&&(o=0),u._5&&n+o>ut(t)&&t.setRowCount(n+o),u.E5&&e+a>st(t)&&t.setColumnCount(e+a),f={},h=l=0;l<i.length;l++,h++)d=i[l],v=t.o5(),d.length<=0||(0<c&&l<c?ee(t,d,h,e,a,1,u,f):0<o&&h<ut(t)&&(ee(t,d,h=l===c?n:h,0,s,2,u,f),d.splice(0,s),v&&(h=t.j5(h-1,3)),ee(t,d,h,e,a,3,u,f,v)))}function ee(t,n,e,i,r,o,a,u,s){for(var c,f,l,c=st(t,o),f=0,l=i;f<n.length;f++,l++)0<r&&l<c&&(s&&(l=t.O5(l-1,3)),ie(t,o,e,l,n[f],a,u))}function ie(n,e,i,r,o,t,a){var u,s,c,f,l,l,a,f,t,h,c,u=o,s=it;if(!1===t.k5&&(c={value:it},l=a[f=o.toString()],!et(o)&&l?(u=l.setValue,s=l.formatter):(u=tt.mt.Xf(it,o,!t.k5,c),s=c.value,et(o)||(a[f]={setValue:u,formatter:s}))),et(u))n.setValue(i,r,u,e);else if(""!==o)if(t.D5&&"="===o[0]&&1<o.length)try{n.setFormula(i,r,o.substr(1))}catch(t){n.setText(i,r,o,e)}else l=n.l0(i,r,"formatter",e),!1===t.k5&&s?l?(c=(l="string"==typeof l&&B.Formatter?new B.Formatter.GeneralFormatter(l):l).parse&&l.parse(o),u=et(c)?u:c):(s.isAuto=!0,n.getCell(i,r,e).R5("_autoFormatter",s),a=void 0,f=n.getCellType(i,r,e),t=s.formatString(),f&&"7"===f.typeName&&(a=f.parse(o,t,h={sheet:n,row:i,col:r,sheetArea:e}),u=et(a)?o:a)):l&&n.getCell(i,r,e).formatter(it),n.setValue(i,r,u,e);else n.setValue(i,r,it,e)}function re(t){for(var n,e,i,n=0,e=0;e<(t&&t.length);e++)i=t[e],n=P(i.length,n);return n}function oe(t,n,e,i,r,o,a,u,s,c){if(!t)throw new Error(ot().Exp_SheetIsNull);var i;(n<-1||n>=ut(t))&&Zn("row",n,"-1",ut(t)-1),(e<-1||e>=st(t))&&Zn("column",e,"-1",st(t)-1),et(i)||""===i||(-1===n&&(n=0),-1===e&&(e=0),(i=$n(i,r,o,a,s,c))&&0<i.length&&ne(t,n,e,i,u))}function ae(t,n,e,i,r,o,a,u,s,c,f,l,h,d){var v,m,v,m,g,p,b,y,w,M,p,n,C;if(t)return v=ut(t),m=st(t),(n<-1||v<=n)&&Zn("row",n,"-1",v-1),(e<-1||v<n+e)&&Zn("rowCount",e,"-1",v-n),(i<-1||m<=i)&&Zn("column",i,"-1",m-1),(r<-1||m<i+r)&&Zn("columnCount",r,"-1",m-i),p=g=!(m=v=-1),m=-1===n&&-1===i&&-1===e&&-1===r?(i=n=0,v=(e=ut(t))-1,(r=st(t))-1):(-1===n&&(n=0,2==(2&U(t)))&&(g=!0),-1===i&&(i=0,1==(1&U(t)))&&(p=!0),v=n+(e=-1===e?ut(t)-n:e)-1,i+(r=-1===r?st(t)-i:r)-1),w=y=null,M=fe(t,n,v,i,m,3,c,f,o=!et(o)&&""!==o?o:"\r\n",a=!et(a)&&""!==a?a:"\t",u=!et(u)&&""!==u?u:'"',b=new RegExp(u,"g"),s,l,h,d),p&&(p=t.getColumnCount(2),y=fe(t,n,v,0,p-1,2,c,f,o,a,u,b,s,l,h,d)),g&&(n=t.getRowCount(1),w=fe(t,0,n-1,i,m,1,c,f,o,a,u,b,s,l,h,d)),ue(M,y,w,o,a,C=l&&4e3<e*r&&(S.safari||S.mozilla||tt.mt.Qf()&&S.chrome));throw new Error(ot().Exp_SheetIsNull)}function ue(t,n,e,i,r,o){var a,u,s,n,c,a=t,u=0,s=function(t,n){for(var e,i,r,e=[],i=t.length,r=0;r<i;r++)e.push(t[r].concat(n[r]));return e};return n&&(u=n[0].length,a=s(n,t)),e&&(n=e.length,c=null,a=(e=u?s(c=fe(null,0,n-1,0,u-1,null,[],[],i,r,null,null,null,!1,!1),e):e).concat(a)),o&&se(a),ce(a,i,r)}function se(t){for(var n,e,n=t.length,e=t.length-1;0<=e&&-1===t[e].join("").search(/\S+/);e--)n=e;t.length=n}function ce(t,n,e){for(var i,r,o,a,o="",a=t.length,i=0;i<a;i++){for(r=0;r<t[i].length;r++)0!==r&&(o+=e),o+=t[i][r];o+=n}return o}function fe(t,n,e,i,r,o,a,u,s,c,f,l,h,d,v,m){for(var g,p,b,y,w,M,g=[],y=t&&G(t),p=n;p<=e;p++)if(!a||!z(a,p)){for(w=[],b=i;b<=r;b++)u&&z(u,b)||(M="",M=le(M=t&&!Xn(t,p,b,o,d)&&(M=t.getText(p,b,o),m)&&y?M&&(" "!==M[0]&&" "!==M[M.length-1]||"number"!=typeof t.getValue(p,b,o)?M.replace(/[\r\n]+/g,"\n"):M.trim()):M,d,y,l,f,v,h,c,s),w.push(M));g.push(w)}return g}function le(t,n,e,i,r,o,a,u,s){var c="";return et(t)||(c=t,n&&e)||(c=c.replace(i,r+r)),o&&!c&&(c=" "),n&&e?c=c.replace(/\n/g," "):!a&&-1===c.indexOf(r)&&-1===c.indexOf(u)&&-1===c.indexOf(s)&&-1===c.indexOf("\n")||(c=r+c+r),c}function he(t,n,e,i,r,o){var a,u,s,c,f,l,h,a=it,u=$n(t,n,e,i,r,o);if(u){for(s=u.length,c=re(u),f=[],l=0;l<s;l++)for(f[l]=[],h=0;h<c;h++)h<u[l].length?f[l][h]=u[l][h]:f[l][h]=it;a=f}return a}function de(n,t){var e=[];return t.forEach(function(t){var t=ve(n,t);t&&e.push(t)}),e}function ve(t,n){var e,i,r,t,o,a,u,n,s,e,o,i,a,e=t.row,i=t.col,r=t.row+t.rowCount,t=t.col+t.colCount,o=n.row,a=n.col,u=n.row+n.rowCount,n=n.col+n.colCount,s;return P(e,o)<=_(r,u)&&P(i,a)<=_(t,n)&&(e=P(e,o),o=P(i,a),i=_(r,u)-e,a=_(t,n)-o,new tt.Range(e,o,i,a))}function s(t,n){if(t.sheets){var n=(0,tt._f)(t,n.sheetName);if(n)return n}return t}function o(t,n,e,i){var t,n,t=s(t,e),n=new n(t,e,i);return i?n.undo(t):n.execute(t)}function me(t){var e=t;return function(t,n){var t=s(t,n);return at.B5(t,e)}}function i(t,n){var e,i,e=t,i=n;return function(t,n){var t=s(t,n);return at.L5(t,e,i)}}function ge(t,n){var t,e,i,r,n,t=t.parent;t&&(e=t.getSheetCount(),r=i=void 0,i=r=t.getActiveSheetIndex(),n?r<e-1&&r++:0<r&&r--,i!==r)&&(n=t.getActiveSheet(),t.tb(r,1),t.a3(n),t.repaint())}function pe(t,n,e,i){t.F5=!0,be(t)?t.P5(n):t.G5(n,e,void 0,void 0,i),t.F5=!1}function be(t){var n,e,n=t.Ut.getSelections().length;return 1<n||!(!((e=t.U5())&&0<n)||t.ui===e.row&&t.ci===e.col&&t.H5>=ct(e)&&t.z5>=ft(e))}function ye(t,n){var e,e,t,n;return!!t.endEdit()&&((e=t.rt).V5(),e.Y5(),tt.hi.F1(it),e=!1,(t=t.parent)&&((n=n.call(t))&&n.focus?(n.focus(),e=!0):t.vC()),{ignoreCancelDefault:!e})}function we(t,n,e){var i=this;i.Mf=t,i.Z5=n,i.W5=e,i.Q5=[],i.K5=[],i.J5()}function Me(n,t){var e,i,e=[];return"string"==typeof t?(i=(0,tt._f)(n,t))&&e.push(i):Array.isArray(t)&&t.forEach(function(t){var t=(0,tt._f)(n,t);t&&e.push(t)}),e}function Ce(t){return t instanceof T.Worksheet?t:t.Mf instanceof T.Worksheet?t.Mf:void 0}function M(t,n){Wn(t),n||Qn(t)}function p(t,n){n||ht(t),lt(t)}function Se(t,n){this.X5=M,this.q5=p;var e=this;e.Mf=t,e.tT=n}function Te(t,n){et(t.Tb)&&(t.Tb=n.Tb,t.Ab=n.Ab)}function Ae(t,n){var e=_n.call(this,t,n)||this;return Te(n,t),e}function Ie(t,n){var e=En.call(this,t,n)||this;return Te(n,t),e}function xe(t,n){var e,i,e=jn.call(this)||this,i=e;return i.Mf=t,i.tT=n,e}function Ne(t,n){var e,i,e=On.call(this)||this,i=e;return i.Mf=t,i.tT=n,e}function r(t,n){var e,i,t,e=Rn.call(this,t,n)||this,i=e,t=t.parent;return i.nT=n.rowHeader?2:3,g(n.autoFitType)||(n.autoFitType=t?t.options.autoFitType:0),e}function a(t,n){var e,i,t,e=Bn.call(this,t,n)||this,i=e,t=t.parent;return i.nT=n.columnHeader?1:3,g(n.autoFitType)||(n.autoFitType=t?t.options.autoFitType:0),e}function ke(t,n){"value"===n.propertyName&&t.eT(n.row,n.col,n.oldValue,n.newValue)}function c(t,n){var e,i,t,e=Ln.call(this,t,n)||this;return F&&n.ranges&&1===n.endEditType&&(i=t.JS(n.ranges[0]),1===ct(n.ranges[0]=i))&&1===ft(i)&&(t=t.iT(i.row,i.col,1,1))&&t.ranges&&0<t.ranges.length&&(n.ranges=[t.ranges[0]]),e}function De(t){var t=t.parent,t=t&&t.w2;t&&t.repaint()}function _e(t){var e,n,i,r,o,a,u,s,c,f,l,h,d;if(A){for(e=A.createMap(),n=t.getRowCount(),i=t.getColumnCount(),r=t.b3(),o=r.rT.id,u=function(t,n){t.w3.rT.id!==o&&e.set(n,t)},s=0;s<n;s++)for(c=0;c<i;c++)if((f=r.oT(s,c))&&f.aT)for(a=f.aT,l=0;l<a.length;l++)(h=f[a[l]])&&h.forEach(u);if((d=r.uT())&&d.aT)for(a=d.aT,l=0;l<a.length;l++)(h=d[a[l]])&&h.forEach(function(t){t&&t.content.forEach(u)});return e}}function Ee(t,i){t&&t.forEach(function(t){var n,e,n=t.w3.getFormula(t.row,t.column),e=t.w3.sT(t.row,t.column);t.w3.rT.setFormula(t.row,t.column,n,e,i)})}function je(t,n){return Fn.call(this,t,n)||this}function Oe(t,n){return Pn.call(this,t,n)||this}function Re(t,n){return!(!0===t.isEditing()&&!t.endEdit()||(t.suspendPaint(),t.zoom(n),t.resumePaint(),0))}function Be(t,n){return t.tables&&t.tables.Fue(n)}function Le(t,n){for(var e,i,e=n.row;e<n.row+n.rowCount;e++)for(i=n.col;i<n.col+n.colCount;i++)if(!et(t.getValue(e,i)))return;return 1}function Fe(t,n){return-1!==t.col&&-1!==t.colCount&&t.colCount!==n}function Pe(t,n){return-1===t.row||-1===t.rowCount||t.rowCount===n}function Ge(t,n,e,i,r){if(!(t<=r.row&&n<=r.col&&t+e>=r.row+r.rowCount&&n+i>=r.col+r.colCount||r.col>n+i||r.col+r.colCount-1<n||r.col>n+i-1||r.col+r.colCount-1<n||r.row+r.rowCount-1<t||n===r.col&&i===r.colCount&&t>r.row))return!0}function Ue(t,n){return t.tables&&t.tables.Fue(n)}function He(t,n,e,i,r){return t.tables&&t.tables.oSt(n,e,i,r)}function ze(t,n){return Gn.call(this,t,n)||this}function Ve(t,n,e){var i,r,o,i=Un.call(this,t,n)||this;if(!e&&(n.cachedActions=[],r=n.ranges)&&0<r.length)for(o=0;o<r.length;o++)n.cachedActions[o]=new In(t,{clearRange:r[o]});return i}function dt(t,n){return Hn.call(this,t,n)||this}function Ye(t,n,e){var i,r,o,e,a,u,s,c,f,l,h,d,v,e,m,g,p,b,y,w,M,C,S,M,T,A,i=zn.call(this,t,n)||this;if(!e){if(o=n.fromSheet,!(r=t))throw new Error(ot().Exp_DestSheetIsNull);if(a=(e=n).pastedRanges,u=r.o5(),a&&0<a.length)if(n.cachedActions=[],c=(s=e.fromRanges||[e.fromRange]).length,f=e.isCutting,l=e.clipboardText,h=e.clipboardHtml,d=e.clipboardImage,v=e.pasteOption,e={},m=a[0],!f&&o&&o.cT(s,e)&&m.equals(o.fT(s,m))){for(p=e.inSameCol,(g=e.inSameRow)?s.sort(function(t,n){return t.col-n.col}):p&&s.sort(function(t,n){return t.row-n.row}),b=m.row,y=m.col,w=0;w<c;w++)C=(M=s[w]).rowCount,S=M.colCount,u&&(C+=t.lT(b,C,!0),S+=t.lT(y,S)),M={sourceRange:M,targetRange:(0,tt.Ec)(b,y,C,S),isCutting:f,clipboardText:l,clipboardHtml:h,clipboardImage:d,includeFilteredOutRow:!0},n.cachedActions[w]=new Nn(t,{fromSheet:o,toSheet:r,pasteExtent:M,pasteOption:v}),g?y+=S:p&&(b+=C);n.hT=!0}else for(T=0;T<a.length;T++)A={sourceRange:s[0],targetRange:a[T],isCutting:f,clipboardText:l,clipboardHtml:h,clipboardImage:d},n.cachedActions[T]=new Nn(t,{fromSheet:o,toSheet:r,pasteExtent:A,pasteOption:v})}return i}n=this&&this.__extends||(Dn=function(t,n){return(Dn=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(t,n){t.__proto__=n}:function(t,n){for(var e in n)Object.prototype.hasOwnProperty.call(n,e)&&(t[e]=n[e])}))(t,n)},function(t,n){if("function"!=typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function e(){this.constructor=t}Dn(t,n),t.prototype=null===n?Object.create(n):(e.prototype=n.prototype,new e)}),Object.defineProperty(l,"__esModule",{value:!0}),l.Commands=void 0,e=t("./dist/core/core.ns.js"),B=t("Common"),C=t("./dist/core/worksheet/style.js"),T=t("./dist/core/worksheet/worksheet.js"),tt=t("./dist/core/util/common.js"),H=t("./dist/core/worksheet/clipboardhelper.js"),h=t("./dist/core/util/domUtil.js"),nt=t("./dist/core/core.enum.js"),b=h.GC$,L=t("./dist/core/worksheet/worksheet-static.js"),A=t("CalcEngine"),d=t("./dist/core/util/crypto.js"),I=t("./dist/core/worksheet/worksheet-formatter.js"),F=!!A,et=B.Common.lt.ht,z=B.Common.Uf.OS,v=B.Common.zf,x=v.dT,m=tt.Events.CellChanged,y=tt.Events.ColumnWidthChanging,w=tt.Events.ColumnWidthChanged,N=tt.Events.RowHeightChanging,k=tt.Events.RowHeightChanged,S=tt.mt.Tt,g=tt.mt.T1,h=b.extend,D=b.inherit,it=null,rt=void 0,P=Math.max,_=Math.min,V=Math.floor,E=Math.ceil,j=Number.MAX_VALUE,O=isNaN,Y="^(((ht|f)tp(s?)):\\/\\/(?:www.|(?!www))[a-zA-Z0-9][a-zA-Z0-9-]+[a-zA-Z0-9]\\.[^\\s]{2,}|www\\.[a-zA-Z0-9][a-zA-Z0-9-]+[a-zA-Z0-9]\\.[^\\s]{2,}|((ht|f)tp(s?)):\\/\\/(?:www\\.|(?!www))[a-zA-Z0-9]+\\.[^\\s]{2,}|www\\.[a-zA-Z0-9]+\\.[^\\s]{2,})$",Z="^(mailto:\\/\\/)?([A-Za-z0-9_\\-\\.\\!\\#$%&'*\\+/=?^`{|}~])+\\@([A-Za-z0-9\\-])+\\.([A-Za-z0-9\\-]){2,63}(\\?subject=.+)?$",R=1e5,W="SHA-512",t=new B.Common.ResourceManager(e.SR,"Sheets"),ot=t.getResource.bind(t),h(T.Worksheet.prototype,{autoFitColumn:function(t){0<=t&&t<st(this)&&this.Qy().execute({cmd:"autoFitColumn",sheetName:this.name(),columns:[{col:t}],rowHeader:!1})},autoFitRow:function(t){0<=t&&t<ut(this)&&this.Qy().execute({cmd:"autoFitRow",sheetName:this.name(),rows:[{row:t}],columnHeader:!1})},setCsv:function(t,n,e,i,r,o,a,u){var s=this;Wn(s),Qn(s),Jn(s),oe(s,t,n,e,i,r,'"',o,a,u),Kn(s),ht(s),lt(s)},setDataToCell:function(t,n,e,i){ne(t,n,e,i,0)},getCsv:function(t,n,e,i,r,o){return ae(this,t,e,n,i,r,o,'"',!0)},getRangeTextHasIgnore:function(t,n,e,i,r,o){return ae(this,t,e,n,i,"\r\n","\t",'"',!0,r,o)},copyTo:function(t,n,e,i,r,o,a){this.vT(t,n,e,i,r,o,a)},vT:function(t,n,e,i,r,o,a,u,s){var c=this;Wn(c),Qn(c),L.staticMembers.copyTo(c,t,n,c,e,i,r,o,a,u,0,s),ht(c),lt(c)},moveTo:function(t,n,e,i,r,o,a,u){var s=this;if(!(F&&a&nt.CopyToOptions.formula)||s.mT(t,n,r,o,!0)&&s.mT(e,i,r,o,!0))try{Wn(s),Qn(s),L.staticMembers.moveTo(s,t,n,s,e,i,r,o,a,u)}finally{ht(s),lt(s)}},findSpecialNonNullCellInRange:function(t,n){for(var e,t,i,r,o,a,u,s,e=this.Ut.sheetModels[3],t=tt.mt.S1(this,t),i=t.row,r=t.row+t.rowCount,o=t.col,a=t.col+t.colCount,u=e.gT(i-1);-1!==u&&u<=r;){for(s=e.pT(u,o-1);-1!==s&&s<=a;){if(n(this,u,s))return{row:u,col:s};s=e.pT(u,s)}u=e.gT(u)}return rt},bT:function(t){var n,e,i,r,o,t,n=this,e=n.yT(t);if(e)return i="\t",r="\r\n",o='"',t=n.wT(t),ae(n,e.row,ct(e),e.col,ft(e),r,i,'"',!1,t.rows,t.cols,!0)},MT:function(t){var n,e,t,i,n=this,e=n.yT(t);if(e)return t=n.wT(t),i=U(n),H.yM.KS(n,i,e.row,ct(e),e.col,ft(e),nt.SheetArea.viewport,G(n),t.rows,t.cols,!1,!1,!1,!1)},CT:function(t,n,e){var i,r,o,a,u,s,c,i=this,r=i.rt,o=i.bT(t);if(o){(a=i.ST()).DS=i,a._S=t,n&&i.NMi&&1===t.length&&-1===t[0].row&&-1===t[0].col&&(n=!1),a.ES=n,(u=i.ST()).TT=!0,s=i.MT(t),i.AT&&i.AT(),i.ieV&&i.ieV();try{if(c={sheet:i,sheetName:i.name(),copyData:{text:o,html:s},ranges:t,isCutting:n,cancel:!1,action:n?nt.ClipboardActionType.cut:nt.ClipboardActionType.copy},i.ki(tt.Events.ClipboardChanging,c),!1===c.cancel)return r&&!e&&r.IT(G(i)?s:o),i.ki(tt.Events.ClipboardChanged,{sheet:i,sheetName:i.name(),copyData:{text:o,html:s}}),setTimeout(function(){!r||e||i.xT||r.NT()},100),{copyText:o,copyHtml:s};a.c5()}catch(t){}}},kT:function(t,n,e,i,r,o,a,u,s,c,f){var l,h,d,v,m,m,c,l=ot().Exp_PasteSourceCellsLocked;if(a.pastedInternal=!1,a.pastedRange=it,h=!o&&!s,!t&&h)return!1;if(m=(v=d=this).wT(n),d._T(t,d.yT(n),v,o,m.rows,m.cols,c)||h){if(a.pastedInternal=!0,r&&t.options.isProtected&&t.ET(n))return d.jT(1,l),!1;a.pastedRange=d.OT(t,n,v,e,i,r,u)}else m=d.RT(v,e,o,H.yM.n5(s)),c=d.BT(v,e,s),a.pastedRange=m.union(c);return d.LT(t,n,e,i,r,a,u,f)},LT:function(t,n,e,i,r,o,a,u){var s,c,f,l,h,d,v,m,g,p,f,h,b,y,w,M,C,S,T,A,I,x,N,s=this,c=ot().Exp_InvalidCopyPasteSize,f=s.FT(),l=ot().Exp_PasteChangeMergeCell,h=ot().Exp_ChangePartOfArray,d=s,v=o.pastedRange,m=d.o5();if(!v)return s.jT(1,c),!1;if(!d.PT(v.row,v.col,ct(v),ft(v),f,h,rt,a,rt,nt.SheetArea.viewport))return!1;if(o.pastedInternal){if(1===(g=n.length)){if(p=n[0],r&&!t.PT(p.row,p.col,ct(p),ft(p),f,h,rt,rt,rt,nt.SheetArea.viewport))return!1;if(t.GT(p.row,p.col,ct(p),ft(p)))return s.jT(1,l),!1;if(f=v.row<0?ut(d):ct(v),h=v.col<0?st(d):ft(v),b=p.row<0?ut(t):ct(p),y=p.col<0?st(t):ft(p),m&&(f=(f-=d.lT(e.row,P(f,b),!0))<1?1:f,h=(h-=d.lT(e.col,P(h,y)))<1?1:h),(b<f||y<h)&&!(w=2===i)){if(M=e.row,C=e.col,e.row<0&&b<ut(d)&&(M=0),e.col<0&&y<st(d)&&(C=0),f%b==0&&1===h?(h=y,m||(v=o.pastedRange=new tt.Range(M,C,f,h))):1===f&&h%y==0?(f=b,m||(v=o.pastedRange=new tt.Range(M,C,f,h))):f%b==0&&h%y==0||(v=o.pastedRange=new tt.Range(M,C,f=b,h=y)),S=V(f/b),T=V(h/y),a===rt||r&&(!u||!Be(d,new tt.Range(M,C,f,h))))for(A=0;A<S;A++)for(I=0;I<T;I++)if(!s.UT(p,v)&&d.GT(M<0?-1:M+A*b,C<0?-1:C+I*y,M<0?-1:b,C<0?-1:y))return s.jT(1,l),!1}else if(a===rt&&!s.UT(p,v)&&d.GT(v.row,v.col,ct(v),ft(v)))return s.jT(1,l),!1}else if(1<g){for(x=0;x<g;x++)if(N=n[x],t.GT(N.row,N.col,ct(N),ft(N)))return s.jT(1,l),!1;if(d.GT(v.row,v.col,ct(v),ft(v)))return s.jT(1,l),!1}}else{if(d.GT(v.row,v.col,ct(v),ft(v)))return s.jT(1,l),!1;if(!d.HT(v.row,v.col,ct(v),ft(v)))return s.jT(1,c),!1}return!0},UT:function(t,n){if(t&&1===ct(t)&&1===ft(t)){var t=this.getSpan(n.row,n.col);if(t&&t.equals(n))return!0}return!1},_T:function(t,n,e,i,r,o,a){var u,s,c,f;if(t&&n&&e)try{return(s=(s=(u=ae(t,n.row,ct(n),n.col,ft(n),"\r\n","\t",'"',!1,r,o,!0,S.safari,!0))===i)||((s=!(s=u===i+"\r\n")&&S.chrome?u===i+"\t\r\n":s)||!(S.safari||S.mozilla||a)&&G(e)?s:u.replace(/\s/g,"")===i.replace(/\s/g,"")))||(c=new RegExp(String.fromCharCode(160),"g"),f=String.fromCharCode(32),s=(u=u.replace(c,f)).replace(/\s+$/,"")===i.replace(/\s+$/,"")),s}catch(t){}return!1},OT:function(t,n,e,i,r,o,a){var u,s,c,s,n,f,l,s,h,d,v,m,g,p,r,r,u=this,s=n.length,c=e.o5();if(1!==s)return 1<s?u.fT(n,i):it;if(n=(s=n[0]).row<0?0:s.row,f=s.col<0?0:s.col,l=s.row<0?ut(t):ct(s),s=s.col<0?st(t):ft(s),h=i.row<0?0:i.row,d=i.col<0?0:i.col,v=i.row<0?ut(e):ct(i),m=i.col<0?st(e):ft(i),p=g=void 0,c&&(v=(v-=g=e.lT(h,P(v,l),!0))<1?1:v,m=(m-=p=e.lT(d,P(m,s)))<1?1:m),r=2===r,o||1===v&&1===m)v=l,m=s;else if(!r&&(v%l==0&&1===m?m=s:1===v&&m%s==0?v=l:v%l==0&&m%s==0||(v=l,m=s),!u.zT(n,f,l,s,ut(t),st(t))))return it;if(!o&&t.name()===e.name()&&et(a))if((r=new tt.Range(h,d,v,m)).contains(n,f,l,s)){if((n-h)%l!=0||(f-d)%s!=0)return it}else if(r.intersect(n,f,l,s)&&(l<v||s<m))return it;return c&&(v+=g,m+=p),e.HT(h,d,v,m)?(-1===i.row&&(v=h=-1),-1===i.col&&(m=d=-1),new tt.Range(h,d,v,m)):it},fT:function(t,n){var e,i,r,o,a,u,s,a,c,a,e=this,i=e.o5();if(1<t.length){if(r=t[0],o=t[1],a=r.rowCount,u=r.colCount,r.row===o.row&&a===o.rowCount)return s=0,a=a,t.forEach(function(t){s+=t.colCount}),i&&(a+=e.lT(n.row,a,!0),s+=e.lT(n.col,s)),(0,tt.Ec)(n.row,n.col,a,s);if(r.col===o.col&&u===o.colCount)return c=0,a=u,t.forEach(function(t){c+=t.rowCount}),i&&(c+=e.lT(n.row,c,!0),a+=e.lT(n.col,a)),(0,tt.Ec)(n.row,n.col,c,a)}return it},RT:function(t,n,e,i){var r,n,o,e,i,e,r=n.row<0?0:n.row,n=n.col<0?0:n.col,o=new tt.Range(r,n,1,1),e=he(e,"\r\n","\t",'"',G(t),i);return e&&(i=e.length,e=re(e),0<i)&&0<e&&(t.o5()&&(i+=t.lT(r,i,!0),e+=t.lT(n,e)),o=new tt.Range(r,n,i,e)),o},BT:function(t,n,e){var i,n,r,o,a,a,e,a,e,a,i=n.row<0?0:n.row,n=n.col<0?0:n.col,r=1,o=1,a=t.ST();return a&&((a=a.i5()).innerHTML=e,a=(e=a.getElementsByTagName("table"))&&e[0])&&((e=a.rows)&&(r=e.length,a=e[0]&&e[0].cells)&&(o=a.length),0<r)&&0<o&&t.o5()&&(r+=t.lT(i,r,!0),o+=t.lT(n,o)),new tt.Range(i,n,r,o)},YT:function(){var t=this.ST();t&&t.c5()},ZT:function(t,e,i,n,r,o,a,u,s,c){var f,l,h,d,v,s,m,g,p,b,y,w,M,C,S,T,A,I,x,N,k,f=Nn.WT(s),s=n.row<0?ut(i):ct(n),m=n.col<0?st(i):ft(n),d=e.row<0?ut(t):ct(e),v=e.col<0?st(t):ft(e),l=n.row,h=n.col;for(n.row<0&&d<ut(i)&&(l=0),n.col<0&&v<st(i)&&(h=0),g=V(s/d),p=V(m/v),b=0;b<g&&g&&p;b++)for(y=0;y<p;y++)L.staticMembers.copyTo(t,e.row,e.col,i,l+d*b,h+v*y,d,v,f,c,U(t),rt,Yn(f));for(x=-33&f,C=l+d*g,S=h,T=s-d*g,A=v,I=de(new tt.Range(e.row,e.col,T,A),t.getSpans(e)),N=function(n){I.forEach(function(t){i.addSpan(C+t.row-e.row,S+v*n+t.col-e.col,t.rowCount,t.colCount)}),L.staticMembers.copyTo(t,e.row<0?0:e.row,e.col<0?0:e.col,i,C,S+v*n,T,A,x,c,U(t),rt,Yn(x))},y=0;y<p&&T&&A;y++)N(y);for(C=l,S=h+v*p,T=d,A=m-v*p,I=de(new tt.Range(e.row,e.col,T,A),t.getSpans(e)),k=function(n){I.forEach(function(t){i.addSpan(C+d*n+t.row-e.row,S+t.col-e.col,t.rowCount,t.colCount)}),L.staticMembers.copyTo(t,e.row<0?0:e.row,e.col<0?0:e.col,i,C+d*n,S,T,A,x,c,U(t),rt,Yn(x))},b=0;b<g&&T&&A;b++)k(b);C=l+d*g,S=h+v*p,T=s-d*g,A=m-v*p,I=de(new tt.Range(e.row,e.col,T,A),t.getSpans(e)),T&&A&&(I.forEach(function(t){i.addSpan(C+t.row-e.row,S+t.col-e.col,t.rowCount,t.colCount)}),L.staticMembers.copyTo(t,e.row<0?0:e.row,e.col<0?0:e.col,i,C,S,T,A,x,c,U(t),rt,Yn(x)))},QT:function(t,n,e,i,r,o,a,u,s,c,f){var l,h,d,v,m,g,p,b,y,w,M,C,S,T,A,I,x,N,k,D,_,E,j,O,R;if(t&&e.name()===t.name()&&e.parent&&!t.NMi&&!z(e.parent.sheets,t)&&e.parent!==t.parent)t.YT();else{l=e.o5(),b=Nn.WT(s),Jn(t),Jn(e);try{if(t&&n){if(0!=(2&b)&&r&&F&&(t.KT(n.row,n.col,ct(n),ft(n))||e.KT(i.row,i.col,ct(i),ft(i))))throw ot().Exp_ChangePartOfArray;if(y=2===s,r)L.staticMembers.moveTo(t,n.row,n.col,e,i.row,i.col,ct(n),ft(n),b,t.JT,f),t.YT();else if(y)this.ZT(t,n,e,i,r,o,a,u,s,c);else if(w=i.row<0?ut(e):ct(i),M=i.col<0?st(e):ft(i),v=n.row<0?ut(t):ct(n),m=n.col<0?st(t):ft(n),l&&(w-=e.lT(i.row,P(w,v),!0),M-=e.lT(i.col,P(M,m)),w=w<1?1:w,M=M<1?1:M),v<w||m<M)for(h=i.row,d=i.col,i.row<0&&v<ut(e)&&(h=0),i.col<0&&m<st(e)&&(d=0),w%v==0&&1===M?M=m:1===w&&M%m==0?w=v:w%v==0&&M%m==0||(w=v,M=m),C=V(w/v),S=V(M/m),T=v,A=m,k=N=x=I=void 0,g=0;g<C;g++){for(I=et(N)?h<0?-1:h+g*v:N,p=0;p<S;p++)x=et(k)?d<0?-1:d+p*m:k,v=h<0?-1:T,m=d<0?-1:A,l&&(v=h<0?-1:v+e.lT(I,T,!0),m=d<0?-1:m+e.lT(x,A)),L.staticMembers.copyTo(t,n.row,n.col,e,I,x,T,A,b,c,U(t),f,Yn(b)),k=x+(m<0?0:m);N=I+(v<0?0:v),k=null}else L.staticMembers.copyTo(t,n.row,n.col,e,i.row,i.col,ct(n),ft(n),b,c,U(t),f,Yn(b))}else{if(h=i.row,d=i.col,v=ct(i),m=ft(i),D=0===s||2===s||4===s||5===s,o&&D)for(j=(E=(_=e.Ut).getSpans((0,tt.Ec)(h,d,v,m))).length-1;0<=j;j--)_.do("removeSpan",E[j]);if(F&&0<(1&b)&&e.clearFormula(h,d,v,m,function(t,n){return!t.XT||!t.XT(n)}),O=e.ST(),o&&""!==o)e.parent&&e.parent.options.allowAutoCreateHyperlink&&1===v&&1===m&&(B.Common.$T.qT(Y).test(o)||B.Common.$T.qT(Z).test(o))&&e.setHyperlink&&e.setHyperlink(h,d,{url:o,tooltip:o}),R=e.parent&&e.parent.options.allowUserEditFormula?16:0,e.setCsv(h,d,o,"\r\n","\t",R,G(e),H.yM.n5(a));else if(O&&D&&u)O.s5(u,e,h,d);else for(g=0;g<v;g++)for(p=0;p<m;p++)e.setValue(h+g,d+p,it);O&&D&&a&&O.r5(a,e,h,d)}}finally{Kn(t,!1),Kn(e,!1)}}},tA:function(t){if(!this.isEditing()){var n=this.getSelections();if(n&&1===n.length)return this.options.isProtected&&this.ET(n)?(this.jT(14,this.FT()),it):this.CT(n,!0,t)}return it},nA:function(t){var n,e,i,r,o,a,u,s,n=this,e=t.length,i;if(n.options.isProtected)for(r=0;r<e;r++)for(a=(o=t[r]).row;a<o.row+o.rowCount;a++)for(u=o.col;u<o.col+o.colCount;u++)if(!1!==(s=n.getActualStyle(a,u)).locked)return!0;return!1},cT:function(t,n){var e,i,r,o,a,u,s;if(t&&1<(e=t.length)){for(i=void 0,i=0;i<e;i++)for(r=t[i],o=i+1;o<e;o++)if(a=t[o],r.intersect(a.row,a.col,a.rowCount,a.colCount))return!1;for(u=t[0],s=void 0,i=1;i<e&&(s=t[i],u.row===s.row&&u.rowCount===s.rowCount);i++);if(e<=i)return n&&(n.inSameRow=!0),!0;for(i=1;i<e&&(s=t[i],u.col===s.col&&u.colCount===s.colCount);i++);if(e<=i)return n&&(n.inSameCol=!0),!0}return!1},yT:function(t){var n,e,i,r,o;if(t){if(1===(n=t.length))return t[0];if(1<n){if(e=t[0],i=t[n-1],o=r=void 0,e.row===i.row&&e.rowCount===i.rowCount){for(r=0;r<n;r++)(o=t[r]).col<e.col&&(e=o),o.col>i.col&&(i=o);return(0,tt.Ec)(e.row,e.col,e.rowCount,i.col+i.colCount-e.col)}if(e.col===i.col&&e.colCount===i.colCount){for(r=0;r<n;r++)(o=t[r]).row<e.row&&(e=o),o.row>i.row&&(i=o);return(0,tt.Ec)(e.row,e.col,i.row+i.rowCount-e.row,e.colCount)}}}return it},wT:function(t){var n,e,i,r,o,a,r,u,s,c,s,f,l,h,n=[],e=[];if(t&&1<(i=t.length)&&(r=t[0],o=t[i-1],a=r.row===o.row&&r.rowCount===o.rowCount,r=r.col===o.col&&r.colCount===o.colCount,a||r))for(t.sort(a?function(t,n){return t.col-n.col}:function(t,n){return t.row-n.row}),u=1;u<i;u++)for(s=t[u-1],c=t[u],s=a?s.col+s.colCount:s.row+s.rowCount,f=a?c.col:c.row,l=a?e:n,h=s;h<f;h++)l.push(h);return{rows:n,cols:e}},eA:function(t){var n,e,i,r,o,a,u,s,n=this;if(!n.isEditing()){if((e=n.getSelections())&&1===e.length){if((i=n.ST()).TT=!0,-1!==(r=e[0]).row&&n.iA&&n.iA()){for(o=[],a=-1,u=0;u<r.rowCount;u++)s=r.row+u,n.XT(s)?-1!==a&&(o.push((0,tt.Ec)(a,r.col,s-a,r.colCount)),a=-1):-1===a&&(a=s);-1!==a&&o.push((0,tt.Ec)(a,r.col,r.row+r.rowCount-a,r.colCount)),e=o}return n.CT(e,!1,t)}if(n.cT(e))return n.CT(e,!1,t);n.jT(1,ot().Exp_MultipleSelections)}return it},rA:function(t){var o,a,u,s,c,f,l,h,d,v,o=this,a=o.rt;o.isEditing()||(t&&(u=t.pasteText,s=t.pasteHtml,c=void 0===t.pasteOption?o.options.clipBoardOptions:t.pasteOption,f=t.shiftCells,d=t.isHeaderPaste,h=t.isFromDesigner,l=o.getSelections()[0]),a&&!u&&a.IT(""),(v=o.ST())&&(v.oA=!1),setTimeout(function(){var t,n,e,i,i,r;o.xT||(t=u||"",n=s||"",a&&!u&&(v&&(i=v.QS(),r=v.DS,t=i.text,n=i.html,i=i.image,e=v._S&&v._S[0],r)&&tt.mt.J0(e,r.getRowCount(),r.getColumnCount()),a.NT()),(S.msie||S.edge||u||!t&&!n&&!v.oA)&&o.US(t,n,i,c,f,l,e,h,d),o.rt.aA(),o.ki(tt.Events.PasteEnd))},100))},US:function(t,n,e,i,r,o,a,u,s){var c,f,f,c=this,f=c.ST();if(f&&(f.oA=!0),!(f=c.uA(t,i,r,n,u,s))){if(!e)return;f={pasteOption:void 0===i?c.options.clipBoardOptions:i,pastedRanges:[(0,tt.Ec)(c.getActiveRowIndex(),c.getActiveColumnIndex(),1,1)],clipboardText:""}}r!==rt&&(f.sA=r),et(s)||(f.Nse=s),o&&(f.cA=o),a&&(f.fA=a),f.cmd="clipboardPaste",f.sheetName=c.name(),G(c)&&(f.clipboardHtml=n,f.clipboardImage=e),c.Qy().execute(f)},uA:function(t,n,e,i,r,o){var a,u,s,c,f,l,h,d,v,m,g,p,s,e,b,y,a=this,u=ot().Exp_InvalidPastedArea,s=a.ST(),c=s.DS,f=s._S,l=s.ES;if(l&&c&&f&&c.options.isProtected&&c.ET(f)&&(l=!1),h={pastedRange:it,pastedInternal:!1},d=[],1<(v=a.getSelections()).length)for(g=2===n,p=0;p<v.length;p++){if(m=v[p],!a.kT(c,f,m,n,l,t,h,rt,i,r,o))return;if(m.containsRange(h.pastedRange)&&!m.equals(h.pastedRange)&&!g)return void a.jT(1,u);d.push(h.pastedRange)}else{if(m=0<v.length?v[0]:a.Ut.getSpan(a.ui,a.ci),!a.kT(c,f,m,n,l,t,h,e,i,r,o))return;d.push(h.pastedRange)}if((s=a.lA)&&s._T(h.pastedInternal),h.pastedInternal||(f=c=it,l=!1),e=void 0===n?a.options.clipBoardOptions:n,l&&(e=a.hA),f&&1===f.length)for(b=0;b<d.length;b++)a.UT(f[0],y=d[b])&&(y.rowCount=1,y.colCount=1);if(!((!f||1<f.length)&&1<d.length))return{fromSheet:c,fromRanges:f,isCutting:l,pasteOption:e,pastedRanges:d,clipboardText:t};a.jT(1,ot().Exp_MultipleSelections)},HT:function(t,n,e,i,r){var o,a,u,o=this,a=ut(o),u=st(o);return Vn(o)?-1<=t&&(r||t<a)&&-1<=n&&(r||n<u):o.zT(t,n,e,i,a,u)},ET:function(t){for(var n=0;n<t.length;n++)if(this.dA(t[n],rt,nt.SheetArea.viewport))return!0;return!1},G5:function(t,n,e,i,r){var o,a,a,a,u,o=this,a=o.vA&&1===o.vA.sheetArea;o.endEdit&&!o.endEdit()||a||(a={sheet:o,sheetName:o.name(),row:o.ui,col:o.ci,cancel:!1},o.ki(tt.Events.LeaveCell,a),!0!==a.cancel&&(a=o.ui,u=o.ci,et(e)&&(e=o.ui),et(i)&&(i=o.ci),3===t?o.mA(e,i,n):4===t?o.gA(e,i,n):1===t?o.pA(e,i,n,r):2===t?o.bA(e,i,n):5===t?o.yA():6===t&&o.wA(),o.MA(t,a,u,!1)))},P5:function(t){var n,e,e,i,n=this;n.endEdit()&&(e={sheet:n,sheetName:n.name(),row:n.ui,col:n.ci,cancel:!1},n.ki(tt.Events.LeaveCell,e),!0!==e.cancel)&&(e=n.ui,i=n.ci,3===t?n.CA(n.ui,n.ci):4===t?n.SA(n.ui,n.ci):1===t?n.TA(n.ui,n.ci):2===t&&n.AA(n.ui,n.ci),n.MA(t,e,i,!0))},MA:function(t,n,e,i){var r,o,a,u,s,s,c,f,f,l,h,l,h,f,l,h,u,d,v,d,h,u,m,g,l,v,d,h,u,r=this,o=r.rt,a=r.Ut.getSelections(),u=!1;if(i||(s=r.JS(r.U5()),!(u=1<a.length||1<ct(s)||1<ft(s)?!0:u)&&r.Cb&&r.Cb.Sb(s)&&(u=!0),r.IA()),s=r.ui,c=r.ci,f=r.Ut.getSpan(s,c),r.H5=ct(f),r.z5=ft(f),i||(f=r.xA(s,c),l=r.selectionPolicy(),h=r.selectionUnit(),0!==l&&1!==l||r.Ut.do("clearSelection"),1===h?(f.col=-1,f.colCount=-1):2===h&&(f.row=-1,f.rowCount=-1),r.kA(f.row,f.col,ct(f),ft(f),!1),l=r.Ut.getSelections(),o._A(a,l)&&(r.EA(a,l),r.jA(a))),r.OA(s,c),n!==s&&(h=r.H3)&&h.RA(),f=r.Dn,u){if(h=(l=r.Fi()).BA,u=l.LA,d=l.width-h,v=l.height-u,f.FA(h,u,d,v),f.repaint(new tt.Rect(h,u,d,l.qC)),f.repaint(new tt.Rect(h,u,l.XC,v)),h=(d=r._1)&&d.isEnable(nt.RowColumnStates.selected,!0),u=d&&d.isEnable(nt.RowColumnStates.selected,!1),h||u){for(m=a[0],g=1;g<a.length;g++)m=m.union(a[g]);m&&(l=new tt.Range(s,c,r.H5,r.z5),f.E1(l.union(m),null,null,null,null,i))}f.jy(f.J())}else d=ct(v=r.Ut.getSpan(n,e)),h=ft(v),f.E1(new tt.Range(s,c,r.H5,r.z5).union(new tt.Range(n,e,d,h)),null,null,null,null,i);u={sheet:r,sheetName:r.name(),row:s,col:c},r.ki(tt.Events.EnterCell,u),r.ki(tt.Events.FormulaTextboxEnterCell,u),o.PA&&o.PA(s,c)},GA:function(t,n){var e,i,t,e=this,i=e.getDataValidator&&e.getDataValidator(t,n),t={sheet:e,sheetName:e.name(),row:t,col:n,validator:i,validationResult:0};return e.ki(tt.Events.ValidationError,t),t.validationResult},protect:function(t){this.aue(t)},aue:function(t){var n,e,e,i,t,n=this,e="string"==typeof t;!0!==n.options.isProtected&&(et(t)||e&&0===t.length?n.options.isProtected=!0:e&&(e=d.Qoe.iue(),t=d.Qoe.nue(t,e,i=1e5,d.Qoe.eue),n.oue={algorithmName:W,hashValue:t,saltValue:e,spinCount:1e5},n.options.isProtected=!0))},unprotect:function(t){return this.uue(t)},uue:function(t){var n,e,e,i,r,o,a,u,n=this,e=n.sue();if(n.options.isProtected){if(!e)return!(n.options.isProtected=!1);if(et(t)||"string"!=typeof t||0===t.length)return!1;if(i=(e=n.oue).hashValue,r=e.saltValue,o=e.spinCount,(a=e.algorithmName)!==W)throw new Error(ot().EXP_UNSUPPORT_CRYPTO_ALGORITHM);if(!(u=d.Qoe.rue(t,i,r,o,d.Qoe.eue)))return!1;n.options.isProtected=!1,n.oue=rt}return!0},hasPassword:function(){return this.sue()},sue:function(){return!et(this.oue)}}),at={},(l.Commands=at).B5=function(t,n){return!!t&&2!==t.Di&&(t.G5(n,!1),!0)},at.UA=function(t,n,e,i){return!!t&&2!==t.Di&&(t.G5(n,!1,e,i),!0)},at.L5=function(t,n,e){return!!t&&2!==t.Di&&!(t.endEdit&&!t.endEdit()||(t.HA(n,e),0))},Q="navigationLeft",J="navigationRight",K="navigationUp",X="navigationDown",q="navigationHome2",$="navigationEnd2",vt="navigationTop",mt="navigationBottom",gt="navigationHome",pt="navigationFirst",bt="navigationEnd",yt="navigationLast",wt="moveToNextCell",Mt="moveToPreviousCell",Ct="navigationPageUp",St="navigationPageDown",Tt="navigationPreviousSheet",At="navigationNextSheet",It="clear",xt="clearAndEditing",Nt="commitInputNavigationDown",kt="commitInputNavigationUp",Dt="cancelInput",_t="commitArrayFormula",Et="selectionLeft",jt="selectionRight",Ot="selectionUp",Rt="selectionDown",Bt="selectionHome",Lt="selectionEnd",Ft="selectionPageUp",Pt="selectionPageDown",Gt="selectionTop",Ut="selectionBottom",Ht="selectionFirst",zt="selectionLast",Vt="copy",Yt="cut",Zt="paste",Wt="undo",Qt="redo",Jt="resizeColumn",Kt="resizeRow",Xt="splitResizeRow",qt="splitResizeColumn",$t="autoFitColumn",tn="autoFitRow",nn="editCell",en="renameSheet",rn="zoom",on="clearValues",an="clipboardPaste",un="selectNextControl",sn="selectPreviousControl",cn="moveToNextCellThenControl",fn="moveToPreviousCellThenControl",ln="changeFormulaReference",hn="moveSheet",dn="copySheet",vn="showAllSheetsDialog",at.Tp=s,at.zA=o,at.gM=function(t){var n=tt.mt.Qf(),e=!n,i=n;t.register(Q,at[Q],37,!1,!1,!1,!1),t.register(J,at[J],39,!1,!1,!1,!1),t.register(K,at[K],38,!1,!1,!1,!1),t.register(X,at[X],40,!1,!1,!1,!1),t.register(q,at[q],37,e,!1,!1,i),t.register($,at[$],39,e,!1,!1,i),t.register(vt,at[vt],38,e,!1,!1,i),t.register(mt,at[mt],40,e,!1,!1,i),t.register(gt,at[gt],36,!1,!1,!1,!1),t.register(pt,at[pt],36,!0,!1,!1,!1),t.register(bt,at[bt],35,!1,!1,!1,!1),t.register(yt,at[yt],35,!0,!1,!1,!1),t.register(wt,at[wt],9,!1,!1,!1,!1),t.register(Mt,at[Mt],9,!1,!0,!1,!1),t.register(Ct,at[Ct],33,!1,!1,!1,!1),t.register(St,at[St],34,!1,!1,!1,!1),t.register(Tt,at[Tt],33,e,!1,!1,i),t.register(At,at[At],34,e,!1,!1,i),t.register(It,at[It],46,!1,!1,!1,!1),t.register(xt,at[xt],8,!1,!1,!1,!1),t.register(Nt,at[Nt],13,!1,!1,!1,!1),t.register(kt,at[kt],13,!1,!0,!1,!1),t.register(Dt,at[Dt],27,!1,!1,!1,!1),t.register(_t,at[_t],13,!0,!0,!1,!1),t.register(Et,at[Et],37,!1,!0,!1,!1),t.register(jt,at[jt],39,!1,!0,!1,!1),t.register(Ot,at[Ot],38,!1,!0,!1,!1),t.register(Rt,at[Rt],40,!1,!0,!1,!1),t.register(Bt,at[Bt],36,!1,!0,!1,!1),t.register(Lt,at[Lt],35,!1,!0,!1,!1),t.register(Ft,at[Ft],33,!1,!0,!1,!1),t.register(Pt,at[Pt],34,!1,!0,!1,!1),t.register(Bt,at[Bt],37,e,!0,!1,i),t.register(Lt,at[Lt],39,e,!0,!1,i),t.register(Gt,at[Gt],38,e,!0,!1,i),t.register(Ut,at[Ut],40,e,!0,!1,i),t.register(Ht,at[Ht],36,!0,!0,!1,!1),t.register(zt,at[zt],35,!0,!0,!1,!1),t.register(Vt,at.copy,67,e,!1,!1,i),t.register(Yt,at.cut,88,e,!1,!1,i),t.register(Zt,at[Zt],86,e,!1,!1,i),t.register(Wt,at.undo,90,e,!1,!1,i),t.register(Qt,at.redo,89,e,!1,!1,i),n&&t.register(Qt,at.redo,90,e,!0,!1,i),t.register(un,at[un]),t.register(sn,at[sn]),t.register(cn,at[cn]),t.register(fn,at[fn]),t.register(ln,at[ln]),t.register(Jt,at[Jt]),t.register(Kt,at[Kt]),t.register(qt,at[qt]),t.register(Xt,at[Xt]),t.register($t,at[$t]),t.register(tn,at[tn]),t.register(nn,at[nn]),t.register(en,at[en]),t.register(rn,at.zoom),t.register(on,at[on]),t.register(an,at[an]),t.register(hn,at[hn]),t.register(dn,at[dn]),t.register(vn,at[vn])},u={256:"bindingPath",4:"comment",2:"formula",16:"sparkline",64:"style",128:"tag",1024:"hyperlink",1:"value"},at[Q]={canUndo:!(mn=".cellEditAction"),execute:me(3)},at[J]={canUndo:!1,execute:me(4)},at[K]={canUndo:!1,execute:me(1)},at[X]={canUndo:!1,execute:me(2)},at[_t]={canUndo:!1,execute:function(t,n){var t,n,t=s(t,n),n=at.VA;return(t=n?n.YA(t):t).YA&&t.YA(),!0}},at[Nt]={canUndo:!1,execute:function(t,n){var t,n,t=s(t,n),n=at.VA;return pe(t=n?n.ZA(t):t,2,!1),!0}},at[kt]={canUndo:!1,execute:function(t,n){var t,n,t=s(t,n),n=at.VA;return pe(t=n?n.WA(t):t,1,!1,!0),!0}},at[gt]={canUndo:!1,execute:function(t,n){var t=s(t,n);return at.UA(t,4,it,t.frozenColumnCount()-1)}},at[q]={canUndo:!1,execute:function(t,n){var t,e,t=s(t,n);return!!(t&&0<(e=t.getSelections()).length)&&at.UA(t,4,it,-1)}},at[bt]={canUndo:!1,execute:function(t,n){var t=s(t,n);return at.UA(t,3,it,st(t)-t.frozenTrailingColumnCount())}},at[$]={canUndo:!1,execute:function(t,n){var t,e,t=s(t,n);return!!(t&&0<(e=t.getSelections()).length)&&at.UA(t,3,it,st(t))}},at[vt]={canUndo:!1,execute:function(t,n){var t=s(t,n);return at.UA(t,2,-1,it)}},at[mt]={canUndo:!1,execute:function(t,n){var t=s(t,n);return at.UA(t,1,ut(t),it)}},at[Ct]={canUndo:!1,execute:function(t,n){var t,n,e,e,i,i,t=s(t,n);if(!t||2===t.Di)return!1;if((n=t.QA())!==it&&n!==t.Tb){if(e=t._y(1,3),(e=t.j5(t.ui-e.length))<n&&(e=n),i=at.VA){if((i=i.KA(t,e,n)).r)return!0;t=i.sheet}if(!t.endEdit())return!1;t.JA(e,t.getActiveColumnIndex())&&(t.XA(e,it),t.qA=e,t.G5()),t.$A(n,0)}return!0}},at[St]={canUndo:!1,execute:function(t,n){var t,n,e,e,i,i,t=s(t,n);if(!t||2===t.Di)return!1;if((n=t.tI())!==it&&n!==t.Tb){if(e=t._y(1,3),(e=t.nI(t.ui+e.length))<n&&(e=n),i=at.VA){if((i=i.eI(t,e,n)).r)return!0;t=i.sheet}if(!t.endEdit())return!1;t.JA(e,t.getActiveColumnIndex())&&(t.XA(e,it),t.qA=e,t.G5()),t.$A(n,0)}return!0}},at[At]={canUndo:!1,execute:function(t,n){var e;ge(s(t,n),!0)}},at[Tt]={canUndo:!1,execute:function(t,n){var e;ge(s(t,n),!1)}},at[pt]={canUndo:!1,execute:function(t,n){var t,n,n,t=s(t,n);if(!t||2===t.Di)return!1;if(n=at.VA){if((n=n.iI(t)).r)return!0;t=n.sheet}return t.G5(5,!1,t.ui,t.ci),!0}},at[yt]={canUndo:!1,execute:function(t,n){var t,n,n,t=s(t,n);if(!t||2===t.Di)return!1;if(n=at.VA){if((n=n.rI(t)).r)return!0;t=n.sheet}return t.G5(6,!1,t.ui,t.ci),!0}},at[un]={canUndo:!1,execute:function(t,n){var t=s(t,n);return!!t.parent&&ye(t,t.parent.nextControl)}},at[sn]={canUndo:!1,execute:function(t,n){var t=s(t,n);return!!t.parent&&ye(t,t.parent.previousControl)}},at[wt]={canUndo:!1,execute:function(t,n){var t,n,t=s(t,n),n=at.VA;return pe(t=n?n.oI(t):t,4,!0),!0}},at[Mt]={canUndo:!1,execute:function(t,n){var t,n,t=s(t,n),n=at.VA;return pe(t=n?n.aI(t):t,3,!0),!0}},at[cn]={canUndo:!1,execute:function(t,n){var e,i,r,o,a,e=s(t,n),i=e.qA,r=e.getActiveColumnIndex();return e.F5=!0,o=e.uI(e.getActiveRowIndex(),r,!0,i),e.F5=!1,((a=!o||o.leadingCellRow<i||o.leadingCellRow===i&&r>o.col)?at[un]:at[wt]).execute(t,n)}},at[fn]={canUndo:!1,execute:function(t,n){var e,i,r,o,a,e=s(t,n),i=e.qA,r=e.getActiveColumnIndex();return e.F5=!0,o=e.sI(e.getActiveRowIndex(),r,!0,i),e.F5=!1,((a=!o||o.leadingCellRow>i||o.leadingCellRow===i&&r<o.col)?at[sn]:at[Mt]).execute(t,n)}},at[Dt]={canUndo:!1,execute:function(t,n){var t,n,e,n,t=s(t,n),n=at.VA;return n&&(e=n.cI(t)),t.isEditing()?!!t.endEdit(!0):et(e)?(at.fI(t.parent),t.bM=it,t.parent.bM.c5(),(n=t).AT&&n.AT(),void(n.ieV&&n.ieV())):e}},at.fI=function(t){var n,t,e,i,r,o;if(t&&(n=t.sheets,t=t.mp.map(function(t){return t.Mf}),e=n.concat(t)))for(i=0,r=e.length;i<r;i++)(o=e[i])&&o.lA&&o.lA.lI()},at[It]={canUndo:!1,execute:function(t,n){var t,n,t=s(t,n);return!t.isEditing()&&(n=t.getSelections(),t.Qy().execute({cmd:on,sheetName:t.name(),ranges:n}))}},at[xt]={canUndo:!1,execute:function(t,n){var e=s(t,n);return!e.isEditing()&&(tt.mt.Qf()?at[It].execute(t,n):(e.Ai=!0,e.startEdit(!0,""),e.Ai=!1),!0)}},at.copy={canUndo:!1,execute:function(t,n){var t,t,t=s(t,n),t=n.copyData=t.eA(n.ignoreClipboard);return n.callback&&n.callback(),!t||rt}},at.cut={canUndo:!1,execute:function(t,n){var t,t,t=s(t,n),t=n.cutData=t.tA(n.ignoreClipboard);return n.callback&&n.callback(),!t||rt}},at[Zt]={canUndo:!1,execute:function(t,n){var e;s(t,n).rA(n)}},at[Et]={canUndo:!1,execute:i(37)},at[jt]={canUndo:!1,execute:i(39)},at[Ot]={canUndo:!1,execute:i(38)},at[Rt]={canUndo:!1,execute:i(40)},at[Bt]={canUndo:!1,execute:i(37,!0)},at[Lt]={canUndo:!1,execute:i(39,!0)},at[Ft]={canUndo:!1,execute:i(33)},at[Pt]={canUndo:!1,execute:i(34)},at[Gt]={canUndo:!1,execute:i(38,!0)},at[Ut]={canUndo:!1,execute:i(40,!0)},at[Ht]={canUndo:!1,execute:i(36,!0)},at[zt]={canUndo:!1,execute:i(35,!0)},at[ln]={canUndo:!1,execute:function(t,n){var t,n,t=s(t,n),n=t&&t.rt;if(n){Wn(t);try{n.hI&&n.hI()}finally{lt(t)}}}},at.undo={canUndo:!1,execute:function(t){var n,t,n;return t&&(t=t.undoManager())&&t.canUndo()&&t.undo(),!0}},at.redo={canUndo:!1,execute:function(t){var n,t,n;return t&&(t=t.undoManager())&&t.canRedo()&&t.redo(),!0}},at[Jt]={canUndo:!0,execute:function(t,n,e){return o(t,pn,n,e)}},at[Kt]={canUndo:!0,execute:function(t,n,e){return o(t,bn,n,e)}},at[qt]={canUndo:!0,execute:function(t,n,e){return o(t,yn,n,e)}},at[Xt]={canUndo:!0,execute:function(t,n,e){return o(t,wn,n,e)}},at[$t]={canUndo:!0,execute:function(t,n,e){return o(t,Mn,n,e)}},at[tn]={canUndo:!0,execute:function(t,n,e){return o(t,Cn,n,e)}},at[nn]={canUndo:!0,execute:function(t,n,e){return o(t,Sn,n,e)}},at[en]={canUndo:!0,execute:function(t,n,e){return o(t,Tn,n,e)}},at.zoom={canUndo:!0,execute:function(t,n,e){return o(t,An,n,e)}},at[on]={canUndo:!0,execute:function(t,n,e){var i,r,i=s(t,n),r=i.getSelections();return i.options.isProtected&&i.ET(r)?(i.jT(13,i.FT()),!1):o(t,xn,n,e)}},at[an]={canUndo:!0,execute:function(t,n,e){return o(t,kn,n,e)}},at[hn]={canUndo:!1,execute:function(t,n){var e,n,i,r,i,o,a,a,e=n.sheetName,n=n.targetIndex,i=t.getSheetPosition(e),r=t.jg(),i=i,o=n,a={sheet:r,sheetName:r.name(),oldIndex:i,newIndex:o,cancel:!1};return t.ki(tt.Events.SheetMoving,a),!a.cancel&&(a=t.changeSheetPosition(e,n),t.ki(tt.Events.SheetMoved,{sheet:r,sheetName:r?r.name():it,oldIndex:i,newIndex:o}),a)}},at[dn]={canUndo:!1,execute:function(t,n){var e,i,r,n,o,a,e=n.sheetName,i=n.targetIndex,r=n.newName,n=n.includeBindingSource,o=t.getSheetFromName(e);return t.ki(tt.Events.SheetChanging,{sheetName:r,propertyName:"insertSheet",cancel:!1,sheetIndex:i,sheetPosition:t.getSheetPosition(r)}),t.ki(tt.Events.ActiveSheetChanging,{oldSheet:o,newSheet:a,cancel:!1}),a=t.clone(e,i,r,n),!et(a)&&(t.ki(tt.Events.SheetChanged,{sheetName:a.name(),propertyName:"insertSheet",sheetIndex:i,sheetPosition:t.getSheetPosition(a.name())}),t.ki(tt.Events.ActiveSheetChanged,{oldSheet:o,newSheet:a}),!0)}},at[vn]={canUndo:!1,execute:function(t,n){for(var t,e,i,r,o,a,u,s,c,c,f,l,h,t=t,e="gc.spread.",i="gc.spread.contextMenu.allSheets",r="sheetTab",o=[],a=t.qv(),s=0;s<a.length;s++)a[s].visible()===nt.SheetTabVisible.visible&&(c=21<a[s].name().length?a[s].name().substr(0,18)+"...":a[s].name(),c={text:c=v.dI(c),name:e+a[s].name(),command:i,workArea:r,itemClass:"",title:a[s].name()},a[s].b2()&&(u=s,c.itemClass="gc-ui-contextmenu-menuitem-all-sheets-select-sheets-background-color"),o.push(c));return f=(0,tt.jf)(t),t.ki(tt.Events.FormulaTextboxActiveSheetChanging,l={oldSheet:f,newSheet:f,needTriggerSheetChange:!0}),h={items:o,mouseEvent:n.mouseEvent,cancel:!1},t.ki(tt.Events.SheetTabAllSheetsListContextMenuOpening,h),!h.cancel&&(t.contextMenu.openAllSheetsListContextMenu(o,t,n.mouseEvent,u),t.ki(tt.Events.SheetTabAllSheetsListContextMenuOpened,h),t.ki(tt.Events.FormulaTextboxActiveSheetChanged,{oldSheet:void 0,newSheet:f}),!0)}},we.prototype.J5=function(){var t,n,e,i,r,o,a,u,s,c,f,l,h,d,v,m,g,p,b,y,w,M,C,S,h,T,T,A,A,t=this,n=t.Z5,e=t.Mf;if(e&&n){if(i=t.W5,r=n.row,o=n.col,a=ct(n),u=ft(n),s=t.Q5,c=!1,-1===r&&(c=!0,r=0,a=ut(e)),-1===o&&(c=!0,o=0,u=st(e)),l=[],0<(64&i))for(d=0;d<u;d++)l[d]=e.vI(-1,d)||it;for(v=0;v<a;v++)for(m=r+v,0<(64&i)&&(f=e.vI(m,-1)||it),g=0;g<u;g++){if(p=void 0,b=o+g,F&&0<(2&i)&&e.getFormulaInformation&&(p=e.getFormulaInformation(m,b,3)).hasFormula)if(p.isArrayFormula){if((y=p.baseRange).row===m&&y.col===b)for(w=y.row,M=y.row+ct(y);w<M;w++)for(C=y.col,S=y.col+ft(y);C<S;C++)t.mI(s,w-r,C-o,p,2)}else t.mI(s,v,g,p.formula,2);!(0<(1&i))||p&&p.hasFormula||t.mI(s,v,g,e.getValue(m,b,3),1),0<(16&i)&&e.getSparkline&&(h=e.getSparkline(m,b),T=it,h&&(et(h.data())&&h.data(h.gI),T=h.data()),h)&&T&&t.mI(s,v,g,h,16),0<(64&i)&&(T=void 0,T=c?e.getActualStyle(m,b,3):(h=e.vI(m,b)||it,e.getCompositeStyle(m,b,3,h,f,l[g])),A=rt,T&&T.toJSON&&(A=JSON.stringify(T.toJSON(3,!0))),t.mI(s,v,g,A,64)),A=e.Ut.pI,0<(4&i)&&A&&t.mI(s,v,g,A.get(m,b),4),0<(128&i)&&t.mI(s,v,g,e.getTag(m,b,3),128),0<(256&i)&&t.mI(s,v,g,e.getBindingPath&&e.getBindingPath(m,b,3),256),0<(1024&i)&&t.mI(s,v,g,e.getHyperlink&&e.getHyperlink(v,g,3),1024)}}},we.prototype.bI=function(){return this.Q5},we.prototype.mI=function(t,n,e,i,r){!et(i)&&t&&(t[n]===rt&&(t[n]=[]),t[n][e]===rt&&(t[n][e]={}),t[n][e][u[r]]=i)},we.prototype.yI=function(t){var n,e,i,r,o,a,u,s,c;if(t)for(e=(n=this).Q5,i=0,r=t.length;i<r;i++)if(o=t[i])for(a=0,u=o.length;a<u;a++)(s=o[a])&&(e[i]||(e[i]=[]),(c=e[i][a])?n.wI(s,c)&&(e[i][a]=rt):e[i][a]=s)},we.prototype.wI=function(t,n){var e,i,r,o,a,e=this.W5,i=[];for(256&e&&i.push(u[256]),4&e&&i.push(u[4]),2&e&&i.push(u[2]),16&e&&i.push(u[16]),64&e&&i.push(u[64]),128&e&&i.push(u[128]),1024&e&&i.push(u[1024]),1&e&&i.push(u[1]),r=0,o=i.length;r<o;r++)if(t[a=i[r]]!==n[a])return!1;return!0},we.prototype.MI=function(){var t,n,e,i,r,o,a,u,s,c,t=this,n=t.Z5.row,e=t.Z5.col,i=t.Q5,r=t.K5;if(!(r&&0<r.length)){for(r=[],n=-1===n?0:n,e=-1===e?0:e,o=0,a=i.length;o<a;o++)if(u=i[o])for(s=0,c=u.length;s<c;s++)u[s]&&r.push({row:o+n,col:s+e});t.K5=r}return r},gn=we,at.CI=gn,at.SI=function(t,n,e,i,r,o,a,u,s,c){t&&(n<0&&(n=0,i=ut(t)),e<0&&(e=0,r=st(t)),t.SI(n,e,i,r,o,a,rt,rt,u,s,c))},at.TI=function(t){return"changes"+t},at.AI=function(t){return t&&(0!==t.length||!b.isEmptyObject(t))},at.lM=function(n){var t,e,e=n.sheetName;return"string"==typeof e?t=[e]:Array.isArray(e)&&(t=e),!!t&&t.every(function(t){var t,t,t=at.TI(t),t=n[t];return t&&0===t.length&&b.isEmptyObject(t)})},at.startTransaction=function(t,n){Me(t,n.sheetName).forEach(function(t){t.Ut.startTransaction()})},at.endTransaction=function(t,e){Me(t,e.sheetName).forEach(function(t){var n=at.TI(t.name());e[n]=t.Ut.endTransaction()})},at.undoTransaction=function(t,e){Me(t,e.sheetName).forEach(function(t){var n=at.TI(t.name());t.Ut.undo(e[n]),t.zw()})},at.II=function(t){t.forEach(function(t){var t=Ce(t);t&&t.Ut.startTransaction()})},at.startTransactionAll=function(t){at.II(t)},at.xI=function(t,i){var r=[];t.forEach(function(t){var t,n,e,t,t=Ce(t);t&&(n=t.name(),e=at.TI(n),t=t.Ut.endTransaction())&&(i[e]=t,r.push(n))}),i.sheetNames=r},at.endTransactionAll=function(t,n){at.xI(t,n)},at.NI=function(t,e){t.forEach(function(t){var t,n,t=Ce(t);t&&(n=at.TI(t.name()),t.Ut.undo(e[n]))})},Se.prototype.execute=function(){},Se.prototype.canExecute=function(){return!0},Se.prototype.canUndo=function(){return!0},Se.prototype.undo=function(){return!0},at.ActionBase=e=Se,n(Ae,_n=e),Ae.prototype.execute=function(){var t,n,e,i,r,o,a,t,u,s,c,f,l,h,d,v,m,g,p,t=this,n=!1;if(t.canExecute()&&(e=t.tT,i=t.Mf,r=e.columns,o=e.rowHeader,a=r&&r.length,i)&&0<a){if(t=t.kI(r),u={sheet:i,sheetName:i.name(),colList:t,header:o,cancel:!1},i.ki(y,u),!0===u.cancel)return n;e.DI=!0,i.Ut.startTransaction(),M(i);try{for(s=2,c=3,f=st(i,o?2:3),i.Ab=e.Ab,l=e.size,h=0;h<a;h++)for(v=(d=r[h]).firstCol,m=d.lastCol,g=v;g<=m;g++)0<=g&&g<f&&(o&&i.getColumnResizable(g,2)&&l!==i.Do(g,2)?(i.setColumnWidth(g,l,2),n=!0):!o&&i.getColumnResizable(g,3)&&l!==i.Do(g,3)&&(i.setColumnWidth(g,l,3),n=!0))}finally{ht(i),b[b.sd]({jS:i.parent}),i.ki(w,{sheet:i,sheetName:i.name(),colList:t,header:e.rowHeader}),lt(i),e[p=at.TI(i.name())]=i.Ut.endTransaction()}i.ow()}return n},Ae.prototype.undo=function(){var t,n,e,i,r,o,a,a,t,u,t=this,n=!1;if(t.canUndo()&&(e=t.tT,i=t.Mf,r=e.columns,o=e.rowHeader,a=r&&r.length,i)&&0<a){if(a=t.kI(r),t={sheet:i,sheetName:i.name(),colList:a,header:o,cancel:!1},i.ki(y,t),!0===t.cancel)return n;M(i);try{u=at.TI(i.name()),i.Ut.undo(e[u]),i.Zw=!0,i.showCell(i.getActiveRowIndex(),i.getActiveColumnIndex(),1,1),n=!0}finally{ht(i),b[b.sd]({jS:i.parent}),i.ki(w,{sheet:i,sheetName:i.name(),colList:a,header:e.rowHeader}),lt(i)}}return n},Ae.prototype.kI=function(t){for(var n,e,i,r,o,a,u,n=[],e=0,i=t.length;e<i;e++)for(o=(r=t[e]).firstCol,a=r.lastCol,u=o;u<=a;u++)n.push(u);return n},Ae.prototype.canUndo=function(){return this.tT.DI},pn=Ae,n(Ie,En=e),Ie.prototype.execute=function(){var t,n,e,i,r,o,t,a,u,s,c,f,l,h,d,v,m,g,p,t=this,n=!1;if(t.canExecute()&&(e=t.Mf,o=(r=(i=t.tT).rows)&&r.length,e)&&0<o){if(t=t._I(r),a={sheet:e,sheetName:e.name(),rowList:t,header:i.columnHeader,cancel:!1},e.ki(N,a),!0===a.cancel)return n;i.DI=!0,e.Ut.startTransaction(),M(e);try{for(u=3,s=1,f=ut(e,(c=i.columnHeader)?1:3),e.Tb=i.Tb,l=i.size,h=0;h<o;h++)for(v=(d=r[h]).firstRow,m=d.lastRow,g=v;g<=m;g++)0<=g&&g<f&&(c&&e.getRowResizable(g,1)&&l!==e._o(g,1)?(e.setRowHeight(g,l,1),n=!0):!c&&e.getRowResizable(g,3)&&l!==e._o(g,3)&&(e.setRowHeight(g,l,3),n=!0))}finally{ht(e),b[b.sd]({jS:e.parent}),e.ki(k,{sheet:e,sheetName:e.name(),rowList:t,header:i.columnHeader}),lt(e),i[p=at.TI(e.name())]=e.Ut.endTransaction()}e.tw()}return n},Ie.prototype.undo=function(){var t,n,e,i,r,o,o,t,a,t=this,n=!1;if(t.canUndo()&&(e=t.Mf,o=(r=(i=t.tT).rows)&&r.length,e)&&0<o){if(o=t._I(r),t={sheet:e,sheetName:e.name(),rowList:o,header:i.columnHeader,cancel:!1},e.ki(N,t),!0===t.cancel)return n;M(e);try{a=at.TI(e.name()),e.Ut.undo(i[a]),e.Ww=!0,e.showCell(e.getActiveRowIndex(),e.getActiveColumnIndex(),1,1),n=!0}finally{ht(e),b[b.sd]({jS:e.parent}),e.ki(k,{sheet:e,sheetName:e.name(),rowList:o,header:i.columnHeader}),lt(e)}}return n},Ie.prototype._I=function(t){for(var n,e,i,r,o,a,u,n=[],e=0,i=t.length;e<i;e++)for(o=(r=t[e]).firstRow,a=r.lastRow,u=o;u<=a;u++)n.push(u);return n},Ie.prototype.canUndo=function(){return this.tT.DI},bn=Ie,n(xe,jn=e),xe.prototype.execute=function(){var t,n,e,i,r,o,a,u,s,c,f,l,h,d,v,t=this,n=!1,e=t.tT,i=t.Mf,r=e.columns,o=e.rowHeader,a=t.kI(r);if(i&&r&&0<r.length){if(u={sheet:i,sheetName:i.Zc,colList:a,header:o,cancel:!1},i.ki(y,u),!0===u.cancel)return n;i.Ut.startTransaction(),t.X5(i);try{s=E(e.size),c=o?2:3,f=r[0].firstCol,d=h=l=void 0,s!==(l=i.Do(f,c))&&(h=s-l,d=i.O5(f,c),i.setColumnWidth(f,s,c),i.setColumnWidth(d,i.Do(d,c)-h,c)),n=!0}finally{ht(i),b[b.sd]({jS:i.parent}),i.ki(w,{sheet:i,sheetName:i.Zc,colList:a,header:e.rowHeader}),lt(i),e[v=at.TI(i.name())]=i.Ut.endTransaction()}}return n},xe.prototype.undo=function(){var t,n,e,i,r,n,r,o,t=this.Mf,n=this.tT.columns,e=!1,i=this.tT,r=this.tT.rowHeader,n=this.kI(n),r={sheet:t,sheetName:t.Zc,colList:n,header:r,cancel:!1};if(t.ki(y,r),!0!==r.cancel){M(t);try{o=at.TI(t.name()),t.Ut.undo(i[o]),e=!0}finally{ht(t),b[b.sd]({jS:t.parent}),t.ki(w,{sheet:t,sheetName:t.Zc,colList:n,header:i.rowHeader}),lt(t)}}return e},xe.prototype.kI=function(t){for(var n,e,i,r,o,a,u,n=[],e=0,i=t.length;e<i;e++)for(o=(r=t[e]).firstCol,a=r.lastCol,u=o;u<=a;u++)n.push(u);return n},yn=xe,n(Ne,On=e),Ne.prototype.execute=function(){var t,n,e,i,r,o,a,u,s,c,f,l,h,d,v,t=this,n=!1,e=t.tT,i=t.Mf,r=e.rows,o=e.columnHeader,a=t._I(r);if(i&&r&&0<r.length){if(u={sheet:i,sheetName:i.Zc,rowList:a,header:o,cancel:!1},i.ki(N,u),!0===u.cancel)return n;i.Ut.startTransaction(),t.X5(i);try{s=E(e.size),c=o?1:3,f=r[0].firstRow,d=h=l=void 0,s!==(l=i._o(f,c))&&(h=s-l,d=i.j5(f,c),i.setRowHeight(f,s,c),i.setRowHeight(d,i._o(d,c)-h,c)),n=!0}finally{ht(i),b[b.sd]({jS:i.parent}),i.ki(k,{sheet:i,sheetName:i.Zc,rowList:a,header:e.columnHeader}),lt(i),e[v=at.TI(i.name())]=i.Ut.endTransaction()}}return n},Ne.prototype.undo=function(){var t,n,e,i,r,n,r,o,t=this.Mf,n=this.tT.rows,e=!1,i=this.tT,r=this.tT.columnHeader,n=this._I(n),r={sheet:t,sheetName:t.Zc,rowList:n,header:r,cancel:!1};if(t.ki(N,r),!0!==r.cancel){M(t);try{o=at.TI(t.name()),t.Ut.undo(i[o]),e=!0}finally{ht(t),b[b.sd]({jS:t.parent}),t.ki(k,{sheet:t,sheetName:t.Zc,rowList:n,header:i.columnHeader}),lt(t)}}return e},Ne.prototype._I=function(t){for(var n,e,i,r,o,a,u,n=[],e=0,i=t.length;e<i;e++)for(o=(r=t[e]).firstRow,a=r.lastRow,u=o;u<=a;u++)n.push(u);return n},wn=Ne,n(r,Rn=e),r.prototype.canExecute=function(){var t=this.tT;return this.Mf&&t.columns&&0<t.columns.length},r.prototype.execute=function(){var t,n,e,i,r,o,a,u,s,c,f,l,h,d,v,m,g,t=this,n=!1;if(t.canExecute()){if(e=t.tT,i=t.Mf,r=t.nT,o=t.kI(e.columns),a=2===r,u={sheet:i,sheetName:i.name(),colList:o,header:a,cancel:!1},i.ki(y,u),!0===u.cancel)return n;for(e.DI=!0,c=(s=st(i,r))-1,l=void(f=0),h=0,d=e.columns.length;h<d;h++)c=(l=e.columns[h].col)<c?l:c,f=f<l?l:f;tt.Be.Ll(i,0,c,ut(i)-1,f),i.Ut.startTransaction(),M(i);try{for(v=void 0,h=0,d=e.columns.length;h<d;h++)0<=(m=e.columns[h].col)&&m<s&&i.getColumnResizable(m,r)&&((v=t.qf(m))===i.getColumnWidth(m,r)&&et(i.getColumnWidth(m,r,!0))||(i.setColumnWidth(m,v,r),n=!0))}finally{tt.Be.dl(),ht(i),b[b.sd]({jS:i.parent}),i.ki(w,{sheet:i,sheetName:i.name(),colList:o,header:a}),lt(i),e[g=at.TI(i.name())]=i.Ut.endTransaction()}}return n},r.prototype.undo=function(){var t,n,e,i,r,t,r,o,a,t=this,n=!1;if(t.canUndo()){if(e=t.tT,i=t.Mf,r=t.nT,t=t.kI(e.columns),r=2===r,o={sheet:i,sheetName:i.name(),colList:t,header:r,cancel:!1},i.ki(y,o),!0===o.cancel)return n;M(i);try{a=at.TI(i.name()),i.Ut.undo(e[a]),n=!0}finally{ht(i),b[b.sd]({jS:i.parent}),i.ki(w,{sheet:i,sheetName:i.name(),colList:t,header:r}),lt(i)}}return n},r.prototype.kI=function(t){for(var n,e,i,n=[],e=0;e<t.length;e++)i=t[e],n.push(i.col);return n},r.prototype.qf=function(t){return tt.mt.qf(t,this.Mf,this.nT,this.tT.autoFitType)},r.prototype.canUndo=function(){return this.tT.DI},Mn=r,n(a,Bn=e),a.prototype.canExecute=function(){var t=this.tT;return this.Mf&&t.rows&&0<t.rows.length},a.prototype.execute=function(){var t,n,e,i,r,o,a,u,s,c,f,l,h,d,t=this,n=!1;if(t.canExecute()){if(e=t.tT,i=t.Mf,r=t._I(e.rows),o=t.nT,a=1===t.nT,u={sheet:i,sheetName:i.name(),rowList:r,header:a,cancel:!1},i.ki(N,u),!0===u.cancel)return n;e.DI=!0,i.Ut.startTransaction(),M(i);try{for(s=ut(i,o),c=void 0,f=0,l=e.rows.length;f<l;f++)0<=(h=e.rows[f].row)&&h<s&&i.getRowResizable(h,o)&&((c=t.e0(h))===i.getRowHeight(h,o)&&et(i.getRowHeight(h,o,!0))||(i.setRowHeight(h,c,o),n=!0))}finally{ht(i),b[b.sd]({jS:i.parent}),i.ki(k,{sheet:i,sheetName:i.name(),rowList:r,header:a}),lt(i),e[d=at.TI(i.name())]=i.Ut.endTransaction()}}return n},a.prototype.undo=function(){var t,n,e,i,r,t,o,a,t=this,n=!1;if(t.canUndo()){if(e=t.tT,i=t.Mf,r=t._I(e.rows),t=1===t.nT,o={sheet:i,sheetName:i.name(),rowList:r,header:t,cancel:!1},i.ki(N,o),!0===o.cancel)return n;M(i);try{a=at.TI(i.name()),i.Ut.undo(e[a]),n=!0}finally{ht(i),b[b.sd]({jS:i.parent}),i.ki(k,{sheet:i,sheetName:i.name(),rowList:r,header:t}),lt(i)}}return n},a.prototype._I=function(t){for(var n,e,i,r,n=[],e=0,i=t.length;e<i;e++)r=t[e],n.push(r.row);return n},a.prototype.e0=function(t){return tt.mt.e0(t,this.Mf,this.nT,this.tT.autoFitType)},a.prototype.canUndo=function(){return this.tT.DI},Cn=a,n(c,Ln=e),c.prototype.canExecute=function(){var t,n,e,i,t,r,o,a,t=this,n=t.Mf,e=t.tT,i=e.ranges,t=e.row,r=e.col;if(i){for(o=0;o<i.length;o++)if(a=i[o],!n.PT(a.row,a.col,ct(a),ft(a),rt,rt,rt,rt,rt,e.sheetArea))return!1}else if(!n.PT(t,r,1,1,rt,rt,rt,rt,rt,e.sheetArea))return!1;return!0},c.prototype.EI=function(t){var n,e,i,r,o,a,u,n,e=this.tT,i=e.ranges;if(i)for(r=0;r<i.length;r++)for(a=(o=i[r]).row;a<o.row+ct(o);a++)for(u=o.col;u<o.col+ft(o);u++)t(a,u);else t(e.row,e.col)},c.prototype.undo=function(){var t,e,t,n,t=this;if(t.canUndo()){e=t.Mf,t=t.tT,M(e,!0);try{e.D3(m+mn,function(t,n){ke(e,n)}),n=at.TI(e.name()),e.Ut.undo(t[n])}catch(t){return!1}finally{e._3(m+mn),p(e,!0)}return!0}return!1},c.prototype.execute=function(){var t,n,e,i,t=this,n=!1;if(t.canExecute()){i=(e=t.Mf).parent.i4(),at.II(i),M(e,!0);try{e.D3(m+mn,function(t,n){ke(e,n)}),t.tT.applyResult=t.jI(),n=!0}catch(t){n=!1}finally{e._3(m+mn),at.xI(i,t.tT),p(e,!0)}}return n},c.prototype.OI=function(t,n){return t+"_"+n},c.prototype.RI=function(t){var n,e,i,r,o,a,u,s,c,r,u,f,r,u,l,n=this,e=0,i=n.Mf,r=n.tT,o=r.row,a=r.col,u=r.sheetArea,s=r.newValue,c=!r.hasOwnProperty("autoFormat")||r.autoFormat;if(F&&!0!==r.ignoreFormula&&(0,tt.kf)(s)){if(i.getDataValidator&&i.getDataValidator(o,a,u)&&""!==(r="="===s[0]?s.substring(1):s)&&r!==i.getFormula(o,a,u)&&(u=i.op())){f=void 0;try{f=u.parse(i.Uw(),r,0<=o?o:0,0<=a?a:0,!0)}catch(t){e=i.GA(o,a)}f&&(r=u.BI(i.Uw(),f,{row:o,col:a}),i.isValid)&&!i.isValid(o,a,r,!1)&&(e=i.GA(o,a))}}else u=n.LI(o,a,s,c,t),(l=!i.isValid||i.isValid(o,a,u,!1))||(e=i.GA(o,a),i.rt.FI=!0);return e},c.prototype.jI=function(){var t,i,n,r,o,e,a,u,s,e,c,f,l,h,d,v,m,g,l,p,b,y,y,l,b,n,d,t=this,i=t.Mf,n=t.tT,r=n.sheetArea,o=n.newValue,e=n.ignoreValidate,a={GI:!1,UI:!1,_autoFormatter:rt,quotePrefix:rt},u=0;if(!0===e||1!==(u=t.RI(a))&&2!==u){if(e=!n.hasOwnProperty("autoFormat")||n.autoFormat,c=0<=(c=n.row)?c:0,f=0<=(f=n.col)?f:0,l=F&&A&&A.Parser,m=i.parent,!(g=i.NMi&&3===r)&&l)if(v=i.op(),l=m&&m.options.allowUserEditFormula,b=!1,"@"!==(p=i.getFormatter(c,f,r))&&l&&v&&!0!==n.ignoreFormula&&(0,tt.kf)(o)){"="===o[0]&&(o=o.substring(1),b=!0);try{if(y={row:c,col:f,sheetArea:r,text:o,isAllow:!0},T.Worksheet.et(i,"applyEditingSetFormula",y),y.isAllow){if(n.ranges&&1===n.endEditType)return d=n.ranges[0],i.setArrayFormula(d.row,d.col,ct(d),ft(d),o,r),u;h=v.parse(i.Uw(),o,c,f,!0)}}catch(t){if(!m||!m.options.allowInvalidFormula)throw i.jT(0,"string"==typeof t?t:t.message),t;o=b?"="+o:o}}else n.ranges&&1===n.endEditType&&(d=n.ranges[0],i.getRange(d.row,d.col,ct(d),ft(d),r).clear(1));h||(o&&"'"===o[0]?t.HI(c,f,!0,a):t.HI(c,f,rt,a),s=t.LI(c,f,o,e,a)),t.EI(function(n,e){if(h)try{var t=v.unparse(i.Uw(r),h,n,e);i.zI(n,e,t,h,rt,r),i.ki(tt.Events.UserFormulaEntered,{sheet:i,sheetName:i.name(),row:n,col:e,isCircularReference:i.VI(n,e),formula:t}),m&&m.options.formulaFormatHint&&(0,I.Pue)(i,m,h,c,f)}catch(t){throw i.jT(0,"string"==typeof t?t:t.message),t}else{try{i.hasFormula&&i.hasFormula(n,e,r)&&i.setFormula(n,e,it,r)}catch(t){throw i.jT(0,"string"==typeof t?t:t.message),t}try{i.YI(n,e,s,r),"string"!=typeof s&&null!==s||T.Worksheet.et(i,"setHyperlinkWhenEditing",{url:s,row:n,col:e,sheetArea:r})}catch(t){i.setValue(n,e,o,r)}}}),l=a.UI,((y=a.GI)||l)&&(n="string"==typeof(b=i.vI(c,f,r)),b&&!n||(d=new C.Style,n&&(d.parentName=b),b=d),y&&(b._autoFormatter=a._autoFormatter),l&&(b.quotePrefix=a.quotePrefix),i.setStyle(c,f,b,r))}return u},c.prototype.canUndo=function(){return 0===this.tT.applyResult},c.prototype.LI=function(t,n,e,i,r){var o,a,o,u,a,t,n,u,e,o=this,a=o.Mf,o=o.tT,u=o.ignoreFormatting,a=a.getActualStyle(t,n),t={},n="string"!=typeof e||u?e:e&&"'"===e[0]?e.substring(1):tt.mt.Xf(a,e,i,t,o.editingFormatter);return r.quotePrefix?(r._autoFormatter=rt,r.GI=!0):(u=t.value,i&&u&&((n===(e=it)||"General"===u.formatString())&&a._autoFormatter||(u.isAuto=!0,e=u),e)&&(r.GI=!0,r._autoFormatter=e)),n},c.prototype.HI=function(t,n,e,i){var r,o,t,n,a,r,o,t=this.Mf.vI(t,n),n="string"==typeof t;t&&!n||(a=new C.Style,n&&(a.parentName=t),t=a),t.quotePrefix!==e&&(i.UI=!0,i.quotePrefix=e)},Sn=c,n(je,Fn=e),je.prototype.canUndo=function(){return!!this.tT.oldName},je.prototype.canExecute=function(){var t,n,t=this,n=t.tT;return t.Mf&&n.name&&n.name!==n.oldName},je.prototype.execute=function(){var t,n,e,i,r,t,o,a,a,u,s,t=this,n=t.Mf,e=t.tT,i=e.name,r=!1;return t.canExecute()&&(t=n.name(),n.ki(tt.Events.SheetNameChanging,a={sheet:n,oldValue:t,newValue:o=i,cancel:!1}),!1===a.cancel)&&(a=n.parent.sheets,at.II(a),u=null,n.parent.options&&n.parent.options.saveChangesForSheet&&Ee(u=_e(n),!0),e.oldName=t,M(n,!0),Jn(n),n.ub(i),De(n),u&&Ee(u,!1),at.xI(a,e),r=!0,e.sheetName=i,Kn(n,!1),p(n,!0),n.ki(tt.Events.SheetNameChanged,s={sheet:n,oldValue:t,newValue:o})),r},je.prototype.undo=function(){var t,n,t,e,i,r,r,o,t=this;return!(!t.canUndo()||(n=t.Mf,e=(t=t.tT).name,i=t.oldName,n.ki(tt.Events.SheetNameChanging,r={sheet:n,oldValue:e,newValue:i,cancel:!1}),!1!==r.cancel)||(M(n,!0),Jn(n),r=at.TI(n.name()),n.Ut.undo(t[r]),De(n),t.sheetName=t.oldName,Kn(n,!1),p(n,!0),n.ki(tt.Events.SheetNameChanged,o={sheet:n,oldValue:e,newValue:i}),0))},Tn=je,n(Oe,Pn=e),Oe.prototype.canExecute=function(){var t=this;return t.Mf&&t.Mf.parent.options.allowUserZoom&&t.Mf.zoom()!==t.tT.zoomFactor},Oe.prototype.execute=function(){var t,n,e,t,i,r,o,t=this,n=t.tT,e=!1;return t.canExecute()&&(i=(t=t.Mf).Ut,r=n.zoomFactor,i.startTransaction(),e=Re(t,r),i.ZI(["zoomChanged",r,n.oldZoomFactor]),n[o=at.TI(t.name())]=t.Ut.endTransaction()),e},Oe.prototype.undo=function(){var t,n,t=this.Mf;if(this.canUndo())return!(!0===t.isEditing()&&!t.endEdit()||(t.suspendPaint(),n=at.TI(t.name()),t.Ut.undo(this.tT[n]),t.resumePaint(),0))},An=Oe,n(ze,Gn=e),ze.prototype.execute=function(){var t,n,e,i,e,r,o,a,e,u,u,t=this;t.canExecute()&&(n=t.Mf,e=t.tT.clearRange,i=n.tables&&n.tables.WI&&n.tables.WI(e.row,e.col,e.rowCount,e.colCount),n.isDirtySuspended()||(t.tT.K5=new gn(n,n.JS(e),3)),i&&0<i.length&&(t.tT.tableNames=i),r=(e=n.JS(e)).row,o=e.col,a=ct(e),0<(e=ft(e)))&&0<a&&(n.Ut.startTransaction(),M(n),n.QI=!0,n.KI(r,o,a,e,3,257,!0),p(n),n.QI=!1,u=at.TI(n.name()),t.tT[u]=n.Ut.endTransaction(),u=t.tT.K5,at.SI(n,r,o,a,e,u?u.MI():[],2,i))},ze.prototype.canExecute=function(){var t=this.tT.clearRange;return this.Mf.PT(t.row,t.col,ct(t),ft(t),rt,rt,rt,rt,rt,nt.SheetArea.viewport)},ze.prototype.canUndo=function(){var t,t,t=at.TI(this.Mf.name()),t=this.tT[t];return at.AI(t)},ze.prototype.undo=function(){var t,n,e,i,i,t=this,n=t.Mf;if(t.canUndo()&&n&&0<ft(e=n.JS(t.tT.clearRange))&&0<ct(e)){M(n),n.QI=!0;try{i=at.TI(n.name()),n.Ut.undo(t.tT[i])}finally{p(n),n.QI=!1}return i=t.tT.K5,at.SI(n,e.row,e.col,ct(e),ft(e),i?i.MI():[],2,t.tT.tableNames,!0),!0}return!1},ze.prototype.toJSON=function(){var t=this;return{sheetName:t.Mf?t.Mf.name():"",command:t.tT}},In=ze,n(Ve,Un=e),Ve.prototype.canExecute=function(){var t,n,e,t=this.tT.cachedActions;if(t){for(n=0;n<t.length;n++)if(!(e=t[n]).canExecute())return!1;return!0}return!1},Ve.prototype.execute=function(){var t,n,t,e,i,t=this;if(t.canExecute()&&(n=t.tT.cachedActions,t=t.Mf,n)){for(M(t,!0),e=0;e<n.length;e++)(i=n[e]).execute();return p(t,!0),!0}return!1},Ve.prototype.canUndo=function(){var t,n,e,t=this.tT.cachedActions;if(t){for(n=0;n<t.length;n++)if(!(e=t[n]).canUndo())return!1;return!0}return!1},Ve.prototype.undo=function(){var t,n,e,i,r,r,t=this,n=t.tT.cachedActions;if(t.canUndo()){for(e=t.Mf,i=n.length-1;0<=i;i--)if(r=n[i],M(e,!0),r=r.undo(),p(e,!0),!r)return!1;return!0}return!1},xn=Ve,at.JI=xn,n(dt,Hn=e),dt.WT=function(t){var n=0;return 0!==t&&1!==t||(n|=1),0!==t&&2!==t||(n|=608),0!==t&&3!==t||(n|=2),0!==t&&4!==t||(n|=609),0!==t&&5!==t||(n|=610),0===t&&(n|=1972),n},dt.prototype.canExecute=function(){var t,n,e,i,r,t,n=this.tT,e=n.pasteExtent,i=e.targetRange,r=e.sourceRange;return n.toSheet.PT(i.row,i.col,ct(i),ft(i),rt,rt,rt,rt,rt,nt.SheetArea.viewport)&&(!e.isCutting||n.fromSheet.PT(r.row,r.col,ct(r),ft(r),rt,rt,rt,rt,it,nt.SheetArea.viewport))},dt.prototype.XI=function(){var t,n,e,i,r,o,n,a,t,t=this,n=t.tT.pasteExtent,e=t.tT.Kh={},i=n.isCutting,r=dt.WT(t.tT.pasteOption),o=n.sourceRange,n=n.targetRange,a=t.tT.fromSheet,t=t.tT.toSheet;a&&o&&i&&!a.isDirtySuspended()&&(e.qI=new gn(a,o,r)),t.isDirtySuspended()||(e.$I=new gn(t,n,r))},dt.prototype.nx=function(){return this.tT.pasteExtent.targetRange},dt.prototype.ex=function(t,n,e,i,r,o){var B,a,u,s,c,o,L,F,P,G,U,H,f,l,h,d,v,m,g,p,b,z,V,Y,Z,y,w,M,C,S,T,W,A,I,x,i,N,k,D,_,E,Q,j,J,O,K,X,y,C,R,p,w,b,E,y,R,c,s,x,C,w,p,B=!1,a=n.row,u=n.col,s=n.rowCount,c=n.colCount,o=r!==o,L=!1,F=!1,P=!1,G=!1,U=Vn(r),H=!1,f=r.o5(),m=r.getRowCount(),g=r.getColumnCount(),p=s,b=c,z=0,V=0,Y=0,Z=0;if(f&&(p-=r.ix(a,p,!0),b-=r.ix(u,b)),y=r.tables&&r.tables.AB(a,u,s,c),M=Fe(e,g),C=Pe(e,m),A=this.bx,I=this.Nse,x=i===nt.InsertShiftCell.right,i=i===nt.InsertShiftCell.down,-1===(N=e.row)&&(N=0),-1===(k=e.col)&&(k=0),-1===(D=e.rowCount)&&(D=m),-1===(_=e.colCount)&&(_=g),E=w=!1,I){if(1<y.length)return r.jT(1,ot().Exp_InsertCopiedCutCellsOnSpanTable),{returnFunc:!0};if(1===y.length){if(S=y[0])if(T=S.Tx,W=S.Sx,x){if(!o&&(W+S.Ky!==D&&(u!==S.iw||D<S.Ky+W)&&!(D<=S.Ky||!t&&u===S.iw&&p%D==0)||!A&&t&&Be(r,e)))return r.jT(1,ot().Exp_InsertCopiedCutCellsOnSpanTable),{returnFunc:!0};u===S.iw&&p%D==0||(w=!0),-1===a&&(E=!(a=0)),u===S.iw&&(S=rt)}else if(i){if(!o&&M&&a<=N&&_>S.iw&&_<S.iw+S.Tx&&(t||b%_!=0))return r.jT(1,ot().Exp_InsertCopiedCutCellsOnSpanTable),{returnFunc:!0};_===T&&0===S.iw&&a!==S.Ky&&(w=!0),-1===u&&(E=!(u=0)),a===S.Ky&&(S=rt)}}else if(t&&(!M||C)&&r.tables&&r.tables.Fue(e))return r.jT(1,ot().Exp_InsertCopiedCutCellsAffectTable),{returnFunc:!0}}if(I&&S&&(Q=S.name()),!w&&!t&&M&&(x&&p%D==0||i&&b%_==0)){if(p%D==(C=y=0)&&b%_!=0?(c=n.colCount=_,f&&(y=r.lT(u,c),n.colCount=c+=y)):p%D!=0&&b%_==0&&(s=n.rowCount=D,f)&&(C=r.lT(a,s,!0),n.rowCount=s+=C),B=!0,x){if(R=!1,j=!S||!I||A||!Pe(n,m),!o){if((a<=e.row&&a+s>=e.row+e.rowCount||E&&-1===e.row)&&(R=!0),k<u&&u<=k+_-1&&N<a&&a<=N+D-1)return r.jT(1,ot().Exp_InsertCopiedCutCells),{returnFunc:!0};if(!R&&e.intersect(a,u,s,g-u))return r.jT(1,ot().Exp_InsertCopiedCutCells),{returnFunc:!0};if(this.rx(r,a,u,s,g-u,Q))return r.jT(1,ot().Exp_InsertCopiedCutCellsOnSpanTable),{returnFunc:!0};if(!j&&S&&D===S.Sx){if(0!==S.Ky)return r.jT(1,ot().Exp_InsertCopiedCutCellsOnSpanTable),{returnFunc:!0};u<k&&(O=c),K=S.Sx}(R&&u<=k&&(!S||M)||!et(O))&&(f?(e.col+=c,e.col=r.O5(e.col-1),V=r.lT(e.col,c),e.colCount+=V):e.col+=et(O)?c:O,P=!0)}if(l=a,d=s,h=g-c,v=c,f&&(h=g-(v=c+(Z=r.ox(g-1,c))+y)),(H=this.ax(r,l,h,d,v))&&!U)return r.jT(1,ot().Exp_InsertCopiedCutCellsNoRange),{returnFunc:!0}}else if(i){if(R=!1,j=!S||!I||A||Fe(n,g),!o){if(u<=k&&k+_<=u+c&&(R=!0),N<a&&a<=N+D-1&&k<u&&u<=k+_-1)return r.jT(1,ot().Exp_InsertCopiedCutCells),{returnFunc:!0};if(!R&&e.intersect(a,u,r.getRowCount()-a,c))return r.jT(1,ot().Exp_InsertCopiedCutCells),{returnFunc:!0};if(this.ux(r,a,u,r.getRowCount()-a,c,Q))return r.jT(1,ot().Exp_InsertCopiedCutCellsOnSpanTable),{returnFunc:!0};if(N<a&&a<N+D||Fe(n,g)&&S&&_>S.iw&&S.iw+T>_&&e.intersect(a,u,r.getRowCount()-a,c))return r.jT(1,ot().Exp_InsertCopiedCutCellsOverlap),{returnFunc:!0};!j&&S&&0<s&&r.getColumnCount()%_==0&&_===T&&0===S.iw&&(X=T),(!S||M)&&R&&a<=N&&(f?(e.row+=s,e.row=r.j5(e.row-1),z=r.lT(e.row,s,!0),e.rowCount+=z):e.row+=s,G=!0)}if(l=r.getRowCount()-s,d=s,h=u,v=c,f&&(l=m-(d=s+(Y=r.ox(m-1,s,!0))+C)),(H=this.ax(r,l,h,d,v))&&!U)return r.jT(1,ot().Exp_InsertCopiedCutCellsNoRange),{returnFunc:!0}}}else if(x){if(w=void 0,l=a,d=p=D,b=!S||!I||A||!Pe(n,m),E=S&&D<=S.Ky,j=b||E,f&&(p+=w=r.lT(a,p),d+=w),y=!1,!o){if(c=(R=N)+D,j&&a!==R&&e.intersect(a,u,p,r.getColumnCount()-u))return r.jT(1,ot().Exp_InsertCopiedCutCells),{returnFunc:!0};if(k<u&&u<=k+_-1&&R<a&&a<=c-1)return r.jT(1,ot().Exp_InsertCopiedCutCells),{returnFunc:!0};if(this.rx(r,a,u,p,r.getColumnCount()-u,Q)||!j&&S&&u<k&&R>=S.Ky&&R<S.Ky+W&&c>S.Ky+W)return r.jT(1,ot().Exp_InsertCopiedCutCellsOnSpanTable),{returnFunc:!0};if(!A&&t&&k<u&&!Ue(r,e)&&He(r,N,k+_,D,u-k-_+(S?S.Tx-(u-S.iw):0)))return r.jT(1,ot().Exp_InsertCopiedCutCellsAffectTable),{returnFunc:!0};if(!b&&S)if(E)K=D;else{if(0!==S.Ky&&u!==S.iw)return r.jT(1,ot().Exp_InsertCopiedCutCellsOnSpanTable),{returnFunc:!0};u===S.iw&&(y=!0),u<k&&R>=S.Ky&&c<=S.Ky+W&&D===S.Sx&&(O=_),K=y?D:S.Sx}}if(o||(a!==N&&-1!==a||!(u<=k)||S&&!y&&!E)&&et(O)||(f?(e.col+=e.colCount,e.col=r.O5(e.col-1),V=r.lT(e.col,e.colCount),e.colCount+=V):e.col=e.col+(et(O)?e.colCount:O),L=!0),h=r.getColumnCount()-e.colCount,v=e.colCount,f&&(Z=r.lT(u,e.colCount),h=g-(v=(s=e.colCount+Z)+r.ox(g-1,s)),L)&&(e.col+=Z),(H=this.ax(r,l,h,d,v))&&!U)return r.jT(1,ot().Exp_InsertCopiedCutCellsNoRange),{returnFunc:!0}}else if(i){if(C=void 0,h=u,v=x=_,j=!S||!I||A||Fe(n,g)||_<=S.iw,f&&(x+=C=r.lT(u,x),v+=C),!j&&S&&M&&(_<T||_<S.iw+T||(!S.showHeader||S.Ky!==a)&&_!==S.iw+T))return r.jT(1,ot().Exp_InsertCopiedCutCellsOnSpanTable),{returnFunc:!0};if(!o){if(S&&M&&S.iw<x&&S.iw+S.Tx!==x&&e.intersect(a,u,r.getRowCount()-a,x))return r.jT(1,ot().Exp_InsertCopiedCutCellsOverlap),{returnFunc:!0};if(M&&j&&u!==k&&e.intersect(a,u,r.getRowCount()-a,x))return r.jT(1,ot().Exp_InsertCopiedCutCells),{returnFunc:!0};if(M&&u!==k&&e.intersect(a,u,r.getRowCount()-a,e.colCount))return r.jT(1,ot().Exp_InsertCopiedCutCells),{returnFunc:!0};if(N<a&&a<=N+D-1&&k<u&&u<=k+x-1)return r.jT(1,ot().Exp_InsertCopiedCutCells),{returnFunc:!0};if(this.ux(r,a,u,r.getRowCount()-a,x,Q))return r.jT(1,ot().Exp_InsertCopiedCutCellsOnSpanTable),{returnFunc:!0};if(!A&&t&&N<a&&!Ue(r,e)&&He(r,N+D,k,a-N-D+(S?S.Sx-(a-S.Ky):0),x))return r.jT(1,ot().Exp_InsertCopiedCutCellsAffectTable),{returnFunc:!0};!j&&S&&(w=D,0<(w=t&&(!M&&e.intersect(S.Ky,0,S.Sx,S.endColumn()+1)||new tt.Range(S.Ky,0,S.Sx,S.endColumn()+1).containsRange(e))?N+D-1-S.endRow():w))&&r.getColumnCount()%x==0&&(!M&&a<N?J=w:x===T&&(X=T))}if(o||et(J)&&(u!==k&&-1!==u||!(a<=N)||S&&!M)||(f?(e.row=e.row+e.rowCount,e.row=r.j5(e.row-1),z=r.lT(e.row,e.rowCount,!0),e.rowCount+=z):e.row=e.row+(et(J)?e.rowCount:J),F=!0),l=m-e.rowCount,d=e.rowCount,f&&(Y=r.lT(a,e.rowCount,!0),l=m-(d=(p=e.rowCount+Y)+r.ox(m-1,p,!0)),F)&&(e.row+=Y),(H=this.ax(r,l,h,d,v))&&!U)return r.jT(1,ot().Exp_InsertCopiedCutCellsNoRange),{returnFunc:!0}}return{changePasteDataRangeCol:L,changePasteDataRangeRow:F,changePasteDataRangeCols:P,changePasteDataRangeRows:G,moveRangeHaveValue:H,returnFunc:!1,selectRange:B,adjustedTableRowCount:K,adjustedTableColCount:X,changePasteDataRangeRowInvisibleCount:z,changePasteDataRangeColInvisibleCount:V,invisibleRowCountInAcRange:Y,invisibleColCountInAcRange:Z}},dt.prototype.fx=function(B,t,n,L,e,i,r,o,a,u,s){var c,f,l,h,d,v,m,g,t,p,b,y,w,F,M,C,S,T,A,I,x,N,P,G,k,D,_,E,j,O,U,R,c=!1,f=!1,l=this.Nse,h=n.o5(),d=n.getColumnCount(),v=-1!==e.col&&e.colCount!==d,m=!1,g=t===nt.InsertShiftCell.right,t=t===nt.InsertShiftCell.down,p=Be(n,new tt.Range(i,r,t?1:o,g?1:a)),b=0;if(l&&p&&(-1===i&&(i=0),-1===r)&&(r=0),p&&(g&&r===p.iw||t&&i===p.Ky)&&(p=rt),B){if(g)if(n.mT(i,r+a,o,n.getColumnCount()-r-a,!0))if(y=p&&e.rowCount>p.Ky&&p.showHeader(),r+a<n.getColumnCount()){if(w=p&&r===p.iw,h)if(F=o,M=a+n.ox(n.getColumnCount()-1,a),i<0)n.moveTo(i,r,i,r+a,o,n.getColumnCount()-r-a,2047,!0);else for(C=i;C<i+F&&C<n.getRowCount();C++)0!==n.getRowHeight(C)&&n.moveTo(C,r,C,r+a,1,n.getColumnCount()-r-M,2047,!0);else l&&p&&!w&&(p.showFooter()||y)?(S=p.endRow(),p.showFooter()&&(b=S),e.rowCount>S+1&&n.moveTo(S+1,r,S+1,r+e.colCount,e.rowCount-S-1,n.getColumnCount()-r-e.colCount,2047,!0)):n.moveTo(i,r,i,r+a,o,n.getColumnCount()-r-a,2047,!0);this.lx(n,i,r,i,r+a),(A=(T=n.rowFilter())&&T.range)&&-1===i&&1<A.colCount&&r>A.col&&r<=A.col+A.colCount-1&&(A.colCount=A.colCount+e.colCount),l&&p&&(w||e.rowCount!==p.Sx&&!Pe(e,n.getRowCount())||(p.showFooter()||y?(p.insertColumns(r-p.iw,e.colCount),m=!0):p.K5t(new tt.Range(p.Ky,p.iw,p.Sx,p.Tx+a))))}else r+a>n.getColumnCount()&&(f=c=!0);else f=c=!0;else if(t)if(n.mT(i+o,r,n.getRowCount()-i-o,a,!0))if(i+o<n.getRowCount()){if(I=0,l&&p&&(N=(x=p.dataRange()).col+x.colCount,(P=i===p.Ky)||(I=o,0<(I=s&&e.row>=p.startRow()&&e.row<=p.endRow()?e.row+e.rowCount-1-p.endRow():I)&&(u=p.footerIndex())),!s&&v&&d%e.colCount==0||!v&&!Le(n,{row:e.row,col:N,rowCount:e.rowCount,colCount:e.colCount-N})||(m=!0)),h)if(G=a,k=o+n.ox(n.getRowCount()-1,o,!0),r<0)n.moveTo(i,r,i+o,r,n.getRowCount()-i-k,e.colCount,2047,!0);else for(D=r;D<r+G&&D<n.getColumnCount();D++)0!==n.getColumnWidth(D)&&n.moveTo(i,D,i+o,D,n.getRowCount()-i-k,1,2047,!0);else _=0<I,et(u)||-1===u?(_&&p.K5t(new tt.Range(p.Ky,p.iw,p.Sx+I,p.Tx)),n.moveTo(i,r,i+o,r,n.getRowCount()-i-o,a,2047,!0)):(n.moveTo(u+1,r,u+1+o,r,n.getRowCount()-u-1-o,a,2047,!0),_&&p.K5t(new tt.Range(p.Ky,p.iw,p.Sx+I,p.Tx)),0<(E=u+I-i-o)&&n.moveTo(i,r,i+o,r,E,a,2047,!0));this.lx(n,i,r,i+o,r)}else i+o>n.getRowCount()&&(f=c=!0);else f=c=!0}else if(g)if(n.mT(i,r+e.colCount,e.rowCount,n.getColumnCount()-r-e.colCount,!0))if(r+e.colCount<n.getColumnCount()){if(w=p&&r===p.iw,y=p&&e.rowCount>p.Ky&&p.showHeader(),h)if(j=e.rowCount,M=(O=e.colCount+n.lT(r,e.colCount))+n.ox(n.getColumnCount()-1,O),i<0)n.moveTo(i,r,i,r+O,e.rowCount,n.getColumnCount()-r-M,2047,!0);else for(C=i;C<i+j&&C<n.getRowCount();C++)0===n.getRowHeight(C)?j++:n.moveTo(C,r,C,r+O,1,n.getColumnCount()-r-M,2047,!0);else l&&!s&&p&&!w&&(p.showFooter()||y)?(S=p.endRow(),p.showFooter()&&(b=S),e.rowCount>S+1&&n.moveTo(S+1,r,S+1,r+e.colCount,e.rowCount-S-1,n.getColumnCount()-r-e.colCount,2047,!0)):n.moveTo(i,r,i,r+e.colCount,e.rowCount,n.getColumnCount()-r-e.colCount,2047,!0);this.lx(n,i,r,i,r+e.colCount),(A=(T=n.rowFilter())&&T.range)&&-1===i&&1<A.colCount&&r>A.col&&r<=A.col+A.colCount-1&&(A.colCount=A.colCount+e.colCount),l&&p&&e.rowCount>p.Ky&&(w||e.rowCount!==p.Sx&&!Pe(e,n.getRowCount())||(s||!p.showFooter()&&!y?p.K5t(new tt.Range(p.Ky,p.iw,p.Sx,p.Tx+e.colCount)):(p.insertColumns(r-p.iw,e.colCount),m=!0)))}else r+e.colCount>n.getColumnCount()&&(f=c=!0);else f=c=!0;else if(t)if(n.mT(i+e.rowCount,r,n.getRowCount()-i-e.rowCount,e.colCount,!0))if(i+e.rowCount<n.getRowCount()){if(I=0,l&&p&&e.colCount>p.iw&&(N=(x=p.dataRange()).col+x.colCount,(P=i===p.Ky)||(I=e.rowCount,0<(I=s&&(!v&&e.intersect(p.Ky,0,p.Sx,p.endColumn()+1)||new tt.Range(p.Ky,0,p.Sx,p.endColumn()+1).containsRange(e))?e.row+e.rowCount-1-p.endRow():I)&&(u=p.footerIndex())),!s&&v&&d%e.colCount==0||!v&&!Le(n,{row:e.row,col:N,rowCount:e.rowCount,colCount:e.colCount-N})||(m=!0)),h)if(U=e.colCount,k=(R=e.rowCount+n.lT(i,e.rowCount,!0))+n.ox(n.getRowCount()-1,R,!0),r<0)n.moveTo(i,r,i+R,r,n.getRowCount()-i-k,e.colCount,2047,!0);else for(D=r;D<r+U&&D<n.getColumnCount();D++)0===n.getColumnWidth(D)?U++:n.moveTo(i,D,i+R,D,n.getRowCount()-i-k,1,2047,!0);else _=0<I,et(u)||-1===u?(_&&p.K5t(new tt.Range(p.Ky,p.iw,p.Sx+I,p.Tx)),n.moveTo(i,r,i+e.rowCount,r,n.getRowCount()-i-e.rowCount,e.colCount,2047,!0)):(n.moveTo(u+1,r,u+1+e.rowCount,r,n.getRowCount()-u-1-e.rowCount,e.colCount,2047,!0),_&&p.K5t(new tt.Range(p.Ky,p.iw,p.Sx+I,p.Tx)),0<(E=u+I-i-e.rowCount)&&n.moveTo(i,r,i+e.rowCount,r,E,e.colCount,2047,!0));this.lx(n,i,r,i+e.rowCount,r)}else i+e.rowCount>n.getRowCount()&&(f=c=!0);else f=c=!0;return{ignoreTableExpand:m,ignoreTableFooterIndex:b,raiseInvalidOperation:c,returnFunc:f}},dt.prototype.lx=function(t,n,e,i,r){t.ki("shiftCellsDown",{row:i,col:r,changedRowCount:i-n,changedColCount:r-e,srcRow:n,srcColumn:e},!0)},dt.prototype.hx=function(t,n,e,i,r,o,a,u){var s,c,f,l,h,s=u.changePasteDataRangeRowInvisibleCount,c=u.changePasteDataRangeColInvisibleCount,f=u.invisibleRowCountInAcRange,l=u.invisibleColCountInAcRange,h=this.tT.pasteExtent.targetRange;t&&(n.colCount-=c,n.col-=n.colCount,n.col-=l,h.colCount-=c),e&&(n.rowCount-=s,n.row-=n.rowCount,n.row-=f,h.rowCount-=s),i&&(n.colCount-=c,n.col-=o,n.col-=l,h.colCount-=c),r&&(n.rowCount-=s,n.row-=a,n.row-=f,h.rowCount-=s),u.changePasteDataRangeRowInvisibleCount=0,u.changePasteDataRangeColInvisibleCount=0,u.invisibleRowCountInAcRange=0,u.invisibleColCountInAcRange=0},dt.prototype.vx=function(t,n){var e=[].concat(n.parent.sheets);return t&&t.NMi&&e.push(t),n&&n!==t&&n.NMi&&e.push(n),e},dt.prototype.Gfe=function(t,n,e,i){var e,i,r,o,a;n&&e&&i!==rt&&(e=n.Ky,i=n.iw,r=n.Sx,o=n.Tx,a={showHeader:n.showHeader(),showFooter:n.showFooter(),useFooterDropDownList:n.useFooterDropDownList(),showResizeHandle:n.showResizeHandle()},t.tables._Qt(n.name(),e,i,r,o,n.style(),a,!0),n.L0())},dt.prototype.execute=function(){var n,t,e,i,B,r,o,a,u,s,c,f,l,h,d,v,L,F,P,m,G,U,H,z,g,p,V,Y,Z,W,b,b,y,b,y,b,w,M,C,S,T,A,I,x,N,k,D,Q,J,K,_,X,E,j,O,R,q,$,g,C,I,T,A,p,k,x,S,n=this;if(n.canExecute()&&(t=n.tT.fromSheet,e=n.tT.toSheet,i=n.tT.pasteExtent,B=n.tT.pasteOption,r=i.sourceRange,o=i.targetRange,a=i.isCutting,!t||!r||t.zT(r.row,r.col,ct(r),ft(r),ut(t),st(t)))&&e&&o&&e.HT(o.row,o.col,ct(o),ft(o),!0)&&!(e.tables&&e.tables.mx(t,r,e,o,a)||e.pivotTables&&e.pivotTables.KYt(r,o,e))){if(f=c=s=u=void 0,t&&(c=t.ST(),u=n.sA,s=n.fA)&&(f=new tt.Range(s.row,s.col,s.rowCount,s.colCount)),v=d=h=l=void 0,n.cA&&(l=n.cA.row,h=n.cA.col,d=n.cA.rowCount,v=n.cA.colCount),F=n.Nse,P=e===t,m=L=void 0,g=Vn(e),p=z=H=U=G=!1,W=Z=Y=V=0,u!==rt&&s){if(P&&a&&u===nt.InsertShiftCell.right&&Pe(s,e.getRowCount())&&(m=Be(e,s))&&(b=Be(e,new tt.Range(l,h,d,v)))&&b.name()===m.name()&&(n.tT.Ufe=m,e.tables.remove(m,1)),(b=this.ex(a,n.cA,s,u,e,t)).returnFunc)return void n.Gfe(e,m,a,u);G=b.changePasteDataRangeCol,U=b.changePasteDataRangeRow,V=b.changePasteDataRangeRowInvisibleCount,Y=b.changePasteDataRangeColInvisibleCount,Z=b.invisibleRowCountInAcRange,W=b.invisibleColCountInAcRange,H=b.changePasteDataRangeCols,z=b.changePasteDataRangeRows,p=b.moveRangeHaveValue,L=b.selectRange,d=n.cA.rowCount,v=n.cA.colCount,o.rowCount+=V,o.colCount+=Y,y=b.adjustedTableRowCount,b=b.adjustedTableColCount,et(y)||(o.row=0,o.rowCount=y),et(b)||(o.col=0,o.colCount=b)}n.XI(),y=n.vx(t,e),at.II(y),Wn(e),Qn(e),b=!(e.QI=!0),M=w=void 0,t&&(Qn(t),t.QI=!0);try{if(g){if((S=C=-1)!==o.row?C=o.row+ct(o):-1===r.row&&(C=ut(t)),A=C-(T=ut(e)),I=T<C,x=ot().Exp_InvalidCopyPasteSize,I&&n.gx(r,o))u===nt.InsertShiftCell.down&&p?e.addRows(T,T-l+A):e.addRows(T,A);else if(p||l+o.rowCount!==T||u!==nt.InsertShiftCell.down){if(p&&u===nt.InsertShiftCell.down)e.addRows(T,T-l+A);else if(I)return b=!0,w=1,M=x,void n.Gfe(e,m,a,u)}else e.addRows(T,T-l+A-f.rowCount);if(-1!==o.col?S=o.col+ft(o):-1===r.col&&(S=st(t)),(k=(N=st(e))<S)&&n.gx(r,o))u===nt.InsertShiftCell.right&&p?e.setColumnCount(S+N-h):e.setColumnCount(S);else if(p||h+o.colCount!==N||u!==nt.InsertShiftCell.right){if(p&&u===nt.InsertShiftCell.right)e.setColumnCount(S+N-h);else if(k)return b=!0,w=1,M=x,void n.Gfe(e,m,a,u)}else e.setColumnCount(S+N-h-f.colCount)}if((b=(D=u!==rt&&this.fx(L,u,e,n.cA,f,l,h,d,v,n.px,a)).raiseInvalidOperation)&&(w=1,M=ot().Exp_InsertCopiedCutCellsNoRange),D.returnFunc)n.Gfe(e,m,a,u);else{if(r&&tt.Be.Ll(t,r.row,r.col,r.row+ct(r)-1,r.col+ft(r)-1),!D.ignoreTableExpand)try{Q={shiftCells:n.bx&&u===nt.InsertShiftCell.down,isCopy:!a,isFirst:!1,isHeaderPaste:n.Nse},J=et(D.ignoreTableFooterIndex)?0:D.ignoreTableFooterIndex,K=new tt.Range(o.row,o.col,o.rowCount-J,o.colCount),e.tables&&e.tables.yx(t,K,r,it,it,it,{shiftInfo:Q})}catch(t){return b=!0,w=6,M=t.message,void n.Gfe(e,m,a,u)}_=s||r,X=a&&u!==rt&&(u===nt.InsertShiftCell.right&&(-1===_.row||_.row===o.row)||u===nt.InsertShiftCell.down&&(-1===_.col||_.col===o.col)),e.QT(t,s||r,e,o,a,i.clipboardText,i.clipboardHtml,i.clipboardImage,B,!i.includeFilteredOutRow,!0===X),a&&u!==rt&&(E=_.row,j=_.col,O=_.rowCount,R=_.colCount,q=o.row,$=o.col,u!==nt.InsertShiftCell.right||-1!==_.row&&_.row!==o.row||(P&&F&&j<$&&Ue(e,o)&&(o.col-=R),t.moveTo(E,j+R,q,j,O,e.getColumnCount()-j-R,2047,!0)),u!==nt.InsertShiftCell.down||-1!==_.col&&_.col!==o.col||(P&&F&&E<q&&Ue(e,o)&&(o.row-=O),t.moveTo(E+O,j,E,$,e.getRowCount()-E-O,R,2047,!0)))}}finally{n.Gfe(e,m,a,u),r&&tt.Be.dl(),ht(e),e.QI=!1,t&&(ht(t),t.QI=!1),lt(e),at.xI(y,n.tT),g=n.tT.Kh,C=dt.WT(B),i.isCutting&&t&&(I=[],t.isDirtySuspended()||((T=new gn(t,r,C)).yI(g.qI.bI()),I=(g.wx=T).MI()),at.SI(t,r.row,r.col,ct(r),ft(r),I,3,rt,rt,u)),e&&(A=[],e.isDirtySuspended()||((p=new gn(e,o,C)).yI(g.$I.bI()),A=(g.Mx=p).MI()),k=e.tables&&e.tables.WI&&e.tables.WI(o.row,o.col,o.rowCount,o.colCount),x=ct(o),S=ft(o),at.SI(e,o.row,o.col,x,S,A,3,k,rt,u),n.tableNamesObj={r:o.row,c:o.col,rc:x,cc:S,tableNames:k}),n.Cx={changePasteDataRangeCol:G,changePasteDataRangeRow:U,changePasteDataRangeCols:H,changePasteDataRangeRows:z,acColCount:v,acRowCount:d,changePasteDataRangeRowInvisibleCount:V,changePasteDataRangeColInvisibleCount:Y,invisibleRowCountInAcRange:Z,invisibleColCountInAcRange:W},c&&delete c.TT,b&&e.jT(w,M)}}},dt.prototype.rx=function(t,n,e,i,r,o){for(var a,u,s,c,f,l,h,d,v,d,m,a=t.Ut.getSpans(),u=t.tables&&t.tables.U3,s=t.pivotTables&&t.pivotTables.all(),c=0;c<a.length;c++)if(!(n<=(f=a[c]).row&&e<=f.col&&n+i>=f.row+f.rowCount&&e+r>=f.col+f.colCount||f.row>n+i||f.row+f.rowCount-1<n||f.row>n+i-1||f.row+f.rowCount-1<n||f.col+f.colCount-1<e))return!0;if(u)for(c=0;c<u.length;c++)if(l=u[c],(et(o)||l.name()!==o)&&!(n<=l.Ky&&e<=l.iw&&n+i>=l.Ky+l.Sx&&e+r>=l.iw+l.Tx||l.Ky>n+i||l.Ky+l.Sx-1<n||l.Ky>n+i-1||l.Ky+l.Sx-1<n||l.iw+l.Tx-1<e))return!0;if(s)for(c=0;c<s.length;c++)if(v=(d=(h=s[c]).getRange()).content,d=d.page,m=void 0,m=!(m=v?Ge(n,e,i,r,v):m)&&d?Ge(n,e,i,r,d):m)return!0;return!1},dt.prototype.ux=function(t,n,e,i,r,o){for(var a,u,s,c,f,l,h,d,v,d,m,a=t.Ut.getSpans(),u=t.tables&&t.tables.U3,s=t.pivotTables&&t.pivotTables.all(),c=0;c<a.length;c++)if(!(n<=(f=a[c]).row&&e<=f.col&&n+i>=f.row+f.rowCount&&e+r>=f.col+f.colCount||f.col>e+r||f.col+f.colCount-1<e||f.col>e+r-1||f.col+f.colCount-1<e||f.row+f.rowCount-1<n))return!0;if(u)for(c=0;c<u.length;c++)if(l=u[c],(et(o)||l.name()!==o)&&!(n<=l.Ky&&e<=l.iw&&n+i>=l.Ky+l.Sx&&e+r>=l.iw+l.Tx||l.iw>e+r||l.iw+l.Tx-1<e||l.iw>e+r-1||l.iw+l.Tx-1<e||l.Ky+l.Sx-1<n||e===l.iw&&r===l.Tx&&n>l.Ky))return!0;if(s)for(c=0;c<s.length;c++)if(v=(d=(h=s[c]).getRange()).content,d=d.page,m=void 0,m=!(m=v?Ge(n,e,i,r,v):m)&&d?Ge(n,e,i,r,d):m)return!0;return!1},dt.prototype.ax=function(t,n,e,i,r){for(var o,a,u,s,c,f,l,h,d,o=t.Ut.getSpans(),a=t.tables.U3,u=n;u<n+i;u++)for(s=e;s<e+r;s++){if(c=t.getCell(u,s),!et(c.value())||c.backColor()||c.comment()||c.tag())return!0;for(f=0;f<o.length;f++)if(u>=(l=o[f]).row&&u<=l.row+l.rowCount-1&&s>=l.col&&s<=l.col+l.colCount-1)return!0;for(h=0;h<a.length;h++)if(u>=(d=a[h]).Ky&&u<=d.Ky+d.Sx-1&&s>=d.iw&&s<=d.iw+d.Tx-1)return!0}return!1},dt.prototype.gx=function(t,n){var e,t,i,n,r,o,a;return!t||(e=t.row,t=t.col,i=n.row,n=n.col,-1!==e&&-1!==t)||(r=-1===e&&-1!==t)&&i<=0||(o=-1===t&&-1!==e)&&n<=0||(a=-1===e&&-1===t)&&i<=0&&n<=0},dt.prototype.undo=function(){var t,n,e,i,r,o,a,a,u,s,c,f,l,h,d,v,m,g,p,b,y,w,M,C,S,T,t=this;if(t.canUndo()){if(n=t.tT.fromSheet,e=t.tT.toSheet,r=(i=t.tT.pasteExtent).sourceRange,o=i.targetRange,!e||!o)return!1;if(t.Cx&&(a=t.Cx,this.hx(a.changePasteDataRangeCol,r,a.changePasteDataRangeRow,a.changePasteDataRangeCols,a.changePasteDataRangeRows,a.acColCount,a.acRowCount,a)),!e.zT(o.row,o.col,ct(o),ft(o),ut(e),st(e)))return!1;if(n&&r){if(!n.zT(r.row,r.col,ct(r),ft(r),ut(n),st(n)))return!1;if(n.name()===e.name()&&e.parent&&!n.NMi&&!z(e.parent.sheets,n))return!1}a=t.tT.Kh,Wn(e);try{u=o.row<0?0:o.row,s=o.col<0?0:o.col,c=o.row<0?ut(e):ct(o),f=o.col<0?st(e):ft(o),l=t.vx(n,e),at.NI(l,t.tT),(d=(h=e.rowFilter())&&h.range)&&-1===o.row&&d.col<o.col&&d.col+d.colCount>=o.col+o.colCount&&(d.colCount=d.colCount-o.colCount),p=g=m=v=0,n&&r&&(v=r.row<0?0:r.row,m=r.col<0?0:r.col,g=r.row<0?ut(n):ct(r),p=r.col<0?st(n):ft(r)),b=[],y=[],(w=t.tableNamesObj)&&(e&&w.r===u&&w.c===s&&w.rc===c&&w.cc===f&&(y=w.tableNames),n)&&w.r===v&&w.c===m&&w.rc===g&&w.cc===p&&(b=w.tableNames),M=t.sA,e&&(C=a.Mx,at.SI(e,u,s,c,f,C?C.MI():[],3,b,!0,M)),i.isCutting&&n&&(S=a.wx,at.SI(n,v,m,g,p,S?S.MI():[],3,y,!0,M)),(T=t.tT.Ufe)&&t.Gfe(e,T,i.isCutting,M)}finally{lt(e)}}return!0},dt.prototype.toJSON=function(){var t=this;return{sheetName:t.Mf?t.Mf.name():"",command:t.tT}},Nn=dt,n(Ye,zn=e),Ye.prototype.execute=function(){var t,n,e,i,r,o,a,u,s,c,f,l,h,d,v,m,g,t=this,n=t.tT,e=n.cachedActions,i=!1;if(t.canExecute()&&e){M(o=(r=t.Mf).parent.jg(),!0);try{for(a=!1,u=0;u<e.length;u++)(s=e[u]).sA=n.sA,s.Nse=n.Nse,s.cA=n.cA,s.fA=n.fA,s.bx=n.bx,s.px=n.px,r?(c=s.tT.pasteExtent,l=(f=t.tT).fromSheet,h=f.fromRanges&&f.fromRanges[u],d=c.clipboardText,v=c.clipboardHtml,!d&&l&&h&&(d=l.bT([h])),!v&&l&&h&&G(r)&&(v=l.MT([h])),m={sheet:r,sheetName:r.name(),cellRange:s.nx(),pasteOption:s.tT.pasteOption,pasteData:{text:d,html:v},shiftCells:n.sA,fromSheet:l,fromRange:h,isCutting:!!f.isCutting,cancel:!1,action:f.isCutting?nt.ClipboardActionType.cut:nt.ClipboardActionType.copy},(g=c.clipboardImage)&&(m.pasteData.image=g),r.ki(tt.Events.ClipboardPasting,m),m.cancel||(i=s.execute(),delete m.cancel,a=!0,r.ki(tt.Events.ClipboardPasted,m))):i=s.execute();a&&t.Ax()}finally{p(o,!0)}}return i},Ye.prototype.Ax=function(){var t,n,e,i,t,r,o,a,u,s,c,a,t=this,n=t.tT,e=n.cachedActions,i=t.Mf;if(i&&e){if(t=i.getSelections(),r=[],o=i.parent,i.IA(),n.hT)a=n.pastedRanges[0],i.n4(a.row,a.col,ct(a),ft(a));else if(1<e.length)for(u=0;u<e.length;u++)c=(s=e[u]).nx(),i.n4(c.row,c.col,ct(c),ft(c));else 0<e.length&&(a=e[0].nx(),i.n4(a.row,a.col,ct(a),ft(a)),a.contains(i.ui,i.ci)||i.XA(a.row,a.col));r=i.getSelections(),i.EA(t,r)&&i.jA(t),o&&n.Z3&&o.changeSelectionInCommandExecuting(n,null,null,r)}},Ye.prototype.canExecute=function(){var t,n,e,t=this.tT.cachedActions;if(t){for(n=0;n<t.length;n++)if(!(e=t[n]).canExecute())return!1;return!0}return!1},Ye.prototype.canUndo=function(){var t,n,e,t=this.tT.cachedActions;if(t){for(n=0;n<t.length;n++)if(!(e=t[n]).canUndo())return!1;return!0}return!1},Ye.prototype.undo=function(){var t,n,e,t,i,r,t=this,n=t.tT.cachedActions;if(t.canUndo()&&n){e=!0,M(t=t.Mf.parent.jg(),!0);try{for(i=n.length-1;0<=i;i--)r=n[i],e=e&&r.undo()}finally{p(t,!0)}return e}return!1},kn=Ye},"./dist/core/worksheet/worksheet-border.js":function(d,t,n){"use strict";var e,N,i,H,n,z,j,k,v,D,V,Y,E,Z,R,o,W,B,y,w,M,C,L,m,g,p,b,S,T,A,I,i,f,u,F,l,P,O,G,U,Q,J,K,X,q;function r(){}function $(t,n,e,i,r,o,a){var u,s,c,u=Q.call(this)||this,s;return o%2||(t!==e?(n-=.5,i-=.5):(t-=.5,e-=.5)),(c=u).Ix=t,c.xx=n,c.Nx=e,c.Dx=i,c._x=r,c.Ex=o,c.jx=a,u}function a(t,n,e,i,r,o,a,u){var s,c,f,s=J.call(this)||this,c;return o%2||(t!==e?(n-=.5,i-=.5):(t-=.5,e-=.5)),(f=s).Ix=t,f.xx=n,f.Nx=e,f.Dx=i,f._x=r,f.Ex=o,f.Ox=a,f.jx=u,s}function tt(t,n,e,i,r,o,a,u,s){var c,f,c=K.call(this)||this;return o?(--t,--e):(--n,--i),(f=c).Ix=t,f.xx=n,f.Nx=e,f.Dx=i,f._x=r,f.Rx=o,f.Ex=1,f.Bx=a,f.Lx=u,f.jx=s,c}function s(t,n,e,i,r,o,a){var u,s,u=X.call(this)||this,s=u;return s.Ix=t,s.xx=n,s.Nx=e,s.Dx=i,s._x=r,s.Fx=o,s.jx=a,s.Px=new f(s.Ix,s.xx,s.Nx,s.Dx,r,1,a),s.Gx=null,u}function c(t,n,e,i,r,o){var a,u,s,c,a=q.call(this)||this,u=a,s=0,c=0;return t===e&&(s=1),n===i&&(c=1),t!==e&&n!==i?o?(u.Px=new f(t-(s=2),n,e-s,i,r,1,o),u.Gx=new f(t+s,n,e+s,i,r,1,o)):(c=s=2,e<t?(u.Px=new l(t-s,n,e,i-c,r,!1,o),u.Gx=new l(t,n+c,e+s,i,r,!1,o)):(u.Px=new l(t,n+c,e-s,i,r,!0,o),u.Gx=new l(t+s,n,e,i-c,r,!0,o))):(u.Px=new f(t-s,n-c,e-s,i-c,r,1,o),u.Gx=new f(t+s,n+c,e+s,i+c,r,1,o)),u.jx=o,u._x=r,u.Ex=1,a}function _(t,n,e,i,r,o,a){switch(o=o!==z&&o!==j?o:1){case 1:return new f(t,n,e,i,r,1,a);case 2:return new f(t,n,e,i,r,2,a);case 5:return new f(t,n,e,i,r,3,a);case 3:return new u(t,n,e,i,r,1,[3,1],a);case 9:return new u(t,n,e,i,r,1,[8,2,2,2],a);case 4:return new u(t,n,e,i,r,1,[2,2],a);case 11:return new u(t,n,e,i,r,1,[9,3,3,3,3,3],a);case 13:return new F(t,n,e,i,r,t!==e,[11,1,5,1],[10,2,4,2],a);case 10:return new u(t,n,e,i,r,2,[9,3,3,3],a);case 12:return new u(t,n,e,i,r,2,[9,3,3,3,3,3],a);case 8:return new u(t,n,e,i,r,2,[9,3],a);case 7:return new u(t,n,e,i,r,1,[1],a);case 6:return new P(t,n,e,i,r,a)}return j}function x(){}function h(t,n,e,i){var r=this;r.Ux=!1,r.Hx=!1,r.Mf=t,r.nT=i,r.zx=n,r.Vx=e}e=this&&this.__extends||(U=function(t,n){return(U=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(t,n){t.__proto__=n}:function(t,n){for(var e in n)Object.prototype.hasOwnProperty.call(n,e)&&(t[e]=n[e])}))(t,n)},function(t,n){if("function"!=typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function e(){this.constructor=t}U(t,n),t.prototype=null===n?Object.create(n):(e.prototype=n.prototype,new e)}),Object.defineProperty(t,"__esModule",{value:!0}),t.Yx=t.Zx=void 0,N=n("./dist/core/worksheet/style.js"),i=n("./dist/core/util/domUtil.js"),H=n("./dist/core/core.enum.js"),n=n("Common"),z=void 0,j=null,k=Math.sqrt,v=Math.pow,D=Math.min,V=Math.abs,Y=Math.tan,E=Math.floor,Z=Math.PI,R=i.GC$.inherit,o=i.GC$.isEmptyObject,W=n.Common.lt.ht,m=y=0,g=w=1,p=M=2,b=C=3,S=4,T=5,A=6,I=7,r.prototype.Wx=function(t){var n=this;0===t._orientation?(t.Kx&&(n.Nx+=t.Kx),t.Jx&&(n.Ix+=t.Jx)):(t.Kx&&(n.Dx+=t.Kx),t.Jx&&(n.xx+=t.Jx))},r.prototype._e=function(t){var n=this._x||"#9eb6ce",e=this.Ex,i=t.lineWidth,r=t.strokeStyle;i===e&&r===n||(i!==e&&(t.lineWidth=e),r!==n&&(t.strokeStyle=n)),this.Xx(t)},r.prototype.Xx=function(t){var n,e,i,e,i,n=this,e=n.Ix===n.Nx,i=n.xx===n.Dx;e&&i||(e||i?(t.beginPath(),n.qx(t),t.stroke()):(t.save(),e=Math.min(n.Ix,n.Nx),i=Math.min(n.xx,n.Dx),t.rect(e,i,Math.abs(n.Nx-n.Ix),Math.abs(n.Dx-n.xx)),t.clip(),t.beginPath(),n.qx(t),t.stroke(),t.beginPath(),t.restore()))},r.prototype.qx=function(t){var n=this;t.moveTo(n.Ix,n.xx),t.lineTo(n.Nx,n.Dx)},e($,Q=i=r),f=$,e(a,J=i),a.prototype.qx=function(t){var n=this;a.Dn(t,n.Ix,n.xx,n.Nx,n.Dx,n.Ox)},a.Dn=function(t,n,e,i,r,o){var a,u,s,c,f,l,h,d,a=k(v(i-n,2)+v(r-e,2)),s=(i-n)/a,c=(r-e)/a,f=0,l=0;for(o=o&&o.length?o:[4,4];f<a;)f+=h=D(o[l%o.length],a-f),(d=++l%2)&&t.moveTo(n,e),n+=h*s,e+=h*c,d&&t.lineTo(n,e)},u=a,e(tt,K=i),tt.prototype.qx=function(t){var n,e,i,n=this,e=n.Rx?0:1,i=n.Rx?1:0;u.Dn(t,n.Ix-e,n.xx-i,n.Nx-e,n.Dx-i,n.Bx),u.Dn(t,n.Ix,n.xx,n.Nx,n.Dx,n.Lx)},F=tt,e(s,X=i),s.prototype.Xx=function(t){this.Px&&this.Px.Xx(t),this.Gx&&this.Gx.Xx(t)},s.prototype.Wx=function(t){var n=this;n.Gx?(t.Jx&&n.Px&&n.Px.Wx(t),t.Kx&&n.Gx.Wx(t)):n.Px&&n.Px.Wx(t)},s.prototype.$x=function(t){var n,e,t,i,r,o,a,u,s,n=this;t&&t.severX&&t.severY?(e=t.severX||0,t=t.severY||0,e=n.Fx?e:-e,u=(i=parseInt(n.Ix+(n.Nx-n.Ix)/2,10))+e,s=(r=parseInt(n.xx+(n.Dx-n.xx)/2,10))+t,n.Px=new f(n.Ix,n.xx,o=i-e,a=r-t,n._x,1,n.jx),n.Gx=new f(u,s,n.Nx,n.Dx,n._x,1,n.jx)):(n.Px=new f(n.Ix,n.xx,n.Nx,n.Dx,n._x,1,n.jx),n.Gx=null)},l=s,e(c,q=i),c.prototype.Xx=function(t){this.Px.Xx(t),this.Gx.Xx(t)},c.prototype.Wx=function(t){var n=this;t.tN?1===t.tN?n.Px.Wx(t):2===t.tN&&n.Gx.Wx(t):(n.Px.Wx(t),n.Gx.Wx(t))},c.prototype.$x=function(){var t,n,e,t,t=this,n={severX:1,severY:1},e=t.Px,t=t.Gx;e.$x(n),t.$x(n)},P=c,t.Zx=_,x.nN=function(t,n,e){var i,i;return t?n?0!=(i=(i=x.eN)[t.style]-i[n.style])||e?i:(n.level||0)-(t.level||0):1:n?-1:0},x.iN=function(t){if(t){if(t.isGridLine)return 1;if(t.style)return N.LineBorder.YC(t.style)}return 0},x.rN=function(t){return t&&6===t.style},x.oN=function(t){return t&&13===t.style},x.aN=function(t,n){return t&&(!n||0<=x.nN(t.style,n.style))?t:n},x.uN=function(t,n){t&&t.line?t.line.Wx(n):t.Wx&&t.Wx(n)},x.sN=function(t,n,e){return t===n?0:t?n?t.isGridLine?n.isGridLine?0:-1:n.isGridLine?1:x.nN(t.style,n.style,e):1:-1},x.cN=function(t){return t&&t.style&&6===t.style.style},x.fN=function(t,n,e,i){var t;return!(!t.style||6!==t.style.style)||(t=0,(t=(t=(t+=n&&n.style&&6===n.style.style?1:0)+(e&&e.style&&6===e.style.style?1:0))+(i&&i.style&&6===i.style.style?1:0))<2)},x.lN=function(t,n,e,i,r,o){var o,e,i,o={_orientation:o?1:0,Jx:0,Kx:0},e=this.sN(t,e),i=this.sN(t,i);0<=e&&0<=i?0===e&&0===i?-1!==r&&1===r&&(o.Kx-=r):-1===r?o.Jx-=r:1===r&&(o.Kx-=2*r):0<=i?(o.tN=2,o.Jx+=r):0<=e&&(o.tN=1,o.Jx+=r),this.uN(t,o)},x.hN=function(t,n,e,i,r,o,a,u,s){var c,u,s,f,l,h,d,d,h,v,o,d,h,i,c={_orientation:u?1:0,tN:s?2:1,Jx:0,Kx:0},u={_orientation:u?1:0,tN:s?1:2,Jx:0,Kx:0},s=1===o?i:r,f=1===a?e:n,l;this.cN(f)?0===(h=this.sN(t,s))?0===(d=this.sN(t,f))?1===a&&(u.Kx-=a):0<d&&(-1===a?u.Jx-=2*a:1===a&&(u.Kx-=2*a)):0<h?0===(d=this.sN(t,f))?1===a&&(u.Kx-=a):0<d&&(-1===a?u.Jx-=2*a:1===a&&(u.Kx-=2*a)):0===(h=this.sN(t,f))?-1===a?c.Jx+=2*a:1===a&&(c.Kx+=2*a):0<h&&(-1===a?c.Jx-=3*a:1===a&&(c.Kx-=3*a)):0<=this.sN(t,s)?-1===a?u.Jx-=2*a:1===a&&(u.Kx-=2*a):-1===a?c.Jx+=2*a:1===a&&(c.Kx+=2*a),d=!1,h=0,this.cN(o=1==(v=1===o?2:1)?i:r)&&0<this.sN(o,t)&&(d=!0,i=x.iN(o),0<this.sN(o,s)?0<i&&(h=1===a&&this.cN(e)?2<=i?2:1:-1===a&&this.cN(n)?3<=i?2:1:3===i?3:2):h=3===i?3:2),d||this.cN(f)||!(f&&!f.isGridLine||o&&!o.isGridLine)||(d=!0,h=-1===a?2:1),d&&(-1===a?(c.Jx+=a*h,u.Jx+=a*h):1===a&&(c.Kx+=a*h,u.Kx+=a*h)),(c.Jx||c.Kx)&&this.uN(t,c),(u.Jx||u.Kx)&&this.uN(t,u)},x.dN=function(t,n,e,i,r,o){var e;0<=this.sN(t,e)&&0<=this.sN(t,i)&&(e={_orientation:o?1:0,Jx:0,Kx:0},-1===r?(e.Jx-=2*r,this.cN(t)&&0<this.sN(n,t)&&--e.Jx):1===r&&(e.Kx-=2*r,this.cN(t))&&0<this.sN(n,t)&&(e.Kx+=1),this.uN(t,e))},x.vN=function(t,n,e,i,r,o){var e,i,e;this.cN(t)&&(e=this.aN(e,i))&&!e.isGridLine&&0<(i=x.iN(e))&&(e={_orientation:o?1:0,Jx:0,Kx:0},-1===r?e.Jx+=i*r:e.Kx+=i*r,e.Jx||e.Kx)&&this.uN(t,e)},x.mN=function(t,n,e,i,r,o,a){var u,s,c,f,e,c=x;(n||e||i)&&(f=c.aN(e,i),c.fN(t,n,e,i)?0<(s=c.sN(f,t,!0))?(u=c.iN(f),c.cN(t)&&(c.cN(e)||c.cN(i)||c.cN(n))||3===u&&c.uN(t,{_orientation:0,Jx:1})):f&&s<0?0<(s=c.sN(t,n,!0))?3===(u=c.iN(f))||2===u?c.uN(t,{_orientation:0,Jx:-2}):1===u&&c.uN(t,{_orientation:0,Jx:-1}):0!==s&&0<c.sN(n,f,!0)&&3===(u=c.iN(f))&&c.uN(t,{_orientation:0,Jx:1}):0===s&&(!n||0<c.sN(t,n,!0))&&(3===(u=c.iN(f))||2===u?c.uN(t,{_orientation:0,Jx:-2}):1===u&&c.uN(t,{_orientation:0,Jx:-1})):c.uN(t,{_orientation:0,Jx:1})),(r||o||a)&&(e=c.aN(o,a),c.fN(t,r,o,a)?0<(s=c.sN(e,t,!0))?(u=c.iN(e),c.cN(t)&&(c.cN(o)||c.cN(a)||c.cN(r))||(3===u?c.uN(t,{_orientation:0,Kx:-2}):2!==u&&1!==u||c.uN(t,{_orientation:0,Kx:-1}))):s<=0&&(0<(s=c.sN(t,r,!0))?3===(u=c.iN(e))&&c.uN(t,{_orientation:0,Kx:1}):0!==s&&c.uN(t,{_orientation:0,Kx:-1})):c.uN(t,{_orientation:0,Kx:-2}))},x.gN=function(t,n,e,i,r,o,a){var u,s,c,f,e,c=x;(n||e||i)&&(f=c.aN(e,i),s=c.sN(f,t,!0),c.fN(t,n,e,i)?0<s?(u=c.iN(f),c.cN(t)&&(c.cN(e)||c.cN(i)||c.cN(n))||3===u&&c.uN(t,{_orientation:1,Jx:1})):s<0?0<(s=c.sN(t,n,!0))?3===(u=c.iN(f))||2===u?c.uN(t,{_orientation:1,Jx:-2}):1===u&&c.uN(t,{_orientation:1,Jx:-1}):0!==s&&0<c.sN(n,f,!0)&&3===(u=c.iN(f))&&c.uN(t,{_orientation:1,Jx:1}):0===s&&0<c.sN(t,n,!0)&&(3===(u=c.iN(f))||2===u?c.uN(t,{_orientation:1,Jx:-2}):1===u&&c.uN(t,{_orientation:1,Jx:-1})):c.uN(t,{_orientation:1,Jx:1})),(r||o||a)&&(e=c.aN(o,a),s=c.sN(t,e,!0),c.fN(t,r,o,a)?s<0?(u=c.iN(e),c.cN(t)&&(c.cN(o)||c.cN(a)||c.cN(r))||(3===u||2===u?c.uN(t,{_orientation:1,Kx:-2}):1===u&&c.uN(t,{_orientation:1,Kx:-1}))):e!==j&&0<=s&&(0<(s=c.sN(t,r,!0))?3===(u=c.iN(e))&&c.uN(t,{_orientation:1,Kx:1}):0!==s&&c.uN(t,{_orientation:1,Kx:-1})):c.uN(t,{_orientation:1,Kx:-2}))},x.pN=function(t,n,e,i,r,o,a,u){var s,c,f,l,l,s=x;u?this.gN(t,n,e,i,r,o,a):this.mN(t,n,e,i,r,o,a),c=s.cN(e),f=s.cN(i),l=s.cN(n),c&&f&&l?s.lN(t,n,e,i,-1,u):c&&!f?s.hN(t,n,r,e,i,1,-1,u,!0):!c&&f?s.hN(t,n,r,e,i,2,-1,u,!1):c&&f&&!l?s.dN(t,n,e,i,-1,u):l&&s.vN(t,n,e,i,-1,u),c=s.cN(o),f=s.cN(a),l=s.cN(r),c&&f&&l?s.lN(t,r,o,a,1,u):c&&!f?s.hN(t,n,r,o,a,1,1,u,!0):!c&&f?s.hN(t,n,r,o,a,2,1,u,!1):c&&f&&!l?s.dN(t,r,o,a,1,u):l&&s.vN(t,r,o,a,1,u)},x.eN=[0,101,199,100,100,300,90,100,198,100,198,100,198,198],x.bN=function(t,n){return!(!t||!n||t.color!==n.color||t.level!==n.level||t.style!==n.style)},O=x,h.prototype.yN=function(){var t,n,e,i,r,o,a,u,s,c,f,t=this;if(t.wN=[],t.MN=[],t.CN=[],t.SN=[],t.TN=[],t.AN={},t.IN={},t.xN={},t.NN={},t.kN={},t.DN={},t._N={},n=t.zx,e=t.Vx,n&&0<n.length&&e&&0<e.length){for(i=t.MN,r=n.length,o=void 0,a=0;a<r;a++)0<(o=n[a]).height&&i.push(o.row);for(i.push(i[i.length-1]+1),u=t.CN,s=e.length,c=void 0,f=0;f<s;f++)0<(c=e[f]).width&&u.push(c.col);u.push(u[u.length-1]+1)}t.Ux=!0},h.prototype.EN=function(t,n,e,i,r,o,a,u){var t;e&&(t={Ky:t,iw:n,jN:e.startColumn,ON:e.endColumn,RN:i,_x:r,_y:o,YC:a,ZC:u},this.SN.push(t))},h.prototype.PN=function(t,n,e,i,r,o,a,u,s,c,f){var l,u,h,d,v,m,g,p,b,y,w,l=this;l.Ux||l.yN(),u?l.wN.push(u):(w=y=b=p=g=m=v=d=h=u=void 0,a&&(u=a.borderLeft,h=a.borderTop,d=a.borderRight,v=a.borderBottom,w=a.backColor,f&&2===f.columnHeaderFitMode||(m=a.diagonalDown,g=a.diagonalUp),f&&f.sheetArea!==z&&3!==f.sheetArea||(p=a.textOrientation),b=a.isVerticalText,y=a.textIndent),!w||u||d||h||v||l.TN.push({r:t,c:n,rc:1,cc:1}),l.GN(t,n,e,i,r,o,u,h,d,v,m,g,w,!1,!1,s,c,p,b,y&&0!==y,f))},h.prototype.GN=function(t,n,e,i,r,o,a,u,s,c,f,l,h,d,v,B,L,m,g,p,b){var y,w,M,C,S,F,P,T,A,I,x,g,p,N,k,D,_,E,j,O,R,M,M,I,G,U,y=this,w=y.Mf,M=w.Jt,C=!1,S=!1,F=!1,P=!1,T=function(t){return t!==z&&t&&-90<=t&&t<=90},A=T(m),I=a||u||s||c,D=0,_=0,E=e,j=r;n+1<w.getColumnCount()&&(O=M.qt(t,n+1)),0<=n-1&&(R=M.qt(t,n-1)),M=A&&!g&&!p&&b&&b.data,I&&(M&&(N=V(m*Z/180),k=Y(N),D=Math.floor(o/k),-90<m&&m<0&&(E=e-D),0<m)&&m<90&&(E=e+D),A||(O&&T(O.textOrientation)&&(N=V(O.textOrientation*Z/180),k=Y(N),_=Math.floor(o/k),0<O.textOrientation&&O.textOrientation<90&&(j=r+_),O.textOrientation<0)&&-90<O.textOrientation&&(j=r-_),R&&T(R.textOrientation)&&(N=V(R.textOrientation*Z/180),k=Y(N),_=Math.floor(o/k),-90<R.textOrientation&&R.textOrientation<0&&(j+=_,E=e-_),0<R.textOrientation)&&R.textOrientation<90&&(j-=_,E=e+_))),f&&!A&&y.UN(t,n,e-1,i-1,e+r,i+o,f,y.kN),l&&!A&&y.UN(t,n,e+r,i-1,e-1,i+o,l,y.DN),u&&0<o&&(C=y.UN(t,n,E,i-.5,E+j,i-.5,u,y.xN,A)),a&&0<j&&(S=y.UN(t,n,E-.5,i,e-.5,i+o,a,y.NN,A)),s&&0<j&&(P=b&&b.columnHeaderFitMode===H.ColumnHeaderFitMode.stack&&!W(b.cornerX)?(x=b.cornerX,g=b.cornerY,y.UN(t,n+1,E+j-.5,i,e+r-.5,i+(p=g-i),s,y.NN,A,{isMultiLine:!0,multiLinePart:"topVertical"}),y.UN(t,n+1,x,i+p-.5,e+r-.5,i+p-.5,s,y.xN,A,{isMultiLine:!0,multiLinePart:"horizontal"}),y.UN(t,n+1,x-.5,g,x-.5,i+o,s,y.NN,A,{isMultiLine:!0,multiLinePart:"bottomVertical"})):y.UN(t,n+1,E+j-.5,i,e+r-.5,i+o,s,y.NN,A)),c&&0<o&&(F=b&&b.columnHeaderFitMode===H.ColumnHeaderFitMode.stack&&!W(b.cornerX)?(x=b.cornerX,y.UN(t+1,n,e,i+o-.5,x,i+o-.5,c,y.xN,A)):y.UN(t+1,n,e,i+o-.5,e+r,i+o-.5,c,y.xN,A)),h&&0!==w.Jt.Gt(t)&&0!==w.Jt.Kt(n)||(I=!P&&!v,((M=!F&&!d)||I||(G=!C&&!d)||(U=!S&&!v))&&y.HN(t,n,e,i,r,o,M,I,B,L)),!C&&!h||A||y.zN(t-1,n,y.AN),(S||h)&&y.zN(t,n-1,y.IN),!h||a||s||u||c||(y.VN(t-1,n-1,y.IN,!1),y.VN(t-1,n-1,y.AN,!0))},h.prototype.UN=function(t,n,e,i,r,o,a,u,s,c){var f,l,c,h,h;return!!a&&(l=f=void 0,c&&(f=c.isMultiLine,l=c.multiLinePart),(c=this.YN(t,n,u,!0))?f?((h=_(e,i,r,o,a.color,a.style,s)).multiLinePart=l,c.splitLines||(c.splitLines=[]),"horizontal"===l&&(c.line=h),c.splitLines.push(h)):s||6!==c.style.style&&(6===a.style||0<O.nN(a,c.style))?(c.line=_(e,i,r,o,a.color,a.style,s),c.style=a):c.line&&!c.splitLines&&o-i!=c.line.Dx-c.line.xx&&(c.line.Dx=o,c.line.xx=i):(h=_(e,i,r,o,a.color,a.style,s))&&((c=this.YN(t,n,u)).line=h,c.style=a,f)&&(c.line.multiLinePart=l,c.splitLines=[c.line]),c)&&c.line!==j},h.prototype.HN=function(t,n,e,i,r,o,a,u,s,c){var f,l,h,l,a,a,s,a,f=this,l=3===f.nT,h=f.Mf.options.gridline;l&&h&&(l=h.color,h.showHorizontalGridline&&(a&&((a=f.YN(t,n,f.AN)).isGridLine=!0,a.line=_(e,i+o-.5,e+r,i+o-.5,l)),s)&&((a=f.YN(-1,n,f.AN,!1,!0)).isGridLine=!0,a.line=_(e,i-.5,e+r,i-.5,l)),h.showVerticalGridline)&&(u&&((s=f.YN(t,n,f.IN)).isGridLine=!0,s.line=_(e+r-.5,i,e+r-.5,i+o,l)),c)&&((a=f.YN(t,-1,f.IN,!1,!0)).isGridLine=!0,a.line=_(e-.5,i,e-.5,i+o,l))},h.prototype.VN=function(t,n,e,i){var t,r,t=this.YN(t,n,e,!0);t&&t.line&&t.line.Wx({_orientation:i?0:1,Kx:-1})},h.prototype.zN=function(t,n,e){var e,i;(0<=t&&0<=n||0===t&&-1===n||-1===t&&0===n)&&(e=e[t])&&(i=e[n])&&delete e[n]},h.prototype.YN=function(t,n,e,i,r){var r,e;if(!r&&(-1===t||-1===n))return j;if(!(r=e[t])){if(i)return j;e[t]=r={}}if(!(e=r[n])){if(i)return j;r[n]=e={}}return e},h.prototype.ZN=function(){for(var t,n,e,i,r,o,a,u,s,c,f,l,h,d,v,m,g,s,p,b,y,h,w,M,w,f,C,S,T,A,I,x,N,k,D,t=this,n=t.SN,e=n.length,i=t.NN,r=t.xN,o=t.IN,a=t.AN,u=0;u<e;u++)if(c=(s=n[u]).Ky,f=s.iw,l=s.jN,h=s.RN,d=s.ON,m=s._x,g=s.YC,s=s.ZC,p=m,b=v=void 0,y=h.textOrientation,h=h.borderTop,!(w=n[u-1])||w.Ky!==c||w.jN!==l||w.ON!==d){for(M=l;M<d;M++)(v=t.YN(c,M+1,i,!0))&&!y?t.zN(c,M+1,i):(v=t.YN(c,M,o,!0))&&t.zN(c,M,o);if(w=t.YN(c,f,r,!0),y&&h&&!w)for(f=void 0,f=s/Math.tan(Math.abs(y*Math.PI/180)),-90<y&&y<0&&(p=m-f),b=(p=0<y&&y<90?m+f:p)+g,C=l;C<d+1;C++)if(T=(S=t.YN(c-1,C,a,!0))&&S.line)for(S.splitLines||(S.splitLines=[],S.splitLines.push(T)),A=0;A<S.splitLines.length;A++)if(x=(I=S.splitLines[A]).Ix,N=I.Nx,k=I.xx,D=I.Dx,x<p&&N<b&&p<N)I.Nx=p;else if(p<x&&N<b)t.zN(c-1,C,t.AN);else if(p<x&&b<N&&x<b)I.Ix=b;else if(x<p&&b<N){S.splitLines.splice(A,1,_(x,k,p,k,I.color),_(b,D,N,D,I.color));break}}},h.prototype.WN=function(){var t,n,e,i,t=this.wN,n=t.length;if(0<n)for(i=0;i<n;i++)e=t[i],this.QN(e)},h.prototype.KN=function(){var t,n,e,i,r,o,a,u;if(this._N={},0<(n=(t=this.wN).length))for(i=0;i<n;i++)for(e=t[i],r=0;r<e.rowCount;r++)for(o=r+e.row,this._N[o]=this._N[o]||{},a=0;a<e.colCount;a++)u=a+e.col,this._N[o][u]=e},h.prototype.QN=function(t){var n,e,i,r,o,a,u,s,c,f,l,h,d,v,m,g,p,b,y,w,M,C,S,T,A,I,x,N,k,D,n=this,e=t.row,i=t.col,r=t.x,o=t.y,a=t.spanSizeInfo,l=a.styleList[0][0],h=l?l.backColor:j,S=r,T=o,A=null,I=!0,x=null,N=!0;if(1===t.rowCount)for(v=e,g=a.rowSizes[0],d=0;d<t.colCount;d++)b=0===d,w=d===t.colCount-1,m=i+d,p=a.colSizes[d],C=a.styleList[0][d],v===t.row&&m===t.col&&(A=(k=C)&&k.diagonalDown,x=k&&k.diagonalUp),C?(u=C.borderLeft,s=C.borderTop,c=C.borderRight,f=C.borderBottom,I=I&&O.bN(A,C.diagonalDown),N=N&&O.bN(x,C.diagonalUp)):u=s=c=f=j,b?n.GN(v,m,S,T,p,g,u,s,j,f,j,j,h,!1,!0):w?n.GN(v,m,S,T,p,g,j,s,c,f,j,j,h,!1,!1):n.GN(v,m,S,T,p,g,j,s,j,f,j,j,h,!1,!0),S+=p;else if(1===t.colCount)for(m=i,p=a.colSizes[0],d=0;d<t.rowCount;d++)y=0===d,M=d===t.rowCount-1,g=a.rowSizes[d],C=a.styleList[d][0],(v=e+d)===t.row&&m===t.col&&(A=(k=C)&&k.diagonalDown,x=k&&k.diagonalUp),C?(u=C.borderLeft,s=C.borderTop,c=C.borderRight,f=C.borderBottom,I=I&&O.bN(A,C.diagonalDown),N=N&&O.bN(x,C.diagonalUp)):u=s=c=f=j,y?n.GN(v,m,S,T,p,g,u,s,c,j,j,j,h,!0,!1):M?n.GN(v,m,S,T,p,g,u,j,c,f,j,j,h,!1,!1):n.GN(v,m,S,T,p,g,u,j,c,j,j,j,h,!0,!1),T+=g;else for(d=0;d<t.rowCount;d++){for(v=e+d,y=0===d,M=d===t.rowCount-1,g=a.rowSizes[d],D=0;D<t.colCount;D++)m=i+D,b=0===D,w=D===t.colCount-1,p=a.colSizes[D],C=a.styleList[d][D],v===t.row&&m===t.col&&(A=(k=C)&&k.diagonalDown,x=k&&k.diagonalUp),C?(u=C.borderLeft,s=C.borderTop,c=C.borderRight,f=C.borderBottom,I=I&&O.bN(A,C.diagonalDown),N=N&&O.bN(x,C.diagonalUp)):u=s=c=f=j,y?b?n.GN(v,m,S,T,p,g,u,s,j,j,j,j,h,!0,!0):w?n.GN(v,m,S,T,p,g,j,s,c,j,j,j,h,!0,!1):n.GN(v,m,S,T,p,g,j,s,j,j,j,j,h,!0,!0):M?b?n.GN(v,m,S,T,p,g,u,j,j,f,j,j,h,!1,!0):w?n.GN(v,m,S,T,p,g,j,j,c,f,j,j,h,!1,!1):n.GN(v,m,S,T,p,g,j,j,j,f,j,j,h,!1,!0):b?n.GN(v,m,S,T,p,g,u,j,j,j,j,j,h,!0,!0):w&&n.GN(v,m,S,T,p,g,j,j,c,j,j,j,h,!0,!1),S+=p;S=r,T+=g}n.GN(t.row,t.col,t.x,t.y,t.width,t.height,j,j,j,j,A=I?A:null,x=N?x:null,j,!0,!0),!h||u||c||s||f||n.TN.push({r:e,c:i,rc:t.rowCount,cc:t.colCount})},h.prototype.Wx=function(){var t,n,e,i,r,t=this,n=!1,e=!1,i=!1,r=!1;o(t.NN)||(n=!0),o(t.xN)||(e=!0),(n||e)&&(t.JN(),t.XN()),o(t.kN)||(i=!0),o(t.DN)||(r=!0),(i||r)&&t.qN(),0<t.TN.length&&t.$N()},h.prototype.t6=function(t,n,e,i,r){var o,a,o=this,a=this._N[t]?this._N[t][n]:null;if(a)switch(r){case m:return o.n6(t,n,e,i);case g:case p:return o.n6(t,n+a.colCount-1,e,i);case b:case S:return o.n6(t+a.rowCount-1,n+a.colCount-1,e,i);case T:case A:return o.n6(t+a.rowCount-1,n,e,i);case I:return o.n6(t,n,e,i)}return o.n6(t,n,e,i)},h.prototype.qN=function(){for(var t,n,e,i,r,o,a,u,s,c,c,c,c,f,l,c,c,c,c,h,d,v,t=this,n=t.MN,e=t.CN,i=n.length,r=e.length,f={},l={},o=0;o<i;o++)for(u=n[o],a=0;a<r;a++)s=e[a],h=t.YN(u,s,t.kN,!1),d=t.YN(u,s,t.DN,!1),(h||d)&&(O.cN(h)&&O.cN(d)&&(h.line.$x(),d.line.$x()),(c=t.t6(u,s,!(v=[]),f,m))&&c.line&&!c.isGridLine&&t.e6(v=[1,1,2],c,h,!0,1),(c=t.t6(u,s,!1,f,g))&&c.line&&!c.isGridLine&&t.e6(v=[1,1,2],c,d,!0,1),(c=t.t6(u,s,!0,l,I))&&c.line&&!c.isGridLine&&t.e6(v=[1,1,2],c,h,!0,0),(c=t.t6(u,s,!0,l,A))&&c.line&&!c.isGridLine&&t.e6(v=[1,1,2],c,d,!1,0),(c=t.t6(u+1,s,!1,f,T))&&c.line&&!c.isGridLine&&t.e6(v=[-1,-2,-2],c,d,!1,1),(c=t.t6(u+1,s,!1,f,S))&&c.line&&!c.isGridLine&&t.e6(v=[-1,-2,-2],c,h,!1,1),(c=t.t6(u,s+1,!0,l,p))&&c.line&&!c.isGridLine&&t.e6(v=[-1,-2,-2],c,d,!0,0),c=t.t6(u,s+1,!0,l,b))&&c.line&&!c.isGridLine&&t.e6(v=[-1,-2,-2],c,h,!1,0)},h.prototype.e6=function(t,n,e,i,r){var o,a,n,o,t,o=O.cN(n),a=O.oN(n),n=n.line.Ex;o&&(n=3),o=t[(n=a?2:n)-1],e&&e.line&&(t={_orientation:r},i?t.Jx=o:t.Kx=o,e.line.Wx(t))},h.prototype.$N=function(){for(var t,n,e,i,r,o,a,u,s,c,f,l,h,d,v,t=this,n=t.TN,e=n.length,i=0;i<e;i++){for(s=(u=o=(r=n[i]).r)-1,c=(a=r.c)-1,f=a,1<r.rc&&(u+=r.rc-1),1<r.cc&&(f+=r.cc-1),h=l=!1,d=i+1;d<e&&((v=n[d]).c===f+1&&v.r===o&&(h=!0),!(l=v.r===u+1&&v.c===a?!0:l)||!h)&&!(v.r>o+1&&v.c>a+1);d++);l||t.VN(u,c,t.AN,!0),h||t.VN(s,f,t.IN,!1)}},h.prototype.JN=function(){for(var t,n,e,i,r,o,a,u,s,c,f,l,h,d,v,m,g,p,b,y,w,M,C,S,T,A,I,x,N,k,D,_,E,w,t=this,n=t.Mf,e=n.Ut,i=t.MN,r=t.CN,o=i.length,a=r.length,l={},h={},u=0;u<o;u++)for(c=i[u],s=0;s<a;s++){if(f=r[s],A=t.YN(c,f,t.NN,!(T=S=0))){if(A.line&&A.line.jx)continue;S++}else A=t.YN(c,f-1,t.IN,!0);if((I=t.YN(c,f,t.xN,!0))?T++:I=t.YN(c-1,f,t.AN,!0),A||I){if((d=0===u?j:t.n6(i[u-1],f,!0,h))&&d.line&&!d.isGridLine&&(S++,T++),(v=0===s?j:t.n6(c,r[s-1],!1,l))&&v.line&&!v.isGridLine&&(S++,T++),A)for(x=[A],A.splitLines&&0<A.splitLines.length&&(x=A.splitLines),N=0;N<x.length;N++)(k=x[N]).style=A.style,(m=t.n6(c,f,!1,l))&&m.line&&!m.isGridLine&&S++,u!==o-1&&(p=t.n6(i[u+1],f,!0,h))&&p.line&&!p.isGridLine&&S++,0!==s&&u!==o-1&&(b=t.n6(i[u+1],r[s-1],!1,l))&&b.line&&!b.isGridLine&&S++,u!==o-1&&(y=t.n6(i[u+1],f,!1,l))&&y.line&&!y.isGridLine&&S++,0<S&&("topVertical"===k.multiLinePart?(D=e.i6(f,0),_=n.r6(D),2===n.Lt(_)&&(D=n.O5(D)),E=n.O5(f),m=t.n6(c,D,!1,l),p=t.n6(c,E,!0,h),b=k,y=j):"bottomVertical"===k.multiLinePart&&(m=k,p=v=d=j,b=t.n6(i[u+1],r[s-1],!1,l),y=t.n6(i[u+1],r[s],!1,l)),O.rN(A.style)?O.pN(k,d,v,m,p,b,y,!0):O.oN(A.style)||O.gN(k,d,v,m,p,b,y));I&&((g=t.n6(c,f,!0,h))&&g.line&&!g.isGridLine&&T++,s!==a-1&&(w=r[s+1],2===n.Lt(w)&&(w=e.i6(w,0),w=n.O5(w)),w=t.n6(c,w,!1,l))&&w.line&&!w.isGridLine&&T++,0!==u&&s!==a-1&&(M=t.n6(i[u-1],r[s+1],!0,h))&&M.line&&!M.isGridLine&&T++,s!==a-1&&(C=t.n6(c,r[s+1],!0,h))&&C.line&&!C.isGridLine&&T++,0<T)&&(I.line&&"horizontal"===I.line.multiLinePart&&(D=e.i6(f,0),_=n.r6(D),2===n.Lt(_)&&(D=n.O5(D)),w=d=v=j,M=g=I,C=t.n6(c,D,!0,h)),O.rN(I.style)?O.pN(I,v,d,g,w,M,C,!1):O.oN(I.style)||O.mN(I,v,d,g,w,M,C))}}},h.prototype.o6=function(t,n,e,i){var r,o,e,r=this,o=this._N[t]?this._N[t][n]:null,e=e?r.DN:r.kN;return o?t===o.row&&n===o.col&&i===y||t===o.row&&n===o.col+o.colCount-1&&i===w||t===o.row+o.rowCount-1&&n===o.col+o.colCount-1&&i===M||t===o.row+o.rowCount-1&&n===o.col&&i===C?r.YN(o.row,o.col,e,!1):void 0:r.YN(t,n,e,!1)},h.prototype.XN=function(){for(var t,n,e,i,r,o,a,u,s,c,f,l,h,d,v,m,g,p,b,b,t=this,n=t.MN,e=t.CN,i=n.length,r=e.length,o=0;o<i;o++)for(u=n[o],a=0;a<r;a++)s=e[a],(b=t.YN(u,s,t.NN,!0))&&b.line&&b.line._noNeedAdjust||(b&&b.line&&O.cN(b)&&(c=t.o6(u,s,!1,y),f=t.o6(u,s,!0,C),l=O.cN(c),h=O.cN(f),d=t.o6(u,s-1,!1,M),v=t.o6(u,s-1,!0,w),m=O.cN(d),g=O.cN(v),c&&l&&b.line.Wx(p={tN:2,_orientation:1,Jx:2}),f&&h&&b.line.Wx(p={tN:2,_orientation:1,Kx:-2}),d&&m&&b.line.Wx(p={tN:1,_orientation:1,Kx:-2}),v)&&g&&b.line.Wx(p={tN:1,_orientation:1,Jx:2}),(b=t.YN(u,s,t.xN,!0))&&b.line&&O.cN(b)&&(c=t.o6(u,s,!1,y),f=t.o6(u,s,!0,w),l=O.cN(c),h=O.cN(f),d=t.o6(u-1,s,!1,M),v=t.o6(u-1,s,!0,C),m=O.cN(d),g=O.cN(v),c&&l&&b.line.Wx(p={tN:2,_orientation:0,Jx:2}),f&&h&&b.line.Wx(p={tN:2,_orientation:0,Kx:-2}),d&&m&&b.line.Wx(p={tN:1,_orientation:0,Kx:-2}),v)&&g&&b.line.Wx(p={tN:1,_orientation:0,Jx:2}))},h.prototype.n6=function(t,n,e,i){var r,i,r=i[t];return i=(i=(r=r||(i[t]={}))[n])===z?r[n]=this.a6(t,n,e):i},h.prototype.a6=function(t,n,e){var i,r,o;if(t===z||t<0||n===z||n<0)return j;if(i=this,r=e?i.NN:i.xN,o=i.YN(t,n,r,!0))return o;if(r=e?i.IN:i.AN,e){if(--n<0)return j}else if(--t<0)return j;return(o=i.YN(t,n,r,!0))||j},h.prototype.paint=function(t){var n=this;n.Ux&&(n.Hx||(n.KN(),n.WN(),n.ZN(),n.Wx(),n.Hx=!0),t.save(),n._e(t),t.restore())},h.prototype._e=function(t){this.u6(t),this.s6(t)},h.prototype.u6=function(t){var n=this;n.c6(t,n.AN),n.c6(t,n.IN)},h.prototype.s6=function(t){var n=this;n.c6(t,n.xN),n.c6(t,n.NN),n.c6(t,n.kN),n.c6(t,n.DN)},h.prototype.c6=function(t,n){var e,i,r,o,a,u;for(e in n)if(n[e])for(i in r=n[e])if(r[i])if(o=r[i].line,(a=r[i].splitLines)&&0<a.length)for(u=0;u<a.length;u++)a[u]&&a[u]._e(t);else o&&o._e(t)},t.Yx=h},"./dist/core/worksheet/worksheet-edit.js":function(t,n,e){"use strict";var n,x,N,i,k,i,D,e,_,E,j,O,r,R,B,C,o,m,e,a,u,s;Object.defineProperty(n,"__esModule",{value:!0}),n=e("./dist/core/core.ns.js"),x=e("./dist/core/worksheet/worksheet.js"),N=e("./dist/core/util/common.js"),i=e("./dist/core/util/domUtil.js"),k=i.GC$,i=e("Common"),D=e("./dist/core/core.enum.js"),e=e("CalcEngine"),_=!!e,E=N.mt.Tt,j=N.mt.pi(),O=i.Common.lt.ht,r=i.Common.zf,R=i.Common.CultureManager,B=null,C=void 0,o="string",m=N.mt.wt,a=(e=new i.Common.ResourceManager(n.SR,"Sheets")).getResource.bind(e),u="=",k.extend(x.Worksheet.prototype,s={startEdit:function(t,n){var e=this;e.f6(e.Dg(),e.ui,e.ci,B,B,t,n)},editorStatus:function(){return this.Di||0},isEditing:function(){var t=this.Di;return 1===t||2===t},endEdit:function(t){return this.ol(t)},ol:function(t,n,e,i){var r,o,a,u,s,r=this;if(!r.isEditing())return!0;r.suspendPaint();try{return o=r.ui,a=r.ci,u=D.SheetArea.viewport,(s=r.vA)&&(o=s.row,a=s.col,u=s.sheetArea,r.vA=C),r.l6(o,a,u,t,n,e,i)}finally{r.resumePaint()}},l6:function(t,n,e,i,r,o,a){var u,s,c,f,t,n,l,h,d,v,m,m,m,g,p,m,b,g,y,p,m,w,M,r,g,p;if(void 0===e&&(e=D.SheetArea.viewport),s=(u=this).rt,c=u.li,f=u.name(),(d=u.getCellType(t=t,n=n,e)).isImeAware(v={sheet:u,row:t,col:n,sheetArea:e})||s.aA(),c&&c.parentNode){if(h=d.getEditorValue(c,v),u.ki(N.Events.EditEnd,m={sheet:u,sheetName:f,row:t,col:n,editor:c,editingText:h,cancel:!1,committed:!i}),m.cancel&&!a)return;if(u.ki(N.Events.EditEnding,m),m.cancel&&!a)return;if(m=(m=u.parent)&&m.h6,document.activeElement===(m&&m.Ti)&&s.aA(),0<=t&&0<=n&&(g=c.d6,p=u.getFormulaInformation&&u.getFormulaInformation(t,n,3),d.isEditingValueChanged(g,h,v)||1===r||p&&p.isArrayFormula&&1!==r))if(i)d.setEditorValue(c,g,v),d.selectAll(c,v);else if(m=d.v6,O(m)&&(m=!0),g={cmd:"editCell",sheetName:f,row:t,col:n,sheetArea:e,newValue:h=(b=u.getActualStyle(t,n)).mask&&p&&!p.hasFormula&&h&&-1<N.FormulaPrefix.indexOf(h[0])?"'"+h:h,autoFormat:m,editingFormatter:c.Ii},1===r&&(g.ranges=[u.U5()],g.endEditType=r),null!==h&&(y=u.tables&&u.tables.find&&(u.tables.find(t-1,n)||u.tables.find(t,n-1)))&&u.tables.yx(B,new N.Range(t,n,1,1),null,h,!0),u.Qy().execute(g),2===(l=g.applyResult)&&(d.focus(c,v),!a))return!1;if(u.k1=!0,p=e===D.SheetArea.colHeader?-1:C,m=e===D.SheetArea.rowHeader?-1:C,d.Sn(c,v,u.getCellRect(t,n,p,m)),d.isImeAware(v))E.msie&&9===parseFloat(E.version)?s.aA():k(c.parentNode.parentNode).css({width:0,height:0,overflow:"hidden",border:"none"});else for(w=u.qc(),M=c;M;)M.parentNode===w?w.removeChild(M):M=M.parentNode}return u.u0=!1,g=k.extend({},r={sheet:u,sheetName:f,row:t,col:n,editingText:h,ignoreValueChange:i,sheetArea:e,committed:!i}),u.ki(N.Events.EditEnded,r),u.ki(N.Events.FormulaTextboxEditEnded,g),!(!0!==o&&g.ignore&&!a)&&(0!==u.Di&&(p=u.Di,u.Di=0,u._i(p,0)),u.Ut.setCellState(t,n,D.CellStatesType.edit,!1,e),x.Worksheet.et(u,"endEdit"),u.li=B,1!==l)},m6:function(t,n,e){var i,r,o,a,u,t,u,r,s,n,i=this,r=i.hitTest(n,e);!r||r.cellTypeHitInfo&&(r.cellTypeHitInfo.outlineColumnHitInfo||r.cellTypeHitInfo.cellButtonHitInfo)||(o=r.row,a=r.col,0<=o&&0<=a&&0<=r.rowViewportIndex&&0<=r.colViewportIndex&&!r.resizeInfo&&!r.dragInfo&&o===i.ui&&a===i.ci&&(u=i.isEditing(),i.f6(t,o,a),!u)&&i.isEditing()&&(t=r.hitTestType,(u=i.getCellType(o,a)).j3)&&(r=i.getCellRect(o,a,1===t?-1:C,2===t?-1:C),s=i.getActualStyle(o,a,t),n=u.Bn(n,e,s,r,{sheet:i,row:o,col:a,sheetArea:t}))&&n.isReservedLocation&&u.j3(i,o,a,3))},inputFormulaAndSelectFormulaRange:function(t,n,e,i){var r,o,a,u,s,c,f,l,h,d,c,r=this,o=r.options,a=r.getCellRect(t,n),u=r.getActualStyle(t,n),s=r.getCellType(t,n),c=r.rt;c.Zg(),f={sheet:r,row:t,col:n,sheetArea:3},(h=(l=c.g6)&&l.firstChild?l.firstChild.firstChild:h)&&(r.li=h,d=r.Fi(),s.isImeAware(f)&&c.p6(),s.On(l,u,a,f),r.Ri(s,h,t,n,u,C,C,C,C,3),s.Rn(l,u,a,f),o.allowCellOverflow&&((c=a.clone()).y-=2,c.height+=4,c.x=d.b6,c.width=r.Gy(d),r.repaint(c)),x.Worksheet.et(r,"startEdit",{element:s.getEditingElement(),row:t,col:n,sheetArea:3}),r.Di=2,r.il.text(i),r.il.caret(i.length-1),e&&r.il.y6(3,4),r.il.w6(),N.hi.F1(r))},f6:function(t,n,e,i,r,o,a,u,s){var c,f,l,h,d,v,m,g,p,p,b,y,w,M,C,S,T,M,T,M,T,T,s,T,M,s,T,M,s,i,A,I,r,p;k[k.sd]({jS:this.parent}),n<0||e<0||(f=(c=this).name(),l=c.options,c.isEditing())||(h=c.C6(i,r),O(h)&&(h=3),(d=c.Ut).setCellState(n,e,D.CellStatesType.edit,!0,h),v=c.getActualStyle(n,e,h),l.isProtected&&!1!==v.locked?(d.setCellState(n,e,D.CellStatesType.edit,!1,h),c.jT(13,c.FT())):(m=c.getCellType(n,e,h))&&(x.Worksheet.et(c,"allowStartEdit",p={row:n,col:e,sheetArea:h,isAllow:g=!0}),p.isAllow)&&((p=c.rt).Zg(),w=(y=m.isImeAware(b={sheet:c,row:n,col:e,sheetArea:h})?p.g6:m.jn(b))&&y.firstChild?y.firstChild.firstChild:w)?(M=v,C=!1,T=R.culture(),(M.formatter&&N.util.h0(M.formatter,T)||M._autoFormatter&&M._autoFormatter.formatCached&&N.util.h0(M._autoFormatter,T))&&(s&&s.key&&(M=s.key,T=s.code,M&&-1!==N.NUMBER_ARRAY.indexOf(M)&&(C=!0),"+"!==M&&"-"!==M||(m.probabilityAddPercent=!0),"process"===M.toLowerCase())&&(!s.shiftKey&&0<T.length-T.replace(/[0-9]/,"").length&&(C=!0),!s.shiftKey&&(0<T.length-T.replace("Minus","").length||0<T.length-T.replace("Subtract","").length||0<T.length-T.replace("Add","").length)&&(m.probabilityAddPercentSpec=!0),s.shiftKey)&&0<T.length-T.replace("Equal","").length&&(m.probabilityAddPercentSpec=!0),M=y.innerText,E.msie&&(M=M.replace("\r\n","")),T=R.Fe(R.culture()).NumberFormat.numberDecimalSeparator,T=new RegExp("^[-]?[0-9]+(\\"+T+"[0-9]+)?$"),!s)&&M&&T.test(M)&&(S=!0),c.li=w,c.ki(N.Events.EditStarting,s={sheet:c,sheetName:f,row:n,col:e,cancel:!1}),s.cancel?(j.ipad&&p.aA(),d.setCellState(n,e,D.CellStatesType.edit,!1,h)):(c.vA={row:n,col:e,sheetArea:h},3===h&&c.showCell(n,e,3,3),c.S6=!0,T=c.getValue(n,e,h),M=_&&c.getFormula(n,e,h),s=c.Di,c.Ai||O(T)&&O(M)?c.Di=1:c.Di=2,c._i(s,c.Di),T=c.Fi(),!(M=c.getCellRect(n,e,i,r))||O(M.width)||O(M.height)||O(M.x)||O(M.y)||M.width<=0||M.height<=0||(m.isImeAware(b)&&p.p6(),m.On(y,v,M,b),c.Ri(m,w,n,e,v,a,u,C,S,h),s=c.qc(),m.isImeAware(b)||s.insertBefore(y,B),delete c.S6,m.Rn(y,v,M,b),m.isImeAware(b)&&o||m.focus(w,b),l.allowCellOverflow&&((i=M.clone()).y-=2,i.height+=4,c._1&&c._1.isEnable(D.RowColumnStates.edit,!1)&&(i.y=T.T6,i.height=T.A6),i.x=T.b6,i.width=c.Gy(T),c.repaint(i)),x.Worksheet.et(c,"startEdit",{element:m.getEditingElement(),row:n,col:e,sheetArea:h,preventFormulaTextBox:!!v.mask}),C||!o||v.mask||m.selectAll(w,b),C&&(A=window.getSelection(),(I=document.createRange()).setStart(w,0),A.removeAllRanges(),A.addRange(I)),S&&(A=window.getSelection(),(r=document.createElement("span")).innerText="%",I=document.createRange(),c.parent.options.enableFormulaTextbox&&c.parent.options.allowUserEditFormula&&!v.mask?(w.firstChild.appendChild(r),I.setStart(w.firstChild,1),c.il&&c.il.I6()):(w.appendChild(r),I.setStart(w,1)),A.removeAllRanges(),A.addRange(I)),N.hi.F1(c),c.ki(N.Events.EditStarted,p={sheet:c,sheetName:f,row:n,col:e,sheetArea:h}),c.ki(N.Events.FormulaTextboxEditStarted,p)))):d.setCellState(n,e,D.CellStatesType.edit,!1,h))},Ri:function(t,n,e,i,r,o,a,u,s,c){var f,l,h,a,d,v,d,v,d,o,r,t,f=this,l=_&&f.getFormula(e,i,c,!0),a={sheet:f,row:e,col:i,sheetArea:c,isImeInput:a,cellStyle:r};(h=l=l&&"="+l)&&0!==l.length||((l=f.getValue(e,i,c,1))&&l.richText&&(l=m(l)),d=f.parent,v=_&&d&&d.options.allowUserEditFormula,d=_&&d&&d.options.allowInvalidFormula,N.util.c0(l,r.quotePrefix,v,d)?h=l="'"+l:(h=l,l=t.je(n,r,l,a))),n.d6=l,O(o)||(l=o),s&&(l=l&&this.x6(l,r)),r.mask&&r.mask.pattern&&"'"!==r.mask.pattern[0]&&l&&"'"===l[0]&&-1<N.FormulaPrefix.indexOf(l[1])&&(l=l.substring(1,l.length)),t.setEditorValue(n,l,a,u,s),f.parent&&f.parent.options.enableAccessibility&&(v=l&&"="===l[0],d=f.getText(e,i,c),o=v?l:f.getFormula(e,i,c),r=3===c&&f.comments&&f.comments.get(e,i),t=f.N6(e,i,d,o,r&&r.text()),n.setAttribute("aria-label",t),f.setAccessibilityPrefixSuffixContent)&&f.setAccessibilityPrefixSuffixContent(),n.Li=h},k6:function(t){var n="",t=t&&(t.formatter||t._autoFormatter);return n=t?typeof t==o?t:t.formatCached:n},x6:function(t,n){var e,i,e,n,r,o,n,r,n,r,n,n,a,u,e=R.Fe(R.culture()).NumberFormat,i=e.negativeSign,e=e.numberDecimalSeparator,n=this.k6(n),r="%"===n[0],n=n.split(";");if(r?o=n[0].split("%")[1].split(".")[1]:-1<n[0].indexOf("%")&&(o="00"),void 0===o&&(o=""),1<t.split("e").length)return r=t.split("e")[0],n=t.split("e")[1],r+"e+"+(parseInt(n.split("+")[1],10)+2);if(1<t.split(e).length){for(r=!1,t.charAt(0)===i&&(t=t.substr(1,t.length-1),r=!0),n=(t+=o).indexOf(e),a=(n=(t=(t=t.split(e).join("")).substr(0,n+2)+e+t.substr(n+2,t.length-1)).split(e))[0],u=n[1];a&&"0"===a.charAt(0);)a=a.substr(1,a.length-1);for(;u&&"0"===u.charAt(u.length-1);)u=u.substr(0,u.length-1);return(a=r?a&&i+a:a)&&u?a+e+u:!a&&u?(r?i+"0"+e:"0"+e)+u:a&&!u?a:"0"}return"0"===t?t:t+o}})},"./dist/core/worksheet/worksheet-event.js":function(r,o,t){"use strict";var a,p,w,u,d,b,v,t,m,z,s,g,y,V,Y,Z,c,f,M,W,n,Q,J,K,X,q,$,tt,nt,C,S,T,et,A,l,I,x,it,rt,ot,at,ut,st,ct,ft,lt,ht,dt,vt,mt,gt,pt,bt,yt,N,k,D,wt,Mt,Ct,n,St,Tt,At,It;function xt(t,n){var e,n,e=[n,n];return e=t<3*n?2===t?[1,0]:1===t?[0,0]:[n=l(t/3),n]:e}function Nt(t,n){var e=3;return R(n)<0&&(e=1),!(3===(e=B(n)<0?2:e)||!t.ni(n.row,n.col,e,!0))}function kt(t,n,e){var i,r,o,a,u,s,u,s,c,s,c,i=!1,r=t.Fi();return n&&(o=R(n),u=(a=B(n))<0&&n.col>=t.getFreeAreaColumnCount(v.SheetArea.rowHeader),s=o<0&&n.row>=t.getFreeAreaRowCount(v.SheetArea.colHeader),u||s)&&(u=t.getCellRect(n.row,n.col,o,a,!0))&&0<u.width&&0<u.height&&(s=r.x,c=r.y,u.x<r.XC+s||u.y<r.qC+c||u.y>=r.height-r.D6)&&(s=new b.Rect(u.x-2,u.y-2,u.width+4,u.height+4),c=void 0,c=o<0&&a<0?r.R1():o<0?r.L1(a):r.B1(o),s=s.getIntersectRect(c),e._6(s.x,s.y,s.width,s.height),i=Nt(t,n)),i}function _(t){return t.isEditing()}function E(t){return t.endEdit()}function Dt(t){return t.frozenRowCount()}function _t(t){return t.frozenColumnCount()}function j(t,n){return t.getRowCount(n)}function O(t,n){return t.getColumnCount(n)}function R(t){return t.rowViewportIndex}function B(t){return t.colViewportIndex}function L(t){return t.hitTestType}function Et(t){return t.getActiveRowIndex()}function jt(t){return t.getActiveColumnIndex()}function h(t){return t.keyCode}function F(t){return t.ctrlKey}function P(t){return t.shiftKey}function Ot(t){return t.altKey}function Rt(t){return t.metaKey}function G(t){return t.colCount}function Bt(t){return t.rowCount}function U(t,n,e){return{action:t,index:n,sheetArea:e}}function Lt(t,n,e){return C===n.O5(t,e,!0)}function Ft(t,n,e){return C===n.j5(t,e,!0)}function Pt(t,n){return n?t.E6?t.startY-t.movingY:t.movingY-t.startY:t.j6?t.startX-t.movingX:t.movingX-t.startX}function H(t,n,e,i,r,o,a){var n,r,n={sheet:t,sheetName:n,sheetArea:r,row:e,col:i},r=t.getCellType(e,i);return r&&(n=r.cfe(n,a)),o&&(n.cancel=!1),n}function Gt(t,n,e,i,r,o){var a,u,a=t.Mf,u=H(a,a.name(),a.ui,a.ci,S,!0);if(a.ki(b.Events.LeaveCell,u),u&&!0===u.cancel)return!0;a.O6(n,e,i,r,o),a.ki(b.Events.EnterCell,H(a,a.name(),n,e)),a.ki(b.Events.FormulaTextboxEnterCell,H(a,a.name(),n,e,S,S,b.Events.FormulaTextboxEnterCell)),t.PA&&t.PA(n,e)}function Ut(t,n,e,i,r,o,a){var u,n,s,u=t.Mf,n=n.call(u,o.sheetArea);return(a&&!u.getRowVisible(o.index,o.sheetArea)||!a&&!u.getColumnVisible(o.index,o.sheetArea))&&(o.index=e.call(t,o.index,o.sheetArea)),s=(s=i.call(n,o.index))||i.call(n,r)}function Ht(t,n,e,i,r){var o,a,u,n,e,o=i?"movingY":"movingX",a=i?"startY":"startX";t[o]=n,(u=t.j6||t.E6?t[o]>t[a]:t[o]<t[a])&&(t[o]=t[a]),n=i?e.y+e.height:e.x+e.width,e=i?t.R6:t.B6,t[o]>n&&!e&&(t[o]=n),r!==C&&t[o]>t[a]+r&&(t[o]=t[a]+r)}function zt(t,n){var e=t.Fi();return 0<Dt(t)&&n<e.T6+e.L6?0:0<t.frozenTrailingRowCount()&&n>e.Ay?2:1}function Vt(t,n){var e=t.Fi();return 0<_t(t)&&n<e.b6+e.F6?0:0<t.frozenTrailingColumnCount()&&n>e.Hy?2:1}function Yt(t,n,e){var t=t._y(n);return t?t.findNearY(e):C}function Zt(t,n){var t=t._y(-1,v.SheetArea.colHeader);return t?t.findNearY(n):C}function Wt(t,n,e){var t=t.Yy(n);return t?t.findNearX(e):C}function Qt(t,n){var t=t.Yy(-1,v.SheetArea.rowHeader);return t?t.findNearX(n):C}function Jt(t){return!t.options.isProtected||t.options.protectionOptions.allowResizeRows}function Kt(t){return!t.options.isProtected||t.options.protectionOptions.allowResizeColumns}function Xt(t,n){var e,i,r,n,o,t,e=n.row,i=n.rowCount,r=n.col,n=n.colCount,o=t.getColumnCount(),t=t.getRowCount();return{row:e,col:r,rowCount:i=t<i+e?t-e:i,colCount:n=o<n+r?o-r:n}}function qt(t,n){var e,i,e=t.getViewportBottomRow(t.C0(n));if(n<(e=-1===e?t.P6():e))for(i=e;n<i;i--)if(0!==t.getRowHeight(i))return;return 1}function $t(r){var t,o,a,t=r.Ut.getSelections();if(0<t.length)return o=0,a=r.getRowCount(),t.every(function(t){var t,n,e,i,t=Xt(r,t),n=!1;return 1===t.rowCount&&(n=(o+=1)<=1),e=t.row<a,(i=-1!==t.col)||n&&e})}function tn(t,n,e){var i,r,i,r=t.parent.options.rowResizeMode;return e&&0===r&&(r=1),n.action!==N&&1===r&&!qt(t,n.index)&&!(!t.getRowResizable(n.index,n.sheetArea)||!t.getRowResizable(n.index+1,n.sheetArea))&&$t(t)}function nn(t,n,e,i){return tn(t,n,i)&&1===e.length&&e[0].firstRow===e[0].lastRow}function en(t,n){var e,i,e=t.getViewportRightColumn(t.S0(n));if(n<(e=-1===e?t.G6():e))for(i=e;n<i;i--)if(0!==t.getColumnWidth(i))return;return 1}function rn(r){var t,o,a,t=r.Ut.getSelections();if(0<t.length)return o=0,a=r.getColumnCount(),t.every(function(t){var t,n,e,i,t=Xt(r,t),n=!1;return 1===t.colCount&&(n=(o+=1)<=1),e=t.col<a,(i=-1!==t.row)||n&&e})}function on(t,n,e){var i,r,i,r=t.parent.options.columnResizeMode;return e&&0===r&&(r=1),n.action!==wt&&1===r&&!en(t,n.index)&&!(!t.getColumnResizable(n.index,n.sheetArea)||!t.getColumnResizable(n.index+1,n.sheetArea))&&rn(t)}function an(t,n,e,i){return on(t,n,i)&&1===e.length&&e[0].firstColumn===e[0].lastColumn}function un(t,n,e,i,r){var o,a,r,u,o=n.index,a=t.Fi();tn(t,n,r)?(r=t.j5(o,e),Ht(n,i,a,!0,u=t.Gt(o,e)+t.Gt(r,e))):Ht(n,i,a,!0)}function sn(t,n,e,i,r){var o,a,r,u,o=n.index,a=t.Fi();on(t,n,r)?(r=t.O5(o,e),Ht(n,i,a,!1,u=t.nn(o,e)+t.nn(r,e))):Ht(n,i,a,!1)}function cn(t,n,e){var i,r,o,a,u,s,c,f,i=e?t.frozenRowCount():t.frozenColumnCount(),r=e?t.Tb:t.Ab,o=!1,u=r-1;if(0<i&&i<r)for(s=r-1;i<=s;){if(a=e?t.getRowVisible(s):t.getColumnVisible(s)){if(c=e?t.getRowHeight(s):t.getColumnWidth(s),s===u&&0===c)break;if(0<c){o=!0;break}}else u--;s--}for(f=o?i:n,f--;0<=f;){if(a=e?t.getRowVisible(f):t.getColumnVisible(f))return f;f--}return-1}function fn(t){var t=t.il;return t&&t.U6}function ln(t){for(;t!==z.body;){var n;if(getComputedStyle(t).transform.match(/matrix\([^\)]+\)/))return 1;if(!t.parentNode)break;t=t.parentNode}}function e(t){var n=this;n.Ti=t,n.H6=C,n.z6=C,n.V6=C,n.Y6=C,n.Z6=!1,n.W6=!1}function i(t){this.Q6=0;var n=this;n.K6=0,n.J6=!1,n.X6=!1,n.q6={},n.Mf=t,n.tk="gcEvent"+t._id}Object.defineProperty(o,"__esModule",{value:!0}),o.nk=void 0,a=t("./dist/core/core.ns.js"),p=t("./dist/core/worksheet/worksheet.js"),w=t("Common"),u=t("./dist/core/worksheet/worksheet-model.js"),d=t("./dist/core/util/domUtil.js"),b=t("./dist/core/util/common.js"),v=t("./dist/core/core.enum.js"),t=t("./dist/core/workbook/sheettabbase.js"),m=window,z=document,s=d.GC$.each,g=b.mt.Tt,y=b.mt.pi(),V=b.mt.vi,Y=b.mt.En,Z=w.Common.zf,c=w.Common.zf.I5,f=b.Ec,M=w.Common.lt.ht,Q="mousedown"+(n=".handler"),J="mouseup"+n,K="mousemove"+n,X="mousewheel"+n,q="DOMMouseScroll"+n,$="wheel"+n,tt="mouseout"+n,nt="dblclick"+n,C=null,S=void 0,T=isNaN,et=parseInt,A=Math.max,l=Math.floor,I=Math.min,x=Math.abs,it=Math.ceil,rt="function",ot="position",at="absolute",ut="border",st="overflow",ct="top",ft="left",lt="width",ht="height",dt="resize",vt="hidden",mt="visible",gt="none",pt="tabindex",bt="gcUIElement",yt="corner",N="sizeHiddenRow",k="sizeRow",D="sizeCol",wt="sizeHiddenCol",Mt="default",Ct=y.iphone||y.ipad||y.android,n=new w.Common.ResourceManager(a.SR,"Sheets"),St=n.getResource.bind(n),Tt=30,e.prototype.ek=function(t){typeof t==rt&&(this.z6=t)},e.prototype.ik=function(t){var n,e,n=this;T(t)||0===t?n.rk():(n.W6=0<t,t=x(t),(e=n.H6)!==(n.H6=t)&&n.ak())},e.prototype.ak=function(){var t=this;t.d5(),T(t.H6)||(t.V6=m.setInterval(function(){t.uk()},t.H6))},e.prototype.uk=function(){var t=this,n=t.z6;t.Z6=!0,typeof n==rt&&(t.Y6=n.call(t.Ti,t.W6))},e.prototype.rk=function(){var t=this;t.d5(),t.H6=C,t.V6=C,t.Y6=C,t.Z6=!1},e.prototype.d5=function(){var t=this.V6;t&&clearInterval(t)},e.prototype.L0=function(){this.rk()},At=e,i.prototype.L0=function(){var t=this;t.sk&&t.sk.L0(),t.ck&&t.ck.L0(),t.fk=C},i.prototype.lk=function(){var t=this;return t.sk||(t.sk=new At(t)),t.sk},i.prototype.hk=function(){var t=this;return t.ck||(t.ck=new At(t)),t.ck},i.prototype.uw=function(){return this.Mf.uw()},i.prototype.it=function(){var t,t;return t=(t=(0,d.GC$)(this.Mf.Dg()).position())||{top:0,left:0}},i.prototype.gg=function(t){var n,e,n,e,n,i,r,o,a,a,i,r,o,n=b.mt.Qf(),e=F(t),n=n&&!0===e&&0===t.button;return!(2!==t.button&&!n&&(n=(e=this).Mf,e.Fg(),g&&g.msie&&t.offsetX!==S&&t.offsetY!==S&&(r=i=0,o=n.fg,t.target!==o&&(i=(a=b.mt.T0(t.target,o)).I0,r=a.A0),o)&&(a=t.pageX-(t.offsetX+i),i=t.pageY-(t.offsetY+r),o.canvasOffset={top:i,left:a}),r=n.uw(),o=e.dk(t,t.pageX-r.left,t.pageY-r.top),_(n)||o||e.Zg(),n.vk=!0))},i.prototype.Fg=function(){var n=this;n.p4||((0,d.GC$)(z).bind("mousemove.gcSheet."+n.tk,function(t){n.pg(t)}).bind("mouseup.gcSheet."+n.tk,function(t){n.bg(t)}),n.p4=!0)},i.prototype.u2=function(){this.p4&&(this.p4=!1,d.GC$)(z).unbind("mousemove.gcSheet."+this.tk).unbind("mouseup.gcSheet."+this.tk)},i.prototype.dk=function(t,n,e){var i,r,o,a,u,s,c,f,l,h,n,e,n,h,s,c,l,d,v,m,g,i=this,r=i.Mf,o=r.hitTest(n,e),a=o.row,u=o.col,s=o.dragInfo,c=o.formulaRangeHitInfo,f=o.cellTypeHitInfo,l=o.resizeTableHitInfo,h={hitInfo:o,e:t,r:C};if(p.Worksheet.et(r,"processMouseDown",h),n>=(n=r.Fi()).x&&e>=n.y&&(r.sw=o,!h.r))if(i.ab=!0,o.tableSelectInfo&&!r.il)i.mk(o,r);else if(o.resizeInfo)(fn(r)||E(r))&&i.gk(o);else if(o.dragMergeInfo)E(r)&&i.pk&&i.pk(o);else if(s&&s.side&&s.side!==yt)E(r)&&(i.bk&&i.bk(o),i.yk(t));else if(s&&s.side===yt)E(r)&&i.wk&&i.wk(o);else if(o.filterButtonHitInfo)E(r);else if(c)c.inBorder?i.Mk(o):(c.inTopLeft||c.inTopRight||c.inBottomLeft||c.inBottomRight)&&i.Ck(o);else if(l)i.Sk&&i.Sk(o);else if(r.JA(R(o)<0?-1:a,B(o)<0?-1:u)&&(e=r.il,o.tableSelectInfo&&e?(n=this.Tk(o,r),o.tableSelectInfo.tableSelection=n,e.Ak(n)):e&&e.Gce(),!i.Ik||!i.Ik(r,o))){if(h=Et(r),s=jt(r),f){if(c=r.getCellType(f.row,f.col,L(o)),f.sheet||(f.sheet=r),i.xk(c,f)&&(l=f.sheetArea,M(l)||3===l)&&(a!==h||u!==s)){r.suspendPaint();try{if(!E(r))return;if(d=H(r,r.name(),h,s,S,!0),r.ki(b.Events.LeaveCell,d),d&&!0===d.cancel)return;v=r.Ut.getSelections(),m=r.Ut.getSpan(a,u),g=[new b.Range(m.row,m.col,m.rowCount,m.colCount)],r.ki(b.Events.FloatingElementSelected,{type:"worksheet"}),r.EA(v,g),r.t4(a,u,S,S,1),r.ki(b.Events.EnterCell,H(r,r.name(),a,u)),r.ki(b.Events.FormulaTextboxEnterCell,H(r,r.name(),a,u)),r.jA(v),r.Nk=!0,i.PA&&i.PA(a,u)}finally{r.resumePaint()}}c.processCellAndPaddingMouseDown(f)}if(f&&f.isReservedLocation)return!0;i.yk(t),i.kk(r,o,a,u)}},i.prototype.kk=function(t,n,e,i){var r,e,i,r=this;try{if(r.Dk=n,_(t)&&!E(t))return}finally{r.Dk=C}M(e)||M(i)||(3===L(n)&&r.PA&&r.PA(e,i),t.ki(b.Events.FloatingElementSelected,{type:"worksheet"}),e=t.Ut.getSelections(),r._k(n,e),i=t.Ut.getSelections(),t.EA(e,i))},i.prototype.xk=function(t,n){return t&&n&&n.isReservedLocation&&(!t.activeOnClick||t.activeOnClick())},i.prototype.Ek=function(t){var n,e,n=this.Mf;return!n||(e=n.Fi(),M(t.x))||M(t.y)||M(t.width)||M(t.height)||t.x+t.width>e.Py+n.Gy(e)+e.zy||t.y+t.height>e.Cy+n.Sy(e)+e.Iy},i.prototype.jk=function(t,n,e,i,r){for(var o,a,u,s,c,f,l,h,h,o=this.Mf,u=0,s=t.options,c=s.length;u<c;u++)if((f=s[u]).selected){a=i[u].value;break}l=!1,o.options.isProtected&&(h=o.getActualStyle(n,e))&&(l=h.locked),a===S||l||(h={cmd:"editCell",sheetName:o.name(),row:n,col:e,newValue:a,autoFormat:!0,ignoreFormatting:r,ignoreFormula:!0},o.Qy().execute(h)),(0,d.GC$)(t).hide()},i.prototype.Ok=function(){var t,n,t=this;t.Rk&&(3!==(n=t.Rk.Bk)&&2!==n||t.hk().ek(t.Lk),3!==n&&1!==n||t.lk().ek(t.Fk))},i.prototype.Pk=function(){var t=this;t.ob&&t.Gk(),t.Uk&&t.Hk&&t.Hk(),t.zk&&t.Vk&&t.Vk(),t.Yk&&t.Zk&&t.Zk(),t.Wk&&t.Qk(),t.Kk&&t.Jk(),t.Xk&&t.qk(),t.$k&&t.t9&&t.t9()},i.prototype.Lk=function(t){var n,e,i,r,i,o,a,t,a,i,n=this,e;n.n9()||(i=n.Rk,r=n.Mf,i=i.e9,o=r.getViewportTopRow(i),a=r.getViewportBottomRow(i),t?(a<j(r)-r.frozenTrailingRowCount()-1||(t=r._y(i))&&0<t.length&&(a=r.Fi(),(i=t[t.length-1]).y+i.height>=a.Cy+r.Sy(a)))&&r.$A(r.j5(o)):o>Dt(r)&&r.$A(r.nI(o))),n.Pk()},i.prototype.Fk=function(t){var n,e,i,r,o,a,u,t,u,o,n=this,e;n.i9()||(i=n.Mf,o=(r=n.Rk).r9,a=i.getViewportLeftColumn(o),u=i.getViewportRightColumn(o),t?(u<O(i)-i.frozenTrailingColumnCount()-1||(t=i.Yy(o))&&0<t.length&&(u=i.Fi(),(o=t[t.length-1]).x+o.width>=u.Py+i.Gy(u)))&&i.o9(i.O5(a)):a>_t(i)&&i.o9(i.r6(a))),n.Pk()},i.prototype.n9=function(){var t,n,e,i,r,o,a,u,s,c,f,l,h,t=this.Mf,n=t.Fi(),e=Dt(t),i=t.frozenTrailingRowCount(),r=this.fk,o=this.Rk,a=o.e9;if(0===a){if(r.y>n.Cy)return t.$A(t.pw()),o.e9=1,!0}else if(1===a){if((u=t._y(1))&&0<u.length){if(s=u[0],0<e&&r.y<n.Cy&&s.row<=t.pw())return!(o.e9=0);if(s=u[u.length-1],0<i&&r.y>n.Ay&&s.row>=t.P6()&&s.y+s.height<=n.Ay)return o.e9=2,!0}}else if(2===a&&(u=t._y(1))&&0<u.length&&r.y<n.Ay){if((s=u[u.length-1]).y+s.height>n.Ay){for(c=t.Sy(n),l=0,h=f=j(t)-i-1;e<=h;h--)if(c<(l+=t.Gt(h))){f=I(h+1,f);break}t.$A(t.j5(f-1))}return o.e9=1,!0}return!1},i.prototype.i9=function(){var t,n,e,i,r,o,a,u,s,c,f,l,h,t=this.Mf,n=t.frozenTrailingColumnCount(),e=_t(t),i=t.Fi(),r=this.fk,o=this.Rk,a=o.r9;if(0===a){if(r.x>i.Py)return t.o9(t.Sw()),o.r9=1,!0}else if(1===a){if((u=t.Yy(1))&&0<u.length){if(s=u[0],0<e&&r.x<i.Py&&s.col<=t.Sw())return!(o.r9=0);if(s=u[u.length-1],0<n&&r.x>i.Hy&&s.col>=t.G6()&&s.x+s.width<=i.Hy)return o.r9=2,!0}}else if(2===a&&(u=t.Yy(1))&&0<u.length&&r.x<i.Hy){if((s=u[u.length-1]).x+s.width>i.Hy){for(c=t.Gy(i),l=0,h=f=O(t)-n-1;e<=h;h--)if(c<(l+=t.nn(h))){f=I(h+1,f);break}t.o9(t.O5(f-1))}return o.r9=1,!0}return!1},i.prototype.a9=function(){var t,n,e,i,r,i,o,a,u,u,r,e,i,n,s,t=this;(t.rb||t.u9||t.s9)&&(e=(n=t.Mf).Fi(),i=t.Rk,M(i)||(r=i.e9,i=i.r9,o=t.fk,a=C,0<=r&&0<=i?(a=e.c9(r,i),0===r&&n.Tb===n.frozenRowCount()&&(u=e.c9(1,i),a.height+=u.height),0===i&&n.Ab===n.frozenColumnCount()&&(u=e.c9(r,1),a.width+=u.width)):0<=r?a=e.B1(r):0<=i&&(a=e.L1(i)),a&&(r=(u=n.parent)&&u.options.scrollbarAppearance===v.ScrollbarAppearance.mobile,i=e=0,s=n=!1,o.x<=a.x?(e=o.x-a.x,r&&(s=!0)):o.x>=a.x+a.width?(0===(e=o.x-(a.x+a.width))&&(e=50),r&&(s=!0)):r&&o.x===a.x+a.width-1&&(e=50,s=!0),o.y<=a.y?(i=o.y-a.y,r&&(n=!0)):o.y>=a.y+a.height&&(i=o.y-(a.y+a.height),r)&&(n=!0),u&&r&&(n&&(u.Xb.qy(v.ScrollbarState.show),u.ib.$y(!0)),s)&&(u.zb.qy(v.ScrollbarState.show),u.ib.$y(!1)),t.lk().ik(t.f9(e)),t.hk().ik(t.f9(i)))))},i.prototype.l9=function(){this.lk().rk(),this.hk().rk()},i.prototype.gk=function(t){var n,e,i,r,o,o,e,o,i,t,n=this,e=u.h9.prototype,i=n.Mf,r=t.resizeInfo;r.action===k||r.action===N?(o=Ut(n,i.d9,n.v9,e.findRow,t.row,r,!0),r.startY=o.y+(r.E6?o.height:0)):(o=Ut(n,i.m9,n.g9,e.findCol,t.col,r,!1),r.startX=o.x+(r.j6?o.width:0)),e=i.parent,o=t.x,i=t.y,!e||(1!==(t=e.options.showResizeTip)||r.action!==D&&r.action!==wt)&&(2!==t||r.action!==k&&r.action!==N)&&3!==t||(i-30<0?i+=15:i-=30,e.Tw(Z.j0(n.p9()),o,i)),n.isResizing=!0,n.rb=!0,n.ctrl&&(n.b9=!0)},i.prototype.y9=function(){var t,n,e,i,r,o,r,a,u,s,e,r,s,t=this,n=t.Mf,e=n.sw,i=e.resizeInfo,r=t.fk,o=r.x,r=r.y,a=n.Fi(),u=n.parent,s=i.sheetArea;i&&t.rb&&t.isResizing&&(e.x===o&&e.y===r||(i.action===k||i.action===N?un(n,i,s,r,t.b9):sn(n,i,s,o,t.b9),r=(e=n.Dn).J(),e.FA(a.x,a.y,a.width,a.height),e.jy(r),!u)||(1!==(s=u.options.showResizeTip)||i.action!==D&&i.action!==wt)&&(2!==s||i.action!==k&&i.action!==N)&&3!==s||u.ny(t.w9(i)))},i.prototype.C9=function(){var t,n,e,i,r,o,a,i,u,s,i,u,i,t=this;t.isResizing=!1,n=!(t.rb=!1),i=(e=t.Mf).sw,(r=i.resizeInfo)&&(t.iy(),r.action===k||r.action===N?M(r.movingY)?n=!1:(o=A(0,Pt(r,!0)/e.zoom()),a=[],i="resizeRow",e.S9(r.index)?d.GC$.each(e.Ut.getSelections(),function(t,n){var n;-1===n.col&&(1===r.sheetArea?a.push({firstRow:r.index,lastRow:r.index}):(n=e.JS(n),a.push({firstRow:n.row,lastRow:n.row+Bt(n)-1})))}):a.push({firstRow:r.index,lastRow:r.index}),nn(e,r,a,t.b9)&&(i="splitResizeRow"),u=1===r.sheetArea,e.Qy().execute({cmd:i,sheetName:e.name(),rows:a,size:o,columnHeader:u})):M(r.movingX)?n=!1:(o=A(0,Pt(r)/e.zoom()),s=[],i="resizeColumn",e.T9(r.index)?d.GC$.each(e.Ut.getSelections(),function(t,n){var n;-1===n.row&&(n=e.JS(n),2===r.sheetArea?s.push({firstCol:r.index,lastCol:r.index}):s.push({firstCol:n.col,lastCol:n.col+G(n)-1}))}):s.push({firstCol:r.index,lastCol:r.index}),an(e,r,s,t.b9)&&(i="splitResizeColumn"),u=2===r.sheetArea,e.Qy().execute({cmd:i,sheetName:e.name(),columns:s,size:o,rowHeader:u})),(i=e.hitTest(t.fk.x,t.fk.y))&&t.cw(i),n||e.repaint(),t.b9=!1)},i.prototype.A9=function(t,n){var e,i,r,o,a,u,s,c,f,l,h,d,v,m,g,p,b,d,c,e=0,i=0,r=0,o=0,a=this,u=a.Mf,s=u.H3,c=Dt(u),f=_t(u),h=L(t),d=1===h&&u.NMi&&u.NMi.options.isDesignMode&&t.row<u.Ut.getFreeAreaRowCount(h);if(a.I9=a.x9=u.Ut.getSelections(h),u.isCtrlPressed(h)||a.shift||(d?u.IA(h):u.IA()),0===h)!a.shift&&(l=Gt(a,v=c?u.N9():u.Tb,p=f?u.k9():u.Ab,1,1,n))||(u.isCtrlPressed(h)||u.IA(),a.yse(u)?(u.IA(),u.D9(0,0,1,1,!0)):u.D9(-1,-1,j(u),O(u),!0));else if(1===h)d?(b=u.Ut.getSpan(t.row,t.col,1),u.Ut._9(b.row,b.col,b.rowCount,b.colCount),u.D9(b.row,b.col,b.rowCount,b.colCount,!0,1),a.E9=!0):!a.shift&&(v=c?u.N9():u.Tb,m=a.j9(v,t.col,!1),l=Gt(a,m.row,m.col,1,B(t),n))||(a.shift||u.O9?(e=I(u.ci,t.col),o=x(u.ci-t.col)+1,u.kA(-1,e,j(u),o,!0)):u.D9(-1,u.ci,j(u),1,!0));else if(2===h){if(!a.shift){if(d=f?u.k9():u.Ab,m=a.j9(t.row,d,!0),g=u.ui!==m.row,l=Gt(a,m.row,m.col,R(t),1,n))return;g&&s&&s.RA()}a.shift||u.O9?(i=I(u.ui,t.row),r=x(u.ui-t.row)+1,u.kA(i,-1,r,O(u),!0)):u.D9(u.ui,-1,1,O(u),!0)}else if(3===h)if(T(t.row)||T(t.col))_(u)&&(c=u.getCellRect(u.ui,u.ci,u.R9,u.B9),u.Dn._6(c.x,c.y,c.width,c.height));else{if(!a.shift&&(u.ui!==t.row||u.ci!==t.col)){if(g=u.ui!==t.row,l=Gt(a,t.row,t.col,R(t),B(t),n))return;g&&s&&s.RA()}a.shift?u.L9(t.row,t.col,!0):(b=u.Ut.getSpan(t.row,t.col),u.O9||u.D9(b.row,b.col,Bt(b),G(b),!0))}},i.prototype.yse=function(t){for(var n,e,i,r,o,a,n,e=0,i=t.getSelections();e<i.length;e++)if(r=i[e],o=j(t),a=O(t),-1===r.row&&-1===r.col&&r.colCount===a&&r.rowCount===o)return!0;return!1},i.prototype.F9=function(t){var n;!t||3===L(t)&&(T(t.row)||T(t.col))||((n=this).rb=!0,n.ob=!0,n.Rk={e9:R(t),r9:B(t),Bk:L(t)},n.Ok())},i.prototype.P9=function(t,n){var e,i,r,o,t,n,a,u,i,s,e,i=this.Mf,o=i.getSpan(t,n),t=t,n=n,a=1,u=1,i=i.selectionUnit(),s=!1;return 1===i?(u=n=-1,t=o?o.row:t,a=o?o.rowCount:a):2===i?(a=t=-1,n=o?o.col:n,u=o?o.colCount:u):s=!0,r=o&&s?o:new b.Range(t,n,a,u)},i.prototype._k=function(t,n){var e=this,i=e.Mf,r=t.row,o=t.col;i.O9=e.G9(r,o,n,L(t))&&i.parent.options.allowUserDeselect,i.O9&&(i.U9=i.ui,i.H9=i.ci,i.z9=e.P9(r,o)),e.A9(t),e.F9(t)},i.prototype.G9=function(t,n,e,i){var r,o,a,r=this,o=r.Mf,a;return r.V9(t,n,e,i)&&2===o.selectionPolicy()},i.prototype.V9=function(t,n,e,i){var r,o,a,u,s,c,r=this.Mf,o=r.getRowCount(),a=r.getColumnCount();if(!r.isCtrlPressed(i))return!1;for(u=!1,s=e.length,c=0;c<s;c++)if(3===i){if(e[c].contains(t,n,1,1)){u=!0;break}}else if(2===i){if(e[c].contains(t,-1,1,a)||e[c].contains(t,0,1,a)){u=!0;break}}else if(1===i&&(e[c].contains(-1,n,o,1)||e[c].contains(0,n,o,1))){u=!0;break}return u},i.prototype.Gk=function(){var t,n,t=this;t.Rk&&t.rb&&!0!==t.FI&&(3===(n=t.Rk.Bk)?t.Y9():2===n?t.Z9():1===n&&t.W9())},i.prototype.Y9=function(){var t,n,e,i,t,r,o,o,t=this,n=t.Mf,e=t.Q9(),i=t.K9();0<=e&&0<=i&&n.JA(e,i)&&(t.a9(),t=n.Ut.getSelections(),r=n.xA(e,i,n.ui,n.ci),1===t.length&&(o=t[0],!n.O9)&&r.equals(o)||(n.L9(e,i,!0),o=n.Ut.getSelections(),n.O9?n.ki(b.Events.InternalSelectionChanging,{sheet:this,sheetName:n.name(),oldSelections:t,newSelections:r}):n.EA(t,o)))},i.prototype.Z9=function(){var t,n,e,i,e,r,o,a,u,s,i,t=this,n=t.Mf,e=t.Q9(!0);if(0<=e&&n.JA(e,-1)){if(i=I(n.ui,e),e=A(n.ui,e)-i+1,r=-1,o=O(n),0===(a=n.selectionPolicy()))return;2===(u=n.selectionUnit())&&(e=i=-1),s=n.Ut.getSelections(),n.kA(i,-1,e,o,!0),i=n.Ut.getSelections(),n.EA(s,i)}t.a9()},i.prototype.W9=function(){var t,n,e,i,r,e,i,e,i,o,r,a,u,s,e,t=this,n=t.Mf,e=t.Rk.Bk,i=t.Q9(!0,e),r=t.K9(!0,e);if(t.E9&&i<n.Ut.getFreeAreaRowCount(e))e=n.Ut.J9(),i=n.xA(i,r,e.row,e.col,S,1),n.D9(i.row,i.col,i.rowCount,i.colCount,!0,1);else if(t.E9=!1,0<=r&&n.JA(-1,r)){if(e=I(n.ci,r),i=A(n.ci,r)-e+1,o=-1,r=j(n),0===(a=n.selectionPolicy()))return;1===(u=n.selectionUnit())&&(i=e=-1),s=n.Ut.getSelections(),n.kA(-1,e,r,i,!0),e=n.Ut.getSelections(),n.EA(s,e)}t.a9()},i.prototype.X9=function(){var t,n,e,e,i,t=this;t.Rk=C,t.l9(),t.FI=C,t.rb=!1,t.ob=!1,t.q9=t.E9,t.E9=!1,0!==(n=t.Mf).Ut.getSelections().length&&(n.O9&&(n.O9=!1,e=n.z9,n.z9=null,n.tD(n.Ut.getSelections(),e),delete n.U9,delete n.H9),n.Nk?delete n.Nk:((e=!t.x9)||(i=n.Ut.getSelections(),e=t._A(t.x9,i)),e&&n.jA(t.I9,t.shift)),t.x9=n.Ut.getSelections())},i.prototype.nD=function(){var t,n,e,i,t=this.Mf,n=zt(t,this.fk.y),e=this.Rk.e9,i=t._y(1);return n=0===n&&0<e&&0<i.length&&i[0].row>t.pw()||2===n&&e<2&&0<i.length&&i[i.length-1].row<t.P6()?1:n},i.prototype.eD=function(){var t,n,e,i,t=this.Mf,n=Vt(t,this.fk.x),e=this.Rk.r9,i=t.Yy(1);return n=0===n&&0<e&&0<i.length&&i[0].col>t.Sw()||2===n&&e<2&&0<i.length&&i[i.length-1].col<t.G6()?1:n},i.prototype.Q9=function(t,n,e){var i,r,o,a,r,n,e,r,a;if(void 0===n&&(n=v.SheetArea.viewport),r=(i=this.Mf).Ut,o=this.fk.y,n===v.SheetArea.colHeader){if(a=Zt(i,o))return r=r.getFreeAreaRowCount(n),e&&0<r&&a.row>=r?r-1:a.row}else if(a=Yt(i,n=this.nD(),o)){if(e=i.Fi(),r=a.row,1===n&&o<e.Cy){if((a=i.pw())<r)return i.j5(r-1)||r;if(r===a&&t)return 0}else if(0===n&&o<e.T6&&t)return 0;return 1===n&&o>e.Ay&&r>i.iD()?i.nI(r)||r:r}return-1},i.prototype.K9=function(t,n,e){var i,r,o,a,r,n,e,r,a;if(void 0===n&&(n=v.SheetArea.viewport),r=(i=this.Mf).Ut,o=this.fk.x,n===v.SheetArea.rowHeader){if(a=Qt(i,o))return r=r.getFreeAreaColumnCount(n),e&&0<r&&a.col>=r?r-1:a.col}else if(a=Wt(i,n=this.eD(),o)){if(e=i.Fi(),r=a.col,1===n&&o<e.Py){if((a=i.Sw())<r)return i.O5(r-1)||r;if(r===a&&t)return 0}else if(0===n&&o<e.b6&&t)return 0;return 1===n&&o>e.Hy&&r>i.rD()?i.r6(r)||r:r}return-1},i.prototype.f9=function(t){var n,e,n=0;return T(t)||0===t||(e=t<0,n=it(500/x(t)),200<(n=A(20,10*n))&&(n=200),e&&(n=-n)),n},i.prototype.v9=function(t,n){var e,n=this.Mf.nI(t,n);return n!==C?n:t},i.prototype.g9=function(t,n){var e,n=this.Mf.r6(t,n);return n!==C?n:t},i.prototype.oD=function(t,n,e){for(var i=this.Mf;n<t;)if(i.getRowVisible(--t,e))return t;return t},i.prototype.aD=function(t,n,e){for(var i=this.Mf;n<t;)if(i.getColumnVisible(--t,e))return t;return t},i.prototype.uD=function(t,n,e){for(var i=this.Mf;t<n;)if(i.getColumnVisible(++t,e))return t;return t},i.prototype.sD=function(t,n,e){for(var i=this.Mf;t<n;)if(i.getRowVisible(++t,e))return t;return t},i.prototype.cD=function(t,n,e,i,r){var o,a,u,s,c,f,u,s,l,h,d,v,d,m,m,g,g,d,m,c,g,p,b,o=C;if(Jt(t)){if(a=this,u=t.options.reversalTrailingResizeOrder,s=t.Ny,c=2===R(n),u=u&&(f=c&&s),s=c&&!s||u,!(l=t._y(R(n),i))||T(n.row)||T(n.col)){if(T(n.row)&&1===R(n))for(p=3,b=0;b<3&&(o=a.fD(t,b,e,i,r))===C;b++);}else t.getRowVisible(n.row,i)||(n.row=this.v9(n.row,i)),(h=l.findRow(n.row))&&(v=(d=xt(h.height,e))[0],d=d[1],m=!(u&&l[l.length-1].row===h.row),h.y+h.height-d<=r&&r<=h.y+h.height+d&&m?(o=U(k,n.row,i),0<=(m=l[l.length-1].row)&&(g=t.P6(i),o.index===g)&&o.index!==m&&h.y+h.height-d/2<=r&&(o=U(a.lD(t,m,i),m,i)),c&&Ft(o.index,t,i)&&(o.R6=!0),u&&(g=a.sD(o.index,l[l.length-1].row,i),(o=U(a.lD(t,g,i),g,i)).E6=u)):h.y-v<=r&&r<h.y+v&&(0<w.Common.Uf.hD(l,h)||s)&&(d=a.oD(n.row,0,i),o=U(a.lD(t,d,i),d,i),u)&&(o=U(k,n.row,i),(o=0<=(m=l[0].row)&&(c=t.j5(m-1,i,!0),o.index===c)&&o.index!==m&&r<h.y+v/2?U(a.lD(t,m,i),m,i):o).E6=u)),!o&&1===R(n)&&0<l.length&&(h=l[0],A(0,h.y-e)<=r)&&r<=h.y+e&&0<=(g=cn(t,n.row,!0))&&(o=U(a.lD(t,g,i),g,i));o&&!t.getRowResizable(o.index,i)&&(o=C)}return o},i.prototype.fD=function(t,n,e,i,r){var o=this,a=C,u=2===n,n=t._y(n,i),n=n[u?0:n.length-1],s,n;return M(n)||0!==n.height||(s=u?n.y:n.y+n.height,n=n.row,A(0,s-e)<=r&&r<=s+e&&(a=U(o.lD(t,n,i),n,i),u)&&(a.E6=!0)),a},i.prototype.lD=function(t,n,e){var i=t.parent;return i&&1===i.options.resizeZeroIndicator&&t.getRowVisible(n)&&0===t._o(n,e)?N:k},i.prototype.dD=function(t,n,e,i,r){var o,a,u,s,c,f,u,s,l,h,d,v,d,m,g,p,g,p,p,m,d,g,c,b,y,o=C;if(Kt(t)){if(a=this,u=t.options.reversalTrailingResizeOrder,s=t.Vy,c=2===B(n),u=u&&(f=c&&s),s=c&&!s||u,!(l=t.Yy(B(n),i))||T(n.col)||T(n.row)){if(T(n.col)&&1===B(n))for(b=3,y=0;y<3&&(o=a.vD(t,y,e,i,r))===C;y++);}else t.getColumnVisible(n.col,i)||(n.col=this.g9(n.col,i)),(h=l.findCol(n.col))&&(v=(d=xt(h.width,e))[0],d=d[1],m=t.getColumnWidth(n.col,i),g=t.zoom(),p=!(u&&l[l.length-1].col===h.col),h.x+(m*=g)-d<=r&&r<=h.x+m+d&&p?(o=U(D,n.col,i),0<=(g=l[l.length-1].col)&&(p=t.G6(i),o.index===p)&&o.index!==g&&h.x+m-d/2<=r&&(o=U(a.mD(t,g,i),g,i)),c&&Lt(o.index,t,i)&&(o.B6=!0),u&&(p=a.uD(o.index,l[l.length-1].col,i),(o=U(a.mD(t,p,i),p,i)).j6=u)):h.x-v<=r&&r<h.x+v&&(0<w.Common.Uf.hD(l,h)||s)&&(m=a.aD(n.col,0,i),o=U(a.mD(t,m,i),m,i),u)&&(o=U(D,n.col,i),(o=0<=(d=l[0].col)&&(g=t.O5(d-1,i,!0),o.index===g)&&o.index!==d&&r<h.x+v/2?U(a.mD(t,d,i),d,i):o).j6=u)),!o&&1===B(n)&&0<l.length&&(h=l[0],A(0,h.x-e)<=r)&&r<=h.x+e&&0<=(c=cn(t,n.col,!1))&&(o=U(a.mD(t,c,i),c,i));(o=o&&t.gD&&t.pD(n,o.index)?C:o)&&!t.getColumnResizable(o.index,i)&&(o=C)}return o},i.prototype.vD=function(t,n,e,i,r){var o=this,a=C,u=2===n,n=t.Yy(n,i),n=n[u?0:n.length-1],s,n;return M(n)||0!==n.width||(s=u?n.x:n.x+n.width,n=n.col,A(0,s-e)<=r&&r<=s+e&&(a=U(o.mD(t,n,i),n,i),u)&&(a.j6=!0)),a},i.prototype.mD=function(t,n,e){var i=t.parent;return i&&1===i.options.resizeZeroIndicator&&t.getColumnVisible(n)&&0===t.Do(n,e)?wt:D},i.prototype.bD=function(t,n,e,i){var r,o,a,u,s,u,c,f,l,a,h,h,h,t,r=this,o=r.Mf,a=o.parent,u=o.options,s=u.colHeaderVisible,u=u.rowHeaderVisible,c=C;return a&&!a.options.allowUserResize||(a=o.Fi(),R(t)<0&&0<=B(t)&&s&&t.row>=o.getFreeAreaRowCount(v.SheetArea.colHeader)?c=(c=r.dD(o,t,i,1,n))||r.cD(o,t,i,1,e):0<=R(t)&&B(t)<0&&u&&t.col>=o.getFreeAreaRowCount(v.SheetArea.rowHeader)?c=(c=r.cD(o,t,i,2,e))||r.dD(o,t,i,2,n):R(t)<0&&B(t)<0?o.P6(2)===C&&x(e-a.qC)<=i?(h=o._y(1))&&0<h.length&&0<=(f=h[h.length-1].row)&&o.getRowResizable(f,2)&&(c=U(r.lD(o,f,2),f,2)):o.G6(1)===C&&x(n-a.XC)<=i&&(h=o.Yy(1))&&0<h.length&&0<=(l=h[h.length-1].col)&&o.getColumnResizable(l,1)&&(c=U(r.mD(o,l,1),l,1)):0<=R(t)&&0<=B(t)&&(f=j(o,1)-1,l=O(o,2)-1,h=o.options.sheetAreaOffset.top,t=o.options.sheetAreaOffset.left,0<=f&&0===a.qC&&h<=e&&e<=i+h&&s?c=U(r.lD(o,f,1),f,1):0<=l&&0===a.XC&&t<=n&&n<=i+t&&u&&(c=U(r.mD(o,l,2),l,2)))),c},i.prototype.yD=function(t,n,e,i){var r,o,a,n,n,n,r,r=this.Mf,o,a=r.Fi().c9(1,1);if(1===n)if((n=r.Yy(n))&&0<n.length){if((n=n[n.length-1]).x+n.width<=e&&e<a.x+a.width)return!0}else if(a.contains(e,i))return!0;if(1===t)if((n=r._y(t))&&0<n.length){if((r=n[n.length-1]).y+r.height<=i&&i<a.y+a.height)return!0}else if(a.contains(e,i))return!0;return!1},i.prototype.pg=function(t){var n=this.uw();this.wD(t,t.pageX-n.left,t.pageY-n.top)},i.prototype.yg=function(){var t,n,e,i,e,e,n,e,t=this.Mf,n=t.sw;n&&(e=n.cellTypeHitInfo)&&(i=t.getCellType(e.row,e.col,L(n))).Ye(e),this.rb||(t.Nk=S,e={x:-1e4,y:-1e4,rowViewportIndex:C,colViewportIndex:C,row:-1,col:-1,resizeInfo:C,hitTestType:C},this.fw(e),n&&(e=n.row,n=n.col,e=t.getActualStyle(e,n),t.MD&&(clearTimeout(t.MD),delete t.MD),t.parent)&&e&&e.showEllipsis&&t.parent.iy())},i.prototype.wD=function(t,n,e){var i,t,n,r,e,o,a,u,s,c,f,l,h,d,f,i=this;i.fk={e:t,x:n,y:e},t=i.Mf,i.ab&&!b.hi.A1(t)&&b.hi.F1(t),i.ab&&i.rb?i.isResizing?i.y9():i.Uk?i.Hk&&i.Hk():i.zk?i.Vk&&i.Vk():i.Yk?i.Zk&&i.Zk():i.Wk?i.Qk():i.Kk?i.Jk():i.Xk?i.qk():i.$k?i.t9&&i.t9():i.ob&&i.Gk():(n=t.hitTest(n,e),i.CD(t,n,i),n&&(0===i.Q6&&n.tableSelectInfo&&i.ab&&i.SD(t,i,n),r=t.parent,e=n.row,o=n.col,a=t.C6(n.rowViewportIndex,n.colViewportIndex),c=n.pivotTableInfo,f=!M(c)&&c.options.showToolTip,r?(s=t.getActualStyle(e,o,a),l=t.getCellRect(e,o,n.rowViewportIndex,n.colViewportIndex),!f||t.isEditing&&t.isEditing()?(clearTimeout(t.MD),delete t.MD,(u=t.Ci(e,o,a))&&!1!==s.hv&&a?r.Tw(Z.j0(u),l.x+l.width+5,l.y+l.height+5,!1):(d=r.options.showScrollTip&&(r.Xb.a4||r.zb.a4||r.Xw.a4))||r.iy()):(u=c.sJt(e,o),h="gc-spread-pivot-toolTip",clearTimeout(t.MD),delete t.MD,r.iy(),u&&!1!==s.hv&&(t.MD=setTimeout(function(t,n){r.Tw(u,t,n+15,!1,h)}.bind(void 0,n.x,n.y),700)))):(clearTimeout(t.MD),delete t.MD),i.cw(n),r&&r.options.enableAccessibility&&(f=t.t2(n),r.n2(f)),i.fw(n)))},i.prototype.CD=function(t,n,e){var i,r,o,a,o;1===e.Q6?(i=e.TD.row,r=e.TD.col,o=n.col,a=t.getSelections()[0],t.kA(i,o<r?o:r,a.rowCount,0<r-o?r-o+1:o-r+1,!0)):2===e.Q6&&(i=e.TD.row,r=e.TD.col,o=n.row,a=t.getSelections()[0],t.kA(o<i?o:i,r,0<i-o?i-o+1:o-i+1,a.colCount,!0))},i.prototype.SD=function(t,n,e){var i,t,i,i=t.getActiveRowIndex(),t=t.getActiveColumnIndex();n.TD={row:i,col:t},"tableColSelect"===(i=e.tableSelectInfo.action)?n.Q6=1:"tableRowSelect"===i&&(n.Q6=2)},i.prototype.cw=function(t){var n,e,i,r,o,a,u,r,u,s,c,f,l,h,d,d,r,u,s,n=this,e=n.Mf,i=e.Dg();i&&(a=!(r=e.sw)||t.row!==r.row||t.col!==r.col||L(t)!==L(r)||t.resizeInfo&&!r.resizeInfo||!t.resizeInfo&&r.resizeInfo||t.resizeInfo&&t.resizeInfo.action!==r.resizeInfo.action||t.dragInfo&&!r.dragInfo||!t.dragInfo&&r.dragInfo||t.dragInfo&&t.dragInfo.action!==r.dragInfo.action||t.resizeTableHitInfo&&!r.resizeTableHitInfo||!t.cellTypeHitInfo&&r.cellTypeHitInfo,r&&a&&(u=r.cellTypeHitInfo)&&(o=e.getCellType(u.row,u.col,L(r))).Ye(u),r=t.resizeInfo,u=t.dragMergeInfo,s=t.dragInfo,c=t.formulaRangeHitInfo,f=t.cellTypeHitInfo,l=e.Dn,h=t.resizeTableHitInfo,(d=t.tableSelectInfo)?"tableRowSelect"===d.action?i.style.cursor="url(data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiIHN0YW5kYWxvbmU9Im5vIj8+CjwhRE9DVFlQRSBzdmcgUFVCTElDICItLy9XM0MvL0RURCBTVkcgMS4xLy9FTiIgImh0dHA6Ly93d3cudzMub3JnL0dyYXBoaWNzL1NWRy8xLjEvRFREL3N2ZzExLmR0ZCI+CjxzdmcgdmVyc2lvbj0iMS4xIiBpZD0iTGF5ZXJfMSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB4bWxuczp4bGluaz0iaHR0cDovL3d3dy53My5vcmcvMTk5OS94bGluayIgeD0iMHB4IiB5PSIwcHgiIHdpZHRoPSI4cHgiIGhlaWdodD0iOHB4IiB2aWV3Qm94PSIwIDAgOCA4IiBlbmFibGUtYmFja2dyb3VuZD0ibmV3IDAgMCA4IDgiIHhtbDpzcGFjZT0icHJlc2VydmUiPiAgPGltYWdlIGlkPSJpbWFnZTAiIHdpZHRoPSI4IiBoZWlnaHQ9IjgiIHg9IjAiIHk9IjAiCiAgICBocmVmPSJkYXRhOmltYWdlL3BuZztiYXNlNjQsaVZCT1J3MEtHZ29BQUFBTlNVaEVVZ0FBQUFnQUFBQUlDQVFBQUFCdUJuWUFBQUFBQkdkQlRVRUFBTEdQQy94aEJRQUFBQ0JqU0ZKTgpBQUI2SmdBQWdJUUFBUG9BQUFDQTZBQUFkVEFBQU9wZ0FBQTZtQUFBRjNDY3VsRThBQUFBQW1KTFIwUUEvNGVQekw4QUFBQUhkRWxOClJRZm1BeDBHTURRVFpSbFpBQUFBUzBsRVFWUUkxMlhOc1ExQVVBQkYwZU9qVWxFYXdTNFM0Mmh0d0JCS0kyQXVJcUhReUhmcW0vZDQKNVZxbGo5eGlWSkRwSlFnYW5jdVF1RC9kYVE0aXFjTm10YXRWSnYxdlZIejdBRU5GRE9OV3daY3lBQUFBSlhSRldIUmtZWFJsT21OeQpaV0YwWlFBeU1ESXlMVEF6TFRJNVZEQTJPalE0T2pVeUt6QXdPakF3VkVsRUpBQUFBQ1YwUlZoMFpHRjBaVHB0YjJScFpua0FNakF5Ck1pMHdNeTB5T1ZRd05qbzBPRG8xTWlzd01Eb3dNQ1VVL0pnQUFBQUFTVVZPUks1Q1lJST0iIC8+Cjwvc3ZnPgo=) 8 4,auto":"tableColSelect"===d.action?i.style.cursor="url(data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiIHN0YW5kYWxvbmU9Im5vIj8+CjwhRE9DVFlQRSBzdmcgUFVCTElDICItLy9XM0MvL0RURCBTVkcgMS4xLy9FTiIgImh0dHA6Ly93d3cudzMub3JnL0dyYXBoaWNzL1NWRy8xLjEvRFREL3N2ZzExLmR0ZCI+CjxzdmcgdmVyc2lvbj0iMS4xIiBpZD0iTGF5ZXJfMSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB4bWxuczp4bGluaz0iaHR0cDovL3d3dy53My5vcmcvMTk5OS94bGluayIgeD0iMHB4IiB5PSIwcHgiIHdpZHRoPSI4cHgiIGhlaWdodD0iOHB4IiB2aWV3Qm94PSIwIDAgOCA4IiBlbmFibGUtYmFja2dyb3VuZD0ibmV3IDAgMCA4IDgiIHhtbDpzcGFjZT0icHJlc2VydmUiPiAgPGltYWdlIGlkPSJpbWFnZTAiIHdpZHRoPSI4IiBoZWlnaHQ9IjgiIHg9IjAiIHk9IjAiCiAgICBocmVmPSJkYXRhOmltYWdlL3BuZztiYXNlNjQsaVZCT1J3MEtHZ29BQUFBTlNVaEVVZ0FBQUFnQUFBQUlDQVFBQUFCdUJuWUFBQUFBQkdkQlRVRUFBTEdQQy94aEJRQUFBQ0JqU0ZKTgpBQUI2SmdBQWdJUUFBUG9BQUFDQTZBQUFkVEFBQU9wZ0FBQTZtQUFBRjNDY3VsRThBQUFBQW1KTFIwUUEvNGVQekw4QUFBQUhkRWxOClJRZm1BeDBHTlRobnBLRTNBQUFBVGtsRVFWUUkxMlhJTVFwQVVBQUEwUGQ5UlprZHdlNFFWanVUZ3pBN25LTllETCtVb3V5ODhRR1QKMjIyQ0hBUVJBVElmdjRocXZVNkxRMm5QSkkwQmpCb0pDb3ZUYVZZUThkaFVOcXVMRjkwZUQzQ2dxdzV5QUFBQUpYUkZXSFJrWVhSbApPbU55WldGMFpRQXlNREl5TFRBekxUSTVWREEyT2pVek9qVTJLekF3T2pBd21XaEVBQUFBQUNWMFJWaDBaR0YwWlRwdGIyUnBabmtBCk1qQXlNaTB3TXkweU9WUXdOam8xTXpvMU5pc3dNRG93TU9nMS9Md0FBQUFBU1VWT1JLNUNZSUk9IiAvPgo8L3N2Zz4K) 8 4,auto":"tableCornerSelect"===d.action?i.style.cursor="url(data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiIHN0YW5kYWxvbmU9Im5vIj8+CjwhRE9DVFlQRSBzdmcgUFVCTElDICItLy9XM0MvL0RURCBTVkcgMS4xLy9FTiIgImh0dHA6Ly93d3cudzMub3JnL0dyYXBoaWNzL1NWRy8xLjEvRFREL3N2ZzExLmR0ZCI+CjxzdmcgdmVyc2lvbj0iMS4xIiBpZD0iTGF5ZXJfMSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB4bWxuczp4bGluaz0iaHR0cDovL3d3dy53My5vcmcvMTk5OS94bGluayIgeD0iMHB4IiB5PSIwcHgiIHdpZHRoPSIxMHB4IiBoZWlnaHQ9IjEwcHgiIHZpZXdCb3g9IjAgMCAxMCAxMCIgZW5hYmxlLWJhY2tncm91bmQ9Im5ldyAwIDAgMTAgMTAiIHhtbDpzcGFjZT0icHJlc2VydmUiPiAgPGltYWdlIGlkPSJpbWFnZTAiIHdpZHRoPSIxMCIgaGVpZ2h0PSIxMCIgeD0iMCIgeT0iMCIKICAgIGhyZWY9ImRhdGE6aW1hZ2UvcG5nO2Jhc2U2NCxpVkJPUncwS0dnb0FBQUFOU1VoRVVnQUFBQW9BQUFBS0NBUUFBQUFuT3djMkFBQUFCR2RCVFVFQUFMR1BDL3hoQlFBQUFDQmpTRkpOCkFBQjZKZ0FBZ0lRQUFQb0FBQUNBNkFBQWRUQUFBT3BnQUFBNm1BQUFGM0NjdWxFOEFBQUFBbUpMUjBRQS80ZVB6TDhBQUFBSGRFbE4KUlFmbUF4MEdOd1BrbVNxUkFBQUFZRWxFUVZRSTExM01zUTJETUJRRTBDZTZVRUxDQnBHeUhOUFEyeVVNeFFRWkFjVXhCV0FCZDkzVAovMGVsTitsYzB2djZDNW96anBJc2lZVnJYc0tGbndab3hKMkR0eWh0RHdjdlpvdDhMTGVDbjd5MzVHTytZeXZlTHg4R3FWQmVBYnlQCk1QNG1OSW4zQUFBQUpYUkZXSFJrWVhSbE9tTnlaV0YwWlFBeU1ESXlMVEF6TFRJNVZEQTJPalUxT2pBekt6QXdPakF3anE0VmhBQUEKQUNWMFJWaDBaR0YwWlRwdGIyUnBabmtBTWpBeU1pMHdNeTB5T1ZRd05qbzFOVG93TXlzd01Eb3dNUC96clRnQUFBQUFTVVZPUks1QwpZSUk9IiAvPgo8L3N2Zz4K) 10 5,auto":"tableSelect"===d.action?i.style.cursor="move":"default"===d.action&&(i.style.cursor=""):r?r.action===D?i.style.cursor=b.CursorResource.ResizeCol:r.action===k?i.style.cursor=b.CursorResource.ResizeRow:r.action===wt?i.style.cursor=b.CursorResource.ResizeHiddenCol:r.action===N?i.style.cursor=b.CursorResource.ResizeHiddenRow:i.style.cursor=Mt:u?u.left||u.right?i.style.cursor="w-resize":(u.top||u.bottom)&&(i.style.cursor="n-resize"):s&&"drag"===s.action?s.side===yt?i.style.cursor="crosshair":s.side?i.style.cursor="move":i.style.cursor=Mt:c?(c.inBorder?i.style.cursor="move":c.inTopLeft?i.style.cursor="nw-resize":c.inTopRight?i.style.cursor="ne-resize":c.inBottomLeft?i.style.cursor="sw-resize":c.inBottomRight&&(i.style.cursor="se-resize"),d=n.isFormulaRangeHovering,u=(r=n.AD)&&r.paramRange,s=c.paramRange,n.isFormulaRangeHovering=!0,n.AD={paramRange:s},d&&s.index===u.index||l.ID()):h?i.style.cursor="se-resize":(f&&(o=e.getCellType(f.row,f.col,L(t)),f.sheet=e,a&&o.processMouseEnter(f),o.ze(f)),!a&&f&&f.isReservedLocation||(i.style.cursor=Mt),n.isFormulaRangeHovering&&(n.isFormulaRangeHovering=!1,n.AD=C,l.ID())))},i.prototype.bg=function(t){var n,e,n=this,e=n.Mf;return n.u2(),!e.vk||(e.vk=!1,n.xD(t),!1)},i.prototype.xD=function(t){var n,e,i,i,r,o,n=this,e=n.Mf,i=b.hi.ai();n.ab=!1,n.Q6=0,i&&i!==e&&i.endEdit&&(i.il&&i.il.rl||(i.endEdit(),i.repaint())),b.hi.F1(e),n.isResizing?n.C9():n.Uk?n.ND&&n.ND():n.zk?n.kD&&n.kD(t):n.Yk?n.DD&&n.DD():n.Wk?n._D():n.Kk?n.ED():n.Xk?n.jD():n.$k?n.OD&&n.OD():e.sw&&(r=(i=e.sw).cellTypeHitInfo,!i.filterButtonHitInfo)&&!i.resizeInfo&&0<=i.row&&0<=i.col&&(r&&(o=e.getCellType(r.row,r.col,L(i)),r.sheet||(r.sheet=e),o.Ve(r)),r&&r.isReservedLocation||e.ki(b.Events.CellClick,H(e,e.name(),i.row,i.col,L(i))),n.X9(),e.RD)&&e.BD&&e.BD(),n.LD=!1,n.yk(t)},i.prototype.FD=function(t,n,e){var i,r,i=this.Mf;!i.isEditing||i!==b.hi.ai()||(r=i.Dg(),P(t))||F(t)||i.m6(r,n,e)},i.prototype.pf=function(t){var n,e,i,r,o,a,i,r,o,u,i,s,a,n=this,e=n.Mf;if(e){if(i=Et(e),r=jt(e),o=e.getCellType(i,r),a={isEditing:_(e),sheet:e,row:i,col:r,sheetArea:3},i={sheet:e,row:i,col:r,sheetArea:3},o&&o.isReservedKey(t,a))return void(_(e)||o.processKeyDown(t,i));if(r={e:t,r:C,c:a},p.Worksheet.et(e,"preProcessKeyDown",r),r.r)return}o=!(_(e)||F(t)||Rt(t)||34!==h(t)&&33!==h(t)&&37!==h(t)&&39!==h(t)&&9!==h(t)&&13!==h(t)&&38!==h(t)&&40!==h(t)),e.Oi&&(e.Oi=!1,e.Dn.PD()),a=27===(i=h(t)),e.RD&&e.GD&&((s=13===i)||a)?e.GD(a):u=o?n.UD?n.HD:n.HD=n.zD(t):n.zD(t),o&&u&&b.hi.A1(e)&&(n.VD=new Date,n.UD?(n.YD<25&&n.YD++,V(t)):(n.UD=!0,n.YD=1,n.ZD(t,!0)))},i.prototype.p9=function(){var t,n,e,i,i,t=this.Mf,n,e=t.sw.resizeInfo;return e.action===k||e.action===N?(i=t.getRowHeight(e.index),c(St().Tip_Height,[i])):(i=t.getColumnWidth(e.index),c(St().Tip_Width,[i]))},i.prototype.w9=function(t){var n=this.Mf;return t.action===k||t.action===N?c(St().Tip_Height,[A(0,l((t.movingY-t.startY)/n.zoom()))]):c(St().Tip_Width,[A(0,l((t.movingX-t.startX)/n.zoom()))])},i.prototype.ZD=function(t,n){var e=this;e.UD&&(new Date-e.VD>(1<e.YD?100:600)?e.V5():(n||(e.HD=e.zD(t)),e.UD&&(e.K6=m.setTimeout(function(){e.ZD(t)},n?500:20))))},i.prototype.WD=function(t,n){var e,i,r,o,i,e=this.Mf,i=e.Dg();if(i){e.Ai=!0;try{r=_(e),e.f6&&e.f6(i,e.ui,e.ci,C,C,!0,C,n,t),!r&&_(e)&&(!(o=e.getCellType(e.ui,e.ci)).j3||32!==h(t)||F(t)||P(t)||Ot(t)||o.j3(e,e.ui,e.ci,3),o.QD)&&o.QD(t)}finally{e.Ai=!1,(i=e.ST()).TT&&delete i.TT}}},i.prototype.zD=function(t){var n,e,i,i,r,o,a,u,s,i,r,c,i,f,n=this,e=n.Mf;if(n.yk(t),_(e)||27!==h(t)||Ot(t)||F(t)||P(t)||!e.KD||((0,d.GC$)(e.KD).remove(),e.KD=C),i=e.ST(),_(e)||27!==h(t)||Ot(t)||F(t)||P(t)||!i.TT||delete i.TT,_(e)||34!==h(t)&&33!==h(t)&&35!==h(t)&&36!==h(t)&&38!==h(t)&&40!==h(t)||V(t),_(e)||37!==h(t)&&39!==h(t)||V(t),_(e)&&F(t)&&(89===h(t)||90===h(t)))V(t);else{if(r=(i=e.Qy()).getShortcutKey(h(t),F(t),P(t),Ot(t),Rt(t)),o=i.getCommands(r))for(a=0;a<o.length;a++)if(u={sheetName:e.name()},(s=o[a].execute(e.parent,u))||u.JD)return s.ignoreCancelDefault||V(t),!0;if(i={e:t,r:C},p.Worksheet.et(e,"processKeyDown",i),i.r)return!0;n.Pi(t)&&((r=e.il)&&r.XD&&r.qD(),(c=_(e))||(f=(i=m.Vc.el(t.target))&&"gcAttachedFormulaTextBox"===i.getAttribute(bt))||n.WD(t))}return!1},i.prototype.V5=function(){var t=this;t.UD=!1,t.HD=S,(t.YD=0)<t.K6&&(clearTimeout(t.K6),t.K6=0)},i.prototype.bf=function(t){var n,e,i,r,o,a,i,r,a,n=this;if(n.V5(),e=n.Mf){if(i=Et(e),r=jt(e),o=e.getCellType(i,r),a={isEditing:_(e),sheet:e,row:i,col:r,sheetArea:3},i={sheet:e,row:i,col:r,sheetArea:3},o&&o.isReservedKey(t,a))return void(_(e)||o.processKeyUp(t,i));if((r=e.il)&&r.$D(t))return;if((a=e.parent&&e.parent.h6)&&a.$D(t))return}n.yk(t)},i.prototype.yf=function(t){var n,e,i,n,e=this.Mf,i={e:t,r:C};p.Worksheet.et(e,"processCompositionStart",i),i.r||this.WD(t,!0)},i.prototype.Pi=function(t){return!(F(t)||Ot(t)||Rt(t))&&(65<=h(t)&&h(t)<=90||48<=h(t)&&h(t)<=59||96<=h(t)&&h(t)<=105||186<=h(t)&&h(t)<=192||220<=h(t)&&h(t)<=222||219===h(t)||106<=h(t)&&h(t)<=111||32===h(t)||61===h(t)||173===h(t)||229===h(t)||0===h(t)||8===h(t))},i.prototype.yk=function(t){var n,e,i,r,o,n=this,e=n.Mf,i,r=(b.mt.Qf()?Rt:F)(t);n.ctrl=r&&!P(t),n.shift=P(t)&&!r,n.isPressShiftKey=P(t),!0===n.zk&&(n.t_=r,o=P(t),n.e_&&(o=!P(t)),n.i_=o,e.Dn.o_)&&e.Dn.o_(),n.a_=r},i.prototype.Y5=function(){var t=this;t.shift=!1,t.ctrl=!1,t.zk=!1,t.i_=!1,t.t_=!1,t.a_=!1},i.prototype.By=function(t){var n,e,i,r,o,a,u,t,s,s,c,f,a,u,e,l,c;t&&t.sheet?(n=t.sheet,e=t.editor,i=t.canvasOffset):e=(n=this.Mf).li,_(n)&&(t=v.SheetArea.viewport,(s=n.vA)?(r=s.row,o=s.col,M(s.sheetArea)||(t=s.sheetArea)):(r=n.ui,o=n.ci),t===v.SheetArea.rowHeader?u=-1:t===v.SheetArea.colHeader&&(a=-1),s=n.getCellType(r,o,t),c=n.Fi(),f=n.getActualStyle(r,o,t),a=n.getCellRect(r,o,a,u),e&&e.parentNode&&(u=e.parentNode.parentNode,e=!1,t===v.SheetArea.rowHeader?e=a.x>=c.x&&a.y>=c.y+c.qC&&a.x+a.width<=c.Py&&a.y+a.height<=c.Ay+c.Iy:t===v.SheetArea.colHeader?e=a.x>=c.x+c.XC&&a.y>=c.y&&a.x+a.width<=c.Hy+c.zy&&a.y+a.height<=c.Cy:t===v.SheetArea.viewport&&(e=a.x>=c.b6&&a.y>=c.T6&&a.x+a.width<=c.Hy+c.zy&&a.y+a.height<=c.Ay+c.Iy),a&&0<a.width&&0<a.height&&e?s.Rn(u,f,a,l={sheet:n,row:r,col:o,sheetArea:t,canvasOffset:i}):(0,d.GC$)(u).css({top:-1e4,left:-1e4})),c=n.il)&&c.u_()},i.prototype.s_=function(t,n){var e,i;if(t)for(e=t.firstChild;e;){if(e.id===n||e.name===n)return e;if(i=this.s_(e,n))return i;e=e.nextSibling}return C},i.prototype._A=function(t,n){var e,i,r,o,e=!0;if(t.length===n.length)for(i=0;i<t.length;i++){if(r=t[i],o=n[i],r.row!==o.row||r.col!==o.col||Bt(r)!==Bt(o)||G(r)!==G(o)){e=!0;break}e=!1}return e},i.prototype.f_=function(t,n,e,i){var r,o,a,u,s,c,f,i,i,n,e,n,t,i,r=this,o=r.Mf,a={sheet:o,row:n,col:e,sheetArea:3},u=o.qc(),s=t.isImeAware(a),f=Ct?at:"fixed";return i&&r.l_(),s&&!r.g6&&(i=(c=t.jn(a)).style,r.h_||(r.h_={overflow:mt,border:gt,position:at}),r.h_.overflow=i.overflow,r.h_.border=i.border,r.h_.position=i.position,(0,d.GC$)(c).css([ot,st,ct,ft,lt,ht,ut],[f,vt,"0px","0px","0px","0px",gt]),o.Ri&&c.firstChild&&(i=c.firstChild.firstChild,o.Ri(t,i,n,e,o.getActualStyle(n,e),S,S,S,S,3),n=t.getEditorValue(i,a),g.safari)&&(""===n||M(n))&&t.setEditorValue(i," ",a),u&&u.insertBefore(c,C),r.g6=c),r.d_||(c=Y("div"),(0,d.GC$)(c).css([ot,st,ct,ft,lt,ht],[f,vt,"0px","0px","0px","0px"]),r.d_=c,e=Y("textarea"),(0,d.GC$)(e).attr(bt,"gcSheetFocusInput").attr(pt,-1).css([ot,st,ut,dt],[at,vt,gt,gt]),r.Mf.parent&&r.Mf.parent.options.enableAccessibility&&(0,d.GC$)(e).attr("aria-hidden","true").attr("role","none").attr("title",""),e.value=" ",c.insertBefore(e,C),r.I1=e,n=Y("div"),(0,d.GC$)(n).css(ot,at).css(st,vt).attr(bt,"gcSheetFocusInput").attr("aria-hidden","true").attr("title","").attr(pt,-1),c.insertBefore(n,C),r.m_=n,u&&u.insertBefore(c,C)),t=m.location!==m.parent.location,i=0<m.scrollX||0<m.scrollY,(Ct||(g.mozilla||g.chrome||g.safari)&&t||i)&&(r.g6&&r.g_(o,r.g6),r.g_(o,r.d_)),s?r.g6:r.I1},i.prototype.p6=function(){var t=this;t.g6&&t.h_&&(0,d.GC$)(t.g6).css(st,t.h_.overflow).css(ut,t.h_.border).css(ot,t.h_.position)},i.prototype.l_=function(){var t=this;t.g6&&(t.g6.parentElement&&t.g6.parentElement.removeChild(t.g6),t.g6.comboBox&&(t.g6.comboBox=C),t.g6=C)},i.prototype.Zg=function(t){b.hi.A1(this.Mf)||this.p_(!0,!0,t)},i.prototype.al=function(){var t=this.m_;t&&t.focus()},i.prototype.aA=function(){this.p_(!0,!0)},i.prototype.b_=function(){this.y_&&(clearTimeout(this.y_),this.y_=C)},i.prototype.p_=function(t,n,e){var i,r,o,a,u,s,c,f,l,h,d,t;0===arguments.length&&(t=!0),(i=this).X6||(i.J6=!1,i.b_(),r=i.Mf,o=Et(r),a=jt(r),u=r.getCellType(o,a),i.f_(u,o,a,n),s={sheet:r,row:o,col:a,sheetArea:3},c=u.isImeAware(s)&&i.g6.firstChild?i.g6.firstChild.firstChild:i.I1,f=c,n&&!g.msie&&u.setImeMode(f,r.getActualStyle(o,a).imeMode,s),z.body.focus(),l=function(){var t=function(){try{u.isImeAware(s)?(u.focus(f,s),u.selectAll(f,s)):(c.focus(),c.select())}catch(t){}};n&&g.msie&&u.setImeMode(f,r.getActualStyle(o,a).imeMode,s),t()},d=g.metroMode||y.ipad||y.iphone||y.android,!r.Oi&&!d||!t&&u.isImeAware(s)?!1===r._enhanceIme||e||i.w_(r)||l():!_(r)&&d?n&&(t=i.g6&&i.g6.firstChild&&i.g6.firstChild.firstChild,u.setImeMode(t,r.getActualStyle(o,a).imeMode,s)):i.y_=m.setTimeout(function(){i.w_(r)||(i.b_(),_(r))||!1===r._enhanceIme||e||l()},200),b.hi.A1(r)||i.w_(r)||b.hi.F1(r),i.M_(r))||i.PA&&i.PA(r.ui,r.ci)},i.prototype.g_=function(t,n){var t,e,e,i,r,o,e,i,r,o,t,i,a,t,u,s,c,u,i,c,s,e=Et(t),i=jt(t),r=t.R9,o=t.B9,e=t.getCellRect(e,i,r,o),i=this,r=t.uw(),o=i.it(),t=i.g6,i=0,a=0;t&&(t=(0,d.GC$)(t),i=parseInt(t.css(ht),10),a=parseInt(t.css(lt),10)),t=e.y+o.top-2,e=e.x+o.left-2,u=m.pageYOffset,s=m.pageXOffset,(c="fixed"===n.style.position&&!ln(n))&&(t-=u,e-=s),u=c?0:u-r.top+o.top,i=m.innerHeight+u-i,c=c?0:s-r.left+o.left,s=m.innerWidth+c-a,(T(t)||t<u||i<t)&&(t=u),(T(e)||e<c||s<e)&&(e=c),(0,d.GC$)(n).css(ct,t).css(ft,e)},i.prototype.C_=function(t){var n,e,i,t,e,n=this;n.b_(),_(n.Mf)||n.J6&&z.activeElement===n.m_||(e=n.Mf,t=t?(i=t.row,t.col):(i=e.ui,e.ci),e=e.getCellType(i,t),n.f_(e,i,t,!1),n.m_.focus(),n.J6=!0)},i.prototype.S_=function(t,n){var e=this;e.J6&&(e.J6=!1,n||e.p_(t))},i.prototype.IT=function(t){var n,e,n,e=this.Mf.ST();e&&(e.YS(t),e.ZS(),this.X6=!0,t)&&e.WS()},i.prototype.NT=function(){var t,n,t=this,n=t.Mf.ST();n&&n.YS(""),t.X6=!1,t.p_(!0,!1)},i.prototype.T_=function(){var t,n,t=this;t.b_(),(n=t.g6)&&((0,d.GC$)(n).remove(),t.g6=S),(n=t.d_)&&((0,d.GC$)(n).remove(),t.I1=S,t.d_=C,t.m_=C)},i.prototype.Tw=function(t,n,e,i){var r=this.Mf.parent;r&&r.Tw(Z.j0(t),n,e,i)},i.prototype.ny=function(t,n,e,i){var r=this.Mf.parent;r&&r.ny(t,n,e,i)},i.prototype.iy=function(){var t=this.Mf.parent;t&&t.iy()},i.prototype.fw=function(t){var n,e,i,r,o,a,a,u,a,s,i,r,i,u;function c(t,n){var e=!1;return t||n?t&&n&&(e=t.action===n.action&&t.index===n.index&&t.sheetArea===n.sheetArea):e=!0,e}i=(e=(n=this).Mf).A_,r=e.I_,a=!1,a=(a=(a=(o=e.sw)?a:!0)||t?a:!0)||t.col!==o.col||t.row!==o.row||B(t)!==B(o)||R(t)!==R(o)||L(t)!==L(o)||!c(t.resizeInfo,o.resizeInfo),e.sw=t,a&&(u=(a=e._1)&&a.isEnable(v.RowColumnStates.hover,!0),a=a&&a.isEnable(v.RowColumnStates.hover,!1),s=t.hitTestType,o&&!M(o.hitTestType)&&(e.A_=null,e.I_=null,e.Ut.setCellState(i,r,v.CellStatesType.hover,!1,o.hitTestType),u&&e.x_(i,o.rowViewportIndex,o.colViewportIndex),a&&e.N_(r,o.rowViewportIndex,o.colViewportIndex),u||a||e.k_&&e.k_(v.CellStatesType.hover,i,r,o.hitTestType,o.rowViewportIndex,o.colViewportIndex)),t&&!M(s)&&(i=void 0!==t.row&&void 0!==t.col&&s===v.SheetArea.viewport,e.A_=t.row,e.I_=t.col,t.resizeInfo||(e.Ut.setCellState(t.row,t.col,v.CellStatesType.hover,!0,s),u&&i&&e.x_(t.row,t.rowViewportIndex,t.colViewportIndex),a&&i&&e.N_(t.col,t.rowViewportIndex,t.colViewportIndex),u)||a||e.k_&&e.k_(v.CellStatesType.hover,t.row,t.col,s,t.rowViewportIndex,t.colViewportIndex)),e.D_=!0,i=kt(e,o,r=e.Dn),u=kt(e,t,r),i=i||u,e.D_=!1,(i||e.gD)&&r.E1(),e.NMi)&&e.NMi.options.isDesignMode&&1===s&&r.E1(S,S,S,S,1)},i.prototype.j9=function(t,n,e){var t=this.__(t,n,e);return this.E_(t)},i.prototype.__=function(t,n,e){var i,r,o,i=this.Mf.Ut.getSpan(t,n),r=Bt(i),o=G(i);return 1===r&&1===o||e&&1===r||!e&&1===o?i:(e?n++:t++,this.__(t,n,e))},i.prototype.E_=function(t){for(var n,e,i,r,o,a,n=this.Mf,e=t.row,r=j(n),i=e;i<r&&!0!==n.getRowVisible(i);i++);for(i<r&&(e=i),o=t.col,a=O(n),i=o;i<a&&!0!==n.getColumnVisible(i);i++);return f(e,o=i<a?i:o,Bt(t),G(t))},i.prototype.M_=function(t){var n,e,i,r,n=t.floatingObjects&&t.floatingObjects.all(),e=t.shapes&&t.shapes.all();if(!M(n))for(i=0;i<n.length;i++)if(n[i].isSelected())return!0;if(!M(e))for(r=0;r<e.length;r++)if(e[r].isSelected())return!0},i.prototype.w_=function(t){return"function"==typeof t.isShapeTextEditorOpened&&t.isShapeTextEditorOpened()},i.prototype.j_=function(t){var r,n,e,o,a,e,n,i,u,u,i,r=this.Mf,n=t.resizeInfo;return n?(e=r.Ut.getSelections(),n.action===k||n.action===N?(o=[],r.S9(n.index)?s(e,function(t,n){var e,i;if(-1===n.col)for(e=r.JS(n),i=0;i<Bt(e);i++)o.push({row:e.row+i})}):o.push({row:n.index}),r.Qy().execute({cmd:"autoFitRow",sheetName:r.name(),rows:o,columnHeader:1===n.sheetArea})):(a=[],r.T9(n.index)?s(e,function(t,n){var e,i;if(-1===n.row)for(e=r.JS(n),i=0;i<G(e);i++)a.push({col:e.col+i})}):a.push({col:n.index}),r.Qy().execute({cmd:"autoFitColumn",sheetName:r.name(),columns:a,rowHeader:2===n.sheetArea})),!0):(e=t.row,n=t.col,i=t.hitTestType,(u=r.O_(t.rowViewportIndex,t.colViewportIndex,t.hitTestType,t.row,t.col))&&(e=u.row,n=u.col),u=void 0,i=r.getFormula&&r.getFormula(e,n,i,!0),r.f6(r.fg,e,n,t.rowViewportIndex,t.colViewportIndex,!1,u=i?"="+i:u,!1),!1)},It=i,o.nk=It,p.Worksheet.ch("eventHandler",{beforeSetHost:function(){var t=this;t.rt=new It(t)},dispose:function(t){var n,e,i,r,r,i,n=this,e=n.rt;e&&(e.u2(),i=e.tk,(0,d.GC$)(n.Dg()).unbind(Q+"."+i).unbind(J+"."+i).unbind(K+"."+i).unbind(X+"."+i).unbind(tt+"."+i).unbind(nt+"."+i),g.mozilla&&(r="onwheel"in document?$:q,(0,d.GC$)(n.Dg()).unbind(r+"."+i)),e.L0(),e.T_()),(r=n.li)&&(0,d.GC$)(r).remove(),(i=n.R_)&&(i.close(),n.R_=null),!1!==t.clearCache&&(n.B_=C,n.L_=C,n.F_=C,n.P_=C,n.G_=C,n.U_=C,n.rt=C)},setHost:function(t){var f,i,n,e;function r(t,n){var e,i,e,r,o,e=f.uw(),i=n.pageX-e.left,e=n.pageY-e.top,r=f.hitTest(i,e),o=r.dragInfo;r.tableSelectInfo||(o&&t.H_&&"corner"===o.side?t.H_():t.FD(n,i,e))}t&&(i=(f=this).rt,f.B_=function(t){var n={e:t,r:C};if(p.Worksheet.et(f,"preProcessMouseDown",n),!n.r)return i.gg(t)},f.L_=function(t){var n={e:t,r:C};p.Worksheet.et(f,"preProcessMouseMove",n),n.r||i.p4||i.pg(t)},f.F_=function(t){var n={e:t,r:C};return p.Worksheet.et(f,"preProcessMouseUp",n),n.r||f.f2||i.p4?void 0:i.bg(t)},f.P_=function(t){var n,n,e,i,r,o,a,u,s,c,e,s,n={e:t=t||m.event,r:C};if(p.Worksheet.et(f,"preProcessMouseWheel",n),!n.r)return e=(n=f.parent)&&n.options.scrollByPixel,i=t.detail||t.wheelDelta/-40,r=0,"wheel"===t.type?(o=17,a=g.mozilla&&88<=+g.version?17:1,i=t.deltaY/a,r=t.deltaX/a,e||(x(i)>=x(r)?r=0:i=0)):(u=(new Date).valueOf(),s=t.wheelDeltaY,c=t.wheelDeltaX,e||(x(s)>=x(c)?c=0:s=0),e=!f.z_||200<u-f.z_,(g.safari||g.chrome)&&(a=g.safari?-4:-40,M(s)||(e?(i=(0<=(i=s/a)?1:-1)*l(x(i)),f.V_=0):(f.V_+=i=s/a,i=(0<=i?1:-1)*l(x(f.V_)),f.V_-=i)),M(c)||(e?(r=(0<=(r=c/a)?1:-1)*l(x(r)),f.Y_=0):(f.Y_+=r=c/a,r=(0<=r?1:-1)*l(x(f.Y_)),f.Y_-=r))),f.z_=u),(0!==i||0!==r)&&(s=f.parent.ib.Mg(f,t,et(i,10)||0,et(r,10)||0),n.iy(),!!s)&&void 0},f.G_=function(t){var n={e:t,r:C};if(p.Worksheet.et(f,"preProcessMouseOut",n),!n.r)return i.yg(t)},f.U_=function(t){var n,n,e,n={e:t,r:C};p.Worksheet.et(f,"preProcessMouseDbClick",n),n.r||(n=f.sw)&&(e=!1,3===L(n)?r(i,t):e=i.j_(n),e||f.ki(b.Events.CellDoubleClick,H(f,f.name(),n.row,n.col,L(n))))},n=i.tk,t.bind(Q+"."+n,function(t){return f.B_(t)}).bind(J+"."+n,function(t){return f.F_(t)}).bind(K+"."+n,function(t){return f.L_(t)}).bind(X+"."+n,function(t){return f.P_(t)}).bind(tt+"."+n,function(t){return f.G_(t)}).bind(nt+"."+n,function(t){return f.U_(t)}),g.mozilla)&&(e="onwheel"in document?$:q,t.bind(e+"."+n,function(t){return f.P_(t)}))}}),t.Hv.ch("worksheet-event",{preProcessMouseMove:function(t){var n,n,n=this.Vv.getActiveSheet();n&&(n=n.rt)&&n.ab&&n.rb&&n.isResizing&&(n.pg(t.e),t.r=!1)}})},"./dist/core/worksheet/worksheet-formatter.js":function(t,n,u){"use strict";var e,i,r,o,a,l,s,h,c,d,v,m;function f(t,n,e,i,r){var o,n,a,o=n.getRange(e,i);if(n.source&&(t=n.source.Mf),n=o.row,a=o.col,r)if(1===o.rowCount)a=i;else{if(1!==o.colCount)return d;n=e}return g(t,n,a)}function g(t,n,e){var i,r,o,r,t,r,i=t.getFormatter(n,e);return i&&"General"!==i?w(i,function(t,n){return a.Be.Re(t,n)}):(r=t.getStyle(n,e),(o=r&&r._autoFormatter)?w(o.formatCached,function(t,n){return o.format(t)}):(t=(r=t.pivotTables)&&r.findPivotTable(n,e))&&(i=(r=t.hqt(n,e))&&r.formatter)?w(i,function(t,n){return a.Be.Re(t,n)}):d)}function p(t,n){var n=s(t,"E")&&n(1,t);return n&&s(n,"E")}function b(t,n){var n=n(123,t);return s(n,"123")&&0<(n=n.replace(/[1230. ]+/g,"")).length}function y(t,n){var n;if(t=t.replace("DBNum",""),e.Common.$T.qT("[mMdDyYhHseg]").test(t))return n=n(123,t),!s(n,"123")}function w(t,n){var e,i,r,o;if("="===t[0])return d;if(e={f:t},y(t,n)){if(i=n(44955,t),r=n(44955.11,t),o=n(45323,t),i!==r)return e.t=i===o?6:8,e;if(i!==o)return e.t=7,e}if(s(t,"%"))e.t=0;else if(s(t,"/"))e.t=4;else if(p(t,n))e.t=3;else if(b(t,n))e.t=5;else if(s(t,"0")||s(t,"DBNum",!0))e.t=2;else if(s(t,"GENERAL",!0))e.t=1;else{if(!s(t,"@"))return d;e.t=9}return e}function M(t,n,e,i,r){var e,t,e=e.value;if(e&&2===e.type)return{f:"0.00%",t:0};if(e&&9===e.type)if(0===e.operatorType||1===e.operatorType){if(e.value&&2===e.value.type)return{f:"0.00%",t:0}}else if(2===e.operatorType)return(t=M(t,n,e,i,r))&&0===t.t&&(t.f=t.f.replace("%","00%")),t;return d}function C(t,n,e,i,r){var o,t,o=A(t,n,e.value,i,r),t=A(t,n,e.value2,i,r);if(7===o.t||8===o.t){if(7===t.t||8===t.t)return d;if(6===t.t)return 8===o.t?o:{f:o.f+" "+t.f,t:8}}else if(6===o.t){if(8===t.t)return t;if(7===t.t)return{f:t.f+" "+o.f,t:8}}return 0===o.t&&0===t.t?{f:(t.f.length>o.f.length?t:o).f,t:0}:1!==o.t?o:t}function S(t,n,e,i,r){var o,t,o=A(t,n,e.value,i,r),t=A(t,n,e.value2,i,r);return 9===o.t?o:9===t.t?t:5<=o.t?5<=t.t?d:o:5<=t.t?t:3===o.t?o:3===t.t?t:4===o.t?o:4===t.t?t:2!==o.t&&1!==o.t&&2!==t.t&&1!==t.t&&0===o.t&&0===t.t?{f:(t.f.length>o.f.length?t:o).f,t:0}:d}function T(t,n,e,i,r){var o,a,u,s,c,f,o=e.functionName&&e.functionName.toUpperCase(),a=m[o];if(l(v[o]))return"number"==typeof a?A(t,n,f=e.arguments[a],i,r):a?a(t,n,e,i,r):d;switch(v[o]){case 6:u="H:mm:ss";break;case 7:u=h.Fe().DateTimeFormat.shortDatePattern||"M/d/yyyy";break;case 8:u=h.Fe().DateTimeFormat.defaultDatePattern||"M/d/yyyy H:mm:ss";break;case 0:u="0.00%";break;case 5:s=h.Fe().NumberFormat.currencySymbol||"$",u=(c=h.Fe().predefinedFormats.Currency)&&c[c.length-1]||"".concat(s,"#,##0.00_);[Red](").concat(s,"#,##0.00)")}return{f:u,t:v[o]}}function A(t,n,e,i,r){if(e)if(9===e.type){if(2===e.operatorType)return M(t,n,e,i,r);if(3===e.operatorType||4===e.operatorType)return C(t,n,e,i,r);if(5===e.operatorType||6===e.operatorType||7===e.operatorType)return S(t,n,e,i,r);if(0===e.operatorType||1===e.operatorType)return A(t,n,e.value,i,r)}else{if(1===e.type||13===e.type||22===e.type)return f(t,e,i,r);if(7===e.type)return T(t,n,e,i,r);if(10===e.type)return A(t,n,e.value,i,r)}return d}function I(t,n,e,i,r){var o=t.getFormatter(i,r);o&&"GENERAL"!==o.toUpperCase()||(e=t.oMt.Fyt(i,r)||e,x(t,i,r,A(t,n,e,i,r)))}function x(t,n,e,i){var r=t.Z_(n,e)||new o.Style;(i="string"==typeof i?w(i,function(t,n){return a.Be.Re(t,n)}):i)&&1!==i.t?r._autoFormatter=new c(i.f):delete r._autoFormatter,delete r.formatter,t.setStyle(n,e,r)}Object.defineProperty(n,"__esModule",{value:!0}),n.Lfe=n.Pue=n.Gue=void 0,e=u("Common"),i=u("./dist/core/util/domUtil.js"),r=u("./dist/core/worksheet/worksheet.js"),o=u("./dist/core/worksheet/style.js"),a=u("./dist/core/util/common.js"),l=e.Common.lt.ht,s=e.Common.zf.OS,h=e.Common.CultureManager,c=e.Formatter&&e.Formatter.GeneralFormatter,d={t:1},i.GC$.extend(r.Worksheet.prototype,{getFormatter:function(t,n,e){return this.l0(t,n,"formatter",e)},setFormatter:function(t,n,e,i){var r=this.Z_(t,n,i),r;(r=r||new o.Style).formatter=e,this.setStyle(t,n,r,i)}}),r.Worksheet.ch("formatter",{settingText:function(t){var n,n,n=a.util.Kf(t.value);c&&n&&(n={},(new c).getPreferredDisplayFormatter(t.value,n),"number"==typeof n.value)&&(t.value=n.value)}}),v={NOW:8,TODAY:7,TIME:6,DATE:7,IRR:0,XIRR:0,MIRR:0,RATE:0,YIELD:0,INTRATE:0,NPV:5,XNPV:5},(m={SUM:0,MAX:0,MIN:0,AVEDEV:0,FLOOR:0,ROUND:0,ROUNDUP:0,ROUNDDOWN:0,INT:0,TRUNC:0}).SINGLE=m["@"]=function(t,n,e,i,r){var e=e.arguments[0];return!e||1!==e.type&&13!==e.type?d:f(t,e,i,r,!0)},m.INDIRECT=m.OFFSET=m.INDEX=function(i,t,n,r,o){var e,a,e=u("SheetsCalc"),a=d;return e&&(n.Uue=function(t,n,e){a=l(n)?f(i,t,r,o):g(e&&e.Mf||i,t,n)},e.evaluateExpression(i,n,r,o)),a},n.Gue=A,n.Pue=I,n.Lfe=x},"./dist/core/worksheet/worksheet-json.js":function(r,t,n){"use strict";var t,V,Y,Z,gt,W,e,I,pt,o,bt,i,yt,d,n,wt,n,a,x,u,xt,c,Q,J,Mt,K,Ct,N,X,St,Nt,v,m,l,g,kt,M,k,D,s,f,Dt,S,_,Tt,p,b,w,E,T,h,_t,Et,jt,Ot,y,Rt,Bt,Lt,j,et,q,$,At,C,O,R,B,It,n;function A(t,n){return St(t)?n:St(n)?t:Math.max(t,n)}function L(t,n,e,i){var t,t;t.dataTable&&(n.dataTable||(n.dataTable={}),t=t.dataTable[e])&&(n.dataTable[e]||(n.dataTable[e]={}),t=t[i])&&(n.dataTable[e][i]||(n.dataTable[e][i]={}),t.formula)&&(n.dataTable[e][i].formula=t.formula)}function it(t,n,e,i,r){var o,a,u,s,c,f,l,h,d,v,m,o=t.Ut,a=o.W_(),u=o.W_(pt.SheetArea.colHeader),s=o.Q_(!0),c=o.Q_(!0,pt.SheetArea.colHeader),f=o.K_(),l=o.K_(pt.SheetArea.colHeader),h=a.getColumnCount();for(!r&&St(n.colHeaderData)?n.colHeaderData={}:o.ap=e,u.setRowCount(e),d=0;d<e;d++)for(u.setNode(d,-1,a.J_(d,-1)),c.X_(d,s.q_(d)),v=i;v<h;v++)u.setNode(d,v,a.J_(d,v)),r||L(n.data,n.colHeaderData,d,v);(m=f.getSpans((0,gt.Ec)(0,0,e,h))).forEach(function(t){l.add(t)}),t.frozenRowCount(0)}function rt(t,n,e,i,r){var o,a,u,s,c,f,l,h,d,v,m,o=t.Ut,a=o.W_(),u=o.W_(pt.SheetArea.rowHeader),s=o.Q_(!1),c=o.Q_(!1,pt.SheetArea.rowHeader),f=o.K_(),l=o.K_(pt.SheetArea.rowHeader),h=a.getRowCount();for(!r&&St(n.rowHeaderData)?n.rowHeaderData={}:o.fp=e,u.setColumnCount(e),d=0;d<e;d++)for(u.setNode(-1,d,a.J_(-1,d)),c.X_(d,s.q_(d)),v=i;v<h;v++)u.setNode(v,d,a.J_(v,d)),r||L(n.data,n.rowHeaderData,v,d);(m=f.getSpans((0,gt.Ec)(0,0,h,e))).forEach(function(t){l.add(t)}),t.frozenColumnCount(0)}function F(t,n){switch(t){case"frozenRowCount":case"frozenColCount":case"frozenTrailingRowCount":case"frozenTrailingColCount":case"activeRow":case"activeCol":return 0===n;case"rowCount":return 200===n;case"columnCount":return 20===n;case"zoomFactor":case"rowHeaderColCount":case"colHeaderRowCount":return 1===n;case"visible":return!0===n}}function tt(t,n){return K(t)?t:n}function nt(t,n,e){K(e)&&n.call(t,e,!1)}function ot(e,i,r,o,a,u){Mt&&Ct(Mt,function(t,n){var n=n.fromJson;n&&n.call(e,i,r,o,!K(a)||a,u)})}function P(t,n){var e,i,r,o,a,u,s,c,f,l,e=t.Ut.t8.anchors;for(i in e)if(o=e[i],a=n[r=+i],o&&a)for(u in o)(c=o[u])&&(f=a[s=+u])&&(l={row:c.row,rowCount:c.rowCount,col:c.col,colCount:c.colCount,isDynamicArray:!0},c.isValid||(l.isInvalid=!0),f.arrayInfo=l)}function G(t,n){var n=k(n,_t+"&tabColor");n&&(t.sheetTabColor=f(n))}function U(t,n,e){dt(t,n,e),bt.Util.wo(e,t.parent&&t.parent.v2)&&H(t,e)}function H(t,n){Q&&t.Lp.resumeAdjust(),Gt(t,n)}function z(t){var t,n,e,t,t=M(t,Et);return t&&t.ref&&(t=S(t.ref,!0))&&(n=t.row+t.rowCount,e=t.col+t.colCount),{rowCount:n=St(n)||n<-1?V.Worksheet.n8:n,colCount:e=St(e)||e<-1?V.Worksheet.e8:e}}function at(t,n){var t,n,e,t=t.defaults,n=M(n,Bt);n&&(e=n.defaultColWidth,isNaN(e)?(t.colWidth=gt.SJSColumnWidthHelper.defaultColumnWidthToPixel(8),t._isExcelDefaultColumnWidth=!0):t.colWidth=gt.SJSColumnWidthHelper.columnWidthToPixel(parseFloat(e)),t.rowHeight=gt.SJSColumnWidthHelper.pointToPixel(n.defaultRowHeight))}function ut(r,o,a,e){var t,i,n,u,s,c,f,l,h,d,v,m,g,p,b,y,w,w,M,M,C,w,n,M,d,t=k(o,"sheetViews&sheetView"),i=r.Ut,n=r.options,d=!a||!1!==a.includeStyles,v=bt.Util.Co(a),m=r.getRowCount(),g=r.getColumnCount(),p=o.lossless,b=0,y=0;t&&((w=t.topLeftCell)&&(f=S(w),b=f?f.row:0,y=f?f.col:0),t.zoomScale&&r.zoom(t.zoomScale/100),w=n.gridline,(M=o.lossless&&o.lossless.gridline)?(w.showHorizontalGridline=!!St(M.showHorizontalGridline)||M.showHorizontalGridline,w.showVerticalGridline=!!St(M.showVerticalGridline)||M.showVerticalGridline):"0"===t.showGridLines&&(w.showHorizontalGridline=!1,w.showVerticalGridline=!1),M&&!St(M.color)?w.color=M.color:t.colorId&&64!=+t.colorId&&(w.color=gt.ColorHelper.getIndexedColor(t.colorId)),T(t.showRowColHeaders,!0)||(n.rowHeaderVisible=!1,n.colHeaderVisible=!1),T(t.showFormulas)&&(n.showFormulas=!0),n.showZeros=T(t.showZeros,!0),T(t.tabSelected)&&r.b2(!0,!1),M=D(t,"pane"),C=3,d&&M&&0<M.length&&M.forEach(function(t){var n,n,t,e,i,n=t.state;"frozen"!==n&&"frozenSplit"!==n||(t.topLeftCell&&(c=t.topLeftCell),n=t.xSplit,t=t.ySplit,e=b,i=y,t&&m<=(l=+t+e)&&(m=A(m,l)),n&&g<=(h=+n+i)&&(g=A(g,h)),lt(r,o,a,l,h),t&&n?(f=S(c),b=f.row||0,y=f.col||0):t&&!n?(f=S(c),b=f.row||0,y=i):!t&&n&&(f=S(c),b=e,y=f.col))}),d&&ht(r,o),d&&(p&&p.defaultStyle?((w=new Y.Style).fromJSON(p.defaultStyle,At,r),r.setDefaultStyle(w)):e.defaultStyle&&r.setDefaultStyle(e.defaultStyle)),(n=D(t,"selection"))&&0<n.length&&n.forEach(function(t){var n,n,n,t,n=t.activeCell;n&&(n=S(n),u=n.row,s=n.col,m=A(m,n.row+1),g=A(g,n.col+1)),n=t.panel,!(t=t.sqref)||n&&3!==n||(i.selectionModel.selections=_(t),v&&bt.Util.Ao(r,i.selectionModel.selections,At,e))}),v)&&bt.Util.So(r,m,g,e),M=p?tt(p.rowHeaderColCount,V.Worksheet.r8):V.Worksheet.r8,d=p?tt(p.colHeaderRowCount,V.Worksheet.o8):V.Worksheet.o8,r.setColumnCount(M,pt.SheetArea.rowHeader),r.setRowCount(d,pt.SheetArea.colHeader),r.O6(u||0,s||0,At,At,!0),r.showCell(b,y,pt.VerticalPosition.top,pt.HorizontalPosition.left)}function st(h,t,d,v,n,m){var g,e,p,i,i,b,y,w,e,g=!n||!1!==n.includeStyles,e=h.Ut,p=e.Q_(!1,3),i=M(t,Lt),i=i&&i.c_,b=e.W_(3),y=b.a8,w=E(n);i&&0<i.length&&i.forEach(function(t,n){var e,r,i,o,a,a,u,s,c,f,l,e=t.width,r=t.hidden,i=t.outlineLevel,a=b.J_(-1,n,!0),a=a&&a.style,u=+t.min,s=+t.max,c=C;for(St(e)||(c=gt.SJSColumnWidthHelper.columnWidthToPixel(parseFloat(e)),"1"===r&&0===c&&(c=At)),r="1"===r&&St(i)?r:C,w?t.t!==At?o=d.getOriginNamedStyle(t.t):t.e!==At&&(o=B(d.getOriginStyle(t.e))):o=d.getStyle(t.style),y&&x(y.style,-1,n,a,o),o=g&&o?o:C,1==u&&s===V.MAX_COLUMN_COUNT&&(m.dataEffectByInflate[h.name()]||(m.dataEffectByInflate[h.name()]={}),m.dataEffectByInflate[h.name()].setColumnInfo=function(t){var n,e,i;if(!(t.col<0||t.colCount<=0))for(n=t.col,e=0,i=t.colCount;e<i;e++)c!==C&&p.setSize(n+e,c),r!==C&&h.setColumnVisible(n+e,!1),o!==C&&h.setStyle(-1,n+e,o)}),s=s===V.MAX_COLUMN_COUNT?A(u,v):+t.max,f=u;f<=s;f++)l=f-1,c!==C&&p.setSize(l,c),r!==C&&h.setColumnVisible(l,!1),o!==C&&h.setStyle(-1,l,o)}),(e=t.lossless&&t.lossless.colInfos)&&e.forEach(function(t,n){St(t)||(St(t.colTag)||(h.setTag(-1,n,t.colTag),delete t.colTag),p.X_(n,t))})}function ct(t,n){var n,e,i,n=M(n,Ot);n&&(e=t.spanModels[3],(i=n.c_).forEach(function(t){var t=S(t.ref);e.find(t.row,t.col)||e.add(t)}))}function Ft(t,o,a){var n,u;if(0<t.length)return n={n_:y},u=[],t.forEach(function(t){var n,e,e,e,i,r,r,i,r,n={n_:yt.XFileConstants.ku,lossless:{}},e=o[t.row+","+t.col],e=Tt(e||(0,gt.Ec)(t.row,t.col,1,1));n.ref=e,(i=(e=t.hyperlink).url)&&(i.substring(0,(r="sjs://").length)===r?n.location=s(i.replace(r,"")):(r=yt.XFileConstants.Rr+bt.Util.wr(a),a.c_.push({n_:yt.XFileConstants.Lr,Id:r,Target:s(i),Type:yt.RelationshipConstants.pc,TargetMode:yt.XFileConstants.Cu}),n[h]=r),"string"==typeof(i=t.value))&&(n.display=s(i)),e.tooltip&&(n.tooltip=s(e.tooltip)),r=n.lossless,St(e.visitedLinkColor)||(r.visitedLinkColor=e.visitedLinkColor),St(e.drawUnderline)||(r.drawUnderline=e.drawUnderline),St(e.command)||(r.command=e.command),St(e.target)||(r.target=e.target),St(e.linkColor)||(r.linkColor=e.linkColor),u.push(n)}),n.c_=u,n}function ft(s,t){var n,n,c,f,n=M(t,y);n&&(n=n.c_)&&(c=s.Ut.sheetModels[3].dataTable,f=t.rels&&t.rels.c_||[],n.forEach(function(t){var n,e,n,i,r,r,o,a,o,u,u,n=t.ref.split(":"),e=m(n[0]),n=v(n[0]),i=l(t.tooltip);t[h]&&(r=g(f,t[h]),r=l(r&&r.Target)),(o=l(t.location))&&(r=r?r+"#"+o:"sjs://"+(o="#"===o[0]?o.substr(1):o)),o="hyperlink",o="string"==typeof(a=c[e]&&c[e][n]&&c[e][n].style)?(u=s.u8(a))&&u.foreColor:a&&a.foreColor,u=t.lossless||{},s.setHyperlink(e,n,{url:r,tooltip:i,linkColor:u.linkColor||o,visitedLinkColor:u.visitedLinkColor||"followedHyperlink",drawUnderline:!!St(u.drawUnderline)||u.drawUnderline,command:u.command,target:u.target||0},3)}))}function lt(t,n,e,i,r){t.frozenRowCount(i),t.frozenColumnCount(r)}function ht(t,n){var n=n.lossless;n&&(nt(t,t.frozenTrailingRowCount,n.frozenTrailingRowCount),nt(t,t.frozenTrailingColumnCount,n.frozenTrailingColCount),t.Ny=!K(n.frozenTrailingRowStickToEdge)||n.frozenTrailingRowStickToEdge,t.Vy=!K(n.frozenTrailingColumnStickToEdge)||n.frozenTrailingColumnStickToEdge,St(n.frozenlineColor)||(t.options.frozenlineColor=n.frozenlineColor))}function dt(t,n,e){var i=e&&e.frozenColumnsAsRowHeaders,e=e&&e.frozenRowsAsColumnHeaders,r=t.frozenRowCount(),o=t.frozenColumnCount();0<r&&e&&it(t,At,r,o,!0),0<o&&i&&rt(t,At,o,r,!0)}function vt(t,n){var e,i,r,o,a,u,e=t.options,i=M(n,"sheetProtection"),r=e.protectionOptions;if(i)for(o in i.algorithmName&&i.hashValue&&i.saltValue&&i.spinCount&&(t.oue={algorithmName:i.algorithmName,hashValue:i.hashValue,saltValue:i.saltValue,spinCount:+i.spinCount}),delete i.algorithmName,delete i.hashValue,delete i.saltValue,delete i.spinCount,i)if(i.hasOwnProperty(o))switch(u="0"===(a=i[o]),o){case yt.XFileConstants.ru:e.isProtected="1"===a;break;case"selectLockedCells":r.allowSelectLockedCells=u;break;case"selectUnlockedCells":r.allowSelectUnlockedCells=u;break;case"autoFilter":r.allowFilter=u;break;case"sort":r.allowSort=u;break;case"insertColumns":r.allowInsertColumns=u;break;case"insertRows":r.allowInsertRows=u;break;case"deleteColumns":r.allowDeleteColumns=u;break;case"deleteRows":r.allowDeleteRows=u;break;case"objects":r.allowEditObjects=u;break;default:"1"===i[o]||"0"===i[o]?r[o]="0"===i[o]:"n_"!==o&&"c_"!==o&&(r[o]=i[o])}e.isProtected&&!0!==r.allowEditObjects&&i.objects===At&&(r.allowEditObjects=!0)}function mt(n,e){var i={sheetAreaOffset:function(t){St(t.left)||(n.sheetAreaOffset.left=t.left),St(t.top)||(n.sheetAreaOffset.top=t.top)}};e&&e.sheetOptions&&Object.keys(e.sheetOptions).forEach(function(t){St(e.sheetOptions[t])||(i[t]&&"function"==typeof i[t]?i[t](e.sheetOptions[t]):n[t]=e.sheetOptions[t])})}function Pt(t,n){var e={rowHeaderAutoText:t.rowHeaderAutoText,colHeaderAutoText:t.colHeaderAutoText,rowHeaderAutoTextIndex:t.rowHeaderAutoTextIndex,colHeaderAutoTextIndex:t.colHeaderAutoTextIndex,allowCellOverflow:t.allowCellOverflow,clipBoardOptions:t.clipBoardOptions,selectionBackColor:t.selectionBackColor,selectionBorderColor:t.selectionBorderColor,sheetAreaOffset:{left:t.sheetAreaOffset.left,top:t.sheetAreaOffset.top}};return n&&(e.rowHeaderVisible=t.rowHeaderVisible,e.colHeaderVisible=t.colHeaderVisible),e}function Gt(t,n){var e,n,i,e=n&&n.frozenColumnsAsRowHeaders,n=n&&n.frozenRowsAsColumnHeaders;(e||n)&&(i=t.Ut,n&&K(i.ap)&&(t.cp=!0,t.deleteRows(0,i.ap)),e)&&K(i.fp)&&t.deleteColumns(0,i.fp)}function Ut(t,n,e,i,r,o){var a,u,s,c,f,l;if(t){if(e.col=Math.max(t.getActiveColumnIndex(),0),e.row=Math.max(t.getActiveRowIndex(),0),a=0<r,u=0<o,0===i){if(!a||!u)return}else if(1===i){if(!u)return;a&&(e.col=o,e.row=0)}else if(2===i){if(!a)return;u&&(e.col=0,e.row=r)}if(e.col=Math.min(yt.XmlConstants.xo,e.col),e.row=Math.min(yt.XmlConstants.Io,e.row),n)if(s=void 0,c=t.getSelections())for(f=0;f<c.length;f++)"object"==typeof(l=c[f])&&(s=new gt.Range(0<l.row?l.row:0,0<l.col?l.col:0,0<l.rowCount?l.rowCount:yt.XmlConstants.Io,0<l.colCount?l.colCount:yt.XmlConstants.xo),n.push(s));else n.push(new gt.Range(e.row,e.col,1,1));return 1}}function Ht(t,n,e){var i,r,o,a,u,s,c,f,l,h,d,v,m,g,p,p,g,b,y,i=t.getSelections();if(i&&0!==i.length)for(r=e?t.frozenRowCount():0,o=e?t.frozenColumnCount():0,a=[],u=new gt.Range(0,0,1,1),s=0,f=-(c=1),l=3;0<=l;l--)if(a.length=0,Ut(t,a,u,l,r,o)){for(c=a.length,s=0;s<c;s++)-1!==(h=-1!==(h=a[s]).col&&-1!==h.colCount?h:new gt.Range(h.row,0,h.rowCount,yt.XmlConstants.xo)).row&&-1!==h.rowCount||(h=new gt.Range(0,h.col,yt.XmlConstants.Io,h.colCount)),u.col>=h.col&&u.col<=h.col+h.colCount-1&&u.row>=h.row&&u.row<=h.row+h.rowCount-1&&(f=s);if(f<0&&0<c&&(u.row=a[0].row,u.col=a[0].col),d=""+w(u.col)+(u.row+1),v="",0<o&&0<r&&(1===l||2===l))v=d;else{for(s=0;s<c;s++)m=a[s],g=Math.min(yt.XmlConstants.Io,m.row+1),p=Math.min(m.col,yt.XmlConstants.xo),v+=""+w(p)+g,(1<m.colCount||1<m.rowCount)&&(p=Math.min(p+m.colCount-1,yt.XmlConstants.xo),g=Math.min(g+m.rowCount-1,yt.XmlConstants.Io),v+=":"+(b=""+w(p)+g)),v+=" ";v=v.trim()}bt.StringEx.Xi(v)||3===l&&(0<o||0<r||3!==l)||(y={n_:"selection"},3!==l&&(y.pane=It[l]),y.activeCell=d,0!==f&&0===l&&(y.activeCellId=f.toString()),y.sqref=v,n.c_.push(y))}}function zt(t,n,e,i){var n,i,n=(n&&n.theme?n:i).theme,i=new W.Theme(void 0);e&&n?n&&i.yh(n):i.yh("Office"),t.currentTheme(i)}function Vt(t,n){t&&(t[n]=2)}function Yt(t,n){var e,i,r,o,a,u,u,e=t.options.protectionOptions,i,r={n_:"sheetProtection"};for(a in t.options.isProtected&&(r.sheet="1"),o=function(t){return t?"0":"1"},e)e.hasOwnProperty(a)&&(u=e[a],["allowSelectLockedCells","allowSelectUnlockedCells","allowEditObjects"].includes(a)&&u||(u=bt.protectionOptionsMap[a]||a,(n||bt.excelSupportProtectionOptions[u])&&(r[u]=o(e[a]))));if(t.oue&&(gt.util.w1(r,t.oue),r.spinCount=!St(r.spinCount)&&""+r.spinCount),1<Object.keys(r).length)return r}Object.defineProperty(t,"__esModule",{value:!0}),t=n("Common"),V=n("./dist/core/worksheet/worksheet.js"),Y=n("./dist/core/worksheet/style.js"),Z=Y.Style.xp,gt=n("./dist/core/util/common.js"),W=n("./dist/core/util/theme.js"),e=n("./dist/core/util/domUtil.js"),I=n("./dist/core/worksheet/stylehelper.js"),pt=n("./dist/core/core.enum.js"),o=n("CalcEngine"),bt=n("./dist/core/excel-io-util/common.js"),i=n("./dist/core/excel-io-util/range-parser.js"),yt=n("./dist/core/excel-io-util/excel-types.js"),d=n("./dist/core/worksheet/worksheet-model.js"),n=n("./dist/core/core.ns.js"),wt=void 0,n=new t.Common.ResourceManager(n.SR,"Sheets"),a=n.getResource.bind(n),x=gt.UsedRangeUtil.updateUsedRangeByData,xt=16384,c=1048576,Q=!!o,J=t.Common.CultureManager,Mt=V.Worksheet.fh,K=gt.util.T1,Ct=e.GC$.each,N=e.GC$.isEmptyObject,X=t.Common.kh,St=t.Common.lt.ht,Nt=bt.IndexHelper.nr,v=bt.IndexHelper.$i,m=bt.IndexHelper.qi,l=gt.util.n1,g=bt.Util.Sr,kt=gt.util.Pr,M=gt.util.xr,k=gt.util.o1,D=gt.util.go,s=gt.util.vo,f=gt.util.d1,Dt=gt.util.h1,S=i.range_parser._c,_=i.range_parser.Dc,Tt=i.range_parser.jc,p=i.range_parser.Oc,b=t.Common.zf,w=bt.Util.No,E=bt.Util.ko,T=bt.NodeHelper.ur,h=yt.XFileConstants.Ki,_t=yt.XFileConstants.Su,Et=yt.XFileConstants.Tu,jt=yt.XFileConstants.Au,Ot=yt.XFileConstants.Iu,y=yt.XFileConstants.Nu,Rt=yt.XFileConstants.Du,Bt=yt.XFileConstants._u,Lt=yt.XFileConstants.Eu,j=yt.XFileConstants.bo,et="string",q=parseInt,$=isNaN,At=void 0,C=null,O="1",R="0",B=t.Common.lt.tv,(n=It=It||{})[n.bottomRight=0]="bottomRight",n[n.topRight=1]="topRight",n[n.bottomLeft=2]="bottomLeft",n[n.topLeft=3]="topLeft",e.GC$.extend(V.Worksheet.prototype,{s8:function(t,n,e,i,r,o){var t,n;t[n]||(t[n]={}),(t=t[n])[e]||(t[e]={}),n=t[e],r&&!St(n.value)||(n.value=i),St(o)||(n.style=o)},c8:function(t,n,e,i,r,o){var t,a,u,s,c,f,c,t=M(t,j),a=t[n],u=(u=(a=a||(t[n]={}))[e])||(a[e]={});switch(s=typeof i){case"boolean":u.b=i?1:0;break;case"string":f=(c=(0,d.getOADateNumber)(i,r)).OADateNumber,c=c.valueIndex,u.o=f,u.v=c;break;case"object":i&&i.richText?u.v=r.getTextIndex(i):u.v=i;break;default:u.n=i}St(o)||(u.s=o)},Op:function(t,n){for(var e,i,r,o,a,u,s,c,f,l,h,d,v,v,e=this,i=e.Ut,r=i.W_(),o=i.W_(pt.SheetArea.colHeader),a=i.Q_(!0),u=i.Q_(!0,pt.SheetArea.colHeader),s=i.K_(),c=i.K_(pt.SheetArea.colHeader),f=e.rowFilter(),l=r.getColumnCount(),h=0;h<t;h++)for(r.setNode(h,-1,o.J_(h,-1)),a.X_(h,u.q_(h)),d=n;d<l;d++)(v=(v=o.J_(h,d))||{}).style=e.getActualStyle(h,d,pt.SheetArea.colHeader),r.setNode(h,d,v),(v=e.getFormula(h,d,pt.SheetArea.colHeader))&&e.setFormula(h,d,v,pt.SheetArea.viewport);c.getSpans().forEach(function(t){s.add(t)}),f&&f.range&&-1===f.range.row&&(f.f8=!0),e.frozenRowCount(t),i.l8(V.Worksheet.o8,l,pt.SheetArea.colHeader),i.h8(!1,pt.SheetArea.colHeader),i.d8(pt.SheetArea.colHeader),e.b3(pt.SheetArea.colHeader).clearAll()},jp:function(t,n){for(var e,i,r,o,a,u,s,c,f,l,h,d,d,e=this,i=e.Ut,r=i.W_(),o=i.W_(pt.SheetArea.rowHeader),a=i.Q_(!1),u=i.Q_(!1,pt.SheetArea.rowHeader),s=i.K_(),c=i.K_(pt.SheetArea.rowHeader),f=r.getRowCount(),l=0;l<t;l++)for(r.setNode(-1,l,o.J_(-1,l)),a.X_(l,u.q_(l)),h=n;h<f;h++)(d=(d=o.J_(h,l))||{}).style=e.getActualStyle(h,l,pt.SheetArea.rowHeader),r.setNode(h,l,d),(d=e.getFormula(h,l,pt.SheetArea.rowHeader))&&e.setFormula(h,l,d,pt.SheetArea.viewport);c.getSpans().forEach(function(t){s.add(t)}),e.frozenColumnCount(t),i.l8(f,V.Worksheet.r8,pt.SheetArea.rowHeader),i.h8(!1,pt.SheetArea.rowHeader),i.d8(pt.SheetArea.rowHeader),e.b3(pt.SheetArea.rowHeader).clearAll()},toJSON:function(e){var a,t,n,i,r,o,r,u,u,n,r,i,s,u,c,f,l,h,d,v,m,g,p,b,y,b,a=this,t=e&&e.ignoreStyle;for(l in!e||e.kp||a.NMi||(n=a.getRowCount(pt.SheetArea.colHeader),i=a.getColumnCount(pt.SheetArea.rowHeader),r=e.rowHeadersAsFrozenColumns,u=(o=e.columnHeadersAsFrozenRows)&&0<n,(r=r&&0<i)&&a.addColumns(0,i),u&&a.sfe(0,n,3,u),r&&a.jp(i,u?n:0),u&&a.Op(n,r?i:0)),u=a.getRowCount(),n=a.getColumnCount(),r=a.getRowCount(pt.SheetArea.colHeader),i=a.getColumnCount(pt.SheetArea.rowHeader),s={name:e&&e.newWorkSheetName||a.name(),isSelected:a.b2(),rowCount:u,columnCount:n,activeRow:a.ui,activeCol:a.ci,zoomFactor:a.zoom(),rowHeaderColCount:i,colHeaderRowCount:r,visible:a.visible()},u=a.getDockScrollbarAttachedIndex(),St(u)||(s.dockScrollbarAttachedIndex=u),t||(s.frozenRowCount=a.frozenRowCount(),s.frozenColCount=a.frozenColumnCount(),s.frozenTrailingRowCount=a.frozenTrailingRowCount(),s.frozenTrailingColCount=a.frozenTrailingColumnCount(),s.frozenTrailingRowStickToEdge=a.Ny,s.frozenTrailingColumnStickToEdge=a.Vy,s.theme=a.hl.toJSON()),f=(c=a.Ut).toJSON(e))s[l]=f[l];for(d in Mt&&Ct(Mt,function(t,n){n.toJson&&n.toJson.call(a,s,e)}),h={},s)!X(s,d)||St(v=s[d])||F(d,v)||(h[d]=v);if(P(a,s.data.dataTable),Ct(a.options,function(t,n){var e,i,r,o,e=n;"gridline"===t&&(e={},i=n.color,r=n.showHorizontalGridline,o=n.showVerticalGridline,i&&i!==gt.I.fl("gc-gridlineColor").borderTopColor&&(e.color=i),!1===r&&(e.showHorizontalGridline=r),!1===o)&&(e.showVerticalGridline=o),"sheetAreaOffset"===t&&(e={},n.left&&(e.left=n.left),n.top)&&(e.top=n.top),"protectionOptions"===t&&a.oue&&gt.util.w1(e,a.oue),"_ps"===t||St(e)||V.Worksheet.Pp[t]===e||"object"==typeof e&&N(e)||(h[t]=e)}),m=[],g=a.Hp){for(p in g)X(g,p)&&(b=g[p])&&(y=b.toJSON(),b=b.font,N(y)||(b&&(y.font=I.W.b5(b)),m.push(y)));0<m.length&&(h.namedStyles=m)}return h},fromJSON:function(t,B,n,e,i){var r,o,a,n,u,s,c,f,l,h,d,v,m,g,p,b,y,w,M,C,S,T,A,I,x,L,N,F,k,P,D,G,U,_,H,E,z,j,O,R;if(n&&(r=n.noSchema,o=n.version),t){n=(a=this).Ut,u=e&&e.ignoreStyle,a.Zp(),(s=a.Uw())&&!s.G3&&(c=s.G3=!0),V.Worksheet.et(a,"preFromJson"),a.suspendPaint(),n.v8(),n.m8(),f=J.culture(),J.culture(""),l=tt(t.rowCount,V.Worksheet.n8),h=tt(t.columnCount,V.Worksheet.e8);try{if(a.ub(t.name+"",!0),a.b2(t.isSelected),a.setRowCount(l),a.setColumnCount(h),a.Hp={},d=t.namedStyles)for(v=0;v<d.length;v++)m=d[v],g=new Y.Style,Z(m,a),g.fromJSON(m,r,a),a.$p(g);for(b in p=a.options)if(X(p,b)&&(y=t[b],"protectionOptions"===b?(y=y||t.protectionOption)&&(y.algorithmName&&y.hashValue&&y.saltValue&&y.spinCount&&(a.oue={algorithmName:y.algorithmName,hashValue:y.hashValue,saltValue:y.saltValue,spinCount:y.spinCount}),delete y.algorithmName,delete y.hashValue,delete y.saltValue,delete y.spinCount):"allowCellOverflow"===b&&(y=K(t[b])?t[b]:!o||11<=o),K(y)))if("object"==typeof y)for(w in y)X(y,w)&&(p[b][w]=y[w]);else"borderWidth"===b?(p.sheetAreaOffset.left=y,p.sheetAreaOffset.top=y):p[b]=y;if(M=tt(t.activeRow,a.ui),C=tt(t.activeCol,a.ci),a.O6(M,C,At,At,!0),u||(nt(a,a.frozenRowCount,t.frozenRowCount),nt(a,a.frozenColumnCount,t.frozenColCount),nt(a,a.frozenTrailingRowCount,t.frozenTrailingRowCount),nt(a,a.frozenTrailingColumnCount,t.frozenTrailingColCount),a.Ny=!K(t.frozenTrailingRowStickToEdge)||t.frozenTrailingRowStickToEdge,a.Vy=!K(t.frozenTrailingColumnStickToEdge)||t.frozenTrailingColumnStickToEdge),!u){if(S=t.colStyles)for(T in S)$(T)||a.setStyle(-1,q(T,10),S[T],pt.SheetArea.viewport);if(A=t.rowStyles)for(I in A)$(I)||a.setStyle(q(I,10),-1,A[I],pt.SheetArea.viewport)}x=tt(t.rowHeaderColCount,V.Worksheet.r8),L=tt(t.colHeaderRowCount,V.Worksheet.o8),a.setColumnCount(x,pt.SheetArea.rowHeader),a.setRowCount(L,pt.SheetArea.colHeader),a.g8(tt(t._zoomFactor||t.zoomFactor,a.zoom())),!1===t.visible?t.visible=pt.SheetTabVisible.hidden:!0===t.visible&&(t.visible=pt.SheetTabVisible.visible),nt(a,a.visible,t.visible),N=a.b8,F={sheet:a,setValidator:function(t,n,e){N&&N.y8(t,n,e)},ignoreStyle:u},t.isApplyRefilter||a.w8(t),n.fromJSON(t,r,F,a.Lp&&a.Lp.allowDynamicArray),a.defaults=n.defaults,N&&N.C8(!0),k=t.dockScrollbarAttachedIndex,St(k)||a.setDockScrollbarAttachedIndex(k),(P=t.theme)&&!u&&(typeof(D=P)!=et&&K(D)&&(G="_themeColor",U="_name",_=D.themeColor||D[G],(H=new W.ColorScheme(_.name||_[U])).fromJSON(_,r),D=new W.Theme(D.name||D.Zc,H,D.headingFont||D.Aee,D.bodyFont||D.See)),a.currentTheme(D)),ot(a,t,r,e,B,i),E=e&&e.frozenColumnsAsRowHeaders&&!a.NMi,j=(z=e&&e.frozenRowsAsColumnHeaders&&!a.NMi)&&t.frozenRowCount||0,O=E&&t.frozenColCount||0,z&&0<j&&it(a,t,j,O),E&&0<O&&rt(a,t,O,j),Q&&(R=a.Uw(),0<j&&(R.S8=j),0<O)&&(R.T8=O),i||(0<j&&a.deleteRows(0,j),0<O&&a.deleteColumns(0,O)),a.clearPendingChanges()}finally{c&&delete s.G3,J.culture(f),n.A8(),a.resumePaint()}}},Yp:function(a,u,t,s,c){var f,n,l,h,d,v,e,i,r,o,m,g,p,b,t,y,w,M,C,S,t,y,T,t;if(t&&(f=t.noSchema,n=t.version),a){if(h=(l=this).Ut,d=s.ignoreStyle,l.Zp(),V.Worksheet.et(l,"preFromJson"),h.v8(),h.m8(),v=J.culture(),J.culture(""),l.Hp={},e=a.namedStyles)for(i=0;i<e.length;i++)r=e[i],o=new Y.Style,Z(r,l),o.fromJSON(r,f,l),l.$p(o);for(g in m=l.options)if(X(m,g)&&(p=a[g],"protectionOptions"===g?p=p||a.protectionOption:"allowCellOverflow"===g&&(p=K(a[g])?a[g]:!n||11<=n),K(p)))if("object"==typeof p)for(b in p)X(p,b)&&(m[g][b]=p[b]);else"borderWidth"===g?(m.sheetAreaOffset.left=p,m.sheetAreaOffset.top=p):m[g]=p;if(t=tt(a.activeRow,l.ui),y=tt(a.activeCol,l.ci),l.O6(t,y,At,At,!0),d||(nt(l,l.frozenRowCount,a.frozenRowCount),nt(l,l.frozenColumnCount,a.frozenColCount),nt(l,l.frozenTrailingRowCount,a.frozenTrailingRowCount),nt(l,l.frozenTrailingColumnCount,a.frozenTrailingColCount),l.Ny=!K(a.frozenTrailingRowStickToEdge)||a.frozenTrailingRowStickToEdge,l.Vy=!K(a.frozenTrailingColumnStickToEdge)||a.frozenTrailingColumnStickToEdge),!d){if(w=a.colStyles)for(M in w)$(M)||l.setStyle(-1,q(M,10),w[M],pt.SheetArea.viewport);if(C=a.rowStyles)for(S in C)$(S)||l.setStyle(q(S,10),-1,C[S],pt.SheetArea.viewport)}t=tt(a.rowHeaderColCount,V.Worksheet.r8),y=tt(a.colHeaderRowCount,V.Worksheet.o8),l.setColumnCount(t,pt.SheetArea.rowHeader),l.setRowCount(y,pt.SheetArea.colHeader),l.g8(tt(a._zoomFactor||a.zoomFactor,l.zoom())),T=l.b8,t={sheet:l,setValidator:function(t,n,e){T&&T.y8(t,n,e)},ignoreStyle:d,incrementalLoading:s.incrementalLoading,incrementLoadTask:s.incrementLoadTask},a.isApplyRefilter||l.w8(a),h.fromJSON(a,f,t,l.Lp&&l.Lp.allowDynamicArray,function(){var t,t,n,e,i,r,i,r,t,o,r;l.defaults=h.defaults,T&&T.C8(!0),(t=a.theme)&&!d&&(typeof(t=t)!=et&&K(t)&&(i=t.themeColor||t[n="_themeColor"],(r=new W.ColorScheme(i.name||i[e="_name"])).fromJSON(i,f),t=new W.Theme(t.name||t.Zc,r,t.headingFont||t.Aee,t.bodyFont||t.See)),l.currentTheme(t)),ot(l,a,f,s,u,c),i=s&&s.frozenColumnsAsRowHeaders&&!l.NMi,t=(r=s&&s.frozenRowsAsColumnHeaders&&!l.NMi)&&a.frozenRowCount||0,o=i&&a.frozenColCount||0,r&&0<t&&it(l,a,t,o),i&&0<o&&rt(l,a,o,t),Q&&(r=l.Uw(),0<t&&(r.S8=t),0<o)&&(r.T8=o),c||(0<t&&l.deleteRows(0,t),0<o&&l.deleteColumns(0,o)),l.clearPendingChanges(),J.culture(v),h.A8(),l.loaded=!0})}},wh:function(B,L,e){var i,t,F,n,P,r,o,a,u,s,a,s,G,U,u,s,a,c,f,l,h,d,v,u,u,d,a,m,g,p,l,b,h,f,c,y,d,a,p,g,m,l,h,w,M,C,S,c,T,H,z,V,Y,Z,W,a,A,p,I,g,m,l,h,S,Q,J,r,o,x,K,X,N,k,k,D,q,_,$,tt,nt,et,it,rt,ot,at,ut,st,ct,v,s,ft,w,M,C,T,lt,ht,E,dt,j,vt,O,mt,R,i=this,t=i.options,F=bt.Util.ko(e),n=!e||!1!==e.includeStyles;for(t.sheetTabColor&&(P={n_:_t,c_:[Dt(t.sheetTabColor,At,"tabColor")]}),r=i.getRowCount(pt.SheetArea.colHeader)||1,o=i.getColumnCount(pt.SheetArea.rowHeader)||1,a=i.NMi&&(e&&e.fileType)===pt.OpenSaveFileType.excel,u=e&&e.rowHeadersAsFrozenColumns,s=e&&e.columnHeadersAsFrozenRows,(u||s||a)&&(s=(s||a)&&0<r,(a=u&&0<o)&&i.addColumns(0,o),s&&i.sfe(0,r,3,s),a&&i.jp(o,s?r:0),s)&&i.Op(r,a?o:0),G=i.ui,U=i.ci,u=t.gridline,s=t.frozenlineColor,a=i.zoom(),c=i.frozenRowCount(),f=i.frozenColumnCount(),l=i.getViewportLeftColumn(1),h=i.getViewportTopRow(1),i.NMi?d="A1":l!==At&&h!==At&&(c||f?f&&!c?d="A"+(h+1):!f&&c&&(d=Tt((0,gt.Ec)(0,l,1,1))):d=Tt((0,gt.Ec)(h,l,1,1))),u=(u=(v=u?{color:u.color,showVerticalGridline:u.showVerticalGridline,showHorizontalGridline:u.showHorizontalGridline}:v)&&v.color&&v.color!==gt.I.fl("gc-gridlineColor").borderTopColor?v&&v.color:At)&&gt.ColorHelper.getClosestColorIndex(gt.ColorHelper.convertHexColorToArgb(u)),u={n_:"sheetView",showGridLines:!v||!1!==v.showVerticalGridline&&!1!==v.showHorizontalGridline?At:"0",showRowColHeaders:!1===t.rowHeaderVisible&&!1===t.colHeaderVisible?"0":At,defaultGridColor:u?0:At,colorId:u,showFormulas:t.showFormulas?"1":At,showZeros:t.showZeros?At:"0",topLeftCell:d||At,zoomScale:1===a?At:Math.round(100*a),workbookViewId:0,tabSelected:i.b2()?"1":At,c_:[]},a=d=0,m=3,g="1",p="A",n&&(0<f||0<c)&&(0<f&&(d=f,p=Nt(l)),0<c&&(a=c,g=h+1+""),0<f&&0===c?m=1:0===f&&0<c?m=2:0<f&&0<c&&(m=0),l={n_:"pane",xSplit:0<f?f:At,ySplit:0<c?c:At,topLeftCell:p+g==="A1"?Tt((0,gt.Ec)(d,a,1,1)):p+g,activePane:It[m],state:"frozen"},u.c_.push(l)),Ht(i,u,n),b=L.styleManager,h=L.sharedStrings,y=(c=(f=i.Ut).wh(b,h,e)).sheetData,d=c.hyperlinks,a=c.rowHeaderData,p=c.colHeaderData,g=c.rowHeaderColInfos,m=c.colHeaderRowInfos,l=c.rowHeaderSpan,h=c.colHeaderSpan,w=c.defaults,M=c.selectionPolicy,C=c.selectionUnit,S=c.rowInfos,c=c.tag,n&&(T=i.frozenTrailingRowCount(),H=i.frozenTrailingColumnCount(),z=i.Ny,V=i.Vy),Y=!i.NMi&&i.getDefaultStyle(),a={rowHeaderData:a,colHeaderData:p,rowHeaderColInfos:g,colHeaderRowInfos:m,rowHeaderSpan:l,colHeaderSpan:h,rowInfos:S,colHeaderRowCount:r,rowHeaderColCount:o,gridline:v,frozenlineColor:s,defaults:w,selectionPolicy:M,selectionUnit:C,frozenTrailingRowCount:T,frozenTrailingColCount:H,frozenTrailingRowStickToEdge:z,frozenTrailingColumnStickToEdge:V,defaultStyle:Z=n&&Y&&Y.toJSON(),sheetOptions:W=Pt(t,F),tag:c},n&&(a.theme=i.hl.wh()),A=f.Q_(!1,3).wh(e),I=(p=f.defaults).colWidth,g=p.rowHeight,m={n_:Bt,defaultRowHeight:gt.SJSColumnWidthHelper.pixelToPoint(g),defaultColWidth:gt.SJSColumnWidthHelper.pixelToColumnWidth(I),customHeight:2<=Math.abs(76-g)?"1":At},l=e&&!1===e.includeEmptyRegionCells,S=h=0,Q=i.getRowCount(),J=i.getColumnCount(),l&&(r=pt.UsedRangeType.all-pt.UsedRangeType.colStyle-pt.UsedRangeType.rowStyle-pt.UsedRangeType.style-pt.UsedRangeType.axis,o=i.getUsedRange(r))&&(h=o.row,S=o.col,Q=o.row+o.rowCount,J=o.col+o.colCount),x=[],K=a.colInfos=[],X=f.W_(3),N=S;N<J;N++)k=(k=X.J_(-1,N))&&k.style,D=A[N],q=i.getTag(-1,N),!D&&!k&&St(q)||(_=D&&D.size,$=D&&D.visible,et=nt=tt=void 0,n&&k&&(F?"string"==typeof k?tt=b.getOriginNamedStyleIndex(k):k!==At&&(nt=b.getOriginStyleIndex(k)):("string"==typeof k&&0===k.indexOf(b.Jd)&&(it=k,k=(k=i.i3(it,!1))||(rt=i.parent)&&rt.i3(it,!1)),et=b.getStyleIndex(k))),(!St(_)&&_!==I||!1===$||k||tt!==At||nt!==At)&&(x[N]={width:St(_)?gt.SJSColumnWidthHelper.pixelToColumnWidth(I):gt.SJSColumnWidthHelper.pixelToColumnWidth(_),hidden:!1===$?"1":At,customWidth:St(_)||_===I?At:1,style:et,t:tt,e:nt}),St(q)||(A[N]=A[N]||{},A[N].colTag=q),K[N]=A[N]);for(at=[],ut=i.getSpans(),st={},N=0;N<ut.length;N++)(ct=ut[N])&&(at.push({n_:yt.XFileConstants.xu,ref:Tt(ct)}),st[G+","+U]=ct);for(n&&0<at.length&&(ot={n_:Ot,c_:at}),s=Ft(d,st,v={n_:yt.XFileConstants.Dr,xmlns:yt.RelationshipConstants._r,c_:[]}),N=h;N<Q;N++)ft=i.getTag(N,-1),!y[N]&&St(ft)&&!1!==i.getRowVisible(N)||(y[N]||(y[N]={r:N+1}),!1===i.getRowVisible(N)&&(y[N].v="1"),St(ft))||(y[N].lossless={tag:ft});for(w=Yt(i,F),M=i.getRowCount()||1,C=i.getColumnCount()||1,T={n_:Et,ref:Tt((0,gt.Ec)(0,0,M,C))},E={n_:"worksheet",c_:[P,T,lt={n_:Rt,c_:[u]},m,y,w,ot,s,ht={n_:jt,c_:[]}],rels:v,tempCols:x,lossless:a},Mt&&Ct(Mt,function(t,n){n.wh&&n.wh.call(i,E,L,e)}),dt=[],N=0;N<x.length;N++)if(j=x[N]){if(xt<=(vt=N))break;for(O=N+1,mt=vt;O<x.length&&(R=x[O])&&O===mt+1&&O<xt&&R.style===j.style&&R.hidden===j.hidden&&R.outlineLevel===j.outlineLevel&&R.collapsed===j.collapsed&&Math.abs(R.width-j.width)<=1e-4&&R.t===j.t&&R.e===j.e;)N=mt=O,O++;D={n_:"col",min:vt+1+"",max:mt+1+""},j.style!==wt&&(D.style=j.style+""),j.t!==wt&&(D.t=j.t+""),j.e!==wt&&(D.e=j.e+""),isNaN(j.width)||j.width===wt||(D.width=j.width+""),D.hidden=j.hidden,j.collapsed&&(D.collapsed="1"),!isNaN(j.width)&&1e-4<Math.abs(j.width-i.defaults.colWidth)&&(D.customWidth="1"),"number"==typeof j.outlineLevel&&0!==j.outlineLevel&&(D.outlineLevel=j.outlineLevel+""),dt.push(D)}return 0<dt.length&&E.c_.push({n_:Lt,c_:dt}),delete E.tempCols,kt(E,yt.WorkSheetNodeOrder),E},rv:function(e,i,r,o){var a,t,n,u,s,c,s,f,c,l,h,d,l,a=this,t=a.options,n=M(e,j),u=e.lossless;G(t,e),c=(s=z(e)).rowCount,s=s.colCount,n&&(r.fileType===pt.OpenSaveFileType.excel?(St(n.rowCount)||(c=Math.max(n.rowCount,c||0)),St(n.colCount)||(s=Math.max(n.colCount,s||0))):(St(n.rowCount)||(c=n.rowCount),St(n.colCount)||(s=n.colCount))),a.setRowCount(c),a.setColumnCount(s),c=(f=a.parent)&&f.getSheetIndex(a.name()),(l=i.sheetNamedStyles)[c]&&l[c].forEach(function(t){delete t.sheetId,a.addNamedStyle(t)}),at(h=a.Ut,e),ut(a,e,r,i),d=!r||!1!==r.includeStyles,zt(a,u,d,i),l=i.styleManager,st(a,e,l,s,r,i),mt(t,u),h.yh(n,i,r,u,function(){d&&ct(h,e),ft(a,e),vt(a,e),Mt&&Ct(Mt,function(t,n){n.yh&&n.yh.call(a,e,i,r,o)});var t=f&&f.v2,t=t&&t.sheetsState;o?(a.Xh=!0,Vt(t,a.name()),U(a,e,r)):r.incrementLoadTask.addTask(function(t,n,e,i){t.Xh=!0,Vt(i,t.name()),U(t,n,e)},[a,e,r,t])},o,a.Lp&&a.Lp.allowDynamicArray)},yh:function(t,n,e,i){var r,o,i,r=this;i?r.rv(t,n,e,i):((e=e||{}).progress||(e.progress=function(t){}),e.loadStatus||(e.loadStatus={total:0,valuesLoad:0,formulaLoad:0}),o=bt.Util.wo(e,r.parent&&r.parent.v2),i=e.incrementLoadTask&&e.incrementLoadTask.tasks&&0===e.incrementLoadTask.tasks.length,e.incrementLoadTask.addTask(function(t,n,e){r.rv(t,n,e)},[t,n,e],b.I5(a().STEP.loadSheetData,[r.name()]),function(){var t=e.loadStatus.valuesLoad/e.loadStatus.total;return o?.2:e.fullRecalc?t*bt.STEP_RATE.loadSheetDataWithCalc+ +bt.STEP_RATE.parseFile+bt.STEP_RATE.loadFileData:t*bt.STEP_RATE.loadSheetData+bt.STEP_RATE.parseFile+bt.STEP_RATE.loadFileData},r.name()),i&&e.incrementLoadTask.start())}})},"./dist/core/worksheet/worksheet-model.js":function(l,t,n){"use strict";var h,M,C,x,q,S,k,R,D,$,_,tt,E,P,at,B,j,nt,O,G,et,it,U,T,H,g,I,z,V,p,b,Y,s,d,rt,Z,W,Q,ut,ot,J,K,X,st,v,ct,L,n,ft,lt,k,ht,dt,vt,mt,gt,pt,c,bt,yt,wt,Mt,Ct,St,Tt,At,It,xt,Nt,kt,Dt;function m(t,n){return rt(t)?n:t}function N(t,n){return t.hasOwnProperty(n)}function _t(t){return"number"==typeof t}function y(t){return t.rowCount}function w(t){return t.colCount}function f(t,e,n,i){var r=n;Object.defineProperty(t,e,{get:function(){return r},set:function(t){var n=r;i(this,r=t,e,n)}})}function Et(n,t){n.cache={},t&&t.forEach(function(t){jt(n,t)})}function jt(t,n){var e,i;if(t.I8=g(t.I8,n.row+y(n)-1),t.x8=g(t.x8,n.col+w(n)-1),!t.suspendUpdatingCache)for(e=0;e<n.rowCount;e++)for(i=0;i<n.colCount;i++)t.cache[n.row+e+"_"+(n.col+i)]=n}function Ot(t,n){var e,i;if(!t.suspendUpdatingCache)for(e=0;e<n.rowCount;e++)for(i=0;i<n.colCount;i++)t.cache[n.row+e+"_"+(n.col+i)]=it}function Rt(t,n){var e,i,e,e=t.indexOf("/OADate(")+1,i=t.indexOf(")");return 0!==e&&e<i&&(e=parseFloat(t.substring(e+7,i)),!isNaN(e))?{OADateNumber:e,valueIndex:it}:{OADateNumber:it,valueIndex:n.getTextIndex(t)}}function e(){f(this,"spans",[],Et),this.x8=-1,this.I8=-1,this.cache={},this.suspendUpdatingCache=!1}function Bt(){Array.apply(this,arguments)}function Lt(){var t=kt.call(this)||this;return t.headingOverflowLayouts=et,t.trailingOverflowLayouts=et,t}function Ft(t,n,e,i,r,o,a,u,s){var c=this;c.column=t,c.startColumn=n,c.endColumn=e,c.valueWidth=i,c.columnWidth=r,c.backgroundWidth=o,c.backgroundLeftWidth=a,c.backgroundRightWidth=u,c.expandedWidth=s}function Pt(t,n,e){var i,r,o,a,u,i=(0,$.Ec)(-1,-1,-1,-1);return t&&(r=t.col,o=t.row,u=-1===r,i.row=(a=-1===o)?0:o,i.rowCount=a?n:y(t),i.col=u?0:r,i.colCount=u?e:w(t)),i}function i(){this.selections=[],this.selectionPolicy=2,this.selectionUnit=0}function Gt(t,n,e,i,r,o){for(var a,u,s,c,f,a=t.length,s=!1,c=[],f=0;f<a;f++)if(u=t[f],s=rt(n)||rt(e)?rt(n)?rt(e)?rt(i)?u.containsY(r):u.containsX(i):u.col===e:u.row===n:u.contains(n,e)){if(!o)return u;c.push(u)}return o&&0<c.length?c:et}function Ut(t,n,e){var i=et,r=t.length,o=!rt(n);return i=0<r?(i=o?t.findX(n):t.findY(e))||(o&&n<t[0].x||!o&&e<t[0].y?t[0]:t[r-1]):i}function r(){return Dt.call(this)||this}function Ht(t,n,e,i,r,o,a,u,s,c){var f=this;f.rowCount=a,f.colCount=u,f.row=t,f.col=n,f.x=e,f.y=i,f.width=r,f.height=o,f.isAutoMerge=s,f.offsetX=c}function zt(t,n){var t=t.valuesLoad/t.total;return n?.4*t+.1:.3*t+.1}function Vt(t,n,e,i,r,o,a,u,s,c,f){var l,h,d,v,m,g,p,b,y,w,M,C,l,a,l=r&&r.incrementLoadTask;if(l&&!l.isTerminated){for(h=l.isBusyFunc,d=a=a||0,v=!1,m=30,g=new Date;d<e;){if(p=n[d])for(b=0;b<i;b++)(y=p[b])&&qt(y,t.J_(d,b,v=!0),o,d,b,r,s,c,f);if(d++,h&&h())break;if(30<(w=new Date)-g)break}if(v){if(M=r&&r.sheet,0!==a&&M.parent.getActiveSheet()===M)for(C=a;C<d;C++)if(M.N8.viewport[1].findRow(C)){M.repaint();break}(l=r&&r.incrementalLoading)&&(l.loadStatus.valuesLoad+=d-a,a=zt(l.loadStatus,r.doNotRecalculateAfterLoad),M.parent&&M.parent.ki($.Events.ProgressChanged,{loadStatus:l.loadStatus,progress:a,sheet:M}),l.loading)&&l.loading(a,{sheet:M})}d<e?r.incrementLoadTask.pushTask(Vt,[t,n,e,i,r,o,d,u,s]):u&&r.incrementLoadTask.pushTask(u,[])}}function Yt(t,n,e,i,r,o,a,u,s){for(var c,f,l,h,c=0;c<e;c++)if(f=n[c])for(l=0;l<i;l++)(h=f[l])&&qt(h,t.J_(c,l,!0),o,c,l,r,a,u,s)}function Zt(t,n,e,i,r,o,a,u,s,c,f){var l,h,d,v,m,g,p,b,y,w,M,C,S,T,A,I,x,N,k,D,_,E,k,k,j,I,O,o,o,l=P.Util.Mo(r);if(e){for(h=t.a8,d=r&&!1===r.includeStyles,v=P.Util.ko(r),m=i.styleManager,p=(g=r&&r.incrementLoadTask).isBusyFunc,b=!1,y=30,l&&(w=new Date),M=o=o||0,C=e.rowCount,S=e.colCount;M<C;)if(T=e[M]){for(I=(A=t.J_(M,-1,!0))&&A.style,x=void 0,A&&!d&&(v?T.t!==it?x=m.getOriginNamedStyle(T.t):T.e!==it&&(x=ot(m.getOriginStyle(T.e))):x=m.getStyle(T.s),A.style=x),A&&T.lossless&&!rt(T.lossless.tag)&&(A.tag=T.lossless.tag),h&&L(h.style,M,-1,I,A&&A.style),N=0;N<S;N++)(k=T[N])!==it&&(D=t.J_(M,N,b=!0),E=_=void 0,_=(E=k).v!==it?"number"==typeof(k=E.v)?i.sharedStrings.getText(k):k&&(k._calcError||k._error&&!rt(k._code)||k.error&&!rt(k.code))?B&&R.CalcError.parse(k._calcError||k._error||k.error):k:E.b!==it?!!E.b:E.o!==it?"/OADate("+E.o+")/":E.n,rt(E.f)&&h&&L(h.data,M,N,D.value,_),rt(_)||(D.value=_),k=D.style,v||(rt(E.s)&&(x||f[N])?E.s=0:0!==E.s||x||f[N]||(E.s=it)),d||(j=void 0,v?E.t!==it?j=m.getOriginNamedStyle(E.t):E.e!==it&&(j=ot(m.getOriginStyle(E.e))):j=m.getStyle(E.s),D.style=j),h&&L(h.style,M,N,k,D.style),E.lossless&&(rt(E.lossless.bindingPath)||(D.bindingPath=E.lossless.bindingPath),rt(E.lossless.tag)||(D.tag=E.lossless.tag)),-1<M)&&pn(D,_,!!E.f||!!E.g||!!E.si,D.style,s,it,c);if(M++,!u&&p&&p())break;if(l&&(I=new Date,!u)&&30<I-w)break}else M++;if(b){if(0!==o&&n.parent.getActiveSheet()===n)for(O=o;O<M;O++)if(n.N8.viewport[1].findRow(O)){n.repaint();break}r.loadStatus.valuesLoad+=M-o,!u&&l&&(o=r.loadStatus.valuesLoad/r.loadStatus.total,o=+(r.fullRecalc?.3*o+.2:.4*o+.2).toFixed(5),r.incrementLoadTask.progress)&&r.incrementLoadTask.progress({progress:o,sheetName:n.name(),step:Z.I5(ft().STEP.loadSheetData,[n.name()])})}M<C?r.incrementLoadTask.pushTask(Zt,[t,n,e,i,r,M,a,it,s,c,f]):u?a():a&&r.incrementLoadTask.pushTask(a,[])}else a&&setTimeout(a,0)}function Wt(t,n,e,i,r,o,a,u,s){var o,c,o;0<=e&&0<=i?(o[e]||(o[e]={}),c=(o=o[e])[i],o=(o[i]=r)&&r.value,s.a8&&(o&&"SparklineExValue"===o.typeName&&(o=et),L(s.a8.data,e,i,c&&c.value,o),L(s.a8.style,e,i,c&&c.style,r&&r.style))):0<=e&&-1===i&&0<=t&&-1===n?a[e]=r:0<=i&&-1===e&&0<=n&&-1===t&&(u[i]=r)}function Qt(t,n,e,i,r,o,a){var o;0<=e&&0<=i&&(o[e]||(o[e]={}),o[e].rs="e",(o=o[e]).originalItem=a,o[i]=r)}function Jt(t,n,e){var i,r,o,a,u,s,i={};for(r in t)t[r]&&(o=H(r),!isNaN(o))&&n<=o&&(a=t[o],u=t[o+e],s=i[o],u&&(i[o+e]=u),s?t[o+e]=s:(delete t[o],t[o+e]=a))}function Kt(t,n,e){var i,r,o;for(i in t)t[i]&&(r=Math.floor(i),!isNaN(r))&&n<=r&&(o=t[r],delete t[r],n+e<=r)&&(t[r-e]=o)}function Xt(t){var n,e,n=15;-10<t&&t<10&&(1<(e=t.toString()).indexOf("000000000000")||1<e.indexOf("999999999999"))&&(n=14),S.Common.st.E8(t,R.Functions.CALC_PRECISION||n)}function o(t,n,e,i){var r=this;r.Sx=t,r.Tx=n,rt(e)||(r.j8=e),rt(i)||(r.O8=i),r.Hc()}function a(){this.infos=[],this.R8=[]}function qt(t,n,e,i,r,o,a,u,s){var c,f,l,l,h,d,v,h,e,a,v,o,d;t&&(c=t.value,f=t.formula,c!==it&&(c!==et&&(c._calcError||c._error&&!rt(c._code))&&(l=B&&R.CalcError.parse(c._calcError||c._error))!==it&&(c=l=Q(l)),rt(f)&&a&&L(a.data,i,r,n.value,c),n.value=c),l=t.style,h=o&&o.sheet,l!==it&&o&&!o.ignoreStyle&&(d=et,v=n.style,typeof l===U?(n.style=l,d=h&&(h.i3(l,!1)||h.parent&&h.parent.i3(l,!1))):l&&((d=new q.Style).fromJSON(l,e),d.name=it,n.style=d),a&&L(a.style,i,r,v,n.style),d)&&d.validator&&o.setValidator&&o.setValidator(i,r,d.validator),(h=t.visualState)!==it&&(n.visualState=h),(e=t.bindingPath)!==it&&(n.bindingPath=e),(a=t.tag)!==it&&a!==et&&(typeof(v=a.typeName)===U&&(o=D.getTypeFromString(v))&&(a=new o).fromJSON&&a.fromJSON(t.tag),n.tag=a),(d=t.hyperlink)!==it&&(n.hyperlink=ot(d)),-1<i)&&-1<r&&pn(n,c,!!f,l,u,it,s)}function $t(t,n,e){var i,r,o,a,u,s,c,f,l,h,d,v,e,o,r,a,n,i=n[0];if("selectionModel"!==i[0]){for(r=i[0],o=n[1],a=null,2<n.length&&(a=n[2]),a=e?a:o,u=t,s=0;s<i.length-1;s++)c=i[s],u=c===z?u.B8:(u[c]||(u[c]={}),u[c]);l=i[(f=i.length)-1],d=(h=t.sheetModels[3]).a8,v=u[i[s]],"sheetModels"===r||"colInfos"===r||"rowInfos"===r?e&&a!==u[i[s]]?u[i[s]]=a:e||(u[i[s]]=o):"spanModels"===r?(u.cache={},u.spans=[],a.forEach(function(t){u.add((0,$.Ec)(t.row,t.col,t.rowCount,t.colCount))})):(u[i[s]]=n[1],e=void 0,o=i[f-2],r=i[1],"size"===l?e=i[0]===p?tt.AxisInfoChangeType.setRowHeight:tt.AxisInfoChangeType.setColumnWidth:"visible"===l&&(e=i[0]===p?tt.AxisInfoChangeType.setRowVisible:tt.AxisInfoChangeType.setColumnVisible),rt(e)||t.L8({type:e,index:o,sheetArea:r})),"style"===l?((a=d&&d.style)&&L(a,i[f-3],i[f-2],v,u[i[s]]),u&&(v&&v.quotePrefix||u.style&&u.style.quotePrefix)&&(v&&v.quotePrefix)!==(u.style&&u.style.quotePrefix)&&pn(u,u.value,!!u.formula,u.style,t.F8)):"value"===l&&((n=d&&d.data)&&L(n,i[f-3],i[f-2],v,u[i[s]]),u)&&v!==u.value&&pn(u,u.value,!!u.formula,u.style,t.F8)}}function tn(t,n,e){var i=0<t.P8?[["selectionModel"],it]:it;t.selectionModel.setProperty(n,e,i),i&&t.G8.push(i)}function nn(t,n,e,i,r){var o=t[n];(r=void 0!==r&&r)?o&&delete o[e]:(o=o||(t[n]={}))[e]=i}function en(t,n,e,i){nn(t,n,e,{value:i})}function rn(t,n,e,i,r,o){nn(t,n,e,{value:i,oldValue:r,isAnchorCell:o})}function on(t,n,e,i){var r,r,r,r=t[n],r=r&&r[e];return r?r.value:(en(t,n,e,r=i.getValue(n,e)),r)}function an(t,n){return[t,n].join(",")}function un(t,n){-1===t.indexOf(n)&&t.push(n)}function sn(t,n,e){for(var i=0;i<t.length;i++)if(t[i][0]===n&&t[i][1]===e)return void 0!==t[i][2];return 1}function F(t,n,e){var t=t[n];return t&&t[e]}function cn(t,n){var n,e,n,t,n=n.split(",").map(function(t){return+t}),e=n[0],n=n[1],t=t[e];return t&&t[n]}function fn(t,n,e,i){var r=t[n];r&&delete r[e],i&&nt(r)&&delete t[n]}function u(t){this.modelManager=t,this.anchors={},this.cells={},this.invalidAnchors={}}function ln(t,n,e,i,r,o){var a,o,u,s,c,f,l,h,d,v,m,g;if((o=void 0===o?tt.SheetArea.viewport:o)===tt.SheetArea.viewport){for(c in a=t.W_(3),s=[],u=(o=t.t8).anchors)if(u.hasOwnProperty(c)&&(f=u[c]))for(l in f)f.hasOwnProperty(l)&&(h=f[l])&&(d=h.row,v=h.col,m=h.rowCount,g=h.colCount,n<=(r?d+m:v+g))&&(h.isValid&&a.U8(h),(r?d:v)<n)&&s.push(h);s.length&&(0,R.markAnchorCellDirty)(s,t.Mf.b3(),o)}}function hn(t){return t&&t.filter(function(t){return!t.isAutoMerge})}function A(t,n,e,i,r,o){var a,t,i,r,u,t;function s(t,n,e,i){0<a.P8&&a.G8.push([["defaults",e],i,n]),a.Mf.zw()}this.H8=[],(a=this).Mf=t,t=new pt(n,e,n,e),a.sheetModels=[it,new pt(i,e,0,0),new pt(n,r,0,0),t],t.z8(),(i=a.rowInfos=[])[0]=i[1]=new c,i[2]=i[3]=new c,(r=a.colInfos=[])[0]=r[2]=new c,r[1]=r[3]=new c,a.spanModels=[it,new lt,new lt,new lt],a.selectionModel=new vt,(u=a.colHeaderSelectionModel=new vt).selectionPolicy=1,a.t8=new St(a),a.name=o||"",a.isSelected=!1,a.zoomFactor=1,f(t=a.defaults={},"rowHeight",20,s),f(t,"colWidth",62,s),f(t,"rowHeaderColWidth",40,s),f(t,"colHeaderRowHeight",20,s),f(t,"_isExcelDefaultColumnWidth",!1,s),a.P8=0,A.et(this,"init"),a.V8(n,e),a.F8={}}function dn(t,n){return!n&&!rt(t)&&"string"==typeof t}function vn(t,n,e,i){var n;return(!n||!n.quotePrefix)&&(e&&e[t]||(-1!==At.indexOf(t[0])&&1<t.length&&(Tt.et(it,"isInvalidFormula",n={value:t,isInvalid:!1,allowDynamicArray:i}),n.isInvalid)?(e&&(e[t]=!0),1):void 0))}function mn(t){rt(t.cellState)||(t.cellState&=~tt.CellStatesType.invalidFormula)}function gn(t){rt(t.cellState)&&(t.cellState=0),t.cellState|=tt.CellStatesType.invalidFormula}function pn(t,n,e,i,r,o,a){rt(t)||(dn(n,e)&&vn(n,i=o&&i&&"string"==typeof i?yn(i,o):i,r,a=o&&rt(a)?o.options.allowDynamicArray:a)?gn:mn)(t)}function bn(t,n,e){return!(rt(t)&&rt(n)||("string"==typeof t&&(t=yn(t,e)),"string"==typeof n&&(n=yn(n,e)),(t&&t.quotePrefix)===(n&&n.quotePrefix)))}function yn(t,n){var e,i,r,o,a;if(n){if(e=n.getNamedStyle(t))return e;for(i=0,r=n.sheets;i<r.length;i++)if(a=(o=r[i]).getNamedStyle(t))return a;return et}}function wn(t,n){var e,i,t;if("string"==typeof t&&"/OADate"===t.substring(0,7)&&!n.formatter){if((n=rt(n)?new q.Style:n)._autoFormatter)return n.formatter=n._autoFormatter.formatCached,n;e=t.indexOf("("),i=t.indexOf(")"),-1!==e&&-1!==i&&((t=parseInt(t.substring(e+1,i),10))<1?n.formatter="h:mm:ss":1<t&&(n.formatter="M/d/yyyy"))}return n}function Mn(t,n){return n=t.renamedStyles&&t.renamedStyles[n]?t.renamedStyles[n]:n}function Cn(t,n){var e,i,r;return"object"==typeof n?n:"string"==typeof n?(It.test(e=n)&&(i=n.indexOf(xt),e=Mn(t,n.substring(i))),(r=t.u8(e))||new q.Style):void 0}function Sn(t,n,e){e&&Tn(n,e=Cn(t,e))}function Tn(t,n){t.backColor===it&&n.backColor!==it&&!1!==n.applyFill&&(t.backColor=n.backColor),!1!==n.applyFont&&(t.foreColor===it&&n.foreColor!==it&&(t.foreColor=n.foreColor),t.themeFont===it&&t.font===it?(t.themeFont=n.themeFont,t.font=n.font):t.themeFont!==it&&t.font===it&&(t.font=n.font),t.textDecoration===it)&&n.textDecoration!==it&&(t.textDecoration=n.textDecoration),!1!==n.applyAlignment&&(t.hAlign===it&&n.hAlign!==it&&(t.hAlign=n.hAlign),t.vAlign===it&&n.vAlign!==it&&(t.vAlign=n.vAlign),t.textIndent===it&&n.textIndent!==it&&(t.textIndent=n.textIndent),t.wordWrap===it&&n.wordWrap!==it&&(t.wordWrap=n.wordWrap),t.isVerticalText===it&&n.isVerticalText!==it&&(t.isVerticalText=n.isVerticalText),t.shrinkToFit===it&&n.shrinkToFit!==it&&(t.shrinkToFit=n.shrinkToFit),t.textOrientation===it)&&n.textOrientation!==it&&(t.textOrientation=n.textOrientation),t.formatter===it&&n.formatter!==it&&!1!==n.applyNumberFormat&&(t.formatter=n.formatter),!1!==n.applyBorder&&(t.borderLeft===it&&n.borderLeft!==it&&(t.borderLeft=An(n.borderLeft)),t.borderTop===it&&n.borderTop!==it&&(t.borderTop=An(n.borderTop)),t.borderRight===it&&n.borderRight!==it&&(t.borderRight=An(n.borderRight)),t.borderBottom===it&&n.borderBottom!==it&&(t.borderBottom=An(n.borderBottom)),t.diagonalUp===it&&n.diagonalUp!==it&&(t.diagonalUp=An(n.diagonalUp)),t.diagonalDown===it)&&n.diagonalDown!==it&&(t.diagonalDown=An(n.diagonalDown)),t.locked===it&&!1!==n.applyProtection&&(t.locked=n.locked),t.quotePrefix===it&&n.quotePrefix!==it&&(t.quotePrefix=n.quotePrefix)}function An(t){var n;return t&&(n={},rt(t.color)||(n.color=t.color),rt(t.style)||(n.style=t.style),rt(t.level)||(n.level=t.level),n)}h=this&&this.__extends||(Nt=function(t,n){return(Nt=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(t,n){t.__proto__=n}:function(t,n){for(var e in n)Object.prototype.hasOwnProperty.call(n,e)&&(t[e]=n[e])}))(t,n)},function(t,n){if("function"!=typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function e(){this.constructor=t}Nt(t,n),t.prototype=null===n?Object.create(n):(e.prototype=n.prototype,new e)}),M=this&&this.__assign||function(){return(M=Object.assign||function(t){for(var n,e,i,r,e=1,i=arguments.length;e<i;e++)for(r in n=arguments[e])Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r]);return t}).apply(this,arguments)},C=this&&this.__rest||function(t,n){var e,i,r,e={};for(i in t)Object.prototype.hasOwnProperty.call(t,i)&&n.indexOf(i)<0&&(e[i]=t[i]);if(null!=t&&"function"==typeof Object.getOwnPropertySymbols)for(r=0,i=Object.getOwnPropertySymbols(t);r<i.length;r++)n.indexOf(i[r])<0&&Object.prototype.propertyIsEnumerable.call(t,i[r])&&(e[i[r]]=t[i[r]]);return e},Object.defineProperty(t,"__esModule",{value:!0}),t.Y8=t.clearSpillValuesOnAddRemove=t.Z8=t.W8=t.h9=t.Q8=t.K8=t.getOADateNumber=void 0,x=n("./dist/core/core.ns.js"),q=n("./dist/core/worksheet/style.js"),S=n("Common"),k=n("CalcEngine"),R=n("CalcEngine"),D=n("./dist/core/util/common.js"),$=n("./dist/core/util/common.js"),_=n("./dist/core/util/domUtil.js"),tt=n("./dist/core/core.enum.js"),E=n("./dist/core/celltype/celltype.ns.js"),P=n("./dist/core/excel-io-util/common.js"),at=n("./dist/core/excel-io-util/excel-types.js"),B=!!k,j=_.GC$.each,nt=_.GC$.isEmptyObject,O=_.GC$.extend,G=new RegExp("^\\d*(\\.\\d+)?\\*$"),et=null,it=void 0,U="string",T=Math.min,H=Math.floor,g=Math.max,I=Math.ceil,z="dirtyNodes",V="undo",p="rowInfos",b="colInfos",Y="default_size",s=S.Common.J8,d=S.Common.X8,rt=S.Common.lt.ht,Z=S.Common.zf,W=$.util.wt,Q=$.util.g0,ut=$.util.St,ot=S.Common.lt.tv,J=S.Common.lt.q8,K=200,X=20,st="bindingPath",v=$.UsedRangeUtil.vh,ct=$.UsedRangeUtil.hh,L=$.UsedRangeUtil.updateUsedRangeByData,n=new S.Common.ResourceManager(x.SR,"Sheets"),ft=n.getResource.bind(n),t.getOADateNumber=Rt,e.prototype.find=function(t,n){return this.cache[t+"_"+n]||et},e.prototype.get=function(t,n){return this.find(t,n)||(0,$.Ec)(t,n,1,1)},e.prototype.remove=function(t,n){var t=this.spans.indexOf(t);0<=t?(n&&(n[0].push("spans"),n[1]=[].concat(this.spans)),this.removeSpan(t,1),n&&(n[2]=[].concat(this.spans))):n&&(n.length=0)},e.prototype.removeSpan=function(t,n){for(var e=0;e<n;e++)Ot(this,this.spans[t+e]);this.spans.splice(t,n)},e.prototype.update=function(t,n){var e=this;Ot(e,e.spans[t]),e.spans[t]=n,jt(e,n)},e.prototype.add=function(t,n){n&&(n[0].push("spans"),n[1]=[].concat(this.spans)),jt(this,t),this.spans.push(t),n&&(n[2]=[].concat(this.spans))},e.prototype.tE=function(t,n,e,i,r,o,a){var u,s,c,f,l,h,d,v,m,u=this,s=!1;for(a&&(c=[].concat(u.spans)),f=u.spans.length,m=[],v=0;v<f;v++)d=(l=u.spans[v]).col,h=l.row,(-1===t||t<=h&&h<t+r)&&(-1===n||n<=d&&d<n+o)?(m.push((0,$.Ec)(-1===t?h:e+h-t,-1===n?d:i+d-n,y(l),w(l))),s=!0):(-1===t||e<=h&&h<e+r)&&(-1===n||i<=d&&d<i+o)&&(u.removeSpan(v,1),v--,f--,s=!0);for(v=0;v<m.length;v++){if(!u.nE(u.spans,0,u.spans.length,l=m[v]))throw new Error(ft().Exp_OverlappingSpans);u.add(l)}a&&(s?(a[0].push("spans"),a[1]=c,a[2]=[].concat(u.spans)):a.length=0)},e.prototype.nE=function(t,n,e,i){for(var r=n;r<e&&r<t.length;r++)if(t[r].intersect(i.row,i.col,y(i),w(i)))return!1;return!0},e.prototype.getSpans=function(t){var n,e,i,r,n=this.spans;if(!t)return[].concat(n);for(e=[],i=0;i<n.length;i++)(r=n[i]).intersect(t.row,t.col,y(t),w(t))&&e.push(r);return e},e.prototype.GT=function(t,n,e,i){for(var r,o,a,r=this.spans,o=0;o<r.length;o++)if((a=r[o]).intersect(t,n,e,i)&&(-1!==t&&(a.row<t||a.row+y(a)>t+e)||-1!==n&&(a.col<n||a.col+w(a)>n+i)))return!0;return!1},e.prototype.eE=function(t,n,e,i){for(var r,o,a,u,r=!1,o=this.spans,a=0,u=o.length;a<u;a++){if(0<=t||0<=n)for(;a<u&&!o[a].intersect(t,n,e,i);)a++;if(a<u){r=!0;break}}return r},e.prototype.d5=function(t,n,e,i,r){var o,a,u,s,c,f,c,o=this.spans,a=!1;for(r&&(u=[].concat(o)),s=0;s<o.length;s++)f=(c=o[s]).row,c=c.col,(-1===t||t<=f&&f<t+e)&&(-1===n||n<=c&&c<n+i)&&(this.removeSpan(s,1),s--,a=!0);r&&(a?(r[0].push("spans"),r[1]=u,r[2]=[].concat(this.spans)):r.length=0)},e.prototype.iE=function(t,n,e,i,r,o,a){var u,s,c,f,l,h,d,v,m,g,p,u=this,s=!1;for(a&&(c=[].concat(u.spans)),f=[],l=[],h=u.spans.length,g=0;g<h;g++)v=(d=u.spans[g]).row,m=d.col,(-1===t||t<=v&&v<t+r)&&(-1===n||n<=m&&m<n+o)?(p=(0,$.Ec)(-1===t?v:e+v-t,-1===n?m:i+m-n,y(d),w(d)),l.push(p),s=!0):(-1===t||e<=v&&v<e+r)&&(-1===n||i<=m&&m<i+o)?s=!0:f.push(d);if(s){if(0<l.length)for(g=0;g<l.length;g++){if(!u.nE(f,0,f.length,p=l[g]))throw new Error(ft().Exp_OverlappingSpans);f.push(p)}for(u.spans.length=0,u.cache={},g=0;g<f.length;g++)u.add(f[g]);a&&(a[0].push("spans"),a[1]=c,a[2]=[].concat(u.spans))}else a&&(a.length=0)},e.prototype.rE=function(t,n,e){var i,r,o,a,u,s,c,f,l,h,c,i=this,r=i.spans,o=!(i.suspendUpdatingCache=!0);for(e&&(a=[].concat(r)),u=r.length,s=0;s<u;s++)f=(c=r[s]).row,l=c.col,h=y(c),c=w(c),t<=f?(i.update(s,(0,$.Ec)(f+n,l,h,c)),o=!0):t<f+h&&(i.update(s,(0,$.Ec)(f,l,h+n,c)),o=!0);i.suspendUpdatingCache=!1,o&&Et(i,r),e&&(o?(e[0].push("spans"),e[1]=a,e[2]=[].concat(i.spans)):e.length=0)},e.prototype.oE=function(t,n,e){var i,r,o,a,u,s,c,f,l,h,c,i=this,r=i.spans,o=!(i.suspendUpdatingCache=!0);for(e&&(a=[].concat(r)),u=r.length,s=0;s<u;s++)f=(c=r[s]).row,l=c.col,h=y(c),c=w(c),t<=l?(i.update(s,(0,$.Ec)(f,l+n,h,c)),o=!0):t<l+c&&(i.update(s,(0,$.Ec)(f,l,h,c+n)),o=!0);i.suspendUpdatingCache=!1,o&&Et(i,r),e&&(o?(e[0].push("spans"),e[1]=a,e[2]=[].concat(i.spans)):e.length=0)},e.prototype.aE=function(t,n,e){var i,r,o,a,u,s,c,f,l,h,d,f,h,v,i=this,r=i.spans,o=!(i.suspendUpdatingCache=!0);for(e&&(a=[].concat(r)),u=[],s=r.length,c=0;c<s;c++)l=(f=r[c]).row,h=f.col,d=y(f),f=w(f),t<=l?o=(l<t+n?l+d<=t+n?u.push(c):i.update(c,(0,$.Ec)(t,h,l+d-(t+n),f)):i.update(c,(0,$.Ec)(l-n,h,d,f)),!0):t<l+d&&(h=(0,$.Ec)(l,h,d-T(l+d-t,n),f),i.update(c,h),1===h.rowCount&&1===h.colCount&&u.push(c),o=!0);for(c=u.length-1;0<=c;c--)i.removeSpan(v=u[c],1);i.suspendUpdatingCache=!1,o&&Et(i,r),e&&(o?(e[0].push("spans"),e[1]=a,e[2]=[].concat(i.spans)):e.length=0)},e.prototype.uE=function(t,n,e){var i,r,o,a,u,s,c,f,l,h,d,f,l,v,i=this,r=i.spans,o=!(i.suspendUpdatingCache=!0);for(e&&(a=[].concat(r)),u=[],s=r.length,c=0;c<s;c++)l=(f=r[c]).row,h=f.col,d=y(f),f=w(f),t<=h?o=(h<t+n?h+f<=t+n?u.push(c):i.update(c,(0,$.Ec)(l,t,d,h+f-(t+n))):i.update(c,(0,$.Ec)(l,h-n,d,f)),!0):t<h+f&&(l=(0,$.Ec)(l,h,d,f-T(h+f-t,n)),i.update(c,l),1===l.rowCount&&1===l.colCount&&u.push(c),o=!0);for(c=u.length-1;0<=c;c--)i.removeSpan(v=u[c],1);i.suspendUpdatingCache=!1,o&&Et(i,r),e&&(o?(e[0].push("spans"),e[1]=a,e[2]=[].concat(i.spans)):e.length=0)},e.prototype.toJSON=function(){var t=[].concat(this.spans);return 0===t.length?it:t},e.prototype.fromJSON=function(t,n,e){var i,r,o,a,u,a,u;if(t)for(this.spans=[],i=t,r=0;r<i.length;r++)a=y(o=i[r]),u=w(o),a=rt(n)?a:T(a,n),u=rt(e)?u:T(u,e),this.add((0,$.Ec)(o.row,o.col,a,u))},lt=e,Bt.prototype.pop=function(){return et},Bt.prototype.push=function(t){return 0},Bt.prototype.splice=function(t,n){for(var e,i,e=[],i=2;i<arguments.length;i++)e[i-2]=arguments[i];return et},Bt.prototype.slice=function(t,n){return null},(k=Bt).prototype=[],h(Lt,kt=k),Lt.prototype.find=function(t){for(var n,e,i,r,o,n=this,e=n.length,r=[],o=0;o<e;o++)(i=n[o]).contains(t)&&r.push(i);return r},t.K8=Lt,Ft.prototype.contains=function(t){return t>=this.startColumn&&t<=this.endColumn},t.Q8=Ft,i.prototype.getProperty=function(t){return this[t]},i.prototype.setProperty=function(t,n,e){e&&(e[0].push(t),e[1]=this[t],e[2]=n),this[t]=n},i.prototype.clear=function(t){t&&(t.push(["selections",this.get()]),t.push(["activeSelectedRangeIndex",this.activeSelectedRangeIndex])),this.selections=[],this.activeSelectedRangeIndex=-1},i.prototype.add=function(t,n,e,i,r,o){r&&(r.push(["selections",this.get()]),r.push(["activeSelectedRangeIndex",this.activeSelectedRangeIndex]));var r=this,a=r.selectionPolicy,u=r.selectionUnit;0===a?(e=T(e,1),i=T(i,1),r.clear()):1===a&&r.clear(),1===u?i=n=-1:2===u&&(e=t=-1),r.selections.push((0,$.Ec)(t,n,e,i)),!1!==o&&(r.activeSelectedRangeIndex=r.selections.length-1)},i.prototype.get=function(){return[].concat(this.selections)},i.prototype.set=function(t,n){n&&(n.push(["selections",this.get()]),n.push(["activeSelectedRangeIndex",this.activeSelectedRangeIndex])),this.selections=t,this.activeSelectedRangeIndex>=t.length&&(this.activeSelectedRangeIndex=0)},i.prototype.toJSON=function(){var t,n,e,i,r,o,a,t=this,n={},e=t.selectionPolicy,i=t.selectionUnit,r=t.activeSelectedRangeIndex,o=t.selections.length;for(2!==e&&(n.selectionPolicy=e),0!==i&&(n.selectionUnit=i),0!==r&&(n.activeSelectedRangeIndex=r),n.length=o,a=0;a<o;a++)n[a]=t.selections[a];return nt(n)?it:n},i.prototype.fromJSON=function(t,n,e){var i,r,o,a,u,n,e,s,c,f,i=n||200,r=e||20;if(t){for((u=this).clear(),n=t.selectionPolicy,e=t.selectionUnit,s=t.length,rt(s)&&(s=1),c=0;c<s;c++)f=t[c],o=T(f?y(f):1,i),a=T(f?w(f):1,r),u.selections.push((0,$.Ec)(f?f.row:0,f?f.col:0,o,a));u.activeSelectedRangeIndex=t.activeSelectedRangeIndex||0,rt(n)||(u.selectionPolicy=n),rt(e)||(u.selectionUnit=e)}},i.prototype.T9=function(t){for(var n,e,i,r,n=this.selections,e=0;e<n.length;e++)if(r=-1===(i=n[e]).col?0:i.col,-1===i.row&&r<=t&&t<r+w(i))return!0;return!1},i.prototype.S9=function(t){for(var n,e,i,r,n=this.selections,e=0;e<n.length;e++)if(r=-1===(i=n[e]).row?0:i.row,-1===i.col&&r<=t&&t<r+y(i))return!0;return!1},i.prototype.ni=function(t,n,e,i,r,o){for(var a,u,s,c,f,l,h,d,v,d,v,a=!1,u=this.selections,s=o?1:0,c=0,f=u.length;c<f&&(d=(h=Pt(l=u[c],i,r)).row,v=h.col,d=d-s<=t&&t<d+y(h)+s,v=v-s<=n&&n<v+w(h)+s,3===e||rt(e)?a=d&&v:2===e?a=d:1===e?a=v:0===e&&(a=-1===l.row&&-1===l.col),!a);c++);return a},i.prototype.ei=function(t,n,e,i,r){for(var o,a,u,s,c,f,l,s,h,d,c,c,o=this.selections,a=!1,u=0;u<o.length&&(c=(s=o[u]).row,f=s.col,l=y(s),s=w(s),h=-1===f,d=-1===c,rt(e)||3===e||(2===e?(c=d?0:c,a=h&&c<=t&&t<c+l):1===e?(c=h?0:f,a=d&&c<=n&&n<c+s):0===e&&(a=d&&h&&l===i&&s===r),!a));u++);return a},vt=i,h(r,Dt=k),r.prototype.findCell=function(t,n){for(var e,i,r,e=this.length,r=0;r<e;r++)if((i=this[r]).contains(t,n))return i;return et},r.prototype.sE=function(){this.cE={}},r.prototype.fE=function(t,n){this.cE[t]=n},r.prototype.findRow=function(t){var n,e,i,r,n=this.cE;if(n)return n[t];for(e=this.length,r=0;r<e;r++)if((i=this[r]).row===t)return i;return et},r.prototype.findCol=function(t){for(var n,e,i,n=this.length,i=0;i<n;i++)if((e=this[i]).col===t)return e;return et},r.prototype.findLargestRow=function(t){var n,e,i,r,o,n=this.length;if(0===n)return et;for(r=e=0;r<n;r++)(o=this[r]).row===t&&o.height>e&&(e=o.height,i=r);return J(i)&&this[i]},r.prototype.findLargestCol=function(t){var n,e,i,r,o,n=this.length;if(0===n)return et;for(r=e=0;r<n;r++)(o=this[r]).col===t&&o.width>e&&(e=o.width,i=r);return J(i)&&this[i]},r.prototype.findLargestRange=function(t,n){var e,i,r,o,a,u,s,c,f,l,e=this.length;if(0===e)return et;for(i=t.row,r=t.col,o=t.rowCount,a=t.colCount,c=s=0;c<e;c++)if(n)for(f=t.row;f<i+o;f++)(l=this[c]).row===f&&l.height>s&&(s=l.height,u=c);else for(f=t.col;f<r+a;f++)(l=this[c]).col===f&&l.width>s&&(s=l.width,u=c);return J(u)&&this[u]},r.prototype.findX=function(t,n){return Gt(this,it,it,t,it,n)},r.prototype.findY=function(t){return Gt(this,it,it,it,t)},r.prototype.findNearX=function(t){return Ut(this,t)},r.prototype.findNearY=function(t){return Ut(this,it,t)},r.prototype.findXByExactY=function(t,n,e){var i,t,r,o,a,u,i=this.findX(t,!0);if(!Array.isArray(i))return i;for(t=i.length,r=e.y,o=e.height,a=t-1;0<=a;a--)if(n>r+(u=i[a]).y*o)return u},t.h9=r,Ht.prototype.contains=function(t,n){var e=this;return t<e.row+y(e)&&e.row<=t&&n<e.col+w(e)&&e.col<=n},Ht.prototype.intersect=function(t){var n=this;return(n.x<0||t.x<n.x+n.width&&n.x<t.x+t.width)&&(n.y<0||t.y<n.y+n.height&&n.y<t.y+t.height)},Ht.prototype.containsX=function(t){return this.x<=t&&t<this.x+this.width},Ht.prototype.containsY=function(t){return this.y<=t&&t<this.y+this.height},t.W8=Ht,o.prototype.Hc=function(){var t=this;t.dataTable={},t.rowDataArray=[],t.columnDataArray=[],t.defaultDataNode=et,t.B8={},t.lE=0,t.x8=-1,t.I8=-1},o.prototype.z8=function(){var t;this.a8={data:new $.BaseUsedRange,style:new $.BaseUsedRange}},o.prototype.hE=function(t){var n,e=this.a8,i={};if(!rt(e))return t&tt.UsedRangeType.data&&v(i,e.data.getUsedRange()),t&tt.UsedRangeType.style&&v(i,e.style.getUsedRange()),t&tt.UsedRangeType.rowStyle&&v(i,e.style.getRowUsedRange()),t&tt.UsedRangeType.colStyle&&v(i,e.style.getColUsedRange()),i},o.prototype.getRowCount=function(){return this.Sx},o.prototype.getColumnCount=function(){return this.Tx},o.prototype.setRowCount=function(t){this.Sx=t},o.prototype.setColumnCount=function(t){this.Tx=t},o.prototype.getFreeAreaRowCount=function(){return this.j8},o.prototype.getFreeAreaColumnCount=function(){return this.O8},o.prototype.setFreeAreaRowCount=function(t){this.j8=t},o.prototype.setFreeAreaColumnCount=function(t){this.O8=t},o.prototype.dE=function(t,n,e,i,r){var o,a,u,o,u,o,a,t,o=this,a=o.B8;if(!(0<o.lE)){if(o=t+"_"+n,(u=this.B8.vE)&&u[o]){if(u[o].oldCalcValue===e.mE)return;delete u[o]}0<=t&&0<=n&&(i&&(i.type="updateDirty",i.row=t,i.col=n,i.skipUndo=r,a[t]?a[t][n]||(i.isEmptyCol=!0):i.isEmptyRow=!0),a[t]||(a[t]={}),(u=a[t])[n]||(u[n]={}),o=u[n],"n"!==u.rs&&(u.rs="e"),a=e.gE,t=e.d6,rt(a)||(i&&(i.originalItem=u.originalItem),u.originalItem=a),rt(t)||(i&&(i.oldValue=o.oldValue,r)&&(i.oldCalcValue=t),o.oldValue=t))}},o.prototype.pE=function(t){var n,e,i,n=this.B8,e=t.row,i=t.col;t.skipUndo&&(this.B8.vE=this.B8.vE||{},this.B8.vE[e+"_"+i]=t),t.isEmptyRow&&n?delete n[e]:t.isEmptyCol&&n[e]?delete n[e][i]:(t.hasOwnProperty("originalItem")&&(rt(t.originalItem)&&!rt(n[e].originalItem)?delete n[e].originalItem:n[e].originalItem=t.originalItem),t.hasOwnProperty("oldValue")&&n[e]&&(rt(t.oldValue)&&!rt(n[e][i].oldValue)?delete n[e][i].oldValue:n[e][i].oldValue=t.oldValue))},o.prototype.getValue=function(t,n,e){var t=this.J_(t,n);return t&&!rt(t.value)?1!==e?W(t.value):rt(t.value.richText)?t.value:O(!0,{},t.value):et},o.prototype.setValue=function(t,n,e,i,r,o){var a,u,a=this.J_(t,n,!0,i?i[0]:it);!a||rt(a.value)&&rt(e)||a.value===e?i&&(i.length=0):(u=a.value,a.value=e,this.dE(t,n,{d6:u,mE:e},r,o),i&&(i[0].push("value"),i[1]=u,i[2]=e),this.a8&&(e&&"SparklineExValue"===e.typeName&&(e=et),L(this.a8.data,t,n,u,e)))},o.prototype.getStyle=function(t,n,e){var t,n,t=this.J_(t,n),n=t&&t.style;return n=n&&e&&n.clone?n.clone(!0):n},o.prototype.setStyle=function(t,n,e,i){var r,o,r=this.J_(t,n,!0,i?i[0]:it);r&&r.style!==e?(o=r.style,r.style=e,i&&(i[0].push("style"),i[1]=o,i[2]=e),this.a8&&L(this.a8.style,t,n,o,e)):i&&(i.length=0)},o.prototype.getCellState=function(t,n){var t=this.J_(t,n);return t?t.cellState:et},o.prototype.setCellState=function(t,n,e,i){var i,r,o=this.getCellState(t,n)||0,i=i?o|e:o&~e;0!==i?(r=this.J_(t,n,!0,it,!0))&&(r.cellState=i):((r=this.J_(t,n))&&delete r.cellState,nt(r)&&(fn(this.dataTable,t,n),nt(this.dataTable[t]))&&delete this.dataTable[t])},o.prototype.getValueForKey=function(t,n,e){var t=this.J_(t,n);return t&&t[e]},o.prototype.setValueForKey=function(t,n,e,i,r){var o,a,o=this.J_(t,n,!0,r?r[0]:it);o&&o[e]!==i?(a=o[e],o[e]=i,r&&(r[0].push(e),r[1]=a,r[2]=i),this.bE(t,n,e,a,i)):r&&(r.length=0)},o.prototype.bE=function(t,n,e,i,r){var o,a=this.a8;e===st&&a&&L(a.data,t,n,i,r)},o.prototype.rE=function(t,n,e){var i,r,o,a,u,i=this,r=i.Sx,o=i.dataTable,a=i.B8;if(0<=t&&t<=r&&0<=n){if(s(o,r,t,n),s(i.rowDataArray,r,t,n),s(a,r,t,n),i.Sx+=n,!e)for(u=0;u<n;u++)o[t+u]={rs:"n"},a[t+u]={rs:"n"};this.a8&&(this.a8.data.addHeadInfo(t,n,!0),this.a8.style.addHeadInfo(t,n,!0))}},o.prototype.yE=function(t,n,e){var i,r,o,a,i=this,r=i.Sx;if(0<=t&&t<r&&0<n){if(r<t+n&&(n=r-t),e)for(o=0;o<n;o++)e.push([["dataTable",a=t+o],i.dataTable[a]]),e.push([["rowDataArray",a],i.rowDataArray[a]]),e.push([[z,a],i.B8[a]]);d(i.dataTable,r,t,n),d(i.rowDataArray,r,t,n),d(i.B8,r,t,n),i.Sx-=n,this.a8&&(this.a8.data.removeHeadInfo(t,n,!0),this.a8.style.removeHeadInfo(t,n,!0))}},o.prototype.oE=function(t,n){var e,i,r,o,a,a,e=this,i=e.Tx,r=e.B8;if(0<=t&&t<=i&&0<=n){for(o=0;o<e.Sx;o++)(a=e.dataTable[o])&&t<i&&(s(a,i,t,n),a=r[o])&&Jt(a,t,n);s(e.columnDataArray,i,t,n),e.Tx+=n,this.a8&&(this.a8.data.addHeadInfo(t,n,!1),this.a8.style.addHeadInfo(t,n,!1))}},o.prototype.wE=function(t,n,e){var i,r,o,a,u,s,c,f,l,h,i=this,r=i.Tx,o=i.B8;if(0<=t&&t<r&&0<n){for(a=0;a<i.Sx;a++)if(u=i.dataTable[a]){if(e)for(s=0;s<n;s++)e.push([["dataTable",a,c=t+s],u[c]]),i.B8[a]&&e.push([[z,a,c],i.B8[a][c]]);d(u,r,t,n),Kt(f=o[a],t,n)}if(e)for(l=0;l<n;l++)e.push([["columnDataArray",h=t+l],i.columnDataArray[h]]);d(i.columnDataArray,r,t,n),i.Tx-=n=r<t+n?r-t:n,this.a8&&(this.a8.data.removeHeadInfo(t,n,!1),this.a8.style.removeHeadInfo(t,n,!1))}},o.prototype.ME=function(t,n,e,i){var r=this,o=t[n];return e&&(o=o||(t[n]={}),!i)&&n>r.I8&&(r.I8=n),o},o.prototype.CE=function(t,n,e,i){var r,o;if(t)return r=this,o=t[n],e&&(o=o||(t[n]={}),!i)&&r.x8<n&&(r.x8=n),o},o.prototype.J_=function(t,n,e,i,r){var o,a,u,s,c,a,o=this,a=o.dataTable,u=o.columnDataArray,s=o.rowDataArray,c=et;return t<o.Sx&&n<o.Tx&&(0<=t&&0<=n?(a=o.ME(a,t,e,r),c=o.CE(a,n,e,r),i&&i.push("dataTable",t,n)):-1===t&&0<=n?(c=u[n],e&&(c=c||(u[n]={}),!r)&&o.x8<n&&(o.x8=n),i&&i.push("columnDataArray",n)):0<=t&&-1===n?(c=s[t],e&&(c=c||(s[t]={}),!r)&&o.I8<t&&(o.I8=t),i&&i.push("rowDataArray",t)):-1===t&&-1===n&&(c=o.defaultDataNode,e&&!c&&(c=o.defaultDataNode={}),i)&&i.push("defaultDataNode")),c},o.prototype.setNode=function(t,n,e){var i,r,o,a,u,i=this,r=i.dataTable,o=i.columnDataArray,a=i.rowDataArray;t<i.Sx&&n<i.Tx&&(0<=t&&0<=n?(u=(u=r[t])||(r[t]={}))[n]=e:-1===t&&0<=n?o[n]=e:-1===n&&0<=t&&(a[t]=e))},o.prototype.SE=function(t,n,e,i,r){var o,a,u,s,c,f,l,h,d,v,m,g,p;r&&(o=[],a=[]),s=(u=this).dataTable,c=u.rowDataArray,f=u.columnDataArray,l=u.B8,h=u.J_(t,n,it,o),d=l[t]&&l[t][n],v=l[t]&&l[t].originalItem,m=u.J_(e,i,it,a),g=l[e]&&l[e][i],p=l[e]&&l[e].originalItem,r&&(r.push([o,h]),r.push([a,m])),h?Wt(t,n,e,i,h,s,c,f,u):m&&Wt(t,n,e,i,et,s,c,f,u),m?Wt(e,i,t,n,m,s,c,f,u):h&&Wt(e,i,t,n,et,s,c,f,u),d?Qt(t,n,e,i,d,l,v):g&&Qt(t,n,e,i,et,l,v),g?Qt(e,i,t,n,g,l,p):d&&Qt(e,i,t,n,et,l,p)},o.prototype.gT=function(t){t++;for(var n=this.Sx,e=this.dataTable;0<=t&&t<n&&!e[t];)t++;return t<n?t:-1},o.prototype.pT=function(t,n){var e,i,r,e=this,i=et,r=e.Tx;if(i=0<=t&&t<e.Sx?e.dataTable[t]:i){for(n++;0<=n&&n<r&&!i[n];)n++;if(n<r)return n}return-1},o.prototype.U8=function(t){for(var n,e,i,r,o,a,u,s,c,f,l,n=t.row,e=t.col,i=t.rowCount,r=t.colCount,o=this,a=n,u=0;u<i;u++,a++)for(s=e,c=0;c<r;c++,s++)l=void 0,(f=o.J_(a,s))&&(l=f.value,f.value=et,o.a8)&&L(o.a8.data,a,s,l,et)},o.prototype.TE=function(t,n,e){var e=e&&e.getFormatter(t,n);return!!ut(e)&&e},o.prototype.clear=function(t,n,e,i,r,o,a){var u,s,c,f,l,h,d,v,m,g,p,b,y,w,M,C,u=this,s=u.Sx,c=u.Tx,f=[],l=[],m=!!a,g=[];if(0<=t&&0<=n){if(e=T(e,s-t),i=T(i,c-n),0<e&&0<i)for(v=t;v<t+e;v++)if(!o||S.Common.Uf.hD(o,v)<0)for(d=n;d<n+i;d++)m&&(p=[]),(h=u.J_(v,d,it,p))&&(f.push(h),l.push({r:v,c:d}),m&&g.push(p),0<(1&r))&&!rt(h.value)&&(b=m?{}:void 0,u.dE(v,d,{d6:h.value},b),b)&&a.push(b)}else if(0<=t&&-1===n){if(0<(e=T(e,s-t)))for(v=t;v<t+e;v++)m&&(p=[]),(h=u.J_(v,-1,it,p))&&(f.push(h),l.push({r:v,c:d}),m)&&g.push(p)}else if(-1===t&&0<=n){if(0<(i=T(i,c-n)))for(d=n;d<n+i;d++)m&&(p=[]),(h=u.J_(-1,d,it,p))&&(f.push(h),l.push({r:v,c:d}),m)&&g.push(p)}else-1===t&&-1===n&&(m&&(p=[]),h=u.J_(-1,-1,it,p))&&(f.push(h),l.push({r:v,c:d}),m)&&g.push(p);for(u.a8&&(y=u.a8.style,w=u.a8.data),M=function(e){var t;(h=f[e])&&(t=m?[]:it,0<(8&r)&&(t&&t.push(["tag",h.tag]),h.tag=et),0<(2&r)&&(t&&t.push(["style",h.style]),y&&L(y,l[e].r,l[e].c,h.style,et),h.style=et),0<(1&r)&&(t&&t.push(["value",h.value]),w&&L(w,l[e].r,l[e].c,h.value,et),h.value=et),0<(16&r)&&(t&&t.push(["sparkline",h.sparkline]),h.sparkline=et),0<(64&r)&&(t&&t.push(["bindingPath",h.bindingPath]),w&&L(w,l[e].r,l[e].c,h.bindingPath,et),h.bindingPath=et),0<(256&r)&&(t&&t.push(["hyperlink",h.hyperlink]),h.hyperlink=et),0<(4&r)&&(t&&t.push(["comment",h.comment]),h.comment=et),m)&&t.forEach(function(t){var n=[].concat(g[e]);n.push(t[0]),t[0]=n,a.push(t)})},C=0;C<f.length;C++)M(C)},o.prototype.toJSON=function(t,l,h){var d,n,e,i,r,o,a,u,s,c,f,v,m,g,p,b,y,w,M,C,S,T,A,I,t;function x(t,n,e,i,r,o){var a,u,s,c,o,f,t,n,c,s,o;return e&&(u=!(a={}),s=e.value,rt(s)||(a.value=s,u=!0),l&&l.saveAsView&&(c=void 0,o?c=o:d&&(c=h&&h.getFormatter(t,n)),c)&&ut(c)&&(o=h.Oe(t,n,c,s),rt(o)||(a.value=o,u=!0)),(f=l&&l.ignoreStyle)||(t=e.style)&&!nt(t)&&("string"==typeof t?(a.style=t,u=!0):(n=t.toJSON(i,r))&&(n.name=it,n.fontForColumnWidth=t.fontForColumnWidth,a.style=n,u=!0)),c=e.bindingPath,rt(c)||(a.bindingPath=c,u=!0),s=e.tag,rt(s)||(a.tag=s,u=!0),o=e.hyperlink,rt(o)||(a.hyperlink=ot(o),delete a.hyperlink.isVisited,u=!0),!0===u)?a:et}if(d=h&&h.parent&&!nt(h.parent.bp),e={},i={},r=(n=this).Sx,o=n.Tx,a=n.dataTable,u=n.rowDataArray,s=n.columnDataArray,l&&l.saveAsView)for(v=0,m=3===t&&d;v<r;){if((g=a[v])||m){for(b=!(p={}),y=0;y<o;)w=void 0,g&&g[y]?w=x(v,y,g[y]):m&&(M=this.TE(v,y,h))&&(g=g||n.ME(a,v,!0),w=x(v,y,n.CE(g,y,!0),3,!1,M)),rt(w)||(p[y]=w,b=!0),y++;b&&(i[v]=p)}v++}else for(c=n.gT(-1);0<=c;){for(b=!(p={}),f=n.pT(c,-1);0<=f;)(C=n.J_(c,f))&&(w=x(c,f,C),nt(w)||(p[f]=w,b=!0)),f=n.pT(c,f);b&&(i[c]=p),c=n.gT(c)}for(nt(i)||(e.dataTable=i),S=[],c=0;c<r;c++)N(u,c)&&u[c]&&(T=x(c,-1,u[c]),nt(T)||(S[c]=T));for(0<S.length&&(e.rowDataArray=S),A=[],f=0;f<o;f++)N(s,f)&&s[f]&&(I=x(-1,f,s[f]),nt(I)||(A[f]=I));return 0<A.length&&(e.columnDataArray=A),t=x(-1,-1,n.defaultDataNode,t,!0),nt(t)||(e.defaultDataNode=t),e},o.prototype.fromJSON=function(t,n,e,i,r,o,a){var u,s,c,f,l,h,d,v,m,g,p,o,u=e&&e.incrementalLoading;if(t){if((s=this).Hc(),s.lE++,c=t.dataTable,h=s.Sx,d=s.Tx,c?u&&3===o?Vt(s,c,h,d,e,n,it,a,s.a8,i,r):Yt(s,c,h,d,e,n,s.a8,i,r):u&&a&&setTimeout(a,0),g=t.rowDataArray||t.AE)for(f=0;f<h;f++)N(g,f)&&g[f]&&qt(g[f],s.J_(f,-1,!0),n,f,-1,e,s.a8);if(p=t.columnDataArray||t.IE)for(l=0;l<d;l++)N(p,l)&&p[l]&&qt(p[l],s.J_(-1,l,!0),n,-1,l,e,s.a8);(o=t.defaultDataNode||t.xE)&&qt(o,s.J_(-1,-1,!0),n,-1,-1,e,s.a8),s.lE--}else u&&a&&setTimeout(a,0)},o.prototype.wh=function(t,r,n,B,e,i){var o,L,F,P,G,U,H,a,z,u,V,s,i,u,c,i,f,l,h,d,v,m,g,m,Y,p,b,y,w,w,M,C,S,T,A,I,x,N,k,D,_,E,j,O,Z,W,Q,J,j,R,K,X,w,o=this,L=0,F=0,P=o.Sx,G=o.Tx,U=o.dataTable,H=[],a=i&&!1===i.includeStyles,z=i&&i.saveAsView,u=i&&!1===i.includeEmptyRegionCells,V=t&&t.parent&&!nt(t.parent.bp),s=i&&i.fileType===tt.OpenSaveFileType.excel;for(u&&(i=tt.UsedRangeType.all-tt.UsedRangeType.colStyle-tt.UsedRangeType.rowStyle-tt.UsedRangeType.style-tt.UsedRangeType.axis,u=t.getUsedRange(i))&&(L=u.row,F=u.col,P=u.row+u.rowCount,G=u.col+u.colCount),i={sheetData:c={n_:at.XFileConstants.bo,rowCount:o.Sx,colCount:o.Tx},hyperlinks:H},f=!t.NMi&&t.getDefaultStyle(3),Object.keys(r).forEach(function(t){var n,e,i,n,t,n=r[t],e=n&&n.size,i=!rt(e)&&e!==B,n=n&&!1===n.visible?1:it;!0!=i&&!n||((t=c[t]={}).h=i&&e!==it?+$.SJSColumnWidthHelper.pixelToPoint(e).toFixed(2):it,t.v=n)}),l=L;l<P;l++){if(h=c[l]||{r:l+1},d=U[l],v=void 0,g=(m=o.J_(l,-1))&&m.style,rt(g)||a||(s?("string"==typeof g&&0===g.indexOf(n.Jd)&&(m=g,g=(g=t.i3(m,!1))||(Y=t.parent)&&Y.i3(m,!1)),h.s=n.getStyleIndex(g)):"string"==typeof g?h.t=n.getOriginNamedStyleIndex(g):g!==it&&(h.e=n.getOriginStyleIndex(g)),v=!0),d){for(p=F;p<G;p++)if(y={},b=d[p]){if(rt(b.tag)||(y.tag=b.tag),w=b.bindingPath,rt(w)||(y.bindingPath=w),w=o.getStyle(-1,p,!0),M=et,k=b.value,D=o.getStyle(l,p,!(N=x=I=A=T=S=C=void 0)),_=b.hyperlink,E=!1,z&&(!(j=o.TE(l,p,t))&&V&&(j=t.getFormatter(l,p)),ut(j))&&(O=t.Oe(l,p,j,k),!rt(O))){switch(Z=typeof O){case"boolean":T=O?1:0;break;case"string":N=Q=(W=Rt(O,e)).OADateNumber,C=J=W.valueIndex;break;case"object":C=O instanceof Date?(O=$.util.Z0(O),D.formatter="M/d/yyyy",e.getTextIndex(O)):O;break;default:S=isFinite(O)?O:it}E=!0}if(!a)if(s){if(j=_||"string"==typeof k&&"/OADate"===k.substring(0,7)||k!==et&&void 0!==k&&(w||g),D?M=Cn(t,D):j&&(M=new q.Style),M){if(M.parentName)for((R=Cn(t,M.parentName))&&Sn(t,M,R);R&&R.parentName;)(R=Cn(t,R.parentName))&&Sn(t,M,R);g&&Sn(t,M,g),w&&Sn(t,M,w),f&&Sn(t,M,f),M=wn(k,M)}}else"string"==typeof D?I=n.getOriginNamedStyleIndex(D):D!==it&&(x=n.getOriginStyleIndex(D));if(rt(k)&&(I===it&&x===it&&rt(M)||a)&&rt(_))nt(y)||(h[p]={lossless:y},v=!0);else{if(v=!0,!E&&!rt(k))switch(K=typeof k){case"boolean":T=k?1:0;break;case"string":N=Q=(X=Rt(k,e)).OADateNumber,C=J=X.valueIndex;break;case"object":C=k&&k.richText?e.getTextIndex(k):k&&k instanceof Date?e.getTextIndex(k.toISOString()):rt(k._error)&&rt(k._code)?k:{error:k._error,code:k._code};break;default:S=isFinite(k)?k:it}rt(_)||(s&&(M?"string"==typeof M&&(M=t.u8(M)):M=new q.Style,rt(_.linkColor)?_.linkColor===it&&M.foreColor||(M.foreColor="hyperlink"):M.foreColor=_.linkColor,_.drawUnderline&&rt(M.textDecoration)?M.textDecoration=1:2!==M.textDecoration&&4!==M.textDecoration||(M.textDecoration+=1)),H.push({row:l,col:p,value:b.value,hyperlink:ot(_)})),w={s:A=M?n.getStyleIndex(M,3,t.name()):A,v:C,n:S,b:T,t:I,e:x,o:N},nt(y)||(w.lossless=y),h[p]=w}}}v&&(c[l]=h)}return i},o.prototype.yh=function(t,n,e,i,r,o,a,u,s){var c,f,l,h,d,c=this,f={};if(n)for(l=n.colCount,h=0;h<l;h++)(d=c.J_(-1,h))&&d.style&&(f[h]=1);Zt(this,t,n,e,i,r,o,a,u,s,f)},pt=o,a.prototype.NE=function(t,n){var e,i,e=this.infos,i=e[t];return i=!i&&n?e[t]={}:i},a.prototype.kE=function(t,n){var e=this.infos,i=e.length;0<=t&&t<=i&&0<n&&s(e,i,t,n)},a.prototype.DE=function(t,n,e){var i,r,o,a,i=this.infos,r=i.length;if(0<=t&&t<r&&0<n){if(n=T(n,r-t),e)for(o=0;o<n;o++)e.push([["infos",a=t+o],i[a]]);d(i,r,t,n)}},a.prototype._E=function(){return this.infos.length},a.prototype.EE=function(){return this.infos},a.prototype.q_=function(t){return this.infos[t]},a.prototype.X_=function(t,n,e){var i=this.infos[t];this.infos[t]=n,e&&(e[0].push("infos",t),e[1]=i,e[2]=n)},a.prototype.getSize=function(t){var t=this.infos[t],n=et;return t&&(!1===t.visible?n=0:_t(t.size)&&(n=H(t.size))),n},a.prototype.getColumnHeaderFitMode=function(t){var t=this.infos[t],n=tt.ColumnHeaderFitMode.normal;return n=t?t.columnHeaderFitMode||n:n},a.prototype.setColumnHeaderFitMode=function(t,n,e){var i,r,i=this.NE(t,!0),r=i.columnHeaderFitMode;r!==n&&(i.columnHeaderFitMode=n),e&&(e[0].push("infos",t,"columnHeaderFitMode"),e[1]=r)},a.prototype.getActualSize=function(t){var t=this.infos[t];return t?H(t.size):et},a.prototype.setSize=function(t,n,e){var i,r,i=this.NE(t,!0),r=i.size;r!==n&&(i.size=n),e&&(e[0].push("infos",t,"size"),e[1]=r,e[2]=n)},a.prototype.getStarSize=function(t){var t=this.infos[t];return t?t.starSize:it},a.prototype.setStarSize=function(t,n,e){var i,r,i=this.NE(t,!0),r=i.starSize;rt(n)&&rt(r)||(r!==n&&(rt(n)?delete i.starSize:i.starSize=n),e&&(e[0].push("infos",t,"starSize"),e[1]=r,e[2]=n))},a.prototype.getScrollOffsetX=function(t){var t,n,t=this.q_(t),n=0;return n=t&&_t(t.scrollOffsetX)?t.scrollOffsetX:n},a.prototype.setScrollOffsetX=function(t,n,e){var t=this.NE(t,!0);e&&(n+=t.scrollOffsetX||0),t.scrollOffsetX=n},a.prototype.getScrollContentWidth=function(t){var n,t,e,n=this.q_(t),t=this.getSize(t),e=t;return n&&_t(n.scrollContentWidth)&&(e=n.scrollContentWidth),g(e,t)},a.prototype.setScrollContentWidth=function(t,n){var e,t,e=this.NE(t,!0),t=this.getSize(t);e.scrollContentWidth=n=n<t?t:n},a.prototype.getHiddenRows=function(){return this.R8},a.prototype.wh=function(t){return this.infos},a.prototype.yh=function(t,n){var e,i,r,o,a,u,s,e=this,i=t;if(i)for(r=t.rowCount,o=0;o<r;o++)(a=i[o])&&(s=u=void 0,a.h!==it&&(u=Math.round($.SJSColumnWidthHelper.pointToPixel(a.h))),a.v&&(rt(a.l)||0===a.l)&&(s=!1,e.R8.push(o)),rt(u=!1===s&&0===u?it:u)||e.setSize(+o,u),rt(s)||e.setVisible(+o,s))},a.prototype.toJSON=function(t){var n,e,i,r,o,r,r,a,r,a,n=this.infos,e=[];if(t&&t.ignoreStarSize)for(i=0;i<n.length;i++)rt(n[i])||(o=(r=n[i]).cellType,r=C(r,["cellType"]),e[i]=ot(r),o&&(o.toJSON&&(o=o.toJSON()),r=E.ti,a=o.typeName,r=r[o.type]||r[a]||D.getTypeFromString(a))&&((a=new r).fromJSON(o,t),e[i].cellType=a),delete e[i].starSize);else for(i=0;i<n.length;i++)rt(n[i])||(e[i]=n[i]);return 0<e.length?e:it},a.prototype.fromJSON=function(t){t&&(this.infos=t)},bt=(c=a).prototype,j({visible:!0,resizable:!0,pageBreak:!1},function(o,e){var t=o[0].toUpperCase()+o.substr(1);bt["get"+t]=function(t){var n,t,n=e,t=this.infos[t];return n=t&&!rt(t[o])?t[o]:n},bt["set"+t]=function(t,n,e){var i,r,i=this.NE(t,!0),r=i[o];r!==n&&(i[o]=n),e&&(e[0].push("infos",t,o),e[1]=r,e[2]=n)}}),wt=62,Mt=40,Ct=yt=20,u.prototype.L0=function(){this.modelManager=et},u.prototype.getAnchorCell=function(t,n){return F(this.anchors,t,n)},u.prototype.getAnchorItem=function(t,n){return F(this.cells,t,n)},u.prototype.getAnchorInfo=function(t,n,e){var i,r,o,o,a,u,s,i=this,r=i.anchors,o=i.getAnchorCell(t,n);if(o)return o;if(o=i.getAnchorItem(t,n))for(u in a=o.anchorRefs)if(a[u]&&(s=cn(r,u),e||s.isValid))return s},u.prototype.isCellHasItsOwnValue=function(t,n,e){var i,t,r,o,a,u,i=this,t=i.getAnchorItem(t,n);if(t){if(!rt(t.value)||t.jE)return!0;for(a in r=t.anchorRefs,o=i.anchors,r)if(e!==a&&r[a]&&(u=cn(o,a))&&u.isValid)return!0}return!1},u.prototype.removeRef=function(t,n,e,i,r,o){for(var a,u,s,c,f,l,h,d,v,m,g,p,b,y,w,M,p,p,C,a,u=this.cells,s=n.isValid,c=n.row,f=n.col,l=n.rowCount,h=n.colCount,d=1,v=0,m=c;v<l;v++,m++){for(g=f+d;d<h;d++,g++){if(b=(p=F(u,m,g))&&p.anchorRefs,y=!0,s){if(w=t.getValue(m,g),M=p&&p.value,rt(M)){if(p=!(p=p&&p.jE)||p===e,b)for(C in b)if(C!==e&&b[C]){y=!1;break}p?rn(i,m,g,et,w,n.row===m&&n.col===g):M=w}r&&en(r,m,g,M)}b&&(delete b[e],y)&&o&&nt(b)&&fn(u,m,g,!0)}d=0}},u.prototype.OE=function(t,n,e,i,r){var o,a,o,a,t,o=t.getRowCount(),a=t.getColumnCount();return!(o<n+i||a<e+r||(o=t.getSheet(),a=(0,$.Ec)(n,e,i,r),o.Ut.getSpans(a).length)||(t=o.tables)&&t.Pl&&t.Pl(n,e,i,r))},u.prototype.setArray=function(t,n,e,i,r,o,a){var u,s,c,f,l,h,d,v,m,g,p,h,c,c,b,y,w,M,C,S,T,A,I,x,N,k,D,_,E,j,O,u=this,s=an(n,e),c=u.anchors,f=F(c,n,e),l=u.cells;if(f&&!o)return[f,d=(h=u.updateItem(t,n,e))[0],v=h[1]];if(m={},p=!(g={}),f&&f.isValid&&u.removeRef(t,f,s,m,g,p=!0),h=f,nn(c,n,e,f={row:n,col:e,rowCount:i,colCount:r,values:o,isValid:!1}),c=t.getCalcService().RE,f.RE=c,c=h&&h.RE===c&&(i!==h.rowCount||r!==h.colCount),y=(b=t.G3)&&F(u.invalidAnchors,n,e))rn(m,n,e,B&&R.Errors.Spill,et,f.row===n&&f.col===e),u.BE(n,e,i,r,l,b,g,t,s,!0);else if(o){if(w=on(g,n,e,t),(M=!c&&u.OE(t,n,e,i,r))&&(u.BE(n,e,i,r,l,b,g,t,s),!b)&&!a)for(C=1,S=0,T=n;S<i;S++,T++){for(A=e+C;C<r;C++,A++)if(I=on(g,T,A,t),!rt(I)&&u.isCellHasItsOwnValue(T,A,s)){if(M=!1,!p)break;nn(m,T,A,I,!0)}if(!p&&!M)break;C=0}if(M)for(x=t.getCalcSourceModel(),N=t.getCalcService(),S=0,T=n;S<i;S++,T++)for(k=o[S],C=0,A=e;C<r;C++,A++)I=on(g,T,A,t),D=k&&k[C],rt(_=D)?_=0:B&&(R.Convert.Nh(D)||R.Convert.LE(D))&&(_=1===D.getRowCount()&&1===D.getColumnCount()?R.Convert.Nh(D)?D.getValue(0,0):D.getValue(0,0,0):R.Errors.Calc),!x.FE||N.PE||T===n&&A===e||(E=x&&x.usedRange)&&(O=j=void 0,O=b?(j=rt(D)?void 0:_,I):(j=I,_),L(E,T,A,j,O)),rn(m,T,A,_,I,f.row===T&&f.col===A),(S||C)&&(F(l,T,A).jE=s);else rn(m,n,e,B&&R.Errors.Spill,w,f.row===n&&f.col===e);f.isValid=M,h&&M!==h.isValid&&u.modelManager.GE(n,e,!M)}return[f,m,[h]]},u.prototype.BE=function(t,n,e,i,r,o,a,u,s,c){for(var f,l,h,d,v,f=1,l=0;l<e;l++){for(h=t+l;f<i;f++)d=n+f,(v=!c&&F(r,h,d))||(v={anchorRefs:{}},o&&!c||(v.value=on(a,h,d,u)),nn(r,h,d,v)),v.anchorRefs[s]=!0;f=0}},u.prototype.updateItem=function(t,n,e,i,r,o){var a,u,s,c,f,t,l,h,d;if(void 0===r&&(r={}),void 0===o&&(o=[]),a=an(n,e),(c=F(s=(u=this).anchors,n,e))&&(u.removeRef(t,c,a,r,it,!0),fn(r,n,e),fn(s,n,e,!0)),(t=F(f=u.cells,n,e))&&t.value!==i)for(h in u.modelManager.UE(n,e,t.value),t.value=i,delete t.jE,l=t.anchorRefs)l[h]&&un(o,d=cn(s,h));if(c||t)return[c&&r,o]},u.prototype.HE=function(t,n){nn(this.invalidAnchors,t,n,!0)},u.prototype.zE=function(){this.invalidAnchors={}},u.prototype.VE=function(n,t,e){var i,r,o,a,u,s,c,f,l,h,i=this,r=i.anchors,o=[];for(a in r)if(r.hasOwnProperty(a))for(f in s=t<=(u=+a),c=r[a])c.hasOwnProperty(f)&&(s=s||(h=c[f])&&h.rowCount+u>=t)&&o.push([u,l=+f]);o.length&&o.forEach(function(t){i.updateItem(n,t[0],t[1],it)})},u.prototype.rE=function(t,n,e){this.VE(t,n,e)},u.prototype.aE=function(t,n,e){this.VE(t,n,e)},u.prototype.YE=function(n,t){var e,i,r,o,a,u,s,c,f,l,e=this,i=e.anchors,r=[];for(o in i)if(i.hasOwnProperty(o))for(s in a=+o,u=i[o])u.hasOwnProperty(s)&&(f=(f=t<=(c=+s))||(l=u[s])&&l.colCount+c>=t)&&r.push([a,c]);r.length&&r.forEach(function(t){e.updateItem(n,t[0],t[1],it)})},u.prototype.oE=function(t,n,e){this.YE(t,n)},u.prototype.uE=function(t,n,e){this.YE(t,n)},St=u,t.Z8=St,t.clearSpillValuesOnAddRemove=ln,A.prototype.getUsedRange=function(t){var n=this,e={};return v(e,n.ZE(t)),v(e,n.sheetModels[3].hE(t)),v(e,n.WE(t)),v(e,n.QE(t)),e},A.prototype.ZE=function(t){var n,e,t,i,r,o,a;if(t&tt.UsedRangeType.span&&(t=(e=(n=this).spanModels[tt.SheetArea.viewport]).spans,!rt(t))&&0<t.length){for(i={},r=0,o=t;r<o.length;r++)a=o[r],v(i,ct(a));return i}},A.prototype.WE=function(t){var n,e,t,i,r,n,t,o,a,u,s,c,f,l,h,n=!(t&tt.UsedRangeType.axis);if(t&tt.UsedRangeType.data||!n){if(e=n?function(t){return!rt(t)&&!rt(t.name)}:function(t){return!rt(t)},i=(t=this).colInfos[3].infos,n=(r=t.Mf).getRowCount(),t={},0<(a=(o=Object.keys(i)).length)){for(c=0,f=o;c<f.length;c++)if(e(i[l=f[c]])){u=+l;break}for(h=a-1;0<=h;h--)if(e(i[o[h]])){s=+o[h];break}rt(u)||rt(s)||v(t,{minRow:0,minCol:u,maxRow:n=0<n?n-1:n,maxCol:s})}return t}},A.prototype.QE=function(t){var t,n,e,t,i,r,o,a,u,s,c,f,l;if(t&tt.UsedRangeType.axis){if(n=(t=this).rowInfos[3].infos,t=(e=t.Mf).getColumnCount(),i={},0<(u=(a=Object.keys(n)).length)){for(s=0,c=a;s<c.length;s++)if(f=c[s],!rt(n[f])){r=+f;break}for(l=u-1;0<=l;l--)if(!rt(n[a[l]])){o=+a[l];break}rt(r)||rt(o)||v(i,{minRow:r,minCol:0,maxRow:o,maxCol:t=0<t?t-1:t})}return i}},A.prototype.KE=function(t,n,e,i,r){var r;3!==e||t<0||n<0||!this.Mf||this.Mf.hasFormula===it||pn(r=this.W_(3).J_(t,n,!!r),i,this.Mf.hasFormula(t,n,e),r&&r.style,this.F8,this.Mf.parent)},A.prototype.JE=function(t,n,e){var e;3!==e||t<0||n<0||(e=this.W_(3).J_(t,n))&&mn(e)},A.prototype.V8=function(t,n){var e=this;e.L8({type:tt.AxisInfoChangeType.setRowCount,count:t}),e.L8({type:tt.AxisInfoChangeType.setColumnCount,count:n})},A.prototype.L8=function(t){var n,e,i,r,r,o,a,u,s,c,f,l,h,d,n=this,e=n.Mf,i=t.type,r=t.sheetArea,r=void 0===r?tt.SheetArea.viewport:r;if(r===tt.SheetArea.viewport)if(rt(n.XE)&&(n.XE=[]),rt(n.qE)&&(n.qE=[]),n.$E)n.tj(t);else switch(o=n.XE,a=n.qE,i){case tt.AxisInfoChangeType.deleteRows:u=t.index,s=t.count,o.splice(u,s);break;case tt.AxisInfoChangeType.deleteColumns:u=t.index,s=t.count,a.splice(u,s);break;case tt.AxisInfoChangeType.setRowHeight:case tt.AxisInfoChangeType.setRowVisible:u=t.index,c=t.value,o[u]=c;break;case tt.AxisInfoChangeType.setColumnWidth:case tt.AxisInfoChangeType.setColumnVisible:u=t.index,c=t.value,a[u]=c;break;case tt.AxisInfoChangeType.filterRows:for(l=0,h=f=t.index;l<h.length;l++)u=h[l],c=e.getRowHeight(u),o[u]=c;break;case tt.AxisInfoChangeType.outlineExpandRows:for(f=t.index,d=0;d<f.length;d++)u=f[d],c=e.getRowHeight(u),o[u]=c;break;case tt.AxisInfoChangeType.outlineExpandColumns:for(f=t.index,d=0;d<f.length;d++)u=f[d],c=e.getColumnWidth(u),a[u]=c}},A.prototype.nj=function(t){var t;if(this.XE)return t=this.XE[t],rt(t)?this.defaults.rowHeight:t},A.prototype.ej=function(t){var t;if(this.qE)return t=this.qE[t],rt(t)?this.defaults.colWidth:t},A.prototype.v8=function(){this.$E=[]},A.prototype.A8=function(){var t,n,e,i,r,t=this,n=t.$E;if(t.$E=et,n)for(e=0,i=n;e<i.length;e++)r=i[e],t.L8(r)},A.prototype.tj=function(t){this.$E&&this.$E.push(t)},A.prototype.m8=function(){var t=this;t.XE=et,t.qE=et},A.prototype.ij=function(){this.F8=et},A.prototype.L0=function(t){var n;!1!==t&&((n=this).Mf=et,n.sheetModels=et,n.t8&&(n.t8.L0(),n.t8=et),n.m8(),n.ij()),A.et(this,"dispose",{clearCache:t})},A.prototype.addRows=function(t,n,e,i,r){var o,a;void 0===r&&(r=tt.SheetArea.viewport),0<(o=this).P8&&o.G8.push(a={row:t,rowCount:n,type:"addRows",sheetArea:r}),1===r?(o.W_(1).rE(t,n,i),o.K_(1).rE(t,n),o.Q_(!0,1).kE(t,n)):(o.W_(3).rE(t,n,i),o.W_(2).rE(t,n,i),o.K_(3).rE(t,n),o.K_(2).rE(t,n),o.Q_(!0,3).kE(t,n),B&&o.t8.rE(o.Mf.Uw(),t,n)),e||A.et(o,"addRows",{row:t,rowCount:n,sheetArea:r,changes:o.G8}),o.L8({type:tt.AxisInfoChangeType.addRows,index:t,count:n,sheetArea:r})},A.prototype.rj=function(t,n){var e,i,r,t,e=this,i=t.row,r=t.rowCount,t=t.sheetArea;ln(e,i,r,n,!0,t),n?e.addRows(i,r,!0,!n,t):e.deleteRows(i,r,!0,t),A.et(e,"undoAddRows",{row:i,rowCount:r,sheetArea:t})},A.prototype.deleteRows=function(t,n,e,i){var r,o,a,u,s,c,f,l,h,d,v,o=(i=void 0===i?tt.SheetArea.viewport:i)===tt.SheetArea.colHeader;if(0<(r=this).P8&&(u=[],s=[],c=o?[]:[["spanModels",3],it],f=o?[]:[["spanModels",2],it],l=[],r.G8.push(a={row:t,rowCount:n,type:"deleteRows",sheetArea:i})),o?(r.W_(1).yE(t,n),r.K_(1).aE(t,n),r.Q_(!0,1).DE(t,n)):(r.W_(3).yE(t,n,u),r.W_(2).yE(t,n,s),r.K_(3).aE(t,n,c),r.K_(2).aE(t,n,f),r.Q_(!0,3).DE(t,n,l),B&&r.t8.aE(r.Mf.Uw(),t,n)),e||A.et(r,"deleteRows",{row:t,rowCount:n,changes:r.G8,sheetArea:i}),a){for(h=a.changes=[],d=["sheetModels",3],v=0;v<u.length;v++)u[v][0]=d.concat(u[v][0]),h.push(u[v]);for(d=["sheetModels",2],v=0;v<s.length;v++)s[v][0]=d.concat(s[v][0]),h.push(s[v]);for(0<c.length&&h.push(c),0<f.length&&h.push(f),d=[p,3],v=0;v<l.length;v++)l[v][0]=d.concat(l[v][0]),h.push(l[v])}r.L8({type:tt.AxisInfoChangeType.deleteRows,index:t,count:n,sheetArea:i})},A.prototype.oj=function(t,n){var e,i,r,o,a,u,n,e=this,i=t.row,r=t.rowCount,o=t.sheetArea;if(ln(e,i,r,!n,!0,o),n)e.deleteRows(i,r,!0,o);else for(e.addRows(i,r,!0,!0,o),u=(a=t.changes).length-1;0<=u;u--)$t(e,a[u]);(n=e.Mf&&e.Mf.aj)&&n.splice(n.length-r,r)},A.prototype.addColumns=function(t,n,e,i){var r,o;void 0===i&&(i=tt.SheetArea.viewport),0<(r=this).P8&&r.G8.push(o={col:t,colCount:n,type:"addColumns",sheetArea:i}),2===i?(r.W_(2).oE(t,n),r.K_(2).oE(t,n),r.Q_(!1,2).kE(t,n)):(r.W_(3).oE(t,n),r.W_(1).oE(t,n),r.K_(3).oE(t,n),r.K_(1).oE(t,n),r.Q_(!1,3).kE(t,n),B&&r.t8.oE(r.Mf.Uw(),t,n)),e||A.et(r,"addColumns",{col:t,colCount:n,changes:r.G8,sheetArea:i}),r.L8({type:tt.AxisInfoChangeType.addColumns,index:t,count:n,sheetArea:i})},A.prototype.uj=function(t,n){var e,i,r,t,e=this,i=t.col,r=t.colCount,t=t.sheetArea;ln(e,i,r,n,!1,t),n?e.addColumns(i,r,!0,t):e.deleteColumns(i,r,!0,t)},A.prototype.deleteColumns=function(t,n,e,i){var r,o,a,u,s,c,f,l,h,d,v,o=(i=void 0===i?tt.SheetArea.viewport:i)===tt.SheetArea.rowHeader;if(0<(r=this).P8&&(u=[],s=[],c=o?[]:[["spanModels",3],it],f=o?[]:[["spanModels",1],it],l=[],r.G8.push(a={col:t,colCount:n,type:"deleteColumns",sheetArea:i})),o?(r.W_(2).wE(t,n),r.K_(2).uE(t,n),r.Q_(!1,2).DE(t,n)):(r.W_(3).wE(t,n,u),r.W_(1).wE(t,n,s),r.K_(3).uE(t,n,c),r.K_(1).uE(t,n,f),r.Q_(!1,3).DE(t,n,l),B&&r.t8.uE(r.Mf.Uw(),t,n)),e||A.et(r,"deleteColumns",{col:t,colCount:n,changes:r.G8,sheetArea:i}),a){for(h=a.changes=[],d=["sheetModels",3],v=0;v<u.length;v++)u[v][0]=d.concat(u[v][0]),h.push(u[v]);for(d=["sheetModels",1],v=0;v<s.length;v++)s[v][0]=d.concat(s[v][0]),h.push(s[v]);for(0<c.length&&h.push(c),0<f.length&&h.push(f),d=[b,3],v=0;v<l.length;v++)l[v][0]=d.concat(l[v][0]),h.push(l[v])}r.L8({type:tt.AxisInfoChangeType.deleteColumns,index:t,count:n,sheetArea:i})},A.prototype.sj=function(t,n){var e,i,r,o,a,u,e=this,i=t.col,r=t.colCount,o=t.sheetArea;if(ln(e,i,r,!n,!1,o),n)e.deleteColumns(i,r,!0,o);else for(e.addColumns(i,r,!0,o),u=(a=t.changes).length-1;0<=u;u--)$t(e,a[u])},A.prototype.getRowCount=function(t){return this.W_(t).getRowCount()},A.prototype.setRowCount=function(t,n,e){var i,r,i=this,r=i.getRowCount(n);0<i.P8&&i.G8.push({oldRowCount:r,sheetArea:n,type:"setRowCount"}),3===n||2===n?(t<r&&i.deleteRows(t,r-t,e),i.W_(3).setRowCount(t),i.W_(2).setRowCount(t),i.Mf.ki($.Events.WorksheetDataChanged,{type:"count"})):1===n&&(t<r&&i.Q_(!0,n).DE(t,r-t),i.W_(n).setRowCount(t)),i.L8({type:tt.AxisInfoChangeType.setRowCount,count:t,sheetArea:n})},A.prototype.cj=function(t){var n=this;n.W_(3).setRowCount(t),n.W_(2).setRowCount(t),n.L8({type:tt.AxisInfoChangeType.setRowCount,count:t,sheetArea:3})},A.prototype.fj=function(t,n){n?this.setRowCount(t.rowCount,t.sheetArea,!0):this.setRowCount(t.oldRowCount,t.sheetArea,!0)},A.prototype.getColumnCount=function(t){return this.W_(t).getColumnCount()},A.prototype.setColumnCount=function(t,n,e){var i,r,i=this,r=i.getColumnCount(n);0<i.P8&&i.G8.push({oldColCount:r,sheetArea:n,type:"setColumnCount"}),3===n||1===n?(t<r&&i.deleteColumns(t,r-t,e),i.W_(3).setColumnCount(t),i.W_(1).setColumnCount(t),i.Mf.ki($.Events.WorksheetDataChanged,{type:"count"})):2===n&&(t<r&&i.Q_(!1,n).DE(t,r-t),i.W_(n).setColumnCount(t)),i.L8({type:tt.AxisInfoChangeType.setColumnCount,count:t,sheetArea:n})},A.prototype.lj=function(t,n){n?this.setColumnCount(t.colCount,t.sheetArea,!0):this.setColumnCount(t.oldColCount,t.sheetArea,!0)},A.prototype.getLastNonNullRow=function(t,n){var n=n?0:this.Q_(!0,t)._E()-1;return g(this.W_(t).I8,this.K_(t).I8,n)},A.prototype.getLastNonNullCol=function(t,n){var n=n?0:this.Q_(!1,t)._E()-1;return g(this.W_(t).x8,this.K_(t).x8,n)},A.prototype.getFreeAreaRowCount=function(t){var t=this.W_(t);return t&&t.getFreeAreaRowCount()},A.prototype.getFreeAreaColumnCount=function(t){var t=this.W_(t);return t&&t.getFreeAreaColumnCount()},A.prototype.setFreeAreaRowCount=function(t,n){this.W_(n).setFreeAreaRowCount(t)},A.prototype.setFreeAreaColumnCount=function(t,n){this.W_(n).setFreeAreaColumnCount(t)},A.prototype.hj=function(){var t,u,n,t;function e(t,n){for(var e,i,r,o,a,e=n.length,i=0;i<e;i++)r=n[i][0],o=n[i][1],(a=n[i][2])!==o&&(t?u.dj(r,3,"height",o,a):u.vj(r,3,"width",o,a))}n=0!==(u=(t=this).Mf).ot().height&&t.mj(!0,u.defaults.rowHeight),t=0!==u.ot().width&&t.mj(!1,u.defaults.colWidth),n&&e(!0,n),t&&e(!1,t)},A.prototype.mj=function(t,n){var e,i,r,o,a,u,s,c,f,l,h,d,v,m,g,p,b,y,w,M,C,S,f,T,A,A,e=this,i=e.Mf,r=[],o=i.zoom(),a=t?i.getRowCount():i.getColumnCount(),u=e.Q_(t,3),s=0,f=0;if(i.gj&&(f=t?i.gj().height:i.gj().width),t){if(i.options.colHeaderVisible)for(l=0;l<i.getRowCount(1);l++)s+=I(o*i.getRowHeight(l,1));c=i.ot().height-i.options.sheetAreaOffset.top-f-s}else{if(i.options.rowHeaderVisible)for(l=0;l<i.getColumnCount(2);l++)s+=I(o*i.getColumnWidth(l,2));c=i.ot().width-i.options.sheetAreaOffset.left-f-s}for(h=[],d=[],v=[],g=t?i.getRowVisible:i.getColumnVisible,l=m=0;l<a;l++)if(p=g.call(i,l),b=i.Ut.getSize(t,3,l),y=i.Ut.getStarSize(t,3,l),G.test(y))w="*"===y?1:parseFloat(y.replace("*","")),p&&0<w?(m+=w,h.push(l),d.push(w),v.push(b)):r.push([l,0,b]);else if(b=_t(b)?Math.floor(b):n,p&&(c-=I(o*b))<1)return;if(!(m+r.length===0||c<1)){for(M=h.length,l=0;l<M-1;l++)if(b=H((C=c/m/o)*(w=d[l])),S=I(o*b),r.push([h[l],b,v[l]]),c-=S,m-=w,S<1||c<1)return;for(f=I((c-1e-4)/o),r.push([h[M-1],f,v[M-1]]),l=0;l<r.length;l++)T=r[l][0],A=r[l][1],u.setSize(T,A),A=t?tt.AxisInfoChangeType.setRowHeight:tt.AxisInfoChangeType.setColumnWidth,e.L8({type:A,index:T});return r}},A.prototype.setCellState=function(t,n,e,i,r){var r=this.W_(r);r&&r.setCellState(t,n,e,i)},A.prototype.toJSON=function(t){var n,e,i,r,i,t,o,n=this,e={},i=n.Mf;return e.data=n.W_(3).toJSON(3,t,n.Mf),e.rowHeaderData=n.W_(2).toJSON(2,t),e.colHeaderData=n.W_(1).toJSON(1,t),e.rows=n.Q_(!0,3).toJSON(t),e.columns=n.Q_(!1,3).toJSON(t),e.rowHeaderColInfos=n.Q_(!1,2).toJSON(t),e.colHeaderRowInfos=n.Q_(!0,1).toJSON(t),i.filterRowsVisibleInfo&&!i.filterRowsVisibleInfo.empty&&n.updateToJsonRowInfo(i.filterRowsVisibleInfo.rowsVisibleInfo,e,i),e.leftCellIndex=i.getViewportLeftColumn(1),e.topCellIndex=i.getViewportTopRow(1),(r=t&&t.ignoreStyle)||(e.spans=hn(n.K_(3).toJSON()),e.rowHeaderSpan=hn(n.K_(2).toJSON()),e.colHeaderSpan=hn(n.K_(1).toJSON())),e.selections=n.selectionModel.toJSON(),(o=20===(t={colHeaderRowHeight:(i=n.defaults).colHeaderRowHeight,colWidth:i.colWidth,rowHeaderColWidth:i.rowHeaderColWidth,rowHeight:i.rowHeight,_isExcelDefaultColumnWidth:i._isExcelDefaultColumnWidth}).rowHeight&&62===t.colWidth&&40===t.rowHeaderColWidth&&20===t.colHeaderRowHeight)||(e.defaults=t),e},A.prototype.updateToJsonRowInfo=function(t,n,e){var i,r,o,a;for(rt(n.rows)&&(n.rows=[]),i=n.rows,r=e.getRowCount(),o=0;o<r;o++)(a=!1===t[o])&&(rt(i[o])?i[o]={}:i[o]=M({},i[o]),i[o].visible=!1,i[o].isFilter=!0)},A.prototype.fromJSON=function(t,n,e,i,r){var o,a,u,s,c,f,l,h,d,v,i,r,o=this,a=o.F8;if(o.W_(3).fromJSON(t.data,n,e,a,i,3,r),o.W_(2).fromJSON(t.rowHeaderData,n,e,a),o.W_(1).fromJSON(t.colHeaderData,n,e,a),o.Mf.showCell(t.topCellIndex||0,t.leftCellIndex||0,tt.VerticalPosition.top,tt.HorizontalPosition.left),o.Q_(!0,3).fromJSON(t.rows),o.Q_(!1,3).fromJSON(t.columns),o.Q_(!1,2).fromJSON(t.rowHeaderColInfos),o.Q_(!0,1).fromJSON(t.colHeaderRowInfos),t&&t.rows)for(s=0,c=u=Object.keys(t.rows);s<c.length;s++)f=c[s],l=t.rows[f],rt(l)||o.L8({type:tt.AxisInfoChangeType.setRowHeight,index:+f});if(t&&t.columns)for(h=0,d=u=Object.keys(t.columns);h<d.length;h++)f=d[h],l=t.columns[f],rt(l)||o.L8({type:tt.AxisInfoChangeType.setColumnWidth,index:+f});(v=e&&e.ignoreStyle)||(o.K_(3).fromJSON(t.spans,o.getRowCount(),o.getColumnCount()),o.K_(2).fromJSON(t.rowHeaderSpan),o.K_(1).fromJSON(t.colHeaderSpan)),o.selectionModel.fromJSON(t.selections,t.rowCount,t.columnCount),o.Oue(t.tag),(i=t.defaults)!==it&&((r=o.defaults).colHeaderRowHeight=m(i.colHeaderRowHeight,20),r.colWidth=m(i.colWidth,62),r.rowHeaderColWidth=m(i.rowHeaderColWidth,40),r.rowHeight=m(i.rowHeight,20),r._isExcelDefaultColumnWidth=i._isExcelDefaultColumnWidth)},A.prototype.Oue=function(t){var n,e,e,e;t!==it&&(n=this,typeof(e=t.typeName)===U&&(e=D.getTypeFromString(e))&&((e=new e).fromJSON&&e.fromJSON(t),t=e),n.do("setValueForKey",-1,-1,"tag",t,3))},A.prototype.wh=function(t,n,e){var i,r,o,t,r,n,t,a,u,s,t,c,f,l,e,e,h,o,i,d,i=this,r=i.defaults.rowHeight,o=i.Q_(!0,3).wh(e),t=i.W_(3).wh(i.Mf,o,t,r,n,e),r=t.sheetData,n=t.hyperlinks,t={};return e&&(t.saveAsView=e.saveAsView,t.ignoreStyle=!1===e.includeStyles),a=i.W_(2).toJSON(2,t),u=i.W_(1).toJSON(1,t),s=i.Q_(!1,2).toJSON(t),t=i.Q_(!0,1).toJSON(t),c=i.getValueForKey(-1,-1,"tag",3),e&&!1===e.includeStyles||(f=hn(i.K_(2).toJSON()),l=hn(i.K_(1).toJSON())),e={colHeaderRowHeight:(e=i.defaults).colHeaderRowHeight,rowHeaderColWidth:e.rowHeaderColWidth},h=[],o.forEach(function(t,n){t&&t.starSize&&(h[n]={starSize:t.starSize})}),o=i.selectionModel.selectionPolicy,i=i.selectionModel.selectionUnit,{sheetData:r,hyperlinks:n,rowHeaderData:a,colHeaderData:u,rowHeaderColInfos:s,colHeaderRowInfos:t,rowHeaderSpan:f,colHeaderSpan:l,rowInfos:h,tag:c,defaults:(d=40===e.rowHeaderColWidth&&20===e.colHeaderRowHeight)?void 0:e,selectionPolicy:o,selectionUnit:i}},A.prototype.yh=function(t,n,e,i,r,o,a){var u,t,s,c,n,r,o,a,u=this;u.Q_(!0,3).yh(t,e),u.W_(3).yh(u.Mf,t,n,e,it,r,o,u.F8,a),i&&(t={},e&&(t.ignoreStyle=!1===e.includeStyles,P.Util.Mo(e))&&(t.incrementalLoading=!0),u.W_(2).fromJSON(i.rowHeaderData,it,t),u.W_(1).fromJSON(i.colHeaderData,it,t),u.Q_(!1,2).fromJSON(i.rowHeaderColInfos),u.Q_(!0,1).fromJSON(i.colHeaderRowInfos),e&&!1===e.includeStyles||(u.K_(2).fromJSON(i.rowHeaderSpan),u.K_(1).fromJSON(i.colHeaderSpan)),s=u.Q_(!0,3),(c=i.rowInfos||[]).forEach(function(t,n){rt(t&&t.starSize)||s.setStarSize(n,t.starSize)}),(n=i.defaults)!==it&&((r=u.defaults).colHeaderRowHeight=m(n.colHeaderRowHeight,20),r.rowHeaderColWidth=m(n.rowHeaderColWidth,40)),(o=i.selectionPolicy)!==it&&(u.selectionModel.selectionPolicy=+o),(a=i.selectionUnit)!==it&&(u.selectionModel.selectionUnit=+a),u.Oue(i.tag))},A.prototype.startTransaction=function(){var t,n;0===this.P8&&(this.G8=[],this.Mf.isEventSuspended()||(this.G8.events=[]),A.et(this,"startTransaction")),this.P8++},A.prototype.endTransaction=function(){var t,n;return this.P8--,0===this.P8?(A.et(this,"endTransaction"),t=this.G8,this.G8=it,(n=t.events)&&0===n.length&&delete t.events,t):[]},A.prototype.pj=function(){var t=this.G8;if(t)return t.calc||(t.calc=[]),t.calc},A.prototype.GE=function(t,n,e){var i=this.G8;i&&i.push({type:"setIsValid",value:[t,n,e]})},A.prototype.UE=function(t,n,e){var i=this.G8;i&&i.push({type:"dirtyItem",value:[t,n,e]})},A.prototype.bj=function(t,n){var t,e,i,t,t=t.value;t&&(i=(e=this.t8).getAnchorCell(t[0],t[1]))&&(t=t[2],i.isValid=t=n?!t:t)},A.prototype.yj=function(t,n){var t,e,i,n,r,t,t=t.value;t&&(e=t[0],i=t[1],n=n?t[3]:t[2],t=(r=this.t8).getAnchorItem(e,i))&&(t.value=n)},A.prototype.applyChange=function(t,n,e){var i,r,o,a,u,o,s,i=this,r=t.type;!r&&0<t.length?($t(i,t,n),o=t[0][1],a=t[0][3],u=t[0][4],0<o&&0<=a&&0<=u&&(s=(o=i.W_(o)).J_(a,u))&&qt(s,s,!1,a,u,{},o.a8)):"addRows"===r?i.rj(t,n):"addColumns"===r?i.uj(t,n):"deleteRows"===r?i.oj(t,n):"deleteColumns"===r?i.sj(t,n):"setRowCount"===r?i.fj(t,n):"setColumnCount"===r?i.lj(t,n):"setZoomFactor"===r?i.wj(n?t.newValue:t.value):"updateDirty"===r?e.push(t):"setName"===r?n?i.Mj(t.newValue):i.Mj(t.value):"sortRange"===r?i.Cj(t,n):"setIsValid"===r?i.bj(t,n):"dirtyItem"===r?i.yj(t,n):"sheetProperty"===r&&i.Mf[t.pname](n?t.value:t.oldValue)},A.prototype.applyChanges=function(t,n,s){var e,i,r,o,a;function c(t,n,e,i,r){r?t.setArrayFormula(n,e,r.rowCount,r.colCount,i):t.setFormula(n,e,i)}function u(t,n){var e,i,r,o,a,u;if(n)for(e in n)if(!isNaN(e))for(o in i=parseInt(e,10),r=n[e])isNaN(o)||(a=parseInt(o,10),s?c(t,i,a,u=r[o].formula!==r[o].oldFormula?r[o].formula:null,u?r[o].arrayInfo:null):c(t,i,a,r[o].oldFormula,r[o].oldArrayInfo))}if(e=this,i=[],n)if(s)for(r=0;r<n.length;r++)o=n[r],e.applyChange(o,s,i);else for(r=n.length-1;0<=r;r--)o=n[r],e.applyChange(o,s,i);(a=e.Mf).Sj={},a.r3(),u(a,n&&n.formulas),A.et(e,"applyChanges",{command:t,changes:n,isUndo:!s}),0<i.length&&a.Tj()},A.prototype.undo=function(t){var n,e,i,r,o,a,u,s,c,c,n=[],e=t&&t.events;if(e&&this.Aj(e,!0),t)for(i=t.length-1;0<=i;i--)(o=(r=t[i]).type)?"addRows"===o?this.rj(r):"addColumns"===o?this.uj(r):"deleteRows"===o?this.oj(r):"deleteColumns"===o?this.sj(r):"setRowCount"===o?this.fj(r):"setColumnCount"===o?this.lj(r):"setZoomFactor"===o?this.wj(r.value):"updateDirty"===o?(this.pE(r),n.push(r)):"setName"===o?this.Mj(r.value):"sortRange"===o?this.Cj(r):"setIsValid"===o?this.bj(r):"dirtyItem"===o&&this.yj(r):r.skipUndo||$t(this,r);(a=this.Mf).Sj={},a.r3(),(u=0<n.length)&&((s=a.Lp)&&s.suspend(),n.forEach(function(t){a.Ij(t.row,t.col,3,!1)})),(c=t&&t.tableChanges)&&0<c.length&&(A.et(this,V,{tableChanges:c}),t.tableChanges.isRestored=!0),(c=t&&t.calc)&&c.length&&a.xj(c),A.et(this,"undoValue",t),u&&(s&&s.resume(!1),a.Tj()),delete this.W_(3).B8.vE,t&&A.et(this,V,t),e&&this.Aj(e,!1)},A.prototype.do=function(t){for(var n,e,i,t,n=[],e=1;e<arguments.length;e++)n[e-1]=arguments[e];i=this,t&&(t=i[t])&&t.apply(i,n)},A.prototype.W_=function(t){return rt(t)&&(t=3),this.sheetModels[t]},A.prototype.l8=function(t,n,e){var i=0,r=0;rt(e)&&(e=3,i=t,r=n),this.sheetModels[e]=new pt(t,n,i,r)},A.prototype.ZI=function(t){var n,e=this.G8,e=e&&e.events;e&&e.push(t)},A.prototype.Aj=function(t,n){var e,i,r,o,a,e=this.Mf;for(e.Nj=!0,i=t.length-1;0<=i;i--)a=void 0,"cellChanged"!==(o=(r=t[i])[0])||n?"rowChanged"!==o||n?"columnChanged"!==o||n?"zoomChanged"!==o||n?"rowChanging"===o&&n?a=e.kj:"columnChanging"===o&&n?a=e.Dj:"tableRowsChanged"!==o||n?"tableColumnsChanged"!==o||n?"rangeChanged"!==o||n||(a=e._j):a=e.Ej:a=e.jj:a=e.Oj:a=e.vj:a=e.dj:a=e.Rj,a&&([].splice.call(t,i,1),a.apply(e,[].slice.call(r,1)));e.Nj=!1},A.prototype.getValue=function(t,n,e,i,r){if(rt(e)&&(e=3),!i){var o={row:t,col:n,sheetArea:e,isValueGet:!1,value:it};if(A.et(this,"getValue",o,function(){return o.isValueGet}),o.isValueGet)return o.value}return this.W_(e).getValue(t,n,r)},A.prototype.setValue=function(t,n,e,i,r,o,a,u,s){var c,f,l,o,h,s,d,r,s,a,u,r,s;rt(i)&&(i=3),l=(f=this).Mf,(o=!o&&!l.isEventSuspended())&&(c=l.getValue(t,n,i,1)),h=!1,B&&l.getCalcService().allowDynamicArray&&!f.Bj&&3===i&&(f.H8.push(f.t8.updateItem(l.Uw(),t,n,e)),h=!0),s||f.KE(t,n,i,e,!0),s=!1,r||(d={row:t,col:n,value:e,sheetArea:i,isValueSet:!1,changes:f.G8},A.et(f,"setValue",d,function(){return d.isValueSet}),s=d.isValueSet),s||(s=r=void 0,0<f.P8&&(!a||l.parent&&l.parent.options.saveChangesForSheet)&&(r=[["sheetModels",i],it],s={sheetArea:i}),f.W_(i).setValue(t,n,e,r,s,u),u&&r&&sn(this.pj(),t,n)&&(r.skipUndo=!0),r&&0<r.length&&f.G8.push(r),s&&s.type&&f.G8.push(s),l.Tj()),o?(a=c!==e,u=!1,r=void 0,(a=typeof e===U&&((r=$.util.V0(e))instanceof Date&&(u=!0),c instanceof Date)?c.valueOf()!==r.valueOf():a)&&l.Rj("value",t,n,i,c,u&&r?r:e),l.ki($.Events.WorksheetDataChanged,{type:"value"})):l.Lj(l,[{row:t,col:n}],0),h&&f.applyDynamicChanges(),(s=l.getCellType(t,n,i))&&s.Xe(l,t,n,e,i)},A.prototype.applyDynamicChanges=function(){var t,n,e,i,r,o,a,u,t=this,n=t.H8,e=t.Mf;if(!t.Bj&&n.length){for(t.Bj=!0,i=e.Uw(),r=e.b3(),o=0,a=n;o<a.length;o++)(u=a[o])&&((0,R.setSpillValues)(u[0],i),(0,R.markAnchorCellDirty)(u[1],r,t.t8));n.length=0,t.Bj=!1}},A.prototype.getDynamicArrayInfo=function(t,n){return this.t8.getAnchorInfo(t,n)},A.prototype.getStyle=function(t,n,e){return this.W_(e).getStyle(t,n,0<this.P8)},A.prototype.setStyle=function(t,n,e,i){var r,o,r;rt(i)&&(i=3),e&&e.cellType&&e.cellType.qe(this.Mf,t,n,e,i),r=0<this.P8?[["sheetModels",i],it]:it,o=this.W_(i).getStyle(t,n,!1),this.W_(i).setStyle(t,n,e,r),this.Mf.ki($.Events.WorksheetDataChanged,{type:"style"}),r&&0<r.length&&this.G8.push(r),r=this.Mf.parent,i===tt.SheetArea.viewport&&bn(o,e,r)&&this.KE(t,n,i,this.getValue(t,n,i,!0),!1)},A.prototype.getValueForKey=function(t,n,e,i){return this.W_(i).getValueForKey(t,n,e)},A.prototype.setValueForKey=function(t,n,e,i,r){rt(r)&&(r=3);var o=0<this.P8?[["sheetModels",r],it]:it;this.W_(r).setValueForKey(t,n,e,i,o),o&&0<o.length&&this.G8.push(o)},A.prototype.clear=function(t,n,e,i,r,o,a){var u,s,c,f,l,h,d,v,m,g,p,b,y,w,M,C,S,T;if(rt(a)&&(a=3),u=0<this.P8?[]:it,c=!1,f=(s=this).Mf,B&&!s.Bj&&3===a){for(l=f.Uw(),h=s.H8,d=s.t8,v={},m=[],g=0;g<e;g++)for(p=0;p<i;p++)d.updateItem(l,t+g,n+p,et,v,m);h.push([v,m]),c=!0}if(this.W_(a).clear(t,n,e,i,r,o,u),this.Mf.ki($.Events.WorksheetDataChanged,{type:tt.StorageType[r]}),A.et(this,"clear",{row:t,col:n,rowCount:e,colCount:i,type:r,ignoredRowList:o,sheetArea:a,changes:this.G8}),u)for(b=["sheetModels",a],y=0,w=u.length;y<w;y++)(M=u[y])[0]=b.concat(M[0]),this.G8.push(M);for(c&&this.applyDynamicChanges(),g=0;g<e;g++)for(p=0;p<i;p++)this.KE(C=t+g,S=n+p,a,et,!1),(T=f.getCellType(C,S,a))&&T.Xe(f,C,S,et,a)},A.prototype.swapNode=function(t,n,e,i,r){var o,a,u,s,c;if(rt(r)&&(r=3),o=0<this.P8?[]:it,this.W_(r).SE(t,n,e,i,o),o)for(a=["sheetModels",r],u=0,s=o.length;u<s;u++)(c=o[u])[0]=a.concat(c[0]),this.G8.push(c)},A.prototype.dE=function(t,n,e,i){var r;0<this.P8&&(r={sheetArea:i},rt(i))&&(r.sheetArea=3),this.W_(i).dE(t,n,e,r),r&&this.G8.push(r)},A.prototype.pE=function(t){this.W_(t.sheetArea).pE(t)},A.prototype.Fj=function(t){return this.W_(t).B8},A.prototype.Pj=function(t,n,e){var i,e,r,i,e=this.Fj(e)[t];return!(!e||!(r=e[n]))},A.prototype.Gj=function(t,n,e){for(var i,r,o,i=this.W_(e).B8,r=0;r<n;r++)(o=t+r)in i&&delete i[o]},A.prototype.Uj=function(t,n){var e,i,r,o,e,i=this.Mf.aj;if(i)for(r=i.length-1;0<=r;r--)t<=(o=i[r].row)&&o<t+n&&i.splice(r)},A.prototype.Hj=function(t){this.W_(t).B8={}},A.prototype.zj=function(t,n,e,i){var r=this.Fj(),o,a,u;if(r)for(o in r)N(r,o)&&(a=r[o],u=parseInt(o,10),a)&&"n"===a.rs&&(t||n&&e<=u&&u<e+i)&&(r[o]={})},A.prototype.Vj=function(o,t,a,n,u){var e,s,c,f,i,r,l,e,h,d,v,e=this,s=e.Fj(),c=e.Mf,f=c.tables;if(!nt(s)){if(i=[],0<=t)for(r=t;r<t+n;r++)i.push(r);else for(l in s)N(s,l)&&i.push(parseInt(l,10));e=[],h=[],f&&(e=f.Yj(t,a,n,u),h=f.Zj(t,a,n,u),0<e.length)&&A.et(this,"clearPendingChanges",{tableList:e}),j(i,function(t,n){var e,i,r;if((d=s[n])&&"e"===d.rs)if(e=h.length,o)if(f&&0!==e&&f.Wj(h,n,-1))for(i=c.getColumnCount(),r=0;r<i;r++)f&&0!==e&&f.Wj(h,n,r)||(v=d[r])&&delete d[r];else s[n]={};else for(r=a;r<a+u;r++)f&&0!==e&&f.Wj(h,n,r)||(v=d[r])&&delete d[r]})}},A.prototype.Qj=function(){var t,n,e,t,n=this.Fj();for(e in n)N(n,e)&&n[e]&&"e"===n[e].rs&&(n[e]={})},A.prototype.Kj=function(t){this.W_(t).lE++},A.prototype.Jj=function(t){var t,n,t=this.W_(t);t.lE--,(n=t.lE)<0&&(t.lE=0)},A.prototype.getName=function(){return this.name||""},A.prototype.setName=function(t){var n=this;0<n.P8&&n.G8.push({type:"setName",value:n.name}),n.name=t},A.prototype.Xj=function(){return this.isSelected},A.prototype.qj=function(t){this.isSelected=t},A.prototype.Mj=function(t){this.Mf.name(t)},A.prototype.Cj=function(t,n){var e,i,e=t.byRows?t.row:t.column;n||(i=[],t.array.map(function(t,n){i[t-e]=n+e})),this.Mf.sortRange(t.row,t.column,t.rowCount,t.columnCount,t.byRows,t.sortInfo,et,i)},A.prototype.getZoomFactor=function(){return this.zoomFactor},A.prototype.setZoomFactor=function(t){var n=this;0<n.P8&&n.G8.push({type:"setZoomFactor",value:n.zoomFactor}),n.zoomFactor=t},A.prototype.wj=function(t){this.Mf.zoom(t)},A.prototype.K_=function(t){return rt(t)&&(t=3),this.spanModels[t]},A.prototype.d8=function(t){rt(t)&&(t=3),this.spanModels[t]=new lt},A.prototype.getSpans=function(t,n,e){var n=this.K_(n).getSpans(t);return n=e?n.filter(function(t){return!t.isAutoMerge}):n},A.prototype.getSpan=function(t,n,e){return this.K_(e).get(t,n)},A.prototype.Ci=function(t,n,e){var e,e;return rt(e)&&(e=3),(e=this.W_(e))&&e.J_&&(e=e.J_(t,n))&&e.tipContent?e.tipContent:null},A.prototype.$n=function(t,n,e,i){rt(i)&&(i=3);var r=this.W_(i).J_(t,n);!e&&r?delete r.tipContent:e&&r?r.tipContent=e:e&&!r&&((r=this.W_(i).J_(t,n,!0)).tipContent=e)},A.prototype.eE=function(t,n,e,i,r){return this.K_(r).eE(t,n,e,i)},A.prototype.GT=function(t,n,e,i,r){return this.K_(r).GT(t,n,e,i)},A.prototype.findSpan=function(t,n,e){return this.K_(e).find(t,n)},A.prototype.removeSpan=function(t,n){rt(n)&&(n=3);var e=0<this.P8?[["spanModels",n],it]:it;this.K_(n).remove(t,e),e&&0<e.length&&this.G8.push(e)},A.prototype.addSpan=function(t,n){rt(n)&&(n=3);var e=0<this.P8?[["spanModels",n],it]:it;this.K_(n).add(t,e),this.Mf.ki($.Events.WorksheetDataChanged,{type:"span"}),e&&0<e.length&&this.G8.push(e)},A.prototype.clearSpan=function(t,n,e,i,r){rt(r)&&(r=3);var o=0<this.P8?[["spanModels",r],it]:it;this.K_(r).d5(t,n,e,i,o),this.Mf.ki($.Events.WorksheetDataChanged,{type:"span"}),o&&0<o.length&&this.G8.push(o)},A.prototype.moveSpan=function(t,n,e,i,r,o,a){rt(a)&&(a=3);var u=0<this.P8?[["spanModels",a],it]:it;this.K_(a).iE(t,n,e,i,r,o,u),this.Mf.ki($.Events.WorksheetDataChanged,{type:"span"}),u&&0<u.length&&this.G8.push(u)},A.prototype.copySpan=function(t,n,e,i,r,o,a){rt(a)&&(a=3);var u=0<this.P8?[["spanModels",a],it]:it;this.K_(a).tE(t,n,e,i,r,o,u),this.Mf.ki($.Events.WorksheetDataChanged,{type:"span"}),u&&0<u.length&&this.G8.push(u)},A.prototype._9=function(t,n,e,i){this.colHeaderSelectionModel.$j=new $.Range(t,n,e,i)},A.prototype.J9=function(){return this.colHeaderSelectionModel.$j},A.prototype.addSelection=function(t,n,e,i,r,o){var a,u,s;if(1===o)this.colHeaderSelectionModel.add(t,n,e,i,it);else if(a=0<this.P8?[]:it,this.selectionModel.add(t,n,e,i,a,r),a)for(u=0;u<a.length;u++)(s=a[u])[0]=["selectionModel"].concat(s[0]),this.G8.push(s)},A.prototype.getSelections=function(t){return(1===t?this.colHeaderSelectionModel:this.selectionModel).get()},A.prototype.setSelections=function(t,n){var e,i,r;if(1===n)this.colHeaderSelectionModel.set(t,it);else if(e=0<this.P8?[]:it,this.selectionModel.set(t,e),e)for(i=0;i<e.length;i++)(r=e[i])[0]=["selectionModel"].concat(r[0]),this.G8.push(r)},A.prototype.clearSelection=function(t){var n,e,i;if(1===t)this.colHeaderSelectionModel.clear(it);else if(n=0<this.P8?[]:it,this.selectionModel.clear(n),n)for(e=0;e<n.length;e++)(i=n[e])[0]=["selectionModel"].concat(i[0]),this.G8.push(i)},A.prototype.getActiveSelectedRangeIndex=function(){return this.selectionModel.getProperty("activeSelectedRangeIndex")},A.prototype.setActiveSelectedRangeIndex=function(t){var n=0<this.P8?[["selectionModel"],it]:it;this.selectionModel.setProperty("activeSelectedRangeIndex",t,n),n&&this.G8.push(n)},A.prototype.getSelectionPolicy=function(){return this.selectionModel.getProperty("selectionPolicy")},A.prototype.setSelectionPolicy=function(t){tn(this,"selectionPolicy",t)},A.prototype.getSelectionUnit=function(){return this.selectionModel.getProperty("selectionUnit")},A.prototype.setSelectionUnit=function(t){tn(this,"selectionUnit",t)},A.prototype.T9=function(t){return this.selectionModel.T9(t)},A.prototype.S9=function(t){return this.selectionModel.S9(t)},A.prototype.ni=function(t,n,e,i,r,o){return this.selectionModel.ni(t,n,e,i,r,o)},A.prototype.ei=function(t,n,e,i,r){return this.selectionModel.ei(t,n,e,i,r)},A.prototype.Q_=function(t,n){var e;return rt(n)&&(n=3),(t?this.rowInfos:this.colInfos)[n]},A.prototype.h8=function(t,n){var e;rt(n)&&(n=3),(t?this.rowInfos:this.colInfos)[n]=new c},A.prototype.getPageBreak=function(t,n,e){var i;return this.Q_(t,n).getPageBreak(e)},A.prototype.setPageBreak=function(t,n,e,i){var r,o;rt(n)&&(n=3),r=0<this.P8?[[t?p:b,n],it]:it,(o=this.Q_(t,n)).setPageBreak(e,i,r),r&&this.G8.push(r)},A.prototype.getVisible=function(t,n,e){var i;return this.Q_(t,n).getVisible(e)},A.prototype.setVisible=function(t,n,e,i){var r,o,a,i,r=this;rt(n)&&(n=3),o=0<r.P8?[[t?p:b,n],it]:it,(a=r.Q_(t,n)).setVisible(e,i,o),o&&r.G8.push(o),i=t?tt.AxisInfoChangeType.setRowVisible:tt.AxisInfoChangeType.setColumnVisible,r.L8({type:i,index:e,sheetArea:n})},A.prototype.getResizable=function(t,n,e){var i;return this.Q_(t,n).getResizable(e)},A.prototype.setResizable=function(t,n,e,i){var r,o;rt(n)&&(n=3),r=0<this.P8?[[t?p:b,n],it]:it,(o=this.Q_(t,n)).setResizable(e,i,r),r&&this.G8.push(r)},A.prototype.getSize=function(t,n,e){var i;return this.Q_(t,n).getSize(e)},A.prototype.getColumnHeaderFitMode=function(t,n,e){var i;return this.Q_(t,n).getColumnHeaderFitMode(e)},A.prototype.setColumnHeaderFitMode=function(t,n,e,i){var r,o,a,u,s,c,f,t,l,h,d,v,m,r=this,o=60,s=r.Mf,c=s.getRowCount(1);if(rt(n)&&(n=3),r.P8&&(a=[[b,n],it],u=[[p,n],it]),l=(t=r.Q_(t,n)).getColumnHeaderFitMode(e),t.setColumnHeaderFitMode(e,i,a),d=!1,i===tt.ColumnHeaderFitMode.vertical?(h=60,s.gD&&2===l&&s.gD--):i===tt.ColumnHeaderFitMode.stack?(r.t7(e,n),s.gD||(s.gD=0),2!==l&&s.gD++):i===tt.ColumnHeaderFitMode.normal&&(h=s.defaults.colHeaderRowHeight,s.gD)&&2===l&&s.gD--,h){for(v=r.Q_(!0,n),m=0;m<c;m++)f=s.getRowHeight(m,n),(h=g(h,f))!==f&&(v.setSize(m,Y,u),u)&&(r.G8.push(u),u=[[p,n],it]);s.defaults.colHeaderRowHeight=h}a&&r.G8.push(a)},A.prototype.t7=function(t,n){var e,i,r,o,a,u,s,c,f,l,e=this,o=e.Mf,a=e.Q_(!0,n);if(e.P8&&(i=[[p,n],it]),u=e.Mf.defaults.rowHeight||20,c=e.getRowCount(tt.SheetArea.colHeader),f=e.n7(t),!e.e7(t)){for(l=0;l<c;l++)r=u*f,s=o.getRowHeight(l,n),(r=g(r,s))!==s&&(a.setSize(l,Y,i),i)&&(e.G8.push(i),i=[[p,n],it]);o.defaults.colHeaderRowHeight=r}},A.prototype.e7=function(t){var n,e,i,e,n,n=this,e=n.Mf,i=e.frozenColumnCount()-1,e=e.frozenTrailingColumnCount(),n=n.getColumnCount()-1;return t===i||t===n||t===n-e},A.prototype.i7=function(t){var n,e,i,e,n,r,o,n=this,e=n.Mf,i=e.frozenColumnCount(),e=e.frozenTrailingColumnCount(),n=n.getColumnCount();return e&&(o=t===n-e),(r=i?t===i:r)||o},A.prototype.n7=function(t,n){for(var e,i,r,t,o,a,u,s,c,f,t,l,h,e=this,o=tt.SheetArea.colHeader,a={},u=e.Mf,s=u.getColumnCount(),i=r=t=(n=n||e.Q_(!1,o).infos)[t]&&n[t].columnHeaderFitMode===tt.ColumnHeaderFitMode.stack?t:t-1,c=t;0<=c;c--)if(u.getColumnWidth(c,o)){if(!n[c]||n[c].columnHeaderFitMode!==tt.ColumnHeaderFitMode.stack||e.eE(-1,c,-1,1,tt.SheetArea.colHeader))break;if(e.i7(c)){i=c;break}i=c}else a[i=c]=!0;for(c=t;c<s;c++)if(u.getColumnWidth(c,o)){if(!n[c]||n[c].columnHeaderFitMode!==tt.ColumnHeaderFitMode.stack||e.eE(-1,c,-1,1,tt.SheetArea.colHeader))break;if(e.e7(c))break;r=c}else if(a[r=c]=!0,e.e7(c))break;return t=r-i-(f=Object.keys(a).length)+1,l=1,!(h=u.O5(r,o,!0))||e.e7(r)||e.eE(-1,h,-1,1,tt.SheetArea.colHeader)?t:1+t},A.prototype.r7=function(t,n,e){var i,r,o,a,u,s,c,i=this,r=0,o=i.Mf,a=o.Ut;for(n=n||i.Q_(!1,tt.SheetArea.colHeader).infos,u=i.o7(t),s=t-1;u<=s;s--)if(c=o.getColumnWidth(s))if(n[s]&&n[s].columnHeaderFitMode===tt.ColumnHeaderFitMode.stack&&!a.eE(-1,s,-1,1,tt.SheetArea.colHeader))r++;else if(!e||!n[s]||n[s].columnHeaderFitMode!==tt.ColumnHeaderFitMode.vertical||a.eE(-1,s,-1,1,tt.SheetArea.colHeader))return r;return r},A.prototype.i6=function(t,n){for(var e,i,r,o,a,e=this,i,r=e.Mf.getColumnCount(),a=t+1;a<r;a++)if((o=e.getColumnHeaderFitMode(!1,1,a))===n)return a;return et},A.prototype.o7=function(t){var n,e,i,e,n,n=this,e=n.Mf,i=e.frozenColumnCount(),e=e.frozenTrailingColumnCount(),n=n.getColumnCount();return t<i?0:t<n-e?i:n-e},A.prototype.getStarSize=function(t,n,e){var i;return this.Q_(t,n).getStarSize(e)},A.prototype.getActualSize=function(t,n,e){var i;return this.Q_(t,n).getActualSize(e)},A.prototype.setSize=function(t,n,e,i){var r,o,a,o,r=this;rt(n)&&(n=3),o=0<r.P8?[[t?p:b,n],it]:it,(a=r.Q_(t,n)).setSize(e,i,o),this.Mf.ki($.Events.WorksheetDataChanged,{type:"size"}),o&&r.G8.push(o),r.setStarSize(t,n,e,et),o=t?tt.AxisInfoChangeType.setRowHeight:tt.AxisInfoChangeType.setColumnWidth,r.L8({type:o,index:e,value:i,sheetArea:n})},A.prototype.setStarSize=function(t,n,e,i){var r,o;rt(n)&&(n=3),r=0<this.P8?[[t?p:b,n],it]:it,(o=this.Q_(t,n)).setStarSize(e,i,r),r&&!rt(r[1])&&this.G8.push(r)},A.prototype._E=function(t,n){var e;return this.Q_(t,n)._E()},A.prototype.EE=function(t,n){var e;return this.Q_(t,n).EE()},A.prototype.q_=function(t,n,e){var i;return this.Q_(t,n).q_(e)},A.prototype.setItem=function(t,n,e,i){var r,o,a,u,r=this;rt(n)&&(n=3),o=0<r.P8?[[t?p:b,n],it]:it,(a=r.Q_(t,n)).X_(e,i,o),i&&(rt(i.size)||(u=t?tt.AxisInfoChangeType.setRowHeight:tt.AxisInfoChangeType.setColumnWidth,r.L8({type:u,index:e,value:i.size,sheetArea:n})),rt(i.visible)||(u=t?tt.AxisInfoChangeType.setRowVisible:tt.AxisInfoChangeType.setColumnVisible,r.L8({type:u,index:e,sheetArea:n}))),o&&r.G8.push(o)},Tt=A,t.Y8=Tt,(0,$.$e)(Tt),At=["=","+","-"],It=/^(__builtInTableStyle\d+)?__builtInStyle\d+$/,xt="__builtInStyle"},"./dist/core/worksheet/worksheet-render.js":function(s,t,ft){"use strict";var n,lt,q,e,c,ht,dt,vt,d,mt,gt,Mt,C,$,tt,Ct,pt,p,N,f,nt,et,T,E,j,b,y,w,l,h,bt,k,it,a,v,m,g,rt,M,S,St,A,u,I,x,_,O,R,B,L,F,P,G,U;function yt(t){return t.height}function wt(t){return t.width}function H(t,n,e,i,r,o,a){t.beginPath(),t.lineWidth=n,t.strokeStyle=e,t.moveTo(i,r),t.lineTo(o,a),t.stroke()}function z(t,n){var e,t,i,e=0;return"string"==typeof t&&(1===(i=(t=t.split(" ",4)).length)?e=2*k(t[0]):2===i||3===i?e=2*k(t[1]):4===i&&(e=k(t[1])+k(t[3]))),e*n}function D(t,n,e,i,r,o,a,u){var s,c,f,l,h,d,v,m,u,t,v,i,g,p,h,d,s=r.zoom(),c=e.font,f=e.textIndent,l=e.textOrientation,h=e.isVerticalText,d=e.textIndent&&0!==e.textIndent,v=0!==l&&!pt(l);return c=c?nt(c,s).font:i,typeof u===rt&&1!==u&&(c=nt(c,u).font),i=0,i=t&&t.richText?Y(t.richText,c,s):t&&v&&!h&&!d?(u=b(l*Math.PI/180),t=y(u),v=w(u),e.wordWrap?(h=(p=r.Jt).Gt(o),q.q.Zt(o,a,t,v,n,c,h)):(d=$(c),q.q.Wt(n,c)*v+d*t)):q.q.Wt(n,c),m=(i+=W(r,f,o,a)+M)+z(e.cellPadding,s)}function V(t,n,e){var i;if(t&&-90<=t&&t<=90)return h(e/l(b(t*Math.PI/180)))+n+4}function Y(t,n,e){var t=c.GC$.extend(!0,[],t);return Z(t,n,e),q.q.ah(t,n,1)}function Z(t,n,e){for(var i,r,o,a,o,i=0,r=t;i<r.length;i++)a=void 0,(o=r[i]).style=o.style||{},a=(o=o.style).font?nt(o.font,e).font:n,o.font=a}function W(t,n,e,i){if(!pt(e)&&!pt(i)&&t.outlineColumn){var t=t.outlineColumn.a7(e,i);if(t)return t}return n?8*n:0}function Q(t,n,e,i,r,o,a,u,s){var c,f,l,h,d,v,m,g,p,b,y,w,M,C,e,S,S,T,A,I;if(N(r.data)&&t.parent&&t.parent.options.numbersFitMode!==vt.NumbersFitMode.overflow)return et;if(c=t.Jt,f=wt(r),l=wt(r),d=r.style,m=r.text,g=r.printZoomFactor,p=d.watermark,b=d.wordWrap,y=d.textOrientation,C=t.options.allowCellOverflow,n.findCell(o,a))return et;if(d.cellButtons&&0<d.cellButtons.length)return et;if(mt.W.ose(d))return et;if(e=d.cellType||e,S=(S=t.parent&&t.parent.options.numbersFitMode)===vt.NumbersFitMode.mask||S===vt.NumbersFitMode.overflow&&!N(r.data),!e.allowOverflow||!m&&!p||!y&&b&&S)return et;if(!C&&!y)return et;if((w=D(r.data,m=m||p,d,i,t,o,a,g))<=l)return et;if(90===Math.abs(y)&&b)return et;for(v=(A=T=a)+(s?1:-1);(s?v<=u:u<=v)&&!n.findCell(o,v)&&(M=c.qt(o,v),h=c.$t(o,v,3,1,M),I=M.textOrientation,pt(h)||I&&y)&&!M.watermark&&!(M.cellType&&"1"!==M.cellType.typeName||M.cellButtons&&0<M.cellButtons.length||mt.W.ose(M))&&(s?A=v:T=v,!(w<=(l+=c.Kt(v))));v+=s?1:-1);return s&&A===a||!s&&T===a?et:new ht.Q8(a,T,A,w,f,l,s?-1:l,s?l:-1)}function i(t,n,e){var i=this;i.Mf=t,i.Vx=t.Yy(e),i.u7=t.s7(n,e,vt.SheetArea.viewport,!0),i.c7=nt(t.Dn.Nn(),t.zoom()).font,i.f7=t.$f(),i.l7={}}function J(t){var n,e,n=t.parent,e={nps:!0};return lt.Worksheet.et(t,"needPaintSelection",e),(q.hi.A1(t)||n&&!n.options.hideSelection)&&e.nps}function ot(t){var t=t.parent;return t&&t.options.backColor||g}function r(t){this.Mf=t}function o(t){var n=this;n.h7=!1,n.d7=!1,n.Mf=t,n.v7()}Object.defineProperty(t,"__esModule",{value:!0}),t.m7=t.g7=t.needPaintSelection=t.p7=void 0,n=ft("Common"),lt=ft("./dist/core/worksheet/worksheet.js"),q=ft("./dist/core/util/common.js"),e=ft("./dist/core/worksheet/stylehelper.js"),c=ft("./dist/core/util/domUtil.js"),ht=ft("./dist/core/worksheet/worksheet-model.js"),dt=ft("./dist/core/worksheet/worksheet-border.js"),vt=ft("./dist/core/core.enum.js"),d=ft("./dist/core/celltype/basecelltype.js"),mt=ft("./dist/core/worksheet/stylehelper.js"),gt=function(t){return t.getSparkline},Mt=n.Common.Uf,C=q.mt.gt,$=q.mt.vt,tt=q.mt.bt,Ct=q.mt.St,pt=n.Common.lt.ht,p=n.Common.lt.q8,N=q.mt.Ct,f=e.p5,nt=e.W.V,et=null,T=void 0,E=Math.min,j=Math.max,b=Math.abs,y=Math.sin,w=Math.cos,l=Math.tan,h=Math.floor,bt=Math.round,k=parseInt,it="black",a="transparent",v="rowHeader",m="columnHeader",g="white",rt="number",M=2,S=100,i.prototype.b7=function(t,n,e){var i,r,o,a,u,s,c,i=this,r=i.l7[t];if(r)return r;if(a=(o=i.Vx).length,u=new ht.K8,n=n||q.q.J(),0<a){for(u.headingOverflowLayouts=i.y7(t,n),c=0;c<a;c++)(s=this.w7(t,c,n,e))&&u.push(s);u.trailingOverflowLayouts=i.C7(t,n)}return i.l7[t]=u},i.prototype.w7=function(t,n,e,i){var r,o,a,u,s,c,f,l,u,h,d,v,u,n,a,m,g,p,s,b,n,u,n,u,n,a,y,r=this,o=r.Mf,a=o.Jt,u=r.Vx,s=u.length;if(0!==s&&(p=u[0].col,s=u[s-1].col,e=e||q.q.J(),!(wt(u=u[n])<=0))&&(h=u.col,d=a.qt(t,h),v=a.$t(t,h,3,1),c=d.textOrientation,f=d.isVerticalText,l=d.textIndent&&0!==d.textIndent,b=d&&(d.borderLeft||d.borderTop||d.borderRight||d.borderBottom),!pt(v)||d.watermark||d.cellType)&&(n=o.parent&&o.parent.options.numbersFitMode,!((d.shrinkToFit||!c&&d.wordWrap&&(n===vt.NumbersFitMode.mask||n===vt.NumbersFitMode.overflow&&!N(v))||f)&&4!==d.hAlign||4!==d.hAlign&&!1===o.options.allowCellOverflow||(u=o.conditionalFormats)&&(u=(n=u.U(o,t,h,v,3))&&n.dataBar,n=n&&n.iconSet,u&&u.showBarOnly||n&&n.showIconOnly))))return u=a.Kt(h),n=a.Gt(t),a=d.cellType||r.f7,m=q.Be.Cl(o,d,v,y={},{row:t,col:h,sheet:o}),y.content&&0<y.content.length&&!d.shrinkToFit&&c&&(m=a.de(e,y.content,n-4,d.font)),3===(a=d.hAlign)&&(a=C(a,v,d.formatter||d._autoFormatter,c)),!b||!c||f&&4!==a||l?0===a?g=r.S7({data:v,style:d,width:u,text:m,printZoomFactor:i},t,h,s):2===a?g=r.T7({data:v,style:d,width:u,text:m,printZoomFactor:i},t,h,p):1===a?g=r.A7({data:v,style:d,width:u,text:m,printZoomFactor:i},t,h,p,s):4===a&&(g=r.I7({data:v,style:d,width:u,text:m,printZoomFactor:i},t,h,0,o.getColumnCount()-1)):c<0&&-90<c?g=r.x7({data:v,style:d,width:u,text:m,printZoomFactor:i},t,h,p):0<c&&c<90&&(g=r.x7({data:v,style:d,width:u,text:m,printZoomFactor:i},t,h,s,!0)),g},i.prototype.N7=function(t){for(var n,e,i,r,o,a,u,s,c,f,n=this,e=n.Vx,i=e.length,r,o=n.Mf.Jt,f=i-1;0<=f;f--)if(c=(a=e[f]).col,u=o.qt(t,c),(s=o.$t(t,c,3,1))||u.watermarks)return this.w7(t,f)},i.prototype.S7=function(t,n,e,i){var r=this;return Q(r.Mf,r.u7,r.f7,r.c7,t,n,e,i,!0)},i.prototype.T7=function(t,n,e,i){var r=this;return Q(r.Mf,r.u7,r.f7,r.c7,t,n,e,i)},i.prototype.x7=function(t,n,e,i,r){var o,a,u,s,o,c,f,l,h,d,v,m,g,p,b,y,w,M,C,S,T,A,I,x,o=this,a=o.Mf,u=o.u7,s=o.f7,o=o.c7,c=a.Jt,f=wt(t),l=wt(t),h=t.style,v=t.text,m=t.printZoomFactor,g=h.watermark,p=h.wordWrap,b=h.textOrientation,M=h&&(h.borderLeft||h.borderTop||h.borderRight||h.borderBottom),C=h.isVerticalText,S=h.textIndent&&0!==h.textIndent,T=a.options.allowCellOverflow;if(u.findCell(n,e))return et;if(h.cellButtons&&0<h.cellButtons.length)return et;if(mt.W.ose(h))return et;if(!(A=h.cellType||s).allowOverflow||!v&&!g||!b&&p)return et;if(v=v||g,!T&&!b)return et;if((y=!M||C||S?D(t.data,v,h,o,a,n,e,m):V(b,c.Kt(e),c.Gt(n)))<=l)return et;for(d=(x=I=e)+(r?1:-1);(r?d<=i:i<=d)&&!u.findCell(n,d)&&!(w=c.qt(n,d)).watermark&&!(w.cellType&&"1"!==w.cellType.typeName||w.cellButtons&&0<w.cellButtons.length||mt.W.ose(w))&&(r?x=d:I=d,!(y<=(l+=c.Kt(d))));d+=r?1:-1);return r&&x===e||!r&&I===e?et:new ht.Q8(e,I,x,y,f,l,r?-1:l,r?l:-1)},i.prototype.A7=function(t,n,e,i,r){var o,a,u,s,c,f,l,h,d,v,m,g,p,b,y,w,M,C,S,T,A,I,x;if(N(t.data)&&this.Mf.parent&&this.Mf.parent.options.numbersFitMode!==vt.NumbersFitMode.overflow)return et;if(u=(a=(o=this).Mf).Jt,s=o.u7,c=wt(t),f=wt(t),h=t.style,v=t.text,m=t.printZoomFactor,g=h.textOrientation,p=h.watermark,b=h.wordWrap,M=a.options.allowCellOverflow,s.findCell(n,e))return et;if(h.cellButtons&&0<h.cellButtons.length)return et;if(mt.W.ose(h))return et;if(!(C=h.cellType||o.f7).allowOverflow||!v&&!p||!g&&b&&a.parent&&a.parent.options.numbersFitMode!==vt.NumbersFitMode.overflow)return et;if(!M&&!g)return et;if((y=D(t.data,v=v||p,h,o.c7,a,n,e,m))<=f)return et;if(90===Math.abs(g)&&b)return et;for(T=f/2,d=(S=e)-1;i<=d&&!s.findCell(n,d)&&(w=u.qt(n,d),l=u.$t(n,d,3,1,w),A=w.textOrientation,pt(l)||A&&g)&&!w.watermark&&!(w.cellType&&"1"!==w.cellType.typeName||w.cellButtons&&0<w.cellButtons.length||mt.W.ose(w))&&(S=d,!(y/2<=(T+=u.Kt(d))));d--);for(x=f/2,d=(I=e)+1;d<=r&&!s.findCell(n,d)&&(w=u.qt(n,d),l=u.$t(n,d,3,1,w),A=w.textOrientation,pt(l)||A&&g)&&!w.watermark&&!(w.cellType&&"1"!==w.cellType.typeName||w.cellButtons&&0<w.cellButtons.length||mt.W.ose(w))&&(I=d,!(y/2<=(x+=u.Kt(d))));d++);return S===I?et:new ht.Q8(e,S,I,y,c,T+x,T,x)},i.prototype.k7=function(t,n,e){var i,t,i=t.qt(n,e),t=t.$t(n,e,3,1,i);return!(!i.textOrientation&&!pt(t)||i.watermark||i.cellType&&"1"!==i.cellType.typeName||i.cellButtons&&0<i.cellButtons.length||mt.W.ose(i))},i.prototype.I7=function(t,n,e,i,r){var o,a,u,s,c,f,l,h,d,v,m,g,p,g,b,v,y,w,M,C,S,T,A,I,o=this,a=o.Mf,u=a.Jt,s=o.u7,c=wt(t),l=t.style,h=l.shrinkToFit,v=t.text,m=t.printZoomFactor,g=l.watermark,p=l.wordWrap;if(s.findCell(n,e))return et;if(l.cellButtons&&0<l.cellButtons.length)return et;if(mt.W.ose(l))return et;for(g=D(t.data,v=v||g,l,o.c7,a,n,e,m),w=u.Kt(y=v=e),M=v+1;M<=r&&(b=u.qt(n,M),f=u.$t(n,M,3,1,b),pt(f)&&4===b.hAlign&&pt(a.getSpan(n,M)))&&!b.watermark&&!(b.cellType&&"1"!==b.cellType.typeName||b.cellButtons&&0<b.cellButtons.length||mt.W.ose(b));M++)y=M,w+=u.Kt(M);if(C=(g-w)/2,N(t.data)&&this.Mf.parent&&this.Mf.parent.options.numbersFitMode!==vt.NumbersFitMode.overflow&&(C=0),S=v,A=y,I=T=w/2,!h&&!p&&!1!==a.options.allowCellOverflow){for(d=e-1;i<=d&&0<C&&(this.k7(u,n,d)&&!s.findCell(n,d))&&(S=d,!(C<=(T+=u.Kt(d))-w/2));d--);for(d=y+1;d<=r&&0<C&&(this.k7(u,n,d)&&!s.findCell(n,d))&&(A=d,!(C<=(I+=u.Kt(d))-w/2));d++);}return new ht.Q8(e,S,A,g,c,T+I,T,I,w)},i.prototype.y7=function(t,n){var e,i,r,o,a,u,s,c,f,l,h,d,v,m,g,f,p,b,y,w,e=this,i=e.Mf,r=i.Jt,o=e.Vx;if(0===o.length)return[];for(a=o[0].col,u=o[o.length-1].col,s=i.Ut,y=[],n=n||q.q.J(),w=1;w<100;w++){if((v=a-w)<0)return y;if(s.findSpan(t,v)||i.Cb&&i.Cb.D7(t,v,vt.SheetArea.viewport))return y;f=r.$t(t,v,3,1),0<(l=r.Kt(v))&&!pt(f)&&(4!==(d=(c=r.qt(t,v)).hAlign)&&!1===i.options.allowCellOverflow||(3===d&&(d=C(d,f,T,c.textOrientation)),h=r.Gt(t),p=c.cellType||e.f7,g=q.Be.Cl(i,c,f,b={},{row:t,col:v,sheet:i}),f={data:f,style:c,width:l,text:g=b.content&&0<b.content.length&&!c.shrinkToFit&&c.textOrientation?p.de(n,b.content,h-4,c.font):g},0<c.textOrientation&&c.textOrientation<90?m=e.x7(f,t,v,u,!0):0===d?m=e.S7(f,t,v,u):1===d?m=e.A7(f,t,v,a,u):4===d&&(m=e.I7(f,t,v,a,u)),m&&m.endColumn>=a&&y.push(m)))}return y},i.prototype.C7=function(t,n){var e,i,r,o,a,u,s,c,f,l,h,d,v,m,g,p,b,y,f,w,M,e=this,i=e.Mf,r=i.Jt,o=e.Vx;if(0===o.length)return[];for(a=o[0].col,u=o[o.length-1].col,s=i.Ut,g=i.getColumnCount(),w=[],n=n||q.q.J(),M=1;M<100;M++){if(g<=(p=u+M))return w;if(s.findSpan(t,p)||i.Cb&&i.Cb.D7(t,p,vt.SheetArea.viewport))return w;f=r.$t(t,p,3,1),0<(l=r.Kt(p))&&!pt(f)&&(4!==(d=(c=r.qt(t,p)).hAlign)&&!1===i.options.allowCellOverflow||(3===d&&(d=C(d,f,T,c.textOrientation)),h=r.Gt(t),v=c.cellType||e.f7,y=q.Be.Cl(i,c,f,m={},{row:t,col:p,sheet:i}),f={data:f,style:c,width:l,text:y=m.content&&0<m.content.length&&!c.shrinkToFit&&c.textOrientation?v.de(n,m.content,h-4,c.font):y},c.textOrientation<0&&-90<c.textOrientation?b=e.x7(f,t,p,a,!1):2===d?b=e.T7(f,t,p,a):1===d?b=e.A7(f,t,p,a,u):4===d&&(b=e.I7(f,t,p,0,u)),b&&b.startColumn<=u&&w.push(b)))}return w},St=i,t.p7=St,t.needPaintSelection=J,r.prototype.J=function(){var t,n,t,t=this.Mf,n=et,t=t.Dg();return n=t&&t.getContext?t.getContext("2d"):n},r.prototype._7=function(){var t,n,e,i,r,i,o,r,t=this,n=t.Mf,e=n.ot(),i=n.fg,r=wt(i),i=yt(i),o=t.E7;return o&&wt(o)===r&&yt(o)===i||(o&&q.Bf.th(n,o),t.E7=o=q.mt.En("canvas"),o.getContext&&(t.j7=o.getContext("2d"),q.Bf.Wl(o,et,n),q.Bf.$l(o,wt(e),yt(e)))),(r=t.j7)&&(r.beginPath(),tt(r,t._n(t.Nn())),r.name="bufferContext"),r},r.prototype.Nn=function(){return this.c7||(this.c7=f+" "+this.Mf.currentTheme().bodyFont()),this.c7},r.prototype.O7=function(){this.c7=et},r.prototype.R7=function(t){var n,e,i,n,r,n=this.Mf,e=n.parent,i=e?e.options.grayAreaBackColor||q.I.ll("gc-grayArea").backgroundColor:"gray",n=q.Pf.vl(n,i);return n=t&&(r=e?e.options.backgroundImage:et)?a:n},r.prototype._n=function(t){var n,e=this.Mf.zoom();return 1===e?t:nt(t,e).font},r.prototype.FA=function(t,n,e,i,r){var o,a,u,o,s,r,r,r,o=this,a=o.E7,u=o.J();!(e<=0||i<=0)&&a&&u&&(r=r||o.Mf.ot(),o=q.Bf.Kl(a),s=q.Bf.Jl(a),1!==o&&(t*=o,n*=s,e*=o,i*=s,r=new q.Rect(r.x*o,r.y*s,wt(r)*o,yt(r)*s)),r=r.getIntersect(t,n,e,i))&&(r.round(),t=r.x,n=r.y,e=wt(r),i=yt(r),(r=wt(a))&&r<t+e&&(t=r-e)<0&&(e+=t,t=0),(r=yt(a))&&r<n+i&&(n=r-i)<0&&(i+=n,n=0),q.Lf.Vl(u,1,1),u.clearRect(t,n,e,i),u.drawImage(a,t,n,e,i,t,n,e,i),q.Lf.Vl(u,o,s))},r.prototype.O1=function(t,n){t&&this.FA(t.x,t.y,wt(t),yt(t),n)},r.prototype.Ey=function(t,n,e,i,r,o){var a,u,s,c,f,l,h,d,v,m,g,p,b,y,w,M;if(0<e&&0<i)try{u=(a=this).Mf,s=a.J(),c=u.Dg(),f=a._7(),l=a.E7,v=r,m=o,g=e,p=i,b=q.Bf.Kl(c),y=q.Bf.Jl(c),t=bt(t*b),n=bt(n*y),e=bt(e*b),i=bt(i*y),v=bt(v*b),m=bt(m*y),g=bt(g*b),p=bt(p*y),w=wt(l),M=yt(l),w&&w<t+e&&(t=w-e)<0&&(e+=t,t=0),M&&M<n+i&&(n=M-i)<0&&(i+=n,n=0),w&&w<v+g&&(v=w-g)<0&&(g+=v,v=0),M&&M<m+p&&(m=M-p)<0&&(p+=m,m=0),q.Lf.Vl(s,1,1),q.Lf.Vl(f,1,1),s.clearRect(v,m,g,p),s.drawImage(l,t,n,e,i,v,m,g,p),f.clearRect(v,m,g,p),f.drawImage(c,v,m,g,p,v,m,g,p),q.Lf.Vl(s,b,y),q.Lf.Vl(f,b,y)}catch(t){}},r.prototype.E1=function(t,n,e,i,r,o){var a,u,s,c,f,l,h,d,v,m,g,p,b,y,w,s,M,C,M,S,T,A,I,I,x,I,T,A,S,S,t,S,x,T,N,k,D,_,A,a=this,u=a.Mf,s=pt(r)||3===r;if(e=e||a.J(),f=(c=!1,q.Ec)(-1,-1,-1,-1),l=u.Ut,t&&(f=u.options.allowCellOverflow||u.gD?(0,q.Ec)(t.row,0,t.rowCount,u.getColumnCount(r)):(0,q.Ec)(t.row,t.col,t.rowCount,t.colCount),s)&&!o){if(0<=f.col){for(d=f.col,v=f.col+f.colCount-1,m=u.getRowCount(1),g=0;g<m;g++)(h=l.findSpan(g,f.col,1))?d=E(h.col,d):u.z9&&(d=E(u.z9.col,d)),(h=l.findSpan(g,f.col+f.colCount-1,1))?v=j(h.col+h.colCount-1,v):u.z9&&(v=j(u.z9.col+u.z9.colCount-1,v));f.col=d,f.colCount=v-d+1}if(0<=f.row){for(p=f.row,b=f.row+f.rowCount-1,y=u.getColumnCount(2),w=0;w<y;w++)(h=l.findSpan(f.row,w,2))?p=E(h.row,p):u.z9&&(p=E(u.z9.row,p)),(h=l.findSpan(f.row+f.rowCount-1,w,2))?b=j(h.row+h.rowCount-1,b):u.z9&&(b=j(u.z9.row+u.z9.rowCount-1,b));f.row=p,f.rowCount=b-p+1}}if(s=u.j1(f,r),u.cellStates&&u.cellStates.hasIntersectInSelectionState(f.row,f.col,f.rowCount,f.colCount)&&u.repaint(s),C=(M=u._1)&&M.isEnable(vt.RowColumnStates.selected,!0),M=M&&M.isEnable(vt.RowColumnStates.selected,!1),t&&(S=void 0,(C||M)&&(S=u.s7(u.C0(t.row),u.S0(t.col),vt.SheetArea.viewport,!1)),C&&(T=t.row,A=t.rowCount,S&&0<S.length&&(I=S.findLargestRange(t,!0))&&(I=(0,q.Ec)(I.row,I.col,I.rowCount,I.colCount),T=(x=t.union(I)).row,A=x.rowCount),I=u.j1((0,q.Ec)(T,-1,A,-1),r),s.x=E(s.x,I.x),s.y=E(s.y,I.y),s.width=j(s.width,I.width),s.height=j(s.height,I.height)),M)&&(T=t.col,A=t.colCount,S&&0<S.length&&(S=S.findLargestRange(t,!1))&&(S=(0,q.Ec)(S.row,S.col,S.rowCount,S.colCount),T=(x=t.union(S)).col,A=x.colCount),I=u.j1((0,q.Ec)(-1,T,-1,A),r),s.x=E(s.x,I.x),s.y=E(s.y,I.y),s.width=j(s.width,I.width),s.height=j(s.height,I.height)),t=wt(s),S=yt(s),x=s.x,T=s.y,0<=t||0<=S){if(D=18,_=30,s.x+=k=N=-9,s.y+=-9,s.width+=18,s.height+=30,n&&!(s=s.getIntersectRect(n)))return;A=u.Fi(),0<S&&!o&&(u.k1=!0,a._e(e,new q.Rect(A.x,j(A.T6,T),A.XC,S),i)),0<t&&!o&&(u.k1=!0,a._e(e,new q.Rect(j(A.b6,x),A.y,t,A.qC),i)),-1!==f.row||-1!==f.col||o||(u.k1=!0,a._e(e,A.R1(),i)),0<t&&0<S&&((C||M)&&(u.k1=!0),a._e(e,s,i)),c=!0}return c},r.prototype._6=function(t,n,e,i,r){var o,a,u,o=this,a=o.Mf;a.My<=0&&(u=o.J())&&(r||(a.k1=!0),o._e(u,new q.Rect(t,n,e,i)))},r.prototype.repaint=function(t){var n,e,i,n=this,e=n.Mf;0<e.My||(i=n.J())&&(e.k1=!0,n._e(i,t))},r.prototype._e=function(t,n,e){var i=this;t&&i.Mf.My<=0&&(e||i.D1(t,n),i.jy(t,n))},r.prototype.D1=function(t,n,e){var i,r,o,t,a,i=this,r=i.Mf;t&&r.My<=0&&(t=(o=i._7())||t,a=r.ot(),(n=n||a)&&n.round(),e&&e.round(),r.k1&&(r.k1=!1,o&&(o.clearRect(n.x,n.y,wt(n),yt(n)),e&&o.clearRect(e.x,e.y,wt(e),yt(e)),q.Lf.Yl(o,-a.x,-a.y)),i.B7(t,n),e&&i.B7(t,e),o)&&q.Lf.Yl(o,a.x,a.y),o)&&(i.O1(n),e)&&i.O1(e)},r.prototype.jy=function(t,n){var e,i,r,o,a,u,s,c,e=this,i=e.Mf,r=i.Oi;if(t&&!(0<i.My)&&(n&&n.round(),o=i.Fi(),lt.Worksheet.et(i,"beforePaintAdornment",{ctx:t,clipRect:n}),!i.D_)){if(r){for(a=o.R1(),e.O1(a),s=0;s<=2;s++)(a=o.B1(s))&&0!==wt(a)&&0!==yt(a)&&e.O1(a);for(c=0;c<=2;c++)(a=o.L1(c))&&0!==wt(a)&&0!==yt(a)&&e.O1(a)}else if(i.NMi&&i.NMi.options.isDesignMode)for(c=0;c<=2;c++)!(a=o.L1(c))||0===wt(a)||0===yt(a)||(u=n)&&!a.intersectRect(u)||e.L7(t,-1,c,u,1);for(s=0;s<=2;s++)for(c=0;c<=2;c++)(a=o.c9(s,c))&&0!==wt(a)&&0!==yt(a)&&(u=n,(r&&(1!==s||1!==c)||i.parent&&i.parent.options.allowUserDragMerge)&&(e.O1(a),u=a),u&&!a.intersectRect(u)||e.L7(t,s,c,u));e.F7(t),lt.Worksheet.et(i,"paintAdornment",{ctx:t,clipRect:n})}},r.prototype.wm=function(t,n){var e,i,i,r,e,o,e=this.Mf,i=e.parent,i=i?i.options:{},r=ot(e),e=q.Pf.vl(e,r),o;i.backgroundImage&&(e=a),t.save(),t.fillStyle=e,t.fillRect(n.x,n.y,wt(n),yt(n)),t.restore()},r.prototype.P7=function(t,n){var e=this.Mf,i;return 0===e.Fi().qC&&(t===e.N9(3)||n)},r.prototype.G7=function(t,n){var e=this.Mf,i;return 0===e.Fi().XC&&(t===e.k9(3)||n)},r.prototype.U7=function(t,n,e,i,r){var o,a,u,i,s,c,s,e,o=this,a=o.Mf,u=0===i.width,i=0===i.height,s=a.options,c=s.sheetAreaOffset.top,s=s.sheetAreaOffset.left,e=e.c9(t,n);return e&&(i&&o.P7(a.H7(t),r)&&(e.y=e.y-c,e.height=e.height+c),u)&&o.G7(a.z7(n),r)&&(e.x=e.x-s,e.width=e.width+s),e},r.prototype.V7=function(t,n,e,i){for(var r,o,a,u,s,c,f,l,h,d,v,m,g,p,b,y,w,o,r=this,o=r.Mf,a=o.options,u=o.Fi(),s=a.sheetAreaOffset.top,c=a.sheetAreaOffset.left,f=0!==u.qC,l=0!==u.XC,h=o.gj&&o.gj()||{x:a.sheetAreaOffset.left,y:a.sheetAreaOffset.top,width:0,height:0},d=0===h.width,v=0===h.height,g=0;g<=2;g++)(b=u.L1(g))&&(f&&v&&(b.y=b.y-s,b.height=b.height+s,!l)&&d&&(b.x=b.x-c,b.width=b.width+c),p=n?b.getIntersectRect(n):b)&&r.Y7(t,g,p,e,i);for(m=0;m<=2;m++)for((y=u.B1(m))&&(l&&d&&(y.x=y.x-c,y.width=y.width+c,!f)&&v&&(y.y=y.y-s,y.height=y.height+s),p=n?y.getIntersectRect(n):y)&&r.Z7(t,m,p,e,i),g=0;g<=2;g++)(w=r.U7(m,g,u,h,e))&&(p=n?w.getIntersectRect(n):w)&&r.W7(t,m,g,p,e,i);(o=u.R1())&&(p=n?o.getIntersectRect(n):o)&&r.Q7(t,p,e,i)},r.prototype.K7=function(t){var n,e,i,r,o,a,u,s,c,f,l,i,h,n=this,e=n.Mf,i=e.Fi(),r=i.BA,o=i.LA,a=wt(i),u=i.Ay,s=i.Iy,c=i.J7,f=i.Uy,l=i.X7,i=i.Ty;0<i&&(t.fillStyle=n.R7(!1),t.fillRect(r,l,a,i)),0<f&&(t.fillStyle=n.R7(!1),t.fillRect(c,o,f,l),h=e.Ny)&&t.fillRect(c,u,f,s)},r.prototype.q7=function(t,n){var e,i,r,i,o,i,a,u,s,n,e=this,i=e.Mf,r=e.R7(!1),i=i.options,o=i.sheetAreaOffset.left,i=i.sheetAreaOffset.top,a=n.x,u=n.y,s=wt(n),n=yt(n);t.save(),0<o&&H(t,o,r,a+o/2,0<i?u+i:u,a+o/2,u+j(0,n)),0<i&&H(t,i,r,0<o?a+o:a,u+i/2,a+j(0,s),u+i/2),0<o&&0<i&&(t.fillStyle=e.R7(!1),t.fillRect(a,u,o,i)),t.beginPath(),t.restore()},r.prototype.B7=function(t,n){var e,i,r,e=this,i=e.Mf;!t||0<i.My||(r=i.ot(),t.save(),n?t.rect(n.x,n.y,wt(n),yt(n)):t.rect(r.x,r.y,wt(r),yt(r)),t.clip(),t.beginPath(),e.wm(t,r),lt.Worksheet.et(i,"paint",{ctx:t,clipRect:n}),e.q7(t,r),e.V7(t,n,!1),e.K7(t),e.tO(t),lt.Worksheet.et(i,"paintSheetEnd",{ctx:t,clipRect:n}),t.beginPath(),t.restore())},r.prototype.nO=function(t,n,e){var i,r,r,n,i=this,r=i.Mf;t&&(r=r.ot(),t.save(),n=n||new q.Rect(r.x,r.y,wt(r),yt(r)),t.rect(n.x,n.y,wt(n),yt(n)),t.clip(),t.beginPath(),i.wm(t,r),i.V7(t,n,!0,e),t.beginPath(),t.restore())},r.prototype.F7=function(t){var n,e,i,r,o,a,u,s,c,s,c,u,u=this.Mf,s=u.rt,c=u.sw;if(s&&s.isResizing&&c&&(s=c.resizeInfo)){if(c=u.Fi(),u=it,t.save(),t.strokeStyle!==u&&(t.strokeStyle=u),1!==t.lineWidth&&(t.lineWidth=1),t.beginPath(),"sizeRow"===s.action||"sizeHiddenRow"===s.action)for(e=j(0,s.startY-.5),r=s.movingY-.5,o=c.x+wt(c),n=c.x;n<o;n+=2)t.moveTo(n,e),t.lineTo(n+1,e),t.moveTo(n,r),t.lineTo(n+1,r);else for(n=j(0,s.startX-.5),i=s.movingX-.5,a=c.y+yt(c),e=c.y;e<a;e+=2)t.moveTo(n,e),t.lineTo(n,e+1),t.moveTo(i,e),t.lineTo(i,e+1);t.stroke(),t.beginPath(),t.restore()}},r.prototype.Q7=function(t,n,e,i){var r,o,a,u,s,o,c,c,r=this.Mf;t.beginPath(),a=(o=r.Fi().R1()).x,u=o.y,s=wt(o),o=yt(o),c=r.getActualStyle(-1,-1,0),this.eO(t,[{data:et,row:-1,col:-1,x:a,y:u,width:s,height:o,style:c.clone()}],0,e,i),(c=new dt.Yx(r,r._y(0,0),r.Yy(0,0),0)).PN(0,0,a,u,s,o),c.paint(t)},r.prototype.tO=function(t){var n,e,i,r,o,a,u,s,c,f,l,h,d,a,n=this.Mf,e=n.frozenRowCount(),i=n.frozenColumnCount(),r=n.frozenTrailingRowCount(),o=n.frozenTrailingColumnCount();(e||i||r||o)&&(u=(a=n.Fi()).Py,s=a.Cy,c=a.Hy,f=a.Ay,l=a.x,h=a.y,d=wt(a),a=yt(a),t.save(),t.strokeStyle=q.Pf.vl(n,n.options.frozenlineColor),t.lineWidth=1,t.beginPath(),i&&(t.moveTo(u-.5,h),t.lineTo(u-.5,h+a)),e&&(t.moveTo(l,s-.5),t.lineTo(l+d,s-.5)),o&&(t.moveTo(c-.5,h),t.lineTo(c-.5,h+a)),r&&(t.moveTo(l,f-.5),t.lineTo(l+d,f-.5)),t.stroke(),t.restore())},r.prototype.Y7=function(t,n,e,i,r){this.iO(t,-1,n,1,e,i,r)},r.prototype.Z7=function(t,n,e,i,r){this.iO(t,n,-1,2,e,i,r)},r.prototype.W7=function(t,n,e,i,r,o){var a,a,u,s,c,r,a=this.Mf,a=a.getCalcService&&a.getCalcService(),u=a&&a.rO;for(s in u)u[s].getSource().startCalculation();if(this.iO(t,n,e,3,i,r,o),u)for(s in c=!a.calcOnDemand,u)u[s].getSource().endCalculation(c);(r=this.Mf.lA)&&r.oO(t,i,n,e)},r.prototype.aO=function(t,n,e,i,r){var o,a,u,a,n,e,o,a=this.Mf,u=a.getRangeRect(n,e,(0,q.Ec)(r.row,r.col,r.rowCount,r.colCount));(u=u.getIntersectRect(a.Fi().c9(n,e)))&&(u.round(),a=r.isValid,t.save(),t.lineWidth=1,t.strokeStyle="mediumblue",a||t.setLineDash([6,2]),n=u.x+.5,e=u.y+.5,t.strokeRect(n,e,wt(u),yt(u)),t.beginPath(),t.restore())},r.prototype.L7=function(t,n,e,i,r){var o,a,u,s,c,f,l,h,d,v,m,g,p,b,y,w,p,M,C,S,T,l,S,l,A,I,x,T,S,l,A,o=pt(r)||3===r,a=this,u=a.Mf;if(J(u)&&u.addSelection&&(l=u.Ut,h=u.rt,v=(d=l.getSelections(r)).length,i=a.uO(n,e,i))&&(m=q.I.fl("gc-selection"),g=k(m.zIndex),o&&(2007<g&&a.sO(t,n,e,i),p=l.cO=l.t8.getAnchorInfo(u.getActiveRowIndex(),u.getActiveColumnIndex()))&&a.aO(t,n,e,i,p),w=void 0,!((y=(b=a.fO(n,e,d,i)).length)<=0))){for(p=o&&a.fO(n,e,[u.z9],i)[0],M=!1,C=void 0,C=0;C<y;C++)if(w=b[C],!i.containsRect(w)){M=!0;break}if(p&&!i.containsRect(p)&&(M=!0),t.save(),M&&(t.rect(i.x,i.y,wt(i),yt(i)),t.clip()),t.beginPath(),0<y)for(f=q.Pf.vl(u,u.getSelectionBackColor()),t.fillStyle!==f&&(t.fillStyle=f),c=s=0,2007<g&&(s=1,c=-3),C=0;C<y;C++)w=b[C],t.fillRect(w.x+s,w.y+s,wt(w)+c,yt(w)+c);u.RD||(S=u.ui,T=u.ci,1===r?(S=(l=l.J9()||d[0]).row,T=l.col):p&&(S=u.U9,T=u.H9),x=I=A=l=void 0,(S=u.getCellRect(S,T,n,e))&&S.intersectRect(i)&&(l=S.x,A=S.y,I=wt(S),x=yt(S),s=1,c=-2,2007<g&&(c=s=0),a.FA(l+s,A+s,I+c,x+c),1<v)&&(t.strokeStyle=q.Pf.vl(u,u.getSelectionBorderColor()),t.lineWidth=1,t.strokeRect(l+1.5,A+1.5,I-4,x-4))),t.restore(),t.save(),t.beginPath(),1===v&&(o&&h&&h.Yk&&h.lO&&h.lO()&&!h.hO&&(T=h.dO&&h.dO(),l=wt(S=u.getRangeRect(n,e,T)),A=yt(S),S)&&0<l&&0<A&&(t.fillStyle=m&&m.color,t.fillRect(S.x,S.y,l,A)),w)&&0<=wt(w)&&0<=yt(w)&&(a.vO(i,u,n,e,g),a.mO(t,n,e,w,i,d[0],r)),p&&(t.save(),M&&(t.rect(i.x,i.y,wt(i),yt(i)),t.clip()),t.beginPath(),t.fillStyle="rgba(255,255,255,0.4)",t.fillRect(p.x+s,p.y+s,wt(p)+c,yt(p)+c),t.fillStyle=f,t.strokeStyle="rgb(124,124,124)",t.lineWidth=1,t.strokeRect(p.x-.5,p.y-.5,wt(p),yt(p)),t.restore()),t.beginPath(),t.restore()}},r.prototype.vO=function(t,n,e,i,r){var o,a,u,s,o,a,c,f,r,l,u,h,d,v,u,r,l,f,c,o=n.frozenTrailingRowCount(),a=n.frozenTrailingColumnCount(),u=n.getSelections(),s=n.Fi(),o=n.getRowCount()-o-1,a=n.getColumnCount()-a-1,c=n.Yy(1,3),f=n._y(1,3);1===u.length&&2007<r&&(r=n.frozenRowCount(),l=n.frozenColumnCount(),h=(u=u[0]).row,d=u.col,v=u.rowCount,u=u.colCount,0<r&&(r<=h&&n.nI(h)<r?(t.y-=2,t.height+=2):h+v<=r&&n.j5(h+v-1)===n.Tb&&(t.height+=2)),0<l&&(l<=d&&n.r6(d)<l?(t.x-=2,t.width+=2):d+u<=l&&n.O5(d+u-1)===n.Ab&&(t.width+=2)),0===h&&0===d&&(t.x-=2,t.y-=2,t.width+=2,t.height+=2),-1===h&&(h=0,v=n.getRowCount()),-1===d&&(d=0,u=n.getColumnCount()),l=r=!1,f=f.findRow(o),c=c.findCol(a),f&&f.y+yt(f)<s.Cy+n.Sy(s)&&(r=!0),c&&c.x+wt(c)<s.Py+n.Gy(s)&&(l=!0),r&&h+v-1==o&&(t.height+=2),l)&&d+u-1==a&&(t.width+=2)},r.prototype.sO=function(t,n,e,i){var r,o,a,u,s,c,f,B,u,a,l,h,d,a,v,m,g,p,b,y,w,M,C,S,T,A,I,x,N,k,D,_,E,j,O,R,r=this,o=r.Mf,a=o.Ut.getSelections(),u=o.Fi(),s=u.b6,c=u.T6,f=a.length,B=0!==u.qC,u=0!==u.XC;if(!(f<=0)){if(l=(a=a[0]).row,h=a.rowCount,d=a.col,a=a.colCount,-1===l&&(l=0),-1===d&&(d=0),-1===h&&(h=o.getRowCount()),-1===a&&(a=o.getColumnCount()),t.save(),t.beginPath(),t.lineWidth=2,t.strokeStyle=o.getSelectionBorderColor(),v=i.x,m=i.y,g=wt(i),p=yt(i),b=o.frozenRowCount(),B&&(1!==f||0!==b||o.Tb<=l||o.Tb>=l+h))for(w=0,M=(y=r.gO(e)).length;w<M;w++)T=S=0,A=(C=y[w]).x,I=C.x+wt(C),C.x<v+g&&v<C.x+wt(C)&&(1===f&&(0===b&&o.Tb===l||0<b&&0===l)&&(S=-1,T=1),C.x<v&&(S=0,A=v),C.x+wt(C)>v+g&&(T=0,I=v+g),t.moveTo(A+S-1,c-1),t.lineTo(I+T,c-1),t.stroke());if(x=o.frozenColumnCount(),u&&(1!==f||0!==x||o.Ab<=d||o.Ab>=d+a))for(k=0,D=(N=r.pO(n)).length;k<D;k++)j=E=0,O=(_=N[k]).y,R=_.y+yt(_),_.y<m+p&&m<_.y+yt(_)&&(1===f&&(0===x&&o.Ab===d||0<x&&0===d)&&(E=-1,j=1),_.y<m&&(E=0,O=m),_.y+yt(_)>m+p&&(j=0,R=m+p),t.moveTo(s-1,O+E-1),t.lineTo(s-1,R+j),t.stroke());t.beginPath(),t.restore()}},r.prototype.gO=function(t){for(var n,e,i,r,o,a,u,s,c,f,l,h,d,u,v,l,h,d,n=this.Mf,e=n.Ut.getSelections(),i=e.length,r=n.Yy(t),o=[],a={},s=0;s<i;s++)(c=e[s])&&(-1===(f=c.col)?(l=n.Yy(0,3),h=n.Yy(1,3),d=n.Yy(2,3),v=u=-1,0<l.length&&(u=l[0].x,v=l[l.length-1].x+l[l.length-1].width-u,o.push(new q.Rect(u,-1,v,-1))),0<h.length&&(u=h[0].x,v=h[h.length-1].x+h[h.length-1].width-u,o.push(new q.Rect(u,-1,v,-1))),0<d.length&&(u=d[0].x,v=d[d.length-1].x+d[d.length-1].width-u,o.push(new q.Rect(u,-1,v,-1)))):r&&(l=r.findCol(f),h=r.findCol(f+c.colCount-1),l||h)&&((d=new q.Rect(-1,-1,-1,-1)).x=(l||r[0]).x,d.width=h?h.x+wt(h)-d.x:r[r.length-1].x+r[r.length-1].width-d.x,a[u=[d.x,d.width].join("_")]||(a[u]=!0,o.push(d))));return o},r.prototype.pO=function(t){for(var n,e,i,r,o,a,u,s,c,f,l,h,d,u,v,l,h,d,n=this.Mf,e=n.Ut.getSelections(),i=e.length,r=n._y(t),o=[],a={},s=0;s<i;s++)(c=e[s])&&(-1===(f=c.row)?(l=n._y(0,3),h=n._y(1,3),d=n._y(2,3),v=u=-1,0<l.length&&(u=l[0].y,v=l[l.length-1].y+l[l.length-1].height-u,o.push(new q.Rect(-1,u,-1,v))),0<h.length&&(u=h[0].y,v=h[h.length-1].y+h[h.length-1].height-u,o.push(new q.Rect(-1,u,-1,v))),0<d.length&&(u=d[0].y,v=d[d.length-1].y+d[d.length-1].height-u,o.push(new q.Rect(-1,u,-1,v)))):r&&(l=r.findRow(f),h=r.findRow(f+c.rowCount-1),l||h)&&((d=new q.Rect(-1,-1,-1,-1)).y=(l||r[0]).y,d.height=h?h.y+yt(h)-d.y:r[r.length-1].y+r[r.length-1].height-d.y,a[u=[d.y,d.height].join("_")]||(a[u]=!0,o.push(d))));return o},r.prototype.mO=function(t,n,e,i,r,o,a){var u,s,c,f,l,h,d,v,m,g,p,b,y,w,M,C,S,M,T,u=this,s=u.Mf,c=s.parent,f=s.rt,l=i.x,h=i.y,d=wt(i),v=yt(i),m=s.getViewportTopRow(n),g=s.getViewportLeftColumn(e),p=s.getViewportBottomRow(n),b=s.getViewportRightColumn(e),y=0,w=0,M=s.Fi(),C=0!==M.qC,S;0!==M.XC||o.col!==g&&-1!==o.col||(y=2),C||o.row!==m&&-1!==o.row||(w=2),o.row+o.rowCount===p+1&&(r.height=r.height+1),o.col+o.colCount===b+1&&(r.width=r.width+1),0<=d&&0<=v&&(!r||i.intersect(r.x-1,r.y-1,wt(r)+2,yt(r)+2))&&(t.save(),r&&!r.containsRect(i)&&(t.rect(r.x-y,r.y-w,wt(r),yt(r)),t.clip()),t.beginPath(),t.strokeStyle=q.Pf.vl(s,s.getSelectionBorderColor()),t.lineWidth=2,0<d&&0<v?(f&&f.Yk?2===(M=f.bO)?(t.moveTo(l+.5,h-.5),t.lineTo(l+d-1,h-.5)):3===M?(t.moveTo(l+.5,h+v-.5),t.lineTo(l+d-1,h+v-.5)):0===M?(t.moveTo(l-.5,h+.5),t.lineTo(l-.5,h+v-1)):1===M&&(t.moveTo(l+d-.5,h+.5),t.lineTo(l+d-.5,h+v-1)):2007<(T=c&&c.SC)?t.rect(l-1,h-1,d+1,v+1):t.rect(l-.5,h-.5,d,v),t.stroke(),(pt(a)||3===a)&&c&&c.options.allowUserDragFill&&u.yO&&u.yO(t,n,e,i,r)):0!==d&&0!==v||t.strokeRect(l-1,h-1,d+1,v+1),t.beginPath(),t.restore())},r.prototype.uO=function(t,n,e){var i,r,o,n,n,n,i,i=this.Mf,r=i.Fi();return 0<=t&&0<=n?o=r.c9(t,n):-1===t?o=r.L1(n):-1===n&&(o=r.B1(t)),1===n&&(n=0<(n=i.Yy(n)).length?n[n.length-1]:et)&&(o.width=E(wt(o),n.x+wt(n)-r.Py)),1===t&&(i=0<(n=i._y(t)).length?n[n.length-1]:et)&&(o.height=E(yt(o),i.y+yt(i)-r.Cy)),e=e?e.getIntersect(o.x,o.y,wt(o),yt(o)):o},r.prototype.fO=function(t,n,e,i){for(var r,o,a,u,s,c,a,f,l,r=this.Mf,o=r.Ut,u=e.length,c=[],f=r.C6(t,n),l=0;l<u;l++)(s=e[l])&&((a=o.findSpan(s.row,s.col,f))&&a.containsRange(s)&&(s=a),a=r.getRangeRect(t,n,s))&&a.x<=i.x+wt(i)&&a.y<=i.y+yt(i)&&i.x<=a.x+wt(a)&&i.y<=a.y+yt(a)&&c.push(a);return c},r.prototype.wO=function(t,n,e){var i,r,o,n,a,u,s,c,f,l,h;if(t.save(),i=n.x,r=n.y,o=wt(n),n=yt(n),a=[6,6],t.setLineDash)t.beginPath(),t.lineWidth=2,t.strokeStyle=e,t.setLineDash(a),t.rect(i,r,o-1,n-1);else{for(t.beginPath(),t.lineWidth=2,t.strokeStyle=e,u=a[0],s=a[1],h=l=f=c=void 0,c=i,f=r,l=o;0<l;)if(u+s<=l)t.moveTo(c,f),t.lineTo(c+u,f),c=c+u+s,l=l-u-s;else{if(u<=l){t.moveTo(c,f),t.lineTo(c+u,f),l=l-u-s;break}if(0<l){t.moveTo(c,f),t.lineTo(c+l,f),l=l-u-s;break}}for(c=i+o-1,f=r+1,h=n-1,l<0&&(s<(l=b(l))&&(t.moveTo(c,f-2),t.lineTo(c,f+(l-s))),f+=l,h-=l);0<h;)u+s<=h?(t.moveTo(c,f),t.lineTo(c,f+u),f=f+u+s,h=h-u-s):u<=h?(t.moveTo(c,f),t.lineTo(c,f+u),h=h-u-s):0<h&&(t.moveTo(c,f),t.lineTo(c,f+h),h=h-u-s);for(c=i+o-2,f=r+n-1,l=o-1,h<0&&(s<(h=b(h))&&(t.moveTo(c+2,f),t.lineTo(c-(h-s),f)),c-=h,l-=h);0<l;)if(u+s<=l)t.moveTo(c,f),t.lineTo(c-u,f),c=c-u-s,l=l-u-s;else{if(u<=l){t.moveTo(c,f),t.lineTo(c-u,f),l=l-u-s;break}if(0<l){t.moveTo(c,f),t.lineTo(c-l,f),l=l-u-s;break}}for(c=i,f=r+n-2,h=n-1,l<0&&(s<(l=b(l))&&(t.moveTo(c,f+2),t.lineTo(c,f-(l-s))),f-=l,h-=l);0<h;)u+s<=h?(t.moveTo(c,f),t.lineTo(c,f-u),f=f-u-s,h=h-u-s):u<=h?(t.moveTo(c,f),f-u===r?t.lineTo(c,f-u-1):t.lineTo(c,f-u),h=h-u-s):0<h&&(r<f&&(t.moveTo(c,f),t.lineTo(c,f-h)),h=h-u-s)}t.stroke(),t.beginPath(),t.restore()},r.prototype.vfe=function(t,n,e,i,r,o){var i,a,u,s,c,f,l,h,d,v,m,g,m;if(!i&&0!==n.length){for(i=e.row,h=l=f=c=s=u=a=void 0,d=n.length-1;0<=d&&(v=n[d]).isOutside;d--)h=d;for(f=(p(h)?(a=(m=n[h]).col,u=m.x,s=m.width,2!==m.columnHeaderFitMode?(c=n[h].y,n[h]):(c=n[h+1].y,n[h+1])):(a=n[n.length-1].col+1,u=n[n.length-1].x+n[n.length-1].width,s=r.Jt.Kt(a,o),c=e.y,e)).height,l=r.Jt.qt(i,a,o),mt.W.dfe(l,4)&&0<s&&r.getColumnVisible(a,o)&&t.push({style:l,x:u,y:c,width:s,height:f}),g=void 0,d=0;d<n.length&&(v=n[d]).isOutside;d++)g=d;f=(p(g)?(a=(m=n[g]).col,u=m.x,s=m.width,2!==m.columnHeaderFitMode?(c=n[g].y,n[g]):(c=n[g+1].y,n[g+1])):(a=n[0].col-1,s=r.Jt.Kt(a,o),u=n[0].x-s,c=e.y,e)).height,l=r.Jt.qt(i,a,o),mt.W.dfe(l,5)&&0<s&&r.getColumnVisible(a,o)&&t.push({style:l,x:u,y:c,width:s,height:f})}},r.prototype.MO=function(t,n,e,i,r,o,a){var r,u,s,s,r;r&&0!==n.length&&(r=n[0].col-1,u=n[n.length-1].col+1,s=e.Sl(i.row,r,a,1),0<=r&&o.isValid&&!o.isValid(i.row,r,s)&&t.push({style:o.getDataValidator(i.row,r).highlightStyle(),x:n[0].x-o.getColumnWidth(r),y:i.y,width:o.getColumnWidth(r),height:i.height}),s=e.Sl(i.row,u,a,1),o.isValid)&&!o.isValid(i.row,u,s)&&(r=n[n.length-1],t.push({style:o.getDataValidator(i.row,u).highlightStyle(),x:r.x+r.width,y:i.y,width:o.getColumnWidth(u),height:i.height}))},r.prototype.CO=function(t,n,e){for(var i,r,o,a,u,s,c,f,l,h,d,v,i=n.Jt,r=t.row,o=t.col,a={},u={},s=[],c=t.rowCount,f=t.colCount,l=0;l<f;l++)u[l]=n.nn(l+o,e);for(h=0;h<c;h++){if(a[h]=n.Gt(h+r,e),d=[],0<a[h])for(v=0;v<f;v++)d.push(0<u[v]?i.qt(r+h,o+v,e):T);s.push(d)}return{rowSizes:a,colSizes:u,styleList:s}},r.prototype.iO=function(t,f,l,h,d,v,c){var m,g,n,L,F,p,e,e,i,b,P,y,r,o,G,U,w,M,C,S,T,A,I,x,N,k,D,_,E,H,j,a,D,O,z,V,Y,Z,W,Q,J,n,K,X,q,$,tt,n,e,R,B,nt,et,it,n,rt,ot,u,at,ut,st,ct,ct,e,s;if(pt(h)&&(h=3),n=(g=(m=this).Mf).parent,L=n&&n.options.resizeZeroIndicator,F=g._y(f,h),p=g.pfe(l,h),e=g.options.sheetAreaOffset,e=g.gj&&g.gj()||{x:e.left,y:e.top,width:0,height:0},i=m.U7(f,l,g.Fi(),e,v),b=!1,P=F.length,y=p.length,!(P<0||y<0)){for(r=new ht.h9,o=0;o<y;o++)p[o].isOutside||r.push(p[o]);for(G=g.s7(f,l,h,!0),U=0<G.length,S=g.Jt,k=N=x=I=0,E=new dt.Yx(g,F,r,h),H=[],j=[],a=[],O=[],z=[],V=!v&&3===h&&n&&n.options.highlightInvalidData,t.save(),t.beginPath(),Y=[],W=Z=-1,Q=g.N9(3),J=g.k9(3),n=g.Fi(),K=0===n.qC&&0===e.height,X=0===n.XC&&0===e.width,q=!!gt(this.Mf),$=!1,tt=ft("SheetsCalc"),n=g.getActiveRowIndex(),e=g.getActiveColumnIndex(),R=this.SO(h,g,n,e),o=0;o<P;o++){for(w=F[o],m.MO(O,r,S,w,V,g,h),B=[],nt=function(e){var t,t,n,n,i,r,o,a,u,s,u,u,c,c;if(M=p[e],(C=U&&G.findCell(w.row,M.col))?(T=C.row,A=C.col,I=C.x,x=C.y,N=wt(C),k=yt(C),C.isAutoMerge&&(t=m.TO(C,f,l,h),I=t.x,x=t.y,N=t.width,k=t.height),C.spanSizeInfo||(C.spanSizeInfo=m.CO(C,g,h))):(T=w.row,A=M.col,I=M.x,N=wt(M),-1===M.y?x=w.y:(x=bt(M.y*w.height+w.y),b=!0),-1===yt(M)?k=yt(w):(k=w.height+w.y-x,b=!0)),1===L&&(-1===f&&g.getColumnVisible(A)&&0===g.Do(A)&&((W<0||W!==A-1)&&Y.push({x1:I,y1:x,x2:I,y2:x+k,horizontal:!1}),W=A),-1===l)&&g.getRowVisible(T)&&0===g._o(T)&&((Z<0||Z!==T-1)&&Y.push({x1:I,y1:x,x2:I+N,y2:x,horizontal:!0}),Z=T),d&&(I+N<=d.x||I>=d.x+wt(d)||x+k<=d.y||x>=d.y+yt(d))&&(!b||I>d.x+wt(d))&&!M.isOutside)return"continue";if(0===N||0===k)return"continue";if(1===h&&e<y-1&&p[e+1].x-I==0)return"continue";if(B.push({col:A,x:I,y:x,width:N,height:k}),t=function(t){var n,n;t.columnHeaderFitMode!==vt.ColumnHeaderFitMode.normal&&e<y-1&&(n=g.O5(M.col,h,!0))&&(n=p.findCol(n))&&-1!==n.y&&(t.cornerX=n.x,t.columnHeaderFitMode===vt.ColumnHeaderFitMode.stack?t.cornerY=bt(n.y*w.height)+w.y:t.cornerY=w.height+w.y)},M.isOutside)return(n=B[B.length-1]).isOutside=!0,n.columnHeaderFitMode=1===h&&g.Lt(A),t(n),n.columnHeaderFitMode===vt.ColumnHeaderFitMode.stack&&(n.width=S.Kt(A,h)),"continue";if(n=!1,!C||!Mt.OS(H,C)){if(i=!1,D=S.$t(T,A,h,1),r=g.AO&&g.AO(),o=g.getRowCount(vt.SheetArea.colHeader)-1,!v&&R&&T===o&&A>=R.iw&&R.Ky+R.Sx>g.Tb&&A<R.iw+R.Tx){if(D=g.getCell(R.Ky,A).text()+"",n=!0,i=R.filterButtonVisible(),r)for(a=0;a<r.length;a++)if(r[a].col===A&&r[a].rowFilter.nM===R){et.IO(r[a],1,o,!0);break}}else if(r&&0<r.length&&(s=r[u=r.length-1].rowFilter&&r[u].rowFilter.nM))for(a=r.length-1;0<=a;a--)if(r[a].tableColumnHeaderFilter&&r[a].col===A){et.IO(r[a],3,s.Ky,!1);break}_=S.qt(T,A,h),V&&(u=S.Sl(T,A,h,1),g.isValid)&&!g.isValid(T,A,u)&&O.push({style:g.getDataValidator(T,A).highlightStyle(),x:I,y:x,width:N,height:k}),3===h&&(u=_.formatter,tt)&&u&&Ct(u)&&(!v||g.pivotTables&&g.pivotTables.findPivotTable(T,A))&&(c=g.parent&&g.parent.xO(u))&&(c=c.getExpression(),D=g.NO(u,c,T,A)),n&&(_.hAlign=0),t(D={data:D,row:T,col:A,x:I,y:x,width:N,sparkline:q&&g.getSparkline(T,A),height:k,style:_,colStyle:g.Z_(-1,A,h),cellLayout:C,tableFilter:i,columnHeaderFitMode:1===h&&g.Lt(A),offsetX:M.offsetX,sheetArea:h}),j.push(D),mt.W.ose(_)&&z.push({style:_,x:I,y:x,width:D.columnHeaderFitMode===vt.ColumnHeaderFitMode.stack?g.getColumnWidth(A,h):N,height:k,columnHeaderFitMode:D.columnHeaderFitMode,cornerY:D.cornerY,cornerX:D.cornerX}),C&&H.push(C),D.style&&4===D.style.hAlign&&($=!0),E.PN(T,A,I,x,N,k,_,C,T===Q&&K,A===J&&X,D)}},et=this,it=0;it<y;it++)nt(it);0<B.length&&m.vfe(z,B,w,v,g,h)}if(0<j.length){if(3===h&&(g.options.allowCellOverflow||$)&&(n=S.gl(f,l,function(){return new St(g,f,l)}),0<(a=m.kO(t,n,j,E,c)).length)){for(rt=d.x,ot=d.x+d.width,o=0;o<a.length;o++)(u=a[o])&&(at=u.row,ut=u.col,(st=u.cellOverflowLayout&&u.cellOverflowLayout.layout)&&((ct=st.x)<rt&&(rt=ct),ot<(ct=ct+st.width))&&(ot=ct),E.PN(at,ut,u.x,u.y,u.width,u.height,u.style,u.cellLayout,at===Q&&K,ut===J&&X,u));j=j.concat(a),v||(d.x=rt,d.width=ot-rt,i&&(d=d?i.getIntersectRect(d):i))}1===h&&b&&m.DO(j,r,E,d,v,i,Q,J,K,X),d&&(e=g.printInfo&&g.printInfo(),v&&e&&(0<e.columnStart()||0<e.rowStart())&&!e.showBorder()?t.rect(d.x-(0<e.columnStart()?2:0),d.y-(0<e.rowStart()?2:0),wt(d)+(0<e.columnStart()?4:0),yt(d)+(0<e.rowStart()?4:0)):t.rect(d.x,d.y,wt(d),yt(d)),t.clip()),m.eO(t,j,h,v,c)}lt.Worksheet.et(g,"paintViewport",{ctx:t,rowViewportIndex:f,colViewportIndex:l,sheetArea:h,clipRect:d,isPrinting:v}),E.paint(t),0<Y.length&&m._O(t,Y,1,3),0<O.length&&(s=i.getIntersectRect(d),t.rect(s.x,s.y,wt(s),yt(s)),t.clip(),m.EO(t,O)),0<z.length&&(s=i?i.getIntersectRect(d):d,t.rect(s.x,s.y,wt(s),yt(s)),t.clip(),m.ase(t,z,{isPrinting:v,printZoomFactor:c,sheet:g})),t.restore()}},r.prototype.IO=function(t,n,e,i){t.sheetArea=n,t.row=e,t.tableColumnHeaderFilter=i},r.prototype.SO=function(t,n,e,i){if(n.tables&&1===t&&0===n.frozenRowCount()){var t=n.tables.find(e,i);if(t&&t.jO&&t.Ky<n.Tb)return t}return null},r.prototype.TO=function(t,n,e,i){var r,o,a,u,s,c,f,l,h,n,d,v,m,n,r,d,v,r=t.row,o=t.col,a=t.x,u=t.y,s=t.width,c=t.height,f=this.Mf,l=f.Fi();return 1!==n||3!==i&&2!==i||(h=l.B1(n),n=f.frozenRowCount(),d=f.getRowCount(i)-f.frozenTrailingRowCount()-1,u<(v=h.y)&&n<=r&&r<=d&&(c-=v-u,u=v),v+(m=h.height)<u+c&&n<=r+t.rowCount-1&&r+t.rowCount-1<=d&&(c-=u+c-(v+m))),1!==e||3!==i&&1!==i||(h=l.L1(e),n=f.frozenColumnCount(),r=f.getColumnCount(i)-f.frozenTrailingColumnCount()-1,a<(d=h.x)&&n<=o&&o<=r&&(s-=d-a,a=d),d+(v=h.width)<a+s&&n<=o+t.colCount-1&&o+t.colCount-1<=r&&(s-=a+s-(d+v))),new q.Rect(a,u,s,c)},r.prototype._O=function(t,n,e,i){var r,o,a,u,s,c,f,a,l,h,d,v,m,g,p,b;if(0!==n.length)for(r=0,o=n.length;r<o;r++)u=(a=n[r]).x1,s=a.y1,c=a.x2,f=a.y2,a=a.horizontal,t.beginPath(),t.save(),t.lineWidth=e,t.strokeStyle=this.OO(t,a,u,s,c,f),t.fillStyle=this.RO(t,a,u,s,c,f),a?(d=-(h=1),v=-2,t.fillRect(u,s+(l=-3),c-u-1,i+2*e),f+=.5,t.moveTo(u+-1,(s+=.5)+-3),t.lineTo(c+-2,f+-3),t.moveTo(u+-1,s+1),t.lineTo(c+-2,f+1)):(b=-(g=1),t.fillRect(u+(m=-3),s+(p=0),i+2*e,f-s-1),c+=.5,t.moveTo((u+=.5)+-3,s+0),t.lineTo(c+-3,f+-1),t.moveTo(u+1,s+0),t.lineTo(c+1,f+-1)),t.stroke(),t.restore()},r.prototype.RO=function(t,n,e,i,r,o){var a,u,s,c,s,f,l,h,d,u,s=q.I.He(0,"gc-"+(n?v:m)+"-normal"),c=s&&s.backgroundColor,s=s&&s.backgroundImage;if(!n&&s&&-1!==s.indexOf("linear-gradient"))for(f=q.mt.ri(s),a=t.createLinearGradient(e,i,r,o),l=0,h=f.length;l<h;l++)d=f[l],a.addColorStop(d.point,d.color);else c&&(a=c);return a},r.prototype.OO=function(t,n,e,i,r,o){var t,a,e,t=t.createLinearGradient(e,i,r,o),a,e=q.I.He(0,"gc-"+(n?v:m)+"-normal");return n?(t.addColorStop(0,e.borderTopColor),t.addColorStop(1,e.borderBottomColor)):(t.addColorStop(0,e.borderLeftColor),t.addColorStop(1,e.borderRightColor)),t},r.prototype.ase=function(t,n,e){for(var i,r,o,a,u,s,c,f,l,h,o,i=n.length,r=0;r<i;r++)a=(o=n[r]).x,u=o.y,s=o.width,c=o.height,f=o.style,l=o.columnHeaderFitMode,h=o.cornerY,o=o.cornerX,e.columnHeaderFitMode=l,e.cornerY=h,e.cornerX=o,(0,d.paintStyleDecorationOutSideIcons)(t,new q.Rect(a,u,s,c),f.decoration.icons,f.vAlign,e)},r.prototype.EO=function(t,n){var e,i,r,o,a,u,s,c,f,l,u,h,e,i,r=this.Mf.BO();if(n)for(o=n.length,a=0;a<o;a++)s=(u=n[a]).x,c=u.y,f=u.width,l=u.height,0===(h=(u=u.style).type)&&this.LO(t,s,c,f,l,u),1===h&&this.FO(t,s,c,f,l,u),2===h&&this.PO(t,s,c,f,l,u,r)},r.prototype.LO=function(t,n,e,i,r,o){var o,n,e,i,r,a,u,a,s,c,i,r,o=o.color,n=n-4,e=e-4,i=i+8,r=r+8,a=.5522848,u=i/2*a,a=r/2*a,s=n+i,c=e+r,i=n+i/2,r=e+r/2;t.save(),t.lineWidth=2,t.strokeStyle=o,t.beginPath(),t.moveTo(n,r),t.bezierCurveTo(n,r-a,i-u,e,i,e),t.bezierCurveTo(i+u,e,s,r-a,s,r),t.bezierCurveTo(s,r+a,i+u,c,i,c),t.bezierCurveTo(i-u,c,n,r+a,n,r),t.closePath(),t.stroke(),t.restore()},r.prototype.FO=function(t,n,e,i,r,o){var a,u,s,c,f,l,h,d,o;n-=.5,e-=.5,h=Math.min(i/2,r/2),d=o.color,o=o.position,t.save(),t.lineWidth=2,t.strokeStyle=d,t.beginPath(),t.rect(n,e,i,r),t.stroke(),t.restore(),t.save(),t.beginPath(),0===o?(s=a=n,c=(u=e)+h,f=a+h,l=u):2===o?(c=(u=e+r)-h,f=(s=a=n+i)-h,l=u):3===o?(s=a=n,c=(u=e+r)-h,f=a+h,l=u):1===o&&(c=(u=e)+h,f=(s=a=n+i)-h,l=u),t.moveTo(a,u),t.lineTo(s,c),t.lineTo(f,l),t.fillStyle=d,t.fill(),t.closePath(),t.restore()},r.prototype.PO=function(t,n,e,i,r,o,a){var u,s,c,f,l,h,d,v,m,o,g;if(n-=.5,e-=.5,s=(u=this.Mf).zoom(),h=l=15,d=o.image,v=o.position,m=3,o=o.color,t.save(),t.beginPath(),t.lineWidth=2,t.strokeStyle=o,t.rect(n,e,i,r),t.stroke(),d&&"none"!==d&&a){4===v?c=n-18:5===v&&(c=n+i+3);try{a.jt(d)?(g=a.Ot(d),f=e+r/2-7.5,t.drawImage(g,c,f,15,15)):a.Rt(d)}catch(t){}}else 4===v?c=n-18*s:5===v&&(c=n+i+3*s),t.translate(c,f=e+r/2-15*s/2),t.scale(.015*s,.015*s),t.beginPath(),t.moveTo(512,0),t.bezierCurveTo(229.248,0,0,229.184,0,512),t.bezierCurveTo(0,794.816,229.248,1024,512,1024),t.bezierCurveTo(794.752,1024,1024,794.752,1024,512),t.bezierCurveTo(1024,229.24800000000005,794.752,0,512,0),t.closePath(),t.moveTo(783.488,692.992),t.lineTo(692.9920000000001,783.4879999999999),t.lineTo(512,602.496),t.lineTo(331.00800000000004,783.4879999999999),t.lineTo(240.51200000000006,692.992),t.lineTo(421.504,512),t.lineTo(240.512,330.944),t.lineTo(331.008,240.44800000000004),t.lineTo(512,421.44),t.lineTo(692.992,240.384),t.lineTo(783.4879999999999,330.88),t.lineTo(602.496,512),t.lineTo(783.488,692.992),t.closePath(),t.fillStyle=o,t.fill(),t.stroke();t.restore()},r.prototype.eO=function(t,n,e,i,r,B,o,a,u){var s,c,f,l,h,u,L,F,d,P,G,v,m,g,p,b,y,w,M,C,S,T,A,I,x,U,N,H,z,V,k,Y,D,_,D,Z,E,W,j,O,R,R,N,Q,J,K,X;for(void 0===o&&(o=0),void 0===a&&(a=0),void 0===u&&(u=1),c=(s=this).Mf,f=3===e,l=(B||c).zoom()*u,h=nt(s.Nn(),l),u=c.getDefaultStyle(e),L=c.$f(e),F=s.Mf.conditionalFormats,d=ot(c),P=c.k9(2),G=c.N9(1),v=(B||c).BO(),t.save(),t.beginPath(),t.fillStyle=u&&u.foreColor||it,tt(t,h.font),t.textAlign=f?"right":"center",p=n.length,E=[],j={sheet:c,row:-1,col:-1,fontInfo:et,lineHeight:-1,imageLoader:v,conditionalFormats:F,sheetArea:e,parentBackColor:d},O=[],m=0;m<p;m++)w=(b=n[m]).data,U=b.tableFilter,M=b.row,C=b.col,S=b.x,T=b.y,A=wt(b),I=yt(b),1!==e||O[M]||(O[M]=c.getRowHeight(M,e)),x=b.style,k=b.cellOverflowLayout,N=b.columnHeaderFitMode,H=b.cornerX,z=b.cornerY,Z=b.offsetX,V=b.colStyle,_=x.font?nt(x.font,l):h,i&&typeof r===rt&&1!==r&&(_=nt(_.font,r)),x.font=_.font,0<A&&0<I&&(y=x.cellType||L,S--,T--,A++,I++,f?j.sparkline=b.sparkline:(D=i?0:s.GO(M,C,e),j.visualState=D),D=$(_.font),j.lineHeight=D,j.row=M+o,j.col=C+a,j.fontInfo=_,j.cellOverflowLayout=k,R=O.length&&I!==O[M]+1,j.needTopGridline=1===e&&M===G||0===e||R,j.needLeftGridline=2===e&&C===P||0===e||R,j.isPrinting=i,j.printZoomFactor=r,j.columnHeaderFitMode=N,j.cornerX=H,j.cornerY=z,j.offsetX=Z,j.colStyle=V,y._e(t,w,S,T,A,I,x,j,U),k)&&!j.showBarIconOnly&&(R=new q.Rect(S,T,A,I),N=y.In?y.In(t,R,x,j):R,E.push({cellType:y,data:w,x:N.x,y:N.y,width:N.width,height:N.height,style:x,richText:Y,options:{sheet:c,row:M,col:C,fontInfo:_,lineHeight:D,cellOverflowLayout:k,parentBackColor:d,imageLoader:v}}));if(0<(p=E.length))for(Q=c.isEditing(),J=c.ui,K=c.ci,g=0;g<p;g++)w=(W=E[g]).data,j=W.options,Q&&j.row===J&&j.col===K||(X=gt(this.Mf))&&w&&"SparklineExValue"===w.typeName||s.UO(t,W);for(t.restore(),p=n.length,m=0;m<p;m++)b=n[m],lt.Worksheet.et(c,"paintCell",{ctx:t,sheetArea:e,cell:b,isPrinting:i})},r.prototype.UO=function(t,n){var e,i,r,o,a,u,s,n,c,c,c,e=n.cellType,i=n.data,r=n.x,o=n.y,a=wt(n),u=yt(n),s=n.style,n=n.options,c=n.cellOverflowLayout;c&&e.pn&&(c=c.layout,c=new q.Rect(c?c.x:r,c?c.y:o,c?c.width:a,c?c.height:u),e.pn(t,c,n,i)),e.paintValue&&e.paintValue(t,i,r,o,a,u,s,n)},r.prototype.GO=function(t,n,e){var i,r,i=this.Mf,r=0;return J(i)&&(3===e||pt(e)?!i.isEditing()&&i.HO(t,n)?r=3:i.ni(t,n,e)&&(r=2):(i.ni(t,n,e)&&(r=1,i.ei(t,n,e))&&(r=2),i.zO(t,n,e)&&(r=4))),r},r.prototype.kO=function(g,p,b,y,w){for(var M,C,t,S,T,A,I,x,N,k,D,_,E,j,O,R,B,L,F,P,G,U,n,e,i,M=this.Mf,C=M.Jt,t=b.length,x=[],G={},U=[],n=function(t){var n,e,i,r,o,a,u,s,c,f,l,h,d,v,m;if(S=b[t],I=S.row,N=S.col,k=S.y,_=yt(S),B=p.b7(I,g,w),L=B.headingOverflowLayouts,F=B.trailingOverflowLayouts,!G[I]){for(n={},e=0,i=B;e<i.length;e++)r=i[e],n[r.column]=!1;L&&L.forEach(function(t){n[t.column]=!1}),F&&F.forEach(function(t){n[t.column]=!1}),G[I]=n}for(o=G[I],P=B.find(N),a=0;a<P.length;a++)if(u=P[a]){if(s=M.getCellRect(I,u.column,et,et,!0),!o[u.column]){if(c=u.column,(A=C.qt(I,c)).showEllipsis)continue;T=C.$t(I,c,3,1,A),D=u.columnWidth,E=u.backgroundWidth,j=u.backgroundLeftWidth<0?s.x:u.backgroundRightWidth<0?s.x+wt(s)-E:4===A.hAlign?s.x+u.expandedWidth/2-u.backgroundLeftWidth:s.x+wt(s)/2-u.backgroundLeftWidth,R={data:T,row:I,col:c,x:s.x,y:k,width:D,height:_,cellOverflowLayout:u,style:A},x.push(R),u.layout=new q.Rect(j,k,E,_),A=C.qt(I,c),y.EN(I,c,u,A,s.x,k,D,_),o[u.column]=!0}u.column===N&&o[u.column]&&U.push(t)}if(L)for(f=0;f<L.length;f++)(l=L[f])&&!o[l.column]&&l.contains(S.col)&&(N=l.column,(A=C.qt(I,N)).showEllipsis||(T=C.$t(I,N,3,1,A),D=l.columnWidth,E=l.backgroundWidth,h=M.getCellRect(I,l.endColumn,et,et,!0),j=h.x+wt(h)-E,R={data:T,row:I,col:N,x:j,y:k,width:D,height:_,style:A,cellOverflowLayout:l},x.push(R),l.layout=new q.Rect(j,k,E,_),o[l.column]=!0,y.EN(I,N,l,A,j,k,D,_)));if(F)for(d=0;d<F.length;d++)(v=F[d])&&!o[v.column]&&v.contains(S.col)&&(N=v.column,(A=C.qt(I,N)).showEllipsis||(T=C.$t(I,N,3,1,A),D=v.columnWidth,E=v.backgroundWidth,m=M.getCellRect(I,v.startColumn,et,et,!0),j=m.x,O=m.x+E-D,R={data:T,row:I,col:N,x:O,y:k,width:D,height:_,style:A,cellOverflowLayout:v},x.push(R),v.layout=new q.Rect(j,k,E,_),y.EN(I,N,v,A,j,k,D,_),o[v.column]=!0))},e=0;e<t;e++)n(e);if(0<U.length)for(i=U.length-1;0<=i;i--)b.splice(U[i],1);function r(t,n){var e,i,t,n,e=t.row,i=n.row,t=t.col,n=n.col;return e!==i?e-i:t!==n?t-n:void 0}return 0<x.length&&x.sort(r),x},r.prototype.DO=function(t,n,e,i,r,o,a,u,s,c){for(var f,l,h,d,v,m,g,p,b,y,w,M,C,S,S,f=this,l=[],h=f.VO(t[0].col,t[0].x),d=[],v=0;v<h.length;v++)d.push(h[v]);for(v=0;v<n.length;v++)d.push(n[v]);for(e.Vx=d,m=[],g=e.Vx.length,b=0;b<g;b++)0<(p=e.Vx[b]).width&&m.push(p.col);if(m.push(m[m.length-1]+1),e.CN=m,0<(l=f.YO(h,t)).length){for(y=i.x,w=i.x+i.width,v=l.length-1;0<=v;v--)(M=l[v])&&((C=M.overflowLayout)&&((S=C.x)<y&&(y=S),w<(S=S+C.width))&&(w=S),t.unshift(M),e.PN(M.row,M.col,M.x,M.y,M.width,M.height,M.style,T,M.row===a&&s,M.col===u&&c,M));r||(i.width=w-y,o&&i&&o.getIntersectRect(i))}},r.prototype.VO=function(t,n){for(var e,i,r,o,a,u,s,c,f,l,h,d,v,m,g,p,b,y,w,e=new ht.h9,i,r=this.Mf,o=r.Jt,a=r.Ut,u=t,s=[],c=[],f=[],l=[],d=u,m=n,g=r.getColumnCount()-r.frozenTrailingColumnCount(),p=r.frozenColumnCount()-1,b=u-1;p<b;b--)if(s[b]=h=o.Kt(b),h){if(c[b]=a.getColumnHeaderFitMode(!1,vt.SheetArea.colHeader,b),f[b]=a.eE(-1,b,-1,1,vt.SheetArea.colHeader),l[b]=r.ZO(b,m,g,d,s,c,f,l),c[b]===vt.ColumnHeaderFitMode.normal)break;d=b,m-=h}for(y=d;y<u;y++)s[y]||(s[y]=o.Kt(y)),pt(c[y])&&(c[y]=a.getColumnHeaderFitMode(!1,vt.SheetArea.colHeader,y)),v=s[y],w=r.ZO(y,m,g,d,s,c,f,l),e.push(l[y]=w),m+=v;return e},r.prototype.YO=function(r,o){for(var t,a,u,s,e,c,f,l,h,d,v,m,g,p,b,v,n,y,i,w,t,a=this.Mf,u=a.Ut,s=a.Jt,e=a._y(1,1),f=[],n=e.length,y=r.length,i=function(i){var t,n;for(c=e[i],t=function(t){var n,e,n,t,n,n=r[t];if(n){if(l=c.row,h=n.col,p=n.x,b=-1===n.y?c.y:bt(n.y*c.height+c.y),m=wt(n),g=-1===yt(n)?yt(c):c.height+c.y-b,v=s.$t(l,h,1,1,d),d=s.qt(l,h,1),v={data:v,row:l,col:h,x:p,y:b,width:m,height:g,style:d,overflowLayout:n,columnHeaderFitMode:u.getColumnHeaderFitMode(!1,vt.SheetArea.colHeader,h),SheetArea:1},d.showEllipsis&&v.columnHeaderFitMode!==vt.ColumnHeaderFitMode.stack)return"continue";v.columnHeaderFitMode===vt.ColumnHeaderFitMode.stack&&(t===y-1?(e=o[0].col,n=o.filter(function(t){return t.row===i&&t.col===e})[0],v.cornerX=n&&n.x,v.cornerY=n&&n.y):(t=a.O5(h,1,!0))&&(n=r.findCol(t))&&-1!==n.y&&(v.cornerX=n.x,v.cornerY=bt(n.y*c.height)+c.y)),f.push(v)}},n=0;n<y;n++)t(n)},w=0;w<n;w++)i(w);return f},A=r,t.g7=A,u=".cutCopyIndicator",I=q.Events.CellChanged,x=q.Events.ClipboardChanged,_=q.Events.ValueChanged,O=q.Events.ColumnChanged,R=q.Events.RowChanged,B=q.Events.RangeChanged,L=q.Events.ClipboardPasting,F=q.Events.ClipboardPasted,P=q.Events.DragMerging,G=q.Events.FloatingElementSelected,o.prototype._T=function(t){var n=this;if(0===arguments.length)return n.d7;n.d7=t},o.prototype.WO=function(t,n){var e,i,e=this;if(0===arguments.length)return e.h7;(e.h7!==t||t||n)&&(e.h7=t,i=e.Mf)&&(i.zw(),pt(e.QO)||clearTimeout(e.QO),e.QO=setTimeout(function(){var t;e.h7||(t=i.ST())&&t.c5(n),e.QO=et}))},o.prototype.v7=function(){var c,e,f,i,r;function o(){c.h7&&c.WO(!1)}function a(t,n,e){t||n===i||n===e||n===r||o()}e=(c=this).Mf,f=!1,i="resizable",r="isVisible",e.D3(x+u,function(){c.WO(!0)}),e.D3(_+u,o),e.D3(I+u,function(t,n){n.isUndo||"tag"===n.propertyName||n.KO||o()}),e.D3(O+u,function(t,n){a(n.isUndo,n.propertyName,"width")}),e.D3(R+u,function(t,n){a(n.isUndo,n.propertyName,"height")}),e.D3(B+u,function(t,n){n.isUndo||6===n.action||3===n.action||o()}),e.D3(L+u,function(){f=c.WO()}),e.D3(F+u,function(t,n){var e,n,i,r,o,a,u,s,e=n.cellRange,n=n.sheet.ST(),i=n._S,r=f;if(e&&i&&n.DS){if(c._T()){for(a=0,u=i;a<u.length;a++)if((s=u[a]).intersect(e.row,e.col,e.rowCount,e.colCount)&&!s.equals(e)){r=!1;break}}else o=!(r=!1);c.WO(r,o)}}),e.D3(P+u,o),e.D3(G+u,function(t,n){"worksheet"!==n.type&&(e.endEdit(),q.hi.N1(e))})},o.prototype.oO=function(t,n,e,i){var r,r,o,a,a,u,s,c,f,a,c,l,h,d,r=this;if(r.h7&&(o=(r=r.Mf).Dn,a=(a=r.parent)?a.options:{},s=(u=r.ST())._S,c=a.cutCopyIndicatorVisible,pt(c)&&(c=!0),f=q.Pf.vl(r,a.cutCopyIndicatorBorderColor||"blue"),c)&&u.DS===r&&s&&(a=o.uO(e,i,et),c=o.fO(e,i,s,n))&&a){for(t.save(),t.rect(a.x,a.y,wt(a),yt(a)),t.clip(),l=0,h=c;l<h.length;l++)d=h[l],o.wO(t,d,f);t.beginPath(),t.restore()}},o.prototype.JO=function(){this.WO(!1)},o.prototype.XO=function(){this.WO(!1)},o.prototype.qO=function(){this.WO(!1)},o.prototype.$O=function(){this.WO(!1)},o.prototype.lI=function(){this.WO(!1)},o.prototype.L0=function(){var t=this.Mf;t._3(I+u),t._3(x+u),t._3(_+u),t._3(O+u),t._3(R+u),t._3(B+u),t._3(L+u),t._3(F+u),t._3(P+u),t._3(G+u)},U=o,t.m7=U,lt.Worksheet.ch("render",{init:function(){var t=this;t.Dn=new A(t),t.lA&&t.lA.L0(),t.lA=new U(t)},dispose:function(t){var n,t,n=this;!1!==t.clearCache&&(n.Dn&&(n.Dn.Mf=et,n.Dn=et),t=n.lA)&&(t.L0(),n.lA=et)},onLayoutChanged:function(t){var n,e,t,n,e=this.lA;e&&("addRows"===(t=t.changeType)?e.JO():"deleteRows"===t?e.XO():"addColumns"===t?e.qO():"deleteColumns"===t&&e.$O())}})},"./dist/core/worksheet/worksheet-selection.js":function(t,n,e){"use strict";var i,w,n,r,o,d,p,M,C,S,a;function T(t,n){return t.getColumnCount(n)}function A(t,n){return t.getRowCount(n)}function I(t){return t.rowCount}function x(t){return t.colCount}function f(t,n,e){for(var i,r,o,a,i=[],r=t.length,a=0;a<r;a++)o=t[a],a===n?i=i.concat(e):i.push(o);return i}function N(t,n,e){for(var i=e-1;0<=i;i--)if(t.getColumnVisible(n+i))return n+i;return n+e-1}function k(t,n,e){for(var i=e-1;0<=i;i--)if(t.getRowVisible(n+i))return n+i;return n+e-1}Object.defineProperty(n,"__esModule",{value:!0}),i=e("./dist/core/worksheet/worksheet.js"),w=e("./dist/core/util/common.js"),n=e("Common"),r=e("./dist/core/util/domUtil.js"),o=e("./dist/core/core.enum.js"),d=n.Common.lt.ht,p=n.Common.Uf.tR,M=null,C=Math.max,S=Math.min,a="gc-selection",r.GC$.extend(i.Worksheet.prototype,{addSelection:function(t,n,e,i){this.n4(t,n,e,i,!1)},n4:function(t,n,e,i,r){var o,a,u,s,c,f,f,o=this,a=t,u=n,s=e,c=i;-1!==a&&-1!==u&&(f=o.Ut.getSpans())&&0<p(f)&&(a=(f=o.nR(f,(0,w.Ec)(t,n,e,i))).row,u=f.col,s=I(f),c=x(f)),o.Ut.do("addSelection",a,u,s,c,r),o.zw()},setSelection:function(t,n,e,i){this.eR(t,n,e,i,2)},eR:function(t,n,e,i,r){var o,a,u,u,a,r,o=this,a=A(o),u=T(o);u<=n&&(n=u-1),u=C(0,t=a<=t?a-1:t),a=C(0,n),o.IA(),r=2===r?w.hi.A1(o):1===r,o.O6(u,a,o.C0(u),o.S0(a),!r),o.n4(t,n,e,i)},getSelections:function(){return this.Ut.getSelections()},clearSelection:function(t){var n,t;void 0===t&&(t=1),(n=this).IA(),t=2===t?w.hi.A1(n):1===t,n.O6(0,0,n.C0(0),n.S0(0),!t),i.Worksheet.et(n,"clearSelection"),n.zw()},IA:function(t){this.Ut.do("clearSelection",t)},JA:function(t,n,e){var i,r,o,a,o,u,r,o,s,c,f,l,h,d,v,i=this,r=i.options,o=r.protectionOptions,a=!1!==o.allowSelectLockedCells,o=!1!==o.allowSelectUnlockedCells;if(!r.isProtected||a&&o)return!0;if(!a&&!o)return!1;if(r=n<0,o=t<0,a===(u=e?e.locked:i.l0(t,n,"locked"))&&(o||r)){for(s=o?A(i):1,t=o?0:t,c=r?T(i):1,f=i.Ut,l=t+s-1,h=(n=r?0:n)+c-1,v=d=void 0,d=t;d<=l;d++)for(v=n;v<=h;v++)if((e=f.getStyle(d,v))&&a!==e.locked)return!1;if(o)for(d=t;d<=l;d++)if((e=f.getStyle(d,-1))&&a!==e.locked)return!1;if(r)for(v=n;v<=h;v++)if((e=f.getStyle(-1,v))&&a!==e.locked)return!1}return a===u},iR:function(t,n,e,i){var r,o,a,r=this;for(n=n<0?0:n,o=t=t<0?0:t;o<t+e;o++)for(a=n;a<n+i;a++)if(r.l0(o,a,"locked"))return!0},rR:function(){for(var t,n,t=this.getSelections(),n=0;n<t.length;n++)if(-1!==t[n].col)return!1;return!0},oR:function(){for(var t,n,t=this.getSelections(),n=0;n<t.length;n++)if(-1!==t[n].row)return!1;return!0},selectionPolicy:function(t){var n=this,e=n.Ut;return 0===arguments.length?e.getSelectionPolicy():(e.do("setSelectionPolicy",t),n)},selectionUnit:function(t){var n=this,e=n.Ut;return 0===arguments.length?e.getSelectionUnit():(e.do("setSelectionUnit",t),n)},getSelectionBackColor:function(){return this.options.selectionBackColor||w.I.fl(a).backgroundColor},getSelectionBorderColor:function(){return this.options.selectionBorderColor||w.I.fl(a).borderTopColor},aR:function(t){if(!t)return this.options.aR;this.options.aR=t},e4:function(){var t,n,n,e,t=this,n=t.Ut.getSelections();0<p(n)&&(n={selections:n},0!==(e=t.Ut.getActiveSelectedRangeIndex())&&(n.activeSelectedRangeIndex=e),t.uR=n,t.IA(),t.Dn.E1())},cR:function(){var t=this,n=t.uR,e=n&&n.selections;e&&(t.Ut.do("setSelections",e),t.Ut.do("setActiveSelectedRangeIndex",n.activeSelectedRangeIndex||0))},pA:function(t,n,e,i){var r,o,a,i,a,t,r=this,a=r.tables,o=(e||i)&&(o=a&&a.fR(t,n))||r.lR(t,n,e,r.hR||0);o&&(i=o.row,a=o.col,t=o.leadingCellCol,r.dR(i,a))&&(r.qA=i,r.hR=t,r.XA(i,a))},lR:function(t,n,e,i){var r,o,a,u,s,c,r=this,o=A(r),a=T(r),u=t;return 0===u&&!e||0===o||0===a||(c=r.vR(u,i),e||r.mR(c),u=c.r,s=c.c,u<0&&e&&(i=s=(s=r.r6(s))<0||d(s)?r.r6(a):s,u=(c=r.vR(o,s)).r,(s=c.c)===n)&&u<=t)?M:{row:u,col:s,leadingCellCol:i}},bA:function(t,n,e){var i,e,t,n,e,i=this,e=i.gR(t,n,e,i.hR||0);!e||e.row===t&&e.col===n||(t=e.row,n=e.col,e=e.leadingCellCol,i.dR(t,n)&&(i.qA=t,i.hR=e,i.XA(t,n)))},gR:function(t,n,e,i){var r,o,a,u,s,c,r=this,o=A(r),a=T(r),u=t;if((u!==o-1||e)&&0!==o&&0!==a&&(c=r.pR(u,i),e||r.mR(c),u=c.r,s=c.c,!(u===o&&e&&(i=s=a<=(s=r.O5(s))||d(s)?r.O5(-1):s,u=(c=r.pR(-1,s)).r,(s=c.c)===n)&&t<=u)))return{row:u,col:s,leadingCellCol:i}},wA:function(){var t,n,e,n,t=this,n=t.bR();n&&(e=n.row,n=n.col,t.qA=e,t.hR=n,t.XA(e,n))},bR:function(){var t,n,e,i,r,o,a,o,u,t=this,n=t.P6(),e=t.G6(),i=e;if(n||i){if(a=!1!==(o=(r=t.options).protectionOptions).allowSelectLockedCells,o=!1!==o.allowSelectUnlockedCells,!r.isProtected||a&&o)return{row:n,col:i};if(a||o)for(;n!==M&&0<=n;n=t.nI(n))for(i=e;i!==M&&0<=i;i=t.r6(i))if(a===(u=t.l0(n,i,"locked")))return{row:n,col:i}}return M},yA:function(){var t,n,e,n,t=this,n=t.yR();n&&(e=n.row,n=n.col,t.qA=e,t.hR=n,t.XA(e,n))},yR:function(){var t,n,e,i,r,o,a,u,s,u,c,t=this,n=t.j5(t.frozenRowCount()-1),e=t.O5(t.frozenColumnCount()-1),i=e,r=t.P6(),o=t.G6();if(n!==M&&i!==M){if(s=!1!==(u=(a=t.options).protectionOptions).allowSelectLockedCells,u=!1!==u.allowSelectUnlockedCells,!a.isProtected||s&&u)return{row:n,col:i};if(s||u)for(;n!==M&&n<=r;n=t.j5(n))for(i=e;i!==M&&i<=o;i=t.O5(i))if(s===(c=t.l0(n,i,"locked")))return{row:n,col:i}}return M},mA:function(t,n,e){var i,r,o,o,t,n,i=this,o=i.tables,r=e&&(r=o&&o.wR(t,n))||i.sI(t,n,e,i.qA||0);r&&(o=r.row,t=r.col,n=r.leadingCellRow,i.dR(o,t))&&(i.qA=n,i.hR=t,i.XA(o,t))},sI:function(t,n,e,i){var r,o,a,u,s,c,f,r=this,o=A(r),a=T(r),s=n;if(0===s&&!e||0===o||0===a)return M;for(c=r.MR(i,s),f=i,e||r.mR(c),u=c.r,s=c.c;s<0&&e;){if(i=u=(u=r.nI(u,3,!0))<0||d(u)?r.nI(o,3,!0):u,u=(c=r.MR(i,a)).r,s=c.c,u===t&&s<n)return M;if(u===t&&s===n){if(i===f)return M;u=(c=r.MR(i,s)).r,s=c.c}}return{row:u,col:s,leadingCellRow:i}},mR:function(t){var n,e,e,n=this,e=!1;t.r<0?t.r=n.N9():t.r>=A(n)&&(t.r=n.P6(),e=!0),t.c<0?t.c=n.k9():t.c>=T(n)&&(t.c=n.G6(),e=!0),e&&((e=n.Ut.getSpan(t.r,t.c)).row!==t.r&&(t.r=e.row),e.col!==t.c)&&(t.c=e.col)},CA:function(t,n){for(var e,i,r,o,a,u,s,c,f,l,h,h,e=this,i=e.Ut,r=i.getActiveSelectedRangeIndex(),o=-1,a=e.JS(e.U5()),u=a.row,s=a.col,c=a.col+x(a)-1,f=t,l=n;f=(h=e.CR(f,l)).r,!(s<=(l=h.c));){if(o===r&&f===t&&l<=n)return;l=u<=--f?c+1:(h=e.JS(e.U5(3)),o=i.getActiveSelectedRangeIndex(),u=h.row,s=h.col,c=h.col+x(h)-1,f=h.row+I(h)-1,h.col+x(h))}0<=f&&(e.XA(f,l),e.qA=f,e.hR=l)},SA:function(t,n){for(var e,i,r,o,a,u,s,c,f,l,h,h,e=this,i=e.Ut,r=i.getActiveSelectedRangeIndex(),o=-1,a=e.JS(e.U5()),u=a.col,s=a.row+I(a)-1,c=a.col+x(a)-1,f=t,l=n;f=(h=e.TR(f,l)).r,!((l=h.c)<=c);){if(o===r&&f===t&&n<=l)return;l=++f<=s?u-1:(h=e.JS(e.U5(4)),o=i.getActiveSelectedRangeIndex(),u=h.col,s=h.row+I(h)-1,c=h.col+x(h)-1,f=h.row,h.col-1)}0<=f&&(e.XA(f,l),e.qA=f,e.hR=l)},TA:function(t,n){for(var e,i,r,o,a,u,s,c,f,l,h,h,e=this,i=e.Ut,r=i.getActiveSelectedRangeIndex(),o=-1,a=e.JS(e.U5()),u=a.row,s=a.row+I(a)-1,c=a.col,f=t,l=n;f=(h=e.AR(f,l)).r,l=h.c,!(u<=f);){if(o===r&&l===n&&f<=t)return;c<=--l?f=s+1:(h=e.JS(e.U5(1)),o=i.getActiveSelectedRangeIndex(),u=h.row,s=h.row+I(h)-1,c=h.col,f=h.row+I(h),l=h.col+x(h)-1)}0<=l&&(e.XA(f,l),e.qA=f,e.hR=l)},AA:function(t,n){for(var e,i,r,o,a,u,s,c,f,l,h,h,e=this,i=e.Ut,r=i.getActiveSelectedRangeIndex(),o=-1,a=e.JS(e.U5()),u=a.row,s=a.row+I(a)-1,c=a.col+x(a)-1,f=t,l=n;f=(h=e.IR(f,l)).r,l=h.c,!(f<=s);){if(o===r&&l===n&&t<=f)return;++l<=c?f=u-1:(h=e.JS(e.U5(2)),o=i.getActiveSelectedRangeIndex(),s=h.row+I(h)-1,c=h.col+x(h)-1,f=h.row-1,l=h.col)}0<=l&&(e.XA(f,l),e.qA=f,e.hR=l)},gA:function(t,n,e){var i,r,o,o,e,t,i=this,o=i.tables,r=e&&(r=o&&o.xR(t,n))||i.uI(t,n,e,i.qA||0);!r||r.row===t&&r.col===n||(o=r.row,e=r.col,t=r.leadingCellRow,i.dR(o,e)&&(i.qA=t,i.hR=e,i.XA(o,e)))},uI:function(t,n,e,i){var r,o,a,u,s,c,f,r=this,o=A(r),a=T(r),s=n;if(s===a-1&&!e||0===o||0===a)return M;for(c=r.NR(i,s),f=i,e||r.mR(c),u=c.r,s=c.c;s===a&&e;){if(t===o-1&&t===u&&(!r.getRowVisible(u,3)||r.Gt(u,3)<=0))return M;if(i=u=o<=(u=r.j5(u,3,!0))||d(u)?r.j5(-1,3,!0):u,u=(c=r.NR(i,-1)).r,s=c.c,u===t&&n<s)return M;if(u===t&&s===n){if(i===f)return M;u=(c=r.NR(i,s)).r,s=c.c}}return{row:u,col:s,leadingCellRow:i}},MR:function(t,n){for(var e,i,r,o,o,e=this,r=n;0<=r&&(i=t,!(--r<0));)if(e.getColumnVisible(r)&&((o=e.Ut.getSpans((0,w.Ec)(i,r,1,1)))&&0<p(o)&&r>=(o=o[0]).col&&(r=o.col,i=o.row),e.dR(i,r)))return{r:i,c:r};return{r:i,c:r}},CR:function(t,n){for(var e,i,r,e=this;0<=n&&!(--n<0);){if(i=e.Ut.findSpan(t,n)){if(!((r=e.U5()).row<=i.row&&i.row+I(i)<=r.row+I(r)&&r.col<=i.col&&i.col+x(i)<=r.col+x(r)))continue;if(i.row!==t||i.col!==n)continue;n>=i.col&&(n=i.col,t=i.row)}if(e.dR(t,n))return{r:t,c:n}}return{r:t,c:n}},NR:function(t,n){for(var e,i,r,o,a,a,u,e=this,i=T(e),o=n;o<i&&!(i<=(o=(a=e.Ut.getSpan(r=t,o)).col+x(a)));)if(e.getColumnVisible(o)&&((a=e.Ut.getSpans((0,w.Ec)(r,o,1,1)))&&0<p(a)&&(o>(u=a[0]).col?o=C(o,u.col+x(u)):r=u.row),e.dR(r,o)))return{r:r,c:o};return{r:r,c:o}},TR:function(t,n){for(var e,i,r,o,o,a,e=this,i=e.Ut,r=T(e);n<r&&!(r<=(n=(o=i.getSpan(t,n)).col+x(o)));){if(o=i.findSpan(t,n)){if(!((a=e.U5()).row<=o.row&&o.row+I(o)<=a.row+I(a)&&a.col<=o.col&&o.col+x(o)<=a.col+x(a)))continue;if(o.row!==t||o.col!==n)continue;n>o.col?n=C(n,o.col+x(o)):t=o.row}if(e.dR(t,n))return{r:t,c:n}}return{r:t,c:n}},dR:function(t,n){var e,i,r,o,e=this;return!!e.JA(t,n)&&(i=0<=t&&t<A(e)&&0<=n&&n<T(e)&&e.getRowVisible(t)&&e.getColumnVisible(n)&&0<e.Gt(t)&&0<e.nn(n),r=!!e.F5,!0!==i||!0!=r||!1!==(o=e.l0(t,n,"tabStop")))&&i},vR:function(t,n){for(var e,i,i,e=this;0<=t&&!(--t<0);)if(e.getRowVisible(t)&&((i=e.Ut.getSpans((0,w.Ec)(t,n,1,1)))&&0<p(i)&&t>=(i=i[0]).row&&(t=i.row,n=i.col),e.dR(t,n)))return{r:t,c:n};return{r:t,c:n}},AR:function(t,n){for(var e,i,r,e=this;0<=t&&!(--t<0);){if(i=e.Ut.findSpan(t,n)){if(!((r=e.U5()).row<=i.row&&i.row+I(i)<=r.row+I(r)&&r.col<=i.col&&i.col+x(i)<=r.col+x(r)))continue;if(i.row!==t||i.col!==n)continue;t>=i.row&&(n=i.col,t=i.row)}if(e.dR(t,n))return{r:t,c:n}}return{r:t,c:n}},pR:function(t,n){for(var e,i,r,r,o,e=this,i=A(e);t<i&&!(i<=(t=(r=e.Ut.getSpan(t,n)).row+I(r)));)if(r=e.Ut.getSpans((0,w.Ec)(t,n,1,1)),e.getRowVisible(t)&&(r&&0<p(r)&&(t>(o=r[0]).row?t=C(t,o.row+I(o)):n=o.col),e.dR(t,n)))return{r:t,c:n};return{r:t,c:n}},IR:function(t,n){for(var e,i,r,o,o,a,e=this,i=e.Ut,r=A(e);t<r&&!(r<=(t=(o=i.getSpan(t,n)).row+I(o)));){if(o=i.findSpan(t,n)){if(!((a=e.U5()).row<=o.row&&o.row+I(o)<=a.row+I(a)&&a.col<=o.col&&o.col+x(o)<=a.col+x(a)))continue;if(o.col!==n||o.row!==t)continue;t>o.row?t=C(t,o.row+I(o)):n=o.col}if(e.dR(t,n))return{r:t,c:n}}return{r:t,c:n}},D9:function(t,n,e,i,r,o){var a=this;a.Ut.do("addSelection",t,n,e,i,M,o),r&&a.My<=0&&a.Dn.E1(M,M,M,M,o)},L9:function(t,n,e){var i,t,n,r,o,t,a,u,i=this,t=i.xA(t,n,i.ui,i.ci),n=t.row,r=t.col,o=I(t),t=x(t),a=i.selectionPolicy(),u=i.selectionUnit();0!==a&&(1===a&&i.Ut.do("clearSelection"),1===u?t=r=-1:2===u&&(o=n=-1),i.kA(n,r,o,t,e))},xA:function(t,n,e,i,r,o){var a,u,e,i,u,t,a=this;return d(e)&&(e=a.ui),d(i)&&(i=a.ci),e=(u=a.Ut).getSpan(e,i,o),i=u.getSpan(t,n,o),r&&e.equals(i)?new w.Range(e.row,e.col,1,1):(u=e.union(i),(t=a.Ut.getSpans(M,o))&&0<p(t)?a.kR(t,u):u)},kA:function(t,n,e,i,r){var o,a,u,s,c,f,c,f,a,o=this,a=o.Ut,u=o.U5();0<p(a.getSelections())?(c=(0,w.Ec)(t,n,e,i),o.O9?(s=o.z9,o.z9=c):((f=a.getSelections())[a.getActiveSelectedRangeIndex()]=c,a.do("setSelections",f))):o.O9||a.do("addSelection",t,n,e,i),r&&o.My<=0&&(c=o.U5(),!o.O9&&c.row===u.row&&c.col===u.col&&I(c)===I(u)&&x(c)===x(u)||(f=o.Dn,o.O9&&(a=o.z9,s&&s.containsRange(a)?a=s:s&&(a=s.union(a)),u=(a=a.union((0,w.Ec)(o.getActiveRowIndex(),o.getActiveColumnIndex(),1,1))).union(u),c=a.union(c)),u.containsRange(c)?f.E1(u):c.containsRange(u)?f.E1(c):(f.E1(u),f.E1(c),f.E1(o.z9))))},DR:function(t){var n=[];return n=t?this.Ut.getSpans(t):n},_R:function(t,n){var e=t.row,i=t.col,r=t.rowCount,o=t.colCount,a=n.row,u=n.col,s=n.rowCount,c=n.colCount,r=e+r,o=i+o,f=a+s,l=u+c,h=!1,d=!1,v;return t.intersect(a,u,s,c)&&(d=!(h=v=a<e||u<i||r<f||o<l)),n.ER=n.ER||d,h},jR:function(t,n,e,i){for(var r,o,a,r=[],o=[],a=0;a<t.length;a++)o=this.RR(t[a],n,e,i),r=r.concat(o);return r},RR:function(t,n,e,i){var r,o,a,u,a,s,c,r=[],o=n.length;for(r.push(t),s=o-1;0<=s;s--)for(u=n[s],c=0;c<r.length;)a=r[c],this._R(a,u)?(r=f(r,c,a=this.BR(a,u,e,i)),c+=a.length):c++;return r},LR:function(t,n){var e=n.row,i=n.col,r=n.rowCount,n=n.colCount;return t.intersect(e,i,r,n)},FR:function(t,n){for(var e,i,r,o,e,i=[],o=t.length-1;0<=o;o--)r=t[o],this.LR(r,n)||i.push(r);return i},PR:function(t){var n=!1,e=this.Ut.getSpans(t);return n=1===e.length?t.equals(e[0]):n},GR:function(t,n){for(var e,t,i,r,o,a,u,s,e=t,t=n.length,i=e.length,r=!0,u=t-1;0<=u;u--){for(a=n[u],s=i-1;0<=s;s--)if((o=e[s]).equals(a)){r=!1;break}r&&e.push(a)}return e},UR:function(t){for(var n,e,i,r,o,a,n,e=[],r=t.length-1;0<=r;r--)(i=t[r]).ER&&(delete i.ER,e.push(r));for(o=e.length,a=0;a<o;a++)t.splice(e[a],1)},BR:function(t,n,e,i){var r,n,e,i,o,a,u,s,c,f,o,l,h,n;return n=this.JS(n),r=[],n=t.getIntersect(n,e,i),t&&n?(e=0<=t.row?t.row:0,i=0<=t.col?t.col:0,o=t.rowCount,a=t.colCount,u=n.row,s=n.col,c=n.rowCount,l=i+a,n=s+(f=n.colCount),0<(o=e+o)-(h=u+c)&&r.push((0,w.Ec)(h,i,o-h,a)),0<l-n&&r.push((0,w.Ec)(u,n,c,l-n)),0<s-i&&r.push((0,w.Ec)(u,i,c,s-i)),0<u-e&&r.push((0,w.Ec)(e,i,u-e,a))):r.push(t),r},tD:function(t,n){var e,i,r,o,a,u,s,c,f,l,h,d,v,m,g,e=[],i=this.getRowCount(3),r=this.getColumnCount(3),o=this.deselectIgnoreSpan();if(t&&0<t.length){for(s=[],c=[],h=l=void 0,a=!(f=[]),d=(u=t.length)-1;0<=d;d--)l=t[d],o||!this.PR(l)||this.LR(l,n)?(s=this.BR(l,n,i,r),o||0<(h=this.DR(l)).length&&(s=this.jR(s,h,i,r),f=this.FR(h,n),c=this.GR(c,f),this.UR(c)),v=p(s),!a&&0<v&&(this.setSelection(s[v-1].row,s[v-1].col,1,1),a=!0),e=s.concat(e)):c=this.GR(c,[l]);o||(e=c.concat(e))}for(this.IA(),m=e.length,this.suspendPaint(),g=0;g<m;g++)this.n4(e[g].row,e[g].col,e[g].rowCount,e[g].colCount);a||this.setActiveCell(this.ui,this.ci),this.resumePaint()},HA:function(t,n){var e,i,r,r,t,n,o,r,a,u,a,e=this,i=e.Ut.getSelections();p(i)<=0||(r=e.U5(),(r=e.HR(r,t,n))&&(t=r.row,n=r.col,o=I(r),r=x(r),a=e.selectionPolicy(),u=e.selectionUnit(),0!==a)&&(1===a&&e.Ut.do("clearSelection"),1===u?r=n=-1:2===u&&(o=t=-1),e.kA(t,n,o,r,!0),a=e.Ut.getSelections(),e.rt._A(i,a))&&(e.EA(i,a),e.jA(i)))},HR:function(t,n,e,i,r){var o,a,u,o=this,a=o.JS(t),u=M;return 37===n?u=e?o.zR(a,!1,i,r):o.VR(a,i,r):39===n?u=e?o.YR(a,!1,i,r):o.ZR(a,i,r):38===n?u=e?o.WR(a,!1,i,r):o.QR(a,i,r):40===n?u=e?o.KR(a,!1,i,r):o.JR(a,i,r):36===n?u=e?o.XR(a,i,r):o.qR(a,i,r):35===n?u=e?o.$R(a,i,r):o.tB(a,i,r):33===n?u=o.nB(a,i,r):34===n&&(u=o.eB(a,i,r)),u&&(t.row<0&&(u.row=-1,u.rowCount=o.getRowCount()),t.col<0)&&(u.col=-1,u.colCount=o.getColumnCount()),u},VR:function(t,n,e){for(var i,r,o,a,u,s,c,f,l,h,d,v,l,m,g,p,b,y,i=this,r=t.row,o=t.col,a=I(t),u=x(t),s=o+u-1,c=0,f=k(i,r,a);0<s;)if(i.dR(f,--s)&&(l=i.xA(f,s,n,e),h=S(r,l.row),d=S(o,l.col),m=(v=C(r+a-1,l.row+I(l)-1))-h+1,g=(l=S(o+u-1,l.col+x(l)-1))-d+1,h!==r||d!==o||m!==a||g!==u))return p=i.Ab,o<(b=i.ci)?d<=p&&i.o9(d):o===b&&l<=p&&i.o9(l),(y=i.parent&&i.parent.options.scrollByPixel)&&d===p&&0!==i.my&&i.o9(d,0),(0,w.Ec)(h,d,m,g);return M},zR:function(t,n,e,i){var r,o,a,u,s,s,u,n,r,s,e,c,f,r=this,o=t.row,a=t.col,u=r.frozenColumnCount(),s=u?r.O5(u-1):r.k9(),s=n?s:r.k9();if(!d(s))return(u<=0||n)&&r.o9(s),u=r.xA(o,s,e,i),n=S(o,u.row),r=S(a,u.col),s=C(o+I(t)-1,u.row+I(u)-1),e=S(a+x(t)-1,u.col+x(u)-1),(0,w.Ec)(n,r,c=s-n+1,f=e-r+1)},iB:function(t){var n,e,i,r,o,i,a,n=this,e;if(n.parent&&n.parent.options.scrollByPixel){for(o=n.Jt,i=n.S0(t),a=n.getViewportWidth(i);0<=t&&!((a-=o.Kt(t))<0);t--);i=t,r=a}else i=n.rB(t,2).col,r=0;return{iw:i,Xy:r}},ZR:function(t,n,e){for(var i,r,o,a,u,s,c,f,l,h,d,v,l,m,g,p,b,y,i=this,r=t.row,o=t.col,a=I(t),u=x(t),s=o,c=T(i)-1,f=k(i,r,a);s<c;)if(i.dR(f,++s)&&(l=i.xA(f,s,n,e),h=S(r,l.row),d=C(o,l.col),m=(v=C(r+a-1,l.row+I(l)-1))-h+1,g=(l=C(o+u-1,l.col+x(l)-1))-d+1,h!==r||d!==o||m!==a||g!==u))return p=i.oB(),o<(b=i.ci)?p<=d&&(y=i.iB(d),i.o9(y.iw,y.Xy)):o===b&&p<=l&&(y=i.iB(l),i.o9(y.iw,y.Xy)),(0,w.Ec)(h,d,m,g);return M},YR:function(t,n,e,i){var r,o,a,u,u,n,r,u,e,i,s,c,r=this,o=t.row,a=t.col,u=r.aB();if(!d(u))return r.o9(u),u=r.G6(),n||(u+=r.frozenTrailingColumnCount()),n=r.xA(o,u,e,i),r=S(o,n.row),u=C(a,n.col),e=C(o+I(t)-1,n.row+I(n)-1),i=C(a+x(t)-1,n.col+x(n)-1),(0,w.Ec)(r,u,s=e-r+1,c=i-u+1)},QR:function(t,n,e){for(var i,r,o,a,u,s,c,f,l,h,d,v,m,g,l,p,b,y,i=this,r=t.row,o=t.col,a=I(t),u=x(t),s=r+a-1,c=0,f=N(i,o,u);0<s;)if(i.dR(--s,f)&&(l=i.xA(s,f,n,e),h=S(r,l.row),d=S(o,l.col),g=(v=S(r+a-1,l.row+I(l)-1))-h+1,l=(m=C(o+u-1,l.col+x(l)-1))-d+1,h!==r||d!==o||g!==a||l!==u))return p=i.Tb,r<(b=i.ui)?h<=p&&i.$A(h):r===b&&v<=p&&i.$A(v),(y=i.parent&&i.parent.options.scrollByPixel)&&h===p&&0!==i.ly&&i.$A(h,0),(0,w.Ec)(h,d,g,l);return M},WR:function(t,n,e,i){var r,o,a,u,s,s,u,n,r,s,e,c,f,r=this,o=t.row,a=t.col,u=r.frozenRowCount(),s=u?r.j5(u-1):r.N9(),s=n?s:r.N9();if(!d(s))return(u<=0||n)&&r.$A(s),u=r.xA(s,a,e,i),n=S(o,u.row),r=S(a,u.col),s=S(o+I(t)-1,u.row+I(u)-1),e=C(a+x(t)-1,u.col+x(u)-1),(0,w.Ec)(n,r,c=s-n+1,f=e-r+1)},uB:function(t){var n,e,i,r,o,i,a,n=this,e;if(n.parent&&n.parent.options.scrollByPixel){for(o=n.Jt,i=n.C0(t),a=n.getViewportHeight(i);0<=t&&!((a-=o.Gt(t))<0);t--);i=t,r=a}else i=n.Jy(t,2),r=0;return{Ky:i,Xy:r}},JR:function(t,n,e){for(var i,r,o,a,u,s,c,f,l,h,d,v,m,g,l,p,b,y,i=this,r=t.row,o=t.col,a=I(t),u=x(t),s=r,c=A(i)-1,f=N(i,o,u);s<c;)if(i.dR(++s,f)&&(l=i.xA(s,f,n,e),h=C(r,l.row),d=S(o,l.col),g=(v=C(r+a-1,l.row+I(l)-1))-h+1,l=(m=C(o+u-1,l.col+x(l)-1))-d+1,h!==r||d!==o||g!==a||l!==u))return p=i.sB(),r<(b=i.ui)?p<=h&&(y=i.uB(h),i.$A(y.Ky,y.Xy)):r===b&&p<=v&&(y=i.uB(v),i.$A(y.Ky,y.Xy)),(0,w.Ec)(h,d,g,l);return M},KR:function(t,n,e,i){var r,o,a,u,u,n,r,u,e,i,s,c,r=this,o=t.row,a=t.col,u=r.cB();if(!d(u))return r.$A(u),u=r.P6(),n||(u+=r.frozenTrailingRowCount()),n=r.xA(u,a,e,i),r=C(o,n.row),u=S(a,n.col),e=C(o+I(t)-1,n.row+I(n)-1),i=C(a+x(t)-1,n.col+x(n)-1),(0,w.Ec)(r,u,s=e-r+1,c=i-u+1)},qR:function(t,n,e){for(var i,r,o,a,u,s,c,f,l,h,d,v,m,g,l,i=this,r=t.row,o=t.col,a=I(t),u=x(t),s=i.frozenColumnCount()-1,c=i.ci,f=r+a-1;s<c;)if(i.dR(f,++s)){if(o<=s&&o+u-1===i.ci)break;return l=i.xA(f,s,n,e),h=S(r,l.row),d=S(o,l.col),g=(v=C(r+a-1,l.row+I(l)-1))-h+1,l=(m=S(o+u-1,l.col+x(l)-1))-d+1,i.o9(i.k9()),(0,w.Ec)(h,d,g,l)}return M},XR:function(t,n,e){return t=this.zR(t,!0,n,e),t=this.WR(t,!0,n,e)},tB:function(t,n,e){for(var i,r,o,a,u,s,c,f,l,h,d,v,m,g,l,i=this,r=t.row,o=t.col,a=I(t),u=x(t),s=T(i),c=i.ci,f=r+a-1;c<s;)if(i.dR(f,--s)){if(s<=o+u-1&&o===i.ci)break;return l=i.xA(f,s,n,e),h=S(r,l.row),d=C(o,l.col),g=(v=C(r+a-1,l.row+I(l)-1))-h+1,l=(m=C(o+u-1,l.col+x(l)-1))-d+1,i.o9(i.aB()),(0,w.Ec)(h,d,g,l)}return M},$R:function(t,n,e){return t=this.YR(t,!0,n,e),t=this.KR(t,!0,n,e)},nB:function(t,n,e){var i,r,o,a,u,s,c,f,u,s,i,f,n,l,h,i=this,r=t.row,o=t.col,a=I(t),u=i.QA();return d(u)?M:(s=i._y(1),f=-1,(c=i.$A(u))?f=i.j5(r+a-1-p(s)):i.frozenRowCount()<=0&&(f=i.N9()),f<i.Tb?f=i.Tb:f>=i.sB()&&(f=i.nI(i.sB())),u=i.xA(f,o,n,e),s=S(r,u.row),i=S(o,u.col),f=S(r+a-1,u.row+I(u)-1),n=C(o+x(t)-1,u.col+x(u)-1),(0,w.Ec)(s,i,l=f-s+1,h=n-i+1))},eB:function(t,n,e){var i,r,o,a,u,s,u,s,i,u,n,e,c,f,i=this,r=t.row,o=t.col,a=I(t),u=i.tI();return d(u)?M:(s=i._y(1),i.$A(u),(u=i.nI(r+a-1+p(s)))<i.Tb?u=i.Tb:u>=i.sB()&&(u=i.Tb>=i.cB()?i.sB():i.nI(i.sB())),s=i.xA(u,o,n,e),i=C(r,s.row),u=S(o,s.col),n=C(r+a-1,s.row+I(s)-1),e=C(o+x(t)-1,s.col+x(s)-1),(0,w.Ec)(i,u,c=n-i+1,f=e-u+1))},QA:function(){var t,n,n,e,i,r,o,t=this,n=t._y(1);if(!n||p(n)<=0)return M;for(e=(n=t.frozenRowCount())?t.j5(n-1):t.N9(),i=0,r=t.Tb,o=t.Fi();e<r&&!((i+=t.Gt(--r))>t.Sy(o)););return r},fB:function(){var t,n,n,e,i,r,o,t=this,n=t.Yy(1);if(!n||p(n)<=0)return M;for(e=(n=t.frozenColumnCount())?t.O5(n-1):t.k9(),i=0,r=t.Ab,o=t.Fi();e<r&&!((i+=t.nn(--r))>t.Gy(o)););return r},tI:function(){var t,n,t,t=this._y(1),n=p(t);return t&&0<n?(t=t[n-1].row,this.P6()<=t?this.Tb:t):M},cB:function(){var t,n,e,i,e,i,r,t=this;if(t.P6()===t.sB()&&(n=t.Fi(),e=t._y(1),i=p(e),e)&&1<=i&&(e=e[i-1]).y+e.height<=n.Cy+t.Sy(n))return t.Tb;i=t.Tb;try{return t.Tb=t.P6(),r=t.QA(),r=t.j5(r)}catch(t){}finally{t.Tb=i}},aB:function(){var t,n,e,i,e,r,o,t=this;if(t.G6()===t.oB()&&(n=t.Fi(),e=t.Yy(1),i=p(e),e)&&1<=i&&(e=e[i-1]).x+e.width<=n.Py+n.width)return t.Ab;for(n=t.Fi(),r=0,o=t.G6();0<o&&!((r+=t.nn(o))>t.Gy(n));)o--;return o=0<o?t.O5(o):o},sB:function(){var t=this._y(1),n=p(t);return t&&0<n?t[n-1].row:M},oB:function(){var t=this.Yy(1),n=p(t);return t&&0<n?t[n-1].col:M},iD:function(){var t,n,e,i,e,t=this,n=t._y(1),e=p(n);return n&&0<e?(i=t.Fi(),(n[e=e-1].y+n[e].height<=i.Cy+t.Sy(i)?n[e]:n[C(e-1,0)]).row):M},rD:function(){var t,n,e,i,e,t=this,n=t.Yy(1),e=p(n);return n&&0<e?(i=t.Fi(),(n[e=e-1].x+n[e].width<=i.Py+t.Gy(i)?n[e]:n[C(e-1,0)]).col):M},P6:function(t){var n=A(this,t=d(t)?3:t);return 3!==t&&2!==t||(n-=this.frozenTrailingRowCount()),this.nI(n,t)},G6:function(t){var n=T(this,t=d(t)?3:t);return 3!==t&&1!==t||(n-=this.frozenTrailingColumnCount()),this.r6(n,t)},kR:function(t,n){var e,i,r;if(t)for(e=0,i=p(t);e<i;e++)if(r=t[e],n.intersect(r.row,r.col,I(r),x(r)))return t.splice(e,1),e--,this.kR(t,n.union(r));return n},U5:function(t){var n,e,i,r,o,n,e=this.Ut,i=p(e.getSelections()),r=(0,w.Ec)(-1,-1,0,0);return i<=0||(o=e.getActiveSelectedRangeIndex(),3===t||1===t?e.do("setActiveSelectedRangeIndex",o=--o<0?i-1:o):4!==t&&2!==t||e.do("setActiveSelectedRangeIndex",o=i<=++o?0:o),0<=(o=e.getActiveSelectedRangeIndex())&&(r=e.getSelections()[o])),r}}),i.Worksheet.ch("selection",{init:function(){this.Ut.do("addSelection",0,0,1,1),this.Ut.setCellState(0,0,o.CellStatesType.active,!0,o.SheetArea.viewport)}})},"./dist/core/worksheet/worksheet-sort.js":function(i,t,o){"use strict";var e,t,g,y,n,w,n,n,p,u,h,M,s,c,C,f,l,S;function D(t,n,e){for(var i=t[e-n];i<e;)i=t[i-n];return i}function d(t,n){return"object"==typeof t?JSON.stringify(t):(t=n.getColor(t),e.Common.ft.j(e.Common.ft._(t)))}function T(t,n){return t instanceof Date&&n instanceof Date?u(t)===u(n):typeof t==c&&typeof n==c?t.toLowerCase()===n.toLowerCase():t===n}function A(t,n,e,i,r){var o,a,u,t,t=t.currentTheme();return o=(a=(a=M(n)||(a=r?n.backColor:n.foreColor,M(a))?a:d(a,t))||"")===(u=(u=M(e)||(u=r?e.backColor:e.foreColor,M(u))?u:d(u,t))||"")?0:a===i?1:u===i?-1:0}function I(t,n){var e,i,r,o,a;return t instanceof Date&&(t=u(t)),n instanceof Date&&(n=u(n)),r=(e=typeof t)==c,o=(i=typeof n)==c,a=i==C,e==i||e!=C&&!a?e==s&&o||(!r||i!=s)&&(r&&o?t.toLowerCase()>n.toLowerCase():n<t):a}function v(t,n,e,i,r,o){var a,u,s,c,f,l,h,d,v,m,g,p,h,b,y,b,y,u=r,s=t,c=n;if(u)for(f=0;f<u.length&&(u[f]&&(l=u[f].ascending,0<=(h=u[f].index))&&(v=d=void 0,m=i?s:h,g=i?h:s,p=i?c:h,h=i?h:c,v=o?(d=o[m][g],o[p][h]):(d=e.getValue(m,g),e.getValue(p,h)),u[f].compareFunction?(a=u[f].compareFunction(d,v),l||(a*=-1)):M(u[f].color)?(b=M(d)||""===d||typeof d==C&&isNaN(d),y=M(v)||""===v||typeof v==C&&isNaN(v),b||y?b&&y?a=0:b&&!y?a=1:!b&&y&&(a=-1):a=T(d,v)?0:I(d,v)?l?1:-1:l?-1:1):(b=e.getActualStyle(m,g,3,!1,!1,!(y=b=void 0)),y=e.getActualStyle(p,h,3,!1,!1,!0),a=A(e,b,y,u[f].color,u[f].isBackColor),l||(a*=-1))),0===a);f++);return a}function b(t,n,e,i,r){var o,a,u,s,c,f,l,h,o=t.length;if(o<=1)return t;for(u=t[a=Math.floor(o/2)],s=[],c=[],f=[],l=0;l<o;l++)(a===l?f:(h=v(t[l],u,n,e,i,r))<0?s:0<h?c:f).push(t[l]);return b(s,n,e,i,r).concat(f,b(c,n,e,i,r))}function x(t,n,e){var i,r,o,i=[];if(n)for(r=e.length-1;0<=r;r--)o=e[r],0===t.getRowHeight(o)&&(e.splice(r,1),i.push({lp:r,y4:o}));else for(r=e.length-1;0<=r;r--)o=e[r],0===t.getColumnWidth(o)&&(e.splice(r,1),i.push({lp:r,y4:o}));return i}function N(t,n){for(var e,i,e=t.length-1;0<=e;e--)i=t[e],n.splice(i.lp,0,i.y4)}function k(t,n,e,i,r,o,a,u,s){for(var c,f,l,h,i,d,v,m,c=o?i:r,f=o?n:e,l=[],h=0;h<c;h++)l[h]=f+h;for(i=u.ignoreHidden?x(t,o,l):[],d=l.concat([]),v=!1,l=b(l,t,o,a,s),m=0;m<l.length;m++)if(l[m]!==d[m]){v=!0;break}return N(i,l),{array:l,isChanged:v}}function _(t,n,e,i,r,o,a,u,s){var c,f,i,r,l,h,d,n,e,c=o?i:r,f=o?n:e,i=o?t.rowOutlines:t.columnOutlines,r=i.lB(f,c),l=i.hB(r,u.groupSort);if(!l){for(h=[],d=0;d<c;d++)h.push(f+d);l=[h]}for(d=0;d<l.length;d++)l[d]=b(l[d],t,o,a,s);return e=(n=i.dB(l,r,u.groupSort)).array,n.isChanged&&m(t,o,n,e,r,f,c),{array:e,isChanged:n.isChanged}}function m(t,n,e,i,r,o,a){var u,s,c,f,l,u=n?t.rowOutlines:t.columnOutlines,s=[],c=[];if(n){for(f=o;f<o+a;f++)t.XT(f)||t.rowOutlines&&t.rowOutlines.isCollapsed(f)||(t.getRowVisible(f,3,!0)?0===t.getRowHeight(f)&&(s.push(f),t.setRowHeight(f,t.defaults.rowHeight)):(c.push(f),t.setRowVisible(f,!0)));for(u.vB(e.groupSwap,e.array,r.start),f=0;f<c.length;f++)l=h.hD(i,c[f])+o,t.setRowVisible(l,!1);for(f=0;f<s.length;f++)l=h.hD(i,s[f])+o,t.setRowHeight(l,0)}else{for(f=o;f<o+a;f++)t.columnOutlines&&t.columnOutlines.isCollapsed(f)||(t.getColumnVisible(f,3)?0===t.getColumnWidth(f)&&(s.push(f),t.setColumnWidth(f,t.defaults.colWidth)):(c.push(f),t.setColumnVisible(f,!0)));for(u.vB(e.groupSwap,e.array,r.start),f=0;f<c.length;f++)l=h.hD(i,c[f])+o,t.setColumnVisible(l,!1);for(f=0;f<s.length;f++)l=h.hD(i,s[f])+o,t.setColumnWidth(l,0)}}function E(t,n,e){var t=t.oT(n,e,!1);t&&t.hasListeners()&&t.mB()}function j(t,n,e,i){var r,r,i,r=o("SheetsCalc");r&&(r=r.CalcOperatorAdjustor.gB(t.rT,t.rT,t.pB(n,e),n,e,0,0),t.bB(n,e,r,i),i=t.oT(n,e,!!r))&&i.yB()}function O(t,n,e,i,r,o,a,u,s,c,f,l){for(var h,d,v,m,g,p,b,y,w,M,C,S,T,A,I,x,N,k,w=t.Ut,M=w.pI,S=M&&0<M.wB.length,A=o?n:e,I=o?n+i:e+r,N=o?e:n,k=o?e+r:n+i,T=A;T<I;T++)if(T!==(C=D(u,A,T)))for(o?(h=T,v=C):(d=T,m=C),x=N;x<k;x++)o?m=d=x:v=h=x,a&&(g=s[h][d],p=s[v][m]),S&&(b=M.get(h,d),y=M.get(v,m)),f&&l&&(E(f,h,d),E(f,v,m),f.SE(h,d,v,m),j(f,h,d),j(f,v,m)),w.do("swapNode",h,d,v,m),t.b8&&t.MB(h,d,v,m),S&&M.CB(b,h,d,y,v,m),a&&(s[h][d]=p,s[v][m]=g),c.push({row:h,col:d}),c.push({row:v,col:m})}function R(t,n,e,i,r,o,a,u,s,c,f){var l,h,d,n,v,m,g,p,b,l=[],h=t.Ut.P8;if(0<h&&n&&(t.Ut.P8=0,[].push.apply(t.Ut.G8,[{row:e,column:i,rowCount:r,columnCount:o,byRows:a,sortInfo:u,type:"sortRange",array:c.concat([])}])),d=w&&t.b3(),n=w&&t.Uw(),O(t,e,i,r,o,a,s,c,f,l,d,n),s)for(v=e;v<e+r;v++)for(m=i;m<i+o;m++)t.setValue(v,m,f[v][m]);if(d){for(g=e;g<e+r;g++)for(p=i;p<i+o;p++)(b=d.pB(g,p))&&d.SB(g,p,b,S);t.getCalcService().recalcRange(n,e,i,r,o)}return y.Worksheet.et(t,"sortRangeChanged",{column:i,columnCount:o}),0<h&&(t.Ut.P8=h),l}function B(t,n,e,i,r,o,a,u,s,c){var f,l,h,d,v,m;t.suspendPaint(),t.suspendEvent(),w&&t.suspendCalcService();try{if(c)for(l=[],h=n;h<n+i;h++)for(l[h]=[],d=e;d<e+r;d++)l[h][d]=t.getValue(h,d);return m=v=void 0,(v=s||(m=(0===u.groupSort?k:_)(t,n,e,i,r,o,a,u,l)).array)?(f=R(t,m&&m.isChanged,n,e,i,r,o,a,c,v,l),!0):!1}finally{w&&t.resumeCalcService(!1),t.resumeEvent(),t.resumePaint(),t.SI(n,e,i,r,f,4,S,S,S,!!s)}}function L(t,n){for(var e,i,r,o,a,u,s,e=[],i=0,r=n;i<r.length;i++)(o=r[i]).compareFunction?(a=o,e.push({index:a.index,ascending:a.ascending,compareFunction:a.compareFunction})):o.order&&o.hasOwnProperty(f)?(u="top"!==(a=o).order,s=M(a.backColor)?"":d(a.backColor,t.currentTheme()),e.push({index:a.index,ascending:u,color:s,isBackColor:!0})):o.order&&o.hasOwnProperty(l)?(u="top"!==(a=o).order,s=M(a.fontColor)?"":d(a.fontColor,t.currentTheme()),e.push({index:a.index,ascending:u,color:s,isBackColor:!1})):(o.color&&(o.color=d(o.color,t.currentTheme())),e.push(o));return e}Object.defineProperty(t,"__esModule",{value:!0}),e=o("Common"),t=o("./dist/core/util/domUtil.js"),g=o("./dist/core/util/common.js"),y=o("./dist/core/worksheet/worksheet.js"),n=o("CalcEngine"),w=!!n,n=o("./dist/core/core.ns.js"),n=new e.Common.ResourceManager(n.SR,"Sheets"),p=n.getResource.bind(n),u=e.Common.ct.o0,h=e.Common.Uf,M=e.Common.lt.ht,s="boolean",c="string",C="number",f="backColor",l="fontColor",S=void 0,t.GC$.extend(y.Worksheet.prototype,{sortRange:function(t,n,e,i,r,o,a,u,s){var c,f,l,h,d,f,l,f,l,v,m,f,l,f,c=this,f=c.getRowCount(),l=c.getColumnCount();if(-1===e&&(e=f),-1===n&&(n=0),-1===i&&(i=l),(t=-1===t?0:t)<0||f<=t||n<0||l<=n||e<0||f<t+e||i<0||l<n+i||!o)return!1;if(a=c.TB(g.Ec(t,n,e,i),r,a),f=r?c.rowOutlines:c.columnOutlines,!u&&0<a.groupSort){if(!f)return!1;l=f.lB(d=r?t:n,h=r?e:i),r?(e=l.count,t=l.start):(i=l.count,n=l.start)}return w&&!c.mT(t,n,e,i,!1)?(s&&c.jT(7,p().Exp_InvalidSortArrayFormulaInRange),!1):(f=c.Ut.getSpans(g.Ec(t,n,e,i)))&&0<f.length?(s&&c.jT(7,p().Exp_InvalidSortSpanInRange),!1):!(l=c.tables)||(m=1===(v=l.AB(t,n,e,i)).length&&v[0].dataRange().equals(g.Ec(t,n,e,i)),v.length<=0)||m?(l=(f=c.H3)&&f._dataSource||m&&v[0]&&v[0].z3(),(f=B(c,t,n,e,i,r,L(c,o),a,u,l))&&0!==a.groupSort&&c.IB&&c.IB.reFilter(),f):(s&&c.jT(7,p().Exp_InvalidSortPartTableOrMultiTableInRange),!1)},TB:function(t,n,e){var i,t,r,o,a,n,i=this,t=i.JS(t),r=n?t.rowCount:t.colCount,o=n?t.row:t.col,a=n?i.rowOutlines:i.columnOutlines;return M(e)&&(e={}),i.outlineColumn&&i.outlineColumn.xB()&&n&&(n=i.outlineColumn.NB.columnIndex,t.col<=n&&n<=t.col+t.colCount||(e.groupSort=0)),M(e.groupSort)&&(M(e.ignoreHidden)?e.groupSort=a&&a.kB(o,r)?1:0:e.groupSort=0),0===e.groupSort?e.ignoreHidden=!!M(e.ignoreHidden)||e.ignoreHidden:e.ignoreHidden=!1,e},_B:function(){var t=this.options;return!t.isProtected||t.protectionOptions.allowSort},MB:function(t,n,e,i){var r=this,o=r.getDataValidator(t,n),a=r.getDataValidator(e,i);r.setDataValidator(t,n,a),r.setDataValidator(e,i,o)}})},"./dist/core/worksheet/worksheet-static.js":function(i,t,P){"use strict";var n,G,r,I,e,U,H,L,g,z,N,V,Y,e,l;function Z(t,n){return t.getRowCount(n)}function W(t,n){return t.getColumnCount(n)}function k(t,n,e){return t.Do(n,e)}function D(t,n,e){return t._o(n,e)}function _(t,n,e,i){t.setColumnWidth(n,e,i)}function E(t,n,e,i){t.setRowHeight(n,e,i)}function j(t,n,e,i,r){return t.getActualStyle(n,e,i,N,N,N,r)}function o(t,n){return t.getDefaultStyle(n)}function a(t,n,e){t.setDefaultStyle(n,e)}function O(t,n,e,i,r){t.u5(n,e,i,r)}function h(t,n,e,i){throw new Error(r.Common.zf.I5(l().Exp_InvalidAndSpace,[t,n,e,i]))}function Q(t,n,e){return n&&e.XT&&e.XT(t)}function J(t,n,e,i,r,o,a,u,s){var c,t,f,i,e,o,u,t;if(!t)throw new Error(l().Exp_SrcIsNull);if(!i)throw new Error(l().Exp_DestIsNull);c=Z(t),t=W(t),f=Z(i),i=W(i),(n<-1||c<=n)&&h("from row index",n,"-1",c-1),(e<-1||t<=e)&&h("from column index",e,"-1",t-1),(r<-1||f<=r)&&h("to row index",r,"-1",f-1),(o<-1||i<=o)&&h("to column index",o,"-1",i-1),(e=e)<0&&(e=0,u=t),o=o<0?0:o,(u<1||t<e+u||i<o+u)&&h("column count",u,"1",V(t-e,i-o)),(u=n)<0&&(u=0,a=c),t=r<0?0:r,(a<1||c<u+a||f<t+a)&&h("row count",a,"1",V(c-u,f-t))}function F(t){if(!t)return t;if("number"==typeof t||"string"==typeof t||"boolean"==typeof t||L(t))return t;if(t.clone)return t.clone();if(t instanceof Date)return new Date(t.valueOf());var n,e,i,n=t instanceof Object?new t.constructor:new t.constructor(t.valueOf());for(e in t)t.hasOwnProperty(e)&&(i=t[e],t.hasOwnProperty(e))&&n[e]!==i&&(n[e]="object"==typeof i?F(i):i);return n.toString=t.toString,n.valueOf=t.valueOf,n}function p(t,n,e,i,r,o,a,u,s){var c,f,l,h,d,v,m,g,p,b,y,w,w,c=t.getSpans(N,s),f=i.getSpans(N,s),l=[];if(c)for(h=0;h<c.length;h++)v=(d=c[h]).row,m=d.col,g=d.rowCount,p=d.colCount,-1===n?e<=m&&m+p<=e+u&&l.push((0,G.Ec)(v,o+m-e,g,p)):-1===e?n<=v&&v+g<=n+a&&l.push((0,G.Ec)(r+v-n,m,g,p)):n<=v&&v<n+a&&e<=m&&m<e+u&&l.push((0,G.Ec)(r+v-n,o+m-e,g,p));if(f)for(h=0;h<f.length;h++)v=(d=f[h]).row,b=void 0,y=o<=(m=d.col)&&m<o+u,w=r<=v&&v<r+a,(b=-1===n?y:-1===e?w:w&&y)&&(w=i.findSpan(v,m,s))&&w.row===v&&w.col===m&&i.do("removeSpan",w,s);for(h=0;h<l.length;h++)i.do("addSpan",l[h],s)}function X(t,n,e,i,r,o,a,u,s,c){var f,l,i,t,f=t.conditionalFormats,l=i.conditionalFormats,i=v(t,i);f&&l&&!t.EB&&(t=f.jB(n,e,l,r,o,a,u,i,c),s)&&f.OB(n,e,a,u,t,i)}function q(t,n,e,i,r,o,a,u,s,c){var f,l;n<0&&(n=0,a=V(Z(t),Z(i))),r<0&&(r=0),e<0&&(e=0,u=V(W(t),W(i))),o<0&&(o=0),(f=!(t===i&&t.name()===i.name()))?(l=i.RB)&&(s?0<t.RB.count()&&l.BB(t,n,e,r,o,a,u):l.LB(t,n,e,r,o,a,u,N,c)):(l=t.RB)&&(s?0<l.count()&&l.iE(n,e,r,o,a,u):l.tE(n,e,r,o,a,u,N,c))}function $(t,n,e,i,r,o){var a,u,s;n<0&&(n=0,r=V(W(t),W(e))),i<0&&(i=0),a=t.columnOutlines,u=e.columnOutlines,(s=!(t===e&&t.name()===e.name()))?a&&u&&u.FB(a,n,i,r,o):a&&a.PB(n,i,r,o)}function tt(t,n,e,i,r,o){var a,t,e;n<0&&(n=0,r=V(Z(t),Z(e))),i<0&&(i=0),a=!(t===e&&t.name()===e.name()),t=t.rowOutlines,e=e.rowOutlines,a?t&&e&&e.FB(t,n,i,r,o):t&&t.PB(n,i,r,o)}function d(t,n,e,i,r,o,a,u,s,c){var f,t,l,f=!(t===i&&t.name()===i.name()),t=t.Ut,l=t.K_(c);f?(p(t,n,e,i.Ut,r,o,a,u,c),s&&l&&t.do("clearSpan",n,e,a,u,c)):s?t.do("moveSpan",n,e,r,o,a,u,c):t.do("copySpan",n,e,r,o,a,u,c)}function nt(t,n,e,i,r,o,a,u,s){var c=n,f=e;c<0&&(c=0,a=V(Z(t),Z(i))),r<0&&(r=0),f<0&&(f=0,u=V(W(t),W(i))),o<0&&(o=0),n<0&&d(t,-1,f,i,-1,o,-1,u,s,1),e<0&&d(t,c,-1,i,r,-1,a,-1,s,2),d(t,c,f,i,r,o,a,u,s)}function et(t,n,e,i,r,o,a,u,s){var c,f,l,h,d,v,m,g,p,b,y,w,M,C,S,T,A;for(n<0&&(n=0,r=V(W(t),W(e))),c=r,i<0&&(i=0),f=!u&&e.o5(),l=1,h=[],v=d=0;d<r&&d<W(e,1);d++)f&&0===e.getColumnWidth(i+d)?r++:(m={},0<(64&o)&&(g=k(t,v+n),L(g)||(m.size=g,a&&_(t,d+n,t.defaults.colWidth)),p=t.getColumnVisible(v+n),L(p)||(m.visible=p,a&&t.setColumnVisible(d+n,!0)),b=j(t,-1,v+n,N,s),m.style=b,a&&O(t,-1,d+n,z),b=j(t,-1,v+n,1,s),m.headerStyle=b,a&&O(t,-1,d+n,z,1),y=t.Lt(v+n),L(y)||(m.columnHeaderFitMode=y,a&&t.GB(d+n,I.ColumnHeaderFitMode.normal))),0<(128&o)&&(w=t.getTag(-1,v+n),L(w)||(m.tag=w,a&&t.setTag(-1,d+n,N))),h[v+n]=m,v++);for(r=c,v=d=0;d<r&&d<W(e,1);d++)f&&0===e.getColumnWidth(i+d)?r++:(m=h[v+n],0<(64&o)&&(g=m.size,L(g)||_(e,d+i,g),p=m.visible,L(p)||e.setColumnVisible(d+i,p),O(e,-1,d+i,(b=m.style)?b.clone():z),O(e,-1,d+i,(b=m.headerStyle)?b.clone():z,1),y=m.columnHeaderFitMode,L(y)||e.GB(d+i,y)),0<(128&o)&&(w=m.tag,L(w)||e.setTag(-1,d+i,w)),v++);for(M=Z(e,1),C=V(Z(t,1),M),T=S=0;S<C&&S<M;S++)f&&0===e.getRowHeight(S,1)?C++:(A=D(t,T,1),L(A)||(a&&E(t,S,t.defaults.colHeaderRowHeight,1),E(e,S,A,1)),T++)}function it(t,n,e,i,r,o,a,u,s,c){var f,l,h,d,v,m,g,p,b,y,w,M,C,S,T,A,I,x;for(n<0&&(n=0,r=V(Z(t),Z(e))),f=r,i<0&&(i=0),l=!s&&e.o5(),h=2,d=[],m=v=0;v<r&&i+v<Z(e,2);v++)l&&0===e.getRowHeight(i+v)?r++:(!u&&Q(i+v,a,e)||(g={},0<(64&o)&&(p=D(t,m+n),L(p)||(g.size=p,u&&E(t,v+n,t.defaults.rowHeight)),b=t.getRowVisible(m+n),L(b)||(g.visible=b,u&&t.setRowVisible(v+n,!0)),y=j(t,m+n,-1,N,c),g.style=y,u&&O(t,v+n,-1,z),y=j(t,m+n,-1,2,c),g.headerStyle=y,u)&&O(t,v+n,-1,z,2),0<(128&o)&&(w=t.getTag(m+n,-1),L(w)||(g.tag=w,u&&t.setTag(v+n,-1,N))),d[m+n]=g),m++);for(r=f,M=e.rowFilter&&e.rowFilter()&&e.rowFilter().extendedRange,m=v=0;v<r&&i+v<Z(e,2);v++)C=i+v,l&&0===e.getRowHeight(C)?r++:(!u&&Q(C,a,e)||(g=d[m+n],0<(64&o)&&(p=g.size,L(p)||E(e,C,p),b=g.visible,L(b)||(M&&M.intersect(C,-1,1,0)?e.filterRowsVisibleInfo.rowsVisibleInfo[C]=!!b:e.setRowVisible(C,b)),O(e,C,-1,(y=g.style)?y.clone():z),O(e,C,-1,(y=g.headerStyle)?y.clone():z,2)),0<(128&o)&&(w=g.tag,L(w)||e.setTag(C,-1,w))),m++);for(S=W(e,2),T=V(W(t,2),S),I=A=0;A<T&&A<S;A++)l&&0===e.getColumnWidth(A,2)?T++:(x=k(t,I,2),L(x)||(u&&_(t,A,t.defaults.rowHeaderColWidth,2),_(e,A,x,2)),I++)}function rt(t,n,e,i){var e,e,n;t===n&&t.name()===n.name()||(0<(64&e)&&(e=o(t),a(n,i?e:e.clone()),e=o(t,1),a(n,i?e:e.clone(),1),e=o(t,2),a(n,i?e:e.clone(),2),i)&&(a(t,z),a(t,z,1),a(t,z,2)),e=n.defaults,n=t.defaults,e.colWidth=n.colWidth,e.rowHeight=n.rowHeight,e.rowHeaderColWidth=n.rowHeaderColWidth,e.colHeaderRowHeight=n.colHeaderRowHeight,i&&(n.colWidth=62,n.rowHeight=20,n.rowHeaderColWidth=40,n.colHeaderRowHeight=20))}function T(t,n,e,i,r,o,a,u,s,c,f,l,B){var h,d,v,m,g,p,b,y,w,M,C,S,T,A,I,x,N,k,D,_,E,j,O,R,h=!(t===i&&t.name()===i.name()),d=!B&&i.o5();if(2==(2&c)&&n<0)if(C=e,S=o,v=V(Z(t,1),Z(i,1)),m=u,e<0&&(C=0,m=W(t)),o<0&&(S=0),T=m,h)for(w=g=0;g<v&&g<Z(i,1);g++)if(d&&0===i.getRowHeight(g,1))v++;else{for(M=p=0,m=T;p<m&&p<W(i,1);p++)d&&0===i.getColumnWidth(S+p,1)?m++:(l(i,g,S+p,F(y=f(t,w,C+M,1)),1),M++);w++}else{for(b=new G.Rf,g=0;g<v;g++)for(p=0;p<m;p++)y=f(t,g,C+p,1),L(y)||b.set(g,p,F(y));for(w=g=0;g<v&&g<Z(i,1);g++)if(d&&0===i.getRowHeight(g,1))v++;else{for(M=p=0,m=T;p<m&&p<W(i,1);p++)d&&0===i.getColumnWidth(S+p,1)?m++:(l(i,g,S+p,b.get(w,M),1),M++);w++}}if(1==(1&c)&&e<0)if(A=n,I=r,v=a,m=V(W(t,2),W(i,2)),n<0&&(A=0,v=Z(t)),r<0&&(I=0),T=m,h)for(w=g=0;g<v&&g<Z(i,2);g++)if(d&&0===i.getRowHeight(I+g,2))v++;else{for(M=p=0,m=T;p<m&&p<W(i,2);p++)d&&0===i.getColumnWidth(p,2)?m++:(l(i,I+g,p,F(y=f(t,A+w,M,2)),2),M++);w++}else{for(b=new G.Rf,g=0;g<v;g++)for(p=0;p<m;p++)y=f(t,A+g,p,2),L(y)||b.set(g,p,F(y));for(w=g=0;g<v&&g<Z(i,2);g++)if(d&&0===i.getRowHeight(I+g,2))v++;else{for(M=p=0,m=T;p<m&&p<W(i,2);p++)d&&0===i.getColumnWidth(p,2)?m++:(l(i,I+g,p,b.get(w,M),2),M++);w++}}if(x=n,N=e,k=r,D=o,_=a,E=u,j=Z(i),O=W(i),n<0&&(x=0,_=V(Z(t),j)),e<0&&(N=0,E=V(W(t),O)),r<0&&(k=0),o<0&&(D=0),R=E,h)for(g=w=0;g<_&&k+g<j;g++)if(d&&0===i.getRowHeight(k+g))_++;else{if(!Q(k+g,s,i))for(p=M=0,E=R;p<E&&D+p<O;p++)d&&0===i.getColumnWidth(D+p)?E++:(l(i,k+g,D+p,F(y=f(t,x+w,N+M,3)),3),M++);w++}else{b=new G.Rf;try{for(g=0;g<_;g++)for(p=0;p<E;p++)y=f(t,x+g,N+p,3),L(y)||b.set(g,p,F(y));for(g=w=0;g<_&&k+g<j;g++)if(d&&0===i.getRowHeight(k+g))_++;else{if(!Q(k+g,s,i))for(p=M=0,E=R;p<E&&D+p<O;p++)d&&0===i.getColumnWidth(D+p)?E++:(l(i,k+g,D+p,b.get(w,M),3),M++);w++}}catch(t){}}}function b(t){return[t.row,t.col].join(",")}function ot(t,n,e,l,i,r,o,a,u,s,h,d,c,v){var m;h&&(m=(0,G.Ec)(n,e,o,a)),T(t,n,e,l,i,r,o,a,u,s,function(t,n,e,i){var r,o,a,u,s,c,f,s,f,s,f,c,r=3===i,a=v?0:1,u=t.Ut,s={};return r?(c=(h||d)&&u.getDynamicArrayInfo(n,e))&&c.isValid?(o=z,h&&!s[f=b(c)]&&(s=(s[f]=c).row,f=c.col,m.contains(s,f,1,1))&&u.W_(3).U8(c)):o=t.getValue(n,e,i,a):(o=u.getValue(n,e,i,!0,a),1===i&&L(o)&&l.UB&&(s=t.H3)&&s._dataSource&&(f=u.q_(!1,3,e),c=t.options.colHeaderAutoTextIndex,f)&&(0<=c&&n===c||-1===c&&n===Z(t,i)-1)&&(o=f.displayName||f.name)),h&&!L(o)&&(r?t.YI(n,e,z,i,!1):u.do("setValue",n,e,z,i,!0,!0)),o},function(t,n,e,i,r){L(i)?t.YI(n,e,z,r,!!t.HB):t.YI(n,e,i,r,!!t.HB)},c)}function C(t,n,e){for(var t,i,r,o,a,u,s,c,t=t.JS(n),i=t.row,r=t.col,o=t.rowCount,a=t.colCount,u=0;u<o;u++)for(s=e[i+u]=e[i+u]||{},c=0;c<a;c++)s[r+c]=!0}function at(t,n,e,i,r,o,a,u,s,c,f,l,h){var d,v,m,g,p,b,y,w,M,d={};if(t===i&&t.tables)for(v=(0,G.Ec)(n,e,a,u),m=(0,G.Ec)(r,o,a,u),p=(g=t.tables).all(),b=void 0,y=0,w=(p=g.zB?p.concat(g.zB):p).length;y<w;y++)(b=(M=p[y]).VB||M.range()).containsRange(v)&&b.containsRange(m)?C(t,v,d):(b.intersect(m.row,m.col,m.rowCount,m.colCount)||f&&v.containsRange(b))&&C(t,b,d);T(t,n,e,i,r,o,a,u,s,c,function(t,n,e,i){var r,r,r=(3===i||L(i))&&d[n]&&d[n][e],r=t.getCompositeStyle(n,e,i,N,N,N,N,r,N,N,l);return f&&r&&O(t,n,e,z,i),r},function(t,n,e,i,r){O(t,n,e,i,r)},h)}function ut(r,t,n,o,e,i,a,u,s,c,f){var l,h,d,d,l=r.b8.YB;for(h in l)(d=l[h])&&(d=d.condition())&&d.initExpression();T(r,t,n,o,e,i,a,u,s,0,function(t,n,e){var i=t.getDataValidator(n,e,3);return i&&(c&&t.setDataValidator(n,e,z),v(r,o))&&(i.ZB=!0),i},function(t,n,e,i){t.setDataValidator(n,e,i),v(r,o)&&i&&delete i.ZB},f)}function v(t,n){return t===n&&t.name()===n.name()}function st(t,n,e,i,r,o,a,u,s,c,f){T(t,n,e,i,r,o,a,u,s,0,function(t,n,e){var t,i,t=t.Ut.pI,i=t&&t.get(n,e);return i&&c&&t.remove(n,e),i},function(t,n,e,i){var t=t.Ut.pI;t&&t.WB(n,e,i)},f)}function ct(t,n,e,o,i,r,a,u,s,c,f,l){T(t,n,e,o,i,r,a,u,s,c,function(t,n,e,i){var i=t.getTag(n,e,i);return!L(i)&&f&&t.setTag(n,e,N),i},function(t,n,e,i,r){o.setTag(n,e,i,r)},l)}function ft(a,u,s,t,n,e,i,r,o,c,f){var l,h,d,v,m,g,p,b,y,w,M,C,S,l=[],h=[],d={},v={},m=!f&&t.o5();if(m){for(g=i,p=r,g+=t.lT(n,g,!0),p+=t.lT(e,p),b=t.getRowCount(),y=t.getColumnCount(),M=w=0;w<g&&w+n<b;w++)0!==t.getRowHeight(n+w)&&(d[M]=w,M++);for(S=C=0;C<p&&C+e<y;C++)0!==t.getColumnWidth(e+C)&&(v[S]=C,S++)}return T(a,u,s,t,n,e,i,r,o,0,function(t,n,e){var i,r,o,i=t.getBindingPath&&t.getBindingPath(n,e);return i&&(r=n-Y(0,u),o=e-Y(0,s),m&&(r=d[r],o=v[o]),l.push({row:r,col:o,value:t.getValue(n,e)}),c)&&a.setBindingPath&&a.setBindingPath(n,e,z),i},function(t,n,e,i){L(i)&&(!t.getBindingPath||L(t.getBindingPath(n,e)))||(t.setBindingPath&&t.setBindingPath(n,e,N),h.push({sheet:t,r:n,c:e,value:i}))},f),{savedValues:l,bindingPathInfos:h}}function K(t){t.forEach(function(t){var n=t.sheet,e=t.r,i=t.c,t=t.value;n.setBindingPath&&n.setBindingPath(e,i,t)})}function lt(t,n,e,o,i,r,a,u,s,c,f,l){T(t,n,e,o,i,r,a,u,s,c,function(t,n,e,i){var i=t.getHyperlink&&t.getHyperlink(n,e,i);return!L(i)&&f&&t.setHyperlink&&t.setHyperlink(n,e,N),i},function(t,n,e,i,r){o.setHyperlink&&o.setHyperlink(n,e,i,r)},l)}function ht(t,n,e,i,r,o,a,u){var s=P("SheetsCalc");s&&s.CalcOperatorAdjustor.moveFormula(t,n,e,i,r,o,a,u)}function dt(i,r,o,a,u,s,c,f){var t,l,h,d,v,t,m,t,n,e,t=P("SheetsCalc");if(t)if(l=t.QB,v=i.Ut.pj(),i.parent&&i.parent.sheets)for(m=i.parent.sheets,(t=i.parent.getCustomNames())&&g(t,function(t,n){h=n.getExpression(),(d=l(null,i,r,o,a,u,s,c,f,h))!==h&&n.SB(d,v)}),n=function(e){var t=m[e].getCustomNames();t&&g(t,function(t,n){h=n.getExpression(),(d=l(m[e],i,r,o,a,u,s,c,f,h))!==h&&n.SB(d,v)})},e=0;e<m.length;e++)n(e);else(t=i.getCustomNames())&&g(t,function(t,n){h=n.getExpression(),(d=l(i,i,r,o,a,u,s,c,f,h))!==h&&n.SB(d,v)})}function m(t,n,e,i,r,o,a,u,s,c,f,l,h,d,B){var v,m,g,L,p,b,y,w,M,C,S,T,A,b,b,I,x,N,k,D,_,E,j,O,R,F;if(J(t,n,e,i,r,o,a,u,l),0<(1&s)&&0<(2&s)&&(b=t.pivotTables)&&(p=b.KB((0,G.Ec)(Y(0,n),Y(0,e),n<0?V(Z(t),Z(i)):a,e<0?V(W(t),W(i)):u),l)),l&&i.UB&&n<0)for(g=u,(m=e)<0&&(m=0,g=V(W(t),W(i))),(y=o)<0&&(y=0),v=!0,w=0;w<g;w++)M=t.Ut.q_(!1,3,m+w),C=t.Ut.q_(!1,3,y+w),S=M&&M.name,T=C&&C.name,M&&C&&S&&T||(v=!1),(C=H.GC$.extend(!0,{},i.Ut.q_(!1,3,y+w)||{})).displayName=M&&M.displayName,C.name=M&&M.name,i.Ut.do("setItem",!1,3,y+w,C);0<(64&s)&&(at(t,n,e,i,r,o,a,u,c,f,l,h,d),t.EB||t.b8&&ut(t,n,e,i,r,o,a,u,c,l,d)),0<(512&s)&&X(t,n,e,i,r,o,a,u,l,d),0<(1&s)&&0<(2&s)&&(b=t.tables)&&(A=b.KB((0,G.Ec)(Y(0,n),Y(0,e),n<0?V(Z(t),Z(i)):a,e<0?V(W(t),W(i)):u),l)),(b=U)&&(t.suspendCalcService(),i.suspendCalcService()),I=[],x=z,N=[],0<(256&s)&&(I=(x=ft(t,n,e,i,r,o,a,u,c,l,d)).savedValues,N=x.bindingPathInfos);try{if(k=i.pivotTables,0<(1&s)&&0<(2&s)&&k&&k.JB(p,t,Y(0,n),Y(0,e),i,Y(0,r),Y(0,o),a,u,l),0<(1&s)&&!v){if(ot(t,n,e,i,r,o,a,u,c,f,l,0<(2&s),d,B),U&&0==(2&s)&&i.clearFormula(r,o,a,u,function(t,n){return!c||!t.XT||!t.XT(n)}),0<(256&s))for(K(N),D=I.length,_=r<0?0:r,E=o<0?0:o,j=0;j<D;j++)O=I[j],!l&&Q(_+O.row,c,i)||i.setValue(_+O.row,E+O.col,O.value)}else 0<(256&s)&&K(N);R=i.tables,0<(1&s)&&0<(2&s)&&R&&R.JB(A,Y(0,n),Y(0,e),Y(0,r),Y(0,o),l),U&&(l?(t.EB||dt(t,n,e,i,r,o,a,u),0<(2&s)&&ht(t,n,e,i,r,o,a,u)):0<(2&s)&&(F=P("SheetsCalc"))&&F.XB(t,n,e,i,r,o,a,u,c,d),0<(1&s))&&0<(2&s)&&R&&R.qB(A)}finally{b&&(t.resumeCalcService(!1),i.resumeCalcService(!1))}if(0<(4&s)&&st(t,n,e,i,r,o,a,u,c,l,d),0<(128&s)&&ct(t,n,e,i,r,o,a,u,c,f,l,d),0<(1024&s)&&lt(t,n,e,i,r,o,a,u,c,f,l,d),0<(16&s)&&q(t,n,e,i,r,o,a,u,l,d),0<(8&s)&&(n<0&&$(t,e,i,o,u,l),e<0)&&tt(t,n,i,r,a,l),0<(32&s)&&(!l&&1===a&&1===u||nt(t,n,e,i,r,o,a,u,l)),n<0&&r<=0&&et(t,e,i,o,u,s,l,d,h),e<0&&o<=0&&it(t,n,i,r,a,s,c,l,d,h),n<0&&r<=0&&e<0&&o<=0&&rt(t,i,s,l),l&&t.UB&&n<0)for(g=u,(m=e)<0&&(m=0,g=V(W(t),W(i))),w=0;w<g;w++)t.getDataColumnName&&t.getDataColumnName(m+w)&&t.Ut.do("setItem",!1,3,m+w,z)}Object.defineProperty(t,"__esModule",{value:!0}),t.staticMembers=void 0,n=P("./dist/core/core.ns.js"),G=P("./dist/core/util/common.js"),r=P("Common"),I=P("./dist/core/core.enum.js"),e=P("CalcEngine"),U=!!e,H=P("./dist/core/util/domUtil.js"),L=r.Common.lt.ht,g=H.GC$.each,z=null,N=void 0,V=Math.min,Y=Math.max,e=new r.Common.ResourceManager(n.SR,"Sheets"),l=e.getResource.bind(e),t.staticMembers={copyTo:function(t,n,e,i,r,o,a,u,s,c,f,l,h){m(t,n,e,i,r,o,a,u,s,c,f,!1,N,l,h)},moveTo:function(t,n,e,i,r,o,a,u,s,c,f,l){var h=3;t===i&&t.NMi&&(h=0),m(t,n,e,i,r,o,a,u,s,N,h,!0,c,f,l)}}},"./dist/core/worksheet/worksheet-ui.js":function(t,n,c){"use strict";var e,s,i,g,r,o,a,u,f,l,h,m,d,a,v;function p(t){return"number"==typeof t}function b(t){return"string"==typeof t}function y(t){return parseInt(t,10)}function w(t){return Math.abs(t)}function M(t,n){var s=t,c=n;return function(t){var n,e,i,r,o,a,u,n=this,e=n.sheet,i=n.row,r=n.col,o=n.sheetArea;if(0===arguments.length)return s.call(e,i,r,o);if(0<=i&&0<=r)for(a=i;a<i+n.rowCount;a++)for(u=r;u<r+n.colCount;u++)C(e,a,u,o)&&c.call(e,a,u,t,o);return n}}function C(t,n,e,i){var r,t,r=t.getRowCount(i),t=t.getColumnCount(i);return e<0&&0<=n&&n<r||n<0&&0<=e&&e<t||0<=n&&n<r&&0<=e&&e<t||-1===n&&-1===e}function S(t,n,e,i,r,o){var a,u;C(t,n,e,o)&&("string"==typeof(a=(a=t.vI(n,e,o))||new s.Style)&&(u=a,(a=new s.Style).parentName=u),"font"===i&&T(t,a,r),a[i]=r,t.setStyle(n,e,a,o))}function T(t,n,e){var i,r,o,o,a;d(n.themeFont)||(r=(i=l()).style,o=n.font,o=(r.font=o)&&r.fontFamily,(a=(r.font=e)&&r.fontFamily)!==o&&(n.themeFont=h))}function A(t,n,e,i,r,o){var a=this;n<0&&(n=i=-1),e<0&&(e=r=-1),a.sheet=t,a.row=n,a.rowCount=d(i)?1:i,a.col=e,a.colCount=d(r)?1:r,a.sheetArea=d(o)?3:o}function I(t){return t=(t=t.replace(/[^\:]+\!/g,"")).replace(/\$/g,"")}function x(t){var t,n,t,e,i,r,r,o,a,u,n,s,e,c,f,l,h,d,v,t=t.split(":"),n=t[0],t=t[1],e=/([A-Z]+)(\d+)?(\D+)?/;if(isNaN(Number(n))){if(o=(r=n.match(e))[3])return m;i=r[1],r=r[2]}else r=n;if(n&&!t){if(i&&r)return[a=N(r),u=k(i),1,1]}else if(n&&t){if(s=n=void 0,isNaN(Number(t))){if(o=(e=t.match(e))[3])return m;n=e[1],s=e[2]}else s=t;if(!i&&r&&!n&&s)return c=N(r),f=N(s),[a=Math.min(c,f),-1,l=w(c-f)+1,-1];if(i&&!r&&n&&!s)return h=k(i),d=k(n),[-1,u=Math.min(h,d),-1,v=w(h-d)+1];if(i&&r&&n&&s)return c=N(r),f=N(s),h=k(i),d=k(n),a=Math.min(c,f),l=w(c-f)+1,[a,u=Math.min(h,d),l,v=w(h-d)+1]}return m}function N(t){return y(t)-1}function k(t){for(var n,e,i,r,o,a,n=64,e=26,i=0,r=t.length,o=0;o<r;o++)a=t[o].charCodeAt(0)-64,i+=Math.pow(26,r-o-1)*a;return i-1}Object.defineProperty(n,"__esModule",{value:!0}),n.$B=n.tL=n.CellRange=void 0,e=c("./dist/core/worksheet/worksheet.js"),s=c("./dist/core/worksheet/style.js"),i=c("./dist/core/util/domUtil.js"),g=c("./dist/core/util/common.js"),r=c("Common"),o=c("./dist/core/core.enum.js"),a=c("CalcEngine"),u=c("./dist/core/worksheet/clipboardhelper.js"),f=!!a,l=g.util.N0,h=void 0,m=null,d=r.Common.lt.ht,a=e.Worksheet.prototype,A.prototype.tag=function(t){var n=this,e=n.sheet,i=n.row,r=n.col,o=n.rowCount,a=n.colCount,u=n.sheetArea,s,c;if(0===arguments.length)return e.getTag(i,r,u);if(0<=i&&0<=r)for(s=i;s<i+o;s++)for(c=r;c<r+a;c++)e.setTag(s,c,t,u);else if(0<=i)for(s=i;s<i+o;s++)e.setTag(s,-1,t,u);else if(0<=r)for(c=r;c<r+a;c++)e.setTag(-1,c,t,u);return n},A.prototype.width=function(t){var n,e,i,r,o,a,n=this,e=n.sheet,i=n.row,r=n.col,o=n.sheetArea;if(0!==arguments.length){if(i<0)for(a=0;a<n.colCount;a++)e.setColumnWidth(a+r,t,o);return n}if(i<0)return e.getColumnWidth(r,o)},A.prototype.height=function(t){var n,e,i,r,o,a,n=this,e=n.sheet,i=n.row,r=n.col,o=n.sheetArea;if(0!==arguments.length){if(r<0)for(a=0;a<n.rowCount;a++)e.setRowHeight(a+i,t,o);return n}if(r<0)return e.getRowHeight(i,o)},A.prototype.visible=function(t){var n,e,i,r,o,a,u,n=this,e=n.sheet,i=n.row,r=n.col,o=n.sheetArea;if(0===arguments.length)return r<0&&0<=i?e.getRowVisible(i,o):0<=r&&i<0?e.getColumnVisible(r,o):void 0;if(r<0&&0<=i)for(a=0;a<n.rowCount;a++)e.setRowVisible(a+i,t,o);else if(0<=r&&i<0)for(u=0;u<n.colCount;u++)e.setColumnVisible(u+r,t,o);return n},A.prototype.resizable=function(t){var n,e,i,r,o,a,u,n=this,e=n.sheet,i=n.row,r=n.col,o=n.sheetArea;if(0===arguments.length)return r<0&&0<=i?e.getRowResizable(i,o):0<=r&&i<0?e.getColumnResizable(r,o):void 0;if(r<0&&0<=i)for(a=0;a<n.rowCount;a++)e.setRowResizable(a+i,t,o);else if(0<=r&&i<0)for(u=0;u<n.colCount;u++)e.setColumnResizable(u+r,t,o);return n},A.prototype.l0=function(t){var n=this;return n.sheet.l0(n.row,n.col,t,n.sheetArea)},A.prototype.R5=function(e,i){var t=this,r=t.sheet,o=t.sheetArea;return t.nL(function(t,n){S(r,t,n,e,i,o)}),t},A.prototype.nL=function(t){var n,e,i,r,o,a,n=this,e=n.sheet,i=n.row+n.rowCount,r=n.col+n.colCount;if(e.suspendPaint(),0<=n.row&&0<=n.col)for(o=n.row;o<i;o++)for(a=n.col;a<r;a++)t.call(n,o,a);else if(0<=n.row)for(o=n.row;o<i;o++)t.call(n,o,-1);else if(0<=n.col)for(a=n.col;a<r;a++)t.call(n,-1,a);else-1===n.row&&-1===n.col&&-1===n.rowCount&&-1===n.colCount&&t.call(n,-1,-1);e.resumePaint()},A.prototype.setStyleName=function(e){var i=this;i.nL(function(t,n){i.sheet.setStyleName(t,n,e,i.sheetArea)})},A.prototype.setStyle=function(e){var i=this;i.nL(function(t,n){i.sheet.setStyle(t,n,e.clone(),i.sheetArea)})},A.prototype.clear=function(t){var n=this;n.sheet.clear(n.row,n.col,n.rowCount,n.colCount,n.sheetArea,t)},A.prototype.setBorder=function(t,n){var e,i,r,o,a,u,s,c,f,l,h,d,v,m,e=this,i=e.sheet,r=e.sheetArea;i.suspendPaint();try{if(o=new g.Range(e.row,e.col,e.rowCount,e.colCount),u=(a=i.JS(o,r)).row,s=a.col,c=a.rowCount,f=a.colCount,h=l=void 0,d=n.all,v=n.outline,m=n.inside,n.left||d||v)for(l=0;l<c;l++)i.getCell(u+l,s,r).borderLeft(t);if(n.top||d||v)for(h=0;h<f;h++)i.getCell(u,s+h,r).borderTop(t);if(n.right||d||v)for(l=0;l<c;l++)i.getCell(u+l,s+f-1,r).borderRight(t);if(n.bottom||d||v)for(h=0;h<f;h++)i.getCell(u+c-1,s+h,r).borderBottom(t);if(n.diagonalUp)for(l=0;l<c;l++)for(h=0;h<f;h++)i.getCell(u+l,s+h,r).diagonalUp(t);if(n.diagonalDown)for(l=0;l<c;l++)for(h=0;h<f;h++)i.getCell(u+l,s+h,r).diagonalDown(t);if(n.innerHorizontal||d||m)for(l=0;l<c-1;l++)for(h=0;h<f;h++)i.getCell(u+l,s+h,r).borderBottom(t),i.getCell(u+l+1,s+h,r).borderTop(t);if(n.innerVertical||d||m)for(h=0;h<f-1;h++)for(l=0;l<c;l++)i.getCell(u+l,s+h,r).borderRight(t),i.getCell(u+l,s+h+1,r).borderLeft(t)}finally{i.resumePaint()}},A.prototype.toHtml=function(t,n){void 0===t&&(t=o.HeaderOptions.noHeaders),void 0===n&&(n=!0);var e=this;return e.sheetArea===o.SheetArea.corner?"":u.yM.KS(e.sheet,t,e.row,e.rowCount,e.col,e.colCount,e.sheetArea,n,[],[],!0,!0,n,!0)},A.p0=M,v=A,(n.CellRange=v).prototype.value=M(a.getValue,a.setValue),v.prototype.text=M(a.getText,a.setText),v.prototype.D5=M(function(t,n){return f&&this.getFormula(t,n)},function(t,n,e,i){f&&this.setFormula(t,n,e,i)}),v.prototype.formula=function(t,n){if(!n)return 0===arguments.length?this.D5():this.D5(t);f&&this.sheet.eL(this.row,this.col,this.rowCount,this.colCount,t)},v.prototype.styleName=M(a.getStyleName,a.setStyleName),i.GC$.each(["backColor","foreColor","hAlign","vAlign","themeFont","font","formatter","borderLeft","borderTop","borderRight","borderBottom","diagonalDown","diagonalUp","locked","textIndent","wordWrap","showEllipsis","shrinkToFit","backgroundImage","backgroundImageLayout","cellType","tabStop","textDecoration","imeMode","watermark","cellPadding","labelOptions","quotePrefix","isVerticalText","cellButtons","dropDowns","textOrientation","mask"],function(t,n){v.prototype[n]=function(t){return 0===arguments.length?this.l0(n):this.R5(n,t)}}),n.tL=x,n.$B=k,i.GC$.extend(a,{getRange:function(){var t,n,e,i,r,o,a,u,s,r,a,t=arguments[0];if(b(t)){if(a=t.toUpperCase(),u=this.parent&&1===this.parent.options.referenceStyle)return m;if(o=arguments[1],1<(a=I(a)).split(",").length)return m;if(f){if(!(r=(s=c("SheetsCalc")).formulaToRange(this,a,h,h,o)))return m;n=r.row,e=r.col,i=r.rowCount,r=r.colCount}else{if(!(a=x(a)))return m;n=a[0],e=a[1],i=a[2],r=a[3]}}else p(t)&&(n=t,e=arguments[1],i=arguments[2],r=arguments[3],o=arguments[4]);return new v(this,n,e,i,r,o)},getCell:function(t,n,e){return d(n)&&(n=-1),new v(this,t,n,1,1,e)}})},"./dist/core/worksheet/worksheet.js":function(o,t,r){"use strict";var n,I,a,u,x,E,l,f,m,D,N,e,k,g,i,p,b,W,_,y,e,M,T,h,d,Q,J,K,X,q,$,tt,C,nt,v,j,O,R,B,w,et,it,S,rt,L,ot,at,ut,s,F,st,ct,ft,lt,ht,dt,vt,mt,gt,n,c,pt,bt,yt,wt,Mt,n,n,n;function Ct(t,n){var e,i,r,o,a,u,s,e=[],i=t.Ut.Fj();if(i)for(r in i)if(Q(i,r)&&(o=i[r])&&(n||"n"!==o.rs||(a={row:+r,item:t.getDataItem&&t.getDataItem(+r)},e.push(a)),n)&&"e"===o.rs)for(u in o)if(!v(u)&&(s=o[u])){(a={row:+r,item:t.getDataItem&&t.getDataItem(+r)}).originalItem=o.originalItem,e.push(a);break}return e}function A(t,n,e,i){for(var r,o,r=0,o=n;o<=e;o++)r+=t.Kt(o,i);return r}function P(t,n,e,i){for(var r,o,r=0,o=n;o<=e;o++)r+=t.Gt(o,i);return r}function G(t,n){return t.getColumnCount(n)}function U(t,n){return t.getRowCount(n)}function H(t){return t.frozenTrailingColumnCount()}function z(t){return t.frozenTrailingRowCount()}function St(t){return t.Ny}function Tt(t){return t.Vy}function V(t){return t.frozenColumnCount()}function Y(t){return t.frozenRowCount()}function At(t){return _(t)||t===D.SheetArea.viewport||t===D.SheetArea.rowHeader?D.SheetArea.viewport:t===D.SheetArea.colHeader?t:D.SheetArea.corner}function It(t){return _(t)||t===D.SheetArea.viewport||t===D.SheetArea.colHeader?D.SheetArea.viewport:t===D.SheetArea.rowHeader?t:D.SheetArea.corner}function xt(t,n){var t,n,t=I.util._0(t.font),n=I.util._0(n.font);return t.fontStyle+" "+t.fontWeight+" "+n.fontSize+" "+n.fontFamily}function Nt(t,e,i){Object.defineProperty(t,e,{get:function(){return this["_"+e]},set:function(t){var n=this["_"+e];n!==t&&(this["_"+e]=t,i)&&i(e,t,n)}})}function kt(t,n,e,i){return{row:n,col:e,newValue:t.getValue(n,e),oldValue:i}}function Dt(t){var n,e,i,r;if(t)for(e=(n=t.sheets).length,r=0;r<e;r++)!0===(i=n[r]).iL&&delete i.iL}function _t(t){if(!d(t))for(var n in t)if(!_(t[n])&&!d(t[n]))return;return 1}function Z(t){var i=this;i._id=Z.rL,Z.rL++,i.options=M(wt,function(t,n,e){i.Ob(t,n,e)}),i.Hc(t),i.Vp=new u.Tasks(function(){return this.tasks.pop()},function(){var t=i.parent;return t&&t.ib.eb||i.rt.rb||i.rt.ob||i.rt.ab})}function Et(t,n,e,i,r){var r;-1===n&&-1===e||3===(r=_(r)?3:r)&&(r=t.tables&&t.tables.find(n,e))&&r.oL&&n===r.footerIndex()&&Mt.et(t,"composeTableFooterList",{table:r,row:n,col:e,style:i})}Object.defineProperty(t,"__esModule",{value:!0}),t.Worksheet=t.InvalidType=t.ClearPendingChangeType=t.MAX_COLUMN_COUNT=t.MAX_ROW_COUNT=void 0,n=r("./dist/core/core.ns.js"),I=r("./dist/core/util/common.js"),a=r("./dist/core/util/imageLoader.js"),u=r("./dist/core/util/tasks.js"),x=r("./dist/core/worksheet/style.js"),E=r("./dist/core/worksheet/worksheet-model.js"),l=r("./dist/core/util/domUtil.js"),f=r("./dist/core/celltype/textcelltype.js"),m=r("./dist/core/celltype/headercelltype.js"),D=r("./dist/core/core.enum.js"),N=r("Common"),e=r("CalcEngine"),k=!!e,i=r("./dist/core/util/theme.js"),p=r("./dist/core/worksheet/stylehelper.js"),b=I.util.g0,W=I.util.St,_=N.Common.lt.ht,y=I.util.En,e=I.util.p0,M=I.util.b0,T=I.util.x0,h=l.GC$.each,d=l.GC$.isEmptyObject,Q=N.Common.kh,J=I.util.Z0,K=I.util.V0,X=new RegExp("^\\d*(\\.\\d+)?\\*$"),q=new Date(1899,11,30).getTime(),$=N.Common.zf,tt=document,C=parseInt,nt=parseFloat,v=isNaN,j=null,O=void 0,R=Math.min,B=Math.max,w=Math.floor,et=Math.ceil,it=Math.abs,S=Math.round,rt="undefined",L="string",ot="width",at="height",ut="black",s="tag",F="onLayoutChanged",st="beforeLayoutChanged",ct="onPaintSuspend",ft="isVisible",lt="starSize",ht="resizable",dt=".gcSheet",vt=".gcSheetInternal",mt="columnHeaderFitMode",t.MAX_ROW_COUNT=1048576,t.MAX_COLUMN_COUNT=16384,gt={backColor:!0,foreColor:!0,font:!0,borderLeft:!0,borderTop:!0,borderRight:!0,borderBottom:!0,textDecoration:!0,cellType:!0,formatter:!0},n=new N.Common.ResourceManager(n.SR,"Sheets"),c=n.getResource.bind(n),pt=I.UsedRangeUtil.vh,(n=bt=t.ClearPendingChangeType||(t.ClearPendingChangeType={}))[n.dirty=1]="dirty",n[n.insert=2]="insert",n[n.delete=4]="delete",(n=yt=t.InvalidType||(t.InvalidType={}))[n.setFormula=0]="setFormula",n[n.copyPaste=1]="copyPaste",n[n.dragFill=2]="dragFill",n[n.dragDrop=3]="dragDrop",n[n.changePartOfArrayFormula=4]="changePartOfArrayFormula",n[n.changeSheetName=5]="changeSheetName",n[n.table=6]="table",n[n.hideSheet=7]="hideSheet",n[n.pivotTable=8]="pivotTable",n[n.PTOverlapPT=9]="PTOverlapPT",wt={rowHeaderVisible:!0,colHeaderVisible:!0,clipBoardOptions:0,frozenlineColor:ut,rowHeaderAutoText:1,colHeaderAutoText:2,rowHeaderAutoTextIndex:-1,colHeaderAutoTextIndex:-1,sheetTabColor:j,selectionBackColor:j,selectionBorderColor:j,allowCellOverflow:!0,showFormulas:!1,showZeros:!0,isProtected:!1,protectionOptions:{},gridline:{},reversalTrailingResizeOrder:!1,keepUnknownFormulas:!1,sheetAreaOffset:{left:0,top:0}},Z.prototype.sortRange=function(t,n,e,i,r,o,a,u,s){return!1},Z.prototype.Ob=function(t,e,n){var i,r,o,a,u,s,i=this,r=i.parent;switch(t){case"allowCellOverflow":case"showFormulas":case"showZeros":case"colHeaderAutoText":case"colHeaderAutoTextIndex":case"colHeaderVisible":case"frozenlineColor":case"rowHeaderAutoText":case"rowHeaderAutoTextIndex":case"rowHeaderVisible":case"selectionBackColor":case"selectionBorderColor":case"reversalTrailingResizeOrder":i.zw();break;case"sheetAreaOffset":o=function(t,n){n<0&&(i.options.sheetAreaOffset[t]=0),i.zw()},a=i.options.sheetAreaOffset,["left","top"].forEach(function(t){var n=e[t];Nt(a,t,o),a[t]=n});break;case"gridline":u=function(){i.zw()},s=i.options.gridline,["color","showHorizontalGridline","showVerticalGridline"].forEach(function(t){var n=e[t];Nt(s,t,u),s[t]=n});break;case"isProtected":e&&r&&r.undoManager().aL(function(t){return t.sheetId!==i._id}),i.uL(),Z.et(i,"onProtectChanged"),i.zw();break;case"protectionOptions":i.uL(),Z.et(i,"onProtectChanged");break;case"sheetTabColor":r&&r.Xg();break;case"keepUnknownFormulas":i.options.keepUnknownFormulas=e}},Z.prototype.getUsedRange=function(t){var n,e,i,r,o,a,u;return!_(t)&&(i=(e=(n=this).Ut).getUsedRange(t)||{},r=n.getRowCount(),o=n.getColumnCount(),t&D.UsedRangeType.formula&&k&&(u=(a=n.b3()).usedRange,_(u)||pt(i,u.getUsedRange())),pt(i,n.rowOutlines.getUsedRange(t)),pt(i,n.columnOutlines.getUsedRange(t)),Z.et(n,"getUsedRange",{type:t,range:i}),i)&&0<Object.keys(i).length?(i.minRow<0&&(i.minRow=0,i.maxRow=r-1),i.minCol<0&&(i.minCol=0,i.maxCol=o-1),i.maxRow>=r&&(i.maxRow=r-1),i.maxCol>=o&&(i.maxCol=o-1),new I.Range(i.minRow,i.minCol,i.maxRow-i.minRow+1,i.maxCol-i.minCol+1)):j},Z.prototype.name=function(t){var n=this,e=n.parent;if(0===arguments.length)return n.Ut?n.Ut.getName():"";if(T(t,e?e.sheets:null,n))return n.ub(t),e&&e.Xg(),n;throw c().Exp_NotSupported},Z.prototype.isSelected=function(t){return this.b2(t)},Z.prototype.b2=function(t,n){var e,i,r,o,a,u,e=this,i=e.parent,r=!!e.Ut&&e.Ut.Xj();return _(t)?r:(t!==r&&(o=e.name(),a=i&&i._se(o),u=void 0,n&&(u={oldValue:r,newValue:t,sheetName:o,propertyName:"isSelected",cancel:!1,sheetIndex:a,sheetPosition:i&&i.getSheetPosition(o)},i)&&i.ki(I.Events.SheetChanging,u),!n||u&&!1===u.cancel)&&(e.Ut.qj(t),i&&i.w2&&i.w2.repaint(),n)&&i&&i.ki(I.Events.SheetChanged,{oldValue:r,newValue:t,sheetName:o,propertyName:"isSelected",sheetIndex:a,sheetPosition:i&&i.getSheetPosition(o)}),e)},Z.prototype.ub=function(t,n){var e,i,e=this,i=e.name();n||Z.et(e,"beforeSetName",{oldName:i,newName:t}),this.Ut.do("setName",t),n||Z.et(e,"setName",{oldName:i,newName:t})},Z.prototype.addRows=function(t,n,e){this.sfe(t,n,e)},Z.prototype.sfe=function(t,n,e,i){var r,o,a,u,s;if((e=At(r=e=void 0===e?D.SheetArea.viewport:e))!==D.SheetArea.corner&&!(n<=0)){a=U(o=this,e),(t<0||a<t)&&(t=a),o.suspendPaint();try{u="addRows",o.kj(t,r,u,n,a)&&(0===o.Ut.P8&&o.parent&&o.parent.Wp.clear(),o.sL(!1,e),s={changeType:"addingRows",row:t,rowCount:n,canAdd:!0,sheetArea:e},Z.et(o,F,s),s.canAdd)&&(_(s.newRow)||(t=s.newRow),this.Ut.do("addRows",t,n,O,O,e),o.Ww=!0,Z.et(o,F,{changeType:u,row:t,oldValue:a,rowCount:n,rowExpand:i,sheetArea:e}),Z.et(o,F,{changeType:"addRows2",row:t,oldValue:a,rowCount:n,sheetArea:e}),e===D.SheetArea.viewport&&o.tables&&o.tables.cL(!0,t),o.dj(t,r,u,n,a))}finally{o.sL(!0,e),o.resumePaint()}}},Z.prototype.sL=function(t,n){var e,i,r;(n=void 0===n?D.SheetArea.viewport:n)===D.SheetArea.viewport&&(i=(e=this).ui,r=e.ci,e.Ut.setCellState(i,r,D.CellStatesType.active,t,n))},Z.prototype.deleteRows=function(t,n,e){var i,r,o,a,u,s,c,f,l,h,d,v,m;if((e=At(i=e=void 0===e?D.SheetArea.viewport:e))!==D.SheetArea.corner&&(o=U(r=this,e),!(t<0||o<=t||n<=0))){r.suspendPaint();try{if(a="deleteRows",r.kj(t,i,a,n,o)&&(0===r.Ut.P8&&r.parent&&r.parent.Wp.clear(),r.sL(!1,e),u={changeType:"deletingRows",row:t,rowCount:n,canDelete:!0,sheetArea:e},Z.et(r,F,u),u.canDelete)){if(e===D.SheetArea.viewport&&r._j(t,n,0,this.getColumnCount()),r.Ut.do("deleteRows",t,n,O,e),0<=(s=r.Tb)){for(c=-1,f=Y(r),l=s;f<=l;l--)if(r.getRowVisible(l)&&0<r.Gt(l)){c=l;break}s!==(c=-1===c?0:c)&&r.$A(c)}h=U(r),r.getActiveRowIndex()>=h&&(d=h-1,v=r.getActiveColumnIndex(),(m=r.getSpan(d,v))&&(d=m.row,v=m.col),r.setActiveCell(d,v)),r.Ww=!0,Z.et(r,F,{changeType:a,row:t,oldValue:o,rowCount:n,sheetArea:e}),e===D.SheetArea.viewport&&r.tables&&r.tables.cL(!0,t),r.dj(t,i,a,n,o)}}finally{r.sL(!0,e),r.resumePaint()}}},Z.prototype.addColumns=function(t,n,e){var i,r,o,a,u;(e=It(i=e=void 0===e?D.SheetArea.viewport:e))===D.SheetArea.corner||n<=0||(o=G(r=this,e),r.Dj(t=t<0||o<t?o:t,i,a="addColumns",n,o)&&(0===r.Ut.P8&&r.parent&&r.parent.Wp.clear(),Z.et(r,F,u={changeType:"addingColumns",col:t,colCount:n,canAdd:!0,sheetArea:e}),u.canAdd)&&(r.sL(!1,e),r.Ut.do("addColumns",t,n,O,e),r.Zw=!0,Z.et(r,F,{changeType:a,col:t,oldValue:o,colCount:n,sheetArea:e}),Z.et(r,F,{changeType:"addColumns2",col:t,oldValue:o,colCount:n,sheetArea:e}),e===D.SheetArea.viewport&&r.tables&&r.tables.cL(!1,t),r.vj(t,i,a,n,o),r.sL(!0,e),r.zw()))},Z.prototype.deleteColumns=function(t,n,e){var i,r,o,a,u,u,s,c,f,u,l,u,h;if((e=It(i=e=void 0===e?D.SheetArea.viewport:e))!==D.SheetArea.corner&&(o=G(r=this,e),!(t<0||o<=t||n<=0))&&r.Dj(t,i,a="deleteColumns",n,o)&&(0===r.Ut.P8&&r.parent&&r.parent.Wp.clear(),Z.et(r,F,u={changeType:"deletingColumns",col:t,colCount:n,canDelete:!0,sheetArea:e}),u.canDelete)){if(r.sL(!1,e),e===D.SheetArea.viewport&&r._j(0,this.getRowCount(),t,n),r.Ut.do("deleteColumns",t,n,O,e),0<=(u=r.Ab)){for(s=-1,c=V(r),f=u;c<=f;f--)if(r.getColumnVisible(f)&&0<r.nn(f)){s=f;break}u!==(s=-1===s?0:s)&&r.o9(s)}u=G(r),r.getActiveColumnIndex()>=u&&(l=r.getActiveRowIndex(),(h=r.getSpan(l,u=u-1))&&(l=h.row,u=h.col),r.setActiveCell(l,u)),r.Zw=!0,Z.et(r,F,{changeType:a,col:t,oldValue:o,colCount:n,sheetArea:e}),Z.et(r,F,{changeType:"deleteColumns2",col:t,oldValue:o,colCount:n,sheetArea:e}),e===D.SheetArea.viewport&&r.tables&&r.tables.cL(!1,t),r.vj(t,i,a,n,o),r.sL(!0,e),r.zw()}},Z.prototype.frozenTrailingRowCount=function(t,n){var e=this;return 0===arguments.length?e.fL:(0<=t&&(_(n)&&(n=!0),e.fL=t,e.Ny=n,e.Ww=!0,e.zw()),e)},Z.prototype.frozenTrailingColumnCount=function(t,n){var e=this;return 0===arguments.length?e.lL:(0<=t&&(_(n)&&(n=!0),e.lL=t,e.Vy=n,e.Zw=!0,e.zw()),e)},Z.prototype.getFrozenTrailingState=function(t){var n=this;return t?n.Ny:n.Vy},Z.prototype.Gy=function(t){var n,e,n=Tt(this),e=t.hL;return n?e+t.Uy:e},Z.prototype.Sy=function(t){var n,e,n=St(this),e=t.A6;return n?e+t.Ty:e},Z.prototype.getRowCount=function(t){return 0===t?0:this.Ut.getRowCount(t)},Z.prototype.getColumnCount=function(t){return 0===t?0:this.Ut.getColumnCount(t)},Z.prototype.setRowCount=function(t,n,e){var i,e,e;_(n)&&(n=3),i=this,_(e)||(e=i.getUsedRange(e),_(e))||(t=Math.max(t,e.row+e.rowCount)),Z.et(i,F,e={changeType:"settingRowCount",rowCount:t,sheetArea:n,canSet:!0}),e.canSet&&i.setRowCountCore(t,n)},Z.prototype.setRowCountCore=function(t,n){var e,i;t=C(t,10),v(t)||(_(n)&&(n=3),i=(e=this).getRowCount(n),t<0)||t===i||(3===n||2===n?(e.Ut.do("setRowCount",t,n),Y(e)>t&&e.frozenRowCount(t)):1===n&&e.Ut.do("setRowCount",t,n),Z.et(e,F,{changeType:"setRowCount",row:i,rowCount:t,sheetArea:n}),e.Ww=!0,e.ui>=t&&(3===n||2===n)&&e.setActiveCell(t-1,e.getActiveColumnIndex()),e.zw(),e.clearPendingChanges())},Z.prototype.setColumnCount=function(t,n,e){var i,r,e;t=C(t,10),v(t)||(r=(i=this).getColumnCount(n),t<0)||t===r||(_(n)&&(n=3),_(e)||(e=i.getUsedRange(e),_(e))||(t=Math.max(t,e.col+e.colCount)),3===n||1===n?(i.Ut.do("setColumnCount",t,n),V(i)>t&&i.frozenColumnCount(t)):2===n&&i.Ut.do("setColumnCount",t,n),Z.et(i,F,{changeType:"setColumnCount",row:r,colCount:t,sheetArea:n}),i.Zw=!0,i.ci>=t&&(3===n||1===n)&&i.setActiveCell(i.getActiveRowIndex(),t-1),i.zw(),i.clearPendingChanges())},Z.prototype.getFreeAreaRowCount=function(t){var n;return this.Ut.getFreeAreaRowCount(t)},Z.prototype.getFreeAreaColumnCount=function(t){var n;return this.Ut.getFreeAreaColumnCount(t)},Z.prototype.setFreeAreaRowCount=function(t,n){var e;this.Ut.setFreeAreaRowCount(t,n)},Z.prototype.setFreeAreaColumnCount=function(t,n){var e;this.Ut.setFreeAreaColumnCount(t,n)},Z.prototype.w8=function(t){var n,e,i,r,o;if(!_(t)&&(n=t.rows,i=!1,this.filterRowsVisibleInfo)){if(r=this.filterRowsVisibleInfo.rowsVisibleInfo||{},n&&0<n.length)for(o=0;o<n.length;o++)(e=n[o])&&e.isFilter&&(e.visible=!0,delete e.isFilter,i=!(r[o]=!1));i&&(this.filterRowsVisibleInfo.rowsVisibleInfo=r,this.filterRowsVisibleInfo.empty=!1)}},Z.prototype.Oe=function(t,n,e){var i=this;return(g=g||r("SheetsCalc"))?i.dL(t,n,e):O},Z.prototype.t0=function(t,n,e){var i,e,r,e,e,i,i=this;if(3===e)return i.options.showFormulas?(e=i.getFormula(t,n,3,!0))?"="!==e[0]?"="+e:e:i.Ut&&i.Ut.t8&&i.Ut.t8.getAnchorInfo(t,n)?"":void 0:i.options.showZeros||!(0===(e=i.getValue(t,n,3))||e instanceof Date&&e.getTime()===q)||(e=(e=i.getFormatter(t,n))||(i=i.getStyle(t,n))&&i._autoFormatter&&i._autoFormatter.formatCached)&&("="===e[0]||3<=e.split(";").length)?void 0:""},Z.prototype.getText=function(t,n,e){var i,r,o;return _(e)&&(e=3),r=(i=this).t0(t,n,e),_(r)?(o=i.getValue(t,n,e),i.vL(t,n,o,e,!0)):r},Z.prototype.setText=function(t,n,e,i){var r,o,a,a,u,s,c,r=this;_(i)&&(i=3),o=e,Z.et(r,"settingText",a={value:e}),a=e=a.value,u=r.getCellType(t,n,i),s=r.getFormatter&&r.getFormatter(t,n,i),u&&s&&!W(s)&&(a=u.parse(o,s,c={sheet:r,row:t,col:n,sheetArea:i}),a=_(a)?e:a),r.YI(t,n,a,i),r.zw()},Z.prototype.getValue=function(t,n,e,i){var r,o,a,u,s,a,c,i,i,r,r,i;return 0===e?j:(_(e)&&(e=3),o=(r=this).options,u=(a=r.Ut).getRowCount(e),s=a.getColumnCount(e),a=r.mL(a,t,n,e,i),1===e?_(a)&&((i=r.H3)&&i._dataSource&&(i=r.Ut.q_(!1,3,n),r=o.colHeaderAutoTextIndex,i)&&(0<=r&&t===r||-1===r&&t===u-1)&&(a=i.displayName||i.name),_(a))&&t===(c=(c=o.colHeaderAutoTextIndex)<0||u<=c?u-1:c)&&(2===(r=o.colHeaderAutoText)?a=I.util.Vf(n+1):1===r&&(a=n+1)):2===e&&_(a)&&n===(c=(c=o.rowHeaderAutoTextIndex)<0||s<=c?s-1:c)&&(2===(i=o.rowHeaderAutoText)?a=I.util.Vf(t+1):1===i&&(a=t+1)),a)},Z.prototype.setValue=function(t,n,e,i,r){this.YI(t,n,e,i,r);var t=this.parent,n=t&&t.getActiveSheet();(n&&!0===n.iL?n:this).zw(),Dt(t)},Z.prototype.Ij=function(t,n,e,i){var r=this;!i&&k&&r.gL(t,n,e),r.Q1i&&r.Q1i(t,n,1,1,e)},Z.prototype.Tj=function(){var t=this.conditionalFormats;t&&t.dl()},Z.prototype.Lj=function(t,a,u){var n,s;t&&t.parent&&t.parent.sheets&&(n=t.parent.sheets,s=t._id,n.forEach(function(o){var t=o.cameraShapes;t&&0<t.length&&t.forEach(function(t){var n,e,i,r;if(t.cameraImageCache&&(e=(n=t.JVV).ytV.AnV)&&(o._id===s||e.sheet&&e.sheet._id===s))for(i=0;i<a.length;i++){if(r=e.cellRange,void 0!==a[i].row&&void 0===a[i].col&&2===u&&a[i].row>=r.row&&a[i].row<r.row+r.rowCount){t.cameraImageCache=null,n.ytV.rtV&&n.mtV();break}if(void 0===a[i].row&&void 0!==a[i].col&&1===u&&a[i].col>=r.col&&a[i].col<r.col+r.colCount){t.cameraImageCache=null,n.ytV.rtV&&n.mtV();break}if(0===u){if(void 0===a[i].rowCount&&void 0===a[i].colCount&&r.contains(a[i].row,a[i].col)){t.cameraImageCache=null;break}if(void 0!==a[i].rowCount&&void 0!==a[i].colCount&&r.intersect(a[i].row,a[i].col,a[i].rowCount,a[i].colCount)){t.cameraImageCache=null;break}}}})}))},Z.prototype.YI=function(t,n,e,i,r){var o,a,u,s;0===i||(_(i)&&(i=3),u=(a=(o=this).Ut).getRowCount(i),s=a.getColumnCount(i),t<0)||u<=t||n<0||s<=n||(e=J(e),e=b(e),a.do("setValue",t,n,e,i),o.Ij(t,n,i,r),o.Tj())},Z.prototype.Il=function(t,n,e,i,r,o){var a=this,i,i=a.getActualStyle(t,n,e,i,r,o);return Et(a,t,n,i,e),i},Z.prototype.getActualStyle=function(t,n,e,i,r,o,a){var u,s,c,f,l,h,d,d,d,v,m,g,p,b,y,g,y,h,w,M,C,S,S,g,T,A,p,b,l;if(0===(e=_(e)?3:e))return new x.Style;if(-1===t&&-1===n)return this.getDefaultStyle(e);if(d=(u=this).pL,g="__spreadJSDefault",y="__undefined",h=this.Ut,3===e&&u.pivotTables&&(M=(w=u.pivotTables.findPivotTable(t,n)||j)&&w.hqt(t,n)),f=h.getStyle(t,n,e),l=h.getStyle(t,-1,e),h=h.getStyle(-1,n,e),l=l||j,h=h||j,a&&(-1===t&&(l=j),-1===n)&&(h=j),p=y,C=u.parent&&u.parent.Gie,(f=f||j)&&(p=f.charAt?f:g+f._id),b=y,l&&(b=l.charAt?l:g+l._id),y=y,h&&(y=h.charAt?h:g+h._id),d=(g=d[e])[p],S=u.tables,(S=3===e&&S&&!o?S.find(t,n):j)||w||u.NMi||((v=(d=d||(g[p]={}))[b])?m=v[y]:v=d[b]={}),m||(c=u.getCompositeStyle(t,n,e,f,l,h,S,O,o,M,a,w)),(3===e||t<u.getFreeAreaRowCount(e)||1===e&&u.NMi)&&!i&&(g=u.conditionalFormats)&&(s=g.bL(s,t,n,e)),(3===e||t<u.getFreeAreaRowCount(e))&&!i&&(_(s)||_(s.foreColor))&&(T=s&&s.formatter||m&&m.formatter||c&&c.formatter||f&&f._autoFormatter)&&!o&&!W(T)){try{(A=N.Formatter&&N.Formatter.GeneralFormatter)&&typeof T==L&&(T=I.Be.Ue(T))}catch(t){}(T.hasFormattedColor&&T.hasFormattedColor()||N.Formatter&&T instanceof N.Formatter.FormatterBase)&&(p={conditionalForeColor:j},T.format(u.getValue(t,n,e),p),p.conditionalForeColor)&&((s=_(s)?new x.Style:s).foreColor=p.conditionalForeColor)}if(s)s.h5(d=m||c),s.font&&d&&d.font&&s.font!==d.font&&(s.font=xt(s,d)),c=s;else if(m)return!u.cellStates||i||C||(b=u.cellStates.getStyle(t,n,e,j,m.locked))&&(b.h5(m),(m=b).v5(u.hl)),r?m:m.clone(!0);return a||(_(c.locked)&&(c.locked=!0),c=c.v5(u.hl)),s||S||w||u.NMi||(v[y]=c.clone(!0)),!u.cellStates||i||C||(l=u.cellStates.getStyle(t,n,e,j,c.locked))&&(l.h5(c),c=(c=l).v5(u.hl)),c},Z.prototype.l0=function(t,n,e,i){var r,o,a,u,s,c,f,l,h,d,v,h,v,m,g,g;if(0===i)return O;if(_(i)&&(i=3),s=(r=this).Ut,f=!1,3===i){if("foreColor"===e){h=r.l0(t,n,"formatter",i);try{(d=N.Formatter&&N.Formatter.GeneralFormatter)&&typeof h==L&&(h=I.Be.Ue(h))}catch(t){}h&&(h.hasFormattedColor&&h.hasFormattedColor()||N.Formatter&&h instanceof N.Formatter.FormatterBase)&&(v={conditionalForeColor:j},h.format(r.getValue(t,n),v),v.conditionalForeColor)&&(c=v.conditionalForeColor,f=!0)}(h=r.conditionalFormats)&&0<h.count()&&(f=(v=h.wL(t,n,e,i)).yL,c=v.Y6)}for(m=0;!f&&m<=4;)if(0===m?o=s.getStyle(t,n,i):1===m?(g=r.tables,(g=3===i&&g?g.find(t,n):j)&&gt[e]&&(o=g.ML(t,n,e))):o=2===m?s.getStyle(t,-1,i):3===m?s.getStyle(-1,n,i):r.getDefaultStyle(i),m++,o=o&&o.charAt&&typeof o==L?r.u8(o):o){if("font"===e&&o.themeFont&&!l&&(l=o.themeFont),o[e]!==O){c=o[e],f=!0;break}for(a=o.parentName;a&&(u=r.u8(a));){if(u[e]!==O){c=u[e],f=!0;break}a=u.parentName}}return"locked"===e?!!_(c)||c:f||l?("foreColor"!==e&&"backColor"!==e&&"font"!==e&&"borderLeft"!==e&&"borderTop"!==e&&"borderRight"!==e&&"borderBottom"!==e||((o=new x.Style)[e]=c,"font"===e&&l&&(o.themeFont=l),o.v5(r.hl),c=o[e]),c):O},Z.prototype.getStyle=function(t,n,e){return this.Z_(t,n,e,!0)},Z.prototype.Z_=function(t,n,e,i){var r,t,n,e;if(0!==(e=_(e)?3:e)){if((t=(r=this.Ut).getStyle(t,n,e))instanceof x.Style)return i&&this.r3(),t;if(typeof t==L&&(n=this.u8(t))!==j&&n!==O)return(e=new x.Style).h5(n,!1),i&&this.r3(),e}return j},Z.prototype.addNamedStyle=function(t){this.$p(t),this.zw()},Z.prototype.$p=function(t){if(t){if(!t.name)throw new Error(c().Exp_EmptyNamedStyle);var n=t.name.toUpperCase();this.Hp[n]=t}},Z.prototype.getNamedStyle=function(t){return this.i3(t,!0)},Z.prototype.i3=function(t,n){var e,e,e=this.Hp;return e&&t?((e=e[t=t.toUpperCase()])&&n&&this.r3(),e):j},Z.prototype.r3=function(){this.pL=[{},{},{},{}]},Z.prototype.removeNamedStyle=function(t){var n,e,n=this.Hp;n&&t&&(t=t.toUpperCase(),Q(n,t))&&((e=n[t].formatter)&&"string"==typeof e&&this.parent.bp[e]&&this.parent.o3(e),delete n[t],this.r3(),this.zw())},Z.prototype.getNamedStyles=function(){var e=[],t=this.Hp;return t&&h(t,function(t,n){e.push(n)}),this.r3(),e},Z.prototype.setStyle=function(t,n,e,i){var r,i;_(i)&&(i=3),e&&e.backColor&&"object"==typeof e.backColor&&p.W.processStops(e.backColor),(r=this).CL(t,n,e,i),-1===t&&-1===n&&(r.Sj[i]=j),-1!==t&&-1!==n||(i=e&&e.validator)&&i.condition()&&4===i.condition().conType()&&i.condition().getExpected(this,t<0?0:t,n<0?0:n),r.r3(),r.zw()},Z.prototype.u5=function(t,n,e,i){var r,o,a,r=this;r.options.isProtected?(o=r.Z_(t,n,i),a=void 0,e?(a=o?o.locked:O,e.locked!==a&&(e.locked=a),r.setStyle(t,n,e,i)):o&&((a=o.locked)!==O&&((e=new x.Style).locked=a),r.setStyle(t,n,e,i))):r.setStyle(t,n,e,i)},Z.prototype.getStyleName=function(t,n,e){var t=this.vI(t,n,e);return t instanceof x.Style?t.name:t},Z.prototype.setStyleName=function(t,n,e,i){var r;typeof e==L&&(_(i)&&(i=3),(r=this).CL(t,n,e,i),-1===t&&-1===n&&(r.Sj[i]=j),r.r3(),r.zw())},Z.prototype.vI=function(t,n,e){var i;return(i=0!==(e=_(e)?3:e)?this.Ut.getStyle(t,n,e):i)||j},Z.prototype.getNamedStyleName=function(t,n,e){var t=this.vI(t,n,e);return"string"==typeof t?t:O},Z.prototype.CL=function(t,n,e,i){var r,o,a,u,s,u,s,u,u,a,o;0!==(i=_(i)?3:i)&&(o=(r=this).vI(t,n,i),u=(a=r.Ut).getRowCount(i),s=a.getColumnCount(i),t<-1||u<=t||n<-1||s<=n||(u=e,s=a.getStyle(t,n,i),(u=(u=typeof u==L?r.u8(u):u)&&u.formatter)&&W(u)&&r.SL(t,n,u),a.do("setStyle",t,n,e,i),u=o&&o.cellType&&o.cellType.typeName||j,a=e&&e.cellType&&e.cellType.typeName||j,t===r.ui&&n===r.ci&&u!==a&&I.hi.A1(r)&&r.rt.aA(),o="[styleinfo]",-1!==t&&-1!==n?r.Rj(o,t,n,i,s,e):-1!==t&&-1===n?r.dj(t,i,o,e,s):-1===t&&-1!==n&&r.vj(n,i,o,e,s)))},Z.prototype.SL=function(t,n,e){var i=this;(g=g||r("SheetsCalc"))&&i.TL(t,n,e)},Z.prototype.getDefaultStyle=function(t){var n,e,i,i,r,n,i;return _(t)&&(t=3),(i=(e=(n=this).Sj)[t])||(0!==t?((r=typeof(r=(i=n.Ut).getStyle(-1,-1,t))==L?n.u8(r):r)||(r=new x.Style,i.do("setStyle",-1,-1,r,t)),n=1===t||2===t,typeof r.hAlign==rt&&(r.hAlign=n?1:3),typeof r.vAlign==rt&&(r.vAlign=n?1:0),typeof r.imeMode==rt&&(r.imeMode=1),r.font||typeof r.themeFont!=rt||(r.themeFont="Body"),e[t]=r):((i=new x.Style).locked=!0,e[t]=i))},Z.prototype.setDefaultStyle=function(t,n){var e=this;0!==(n=_(n)?3:n)&&e.Ut.do("setStyle",-1,-1,t,n),e.Sj[n]=j,e.r3(),e.zw()},Z.prototype.u8=function(t){var n,e,e,n=this.i3(t,!1);return n=n||(e=this.parent)&&e.i3(t,!1),e=j,n&&(e=n.clone(!0),(0,I.AL)(e)),e},Z.prototype.getCompositeStyle=function(t,n,e,i,r,o,a,u,s,c,f,l){var u,h,d,v;if(_(e)&&(e=3),h=this,d=new x.Style,v=!1,0!==e){if(v=h.IL(t,n,e,d,v,i),u)return v?d:i;v=h.xL(t,n,e,d,v,a,s),v=(u=h.NL(t,n,e,d,v,l,s,c)).changed,d=u.destInfo,v=h.kL(t,e,d,v,r),v=h.DL(n,e,d,v,o)}return h._L(e,d,v,f),d},Z.prototype.IL=function(t,n,e,i,r,o){var a,u,s,c,f,f,l,a=this,u=a.Ut,f=u.getRowCount(e),l=u.getColumnCount(e);if(0<=t&&t<f&&0<=n&&n<l&&(f=(f=o!==O?o:u.getStyle(t,n,e))&&f.charAt?a.u8(f):f))for(i.h5(f,!0,10),r=!0,s=f.parentName;s&&(c=a.u8(s));)i.h5(c,!1,10,!0),s=c.parentName;return r},Z.prototype.xL=function(t,n,e,i,r,o,a){var u,s=this.tables;return(o=o!==O||a?o:3===e&&s?s.find(t,n):j)&&!a&&(o.h5(t,n,i),r=!0),r},Z.prototype.NL=function(t,n,e,i,r,o,a,u){var s,c,a,s=this,c=s.pivotTables;return(u=o!==O||a?u:(o=3===e&&c?c.findPivotTable(t,n):j)&&o.hqt(t,n))&&(u.parentName&&(a=s.u8(u.parentName))&&u.h5(a),u.h5(i),i=u,r=!0),o&&(o.wqt(t,n,i),r=!0),{changed:r,destInfo:i}},Z.prototype.kL=function(t,n,e,i,r){var o=this,a=o.Ut,u=a.getRowCount(n),u,s,c;if(0<=t&&t<u&&(u=(u=r!==O?r:a.getStyle(t,-1,n))&&u.charAt?o.u8(u):u))for(e.h5(u,!i,30),i=!0,s=u.parentName;s&&(c=o.u8(s));)e.h5(c,!1,30,!0),s=c.parentName;return i},Z.prototype.DL=function(t,n,e,i,r){var o=this,a=o.Ut,u=a.getColumnCount(n),u,s,c;if(0<=t&&t<u&&(u=(u=r!==O?r:a.getStyle(-1,t,n))&&u.charAt?o.u8(u):u))for(e.h5(u,!i,40),i=!0,s=u.parentName;s&&(c=o.u8(s));)e.h5(c,!1,40,!0),s=c.parentName;return i},Z.prototype._L=function(t,n,e,i){var r,o,a,t,r=this,t=r.getDefaultStyle(t);if(t&&t.charAt?t=r.u8(t):t&&t.clone&&(t=t.clone(!0),(0,I.AL)(t)),t&&!i)for(n.h5(t,!e,50),o=t.parentName;o&&(a=r.u8(o));)n.h5(a,!1,50,!0),o=a.parentName;return e},Z.prototype.getCellType=function(t,n,e){return this.l0(t,n,"cellType",e)||this.$f(e)},Z.prototype.$f=function(t){_(t)&&(t=3);var n,n=(n=this.f7)||(this.f7=new f.Text);return 3===t?n:1===t?new m.ColumnHeader:2===t?new m.RowHeader:0===t?new m.Corner:n},Z.prototype.setCellType=function(t,n,e,i){var r=this.Z_(t,n,i),r;(r=r||new x.Style).cellType=e,this.setStyle(t,n,r,i)},Z.prototype.EL=function(t,n,e,i,r){var o,a,u,s,s,c,f,o=this;if(_(r)&&(r=3),(a=o.Ut).do("clearSpan",t,n,e,i,r),u=(0,I.Ec)(t,n,e,i),s=o.JS(u,r),s=o.jL(s,r),a.do("addSpan",s,r),3===r){for(c=o.getSelections(),f=0;f<c.length;f++)c[f].intersect(t,n,e,i)&&(c[f]=c[f].union(u));a.do("setSelections",c)}o.zw()},Z.prototype.jL=function(t,n){var e,n,i,r,o,t,e=this.getRowCount(n),n=this.getColumnCount(n),i=t.row,r=t.col,o=t.rowCount,t=t.colCount;return(0,I.Ec)(i,r,o=e<i+o?e-i:o,t=n<r+t?n-r:t)},Z.prototype.addSpan=function(t,n,e,i,r){var o,a,u,a,s,u,o=this;if((1!==e||1!==i)&&0!==r&&(a=o.getRowCount(r),u=o.getColumnCount(r),!(a<=t||u<=n||t<-1||n<-1))&&(a=!0,a=k&&(3===r||_(r))&&(a=o.mT(t,n,e,i,!1),o.pivotTables)?a&&o.pivotTables.HYt(t,n,e,i):a)){if((s=o.Ut).GT(t,n,e,i,r))throw new Error(c().Exp_InvalidRange);o.OL&&o.OL(t,n,e,i),o.EL(t,n,e,i,r),Z.et(o,F,u={sheet:o,row:t,col:n,rowCount:e,colCount:i,sheetArea:r,changeType:"addSpan"}),o.ki("spanChanged",u)}},Z.prototype.removeSpan=function(t,n,e){var i,r,o,r,i=this;_(e)&&(e=3),(o=(r=i.Ut).findSpan(t,n,e))&&o.row===t&&o.col===n&&r.do("removeSpan",o,e),Z.et(i,F,r={sheet:i,row:t,col:n,sheetArea:e,changeType:"removeSpan"}),i.ki("spanChanged",r),i.zw()},Z.prototype.getSpans=function(t,n){return 0===n?[]:this.Ut.getSpans(t,n,!0)},Z.prototype.getSpan=function(t,n,e){return 0===e?j:this.Ut.findSpan(t,n,e)},Z.prototype.repaint=function(t){this.My<=0&&this.Dn&&this.Dn.repaint(t)},Z.prototype.x_=function(t,n,e,i){var r,o,t,n,r=t,o=1,t=this.RL(t,n,e,i);t&&(r=t.row,o=t.rowCount),(n=this.j1(new I.Range(r,-1,o,-1))).y-=2,n.height+=4,this.repaint(n)},Z.prototype.N_=function(t,n,e,i){var r,o,t,n,r=t,o=1,t=this.BL(t,n,e,i);t&&(r=t.col,o=t.colCount),(n=this.j1(new I.Range(-1,r,-1,o))).x-=2,n.width+=4,this.repaint(n)},Z.prototype.LL=function(t,n){var e,i,t,e=this,i=e.Fi(),t=e.j1(new I.Range(-1,t,-1,1));t.y=i.y,t.height=i.height,n&&(t.x-=2,t.width+=4),e.repaint(t)},Z.prototype.RL=function(t,n,e,i){var r,o,a,u,s,c,f,r=this,o=r.yw(e),a=o.length;if(0!==a&&(u=r.s7(n,e,D.SheetArea.viewport,i))){if(u.length>a)for(u=new E.h9,c=s=o[0].col;c<a;c++)(f=r.O_(n,e,D.SheetArea.viewport,t,o[c].col))&&u.push(f);return u.findLargestRow(t)}return j},Z.prototype.BL=function(t,n,e,i){var r,o,a,u,s,c,f,r=this,o=r.dw(n),a=o.length;if(0!==a&&(u=r.s7(n,e,D.SheetArea.viewport,i))){if(u.length>a)for(u=new E.h9,c=s=o[0].row;c<a;c++)(f=r.O_(n,e,D.SheetArea.viewport,o[c].row,t))&&u.push(f);return u.findLargestCol(t)}return j},Z.prototype.OA=function(t,n){var e,i,r,o,a,u,s,c,c,s,f,l,c,h,c,c,d,v,m,c,d,g,s,t,c,d,s,e=this,i=e.parent,r=i&&i.options.scrollbarAppearance===D.ScrollbarAppearance.mobile,o=!1,a=!1,u=i&&i.options.scrollByPixel,s=Y(e),c=V(e),c=c?e.O5(c-1):e.k9(),s=s?e.j5(s-1):e.N9();if(n<e.Ab&&c<=n?(o=!0,e.o9(e.r6(n+1),0)):u&&n===e.Ab&&0!==e.my&&(o=!0,e.o9(n,0)),n>e.rD()&&n<=e.G6()){for(f=0,l=n,c=e.Fi(),h=e.Gy(c),(c=e.Ut.findSpan(t,l))&&(l=c.col+c.colCount-1);l>e.Ab&&!(h<(f+=e.nn(l)));)l--;d=c=void 0,d=u?(l===e.Ab&&f<h&&(f+=e.nn(l)),c=l,h-f):(c=e.O5(l),0),o=!0,e.o9(c,d)}if(t<e.Tb&&s<=t?(a=!0,e.$A(e.nI(t+1),0)):u&&t===e.Tb&&0!==e.ly&&(a=!0,e.$A(t,0)),t>e.iD()&&t<=e.P6()){for(v=0,(c=e.Ut.findSpan(m=t,n))&&(m=c.row+c.rowCount-1),d=e.Fi(),g=e.Sy(d);m>e.Tb&&!(g<(v+=e.Gt(m)));)m--;t=s=void 0,t=u?(m===e.Tb&&v<g&&(v+=e.Gt(m)),s=m,g-v):(s=e.j5(m),0),a=!0,e.$A(s,t)}u||n!==e.G6()||e.o9(e.aB(),0),r&&(c=i.Xb,d=i.zb,s=i.ib,a&&(c.qy(D.ScrollbarState.show),s.$y(!0)),o)&&(d.qy(D.ScrollbarState.show),s.$y(!1))},Z.prototype.hitTest=function(t,n,e,i){var r,o,a,u,s,a,u,s,e,s,s,c,f,a,a,c,a,c,a,u,a,c,u,a,c,u,i,r=this;if(r.Fi(),o={x:t,y:n},a=r.rowOutlines,u=r.columnOutlines,s=!(s=a?a.hitTest(r,t,n):s)&&u?u.hitTest(r,t,n):s)o.outlineHitInfo=s;else{if(a=r.FL(n),u=r.PL(t),o.rowViewportIndex=a,o.colViewportIndex=u,o.row=r.GL(n,a),o.col=r.UL(t,u,n,a,o.row),o.hitTestType=r.C6(a,u),0<=a&&a<=2&&0<=u&&!0!==e&&(s=r.O_(a,u,o.hitTestType,o.row,o.col))&&(o.row=s.row,o.col=s.col),e=r.rt,s=(s=r.IB)&&s.hitTest(o,t,n),f=void 0,!(c=r.tables)||-1===a&&-1===u||(f=-1===a?c.find(r.getActiveRowIndex(),r.getActiveColumnIndex()):c.find(o.row,o.col)),s=s||(a=f&&f.IB)&&a.hitTest(o,t,n),a=c&&!s&&c.HL(t,n,o))return(o.tableSelectInfo=a).table&&a.table.IB&&(o.filterButtonHitInfo=s),o;(c=e.zL&&e.zL(o,t,n))?o.dragMergeInfo=c:(a=e.VL&&e.VL(o,t,n))?o.dragInfo=a:(c=o.col,o.col=r.UL(t,u),o.YL=c,(a=e.bD(o,t,n,5))?o.resizeInfo=a:(o.col=c,delete o.YL,(u=e.ZL?e.ZL(o,t,n):j)?o.formulaRangeHitInfo=u:(c=(a=r.Ut.pI)&&a.hitTest(t,n))?o.commentHitInfo=c:(a=(u=r.WL)&&u.hitTest(t,n,i),c=void 0,(c=r.shapes?r.shapes.hitTest(t,n):c)?o.shapeHitInfo=c:a?o.floatingObjectHitInfo=a:s?o.filterButtonHitInfo=s:(u=f&&!f.QL()&&e.KL&&e.KL(o,f))?o.resizeTableHitInfo=u:o.cellTypeHitInfo=r.JL(o,t,n))))}return i=r.pivotTables&&r.pivotTables.findPivotTable(o.row,o.col),_(i)||(o.pivotTableInfo=i),o},Z.prototype.getCellRect=function(t,n,e,i,r){var o,a,u,u,s,c,a,e,i,o,r,o=3;return-1===e?o=1:-1===i&&(o=2),u=(a=this).Fi(),-1===e&&-1===i?new I.Rect(u.BA,u.LA,u.XC,u.qC):(u=a.ot(),_(e)&&(e=a.C0(t)),_(i)&&(i=a.S0(n)),s=a._y(e,o).findRow(t),c=a.Yy(i,o).findCol(n),(a=a.s7(e,i,o,r).findCell(t,n))?new I.Rect(a.x-u.x,a.y-u.y,a.width,a.height):s&&c?(e=c.x-u.x,i=s.y-u.y,o=c.width,r=s.height,-1!==c.height&&-1!==c.y&&(r=s.height*c.height,i=s.height*c.y),new I.Rect(e,i,o,r)):new I.Rect)},Z.prototype.XA=function(t,n,e){var i,r,o,a,u,s,c,s,a,u,c,s,i=this,r=i.rt,o=!1,a=i.ui,u=i.ci;_(t)||(i.ui=t,o=!0),_(n)||(i.ci=n,o=!0),c=(s=i._1)&&s.isEnable(D.RowColumnStates.active,!0),s=s&&s.isEnable(D.RowColumnStates.active,!1),c&&(i.x_(a,i.R9,i.B9),i.x_(t,i.R9,i.B9)),s&&(i.N_(u,i.R9,i.B9),i.N_(n,i.R9,i.B9)),i.Ut.setCellState(a,u,D.CellStatesType.active,!1,D.SheetArea.viewport),c||s||i.k_&&i.k_(D.CellStatesType.active,a,u,D.SheetArea.viewport),i.Ut.setCellState(t,n,D.CellStatesType.active,!0,D.SheetArea.viewport),c||s||i.k_&&i.k_(D.CellStatesType.active,t,n,D.SheetArea.viewport),!e&&r&&o&&(r.aA(),(u=(a=i.Ut).getDynamicArrayInfo(t,n))!==(c=a.cO))&&(a.cO=u,i.My<=0)&&(s=void 0,s=u&&c?(0,I.getUnionRange)(u,c):(0,I.Ec)((u=u||c).row,u.col,u.rowCount,u.colCount),i.Dn.E1(s))},Z.prototype.XL=function(t,n,e,i,r){var t,n,e,i,r,t=t.getCellRect(n,e,i,r),n=t.x,e=t.y,i=t.width,r=t.height;return t.x=n-2,t.y=e-2,t.width=i+4,t.height=r+4,t},Z.prototype.O6=function(t,n,e,i,r){var o,a,u,s,c,c,o=this,a=o.ui,u=o.ci,s=o.Ut,c=s.getSpan(t,n);o.H5=c.rowCount,o.z5=c.colCount,o.My<=0&&(c=s.getSpan(a,u),o.Dn.E1((0,I.Ec)(a,u,c.rowCount,c.colCount))),o.R9=e,o.B9=i,o.XA(t,n,r),o.qA=t,o.hR=n},Z.prototype.setActiveCell=function(t,n,e,i){this.t4(t,n,e,i,2)},Z.prototype.t4=function(t,n,e,i,r){var o,a,u,a,u,r,o=this,a=U(o),u=G(o);t<0?t=0:a<=t&&(t=B(0,a-1)),n<0?n=0:u<=n&&(n=B(0,u-1)),o.IA(),a=2===r?I.hi.A1(o):1===r,o.O6(t,n,e,i,!a),u={sheet:o,sheetName:o.name(),row:t,col:n},r=o.Ut.getSpan(t,n),o.D9(r.row,r.col,r.rowCount,r.colCount),o.zw(),o.ki(I.Events.FormulaTextboxEnterCell,u)},Z.prototype.getActiveRowIndex=function(){return this.ui},Z.prototype.getActiveColumnIndex=function(){return this.ci},Z.prototype.getRowResizable=function(t,n){return this.Ut.getResizable(!0,n,t)},Z.prototype.setRowResizable=function(t,n,e){this.qL(t,n,ht,!0,e)},Z.prototype.qL=function(t,n,e,i,r){var o,a,u,s;switch(_(r)&&(r=3),e!==at&&e!==ot||!X.test(n)||(e=lt),a=(o=this).Ut,e){case ht:u=a.getResizable(i,r,t);break;case"pageBreak":u=a.getPageBreak(i,r,t);break;case ft:u=a.getVisible(i,r,t);break;case at:case ot:u=a.getSize(i,r,t);break;case mt:u=a.getColumnHeaderFitMode(i,r,t)}if(s=!0,!(s=i?o.kj(t,r,e,n,u):o.Dj(t,r,e,n,u)))return s;switch(e){case ht:a.do("setResizable",i,r,t,n);break;case"pageBreak":a.do("setPageBreak",i,r,t,n);break;case ft:a.do("setVisible",i,r,t,n),i&&k&&3===r&&u!==n&&o.recalcRows([t]);break;case at:a.do("setSize",i,r,t,n),!k||3!==r||u===n||0!==u&&0!==n||o.recalcRows([t]);break;case ot:a.do("setSize",i,r,t,n),!k||3!==r||u===n||0!==u&&0!==n||o.recalcCols([t]);break;case lt:a.do("setStarSize",i,r,t,n);break;case mt:a.do("setColumnHeaderFitMode",i,r,t,n)}return i?o.dj(t,r,e,n,u):o.vj(t,r,e,n,u),!0},Z.prototype.getColumnResizable=function(t,n){return this.Ut.getResizable(!1,n,t)},Z.prototype.setColumnResizable=function(t,n,e){this.qL(t,n,ht,!1,e)},Z.prototype.getRowHeight=function(t,n,e){var i,e,r,o,a,e,u,e,i=this;if(_(n)&&(n=3),e)return i.Ut.getStarSize(!0,n,t);if(3===n||2===n){if(e=i.getRowCount(n),t<0||e<=t)return 0;for(r=i.$L,o=0;o<r.length;o++)if(!(a=r[o]).tF(t))return 0}return u=(e=i.defaults).rowHeight,1===n&&(u=e.colHeaderRowHeight),(e=i.Ut.getSize(!0,n,t))||0===e?e:w(u)},Z.prototype._o=function(t,n){var e,i,r,i;return _(n)&&(n=3),r=(i=(e=this).defaults).rowHeight,1===n&&(r=i.colHeaderRowHeight),(i=e.Ut.getActualSize(!0,n,t))||0===i?i:w(r)},Z.prototype.setRowHeight=function(t,n,e){this.qL(t,n,at,!0,e)&&(this.Ww=!0,this.zw())},Z.prototype.getRowVisible=function(t,n,e){var i,r,o,a,i=this;if(_(n)&&(n=3),!e&&(3===n||2===n))for(r=i.$L,o=0;o<r.length;o++)if(!(a=r[o]).tF(t))return!1;return this.Ut.getVisible(!0,n,t)},Z.prototype.setRowVisible=function(t,n,e){var i=this;i.qL(t,n,ft,!0,e)&&(i.Ww=!0,i.zw())},Z.prototype.getColumnWidth=function(t,n,e){var i,e,r,e,o,a,u,e,i=this;if(_(n)&&(n=3),e)return i.Ut.getStarSize(!1,n,t);if(r=(e=i.defaults).colWidth,2===n&&(r=e.rowHeaderColWidth),3===n||1===n){if(e=i.getColumnCount(n),t<0||e<=t)return 0;for(o=i.nF,a=0;a<o.length;a++)if(!(u=o[a]).tF(t))return 0}return(e=this.Ut.getSize(!1,n,t))||0===e?e:w(r)},Z.prototype.Do=function(t,n){var e,i,r,i;return _(n)&&(n=3),r=(i=(e=this).defaults).colWidth,2===n&&(r=i.rowHeaderColWidth),(i=e.Ut.getActualSize(!1,n,t))||0===i?i:w(r)},Z.prototype.setColumnWidth=function(t,n,e){this.qL(t,n,ot,!1,e)&&(this.Zw=!0,this.zw())},Z.prototype.getColumnVisible=function(t,n){var e,i,r,o,e=this;if(3===(n=_(n)?3:n)||1===n)for(i=e.nF,r=0;r<i.length;r++)if(!(o=i[r]).tF(t))return!1;return e.Ut.getVisible(!1,n,t)},Z.prototype.setColumnVisible=function(t,n,e){var i=this;i.qL(t,n,ft,!1,e)&&(i.Zw=!0,i.zw())},Z.prototype.zoom=function(t){var n,e,n=this;return 0===arguments.length?n.Ut.getZoomFactor():(t=nt(t),!v(t)&&isFinite(t)&&(4<t?t=4:t<.25&&(t=.25),e=n.Ut.getZoomFactor(),n.g8(t),n.my=n.my/e*t,n.ly=n.ly/e*t,n.Zw=!0,n.Ww=!0,n.zw()),n)},Z.prototype.g8=function(t){this.Ut.do("setZoomFactor",t),Z.et(this,F,{changeType:"zoomSheet"})},Z.prototype.n3=function(){var t=this;t.eF=j,t.N8={colHeader:j,viewport:j},t.iF={rowHeader:j,viewport:j,colHeader:j}},Z.prototype.invalidateLayout=function(){var t,n,n,t,t=this,n=t.rt;t.Ut.hj(),t.n3(),Z.et(t,st,{changeType:"invalidateLayout"}),t.Zw&&(t.aw(),t.Zw=!1),t.Ww&&(t.ew(),t.Ww=!1),t.n3(),Z.et(t,F,{changeType:"invalidateLayout"}),n&&n.PA&&I.hi.A1(t)&&!n.M_(t)&&n.PA(t.ui,t.ci),t.k1=!0,(n=t.parent)&&n.options.enableAccessibility&&(t=t.t2(),n.n2(t))},Z.prototype.zw=function(){var t=this;t.My<=0&&(t.invalidateLayout(),t.repaint())},Z.prototype.getViewportHeight=function(t){var n=this,e=n.Fi();return 0===t?e.L6:1===t?n.Sy(e):2===t?e.Iy:0},Z.prototype.getViewportWidth=function(t){var n=this.Fi();return 0===t?n.F6:1===t?this.Gy(n):2===t?n.zy:0},Z.prototype.getViewportTopRow=function(t){var n,e,n=this,e=Y(n);return 0===t?0:1===t?B(e,n.Tb):2===t?B(e,U(n)-z(n)):-1},Z.prototype.getViewportTopRowOffset=function(){return this.ly},Z.prototype.getViewportBottomRow=function(t){var n,e,i,r,o,a,u,n=this;if(2===t)return U(n)-1;for(e=n.getViewportTopRow(t),i=n.getViewportHeight(t),r=1===t?n.ly:0,o=0,a=U(n)-z(n),0===t&&(a=R(Y(n),a)),u=e;u<a&&r<i;u++,o++)r+=n.Gt(u);return e+o-1},Z.prototype.H7=function(t){for(var n,e,i,r,n,e=this.dw(t),i=0;i<e.length;i++)if(0<(r=e[i]).height)return r.row;return-1},Z.prototype.getViewportLeftColumn=function(t){var n,e,n=this,e=V(n);return 0===t?0:1===t?B(e,n.Ab):2===t?B(e,G(n)-H(n)):-1},Z.prototype.getViewportLeftColumnOffset=function(){return this.my},Z.prototype.getViewportRightColumn=function(t){var n,e,i,r,o,a,u,n=this;if(2===t)return G(n)-1;for(e=n.getViewportLeftColumn(t),i=n.getViewportWidth(t),r=0,o=1===t?n.my:0,a=G(n)-H(n),0===t&&(a=R(V(n),a)),u=e;u<a&&o<i;u++,r++)o+=n.nn(u);return e+r-1},Z.prototype.z7=function(t){for(var n,e,i,r,n=this,e=n.getViewportLeftColumn(t),i=n.getViewportRightColumn(t),r=e;r<i+1;r++)if(-1<r&&n.getColumnVisible(r,3)&&0<n.nn(r,3))return r;return-1},Z.prototype.showCell=function(t,n,e,i){this.rF(t,n,e,i)},Z.prototype.rF=function(t,n,e,i,r,o){var i,i,a,u,s,c,f,l,h,d,v,e,u,s,a=this;t<0||t>=U(a)||n<0||n>=G(a)||(u=a.parent&&a.parent.options.scrollByPixel,s=a.parent&&a.parent.options.scrollbarMaxAlign,c=a.S0(n),f=a.C0(t),l=a.getViewportTopRow(f),h=a.ly,d=a.getViewportLeftColumn(c),v=a.my,1===c&&_(o)&&(n=(i=a.rB(n,i,u,s)).col,o=i.offset),1===f&&_(r)&&(t=(i=a.oF(t,e,u,s)).row,r=i.offset),u=e=!1,1!==f||t===l&&r===h||(t=R(t,a.mw()),a.Tb=t,a.ly=r,a.tw(),e=!0),1!==c||n===d&&o===v||(n=R(n,a.Mw()),a.Ab=n,a.my=o,a.ow(),u=!0),(e||u)&&((s=a.parent)&&!s.options.scrollbarShowMax&&(a.Zw=!0,a.Ww=!0),a.zw(),e&&a.ki(I.Events.TopRowChanged,{sheet:a,sheetName:a.name(),oldTopRow:l,newTopRow:t}),u)&&a.ki(I.Events.LeftColumnChanged,{sheet:a,sheetName:a.name(),oldLeftCol:d,newLeftCol:n}))},Z.prototype.C0=function(t){var n=this;return t<Y(n)?0:t>=U(n)-z(n)?2:1},Z.prototype.S0=function(t){var n=this;return t<V(n)?0:t>=G(n)-H(n)?2:1},Z.prototype.oF=function(t,n,e,i){var r,o,a,u,s,c,f,l,h,d,v,m,i,n,g,p,i,r=this,o=r.Jt,a=r.C0(t),u=r.getViewportTopRow(a),s=r.ly,c=Y(r),l=r.P6();if(0===n)if(i){for(h=l,f=r.getViewportHeight(a);c<=h;h--)if((f-=o.Gt(h))<0){s=t<=h?0:(t=h,f);break}}else s=0;else if(1===n){if(v=d=!1,i){for(h=l,f=m=w(r.getViewportHeight(a)/2);c<=h;h--)if((f-=o.Gt(h))<0){h<=t&&(h--,f+=m,v=!0);break}if(v)for(;c<=h;h--)if((f-=o.Gt(h))<0){t=h,s=f,d=!0;break}}if(!d){for(f=w((r.getViewportHeight(a)-o.Gt(t))/2);c<t;t--)if((f-=o.Gt(t-1))<0){t-=1,s=f;break}0<f&&t===c&&(s=0)}}else if(2===n){for(f=r.getViewportHeight(a)-o.Gt(t);c<t;t--)if((f-=o.Gt(t-1))<0){t-=1,s=f;break}0<f&&t===c&&(s=0)}else if(3===n)if(u<t){if(i=r.Fi(),n=r.getCellRect(t,r.ci),g=i.c9(1,1),p=i.c9(1,0),i=i.c9(1,2),g.containsRect(n,!0)||p.containsRect(n,!0)||i.containsRect(n,!0))t=u;else for(f=r.getViewportHeight(a)-o.Gt(t);u<t;t--)if((f-=o.Gt(t-1))<0){t-=1,s=f;break}}else s=0;return!e&&s<0&&(s=0,t<l)&&(t+=1),{row:t,offset:s}},Z.prototype.rB=function(t,n,e,i){var r,o,a,u,s,c,f,l,h,d,v,m,i,n,g,p,i,b,y,r=this,o=r.Jt,a=r.S0(t),u=r.getViewportLeftColumn(a),s=r.my,c=V(r),l=r.G6();if(0===n)if(i){for(f=r.getViewportWidth(a),h=l;c<=h;h--)if((f-=o.Kt(h))<0){s=t<=h?0:(t=h,f);break}}else s=0;else if(1===n){if(v=d=!1,i){for(f=m=w(r.getViewportWidth(a)/2),h=l;c<=h;h--)if((f-=o.Kt(h))<0){h<=t&&(h--,f+=m,v=!0);break}if(v)for(;c<=h;h--)if((f-=o.Kt(h))<0){t=h,s=f,d=!0;break}}if(!d){for(f=w((r.getViewportWidth(a)-o.Kt(t))/2);c<t;t--)if((f-=o.Kt(t-1))<0){t-=1,s=f;break}0<f&&t===c&&(s=0)}}else if(2===n){for(f=r.getViewportWidth(a)-o.Kt(t);c<t;t--)if((f-=o.Kt(t-1))<0){t-=1,s=f;break}0<f&&t===c&&(s=0)}else if(3===n)if(u<t){if(n=(i=r.Fi()).Py,g=i.Cy,p=i.hL,i=i.A6,b=r.getCellRect(r.ui,t),(y=new I.Rect(n,g,p,i)).containsRect(b,!0))t=u;else for(f=r.getViewportWidth(a)-o.Kt(t);u<t;t--)if((f-=o.Kt(t-1))<0){t-=1,s=f;break}}else s=0;return!e&&s<0&&(s=0,t<l)&&(t+=1),{col:t,offset:s}},Z.prototype.Jy=function(t,n){var e=this,i=e.Jt,r=e.C0(t),o=e.getViewportTopRow(r),a;if(0!==n)if(1===n)for(a=w((e.getViewportHeight(r)-i.Gt(t))/2);0<t&&!((a-=i.Gt(t-1))<0);t--);else if(2===n)for(a=e.getViewportHeight(r)-i.Gt(t);0<t&&!((a-=i.Gt(t-1))<0);t--);else if(3===n&&!(t<o||-1===o))for(a=e.getViewportHeight(r)-i.Gt(t);o<t&&!((a-=i.Gt(t-1))<0);t--);return t},Z.prototype.showColumn=function(t,n){this.showCell(this.Tb,t,0,n)},Z.prototype.showRow=function(t,n){this.showCell(t,this.Ab,n,0)},Z.prototype.suspendEvent=function(){this.vf++},Z.prototype.resumeEvent=function(){this.vf--,this.vf<0&&(this.vf=0)},Z.prototype.isEventSuspended=function(){return 0<this.vf},Z.prototype.currentTheme=function(t){var n=this;return 0===arguments.length?(n.hl||n.aF(),n.hl):(typeof t==L&&(t=i.Themes[t]||new i.Theme(t)),n.hl=t,n.Dn.O7(),n.r3(),n.zw(),n)},Z.prototype.uF=function(){var t=I.I.fl(""),t=C(t.zIndex),n=i.Themes.Office2007;return n=2007<t?i.Themes.Office:n},Z.prototype.aF=function(){this.hl=this.uF(),this.r3()},Z.prototype.reset=function(){var t=this;t.sF(),t.zw()},Z.prototype.sF=function(){var t,n,e,i,r,t=this,n=t.b2();t.cF(),t.R9=0,t.B9=0,t.Zp(),t.eF=j,t.N8={colHeader:j,viewport:j},t.iF={rowHeader:j,viewport:j,colHeader:j},t.Tb=0,t.ly=0,t.Ab=0,t.my=0,t.frozenRowCount(0),t.frozenColumnCount(0),t.frozenTrailingRowCount(0),t.frozenTrailingColumnCount(0),Z.et(t,"beforeSetHost"),(e=t.parent)&&(i=e.getActiveSheet(),r=e.getActiveSheetTab(),i&&t.name()===i.name()||r&&t.name()===r.name())&&t.hg(e.Kg),t.r3(),t.Jt=new I.Ff(t),t.Sj={},k&&t.resetCalc(),t.Ut=new E.Y8(t,Z.n8,Z.e8,Z.o8,Z.r8,t.name()),t.defaults=t.Ut.defaults,t.b2(n),t.aF(),t.Hp={},t.Zw=!0,t.Ww=!0,t.parent&&t.parent.sg?t.My=t.parent.sg:t.My=0,t.parent&&t.parent.vf?t.vf=t.parent.vf:t.vf=0,t.lE=0,t.xT=!1,t.fF=j,t.$L=[],t.nF=[],t.Nj=!1,t.hA=D.ClipboardPasteOptions.all,t.lF=D.CopyToOptions.all,t.JT=!0,t.UB=!0,Z.et(t,"init")},Z.prototype.Zp=function(){var i=this;h(wt,function(t,n){var e;_(n)||(e=n,"gridline"===t?e={color:I.I.fl("gc-gridlineColor").borderTopColor,showVerticalGridline:!0,showHorizontalGridline:!0}:"object"==typeof e&&(e=l.GC$.extend({},n)),i.options[t]=e)})},Z.prototype.pM=function(t){var n,e,n=this;for(n.parent=t,e=n.My;e<t.sg;e++)n.suspendPaint();n.vf=t.vf,Z.et(n,"attach",t)},Z.prototype.hF=function(t,n){return t.row===n.row&&t.col===n.col&&t.rowCount===n.rowCount&&t.colCount===n.colCount},Z.prototype.dF=function(t,n,e,i,r){for(var o,a,u,o=this.iT(n,e,i,r).ranges,a=0;a<o.length;a++)for(u=0;u<t.length;u++)if(this.hF(t[a],o[u]))return!0;return!1},Z.prototype.vF=function(t,n,e,i,r){var o,a,o=!1;return void 0!==r?0===r?0<(a=this.iT(t,n,e,this.getColumnCount()-n).ranges).length&&(o=(o=(o=0<t-1?this.dF(a,t-1,n,1,this.getColumnCount()-n):o)||this.dF(a,t+e,n,1,this.getColumnCount()-n))||this.dF(a,t,n,e,1)):0<(a=this.iT(t,n,this.getRowCount()-t,i).ranges).length&&(o=(o=(o=0<t-1?this.dF(a,t-1,n,this.getRowCount()-t,1):o)||this.dF(a,t+e,n,this.getRowCount()-t,1))||this.dF(a,t,n,1,i)):o=!0,o},Z.prototype.PT=function(t,n,e,i,r,o,a,u,s,c){var f,a,f=this;return!a&&f.options.isProtected&&f.dA((0,I.Ec)(t,n,e,i),s,c)?(r&&f.jT(1,r),!1):(a=this.vF(t,n,e,i,u),!(k&&a&&!f.mT(t,n,e,i)&&(o&&f.jT(1,o),1)))},Z.prototype.clear=function(t,n,e,i,r,o,a,u,s){0!==r&&this.KI(t,n,e,i,r,o,a,u,s)},Z.prototype.KI=function(t,n,e,i,r,o,a,u,s,c){var f,l,h,d,v,m,g,p,b,y,w,M,C,S,T,A,I,f=this,l=k;try{if(l&&f.suspendCalcService(),f.suspendPaint(),h=f.defaults,p=3,b={changeType:"clear",row:t,col:n,rowCount:e,colCount:i,sheetArea:r,type:o,ignoreTable:u,ignorePivotTable:s,canClear:!(g=m=v=d=void 0)},Z.et(f,F,b),b.canClear){if(_(r)||3===r){if(l&&!f.mT(t,n,e,i))return!1;if(1&o&&f.getDataSource&&f.getDataSource()){for(f.suspendEvent(),d=t;d<t+e;d++)if(!(a&&f.XT&&f.XT(d)))for(v=n;v<n+i;v++)f.setValue(d,v,j,r);f.resumeEvent()}}if(y=f.Ut,w=l&&f.b3(),d=-1===t?0:t,M=-1===t?y.getRowCount(r):e,v=-1===n?0:n,C=-1===n?y.getColumnCount(r):i,S=[],a&&f.XT)for(T=d;T<M+d;T++)f.XT(T)&&S.push(T);if(y.do("clear",d,v,M,C,o,S,r),w&&1&o&&!c&&(w.mF(d,v,M,C),w.clear(d,v,M,C,y.pj())),8&o&&!(0<=t&&0<=n))if(0<=n)for(g=0;g<C;g++)f.setTag(-1,v+g,j,r);else if(0<=t)for(m=0;m<M;m++)a&&f.XT&&f.XT(d+m)||f.setTag(d+m,-1,j,r);else f.setTag(-1,-1,j,r);if(256&o&&!(0<=t&&0<=n))if(0<=n)for(g=0;g<C;g++)f.setHyperlink(-1,v+g,j,r);else if(0<=t)for(m=0;m<M;m++)a&&f.XT&&f.XT(d+m)||f.setHyperlink(-1,-1,j);if(2&o&&!(0<=t&&0<=n))if(0<=n)for(g=0;g<C;g++)f.setStyle(-1,v+g,j,r);else if(0<=t)for(m=0;m<M;m++)a&&f.XT&&f.XT(d+m)||f.setStyle(d+m,-1,j,r);else f.setStyle(-1,-1,j,r);if(32&o){if(t<0)for(g=0;g<C;g++)f.setColumnVisible(v+g,!0,r),f.setColumnResizable(v+g,!0,r),f.setColumnWidth(v+g,2===r?h.rowHeaderColWidth:h.colWidth,r);if(n<0)for(m=0;m<M;m++)a&&f.XT&&f.XT(d+m)||(f.setRowVisible(d+m,!0,r),f.setRowResizable(d+m,!0,r),f.setRowHeight(d+m,1===r?h.colHeaderRowHeight:h.rowHeight,r))}for((_(r)||3===r)&&l&&1==(1&o)&&(A=f.b3())&&A.gF(t,n,e,i),I=[],m=0;m<M;m++)for(g=0;g<C;g++)I.push({row:d+m,col:v+g});f.SI(t,n,M,C,I,2,r)}}finally{f.resumePaint(),l&&f.resumeCalcService(!1)}},Z.prototype.uL=function(){var t,n,e,n,e,n,e,t=this,n=t.options,e=n.protectionOptions;n.isProtected&&e&&(n=e.allowSelectLockedCells,e=e.allowSelectUnlockedCells,!1===n&&!1!==e||!1!==n&&!1===e)&&(n=t.ui,e=t.ci,t.JA(n,e)||(t.IA(),t.gA(n,e,!0),t.MA(4,n,e)))},Z.prototype.setArray=function(i,r,t,o){var a,n,u,s,c,f,a=this,n=k;if(o=n&&o,u=U(a),s=G(a),t&&0<=i&&i<u&&0<=r&&r<s){n&&a.suspendCalcService(),a.suspendPaint();try{h(t,function(e,t){l.GC$.isArray(t)?h(t,function(t,n){f=r+t,(c=i+e)<u&&f<s&&(o?a.setFormula(c,f,n):a.setValue(c,f,n,3,!0))}):(f=r,(c=i+e)<u&&f<s&&(o?a.setFormula(c,f,t):a.setValue(c,f,t,3,!0)))})}finally{n&&a.resumeCalcService(),a.resumePaint()}}},Z.prototype.getArray=function(t,n,e,i,r){var o,a,u,s,c,f,o=this,a=[],u=U(o),s=G(o);if(r=r&&k,0<=t&&t<u&&0<=n&&n<s)for(u<t+e&&(e=u-t),s<n+i&&(i=s-n),c=0;c<e;c++)for(a[c]=[],f=0;f<i;f++)a[c][f]=r?o.getFormula(t+c,n+f):o.getValue(t+c,n+f);return a},Z.prototype.setTag=function(t,n,e,i){var r,o,a,u,a,u,r=this;0!==(i=_(i)?3:i)&&(a=(o=r.Ut).getRowCount(i),u=o.getColumnCount(i),t<-1||a<=t||n<-1||u<=n||(e=J(e),a=void 0,(u=0<r.vf)||(a=r.getTag(t,n,i)),o.do("setValueForKey",t,n,s,e,i),a!==e&&(-1!==t&&-1!==n?u?r.Lj(r,[{row:t,col:n}],0):r.Rj(s,t,n,i,a,e):-1!==t&&-1===n?r.dj(t,i,s,e,a):-1===t&&-1!==n&&r.vj(n,i,s,e,a))))},Z.prototype.getTag=function(t,n,e){var i,i,i=this;return 0!==(e=_(e)?3:e)?(i=i.Ut.getValueForKey(t,n,s,e),K(i)):j},Z.prototype.tag=function(t){var n,e,n=this;return 0===arguments.length?(e=n.Ut.getValueForKey(-1,-1,s,3),K(e)):(n.Ut.do("setValueForKey",-1,-1,s,J(t),3),n)},Z.prototype.getParent=function(){return this.parent},Z.prototype.getDirtyRows=function(){return Ct(this,!0)},Z.prototype.getInsertRows=function(){return Ct(this,!1)},Z.prototype.getDeletedRows=function(){var e=[],t=this.aj;return t&&h(t,function(t,n){n&&!l.GC$.isFunction(n)&&e.push({row:n.row,originalItem:n.data})}),e},Z.prototype.hasPendingChanges=function(){var t,n,e,t=this,n=t.aj;return!!(n&&0<n.length)||!_t(e=t.Ut.Fj())},Z.prototype.clearPendingChanges=function(t){var n,e,i,r,o,t,n=this;_(t)||d(t)?(n.Ut.Hj(),n.aj=[],Z.et(n,"clearPendingChanges")):(e=t.row,i=t.col,r=t.rowCount,o=t.colCount,(1&(t=(t=t.clearType)||bt.dirty))===bt.dirty&&n.pF(e,i,r,o),(2&t)===bt.insert&&n.bF(e,i,r,o),(4&t)===bt.delete&&n.yF(e,i,r,o))},Z.prototype.pF=function(t,n,e,i){var r=this,o=r.Ut,a=r.wF(t,n,e,i),u=r.MF(n,i);a?(o.Qj(),Z.et(r,"clearPendingChanges")):o.Vj(u,t,n,e,i)},Z.prototype.bF=function(t,n,e,i){var r=this,o=r.Ut,a=r.wF(t,n,e,i),r=r.MF(n,i);o.zj(a,r,t,e)},Z.prototype.yF=function(e,t,i,n){var r,t,o,a,u,r=this;if(r.wF(e,t,i,n))r.aj=[];else if(r.MF(t,n)&&(t=r.aj))for(o=[],h(t,function(t,n){var n;n&&(n=n.row,e<=n)&&n<e+i&&o.push(t)}),u=(a=o.length)-1;0<=u;u--)r.aj.splice(o[u],1)},Z.prototype.MF=function(t,n){return _(t)||-1===t||0===t&&this.getColumnCount()===n},Z.prototype.SF=function(t,n){return _(t)||-1===t||0===t&&n===this.getRowCount()},Z.prototype.wF=function(t,n,e,i){return this.MF(t,e)&&this.MF(n,i)},Z.prototype.getDirtyCells=function(t,r,n,o){var a,u,s,e,i,c,f,l,a=this;if(_(t)&&(t=-1),_(r)&&(r=-1),(_(n)||n<=0)&&(n=1),(_(o)||o<=0)&&(o=1),u=[],s=a.Ut.Fj(),!d(s)){if(e=[],0<=t)for(i=t;i<t+n;i++)e.push(i);else for(c in s)Q(s,c)&&e.push(C(c));h(e,function(t,n){var e,i;if((f=s[n])&&"e"===f.rs)if(0<=r)for(e=r;e<r+o;e++)(l=f[e])&&u.push(kt(a,n,e,l.oldValue));else for(i in f)v(i)||(l=f[i])&&u.push(kt(a,n,C(i),l.oldValue))})}return u},Z.prototype.suspendDirty=function(){this.lE++,this.Ut.Kj()},Z.prototype.resumeDirty=function(){var t=this;t.lE--,t.lE<0&&(t.lE=0),t.Ut.Jj()},Z.prototype.isDirtySuspended=function(){return 0<this.lE},Z.prototype.Hc=function(t){this.cg(new I.Rect(0,0,0,0)),this.sF(),this.ub(t)},Z.prototype.TF=function(){return this},Z.prototype.uw=function(){var t,n,e,n,t,n=this.Dg(),e={top:0,left:0};return n&&n.parentElement&&(e=(0,l.GC$)(n).offset())&&(e.top+=tt.body.clientTop||0,e.left+=tt.body.clientLeft||0),e=(n=n&&n.canvasOffset)?n:e},Z.prototype.hg=function(t){var n,e,i,r,o;t&&((n=this).xT=!1,(e=n.fg)&&n.L0(!1),i=y("canvas"),o=(r=n.parent&&n.parent.options.enableAccessibility)?"":c().NeedCanvasSupport,(0,l.GC$)(i).attr("id",t.getAttribute("id")+"_vp").attr("gcUIElement","gcWorksheetCanvas").html(o).appendTo(t),I.Bf.Wl(i,j,n),n.fg=i,n.Cg(),n.repaint(),n.parent&&n.parent.nb(),Z.et(n,"setHost",(0,l.GC$)(i)))},Z.prototype.AF=function(t,e,n,i,r,o,a,u,s){for(var c,f,l,h,d,v,c=this,f=c.getActiveRowIndex(),l=c.getActiveColumnIndex(),h=function(t,n){return f===e&&n===l?c.Due(t):t},d=n;d<i;d++)v=h(c.getText(e,d,s),d),t.push('"'+v+'"');for(d=r;d<o;d++)v=h(c.getText(e,d,s),d),t.push('"'+v+'"');for(d=a;d<u;d++)v=h(c.getText(e,d,s),d),t.push('"'+v+'"')},Z.prototype.xF=function(){for(var t,n,e,i,r,o,a,u,s,c,f,l,h,e,d,v,m,g,p,b,y,t=this,n=t.getViewportTopRow(1),e=t.getViewportBottomRow(1),i=t.getViewportLeftColumn(1),r,o=e-n+1,a=t.getViewportRightColumn(1)-i+1,u=t.getRowCount(D.SheetArea.colHeader),s=t.getColumnCount(D.SheetArea.rowHeader),c=t.frozenColumnCount(),f=H(t),l=t.getColumnCount(),h=t.frozenRowCount(),e=z(t),d=t.getRowCount(),v=[],m=0;m<u;m++)t.AF(g=[],m,0,c,i,i+a,l-f,l,D.SheetArea.colHeader),v.push(g.join(","));for(m=0;m<h;m++){for(p=[],b=0;b<s;b++)y=t.getText(m,b,D.SheetArea.rowHeader),p.push('"'+y+'"');t.AF(p,m,0,c,i,i+a,l-f,l),v.push(p.join(","))}for(m=n;m<n+o;m++){for(p=[],b=0;b<s;b++)y=t.getText(m,b,D.SheetArea.rowHeader),p.push('"'+y+'"');t.AF(p,m,0,c,i,i+a,l-f,l),v.push(p.join(","))}for(m=d-e;m<d;m++){for(p=[],b=0;b<s;b++)y=t.getText(m,b,D.SheetArea.rowHeader),p.push('"'+y+'"');t.AF(p,m,0,c,i,i+a,l-f,l),v.push(p.join(","))}return v.join(";")},Z.prototype.t2=function(t){var n,e,i,r,t,o,a,u,s,n=this;return I.util.Qf()?n.xF():(e=n.ui,i=n.ci,r=D.SheetArea.viewport,!t||_(t.row)||_(t.col)||(e=t.row,i=t.col,r=t.hitTestType),t=c(),o="",a=n.getText(e,i,r),r===D.SheetArea.rowHeader?o=t.ARIA_RowHeader+" ":r===D.SheetArea.colHeader?o=t.ARIA_ColumnHeader+" ":!_(r)&&r!==D.SheetArea.viewport||(u=n.getFormula(e,i),s=n.comments&&n.comments.get(e,i)),o+n.N6(e,i,a,u,s&&s.text()))},Z.prototype.N6=function(t,n,e,i,r){var o,n,o=c(),n=o.ARIA_Cell+" "+I.util.Vf(n+1)+(t+1)+" ";return _(e)||""===e||(n+=$.I5(o.ARIA_HasValue,[e])+", "),_(i)||(n+=$.I5(o.ARIA_HasFormula,[i])+", "),_(r)||(n+=$.I5(o.ARIA_HasComment,[r])),this.Due(n)},Z.prototype.Due=function(t){return this._ue&&(t=this._ue+" "+t),t=this.Eue?t+" "+this.Eue:t},Z.prototype.setAccessibilityPrefixSuffixContent=function(t,n){this._ue=t,this.Eue=n},Z.prototype.Cg=function(){var t,n,e,i,e,r,r,i,e,r,t=this,n=t.Dg();n&&n.parentNode&&(i=(e=getComputedStyle(n.parentNode)).width,e=e.height,0<(r=i.indexOf("px"))&&(i=i.substring(0,r)),0<(r=e.indexOf("px"))&&(e=e.substring(0,r)),r=C(i),i=C(e),v(r)&&(r=(0,l.GC$)(n.parentNode).width()),v(i)&&(i=(0,l.GC$)(n.parentNode).height()),0!==r)&&0!==i&&(e=B(r,0),r=B(i,0),n.style.display="none",n.style.display="",n.width=e,n.height=r,n.style.width=e+"px",n.style.height=r+"px",e=n.clientWidth||n.width,r=n.clientHeight||n.height,t.kg.width=e,t.kg.height=r,I.Bf.$l(n,e,r),t.invalidateLayout())},Z.prototype.destroy=function(){this.L0(!0)},Z.prototype.L0=function(t,n){var e,n,i,i,e=this;!0!==e.xT&&(I.Bf.eh(e),e.isEditing&&e.isEditing()&&e.l6(e.ui,e.ci,D.SheetArea.viewport),Z.et(e,"dispose",{clearCache:t,isSheetDestroy:!0,hasActiveSheet:n}),(n=e.fg)&&((i=n.parentNode)&&i.removeChild(n),e.fg=j),e.NF(),e.Ut&&e.Ut.L0(t),!1!==t)&&(e.xT=!0,(i=e.lA)&&i.L0(),e.parent=j,e.Ut=j,e.Jt&&(e.Jt.L0(),e.Jt=j),e.MC&&(e.MC.L0(),e.MC=j),I.hi.A1(e)&&I.hi.F1(j,!0),e.bM&&(e.bM.c5(),e.bM=j),e.$L=j,e.nF=j)},Z.prototype.NF=function(){var t=this.kF;t&&((0,l.GC$)(t).remove(),this.kF=O)},Z.prototype.mL=function(t,n,e,i,r){var o,o,a,a,o;return 3===(i=_(i)?3:i)&&this.S6&&(o=t.getDynamicArrayInfo(n,e))&&o.isValid&&(n!==o.row||e!==o.col)?j:(this.loading||0===i||(o=k&&this.b3(i))&&(a=o.getCalcService()).calcOnDemand&&!a.IsSuspended()&&(a=o.oT(n,e))&&!0===a.k1&&(a.k1=!1,delete a.DF,delete a.C3,o.recalculateCell(a),this.Uw()._F()),o=t.getValue(n,e,i,this.loading,r),K(o))},Z.prototype.JS=function(t,n){var e,i,r,o,a,t,u,i;return _(n)&&(n=3),e=(0,I.Ec)(-1,-1,-1,-1),t&&(r=t.row,o=t.col,a=t.rowCount,t=t.colCount,u=(i=this).getRowCount(n),i=i.getColumnCount(n),-1===o&&(o=0,t=i),-1===r&&(r=0,a=u),e.col=o,e.row=r,e.colCount=Math.min(i-o,t),e.rowCount=Math.min(u-r,a)),e},Z.prototype.getRangeRect=function(t,n,e){var i,r,o,a,u,s,e,c,f,l,h,e,d,v,m,g,p,b,y,w,i=new I.Rect(-1,-1,-1,-1),r=this,o=r.Fi(),a=r.C6(t,n);return 0!==o.width&&0!==o.height&&(u=r._y(t,a),(s=r.Yy(n,a))&&0!==s.length&&u&&0!==u.length)&&(e=r.JS(e),c=r.Jt,f=e.row,l=e.row+e.rowCount-1,h=e.col,e=e.col+e.colCount-1,d=Y(r),v=U(r)-z(r)-1,m=V(r),g=G(r)-H(r)-1,p=s[0].col,b=s[s.length-1].col,y=u[0].row,w=u[u.length-1].row,h<p&&(h=M(p,h)),b<e&&(e=C(b,e)),f<y&&(f=S(y,f)),w<l&&(l=T(w,l)),e<h||l<f||(0===n?h<m&&(i.x=o.b6+A(c,0,h-1),i.width=A(c,h,e)):1===n||-1===n?h<=g&&m<=e&&(i.x=h<p?s[0].x-A(c,h,p-1,a):s[0].x+A(c,p,h-1,a),i.width=A(c,h,e,a)):2===n&&g<e&&(i.x=h<p?o.Hy-A(c,h,p-1):o.Hy+A(c,p,h-1),i.width=A(c,h,e)),0===t?f<d&&(i.y=o.T6+P(c,0,f-1),i.height=P(c,f,l)):1===t||-1===t?f<=v&&d<=l&&(i.y=f<y?u[0].y-P(c,f,y-1,a):u[0].y+P(c,y,f-1,a),i.height=P(c,f,l,a)):2===t&&v<l&&(i.y=f<y?o.Ay-P(c,f,y-1):o.Ay+P(c,y,f-1),i.height=P(c,f,l)))),i;function M(t,n){for(;n<t;)if(r.getColumnVisible(--t))return t;return t}function C(t,n){for(;t<n;)if(r.getColumnVisible(++t))return t;return t}function S(t,n){for(;n<t;)if(r.getRowVisible(--t))return t;return t}function T(t,n){for(;t<n;)if(r.getRowVisible(++t))return t;return t}},Z.prototype.isIntersectWithArrayFormula=function(t){var n,e,i,n=k&&this.b3();if(n)for(e=t.row;e<t.row+t.rowCount;e++)for(i=t.col;i<t.col+t.colCount;i++)if(n.EF(e,i,1,1))return!0;return!1},Z.prototype.setRangeActiveCells=function(t,n){this.XA(t,n),this.repaint()},Z.prototype.j1=function(t,n){var e,i,r,t,o,a,u,s,c,f,l,h,t,d,v,m,g,e=this,i=new I.Rect(-1,-1,-1,-1),r=e.Fi();if(0!==r.width&&0!==r.height){if(t=e.JS(t,n),o=V(e),a=Y(e),u=H(e),s=z(e),c=e.Jt,f=t.row,l=t.row+t.rowCount-1,h=t.col,t=t.col+t.colCount-1,d=U(e,n),v=G(e,n),h<o)i.x=r.b6+A(c,0,h-1,n),i.width=A(c,h,R(t,o-1),n),o<=t&&t<v-u?(m=e.yw(1))&&0<m.length&&(i.width+=A(c,m[0].col,R(t,m[m.length-1].col),n)+e.my):v-u<=t&&(m=e.yw(2))&&0<m.length&&(i.width=m[0].x-i.x,i.width+=A(c,v-u,R(t,v-1),n));else if(h<v-u){if(!(m=e.yw(1))||0===m.length||h>m[m.length-1].col||t<m[0].col)return i;i.x=r.Py+A(c,m[0].col,h-1,n)+e.my,o<=t&&t<v-u?i.width=A(c,B(h,m[0].col),R(t,m[m.length-1].col),n):v-u<=t&&(m=e.yw(2))&&0<m.length&&(i.width=m[0].x-i.x,i.width+=A(c,v-u,R(t,v-1),n))}else h<v&&(m=e.yw(2))&&0<m.length&&(i.x=r.Hy+A(c,m[0].col,h-1,n),i.width=A(c,h,R(t,v-1),n));if(f<a)i.y=r.T6+P(c,0,f-1,n),i.height=P(c,f,R(l,a-1),n),a<=l&&l<d-s?(g=e.dw(1))&&0<g.length&&(i.height+=P(c,g[0].row,R(l,g[g.length-1].row),n)+e.ly):d-s<=l&&(g=e.dw(2))&&0<g.length&&(i.height=g[0].y-i.y,i.height+=P(c,d-s,R(l,d-1),n));else if(f<d-s){if(!(g=e.dw(1))||0===g.length||f>g[g.length-1].row||l<g[0].row)return i;i.y=r.Cy+P(c,g[0].row,f-1,n)+e.ly,a<=l&&l<d-s?i.height=P(c,B(f,g[0].row),R(l,g[g.length-1].row),n):d-s<=l&&(g=e.dw(2))&&0<g.length&&(i.height=g[0].y-i.y,i.height+=P(c,d-s,R(l,d-1),n))}else f<d&&(g=e.dw(2))&&0<g.length&&(i.y=r.Ay+P(c,g[0].row,f-1,n),i.height+=P(c,f,R(l,d-1),n))}return i},Z.prototype.Dg=function(){return this.fg},Z.prototype.Gi=function(t,n){return this.Qt(t,n)+1},Z.prototype.Qt=function(t,n){var e="",i=this.Dn,e=n||i._n(i.Nn());return I.q.Wt(t,e)},Z.prototype.PL=function(t){var n,e,i,r,n,o,a,n=this,e=n.Fi(),i=j,r=e.Py,n=n.Gy(e),o=e.Hy,a=e.zy;return e.BA<t&&t<e.BA+e.XC?i=-1:e.b6<t&&t<e.b6+e.F6?i=0:r<t&&t<r+n?i=1:o<t&&t<o+a&&(i=2),i},Z.prototype.FL=function(t){var n,e,i,r,n,o,a,n=this,e=n.Fi(),i=j,r=e.Cy,n=n.Sy(e),o=e.Ay,a=e.Iy;return e.LA<t&&t<e.LA+e.qC?i=-1:e.T6<t&&t<e.T6+e.L6?i=0:r<t&&t<r+n?i=1:o<t&&t<o+a&&(i=2),i},Z.prototype.GL=function(t,n){var n,n,n=-1===n?this.jF():this.dw(n);if(n&&(n=n.findY(t)))return n.row},Z.prototype.UL=function(t,n,e,i,r){var n,o,a,n=-1===n?this.OF():-1===i?this.BF(n):this.yw(n);if(n)return a=void 0,(a=-1!==i||_(r)?n.findX(t):(o=this.jF().findRow(r),n.findXByExactY(t,e,o)))||n[0]&&(a=(n=this.Dn.VO(n[0].col,n[0].x))?-1!==i||_(r)?n.findX(t):n.findXByExactY(t,e,o):a)?a.col:void 0},Z.prototype.pD=function(t,n){var e,i,t,r,r,o,t,n,e=t.YL;return e!==t.col||(r=t.colViewportIndex,o=t.y,t=t.row,r=(i=this).BF(r),t=this.jF().findRow(t),n===e&&(e=i.O5(e,1)),(n=r.findCol(e))&&o<n.y*t.height+t.y)},Z.prototype.HO=function(t,n){var e=this;return e.ui<=t&&t<e.ui+e.H5&&e.ci<=n&&n<e.ci+e.z5},Z.prototype.T9=function(t){return this.Ut.T9(t)},Z.prototype.S9=function(t){return this.Ut.S9(t)},Z.prototype.ni=function(t,n,e,i){var r,o,r,r=this,o=U(r),r=G(r);return this.Ut.ni(t,n,e,o,r,i)},Z.prototype.ei=function(t,n,e){var i,r,i,i=this,r=U(i),i=G(i);return this.Ut.ei(t,n,e,r,i)},Z.prototype.zO=function(t,n,e){var i,r,o,a,u,s,c,u,i=this,u=i.sw;if(u&&!u.resizeInfo&&!_(e)){if(s=u.hitTestType,c=u.row,u=u.col,1===e)return r=!1,(o=!(o=i.Ut.findSpan(c,u,1))&&i.Cb?i.Cb.D7(c,u,1):o)&&(r=o.contains(t,n,1,1)),a=t===c&&n===u||r,s===e&&a;if(2===e)return r=!1,(o=!(o=i.Ut.findSpan(c,u,2))&&i.Cb?i.Cb.D7(c,u,2):o)&&(r=o.contains(t,n,1,1)),a=t===c&&n===u||r,s===e&&a;if(3===e)return s===e&&t===c&&n===u;if(0===e)return s===e}return!1},Z.prototype.C6=function(t,n){return 0<=t&&t<=2&&0<=n?3:0<=t&&t<=2&&n<0?2:t<0&&0<=n?1:t<0&&n<0?0:j},Z.prototype.Zg=function(t){var n=this.rt;n&&n.Zg(t)},Z.prototype.qc=function(){var t,n,n,t,t=this,n=t.parent,n=n&&n.Ti;return n=n||(t=t.fg)&&t.parentElement},Z.prototype.cF=function(){var t,n,e,i,r,t=this,n=0,e=0,i=1,r=1;t.ui=0,t.ci=0,t.H5=1,t.z5=1,t.qA=0,t.hR=0},Z.prototype.Gt=function(t,n,e){var i=this,t=i.getRowHeight(t,n),n=i.zoom();return 1!==n&&(t*=n),e?t:et(t)},Z.prototype.nn=function(t,n,e){var i=this,t=i.getColumnWidth(t,n),n=i.zoom();return 1!==n&&(t*=n),e?t:et(t)},Z.prototype.LF=function(){var i,t,n,e,r,e,o,a,t,r,u,e,s,c,f,l,h,d,v,e,n,m,g,e,p,b,n,i=this,t=i.ot(),n=i.options,e=n.sheetAreaOffset.left,r=n.sheetAreaOffset.top,e=new I.Rect(t.x+e,t.y+r,B(0,t.width-e),B(0,t.height-r)),o=e.width,a=e.height,t=St(i),r=Tt(i),u={x:e.x,y:e.y,width:e.width,height:e.height,XC:0,qC:0,F6:0,L6:0,zy:0,Iy:0,D6:0,FF:0,PF:0,GF:0,b6:0,T6:0,Hy:0,Ay:0,Py:0,Cy:0,A6:0,hL:0,J7:0,X7:0,Ty:0,Uy:0,BA:0,LA:0,R1:function(){var t=this;return new I.Rect(t.x,t.y,t.XC,t.qC)},L1:function(t){var n=this;return 0===t?new I.Rect(n.b6,n.y,n.F6,n.qC):1===t?new I.Rect(n.Py,n.y,i.Gy(n),n.qC):2===t?new I.Rect(n.Hy,n.y,n.zy,n.qC):j},B1:function(t){var n=this;return 0===t?new I.Rect(n.x,n.T6,n.XC,n.L6):1===t?new I.Rect(n.x,n.Cy,n.XC,i.Sy(n)):2===t?new I.Rect(n.x,n.Ay,n.XC,n.Iy):j},c9:function(t,n){var e=this;if(0===t){if(0===n)return new I.Rect(e.b6,e.T6,e.F6,e.L6);if(1===n)return new I.Rect(e.Py,e.T6,i.Gy(e),e.L6);if(2===n)return new I.Rect(e.Hy,e.T6,e.zy,e.L6)}else if(1===t){if(0===n)return new I.Rect(e.b6,e.Cy,e.F6,i.Sy(e));if(1===n)return new I.Rect(e.Py,e.Cy,i.Gy(e),i.Sy(e));if(2===n)return new I.Rect(e.Hy,e.Cy,e.zy,i.Sy(e))}else if(2===t){if(0===n)return new I.Rect(e.b6,e.Ay,e.F6,e.Iy);if(1===n)return new I.Rect(e.Py,e.Ay,i.Gy(e),e.Iy);if(2===n)return new I.Rect(e.Hy,e.Ay,e.zy,e.Iy)}return j}};if(i.gj&&((s=0)<(e=i.gj()).width&&(u.x+=e.width+0,o-=e.width+0),0<e.height)&&(u.y+=e.height+0,a-=e.height+0),n.rowHeaderVisible)for(h=i.getColumnCount(2),l=0;l<h;l++)u.XC+=i.nn(l,2);if(n.colHeaderVisible)for(f=i.getRowCount(1),c=0;c<f;c++)u.qC+=i.Gt(c,1);if(0<(d=V(i)))for(h=G(i),l=0;l<d&&l<h;l++)i.getColumnVisible(l)&&(u.F6+=i.nn(l));if(0<(v=Y(i)))for(f=U(i),c=0;c<v&&c<f;c++)i.getRowVisible(c)&&(u.L6+=i.Gt(c));if(0<(e=H(i)))for(h=G(i),l=B(d,h-e);l<h;l++)u.zy+=i.nn(l);if(0<(n=z(i)))for(f=U(i),c=B(v,f-n);c<f;c++)u.Iy+=i.Gt(c);if(u.BA=u.x,u.LA=u.y,u.b6=u.BA+u.XC,u.T6=u.LA+u.qC,u.Py=u.b6+u.F6,u.Cy=u.T6+u.L6,o=(o=o-u.XC-u.F6)-u.zy-u.Uy,a=(a=(a-=u.qC)-u.L6-u.Iy)-u.Ty-u.D6,f=U(i),(m=0)<(g=(h=G(i))-e))for(m+=i.my,l=B(d,i.Ab);l<g&&m<o;l++)m+=i.nn(l);if(m<(e=B(0,o))?(u.Uy=e-m,e=u.hL=m):u.hL=e,(p=0)<(b=f-n))for(p+=i.ly,c=B(v,i.Tb);c<b&&p<a;c++)p+=i.Gt(c);return p<(n=B(0,a))?(u.Ty=n-p,n=u.A6=p):u.A6=n,u.Hy=u.Py+e,u.Ay=u.Cy+n,r?(u.J7=u.Py+u.hL,u.Hy+=u.Uy):u.J7=u.Hy+u.zy,t?(u.X7=u.Cy+u.A6,u.Ay+=u.Ty):u.X7=u.Ay+u.Iy,u.PF=u.BA,u.GF=u.y+u.height-u.D6,u},Z.prototype.Fi=function(){var t=this;return t.eF||(t.eF=t.LF()),t.eF},Z.prototype.Yy=function(t,n){return _(n)||3===n?this.yw(t):2===n?this.OF():1===n?1!==this.getRowCount(D.SheetArea.colHeader)?this.yw(t):this.BF(t):j},Z.prototype.pfe=function(t,n){return _(n)||3===n?this.yw(t):2===n?this.OF():1===n?1!==this.getRowCount(D.SheetArea.colHeader)?this.yw(t):this.bfe(t):j},Z.prototype.OF=function(){var t=this;return t.iF.rowHeader||(t.iF.rowHeader=t.UF()),t.iF.rowHeader},Z.prototype.yw=function(t){var n=this;return n.iF.viewport||(n.iF.viewport={}),n.iF.viewport[t]||(n.iF.viewport[t]=n.HF(t)),n.iF.viewport[t]},Z.prototype.BF=function(t){var n=this;return n.iF.colHeader||(n.iF.colHeader={}),n.iF.colHeader[t]||(n.iF.colHeader[t]=n.zF(t)),n.iF.colHeader[t]},Z.prototype.bfe=function(t){var n=this;return n.iF.colHeaderWithStack||(n.iF.colHeaderWithStack={}),n.iF.colHeaderWithStack[t]||(n.iF.colHeaderWithStack[t]=n.yfe(t)),n.iF.colHeaderWithStack[t]},Z.prototype.UF=function(){for(var t,n,e,i,r,o,t=new E.h9,n,e=this.Fi().BA,r=this.getColumnCount(2),o=0;o<r;o++)i=this.nn(o,2),t.push(new E.W8(-1,o,e,-1,i,-1)),e+=i;return t},Z.prototype.HF=function(t){var n,e,i,r,o,a,u,s,c,f,l,h,d,v,m,n=this,e=new E.h9,i=n.Fi(),r=G(n),s=n.Jt,c=V(n),f=H(n);if(0===t)for(a=i.b6,r=R(c,r),o=0;o<r;o++)u=s.Kt(o),(l=new E.W8(-1,o,a,-1,u,-1)).offsetX=n.getColumnScrollOffsetX(o),e.push(l),a+=u;else if(1===t)for(h=Tt(n),d=n.my,a=i.Py+d,r=h?r-f:r+f,v=n.Gy(i)-d,o=m=B(c,n.Ab);0<v&&o<r;o++)u=s.Kt(o),(l=new E.W8(-1,o,a,-1,u,-1)).offsetX=n.getColumnScrollOffsetX(o),e.push(l),a+=u,v-=u;else if(2===t)for(a=i.Hy,o=B(c,r-f);o<r;o++)u=s.Kt(o),(l=new E.W8(-1,o,a,-1,u,-1)).offsetX=n.getColumnScrollOffsetX(o),e.push(l),a+=u;return e},Z.prototype.zF=function(t){var n,e,i,r,o,a,u,s,c,f,l,h,d,v,m,g,p,b,y,w,M,C,S,p,n=this,e=new E.h9,i=n.Fi(),r=G(n),s=n.Jt,c=V(n),f=H(n),l=n.Ut,h=[],d=[],v=[],m=[];if(0===t)for(a=i.b6,r=R(c,r),o=0;o<r;o++)h[o]=u=s.Kt(o),d[o]=l.getColumnHeaderFitMode(!1,D.SheetArea.colHeader,o),v[o]=l.eE(-1,o,-1,1,D.SheetArea.colHeader),g=n.ZO(o,a,r,0,h,d,v,m),m[o]=g,e.push(g),a+=u;else if(1===t){for(p=Tt(n),b=n.my,a=i.Py+b,r=p?r-f:r+f,y=n.Gy(i)-b,C=void 0,S=(M=w=B(c,n.Ab))-1;0<=S;S--)if(h[S]=C=s.Kt(S),C){if(d[S]=l.getColumnHeaderFitMode(!1,D.SheetArea.colHeader,S),d[S]===D.ColumnHeaderFitMode.normal)break;M=S}for(o=M;0<y&&o<r;o++)h[o]||(h[o]=s.Kt(o)),_(d[o])&&(d[o]=l.getColumnHeaderFitMode(!1,D.SheetArea.colHeader,o)),u=h[o],v[o]=l.eE(-1,o,-1,1,D.SheetArea.colHeader),g=n.ZO(o,a,r,w,h,d,v,m),m[o]=g,w<=o&&(e.push(g),a+=u,y-=u);y<=0&&o<r&&2===l.getColumnHeaderFitMode(!1,D.SheetArea.colHeader,o-1)&&(p=n.ZO(o,a,r,w,h,d,v,m),m[o]=p,e.push(p))}else if(2===t)for(a=i.Hy,o=w=B(c,r-f);o<r;o++)h[o]=u=s.Kt(o),d[o]=l.getColumnHeaderFitMode(!1,D.SheetArea.colHeader,o),v[o]=l.eE(-1,o,-1,1,D.SheetArea.colHeader),g=n.ZO(o,a,r,w,h,d,v,m),m[o]=g,e.push(g),a+=u;return e},Z.prototype.yfe=function(t){var o,n,e,i,r,a,u,s,c,f,l,h,d,v,m,g,p,b,y,w,M,C,S,T,M,A,I,x,C,M,N,o=this,n=new E.h9,e=o.Fi(),i=G(o),u=o.Jt,s=V(o),c=H(o),f=o.Ut,l=[],h=[],d=[],v=[],m=function(t){for(var n,e,i,r,i,o,n=0,e=t,r=t-1;0<=r;r--)if(l[r]=i=u.Kt(r),i){if(h[r]=f.getColumnHeaderFitMode(!1,D.SheetArea.colHeader,r),(i=h[r]!==D.ColumnHeaderFitMode.normal)||(h[o=r-1]=f.getColumnHeaderFitMode(!1,D.SheetArea.colHeader,o),i=h[o]!==D.ColumnHeaderFitMode.normal),!i)break;n+=l[e=r]}return{leftOutsideWidth:n,wfe:e}},g=function(t,n,e,i){var r,e;return l[n]||(l[n]=u.Kt(n)),r=l[n],d[n]=f.eE(-1,n,-1,1,D.SheetArea.colHeader),e=o.ZO(n,e,i,t,l,h,d,v),{colLayout:v[n]=e,colWidth:r}};if(0===t)for(a=e.b6,p=R(s,i),r=0;r<i&&(h[r]=f.getColumnHeaderFitMode(!1,D.SheetArea.colHeader,r),!(p<=r&&2!==h[r]&&2!==h[r-1]));r++)y=(b=g(0,r,a,i)).colLayout,w=b.colWidth,r<p||(y.isOutside=!0),n.push(y),a+=w;else if(1===t){for(M=Tt(o),C=o.my,a=e.Py+C,p=M?i-c:i,S=o.Gy(e)-C,a-=A=(M=m(T=B(s,o.Ab))).leftOutsideWidth,r=I=M.wfe;r<i&&(_(h[r])&&(h[r]=f.getColumnHeaderFitMode(!1,D.SheetArea.colHeader,r)),!(S<=0||p<=r)||2===h[r]||2===h[r-1]);r++)y=(x=g(T,r,a,i)).colLayout,w=x.colWidth,T<=r&&0<S?(n.push(y),a+=w,S-=w):(y.isOutside=!0,n.push(y),a+=w);S<=0&&r<i&&2===f.getColumnHeaderFitMode(!1,D.SheetArea.colHeader,r-1)&&(C=o.ZO(r,a,i,T,l,h,d,v),v[r]=C,n.push(C))}else if(2===t)for(a=e.Hy,a-=A=(M=m(T=B(s,i-c))).leftOutsideWidth,r=I=M.wfe;r<i;r++)h[r]=f.getColumnHeaderFitMode(!1,D.SheetArea.colHeader,r),y=(N=g(T,r,a,i)).colLayout,w=N.colWidth,T<=r||(y.isOutside=!0),n.push(y),a+=w;return n},Z.prototype.ZO=function(t,n,e,i,r,o,a,u){var s,c,f,l,h,d,v,m,g,p,p,b,y,w,w,M,C,g,S,T,A,T,I,x,N,k,o,s=this,c=s.Ut,f=s.Jt,l=t,h=-1,d=-1,v=o[t],m=r[t],g=a[t],p=s.NMi,p=p&&p.options&&p.options.defaultStackRowHeight;if(v!==D.ColumnHeaderFitMode.normal&&!c.e7(t)&&!g&&!c.eE(-1,t+1,-1,1,D.SheetArea.colHeader))for(v===D.ColumnHeaderFitMode.stack&&(m+=f.Kt(l=t+1));(c.getColumnHeaderFitMode(!1,D.SheetArea.colHeader,l)!==D.ColumnHeaderFitMode.normal||!f.Kt(l))&&l<e-1&&!c.eE(-1,l+1,-1,1,D.SheetArea.colHeader);){if((b=c.getColumnHeaderFitMode(!1,D.SheetArea.colHeader,l))===D.ColumnHeaderFitMode.vertical&&f.Kt(l)){if(v===D.ColumnHeaderFitMode.vertical)break;if(y=s.O5(l,D.SheetArea.viewport),w=s.r6(l,D.SheetArea.viewport,!0),w=c.getColumnHeaderFitMode(!1,D.SheetArea.colHeader,w),M=c.getColumnHeaderFitMode(!1,D.SheetArea.colHeader,y),!(w!==D.ColumnHeaderFitMode.normal&&M!==D.ColumnHeaderFitMode.normal&&y<e)||c.eE(-1,y+1,-1,1,D.SheetArea.colHeader))break}l++,m+=f.Kt(l)}for(l=t-1;i<=l&&!r[l]&&!a[l];)l--;return C=s.Ut.o7(t),(g=o[l])!==D.ColumnHeaderFitMode.normal&&r[l]&&!a[l]&&!a[t]&&C<=l?((S=u[l])===O&&(T=n-s.nn(l),S=u[l]=s.ZO(l,T,e,i,r,o,a,u)),g===D.ColumnHeaderFitMode.stack?(T=(A=function(t){for(var n=s.r6(t,D.SheetArea.viewport,!0);C<=n&&s.Lt(n)===D.ColumnHeaderFitMode.stack;)n=s.r6(n,D.SheetArea.viewport,!0);return!!(C<=n&&s.Lt(n)!==D.ColumnHeaderFitMode.normal&&u[n||0]&&-1!==u[n||0].y)&&u[n||0]})(t),h=_(p)?(x=c.r7(t))/(N=c.n7(t)):(h=p*(I=c.r7(t,O,!0))/s.defaults.colHeaderRowHeight,R(h,1)),T&&_(p)?h=1-(d=(1-h)*(k=0<T.height?T.height:1)):d=1-h):g===D.ColumnHeaderFitMode.vertical&&(v!==D.ColumnHeaderFitMode.normal?(h=S.y,d=S.height):h=d=-1)):h=d=-1,(o=new E.W8(-1,t,n,h,m,d)).offsetX=s.getColumnScrollOffsetX(t),o},Z.prototype._y=function(t,n){return _(n)||3===n||2===n?this.dw(t):1===n?this.jF():j},Z.prototype.d9=function(t){for(var n,e,i,n=new E.h9,e=0;e<3;e++)(i=this._y(e,t))&&0<i.length&&(n=l.GC$.merge(n,i));return n},Z.prototype.m9=function(t){for(var n,e,i,n=new E.h9,e=0;e<3;e++)(i=this.Yy(e,t))&&0<i.length&&(n=l.GC$.merge(n,i));return n},Z.prototype.jF=function(){var t=this;return t.N8.colHeader||(t.N8.colHeader=t.VF()),t.N8.colHeader},Z.prototype.dw=function(t){var n=this;return n.N8.viewport||(n.N8.viewport={}),n.N8.viewport[t]||(n.N8.viewport[t]=n.YF(t)),n.N8.viewport[t]},Z.prototype.VF=function(){for(var t,n,e,i,r,o,t=new E.h9,n,e=this.Fi().LA,r=this.getRowCount(1),o=0;o<r;o++)i=this.Gt(o,1),t.push(new E.W8(o,-1,-1,e,-1,i)),e+=i;return t},Z.prototype.YF=function(t){var n,e,i,r,o,a,u,s,c,f,l,h,d,v,m,n=this,e=new E.h9;if(e.sE(),i=Y(n),r=z(n),o=n.Fi(),a=U(n),f=n.Jt,0===t)for(s=o.T6,a=R(i,a),u=0;u<a;u++)c=f.Gt(u),l=new E.W8(u,-1,-1,s,-1,c),e.push(l),e.fE(u,l),s+=c;else if(1===t)for(h=St(n),d=n.ly,s=o.Cy+d,a=h?a-r:a+r,v=n.Sy(o)-d,u=m=B(i,n.Tb);0<v&&u<a;u++)c=f.Gt(u),l=new E.W8(u,-1,-1,s,-1,c),e.push(l),e.fE(u,l),s+=c,v-=c;else if(2===t)for(s=o.Ay,u=B(i,a-r);u<a;u++)c=f.Gt(u),l=new E.W8(u,-1,-1,s,-1,c),e.push(l),e.fE(u,l),s+=c;return e},Z.prototype.s7=function(t,n,e,i){var r,o,a,t,n,u,s,c,f,l,h,i,r=this,o=r.getRowCount(e),a=r.getColumnCount(e),t=r._y(t,e),n=r.Yy(n,e),u=new E.h9;return t&&0<t.length&&n&&0<n.length&&(s=t[0].row,c=n[0].col,f=t[t.length-1].row,l=n[n.length-1].col,h=r.Ut.getSpans((0,I.Ec)(s,c,f-s+1,l-c+1),e),i&&r.Cb&&(i=r.Cb.ZF(e),h=h.concat(i)),0<h.length)&&r.WF(h,s,c,f,l,u,o,a,e,t,n),u},Z.prototype.O_=function(t,n,e,i,r){var o,a,u,t,n,s,c,f,i,r,o=this,a=o.getRowCount(e),u=o.getColumnCount(e),t=o._y(t,e),n=o.Yy(n,e),s=new E.h9;return t&&0<t.length&&n&&0<n.length&&(c=t[0].row,f=n[0].col,(i=o.getSpan(i,r,e))&&((r=[]).push(i),o.WF(r,c,f,i.row+i.rowCount,i.col+i.colCount,s,a,u,e,t,n)),0<s.length)?s[0]:j},Z.prototype.WF=function(t,n,e,i,r,o,a,u,s,c,f){var l,h,d,v,m,g,p,b,y,w,M,C,S,T,A,I,x,N,k,D,_,l=t.length;if(!(l<=0)){for(h=this,v=i+1,m=r+1,g=[],p=[],b=[],y=[],M=w=0,d=n-1;0<=d;d--)g[d]=h.Gt(d,s),y[d]=M-=g[d];for(M=0,d=n;d<v;d++)y[d]=M,g[d]=h.Gt(d,s),M+=g[d];for(d=e-1;0<=d;d--)p[d]=h.nn(d,s),b[d]=w-=p[d];for(w=0,d=e;d<m;d++)b[d]=w,p[d]=h.nn(d,s),w+=p[d];for(C=0;C<l;C++)if((S=t[C]).intersect(n,e,i-n+1,r-e+1)){if(v<(T=S.row+S.rowCount)){for(d=v;d<T;d++)g.push(h.Gt(d,s)),y.push(y[d-1]+g[d]);v=T}if(m<(A=S.col+S.colCount)){for(d=m;d<A;d++)p.push(h.nn(d,s)),b.push(b[d-1]+p[d]);m=A}for(I=b[S.col],x=y[S.row],_=D=void(k=N=0),_=S.col;_<S.col+S.colCount&&_<u;_++)N+=p[_];for(D=S.row;D<S.row+S.rowCount&&D<a;D++)k+=g[D];o.push(new E.W8(S.row,S.col,f[0].x+I,c[0].y+x,N,k,S.rowCount,S.colCount,S.isAutoMerge))}}},Z.prototype.ow=function(){var t,n,e,i,n,r,i,t=this,n=t.parent,e=t.ww(t.Ab),i=t.my;-1!==e&&e!==t.Ab&&(t.Ab=e),(n=n&&n.zb)&&(i=(r=n.g4===D.ScrollType.pixels)?t.QF(e)-i:t.KF(e),n.value(i))},Z.prototype.JF=function(){var t,n,n,e,e,t,n=this.parent,n=n&&n.Xw;n&&(e=this.getDockScrollbarAttachedIndex(),_(e)||(e=-this.getColumnScrollOffsetX(e),n.value(e)))},Z.prototype.tw=function(){var t,n,e,i,n,r,i,t=this,n=t.parent,e=t.vw(t.Tb),i=t.ly;-1!==e&&e!==t.Tb&&(t.Tb=e),(n=n&&n.Xb)&&(i=(r=n.g4===D.ScrollType.pixels)?t.XF(e)-i:t.qF(e),n.value(i))},Z.prototype.aw=function(){var t,n,e,t=this,n=t.parent;n&&n.zb&&(e=n.options.scrollByPixel,n.zb.g4=e?D.ScrollType.pixels:D.ScrollType.continuous),n&&n.Xg&&(n.options.scrollbarAppearance===D.ScrollbarAppearance.mobile&&n.kC(),n.options.scrollIgnoreHidden&&(t.$F=t.tP(!0)),n.Xg())},Z.prototype.ew=function(){var t,n,e,t=this,n=t.parent;n&&n.Xb&&(e=n.options.scrollByPixel,n.Xb.g4=e?D.ScrollType.pixels:D.ScrollType.continuous),n&&n.QC&&(n.options.scrollbarAppearance===D.ScrollbarAppearance.mobile&&n.kC(),n.options.scrollIgnoreHidden&&(t.nP=t.eP(!0)),n.QC())},Z.prototype.Sw=function(){var t,n,e,t=this,n=0,e=V(t);return n=0<e?t.O5(e-1):t.k9()},Z.prototype.pw=function(){var t,n,e,t=this,n=0,e=Y(t);return n=0<e?t.j5(e-1):t.N9()},Z.prototype.k9=function(t){return this.O5(-1,t)},Z.prototype.O5=function(t,n,e){for(var i,r,o,i=this,r=i.getColumnCount(n),o=e?r-1:r-1-H(i);t<o;)if(i.getColumnVisible(++t,n)&&0<i.nn(t,n))return t;return j},Z.prototype.r6=function(t,n,e){for(var i=this,r=e?0:V(i);r<t;)if(i.getColumnVisible(--t,n)&&0<i.nn(t,n))return t;return j},Z.prototype.N9=function(t){return this.j5(-1,t)},Z.prototype.j5=function(t,n,e){for(var i,r,o,i=this,r=i.getRowCount(n),o=e?r-1:r-1-z(i);t<o;)if(i.getRowVisible(++t,n)&&0<i.Gt(t,n))return t;return j},Z.prototype.nI=function(t,n,e){for(var i=this,r=e?0:Y(i);r<t;)if(i.getRowVisible(--t,n)&&0<i.Gt(t,n))return t;return j},Z.prototype.iP=function(){this.Ww=!0,this.tw()},Z.prototype.rP=function(){this.Zw=!0,this.ow()},Z.prototype.XF=function(t){var n,e,i,r,e,o,a,u,n=this,e=Y(n),i,r=e,e=r+(U(n)-z(n)-e)-1,o=0;if(!(t<=r))for(e<t&&(t=e),a=r;a<t;a++)o+=u=n.Gt(a);return o},Z.prototype.QF=function(t){var n,e,i,r,e,o,a,u,n=this,e=V(n),i,r=e,e=r+(G(n)-H(n)-e)-1,o=0;if(!(t<=r))for(e<t&&(t=e),a=r;a<t;a++)o+=u=n.nn(a);return o},Z.prototype.qF=function(t){var n,e,n=this.parent;return n&&n.options.scrollIgnoreHidden?(e=this.eP().visibleIndex)[t]:t},Z.prototype.oP=function(t){var n,e,n=this.parent;return n&&n.options.scrollIgnoreHidden?(e=this.eP().originalIndex)[t]:t},Z.prototype.KF=function(t){var n,e,n=this.parent;return n&&n.options.scrollIgnoreHidden?(e=this.tP().visibleIndex)[t]:t},Z.prototype.aP=function(t){var n,e,n=this.parent;return n&&n.options.scrollIgnoreHidden?(e=this.tP().originalIndex)[t]:t},Z.prototype.tP=function(t){var n,t,e,i,r,o,a,u,s,n=this;if(n.$F&&!t)return n.$F;if(t=V(n),e=G(n)-H(n)-t,o=n.Jt,a={visibleIndex:{},originalIndex:{}},!((r=(i=t)+e-1)-i+1<=0)){for(u=0,s=i;s<=r;s++)a.originalIndex[u]=s,a.visibleIndex[s]=u,0<o.Kt(s)&&u++;for(s--,u--;o.Kt(s)<=0&&i<=s;)a.originalIndex[u]=s,a.visibleIndex[s]=u,s--}return a},Z.prototype.eP=function(t){var n,t,e,i,r,o,a,u,s,n=this;if(n.nP&&!t)return n.nP;if(t=Y(n),e=U(n)-z(n)-t,o=n.Jt,a={visibleIndex:{},originalIndex:{}},!((r=(i=t)+e-1)-i+1<=0)){for(u=0,s=i;s<=r;s++)a.originalIndex[u]=s,a.visibleIndex[s]=u,0<o.Gt(s)&&u++;for(s--,u--;o.Gt(s)<=0&&i<=s;)a.originalIndex[u]=s,a.visibleIndex[s]=u,s--}return a},Z.prototype.vw=function(t,n){var e,i,r,o,e=this,r=Y(e),o=U(e)-z(e)-1;if(n){if((i=e.nI((t=o<t?o:t)+1))!==j&&r<=i)return i}else if((i=e.j5((t=t<r?r:t)-1))!==j&&i<=o)return i;return-1},Z.prototype.ww=function(t,n){var e,i,r,o,e=this,r=V(e),o=G(e)-H(e)-1;if(n){if((i=e.r6((t=o<t?o:t)+1))!==j&&r<=i)return i}else if((i=e.O5((t=t<r?r:t)-1))!==j&&i<=o)return i;return-1},Z.prototype.uP=function(t,n,e){var i,r,o,a,u;if(e<n)return e;for(i=0,r=this.Jt,a=o=e;n<=a;a--)if(!((u=r.Gt(a))<=0)){if(t<(i+=u))break;o=a}return o},Z.prototype.gw=function(t,n,e){for(var i,r,o,a,u,i=0,r=e,o=0,a=e;n<=a;a--)if(!((u=this.Gt(a))<=0)&&(r=a,t<=(i+=u))){o=t-i;break}return{Ky:r,Xy:o}},Z.prototype.sP=function(t,n,e){var i,r,o,a,u;if(e<n)return e;for(i=0,r=this.Jt,a=o=e;n<=a;a--)if(!((u=r.Kt(a))<=0)){if(t<(i+=u))break;o=a}return o},Z.prototype.Cw=function(t,n,e){for(var i,r,o,a,u,i=0,r=e,o=0,a=e;n<=a;a--)if(!((u=this.nn(a))<=0)&&(r=a,t<=(i+=u))){o=t-i;break}return{iw:r,Xy:o}},Z.prototype.cP=function(){var t,n,e,i,r,o,a,u,t=this,n=t.Fi(),e=t.Yy(1,3),i=0,r=0;if(e)for(o=0;o<e.length;o++)i+=a=e[o].width,0<a&&r++;return 0==(u=i/(r=0===r?1:r))?1:w(t.Gy(n)/u)},Z.prototype.fP=function(){var t,n,e,i,r,o,a,u,t=this,n=t.Fi(),e=t._y(1,3),i=0,r=0;if(e)for(o=0;o<e.length;o++)i+=a=e[o].height,0<a&&r++;return 0==(u=i/(r=0===r?1:r))?1:w(t.Sy(n)/u)},Z.prototype.mw=function(t){var n,e,i,r,e,e,r;return _(t)&&(t=3),e=(n=this).parent,i=Y(n),r=z(n),e&&e.options.scrollbarMaxAlign?(e=n.Fi(),n.uP(n.Sy(e),i,U(n)-r-1)):(e=n.getRowCount(t),3!==t&&2!==t||(e-=r),(r=n.nI(e,t))===j?i:r)},Z.prototype.Mw=function(t){var n,e,i,e,e,n;return _(t)&&(t=3),e=(n=this).parent,i=V(n),e&&e.options.scrollbarMaxAlign?(e=n.Fi(),n.sP(n.Gy(e),i,G(n)-H(n)-1)):(e=n.getColumnCount(t),3!==t&&1!==t||(e-=H(n)),(n=n.r6(e,t))===j?i:n)},Z.prototype.lP=function(){var e,i,r,t,n,o,a,a,a,a,o,e=this,i=Y(e),r=V(e),t=U(e)-z(e)-1,n=G(e)-H(e)-1,o=e.Ut,a=o.getLastNonNullRow(3);return i<a&&(i=a),a=o.getLastNonNullCol(3),r<a&&(r=a),a=o.getLastNonNullRow(2),i<a&&(i=a),a=o.getLastNonNullCol(1),r<a&&(r=a),(o=Z.fh)&&h(o,function(t,n){var n,n,n=n.lastNonNullRowAndCol;n&&(n=n.call(e),i=B(i,n.lastNonNullRow),r=B(r,n.lastNonNullCol))}),{lastNonNullRow:i=t<i?t:i,lastNonNullCol:r=n<r?n:r}},Z.prototype.getLastNonNullRow=function(){return this.lP().lastNonNullRow},Z.prototype.getLastNonNullColumn=function(){return this.lP().lastNonNullCol},Z.prototype.$A=function(t,n,e){var i,r,o,a,u,a,i=this,r=i.Tb,o=i.ly,a=i.mw(),u=!_(e);(t=r>=i.getRowCount()&&a<t?a:t)>=i.pw()&&t<=a&&(u||t!==r||n!==o)&&((a=i.parent)&&(a.ib&&a.ib.yy(i,t,n||0,e),i.tw()),a&&!a.options.scrollbarShowMax&&i.ew(),i.invalidateLayout())},Z.prototype.o9=function(t,n,e){var i,r,o,a,u,a,i=this,r=i.Ab,o=i.my,a=i.Mw(),u=!_(e);(t=r>=i.getColumnCount()&&a<t?a:t)>=i.Sw()&&t<=a&&(u||t!==r||n!==o)&&((a=i.parent)&&(a.ib&&a.ib.wy(i,t,n||0,e),i.ow()),a&&!a.options.scrollbarShowMax&&i.aw(),i.invalidateLayout())},Z.prototype.JL=function(t,n,e){var i,r,o,t,a,a,a,u,s,c,r,f,i=this,r=t.row,o=t.col,t=t.hitTestType;return _(r)||_(o)?j:((a=i.getSpan(r,o,t))&&(r=a.row,o=a.col),i.Cb&&(a=i.Cb.D7(r,o,t))&&(r=a.row,o=a.col),a=i.Il(r,o,t),c=i.getCellRect(r,o,u=1===t?-1:O,s=2===t?-1:O,!0),r={sheet:i,row:r,col:o,sheetArea:t},(f=a.cellType||i.$f(t)).Bn(n,e,a,c,r))},Z.prototype.bC=function(){this.unbindAll(),this.E3()},Z.prototype.dA=function(t,n,e){for(var t,i,r,o,a,u,s,c,f,u,f,f,t=this.JS(t),i=t.row,r=t.col,o=i+t.rowCount,a=r+t.colCount,s=i;s<o;s++)for(c=r;c<a;c++)if(u=(f=this.getSpan(s,c,e))?f.row:s,f=f?f.col:c,u=this.getActualStyle(u,f,e),f=n&&this.XT(s,e),!0===u.locked&&!f)return!0;return!1},Z.prototype.zT=function(t,n,e,i,r,o){if(-1<=t&&t<r&&-1<=n&&n<o){if(-1===t&&-1===n)return!0;if(-1===t){if(0!==i&&n+i<=o)return!0}else if(-1===n){if(0!==e&&t+e<=r)return!0}else if(0!==i&&n+i<=o&&0!==e&&t+e<=r)return!0}return!1},Z.prototype.GT=function(t,n,e,i){var r,o,o,o,r=this;return!(t<0&&n<0)&&(t<0&&(o=r.Ut.K_(1))&&o.spans&&0<o.spans.length?r.Ut.GT(-1,n,-1,i,1):n<0&&(o=r.Ut.K_(2))&&o.spans&&0<o.spans.length?r.Ut.GT(t,-1,e,-1,2):!!((o=r.Ut.K_(3))&&o.spans&&0<o.spans.length)&&r.Ut.GT(t,n,e,i,3))},Z.prototype.suspendPaint=function(){var t,n,t=this,n=t.My;t.My++,0===n&&Z.et(t,ct,{suspend:!0})},Z.prototype.resumePaint=function(){var t=this;t.My--,t.My<=0&&(t.My=0,Z.et(t,ct,{suspend:!1}),t.hP())&&t.zw()},Z.prototype.hP=function(){var t=this.parent;return!t||t.getActiveSheet()===this},Z.prototype.isPaintSuspended=function(){return 0<this.My},Z.prototype.nR=function(t,n){for(var e,i,r,o,e=this,i=t&&t.length,r=0;r<i;r++)if(o=t[r],n.intersect(o.row,o.col,o.rowCount,o.colCount))return t.splice(r,1),e.nR(t,n.union(o));return n},Z.prototype.getClipboardHelperObj=function(){var t=this.ST();return{isCutting:t.ES,ranges:t._S,showInsertCopyPasteCells:t.TT}},Z.prototype.resetFloatingObjectHelperData=function(t){this.dP&&this.dP.remove(t)},Z.prototype.ST=function(){var t=this,n=t.parent;return t.bM||(t.bM=n&&n.bM),t.bM},Z.prototype.BO=function(){var t;return this.MC||((t=this).MC=new a.Wh(function(){!t.MC||t.parent&&t.parent.Vp&&t.parent.Vp.endingCallback||(Z.et(t,"onImageLoaded"),t.repaint())})),this.MC},Z.prototype.Qy=function(){var t,n=this.parent;if(n)return n.commandManager()},Z.prototype.jT=function(t,n){this.ki(I.Events.InvalidOperation,{sheet:this,sheetName:this.name(),invalidType:t,message:n})},Z.prototype.Rj=function(t,n,e,i,r,o){var a,u;0===this.vf&&(a={sheet:this,sheetName:this.name(),row:n,col:e,sheetArea:i,propertyName:t,oldValue:r,newValue:o,isUndo:this.Nj},this.ki(I.Events.CellChanged,a),(u=this.Ut).ZI(["cellChanged",t,n,e,i,o,r]))},Z.prototype.eT=function(t,n,e,i){this.ki(I.Events.ValueChanged,{sheet:this,sheetName:this.name(),row:t,col:n,oldValue:e,newValue:i})},Z.prototype.Dj=function(t,n,e,i,r){var o,a,o;if(0===this.vf){if(o={sheet:this,sheetName:this.name(),col:t,sheetArea:n,propertyName:e,newValue:i,oldValue:r,cancel:!1},"addColumns"!==e&&"deleteColumns"!==e||(o.count=i),this.ki(I.Events.ColumnChanging,o),!0===o.cancel)return!1;(a=this.Ut).ZI(["columnChanging",t,n,e,r,i])}return o=this.getDockScrollbarAttachedIndex(),_(o)||this.vP(),!0},Z.prototype.vj=function(t,n,e,i,r){var o,a,o;0===this.vf?(o={sheet:this,sheetName:this.name(),col:t,sheetArea:n,propertyName:e,newValue:i,oldValue:r,isUndo:this.Nj},"addColumns"!==e&&"deleteColumns"!==e||(o.count=i),this.ki(I.Events.ColumnChanged,o),(a=this.Ut).ZI(["columnChanged",t,n,e,r,i])):this.Lj(this,[{col:t}],1),o=this.mP,_(o)||this.gP()},Z.prototype._j=function(t,n,e,i){var r,o,a,u,s,o=[];if(this.tables){for(r=this.tables.pP(t,n,e,i),a=0;a<r.length;a++)o.push(r[a].name());0<o.length&&(u={isUndo:this.Nj,sheet:this,sheetName:this.name(),row:t,col:e,rowCount:n,colCount:i,tableNames:o,action:2},this.ki(I.Events.RangeChanged,u),(s=this.Ut).ZI(["rangeChanged",t,n,e,i]))}},Z.prototype.kj=function(t,n,e,i,r){var o,a;if(0===this.vf){if(o={sheet:this,sheetName:this.name(),row:t,sheetArea:n,propertyName:e,newValue:i,oldValue:r,cancel:!1},"addRows"!==e&&"deleteRows"!==e||(o.count=i),this.ki(I.Events.RowChanging,o),!0===o.cancel)return!1;(a=this.Ut).ZI(["rowChanging",t,n,e,r,i])}return!0},Z.prototype.dj=function(t,n,e,i,r){var o,a;0===this.vf?(o={sheet:this,sheetName:this.name(),row:t,sheetArea:n,propertyName:e,newValue:i,oldValue:r,isUndo:this.Nj},"addRows"!==e&&"deleteRows"!==e||(o.count=i),this.ki(I.Events.RowChanged,o),(a=this.Ut).ZI(["rowChanged",t,n,e,r,i])):this.Lj(this,[{row:t}],2)},Z.prototype.Oj=function(t,n){n!==t&&(this.ki(I.Events.ViewZoomed,{sheet:this,sheetName:this.name(),oldZoomFactor:t,newZoomFactor:n}),this.ki(I.Events.UserZooming,{sheet:this,sheetName:this.name(),oldZoomFactor:t,newZoomFactor:n}))},Z.prototype.EA=function(t,n){return!(this.O9||!this.rt._A(t,n)||(this.ki(I.Events.SelectionChanging,{sheet:this,sheetName:this.name(),oldSelections:t,newSelections:n}),0))},Z.prototype.jA=function(t,n){this.ki(I.Events.SelectionChanged,{sheet:this,sheetName:this.name(),oldSelections:t,newSelections:this.getSelections(),shiftKey:n})},Z.prototype.SI=function(t,n,e,i,r,o,a,u,s,c,f){var l,t,l={sheet:this,sheetName:this.name(),row:t,col:n,rowCount:e,colCount:i,changedCells:r,action:o},t={sheet:this,sheetName:this.name(),row:t,col:n,rowCount:e,colCount:i,changedCells:r,isUndo:!!c,action:o};a&&(t.sheetArea=l.sheetArea=a),u&&(l.value=u),(r&&0<r.length||f!==O)&&(s&&0<s.length&&(t.tableNames=s),this.ki(I.Events.RangeChanged,t),this.ki(I.Events.FormulaTextboxRangeChanged,l))},Z.prototype._i=function(t,n){var t={sheet:this,sheetName:this.name(),oldStatus:t,newStatus:n};this.ki(I.Events.EditorStatusChanged,t)},Z.prototype.bP=function(){return this.yP||(this.yP=(0,l.GC$)(y("input"))),this.yP},Z.prototype.o5=function(){var t=this;return t.parent&&t.parent.options.pasteSkipInvisibleRange},Z.prototype.lT=function(t,n,e){var i,r,o,a,u,i=this,r=0,o=i.getColumnWidth,a=i.getColumnCount();for(e&&(o=i.getRowHeight,a=i.getRowCount()),u=t=t<0?0:t;u<t+n;u++)u<a&&0===o.call(i,u)&&(r++,n++);return r},Z.prototype.ox=function(t,n,e){var i,r,o,a,i=this,r=0,o=i.getColumnWidth;for(e&&(o=i.getRowHeight),a=t=t<0?0:t;t-n<a&&0<a;a--)0===o.call(i,a)&&(r++,n++);return r},Z.prototype.ix=function(t,n,e){var i,r,o,a,i=this,r=0,o=i.getColumnWidth;for(e&&(o=i.getRowHeight),a=t=t<0?0:t;a<t+n;a++)0===o.call(i,a)&&r++;return r},Z.prototype.bind=function(t,n,e){this.bP().bind(t+dt,n,e)},Z.prototype.unbind=function(t,n){this.bP().unbind(t+dt,n)},Z.prototype.ki=function(t,n,e){this.updateEventsData&&this.updateEventsData(t,n),0!==this.vf&&!e||this.bP().trigger(t,n)},Z.prototype.unbindAll=function(){this.unbind(dt)},Z.prototype.D3=function(t,n,e){0<=t.indexOf(".")?this.bind(t,n,e):this.bind(t+vt,n,e)},Z.prototype._3=function(t,n){0<=t.indexOf(".")?this.unbind(t,n):this.unbind(t+vt,n)},Z.prototype.E3=function(){this.unbind(vt)},Z.prototype.ot=function(){var t=this.kg;return new I.Rect(t.x,t.y,t.width,t.height)},Z.prototype.cg=function(t){this.kg=new I.Rect(t.x,t.y,t.width,t.height)},Z.prototype.scroll=function(t,n){var e,i,r,o,a,i,u,s,r,n,c,f,n,e=this,i=e.parent;i&&(o=(r=i.options).scrollByPixel,a=r.scrollPixel,i=i.ib,u=r.scrollbarShowMax,s=r.showHorizontalScrollbar,r=r.showVerticalScrollbar,0!==n&&(c=(n=i.bw(e,Math.round(n)/a)).iw,f=o?n.Xy:0,c===e.Ab&&f===e.my||(i.wy(e,c,f),s&&(e.ow(),u||(e.Zw=!0)))),0!==t)&&(c=(n=i.hw(e,Math.round(t)/a)).Ky,f=o?n.Xy:0,c===e.Tb&&f===e.ly||(i.yy(e,c,f),r&&(e.tw(),u||(e.Ww=!0))))},Z.prototype.isCtrlPressed=function(t){return this.rt&&this.rt.ctrl},Z.prototype.deselectIgnoreSpan=function(){return!1},Z.prototype.Wb=function(t,n){var e,i,r,o,a,u,s,c,f,l,h,d,v,m,m,g,p,b,y,w,M,s,i,m,e=this,i=e.zoom(),r=n.newValue,o=n.oldValue,a=n.scrollEventType,u=t.options.scrollByPixel,s=t.options.scrollPixel;if(o=n.oldValue=_(o)?0:u?S(o):C(o+"",10),e.Ww=!1,l=e.pw(),h=e.mw(),d=t.options.scrollbarShowMax,v=0,u){for(m=(r=S(r))-o,a!==D.Zi.thumbTrack&&(r=o+(m*=s*i))<0&&(r=0),d||(e.Ww=!0,a===D.Zi.smallIncrement&&r===o?r+=s*i:n.ignoreUpdatePosition=!0),b=(m=e.frozenRowCount())+(g=e.getRowCount()-e.frozenTrailingRowCount()-m)-1,w=y=0,M=m;M<=b;M++)if(r<=(y+=w=e.Gt(M))){v=y-r-w,c=M;break}_(c)&&(v=-e.Gt(c=b),r=y)}else c=C(r+"",10),c=e.oP(c),a===D.Zi.largeDecrement||a===D.Zi.smallDecrement?(a===D.Zi.largeDecrement&&(c=e.QA()),-1!==(f=e.vw(c,!0))&&f!==c&&(c=f),d||(e.Ww=!0,n.ignoreUpdatePosition=!0)):a!==D.Zi.largeIncrement&&a!==D.Zi.smallIncrement||(a===D.Zi.largeIncrement&&(c=e.sB())===e.Tb&&c++,d||(e.Ww=!0,a===D.Zi.smallIncrement&&r===o&&c++),-1!==(f=e.vw(c))&&f!==c&&(c=f)),h<(c=c<l?l:c)&&(c=h);s=u?S(r):e.qF(c),n.newValue!==s&&(n.newValue=s),i=s,0!==(m=e.Gt(c))&&(i+=it(v)/m),n.newValueWithOffset=u?s:i,o===s&&!u||t.ib.ay(e,c,v)},Z.prototype.Kb=function(t){var n,e,i,r,o,a,n=this,e=t.Xb,i;e.g4!==D.ScrollType.pixels&&(r=n.oP(e.value()),o=n.pw(),a=n.mw(),r<o?e.value(n.qF(o)):a<r&&e.value(n.qF(a))),t.iy(),t.options.scrollbarShowMax||(t.ib.scrolling?n.Ww=!0:t.QC())},Z.prototype.Fb=function(t,n){var e,i,r,o,a,u,s,c,f,l,h,d,v,m,m,g,p,b,y,w,M,s,i,m,e=this,i=e.zoom(),r=n.newValue,o=n.oldValue,a=n.scrollEventType,u=t.options.scrollByPixel,s=t.options.scrollPixel;if(o=n.oldValue=_(o)?0:u?S(o):C(o+"",10),e.Zw=!1,l=e.Sw(),h=e.Mw(),d=t.options.scrollbarShowMax,v=0,u){for(m=(r=S(r))-o,a!==D.Zi.thumbTrack&&(r=o+(m*=s*i))<0&&(r=0),d||(e.Zw=!0,a===D.Zi.smallIncrement&&r===o?r+=s*i:n.ignoreUpdatePosition=!0),b=(m=e.frozenColumnCount())+(g=e.getColumnCount()-e.frozenTrailingColumnCount()-m)-1,w=y=0,M=m;M<=b;M++)if(r<=(y+=w=e.nn(M))){v=y-r-w,c=M;break}_(c)&&(v=-e.nn(c=b),r=y)}else c=C(r+"",10),c=e.aP(c),a===D.Zi.largeDecrement||a===D.Zi.smallDecrement?(a===D.Zi.largeDecrement&&(c=e.fB()),-1!==(f=e.ww(c,!0))&&f!==c&&(c=f),d||(e.Zw=!0,n.ignoreUpdatePosition=!0)):a!==D.Zi.largeIncrement&&a!==D.Zi.smallIncrement||(a===D.Zi.largeIncrement&&(c=e.oB())===e.Ab&&c++,d||(e.Zw=!0,a===D.Zi.smallIncrement&&r===o&&c++),-1!==(f=e.ww(c))&&f!==c&&(c=f)),h<(c=c<l?l:c)&&(c=h);s=u?S(r):e.KF(c),n.newValue!==s&&(n.newValue=s),i=s,0!==(m=e.nn(c))&&(i+=it(v)/m),n.newValueWithOffset=u?s:i,o===s&&!u||t.ib.ay(e,c,v,!0)},Z.prototype.Gb=function(t){var n,e,i,r,o,a,n=this,e=t.zb;n&&e&&((i=e.g4===D.ScrollType.pixels)||(r=n.aP(e.value()),o=n.Sw(),a=n.Mw(),r<o?e.value(n.KF(o)):a<r&&e.value(n.KF(a))),t.iy(),t.options.scrollbarShowMax||(t.ib.scrolling?n.Zw=!0:t.WC()))},Z.prototype.onHorizontalDockScroll=function(t,n){var e,i,n,r,e=this.wP;_(e)||(i=n.oldValue,n=n.newValue,this.scrollColumnView(e,-(r=n-i)))},Z.prototype.WC=function(t,n,e){var i,r,o,a,o,u,u,a,s,c,f,l,h,d,v,m,h,f,n,t,h,f,s,i=this,r=e&&e.g4===D.ScrollType.pixels,o=i.frozenColumnCount(),a=i.getColumnCount()-i.frozenTrailingColumnCount()-o,o=o,u=i.Fi(),u=i.Gy(u),a=0==a?o:o+a-1,s=i.Ab,c=i.my,l=0;t?(r?(f=d=(h=i.Cw(u,o,a)).iw,l=v=h.Xy):f=i.sP(u,o,a),a=f):r&&(l=-i.nn(a)),n?r&&!t&&(l=-i.nn(a)):(h=(m=i.lP()).lastNonNullCol,a=(f=(f=i.sP(u,o,h))===o&&a<++f?a:f)<s?s<a?s:a:f,l=c),a<s?(i.Ab=a,i.my=r?l:0):s===a&&c<l&&(i.my=r?l:0),-1!==(n=i.ww(i.Ab))&&n!==i.Ab&&(i.Ab=n),e&&(s=f=h=t=0,r?(t=i.QF(o),h=i.QF(a)-l,f=u,s=i.QF(i.Ab)-i.my):(t=i.KF(o),h=i.KF(a),f=i.cP(),s=i.KF(i.Ab),f<1&&(f=1)),e.m4(t),e.v4(h),e.d4(f),e.w4(),e.value(s))},Z.prototype.$C=function(t){var n,e,i,r,o,e,n;t&&(n=this.getDockScrollbarAttachedIndex(),_(n)||(e=this.getColumnWidth(n),r=0,o=(i=this.getColumnScrollWidth(n))-e,e=e,n=-this.getColumnScrollOffsetX(n),t.m4(0),t.v4(o),t.d4(e),t.w4(),t.value(n)))},Z.prototype.QC=function(t,n,e){var i,r,o,a,o,u,a,s,c,f,l,u,h,d,v,m,h,f,n,t,h,f,s,i=this,r=e&&e.g4===D.ScrollType.pixels,o=i.frozenRowCount(),a=i.getRowCount()-i.frozenTrailingRowCount()-o,o=o,u=i.Fi(),a=0==a?o:o+a-1,s=i.Tb,c=i.ly,l=0,u=i.Sy(u);t?(r?(f=d=(h=i.gw(u,o,a)).Ky,l=v=h.Xy):f=i.uP(u,o,a),a=f):r&&(l=-i.Gt(a)),n?r&&!t&&(l=-i.Gt(a)):(h=(m=i.lP()).lastNonNullRow,a=(f=(f=i.uP(u,o,h))===o&&a<++f?a:f)<s?s<a?s:a:f,l=c),a<s?(i.Tb=a,i.ly=r?l:0):s===a&&c<l&&(i.ly=r?l:0),-1!==(n=i.vw(i.Tb))&&n!==i.Tb&&(i.Tb=n),e&&(s=f=h=t=0,r?(t=i.XF(o),h=i.XF(a)-l,f=u,s=i.XF(i.Tb)-i.ly):(t=i.qF(o),h=i.qF(a),f=i.fP(),s=i.qF(i.Tb),f<1&&(f=1)),e.m4(t),e.v4(h),e.d4(f),e.w4(),e.value(s))},Z.prototype.FM=function(){for(var t,n,e,i,r,o,a,t=this,n=t.getRowCount(),e=t.getColumnCount(),i=0;i<n;i++)for(r=0;r<e;r++)(o=t.getValue(i,r))instanceof Date&&((a=t.Z_(i,r))&&a.g5(o),t.CL(i,r,a))},Z.prototype.GB=function(t,n){var e=this;1===e.getRowCount(D.SheetArea.colHeader)&&(e.qL(t,n,mt,!1,D.SheetArea.colHeader),e.Zw=!0,e.zw())},Z.prototype.Lt=function(t){var n;return this.Ut.getColumnHeaderFitMode(!1,1,t)},Z.prototype.vL=function(t,n,e,i,r){var o,a,r,e,u,s,s,s,s,c;return _(i)&&(i=3),o=this,r||(a=o.t0(t,n,i),_(a))?(r=o.getCellType(t,n,i),e=e,"General"===(u=!(u=(u=o.l0(t,n,"formatter",i))&&"General"!==u?u:o.l0(t,n,"_autoFormatter",i))&&(s=o.pivotTables,s=3===i&&s?s.findPivotTable(t,n):j)?(s=s.hqt(t,n))&&s.formatter:u)&&(u=O),s={},c=o.l0(t,n,"quotePrefix",i),(e=r.format(e,u,s,{sheet:o,row:t,col:n,sheetArea:i,quotePrefix:c}))&&"string"==typeof e?e.replace(/\r\n?/g,"\n"):e):a},Z.prototype.isRowFilterOut=function(t){return this.XT(t)},Z.prototype.getHDockScrollbarWidth=function(){var t,n,e,i,r,o,a,u,t=this.getDockScrollbarAttachedIndex(),n,e=0;return e=this.Vy&&!_(t)&&(i=this.frozenTrailingColumnCount(),(o=(r=this.getColumnCount())-i)<=t||t<=(a=r-1))?(u=this.Fi()).zy:e},Z.prototype.getDockScrollbarAttachedIndex=function(){return this.wP},Z.prototype.setDockScrollbarAttachedIndex=function(t){this.wP=t,this.Zw=!0,this.zw()},Z.prototype.vP=function(){var t,n,e,t,t=this.getDockScrollbarAttachedIndex(),n,e,t=this.Ut.Q_(!1,D.SheetArea.viewport).NE(t);this.mP=t},Z.prototype.gP=function(){var t,n,e,i,e,t,n,e=this.Ut.Q_(!1,D.SheetArea.viewport).EE(),i=this.mP,e=e.indexOf(i);this.setDockScrollbarAttachedIndex(e=-1===e?j:e)},Z.prototype.setScrollableColumnIndexInFrozenTrailingColumnArea=function(t){var n,e,i,r;0<=t&&(t+=i=(n=this.getColumnCount())-(e=this.frozenTrailingColumnCount()))<=(r=n-1)&&this.setDockScrollbarAttachedIndex(t)},Z.prototype.getColumnScrollWidth=function(t){var n,e,n,e;return this.Ut.Q_(!1,D.SheetArea.viewport).getScrollContentWidth(t)},Z.prototype.setColumnScrollWidth=function(t,n){var e,i,e,i;this.Ut.Q_(!1,D.SheetArea.viewport).setScrollContentWidth(t,n),this.Zw=!0,this.zw()},Z.prototype.getColumnScrollOffsetX=function(t){var n,e,n,e;return this.Ut.Q_(!1,D.SheetArea.viewport).getScrollOffsetX(t)},Z.prototype.setColumnScrollOffsetX=function(t,n){var e,i,e,i;this.Ut.Q_(!1,D.SheetArea.viewport).setScrollOffsetX(t,n),this.JF(),this.n3(),this.LL(t)},Z.prototype.scrollColumnView=function(t,n){var e,i,r,o,a,u,e,i=this.Ut.Q_(!1,D.SheetArea.viewport),r=this.getColumnWidth(t),o=this.getColumnScrollWidth(t),a=this.getColumnScrollOffsetX(t),u=a+n;0<u?n=-a:u<r-o&&(n=r-o-a),i.setScrollOffsetX(t,n,!0),this.JF(),this.n3(),this.LL(t)},Z.prototype.getScrollTooltipContent=function(t,n){var e,i,t,i,e="",i=this.Ab+1;return t?e=c().Tip_Row+(this.Tb+1):(t=this.getDockScrollbarAttachedIndex(),n&&!_(t)&&(i=this.getDockScrollbarAttachedIndex()+1),1!==this.options.colHeaderAutoText&&(i=I.util.Vf(i)),e=c().Tip_Column+i,n&&!_(t)&&(i=S(this.getColumnScrollOffsetX(t)),e+=" ".concat(c().Tip_Column_Offset,": ").concat(i))),e},Z.prototype.expandSelection=function(t,n){for(var e,i,r,o,a,u,e=new I.Range(n.row,n.col,n.rowCount,n.colCount),i=new I.Range(n.row,n.col,n.rowCount,n.colCount),r=!0,o=!0,a=!0,u=!0;r||o||a||u;)r&&I.util.X0(t,e.row-1,e.col-1,e.colCount+2)&&(e.row=e.row-1,e.rowCount=e.rowCount+1),o&&I.util.X0(t,e.row+e.rowCount,e.col-1,e.colCount+2)&&(e.rowCount=e.rowCount+1),a&&I.util.q0(t,e.row-1,e.col-1,e.rowCount+2)&&(e.col=e.col-1,e.colCount=e.colCount+1),u&&I.util.q0(t,e.row-1,e.col+e.colCount,e.rowCount+2)&&(e.colCount=e.colCount+1),u=a=o=r=!1,i.row===e.row?i.rowCount===e.rowCount-1&&(o=!0):(r=!0,i.rowCount===e.rowCount-2&&(o=!0)),i.col===e.col?i.colCount===e.colCount-1&&(u=!0):(a=!0,i.colCount===e.colCount-2&&(u=!0)),i.row=e.row,i.col=e.col,i.rowCount=e.rowCount,i.colCount=e.colCount;return e},Z.prototype.deleteBlankContent=function(t,n){1===n.rowCount&&1===n.colCount||(I.util.X0(t,n.row,n.col,n.colCount)||(n.row=n.row+1,n.rowCount=n.rowCount-1),I.util.X0(t,n.row+n.rowCount-1,n.col,n.colCount)||(n.rowCount=n.rowCount-1),I.util.q0(t,n.row,n.col,n.rowCount)||(n.col=n.col+1,n.colCount=n.colCount-1),I.util.q0(t,n.row,n.col+n.colCount-1,n.rowCount))||(n.colCount=n.colCount-1)},Z.prototype.MP=function(){return!1},Z.prototype.FT=function(){return c().Exp_InvalidOperationInProtect},Z.prototype.Ci=function(t,n,e){return this.CP(t,n,e)},Z.prototype.CP=function(t,n,e){return this.Ut.Ci(t,n,e)},Z.rL=1,Z.Pp=wt,Z.n8=200,Z.e8=20,Z.r8=1,Z.o8=1,Mt=Z,t.Worksheet=Mt,(0,I.$e)(Mt),(n=Mt.prototype).visible=e("visible",D.SheetTabVisible.visible,function(t){var n,e,i,r,o,a,u,s,n=this,e=n.parent,i=e.sheets,r=i.length,o=l.GC$.inArray(n,i),a=e.getActiveSheetIndex(),u="visible";if(!0!==t&&!1!==t&&t!==D.SheetTabVisible.visible&&t!==D.SheetTabVisible.hidden&&t!==D.SheetTabVisible.veryHidden&&(n._ps[u]=D.SheetTabVisible.visible),!0===t?n._ps[u]=D.SheetTabVisible.visible:!1===t&&(n._ps[u]=D.SheetTabVisible.hidden),t===D.SheetTabVisible.visible||!0===t)a<0?(e.tb(o,1),e.w2&&e.w2.om<0&&(e.w2.om=o)):e.Xg();else if(o===a){for(s=o+1;s<r&&i[s].visible()!==D.SheetTabVisible.visible;)s++;if(r<=s)for(s=o-1;0<=s&&i[s].visible()!==D.SheetTabVisible.visible;)s--;e.w2&&s<e.w2.om&&(e.w2.om=s),s<0?(n.L0(!1),e._2=s,e.Cg()):e.tb(s,1)}else e.Xg()}),n.frozenColumnCount=e("frozenColumnCount",0,function(t){var n=this;n.Ab<t?n.Ab=t:""!==t&&0!==t&&null!==t||(n.Ab=0),n.Zw=!0,n.zw()},function(t){return 0<=t}),n.frozenRowCount=e("frozenRowCount",0,function(t){var n=this;n.Tb<t?n.Tb=t:""!==t&&0!==t&&null!==t||(n.Tb=0),n.Ww=!0,n.zw()},function(t){return 0<=t})},"./dist/plugins/autoMerge/autoMerge.js":function(B,t,n){"use strict";var e,b,i,n,a,u,s,n,c,y,l,h,w,M,C,r,o,f,i,n,i,d;function v(t,n){var t=d.call(this,t.row,t.col,t.rowCount,t.colCount)||this;return t.sheetArea=n,t.isAutoMerge=!0,t}function m(t,n,e){return e+"_"+t+"_"+n}function g(t,n,e){return n===t||(n===b.SheetArea.viewport?e&&t===b.SheetArea.rowHeader||!e&&t===b.SheetArea.colHeader:n===b.SheetArea.rowHeader?e&&t===b.SheetArea.viewport:n===b.SheetArea.colHeader&&!e&&t===b.SheetArea.viewport)}function p(t,n,e){t.clearSpan(n.row,n.col,n.rowCount,n.colCount,e)}function S(t,n,e){var i,r,o,a,u,s,c,f,l,h;return e===b.SheetArea.viewport&&!t.options.allowCellOverflow&&(i=n.row,r=n.col,o=n.rowCount,a=n.colCount,u=t.frozenRowCount(),s=t.frozenColumnCount(),c=t.frozenTrailingRowCount(),f=t.frozenTrailingColumnCount(),l=t.getRowCount(),h=t.getColumnCount(),0===u||-1!==i&&u<=i)&&(0===s||-1!==r&&s<=r)&&(0===c||-1!==i&&i+o<=l-c)&&(0===f||-1!==r&&r+a<=h-f)?((-1===r||0===r&&a===h)&&(r=t.getViewportLeftColumn(1),a=t.getViewportRightColumn(1)-r+1),(-1===i||0===i&&o===l)&&(i=t.getViewportTopRow(1),o=t.getViewportBottomRow(1)-i+1),(0,b.Ec)(i,r,o,a)):t.JS(n,e)}function T(t){this.Mf=t,this.SP=[],this.cE={},this.TP=[]}function A(t,n){var e,i,r,o,t,e=[],i=t.spans;if(i)for(r=0;r<i.length;r++)(o=i[r])&&e.push({n_:b.XFileConstants.xu,ref:u(o)});t=a(n,s),0<e.length&&(t?t.c_=t.c_.concat(e):(n.c_.push({n_:s,c_:e}),b.util.Pr(n,[b.XFileConstants.Su,b.XFileConstants.Tu,b.XFileConstants.Du,b.XFileConstants._u,b.XFileConstants.Eu,b.XFileConstants.bo,"sheetProtection","autoFilter",s,b.XFileConstants.ju,b.XFileConstants.Ou,b.XFileConstants.ku,"printOptions","pageMargins","pageSetup","headerFooter","rowBreaks","colBreaks","picture","drawing","legacyDrawing",b.XFileConstants.Fo,b.XFileConstants.Bo,b.XFileConstants.Bu,b.XFileConstants.Au])))}function I(t,n){var e,e,e,e=t.ZF(b.SheetArea.viewport);0<e.length&&(n.spans?n.spans=n.spans.concat(e):n.spans=e),0<(e=t.ZF(b.SheetArea.rowHeader)).length&&(n.rowHeaderSpan?n.rowHeaderSpan=n.rowHeaderSpan.concat(e):n.rowHeaderSpan=e),0<(e=t.ZF(b.SheetArea.colHeader)).length&&(n.colHeaderSpan?n.colHeaderSpan=n.colHeaderSpan.concat(e):n.colHeaderSpan=e)}function x(t,n,e,i){for(var r,o,a,u,s,c,f,l,h,d,v,m,g,p,r={},o=[],a=e.row,u=e.row+e.rowCount-1,s=e.col,c=e.col+e.colCount-1,f=s;f<=c;f++)if(t.getColumnVisible(f,i)&&!(t.getColumnWidth(f,i)<=0)){for(h=(l=n===y.restricted)&&s<f,d=void 0,v=a;v<=u;)if(!t.getRowVisible(v,i)||t.getRowHeight(v,i)<=0)v++;else{if((m=t.j5(v,i,!0))===C||u<m)break;if(_(t,v,f,m,f,i)){if(h&&!N(t,r,v,f,m,f,i)){d&&(g=new w(d,i),o.push(g),O(r,d,g),d=M),v=m;continue}p=m-v+1,d?d.rowCount+=p-1:d=(0,b.Ec)(v,f,p,1)}else d&&(g=new w(d,i),o.push(g),O(r,d,g),d=M);v=m}d&&(g=new w(d,i),o.push(g),O(r,d,g),d=M)}return{cache:r,spans:o}}function N(t,n,e,i,r,o,a){var u,n,u,n=n[m(e,t.r6(i,a,!0),a)];return n&&n.sheetArea===a&&n.row<=e&&r<=n.row+n.rowCount-1}function k(t,n,e,i){for(var r,o,a,u,s,c,f,l,h,d,v,m,g,p,r={},o=[],a=e.row,u=e.row+e.rowCount-1,s=e.col,c=e.col+e.colCount-1,f=a;f<=u;f++)if(t.getRowVisible(f,i)&&!(t.getRowHeight(f,i)<=0)){for(h=(l=n===y.restricted)&&a<f,d=void 0,v=s;v<=c;)if(!t.getColumnVisible(v,i)||t.getColumnWidth(v,i)<=0)v++;else{if((m=t.O5(v,i,!0))===C||c<m)break;if(_(t,f,v,f,m,i)){if(h&&!D(t,r,f,v,f,m,i)){d&&(g=new w(d,i),o.push(g),O(r,d,g),d=M),v=m;continue}p=m-v+1,d?d.colCount+=p-1:d=(0,b.Ec)(f,v,1,p)}else d&&(g=new w(d,i),o.push(g),O(r,d,g),d=M);v=m}d&&(g=new w(d,i),o.push(g),O(r,d,g),d=M)}return{cache:r,spans:o}}function D(t,n,e,i,r,o,a){var u,n,u,n=n[m(t.nI(e,a,!0),i,a)];return n&&n.sheetArea===a&&n.col<=i&&o<=n.col+n.colCount-1}function _(t,n,e,i,r,o){var a,u,s,c,f,l,a=t.Ut,u=t.getText(n,e,o),s=t.getText(i,r,o),c="[object Object]",f,l;return!(""===u&&""===s&&!t.NMi||u===c&&s===c||u!==s||a.findSpan(n,e,o)||a.findSpan(i,r,o))}function E(t,n,e,i){for(var n,r,o,n,a,u,s,c,f,l,h,d,h,d,n=x(t,n,e,i),r=n.cache,o=n.spans,n=e.row,a=e.row+e.rowCount-1,u=e.col,s=e.col+e.colCount-1,c=n;c<=a;c++)if(t.getRowVisible(c,i)&&!(t.getRowHeight(c,i)<=0))for(f=u;f<=s;f++)if(t.getColumnVisible(f,i)&&!(t.getColumnWidth(f,i)<=0)){if((l=t.O5(f,i,!0))===C||s<l)break;_(t,c,f,c,l,i)&&(h=r[m(c,f,i)],d=r[m(c,l,i)],h&&d?h.row===c&&d.row===c&&h.rowCount===d.rowCount&&(h.colCount+=l-f,j(o,d),O(r,d,h)):h?1===h.rowCount&&(h.colCount+=l-f,O(r,new b.Range(c,l,1,1),h)):d?1===d.rowCount&&(d.col=f,d.colCount+=l-f,O(r,new b.Range(c,f,1,1),d)):(h=new b.Range(c,f,1,l-f+1),d=new w(h,i),o.push(d),O(r,h,d)))}return{cache:r,spans:o}}function j(t,n){for(var e,i,e=0;e<t.length;e++)if((i=t[e]).sheetArea===n.sheetArea&&i.equals(n)){t.splice(e,1);break}}function O(t,n,e){for(var i,r,o,i=e.sheetArea,r=0;r<n.rowCount;r++)for(o=0;o<n.colCount;o++)t[m(n.row+r,n.col+o,i)]=e}function R(t,n,e,i){for(var n,r,o,a,u,n,s,c,f,l,h,d,h,d,n=k(t,n,e,i),r=n.cache,o=n.spans,a=e.row,u=e.row+e.rowCount-1,n=e.col,s=e.col+e.colCount-1,c=n;c<=s;c++)if(t.getColumnVisible(c,i)&&!(t.getColumnWidth(c,i)<=0))for(f=a;f<=u;f++)if(t.getRowVisible(f,i)&&!(t.getRowHeight(f,i)<=0)){if((l=t.j5(f,i,!0))===C||u<l)break;_(t,f,c,l,c,i)&&(h=r[m(f,c,i)],d=r[m(l,c,i)],h&&d?h.col===c&&d.col===c&&h.colCount===d.colCount&&(h.rowCount+=l-f,j(o,d),O(r,d,h)):h?1===h.colCount&&(h.rowCount+=l-f,O(r,new b.Range(l,c,1,1),h)):d?1===d.colCount&&(d.row=f,d.rowCount+=l-f,O(r,new b.Range(f,c,1,1),d)):(h=new b.Range(f,c,l-f+1,1),d=new w(h,i),o.push(d),O(r,h,d)))}return{cache:r,spans:o}}e=this&&this.__extends||(f=function(t,n){return(f=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(t,n){t.__proto__=n}:function(t,n){for(var e in n)Object.prototype.hasOwnProperty.call(n,e)&&(t[e]=n[e])}))(t,n)},function(t,n){if("function"!=typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function e(){this.constructor=t}f(t,n),t.prototype=null===n?Object.create(n):(e.prototype=n.prototype,new e)}),Object.defineProperty(t,"__esModule",{value:!0}),t.SelectionMode=t.AutoMergeDirection=t.AutoMergeMode=t.SR=void 0,b=n("Core"),i=n("Common"),n=n("./dist/plugins/autoMerge/autoMerge.res.en.js"),t.SR={en:n},a=b.util.xr,u=b.range_parser.jc,s=b.XFileConstants.Iu,n=new i.Common.ResourceManager(t.SR,"AutoMerge"),c=n.getResource.bind(n),(i=y=t.AutoMergeMode||(t.AutoMergeMode={}))[i.free=0]="free",i[i.restricted=1]="restricted",(n=l=t.AutoMergeDirection||(t.AutoMergeDirection={}))[n.none=0]="none",n[n.column=1]="column",n[n.row=2]="row",n[n.columnRow=3]="columnRow",n[n.rowColumn=4]="rowColumn",(i=h=t.SelectionMode||(t.SelectionMode={}))[i.source=0]="source",i[i.merged=1]="merged",d=b.Range,e(v,d),w=v,M=void 0,C=null,T.prototype.L0=function(){this.Mf=C},T.prototype.add=function(t,n,e,i,r){var o,a,u,s;for(void 0===i&&(i=b.SheetArea.viewport),void 0===r&&(r=h.source),a=0,u=o=this.all();a<u.length;a++)if((s=u[a]).sheetArea===i&&s.range.intersect(t.row,t.col,t.rowCount,t.colCount))throw new Error(c().Exp_RangeIsIntersected);this.SP.push({range:t,direction:n,mode:e,sheetArea:i,selectionMode:r})},T.prototype.remove=function(t,n){var e,i,r,o;for(void 0===n&&(n=b.SheetArea.viewport),e=this.SP,i=this.Mf.Ut,r=0;r<e.length;r++)if((o=e[r]).sheetArea===n&&o.range.equals(t)){p(i,t,n),e.splice(r,1);break}},T.prototype.clear=function(t){for(var n,e,i,r,o,a,u,s,c,f,l,n=this.SP,e=this.Mf.Ut,i=0;i<n.length;i++)r=n[i],t!==M&&t!==r.sheetArea||p(e,r.range,r.sheetArea);if(t===M)this.SP=[],this.cE={},this.TP=[];else{for(i=(o=this.SP).length-1;0<=i;i--)o[i].sheetArea===t&&o.splice(i,1);for(s in u=[],a=this.cE)a[s].sheetArea===t&&u.push(s);for(c=0,f=u;c<f.length;c++)delete a[s=f[c]];for(i=(l=this.TP).length-1;0<=i;i--)l[i].sheetArea===t&&l.splice(i,1)}},T.prototype.all=function(){return this.SP},T.prototype.Sb=function(n){return this.SP.some(function(t){return t.range.containsRange(n)})},T.prototype.AP=function(t){this.SP=t,this.IP()},T.prototype.D7=function(t,n,e){void 0===e&&(e=b.SheetArea.viewport);var t=this.cE[m(t,n,e)];return t?(0,b.Ec)(t.row,t.col,t.rowCount,t.colCount):C},T.prototype.ZF=function(n){return void 0===n&&(n=b.SheetArea.viewport),this.TP.filter(function(t){return t.sheetArea===n})},T.prototype.IP=function(a,u){var t,s,c,n,f,e,i,r;for(this.cE={},this.TP=[],t=this.SP,s=this.Mf,c=s.Ut,n=function(t){var n,e,i,r,t,o,n=t.direction,e=t.mode,i=t.sheetArea,r=u?s.JS(t.range,i):S(s,t.range,i),t=t.selectionMode===h.merged;(t||a)&&p(c,r,i),o=void 0,n===l.column?o=x(s,e,r,i):n===l.row?o=k(s,e,r,i):n===l.columnRow?o=E(s,e,r,i):n===l.rowColumn&&(o=R(s,e,r,i)),o&&(b.GC$.extend(f.cE,o.cache),f.TP=f.TP.concat(o.spans),t)&&o.spans.forEach(function(t){c.addSpan(t,i)})},f=this,e=0,i=t;e<i.length;e++)n(r=i[e])},T.prototype.JO=function(t,n,e){var i,r,o,a,a,u;if(void 0===e&&(e=b.SheetArea.viewport),!(t<0||n<=0))for(r=0,o=i=this.SP;r<o.length;r++)g((a=o[r]).sheetArea,e,!0)&&(t<=(u=(a=a.range).row)?a.row+=n:u<t&&t<u+a.rowCount&&(a.rowCount+=n))},T.prototype.qO=function(t,n,e){var i,r,o,a,a,u;if(void 0===e&&(e=b.SheetArea.viewport),!(t<0||n<=0))for(r=0,o=i=this.SP;r<o.length;r++)g((a=o[r]).sheetArea,e,!1)&&(t<=(u=(a=a.range).col)?a.col+=n:u<t&&t<u+a.colCount&&(a.colCount+=n))},T.prototype.xP=function(t,n,e){var i,r,o,a,a,u,s,c,f;if(void 0===e&&(e=b.SheetArea.viewport),!(t<0||n<=0)){for(i=this.SP,r=[],o=0;o<i.length;o++)g((a=i[o]).sheetArea,e,!0)&&(u=(a=a.range).row,s=a.rowCount,t<u?((c=t+n-u)<=0?u-=n:(u-=c,a.rowCount-=c),u<0&&(a.rowCount+=u,u=0),a.row=u):u<=t&&t<u+s&&(a.rowCount-=Math.min(n,u+s-t)),0===a.rowCount)&&r.push(o);for(f=r.length-1;0<=f;f--)i.splice(r[f],1)}},T.prototype.NP=function(t,n,e){var i,r,o,a,a,u,s,c,f;if(void 0===e&&(e=b.SheetArea.viewport),!(t<0||n<=0)){for(i=this.SP,r=[],o=0;o<i.length;o++)g((a=i[o]).sheetArea,e,!1)&&(u=(a=a.range).col,s=a.colCount,t<u?((c=t+n-u)<=0?u-=n:(u-=c,a.colCount-=c),u<0&&(a.colCount+=u,u=0),a.col=u):u<=t&&t<u+s&&(a.colCount-=Math.min(n,u+s-t)),0===a.colCount)&&r.push(o);for(f=r.length-1;0<=f;f--)i.splice(r[f],1)}},T.prototype.kP=function(t,n){var e,i,r;for(void 0===n&&(n=b.SheetArea.viewport),i=(e=this.SP).length-1;0<=i;i--)-1!==(r=e[i].range).row&&g(e[i].sheetArea,n,!0)&&(r.row>t-1?e.splice(i,1):r.row+r.rowCount-1>t-1&&(r.rowCount=t-1-r.row+1))},T.prototype.DP=function(t,n){var e,i,r;for(void 0===n&&(n=b.SheetArea.viewport),i=(e=this.SP).length-1;0<=i;i--)-1!==(r=e[i].range).col&&g(e[i].sheetArea,n,!1)&&(r.col>t-1?e.splice(i,1):r.col+r.colCount-1>t-1&&(r.colCount=t-1-r.col+1))},T.prototype.toJSON=function(){return this.SP.map(function(t){var n=t.range;return{range:{row:n.row,col:n.col,rowCount:n.rowCount,colCount:n.colCount},direction:t.direction,mode:t.mode,sheetArea:t.sheetArea,selectionMode:t.selectionMode}})},T.prototype.fromJSON=function(t){var n,e,i,r,o,a;if(t)for(n=this.SP,e=0,i=t;e<i.length;e++)o=(r=i[e]).range,(a=r.selectionMode)===M&&(a=h.source),n.push({range:(0,b.Ec)(o.row,o.col,o.rowCount,o.colCount),direction:r.direction,mode:r.mode,sheetArea:r.sheetArea,selectionMode:a})},r=T,b.GC$.extend(b.Y8.prototype,{_P:function(t){var n,e,n,n=this,e=n.G8;!e||!t&&e.originalAutoMerge||(n=n.Cb.all().map(function(t){var n=t.range;return{range:(0,b.Ec)(n.row,n.col,n.rowCount,n.colCount),direction:t.direction,mode:t.mode,sheetArea:t.sheetArea,selectionMode:t.selectionMode}}),t?e.currentAutoMerge=n:e.originalAutoMerge=n)},EP:function(t){t&&this.Cb.AP(t)},jP:function(t,n,e){this._P(),this.Cb.JO(t,n,e),this._P(!0)},OP:function(t,n,e){this._P(),this.Cb.xP(t,n,e),this._P(!0)},RP:function(t,n,e){this._P(),this.Cb.qO(t,n,e),this._P(!0)},BP:function(t,n,e){this._P(),this.Cb.NP(t,n,e),this._P(!0)},LP:function(t,n){this._P(),this.Cb.kP(t,n),this._P(!0)},FP:function(t,n){this._P(),this.Cb.DP(t,n),this._P(!0)}}),b.Y8.ch(o="autoMerge",{init:function(){this.Cb=new r(this.Mf)},applyChanges:function(t){var n,t,t,n=t.changes,t=t.isUndo;n&&(t=t?n.originalAutoMerge:n.currentAutoMerge)&&this.EP(t)},undo:function(t){var t=t.originalAutoMerge;t&&this.EP(t)},dispose:function(t){var n=this,e;!1!==(t&&t.clearCache)&&n.Cb&&(n.Cb.L0(),n.Cb=C)}}),b.Worksheet.ch(o,{init:function(){var u,s,u=this,s=u.Cb=u.Ut.Cb;u.unbind(b.Events.TopRowChanged+"."+o),u.unbind(b.Events.LeftColumnChanged+"."+o),u.bind(b.Events.TopRowChanged+"."+o,function(){var t,n,e,i,r,o,a,o,o,t=s.all();if(0<t.length)for(n=u.frozenColumnCount(),e=u.getColumnCount()-u.frozenTrailingColumnCount()-1,i=0,r=t;i<r.length;i++)a=(o=r[i]).sheetArea,o=o.range,a===b.SheetArea.viewport?((-1===o.col||o.col<n)&&u.repaint(u.getRangeRect(1,0,o)),(-1===o.col||o.col<=e&&o.col+o.colCount>=n)&&u.repaint(u.getRangeRect(1,1,o)),(-1===o.col||o.col+o.colCount>e)&&u.repaint(u.getRangeRect(1,2,o))):a===b.SheetArea.rowHeader&&(o=u.Fi(),u.repaint(o.B1(1)))}),u.bind(b.Events.LeftColumnChanged+"."+o,function(){var t,n,e,i,r,o,a,o,o,t=s.all();if(0<t.length)for(n=u.frozenRowCount(),e=u.getRowCount()-u.frozenTrailingRowCount()-1,i=0,r=t;i<r.length;i++)a=(o=r[i]).sheetArea,o=o.range,a===b.SheetArea.viewport?((-1===o.row||o.row<n)&&u.repaint(u.getRangeRect(0,1,o)),(-1===o.row||o.row<=e&&o.row+o.rowCount>=n)&&u.repaint(u.getRangeRect(1,1,o)),(-1===o.row||o.row+o.rowCount>e)&&u.repaint(u.getRangeRect(2,1,o))):a===b.SheetArea.colHeader&&(o=u.Fi(),u.repaint(o.L1(1)))})},dispose:function(t){!1!==t.clearCache&&(this.Cb=C,this.unbind(b.Events.TopRowChanged+"."+o),this.unbind(b.Events.LeftColumnChanged+"."+o))},onLayoutChanged:function(t){var n,e,i,r,o,t,a,n=t.changeType,e=t.row,i=t.rowCount,r=t.col,o=t.colCount,t=t.sheetArea,a=this.Ut;"addRows"===n?a.jP(e,i,t):"deleteRows"===n?a.OP(e,i,t):"addColumns"===n?a.RP(r,o,t):"deleteColumns"===n?a.BP(r,o,t):"setRowCount"===n?a.LP(i,t):"setColumnCount"===n&&a.FP(o,t),"invalidateLayout"===n&&this.My<=0&&this.Cb.IP()},toJson:function(t,n){var e,i,e;n&&n.ignoreStyle||(i=this.Cb,t.autoMergeRangeInfos=i.toJSON(),n&&n.includeAutoMergedCells&&(i.IP(!0,!0),I(i,t)))},fromJson:function(t,n,e){var i;e&&e.ignoreStyle||this.Cb.fromJSON(t.autoMergeRangeInfos)},wh:function(t,n,e){var i,r,o,e,i;e&&!1===e.includeStyles||(t.lossless.autoMerge={},r=this.Cb,t.lossless.autoMerge.autoMergeRangeInfos=r.toJSON(),o=r.Mf.NMi,e&&e.includeAutoMergedCells&&!o&&(e={},r.IP(!0,!0),I(r,e),A(e,t)))},yh:function(t,n,e){var i;e&&!1===e.includeStyles||!t.lossless||!t.lossless.autoMerge||this.Cb.fromJSON(t.lossless.autoMerge.autoMergeRangeInfos)}}),b.Workbook.ch(o,{onCultureChanged:function(){c()}}),b.GC$.extend(b.Worksheet.prototype,{autoMerge:function(t,n,e,i,r){void 0===n&&(n=l.column),void 0===e&&(e=y.free),void 0===i&&(i=b.SheetArea.viewport),void 0===r&&(r=h.source);var o=this.Cb;if(0===arguments.length)return o.all();t&&(this.Ut._P(),n===l.none?o.remove(t,i):o.add(t,n,e,i,r),this.zw())}})},"./dist/plugins/autoMerge/autoMerge.res.en.js":function(t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.Exp_RangeIsIntersected=void 0,n.Exp_RangeIsIntersected="The range should not intersect with exsit ranges."},"./dist/plugins/cellState/cellStateManager.js":function(t,n,e){"use strict";var o,a,i,b,y,e,f,i,w,r,u,n,s;function c(t){var n=t.row,e=t.col,i=t.rowCount,t=t.colCount;return new b.Range(n,e,i,t)}function l(t,n){this.Mf=t,this.Kh=n,this.cE=[];for(var e=1;e<=3;e++)this.PP(e)}function h(t){this.Mf=t,this.GP={}}function d(n,t,e){var i=[],r=n.getRowCount(3),o=n.getColumnCount(3);return t.forEach(function(t){i=i.concat(g(n,t.style,t.range,e,r,o))}),i}function v(t){for(var n,e,i,r,o,e,a,u,s,c,e,n=[],i=0,r=t.length;i<r;i++)o=(e=t[i]).style,e={range:{row:a=(e=e.range).row,col:u=e.col,colCount:s=e.colCount,rowCount:c=e.rowCount},style:o.toJSON()},n.push(e);return n}function m(t,n,e,i){for(var r,r,o,a,u,s,c,f,u,r,l,o=0,a=n.length;o<a;o++)s=(u=(r=n[o]).range).row,c=u.col,f=u.rowCount,u=u.colCount,r=r.style,(l=new b.Style).fromJSON(r,e,i),r={style:l,range:new b.Range(s,c,f,u)},t.push(r)}function g(t,n,e,i,r,o){var a;return t.BR(e,i,r,o).map(function(t){return{range:t,style:n}})}function p(t,n,e){return e.contains(t,n)}function M(t){var n=t.range,e=t.style;return n.constructor.name===Object&&((n=new b.Range(0,0,1,1)).fromJSON(t.range),(e=new b.Style).fromJSON(t.style)),{range:n,style:e}}o=this&&this.__assign||function(){return(o=Object.assign||function(t){for(var n,e,i,r,e=1,i=arguments.length;e<i;e++)for(r in n=arguments[e])Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r]);return t}).apply(this,arguments)},a=this&&this.__rest||function(t,n){var e,i,r,e={};for(i in t)Object.prototype.hasOwnProperty.call(t,i)&&n.indexOf(i)<0&&(e[i]=t[i]);if(null!=t&&"function"==typeof Object.getOwnPropertySymbols)for(r=0,i=Object.getOwnPropertySymbols(t);r<i.length;r++)n.indexOf(i[r])<0&&Object.prototype.propertyIsEnumerable.call(t,i[r])&&(e[i[r]]=t[i[r]]);return e},Object.defineProperty(n,"__esModule",{value:!0}),n.CellStateManager=void 0,i=e("Common"),b=e("Core"),y=i.Common.lt.ht,e=b.GC$.extend,f=void 0,i="cellState",w=[b.CellStatesType.readonly,b.CellStatesType.invalid,b.CellStatesType.dirty,b.CellStatesType.invalidFormula,b.CellStatesType.selected,b.CellStatesType.active,b.CellStatesType.hover,b.CellStatesType.edit],l.prototype.PP=function(t){this.cE[t]=[]},l.prototype.UP=function(t){return this.cE[t]},l.prototype.HP=function(t,n){this.cE[n]=t},l.prototype.zP=function(t,n){for(var e,i,r,e=0,i=t.length;e<i;e++)if((r=t[e]).range.equals(n))return e;return-1},l.prototype.VP=function(t,n){var e,i,t,r,e=this,i=e.UP(n),t=this.zP(i,t);-1<t&&(r=i[t],e.YP(t,r.range,r.style,i,n),i.splice(t,1))},l.prototype.ZP=function(t,n,e){var i,r,o,a,i=this,r=i.UP(e),o=i.zP(r,t),a={range:t,style:n};i.WP({index:o,cache:r,range:t,style:n,sheetArea:e}),-1===o?r.push(a):r[o]=a},l.prototype.QP=function(t){var t=this.UP(t),e=this.Kh;return t.map(function(t){var n=t.range,t=t.style;return{range:c(n),style:t.clone(),state:e}})},l.prototype.ML=function(t,n,e){for(var i,r,o,a,u,i=this.UP(e),o=[],a=i.length,u=0;u<a;u++)p(t,n,(r=i[u]).range)&&o.push(r);return 0<o.length?o:null},l.prototype.KP=function(t,n,e){var i,e,r,o,a,i,e=this.UP(e);if(e&&0<e.length)for(r=0,o=e;r<o.length;r++)if(p(t,n,a=o[r].range))return!0;return!1},l.prototype.JP=function(t,n,e,i,r,o){var a,u,s,c,f,l,h,a=this,u=a.Mf,s=a.UP(r);if(s&&0===s.length)return!1;if(a.Kh===b.CellStatesType.dirty&&(y(i)||0<(i&a.Kh)))return u.XP(n,e,r);if(a.Kh===b.CellStatesType.selected&&(y(i)||0<(i&a.Kh))){for(f=0,l=c=a.Mf.getSelections();f<l.length;f++)if(p(n,e,h=l[f]))return!0;return!1}return a.Kh===b.CellStatesType.invalid?!(!u.isValid||!(y(i)||0<(i&a.Kh))||u.isValid(n,e,u.getValue(n,e,r))):a.Kh===b.CellStatesType.readonly?o&&a.Mf.options.isProtected:0<(a.Kh&t)},l.prototype.qP=function(t,n){var e=this,i=this.UP(n);this.$P({cache:i,sheetArea:n,collection:e,state:e.Kh,range:t}),this.HP(d(this.Mf,i,t),n)},l.prototype.toJSON=function(){for(var t,n,e,i,t=this,n={},i=0;i<=3;i++)(e=t.UP(i))&&0<e.length&&(n[i]=v(e));return n},l.prototype.fromJSON=function(t,n,e){var i,r,o,a,i=this;for(i.cE=[],o=1;o<=3;o++)i.PP(o);for(a in t)t.hasOwnProperty(a)&&m(r=i.UP(a),t[a],n,e)},l.prototype.tG=function(t){var t,n,e,t=a(t,[]),n=this,e;n.Mf.Ut.nG(o({type:"rangeChange",state:n.Kh},t))},l.prototype.WP=function(t){var n,e,i,r,t,o,a,n=t.index,e=t.cache,i=t.range,r=t.style,t=t.sheetArea,o=this,a=o.Mf.Ut;-1!==n&&(r=e[n].style),a.nG({type:"add",index:n,cache:e,state:o.Kh,range:i,style:r,sheetArea:t})},l.prototype.YP=function(t,n,e,i,r){var o=this,a;o.Mf.Ut.nG({type:"remove",index:t,range:n,style:e,cache:i,state:o.Kh,sheetArea:r})},l.prototype.$P=function(t){var t,n,e,t=a(t,[]),n=this,e;n.Mf.Ut.nG(o({type:"clear",state:n.Kh},t))},l.prototype.JO=function(o,a){for(var u,s,t,n,u=this,t=function(r){(s=u.UP(r))&&0<s.length&&s.forEach(function(t,n){var t,e,i,t=t.range,e=t.row,i=t.rowCount;o<=e?(t.row=e+a,u.tG({cache:s,range:t,row:e,index:n,sheetArea:r})):e<o&&o<e+i&&(t.rowCount=t.rowCount+a,u.tG({cache:s,range:t,rowCount:i,index:n,sheetArea:r}))})},n=0;n<=3;n++)t(n)},l.prototype.xP=function(a,u){for(var s,c,t,n,s=this,t=function(o){(c=s.UP(o))&&0<c.length&&c.forEach(function(t,n){var t,e,i,r,t=t.range,e=t.row,i=t.rowCount;a<e?((r=a+u-e)<=0?e-=u:(e-=r,t.rowCount-=r),e<0&&(t.rowCount=i+e,e=0),t.row=e,s.tG({cache:c,range:t,row:e,rowCount:i,index:n,sheetArea:o})):e<=a&&a<e+i&&(t.rowCount=t.rowCount-Math.min(u,e+i-a),s.tG({cache:c,range:t,rowCount:i,index:n,sheetArea:o}))})},n=0;n<=3;n++)t(n)},l.prototype.qO=function(o,a){for(var u,s,t,n,u=this,t=function(r){(s=u.UP(r))&&0<s.length&&s.forEach(function(t,n){var t,e,i,t=t.range,e=t.col,i=t.colCount;o<=e?(t.col=e+a,u.tG({cache:s,range:t,col:e,index:n,sheetArea:r})):e<o&&o<e+t.colCount&&(t.colCount=i+a,u.tG({cache:s,range:t,colCount:i,index:n,sheetArea:r}))})},n=0;n<=3;n++)t(n)},l.prototype.NP=function(a,u){for(var s,c,t,n,s=this,t=function(o){(c=s.UP(o))&&0<c.length&&c.forEach(function(t,n){var t,e,i,r,t=t.range,e=t.col,i=t.colCount;a<e?((r=a+u-e)<=0?e-=u:(e-=r,t.colCount-=r),e<0&&(t.colCount+=e,e=0),t.col=e,s.tG({cache:c,range:t,col:e,colCount:i,index:n,sheetArea:o})):e<=a&&a<e+i&&(t.colCount-=Math.min(u,e+i-a),s.tG({cache:c,range:t,colCount:i,index:n,sheetArea:o}))})},n=0;n<=3;n++)t(n)},l.prototype.eG=function(){this.cE=[],this.Mf=null},r=l,h.prototype.getCollection=function(t,n){var e=this;return!e.GP[t]&&n&&(e.GP[t]=new r(e.Mf,t)),e.GP[t]},h.prototype.hasIntersectInSelectionState=function(t,n,e,i){var r,o,o,a,u,s,r,o=this.GP[b.CellStatesType.selected];if(o&&(o=o.UP(b.SheetArea.viewport))&&0<o.length)for(a=0,u=o;a<u.length;a++)if((s=u[a].range).intersect(t,n,e,i))return!0;return!1},h.prototype.getState=function(t,n,e){var i;return this.Mf.Ut.W_(e).getCellState(t,n)||0},h.prototype.remove=function(t,n,e){var i;void 0===e&&(e=b.SheetArea.viewport),this.GP[n].VP(t,e)},h.prototype.all=function(t,n){var e,i;if(void 0===n&&(n=b.SheetArea.viewport),e=[],y(t))for(i in this.GP)this.GP.hasOwnProperty(i)&&(e=e.concat(this.GP[i].QP(n)));else e=this.GP[t].QP(n);return e},h.prototype.add=function(t,n,e,i){var r,n,e;if(b.CellStatesType[n]===f)throw new Error("Unmatched Cell State Type");y(i)&&(i=3),(r=this.getCollection(n,!0)).ZP(c(t),e,i),n=this.Mf,i===b.SheetArea.viewport?n.repaint(n.j1(t)):(e=n.Fi(),i===b.SheetArea.colHeader&&n.repaint(new b.Rect(e.Py,e.LA,n.Gy(e),e.qC)),i===b.SheetArea.rowHeader&&n.repaint(new b.Rect(e.BA,e.Cy,e.XC,n.Sy(e))))},h.prototype.clear=function(t,n){this.iG(t,n)},h.prototype.iG=function(t,n){for(var e in this.GP)this.GP.hasOwnProperty(e)&&this.GP[e].qP(t,n)},h.prototype.rG=function(t,n,e,i,r,o){var a=this,u=a.Mf,a=a.GP[t];a&&a.KP(n,e,i)&&-1!==r&&-1!==o&&u.repaint(u.XL(u,n,e,r,o))},h.prototype.getStyle=function(t,n,e,i,r){var o,a,u,u,s,c,f,l,h,d,v,m,g,p;if(y(e)&&(e=3),o=new b.Style,a=[],l=(f=(c=(s=this).Mf).Ut).getSpan(t,n,e),y(l)||(t=l.row,n=l.col),h=y(i)?s.getState(t,n,e):s.getState(t,n,e)&i,!y(h)){for(d=0,v=w;d<v.length;d++)(u=s.GP[m=v[d]])&&u.JP(h,t,n,i,e,r)&&(u=u.ML(t,n,e))&&0<u.length&&(a=a.concat(u));if(0<a.length){for(p=(g=a.length)-1;0<=p;p--)o.h5(a[p].style);return o}}return null},h.prototype.destroy=function(){for(var t in this.GP)this.GP.hasOwnProperty(t)&&this.GP[t].eG();delete this.GP,delete this.Mf},h.prototype.toJSON=function(){var t,n,e,t={};for(e in this.GP)this.GP.hasOwnProperty(e)&&(n=this.GP[e],t[e]=n.toJSON());return t},h.prototype.fromJSON=function(t,n,e){var i,r,o,a,i=this;for(o in t)t.hasOwnProperty(o)&&(a=parseInt(o,10),(r=i.getCollection(a,!0)).fromJSON(t[a],n,e))},h.prototype.JO=function(t,n){for(var e in this.GP)this.GP.hasOwnProperty(e)&&this.GP[e].JO(t,n)},h.prototype.xP=function(t,n){for(var e in this.GP)this.GP.hasOwnProperty(e)&&this.GP[e].xP(t,n)},h.prototype.qO=function(t,n){for(var e in this.GP)this.GP.hasOwnProperty(e)&&this.GP[e].qO(t,n)},h.prototype.NP=function(t,n){for(var e in this.GP)this.GP.hasOwnProperty(e)&&this.GP[e].NP(t,n)},u=h,n.CellStateManager=u,n={init:function(){this.cellStates=new u(this)},dispose:function(t){var n=this;n.cellStates&&!1!==t.clearCache&&(n.cellStates.destroy(),n.cellStates=null)},onLayoutChanged:function(t){var n,e,i,r,o,a,u,s,c,n=t.changeType,e=t.row,i=t.rowCount,r=t.col,o=t.colCount,a=t.sheetArea;if(y(a)||a===b.SheetArea.viewport)if(u=this.cellStates,"addRows"===n)u.JO(e,i);else if("deleteRows"===n)u.xP(e,i);else if("addColumns"===n)u.qO(r,o);else if("deleteColumns"===n)u.NP(r,o);else if("clear"===n&&(3===a&&2==(2&t.type)&&u.iG(new b.Range(e,r,i,o),a),3===a)&&1==(1&t.type))for(s=e;s<e+i;s++)for(c=r;c<r+o;c++)this.Ut.W_(a).setCellState(s,c,b.CellStatesType.invalid,!1)},toJson:function(t,n){n&&n.ignoreStyle||(t.cellStates=this.cellStates.toJSON())},fromJson:function(t,n,e){var i,r,i=this,r=e&&!e.ignoreStyle||!e;t&&t.cellStates&&r&&(i.cellStates=new u(i),i.cellStates.fromJSON(t.cellStates,n,e))},wh:function(t,n,e){var i;e&&!1===e.includeStyles||(t.lossless.cellStates=this.cellStates.toJSON())},yh:function(t,n,e){var i;e&&!1===e.includeStyles||!t.lossless||!t.lossless.cellStates||this.cellStates.fromJSON(t.lossless.cellStates,f,e)}},e(b.Worksheet.prototype,s={k_:function(t,n,e,i,r,o){i&&i<=3&&0<i&&this.cellStates.rG(t,n,e,i,r,o)},XP:function(t,n,e){var i,e=this.Ut.Fj(e);return e&&e[t]&&e[t][n]}}),b.Worksheet.ch(i,n),e(b.Y8.prototype,{nG:function(t){var n,e,i,n,e=this.G8;e&&(i=void 0,(i=e.originalCellStates||[]).push(t),e.originalCellStates=i)},oG:function(t,i){var r=this;t&&0<t.length&&t.forEach(function(t){var n=t.type,e=a(t,["type"]);switch(n){case"rangeChange":r.aG(o({},e),i);break;case"add":r.uG(o({},e),i);break;case"clear":r.sG(o({},e),i);break;case"remove":r.cG(o({},e),i)}})},sG:function(t,n){var e=t.cache,i=t.sheetArea,r=t.collection,o=t.state,t=t.range;"Object"===r.constructor.name&&(r=this.Mf.cellStates.getCollection(o,!0),e=e.map(M)),n?r.HP(d(this.Mf,e,t),i):r.HP(e,i)},cG:function(t,n){var e=t.cache,i=t.range,r=t.sheetArea,o=t.state,a=t.style,t=t.index;"Object"===i.constructor.name&&(e=this.Mf.cellStates.getCollection(o,!0).UP(r)),n?e.splice(t,1):e.splice(t,0,M({range:i,style:a}))},uG:function(t,n){var e,i,r,o,a,t,u,s,e=t.cache,i=t.range,r=t.sheetArea,o=t.state,a=t.style,t=t.index;"Object"===i.constructor.name&&(e=this.Mf.cellStates.getCollection(o,!0).UP(r)),u=M({range:i,style:a}),n?-1===t?e.push(u):e[t]=u:-1===t?(e.forEach(function(t,n){var e=t.range,t=t.style;e===u.range&&t===u.style&&(s=n)}),e.splice(s,1)):e[t].style=u.style},aG:function(t,n){var e,i,r,o,a,u,s,c,t,r,e=t.cache,i=t.range,r=t.state,o=t.sheetArea,a=t.index,u=t.row,s=t.col,c=t.rowCount,t=t.colCount;"Object"===i.constructor.name&&(e=this.Mf.cellStates.getCollection(r,!0).UP(o),(r=new b.Range(0,0,0,0)).fromJSON(i),i=r),n?e[a].range=i:(i=e[a].range,u!==f&&(i.row=u),s!==f&&(i.col=s),c!==f&&(i.rowCount=c),t!==f&&(i.colCount=t))}}),b.Y8.ch(i,{applyChanges:function(t){var n,t,n,n=t.changes,t=t.isUndo,n=n&&n.originalCellStates;n&&this.oG(n,!t)},undo:function(t){var t=t.originalCellStates;t&&this.oG(t)}})},"./dist/plugins/cellState/cellstate.entry.js":function(t,n,e){"use strict";var i,r,i=this&&this.__createBinding||(Object.create?function(t,n,e,i){void 0===i&&(i=e);var r=Object.getOwnPropertyDescriptor(n,e);r&&("get"in r?n.__esModule:!r.writable&&!r.configurable)||(r={enumerable:!0,get:function(){return n[e]}}),Object.defineProperty(t,i,r)}:function(t,n,e,i){t[i=void 0===i?e:i]=n[e]}),r=this&&this.__exportStar||function(t,n){for(var e in t)"default"===e||Object.prototype.hasOwnProperty.call(n,e)||i(n,t,e)};Object.defineProperty(n,"__esModule",{value:!0}),r(e("./dist/plugins/cellState/cellStateManager.js"),n),r(e("./dist/plugins/cellState/stateManager.js"),n)},"./dist/plugins/cellState/stateManager.js":function(t,n,e){"use strict";var i,i,b,r,l,o,e,a,u,s;function c(t){this.fG={},this.getStateMethods={},this.context=t,o(this.getStateMethods,a)}function f(t,n){var t;if(n)return(t=new u(t)).fromJSON(n),t}Object.defineProperty(n,"__esModule",{value:!0}),n.lG=void 0,i=e("Common"),b=e("Core"),r=i.Common.lt.ht,l=i.Common.lt.q8,o=b.GC$.extend,e="states",(i={})[b.RowColumnStates.hover]=function(t,n,e,i){var r,o,a,u,r=this,o;return(e?t===r.A_:n===r.I_)&&(a=r.zO(r.A_,r.I_,b.SheetArea.viewport),!!(u=i&&i.some(function(t){return!(!t.contains(r.A_,r.I_)||!a)})))},i[b.RowColumnStates.active]=function(t,n,e,i){var r,o,a,r=this,o;return(e?t===r.ui:n===r.ci)&&!!(a=l(r.ui)&&l(r.ci)&&i&&i.some(function(t){return!!t.contains(r.ui,r.ci)}))},i[b.RowColumnStates.selected]=function(t,n,e,i){var r,o,a,u,s,c,f,l,h,d,v,v,m,g,p,r=this,o=this.parent.options.hideSelection;if(o&&!(a=b.hi.ai()===this))return!1;for(s=!1,c=0,f=u=r.getSelections();c<f.length;c++)for(l=f[c],h=0,d=i;h<d.length;h++)v=d[h],l.intersect(v.row,v.col,v.rowCount,v.colCount)&&(v=-1===l.row?0:l.row,m=-1===l.rowCount?r.getRowCount():l.rowCount,g=-1===l.col?0:l.col,p=-1===l.colCount?r.getColumnCount():l.colCount,e&&v<=t&&t<v+m||!e&&g<=n&&n<g+p)&&(s=!0);return s},i[4]=function(t,n,e,i){return!1},i[b.RowColumnStates.edit]=function(t,n,e,i){var r,o,a,u,s,c,f,r=this,o=r.ui,a=r.ci,u;return(e?t===o:n===a)&&(c=((s=r.cellStates).getState(o,a,b.SheetArea.viewport)&b.RowColumnStates.edit)===b.RowColumnStates.edit)&&!!(f=l(o)&&l(a)&&i&&i.some(function(t){return!!t.contains(o,a)}))},i[b.RowColumnStates.invalid]=function(t,n,e,i){var r,o,a,u,s,c,f,l,h,d,v,m,r=this,o=e?r.hG(t,-1):r.hG(-1,n);if(o&&0<o.length&&i)for(a=0,u=i;a<u.length;a++)if(s=u[a],e){for(c=-1===s.col?0:s.col,f=-1===s.colCount?r.getColumnCount():s.colCount,l=c;l<c+f;l++)if(!(h=r.isValid(t,l,r.getValue(t,l,b.SheetArea.viewport))))return!0}else for(d=-1===s.row?0:s.row,v=-1===s.rowCount?r.getRowCount():s.rowCount,m=d;m<d+v;m++)if(!(h=r.isValid(m,n,r.getValue(m,n,b.SheetArea.viewport))))return!0;return!1},i[b.RowColumnStates.dirty]=function(t,n,e,i){var r,o,a,u,s,c,f,l,h,d,v,m,g,p,r;if(i&&0!==i.length)for(o=this.Ut.Fj(),a=0,u=i;a<u.length;a++)for(c in s=u[a],o)if(o[c])for(h in f=Number(c),l=o[c])if(l[h]&&(d=Number(h),v=-1===s.row?0:s.row,m=-1===s.rowCount?this.getRowCount(b.SheetArea.viewport):s.rowCount,g=-1===s.col?0:s.col,p=-1===s.colCount?this.getColumnCount(b.SheetArea.viewport):s.colCount,e&&f===t&&(g<=d&&d<g+p||"n"===l[h])||!e&&d===n&&(v<=f&&f<v+m||"n"===l[h])))return!0;return!1},i[b.RowColumnStates.inserted]=function(t){for(var n,e,i,r,n,e=0,i=this.getInsertRows();e<i.length;e++)if((r=i[e]).row===t)return!0},i[256]=function(t){return!1},i[b.RowColumnStates.invalidFormula]=function(i,r,o,t){var n,a,e,u,s,c,n=this;if(t&&0!==t.length)for(a=n.cellStates,e=function(t,n,e){return!!((o?i===n:r===e)&&a.getState(n,e)&b.CellStatesType.invalidFormula)},u=0;u<t.length;u++)if(s=t[u],c=n.findSpecialNonNullCellInRange(s,e))return!0;return!1},a=i,c.prototype.enableState=function(t,n){var e=this.fG;r(e[t])&&(e[t]={row:!1,column:!1}),n?e[t].row=!0:e[t].column=!0},c.prototype.disableState=function(t,n){var e=this.fG;r(e[t])||(n?e[t].row=!1:e[t].column=!1)},c.prototype.isEnable=function(t,n){var e=this.fG;return!r(e[t])&&(n?e[t].row:e[t].column)},c.prototype.getState=function(t,n,e,i,r,o){var a,u,a=this.context,u=this.getStateMethods[e];if("function"==typeof u)return u.call(a,t,n,i,r,o)?e:0},c.prototype.destroy=function(){delete this.context,delete this.fG},c.prototype.fromJSON=function(t){this.fG=o({},t)},c.prototype.toJSON=function(){return o({},this.fG)},u=c,n.lG=u,b.Worksheet.ch(e,s={init:function(){this._1=new u(this)},dispose:function(t){var n=this;n._1&&!1!==t.clearCache&&(n._1.destroy(),n._1=null)},toJson:function(t){t.states=this._1.toJSON()},fromJson:function(t){var t=f(this,t&&t.states);t&&(this._1=t)},yh:function(t){var t=f(this,t&&t.lossless&&t.lossless.states);t&&(this._1=t)},wh:function(t){t.lossless||(t.lossless={}),t.lossless.states=this._1.toJSON()}})},"./dist/plugins/celltype/buttoncelltype.js":function(t,n,e){"use strict";var i,r,p,u,f,o,s,b,e,r,a,l,c,h,d,y,w,v,m,g,M,C;function S(t,n,e,i){var t,r,t=t.Ut;t&&(t.do("setValueForKey",n,e,h,c,i),r=t.getValueForKey(n,e,d,i))&&(clearTimeout(r),t.do("setValueForKey",n,e,d,c,i))}function T(){var t,e,t=C.call(this)||this;return t.typeName="6",e=t,a(m,function(t,n){e["_"+t]=n}),t}i=this&&this.__extends||(M=function(t,n){return(M=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(t,n){t.__proto__=n}:function(t,n){for(var e in n)Object.prototype.hasOwnProperty.call(n,e)&&(t[e]=n[e])}))(t,n)},function(t,n){if("function"!=typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function e(){this.constructor=t}M(t,n),t.prototype=null===n?Object.create(n):(e.prototype=n.prototype,new e)}),Object.defineProperty(n,"__esModule",{value:!0}),n.Button=void 0,r=e("Common"),p=e("Core"),u=p.Events.SelectionChanged,f=r.Common.lt.ht,o=p.mt.vi,s=p.CellTypes.Context,b=p.CellTypes.Text,e=p.CellTypes.Base,r=p.GC$,a=r.each,c=void 0,h="_isFirstMouseUp",d="_mouseupToken",y="#707070",w="#34B4E3",v=".buttonCellType",m={marginTop:2,marginRight:2,marginBottom:2,marginLeft:2,text:"",buttonBackColor:l=null,buttonState:0},i(T,C=e),T.prototype.paintValue=function(t,n,e,i,r,o,a,u){var s,c,f,l,h,d,v,m,c,f,c,g;t&&(c=(s=this)._marginLeft,f=s._marginTop,l=e+c,h=i+f,d=r-c-s._marginRight,v=o-f-s._marginBottom,0<d-2)&&0<v-2&&(m=e<l+d&&l<e+r&&i<h+v&&h<i+o)&&(t.save(),(l<e||e+r<l+d||h<i||i+o<h+v)&&(t.rect(e,i,r,o),t.clip()),t.beginPath(),t.strokeStyle!==(c=y)&&(t.strokeStyle=c),t.strokeRect(l+.5,h+.5,d-1,v-1),f=void 0,c=s._buttonState,g=s._text,f=2===c?w:(f=s._buttonBackColor)||{degree:90,stops:[{position:0,color:"#F6FAFB"},{position:.125,color:"#F6FAFB"},{position:1,color:"#D2DBEB"}]},t.fillStyle!==f&&(t.fillStyle=f),p.W.setFillStyle(t,f,e,i,r,o,function(){t.fillRect(l+1,h+1,d-2,v-2)}),t.restore(),g)&&b.prototype.paintValue.call(s,t,g,l,h,d,v,a,u)},T.prototype.getText=function(t,n){return t},T.prototype.j3=function(t,n,e,i){var r=t.parent;r&&r.j3(t,n,e,i)},T.prototype.getHitInfo=function(t,n,e,i,r){var o,a,u,s,c,o,i,o=this;return r&&(a=r.sheetArea,f(a)||3===a)&&i?(u=i.x+o._marginLeft,s=i.x+i.width-o._marginRight,c=i.y+o._marginTop,o=i.y+i.height-o._marginBottom,i={x:t,y:n,row:r.row,col:r.col,cellRect:i,sheetArea:a,sheet:r.sheet,cellStyle:e},u<=t&&t<=s&&c<=n&&n<=o&&(i.isReservedLocation=!0),i):l},T.prototype.processMouseDown=function(t){var n,e,n=this,e=t&&t.sheet;return!(!e||!t.isReservedLocation||n.pG||(n.pG=!0,n._buttonState=2,e.repaint(t.cellRect),0))},T.prototype.processMouseUp=function(t){var n,e,i,r,o,a,t,n=this,e=t&&t.sheet;if(n.pG&&e&&t.isReservedLocation){if(n._buttonState=0,e.repaint(t.cellRect),n.pG=!1,i=t.row,r=t.col,o=t.sheetArea,!(a=e.Ut.getValueForKey(i,r,h,o)))return n.j3(e,i,r,o),e.Ut.do("setValueForKey",i,r,h,!0,o),t=setTimeout(function(){S(e,i,r,o)},250),e.Ut.do("setValueForKey",i,r,d,t,o),!0;S(e,i,r,o)}return!1},T.prototype.processMouseLeave=function(t){var n,e,n=this,e=t&&t.sheet;e&&n.pG&&(n._buttonState=0,e.repaint(t.cellRect),n.pG=!1)},T.prototype.processKeyDown=function(t,n){var e,i,r,e=n.sheet,i=this;return!(!e||i.bG)&&(r=e.getCellRect(n.row,n.col),i._buttonState=2,e.repaint(r),e.D3(u+v,function(){e._3(u+v),i.bG=!1,i._buttonState=0,e.repaint(r)}),i.bG=!0)},T.prototype.processKeyUp=function(t,n){var e,i,r,o,a,e=n.sheet,i=this;return!(!e||!i.bG||(r=n.row,o=n.col,a=e.getCellRect(r,o),i._buttonState=0,e.repaint(a),e._3(u+v),i.j3(e,r,o,n.sheetArea),i.bG=!1))},T.prototype.isReservedKey=function(t,n){return 32===t.keyCode&&!t.ctrlKey&&!t.shiftKey&&!t.altKey},T.prototype.getAutoFitWidth=function(t,n,e,i,r){var o,a,o=this,a;return s.Bt(t,o._text,e,i,r)+o._marginLeft+o._marginRight},T.prototype.getAutoFitHeight=function(t,n,e,i,r){var o,a,o=this,a;return s.tn(t,o._text,e,i,r)+o._marginTop+o._marginBottom},T.prototype.QD=function(t){this.isReservedKey(t)&&o(t)},T.prototype.isImeAware=function(t){return!1},T.prototype.toJSON=function(){var e,i,r,e=this,i={typeName:e.typeName};return a(m,function(t,n){"buttonState"!==t&&(r=e["_"+t])!==n&&(i[t]=r)}),i},T.prototype.fromJSON=function(e){var i=this;a(m,function(t){var n=e[t];f(n)||(i["_"+t]=n)})},T.prototype.jn=function(t){},T.prototype.Ke=function(){},g=T,n.Button=g,a(m,function(n){g.prototype[n]=function(t){return 0===arguments.length?this["_"+n]:(this["_"+n]=t,this)}}),p.CellTypes.ti[6]=g},"./dist/plugins/celltype/cellbuttons.js":function(e,t,n){"use strict";var C,t,n,S,o,a,z,T,A,s,c,V,Y,Z,W,Q,g,p,h,J,I,d,K,x,X,N,q,r,b,y,w,M,k,D,_,E,f,v,l,m,t,$,j,i,n;function tt(t){switch(t){case k:return C.ButtonPosition.left;case D:return C.ButtonPosition.right;case _:return C.ButtonPosition.leftOfText;case E:return C.ButtonPosition.rightOfText}}function nt(t){switch(t){case C.ButtonPosition.left:return k;case C.ButtonPosition.right:return D;case C.ButtonPosition.leftOfText:return _;case C.ButtonPosition.rightOfText:return E}}function et(t){for(var n,e,i,n=t.split(" "),i=0;i<n.length;i++)if(0<=n[i].indexOf(r)){e=n[i];break}switch(e){case b:return k;case y:return D;case w:return _;case M:return E}}function it(t){switch(t){case k:return b;case D:return y;case _:return w;case E:return M}}function rt(t,n,e,i){var t,r,t=t.Ut;t&&(t.do("setValueForKey",n,e,g,T,i),r=t.getValueForKey(n,e,p,i))&&(clearTimeout(r),t.do("setValueForKey",n,e,p,T,i))}function ot(t,n,e){var i,r;switch(e){case j.topLeft:return new C.Rect(t.x,t.y,Math.min(n.width,t.width),Math.min(n.height,t.height));case j.topCenter:return i=(t.width-n.width)/2,i=Math.max(0,i),new C.Rect(t.x+i,t.y,Math.min(n.width,t.width),Math.min(n.height,t.height));case j.topRight:return i=t.width-n.width,i=Math.max(0,i),new C.Rect(t.x+i,t.y,Math.min(n.width,t.width),Math.min(n.height,t.height));case j.MiddleLeft:return r=(t.height-n.height)/2,r=Math.max(0,r),new C.Rect(t.x,t.y+r,Math.min(n.width,t.width),Math.min(n.height,t.height));case j.MiddleCenter:return i=(t.width-n.width)/2,i=Math.max(0,i),r=(t.height-n.height)/2,r=Math.max(0,r),new C.Rect(t.x+i,t.y+r,Math.min(n.width,t.width),Math.min(n.height,t.height));case j.MiddleRight:return i=t.width-n.width,i=Math.max(0,i),r=(t.height-n.height)/2,r=Math.max(0,r),new C.Rect(t.x+i,t.y+r,Math.min(n.width,t.width),Math.min(n.height,t.height));case j.bottomLeft:return r=t.height-n.height,r=Math.max(0,r),new C.Rect(t.x,t.y+r,Math.min(n.width,t.width),Math.min(n.height,t.height));case j.bottomCenter:return i=(t.width-n.width)/2,i=Math.max(0,i),r=t.height-n.height,r=Math.max(0,r),new C.Rect(t.x+i,t.y+r,Math.min(n.width,t.width),Math.min(n.height,t.height));case j.bottomRight:return i=t.width-n.width,i=Math.max(0,i),r=t.height-n.height,r=Math.max(0,r),new C.Rect(t.x+i,t.y+r,Math.min(n.width,t.width),Math.min(n.height,t.height))}}function at(t,n,e){for(var i,r,i=[],r=0;r<t.length;r++)i.push({width:P(t[r].button,n,e),height:St(t[r].button,e)});return i}function O(t,n,e,i,r,o){for(var a,u,s,c,f,l,h,a=[],u=[],s=0;s<t.length;s++)c=n[t[s].index],S(c)?u.push(t[s]):a.push(c);for(f=ct(a),s=0;s<u.length;s++)l=P(u[s].button,e,i),(h=!o||f.width+l<=o.width)&&(f.width+=l);return f.height=f.height||(o?o.height:0),f}function ut(t,n,e,i,r,o,a,u,s,c,f,l){var e,h,u,n,a,d,e,c,r,v,m,g,e=G(n,e,a,u,!0,[t]);if(0<e.length){switch(B(e,n,a),t){case C.ButtonPosition.left:h=b;break;case C.ButtonPosition.right:h=y;break;case C.ButtonPosition.leftOfText:h=w;break;case C.ButtonPosition.rightOfText:h=M;break;default:return}switch(u=O(e,c,r,i,!0,o),n="0",a=z(),((d=C.mt.Tt).mozilla||1<a)&&(n="1px"),e=u.width,c=u.height,r=nt(t),S(s.canvasSizes)&&(s.canvasSizes={}),(v=s.canvasSizes)[r]={width:e,height:c},g=st(h,e,c,m={width:e+"px",height:c+"px",display:"block",position:"absolute",bottom:n,overflow:"hidden",paddingTop:"0"}),t){case C.ButtonPosition.left:g.style.left="0";break;case C.ButtonPosition.right:g.style.right="0";break;case C.ButtonPosition.leftOfText:g.style.left=v[_].width+"px";break;case C.ButtonPosition.rightOfText:g.style.right=v[E].width+"px";break;default:return}f.appendChild(g)}}function st(t,n,e,i){var r,o,r=document.createElement("canvas");for(o in r.className=t+" "+q,i)i.hasOwnProperty(o)&&(r.style[o]=i[o]);return r.width=n,r.height=e,r}function ct(t){var n,e,i,r,o;if(t.length<=0)return new C.Rect(0,0,0,0);for(n=t[0].x,e=t[0].y,i=t[0].x+t[0].width,r=t[0].y+t[0].height,o=1;o<t.length;o++)n=Math.min(n,t[o].x),e=Math.min(e,t[o].y),i=Math.max(i,t[o].x+t[o].width),r=Math.max(r,t[o].y+t[o].height);return new C.Rect(n,e,i-n,r-e)}function ft(t){var n,e,n=C.mt.Tt,e=z();if(1!==e)return n.mozilla?Math.ceil(t*e):Math.round(t*e)}function R(t,n,e,i,r,o,a,u){var s,a,c,f,l,h,d;if(!S(t))for(S(u[e])&&(u[e]={}),B(n,i.sheet,i.row),s=t.getContext("2d"),a=O(n,a,r,i,!0),s.setTransform(parseFloat(t.style.width)/a.width,0,0,parseFloat(t.style.height)/a.height,0,0),l=new C.Rect(f=c=0,0,parseFloat(t.style.width),parseFloat(t.style.height)),h=0;h<n.length&&(d=F(s,c,0,P(n[h].button,r,i),i.sheet.getRowHeight(i.row),n[h].button,r,i,o,u[e],n[h].index,l),!S(d));h++)c+=d.width}function lt(e,i,r,o,a,t){var t,n,n,n,n;S(t.eventListeners)&&(t.eventListeners={}),S(t.eventListeners[i])&&(t.eventListeners[i]={}),n=(t=t.eventListeners[i]).mouseDownListener=function(t){var n;It(u({x:t.offsetX,y:t.offsetY,context:r,cellRect:a,cellStyle:o,buttonArea:i},!0),!0,e)},e.addEventListener("mousedown",n),n=t.mouseUpListener=function(t){var n;xt(u({x:t.offsetX,y:t.offsetY,context:r,cellRect:a,cellStyle:o,buttonArea:i},!0),!0,e)},e.addEventListener("mouseup",n),n=t.mouseMoveListener=function(t){var n;Nt(u({x:t.offsetX,y:t.offsetY,context:r,cellRect:a,cellStyle:o,buttonArea:i},!0),!0,e)},e.addEventListener("mousemove",n),n=t.mouseLeaveListener=function(t){var t={x:t.offsetX,y:t.offsetY,context:r,cellRect:a,cellStyle:o,buttonArea:i};t.x<0&&(t.x=0),t.x>=parseFloat(e.style.width)&&(t.x=parseFloat(e.style.width)-1),kt(u(t,!0),!0,e)},e.addEventListener("mouseleave",n)}function ht(t,n,e,i,r,o,a,u,s,c,f,l){var n,h,d,e,v,m,g,p,n=G(n,e,a,u,!0,[t]);if(0<n.length){switch(d=h=void 0,t){case C.ButtonPosition.left:h=b,d=k;break;case C.ButtonPosition.right:h=y,d=D;break;case C.ButtonPosition.leftOfText:h=w,d=_;break;case C.ButtonPosition.rightOfText:h=M,d=E;break;default:return}if(e=l.querySelector("."+h),!S(e)){switch(v=parseFloat(e.style.width),m=o.options.contentRect,g=o.options.leftExternalRect,p=o.options.rightExternalRect,t){case C.ButtonPosition.left:m.x+=v,m.width-=v;break;case C.ButtonPosition.right:m.width-=v;break;case C.ButtonPosition.leftOfText:g.width+=v;break;case C.ButtonPosition.rightOfText:p.width+=v}R(e,n,d,i,r,s,c,f),lt(e,d,i,r,o.options.cellRect,s)}}}function dt(t,n,e,i,r,o,a){var n,e,u,s,c,f,l,n=G(n,e,i,r,!0,[t]);if(n&&0<n.length)switch(e=nt(t),u=o&&o[e]&&o[e].width||0,s=a.contentContainer,c=a.contentRect,f=a.leftExternalRect,l=a.rightExternalRect,t){case C.ButtonPosition.left:mt(s,"left",u),c.x+=u,c.width-=u;break;case C.ButtonPosition.leftOfText:mt(s,"left",u),f.width+=u;break;case C.ButtonPosition.right:c.width-=u;break;case C.ButtonPosition.rightOfText:l.width+=u}}function vt(t){return+t.replace("px","")||0}function mt(t,n,e){var i=0;t.style[n]&&(i=vt(t.style[n])),t.style[n]="".concat((i+=e)-1,"px")}function gt(t,n){S(n.mouseDownListener)||t.removeEventListener("mousedown",n.mouseDownListener),S(n.mouseUpListener)||t.removeEventListener("mouseup",n.mouseUpListener),S(n.mouseMoveListener)||t.removeEventListener("mousemove",n.mouseMoveListener),S(n.mouseLeaveListener)||t.removeEventListener("mouseleave",n.mouseLeaveListener)}function B(t,n,e){for(var i,r,o,i=n.BO(),r=0;r<t.length;r++)(o=Ot(t[r].button,e))&&i.Rt(o)}function L(t){var n=t.isPrinting,t=t.printZoomFactor;return n&&"number"==typeof t&&1!==t}function pt(t,n){return 2===n.columnHeaderFitMode&&n.cornerX&&(t.width=n.cornerX-t.x,t.height=t.height-(n.cornerY-t.y)-1,t.y=n.cornerY-1),t}function bt(t,n,e){switch(e){case C.ButtonPosition.leftOfText:return new C.Rect(t.x,t.y,n.x-t.x,t.height);case C.ButtonPosition.rightOfText:return new C.Rect(n.x+n.width,t.y,t.x+t.width-n.x-n.width,t.height)}}function yt(t,n,e,i,r,o,a){var u,s,c,f,l,h,d,v,m;if(t&&!(n.length<=0)){if(r=_t(r),B(n,u=o.sheet,o.row),2===o.columnHeaderFitMode&&o.cornerX&&(s=o.cellRect.x+o.cellRect.width-(e.x+e.width),(e=e.clone()).width=o.cornerX-e.x-s,e.height=e.height-(o.cornerY-e.y)-1,e.y=o.cornerY-1),c=bt(e,i,a?C.ButtonPosition.leftOfText:C.ButtonPosition.rightOfText),t.save(),t.rect(c.x,c.y,c.width,c.height),t.clip(),t.beginPath(),f=H(u,o.row,o.col,o.sheetArea),l=_t(r),S(f.layout)&&(f.layout={}),a){for(h=c.x+c.width,d=n.length-1;0<=d&&(m=F(t,h-=v=P(n[d].button,l,o),e.y,P(n[d].button,l,o),c.height,n[d].button,l,o,f,f.layout,n[d].index,e),!S(m));d--);i.x=h}else{for(h=c.x,d=0;d<n.length&&(m=F(t,h,e.y,P(n[d].button,l,o),c.height,n[d].button,l,o,f,f.layout,n[d].index,e),!S(m));d++)h+=m.width;i.width=h-i.x}t.restore()}}function wt(t,n,e,i,r){if(!(t+e<r.x||t>r.x+r.width||n+i<r.y||n>r.y+r.height))return t+e>r.x+r.width&&(e=r.x+r.width-t),n+i>r.y+r.height&&(i=r.y+r.height-n),t<r.x&&(t=r.x),n<r.y&&(n=r.y),new C.Rect(t,n,e,i)}function F(t,n,e,i,r,o,a,u,s,c,f,l){var h,s,h=d;if(s.buttonDownIndex===f?h=K:s.buttonHoverIndex===f&&(h=x),s=wt(n,e,i,r,l),!S(s))return Mt(t,s.x,s.y,s.width,s.height,o,a,u,h,l),c[f]=new C.Rect(s.x,s.y,s.width,s.height),c[f].offsetX=s.x-l.x,c[f].offsetY=s.y-l.y,u.cornerY&&(c[f].offsetY+=u.cornerY),c[f]}function Mt(t,n,e,i,r,o,a,u,s,c){var f,l,h,h,d,d,v,d,m,f,f,s,v,f,m,g,p,b,y,b,n,b,w,e,i,M;t.save(),t.beginPath(),f=o.useButtonStyle,l=L(u),h=u.printZoomFactor,h=l?h:u.sheet.zoom(),n+=d=f?I*h:0,e+=d,i-=2*d,r-=2*d,d=V,v=o.hoverBackColor||W,d&&t.strokeStyle!==d&&(t.strokeStyle=d),f&&t.strokeRect(n+.5,e+.5,i-1,r-1),d=Rt(o.enabled,u.row),f?m=!1===o.enabled?o.buttonBackColor||Z:s===K?Y:s===x||u.visualState===C.VisualState.hover?v:((f=t.createLinearGradient(n+i/2,e,n+i/2,e+r)).addColorStop(.125,"#F6FAFB"),f.addColorStop(1,"#D2DBEB"),o.buttonBackColor||f):(m=o.buttonBackColor||"white",s===x&&(o.enabled||S(o.enabled))&&(m=v)),(f=a.font)&&t.font!==f&&(t.font=f),t.fillStyle!==m&&(t.fillStyle=m),t.rect(n+=1,e+=1,i-=2,r-=2),t.clip(),t.beginPath(),t.fillRect(n,e,i,r),s=new C.Rect(n,e,i,r),v=new C.Rect(n,e,i,r),f=J*h,m=Ot(o,u.row),o.caption&&m&&(g=(N.Bt(A,o.caption,a,h,u)+2*I)*h,p=U(o)*h,b=new C.Rect(0,0,g+p+f,r),b=ot(y=new C.Rect(n,e,i,r),b,j.MiddleCenter),o.captionAlign===C.CaptionAlignment.left?(v=new C.Rect(b.x,e,g,r),s=b.x+g+f<n+i-2?new C.Rect(b.x+g+f,e,Math.max(0,p),r):new C.Rect(0,0,0,0)):(s=new C.Rect(b.x,e,Math.min(p,i),r),v=b.x+p+f<n+i-2?new C.Rect(b.x+p+f,e,Math.min(i-2-p-f,g),r):new C.Rect(0,0,0,0))),o.caption&&(n=(N.Bt(A,o.caption,a,h,u)+2*I)*h,b=(N.tn(A,o.caption,a,h,u)+2*I)*h,e=ot(v,w=new C.Rect(0,0,n,b),j.MiddleCenter),i=new X,a=a.clone(),!1===d&&(a.foreColor=Q),a.cellButtons=T,a.decoration=T,i.paintValue(t,o.caption,e.x,e.y-(M=l?0:2),e.width,e.height,a,u)),m&&Ct(t,o,s.x,s.y,s.width,s.height,m,u,c),t.restore()}function Ct(t,n,e,i,r,o,a,u,s){var c,f,u,c,e,i,l,r,o,c,h,n,d;t.save(),t.rect(e+2,i+2,r-4,o-4),t.clip(),t.beginPath(),(f=(c=u.sheet).BO()).jt(a)?f.qh(a)&&(u=L(u)?u.printZoomFactor:c.zoom(),c=new C.Rect(e,i,r,o),e=U(n)-2,i=Tt(n)-2,r=ot(c,l=new C.Rect(0,0,e*u,i*u),j.MiddleCenter),c=(o=f.Ot(a)).width,h=o.height,C.mt.Tt.msie&&n.imageType&&(h=n.imageType===C.ButtonImageType.custom?(v[a]||(o.style.position="absolute",o.style.left="-10000px",o.style.top="-100000px",document.body.appendChild(o),v[a]={width:o.width,height:o.height},document.body.removeChild(o)),c=v[a].width,v[a].height):c=12),s&&C.mt.Tt.msie&&r.x+r.width>s.x+s.width?0<(n=s.x+s.width-r.x)&&t.drawImage(o,0,0,n*(d=c/(e*u)),h,r.x,r.y,n,i*u):t.drawImage(o,0,0,c,h,r.x,r.y,e*u,i*u)):f.Rt(a),t.restore()}function P(t,n,e,i){var r,o,n,a,u,e;return void 0===i&&(i=!0),r=L(e)?e.printZoomFactor:e.sheet.zoom(),o=2*I+3,S(t.width)?(n=N.Bt(A,t.caption,n,r,e),a=t.useButtonStyle,(u=Ot(t,e.row))&&(n=U(t)+n,o=(a?o:0)+J),i?(n+o+7)*r:n+o+7):(e=s(1,t.width),isNaN(e)&&(e=1),i?e*r:e)}function St(t,n,e){var i,r,i,n,t;return void 0===e&&(e=!0),i=n.sheet,r=L(n)?n.printZoomFactor:i.zoom(),i=i.getRowHeight(n.row),n=t.imageSize?t.imageSize.height:A,t=s(1,n||i),isNaN(t)&&(t=1),e?t*r:t}function G(t,n,e,i,r,o){var a,u,s,c,f,l,a=[];if(!n||0===n.length)return[];for(u=!1,s=t.Ut.getValueForKey(e,i,h),t.getActiveRowIndex()===e&&t.getActiveColumnIndex()===i&&!0!==s&&(u=!0),c=0;c<n.length;c++)for(f=n[c].visible,l=0;l<o.length;l++)(n[c].position===o[l]||S(n[c].position)&&o[l]===C.ButtonPosition.right)&&(f&&"function"==typeof f&&f(e)||n[c].visibility===C.ButtonVisibility.onEditing&&r||n[c].visibility!==C.ButtonVisibility.onEditing&&u||n[c].visibility===C.ButtonVisibility.always||S(n[c].visibility))&&a.push({index:c,button:n[c]});return a}function U(t){var n;return n=(n=t.imageSize&&("string"==typeof t.imageSize.width&&(n=c(t.imageSize.width)),"number"==typeof t.imageSize.width)?t.imageSize.width:n)===A||isNaN(n)||n<0?16:n}function Tt(t){var n;return n=(n=t.imageSize&&("string"==typeof t.imageSize.height&&(n=c(t.imageSize.height)),"number"==typeof t.imageSize.height)?t.imageSize.height:n)===A||isNaN(n)||n<0?16:n}function H(t,n,e,i,r){var o,a,o={isMouseDownReservedLocation:!1};return i===C.SheetArea.corner?o:((a=t.Ut.getValueForKey(n,e,f,i))||r||At(t,n,e,i,a=o),a)}function At(t,n,e,i,r){t.Ut.setValueForKey(n,e,f,r,i)}function u(t,n){var e,i,r,o,a,u,s,c,f,l,h,d,v,m,g,p,c,t,s,f,e;if(void 0===n&&(n=!1),e=t.context.row,i=t.context.col,r=t.cellRect,o=t.cellStyle,a=t.context,s=(u={x:t.x,y:t.y,row:e,col:i,cellRect:r,cellStyle:o,sheetArea:t.context.sheetArea,sheet:t.context.sheet,context:a}).sheet,!1!==t.cellStyle.locked&&s.options.isProtected&&!s.NMi)return null;if(c=H(s,u.row,u.col,u.sheetArea,!0),f=t.cellStyle.cellButtons,!c||!f||f.length<=0)return null;if(l=c.layout,!(l=n?c.editorLayout[t.buttonArea]:l))return null;for(m in h=-1,d=u.x,v=u.y,l)if(l.hasOwnProperty(m)&&(g=void 0,p=l[m],g=n?new C.Rect(p.x,p.y,p.width,p.height):new C.Rect(r.x+p.offsetX,r.y+p.offsetY,p.width,p.height))&&g.contains(d,v)){h=+m;break}return-1!==h?u.cellButtonHitInfo={hitButtonIndex:h,buttonConfig:f[h],buttonArea:t.buttonArea}:(c=s.getCellType(u.row,u.col))&&(t=O(G(s,f,e,i,n,[C.ButtonPosition.left]),l,o,a,!1),s=O(G(s,f,e,i,n,[C.ButtonPosition.right]),l,o,a,!1),f=new C.Rect(r.x+t.width,r.y,r.width-t.width-s.width,r.height),e=c.getHitInfo(u.x,u.y,o,f,a))&&e.isReservedLocation&&(u.isReservedLocation=!0),u}function It(t,n,e){var i,r,o,a,u,u,s,c,f,r,s,f,c,n,l,h;return void 0===n&&(n=!1),t&&t.cellButtonHitInfo&&(i=t.sheet,o=t.row,a=t.col,u=t.sheetArea,o===i.ui&&a===i.ci||u!==C.SheetArea.viewport||i.endEdit())&&(t.cellButtonHitInfo.buttonConfig&&(r=t.cellButtonHitInfo.buttonConfig.hasOverLay),u=H(i,o,a,t.sheetArea),t.cellButtonHitInfo&&(c=t.cellButtonHitInfo.hitButtonIndex,s=t.cellButtonHitInfo.buttonConfig),f=Rt(s&&s.enabled,t.row),i)&&(!u.isMouseDownReservedLocation||r)&&s&&(f||S(f))&&0<=c&&(u.buttonDownIndex=c,u.isMouseDownReservedLocation=!0,n&&e?(r=t.cellStyle,s=u.layout,f=t.context,c=u.editorLayout,n=t.cellButtonHitInfo&&t.cellButtonHitInfo.buttonArea,l=r.cellButtons,n&&R(e,h=G(i,l,o,a,!0,[tt(n)]),n,f,r,u,s,c)):i.repaint(t.cellRect),1)}function xt(t,n,e){var i,r,o,a,u,s,s,c,f,l,u,h,d,v,m,e;if(void 0===n&&(n=!1),t&&(i=t&&t.sheet,r=t.row,o=t.col,a=H(i,t.row,t.col,t.sheetArea),u=t.cellButtonHitInfo,a.isMouseDownReservedLocation)&&i){if(u&&0<=u.hitButtonIndex&&u.buttonConfig.command&&(s=u.buttonConfig.command,n||i.getActiveRowIndex()===r&&i.getActiveColumnIndex()===o||i.eR(r,o,1,1,2),"string"==typeof s?i.getParent().commandManager().execute({cmd:s,row:r,col:o,sheetName:i.name(),sheetArea:t.sheetArea}):"function"==typeof s&&s.call(A,i,r,o,t.sheetArea)),n&&0<=a.buttonDownIndex&&e&&(a.buttonDownIndex=-1,s=t.cellStyle,c=a.layout,f=t.context,l=a.editorLayout,u=u&&u.buttonArea,h=s.cellButtons,u)&&R(e,d=G(i,h,r,o,!0,[tt(u)]),u,f,s,a,c,l),a.buttonDownIndex=-1,n||i.repaint(t.cellRect),a.isMouseDownReservedLocation=!1,v=t.sheetArea,!(m=i.Ut.getValueForKey(r,o,g,v)))return Et(i,r,o,v),i.Ut.do("setValueForKey",r,o,g,!0,v),e=setTimeout(function(){rt(i,r,o,v)},250),void i.Ut.do("setValueForKey",r,o,p,e,v);rt(i,r,o,v)}}function Nt(t,n,e){var i,r,o,o,n,a,u,s,c,f,l;void 0===n&&(n=!1),t&&(r=H(i=t&&t.sheet,t.row,t.col,t.sheetArea),o=-1,(o=t.cellButtonHitInfo?t.cellButtonHitInfo.hitButtonIndex:o)!==(S(r.buttonHoverIndex)?-1:r.buttonHoverIndex))&&(r.buttonHoverIndex=o,n?(o=t.cellStyle,n=r.layout,a=t.context,u=r.editorLayout,s=o.cellButtons,c=t.row,f=t.col,e&&Dt(s,i,c,f,l=e.parentElement,a,o,r,n,u)):i.repaint(t.cellRect))}function kt(t,n,e){var i,r,n,o,a,u,s,c,f,l;void 0===n&&(n=!1),t&&t.cellButtonHitInfo&&(r=H(i=t&&t.sheet,t.row,t.col,t.sheetArea),n?(r.buttonHoverIndex=-1,0<=t.cellButtonHitInfo.hitButtonIndex&&(n=t.cellStyle,o=r.layout,a=t.context,u=r.editorLayout,s=n.cellButtons,c=t.row,f=t.col,e)&&Dt(s,i,c,f,l=e.parentElement,a,n,r,o,u)):(i&&(r.buttonHoverIndex=-1,r.buttonDownIndex=-1,r.isMouseDownReservedLocation=!1),i.repaint(t.cellRect)))}function Dt(t,n,e,i,r,o,a,u,s,c){for(var f,l,h,d,f=0;f<m.length;f++)l=nt(m[f]),R(h=r.querySelector("."+it(l)),d=G(n,t,e,i,!0,[tt(l)]),l,o,a,u,s,c)}function _t(t){var t=t.clone(!0);return t.hAlign=C.HorizontalAlign.left,t.vAlign=C.VerticalAlign.center,t.wordWrap=!1,t.isVerticalText=!1,t.shrinkToFit=!1,t.formatter="General",t.textIndent=0,t}function Et(t,n,e,i){var r=t.parent;r&&r.j3(t,n,e,i)}function jt(t,n,e,i,r){var o,a,u,o=t.Il(n,e,r);if(o&&o.cellButtons&&0<o.cellButtons.length&&0<(a=o.cellButtons.filter(function(t){return 1===t.visibility})).length){i&&t.Ut.do("setValueForKey",n,e,h,!0,r);try{u=t.getCellRect(n,e,1===r?-1:void 0,2===r?-1:void 0),t.repaint(u)}finally{i&&t.Ut.do("setValueForKey",n,e,h,T,r)}}}function Ot(t,n){var e,i,n,r,e=null,i=t.imageType;if(S(t.imageType))return null;switch(r=(n=Rt(t.enabled,n))||S(n),i){case C.ButtonImageType.dropdown:e=r?"data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz4KPHN2ZyB3aWR0aD0iMTJweCIgaGVpZ2h0PSIxMnB4IiB2aWV3Qm94PSIwIDAgMTIgMTIiIHZlcnNpb249IjEuMSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB4bWxuczp4bGluaz0iaHR0cDovL3d3dy53My5vcmcvMTk5OS94bGluayI+CiAgICA8IS0tIEdlbmVyYXRvcjogU2tldGNoIDU1ICg3ODA3NikgLSBodHRwczovL3NrZXRjaGFwcC5jb20gLS0+CiAgICA8dGl0bGU+ZHJvcGRvd248L3RpdGxlPgogICAgPGRlc2M+Q3JlYXRlZCB3aXRoIFNrZXRjaC48L2Rlc2M+CiAgICA8ZyBpZD0iZHJvcGRvd24iIHN0cm9rZT0ibm9uZSIgc3Ryb2tlLXdpZHRoPSIxIiBmaWxsPSJub25lIiBmaWxsLXJ1bGU9ImV2ZW5vZGQiPgogICAgICAgIDxwb2x5Z29uIGZpbGw9IiM2RTZFNkUiIHBvaW50cz0iMyA0IDEwIDQgNi41IDkiPjwvcG9seWdvbj4KICAgIDwvZz4KPC9zdmc+":"data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz4KPHN2ZyB3aWR0aD0iMTJweCIgaGVpZ2h0PSIxMnB4IiB2aWV3Qm94PSIwIDAgMTIgMTIiIHZlcnNpb249IjEuMSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB4bWxuczp4bGluaz0iaHR0cDovL3d3dy53My5vcmcvMTk5OS94bGluayI+CiAgICA8IS0tIEdlbmVyYXRvcjogU2tldGNoIDU1ICg3ODA3NikgLSBodHRwczovL3NrZXRjaGFwcC5jb20gLS0+CiAgICA8dGl0bGU+ZHJvcGRvd248L3RpdGxlPgogICAgPGRlc2M+Q3JlYXRlZCB3aXRoIFNrZXRjaC48L2Rlc2M+CiAgICA8ZyBpZD0iZHJvcGRvd24iIHN0cm9rZT0ibm9uZSIgc3Ryb2tlLXdpZHRoPSIxIiBmaWxsPSJub25lIiBmaWxsLXJ1bGU9ImV2ZW5vZGQiPgogICAgICAgIDxwb2x5Z29uIGZpbGw9IiNDQUNBQ0EiIHBvaW50cz0iMyA0IDEwIDQgNi41IDkiPjwvcG9seWdvbj4KICAgIDwvZz4KPC9zdmc+";break;case C.ButtonImageType.left:e=r?"data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz4KPHN2ZyB3aWR0aD0iMTJweCIgaGVpZ2h0PSIxMnB4IiB2aWV3Qm94PSIwIDAgMTIgMTIiIHZlcnNpb249IjEuMSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB4bWxuczp4bGluaz0iaHR0cDovL3d3dy53My5vcmcvMTk5OS94bGluayI+CiAgICA8IS0tIEdlbmVyYXRvcjogU2tldGNoIDU1ICg3ODA3NikgLSBodHRwczovL3NrZXRjaGFwcC5jb20gLS0+CiAgICA8dGl0bGU+bGVmdDwvdGl0bGU+CiAgICA8ZGVzYz5DcmVhdGVkIHdpdGggU2tldGNoLjwvZGVzYz4KICAgIDxnIGlkPSJsZWZ0IiBzdHJva2U9Im5vbmUiIHN0cm9rZS13aWR0aD0iMSIgZmlsbD0ibm9uZSIgZmlsbC1ydWxlPSJldmVub2RkIj4KICAgICAgICA8cG9seWdvbiBmaWxsPSIjNkU2RTZFIiBmaWxsLXJ1bGU9Im5vbnplcm8iIHBvaW50cz0iNS4zNTE1MjcxMiA2LjUgOCA5LjI4ODYzMDM2IDcuMzI0MzU0MDMgMTAgNCA2LjUgNy4zMjQzNTQwMyAzIDggMy43MTEzNjk2NCI+PC9wb2x5Z29uPgogICAgPC9nPgo8L3N2Zz4=":"data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz4KPHN2ZyB3aWR0aD0iMTJweCIgaGVpZ2h0PSIxMnB4IiB2aWV3Qm94PSIwIDAgMTIgMTIiIHZlcnNpb249IjEuMSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB4bWxuczp4bGluaz0iaHR0cDovL3d3dy53My5vcmcvMTk5OS94bGluayI+CiAgICA8IS0tIEdlbmVyYXRvcjogU2tldGNoIDU1ICg3ODA3NikgLSBodHRwczovL3NrZXRjaGFwcC5jb20gLS0+CiAgICA8dGl0bGU+bGVmdDwvdGl0bGU+CiAgICA8ZGVzYz5DcmVhdGVkIHdpdGggU2tldGNoLjwvZGVzYz4KICAgIDxnIGlkPSJsZWZ0IiBzdHJva2U9Im5vbmUiIHN0cm9rZS13aWR0aD0iMSIgZmlsbD0ibm9uZSIgZmlsbC1ydWxlPSJldmVub2RkIj4KICAgICAgICA8cG9seWdvbiBmaWxsPSIjQ0FDQUNBIiBmaWxsLXJ1bGU9Im5vbnplcm8iIHBvaW50cz0iNS4zNTE1MjcxMiA2LjUgOCA5LjI4ODYzMDM2IDcuMzI0MzU0MDMgMTAgNCA2LjUgNy4zMjQzNTQwMyAzIDggMy43MTEzNjk2NCI+PC9wb2x5Z29uPgogICAgPC9nPgo8L3N2Zz4=";break;case C.ButtonImageType.right:e=r?"data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz4KPHN2ZyB3aWR0aD0iMTJweCIgaGVpZ2h0PSIxMnB4IiB2aWV3Qm94PSIwIDAgMTIgMTIiIHZlcnNpb249IjEuMSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB4bWxuczp4bGluaz0iaHR0cDovL3d3dy53My5vcmcvMTk5OS94bGluayI+CiAgICA8IS0tIEdlbmVyYXRvcjogU2tldGNoIDU1ICg3ODA3NikgLSBodHRwczovL3NrZXRjaGFwcC5jb20gLS0+CiAgICA8dGl0bGU+cmlnaHQ8L3RpdGxlPgogICAgPGRlc2M+Q3JlYXRlZCB3aXRoIFNrZXRjaC48L2Rlc2M+CiAgICA8ZyBpZD0icmlnaHQiIHN0cm9rZT0ibm9uZSIgc3Ryb2tlLXdpZHRoPSIxIiBmaWxsPSJub25lIiBmaWxsLXJ1bGU9ImV2ZW5vZGQiPgogICAgICAgIDxwb2x5Z29uIGZpbGw9IiM2RTZFNkUiIGZpbGwtcnVsZT0ibm9uemVybyIgdHJhbnNmb3JtPSJ0cmFuc2xhdGUoNi4wMDAwMDAsIDYuNTAwMDAwKSBzY2FsZSgtMSwgMSkgdHJhbnNsYXRlKC02LjAwMDAwMCwgLTYuNTAwMDAwKSAiIHBvaW50cz0iNS4zNTE1MjcxMiA2LjUgOCA5LjI4ODYzMDM2IDcuMzI0MzU0MDMgMTAgNCA2LjUgNy4zMjQzNTQwMyAzIDggMy43MTEzNjk2NCI+PC9wb2x5Z29uPgogICAgPC9nPgo8L3N2Zz4=":"data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz4KPHN2ZyB3aWR0aD0iMTJweCIgaGVpZ2h0PSIxMnB4IiB2aWV3Qm94PSIwIDAgMTIgMTIiIHZlcnNpb249IjEuMSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB4bWxuczp4bGluaz0iaHR0cDovL3d3dy53My5vcmcvMTk5OS94bGluayI+CiAgICA8IS0tIEdlbmVyYXRvcjogU2tldGNoIDU1ICg3ODA3NikgLSBodHRwczovL3NrZXRjaGFwcC5jb20gLS0+CiAgICA8dGl0bGU+cmlnaHQ8L3RpdGxlPgogICAgPGRlc2M+Q3JlYXRlZCB3aXRoIFNrZXRjaC48L2Rlc2M+CiAgICA8ZyBpZD0icmlnaHQiIHN0cm9rZT0ibm9uZSIgc3Ryb2tlLXdpZHRoPSIxIiBmaWxsPSJub25lIiBmaWxsLXJ1bGU9ImV2ZW5vZGQiPgogICAgICAgIDxwb2x5Z29uIGZpbGw9IiNDQUNBQ0EiIGZpbGwtcnVsZT0ibm9uemVybyIgdHJhbnNmb3JtPSJ0cmFuc2xhdGUoNi4wMDAwMDAsIDYuNTAwMDAwKSBzY2FsZSgtMSwgMSkgdHJhbnNsYXRlKC02LjAwMDAwMCwgLTYuNTAwMDAwKSAiIHBvaW50cz0iNS4zNTE1MjcxMiA2LjUgOCA5LjI4ODYzMDM2IDcuMzI0MzU0MDMgMTAgNCA2LjUgNy4zMjQzNTQwMyAzIDggMy43MTEzNjk2NCI+PC9wb2x5Z29uPgogICAgPC9nPgo8L3N2Zz4=";break;case C.ButtonImageType.clear:e=r?"data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz4KPHN2ZyB3aWR0aD0iMTJweCIgaGVpZ2h0PSIxMnB4IiB2aWV3Qm94PSIwIDAgMTIgMTIiIHZlcnNpb249IjEuMSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB4bWxuczp4bGluaz0iaHR0cDovL3d3dy53My5vcmcvMTk5OS94bGluayI+CiAgICA8IS0tIEdlbmVyYXRvcjogU2tldGNoIDU1ICg3ODA3NikgLSBodHRwczovL3NrZXRjaGFwcC5jb20gLS0+CiAgICA8dGl0bGU+Y2xlYXI8L3RpdGxlPgogICAgPGRlc2M+Q3JlYXRlZCB3aXRoIFNrZXRjaC48L2Rlc2M+CiAgICA8ZyBpZD0iY2xlYXIiIHN0cm9rZT0ibm9uZSIgc3Ryb2tlLXdpZHRoPSIxIiBmaWxsPSJub25lIiBmaWxsLXJ1bGU9ImV2ZW5vZGQiPgogICAgICAgIDxwb2x5Z29uIGZpbGw9IiM2RTZFNkUiIGZpbGwtcnVsZT0ibm9uemVybyIgcG9pbnRzPSI4Ljg3NTQ2MzkgMyAxMCA0LjEyNDUzNjEgNy42MjQ1MzYxIDYuNSAxMCA4Ljg3NTQ2MzkgOC44NzU0NjM5IDEwIDYuNSA3LjYyNDUzNjEgNC4xMjQ1MzYxIDEwIDMgOC44NzU0NjM5IDUuMzc1NDYzOSA2LjUgMyA0LjEyNDUzNjEgNC4xMjQ1MzYxIDMgNi41IDUuMzc1NDYzOSI+PC9wb2x5Z29uPgogICAgPC9nPgo8L3N2Zz4=":"data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz4KPHN2ZyB3aWR0aD0iMTJweCIgaGVpZ2h0PSIxMnB4IiB2aWV3Qm94PSIwIDAgMTIgMTIiIHZlcnNpb249IjEuMSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB4bWxuczp4bGluaz0iaHR0cDovL3d3dy53My5vcmcvMTk5OS94bGluayI+CiAgICA8IS0tIEdlbmVyYXRvcjogU2tldGNoIDU1ICg3ODA3NikgLSBodHRwczovL3NrZXRjaGFwcC5jb20gLS0+CiAgICA8dGl0bGU+Y2xlYXI8L3RpdGxlPgogICAgPGRlc2M+Q3JlYXRlZCB3aXRoIFNrZXRjaC48L2Rlc2M+CiAgICA8ZyBpZD0iY2xlYXIiIHN0cm9rZT0ibm9uZSIgc3Ryb2tlLXdpZHRoPSIxIiBmaWxsPSJub25lIiBmaWxsLXJ1bGU9ImV2ZW5vZGQiPgogICAgICAgIDxwb2x5Z29uIGZpbGw9IiNDQUNBQ0EiIGZpbGwtcnVsZT0ibm9uemVybyIgcG9pbnRzPSI4Ljg3NTQ2MzkgMyAxMCA0LjEyNDUzNjEgNy42MjQ1MzYxIDYuNSAxMCA4Ljg3NTQ2MzkgOC44NzU0NjM5IDEwIDYuNSA3LjYyNDUzNjEgNC4xMjQ1MzYxIDEwIDMgOC44NzU0NjM5IDUuMzc1NDYzOSA2LjUgMyA0LjEyNDUzNjEgNC4xMjQ1MzYxIDMgNi41IDUuMzc1NDYzOSI+PC9wb2x5Z29uPgogICAgPC9nPgo8L3N2Zz4=";break;case 3:e=r?"data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz4KPHN2ZyB3aWR0aD0iMTJweCIgaGVpZ2h0PSIxMnB4IiB2aWV3Qm94PSIwIDAgMTIgMTIiIHZlcnNpb249IjEuMSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB4bWxuczp4bGluaz0iaHR0cDovL3d3dy53My5vcmcvMTk5OS94bGluayI+CiAgICA8IS0tIEdlbmVyYXRvcjogU2tldGNoIDU1ICg3ODA3NikgLSBodHRwczovL3NrZXRjaGFwcC5jb20gLS0+CiAgICA8dGl0bGU+Y2FuY2VsPC90aXRsZT4KICAgIDxkZXNjPkNyZWF0ZWQgd2l0aCBTa2V0Y2guPC9kZXNjPgogICAgPGcgaWQ9ImNhbmNlbCIgc3Ryb2tlPSJub25lIiBzdHJva2Utd2lkdGg9IjEiIGZpbGw9Im5vbmUiIGZpbGwtcnVsZT0iZXZlbm9kZCI+CiAgICAgICAgPHBhdGggZD0iTTYsMSBDOC43NjE0MzE3MSwxIDExLDMuMjM4NTgxMzIgMTEsNiBDMTEsOC43NjE0MzE3MSA4Ljc2MTQzMTcxLDExLjAwMDAxMyA2LjAwMDAwNjUyLDExLjAwMDAxMyBDMy4yMzg1ODEzMiwxMS4wMDAwMTMgMSw4Ljc2MTQ0NDc0IDEsNiBDMSwzLjIzODU2ODI5IDMuMjM4NTgxMzIsMSA2LDEgWiBNOC41MTgwNTU5NiwzLjQ4MTk0NDA0IEM4LjI1MTg4NTYxLDMuMjE1NzczNyA3LjgyMDMzODIyLDMuMjE1NzczNyA3LjU1NDE2Nzg4LDMuNDgxOTQ0MDQgTDYsNS4wMzYxMTE5MiBMNC40NDU4MzIxMiwzLjQ4MTk0NDA0IEM0LjE3OTY2MTc4LDMuMjE1NzczNyAzLjc0ODExNDM5LDMuMjE1NzczNyAzLjQ4MTk0NDA0LDMuNDgxOTQ0MDQgQzMuMjE1NzczNywzLjc0ODExNDM5IDMuMjE1NzczNyw0LjE3OTY2MTc4IDMuNDgxOTQ0MDQsNC40NDU4MzIxMiBMNS4wMzYxMTE5Miw2IEwzLjQ4MTk0NDA0LDcuNTU0MTY3ODggQzMuMjE1NzczNyw3LjgyMDMzODIyIDMuMjE1NzczNyw4LjI1MTg4NTYxIDMuNDgxOTQ0MDQsOC41MTgwNTU5NiBDMy43NDgxMTQzOSw4Ljc4NDIyNjMgNC4xNzk2NjE3OCw4Ljc4NDIyNjMgNC40NDU4MzIxMiw4LjUxODA1NTk2IEw2LDYuOTYzODg4MDggTDcuNTU0MTY3ODgsOC41MTgwNTU5NiBDNy44MjAzMzgyMiw4Ljc4NDIyNjMgOC4yNTE4ODU2MSw4Ljc4NDIyNjMgOC41MTgwNTU5Niw4LjUxODA1NTk2IEM4Ljc4NDIyNjMsOC4yNTE4ODU2MSA4Ljc4NDIyNjMsNy44MjAzMzgyMiA4LjUxODA1NTk2LDcuNTU0MTY3ODggTDYuOTYzODg4MDgsNiBMOC41MTgwNTU5Niw0LjQ0NTgzMjEyIEM4Ljc4NDIyNjMsNC4xNzk2NjE3OCA4Ljc4NDIyNjMsMy43NDgxMTQzOSA4LjUxODA1NTk2LDMuNDgxOTQ0MDQgWiIgaWQ9IuW9oueKtue7k+WQiCIgZmlsbD0iIzZFNkU2RSIgZmlsbC1ydWxlPSJub256ZXJvIj48L3BhdGg+CiAgICA8L2c+Cjwvc3ZnPg==":"data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz4KPHN2ZyB3aWR0aD0iMTJweCIgaGVpZ2h0PSIxMnB4IiB2aWV3Qm94PSIwIDAgMTIgMTIiIHZlcnNpb249IjEuMSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB4bWxuczp4bGluaz0iaHR0cDovL3d3dy53My5vcmcvMTk5OS94bGluayI+CiAgICA8IS0tIEdlbmVyYXRvcjogU2tldGNoIDU1ICg3ODA3NikgLSBodHRwczovL3NrZXRjaGFwcC5jb20gLS0+CiAgICA8dGl0bGU+Y2FuY2VsPC90aXRsZT4KICAgIDxkZXNjPkNyZWF0ZWQgd2l0aCBTa2V0Y2guPC9kZXNjPgogICAgPGcgaWQ9ImNhbmNlbCIgc3Ryb2tlPSJub25lIiBzdHJva2Utd2lkdGg9IjEiIGZpbGw9Im5vbmUiIGZpbGwtcnVsZT0iZXZlbm9kZCI+CiAgICAgICAgPHBhdGggZD0iTTYsMSBDOC43NjE0MzE3MSwxIDExLDMuMjM4NTgxMzIgMTEsNiBDMTEsOC43NjE0MzE3MSA4Ljc2MTQzMTcxLDExLjAwMDAxMyA2LjAwMDAwNjUyLDExLjAwMDAxMyBDMy4yMzg1ODEzMiwxMS4wMDAwMTMgMSw4Ljc2MTQ0NDc0IDEsNiBDMSwzLjIzODU2ODI5IDMuMjM4NTgxMzIsMSA2LDEgWiBNOC41MTgwNTU5NiwzLjQ4MTk0NDA0IEM4LjI1MTg4NTYxLDMuMjE1NzczNyA3LjgyMDMzODIyLDMuMjE1NzczNyA3LjU1NDE2Nzg4LDMuNDgxOTQ0MDQgTDYsNS4wMzYxMTE5MiBMNC40NDU4MzIxMiwzLjQ4MTk0NDA0IEM0LjE3OTY2MTc4LDMuMjE1NzczNyAzLjc0ODExNDM5LDMuMjE1NzczNyAzLjQ4MTk0NDA0LDMuNDgxOTQ0MDQgQzMuMjE1NzczNywzLjc0ODExNDM5IDMuMjE1NzczNyw0LjE3OTY2MTc4IDMuNDgxOTQ0MDQsNC40NDU4MzIxMiBMNS4wMzYxMTE5Miw2IEwzLjQ4MTk0NDA0LDcuNTU0MTY3ODggQzMuMjE1NzczNyw3LjgyMDMzODIyIDMuMjE1NzczNyw4LjI1MTg4NTYxIDMuNDgxOTQ0MDQsOC41MTgwNTU5NiBDMy43NDgxMTQzOSw4Ljc4NDIyNjMgNC4xNzk2NjE3OCw4Ljc4NDIyNjMgNC40NDU4MzIxMiw4LjUxODA1NTk2IEw2LDYuOTYzODg4MDggTDcuNTU0MTY3ODgsOC41MTgwNTU5NiBDNy44MjAzMzgyMiw4Ljc4NDIyNjMgOC4yNTE4ODU2MSw4Ljc4NDIyNjMgOC41MTgwNTU5Niw4LjUxODA1NTk2IEM4Ljc4NDIyNjMsOC4yNTE4ODU2MSA4Ljc4NDIyNjMsNy44MjAzMzgyMiA4LjUxODA1NTk2LDcuNTU0MTY3ODggTDYuOTYzODg4MDgsNiBMOC41MTgwNTU5Niw0LjQ0NTgzMjEyIEM4Ljc4NDIyNjMsNC4xNzk2NjE3OCA4Ljc4NDIyNjMsMy43NDgxMTQzOSA4LjUxODA1NTk2LDMuNDgxOTQ0MDQgWiIgaWQ9IuW9oueKtue7k+WQiCIgZmlsbD0iI0NBQ0FDQSIgZmlsbC1ydWxlPSJub256ZXJvIj48L3BhdGg+CiAgICA8L2c+Cjwvc3ZnPg==";break;case C.ButtonImageType.ok:e=r?"data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz4KPHN2ZyB3aWR0aD0iMTJweCIgaGVpZ2h0PSIxMnB4IiB2aWV3Qm94PSIwIDAgMTIgMTIiIHZlcnNpb249IjEuMSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB4bWxuczp4bGluaz0iaHR0cDovL3d3dy53My5vcmcvMTk5OS94bGluayI+CiAgICA8IS0tIEdlbmVyYXRvcjogU2tldGNoIDU1ICg3ODA3NikgLSBodHRwczovL3NrZXRjaGFwcC5jb20gLS0+CiAgICA8dGl0bGU+b2s8L3RpdGxlPgogICAgPGRlc2M+Q3JlYXRlZCB3aXRoIFNrZXRjaC48L2Rlc2M+CiAgICA8ZyBpZD0ib2siIHN0cm9rZT0ibm9uZSIgc3Ryb2tlLXdpZHRoPSIxIiBmaWxsPSJub25lIiBmaWxsLXJ1bGU9ImV2ZW5vZGQiPgogICAgICAgIDxwYXRoIGQ9Ik01LjY3NjUyMjQsMTAgQzUuNjc2NTIyNCwxMCA2LjkxNzAzMjUzLDcuMzM0ODI5MDcgOC40MTk2ODA3OSw1LjMyNjE2ODAyIEM5LjU4MDA5Mzk2LDMuNzc2MzU0NDYgMTEsMi43MTg3NTQxMSAxMSwyLjcxODc1NDExIEwxMC41MTYxMDg0LDIgQzEwLjUxNjEwODQsMiA4Ljk2NzEyNTYsMi43MDIwNjg3NSA3LjU3NzY3MjIzLDQuMDUwMzc0NDYgQzYuMTY4MzYwMTEsNS40MTcyOTA3NiA1LjM0NDg4MTIxLDYuOTQ2NTczNSA1LjM0NDg4MTIxLDYuOTQ2NTczNSBMMy4yOTc0Mzg1Niw1LjAxMTcxMzA5IEwyLDYuNDYwMTI1OTcgTDUuNjc2NTE5ODEsOS45OTk5ODc0NyBMNS42NzY1MTk4MSw5Ljk5OTk4NzQ3IEw1LjY3NjUyMjQsMTAgWiIgaWQ9Ik9LIiBmaWxsPSIjNkU2RTZFIiBmaWxsLXJ1bGU9Im5vbnplcm8iPjwvcGF0aD4KICAgIDwvZz4KPC9zdmc+":"data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz4KPHN2ZyB3aWR0aD0iMTJweCIgaGVpZ2h0PSIxMnB4IiB2aWV3Qm94PSIwIDAgMTIgMTIiIHZlcnNpb249IjEuMSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB4bWxuczp4bGluaz0iaHR0cDovL3d3dy53My5vcmcvMTk5OS94bGluayI+CiAgICA8IS0tIEdlbmVyYXRvcjogU2tldGNoIDU1ICg3ODA3NikgLSBodHRwczovL3NrZXRjaGFwcC5jb20gLS0+CiAgICA8dGl0bGU+b2s8L3RpdGxlPgogICAgPGRlc2M+Q3JlYXRlZCB3aXRoIFNrZXRjaC48L2Rlc2M+CiAgICA8ZyBpZD0ib2siIHN0cm9rZT0ibm9uZSIgc3Ryb2tlLXdpZHRoPSIxIiBmaWxsPSJub25lIiBmaWxsLXJ1bGU9ImV2ZW5vZGQiPgogICAgICAgIDxwYXRoIGQ9Ik01LjY3NjUyMjQsMTAgQzUuNjc2NTIyNCwxMCA2LjkxNzAzMjUzLDcuMzM0ODI5MDcgOC40MTk2ODA3OSw1LjMyNjE2ODAyIEM5LjU4MDA5Mzk2LDMuNzc2MzU0NDYgMTEsMi43MTg3NTQxMSAxMSwyLjcxODc1NDExIEwxMC41MTYxMDg0LDIgQzEwLjUxNjEwODQsMiA4Ljk2NzEyNTYsMi43MDIwNjg3NSA3LjU3NzY3MjIzLDQuMDUwMzc0NDYgQzYuMTY4MzYwMTEsNS40MTcyOTA3NiA1LjM0NDg4MTIxLDYuOTQ2NTczNSA1LjM0NDg4MTIxLDYuOTQ2NTczNSBMMy4yOTc0Mzg1Niw1LjAxMTcxMzA5IEwyLDYuNDYwMTI1OTcgTDUuNjc2NTE5ODEsOS45OTk5ODc0NyBMNS42NzY1MTk4MSw5Ljk5OTk4NzQ3IEw1LjY3NjUyMjQsMTAgWiIgaWQ9Ik9LIiBmaWxsPSIjQ0FDQUNBIiBmaWxsLXJ1bGU9Im5vbnplcm8iPjwvcGF0aD4KICAgIDwvZz4KPC9zdmc+";break;case C.ButtonImageType.plus:e=r?"data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz4KPHN2ZyB3aWR0aD0iMTJweCIgaGVpZ2h0PSIxMnB4IiB2aWV3Qm94PSIwIDAgMTIgMTIiIHZlcnNpb249IjEuMSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB4bWxuczp4bGluaz0iaHR0cDovL3d3dy53My5vcmcvMTk5OS94bGluayI+CiAgICA8IS0tIEdlbmVyYXRvcjogU2tldGNoIDU1ICg3ODA3NikgLSBodHRwczovL3NrZXRjaGFwcC5jb20gLS0+CiAgICA8dGl0bGU+cGx1czwvdGl0bGU+CiAgICA8ZGVzYz5DcmVhdGVkIHdpdGggU2tldGNoLjwvZGVzYz4KICAgIDxnIGlkPSJwbHVzIiBzdHJva2U9Im5vbmUiIHN0cm9rZS13aWR0aD0iMSIgZmlsbD0ibm9uZSIgZmlsbC1ydWxlPSJldmVub2RkIj4KICAgICAgICA8cGF0aCBkPSJNNSw1IEw1LDMgTDcsMyBMNyw1IEw5LDUgTDksNyBMNyw3IEw3LDkgTDUsOSBMNSw3IEwzLDcgTDMsNSBMNSw1IFoiIGZpbGw9IiM2RTZFNkUiPjwvcGF0aD4KICAgIDwvZz4KPC9zdmc+":"data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz4KPHN2ZyB3aWR0aD0iMTJweCIgaGVpZ2h0PSIxMnB4IiB2aWV3Qm94PSIwIDAgMTIgMTIiIHZlcnNpb249IjEuMSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB4bWxuczp4bGluaz0iaHR0cDovL3d3dy53My5vcmcvMTk5OS94bGluayI+CiAgICA8IS0tIEdlbmVyYXRvcjogU2tldGNoIDU1ICg3ODA3NikgLSBodHRwczovL3NrZXRjaGFwcC5jb20gLS0+CiAgICA8dGl0bGU+cGx1czwvdGl0bGU+CiAgICA8ZGVzYz5DcmVhdGVkIHdpdGggU2tldGNoLjwvZGVzYz4KICAgIDxnIGlkPSJwbHVzIiBzdHJva2U9Im5vbmUiIHN0cm9rZS13aWR0aD0iMSIgZmlsbD0ibm9uZSIgZmlsbC1ydWxlPSJldmVub2RkIj4KICAgICAgICA8cGF0aCBkPSJNNSw1IEw1LDMgTDcsMyBMNyw1IEw5LDUgTDksNyBMNyw3IEw3LDkgTDUsOSBMNSw3IEwzLDcgTDMsNSBMNSw1IFoiIGZpbGw9IiNDQUNBQ0EiPjwvcGF0aD4KICAgIDwvZz4KPC9zdmc+";break;case C.ButtonImageType.minus:e=r?"data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz4KPHN2ZyB3aWR0aD0iMTJweCIgaGVpZ2h0PSIxMnB4IiB2aWV3Qm94PSIwIDAgMTIgMTIiIHZlcnNpb249IjEuMSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB4bWxuczp4bGluaz0iaHR0cDovL3d3dy53My5vcmcvMTk5OS94bGluayI+CiAgICA8IS0tIEdlbmVyYXRvcjogU2tldGNoIDU1ICg3ODA3NikgLSBodHRwczovL3NrZXRjaGFwcC5jb20gLS0+CiAgICA8dGl0bGU+bWludXM8L3RpdGxlPgogICAgPGRlc2M+Q3JlYXRlZCB3aXRoIFNrZXRjaC48L2Rlc2M+CiAgICA8ZyBpZD0ibWludXMiIHN0cm9rZT0ibm9uZSIgc3Ryb2tlLXdpZHRoPSIxIiBmaWxsPSJub25lIiBmaWxsLXJ1bGU9ImV2ZW5vZGQiPgogICAgICAgIDxyZWN0IGZpbGw9IiM2RTZFNkUiIHg9IjMiIHk9IjUiIHdpZHRoPSI2IiBoZWlnaHQ9IjIiPjwvcmVjdD4KICAgIDwvZz4KPC9zdmc+":"data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz4KPHN2ZyB3aWR0aD0iMTJweCIgaGVpZ2h0PSIxMnB4IiB2aWV3Qm94PSIwIDAgMTIgMTIiIHZlcnNpb249IjEuMSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB4bWxuczp4bGluaz0iaHR0cDovL3d3dy53My5vcmcvMTk5OS94bGluayI+CiAgICA8IS0tIEdlbmVyYXRvcjogU2tldGNoIDU1ICg3ODA3NikgLSBodHRwczovL3NrZXRjaGFwcC5jb20gLS0+CiAgICA8dGl0bGU+bWludXM8L3RpdGxlPgogICAgPGRlc2M+Q3JlYXRlZCB3aXRoIFNrZXRjaC48L2Rlc2M+CiAgICA8ZyBpZD0ibWludXMiIHN0cm9rZT0ibm9uZSIgc3Ryb2tlLXdpZHRoPSIxIiBmaWxsPSJub25lIiBmaWxsLXJ1bGU9ImV2ZW5vZGQiPgogICAgICAgIDxyZWN0IGZpbGw9IiNDQUNBQ0EiIHg9IjMiIHk9IjUiIHdpZHRoPSI2IiBoZWlnaHQ9IjIiPjwvcmVjdD4KICAgIDwvZz4KPC9zdmc+";break;case C.ButtonImageType.redo:e=r?"data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz4KPHN2ZyB3aWR0aD0iMTJweCIgaGVpZ2h0PSIxMnB4IiB2aWV3Qm94PSIwIDAgMTIgMTIiIHZlcnNpb249IjEuMSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB4bWxuczp4bGluaz0iaHR0cDovL3d3dy53My5vcmcvMTk5OS94bGluayI+CiAgICA8IS0tIEdlbmVyYXRvcjogU2tldGNoIDU1ICg3ODA3NikgLSBodHRwczovL3NrZXRjaGFwcC5jb20gLS0+CiAgICA8dGl0bGU+cmVkbzwvdGl0bGU+CiAgICA8ZGVzYz5DcmVhdGVkIHdpdGggU2tldGNoLjwvZGVzYz4KICAgIDxnIGlkPSJyZWRvIiBzdHJva2U9Im5vbmUiIHN0cm9rZS13aWR0aD0iMSIgZmlsbD0ibm9uZSIgZmlsbC1ydWxlPSJldmVub2RkIj4KICAgICAgICA8cGF0aCBkPSJNNi43NDY0OTIwNSwzLjc5NjM1NTEyIEM4LjUzNjk1MDQyLDMuNzk2MzU1MTIgMTAsNS4xNzQ5NDI4NyAxMCw2Ljg5NzczMTcxIEMxMCw4LjYyMDUyMDU0IDguNTM2OTUwNDIsMTAgNi43NDY0OTIwNSwxMCBMNS4zMzQ4OTI0MiwxMCBDNS4xOTczODA3MywxMCA1LjExMTMxODk5LDkuOTAxOTExNjEgNS4xMTEzMTg5OSw5Ljc2OTkzODE0IEw1LjExMTMxODk5LDkuMjQ0NzE5MzkgQzUuMTExMzE4OTksOS4xMTM2Mzc2MyA1LjIxNDIxODksOC45OTg2MDY3IDUuMzUyNjY2MDQsOC45OTg2MDY3IEw2Ljc0NzQyNzUsOC45OTg2MDY3IEM3Ljk3MDA2NTQ4LDguOTk4NjA2NyA4Ljk1MTM1NjQxLDguMDYzMjAwMTMgOC45NTEzNTY0MSw2Ljg5NzczMTcxIEM4Ljk1MTM1NjQxLDUuNzMyMjYzMjggNy45NjkxMzAwMyw0Ljc5Nzc0ODQzIDYuNzQ2NDkyMDUsNC43OTc3NDg0MyBMNC4zNTM2MDE1LDQuNzk3NzQ4NDMgQzQuMzUzNjAxNSw0Ljc5Nzc0ODQzIDQuMjE2MDg5OCw0Ljc5Nzc0ODQzIDQuMTY0NjM5ODUsNC44MTM3OTkyNSBDNC4wMjcxMjgxNiw0Ljg3OTc4NTk5IDQuMDYxNzM5OTQsNC45Nzc4NzQzOCA0LjE4MTQ3ODAyLDUuMDkyOTA1MzEgTDUuMDI1MjU3MjUsNS44OTcyMzAxMiBDNS4xMjgxNTcxNiw1Ljk5NTMxODUxIDUuMTExMzE4OTksNi4xNDMzNDI4MSA1LjAwODQxOTA4LDYuMjQxNDMxMiBMNC42Mjk1NjAzNCw2LjYwMjU3NDgyIEM0LjUyNjY2MDQzLDYuNzAwNjYzMjEgNC40MDU5ODY5LDYuNzAwNjYzMjEgNC4zMDIxNTE1NCw2LjYxODYyNTY1IEwyLjA2NDU0NjMsNC40ODU2NDkgQzEuOTc4NDg0NTcsNC40MDM2MTE0NCAxLjk3ODQ4NDU3LDQuMjcyNTI5NjggMi4wNjQ1NDYzLDQuMTkwNDkyMTEgTDQuMjg1MzEzMzgsMi4wNzM1NjYyOSBDNC4zODgyMTMyOCwxLjk3NTQ3NzkgNC41NjAzMzY3NiwxLjk3NTQ3NzkgNC42NDYzOTg1LDIuMDczNTY2MjkgTDUuMDA3NDgzNjMsMi40MTc3NjczNyBDNS4xMTAzODM1NCwyLjUxNTg1NTc3IDUuMTEwMzgzNTQsMi42Nzk5MzA4OSA1LjAwNzQ4MzYzLDIuNzYxOTY4NDYgTDQuMTYzNzA0NCwzLjU2NjI5MzI2IEM0LjA2MDgwNDQ5LDMuNjY0MzgxNjUgNC4wNjA4MDQ0OSwzLjc3OTQxMjU4IDQuMjMyOTI3OTcsMy43Nzk0MTI1OCBMNC4zNTM2MDE1LDMuNzc5NDEyNTggTDYuNzQ2NDkyMDUsMy43OTYzNTUxMiBaIiBmaWxsPSIjNkU2RTZFIiBmaWxsLXJ1bGU9Im5vbnplcm8iIHRyYW5zZm9ybT0idHJhbnNsYXRlKDYuMDAwMDAwLCA2LjAwMDAwMCkgc2NhbGUoLTEsIDEpIHRyYW5zbGF0ZSgtNi4wMDAwMDAsIC02LjAwMDAwMCkgIj48L3BhdGg+CiAgICA8L2c+Cjwvc3ZnPg==":"data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz4KPHN2ZyB3aWR0aD0iMTJweCIgaGVpZ2h0PSIxMnB4IiB2aWV3Qm94PSIwIDAgMTIgMTIiIHZlcnNpb249IjEuMSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB4bWxuczp4bGluaz0iaHR0cDovL3d3dy53My5vcmcvMTk5OS94bGluayI+CiAgICA8IS0tIEdlbmVyYXRvcjogU2tldGNoIDU1ICg3ODA3NikgLSBodHRwczovL3NrZXRjaGFwcC5jb20gLS0+CiAgICA8dGl0bGU+cmVkbzwvdGl0bGU+CiAgICA8ZGVzYz5DcmVhdGVkIHdpdGggU2tldGNoLjwvZGVzYz4KICAgIDxnIGlkPSJyZWRvIiBzdHJva2U9Im5vbmUiIHN0cm9rZS13aWR0aD0iMSIgZmlsbD0ibm9uZSIgZmlsbC1ydWxlPSJldmVub2RkIj4KICAgICAgICA8cGF0aCBkPSJNNi43NDY0OTIwNSwzLjc5NjM1NTEyIEM4LjUzNjk1MDQyLDMuNzk2MzU1MTIgMTAsNS4xNzQ5NDI4NyAxMCw2Ljg5NzczMTcxIEMxMCw4LjYyMDUyMDU0IDguNTM2OTUwNDIsMTAgNi43NDY0OTIwNSwxMCBMNS4zMzQ4OTI0MiwxMCBDNS4xOTczODA3MywxMCA1LjExMTMxODk5LDkuOTAxOTExNjEgNS4xMTEzMTg5OSw5Ljc2OTkzODE0IEw1LjExMTMxODk5LDkuMjQ0NzE5MzkgQzUuMTExMzE4OTksOS4xMTM2Mzc2MyA1LjIxNDIxODksOC45OTg2MDY3IDUuMzUyNjY2MDQsOC45OTg2MDY3IEw2Ljc0NzQyNzUsOC45OTg2MDY3IEM3Ljk3MDA2NTQ4LDguOTk4NjA2NyA4Ljk1MTM1NjQxLDguMDYzMjAwMTMgOC45NTEzNTY0MSw2Ljg5NzczMTcxIEM4Ljk1MTM1NjQxLDUuNzMyMjYzMjggNy45NjkxMzAwMyw0Ljc5Nzc0ODQzIDYuNzQ2NDkyMDUsNC43OTc3NDg0MyBMNC4zNTM2MDE1LDQuNzk3NzQ4NDMgQzQuMzUzNjAxNSw0Ljc5Nzc0ODQzIDQuMjE2MDg5OCw0Ljc5Nzc0ODQzIDQuMTY0NjM5ODUsNC44MTM3OTkyNSBDNC4wMjcxMjgxNiw0Ljg3OTc4NTk5IDQuMDYxNzM5OTQsNC45Nzc4NzQzOCA0LjE4MTQ3ODAyLDUuMDkyOTA1MzEgTDUuMDI1MjU3MjUsNS44OTcyMzAxMiBDNS4xMjgxNTcxNiw1Ljk5NTMxODUxIDUuMTExMzE4OTksNi4xNDMzNDI4MSA1LjAwODQxOTA4LDYuMjQxNDMxMiBMNC42Mjk1NjAzNCw2LjYwMjU3NDgyIEM0LjUyNjY2MDQzLDYuNzAwNjYzMjEgNC40MDU5ODY5LDYuNzAwNjYzMjEgNC4zMDIxNTE1NCw2LjYxODYyNTY1IEwyLjA2NDU0NjMsNC40ODU2NDkgQzEuOTc4NDg0NTcsNC40MDM2MTE0NCAxLjk3ODQ4NDU3LDQuMjcyNTI5NjggMi4wNjQ1NDYzLDQuMTkwNDkyMTEgTDQuMjg1MzEzMzgsMi4wNzM1NjYyOSBDNC4zODgyMTMyOCwxLjk3NTQ3NzkgNC41NjAzMzY3NiwxLjk3NTQ3NzkgNC42NDYzOTg1LDIuMDczNTY2MjkgTDUuMDA3NDgzNjMsMi40MTc3NjczNyBDNS4xMTAzODM1NCwyLjUxNTg1NTc3IDUuMTEwMzgzNTQsMi42Nzk5MzA4OSA1LjAwNzQ4MzYzLDIuNzYxOTY4NDYgTDQuMTYzNzA0NCwzLjU2NjI5MzI2IEM0LjA2MDgwNDQ5LDMuNjY0MzgxNjUgNC4wNjA4MDQ0OSwzLjc3OTQxMjU4IDQuMjMyOTI3OTcsMy43Nzk0MTI1OCBMNC4zNTM2MDE1LDMuNzc5NDEyNTggTDYuNzQ2NDkyMDUsMy43OTYzNTUxMiBaIiBmaWxsPSIjQ0FDQUNBIiBmaWxsLXJ1bGU9Im5vbnplcm8iIHRyYW5zZm9ybT0idHJhbnNsYXRlKDYuMDAwMDAwLCA2LjAwMDAwMCkgc2NhbGUoLTEsIDEpIHRyYW5zbGF0ZSgtNi4wMDAwMDAsIC02LjAwMDAwMCkgIj48L3BhdGg+CiAgICA8L2c+Cjwvc3ZnPg==";break;case C.ButtonImageType.undo:e=r?"data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz4KPHN2ZyB3aWR0aD0iMTJweCIgaGVpZ2h0PSIxMnB4IiB2aWV3Qm94PSIwIDAgMTIgMTIiIHZlcnNpb249IjEuMSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB4bWxuczp4bGluaz0iaHR0cDovL3d3dy53My5vcmcvMTk5OS94bGluayI+CiAgICA8IS0tIEdlbmVyYXRvcjogU2tldGNoIDU1ICg3ODA3NikgLSBodHRwczovL3NrZXRjaGFwcC5jb20gLS0+CiAgICA8dGl0bGU+dW5kbzwvdGl0bGU+CiAgICA8ZGVzYz5DcmVhdGVkIHdpdGggU2tldGNoLjwvZGVzYz4KICAgIDxnIGlkPSJ1bmRvIiBzdHJva2U9Im5vbmUiIHN0cm9rZS13aWR0aD0iMSIgZmlsbD0ibm9uZSIgZmlsbC1ydWxlPSJldmVub2RkIj4KICAgICAgICA8cGF0aCBkPSJNNi43NDY0OTIwNSwzLjc5NjM1NTEyIEM4LjUzNjk1MDQyLDMuNzk2MzU1MTIgMTAsNS4xNzQ5NDI4NyAxMCw2Ljg5NzczMTcxIEMxMCw4LjYyMDUyMDU0IDguNTM2OTUwNDIsMTAgNi43NDY0OTIwNSwxMCBMNS4zMzQ4OTI0MiwxMCBDNS4xOTczODA3MywxMCA1LjExMTMxODk5LDkuOTAxOTExNjEgNS4xMTEzMTg5OSw5Ljc2OTkzODE0IEw1LjExMTMxODk5LDkuMjQ0NzE5MzkgQzUuMTExMzE4OTksOS4xMTM2Mzc2MyA1LjIxNDIxODksOC45OTg2MDY3IDUuMzUyNjY2MDQsOC45OTg2MDY3IEw2Ljc0NzQyNzUsOC45OTg2MDY3IEM3Ljk3MDA2NTQ4LDguOTk4NjA2NyA4Ljk1MTM1NjQxLDguMDYzMjAwMTMgOC45NTEzNTY0MSw2Ljg5NzczMTcxIEM4Ljk1MTM1NjQxLDUuNzMyMjYzMjggNy45NjkxMzAwMyw0Ljc5Nzc0ODQzIDYuNzQ2NDkyMDUsNC43OTc3NDg0MyBMNC4zNTM2MDE1LDQuNzk3NzQ4NDMgQzQuMzUzNjAxNSw0Ljc5Nzc0ODQzIDQuMjE2MDg5OCw0Ljc5Nzc0ODQzIDQuMTY0NjM5ODUsNC44MTM3OTkyNSBDNC4wMjcxMjgxNiw0Ljg3OTc4NTk5IDQuMDYxNzM5OTQsNC45Nzc4NzQzOCA0LjE4MTQ3ODAyLDUuMDkyOTA1MzEgTDUuMDI1MjU3MjUsNS44OTcyMzAxMiBDNS4xMjgxNTcxNiw1Ljk5NTMxODUxIDUuMTExMzE4OTksNi4xNDMzNDI4MSA1LjAwODQxOTA4LDYuMjQxNDMxMiBMNC42Mjk1NjAzNCw2LjYwMjU3NDgyIEM0LjUyNjY2MDQzLDYuNzAwNjYzMjEgNC40MDU5ODY5LDYuNzAwNjYzMjEgNC4zMDIxNTE1NCw2LjYxODYyNTY1IEwyLjA2NDU0NjMsNC40ODU2NDkgQzEuOTc4NDg0NTcsNC40MDM2MTE0NCAxLjk3ODQ4NDU3LDQuMjcyNTI5NjggMi4wNjQ1NDYzLDQuMTkwNDkyMTEgTDQuMjg1MzEzMzgsMi4wNzM1NjYyOSBDNC4zODgyMTMyOCwxLjk3NTQ3NzkgNC41NjAzMzY3NiwxLjk3NTQ3NzkgNC42NDYzOTg1LDIuMDczNTY2MjkgTDUuMDA3NDgzNjMsMi40MTc3NjczNyBDNS4xMTAzODM1NCwyLjUxNTg1NTc3IDUuMTEwMzgzNTQsMi42Nzk5MzA4OSA1LjAwNzQ4MzYzLDIuNzYxOTY4NDYgTDQuMTYzNzA0NCwzLjU2NjI5MzI2IEM0LjA2MDgwNDQ5LDMuNjY0MzgxNjUgNC4wNjA4MDQ0OSwzLjc3OTQxMjU4IDQuMjMyOTI3OTcsMy43Nzk0MTI1OCBMNC4zNTM2MDE1LDMuNzc5NDEyNTggTDYuNzQ2NDkyMDUsMy43OTYzNTUxMiBaIiBmaWxsPSIjNkU2RTZFIiBmaWxsLXJ1bGU9Im5vbnplcm8iPjwvcGF0aD4KICAgIDwvZz4KPC9zdmc+":"data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz4KPHN2ZyB3aWR0aD0iMTJweCIgaGVpZ2h0PSIxMnB4IiB2aWV3Qm94PSIwIDAgMTIgMTIiIHZlcnNpb249IjEuMSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB4bWxuczp4bGluaz0iaHR0cDovL3d3dy53My5vcmcvMTk5OS94bGluayI+CiAgICA8IS0tIEdlbmVyYXRvcjogU2tldGNoIDU1ICg3ODA3NikgLSBodHRwczovL3NrZXRjaGFwcC5jb20gLS0+CiAgICA8dGl0bGU+dW5kbzwvdGl0bGU+CiAgICA8ZGVzYz5DcmVhdGVkIHdpdGggU2tldGNoLjwvZGVzYz4KICAgIDxnIGlkPSJ1bmRvIiBzdHJva2U9Im5vbmUiIHN0cm9rZS13aWR0aD0iMSIgZmlsbD0ibm9uZSIgZmlsbC1ydWxlPSJldmVub2RkIj4KICAgICAgICA8cGF0aCBkPSJNNi43NDY0OTIwNSwzLjc5NjM1NTEyIEM4LjUzNjk1MDQyLDMuNzk2MzU1MTIgMTAsNS4xNzQ5NDI4NyAxMCw2Ljg5NzczMTcxIEMxMCw4LjYyMDUyMDU0IDguNTM2OTUwNDIsMTAgNi43NDY0OTIwNSwxMCBMNS4zMzQ4OTI0MiwxMCBDNS4xOTczODA3MywxMCA1LjExMTMxODk5LDkuOTAxOTExNjEgNS4xMTEzMTg5OSw5Ljc2OTkzODE0IEw1LjExMTMxODk5LDkuMjQ0NzE5MzkgQzUuMTExMzE4OTksOS4xMTM2Mzc2MyA1LjIxNDIxODksOC45OTg2MDY3IDUuMzUyNjY2MDQsOC45OTg2MDY3IEw2Ljc0NzQyNzUsOC45OTg2MDY3IEM3Ljk3MDA2NTQ4LDguOTk4NjA2NyA4Ljk1MTM1NjQxLDguMDYzMjAwMTMgOC45NTEzNTY0MSw2Ljg5NzczMTcxIEM4Ljk1MTM1NjQxLDUuNzMyMjYzMjggNy45NjkxMzAwMyw0Ljc5Nzc0ODQzIDYuNzQ2NDkyMDUsNC43OTc3NDg0MyBMNC4zNTM2MDE1LDQuNzk3NzQ4NDMgQzQuMzUzNjAxNSw0Ljc5Nzc0ODQzIDQuMjE2MDg5OCw0Ljc5Nzc0ODQzIDQuMTY0NjM5ODUsNC44MTM3OTkyNSBDNC4wMjcxMjgxNiw0Ljg3OTc4NTk5IDQuMDYxNzM5OTQsNC45Nzc4NzQzOCA0LjE4MTQ3ODAyLDUuMDkyOTA1MzEgTDUuMDI1MjU3MjUsNS44OTcyMzAxMiBDNS4xMjgxNTcxNiw1Ljk5NTMxODUxIDUuMTExMzE4OTksNi4xNDMzNDI4MSA1LjAwODQxOTA4LDYuMjQxNDMxMiBMNC42Mjk1NjAzNCw2LjYwMjU3NDgyIEM0LjUyNjY2MDQzLDYuNzAwNjYzMjEgNC40MDU5ODY5LDYuNzAwNjYzMjEgNC4zMDIxNTE1NCw2LjYxODYyNTY1IEwyLjA2NDU0NjMsNC40ODU2NDkgQzEuOTc4NDg0NTcsNC40MDM2MTE0NCAxLjk3ODQ4NDU3LDQuMjcyNTI5NjggMi4wNjQ1NDYzLDQuMTkwNDkyMTEgTDQuMjg1MzEzMzgsMi4wNzM1NjYyOSBDNC4zODgyMTMyOCwxLjk3NTQ3NzkgNC41NjAzMzY3NiwxLjk3NTQ3NzkgNC42NDYzOTg1LDIuMDczNTY2MjkgTDUuMDA3NDgzNjMsMi40MTc3NjczNyBDNS4xMTAzODM1NCwyLjUxNTg1NTc3IDUuMTEwMzgzNTQsMi42Nzk5MzA4OSA1LjAwNzQ4MzYzLDIuNzYxOTY4NDYgTDQuMTYzNzA0NCwzLjU2NjI5MzI2IEM0LjA2MDgwNDQ5LDMuNjY0MzgxNjUgNC4wNjA4MDQ0OSwzLjc3OTQxMjU4IDQuMjMyOTI3OTcsMy43Nzk0MTI1OCBMNC4zNTM2MDE1LDMuNzc5NDEyNTggTDYuNzQ2NDkyMDUsMy43OTYzNTUxMiBaIiBmaWxsPSIjQ0FDQUNBIiBmaWxsLXJ1bGU9Im5vbnplcm8iPjwvcGF0aD4KICAgIDwvZz4KPC9zdmc+";break;case C.ButtonImageType.search:e=r?"data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz4KPHN2ZyB3aWR0aD0iMTJweCIgaGVpZ2h0PSIxMnB4IiB2aWV3Qm94PSIwIDAgMTIgMTIiIHZlcnNpb249IjEuMSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB4bWxuczp4bGluaz0iaHR0cDovL3d3dy53My5vcmcvMTk5OS94bGluayI+CiAgICA8IS0tIEdlbmVyYXRvcjogU2tldGNoIDU1ICg3ODA3NikgLSBodHRwczovL3NrZXRjaGFwcC5jb20gLS0+CiAgICA8dGl0bGU+c2VhcmNoPC90aXRsZT4KICAgIDxkZXNjPkNyZWF0ZWQgd2l0aCBTa2V0Y2guPC9kZXNjPgogICAgPGcgaWQ9InNlYXJjaCIgc3Ryb2tlPSJub25lIiBzdHJva2Utd2lkdGg9IjEiIGZpbGw9Im5vbmUiIGZpbGwtcnVsZT0iZXZlbm9kZCI+CiAgICAgICAgPHBhdGggZD0iTTcuNDQ1MzczOTYsNi43MzgyNjcxOCBMMTAuMDM1NTMzOSw5LjMyODQyNzEyIEw5LjMyODQyNzEyLDEwLjAzNTUzMzkgTDYuNzM4MjY3MTgsNy40NDUzNzM5NiBDNi4yNDc4NTc3NCw3Ljc5NDYwNDUyIDUuNjQ3OTE1MjIsOCA1LDggQzMuMzQzMTQ1NzUsOCAyLDYuNjU2ODU0MjUgMiw1IEMyLDMuMzQzMTQ1NzUgMy4zNDMxNDU3NSwyIDUsMiBDNi42NTY4NTQyNSwyIDgsMy4zNDMxNDU3NSA4LDUgQzgsNS42NDc5MTUyMiA3Ljc5NDYwNDUyLDYuMjQ3ODU3NzQgNy40NDUzNzM5Niw2LjczODI2NzE4IFogTTUuMDAwNTI2MTYsMyBDMy44OTYyNTEzMSwzIDMuMDAxMDUyNDgsMy44OTU0MzQ1NiAzLDUgQzMuMDAxMTYyODYsNi4xMDM2NzQ4NCAzLjg5NTAyNzk5LDYuOTk4MjUxNzQgNS4wMDA1MjYxNiw3IEM2LjEwNDgwMTAxLDcgNi45OTk5OTk4Myw2LjEwNDU2NTQ0IDcsNSBDNywzLjg5NTQzNDU2IDYuMTA0ODAxMDEsMy4wMDAwMDAxNyA1LjAwMDUyNjE2LDMgWiIgZmlsbD0iIzZFNkU2RSIgZmlsbC1ydWxlPSJub256ZXJvIj48L3BhdGg+CiAgICA8L2c+Cjwvc3ZnPg==":"data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz4KPHN2ZyB3aWR0aD0iMTJweCIgaGVpZ2h0PSIxMnB4IiB2aWV3Qm94PSIwIDAgMTIgMTIiIHZlcnNpb249IjEuMSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB4bWxuczp4bGluaz0iaHR0cDovL3d3dy53My5vcmcvMTk5OS94bGluayI+CiAgICA8IS0tIEdlbmVyYXRvcjogU2tldGNoIDU1ICg3ODA3NikgLSBodHRwczovL3NrZXRjaGFwcC5jb20gLS0+CiAgICA8dGl0bGU+c2VhcmNoPC90aXRsZT4KICAgIDxkZXNjPkNyZWF0ZWQgd2l0aCBTa2V0Y2guPC9kZXNjPgogICAgPGcgaWQ9InNlYXJjaCIgc3Ryb2tlPSJub25lIiBzdHJva2Utd2lkdGg9IjEiIGZpbGw9Im5vbmUiIGZpbGwtcnVsZT0iZXZlbm9kZCI+CiAgICAgICAgPHBhdGggZD0iTTcuNDQ1MzczOTYsNi43MzgyNjcxOCBMMTAuMDM1NTMzOSw5LjMyODQyNzEyIEw5LjMyODQyNzEyLDEwLjAzNTUzMzkgTDYuNzM4MjY3MTgsNy40NDUzNzM5NiBDNi4yNDc4NTc3NCw3Ljc5NDYwNDUyIDUuNjQ3OTE1MjIsOCA1LDggQzMuMzQzMTQ1NzUsOCAyLDYuNjU2ODU0MjUgMiw1IEMyLDMuMzQzMTQ1NzUgMy4zNDMxNDU3NSwyIDUsMiBDNi42NTY4NTQyNSwyIDgsMy4zNDMxNDU3NSA4LDUgQzgsNS42NDc5MTUyMiA3Ljc5NDYwNDUyLDYuMjQ3ODU3NzQgNy40NDUzNzM5Niw2LjczODI2NzE4IFogTTUuMDAwNTI2MTYsMyBDMy44OTYyNTEzMSwzIDMuMDAxMDUyNDgsMy44OTU0MzQ1NiAzLDUgQzMuMDAxMTYyODYsNi4xMDM2NzQ4NCAzLjg5NTAyNzk5LDYuOTk4MjUxNzQgNS4wMDA1MjYxNiw3IEM2LjEwNDgwMTAxLDcgNi45OTk5OTk4Myw2LjEwNDU2NTQ0IDcsNSBDNywzLjg5NTQzNDU2IDYuMTA0ODAxMDEsMy4wMDAwMDAxNyA1LjAwMDUyNjE2LDMgWiIgZmlsbD0iI0NBQ0FDQSIgZmlsbC1ydWxlPSJub256ZXJvIj48L3BhdGg+CiAgICA8L2c+Cjwvc3ZnPg==";break;case C.ButtonImageType.separator:e=r?"data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz4KPHN2ZyB3aWR0aD0iMTJweCIgaGVpZ2h0PSIxMnB4IiB2aWV3Qm94PSIwIDAgMTIgMTIiIHZlcnNpb249IjEuMSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB4bWxuczp4bGluaz0iaHR0cDovL3d3dy53My5vcmcvMTk5OS94bGluayI+CiAgICA8IS0tIEdlbmVyYXRvcjogU2tldGNoIDU1ICg3ODA3NikgLSBodHRwczovL3NrZXRjaGFwcC5jb20gLS0+CiAgICA8dGl0bGU+c2VwYXJhdG9yPC90aXRsZT4KICAgIDxkZXNjPkNyZWF0ZWQgd2l0aCBTa2V0Y2guPC9kZXNjPgogICAgPGcgaWQ9InNlcGFyYXRvciIgc3Ryb2tlPSJub25lIiBzdHJva2Utd2lkdGg9IjEiIGZpbGw9Im5vbmUiIGZpbGwtcnVsZT0iZXZlbm9kZCI+CiAgICAgICAgPHBhdGggZD0iTTExLDQgTDEwLDQgTDEwLDggTDExLDggTDExLDkgTDksOSBMOSwzIEwxMSwzIEwxMSw0IFogTTIsNCBMMiwzIEw0LDMgTDQsOSBMMiw5IEwyLDggTDMsOCBMMyw0IEwyLDQgWiBNNiwxIEw3LDEgTDcsMTEgTDYsMTEgTDYsMSBaIiBpZD0i5b2i54q257uT5ZCIIiBmaWxsPSIjNkU2RTZFIj48L3BhdGg+CiAgICA8L2c+Cjwvc3ZnPg==":"data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz4KPHN2ZyB3aWR0aD0iMTJweCIgaGVpZ2h0PSIxMnB4IiB2aWV3Qm94PSIwIDAgMTIgMTIiIHZlcnNpb249IjEuMSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB4bWxuczp4bGluaz0iaHR0cDovL3d3dy53My5vcmcvMTk5OS94bGluayI+CiAgICA8IS0tIEdlbmVyYXRvcjogU2tldGNoIDU1ICg3ODA3NikgLSBodHRwczovL3NrZXRjaGFwcC5jb20gLS0+CiAgICA8dGl0bGU+c2VwYXJhdG9yPC90aXRsZT4KICAgIDxkZXNjPkNyZWF0ZWQgd2l0aCBTa2V0Y2guPC9kZXNjPgogICAgPGcgaWQ9InNlcGFyYXRvciIgc3Ryb2tlPSJub25lIiBzdHJva2Utd2lkdGg9IjEiIGZpbGw9Im5vbmUiIGZpbGwtcnVsZT0iZXZlbm9kZCI+CiAgICAgICAgPHBhdGggZD0iTTExLDQgTDEwLDQgTDEwLDggTDExLDggTDExLDkgTDksOSBMOSwzIEwxMSwzIEwxMSw0IFogTTIsNCBMMiwzIEw0LDMgTDQsOSBMMiw5IEwyLDggTDMsOCBMMyw0IEwyLDQgWiBNNiwxIEw3LDEgTDcsMTEgTDYsMTEgTDYsMSBaIiBpZD0i5b2i54q257uT5ZCIIiBmaWxsPSIjQ0FDQUNBIj48L3BhdGg+CiAgICA8L2c+Cjwvc3ZnPg==";break;case C.ButtonImageType.spinLeft:e=r?"data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz4KPHN2ZyB3aWR0aD0iMTJweCIgaGVpZ2h0PSIxMnB4IiB2aWV3Qm94PSIwIDAgMTIgMTIiIHZlcnNpb249IjEuMSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB4bWxuczp4bGluaz0iaHR0cDovL3d3dy53My5vcmcvMTk5OS94bGluayI+CiAgICA8IS0tIEdlbmVyYXRvcjogU2tldGNoIDU1ICg3ODA3NikgLSBodHRwczovL3NrZXRjaGFwcC5jb20gLS0+CiAgICA8dGl0bGU+c3BpbmxlZnQ8L3RpdGxlPgogICAgPGRlc2M+Q3JlYXRlZCB3aXRoIFNrZXRjaC48L2Rlc2M+CiAgICA8ZyBpZD0ic3BpbmxlZnQiIHN0cm9rZT0ibm9uZSIgc3Ryb2tlLXdpZHRoPSIxIiBmaWxsPSJub25lIiBmaWxsLXJ1bGU9ImV2ZW5vZGQiPgogICAgICAgIDxwb2x5Z29uIGZpbGw9IiM2RTZFNkUiIHBvaW50cz0iOCAzIDQgNi41IDggMTAiPjwvcG9seWdvbj4KICAgIDwvZz4KPC9zdmc+":"data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz4KPHN2ZyB3aWR0aD0iMTJweCIgaGVpZ2h0PSIxMnB4IiB2aWV3Qm94PSIwIDAgMTIgMTIiIHZlcnNpb249IjEuMSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB4bWxuczp4bGluaz0iaHR0cDovL3d3dy53My5vcmcvMTk5OS94bGluayI+CiAgICA8IS0tIEdlbmVyYXRvcjogU2tldGNoIDU1ICg3ODA3NikgLSBodHRwczovL3NrZXRjaGFwcC5jb20gLS0+CiAgICA8dGl0bGU+c3BpbmxlZnQ8L3RpdGxlPgogICAgPGRlc2M+Q3JlYXRlZCB3aXRoIFNrZXRjaC48L2Rlc2M+CiAgICA8ZyBpZD0ic3BpbmxlZnQiIHN0cm9rZT0ibm9uZSIgc3Ryb2tlLXdpZHRoPSIxIiBmaWxsPSJub25lIiBmaWxsLXJ1bGU9ImV2ZW5vZGQiPgogICAgICAgIDxwb2x5Z29uIGZpbGw9IiNDQUNBQ0EiIHBvaW50cz0iOCAzIDQgNi41IDggMTAiPjwvcG9seWdvbj4KICAgIDwvZz4KPC9zdmc+";break;case C.ButtonImageType.spinRight:e=r?"data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz4KPHN2ZyB3aWR0aD0iMTJweCIgaGVpZ2h0PSIxMnB4IiB2aWV3Qm94PSIwIDAgMTIgMTIiIHZlcnNpb249IjEuMSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB4bWxuczp4bGluaz0iaHR0cDovL3d3dy53My5vcmcvMTk5OS94bGluayI+CiAgICA8IS0tIEdlbmVyYXRvcjogU2tldGNoIDU1ICg3ODA3NikgLSBodHRwczovL3NrZXRjaGFwcC5jb20gLS0+CiAgICA8dGl0bGU+c3BpbnJpZ2h0PC90aXRsZT4KICAgIDxkZXNjPkNyZWF0ZWQgd2l0aCBTa2V0Y2guPC9kZXNjPgogICAgPGcgaWQ9InNwaW5yaWdodCIgc3Ryb2tlPSJub25lIiBzdHJva2Utd2lkdGg9IjEiIGZpbGw9Im5vbmUiIGZpbGwtcnVsZT0iZXZlbm9kZCI+CiAgICAgICAgPHBvbHlnb24gZmlsbD0iIzZFNkU2RSIgcG9pbnRzPSI0IDMgOCA2LjUgNCAxMCI+PC9wb2x5Z29uPgogICAgPC9nPgo8L3N2Zz4=":"data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz4KPHN2ZyB3aWR0aD0iMTJweCIgaGVpZ2h0PSIxMnB4IiB2aWV3Qm94PSIwIDAgMTIgMTIiIHZlcnNpb249IjEuMSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB4bWxuczp4bGluaz0iaHR0cDovL3d3dy53My5vcmcvMTk5OS94bGluayI+CiAgICA8IS0tIEdlbmVyYXRvcjogU2tldGNoIDU1ICg3ODA3NikgLSBodHRwczovL3NrZXRjaGFwcC5jb20gLS0+CiAgICA8dGl0bGU+c3BpbnJpZ2h0PC90aXRsZT4KICAgIDxkZXNjPkNyZWF0ZWQgd2l0aCBTa2V0Y2guPC9kZXNjPgogICAgPGcgaWQ9InNwaW5yaWdodCIgc3Ryb2tlPSJub25lIiBzdHJva2Utd2lkdGg9IjEiIGZpbGw9Im5vbmUiIGZpbGwtcnVsZT0iZXZlbm9kZCI+CiAgICAgICAgPHBvbHlnb24gZmlsbD0iI0NBQ0FDQSIgcG9pbnRzPSI0IDMgOCA2LjUgNCAxMCI+PC9wb2x5Z29uPgogICAgPC9nPgo8L3N2Zz4=";break;case C.ButtonImageType.ellipsis:e=r?"data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz4KPHN2ZyB3aWR0aD0iMTJweCIgaGVpZ2h0PSIxMnB4IiB2aWV3Qm94PSIwIDAgMTIgMTIiIHZlcnNpb249IjEuMSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB4bWxuczp4bGluaz0iaHR0cDovL3d3dy53My5vcmcvMTk5OS94bGluayI+CiAgICA8IS0tIEdlbmVyYXRvcjogU2tldGNoIDU1ICg3ODA3NikgLSBodHRwczovL3NrZXRjaGFwcC5jb20gLS0+CiAgICA8dGl0bGU+ZWxsaXBzaXM8L3RpdGxlPgogICAgPGRlc2M+Q3JlYXRlZCB3aXRoIFNrZXRjaC48L2Rlc2M+CiAgICA8ZyBpZD0iZWxsaXBzaXMiIHN0cm9rZT0ibm9uZSIgc3Ryb2tlLXdpZHRoPSIxIiBmaWxsPSJub25lIiBmaWxsLXJ1bGU9ImV2ZW5vZGQiPgogICAgICAgIDxwYXRoIGQ9Ik0yLDcgQzEuNDQ3NzE1MjUsNyAxLDYuNTUyMjg0NzUgMSw2IEMxLDUuNDQ3NzE1MjUgMS40NDc3MTUyNSw1IDIsNSBDMi41NTIyODQ3NSw1IDMsNS40NDc3MTUyNSAzLDYgQzMsNi41NTIyODQ3NSAyLjU1MjI4NDc1LDcgMiw3IFogTTYsNyBDNS40NDc3MTUyNSw3IDUsNi41NTIyODQ3NSA1LDYgQzUsNS40NDc3MTUyNSA1LjQ0NzcxNTI1LDUgNiw1IEM2LjU1MjI4NDc1LDUgNyw1LjQ0NzcxNTI1IDcsNiBDNyw2LjU1MjI4NDc1IDYuNTUyMjg0NzUsNyA2LDcgWiBNMTAsNyBDOS40NDc3MTUyNSw3IDksNi41NTIyODQ3NSA5LDYgQzksNS40NDc3MTUyNSA5LjQ0NzcxNTI1LDUgMTAsNSBDMTAuNTUyMjg0Nyw1IDExLDUuNDQ3NzE1MjUgMTEsNiBDMTEsNi41NTIyODQ3NSAxMC41NTIyODQ3LDcgMTAsNyBaIiBmaWxsPSIjNkU2RTZFIj48L3BhdGg+CiAgICA8L2c+Cjwvc3ZnPg==":"data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz4KPHN2ZyB3aWR0aD0iMTJweCIgaGVpZ2h0PSIxMnB4IiB2aWV3Qm94PSIwIDAgMTIgMTIiIHZlcnNpb249IjEuMSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB4bWxuczp4bGluaz0iaHR0cDovL3d3dy53My5vcmcvMTk5OS94bGluayI+CiAgICA8IS0tIEdlbmVyYXRvcjogU2tldGNoIDU1ICg3ODA3NikgLSBodHRwczovL3NrZXRjaGFwcC5jb20gLS0+CiAgICA8dGl0bGU+ZWxsaXBzaXM8L3RpdGxlPgogICAgPGRlc2M+Q3JlYXRlZCB3aXRoIFNrZXRjaC48L2Rlc2M+CiAgICA8ZyBpZD0iZWxsaXBzaXMiIHN0cm9rZT0ibm9uZSIgc3Ryb2tlLXdpZHRoPSIxIiBmaWxsPSJub25lIiBmaWxsLXJ1bGU9ImV2ZW5vZGQiPgogICAgICAgIDxwYXRoIGQ9Ik0yLDcgQzEuNDQ3NzE1MjUsNyAxLDYuNTUyMjg0NzUgMSw2IEMxLDUuNDQ3NzE1MjUgMS40NDc3MTUyNSw1IDIsNSBDMi41NTIyODQ3NSw1IDMsNS40NDc3MTUyNSAzLDYgQzMsNi41NTIyODQ3NSAyLjU1MjI4NDc1LDcgMiw3IFogTTYsNyBDNS40NDc3MTUyNSw3IDUsNi41NTIyODQ3NSA1LDYgQzUsNS40NDc3MTUyNSA1LjQ0NzcxNTI1LDUgNiw1IEM2LjU1MjI4NDc1LDUgNyw1LjQ0NzcxNTI1IDcsNiBDNyw2LjU1MjI4NDc1IDYuNTUyMjg0NzUsNyA2LDcgWiBNMTAsNyBDOS40NDc3MTUyNSw3IDksNi41NTIyODQ3NSA5LDYgQzksNS40NDc3MTUyNSA5LjQ0NzcxNTI1LDUgMTAsNSBDMTAuNTUyMjg0Nyw1IDExLDUuNDQ3NzE1MjUgMTEsNiBDMTEsNi41NTIyODQ3NSAxMC41NTIyODQ3LDcgMTAsNyBaIiBmaWxsPSIjQ0FDQUNBIj48L3BhdGg+CiAgICA8L2c+Cjwvc3ZnPg==";break;case C.ButtonImageType.expand:e=r?"data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIGlkPSJjb2xsYXBzZSIgd2lkdGg9IjEycHgiIGhlaWdodD0iMTJweCI+CiAgICAgICAgPHJlY3QgeD0iMCIgeT0iMCIgd2lkdGg9IjEycHgiIGhlaWdodD0iMTJweCIgcng9IjRweCIgcnk9IjRweCIgc3R5bGU9InN0cm9rZTogIzZlNmU2ZTsgc3Ryb2tlLXdpZHRoOjFweDsgZmlsbDogbm9uZTsiLz4KICAgICAgICA8bGluZSB4MT0iMnB4IiB5MT0iNnB4IiB4Mj0iMTBweCIgeTI9IjZweCIgc3R5bGU9InN0cm9rZTogIzZlNmU2ZTsgc3Ryb2tlLXdpZHRoOjFweDsiLz4KICAgIDwvc3ZnPg==":"data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIGlkPSJjb2xsYXBzZSIgd2lkdGg9IjEycHgiIGhlaWdodD0iMTJweCI+CiAgICAgICAgPHJlY3QgeD0iMCIgeT0iMCIgd2lkdGg9IjEycHgiIGhlaWdodD0iMTJweCIgcng9IjRweCIgcnk9IjRweCIgc3R5bGU9InN0cm9rZTogI2NhY2FjYTsgc3Ryb2tlLXdpZHRoOjFweDsgZmlsbDogbm9uZTsiLz4KICAgICAgICA8bGluZSB4MT0iMnB4IiB5MT0iNnB4IiB4Mj0iMTBweCIgeTI9IjZweCIgc3R5bGU9InN0cm9rZTogI2NhY2FjYTsgc3Ryb2tlLXdpZHRoOjFweDsiLz4KICAgIDwvc3ZnPg==";break;case C.ButtonImageType.collapse:e=r?"data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIGlkPSJleHBhbmQiIHdpZHRoPSIxMnB4IiBoZWlnaHQ9IjEycHgiPgogICAgICAgIDxyZWN0IHg9IjAiIHk9IjAiIHdpZHRoPSIxMnB4IiBoZWlnaHQ9IjEycHgiIHJ4PSI0cHgiIHJ5PSI0cHgiIHN0eWxlPSJzdHJva2U6ICM2ZTZlNmU7IHN0cm9rZS13aWR0aDoxcHg7IGZpbGw6IG5vbmU7Ii8+CiAgICAgICAgPGxpbmUgeDE9IjJweCIgeTE9IjZweCIgeDI9IjEwcHgiIHkyPSI2cHgiIHN0eWxlPSJzdHJva2U6ICM2ZTZlNmU7IHN0cm9rZS13aWR0aDoxcHg7Ii8+CiAgICAgICAgPGxpbmUgeDE9IjZweCIgeTE9IjJweCIgeDI9IjZweCIgeTI9IjEwcHgiIHN0eWxlPSJzdHJva2U6ICM2ZTZlNmU7IHN0cm9rZS13aWR0aDoxcHg7Ii8+CiAgICA8L3N2Zz4=":"data:image/svg+xml;PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIGlkPSJleHBhbmQiIHdpZHRoPSIxMnB4IiBoZWlnaHQ9IjEycHgiPgogICAgICAgIDxyZWN0IHg9IjAiIHk9IjAiIHdpZHRoPSIxMnB4IiBoZWlnaHQ9IjEycHgiIHJ4PSI0cHgiIHJ5PSI0cHgiIHN0eWxlPSJzdHJva2U6ICNjYWNhY2E7IHN0cm9rZS13aWR0aDoxcHg7IGZpbGw6IG5vbmU7Ii8+CiAgICAgICAgPGxpbmUgeDE9IjJweCIgeTE9IjZweCIgeDI9IjEwcHgiIHkyPSI2cHgiIHN0eWxlPSJzdHJva2U6ICNjYWNhY2E7IHN0cm9rZS13aWR0aDoxcHg7Ii8+CiAgICAgICAgPGxpbmUgeDE9IjZweCIgeTE9IjJweCIgeDI9IjZweCIgeTI9IjEwcHgiIHN0eWxlPSJzdHJva2U6ICNjYWNhY2E7IHN0cm9rZS13aWR0aDoxcHg7Ii8+CiAgICA8L3N2Zz4=";break;case C.ButtonImageType.custom:e=t.imageSrc}return e}function Rt(t,n){return"function"==typeof t?t(n):t}Object.defineProperty(t,"__esModule",{value:!0}),C=n("Core"),t=n("Common"),n=n("./dist/plugins/celltype/celltypes.ns.js"),S=t.Common.lt.ht,o=C.W.V,a=C.mt.vt,z=C.Bf.Zl,T=void 0,A=null,s=Math.max,c=parseInt,V="#707070",Y="#34B4E3",Z="#e6e6e6",W="lightgray",Q="#CACACA",g="_isFirstMouseUp",p="_mouseupToken",h="_leaveCell",d=J=0,K=I=2,x=3,X=C.CellTypes.Base,N=C.CellTypes.Context,q="gc-cell-button-canvas",b=(r="gc-editor-")+"left-cellbuttons",y=r+"right-cellbuttons",w=r+"left-of-text-cellbuttons",M=r+"right-of-text-cellbuttons",k="leftButtonArea",D="rightButtonArea",_="leftOfTextButtonArea",E="rightOfTextButtonArea",f="_cellButtonParam",v={},l=C.GC$,m=[C.ButtonPosition.left,C.ButtonPosition.right,C.ButtonPosition.leftOfText,C.ButtonPosition.rightOfText],t=new t.Common.ResourceManager(n.SR,"CellTypes"),$=t.getResource.bind(t),(n=j=j||{})[n.topLeft=0]="topLeft",n[n.topCenter=1]="topCenter",n[n.topRight=2]="topRight",n[n.MiddleLeft=3]="MiddleLeft",n[n.MiddleCenter=4]="MiddleCenter",n[n.MiddleRight=5]="MiddleRight",n[n.bottomLeft=6]="bottomLeft",n[n.bottomCenter=7]="bottomCenter",n[n.bottomRight=8]="bottomRight",C.CellTypes.Base.ch("cellButton",{beforePaintLabel:function(t){var n,e,i,r,o,a,u,s,c,f,a,l,h,d,v,m,g,p,b,n=t.options.context,e=t.options.style;if(!n.cellOverflowLayout&&e.cellButtons&&0<e.cellButtons.length&&(i=t.options.context.sheet,r=n.row,o=n.col,a=G(i,e.cellButtons,r,o,!1,[C.ButtonPosition.left,C.ButtonPosition.right]))&&0<a.length&&(u=_t(e),B(a,i,t.options.context.row),s=t.ctx)){for(c=pt(t.options.rect.clone(),n),s.save(),s.rect(c.x,c.y,c.width,c.height),s.clip(),s.beginPath(),f=c.x,a=c.x+c.width,l=H(i,n.row,n.col,n.sheetArea),S(l.layout)&&(l.layout={}),h=l.layout,d=G(i,e.cellButtons,r,o,!1,[C.ButtonPosition.left]),v=0;v<d.length&&(m=F(s,f,c.y,P(d[v].button,u,n),c.height,d[v].button,u,n,l,h,d[v].index,c),!S(m));v++)f+=m.width;for(g=f,f=a,v=(p=G(i,e.cellButtons,r,o,!1,[C.ButtonPosition.right])).length-1;0<=v&&(m=F(s,f-=b=P(p[v].button,u,n),c.y,b,c.height,p[v].button,u,n,l,h,p[v].index,c),!S(m));v--);s.restore(),(c=t.options.rect).width=c.x+c.width-(a-f)-g,c.x=g}},beforePaintText:function(t){var n,e,i,r,o,t,n=t.context,e=t.style;!n.cellOverflowLayout&&e.cellButtons&&0<e.cellButtons.length&&(i=t.context.sheet,r=n.row,o=n.col,(t=t.externals).left=t.left.concat(at(G(i,e.cellButtons,r,o,!1,[C.ButtonPosition.leftOfText]),e,n)),t.right=t.right.concat(at(G(i,e.cellButtons,r,o,!1,[C.ButtonPosition.rightOfText]),e,n)))},beforeFillTextArea:function(t){var n,e,i,r,o,i,a,u,s,c,n=t.style,e=n.cellButtons;n.cellButtons&&0<n.cellButtons.length&&(i=t.ctx,r=t.availRect,o=t.textRect,yt(i,c=G(a=(i=t.context).sheet,e,u=i.row,s=i.col,!1,[C.ButtonPosition.leftOfText]),r,o,n,i,!0))},afterFillTextArea:function(t){var n,e,i,r,o,i,a,u,s,c,n=t.style,e=n.cellButtons;n.cellButtons&&0<n.cellButtons.length&&(i=t.ctx,r=t.availRect,o=t.textRect,yt(i,c=G(a=(i=t.context).sheet,e,u=i.row,s=i.col,!1,[C.ButtonPosition.rightOfText]),r,o,n,i,!1))},onCreateCellEditor:function(t){var n,e,i,r,o,a,u,s,c,t,f,l,h,d,v,n=t.options.dom;if(n&&n.children&&(e=n.children[0])&&e.children&&(i=e.children[0])&&(o=(r=t.context).sheet,a=r.row,u=r.col,s=t.options.cellStyle,c=(s=S(s)?o.getActualStyle(a,u):s).cellButtons,!(S(c)||c&&c.length<=0))){for(t=t.options.cellRect,f=new C.Rect(t.x,t.y,t.width,t.height),l=H(o,a,u,r.sheetArea),S(l.layout)&&(l.layout={}),h=l.layout,d=!1,v=0;v<c.length;v++)c[v].position!==C.ButtonPosition.leftOfText&&c[v].position!==C.ButtonPosition.rightOfText||(d=!0);for(d&&(e.style.overflow="hidden"),v=0;v<m.length;v++)ut(m[v],o,c,r,s,f,a,u,l,h,n,e)}},onActivateCellEditor:function(t){var n,e,i,r,o,a,u,s,c,f,l,h,n=t.context,e=n.sheet,i=n.row,r=n.col,o=t.options.cellStyle,a=o.cellButtons;if(!(S(a)||a.length<=0))for(u=H(e,i,r,n.sheetArea),S(u.editorLayout)&&(u.editorLayout={}),s=u.layout,c=u.editorLayout,f=_t(o),l=t.options.dom,h=0;h<m.length;h++)ht(m[h],e,a,n,f,t,i,r,u,s,c,l)},onDeactivateCellEditor:function(t){var n,e,i,r,o,e,a,u,s,c,f,l,h,n=t.context,e=n.sheet,i=n.row,r=n.col,o,e=e.getActualStyle(i,r,n.sheetArea).cellButtons;if(e&&0<e.length)for(u=(a=H(n.sheet,i,r,n.sheetArea,!0))&&a.eventListeners,c=(s=t.options.dom).querySelectorAll("."+q),f=0;f<c.length;f++)h=et((l=c[f]).className),S(h)||S(u)||S(u[h])||(gt(l,u[h]),delete a.eventListeners[h])},onUpdateContainer:function(t){var n,e,i,r,n,o,a,u,n=t.context,e=n.sheet,i=n.row,r=n.col,n=H(n.sheet,i,r,n.sheetArea,!0),o=n&&n.canvasSizes,a=t.cellStyle.cellButtons;if(!(S(a)||a.length<=0))for(t.context.preventOverflow=!0,u=0;u<m.length;u++)dt(m[u],e,a,i,r,o,t)},getCellButtonHitInfo:function(t){t.paddingHitInfo=u(t)},processMouseDownOnCellPadding:function(t){It(t)},processMouseUpOnCellPadding:function(t){xt(t)},processMouseMoveOnCellPadding:function(t){Nt(t)},processMouseLeaveOnCellPadding:function(t){kt(t)},getCellButtonAutoHeight:function(i){var r,o,t,a,t,u,r=i.context.sheet,o=i.context.row,t=i.context.col,a=i.cellStyle;a.cellButtons&&0!==a.cellButtons.length&&(t=G(r,a.cellButtons,o,t,!1,[C.ButtonPosition.left,C.ButtonPosition.right]),u=0,t.forEach(function(t){var n,e,n=N.tn(A,t.button.caption,a,r.zoom(),i.context)-2,e;Ot(t.button,o)&&(n=s(n,U(t.button))),u=s(n,u)}),i.value=u+ +I)},getCellButtonAutoWidth:function(n){var t,e,i,r,t,o,t=n.context.sheet,e=n.context.row,i=n.context.col,r=n.cellStyle;r.cellButtons&&0!==r.cellButtons.length&&(t=G(t,r.cellButtons,e,i,!1,[C.ButtonPosition.left,C.ButtonPosition.right,C.ButtonPosition.leftOfText,C.ButtonPosition.rightOfText]),o=0,t.forEach(function(t){o+=P(t.button,r,n.context,!1)}),n.value=o)}}),C.Worksheet.ch(i="cellButtons",{setHost:function(){var e=this;e.bind(C.Events.EnterCell+"."+i,function(t,n){jt(e,n.row,n.col,!1,n.sheetArea)}),e.bind(C.Events.LeaveCell+"."+i,function(t,n){jt(e,n.row,n.col,!0,n.sheetArea)}),e.bind(C.Events.TopRowChanged+"."+i,function(t,n){jt(e,n.row,n.col,!0,n.sheetArea)})},dispose:function(t){var n=this;n.unbind(C.Events.EnterCell+"."+i),n.unbind(C.Events.LeaveCell+"."+i),n.unbind(C.Events.TopRowChanged+"."+i)},processMouseDown:function(t){var n=t.hitInfo.cellTypeHitInfo;n&&n.cellButtonHitInfo&&It(n)&&(t.r=!0)}}),C.Workbook.ch(i,{onCultureChanged:function(){$()}})},"./dist/plugins/celltype/celltypes.entry.js":function(t,n,e){"use strict";var i,r,o,a,u,s,c,i=this&&this.__createBinding||(Object.create?function(t,n,e,i){void 0===i&&(i=e);var r=Object.getOwnPropertyDescriptor(n,e);r&&("get"in r?n.__esModule:!r.writable&&!r.configurable)||(r={enumerable:!0,get:function(){return n[e]}}),Object.defineProperty(t,i,r)}:function(t,n,e,i){t[i=void 0===i?e:i]=n[e]}),r=this&&this.__exportStar||function(t,n){for(var e in t)"default"===e||Object.prototype.hasOwnProperty.call(n,e)||i(n,t,e)};Object.defineProperty(n,"__esModule",{value:!0}),n.ti=n.EditorType=n.Context=n.Base=void 0,a=(o=e("Core")).CellTypes.Base,u=o.CellTypes.Context,s=o.CellTypes.EditorType,c=o.CellTypes.ti,n.Base=a,n.Context=u,n.EditorType=s,n.ti=c,n.Hi=o.CellTypes.Hi,n.zi=o.CellTypes.zi,Object.defineProperty(n,"Corner",{set:function(t){t!==n.Hi.Corner&&(n.Hi.Corner=t)},get:function(){return n.Hi.Corner}}),Object.defineProperty(n,"ColumnHeader",{set:function(t){t!==n.Hi.ColumnHeader&&(n.Hi.ColumnHeader=t)},get:function(){return n.Hi.ColumnHeader}}),Object.defineProperty(n,"RowHeader",{set:function(t){t!==n.Hi.RowHeader&&(n.Hi.RowHeader=t)},get:function(){return n.Hi.RowHeader}}),Object.defineProperty(n,"Text",{set:function(t){t!==n.zi.Text&&(n.zi.Text=t)},get:function(){return n.zi.Text}}),r(e("./dist/plugins/celltype/checkboxcelltype.js"),n),r(e("./dist/plugins/celltype/buttoncelltype.js"),n),r(e("./dist/plugins/celltype/hyperlinkcelltype.js"),n),r(e("./dist/plugins/celltype/comboboxcelltype.js"),n),e("./dist/plugins/celltype/cellbuttons.js"),r(e("./dist/plugins/celltype/editor/colorpicker.js"),n),r(e("./dist/plugins/celltype/editor/timepicker.js"),n),r(e("./dist/plugins/celltype/editor/calendar.js"),n),r(e("./dist/plugins/celltype/editor/calculator.js"),n),r(e("./dist/plugins/celltype/editor/monthPicker.js"),n),r(e("./dist/plugins/celltype/editor/listControl.js"),n),r(e("./dist/plugins/celltype/dropdown-action.js"),n),r(e("./dist/plugins/celltype/radiochecklistcelltype.js"),n),r(e("./dist/plugins/celltype/celltypes.ns.js"),n),r(e("./dist/plugins/celltype/rangecelltype.js"),n),r(e("./dist/plugins/celltype/dataobjectcelltype.js"),n),r(e("./dist/plugins/celltype/editor/popupControl.js"),n)},"./dist/plugins/celltype/celltypes.ns.js":function(t,n,e){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.SR=void 0;var e=e("./dist/plugins/celltype/celltypes.res.en.js");n.SR={en:e}},"./dist/plugins/celltype/celltypes.res.en.js":function(t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.Calendar_NextMonth=n.Calendar_LastMonth=n.Calendar_Today=n.Calendar_FirstYear=n.Calendar_EraName_4=n.Calendar_EraName_3=n.Calendar_EraName_2=n.Calendar_EraName_1=n.Calendar_Time_PM=n.Calendar_Time_AM=n.Calendar_Months_12=n.Calendar_Months_11=n.Calendar_Months_10=n.Calendar_Months_9=n.Calendar_Months_8=n.Calendar_Months_7=n.Calendar_Months_6=n.Calendar_Months_5=n.Calendar_Months_4=n.Calendar_Months_3=n.Calendar_Months_2=n.Calendar_Months_1=n.Calendar_ShortMonths_12=n.Calendar_ShortMonths_11=n.Calendar_ShortMonths_10=n.Calendar_ShortMonths_9=n.Calendar_ShortMonths_8=n.Calendar_ShortMonths_7=n.Calendar_ShortMonths_6=n.Calendar_ShortMonths_5=n.Calendar_ShortMonths_4=n.Calendar_ShortMonths_3=n.Calendar_ShortMonths_2=n.Calendar_ShortMonths_1=n.Calendar_Weeks_7=n.Calendar_Weeks_6=n.Calendar_Weeks_5=n.Calendar_Weeks_4=n.Calendar_Weeks_3=n.Calendar_Weeks_2=n.Calendar_Weeks_1=n.Calendar_ShortWeeks_7=n.Calendar_ShortWeeks_6=n.Calendar_ShortWeeks_5=n.Calendar_ShortWeeks_4=n.Calendar_ShortWeeks_3=n.Calendar_ShortWeeks_2=n.Calendar_ShortWeeks_1=n.Cancel=n.OK=void 0,n.DataObject_MeetTable=n.DataObject_MeetSpan=n.DataObject_MeetLock=n.MultiColumn_InvalidDataSource=n.Calculator_OverFlowInfo=n.Calculator_SqrtParameterException=n.Calculator_InvalidInputInfo=n.Calculator_DivideByZeroInfo=n.StandardColor=n.ThemeColor=n.Quarter_Format_4=n.Quarter_Format_3=n.Quarter_Format_2=n.Quarter_Format_1=n.Calendar_NextTenYear=n.Calendar_LastTenYear=n.Calendar_NextYear=n.Calendar_LastYear=void 0,n.OK="OK",n.Cancel="Cancel",n.Calendar_ShortWeeks_1="MON",n.Calendar_ShortWeeks_2="TUE",n.Calendar_ShortWeeks_3="WED",n.Calendar_ShortWeeks_4="THU",n.Calendar_ShortWeeks_5="FRI",n.Calendar_ShortWeeks_6="SAT",n.Calendar_ShortWeeks_7="SUN",n.Calendar_Weeks_1="Monday",n.Calendar_Weeks_2="Tuesday",n.Calendar_Weeks_3="Wednesday",n.Calendar_Weeks_4="Thursday",n.Calendar_Weeks_5="Friday",n.Calendar_Weeks_6="Saturday",n.Calendar_Weeks_7="Sunday",n.Calendar_ShortMonths_1="JAN",n.Calendar_ShortMonths_2="FEB",n.Calendar_ShortMonths_3="MAR",n.Calendar_ShortMonths_4="APR",n.Calendar_ShortMonths_5="MAY",n.Calendar_ShortMonths_6="JUN",n.Calendar_ShortMonths_7="JUL",n.Calendar_ShortMonths_8="AUG",n.Calendar_ShortMonths_9="SEP",n.Calendar_ShortMonths_10="OCT",n.Calendar_ShortMonths_11="NOV",n.Calendar_ShortMonths_12="DEC",n.Calendar_Months_1="JANUARY",n.Calendar_Months_2="FEBRUARY",n.Calendar_Months_3="MARCH",n.Calendar_Months_4="APRIL",n.Calendar_Months_5="MAY",n.Calendar_Months_6="JUNE",n.Calendar_Months_7="JULY",n.Calendar_Months_8="AUGUST",n.Calendar_Months_9="SEPTEMBER",n.Calendar_Months_10="OCTOBER",n.Calendar_Months_11="NOVEMBER",n.Calendar_Months_12="DECEMBER",n.Calendar_Time_AM="AM",n.Calendar_Time_PM="PM",n.Calendar_EraName_1="M",n.Calendar_EraName_2="T",n.Calendar_EraName_3="S",n.Calendar_EraName_4="H",n.Calendar_FirstYear="1",n.Calendar_Today="Today",n.Calendar_LastMonth="Go to previous month",n.Calendar_NextMonth="Go to next month",n.Calendar_LastYear="Go to previous year",n.Calendar_NextYear="Go to next year",n.Calendar_LastTenYear="Go to previous ten years",n.Calendar_NextTenYear="Go to next ten years",n.Quarter_Format_1="Q1",n.Quarter_Format_2="Q2",n.Quarter_Format_3="Q3",n.Quarter_Format_4="Q4",n.ThemeColor="Theme Colors",n.StandardColor="Standard Colors",n.Calculator_DivideByZeroInfo="Cannot divide by zero.",n.Calculator_InvalidInputInfo="Invalid Input.",n.Calculator_SqrtParameterException="Invalid input for function.",n.Calculator_OverFlowInfo="Arithmetic operation resulted in an overflow.",n.MultiColumn_InvalidDataSource="Invalid data source. The formula should return an array.",n.DataObject_MeetLock="Cannot insert data because there's a locked cell in the way.",n.DataObject_MeetSpan="Cannot insert data because there's a merged cell in the way.",n.DataObject_MeetTable="Cannot insert data because a table in the way."},"./dist/plugins/celltype/checkboxcelltype.js":function(B,t,n){"use strict";var e,i,T,r,c,y,a,s,n,b,o,w,u,f,l,A,h,d,M,C,S,I,x,v,m,L,g,F,p,P,G,N,k,D,U,_,E,j,O,i,H;function z(t,n,e,i){var t,r,t=t.Ut;t&&(t.do("setValueForKey",n,e,k,f,i),r=t.getValueForKey(n,e,D,i))&&(clearTimeout(r),t.do("setValueForKey",n,e,D,f,i))}function R(){var t,e,t=H.call(this)||this;return t.typeName="5",t._boxSize=_,e=t,o(E,function(t,n){e["_"+t]=n}),t}function V(t){return 5*t}function Y(t,n,e,i,r,o,a,u){var s,c,f,l,h,d,v,e,m,g,p,b,y,w,M,a,C,c,i,S,n,s=5*a,c=n.hAlign,f=e.x,l=e.width,h=0,d=n.vAlign,v=e.y,e=e.height,m=0,g=0,p=1<i.split("\n").length,b=f,y=v,w=l,M=e,a=_*a;return 0===t||1===t?(1===c?h=f+l/2-a/2:w=2===c?(h=f+l-s-a,l-s+2):(b=(h=f+s)-1,l-s+1),M=(c=T.q.un(i,C=w-3-1,n.font)).length*o,p=p||1<c.length,m=a+M,y=0===t?(1===d?(g=v+e/2-m/2+M-3,M+=6):g=2===d?v+e-s-m+M:v+s+M,g-M):(1===d?(g=v+e/2-m/2-3,M+=6):g=2===d?v+e-s-m:v+s,g+a)):(g=1===d?v+e/2-a/2:2===d?v+e-s-a:v+s,n=o/2-(i=A(u.fontInfo.fontSize))/2+(S=8<i?Math.floor((i-8)/5+2):1)-1,p=p||l-a-s-4<r,w=l-a-s,2===d?M=e+n+2-s:0===d&&(M=e-((y=v-(2+n)+s)-v)),2===t?(h=f+l-s-a,w=l-a):b=(h=f+s)+a+1),{multiLine:p,startX:h,startY:g,textX:b,textY:y,textW:w,textH:M}}function Z(t,n,e,i,r){var o,n,a,e,u,s,o=5*r,n=n.hAlign,a=e.x-1,e=e.width+1,u=0,s=0;return 0===t||1===t?(s=a+o,1===n?s=a+e/2-_*r/2:2===n&&(s=a+e-o-_*r)):2===t?(u=_*r+i,s=a+o+i,1===n?s=a+e/2-u/2+i:2===n&&(s=a+e-o-u+i)):(u=_*r+i,s=a+o,1===n?s=a+e/2-u/2:2===n&&(s=a+e-o-u)),s-a}function W(t,n,e,i,r){var o,n,a,e,u,s,o=5*r,n=n.vAlign,a=e.y-1,e=e.height+1,u=0,s=0;return 0===t?(u=_*r+i,s=a+o+i,1===n?s=a+e/2-u/2+i:2===n&&(s=a+e-o-u+i)):1===t?(u=_*r+i,s=a+o,1===n?s=a+e/2-u/2:2===n&&(s=a+e-o-u)):(s=a+o,1===n?s=a+e/2-_*r/2:2===n&&(s=a+e-o-_*r)),s-a}function Q(t,n,e,i,r){var o,o,o,o=n.getValue(e,i,r),o=t.wG(o),o={cmd:"editCell",sheetName:n.name(),row:e,col:i,newValue:o,autoFormat:!0};n.Qy().execute(o),t.j3(n,e,i,r)}function J(t,n,e,i,r){var o,a,o=r&&r.sheet,a=t.getEditorValue(n,r);t.setEditorValue(n,a,r),t.updateEditor(n,e,i,r),t.j3(o,o.ui,o.ci,r.sheetArea)}e=this&&this.__extends||(O=function(t,n){return(O=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(t,n){t.__proto__=n}:function(t,n){for(var e in n)Object.prototype.hasOwnProperty.call(n,e)&&(t[e]=n[e])}))(t,n)},function(t,n){if("function"!=typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function e(){this.constructor=t}O(t,n),t.prototype=null===n?Object.create(n):(e.prototype=n.prototype,new e)}),Object.defineProperty(t,"__esModule",{value:!0}),t.CheckBox=t.CheckBoxTextAlign=void 0,i=n("Common"),T=n("Core"),r=T.mt.En,c=i.Common.lt.ht,y=T.mt.vt,a=T.mt.vi,s=T.CellTypes.Context,n=T.CellTypes.Base,b=T.GC$,o=b.each,w=T.mt.yt,u=null,f=void 0,l=Math.max,A=parseInt,h="position",d="absolute",M="font",C="left",S="right",I="top",x="alphabetic",v=".gcEditingInput",m="background-color",L="white",g="green",F="div",p="normal 11pt calibri",P="width",G="height",N="white-space",k="_isFirstMouseUp",D="_mouseupToken",(i=U=t.CheckBoxTextAlign||(t.CheckBoxTextAlign={}))[i.top=0]="top",i[i.bottom=1]="bottom",i[i.left=2]="left",i[i.right=3]="right",E={caption:"",textTrue:"",textIndeterminate:"",textFalse:"",textAlign:3,isThreeState:!(_=12),boxSize:_},e(R,H=n),R.prototype.Poe=function(t,n,e,i,r,o,a,u){var s=this,c=A(e.startX),f=A(e.startY),l=A(e.textX),h=A(e.textY),d=A(e.textW),e=A(e.textH);s.Goe(t,c,f,r,o,a),s.paintText(t,n,l,h,d,e,u,i,n,null)},R.prototype.Goe=function(t,n,e,i,r,o){t.save(),t.strokeStyle="black",t.strokeRect(n+.5,e+.5,2*i+.05,2*i+.05),t.fillStyle=L,t.fillRect(n+1,e+1,2*i-1,2*i-1),this._isThreeState&&c(o)?(t.beginPath(),t.fillStyle=g,t.rect(n+3*r,e+3*r,2*(i-2.5*r),2*(i-2.5*r)),t.fill()):!0==!!o&&(t.beginPath(),t.lineWidth=2.5*r,t.moveTo(n+3*r,e+i),t.lineTo(n+i,e+2*i-3.5*r),t.lineTo(n+2*i-1.5*r,e+3*r),t.stroke()),t.restore()},R.prototype.paintValue=function(t,n,e,i,r,o,a,u){var s,c,f,l,h,d,v,m,g,g,p,b,p,b,p,r,o,o,r,p,e,o,i,r,s,c,a;t&&(t.save(),t.rect(e,i,r,o),t.clip(),t.beginPath(),s=a.hAlign,c=a.font,f=a.foreColor,h=(l=this)._textAlign,d=l.getText(n,u),m=v=0,(g=u.sheet)&&(v=g.Qt(d,c),m=y(c)),g=g.zoom(),p=u.isPrinting,b=u.printZoomFactor,++e,++i,--r,--o,b=(p=this.CG(m,g=p&&"number"==typeof b&&1!==b?b:g)).radius,p=p.scaleFactor,r=new T.Rect(e,i,r,o),a.wordWrap&&(o=Y(h,a,r,d,v,m,g*p,u)).multiLine?l.Poe(t,d,o,u,b,g,n,a):(o=Z(h,a,r,v,g*p),r=W(h,a,r,m,g*p),p=A((e+o).toString()),e=A((i+r).toString()),o=C,i=p+1,1===s?(o="center",i+=b):2===s&&(o=S,i+=2*b),c&&t.font!==c&&T.mt.bt(t,c),f&&(t.fillStyle=f),r=a.textDecoration,a=m/2-(s=parseInt(u.fontInfo.fontSize,10))/2+(c=8<s?Math.floor((s-8)/5+2):1)-1,t.textBaseline!==x&&(t.textBaseline=x),2===h?(t.textAlign=S,t.fillText(d,p+1-2,e+b+m/2-a),r&&l.le(t,r,p+1-2,e+b+m/2-a,v,s,c)):0===h&&(t.textAlign=o,t.fillText(d,i,e-2-a),r)&&l.le(t,r,i,e-2-a,v,m),l.Goe(t,p,e,b,g,n),f&&(t.fillStyle=f),3===h?(t.textAlign=C,t.fillText(d,p+1+2*b+2,e+b+m/2-a),r&&l.le(t,r,p+1+2*b+2,e+b+m/2-a,v,s,c)):1===h&&(t.textAlign=o,t.fillText(d,i,e+2*b+2+m-a),r)&&l.le(t,r,i,e+2*b+2+m-a,v,s,c)),t.restore())},R.prototype.CG=function(t,n){var e,i,r,o,e,i=this._boxSize,r=_/2,o=1;return"auto"===i&&(r=t/4,o=t/2/_),"number"==typeof i&&0<i&&(r=n*i/2,o=i/_),{radius:r,scaleFactor:o}},R.prototype.bi=function(t,n,e){var i,n,t,r,o,a,i,n=n.font,t=this.getText(t,e),r=0,o;return e.sheet&&(r=y(n),t)&&(r*=(a=t.split(/\r\n|\r|\n/)).length),r},R.prototype.getText=function(t,n){return this.SG(t)},R.prototype.focus=function(t,n){t&&t.parentNode.focus()},R.prototype.createEditorElement=function(t,n){var e,e,e,n,t,i,i,n,e=t&&t.sheet&&t.sheet.parent&&t.sheet.parent.Ti,e=T.mt.gi(e)+1e3;return b(n).css("z-index",e).attr("tabindex",1).attr("gcUIElement","gcEditingInput"),(e=b(n.firstChild)).css("overflow","hidden"),(n=b(r("input"))).attr("type","checkbox"),n.attr("class","gc-checkbox-cell-type-input"),i=(t=this.TG(t))/_,n.css("transform","scale("+i+")"),e.append(n),(i=b(r("span"))).css(h,d).css(M,w(p)).css("cursor","default").css(N,"nowrap").css("word-break","break-all"),e.append(i),(n=b(r(F))).css(h,d).css(m,g).css("width",2*(t/2-2.5)).css("height",2*(t/2-2.5)),e.append(n),u},R.prototype.TG=function(t){var n,e,n,i,n=t.sheet,e=n.zoom();return"number"==typeof this._boxSize&&0<this._boxSize?this._boxSize*e:"auto"===this._boxSize?(i="",i=(n=n.Z_(t.row,t.col))&&n.font?n.font:p,e*y(i)/2):_/2},R.prototype.wG=function(t){var t,t=this._isThreeState?!c(t)&&(!0!=!!t||u):!t;return t},R.prototype.setEditorValue=function(t,n,e){var t,i,r,t,o,e,a,u,s;t&&(i=(t=t.parentNode.children)[0],r=t[1],t=t[2],i)&&r&&t&&(o=this,s=u=void 0,(a=(e=e&&e.sheet)&&e.Ai)||(s=o.wG(n)),o._isThreeState?c(s)?(u=!1,b(t).show()):(u=!!s,b(t).hide()):u=!!s,i.checked=u,b(r).text(o.SG(s)))},R.prototype.getEditorValue=function(t,n){if(t){var t=t.parentNode.children,e=t[0],i=t[1],t=t[2];if(e&&i&&t&&(!this._isThreeState||!b(t).isVisible()))return e.checked}return u},R.prototype.j3=function(t,n,e,i){var r=t.parent;r&&r.j3(t,n,e,i)},R.prototype.activateEditor=function(n,e,i,r){var t,t,o,t=r&&r.sheet;n&&t&&(t=b(n.parentNode.parentNode),o=this,t.bind("mousedown"+v,function(t){a(t)}),t.bind("mouseup"+v,function(){J(o,n,e,i,r)}),t.bind("keydown"+v,function(t){var n=t.keyCode;if(!t.ctrlKey&&!t.shiftKey&&!t.altKey){if(32===n)return o.AG=!0,a(t),!1;8===n&&a(t)}}),t.bind("keyup"+v,function(t){!o.AG||32!==t.keyCode||t.ctrlKey||t.shiftKey||t.altKey||(o.AG=!1,J(o,n,e,i,r))}),b(n).bind("click",function(t){a(t)}))},R.prototype.updateEditor=function(t,n,e,i){var r,o,t,a,u,s,a,t,s,c,f,l,h,c,f,o,r,d,c,s,i,v,m,e,f,m,e,u,g,p,l,s,r=i&&i.sheet;t&&r&&(o=r.Dn,u=(a=(t=t.parentNode).children)[0],s=a[1],a=a[2],u)&&s&&a&&(b(t).width(e.width).height(e.height),s=(t=b(s)).text(),c=n.foreColor,f=n.font,l=n.hAlign,h=n.textDecoration,c&&t.css("color",c),c=void 0,c=f||o.Nn(),1<(f=r.zoom())&&(c=o._n(c)),t.css(M,w(c)),o=r.Gi(s,c),r=y(c),s&&(r*=(d=s.split(/\r\n|\r|\n/)).length),m=Z(s=(c=this)._textAlign,n,e,o,f*(v=(i=this.TG(i))/_)),e=W(s,n,e,r,f*v),b(u).css("margin-left",m).css("margin-top",e),f=u.offsetLeft,m=u.offsetTop,e=u.offsetWidth,u=u.offsetHeight,(p=g=0)===s?(g=f,1===l?g=f+i/2-o/2:2===l&&(g=f+i-o),p=m-r,g-=(v-1)*_/2,p-=(v-1)*_/2):1===s?(g=f,1===l?g=f+i/2-o/2:2===l&&(g=f+i-o),p=m+u,g-=(v-1)*_/2,p+=(v-1)*_/2):(2===s?(g=f-o-2,p=m+i/2-r/2,g-=(v-1)*_/2):(g=f+e+2,p=m+i/2-r/2,g+=(v-1)*_/2),p-=(v-1)*_/2),t.css(C,g).css(I,p),n.wordWrap?t.css(N,"normal"):t.css(N,"nowrap"),c._isThreeState?(l=f+(e-a.offsetWidth)/2,s=m+(u-a.offsetHeight)/2,b(a).css(C,l).css(I,s).toggle().toggle()):b(a).hide(),h)&&c.Qe(t,h)},R.prototype.SG=function(t){var n=this,e=n._caption;return n._isThreeState&&c(t)?n._textIndeterminate||e:!0==!!t?n._textTrue||e:n._textFalse||e},R.prototype.getHitInfo=function(t,n,e,i,r){if(r){var o=r.sheetArea;if(c(o)||3===o)return{x:t,y:n,row:r.row,col:r.col,cellRect:i,sheetArea:3,isReservedLocation:!0,sheet:r.sheet,cellStyle:e}}return u},R.prototype.processMouseDown=function(t){if(!t)return!1;t.isReservedLocation&&(this.pG=!0)},R.prototype.processMouseUp=function(t){var n,e,i,r,o,a,t,n=this,e=t&&t.sheet;if(e&&n.pG&&t.isReservedLocation){if(n.pG=!1,i=t.row,r=t.col,o=t.sheetArea,!(a=e.Ut.getValueForKey(i,r,k,o)))return Q(n,e,i,r,o),e.Ut.do("setValueForKey",i,r,k,!0,o),t=setTimeout(function(){z(e,i,r,o)},250),e.Ut.do("setValueForKey",i,r,D,t,o),!0;z(e,i,r,o)}return!1},R.prototype.processMouseLeave=function(t){if(!t)return!1;this.pG=!1},R.prototype.isReservedKey=function(t,n){return 32===t.keyCode&&!t.ctrlKey&&!t.shiftKey&&!t.altKey},R.prototype.processKeyUp=function(t,n){return Q(this,n.sheet,n.row,n.col,n.sheetArea),!0},R.prototype.getAutoFitWidth=function(t,n,e,i,r){var o,a,u,t,e,o=this,a=o._textAlign,u=s.Bt(t,o.SG(t),e,i,r),t=o.bi(t,e,r),e=2*o.CG(t,i).radius;return 0===a||1===a?u=l(u,e):u+=e,u+5+2},R.prototype.getAutoFitHeight=function(t,n,e,i,r){var o,a,u,u,t,e,o=this,a=o._textAlign,u=o.SG(t),u=s.tn(u,u,e,i,r),t=o.bi(t,e,r),e=2*o.CG(t,i).radius;return 0===a||1===a?u+=e:u=l(u,e),u+5},R.prototype.QD=function(t){this.isReservedKey(t)&&a(t)},R.prototype.isImeAware=function(t){return!1},R.prototype.Ke=function(){},R.prototype.Je=function(t){var t={caption:t.caption,textTrue:t.textTrue,textIndeterminate:t.textIndeterminate,textFalse:t.textFalse,textAlign:t.textAlign&&U[t.textAlign],isThreeState:t.isThreeState,boxSize:t.boxSize};this.fromJSON(t)},R.prototype.toJSON=function(){var e,i,r,e=this,i={typeName:e.typeName};return o(E,function(t,n){(r=e["_"+t])!==n&&(i[t]=r)}),i},R.prototype.fromJSON=function(e){var i=this;o(E,function(t){var n=e[t];c(n)||(i["_"+t]=n)})},R.prototype.Ife=function(t){var n,e=this._textAlign;return 2===e||3===e?_*t+5*t:0},j=R,t.CheckBox=j,o(E,function(n){j.prototype[n]=function(t){return 0===arguments.length?this["_"+n]:("boxSize"===n&&("number"==typeof t&&0<t&&(this["_"+n]=t),"auto"!==t)||(this["_"+n]=t),this)}}),T.CellTypes.ti[5]=j},"./dist/plugins/celltype/comboboxcelltype.js":function(r,t,n){"use strict";var o,F,b,P,f,l,G,c,u,h,a,U,H,z,V,d,v,y,s,m,g,p,w,Y,Z,W,Q,M,C,S,T,J,A,I,x,K,X,N,k,q,$,tt,D,nt,et,_,it,E,rt,ot,at,j,ut,st,ct,ft,lt,ht,dt,vt,mt,O,gt,pt,bt,yt,wt,Mt,Ct,n,St;function R(t,n){t.appendChild(n)}function Tt(t,n){t.removeChild(n)}function B(t){return t&&t.parentNode.parentNode.comboBox}function e(t,n,e,i,r,o,a,u,s){var c,n,s,t,e,i,e,t,s,c=this;c.xG=t,c.afe=n,c.lfe=s,n=t.firstChild,h(t).bind(g,function(t){c.NG(t)}).css([q,C,S,I,x,"overflow"],[a||0,e,i,r,o,"visible"]).attr([T],["gcComboBox"]),s=y(0,r-17),c._editable=!1,c.DG=t=f(_),c._G=e=f("textarea"),R(n,c.EG=t),At(t),At(e),h(e).bind("keyup",function(){var t,n,t=c.EG.value;c._text=t,n=c.jG(t),c.editorValue(n),c.OG(t),c.RG()}).bind(p,function(){c.BG()}).bind(w,function(){c.RG()}),h(t).bind(m,function(){c.LG?c.ki(O,{isMouse:!0}):c.PG()}).bind(p,function(){c.BG()}).bind(w,function(){c.RG()}),c.GG(0,0,s,o),R(n,i=c.UG=f(_)),h(i).css([ot,W,k,X],[A,Q,D,tt]).attr(T,"gcDropDownButton").bind(m,function(){var t,n;!l(c.HG)&&(t=c.HG,c.HG=v,(n=(new Date).valueOf())-t<100)||(c.LG?c.ki(O,{isMouse:!0}):c.PG())}),e=f("canvas"),c.fg=e,c.zG(s,0,r-s,o),R(i,e),R(n,t=c.VG=f(_)),c.YG=!1,c.ZG=u||r,h(t).css([W,ot,k,q,K,$,"cursor",X,x,at],[Q,"1px solid",D,a||0,A,A,"default",tt,o,c.ZG+j]),h(t).attr(T,"gcDropDownWindow").attr(J,-1),c.WG(0,+o),c.QG=0,R(t,s=c.KG=f(_)),c.JG=new b.x4(t,s),c._itemHeight=22,c.qG=20,c.$G=-1,c._editorValueType=0,c._items=[],c.eU=pt,c.iU=""}function At(t){h(t).css(["margin","overflow","resize",W,"padding",K,k,"white-space",X,ot],[0,"hidden",A,Q,dt+"px 0px 0px "+ht+j,A,D,"nowrap",tt,A]).attr(T,"gcComboBoxEditor").attr(J,-1)}function i(){var t,e,t=St.call(this)||this;return t.typeName="7",t.v6=!1,t.rU=!1,e=t,a(yt,function(t,n){e["_"+t]=n="items"===t?[]:n}),t}function It(t){var n,t,e,i,r,n=["0","0","0","0"];return typeof t===Y&&(r=i=void 0,1===(e=(t=t.split(" ",4)).length)?n=[i=t[0],i,i,i]:2===e?n=[i=t[0],r=t[1],i,r]:3===e?(r=t[1],n=[t[0],r,t[2],r]):4===e&&(n=[t[0],t[1],t[2],t[3]])),n}function L(t,n){return t.hasOwnProperty(n)}o=this&&this.__extends||(Ct=function(t,n){return(Ct=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(t,n){t.__proto__=n}:function(t,n){for(var e in n)Object.prototype.hasOwnProperty.call(n,e)&&(t[e]=n[e])}))(t,n)},function(t,n){if("function"!=typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function e(){this.constructor=t}Ct(t,n),t.prototype=null===n?Object.create(n):(e.prototype=n.prototype,new e)}),Object.defineProperty(t,"__esModule",{value:!0}),t.ComboBox=t.EditorValueType=void 0,F=n("Common"),b=n("Core"),P=b.CellTypes.Base,f=b.mt.En,l=F.Common.lt.ht,G=F.Common.ft,c=b.mt,u=c.vi,h=b.GC$,a=h.each,U=c.yt,H=c.Ct,z=c.M0,V=document,d=null,v=void 0,y=Math.max,s=parseInt,m="click",g="keydown",p="mouseover",w="mouseout",Y="string",Z="number",W="position",Q="absolute",M="font",C="left",S="top",T="gcUIElement",J="tabindex",A="none",I="width",x="height",K="outline",X="box-sizing",N="color",k="background-color",q="z-index",$="display",tt="content-box",D="white",nt="black",et="title",_="div",it="span",E="text",rt="value",ot="border",at="min-width",j="px",ut=c.wt,(n=st=t.EditorValueType||(t.EditorValueType={}))[n.text=0]="text",n[n.index=1]="index",n[n.value=2]="value",ct=17,dt=ht=1,vt=ht,O="EndEdit.gcEditingInput",gt=mt=18,pt="lightgrey",yt={editorValueType:lt=0,items:d,itemHeight:22,editable:!(bt="#1E90FF"),maxDropDownItems:ft=20,allowFloat:!0},e.prototype.getComboBox=function(){return this.xG},e.prototype.dispose=function(){var t=this;h(t.xG).unbind(g),h(t._G).unbind("keyup").unbind(p).unbind(w),h(t.DG).unbind(m).unbind(p).unbind(w),h(t.UG).unbind(m),h(t.KG).find("div").forEach(function(t){h(t).unbind(p).unbind(w).unbind(m)}),t.JG.dispose()},e.prototype.updateLocationAndSize=function(t,n,e,i){var r,o,r=this,o=y(0,e-17);r.GG(0,0,o,i),r.zG(o,0,e-o,i),r.WG(0,+i)},e.prototype.updateStyle=function(t,n,e){var i=this;e=U(e),t=t||v,h(i.EG).css(k,t).css(N,n).css(M,e),h(i.UG).css(k,t).css(N,n).css(M,e),h(i.VG).css(k,t).css(N,n).css(M,e),i.iU=n,h(i.xG).css(k,"transparent"),i.eU=G.Tv(G._(t),G._(pt))?D:pt},e.prototype.updateImeMode=function(t){h(this.EG).css("ime-mode",t)},e.prototype.editorValueType=function(t){return 0===arguments.length?this._editorValueType:(this._editorValueType=t,this)},e.prototype.editorValue=function(t){var n,e,n=this;return 0===arguments.length?n.oU:(t!==n.oU&&(n.oU=t,e=n.aU(t),n.text(e),n.OG(e,!0,t)),n)},e.prototype.aU=function(t){var n,e=this,i=e._items,r=i.length,o=e._editorValueType,a,u,s;if(e.uU=!0,1===o)(n=(a=i[t])&&L(a,E)?a.text:a)===v&&(n=t,e.uU=!1);else if(0===o){for(n=t,s=0;s<r&&!((a=i[s])&&L(a,E)&&a.text===t||a===t);s++);r<=s&&(e.uU=!1)}else if(2===o){for(u=0;u<r;u++)if((a=i[u])&&L(a,rt)&&a.value===t){n=a.text;break}r<=u&&(n=t,e.uU=!1)}return n=l(t)?"":n},e.prototype.jG=function(t){var n,e,i,n,r,o,a,u,n=this,e=n._items,i=e.length,n=n._editorValueType,r=t;if(1===n)for(a=0;a<i;a++)((o=e[a])&&L(o,E)&&o.text===t||o===t)&&(r=a);else if(2===n)for(u=0;u<i;u++)(o=e[u])&&L(o,E)&&o.text===t?r=o.value:o===t&&(r=v);return r},e.prototype.OG=function(t,n,e){var i,r,o,a,u,s,c,f,r=-1;if(!l(t)&&""!==t)for(a=(o=this._items).length,i=0;i<a;i++)if(c=s=void 0,s=L(u=o[i],E)?u.text:u,L(u,rt)&&(c=u.value),(f=n?s:s.toString().substr(0,t.length))===t){if(r=i,l(e))break;if(!l(c)&&c===e)break}this.sU(r)},e.prototype.RG=function(){h(this.EG).removeAttr(et)},e.prototype.BG=function(){var t,n,e,i,t=this,n=t.Wt(t._text),e=h(t.EG),i;e.width()+ht<n?e.attr(et,t._text):e.removeAttr(et)},e.prototype.GG=function(t,n,e,i){e-=0,i-=0,h(this.EG).css(C,t).css(S,n).css(I,e-ht).css(x,i-dt)},e.prototype.editable=function(t){var n,e,i,r,o,r,n=this;return 0===arguments.length?n._editable:n._editable!==t?(n._editable=t,e=n.xG.firstChild,i=n.EG,r=h(i),o={left:s(r.css(C)),top:s(r.css(S)),width:s(r.css(I)),height:s(r.css(x))},r={backColor:r.css(k),foreColor:r.css(N),font:i.style.font},Tt(e,i),n.EG=t?n._G:n.DG,R(e,n.EG),h(n.EG).css(k,r.backColor).css(N,r.foreColor).css(M,r.font),n.GG(o.left,o.top,o.width,o.height),n):void 0},e.prototype.text=function(t){var n=this,e=n.EG;if(0===arguments.length)return n._text;t!==n._text&&(n._text=t,n._editable?e.value=t:e.textContent=t)},e.prototype.focus=function(){var t=this,n=t.EG;n.focus(),t._editable&&(n.selectionStart=n.value.length)},e.prototype.selectAll=function(){var t=this;t._editable&&t.EG.select()},e.prototype.zG=function(t,n,e,i){var r,o,r,t,n;e-=0,i-=0,o=(r=this).fg,h(r.UG).css(C,t).css(S,n).css(I,e).css(x,i),h(o).attr(I,e).attr(x,i),r=o.width,t=o.height,(n=o.getContext("2d")).beginPath(),n.lineWidth=2,n.fillStyle=nt,n.moveTo(r-17+4,(t-2)/2-2.5),n.lineTo(r-17+7,(t-2)/2+3.5),n.lineTo(r-17+10,(t-2)/2-2.5),n.fill()},e.prototype.showDropDownList=function(){var n=this,t=n.JG;n.YG=!0,h(n.VG).bind(g,function(t){n.NG(t)}).show(),n.cU=!1,n.fU(),this.adjustPosition(),n.cU&&t.pS(h(n.KG.children).height()),t.w4(!1),n.lU(bt,D),n.hU(n.$G),n.focus()},e.prototype.adjustPosition=function(){var t,n,e,i,r,o,a,u,s,c,f,c,l,l,l,c,t=this,n=h(t.VG);n&&(e=parseInt(n.css("left"),10),i=parseInt(n.css("top"),10),r=n.width(),o=n.height(),isNaN(e)||isNaN(i)||isNaN(r)||isNaN(o)||(u=a=0,!(s=.8)!==this.lfe?(f=(c=V.documentElement).clientWidth,c=c.clientHeight,l=n[0].getBoundingClientRect(),c<o&&(n.css("max-height",Math.round(.8*c)+j),o=Math.round(.8*c)),f<r&&(n.css("max-width",Math.round(.8*f)+j),r=Math.round(.8*f)),l.left+r>f&&(u=l.left+r-f),l.top+o>c&&(a=l.top+o-c)):(c=(l=t.afe).clientHeight,f=l.clientWidth,c<o&&(o=Math.round(.8*c),n.css("max-height",o+j)),f<r&&(r=Math.round(.8*f),n.css("max-width",r+j)),l=n[0].getBoundingClientRect(),c=t.afe.getBoundingClientRect(),a=y(0,l.bottom-c.bottom),u=y(0,l.right-c.right)),(e<0||i<0||0<a||0<u)&&((e-=u+5)<0&&(e-=22),n.css({left:e+j,top:(i-=a+5)+j}))))},e.prototype.shiftPadding=function(t,n){var e=this.xG.firstChild;t===C?h(e).css({left:(+h(e).css(C).replace(j,"")||0)-n}):t===S&&h(e).css({top:(+h(e).css(S).replace(j,"")||0)-n})},e.prototype.closeDropDownList=function(){var t=this;t.YG=!1,h(t.VG).unbind(g).hide(),t.lU("",t.iU),t.focus()},e.prototype.PG=function(){this.YG?this.closeDropDownList():this.showDropDownList()},e.prototype.listHeight=function(t){var n=this,e=h(n.VG);if(0===arguments.length)return e.height();0<t&&(e.height(t),n.JG.w4(!1))},e.prototype.WG=function(t,n){h(this.VG).css(C,t).css(S,n)},e.prototype.items=function(t){var n,e,i,r,o,a,n=this;if(0===arguments.length)return n._items;if(t){for(n._items=t,e=n.KG,i=void 0,h(e).find("div").forEach(function(t){h(t).unbind(p).unbind(w).unbind(m)}),i=e.firstChild;i;)Tt(e,i),i=e.firstChild;for(r=n.QG=0,o=t.length;r<o;r++)a=t[r],n.dU(L(a,E)?a.text:a);return n}},e.prototype.dU=function(t){var n,e,i,n=this,e=f(_),i=f(it);i.textContent=t.toString(),i.style.padding="0 18px 0 "+vt+j,i.style.textOverflow="ellipsis",i.style.whiteSpace="nowrap",R(e,i),R(n.KG,e),n.QG++,h(e).bind(m,function(){var t=h(e).index();n.selectedIndex(t),n.closeDropDownList(),n.ki(O,{isMouse:!0})}).bind(p,function(){var t=h(e);e.oldBackColor=t.css(k),t.css(k,n.eU)}).bind(w,function(){h(e).css(k,e.oldBackColor||"")}).css(at,n.ZG+"px")},e.prototype.vU=function(){var t=this;t.S5=f(it),h(t.S5).css([$,M],[A,t.VG.style.font]).appendTo(V.body)},e.prototype.mU=function(){Tt(V.body,this.S5)},e.prototype.Mt=function(t){return this.S5.textContent=t,h(this.S5).width()+2+vt},e.prototype.lU=function(t,n){var e=this,i=e.$G;0<=i&&i<e.QG&&h(e.KG.children[i]).css([k,N],[t,n])},e.prototype.NG=function(t){var n,e,i,r,o,a,n=this,e=t.keyCode,i=t.which;(t.ctrlKey||t.shiftKey||t.altKey||t.metaKey||37===i||39===i)&&9!==i&&n.editable()||(r=n.QG,o=n.$G,a=0,38===i||40===i?(0<=(a=0<=o&&o<r?o+(38===i?-1:1):a)&&a<r&&n.selectedIndex(a),n.YG&&n.hU(a),u(t)):13===i||37===i||39===i||9===i?(n.selectedIndex(n.$G),n.YG&&n.closeDropDownList(),n.ki(O,{keyCode:e,shiftKey:t.shiftKey}),n.YG&&u(t)):27===i?(n.closeDropDownList(),n.ki(O,{keyCode:e}),u(t)):n.editable()||32!==i||u(t))},e.prototype.getSelectedValue=function(t,n,e){var n,i,n=n[t];return l(n)||(1===e?i=t:0===e?i=L(n,E)?n.text:n:2===e&&L(n,rt)&&(i=n.value)),i},e.prototype.sU=function(t){var n=this;n.lU("",n.iU),n.$G=t,n.lU(bt,D),n.hU(t)},e.prototype.selectedIndex=function(t){var n,t,n=this;if(0===arguments.length)return n.$G;0<=t&&t<n.QG&&(n.sU(t),t=n.getSelectedValue(n.$G,n._items,n._editorValueType),l(t)||n.editorValue(t))},e.prototype.itemCountPerPage=function(t){if(0===arguments.length)return this.qG;0<t&&(this.qG=t)},e.prototype.allowFloat=function(t){var n=this;if(0===arguments.length)return n.lfe;n.lfe=t},e.prototype.Wt=function(t){this.vU();var t=this.Mt(t);return this.mU(),t},e.prototype.itemHeight=function(t){if(0===arguments.length)return this._itemHeight;0<t&&(this._itemHeight=t)},e.prototype.fU=function(){var t,n,n,e,i,r,t=this;t.vU(),n=t._items[0],n=y(t._itemHeight,h(t.S5).text(l(n)?"":n).height()),h(t.KG.children).css(x,n),(i=t.QG)<=(r=t.qG)?e=i*n:(e=r*n,t.cU=!0),t.listHeight(e),t.mU()},e.prototype.hU=function(t){var t;0<=t&&t<this.QG&&(t=this.KG.children[t],this.JG.xS(t))},e.prototype.bind=function(t,n,e){h(this.xG).bind(t,n,e)},e.prototype.unbind=function(t,n){h(this.xG).unbind(t,n)},e.prototype.ki=function(t,n){h(this.xG).trigger(t,n)},wt=e,o(i,St=P),i.prototype.isReservedKey=function(t,n){return this.rU},i.prototype.paintValue=function(t,n,e,i,r,o,a,u){var s,c,c,f,l,h,d,h,d,v,m,g,p,v,m,g,s,s=this,c=u.sheet,c=c.zoom?c.zoom():1,f=17,l=y(0,r-17-1);3===a.hAlign&&(a.hAlign=0),a.wordWrap&&(a.wordWrap=!1),h=u.isPrinting,d=u.printZoomFactor,h&&"number"==typeof d&&1!==d&&(c=d),0<l&&0<o&&(h={},d=void 0,u.quotePrefix=a.quotePrefix,v=a.formatter&&"General"!==a.formatter,m=a._autoFormatter&&a._autoFormatter.formatCached&&"General"!==a._autoFormatter.formatCached,g=void 0,p=this.getItemValue(n),g=v?a.formatter:m?a._autoFormatter:b.CellTypes.Context.Nt(t,p,l+1,a,c),d=this.format(ut(n),g,h,u),d=(v=s.getText(n,u))!==n?d||(n=v):d)&&(m=new b.Rect(e,i,r,o),St.prototype.adjustRectForIconSet.call(this,a.hAlign,u.sheet,u.row,u.col,u.sheetArea,m,h.content&&St.prototype.hasInfilling.call(this,h.content)),e=m.x,r=m.width,g=a.isVerticalText,H(p)&&!g&&!0!==a.shrinkToFit&&(d!==(s=b.CellTypes.Context.Et(t,d,l+1,a,c))&&(delete h.content,a.textIndent=0),d=s),this.paintText(t,n,e,i,l,o,a,u,d,h)),t.save(),(r<17||o<17)&&(t.rect(e,i,r,o),t.clip()),t.beginPath(),t.lineWidth=2,t.fillStyle=nt,t.moveTo(e+r-17+3,i+(o-2)/2-2.5),t.lineTo(e+r-17+6,i+(o-2)/2+3.5),t.lineTo(e+r-17+9,i+(o-2)/2-2.5),t.fill(),t.restore()},i.prototype.getText=function(t,n){return t},i.prototype.createEditorElement=function(t,n){var e,i,i,i,r,o,a,u,a,s,s,t,e=t&&t.sheet,i=e&&e.parent,i=i&&i.Ti,i=c.gi(i)+1e3,r=e.defaults,o=this,a=e.getActualStyle(t.row,t.col).cellPadding,u=0;return a&&(u=parseFloat(It(a)[3])||0),a=0,a=(s=e.getSpan(t.row,t.col))?z(e,s.col,s.col+s.colCount,!1):e.nn(t.col)-u,(s=new wt(n,e.qc(),0,0,r.colWidth,r.rowHeight,i,a)).editorValueType(o._editorValueType),s.items(o._items),s.itemHeight(o._itemHeight),s.itemCountPerPage(o._maxDropDownItems),s.editable(o._editable),s.allowFloat(o.allowFloat()),t=s.getComboBox(),Object.defineProperty(t,"comboBox",{get:function(){return this.gU},set:function(t){this.gU!==t&&(this.gU&&this.gU.dispose(),this.gU=t)}}),t.comboBox=s,d},i.prototype.getEditorValue=function(t,n){var t=B(t);return t&&(this.v6=!t.uU),t&&t.editorValue()},i.prototype.setEditorValue=function(t,n,e){var t=B(t);t&&t.editorValue(n)},i.prototype.focus=function(t,n){var t=B(t);t&&t.focus()},i.prototype.selectAll=function(t,n){var t=B(t);t&&t.selectAll()},i.prototype.activateEditor=function(t,n,e,i){var r,s,c,r=this,s=i.sheet,c=B(t);c&&(c.editorValueType(r._editorValueType),c.items(r._items),c.itemHeight(r._itemHeight),c.itemCountPerPage(r._maxDropDownItems),c.editable(r._editable),c.bind(O,function(t,n){var e,i,r,e,o,a,u,e=n.keyCode,i=n.shiftKey;if(e){if(e=(r=s.Qy()).getShortcutKey(e,!1,i||!1,!1,!1),o=r.getCommands(e))for(a=0,u=o.length;a<u;a++)if("navigationLeft"!==o[a].Zc&&"navigationRight"!==o[a].Zc||(s.Di=1),o[a].execute(s.parent,{sheetName:s.name()}))return!0}else n.isMouse&&c.LG&&s.endEdit()})),r.rU=!0},i.prototype.deactivateEditor=function(t,n){var e,i,r,o,a,u;if(t&&(e=B(t))){if(i=n.sheet.getActualStyle(n.row,n.col,n.sheetArea).cellPadding)for(r=[C,S],o=[3,0],a=0;a<r.length;a++)u=parseInt(It(i)[o[a]],10),e.shiftPadding(r[a],u=typeof u==Z&&0<u?u:0);e.unbind(O),e.closeDropDownList(),e.LG=!1}this.rU=!1},i.prototype.updateImeMode=function(t,n){var t;this.isImeAware()&&(t=B(t))&&t.updateImeMode(n)},i.prototype.updateEditor=function(t,n,e,i){var i,t,i,i=t&&i&&i.sheet;i&&(t=B(t),n&&t&&(i=i.Dn,t.updateStyle(n.backColor,n.foreColor||nt,i._n(n.font||i.Nn()))),e)&&t&&t.updateLocationAndSize(e.x,e.y,e.width,e.height)},i.prototype.format=function(t,n,e,i){var r,t;return l(t)?"":(t=(r=this).getItemValue(t),P.prototype.format.call(r,t,n,e))},i.prototype.getItemValue=function(t){var n,e,i,r,o,a,n,u,n=this,e=n._editorValueType,i=n._items;if(i)if(a=i.length,1===e){if(0<=(n=s(t))&&n<a&&(r=i[n])!==v&&r!==d)return o=L(r,E)?r.text:r}else if(2===e)for(u=0;u<a;u++)if((r=i[u])&&L(r,rt)&&r.value===t)return o=r.text;return t},i.prototype.parse=function(t,n,e){var i,r,o,a,u,s,c,i=this,r=i._editorValueType,o=i._items,s=P.prototype.parse.call(i,t,n);if(o){if(c=o.length,0===r)return s;if(1===r){for(u=0;u<c;u++)if((a=o[u])&&L(a,E)&&a.text===s||a===s)return u}else if(2===r)for(u=0;u<c;u++)if((a=o[u])&&L(a,E)&&a.text===s)return a.value}return s},i.prototype.getHitInfo=function(t,n,e,i,r){var o,a,u,u,u,n;return r&&(o=r.sheetArea,a=r.sheet,l(o)||3===o)&&i&&(u=It(e.cellPadding),u=parseInt(u[1],10)||0,u=i.x+i.width-u,n={x:t,y:n,row:r.row,col:r.col,cellStyle:e,cellRect:i,sheetArea:o,sheet:a},u-17<=t)&&t<u?(n.isReservedLocation=!0,n):d},i.prototype.processMouseDown=function(t){var n,e,e,n=t.sheet,e=t.sheetArea;(l(e)||3===e)&&t.isReservedLocation&&n&&(t.row===n.ui&&t.col===n.ci||n.setActiveCell(t.row,t.col),n.startEdit(),e=B(n.li))&&(c.Tt.mozilla&&(e.HG=(new Date).valueOf()),e.showDropDownList(),e.LG=!0)},i.prototype.getAutoFitWidth=function(t,n,e,i,r){var o;return e&&e.wordWrap&&(e.wordWrap=!1),b.CellTypes.Context.Bt(t,n,e,i,r)+17},i.prototype.getAutoFitHeight=function(t,n,e,i,r){return e&&e.wordWrap&&(e.wordWrap=!1),b.CellTypes.Context.tn(t,n,e,i,r)},i.prototype.isImeAware=function(t){return!0},i.prototype.Ke=function(){},i.prototype.Je=function(t){var t={editorValueType:t.editorValueType&&st[t.editorValueType],items:t.items,itemHeight:t.itemHeight,maxDropDownItems:t.maxDropDownItems,editable:t.editable};this.fromJSON(t)},i.prototype.toJSON=function(){var i,r,o,i=this,r={typeName:i.typeName};return a(yt,function(t,n){var e;o=i["_"+t],("items"===t?o&&0<o.length:o!==n)&&(r[t]=o)}),r},i.prototype.fromJSON=function(e){var i=this;a(yt,function(t){var n=e[t];l(n)||(i["_"+t]=n)})},Mt=i,t.ComboBox=Mt,a(yt,function(n){Mt.prototype[n]=function(t){return 0===arguments.length?this["_"+n]:(this["_"+n]=t,this)}}),b.CellTypes.ti[7]=Mt},"./dist/plugins/celltype/dataobjectcelltype.js":function(t,n,f){"use strict";var e,i,r,l,o,o,h,o,d,a,r,u,s;function v(t){return t&&"object"==typeof t&&!(t instanceof i.CalcError)&&!(t instanceof Date)&&!Array.isArray(t)}function m(t){return v(t)?g(t,""):[]}function g(t,n){for(var e,i,r,o,a,u,s,c,e=[],i,r=0,o=Object.keys(t);r<o.length;r++)a=o[r],s=n?n+"."+a:a,"function"!=typeof(u=t[a])&&(v(u)?(c=g(u,s),e.push({text:a,value:u,path:s,layout:{displayAs:l.LayoutDisplayAs.popup},items:c})):e.push({text:a,value:u,path:s}));return e}function c(t){var n=s.call(this)||this;return n.typeName="18",n.pU=t,n}e=this&&this.__extends||(u=function(t,n){return(u=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(t,n){t.__proto__=n}:function(t,n){for(var e in n)Object.prototype.hasOwnProperty.call(n,e)&&(t[e]=n[e])}))(t,n)},function(t,n){if("function"!=typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function e(){this.constructor=t}u(t,n),t.prototype=null===n?Object.create(n):(e.prototype=n.prototype,new e)}),Object.defineProperty(n,"__esModule",{value:!0}),n.DataObject=void 0,i=f("CalcEngine"),r=f("Common"),l=f("Core"),o=f("./dist/plugins/celltype/celltypes.ns.js"),o=new r.Common.ResourceManager(o.SR,"CellTypes"),h=o.getResource.bind(o),o=l.CellTypes.Text,d=r.Common.lt.ht,a=void 0,e(c,s=o),c.prototype.Xe=function(t,n,e,i,r){var o=t.Z_(n,e,r);o||((o=new l.Style).cellType=this),t.Ut.do("setStyle",n,e,o,r)},c.prototype.qe=function(s,c,t,n,e){var i,e,i,e=m(s.getValue(c,t,e));0<e.length?(n.formatter=this.pU,n.cellButtons=[{command:"openList",imageType:l.ButtonImageType.custom,imageSrc:"data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz4KPHN2ZyB3aWR0aD0iMTZweCIgaGVpZ2h0PSIxNnB4IiB2aWV3Qm94PSIwIDAgMTYgMTYiIHZlcnNpb249IjEuMSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB4bWxuczp4bGluaz0iaHR0cDovL3d3dy53My5vcmcvMTk5OS94bGluayI+CiAgICA8dGl0bGU+RGF0YSBvYmplY3QgY2VsbCB0eXBlPC90aXRsZT4KICAgIDxnIGlkPSJEYXRhLW9iamVjdC1jZWxsLXR5cGUiIHN0cm9rZT0ibm9uZSIgc3Ryb2tlLXdpZHRoPSIxIiBmaWxsPSJub25lIiBmaWxsLXJ1bGU9ImV2ZW5vZGQiPgogICAgICAgIDxwYXRoIGQ9Ik0xMyw4LjcxNDI4NTcxIEwxMywxMS41NzE0Mjg2IEMxMywxMi4zNjA0OTExIDEwLjk4NTgxNzMsMTMgOC41LDEzIEM2LjAxNDE4MjY5LDEzIDQsMTIuMzYwNDkxMSA0LDExLjU3MTQyODYgTDQsOC43MTQyODU3MSBDNCw5LjUwMzM0ODIxIDYuMDE0MTgyNjksMTAuMTQyODU3MSA4LjUsMTAuMTQyODU3MSBDMTAuOTg1ODE3MywxMC4xNDI4NTcxIDEzLDkuNTAzMzQ4MjEgMTMsOC43MTQyODU3MSBaIE0xMyw1LjE0Mjg1NzE0IEwxMyw4IEMxMyw4Ljc4OTA2MjUgMTAuOTg1ODE3Myw5LjQyODU3MTQzIDguNSw5LjQyODU3MTQzIEM2LjAxNDE4MjY5LDkuNDI4NTcxNDMgNCw4Ljc4OTA2MjUgNCw4IEw0LDUuMTQyODU3MTQgQzQsNS45MzE5MTk2NCA2LjAxNDE4MjY5LDYuNTcxNDI4NTcgOC41LDYuNTcxNDI4NTcgQzEwLjk4NTgxNzMsNi41NzE0Mjg1NyAxMyw1LjkzMTkxOTY0IDEzLDUuMTQyODU3MTQgWiBNOC41LDMgQzEwLjk4NTgxNzMsMyAxMywzLjYzOTUwODkzIDEzLDQuNDI4NTcxNDMgQzEzLDUuMjE3NjMzOTMgMTAuOTg1ODE3Myw1Ljg1NzE0Mjg2IDguNSw1Ljg1NzE0Mjg2IEM2LjAxNDE4MjY5LDUuODU3MTQyODYgNCw1LjIxNzYzMzkzIDQsNC40Mjg1NzE0MyBDNCwzLjYzOTUwODkzIDYuMDE0MTgyNjksMyA4LjUsMyBaIiBpZD0i5b2i54q257uT5ZCIIiBmaWxsPSIjMzY3RkNBIiBmaWxsLXJ1bGU9Im5vbnplcm8iPjwvcGF0aD4KICAgIDwvZz4KPC9zdmc+"}],n.dropDowns=[{type:l.DropDownType.list,option:{items:e,dropDownAlignment:0,dropDownDirection:3},submitCommand:function(t,n,e){for(var i,r,o,a,u,i=f("SheetsCalc"),r=e.sheetArea,o=e.col+1;o<t.getColumnCount(r);o++){if(t.options.isProtected&&t.getCell(e.row,o,r).locked()){t.jT(16,h().DataObject_MeetLock);break}if(t.Ut.findSpan(e.row,o,r)){t.jT(16,h().DataObject_MeetSpan);break}if(3===r&&t.tables&&t.tables.find(e.row,o)||t.pivotTables&&t.pivotTables.findPivotTable(e.row,o)){t.jT(16,h().DataObject_MeetTable);break}if(d(t.getValue(e.row,o,r))){a=i.rangesToFormula([new l.Range(e.row,e.col,1,1)],c,o,15,1===s.parent.options.referenceStyle),u=e.path,t.Qy().execute({cmd:"editCell",sheetName:t.name(),row:e.row,col:o,sheetArea:r,newValue:"="+a+'."'+u+'"',autoFormat:!1});break}}}}]):(n.cellButtons=a,n.dropDowns=a),n.formatter&&l.util.St(n.formatter)&&s.SL(c,t,n.formatter)},c.prototype.paint=function(t,n,e,i,r,o,a,u){this.pU===a.formatter&&!this.bU||(this.Xe(u.sheet,u.row,u.col,n,u.sheetArea),this.bU=!1),s.prototype.paint.call(this,t,n,e,i,r,o,a,u)},c.prototype.toJSON=function(){return{typeName:this.typeName,format:this.pU}},c.prototype.fromJSON=function(t){this.pU=t.format,this.bU=!0},n.DataObject=r=c,l.CellTypes.ti[18]=r},"./dist/plugins/celltype/dropdown-action.js":function(s,t,n){"use strict";var p,d,v,m,g,b,y,w,M,t,C,S,T,A,e,i,I,n,x,N,k,D,_,E,j,O,R,B,r,o,L,a;function F(t,n){return r.createElement(t,n)}function u(h){return{canUndo:!1,execute:function(t,n,e){var i,t,r,o,a,u,s,c,f,l,i=(0,p._f)(t,n.sheetName);if(!i||t.jg().name()!==n.sheetName)return!1;if(t=n.row,r=n.col,(A(t)||A(r))&&(t=i.getActiveRowIndex(),r=i.getActiveColumnIndex()),o=n.sheetArea,A(o)&&(o=3),t<0||t>=i.getRowCount(o)||r<0||r>=i.getColumnCount(o))return!1;switch(i.showCell(t,r,p.VerticalPosition.nearest,p.HorizontalPosition.nearest),s=i.getCellRect(t,r,a=1===o?-1:void 0,u=2===o?-1:void 0),c=F("div"),f=P(i,t,r,o),(A(n.row)||A(n.col))&&(n.row=i.getActiveRowIndex(),n.col=i.getActiveColumnIndex()),h){case N:l=new y.ColorPicker(c);break;case k:f=G(f,"date"),l=new M.Calendar(c);break;case D:f=G(f,"date"),l=new g.TimePicker(c);break;case _:f=(f=G(f,"number")).toString(),l=new d.Calculator(c);break;case E:f=G(f,"date"),l=new b.MonthPicker(c);break;case j:(l=new v.List(c)).formula=i.getFormula(n.row,n.col);break;case O:f=G(f,"number"),l=new m.Slider(c);break;case R:l=new S.WorkFlow(c),"string"!=typeof f&&f!==I&&(f=f.toString());break;case B:l=new T.MultiColumn(c,I,i)}return V(l,h,f,s,i,n),!0}}}function P(t,n,e,i){var r,o;return t.isEditing()?(r=t.getCellType(n,e)).getEditorValue(t.li,o={sheet:t,row:n,col:e,sheetArea:i}):t.getValue(n,e,i)}function G(t,n){return"date"===n?"string"==typeof t?(t=i.yU(t))===I&&(t=new Date):t instanceof Date||(t=new Date):"number"===n&&("string"==typeof t?t=e.yU(t):"number"!=typeof t&&(t=0)),t}function U(t,n,e,i){var r,o,a,u,e,n,u,a,r=e.row,o=e.col;(A(r)||A(o))&&(r=t.getActiveRowIndex(),o=t.getActiveColumnIndex()),a=e.sheetArea,A(a)&&(a=3),n&&n.submitCommand?"string"==typeof n.submitCommand?t.getParent().commandManager().execute({cmd:n.submitCommand,sheetName:t.name(),row:r,col:o,newValue:i.value}):"function"==typeof n.submitCommand&&((u={}).row=e.row,u.col=e.col,u.sheetArea=a,u.path=i.path,n.submitCommand.call(null,t,i.value,u)):(t.getParent().commandManager().execute({cmd:"editCell",sheetName:t.name(),row:r,col:o,newValue:i.text,autoFormat:!i.noAutoFormat,sheetArea:a,isUndo:!1}),t.isEditing()&&t.ci===o&&t.ui===r&&(e=t.getCellType(r,o),n={sheet:t,row:r,col:o,sheetArea:p.SheetArea.viewport},u=t.Il(r,o,a),a=t.getCellRect(r,o),t.li.Li=i.value,e.updateEditor(t.li,u,a,n),e.setEditorValue(t.li,i.text,n)))}function H(t){var n=-1;switch(t){case N:n=p.DropDownType.colorPicker;break;case k:n=p.DropDownType.dateTimePicker;break;case D:n=p.DropDownType.timePicker;break;case _:n=p.DropDownType.calculator;break;case E:n=p.DropDownType.monthPicker;break;case j:n=p.DropDownType.list;break;case O:n=p.DropDownType.slider;break;case R:n=p.DropDownType.workflowList;break;case B:n=p.DropDownType.multiColumn}return n}function z(t,n,e,i,r){var n,n,n=n.cellButtons;t&&n&&0<n.length&&(n=t.Ut.getValueForKey(e,i,o,r))&&n.isMouseDownReservedLocation&&(n.buttonDownIndex=-1,n.isMouseDownReservedLocation=!1,t.repaint(t.getCellRect(e,i)))}function V(n,t,e,i,r,o){var a,u,s,c,f,l,h,d,t,v,m,t,t,s,e,t,t,s,e,i,g;x.ef(),a=r.parent,u=r.qc(),c=o.row,f=o.col,l=o.sheetArea,h=r.Il(c,f,l),d=H(t),(m=(t=h.dropDowns)&&0<t.length)&&(t=t.filter(function(t){return t.type===d})[0])&&(void 0!==t.option&&null!==t.option&&(s=t.option),v=t),n.setOptions(s),n.setValue(e),t=u.getBoundingClientRect(),s=i.x+t.left,e=i.y+t.top,(t=Y(a))&&(s+=t.x,e+=t.y),t=new w.Rectangle(s,e,i.width,i.height),e=(s=n.getOptions())&&!A(s.dropDownAlignment)?s.dropDownAlignment:p.DropDownAlignment.Far,i=s&&!A(s.dropDownDirection)?s.dropDownDirection:void 0,g=new w.PopupControl(n.getContainer(),t,{align:e,hostElement:u,direction:i}),L+=1,m&&n.wU(),g.open(),n.scrollToSelect(),m&&n.refresh(),n.on(C.BaseDropdown.Event_ValueChanged,function(t){t.notCloseDropDown||g.close(),Z(o,t)&&U(r,v,o,t)}),a&&(a.CC=a.CC||[],a.CC.push(g)),n.getContainer().addEventListener("contextmenu",function(t){t.stopPropagation(),t.preventDefault()}),g.on("close",function(){z(r,h,c,f,l),n&&n.dispose(),--L,g=null;var t=a.CC.indexOf(g);a.CC.splice(t,1),x.cf()})}function Y(t){var n,e,i,r;if(t&&(n=t.options.tabStripVisible)&&0!==(e=t.options.tabStripPosition)){switch(i={x:0,y:0},r=t.w2.kg,e){case 1:i.y=r.height;break;case 2:i.x=r.width}return i}}function Z(t,n){return!0!==n.notSubmit&&(3===t.sheetArea||t.cmd!==_||!isNaN(n.value))}Object.defineProperty(t,"__esModule",{value:!0}),t.commands=void 0,p=n("Core"),Object.defineProperty(t,"commands",{enumerable:!0,get:function(){return p.Commands}}),d=n("./dist/plugins/celltype/editor/calculator.js"),v=n("./dist/plugins/celltype/editor/listControl.js"),m=n("./dist/plugins/celltype/editor/slider.js"),g=n("./dist/plugins/celltype/editor/timepicker.js"),b=n("./dist/plugins/celltype/editor/monthPicker.js"),y=n("./dist/plugins/celltype/editor/colorpicker.js"),w=n("./dist/plugins/celltype/editor/popupControl.js"),M=n("./dist/plugins/celltype/editor/calendar.js"),t=n("Common"),C=n("./dist/plugins/celltype/editor/baseControl.js"),S=n("./dist/plugins/celltype/editor/workflowPicker.js"),T=n("./dist/plugins/celltype/editor/multiColumnPicker.js"),A=t.Common.lt.ht,e=t.Common.st,i=t.Common.ct,I=null,n=window,x=n.Vc,N="openColorPicker",k="openDateTimePicker",D="openTimePicker",_="openCalculator",E="openMonthPicker",j="openList",O="openSlider",R="openWorkflowList",B="openMultiColumn",r=document,o="_cellButtonParam",p.Commands[N]=u(N),p.Commands[k]=u(k),p.Commands[D]=u(D),p.Commands[_]=u(_),p.Commands[E]=u(E),p.Commands[j]=u(j),p.Commands[O]=u(O),p.Commands[R]=u(R),p.Commands[B]=u(B),L=0,p.Workbook.ch("registerOpendropdownCommand",a={init:function(){this.commandManager().register(N,p.Commands[N]),this.commandManager().register(k,p.Commands[k]),this.commandManager().register(D,p.Commands[D]),this.commandManager().register(_,p.Commands[_]),this.commandManager().register(E,p.Commands[E]),this.commandManager().register(j,p.Commands[j]),this.commandManager().register(O,p.Commands[O]),this.commandManager().register(R,p.Commands[R]),this.commandManager().register(B,p.Commands[B])}}),p.Worksheet.ch("registerOpendropdownCommand",{preProcessMouseWheel:function(t){0<L&&!this.RD&&(t.r=!0)}})},"./dist/plugins/celltype/editor/baseControl.js":function(t,n,e){"use strict";var i,e,r,o,a,u,s;function c(t){var n=u.call(this)||this;return n.Wc=t,n}function f(t){var n=s.call(this)||this;return n.Ti=t,n}i=this&&this.__extends||(a=function(t,n){return(a=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(t,n){t.__proto__=n}:function(t,n){for(var e in n)Object.prototype.hasOwnProperty.call(n,e)&&(t[e]=n[e])}))(t,n)},function(t,n){if("function"!=typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function e(){this.constructor=t}a(t,n),t.prototype=null===n?Object.create(n):(e.prototype=n.prototype,new e)}),Object.defineProperty(n,"__esModule",{value:!0}),n.BaseDropdown=n.BaseControl=void 0,e=e("./dist/plugins/celltype/editor/eventbase.js"),u=e.EventBase,i(c,u),c.prototype.init=function(t,n,e){this.Ti=this.Wc.querySelector("."+n),this.Ti?this.RemoveChilds(this.Ti):(this.Ti=this.CreateElement(t,n,e),this.Wc.appendChild(this.Ti))},c.prototype.GetContainer=function(){return this.Wc},c.prototype.RemoveChilds=function(t){for(;t.firstChild;)t.removeChild(t.firstChild)},c.prototype.CreateElement=function(t,n,e,i){var r,o,r=document.createElement(t);if(n&&(r.className=n),e)for(o in e)e[o]&&r.setAttribute(o,e[o]);return i&&i.appendChild(r),r},n.BaseControl=c,s=e.EventBase,i(f,s),f.prototype.getOptions=function(){return this.MU},f.prototype.updateStyle=function(t,n,e){},f.prototype.scrollToSelect=function(){},f.prototype.getContainer=function(){return this.Ti},f.prototype.refresh=function(){},f.prototype.wU=function(){},f.prototype.dispose=function(){},f.Event_ValueChanged="ValueChangedEvent",n.BaseDropdown=f},"./dist/plugins/celltype/editor/baseSpreadPicker.js":function(t,n,e){"use strict";var i,r,o,e,l,h,d,a,u,s,c,f,v,m,g;function p(t,n,e){var t=g.call(this,t)||this;return t.setOptions(n),t.CU=e,t}function b(t,n,e){var i={sheet:t};l(e)||(i.isEsc=e),t.ki(n,i)}i=this&&this.__extends||(m=function(t,n){return(m=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(t,n){t.__proto__=n}:function(t,n){for(var e in n)Object.prototype.hasOwnProperty.call(n,e)&&(t[e]=n[e])}))(t,n)},function(t,n){if("function"!=typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function e(){this.constructor=t}m(t,n),t.prototype=null===n?Object.create(n):(e.prototype=n.prototype,new e)}),Object.defineProperty(n,"__esModule",{value:!0}),n.BaseSpreadPicker=void 0,r=e("./dist/plugins/celltype/editor/baseControl.js"),o=e("Core"),e=e("Common"),l=e.Common.lt.ht,h=Math.min,d=Math.max,a=null,u=".baseSpreadNS",s=800,c=400,f=100,g=r.BaseDropdown,i(p,g),p.prototype.setOptions=function(t){var n,t,n,n=this;(n.MU=t)&&(t=n.Ti,(n=document.createElement("div")).setAttribute("class","gc-base-spread-div"),t.appendChild(n),this.SU=n,this.TU=this.AU(n))},p.prototype.setValue=function(t){var n,e,n=this;n.MU&&(e=n.TU,setTimeout(function(){var t;window.Vc.cf(),e&&e.focus(!0)},1e3))},p.prototype.wU=function(){var t,n,e,i,r,e,t=this;t.SU&&(n=t.Ti,(e=t.MU)&&(i=e.width,r=e.height),e=t.IU(i,r),l(i)&&(i=e.width),l(r)&&(r=e.height),(0,o.GC$)(n).width(i).height(r))},p.prototype.refresh=function(){this.TU&&this.TU.refresh()},p.prototype.dispose=function(){var t=this;t.CU&&(t.CU.Zg(),t.CU=a),t.SU&&(t.SU=a),t.TU&&(t.TU.unbind(o.Events.DropdownSpreadMouseClick+u),t.TU.unbind(o.Events.DropdownSpreadKeyboardEnter+u),t.TU.L0(),t.TU=a)},p.prototype.IU=function(t,n){for(var e,i,r,o,a,u,s,c,c,t,t,n,f,e,i=this.TU,r=i.getActiveSheet(),o=r.getColumnCount(),a=0,u=0;u<o;u++)a+=r.getColumnWidth(u,3);return s=a,c=r.getRowCount(3)+r.getRowCount(1),c=r.getRowHeight(0,3)*c,s<800&&l(t)||s<=t?i.options.showHorizontalScrollbar=!1:(t=0,c+=t=i.zb?i.zb.ZC():t),c<400&&l(n)||c<n?i.options.showVerticalScrollbar=!1:(t=0,s+=t=(n=i.Xb)?(f=n.lS(!1))||i.NC():t),{width:h(s,800),height:h(d(c,100),400)}},p.prototype.AU=function(t){var t,n,e,i,t=new o.Workbook(t,{sheetCount:1});return t.xU=!0,(n=t.options).allowUserDragDrop=!1,n.allowUserDragFill=!1,n.allowUserResize=!1,n.allowUserZoom=!1,n.tabStripVisible=!1,n.allowContextMenu=!1,n.allowUserDeselect=!1,n.scrollbarMaxAlign=!0,(e=t.getActiveSheet()).RD=!0,i=this,t.bind(o.Events.DropdownSpreadMouseClick+u,function(t,n){i.submitData(n)}),t.bind(o.Events.DropdownSpreadKeyboardEnter+u,function(t,n){i.submitData(n)}),t},p.prototype.submitData=function(t){},n.BaseSpreadPicker=p,o.GC$.extend(o.Worksheet.prototype,{BD:function(){b(this,o.Events.DropdownSpreadMouseClick)},GD:function(t){b(this,o.Events.DropdownSpreadKeyboardEnter,t)}})},"./dist/plugins/celltype/editor/calculator.js":function(t,n,e){"use strict";var i,o,r,a,u,s,e,c,f,l,h,d,v,m,g,p,b,y,w,M,C,S,T;function A(t){var t=parseInt(window.getComputedStyle(t)["font-size"].replace("px",""),0);return t=isNaN(t)?0:t}function I(){}function x(){}function N(){}function k(t,n,e,i,r,o,a,u,s,c,f){var l=this;l.Y6=t,l._x=n,l._y=e,l.NU=i,l.kU=r,l.DU=o,l._U=a,l.EU=u,l.jU=s,l.OU=c,l.RU=f,l.BU=p}function D(t){var n,e,i,n=T.call(this,t)||this,e=n;return e.Ti=document.createElement("div"),e.Ti.classList.add("gc-calculator-container"),e.Ti.innerHTML=f,(i=e.Ti.querySelector(".okbtn")).textContent=c().OK,t.appendChild(n.Ti),e.LU(),e.FU(),e.PU(),e.GU(),e.UU("0"),n}i=this&&this.__extends||(S=function(t,n){return(S=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(t,n){t.__proto__=n}:function(t,n){for(var e in n)Object.prototype.hasOwnProperty.call(n,e)&&(t[e]=n[e])}))(t,n)},function(t,n){if("function"!=typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function e(){this.constructor=t}S(t,n),t.prototype=null===n?Object.create(n):(e.prototype=n.prototype,new e)}),Object.defineProperty(n,"__esModule",{value:!0}),n.Calculator=n.CalculatorErrorInfo=void 0,o=e("./dist/plugins/celltype/editor/baseControl.js"),r=e("./dist/plugins/celltype/celltypes.ns.js"),a=e("Common"),u=e("Core"),s=u.Bf.Zl,e=new a.Common.ResourceManager(r.SR,"CellTypes"),c=e.getResource.bind(e),f='\n<div class="gc-calculator">\n    <header class="gc-top-part">\n        <div class="gc-screen">\n            <div class="gc-main-screen">\n                <input class="gc-main" value="" type="text" disabled readonly="readonly"></div>\n        </div>\n    </header>\n    <section class="gc-bottom-part">\n        <div class="gc-features">\n            <div class="gc-sub-menu">\n                <div class="gc-row">\n                    <div class="percentage button image icon-group1" data-value="%" role="button">\n                        <img class="icon icons8-Percentage" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAABK0lEQVRYR+2WYQ3CMBCFvznAAgrAAeAAHOAACYADHCABJIACcAA4wAHkkpYM6K7XZs3+rAnZYNf169u7Nyo6HlXH69MD9ArEFJgDK2AKnICtO2re3bk5D2AMPLViDUAWPwQmzxQIWfDi5iyAY6zLNIArMHK73gDyWQNnp0jo3qLSJFLzNU8DeLnKek3oN3/DJbB3X4bAPbZ7ud4WwAC4AXIUn4haptEWQJLx6mRtACQbzwrgTShyellDJkw2nhXA0oZZxrMCSJ0EkCjgW0vOZccyso2XApCTeEnpGYviJoAm41kemzmItN03GS85PXMU0IyXmp7J/4hixisOEEu8ogCWxCsKYEk8a3p+DG41oTXxirRhzHi/7aql519rWxUwvdtzinqAXoHOFXgD+J9gIZOwvCMAAAAASUVORK5CYII="></div>\n                    <div class="sqrt button image icon-group1" data-value="sqrt" role="button">\n                        <img class="icon icons8-Square-Root" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAABP0lEQVRYR+3V4S0FQRQF4O9VgApQATrQASpABXSAClABOqCCRwWoABWgAnKTnWSzeV5mdkf2z55fm83sPWfPuXfuzMiYjcxvEjA5UNuBd6z/0dgLuWoK2MV8yVT9u4BbHOIC57njXcuBVXw2pJuIKLJQS8ARbvCA/Szm5lAtAS/YwjEiimzUELCNZ3wjoihCDQFXOME1TovYqbILvrCCHUQURRjqQGq+V0QUxVgm4KdVLcYqxquLe+z1ab5UKFdAnO92+AbemkJriCiKkRNBsrnrQjTcJe4QZ3ohR0AUTkum7UJ6d4CIohdyBXRdSIvnAxFFb+QKaLsQfxzXbfHiWaSyREBy4bEZubj1ihbPUAFBGLnHpRN4QkQxCCUOBFHs+bOGsXjxDHUgvk8upOdBfx8flzowmLBbYBIwOTC6A7+1/zEhMa617wAAAABJRU5ErkJggg=="></div>\n                    <div class="sqr button icon-group1" data-value="pow" role="button">\n                        <span class="x-sign">\n                            <sub>x</sub></span>\n                        <span>\n                            <sup>2</sup></span>\n                    </div>\n                    <div class="fraction button icon-group1" data-value="1/x" role="button">\n                        <span>\n                            <sup>1</sup></span>\n                        <span>&frasl;</span>\n                        <span class="x-sign">\n                            <sub>\n                                <em>x</em></sub>\n                        </span>\n                    </div>\n                </div>\n            </div>\n            <div class="gc-main-menu">\n                <div class="gc-row">\n                    <div class="clear-entry button icon-group1" data-value="CE" role="button">CE</div>\n                    <div class="clear button icon-group1" data-value="C" role="button">C</div>\n                    <div class="clear-element button image icon-group1" data-value="BS" role="button">BS</div>\n                    <div class="divide button image operation icon-group1" data-value="/" role="button">\n                        <img class="icon icons8-Divide" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAo0lEQVRYR+2VSxGDMBRFTxTUAkioklrAQSVAHSChjmqhdYCDMm8mCz7DIp/yurisQ+6Zk5u8gPMXnPMRgAyUGBiBWyzxE3jkFDoXwMLvm0ADGFIhcgEm4AJcY+ALeAOtJ8AHaM4CMNW95xFYtkF0ixImn7/9m9uBVNOH6wVwZOBbzfF6o13e3wL8SMB+W5WwxICmoaahpmGVx6rkGgpABqoYmAH2Lh4hfK3KfwAAAABJRU5ErkJggg=="></div>\n                </div>\n                <div class="gc-row">\n                    <div class="button number icon-group2" role="button" data-value="7">7</div>\n                    <div class="button number icon-group2" role="button" data-value="8">8</div>\n                    <div class="button number icon-group2" role="button" data-value="9">9</div>\n                    <div class="multiply button image operation icon-group1" data-value="*" role="button">\n                        <img class="icon icons8-Multiply" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAABBUlEQVRYR+2W6w3CMAyErxuwCYwAG7AJjAATMQKMUDZhBHQSQaFqYp8DqpDSn2nj+3J+NAMWfoaF9dEBugN/4cAewA3AQ+yYFYADgHNtn+UAxS8ARgA7AYLiVwCbF8CpBGEBMBBPvxYgcvE7gG0N3AIguAIhiTO4B8ALIYsrABZESFwFKEFwPRWcmfNpMXpTkO+b1gTfsdpl8YgDCSSH4FpIvBUg2c446px4OxpNQZ5zBlPmxEcZqABz1c6A6rAKOVBrNWVYhRzw9HkIwpMCj/hcd7gK0wJQxEMQFkD6Hat9nqeD94Hw75inarmQHGviLYNIvByVP7dS8DWh6I2oA3QHfu7AEzfHWCF+OOmJAAAAAElFTkSuQmCC"></div>\n                </div>\n                <div class="gc-row">\n                    <div class="button number icon-group2" role="button" data-value="4">4</div>\n                    <div class="button number icon-group2" role="button" data-value="5">5</div>\n                    <div class="button number icon-group2" role="button" data-value="6">6</div>\n                    <div class="minus button image operation icon-group1" data-value="-" role="button">\n                        <img class="icon icons8-Minus-Math-" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAARElEQVRYR+3V0Q0AMAQFQPYfuh1A+ql8nAF4LhIZw5XD80MAAgQIECCwVuA0fcmy8EtgPEATQG279gYIECBAgACBbwIXi38CITaYSB4AAAAASUVORK5CYII="></div>\n                </div>\n                <div class="gc-row">\n                    <div class="button number icon-group2" role="button" data-value="1">1</div>\n                    <div class="button number icon-group2" role="button" data-value="2">2</div>\n                    <div class="button number icon-group2" role="button" data-value="3">3</div>\n                    <div class="plus button image operation icon-group1" data-value="+" role="button">\n                        <img class="icon icons8-Plus-Math" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAWUlEQVRYR+2WMQoAIAgA9f+PrsWmEMQSEa7Z8rzEUmle2pxfABhvYFkPpQtJb7TEAGAAAxgoM3AO/v1YXoPPm4TtANHKy64AAAxgAANjDERB3bjXXzEA8w1s3k4WIU0YaEoAAAAASUVORK5CYII="></div>\n                </div>\n                <div class="gc-row">\n                    <div class="plus-minus button image icon-group1" data-value="+/-" role="button">\n                        <img class="icon icons8-Plus-Minus" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAYUlEQVRYR+2VMQ4AIAgD4f+P1gUdCakx1VB3pL0UcCM/J/c3CfiewIgMwUbgwmgsASLQg8ByiW7tdNIqY0gXkDnvkQEREIGnCaDLaddVFtFxk+wDCagQoN8CugCFUASuEpjXIBIhP3OSdgAAAABJRU5ErkJggg=="></div>\n                    <div class="button number icon-group2" role="button" data-value="0">0</div>\n                    <div class="dot button icon-group1" data-value="." role="button">.</div>\n                    <div class="equal button image operation icon-group1" data-value="=" role="button">\n                        <img class="icon icons8-Equal-Sign" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAQ0lEQVRYR+3U0Q0AMAQFQPYfuh1A+ikkPQMgF0/GcOXw/LAAAQIECLwETtOLLvPWLtAEUNs6wrUCUiAFBAgQIPCPwAX8vwQhcNJI5wAAAABJRU5ErkJggg==" width="32" height="32"></div>\n                </div>\n                <div class="gc-row">\n                    <div class="button okbtn icon-group1" role="button">OK</div>\n                </div>\n            </div>\n        </div>\n    </section>\n</div>\n',l=Math.floor,h=Math.abs,d=Math.pow,v=Math.round,m=Math.sqrt,g=Math.max,p=new Array("0","1","2","3","4","5","6","7","8","9","+/-",".","+","-","*","/","SQRT","%","1/x","=","MC","MR","MS","M+","BS","CE","C","POW"),I.Init=function(){var t;I.GetBrowserType(),I.IsIE=void 0!==I.ie||void 0!==I.edge},I.GetBrowserType=function(){try{var t=navigator.userAgent.toLowerCase();window.ActiveXObject?I.ie=t.match(/msie ([\d.]+)/)[1]:-1!==t.indexOf("edge")?I.edge=t.match(/edge\/([\d.]+)/)[1]:-1!==t.indexOf("firefox")&&(I.firefox=t.match(/firefox\/([\d.]+)/)[1]),-1!==t.indexOf("rv:")&&-1===t.indexOf("firefox")&&(I.ie=t.match(/rv:([\d.]+)/)[1])}catch(t){}},(b=I).Init(),x.IsErrorText=function(t){return t===c().Calculator_DivideByZeroInfo||t===c().Calculator_InvalidInputInfo||t===c().Calculator_SqrtParameterException||t===c().Calculator_OverFlowInfo},y=x,n.CalculatorErrorInfo=y,N.IsDotContained=function(t){var n;return-1!==(t+"").indexOf(".")},N.GetDotPosition=function(t){var n,e,i,n=t+"",e=0,i=0;for(i=n.length;0<i;i--){if("."===n.substring(i-1,i))return e;e++}return 0===i?0:e},N.FormatOutput=function(t){var n,e,i;if(null==t)return null;if(e=0,i=(n=t+"").length,N.IsDotContained(n))for(;"0"===n.substring(i-1,i)&&""!==n&&-1===n.indexOf("e");)n=n.substring(0,i-1),i--;return n},N.FormatResult=function(t){var n,e,t,i,r,o,r,n=(t=isNaN(t)?0:t)+"",e="";return t<0&&(e="-",n=n.substring(1,n.length)),t=n.length,i="",-1!==(r=n.indexOf("e"))&&(i=n.substring(r,t),t=(n=n.substring(0,r)).length),N.IsDotContained(n)&&16<t&&(o=0,n=1<parseFloat(n)?(o=N.GetDotPosition(n)-(t-16),n.toString().substring(0,17)):(o=N.GetDotPosition(n)-(t-17),n.toString().substring(0,18)),n=(0<o?v(parseFloat(n)*d(10,o))/d(10,o):v(parseFloat(n))).toString()),t=n.length,!N.IsDotContained(n)&&15<t&&(o=t-15,n=(v(parseFloat(n)/d(10,o))*d(10,o)).toString()),n=e+n+i,r=parseFloat(n),N.IsOverFlow(r.toString())?c().Calculator_OverFlowInfo:r},N.SingleMathOperation=function(t,n){var t,n,t=parseFloat(t);if(isNaN(t)&&(t=0),"SQRT"===n){if(t<0)return c().Calculator_InvalidInputInfo;t=m(t)}if("POW"===n&&(t=d(t,2)),"1/x"===n){if(0===t)return c().Calculator_DivideByZeroInfo;n=N.GetDotPosition(t.toString()),t=d(10,n)/(d(10,n)*t)}return N.FormatResult(t)},N.DoubleMathOperation=function(t,n,e){var t,n,i,r,o,a,t=parseFloat(t),n=parseFloat(n);if(N.IsDotContained(t.toString())||N.IsDotContained(n.toString())){if(o=r=0,N.IsDotContained(t.toString())&&(r=N.GetDotPosition(t.toString())),N.IsDotContained(n.toString())&&(o=N.GetDotPosition(n.toString())),a=g(r,o),"+"===e&&(i=((t*=d(10,a))+(n*=d(10,a)))/d(10,a)),"-"===e&&(i=((t*=d(10,a))-(n*=d(10,a)))/d(10,a)),"*"===e&&(i=(t*=d(10,r))*(n*=d(10,o))/d(10,r+o)),"/"===e){if(t*=d(10,a),0===(n*=d(10,a)))return c().Calculator_DivideByZeroInfo;i=t/n}"%"===e&&(i=(t*=d(10,r))*(n*=d(10,o))/d(10,r+o+2))}else{if("+"===e&&(i=t+n),"-"===e&&(i=t-n),"*"===e&&(i=t*n),"/"===e){if(0===n)return c().Calculator_DivideByZeroInfo;i=t/n}"%"===e&&(i=t*n/100)}return N.FormatResult(i)},N.IsOverFlow=function(t){var t=parseFloat(t);if(0!==t){if(79e27<t)return!0;if(t<1e-28&&-1e-28<t)return!0;if(t<-79e27)return!0}return!1},w=N,k.prototype.HU=function(){var t=this;t.Y6="",t._x=null,t._y=null,t.NU=null,t.kU=0,t.EU=!1,t.jU=!1},k.prototype.Click=function(t){var n,t,n=this;return 0<=t&&t<=11&&(n.OU&&(n.zU(t),n.OU=!1),n.VU(t),10!==t)&&(n.RU="ClickNumericButton"),(12<=t&&t<=19||27===t)&&(n.OU?(n.zU(t),n.OU=!1):(n.YU(t),n.RU="ClickMathButton")),24===t&&(n.OU&&(n.zU(t),n.OU=!1),n.ZU()),25!==t&&26!==t||(n.zU(t),n.OU=!1),n.OU?null:((t={}).outputText=n.WU(),y.IsErrorText(n.Y6)&&(n.OU=!0),t.result=void 0===n.Y6||null===n.Y6?"":n.Y6,t.x=n._x,t.y=n._y,t.operation=n.NU,t.token=n.kU,t.count=n.DU,t.memoryNumber=n._U,t.isBSCanUse=n.EU,t.isEqualClicked=n.jU,t.isOperationInvalid=n.OU,t.lastOperation=n.RU,t)},k.prototype.VU=function(t){var n=this;if(null!==n.Y6&&void 0!==n.Y6||(n.Y6=""),!(14<n.DU&&10!==t))switch(11!==t&&10!==t&&(0!==t||n.Y6+""!="0"&&""!==n.Y6)&&n.DU++,10!==t&&(n.EU=!0),n.kU){case 0:0<=t&&t<=9&&("ClickNumericButton"!==n.RU&&void 0!==n.RU&&null!==n.RU&&(n.Y6="0"),"0"===n.Y6&&0!==t?n.Y6=""+t:"0"!==n.Y6&&(n.Y6=n.Y6+""+t)),10===t&&(-1===n.Y6.toString().indexOf("e")?""!==n.Y6&&"0"!==n.Y6&&(-1===n.Y6.toString().indexOf("-")?n.Y6="-"+n.Y6:n.Y6=n.Y6.toString().substring(1,n.Y6.toString().length)):0<+n.Y6?n.Y6="-"+n.Y6:n.Y6=n.Y6.substring(1,n.Y6.length)),11===t&&("ClickNumericButton"!==n.RU&&void 0!==n.RU&&null!==n.RU&&(n.Y6="0."),""===n.Y6||w.IsDotContained(n.Y6)?""!==n.Y6&&w.IsDotContained(n.Y6)||(n.Y6="0."):n.Y6=n.Y6+"."),n.kU=1;break;case 1:0<=t&&t<=9&&("ClickNumericButton"!==n.RU&&void 0!==n.RU&&null!==n.RU&&(n.Y6="0"),"0"===n.Y6&&0===t||("0"===n.Y6&&0!==t?n.Y6=""+t:n.Y6=n.Y6+""+t)),10===t&&(-1===n.Y6.toString().indexOf("e")?""!==n.Y6&&"0"!==n.Y6&&(-1===n.Y6.toString().indexOf("-")?n.Y6="-"+n.Y6:n.Y6=n.Y6.toString().substring(1,n.Y6.toString().length)):0<+n.Y6?n.Y6="-"+n.Y6:n.Y6=n.Y6.substring(1,n.Y6.length)),11===t&&("ClickNumericButton"!==n.RU&&void 0!==n.RU&&null!==n.RU?n.Y6="0.":w.IsDotContained(n.Y6)||(""===n.Y6?n.Y6="0.":n.Y6=n.Y6+".")),n.jU||(n._y=n.Y6);break;case 2:0<=t&&t<=9&&(n.Y6="",n.Y6=n.Y6+t),11===t&&(n.Y6="0."),10===t&&(n.Y6="0"),n.kU=3,n._y=n.Y6;break;case 3:0<=t&&t<=9&&("ClickNumericButton"!==n.RU&&void 0!==n.RU&&null!==n.RU&&(n.Y6="0"),"0"===n.Y6&&0===t||("0"===n.Y6&&0!==t?n.Y6=""+t:n.Y6=n.Y6+""+t)),10===t&&(-1===n.Y6.toString().indexOf("e")?""!==n.Y6&&"0"!==n.Y6&&(-1===n.Y6.toString().indexOf("-")?n.Y6="-"+n.Y6:n.Y6=n.Y6.toString().substring(1,n.Y6.toString().length)):0<+n.Y6?n.Y6="-"+n.Y6:n.Y6=n.Y6.substring(1,n.Y6.length)),11===t&&("ClickNumericButton"!==n.RU&&null!==n.RU?n.Y6="0.":w.IsDotContained(n.Y6)||(""===n.Y6?n.Y6="0.":n.Y6=n.Y6+".")),n._y=n.Y6}},k.prototype.YU=function(t){var n=this;switch(n.DU=0,n.EU=!1,n.jU&&(n.jU=!1),n.Y6=w.FormatOutput(n.Y6),n.kU){case 0:""===n.Y6&&(n.Y6=0),(16<=t&&t<=18&&17!==t||27===t)&&(n.Y6=w.SingleMathOperation(n.Y6,n.BU[t]).toString(),y.IsErrorText(n.Y6)||(n._x=n.Y6),n.kU=1),12<=t&&t<=15&&(n.NU=t,n._x=n.Y6,n.kU=2),17===t&&n.HU();break;case 1:(16<=t&&t<=18&&17!==t||27===t)&&(n.Y6=w.SingleMathOperation(n.Y6,n.BU[t]).toString(),y.IsErrorText(n.Y6)||(null!==n.NU&&void 0!==n.NU&&null!==n._y&&void 0!==n._y?n._y=n.Y6:n._x=n.Y6)),19===t&&(null!==n.NU&&void 0!==n.NU&&null!==n._y&&void 0!==n._y?(n.Y6=w.DoubleMathOperation(n._x.toString(),n._y.toString(),n.BU[n.NU]).toString(),y.IsErrorText(n.Y6)||(n._x=n.Y6)):"-0."===n.Y6&&(n.Y6="0."),n.jU=!0,n.EU=!1),12<=t&&t<=15&&(n.NU=t,n._x=n.Y6,n.kU=2),17===t&&(null!==n.NU&&void 0!==n.NU?(n._y=n.Y6,n.Y6=w.DoubleMathOperation(n._x.toString(),n._y.toString(),n.BU[17]).toString(),n._y=n.Y6):n.HU());break;case 2:(16<=t&&t<=18&&17!==t||27===t)&&(n.Y6=w.SingleMathOperation(n.Y6,n.BU[t]).toString(),y.IsErrorText(n.Y6)||(n.kU=3,n._y=n.Y6)),19===t&&(n._y=n._x,n.Y6=w.DoubleMathOperation(n._x.toString(),n._x.toString(),n.BU[n.NU]).toString(),y.IsErrorText(n.Y6)||(n._x=n.Y6,n.kU=1,n.EU=!1),n.jU=!0),12<=t&&t<=15&&(n.NU=t,n._y=n.Y6),17===t&&(n.Y6=w.DoubleMathOperation(n._x.toString(),n._x.toString(),n.BU[17]),y.IsErrorText(n.Y6)||(n._y=n.Y6,n.kU=3));break;case 3:16<=t&&t<=18&&17!==t&&(n.Y6=w.SingleMathOperation(n.Y6,n.BU[t]).toString(),y.IsErrorText(n.Y6)||(n._y=n.Y6)),12<=t&&t<=15&&(n._y=n.Y6,n.Y6=w.DoubleMathOperation(n._x.toString(),n._y.toString(),n.BU[n.NU]).toString(),y.IsErrorText(n.Y6)||(n._x=n.Y6,n._y=null,n.NU=t,n.kU=2)),17===t&&(n.Y6=w.DoubleMathOperation(n._x.toString(),n._y.toString(),n.BU[17]),y.IsErrorText(n.Y6)||(n._y=n.Y6)),19===t&&(n._y=n.Y6,n.Y6=w.DoubleMathOperation(n._x.toString(),n._y.toString(),n.BU[n.NU]).toString(),y.IsErrorText(n.Y6)||(n._x=n.Y6,n.kU=1,n.EU=!1),n.jU=!0)}n.Y6+=""},k.prototype.ZU=function(){var t,n,e,t=this;if(0<t.DU&&t.DU--,(0===t.kU||1===t.kU||3===t.kU)&&!0===t.EU)switch(t.Y6+="",(n=0)<(e=t.Y6.length)&&(t.Y6=t.Y6.substring(0,e-1)),"-0"===t.Y6&&(t.Y6="0"),"-"===t.Y6&&(t.Y6=""),""===t.Y6&&(t.EU=!1),t.kU){case 0:case 1:t._x=t.Y6;break;case 3:t._y=t.Y6}},k.prototype.zU=function(t){var n=this;n.DU=0,n.EU=!1,n.Y6="",25===t&&(1!==n.kU||null===n.NU||void 0===n.NU||n.jU||(n._y=0),2===n.kU)&&(n.kU=3),26===t&&n.HU()},k.prototype.WU=function(){var t,n,t=this,n="";return n=""===t.Y6||null===t.Y6||void 0===t.Y6?"0":t.Y6},k.prototype.mf=function(t){var n=t.keyCode;switch(t.shiftKey&&(n|=65536),t.ctrlKey&&(n|=131072),t.altKey&&(n|=262144),n){case 131138:case 131140:case 131141:case 131144:case 131145:case 131148:case 131150:case 131154:case 131159:case 131188:case 262181:case 262183:case 117:case 65657:case 131081:case 196617:case 9:case 65545:case 121:case 123:return null;case 48:case 96:return 0;case 49:case 97:return 1;case 50:case 98:return 2;case 51:case 99:return 3;case 52:case 100:return 4;case 53:case 101:return 5;case 54:case 102:return 6;case 55:case 103:return 7;case 56:case 104:return 8;case 57:case 105:return 9;case 120:return 10;case 190:case 188:case 110:return 11;case 65723:case 107:return 12;case 65643:if(b.IsIE)break;return 12;case 189:case 109:return 13;case 65592:case 106:case 65722:return 14;case 191:case 111:return 15;case 65586:case 192:return 16;case 65589:return 17;case 82:return 18;case 13:return 19;case 393292:return 20;case 393298:return 21;case 393293:return 22;case 393296:return 23;case 8:return 24;case 46:return 25;case 27:case 131118:return 26;default:return 61===n&&b.firefox||187===n&&!b.firefox?19:-1}},M=k,T=o.BaseDropdown,i(D,T),D.prototype.setValue=function(t){var n,t,n=this;t=n.QU(t);try{if(!n.q8(t))throw new Error(c().Calculator_InvalidInputInfo);t=""===t?"0":t,n.Y6=n.KU(t),n._text=n.JU(t),n._x=parseFloat(n.Y6),n._y=null,n.NU=null,n.kU=0,n.DU=n.XU(parseFloat(n.Y6)),0<n.DU?n.EU=!0:n.EU=!1,n.jU=!1,n.OU=!1,n.RU=null}catch(t){n._text=c().Calculator_InvalidInputInfo,n.Y6="",n._x=null,n._y=null,n.OU=!0}return n.qU(n.OU),n.UU(n._text),(t={}).outputText=n._text,t.result=n.Y6,t.x=n._x,t.y=n._y,t.operation=n.NU,t.token=n.kU,t.count=n.DU,t.memoryNumber=n._U,t.isBSCanUse=n.EU,t.isEqualClicked=n.jU,t.isOperationInvalid=n.OU,t.lastOperation=n.RU,n.$U=new M(n.Y6,n._x,n._y,n.NU,n.kU,n.DU,n._U,n.EU,n.jU,n.OU,n.RU),n},D.prototype.setOptions=function(){},D.prototype.scrollToSelect=function(){var t=this.Ti.querySelector(".gc-main-screen .gc-main");this.tH(t)},D.prototype.LU=function(){var t=this;t.nH="0",t._text=t.nH,t.Y6="",t._x=0,t._y=0,t.NU=null,t.kU=0,t.DU=0,t._U=null,t.EU=!1,t.jU=!1,t.OU=!1,t.RU=null},D.prototype.FU=function(){var t=this;t.$U=new M(this.Y6,t._x,t._y,t.NU,t.kU,t.DU,t._U,t.EU,t.jU,t.OU,t.RU)},D.prototype.PU=function(){var t=this;t.qU(t.OU)},D.prototype.GU=function(){var e,i,r,t,n,e=this,i=this,r=i.Ti,t,n=function(t){!0!==i.mf(t)&&(t.preventDefault(),t.stopPropagation())};r.addEventListener("click",function(t){for(var n,t,t,n=t.srcElement||t.target;n&&!n.classList.contains("button");)n=n.parentElement;n&&(n.getAttribute("data-value")?(t=n.getAttribute("data-value"),t=D.eH(t),r.focus(),-1!==t&&i.iH(t)):n.classList.contains("okbtn")&&("ClickNumericButton"===i.RU&&i.iH(19),e.fire(o.BaseDropdown.Event_ValueChanged,{value:i._text,text:i._text})))}),r.addEventListener("keydown",n),r.addEventListener("contextmenu",function(t){t.preventDefault(),t.stopPropagation()})},D.prototype.UU=function(t){var n,e,n=this.Ti.querySelector(".gc-main-screen .gc-main"),e=n.value;null!=e&&e.toString().replace(/\r\n/g,"\n")!==t.toString().replace(/\r\n/g,"\n")&&(n.value=t,this.tH(n))},D.prototype.tH=function(t){var n=this;if(null!==n.rH&&void 0!==n.rH||(n.rH=A(t)),n.oH(t))for(;n.oH(t);)n.aH(t);else n.uH(t)},D.prototype.oH=function(t){var n,n,e,i,n,r,o,n=s();return 1===n&&t.scrollWidth>t.clientWidth||1!==n&&1<Math.abs(t.scrollWidth-t.clientWidth)||!(!u.mt.Tt.edge&&!u.mt.Tt.msie||t.clientWidth<=0)&&(e=(n=window.getComputedStyle(t)).fontWeight,i=n.fontSize,n=n.fontFamily,(o=u.q.Wt(t.value,r=e+" "+i+" "+n))+40>t.clientWidth)},D.prototype.aH=function(t){var n=A(t);t.style.fontSize="".concat(n-1,"px")},D.prototype.uH=function(t){for(var n,e,n=this,e=A(t);!n.oH(t)&&e<n.rH;)if(t.style.fontSize="".concat(++e,"px"),n.oH(t)){for(;n.oH(t);)n.aH(t);break}},D.prototype.QU=function(t){if(void 0!==t&&("string"==typeof t||t instanceof String))return(t=null==t?"":t).toString();throw new Error(t+" type is not a string.")},D.prototype.sH=function(t,n){var e,i,r,o;if(0===n.length)return"";for(e="",r=i=0;i<n.length;i++){for(o=!1,r=0;r<t.length;r++)n.substring(i,i+1)===t.substring(r,r+1)&&(o=!0);!0===o&&(e+=n.substring(i,i+1))}return e},D.prototype.q8=function(t){var n;return this.sH("-.0123456789",t)===t&&(-1===(n=t.indexOf("-"))||0===n)&&t.indexOf("-")===t.lastIndexOf("-")&&t.indexOf(".")===t.lastIndexOf(".")},D.prototype.KU=function(t){var t,n,t,e,i,r,o,t=parseFloat(t),n=t<0?!0:!1,t=h(t),e=l(t),i=w.GetDotPosition(t.toString()),r=(t*d(10,i)-e*d(10,i))/d(10,i);if(999999999999999<e)throw new Error(c().Calculator_InvalidInputInfo);return 999999999999999!==e?(o=0===e?15:15-e.toString().length,r=v(r*d(10,o))/d(10,o),i=w.GetDotPosition(r.toString()),t=(e*d(10,i)+r*d(10,i))/d(10,i),e=l(t),i=w.GetDotPosition(t.toString()),0===(r=(t*d(10,i)-e*d(10,i))/d(10,i))&&(t=e),n?"-"+t:""+t):0===r?e:void 0},D.prototype.JU=function(t){var t=t.toString();return t=""===t?"0":t},D.prototype.XU=function(t){var t,n,e,t,i,r,t=h(t),n=l(t),e=w.GetDotPosition(t.toString()),t=(t*d(10,e)-n*d(10,e))/d(10,e),i,r;return(0===n?0:n.toString().length)+(0==t?0:e)},D.prototype.qU=function(t){for(var n=10;n<=18;n++)this.cH(n,t);this.cH(27,t)},D.prototype.cH=function(t,n){var t,t,t=p[t],t=this.Ti.querySelector('[data-value="'+t.toLowerCase()+'"]');t&&(n?t.classList.add("disabled"):t.classList.remove("disabled"))},D.eH=function(t){var n=-1;switch(t){case"0":case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":n=parseInt(t,10);break;case"+/-":n=10;break;case".":n=11;break;case"+":n=12;break;case"-":n=13;break;case"*":n=14;break;case"/":n=15;break;case"sqrt":n=16;break;case"%":n=17;break;case"1/x":n=18;break;case"=":n=19;break;case"MC":n=20;break;case"MR":n=21;break;case"MS":n=22;break;case"M+":n=23;break;case"BS":n=24;break;case"CE":n=25;break;case"C":n=26;break;case"pow":n=27;break;default:n=-1}return n},D.prototype.iH=function(t){var n,t,n=this,t=n.$U.Click(t);null!=t&&(null!==t.result&&void 0!==t.result&&(n.Y6=t.result),null!==t.outputText&&void 0!==t.outputText&&(n.nH=t.outputText,n._text=n.nH,n.UU(n.nH)),null!==t.isOperationInvalid&&void 0!==t.isOperationInvalid&&t.isOperationInvalid!==n.OU&&(n.OU=t.isOperationInvalid,n.qU(n.OU)),t.memoryNumber!==n._U&&(n._U=t.memoryNumber),t.lastOperation!==n.RU)&&(n.RU=t.lastOperation)},D.prototype.mf=function(t){var t=this.$U.mf(t);return null==t||-1!==t&&void this.iH(t)},n.Calculator=D},"./dist/plugins/celltype/editor/calendar.js":function(B,L,t){"use strict";var F,P,G,i,n,r,o,t,m,n,U,H,z,V,Y,Z,W,Q,J,K,f,g,X,q,$,tt,nt,et,it,rt,ot,p,b,l,at,h,c,ut,e,st,ct,y,w,M,C,S,d,v,ft,lt,ht,dt,T,A,vt,I,mt,u,s,gt,x,a,N,pt,bt,yt,wt,k,Mt,Ct,St,Tt,At,It,xt,t,Nt,kt;function D(t){return H.createElement(t)}function _(){}function Dt(){this.yearTds=[]}function _t(){this.monthTds=[]}function Et(){this.weekThs=[],this.dayTds=[]}function jt(){this.calendarYearSection=new pt,this.calendarMonthSection=new bt,this.calendarDaySection=new yt,this.timeItemLIs=[]}function E(){}function Ot(t,n,e,i){this.year=t,this.selected=!!n,this.disabled=!!e,this.focused=!!i}function Rt(t,n,e,i){this.month=t,this.selected=!!n,this.disabled=!!e,this.focused=!!i}function Bt(t,n,e,i){this.date=t,this.selected=!!n,this.disabled=!!e,this.focused=!!i}function j(t){this.owner=t,this.calendarPage=o.CalendarPage.month,this.oldSelectedData=null,this.selectedDate=new Date,this.focusDate=new Date(this.selectedDate.valueOf()),this.focusDateTimeIndex=-1,N.initResource()}function O(t){var n=Nt.call(this)||this;return n.fH=40,n.lH=100,n.hH=!1,n.jS=t,n}function R(t,n){var e=kt.call(this,t)||this;return e.dH=7,e.HG=!0,e._data=new Tt(e),e.Dn=new At(e),e.Dn.on(i.BaseDropdown.Event_ValueChanged,function(t){var n,n,n=(new r.Common.CultureInfo).DateTimeFormat,n=new r.Formatter.GeneralFormatter(n.defaultDatePattern).format(t.newValue);e.fire(i.BaseDropdown.Event_ValueChanged,{text:n,value:t.newValue})}),e.Dn.on(At.Event_GetHost,function(t){t.host=e.Ti}),e.Dn.createCalendarDom(),e.Dn.attachEvent(),e.setValue(new Date),e.Dn.showCalendarPage(o.CalendarPage.day),e.Dn.setCalendarActivePart(a.Date),n&&e.setOptions(n),e}F=this&&this.__extends||(xt=function(t,n){return(xt=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(t,n){t.__proto__=n}:function(t,n){for(var e in n)Object.prototype.hasOwnProperty.call(n,e)&&(t[e]=n[e])}))(t,n)},function(t,n){if("function"!=typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function e(){this.constructor=t}xt(t,n),t.prototype=null===n?Object.create(n):(e.prototype=n.prototype,new e)}),Object.defineProperty(L,"__esModule",{value:!0}),L.Calendar=void 0,P=t("./dist/plugins/celltype/editor/eventbase.js"),G=t("./dist/plugins/celltype/editor/timepicker.js"),i=t("./dist/plugins/celltype/editor/baseControl.js"),n=t("./dist/plugins/celltype/celltypes.ns.js"),r=t("Common"),o=t("Core"),t=new r.Common.ResourceManager(n.SR,"CellTypes"),m=t.getResource.bind(t),n=r.Common.lt,U=n.ht,H=document,z="gc-calendar-container",V="gc-date-time-container",Y="gc-date-part-container",Z="gc-time-part-container",W="gc-ok-button-container",Q="gc-date-container",J="gc-week-container",K="gc-today-container",f="gc-content-container",g="gc-header-container",X="gc-header-title",q="gc-content-td-date",$="gc-content-td-time",tt="gc-date-time-vertical-partline",nt="gc-date-time-horizontal-partline",et="gc-year-page",it="gc-year-select-div",rt="gc-month-page",ot="gc-day-page",p="gc-left-arrow",b="gc-right-arrow",l="gc-is-focused",at="gc-cl-select",h="gc-cl-is-selected",c="gc-cl-disabled-text",ut="gc-cl-select-container",e="gc-focus-part-indicator",st="gc-cl-datepicker",ct="gc-cl-dropdown",y="gc-cl-datepicker-filter",w="gc-cl-datepicker-filter-month",M="gc-cl-grid-align-spread",C="gc-cl-align-middle",S="gc-cl-button-icon-container",d="gc-cl-datepicker-month",v="gc-cl-day",ft="gc-cl-week",lt="gc-cl-show-inline-block",ht="gc-cl-p-bottom-x-small",dt="gc-cl-shrink-none",T="gc-cl-grow",A="gc-cl-grid",vt="gc-uiButton",I="gc-cl-button",mt="gc-cl-button-brand",u="year-index",s="month-index",gt="week-index",x="day-index",(t=a=a||{})[t.Date=1]="Date",t[t.Time=2]="Time",_.initResource=function(){_.resource={shortWeeks:[m().Calendar_ShortWeeks_1,m().Calendar_ShortWeeks_2,m().Calendar_ShortWeeks_3,m().Calendar_ShortWeeks_4,m().Calendar_ShortWeeks_5,m().Calendar_ShortWeeks_6,m().Calendar_ShortWeeks_7],shortMonths:[m().Calendar_ShortMonths_1,m().Calendar_ShortMonths_2,m().Calendar_ShortMonths_3,m().Calendar_ShortMonths_4,m().Calendar_ShortMonths_5,m().Calendar_ShortMonths_6,m().Calendar_ShortMonths_7,m().Calendar_ShortMonths_8,m().Calendar_ShortMonths_9,m().Calendar_ShortMonths_10,m().Calendar_ShortMonths_11,m().Calendar_ShortMonths_12],weeks:[m().Calendar_Weeks_7,m().Calendar_Weeks_1,m().Calendar_Weeks_2,m().Calendar_Weeks_3,m().Calendar_Weeks_4,m().Calendar_Weeks_5,m().Calendar_Weeks_6],months:[m().Calendar_Months_1,m().Calendar_Months_2,m().Calendar_Months_3,m().Calendar_Months_4,m().Calendar_Months_5,m().Calendar_Months_6,m().Calendar_Months_7,m().Calendar_Months_8,m().Calendar_Months_9,m().Calendar_Months_10,m().Calendar_Months_11,m().Calendar_Months_12],timePrefix:[m().Calendar_Time_AM,m().Calendar_Time_PM],eraNames:[m().Calendar_EraName_1,m().Calendar_EraName_2,m().Calendar_EraName_3,m().Calendar_EraName_4],earFirstYear:m().Calendar_FirstYear,today:m().Calendar_Today,lastMonth:m().Calendar_LastMonth,nextMonth:m().Calendar_NextMonth,lastYear:m().Calendar_LastYear,nextYear:m().Calendar_NextYear,lastTenYears:m().Calendar_LastTenYear,nextTenYears:m().Calendar_NextTenYear}},_.resource={shortWeeks:["Mon","Tue","Wed","Thu","Fri","Sat","Sun"],shortMonths:["Jan","Feb","Mar","Api","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],weeks:["Monday","Tuesday","Wednesday","Thursday","Friday","Saturday","Sunday"],months:["January","February","March","Apirl","May","June","July","August","September","October","November","December"],timePrefix:["AM","PM"],eraNames:["M","T","S","H"],earFirstYear:"1",today:"Today",lastMonth:"Go to previous month",nextMonth:"Go to next month",lastYear:"Go to previous year",nextYear:"Go to next year",lastTenYears:"Go to previous ten years",nextTenYears:"Go to next ten years"},N=_,pt=Dt,bt=_t,yt=Et,wt=jt,E.dateEqual=function(t,n,e){if(!t&&!n)return!0;if(!t)return!1;if(!n)return!1;try{return e?t.getFullYear()===n.getFullYear()&&t.getMonth()===n.getMonth()&&t.getDate()===n.getDate()&&t.getHours()===n.getHours()&&t.getMinutes()===n.getMinutes()&&t.getSeconds()===n.getSeconds():t.getFullYear()===n.getFullYear()&&t.getMonth()===n.getMonth()&&t.getDate()===n.getDate()}catch(t){return!1}},E.getMonthMaxDay=function(t,n){return-1!==[1,3,5,7,8,10,12].indexOf(n)?31:-1!==[4,6,9,11].indexOf(n)?30:t%4==0&&t%100!=0?29:28},E.isValidEraDate=function(t){return!(t<this.eraMin||t>this.eraMax)},E.addMilliseconds=function(t,n){var t=new Date(t.getFullYear(),t.getMonth(),t.getDate(),t.getHours(),t.getMinutes(),t.getSeconds());return t.setMilliseconds(t.getMilliseconds()+n),new Date(t.valueOf())},E.getEraDate=function(t){var n,e,i,n={era:-1,eraYear:-1};if(E.isValidEraDate(t))for(e=0;e<E.eraCount;e++)if(t<(i=e+1!==E.eraCount?E.eraDates[e+1]:E.addMilliseconds(E.eraMax,1))){n.era=e,n.eraYear=t.getFullYear()-E.eraDates[e].getFullYear()+1;break}return n},E.getEraYearString=function(t){var n,n,n=new Date(t,5,30),n=E.getEraDate(n);return-1===n.era||-1===n.eraYear?t.toString():t.toString()+"\u5e74"},E.getShortEraYearString=function(t){var t,t,n,t=new Date(t,11,31),t=E.getEraDate(t);return-1===t.era||-1===t.eraYear?"":(n=1===t.eraYear?N.resource.earFirstYear:t.eraYear,N.resource.eraNames[t.era]+n+"\u5e74")},E.getDateLocaleLabel=function(t){var n,t,e,i,r,n=t.getHours(),t=t.getMinutes(),e,i,r;return(n<12?N.resource.timePrefix[0]:N.resource.timePrefix[1])+" "+(0===n||12===n?"12":(n%12).toString())+":"+(t<10?"0"+t.toString():t.toString())},E.eraCount=4,E.eraMax=new Date(2087,11,31,23,59,59),E.eraMin=new Date(1868,8,8),E.eraDates=new Array(new Date(1868,8,8),new Date(1912,6,30),new Date(1926,11,25),new Date(1989,0,8)),k=E,Ot.prototype.getLabel=function(){return this.year.toString()},Mt=Ot,Rt.prototype.getLabel=function(){return N.resource.shortMonths[this.month]},Ct=Rt,Bt.prototype.getLabel=function(){return this.date.getDate().toString()},St=Bt,j.getMonthName=function(t){return N.resource.months[t]},j.getShortMonthName=function(t){return N.resource.shortMonths[t]},j.prototype.updateDayItems=function(){var t,n,e,i,r,o,a,u,s,c;for(this.dayItems=[],t=this.focusDate.getFullYear(),n=this.focusDate.getMonth(),u=a=((o=(i=(e=new Date(t,n,1)).getDay())-(r=this.owner.dH))<0?7+o:o)%7;0<u;u--)(s=new Date(t,n,1)).setDate(s.getDate()-u),c=new St(s,!1,!0,!1),this.dayItems.push(c);for(u=1;u<=42-a;u++)s=new Date(t,n,u),c=new St(s),s.getMonth()!==n&&(c.disabled=!0),k.dateEqual(s,this.selectedDate)&&(c.selected=!0),k.dateEqual(s,this.selectedDate)&&(c.selected=!0),k.dateEqual(s,this.focusDate)&&(c.focused=!0),this.dayItems.push(c)},j.prototype.updateMonthItems=function(){var t,n,e,i,t=this.selectedDate,n=this.focusDate;for(this.monthItems=[],e=0;e<12;e++)(i=new Ct(e)).selected=t&&t.getMonth()===e&&t.getFullYear()===n.getFullYear(),i.focused=n&&n.getMonth()===e,this.monthItems.push(i)},j.prototype.updateYearItems=function(){var t,n;for(this.yearItems=[],t=this.focusDateYearRangeStart-1;t<=this.focusDateYearRangeEnd+1;t++)(n=new Mt(t)).selected=this.selectedDate&&this.selectedDate.getFullYear()===t,n.focused=this.focusDate&&this.focusDate.getFullYear()===t,n.disabled=t<this.focusDateYearRangeStart||t>this.focusDateYearRangeEnd,this.yearItems.push(n)},j.prototype.updateYearRange=function(){this.focusDateYearRangeStart=10*Math.floor(this.focusDate.getFullYear()/10),this.focusDateYearRangeEnd=this.focusDateYearRangeStart+9},j.prototype.getShortWeekName=function(t){var n,e,n,e;return N.resource.shortWeeks[t=(this.owner.dH+t-1)%7]},j.prototype.getCurrentMonthName=function(){var t=this.focusDate.getMonth();return j.getMonthName(t)},Tt=j,Nt=P.EventBase,F(O,Nt),Object.defineProperty(O.prototype,"host",{get:function(){return this.jS.getContainer()},enumerable:!1,configurable:!0}),O.prototype.createCalendarDom=function(){var t,n,e,i,r,i,t,r,t=this.jS;this.mH=new wt,(n=D("div")).tabIndex=0,n.classList.add(z),t.HG?n.classList.add(V):n.classList.add(Q),e=D("table"),i=D("tr"),(r=D("td")).classList.add(q),t.HG&&r.classList.add($),r.appendChild(this.gH()),i.appendChild(r),e.appendChild(i),n.appendChild(e),t.HG&&(i=D("tr"),t=D("td"),r.appendChild(this.pH()),r.appendChild(this.bH()),t.appendChild(this.yH()),t.appendChild(this.wH()),i.appendChild(t),e.appendChild(i)),this.mH.outterContainerDiv=n,(r=this.host)&&(r.innerHTML="",r.appendChild(n))},O.prototype.wH=function(){var t,n,t=D("div");return t.classList.add(W),(n=D("button")).textContent=m().OK,n.className=I+" "+mt+" "+vt,t.appendChild(n),this.mH.okButton=n,t},O.prototype.pH=function(){var t=D("div");return t.classList.add(tt),t},O.prototype.yH=function(){var t=D("div");return t.classList.add(nt),t},O.prototype.gH=function(){var t=D("div");return t.className=Y+" "+st+" "+ct,t.tabIndex=0,t.appendChild(this.MH()),t.appendChild(this.CH()),t.appendChild(this.SH()),this.mH.dateContainerDiv=t},O.prototype.MH=function(){var t=D("div");return t.classList.add(et),t.appendChild(this.TH()),t.appendChild(this.AH()),t},O.prototype.TH=function(){var t,n,e,i,r,r,o,a,a,t=D("div");return t.className=g+" "+y+" "+A,(n=D("div")).className=w+" "+A+" "+M+" "+T,(e=D("div")).classList.add(C),(i=D("button")).className=I+" "+S,i.title=m().Calendar_LastTenYear,i.setAttribute("type","button"),(r=D("div")).classList.add(p),i.appendChild(r),(r=D("span")).classList.add(C),(o=D("button")).className=I+" "+S,o.title=m().Calendar_NextTenYear,o.setAttribute("type","button"),(a=D("div")).classList.add(b),o.appendChild(a),n.appendChild(i),n.appendChild(r),n.appendChild(o),(a=this.mH.calendarYearSection).headerDiv=t,a.lastYearRangeButton=i,a.focusDateYearRangeName=r,a.nextYearRangeButton=o,t.appendChild(n),t},O.prototype.AH=function(){var t,n,t=D("table");return t.className=f+" "+d,(n=D("div")).appendChild(t),this.mH.calendarYearSection.currentYearRangeTable=t,this.IH(),n},O.prototype.IH=function(){for(var t,n,e,i,r,o,a,t=this.mH.calendarYearSection,n=D("tbody"),e=0;e<3;e++){for(i=D("tr"),r=0;r<4;r++)(o=D("td")).setAttribute(u,(4*e+r).toString()),(a=D("span")).classList.add(v),a.setAttribute(u,(4*e+r).toString()),a.innerText=(4*e+r+1).toString(),o.appendChild(a),i.appendChild(o),t.yearTds.push(o);n.appendChild(i)}t.currentYearRangeTable.appendChild(n)},O.prototype.CH=function(){var t=D("div");return t.classList.add(rt),t.appendChild(this.xH()),t.appendChild(this.NH()),t},O.prototype.xH=function(){var t,n,e,i,r,r,o,a,a,t=D("div");return t.className=g+" "+y+" "+A,(n=D("div")).className=w+" "+A+" "+M+" "+T,(e=D("div")).classList.add(C),(i=D("button")).className=I+" "+S,i.title=m().Calendar_LastYear,i.setAttribute("type","button"),(r=D("div")).classList.add(p),i.appendChild(r),(r=D("span")).className=X+" "+C,(o=D("button")).className=I+" "+S,o.title=m().Calendar_NextYear,o.setAttribute("type","button"),(a=D("div")).classList.add(b),o.appendChild(a),n.appendChild(i),n.appendChild(r),n.appendChild(o),(a=this.mH.calendarMonthSection).headerDiv=t,a.lastYearButton=i,a.currentYearName=r,a.nextYearButton=o,t.appendChild(n),t},O.prototype.NH=function(){var t,n,t=D("table");return t.className=f+" "+d,(n=D("div")).appendChild(t),this.mH.calendarMonthSection.currentYearTable=t,this.kH(),n},O.prototype.kH=function(){for(var t,n,e,i,r,o,a,t=this.mH.calendarMonthSection,n=D("tbody"),e=0;e<3;e++){for(i=D("tr"),r=0;r<4;r++)(o=D("td")).setAttribute(s,(4*e+r+1).toString()),(a=D("span")).classList.add(v),a.setAttribute(s,(4*e+r+1).toString()),a.innerText=(4*e+r+1).toString(),o.appendChild(a),i.appendChild(o),t.monthTds.push(o);n.appendChild(i)}t.currentYearTable.appendChild(n)},O.prototype.SH=function(){var t=D("div");return t.classList.add(ot),t.appendChild(this._H()),t.appendChild(this.EH()),t.appendChild(this.jH()),t.appendChild(this.OH()),t},O.prototype._H=function(){var t,n,e,i,r,r,o,a,a,u,s,c,f,l,h,d,v,c,t=D("div");for(t.className=g+" "+y+" "+A,(n=D("div")).className=w+" "+A+" "+M+" "+T,(e=D("div")).classList.add(C),(i=D("button")).className=I+" "+S,i.title=m().Calendar_LastMonth,i.setAttribute("type","button"),(r=D("div")).classList.add(p),i.appendChild(r),(r=D("span")).className=X+" "+C,(o=D("button")).className=I+" "+S,o.title=m().Calendar_NextMonth,o.setAttribute("type","button"),(a=D("div")).classList.add(b),o.appendChild(a),n.appendChild(i),n.appendChild(r),n.appendChild(o),(a=D("div")).className=it+" "+dt,(u=D("div")).classList.add(ut),(s=D("select")).classList.add(at),f=(c=new Date).getFullYear()-this.lH,l=c.getFullYear()+this.fH,h=f;h<=l;h++)(d=D("option")).text=h.toString(),d.value=h.toString(),s.options.add(d);return(v=D("div")).classList.add(ut),u.appendChild(s),a.appendChild(u),t.appendChild(a),t.appendChild(n),(c=this.mH.calendarDaySection).headerDiv=t,c.lastMonthButton=i,c.currentMonthName=r,c.nextMonthButton=o,c.yearSelect=s,t},O.prototype.EH=function(){var t,n,e,i,r,o,a,t=D("div");for(t.className=J+" "+y+" "+A,(n=D("table")).className=f+" "+d,e=D("thead"),i=D("tr"),r=0;r<7;r++)(o=D("th")).setAttribute(gt,r.toString()),(a=D("span")).classList.add(ft),a.setAttribute(gt,r.toString()),a.innerText=this.jS._data.getShortWeekName(r),o.appendChild(a),i.appendChild(o),this.mH.calendarDaySection.weekThs.push(o);return e.appendChild(i),n.appendChild(e),t.appendChild(n),t},O.prototype.jH=function(){var t,n,e,i,r,o,a,u,s,c,t=this.mH.calendarDaySection,n=D("div"),e=D("div"),i=D("table");for(i.className=f+" "+d,r=D("tbody"),o=0;o<6;o++){for(a=D("tr"),u=0;u<7;u++)(s=D("td")).setAttribute(x,(7*o+u).toString()),(c=D("span")).classList.add(v),c.setAttribute(x,(7*o+u).toString()),s.appendChild(c),a.appendChild(s),t.dayTds.push(s);r.appendChild(a)}return i.appendChild(r),e.appendChild(i),n.appendChild(e),t.dayContentTable=i,n},O.prototype.OH=function(){var t,n,e,i,r,o,t=D("div");return t.classList.add(K),(n=D("table")).classList.add(f),e=D("tbody"),i=D("tr"),r=D("td"),(o=D("i")).className=lt+" "+ht,o.innerText=N.resource.today,r.appendChild(o),i.appendChild(r),e.appendChild(i),n.appendChild(e),t.appendChild(n),this.mH.calendarDaySection.todayTd=r,this.mH.calendarDaySection.todayTable=n,t},O.prototype.bH=function(){var n,t,n=this,t=D("div");return t.className=Z+" "+st+" "+ct,t.tabIndex=0,this.mH.timeContainerDiv=t,this.RH=new G.TimePicker(t),this.RH.setOptions({step:{minute:30},height:260}),this.RH.on(i.BaseDropdown.Event_ValueChanged,function(t){n.BH(t)}),t},O.prototype.updateCalendarDom=function(){this.LH(),this.jS.HG&&this.FH()},O.prototype.LH=function(){switch(this.jS._data.calendarPage){case o.CalendarPage.year:this.PH();break;case o.CalendarPage.month:this.GH();break;case o.CalendarPage.day:this.UH()}},O.prototype.HH=function(){var t,n,e,i,r,o,t,n,t=this.jS._data,n=this.mH.calendarDaySection,e=!1;for(n.currentMonthName.innerText=t.getCurrentMonthName(),i=t.focusDate.getFullYear(),r=n.yearSelect,o=0;o<r.options.length;o++)if(i.toString()===r.options[o].value){r.selectedIndex=o,e=!0;break}t=this.fH+this.lH+1,e?r.options[t]&&r.selectedIndex<=t-1&&r.options[t].remove():((n=D("option")).text=i.toString(),n.value=i.toString(),r.options[t]=n,r.selectedIndex=t)},O.prototype.PH=function(){var t,n,e,i,r,o,a,u,a,s,t=this.jS._data,n=this.mH.calendarYearSection;if(t.updateYearItems(),n.focusDateYearRangeName.innerText=t.focusDateYearRangeStart.toString()+" - "+t.focusDateYearRangeEnd.toString(),e=n.yearTds,0!==(i=t.yearItems).length)for(r=0;r<3;r++)for(o=0;o<4;o++)u=i[a=4*r+o],(s=(a=e[a]).querySelector("span")).innerText=u.getLabel(),u.disabled?a.classList.add(c):a.classList.remove(c),u.selected?a.classList.add(h):a.classList.remove(h),u.focused?s.classList.add(l):s.classList.remove(l)},O.prototype.GH=function(){var t,n,e,i,r,o,a,u,s,u,c,t=this.jS._data,n=this.mH.calendarMonthSection;for(t.updateMonthItems(),e=t.focusDate.getFullYear(),i=t.monthItems,r=n.monthTds,n.currentYearName.innerText=e.toString(),o=0;o<3;o++)for(a=0;a<4;a++)s=i[u=4*o+a],(c=(u=r[u]).querySelector("span")).innerText=s.getLabel(),s.selected?u.classList.add(h):u.classList.remove(h),s.focused?c.classList.add(l):c.classList.remove(l)},O.prototype.UH=function(){this.HH(),this.zH()},O.prototype.zH=function(){var t,n,e,i,r,o,a,o,u,t=this.jS._data;if(t.updateDayItems(),0!==(n=t.dayItems).length)for(e=this.mH.calendarDaySection.dayTds,i=0;i<6;i++)for(r=0;r<7;r++)a=n[o=7*i+r],(u=(o=e[o]).querySelector("span")).innerText=a.getLabel(),a.disabled?o.classList.add(c):o.classList.remove(c),a.focused?u.classList.add(l):u.classList.remove(l),a.selected?o.classList.add(h):o.classList.remove(h)},O.prototype.FH=function(){this.RH.setValue(this.jS._data.selectedDate)},O.prototype.attachEvent=function(){this.VH(),this.attachDateEvent(),this.jS.HG&&this.attachTimeEvent()},O.prototype.VH=function(){var n=this;this.mH.outterContainerDiv.addEventListener("keydown",function(t){n.YH(t)})},O.prototype.YH=function(t){9===t.keyCode?(this.jS.HG&&(this.jS._data.calendarActivePart===a.Date?this.setCalendarActivePart(a.Time):this.setCalendarActivePart(a.Date)),t.preventDefault()):this.jS._data.calendarActivePart===a.Date&&this.ZH(t)},O.prototype.ZH=function(t){switch(this.jS._data.calendarPage){case o.CalendarPage.year:this.WH(t);break;case o.CalendarPage.month:this.QH(t);break;case o.CalendarPage.day:this.KH(t)}},O.prototype.WH=function(t){var n,e,n=this.jS._data,e=n.focusDate;switch(t.keyCode){case 13:n.selectedDate=new Date(e.valueOf()),this.showCalendarPage(o.CalendarPage.month);break;case 32:n.selectedDate=new Date(e.valueOf());break;case 37:this.JH();break;case 39:this.XH();break;case 38:this.JH(4);break;case 40:t.ctrlKey||t.metaKey?this.qH():this.XH(4);break;case 36:e.setFullYear(n.focusDateYearRangeStart);break;case 35:e.setFullYear(n.focusDateYearRangeEnd);break;case 33:this.$H();break;case 34:this.tz()}n.updateYearRange(),this.LH()},O.prototype.QH=function(t){var n,e,n=this.jS._data,e=n.focusDate;switch(t.keyCode){case 13:n.selectedDate=new Date(e.valueOf()),this.showCalendarPage(o.CalendarPage.day);break;case 32:n.selectedDate=new Date(e.valueOf());break;case 37:this.nz();break;case 39:this.ez();break;case 38:t.ctrlKey||t.metaKey?this.iz():this.nz(4);break;case 40:t.ctrlKey||t.metaKey?this.rz():this.ez(4);break;case 36:e.setMonth(0);break;case 35:e.setMonth(11);break;case 33:this.JH();break;case 34:this.XH()}this.LH()},O.prototype.KH=function(t){var n,e,i,r,o,a,n=this.jS._data,e=n.focusDate,i=e.getFullYear(),r=e.getMonth(),o=e.getDate(),a=k.getMonthMaxDay(i,r+1);switch(t.keyCode){case 13:return n.selectedDate=new Date(e.valueOf()),void this.oz();case 32:n.selectedDate=new Date(e.valueOf());break;case 37:e.setDate(o-1);break;case 39:e.setDate(o+1);break;case 38:e.setDate(o-7);break;case 40:e.setDate(o+7);break;case 36:e.setDate(1);break;case 35:e.setDate(a);break;case 33:t.shiftKey?this.nz(12):this.nz();break;case 34:t.shiftKey?this.ez(12):this.ez()}n.selectedDate=new Date(e.valueOf()),this.LH()},O.prototype.attachDateEvent=function(){var n=this;this.mH.dateContainerDiv.addEventListener("click",function(t){var t=t.target;t&&(t===n.mH.calendarDaySection.yearSelect||t.parentElement===n.mH.calendarDaySection.yearSelect)||n.setCalendarActivePart(a.Date)}),this.attachYearEvent(),this.attachMonthEvent(),this.attachDayEvent()},O.prototype.attachYearEvent=function(){var n=this;this.mH.calendarYearSection.lastYearRangeButton.addEventListener("click",function(t){n.$H(),n.LH()}),this.mH.calendarYearSection.nextYearRangeButton.addEventListener("click",function(t){n.tz(),n.LH()}),this.mH.calendarYearSection.currentYearRangeTable.addEventListener("click",function(t){n.az(t)})},O.prototype.$H=function(){var t=this.jS._data;t.focusDateYearRangeStart-=10,t.focusDateYearRangeEnd=t.focusDateYearRangeStart+9,t.focusDate.setFullYear(t.focusDate.getFullYear()-10)},O.prototype.tz=function(){var t=this.jS._data;t.focusDateYearRangeStart+=10,t.focusDateYearRangeEnd=t.focusDateYearRangeStart+9,t.focusDate.setFullYear(t.focusDate.getFullYear()+10)},O.prototype.qH=function(){this.showCalendarPage(o.CalendarPage.month)},O.prototype.az=function(t){var t,t,n,n,t=t.srcElement||t.target;t&&(t=+t.getAttribute(u),0!==(n=this.jS._data.yearItems).length)&&(n=n[t],this.jS._data.focusDate.setFullYear(n.year),this.qH())},O.prototype.attachMonthEvent=function(){var n=this;this.mH.calendarMonthSection.lastYearButton.addEventListener("click",function(t){n.JH(),n.LH()}),this.mH.calendarMonthSection.nextYearButton.addEventListener("click",function(t){n.XH(),n.LH()}),this.mH.calendarMonthSection.currentYearName.addEventListener("click",function(t){n.iz()}),this.mH.calendarMonthSection.currentYearTable.addEventListener("click",function(t){n.uz(t)})},O.prototype.JH=function(t){var t,t,t=t||1,t=Math.max(this.jS._data.focusDate.getFullYear()-t,0);this.jS._data.focusDate.setFullYear(t)},O.prototype.XH=function(t){var t,t,t=t||1,t=Math.min(this.jS._data.focusDate.getFullYear()+t,9999);this.jS._data.focusDate.setFullYear(t)},O.prototype.iz=function(){this.jS._data.updateYearRange(),this.showCalendarPage(o.CalendarPage.year)},O.prototype.rz=function(){this.showCalendarPage(o.CalendarPage.day)},O.prototype.uz=function(t){var t,t,t=t.srcElement||t.target;t&&(t=+t.getAttribute(s),this.jS._data.focusDate.setMonth(t-1),this.rz())},O.prototype.attachDayEvent=function(){var n,t,n=this,t=this.mH.calendarDaySection;t.lastMonthButton.addEventListener("click",function(t){n.nz(),n.hH||n.LH()}),t.nextMonthButton.addEventListener("click",function(t){n.ez(),n.hH||n.LH()}),t.currentMonthName.addEventListener("click",function(t){n.cz()}),t.todayTable.addEventListener("click",function(t){n.fz()}),t.dayContentTable.addEventListener("click",function(t){n.lz(t)}),t.yearSelect.addEventListener("change",function(t){n.hz(t)}),this.mH.calendarDaySection.yearSelect.addEventListener("keydown",function(t){t.stopPropagation()})},O.prototype.nz=function(t){var n,t,e,t,i,r,e,n=this.jS._data,t=t||1,e=n.focusDate.getFullYear(),t=n.focusDate.getMonth()-t,i=n.focusDate.getDate();t<0&&(t+=12,--e),r=k.getMonthMaxDay(e,t+1),e=new Date(e,t,Math.min(i,r)),n.focusDate=e},O.prototype.ez=function(t){var n,t,e,t,i,r,e,n=this.jS._data,t=t||1,e=n.focusDate.getFullYear(),t=n.focusDate.getMonth()+t,i=n.focusDate.getDate();11<t&&(t-=12,e+=1),r=k.getMonthMaxDay(e,t+1),e=new Date(e,t,Math.min(i,r),n.focusDate.getHours(),n.focusDate.getMinutes(),n.focusDate.getSeconds()),n.focusDate=e},O.prototype.cz=function(){this.showCalendarPage(o.CalendarPage.month)},O.prototype.lz=function(t){var n,t,t,e,i,e,t,t,n=this.jS._data,t=t.srcElement||t.target;if(t){if(t=t.getAttribute(x),U(t))return;if(0===(e=n.dayItems).length)return;e=(i=e[+t]).date,t=(t=n.selectedDate)?new Date(t.valueOf()):new Date,n.selectedDate=new Date(e.getFullYear(),e.getMonth(),e.getDate(),t.getHours(),t.getMinutes(),t.getSeconds(),t.getMilliseconds()),n.focusDate=new Date(n.selectedDate.valueOf()),this.LH(),this.jS.HG||this.oz()}this.mH.dateContainerDiv.focus()},O.prototype.fz=function(){var t,n,n,e,t=this.jS,n=t._data.selectedDate,n=n?new Date(n.valueOf()):null,e=new Date;n&&(e.setHours(n.getHours()),e.setMinutes(n.getMinutes()),e.setSeconds(0)),t._data.selectedDate=e,t._data.focusDate=new Date(e.valueOf()),this.LH(),t.HG||this.oz()},O.prototype.hz=function(t){var t=t.srcElement||t.target;t&&(this.jS._data.focusDate.setFullYear(+t.value),this.updateCalendarDom())},O.prototype.attachTimeEvent=function(){var n=this;this.mH.timeContainerDiv.addEventListener("click",function(t){n.setCalendarActivePart(a.Time)}),this.mH.okButton.addEventListener("click",function(t){n.oz()})},O.prototype.BH=function(t){var n,e,t,n=this.jS._data,e=n.selectedDate?new Date(n.selectedDate.valueOf()):new Date,t=t.value;e.setHours(t.getHours()),e.setMinutes(t.getMinutes()),e.setSeconds(t.getSeconds()),n.selectedDate=e,n.focusDate=new Date(e.valueOf())},O.prototype.oz=function(){var t=this.jS._data;this.fire(i.BaseDropdown.Event_ValueChanged,{oldValue:t.oldSelectedData,newValue:t.selectedDate}),t.oldSelectedData=t.selectedDate},O.prototype.showCalendarPage=function(t){var n,e,i,n=this.host.querySelector("."+et),e=this.host.querySelector("."+rt),i=this.host.querySelector("."+ot);switch(n.style.display="none",e.style.display="none",i.style.display="none",t){case o.CalendarPage.year:n.style.display="";break;case o.CalendarPage.month:e.style.display="";break;case o.CalendarPage.day:i.style.display=""}this.jS._data.calendarPage=t,this.updateCalendarDom()},O.prototype.setCalendarActivePart=function(t){switch(this.jS._data.calendarActivePart=t,this.mH.dateContainerDiv.classList.remove(e),this.jS.HG&&this.mH.timeContainerDiv.classList.remove(e),t){case a.Date:this.jS.HG&&this.mH.dateContainerDiv.classList.add(e),this.mH.outterContainerDiv.focus();break;case a.Time:this.jS.HG&&this.mH.timeContainerDiv.classList.add(e),this.mH.outterContainerDiv.focus()}},O.Event_GetHost="GetHost",At=O,kt=i.BaseDropdown,F(R,kt),R.prototype.setOptions=function(t){var n,t;t&&(t.showTime||(this.HG=t.showTime,this.Dn.createCalendarDom(),this.Dn.attachEvent()),n=t&&t.calendarPage?t.calendarPage:o.CalendarPage.day,(t=t&&t.startDay?t.startDay:o.CalendarStartDay.saturday)!==this.dH&&(this.dH=t,this.Ti.innerHTML="",this.Dn.createCalendarDom(),this.Dn.attachEvent()),this.Dn.showCalendarPage(n),this.Dn.setCalendarActivePart(a.Date))},R.prototype.setValue=function(t){var n;isNaN(t.valueOf())||((n=this._data).selectedDate=t,n.oldSelectedData=new Date(t.valueOf()),n.focusDate=new Date(t.valueOf()),n.updateYearRange())},R.prototype.scrollToSelect=function(){this.Dn.updateCalendarDom()},L.Calendar=R},"./dist/plugins/celltype/editor/colorpicker.js":function(t,n,e){"use strict";var i,r,o,a,u,e,s,f,e,c,l,h,d;function v(t,n){var t=d.call(this,t)||this;return t.Hc(),t.setOptions(n),t}i=this&&this.__extends||(h=function(t,n){return(h=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(t,n){t.__proto__=n}:function(t,n){for(var e in n)Object.prototype.hasOwnProperty.call(n,e)&&(t[e]=n[e])}))(t,n)},function(t,n){if("function"!=typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function e(){this.constructor=t}h(t,n),t.prototype=null===n?Object.create(n):(e.prototype=n.prototype,new e)}),Object.defineProperty(n,"__esModule",{value:!0}),n.ColorPicker=void 0,r=e("./dist/plugins/celltype/editor/listControl.js"),o=e("Core"),a=e("./dist/plugins/celltype/editor/baseControl.js"),u=e("./dist/plugins/celltype/celltypes.ns.js"),e=e("Common"),s=e.Common.lt.ht,f="group-name",e=new e.Common.ResourceManager(u.SR,"CellTypes"),c=e.getResource.bind(e),d=a.BaseDropdown,i(v,d),v.prototype.setOptions=function(t){var n;t&&(this.options=this.options||{},s(t.colorBlockSize)||(n=parseInt(t.colorBlockSize,10),!isNaN(n)&&0<=n&&(this.options.colorBlockSize=t.colorBlockSize)),s(t.groups)||(this.options.groups=t.groups)),this._6()},v.prototype.setValue=function(t){s(t)||(this.vz=t,this.mz=null,this._6())},v.prototype.Hc=function(){for(var n,t,e,i,n=this,t=v.DefaultColorGroup(),e=[],i=0;i<t.length;i++)e.push({name:t[i].name,colors:t[i].colors,needScaleColor:t[i].needScaleColor});this.options={colorBlockSize:v.DefaultCellWidth,groups:e},this.gz=document.createElement("div"),this.gz.classList.add("gc-color-picker-outer-div"),this.gz.addEventListener("click",function(t){n.pz(t)}),this.Ti.appendChild(this.gz)},v.prototype._6=function(){this.gz.innerHTML="",new r.List(this.gz,this.bz()),this.yz()},v.prototype.yz=function(){var t,n,e,i,t=this.gz.querySelectorAll(".gc-color-picker-color-cell");if(0<t.length)for(n=0;n<t.length;n++)t[n].classList.remove("selected"),e=t[n].getAttribute("color"),i=t[n].getAttribute(f),this.vz===e&&(!this.mz||this.mz&&this.mz===i)&&t[n].classList.add("selected")},v.prototype.wz=function(){for(var t,n,e,i,r,o,t=0,n=this.options.groups,e=0;e<n.length;e++)for(i=n[e],r=0;r<i.colors.length;r++)o=i.colors[r],t=Math.max(t,o.length);return t},v.prototype.bz=function(){for(var t,n,e,i,r,o,o,t=[],n=this.options.colorBlockSize||v.DefaultCellWidth,e=this.wz(),i=this.options.groups,r=0;r<i.length;r++)o=this.Mz(i[r],n,e),t.push(o),i[r].needScaleColor&&(o=this.Cz(i[r].colors[0]),t.push(this.Mz(o,n,e)));return{items:t}},v.prototype.Cz=function(t){var n,e,i,r,o,a,u,s,c,f,l,h,d,v,m,g,n={},e=[],r=[-(i=e.length=5),-15,-25,-35,-50],o=[-10,-25,-50,-75,-90],a=[80,60,40,-25,-50],u=document.createElement("span"),s=t.length;u.style.display="none",document.body.appendChild(u);try{for(c=0;c<s;c++)for(l=(f=this.Sz(t[c],u))[0],h=f[1],d=f[2],v=this.Tz(l,h,d),m=0;m<5;m++)e[m]||((g=[]).length=s,e[m]=g),e[m][c]=1===v?this.Az(l,h,d,r[m]):.8<=v?this.Az(l,h,d,o[m]):0===v?this.Az(l,h,d,Math.abs(r[5-m-1])):v<=.2?this.Az(l,h,d,Math.abs(o[5-m-1])):this.Az(l,h,d,a[m]);n.colors=e}finally{document.body.removeChild(u)}return n},v.prototype.Sz=function(t,n){var e,i,r,o,t;return n.style.color=t,t=(o=window.getComputedStyle(n).color).replace(/(?:\(|\)|rgba|RGBA|rgb|RGB)*/g,"").split(","),[e=parseInt(t[0],10),i=parseInt(t[1],10),r=parseInt(t[2],10)]},v.prototype.Az=function(t,n,e,i){var t,n,e;return i/=100,t=this.Iz(t,n,e),n=parseInt((0<i?(240-t.luminosity)*i:t.luminosity*i).toString(),10),e=this.xz(t.hue,t.luminosity+n,t.saturation),this.Nz(e.r,e.g,e.b)},v.prototype.kz=function(t){var t=t.toString(16);return 1===t.length?"0"+t:t},v.prototype.Nz=function(t,n,e){return"#"+this.kz(t)+this.kz(n)+this.kz(e)},v.prototype.xz=function(t,n,e){var i,r,o,a,u;return 0===e?i=r=o=parseInt((255*n/240).toString(),10):(u=a=void 0,a=2*n-(u=n<=120?(n*(240+e)+120)/240:n+e-(n*e+120)/240),i=parseInt(((255*this.Dz(a,u,t+80)+120)/240).toString(),10),r=parseInt(((255*this.Dz(a,u,t)+120)/240).toString(),10),o=parseInt(((255*this.Dz(a,u,t-80)+120)/240).toString(),10)),{a:255,r:i,g:r,b:o}},v.prototype.Dz=function(t,n,e){return e<0&&(e+=240),240<e&&(e-=240),e<40?t+((n-t)*e+20)/40:e<120?n:e<160?t+((n-t)*(160-e)+20)/40:t},v.prototype.Tz=function(t,n,e){var i;return this.Iz(t,n,e).luminosity/240},v.prototype.Iz=function(t,n,e){var i,r,o,a,u,s,u,s,c,e,a=Math.max(Math.max(t,n),e),u=Math.min(Math.min(t,n),e),s=a+u,i=parseInt(((240*s+255)/510).toString(),10),u=a-u;return 0==u?(r=0,o=160):(r=i<=120?parseInt(((240*u+s/2)/s).toString(),10):parseInt(((240*u+(510-s)/2)/(510-s)).toString(),10),s=(40*(a-t)+u/2)/u,c=(40*(a-n)+u/2)/u,e=(40*(a-e)+u/2)/u,(o=t===a?parseInt((e-c).toString(),10):n===a?parseInt((80+s-e).toString(),10):parseInt((160+c-s).toString(),10))<0&&(o+=240),240<o&&(o-=240)),{luminosity:i,saturation:r,hue:o}},v.prototype.Mz=function(a,u,s){var c,t,c=this,t={items:function(){var t,n,e,i,r,o,t=document.createElement("div");for(t.classList.add("gc-color-picker-group-row"),t.style.width=(u+7)*s+"px",n=0;n<a.colors.length;n++){for((e=document.createElement("div")).classList.add("gc-color-picker-color-row"),i=a.colors[n],r=0;r<i.length;r++)(o=document.createElement("div")).setAttribute(f,a.name),o.setAttribute("color",i[r]),o.style.backgroundColor=i[r],o.style.width=u+"px",o.style.height=u+"px",o.classList.add("gc-color-picker-color-cell"),c.vz===i[r]&&c.mz===a.name&&o.classList.add("selected"),e.appendChild(o);t.appendChild(e)}return t},layout:{direction:o.LayoutDirection.horizontal,displayAs:o.LayoutDisplayAs.inline}};return a.name&&(t.text=a.name),t},v.prototype.pz=function(t){var t,n,t,t=t.srcElement||t.target;t&&(n=t.getAttribute("color"),t=t.getAttribute(f),n)&&t&&(this.vz=n,this.mz=t,this._z(n),this.yz())},v.prototype._z=function(t){this.fire(a.BaseDropdown.Event_ValueChanged,{value:t,text:t})},v.DefaultCellWidth=10,v.DefaultColorGroup=function(){return[{name:c().ThemeColor,colors:[["#ffffff","#000000","#e7e6e6","#44546a","#5b9bd5","#ed7d31","#a5a5a5","#ffc000","#4472c4","#70ad47"]],needScaleColor:!0},{name:c().StandardColor,colors:[["#C00000","#FF0000","#FFC000","#FFFF00","#92D050","#00B050","#00B0F0","#0070C0","#002060","#7030A0"]]}]},n.ColorPicker=v},"./dist/plugins/celltype/editor/eventbase.js":function(t,n){"use strict";var e;function i(){this.Ez={}}Object.defineProperty(n,"__esModule",{value:!0}),n.EventBase=void 0,i.prototype.on=function(t,n){var e=this.Ez[t];(e=null==e?this.Ez[t]=[]:e).push(n)},i.prototype.off=function(t,n){var e,n;t?null!=(e=this.Ez[t])&&(n?(n=e.indexOf(n),e.splice(n,1)):e=[],this.Ez[t]=e):this.Ez={}},i.prototype.fire=function(t,n){var e,t,e=this,t=this.Ez[t];null!=t&&t.forEach(function(t){try{t.call(e,n)}catch(t){}})},n.EventBase=i},"./dist/plugins/celltype/editor/listControl.js":function(B,t,n){"use strict";var e,u,s,o,l,h,a,i,r,c,f,d,v,m,g,p,b,y,w,M,C,S,T,A,L,I,x,F,P,N,G,U,k,H,D,_;function E(t){return i.createElement(t)}function z(t,n){return t.substring(0,n)+t.substring(n+1,t.length)}function V(t,n){if(o.Common.Uf.OS(t,n))return 1;if(o.Common.ct.W0(n))for(var e=0;e<t.length;e++)if(t[e]-n==0)return 1}function Y(t,n){for(var e,i,e=o.Common.ct.W0(n),i=t.length-1;0<=i;i--)(t[i]===n||e&&t[i]-n==0)&&t.splice(i,1)}function Z(t){var n,e,i,r,o;if(h(t)||0===t.length)return[];for(n=[],i=e=0;i<t.length;i++)"\\"===(r=t.charAt(i))?","!==(o=t.charAt(i+1))&&"\\"!==o||(t=z(t,i)):","===r&&(n.push(t.substring(e,i)),e=i+1);return n.push(t.substring(e,t.length)),n}function W(t){for(var n,e,i,n=[],e=0;e<t.length;e++)(i=t[e])&&"string"==typeof i&&(i=i.replace(/\\/g,"\\\\").replace(/,/g,"\\,")),n[e]=i;return n.join(",")}function j(){this.jz=new WeakMap}function O(t,n,e){var i=_.call(this,t)||this;return i.Ti=E("div"),i.Ti.classList.add(c),t.appendChild(i.Ti),i.cE=new r,i.Oz=e&&e.Oz||{y4:void 0},i.Rz={items:[],doms:[]},i.setOptions(n),i}function R(t){if(t.hasOwnProperty("items"))R(t.items);else if(Array.isArray(t))for(var n=0;n<t.length;n++)t[n].hasOwnProperty("items")?R(t[n]):t[n].hasOwnProperty("text")&&!t[n].hasOwnProperty("value")&&(t[n].value=t[n].text);return t}e=this&&this.__extends||(D=function(t,n){return(D=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(t,n){t.__proto__=n}:function(t,n){for(var e in n)Object.prototype.hasOwnProperty.call(n,e)&&(t[e]=n[e])}))(t,n)},function(t,n){if("function"!=typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function e(){this.constructor=t}D(t,n),t.prototype=null===n?Object.create(n):(e.prototype=n.prototype,new e)}),Object.defineProperty(t,"__esModule",{value:!0}),t.List=void 0,u=n("./dist/plugins/celltype/editor/popupControl.js"),s=n("./dist/plugins/celltype/editor/baseControl.js"),o=n("Common"),l=n("Core"),h=o.Common.lt.ht,a=o.Common.Uf.hD,i=document,j.prototype.set=function(t,n,e){var i=this.jz.get(t);i||this.jz.set(t,i={}),i[n]=e},j.prototype.get=function(t,n){var t=this.jz.get(t);return t&&t[n]},j.prototype.clear=function(){this.jz=new WeakMap},r=j,c="gc-list-control",f="gc-list-control-container",d="gc-list-control-group",v="gc-list-control-group-text",m="gc-list-control-item",g="gc-list-control-hassubitem",p="gc-list-control-selected-item",b="gc-list-control-item-text",y="gc-list-control-item-text-ellipsis",w="gc-list-control-item-ellipsis",M="gc-list-control-item-icon",C="gc-list-control-emptyicon",S="gc-list-control-subitem",T="gc-list-alignment-horizontal",A="gc-list-alignment-vertical",L="gc-list-control-item-wrap",I="gc-list-control-noitem",x="gc-list-control-listseparator",F="gc-list-control-item-bigicon",P="gc-list-control-item-bigtext",N="hide-children",G="gc-list-control-tree",U="gc-list-control-tree-text",k="gc-list-control-tree-content",_=s.BaseDropdown,e(O,_),O.prototype.setOptions=function(t){h(t)||(this.MU=R(t),this.Ti.innerHTML="",this.Dn())},O.prototype.setValue=function(t){if(this.MU&&this.MU.multiSelect)if("string"==typeof t)t=Z(t);else if(h(t))t=[];else if(o.Common.lt.Nh(t)){if(1!==this.MU.valueType){t=t.slice(0);for(var n=0;n<t.length;n++)t[n]=""+t[n]}}else t=[t];this.Oz.y4=t,this.Bz()},O.prototype.scrollToSelect=function(){},O.prototype.updateStyle=function(t,n,e){this.Ti.style.font=e},O.prototype.Dn=function(){var t=E("div");t.classList.add(f),this.MU.jue&&(t.setAttribute("role","listbox"),t.setAttribute("tabindex","-1")),this.Lz(t,this.MU),this.Ti.appendChild(t),this.Fz()},O.prototype.Lz=function(t,n){var e;n&&(this.Pz(t,n.layout),n.items)&&(Array.isArray(n.items)?this.Gz(t,n.items):(e=n.items())instanceof HTMLElement&&(t.appendChild(e),t.classList.add(m),this.Pz(e,n.layout)))},O.prototype.Pz=function(t,n){n&&n.direction===l.LayoutDirection.horizontal?t.classList.add(T):t.classList.add(A)},O.prototype.Gz=function(t,n){for(var e,i,r,o,a,u,s,o,c,f,f,e=n.some(function(t){return!!t.icon}),i=0;i<n.length;i++)n[i].items?(r=n[i]).layout&&r.layout.displayAs===l.LayoutDisplayAs.inline?((o=E("div")).classList.add(d),(a=E("span")).innerText=r.text,!h(r.text)&&""!==r.text||a.classList.add(N),a.classList.add(v),o.appendChild(a),Array.isArray(r.items)?this.Lz(o,r):(u=r.items())instanceof HTMLElement&&((s=E("div")).classList.add(m),this.Pz(u,r.layout),s.appendChild(u),o.appendChild(s)),t.appendChild(o)):r.layout&&r.layout.displayAs===l.LayoutDisplayAs.tree?((o=E("div")).classList.add(G),(c=E("div")).classList.add(m),c.classList.add(g),(a=E("span")).innerText=r.text,a.classList.add(U),c.appendChild(a),r.layout.collapsible&&((f=E("span")).classList.add(S),c.appendChild(f),this.Uz(c)),o.appendChild(c),(f=E("div")).classList.add(k),Array.isArray(r.items)?this.Lz(f,r):(u=r.items())instanceof HTMLElement&&((s=E("div")).classList.add(m),this.Pz(u,r.layout),s.appendChild(u),f.appendChild(s)),o.appendChild(f),t.appendChild(o)):this.Hz(t,n[i],!1,!0):this.Hz(t,n[i],e)},O.prototype.Hz=function(t,n,e,i){var r,o,o,e,o,e,o,e;void 0===i&&(i=!1),(r=E("div")).classList.add(m),this.MU.textEllipsis&&r.classList.add(w),"-"===n.text?(r.classList.add(I),(o=E("div")).classList.add(x),r.appendChild(o)):(e&&((o=E("div")).classList.add(M),n.icon?o.style.backgroundImage="url(".concat(n.icon,")"):o.classList.add(C),r.appendChild(o)),(e=E("span")).classList.add(b),this.MU.textEllipsis&&e.classList.add(y),e.innerText=n.text,h(n.text)&&(e.innerText=h(n.value)?"":n.value),r.appendChild(e),o=h(n.value)?null:n.value,(e=a(this.Rz.items,o))<0&&(e=this.Rz.items.length,this.Rz.doms.push([]),this.Rz.items.push(o)),this.Rz.doms[e].push(r),this.cE.set(r,"items",n),i&&((o=E("span")).classList.add(S),r.classList.add(g),this.cE.set(r,"sub-items",n),r.appendChild(o),this.zz(r))),this.MU.jue&&(r.setAttribute("role","option"),r.setAttribute("tabindex","0"),e=n.text||n.value,h(e)||r.setAttribute("aria-label",e)),t.appendChild(r)},O.prototype.qj=function(t,n){var e,i,e=this.Rz.doms[t];if(n)for(i=0;i<e.length;i++)e[i].classList.contains(g)||e[i].classList.add(p);else for(i=0;i<e.length;i++)e[i].classList.contains(p)&&e[i].classList.remove(p)},O.prototype.Bz=function(){for(var t,n,e,i,r,o,n=this,e=n.MU,t=h(n.formula)?e&&e.multiSelect?i=n.Oz.y4:[n.Oz.y4]:["="+n.formula],r=0;r<n.Rz.items.length;r++)o=n.Rz.items[r],V(t,o=e&&e.multiSelect&&1!==e.valueType?""+o:o)?n.qj(r,!0):n.qj(r,!1)},O.prototype.Fz=function(){var r=this;this.Ti.querySelector("."+f).addEventListener("click",function(t){var n,n,e,t,n,i,n=r.Vz(t.target,".".concat(m));n&&(n.classList.contains(g)?r.Yz(t):(n=r.cE.get(n,"items"),e=r.MU,!n&&o.Common.lt.Eh(e&&e.onItemSelected)&&(n={value:e.onItemSelected(t)}),h(n)||(t=n.value,n=n.path,e&&e.multiSelect&&(V(i=(i=r.Oz.y4).slice(0),t=e.multiSelect&&1!==e.valueType?""+t:t)?Y(i,t):o.Common.Uf.ZP(i,t),r.Oz.y4=t=i,r.Bz(),1!==e.valueType)&&(t=W(t)),r.fire(s.BaseDropdown.Event_ValueChanged,{path:n,value:t,text:t,notCloseDropDown:e&&e.multiSelect,noAutoFormat:!0}))))})},O.prototype.Vz=function(t,n){Element.prototype.matches||(Element.prototype.matches=Element.prototype.webkitMatchesSelector||function(t){for(var n=(this.document||this.ownerDocument).querySelectorAll(t),e=n.length;0<=e&&n.item(e)!==this;)--e;return-1<e});for(var e=t;e&&!e.matches(n);)e=e.parentElement;return e},O.prototype.Yz=function(t){var n,e,i,r,o,o,a,n=this,e=this.Vz(t.target,".".concat(m));e.classList.contains(g)&&(i=this.cE.get(e,"sub-items"))&&i.items&&(r=E("div"),o=this.MU,i.multiSelect=o&&o.multiSelect,i.valueType=o&&o.valueType,i.onItemSelected=o&&o.onItemSelected,(o=new O(r,i,this)).Bz(),(a=new u.PopupControl(r,e,{align:l.DropDownAlignment.Near,hostElement:e,direction:l.DropDownDirection.Right})).open(),o.on(s.BaseDropdown.Event_ValueChanged,function(t){n.fire(s.BaseDropdown.Event_ValueChanged,t),n.MU&&n.MU.multiSelect?n.Bz():a.close()}),this.cE.set(e,"sub-items-popup",a),t.stopPropagation(),t.preventDefault())},O.prototype.zz=function(t){var e=this;t.addEventListener("mouseenter",function(t){e.Yz(t)}),t.addEventListener("mouseleave",function(t){var t,n,t=t.target;t.classList.contains(g)&&(n=e.cE.get(t,"sub-items-popup"))&&(n.close(),e.cE.set(t,"sub-items-pop",void 0))})},O.prototype.Uz=function(t){var i=this;t.addEventListener("click",function(t){var n,n,e,n=t.target,n=i.Vz(n,".".concat(g));n&&(e=n.parentElement.querySelector("."+k))&&(n.parentElement.classList.contains(N)?n.parentElement.classList.remove(N):n.parentElement.classList.add(N),t.stopPropagation(),t.preventDefault())})},t.List=O},"./dist/plugins/celltype/editor/monthPicker.js":function(t,n,e){"use strict";var i,s,r,c,o,e,f,a,u,l,h,d,v,m,g,p,b,y;function w(t){return a.createElement(t)}function M(t,n){var t=y.call(this,t)||this;return t.setOptions(n),t.Fz(),t}i=this&&this.__extends||(b=function(t,n){return(b=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(t,n){t.__proto__=n}:function(t,n){for(var e in n)Object.prototype.hasOwnProperty.call(n,e)&&(t[e]=n[e])}))(t,n)},function(t,n){if("function"!=typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function e(){this.constructor=t}b(t,n),t.prototype=null===n?Object.create(n):(e.prototype=n.prototype,new e)}),Object.defineProperty(n,"__esModule",{value:!0}),n.MonthPicker=void 0,s=e("./dist/plugins/celltype/editor/baseControl.js"),r=e("./dist/plugins/celltype/celltypes.ns.js"),c=e("Common"),o=c.Common.lt.ht,e=new c.Common.ResourceManager(r.SR,"CellTypes"),f=e.getResource.bind(e),a=document,u="gc-month-picker-separator",l="gc-month-picker-year-item",h="gc-month-picker-month-item",d="gc-month-picker-qtr-item",v="selected",m="data-month",g="data-qtr",y=s.BaseDropdown,i(M,y),M.prototype.setOptions=function(t){var n,e,e,i,i,i,n=this,e=new Date,e={startYear:e.getFullYear()-10,stopYear:e.getFullYear(),height:300};t&&(o(t.startYear)||(i=parseInt(t.startYear,10),isNaN(i))||(e.startYear=i),!o(t.stopYear)&&0<t.stopYear&&(i=parseInt(t.stopYear,10),isNaN(i)||(e.stopYear=i)),e.stopYear<e.startYear&&(e.stopYear=t.startYear),o(t.height)||(i=parseInt(t.height,10),isNaN(i))||(e.height=i)),e.height=Math.max(1,e.height),n.MU=e,n.Ti.innerHTML="",n.Zz()},M.prototype.setValue=function(t){var n,e,i,r,t,o,n=this;t&&(e=t.getMonth()+1,i=t.getFullYear()),"number"==typeof e&&(t=n.Ti.querySelector("[".concat(m,"='").concat(i,"-").concat(e,"']")))&&(t.classList.add(v),n.Wz&&n.Wz.classList.remove(v),n.Wz=t)},M.prototype.scrollToSelect=function(){var t,t,t=this.Wz;t&&(t=t.offsetTop,this.Ti.scrollTop=t)},M.prototype.Qz=function(t,n){Element.prototype.matches||(Element.prototype.matches=Element.prototype.matchesSelector||Element.prototype.mozMatchesSelector||Element.prototype.msMatchesSelector||Element.prototype.oMatchesSelector||Element.prototype.webkitMatchesSelector||function(t){for(var n=(this.document||this.ownerDocument).querySelectorAll(t),e=n.length;0<=e&&n.item(e)!==this;)--e;return-1<e});for(var e=t;e&&!e.matches(n);)e=e.parentElement;return e},M.prototype.Fz=function(){var u=this;this.Ti.addEventListener("click",function(t){var n,t,e,i,r,o,t,t,r,a,e,n=u,t=n.Qz(t.target,".".concat(h,",.").concat(d));t&&!t.getAttribute(g)&&(t.classList.add(v),n.Wz&&n.Wz.classList.remove(v),r=i=e=null,(n.Wz=t).getAttribute(m)&&(e=+(t=(o=t.getAttribute(m)).split("-"))[1],r=+t[0]),t=new Date(r,e-1,1,0,0,0,0),r=c.Common.CultureManager.Fe().DateTimeFormat,e=(a=new c.Formatter.GeneralFormatter(r.shortDatePattern)).format(t),n.fire(s.BaseDropdown.Event_ValueChanged,{text:e,value:t}))})},M.prototype.Zz=function(){var t,n,e,i,r,t=this;for(0<=this.MU.height?t.Ti.style.maxHeight=this.MU.height+"px":t.Ti.style.height="auto",t.Ti.classList.add("gc-month-picker-container"),n=t.MU.startYear;n<=t.MU.stopYear;n++)e=document.createElement("div"),t.Jz(e),(i=document.createElement("div")).classList.add("gc-month-picker-year-container"),t.Xz(n,i),(r=document.createElement("div")).classList.add("gc-month-picker-month-container"),t.qz(n,1,r),t.qz(n,2,r),t.qz(n,3,r),t.qz(n,4,r),e.appendChild(i),e.appendChild(r),this.Ti.appendChild(e)},M.prototype.Jz=function(t){var n=w("div");n.classList.add(u),t.appendChild(n)},M.prototype.Xz=function(t,n){var e=w("div");e.classList.add(l),e.innerText="".concat(t),n.appendChild(e)},M.prototype.qz=function(t,n,e){var i,r,o,a,u,i=document.createElement("div"),r=w("div"),o=w("div"),a=w("div"),u=w("div");switch(r.classList.add(h),o.classList.add(h),a.classList.add(h),u.classList.add(d),n){case 1:r.innerText=f().Calendar_ShortMonths_1,r.setAttribute(m,"".concat(t,"-").concat(1)),o.innerText=f().Calendar_ShortMonths_2,o.setAttribute(m,"".concat(t,"-").concat(2)),a.innerText=f().Calendar_ShortMonths_3,a.setAttribute(m,"".concat(t,"-").concat(3)),u.innerText=f().Quarter_Format_1,u.setAttribute(g,"".concat(t,"-").concat(1));break;case 2:r.innerText=f().Calendar_ShortMonths_4,r.setAttribute(m,"".concat(t,"-").concat(4)),o.innerText=f().Calendar_ShortMonths_5,o.setAttribute(m,"".concat(t,"-").concat(5)),a.innerText=f().Calendar_ShortMonths_6,a.setAttribute(m,"".concat(t,"-").concat(6)),u.innerText=f().Quarter_Format_2,u.setAttribute(g,"".concat(t,"-").concat(2));break;case 3:r.innerText=f().Calendar_ShortMonths_7,r.setAttribute(m,"".concat(t,"-").concat(7)),o.innerText=f().Calendar_ShortMonths_8,o.setAttribute(m,"".concat(t,"-").concat(8)),a.innerText=f().Calendar_ShortMonths_9,a.setAttribute(m,"".concat(t,"-").concat(9)),u.innerText=f().Quarter_Format_3,u.setAttribute(g,"".concat(t,"-").concat(3));break;case 4:r.innerText=f().Calendar_ShortMonths_10,r.setAttribute(m,"".concat(t,"-").concat(10)),o.innerText=f().Calendar_ShortMonths_11,o.setAttribute(m,"".concat(t,"-").concat(11)),a.innerText=f().Calendar_ShortMonths_12,a.setAttribute(m,"".concat(t,"-").concat(12)),u.innerText=f().Quarter_Format_4,u.setAttribute(g,"".concat(t,"-").concat(4))}i.appendChild(r),i.appendChild(o),i.appendChild(a),i.appendChild(u),e.appendChild(i),n<4&&this.Jz(e)},n.MonthPicker=M},"./dist/plugins/celltype/editor/multiColumnPicker.js":function(t,n,e){"use strict";var i,a,u,r,s,o,c,f,e,v,o,l,h,d,m,g;function p(t){return Array.isArray(t)}function b(t){return"string"==typeof t}function y(t){t.suspendPaint(),t.suspendEvent(),t.suspendCalcService()}function w(t){t.resumeCalcService(!1),t.resumeEvent(),t.resumePaint()}function M(t,n){var e,r,o,a,i,u,s,e=t[0],r=[];if(p(e))for(a=C(o=t,n),i=function(t,n){var e=o[t],i={};a.forEach(function(t,n){i[t]=e[n]}),r.push(i)},u=0,s=o.length;u<s;u++)i(u,s);else r=t;return r}function C(t,n){var e=[];return n&&0<n.length?n.forEach(function(t){e.push(t.name)}):e=t.shift(),e}function S(t,n,e){return g.call(this,t,n,e)||this}i=this&&this.__extends||(m=function(t,n){return(m=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(t,n){t.__proto__=n}:function(t,n){for(var e in n)Object.prototype.hasOwnProperty.call(n,e)&&(t[e]=n[e])}))(t,n)},function(t,n){if("function"!=typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function e(){this.constructor=t}m(t,n),t.prototype=null===n?Object.create(n):(e.prototype=n.prototype,new e)}),Object.defineProperty(n,"__esModule",{value:!0}),n.MultiColumn=void 0,a=e("Core"),u=e("SheetsCalc"),r=e("CalcEngine"),s=e("CalcEngine"),o=e("Common"),c=e("./dist/plugins/celltype/editor/baseControl.js"),f=e("./dist/plugins/celltype/editor/baseSpreadPicker.js"),e=e("./dist/plugins/celltype/celltypes.ns.js"),v=o.Common.lt.ht,o=new o.Common.ResourceManager(e.SR,"CellTypes"),l=o.getResource.bind(o),h=!!r,g=f.BaseSpreadPicker,i(S,g),S.prototype.setOptions=function(n){var e,t,i,r,t,n,i;if(g.prototype.setOptions.call(this,n),((e=this).MU=n)&&(t=e.TU,i=n.dataSource,r=n.bindingInfos,t=t.getActiveSheet(),i)){n=!0,y(t),t.options.isProtected=!0,t.options.rowHeaderVisible=!1,t.selectionPolicy(a.SelectionPolicy.single),t.selectionUnit(a.SelectionUnit.row);try{e.$z(t,i,r)}catch(t){n=!1,e.dispose()}finally{n&&t&&((i=new a.Style).hv=!1,t.setStyle(-1,-1,i,a.SheetArea.viewport),w(t))}}},S.prototype.setValue=function(t){var n,e,i,n,n=this;n.MU&&(g.prototype.setValue.call(this,t),i=(e=n.TU).getActiveSheet(),n=n.tV(t),i.setSelection(n,-1,1,-1))},S.prototype.dispose=function(){g.prototype.dispose.call(this)},S.prototype.$z=function(t,n,e){var i,n;n&&(n=this.nV(n))&&(t.setDataSource(M(n,e)),e)&&t.bindColumns(e)},S.prototype.nV=function(t){var t,n,e,e,e,i,r,o,r,o,n,t=t,n=this.CU;if(b(t)){if(h){if(e=(0,u.formulaToExpression)(n,t),e=n.getCalcService().BI(n.Uw(),e,(0,s.eV)(0,0),!0),r=!1,o=void 0,!(r=!(i=s.Convert.LE(e)||s.Convert.Nh(e))||(o=s.Convert.iV(e,0,!1,!1,!1)).isError||o.isConvertError?r:!0))throw new Error(l().MultiColumn_InvalidDataSource);e=o}}else t instanceof a.Range?e=n.getArray(t.row,t.col,t.rowCount,t.colCount):p(t)?e=t:t.TDi&&(e=(n=(o=(r=n.parent)&&r.dataManager().rV)&&o[t.TDi])&&n.oV());return e},S.prototype.tV=function(t){var n,e,i,r,o,a,u,s,c,f,l,h,d,n=this,e=0;if(t)if(r=(i=n.TU).getActiveSheet(),a=(o=Object.keys(t)).length,s=(u=r.getDataSource()).length,c=!1,f=n.MU.key,v(f))for(l=0;l<s;l++){for(h=u[l],c=!0,d=0;d<a;d++)if(h[f=o[d]]!==t[f]&&void 0!==h[f]){c=!1;break}if(c){e=l;break}}else for(l=0;l<s;l++)if((h=u[l])[f]===t){e=l;break}return e},S.prototype.submitData=function(t){var n,e,i,r,o,t,e,t,n=this,e=t.sheet,i;t.isEsc?r={notSubmit:!0}:-1<(t=(o=e.getSelections()[0]).row)&&(e=e.getDataItem(t),t=n.MU.key,r={value:e=v(t)?e:e[t],text:e}),v(r)||n.fire(c.BaseDropdown.Event_ValueChanged,r)},n.MultiColumn=S},"./dist/plugins/celltype/editor/popupControl.js":function(t,n,e){"use strict";var i,w,e,M,C,r,o,a,u,s;function c(t,n,e,i){this._x=t,this._y=n,this.YC=e,this.ZC=i}function f(t,n,e){var i=s.call(this,null)||this;return i.sourceElement=t,i.target=n,i.defaultOption={closeAfterResize:!0,closeAfterClickOutside:!0,direction:w.DropDownDirection.Down,align:w.DropDownAlignment.Near,horAdj:M.Flip|M.Slide,verAdj:M.Flip|M.Slide},i.globalMousedownEventHandler=function(t){var n,e;if(i.rf){for(e=n=t.target;e&&e!==i.sourceElement;)e=e.parentElement;e||(i.close(),t.stopPropagation(),t.preventDefault())}},i.windowResizeEventHandler=function(){i.rf&&i.close()},i.MU=i.defaultOption,i.rf=!1,e&&i.mergeOption(e),i.aV=null===i.MU.hostElement||void 0===i.MU.hostElement||!(i.MU.hostElement instanceof HTMLElement),i}i=this&&this.__extends||(a=function(t,n){return(a=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(t,n){t.__proto__=n}:function(t,n){for(var e in n)Object.prototype.hasOwnProperty.call(n,e)&&(t[e]=n[e])}))(t,n)},function(t,n){if("function"!=typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function e(){this.constructor=t}a(t,n),t.prototype=null===n?Object.create(n):(e.prototype=n.prototype,new e)}),Object.defineProperty(n,"__esModule",{value:!0}),n.PopupControl=n.Rectangle=n.DropDownAdjustment=void 0,w=e("Core"),e=e("./dist/plugins/celltype/editor/baseControl.js"),(u=M=n.DropDownAdjustment||(n.DropDownAdjustment={}))[u.None=0]="None",u[u.Flip=1]="Flip",u[u.Slide=2]="Slide",c.CreateFromDom=function(t){return new c(t.left,t.top,t.width,t.height)},Object.defineProperty(c.prototype,"x",{get:function(){return this._x},set:function(t){this._x=t},enumerable:!1,configurable:!0}),Object.defineProperty(c.prototype,"y",{get:function(){return this._y},set:function(t){this._y=t},enumerable:!1,configurable:!0}),Object.defineProperty(c.prototype,"width",{get:function(){return this.YC},enumerable:!1,configurable:!0}),Object.defineProperty(c.prototype,"height",{get:function(){return this.ZC},enumerable:!1,configurable:!0}),Object.defineProperty(c.prototype,"left",{get:function(){return this._x},enumerable:!1,configurable:!0}),Object.defineProperty(c.prototype,"right",{get:function(){return this._x+this.YC},enumerable:!1,configurable:!0}),Object.defineProperty(c.prototype,"top",{get:function(){return this._y},enumerable:!1,configurable:!0}),Object.defineProperty(c.prototype,"bottom",{get:function(){return this._y+this.ZC},enumerable:!1,configurable:!0}),Object.defineProperty(c.prototype,"Location",{get:function(){return{X:this._x,Y:this._y}},enumerable:!1,configurable:!0}),Object.defineProperty(c.prototype,"Size",{get:function(){return{width:this.YC,height:this.ZC}},enumerable:!1,configurable:!0}),c.prototype.Offset=function(){for(var t,n,t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];1===t.length&&"number"==typeof t[0].X&&"number"==typeof t[0].X?(this._x+=t[0].X,this._y+=t[0].Y):2===t.length&&"number"==typeof t[0]&&"number"==typeof t[1]&&(this._x+=t[0],this._y+=t[1])},C=c,n.Rectangle=C,r="ribbon-dropdowngroup-popup",s=e.BaseControl,i(f,s),f.prototype.open=function(){this.rf||(this.MU.jue&&this.target.setAttribute&&this.target.setAttribute("aria-expanded","true"),this.beforeOpen(),this.render(),this.clearPosition(),this.calcPosition(),this.rf=!0,this.sourceElement.tabIndex=-1,this.sourceElement.style.cssText+="outline:none",this.sourceElement.focus())},f.prototype.beforeOpen=function(){this.bindEvent()},f.prototype.dispose=function(){var n=this;this.MU.closeAfterResize&&document.removeEventListener("resize",this.windowResizeEventHandler),this.MU.closeAfterClickOutside&&(document.removeEventListener("mousedown",this.globalMousedownEventHandler,!0),"touchstart MSPointerDown pointerdown".split(" ").forEach(function(t){document.removeEventListener(t,n.globalMousedownEventHandler,!0)})),this.aV?(this.sourceElement.classList.remove(r),this.sourceElement.style.display=this.uV,this.sourceElement.style.position=this.Z3):this.sV&&this.sV.parentNode&&(this.MU.hostElement.removeChild(this.sV),this.sV=null)},f.prototype.close=function(){var t;this.rf&&(this.rf=!1,this.MU.jue&&(t=this.target).setAttribute&&(t.setAttribute("aria-expanded","false"),setTimeout(function(){t.focus()})),this.dispose(),this.fire("close"))},f.prototype.mergeOption=function(t){for(var n in t)void 0!==t[n]&&(this.MU[n]=t[n])},f.prototype.clearPosition=function(){this.cV.style.top=this.cV.style.bottom=this.cV.style.left=this.cV.style.right=""},f.prototype.calcPosition=function(){var t,n,e,e,t,i,r,t,r,o,r,o,e,n=this.target instanceof C,t=n?this.target:C.CreateFromDom(this.target.getBoundingClientRect()),e=new C(0,0,window.innerWidth,window.innerHeight),e=this.calculateDropDownLocation(e,t,{width:this.sourceElement.offsetWidth,height:this.sourceElement.offsetHeight},this.MU.direction,this.MU.align,this.MU.horAdj,this.MU.verAdj),t=this.cV.offsetParent,i=t.getBoundingClientRect(),r=document.body,t=t.offsetWidth===r.offsetWidth&&t.offsetHeight===r.offsetHeight,r=document.documentElement,o=(window.pageXOffset||r.scrollLeft)-(r.clientLeft||0),r=(window.pageYOffset||r.scrollTop)-(r.clientTop||0),o=e.X-(t?-o:i.left),e=e.Y-(t?-r:i.top);n&&(o<0&&(o=0),e<0)&&(e=0),this.cV.style.left="".concat(o,"px"),this.cV.style.top="".concat(e,"px")},f.prototype.calculateDropDownLocation=function(t,n,e,i,r,o,a){var u,s,c,f,l,h,d,v,m,g,p,a,o,b,y,n,u={X:t.x,Y:t.y};switch(t.Offset(-u.X,-u.Y),n.Offset(-u.X,-u.Y),s=n.left,c=n.right,f=n.top,l=n.bottom,h=f,d=t.height-l,v=s,m=t.width-c,g=(a&M.Flip)===M.Flip,p=(o&M.Flip)===M.Flip,a=(a&M.Slide)===M.Slide,o=(o&M.Slide)===M.Slide,i){case w.DropDownDirection.Up:e.height>h&&g&&(i=w.DropDownDirection.Down);break;case w.DropDownDirection.Down:e.height>d&&g&&(i=w.DropDownDirection.Up);break;case w.DropDownDirection.Left:e.width>v&&p&&(i=w.DropDownDirection.Right);break;case w.DropDownDirection.Right:e.width>m&&p&&(i=w.DropDownDirection.Left)}switch(y=b=0,i){case w.DropDownDirection.Up:y=f-e.height;break;case w.DropDownDirection.Down:y=l;break;case w.DropDownDirection.Left:b=s-e.width;break;case w.DropDownDirection.Right:b=c}return i===w.DropDownDirection.Up||i===w.DropDownDirection.Down?r===w.DropDownAlignment.Near?b=s:r===w.DropDownAlignment.Center?b=s-(e.width-n.width)/2:r===w.DropDownAlignment.Far&&(b=c-e.width):i!==w.DropDownDirection.Right&&i!==w.DropDownDirection.Left||(r===w.DropDownAlignment.Near?y=f:r===w.DropDownAlignment.Center?y=f-(e.height-n.height)/2:r===w.DropDownAlignment.Far&&(y=l-e.height)),n=new C(b,y,e.width,e.height),o&&(n.width>t.width?n.x=0:(n.x=Math.max(n.x,0),n.x=Math.min(n.x,t.width-n.width))),a&&(n.height>t.height?n.y=0:(n.y=Math.max(n.y,0),n.y=Math.min(n.y,t.height-n.height))),n.Offset(u),n.Location},f.prototype.render=function(){var n=this;this.aV?(this.Z3=this.sourceElement.style.position,this.sourceElement.style.position="absolute",this.uV=this.sourceElement.style.display,this.sourceElement.style.display="",this.sourceElement.style.zIndex="10000",this.sourceElement.classList.add(r),this.cV=this.sourceElement):(this.sV=document.createElement("div"),this.sV.style.cssText="position:absolute; z-index:10000; box-shadow:rgba(0, 0, 0, 0.4) 2px 4px 5px; outline:none",this.sV.classList.add(r),this.sV.appendChild(this.sourceElement),this.MU.hostElement.appendChild(this.sV),this.cV=this.sV),this.MU.jue&&setTimeout(function(){var t;n.cV&&(t=n.cV.querySelector("[role=menu],[role=listbox]"))&&t.focus()},500)},f.prototype.bindEvent=function(){var n=this;this.MU.closeAfterClickOutside&&(document.addEventListener("mousedown",this.globalMousedownEventHandler,!0),"touchstart MSPointerDown pointerdown".split(" ").forEach(function(t){document.addEventListener(t,n.globalMousedownEventHandler,!0)})),this.MU.closeAfterResize&&document.addEventListener("resize",this.windowResizeEventHandler)},n.PopupControl=f},"./dist/plugins/celltype/editor/slider.js":function(t,n,e){"use strict";var i,r,o,a,u,s,c,f,l,h,d,v,m,g,p,b,y;function w(t){var n=t.toExponential().match(/\d(?:\.(\d*))?e([+-]\d+)/);return t.toFixed(Math.max(0,(n[1]||"").length-parseInt(n[2],10)))}function M(t){var t,n,t=w(t||0),n=0;return n=0<=t.indexOf(".")?t.length-t.indexOf(".")-1:n}function C(){}function S(t,n){this.Wc=n,this.fV={},this.fV=f.extend(this.fV,t)}function T(t,n){this.Wc=n,this.lV={},this.lV=f.extend(this.lV,t)}function A(t,n){this.Wc=t,this.hV={},this.dV="",this.hV=f.extend(this.hV,n),this.dV='\n        <div class="'.concat(this.hV.prefixCls,"-tooltip ").concat(this.hV.prefixCls,'-tooltip-placement-top">\n            <div class="').concat(this.hV.prefixCls,'-tooltip-content">\n                <div class="').concat(this.hV.prefixCls,'-tooltip-arrow"></div>\n                <div class="').concat(this.hV.prefixCls,'-tooltip-inner">{{value}}</div>\n            </div>\n        </div>\n        ')}function I(t,n){this.Wc=n,this.vV={},this.mV=!1,this.gV=c,this.vV=f.extend(this.vV,t),this.gV=new d(this.Wc,this.pV())}function x(t,n){this.Wc=n,this.bV={},this.bV=f.extend(this.bV,t)}function N(t,n,e,i){this.Wc=t,this.yV=n,this.wV=e,this.MU=i,this.MV=c,this.CV=c,this.MV=new h(this.SV(),this.Wc),this.CV=new m(this.TV(),this.Wc)}function k(t,n){var e=y.call(this,t)||this;return e.yV=c,e.wV=c,e.AV=c,e.IV=function(t){f.pauseEvent(t),0===t.button&&(document.addEventListener("mouseup",e.xV,!1),document.addEventListener("pointerup",e.xV,!1),document.addEventListener("MSPointerUp",e.xV,!1),document.addEventListener("mousemove",e.NV,!1),document.addEventListener("pointermove",e.NV,!1),document.addEventListener("MSPointerMove",e.NV,!1),e.NV(t))},e.NV=function(t){f.pauseEvent(t);var t=e.kV(t);e.DV!==t&&(e.setValue(t),e._V.onChange(t))},e.xV=function(t){e.NV(t),document.removeEventListener("mousemove",e.NV),document.removeEventListener("mouseup",e.xV),document.removeEventListener("pointermove",e.NV),document.removeEventListener("pointerup",e.xV),document.removeEventListener("MSPointerMove",e.NV),document.removeEventListener("MSPointerUp",e.xV);var n=e.kV(t);e.DV=n,e._V.onAfterChange(e._V.value),e.fire(r.BaseDropdown.Event_ValueChanged,{value:n,text:n.toString(),notCloseDropDown:!0}),f.pauseEvent(t)},e.EV=function(t){f.pauseEvent(t);var n=t.target||t.srcElement;document.addEventListener("touchend",e.jV,!1),n.classList.contains("".concat(e._V.prefixCls,"-handle"))?document.addEventListener("touchmove",e.OV,!1):e.OV(t)},e.OV=function(t){var t,t;f.pauseEvent(t),t=t.targetTouches[0],t=e.kV(t),e.DV!==t&&(e.setValue(t),e._V.onChange(t))},e.jV=function(t){var n,n;document.removeEventListener("touchmove",e.OV),document.removeEventListener("touchend",e.jV),n=t.changedTouches[0],n=e.kV(n),e.DV=n,e._V.onAfterChange(e._V.value),e.fire(r.BaseDropdown.Event_ValueChanged,{value:n,text:n.toString(),notCloseDropDown:!0}),f.pauseEvent(t)},e.init(n),e}i=this&&this.__extends||(b=function(t,n){return(b=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(t,n){t.__proto__=n}:function(t,n){for(var e in n)Object.prototype.hasOwnProperty.call(n,e)&&(t[e]=n[e])}))(t,n)},function(t,n){if("function"!=typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function e(){this.constructor=t}b(t,n),t.prototype=null===n?Object.create(n):(e.prototype=n.prototype,new e)}),Object.defineProperty(n,"__esModule",{value:!0}),n.Slider=void 0,r=e("./dist/plugins/celltype/editor/baseControl.js"),o=e("Common"),a=e("Core"),u=o.Common.lt.ht,s=o.Common.zf.j0,c=null,C.isEmpty=function(t){return void 0===t||t===c||""===t||Array.isArray(t)&&0===t.length},C.isEmptyObject=function(t){var n,e,n=!0;for(e in t)if(e){n=!1;break}return n},C.pauseEvent=function(t){t.stopPropagation(),t.preventDefault()},C.isObject=function(t){var n=typeof t;return"function"==n||"object"==n&&!!t},C.allKeys=function(t){var n,e,n=[];if(!C.isObject(t))return[];for(e in t)t.hasOwnProperty(e)&&n.push(e);return n},C.parseStyleObject=function(t){var n,e,i,r,o,a,o;if(!C.isObject(t))return"";for(n="",i=0,r=(e=C.allKeys(t)).length;i<r;i++)a=t[o=e[i]],o=o.replace(/([A-Z])/g,"-$1"),n+="".concat(o.toLowerCase(),": ").concat(a,"; ");return n.trim()},C.extend=function(t,n,e){var i,r,o,a,u;for(void 0===e&&(e={}),i=C.allKeys(t),o=0,a=(r=C.allKeys(n)).length;o<a;o++)e[u=r[o]]=n[u];for(o=0,a=i.length;o<a;o++)void 0===e[u=i[o]]&&(e[u]=t[u]);return e},C.noop=function(){},C.measureWidth=function(t,n){var e,i,e=0,i=document.createElement("span");i.classList.add(n);try{i.innerText=t,i.style.display="none",document.body.appendChild(i),e=(0,a.GC$)(i).width()}finally{document.body.removeChild(i)}return e},f=C,S.prototype.render=function(){var t,n;if(!this.fV.included)return c;t=this.RV(),(n=this.Wc.querySelector(".".concat(this.fV.className)))===c&&((n=document.createElement("div")).classList.add("".concat(this.fV.className)),this.Wc.appendChild(n)),n.setAttribute("style",f.parseStyleObject(t))},S.prototype.setLength=function(t){this.fV.length=t,this.render()},S.prototype.RV=function(){return this.fV.direction===a.LayoutDirection.vertical?{bottom:"".concat(this.fV.offset,"%"),height:"".concat(this.fV.length,"%")}:{left:"".concat(this.fV.offset,"%"),width:"".concat(this.fV.length,"%")}},l=S,T.prototype.render=function(){var t,n,e,i,r,t=this.Wc.querySelector(".".concat(this.lV.className));if(t===c){for((t=document.createElement("div")).className="".concat(this.lV.className),e=0,i=(n=this.BV()).length;e<i;e++)r=this.LV(n[e]),t.appendChild(r);this.Wc.appendChild(t)}},T.prototype.LV=function(t){var n,e,e,e,n=document.createElement("span"),e=this.lV.max-this.lV.min,e=Math.abs(t-this.lV.min)/e*100+"%",e=this.lV.direction===a.LayoutDirection.vertical?{bottom:e}:{left:e};return n.classList.add("".concat(this.lV.prefixCls,"-dot")),n.setAttribute("style",f.parseStyleObject(e)),n.setAttribute("key",t.toString()),n},T.prototype.BV=function(){var t,n,e,t=Object.keys(this.lV.marks).map(function(t){return Number(t)});if(t.sort(function(t,n){return t-n}),n=t,this.lV.dots)for(e=this.lV.min;e<=this.lV.max;e+=this.lV.step)-1===n.indexOf(e)&&n.push(e);return n},h=T,A.prototype.render=function(t,n){var t,n,e,e,i,e;this.hV.offset=t,t=this.Wc.querySelector(".".concat(this.hV.prefixCls,"-tooltip")),n=new o.Formatter.GeneralFormatter(this.hV.formatString).format(n),f.isEmpty(t)&&(e=s(n),this.dV=this.dV.replace(/{{value}}/,e),(e=document.createElement("div")).innerHTML=this.dV,this.Wc.appendChild(e.firstElementChild),t=this.Wc.querySelector(".".concat(this.hV.prefixCls,"-tooltip"))),(i=t.querySelector(".".concat(this.hV.prefixCls,"-tooltip-inner"))).textContent=n,e=this.GV(n),t.setAttribute("style",f.parseStyleObject(e)),this.hV.tooltipVisible?this.show():this.hide()},A.prototype.show=function(){var t=this.Wc.querySelector(".".concat(this.hV.prefixCls,"-tooltip"));f.isEmpty(t)||(t.style.display="inline-block")},A.prototype.hide=function(){var t=this.Wc.querySelector(".".concat(this.hV.prefixCls,"-tooltip"));f.isEmpty(t)||(t.style.display="none")},A.prototype.GV=function(t){var t,t=0===(t=f.measureWidth(t,"".concat(this.hV.prefixCls,"-tooltip")))?12:t/2+4;return this.hV.direction===a.LayoutDirection.vertical?{left:"-".concat(t,"px"),bottom:"calc(".concat(this.hV.offset,"% + 10px)")}:{top:"-28px",left:"calc(".concat(this.hV.offset,"% - ").concat(t+4,"px)")}},d=A,I.prototype.render=function(){var t,n,e,i,r,t=this,n=this.UV(),e=this.GV(),i=this.vV.tabIndex||0;!this.vV.disabled&&i!==c||(i=c),(r=this.Wc.querySelector(".".concat(this.vV.className)))===c&&((r=document.createElement("div")).className=n,this.Wc.appendChild(r),r.setAttribute("role","slider"),r.setAttribute("aria-valuemin",this.vV.min.toString()),r.setAttribute("aria-valuemax",this.vV.max.toString()),r.setAttribute("aria-valuenow",this.vV.value.toString()),r.setAttribute("aria-disabled",String(this.vV.disabled)),r.addEventListener("blur",function(){t.HV(!1)}),r.addEventListener("mouseenter",function(){t.gV.show()}),r.addEventListener("keydown",function(){t.HV(!1)}),r.addEventListener("mousedown",function(){r.focus(),t.gV.show()}),document.addEventListener("mouseup",function(){document.activeElement===r&&(t.HV(!0),t.gV.hide())})),r.tabIndex=i,r.setAttribute("style",f.parseStyleObject(e))},I.prototype.setOffset=function(t,n){this.vV.offset=t,this.render(),this.gV.render(t,n)},I.prototype.HV=function(t){this.mV=t},I.prototype.UV=function(){return this.mV?"".concat(this.vV.className," ").concat(this.vV.prefixCls,"-handle-click-focused"):"".concat(this.vV.className)},I.prototype.GV=function(){return this.vV.direction===a.LayoutDirection.vertical?{bottom:"".concat(this.vV.offset,"%")}:{left:"".concat(this.vV.offset,"%")}},I.prototype.pV=function(){return{prefixCls:"gc-slider",tooltipVisible:this.vV.tooltipVisible,direction:this.vV.direction,offset:this.vV.offset,formatString:this.vV.formatString}},v=I,x.prototype.render=function(){var t,n,e,i,r,r,t=this.Wc.querySelector(".".concat(this.bV.className));if(t===c){for((t=document.createElement("div")).className="".concat(this.bV.className),n=this.zV(),this.VV(n),e=0,i=n.length;e<i;e++)r=n[e],(r=this.YV(r))!==c&&t.appendChild(r);this.Wc.appendChild(t)}},x.prototype.VV=function(t){var n,e,i,i;for(this.ZV=0,n=1,e=t.length;n<e;n++)(i=this.bV.marks[t[0]])&&(i=f.measureWidth(i.label,"".concat(this.bV.className,"-text")),!this.ZV||this.ZV<i)&&(this.ZV=i)},Object.defineProperty(x.prototype,"maxWidth",{get:function(){return this.ZV},enumerable:!1,configurable:!0}),x.prototype.zV=function(){var t;return f.allKeys(this.bV.marks).sort(function(t,n){return t-n})},x.prototype.YV=function(n){var e,t,i,r,o,o,t,e=this,t=this.bV.marks[n],i=f.isObject(t)?t.label:t;return f.isEmptyObject(i)?c:(r="".concat(this.bV.className,"-text"),o=this.WV(n),o=f.extend(o,t.style),(t=document.createElement("span")).classList.add(r),t.setAttribute("style",f.parseStyleObject(o)),t.setAttribute("key",n.toString()),t.addEventListener("mousedown",function(t){e.bV.onClickLabel(t,n)}),t.innerHTML=s(i),t)},x.prototype.WV=function(t){var n=this.bV.max-this.bV.min;return this.bV.direction===a.LayoutDirection.vertical?{"margin-bottom":"-50%",bottom:(t-this.bV.min)/n*100+"%"}:{left:(t-this.bV.min)/n*100+"%",transform:"translateX(-50%)"}},m=x,N.prototype.render=function(){var t=document.createElement("div");t.className="".concat(this.MU.prefixCls,"-rail"),this.Wc.appendChild(t),this.yV.render(),this.MV.render(),this.wV.render(),this.CV.render(),this.CV.maxWidth&&this.MU.direction===a.LayoutDirection.vertical&&(this.Wc.style.paddingRight=this.CV.maxWidth+"px")},N.prototype.calcValueByPosition=function(t){var t=t-this.QV();return this.trimAlignValue(this.KV(t))},N.prototype.trimAlignValue=function(t){return f.isEmpty(t)?c:this.JV(t)},N.prototype.calcOffset=function(){var t;return 100*(Math.max(this.MU.value-this.MU.min,0)/(this.MU.max-this.MU.min))},N.prototype.getKeyboardValueMutator=function(t){var n=this;switch(t.keyCode){case 38:case 39:return function(t){return n.calculateNextValue("increase",t)};case 40:case 37:return function(t){return n.calculateNextValue("decrease",t)};case 35:return function(t){return n.MU.max};case 36:return function(t){return n.MU.min}}},N.prototype.calculateNextValue=function(t,n){var e,i,i,i,e={increase:function t(n,e){return n+e},decrease:function t(n,e){return n-e}},i=Object.keys(this.MU.marks).indexOf(String(n)),i=e[t](i,1),i=Object.keys(this.MU.marks)[i];return this.MU.step?e[t](n,this.MU.step):!f.isEmptyObject(this.MU.marks)&&this.MU.marks[i]?this.MU.marks[i]:n},N.prototype.JV=function(t){var t=isFinite(this.XV(t))?this.XV(t):0;return this.MU.step===c?t:parseFloat(t.toFixed(this.qV()))},N.prototype.qV=function(){var t,n;if(u(this.MU.precision)){for(n in t=Math.max(M(this.MU.max),M(this.MU.min),M(this.MU.step)),this.MU.marks)t=Math.max(M(parseFloat(n)),t);this.MU.precision=t}return this.MU.precision},N.prototype.XV=function(n){var t,e,e,e,e,t=Object.keys(this.MU.marks).map(parseFloat);return this.MU.step!==c&&(e=Math.ceil((this.MU.max-this.MU.min)/this.MU.step),e=Math.min((n-this.MU.min)/this.MU.step,e),e=Math.round(e)*this.MU.step+this.MU.min,t.push(Math.min(e,this.MU.max))),e=t.map(function(t){return Math.abs(n-t)}),t[e.indexOf(Math.min.apply(Math,e))]},N.prototype.SV=function(){return{prefixCls:this.MU.prefixCls,className:"".concat(this.MU.prefixCls,"-step"),direction:this.MU.direction,marks:this.MU.marks,dots:this.MU.dots,step:this.MU.step,included:this.MU.included,max:this.MU.max,min:this.MU.min}},N.prototype.TV=function(){var e=this;return{className:"".concat(this.MU.prefixCls,"-mark"),onClickLabel:this.MU.disabled?f.noop:function(t,n){e.$V(t,n)},direction:this.MU.direction,marks:this.MU.marks,included:this.MU.included,max:this.MU.max,min:this.MU.min}},N.prototype.$V=function(t,n){},N.prototype.QV=function(){var t=this.Wc.getBoundingClientRect();return this.MU.direction===a.LayoutDirection.vertical?t.top:t.left},N.prototype.tY=function(){var t=this.Wc.getBoundingClientRect();return this.MU.direction===a.LayoutDirection.vertical?t.height:t.width},N.prototype.KV=function(t){var n,e,t,n=this.MU.min,e=this.MU.max,t=Math.abs(Math.max(t,0)/this.tY());return(t=this.MU.direction===a.LayoutDirection.vertical?Math.max(1-t,0):t)*(e-n)+n},g=N,y=r.BaseDropdown,i(k,y),k.prototype.setValue=function(t){var t,t;this._V.disabled||(t=parseFloat(t),t=isNaN(t)?this._V.min:(t=Math.max(this._V.min,t),Math.min(this._V.max,t)),this._V.value=t,this.DV=this._V.value,this.yV.setLength(this.calcOffset()),this.wV.setOffset(this.calcOffset(),t))},k.prototype.calcOffset=function(){var t=Math.max(this._V.value-this._V.min,0)/(this._V.max-this._V.min),t;return 100*(t=Math.min(t,1))},k.prototype.setOptions=function(t){this.init(t)},k.prototype.init=function(t){var t,n;this.nY(t),this.eY(),this.Ti.innerHTML="",(t=document.createElement("div")).className="gc-slider-container",this.Ti.appendChild(t),this._V.direction===a.LayoutDirection.vertical?(t.classList.add("".concat(this._V.prefixCls,"-vertical")),t.style.height=this._V.height+"px"):t.style.width=this._V.width+"px",(n=document.createElement("div")).className=this.UV(),t.appendChild(n),this.yV=new l(this.iY(),n),this.wV=new v(this.rY(),n),this.AV=new g(n,this.yV,this.wV,this.oY()),this.AV.render(),this.aY(n)},k.prototype.aY=function(t){var n=this;this._V.disabled||(t.addEventListener("mousedown",this.IV),t.addEventListener("pointerdown",this.IV),t.addEventListener("MSPointerDown",this.IV),t.addEventListener("touchstart",this.EV),t.addEventListener("keyup",function(t){var t,t,t;f.pauseEvent(t),t=n.AV.getKeyboardValueMutator(t),f.isEmpty(t)||(t=t(n._V.value),(t=n.AV.trimAlignValue(t))!==n._V.value&&(n.setValue(t),n._V.onChange(t),n._V.onAfterChange(t),n.fire(r.BaseDropdown.Event_ValueChanged,{value:t,text:t.toString(),notCloseDropDown:!0})))}))},k.prototype.kV=function(t){var n=0,n;return n=this._V.direction===a.LayoutDirection.vertical?this.AV.calcValueByPosition(t.clientY):this.AV.calcValueByPosition(t.clientX)},k.prototype.uY=function(){var t=function(t){};return{prefixCls:"gc-slider",dots:!1,range:!1,disabled:!1,max:100,min:0,step:1,value:0,direction:a.LayoutDirection.horizontal,included:!0,width:350,height:350,marks:{},tooltipVisible:!1,onChange:t,onAfterChange:t,formatString:"General"}},k.prototype.eY=function(){(f.isEmpty(this._V)||f.isEmptyObject(this._V))&&(this._V={}),this._V=f.extend(this.uY(),this._V)},k.prototype.nY=function(t){var e=this;t&&(u(t.scaleVisible)||(this._V.dots=t.scaleVisible),u(t.direction)||(this._V.direction=t.direction),u(t.formatString)||(this._V.formatString=t.formatString),this.sY(t.min,"min"),this.sY(t.max,"max"),this.sY(t.step,"step"),this.sY(t.width,"width"),this.sY(t.height,"height"),this._V.step<=0&&(this._V.step=1),this._V.min>this._V.max&&(this._V.max=this._V.min),u(t.tooltipVisible)||(this._V.tooltipVisible=t.tooltipVisible),this._V.marks={},t.marks)&&t.marks.forEach(function(t){var t,n,t=parseFloat(t);isNaN(t)||t>=e._V.min&&t<=e._V.max&&(n=new o.Formatter.GeneralFormatter(e._V.formatString),e._V.marks[t]={label:n.format(t)})})},k.prototype.sY=function(t,n){var t;u(t)||(t=parseFloat(t),isNaN(t))||(this._V[n]=t)},k.prototype.iY=function(){return{className:"".concat(this._V.prefixCls,"-track"),included:this._V.included,direction:this._V.direction,offset:0,length:0}},k.prototype.rY=function(){return{prefixCls:this._V.prefixCls,className:"".concat(this._V.prefixCls,"-handle"),direction:this._V.direction,disabled:this._V.disabled,min:this._V.min,max:this._V.max,value:this._V.value,offset:0,tabIndex:0,tooltipVisible:this._V.tooltipVisible,formatString:this._V.formatString}},k.prototype.oY=function(){return{prefixCls:this._V.prefixCls,min:this._V.min,max:this._V.max,value:this._V.value,disabled:this._V.disabled,direction:this._V.direction,dots:this._V.dots,step:this._V.step,included:this._V.included,marks:this._V.marks}},k.prototype.UV=function(){var t="".concat(this._V.prefixCls);return this._V.direction===a.LayoutDirection.vertical&&(t+="  ".concat(this._V.prefixCls,"-vertical")),f.isEmptyObject(this._V.marks)||(t+=" ".concat(this._V.prefixCls,"-with-marks")),this._V.disabled&&(t+=" ".concat(this._V.prefixCls,"-disabled")),t},n.Slider=k},"./dist/plugins/celltype/editor/timepicker.js":function(t,n,e){"use strict";var i,r,o,a,u,s,c,f,l;function h(t,n){var t=l.call(this,t)||this;return t.Hc(),t.setOptions(n),t}i=this&&this.__extends||(f=function(t,n){return(f=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(t,n){t.__proto__=n}:function(t,n){for(var e in n)Object.prototype.hasOwnProperty.call(n,e)&&(t[e]=n[e])}))(t,n)},function(t,n){if("function"!=typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function e(){this.constructor=t}f(t,n),t.prototype=null===n?Object.create(n):(e.prototype=n.prototype,new e)}),Object.defineProperty(n,"__esModule",{value:!0}),n.TimePicker=void 0,r=e("./dist/plugins/celltype/editor/listControl.js"),o=e("./dist/plugins/celltype/editor/baseControl.js"),a="undefined",u=e("Common"),s=u.Common.lt.ht,l=o.BaseDropdown,i(h,l),h.prototype.setOptions=function(t){var n,n,n,n;t&&(null!==(n=this.cY(t.min))&&(this.MU.min=n),null!==(n=this.cY(t.max))&&(this.MU.max=n),null!==(n=this.cY(t.step))&&(this.MU.step=n),s(t.formatString)||(this.MU.formatString=t.formatString),s(t.height)||(n=parseInt(t.height,10),isNaN(n))||(this.MU.height=n),this.MU.height=Math.max(1,this.MU.height)),this._6()},h.prototype.setValue=function(t){void 0!==t&&(this.Bz={hour:t.getHours(),minute:t.getMinutes(),second:t.getSeconds()},this.fY=t,this.yz(),this.scrollToSelect())},h.prototype.scrollToSelect=function(){var t,t,t=this.gz.querySelector(".selected");null!==t&&(t=t.offsetTop,this.Wc.scrollTop=t)},h.prototype.Hc=function(){var n=this;this.MU={min:{},max:{hour:23,minute:59,second:59},step:{hour:1},formatString:"hh:mm",height:200},this.gz=document.createElement("div"),this.gz.classList.add("gc-time-picker-outer-div"),this.gz.addEventListener("click",function(t){n.pz(t)}),this.Ti.appendChild(this.gz)},h.prototype.cY=function(t){var n,e,e,e,n=null;return s(t)||(n={},s(t.hour)||(e=parseInt(t.hour,10),isNaN(e))||(n.hour=e),s(t.minute)||(e=parseInt(t.minute,10),isNaN(e))||(n.minute=e),s(t.second))||(e=parseInt(t.second,10),isNaN(e))||(n.second=e),n},h.prototype._6=function(){this.gz.innerHTML="",new r.List(this.gz,this.lY()),this.yz()},h.prototype.yz=function(){var t,n,e,i,r,t=this.gz.querySelectorAll(".gc-time-picker-li");if(0<t.length)for(n=0;n<t.length;n++)t[n].classList.remove("selected"),e=+t[n].getAttribute("hour"),i=+t[n].getAttribute("minute"),r=+t[n].getAttribute("second"),this.hY(this.Bz,{hour:e,minute:i,second:r})&&t[n].classList.add("selected")},h.prototype.lY=function(){var r=this;return{items:function(){var t,n,e,i,t=r.dY(),n=document.createElement("div");for(n.classList.add("gc-time-picker-container"),r.Wc=n,r.MU.height<0?n.style.height="auto":n.style.maxHeight=r.MU.height+"px",(e=document.createElement("ul")).classList.add("gc-time-picker-ul"),i=0;i<t.length;i++)e.appendChild(r.vY(t[i]));return 24*t.length>r.MU.height&&0<=r.MU.height?n.style.overflowY="scroll":n.style.overflowY="hidden",n.appendChild(e),n}}},h.prototype.vY=function(t){var n=document.createElement("li");return n.classList.add("gc-time-picker-li"),n.setAttribute("hour",t.hour.toString()),n.setAttribute("minute",t.minute.toString()),n.setAttribute("second",t.second.toString()),n.innerText=this.mY(t),n},h.prototype.dY=function(){for(var t,n,e,t=this.gY(this.MU.min),n=this.gY(this.MU.max),e=[];t<=n;)e.push({hour:t.getHours(),minute:t.getMinutes(),second:t.getSeconds()}),t=this.pY(t,this.MU.step);return e},h.prototype.pY=function(t,n){return typeof n.hour!=a&&t.setHours(t.getHours()+n.hour),typeof n.minute!=a&&t.setMinutes(t.getMinutes()+n.minute),typeof n.second!=a&&t.setSeconds(t.getSeconds()+n.second),t},h.prototype.mY=function(t){var n,e,t,n=new Date;return n.setHours(t.hour),n.setMinutes(t.minute),n.setSeconds(t.second),(t=(e=new u.Formatter.GeneralFormatter(this.MU.formatString)).format(n))&&""!==t&&null!==t?t:this.bY(n)},h.prototype.bY=function(t){var n,t,e,i,r,n=t.getHours(),t=t.getMinutes(),e,i,r;return(n<12?"AM":"PM")+" "+(0===n||12===n?"12":(n%12).toString())+":"+(t<10?"0"+t.toString():t.toString())},h.prototype.gY=function(t){var n=new Date;return n.setHours(t.hour||0),n.setMinutes(t.minute||0),n.setSeconds(t.second||0),n},h.prototype.hY=function(t,n){return!(!t||!n)&&(t=this.yY(t),n=this.yY(n),t.hour===n.hour)&&t.minute===n.minute&&t.second===n.second},h.prototype.yY=function(t){return{hour:t.hour||0,minute:t.minute||0,second:t.second||0}},h.prototype.pz=function(t){var t,n,e,t,i,r,r,t=t.target;t&&(n=+t.getAttribute("hour"),e=+t.getAttribute("minute"),t=+t.getAttribute("second"),(i=this.fY||new Date).setHours(n),i.setMinutes(e),i.setSeconds(t),i.setMilliseconds(0),r=(new u.Common.CultureInfo).DateTimeFormat,r=new u.Formatter.GeneralFormatter(r.defaultDatePattern).format(i),this.fire(o.BaseDropdown.Event_ValueChanged,{value:i,text:r}),this.Bz={hour:n,minute:e,second:t},this.yz())},n.TimePicker=h},"./dist/plugins/celltype/editor/workflowPicker.js":function(t,n,e){"use strict";var i,r,o,e,s,a,u,c;function f(t,n){var e=c.call(this,t)||this;return e.wY=new o.List(t),e.wY.on(r.BaseDropdown.Event_ValueChanged,function(t){e.fire(r.BaseDropdown.Event_ValueChanged,t)}),e.setOptions(n),e}function l(t,n){var i,r,o,e,a,u,i={items:[]},r=t.items,o=r.filter(function(t){return t.value===n})[0];if(s(o)&&r&&0<r.length)(e=i.items).push({text:r[0].value,value:r[0].value});else if(o&&o.transitions&&0<o.transitions.length)for(a=function(t){var n,t,e,n=o.transitions[t];"number"==typeof n&&r[n]&&(n=r[n].value),(t=r.filter(function(t){return t.value===n})[0])&&(e=i.items).push({text:t.value,value:t.value})},u=0;u<o.transitions.length;u++)a(u);return i}i=this&&this.__extends||(u=function(t,n){return(u=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(t,n){t.__proto__=n}:function(t,n){for(var e in n)Object.prototype.hasOwnProperty.call(n,e)&&(t[e]=n[e])}))(t,n)},function(t,n){if("function"!=typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function e(){this.constructor=t}u(t,n),t.prototype=null===n?Object.create(n):(e.prototype=n.prototype,new e)}),Object.defineProperty(n,"__esModule",{value:!0}),n.WorkFlow=void 0,r=e("./dist/plugins/celltype/editor/baseControl.js"),o=e("./dist/plugins/celltype/editor/listControl.js"),e=e("Common"),s=e.Common.lt.ht,c=r.BaseDropdown,i(f,c),f.prototype.setOptions=function(t){this.MU=t},f.prototype.setValue=function(t){var t;this.MU&&(t=l(this.MU,t),this.wY.setOptions(t))},f.prototype.updateStyle=function(t,n,e){this.wY.updateStyle(t,n,e)},n.WorkFlow=f},"./dist/plugins/celltype/hyperlinkcelltype.js":function(B,t,n){"use strict";var e,i,M,n,g,n,r,y,o,a,C,S,u,s,c,T,p,A,f,l,h,d,v,I,m,b,w,x,N,L,k,F,P,D,G,_,E,j,i,U;function H(t,n){t.removeChild(n)}function O(){var t,e,t=U.call(this)||this;return t.typeName="8",(e=t)._id=t.MY(),s(_,function(t,n){e["_"+t]=n}),t._onAction=function(t){var n,e,i,t,n,e,n=t&&t.sheet,e=t.row,i=t.col,t=t.sheetArea,n=n.getValue(e,i,t),e=z(this._target);n&&f(o(n),e)},t}function z(t){return["_blank","_self","_parent","_top"][t]}function V(t,n,e,i,r,o){var a,u,s,t,a=0,u=0,s=t.width,t=t.height;return a=o=o||0,1===i?a=(s-n)/2:2===i&&(a=s-n-o),1===r?u=(t-e)/2:2===r&&(u=t-e),{x:a,y:u}}function Y(t,n,e,i){var t,e,t=W(t,e),e=t.width;return e+=!0==(1!==n&&!y(i))?i:0,t.width=e,t}function Z(t,n,e,i,r,o){var t,i,t=W(t,i),i=V(r,t.width,t.height,n,e,o);return t.x=i.x,t.y=i.y,t}function W(t,n){var e,i,r,e=a(n),i,r;return{x:0,y:0,width:Math.max(0,M.q.Wt(t,n,!0)),height:t.split(/\r\n|\r|\n/).length*e}}function Q(t,n,e,i,r,o){var a,u,r,s,c,f,r,l,h,d,v,m,g,a=r.sheet,u=a.Dn;if(!y(e)&&(o=o||(r=a.getValue(r.row,r.col,r.sheetArea),y(r))?o:r+""))for(i=e.cellType.An(i,e,a.zoom()),o=o.replace(/\s+/g," "),s=e&&e.font?e.font:u.Nn(),s=u._n(s),c=[o],f=R(e),r=Z(o=e.wordWrap?(c=M.q.un(o,i.width-3-f,s)).join("\r\n"):o,e.hAlign,e.vAlign,s,i,f),l=i.y+r.y,h=0;h<c.length;h++)if(d=Z(c[h],e.hAlign,e.vAlign,s,i,f),v=i.x+d.x,m=p(v+d.width,i.x+i.width),l=p((g=l)+d.height,i.y+i.height),v<=t&&t<m&&g<=n&&n<l)return!0;return!1}function R(t){return 8*(t.textIndent||0)}function J(t,n,e,i,r){var o,i,a,a,u,e,a,s,c,f,l,h,d,v,m,a,o=i&&i.sheet;if(o){if(a=o.Dn,u=n.font||a.Nn(),1<e&&(u=a._n(u)),e=R(n),n.wordWrap||r){if(n.wordWrap){if(a=i.row,s=i.col,c=i.sheetArea,f=0,l=o.Ut.findSpan(a,s,c)){if(l.row>=a&&l.rowCount<=1&&l.col>=s&&s===l.col&&(f=o.nn(s,c),1<l.colCount))for(h=s+1;h<s+l.colCount;h++)f+=o.nn(h,c)}else f=o.nn(s,c);if(i=g(n,1),0<(a=g(n,3))&&(f-=a),0<i&&(f-=i),d=M.q.un(t,f-3-e,u),r&&1<t.split(/\r\n|\r|\n/).length){for(m=v=0;m<d.length;m++)v=Math.max(v,Y(d[m],n.hAlign,u,R(n)).width);return v}r||(t=d.join("\r\n"))}}else t=t.replace(/\s+/g," ");return a=Y(t,n.hAlign,u,R(n)),r?a.width:a.height}return 0}e=this&&this.__extends||(j=function(t,n){return(j=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(t,n){t.__proto__=n}:function(t,n){for(var e in n)Object.prototype.hasOwnProperty.call(n,e)&&(t[e]=n[e])}))(t,n)},function(t,n){if("function"!=typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function e(){this.constructor=t}j(t,n),t.prototype=null===n?Object.create(n):(e.prototype=n.prototype,new e)}),Object.defineProperty(t,"__esModule",{value:!0}),t.HyperLink=t.HyperLinkTargetType=void 0,i=n("Common"),n=(M=n("Core")).CellTypes.Context,g=n.gn,n=M.CellTypes.Base,r=M.mt.En,y=i.Common.lt.ht,o=i.Common.zf.TY,a=M.mt.vt,C=M.mt.Tt,S=C.mozilla,u=M.GC$,s=u.each,c=null,T=Math.max,p=Math.min,A=Math.floor,f=window.open,l="position",h="absolute",d="margin",v="font",I="left",m="top",b="padding",w="border",x="box-sizing",N="background-color",L="content-box",k="default",F="white",P="div",D="hyperlinkInfo",(i=G=t.HyperLinkTargetType||(t.HyperLinkTargetType={}))[i.blank=0]="blank",i[i.self=1]="self",i[i.parent=2]="parent",i[i.top=3]="top",_={linkColor:"#0066cc",visitedLinkColor:"#3399ff",text:"",linkToolTip:"",target:0,activeOnClick:!0},e(O,U=n),O.prototype.MY=function(){var t,n;return y(this._id)&&(this._id="0"),n="id_"+(t=parseInt(this._id,10)),this._id=++t+"",n},O.prototype.AY=function(t,n,e,i,r,o,a,u,s,c){var f,l,h,d,v,m,h,r,g,p,n,b,y,w,M,f=1,l=I,h=a.hAlign,d=a.vAlign,v=u.lineHeight,m=s.length;for(f+=n,1===h?(f=r/2,l="center"):2===h&&(f=r-1,f-=n,l="right"),t.textAlign!==l&&(t.textAlign=l),h=1,r="alphabetic",h+=v-(n=v/2-(g=parseInt(u.fontInfo.fontSize,10))/2+(p=8<g?A((g-8)/5+2):1)-1),1===d?v<o&&(h=S?(o-c)/2+1:C.msie?(o-c)/2+.5:(o-c)/2,A(h)!==h&&(h+=.5),h+=v/2-n):2===d&&(h=o-c-2.5-n),t.textBaseline!==r&&(t.textBaseline=r),b=i+h,y=0;y<m;y++)t.fillText(s[y],e+f,b),w=t.measureText(s[y]).width,(M=a.textDecoration)&&this.le(t,M,e+f,b,w,g,p),b+=v},O.prototype.IY=function(t,n,e,i,r,o,a,u,s){var c,f,l,h,d,v,h,m,g,p,b,y,a,u,w,c=a.hAlign,f=a.vAlign,l=u.lineHeight,d=s.length,m=0,g=0,b=0,y=0;for(2!==c&&(b=1),2===a.vAlign&&(y=-2.5),y-=T(0,Math.round(l/9)-1),t.strokeStyle!==t.fillStyle&&(t.strokeStyle=t.fillStyle),a=u.fontInfo.fontSize,u=A((a-12)/21+1),t.lineWidth=u,t.beginPath(),w=0;w<d;w++)h=t.measureText(s[w]).width,h=(v=b+e+(p=V(new M.Rect(e,i,r,o),h,l*d,c,f,n)).x)+h,m=y+i+p.y+l,A(m)===m&&(m+=.5),g=m,t.moveTo(v,m),t.lineTo(h,g),t.stroke(),y+=l},O.prototype.paintValue=function(t,n,e,i,r,o,a,u){var s,n,c,f,l,h,d,v,m,g,g,h,d,p,v,m,l,g,b,s=this;if(t&&(n=s.getText(n,u),!y(n))){for(c=(n+="").split(/\r\n|\r|\n/),f=0;f<c.length;)c[f]=c[f].replace(/\s+/g," "),f++;n=c.join("\r\n"),l=!1,h=u.sheet.Ut,d=u.row,v=u.col,m=u.sheetArea,(g=h.getValueForKey(d,v,D,m))&&(s._id===g.id?l=g.visited:h.do("setValueForKey",d,v,D,void 0,m)),t.save(),t.beginPath(),(g=l?s._visitedLinkColor:s._linkColor)&&t.fillStyle!==g&&(t.fillStyle=g),(h=a.font)&&t.font!==h&&M.mt.bt(t,h),d=R(a),u.sheet.outlineColumn&&u.sheet.outlineColumn.Un(u.col)&&(d=0),v=[],l=m=0,(p=a.wordWrap)?(g=r-3-d,1<(m=(v=M.q.un(n,--g,h)).length)&&0!==a.vAlign&&(l=(m-1)*(b=u.lineHeight))):v.push(n),t.rect(e,i,r,o),t.clip(),t.beginPath(),s.AY(t,d,e,i,r,o,a,u,v,l),s.IY(t,d,e,i,r,o,a,u,v),t.restore()}},O.prototype.getText=function(t,n){return this._text||t},O.prototype.j3=function(t,n,e,i){var r;t.Ai||(r=t.parent)&&r.j3(t,n,e,i)},O.prototype.getHitInfo=function(t,n,e,i,r){var o,a,o=this;return r&&(a=r.sheetArea,y(a)&&(a=3),e)&&i?{x:t,y:n,row:r.row,col:r.col,cellStyle:e,cellRect:i,sheetArea:a,isFocusAware:!0,sheet:r.sheet,isReservedLocation:Q(t,n,e,i,r,o._text)}:c},O.prototype.processMouseDown=function(t){var n=t&&t.sheet,e=this;n&&!n.isEditing()&&t.isReservedLocation&&(e.xY=!0)},O.prototype.processMouseUp=function(t){var n,n,n=t&&t.sheet;n&&!n.isEditing()&&(n=this,t.isReservedLocation&&n.xY&&n.NY(t),n.xY=!1)},O.prototype.processMouseMove=function(t){var n,e,i,r,n,n=t.row,e=t.col,i=t.sheet,r=this;!i||i.isEditing()&&i.getActiveRowIndex()===n&&i.getActiveColumnIndex()===e||(n=i.Dg(),t.isReservedLocation?n&&(r.kY(i,t),n.style.cursor="pointer"):(r.DY(i),n&&(n.style.cursor=k)))},O.prototype.processMouseLeave=function(t){var t,n,n,t=t.sheet,n=this;n.xY=!1,n.DY(t),t&&(n=t.Dg())&&(n.style.cursor=k)},O.prototype.kY=function(t,n){var e,i,r,e,o,e,n,e=this;e._linkToolTip&&(i=e._Y(),(r=u(i)).text(e._linkToolTip),o=(e=t.rt.it()).left+n.x,e=e.top+n.y+20,0===r.parent().length)&&((n=t&&t.qc())&&n.insertBefore(i,c),r.css(m,e).css(I,o))},O.prototype.DY=function(t){var n,t,n=this;n.EY&&((t=t&&t.qc())&&n.EY.parentElement===t&&H(t,n.EY),n.EY=c)},O.prototype._Y=function(){var t,n,t=this;return t.EY||(n=r(P),u(n).css(l,h).css(d,0).css(b,2).css(w,"1px #c0c0c0 solid").css("box-shadow","1px 2px 5px rgba(0,0,0,0.4)").css(x,L).css(N,F).css(v,"9pt Arial"),t.EY=n),t.EY},O.prototype.isReservedKey=function(t,n){return 32===t.keyCode&&!t.ctrlKey&&!t.shiftKey&&!t.altKey},O.prototype.processKeyUp=function(t,n){var e,i;return!!n.sheet&&(this.NY(n),!0)},O.prototype.getAutoFitWidth=function(t,n,e,i,r){return J(this._text||t,e,i,r,!0)},O.prototype.getAutoFitHeight=function(t,n,e,i,r){return J(this._text||t,e,i,r)},O.prototype.isImeAware=function(t){return!1},O.prototype.NY=function(t){var n,e,i,r,o,a,n=t&&t.sheet,e=this,i=t.row,r=t.col,o=t.sheetArea,a;e.onClickAction().call(this,t),n.Ut.do("setValueForKey",i,r,D,{id:e._id,visited:!0},o),n.repaint(n.getCellRect(i,r,1===o?-1:c,2===o?-1:c)),e.j3(n,i,r,o)},O.prototype.onClickAction=function(t){return 0===arguments.length?this._onAction:(t&&(this._onAction=t),this)},O.prototype.Je=function(t){var t={linkColor:t.linkColor,visitedLinkColor:t.visitedLinkColor,text:t.text,linkToolTip:t.linkToolTip,target:t.target&&G[t.target],activeOnClick:t.activeOnClick};this.fromJSON(t)},O.prototype.toJSON=function(){var e,i,r,e=this,i={typeName:e.typeName};return s(_,function(t,n){(r=e["_"+t])!==n&&(i[t]=r)}),i},O.prototype.fromJSON=function(e){var i=this;s(_,function(t){var n=e[t];y(n)||(i["_"+t]=n)})},O.prototype.jn=function(t){},O.prototype.Ke=function(){var e,i,r,e=this,r=new O;return s(_,function(t,n){(i=e["_"+t])!==n&&(r["_"+t]=i)}),r._onAction=e._onAction,r},E=O,t.HyperLink=E,s(_,function(n){E.prototype[n]=function(t){return 0===arguments.length?this["_"+n]:(this["_"+n]=t,this)}}),M.CellTypes.ti[8]=E},"./dist/plugins/celltype/radiochecklistcelltype.js":function(M,t,n){"use strict";var e,G,n,C,S,U,H,c,nt,l,f,h,d,et,n,i,a,z,V,y,T,o,Y,Z,W,u,r,i,n,A,s,v,I,i,i,x,N,k,m,g;function Q(t,n){return t.hasOwnProperty(n)}function p(t,n){return t instanceof Date&&n instanceof Date?S(t)===S(n):!d(t)&&!d(n)&&t.toString&&n.toString?t.toString()===n.toString():t===n}function D(t){var n,t,e,i,r,n=["0","0","0","0"];return typeof t===T&&(r=i=void 0,1===(e=(t=t.split(" ",4)).length)?n=[i=t[0],i,i,i]:2===e?n=[i=t[0],r=t[1],i,r]:3===e?(r=t[1],n=[t[0],r,t[2],r]):4===e&&(n=[t[0],t[1],t[2],t[3]])),n}function b(){var t,e,t=x.call(this)||this;return t.typeName="11",t.defaultPadding=5,e=t,a(u,function(t,n){e["_"+t]=n="items"===t?[]:n}),t}function _(){return null!==N&&N.apply(this,arguments)||this}function E(){var t=null!==k&&k.apply(this,arguments)||this;return t.typeName="12",t}function w(){var t,e,t=g.call(this)||this;return t.typeName="13",t.defaultPadding=0,e=t,a(s,function(t,n){e["_"+t]=n="items"===t?[]:n}),e._boxSize=0,delete e.boxSize,t}function j(t,n,e,i,r,o){var a,a,r,a=n.getValue(e,i,o),a=t.wG(a,r),r={cmd:"editCell",sheetName:n.name(),row:e,col:i,newValue:a,autoFormat:!1};n.Qy().execute(r),t.triggerButtonClicked(n,e,i,o)}function J(t,n,e,i,r){var n,o,e,a,u,n=n.zoom(),o=X(t._boxSize,e.font,n),e=rt(t,e),a,u=i;return H(e,o)*(u=t._items.length<i?t._items.length:u)+t._itemSpacing.vertical*n*(u-1)}function K(t,n,e,i,r){var o,a,u,n,s,o=n.zoom(),a=X(t._boxSize,e.font,o),u=t.defaultPadding*o,n=it(t,n,e,i,r),s=0;return n.forEach(function(t){s+=t}),s+=r*(a+u)+(r-1)*t._itemSpacing.horizontal*o}function it(t,n,e,i,r){for(var o,a,u,u,s,s,o=[],a=0;a<t._items.length;a++)u=Q(t._items[a],V)?t._items[a].text:t._items[a],u=n.Qt(u,e.font),(s=t.jY()).hasMargin&&(u=u+s.paddingLeft+s.paddingRight),s=U(a%r),o[s=t._direction===Z.vertical?U(a/i):s]=o[s]===h?u:Math.max(o[s],u);return o}function X(t,n,e){var i=Y*e;return"number"==typeof t&&0<=t?i=t*e:"auto"===t&&(i=z(n)/2),i}function rt(t,n){var n,t,n=z(n.font),t=t.jY();return n=t.hasMargin?n+t.paddingTop+t.paddingBottom:n}function q(t,n,e,i){var e,r,e=O(t)*e,r=e;return 1===t.hAlign?r=(n.width-i)/2:2===t.hAlign&&(r=n.width-e-i),r}function $(t,n,e,i){var e,r,e=2*e,r=e;return 1===t.vAlign?n.height-e>i&&(r=(n.height-i-e)/2+e):2===t.vAlign&&(r=n.height-i-e),r}function tt(t,n,e,i,r){var o,a,u,s;if(t._direction===Z.vertical){if(t._isFlowLayout){if(r!==h)for(o=t._items.length;0<o;){if(!(r<(a=J(t,n,e,o,c(t._items.length/o)))))return[o=H(o,1),c(t._items.length/o)];o-=1}return[t._items.length,1]}return[o=H(1,t._maxRowCount),c(t._items.length/o)]}if(t._isFlowLayout){if(i!==h)for(u=t._items.length;0<u;){if(!(i<(s=K(t,n,e,c(t._items.length/u),u))))return u=H(u,1),[c(t._items.length/u),u];u-=1}return[1,t._items.length]}return u=H(1,t._maxColumnCount),[c(t._items.length/u),u]}function O(t){var n=t.textIndent;return 1===t.hAlign||0===n||n===f||n===h?2:8*n}function R(u,s){for(var t,n,c,f,e,e,t,l,h,d,v,m,g,n,t,p,b,i,r,o,t=s.cellRect.width,n=s.cellRect.height,c=s.sheet,f=c.zoom(),e=c.Z_(s.row,s.col),e=e&&e.font,t=tt(u,c,s.cellStyle,t-1,n),l=t[0],h=t[1],d=it(u,c,s.cellStyle,l,h),v=X(u._boxSize,e,f),m=u.defaultPadding*f,g=H(rt(u,s.cellStyle),v),n=K(u,c,s.cellStyle,l,h),t=J(u,c,s.cellStyle,l,h),p=q(s.cellStyle,s.cellRect,f,n),b=$(s.cellStyle,s.cellRect,f,t),i=function(t){var n,n,e,i,r,o,a,e,e,n,n=Q(u._items[t],V)?u._items[t].text:u._items[t],n=c.Qt(n,s.cellStyle.font),e=U(t/h),i=t%h;if(u._direction===Z.vertical&&(e=t%l,i=U(t/l)),r=new G.Rect,o=0,(a=d.filter(function(t,n){return n<i})).forEach(function(t){o+=t}),r.x=p+o+i*(v+m+u._itemSpacing.horizontal*f),r.y=b+e*g+u._itemSpacing.vertical*f*e,e=u.jY(),r.width=(u._textAlign!==W.right||e.hasMargin?d[i]:n)+v+m,r.height=g,e=s.x-s.cellRect.x,n=s.y-s.cellRect.y,r&&r.contains(e,n))return{value:{value:Q(u._items[t],y)?u._items[t].value:u._items[t]}}},r=0;r<u._items.length;r++)if("object"==typeof(o=i(r)))return o.value}function B(t,n){var e,i,r,e=!1,i=Q(t,y)?t.value:t;if(n!==f)if(Array.isArray(n)){for(r=0;r<n.length;r++)if(p(n[r],i)){e=!0;break}}else e=p(n,i);return e}function L(t,n,e,i){var r,o,a,u,s;if(i)return n;for(t===f&&(t=[]),Array.isArray(t)||(t=[t]),r={},e.forEach(function(t){r[Q(t,y)?t.value:t]=!0}),o=t.length-1;0<=o;o--)r[t[o]]||t.splice(o,1);if(-1===(u=(a=t.slice()).indexOf(n)))a.push(n);else for(o=a.length-1;0<=o;o--)p(a[o],n)&&a.splice(o,1);return s=[],e.forEach(function(t){-1!==a.indexOf(t.value)&&s.push(t.value)}),s}e=this&&this.__extends||(I=function(t,n){return(I=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(t,n){t.__proto__=n}:function(t,n){for(var e in n)Object.prototype.hasOwnProperty.call(n,e)&&(t[e]=n[e])}))(t,n)},function(t,n){if("function"!=typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function e(){this.constructor=t}I(t,n),t.prototype=null===n?Object.create(n):(e.prototype=n.prototype,new e)}),Object.defineProperty(t,"__esModule",{value:!0}),t.ButtonList=t.CheckBoxList=t.RadioButtonList=t.SelectionMode=t.TextAlign=t.Direction=void 0,G=n("Core"),n=n("Common"),C=n.Common.lt.tv,S=n.Common.ct.o0,U=Math.floor,H=Math.max,c=Math.ceil,nt="left",l="alphabetic",f=null,h=void 0,d=n.Common.lt.ht,et=G.mt.bt,n=G.CellTypes.Base,i=G.GC$,a=i.each,z=G.mt.vt,V="text",y="value",T="string",o="number",Y=12,(i=Z=t.Direction||(t.Direction={}))[i.horizontal=0]="horizontal",i[i.vertical=1]="vertical",(i=W=t.TextAlign||(t.TextAlign={}))[i.left=2]="left",i[i.right=3]="right",u={items:f,direction:Z.horizontal,maxColumnCount:1,maxRowCount:1,isFlowLayout:!0,itemSpacing:{horizontal:20,vertical:5},textAlign:W.right,boxSize:Y},e(b,x=n),b.prototype.paintValue=function(t,n,e,i,r,o,a,u){var s,c,B,f,l,h,d,v,m,g,p,b,h,y,w,M,C,S,T,A,I,d,x,N,L,k,D,_,E,j,O,R,R,F,P,s=this;if(t){for(t.save(),t.rect(e+1,i+1,r-2,o-2),t.clip(),t.beginPath(),B=c=0,l=(f=u.sheet).zoom(),h=a.font,d=u.isPrinting,v=u.printZoomFactor,m=X(s._boxSize,h,l=d&&"number"==typeof v&&1!==v?v:l),g=s.defaultPadding*l,p=m/2,b=new G.Rect(e+1,i+1,r-2,o-2),M=K(s,f,a,y=(h=tt(s,f,a,r-2,o-2))[0],w=h[1]),C=J(s,f,a,y,w),S=it(s,f,a,y,w),T=rt(s,a),A=e+q(a,b,l,M),I=i+$(a,b,l,C),(d=a.font)&&t.font!==d&&et(t,u.fontInfo.font),a.foreColor&&(t.fillStyle=a.foreColor),x=a.textDecoration,L=8<(N=u.fontInfo.fontSize)?U((N-8)/5+2):1,k=0,k=(B=z(a.font))/2-N/2+L-1,D=A,_=I,j=E=0,m<N&&(E=s.OY(m),j=(T-k-Y)/2+1),O=0;O<s._items.length;O++)e+r<A||i+o<I||(R=Q(s._items[O],V)?s._items[O].text:s._items[O],c=f.Qt(R,a.font),t.textAlign=nt,R=s._direction===Z.vertical?S[U(O/y)]:S[O%w],F=0,F=s._textAlign===W.left?(s.RY(t,s._items[O],n,c,A,I+E,R,T,k),A=A+R+g,t.save(),s.BY(t,n,s._items[O],A,I+j,p),t.restore(),m):(t.save(),s.BY(t,n,s._items[O],A,I+j,p),A=A+m+g,t.restore(),s.RY(t,s._items[O],n,c,A,I+E,R,T,k),R),x&&(P=this.jY(),s.le(t,x,A-(s._textAlign===W.right?0:R+g)+P.paddingLeft,I+T-k-P.paddingBottom,c,N,L)),s._direction===Z.vertical?(I+=H(T,m)+s._itemSpacing.vertical*l,(O+1)%y==0&&(D=D+R+m+g+s._itemSpacing.horizontal*l,I=i+$(a,b,l,C)),A=D):(A=A+F+s._itemSpacing.horizontal*l,(O+1)%w==0&&(A=e+q(a,b,l,M),_=_+H(T,m)+s._itemSpacing.vertical*l),I=_));t.restore()}},b.prototype.OY=function(t){return(t-Y)/2},b.prototype.getText=function(t,n){return t},b.prototype.RY=function(t,n,e,i,r,o,a,u,s){var n=Q(n,V)?n.text:n;t.textBaseline!==l&&(t.textBaseline=l),t.fillText(n,r,o+u-s)},b.prototype.getItemsBound=function(u,t,n,e){var s,c,f,i,r,o,a,l,t,n,e,h,d,v,m,g,p,t,n,b,y,w,M,C,s=this,c=u.zoom(),f=u.getActualStyle(t,n,e),i,r=G.W.V("11pt "+u.currentTheme().bodyFont(),c);for(f.font&&(r=G.W.V(f.font,c)),f.font=r.font,t=(l=u.getCellRect(t,n,o=1===e?-1:void 0,a=2===e?-1:void 0)).width,n=l.height,e=tt(s,u,f,t-1,n),h=e[0],d=e[1],v=it(s,u,f,h,d),m=X(s._boxSize,r.font,c),g=s.defaultPadding*c,p=H(rt(s,f),m),t=K(s,u,f,h,d),n=J(s,u,f,h,d),b=q(f,l,c,t),y=$(f,l,c,n),w=[],M=function(t){var n,n,e,i,r,o,a,e,n=Q(s._items[t],V)?s._items[t].text:s._items[t],n=u.Qt(n,f.font),e=U(t/d),i=t%d;s._direction===Z.vertical&&(e=t%h,i=U(t/h)),r=new G.Rect,o=0,(a=v.filter(function(t,n){return n<i})).forEach(function(t){o+=t}),r.x=b+o+i*(m+g+s._itemSpacing.horizontal*c)+l.x,r.y=y+e*p+s._itemSpacing.vertical*c*e+l.y,e=s.jY(),r.width=(s._textAlign!==W.right||e.hasMargin?v[i]:n)+m+g,r.height=p,r.x>l.x+l.width||r.y>l.y+l.height?w[t]=null:w[t]=r},C=0;C<s._items.length;C++)M(C);return w},b.prototype.BY=function(t,n,e,i,r,o){},b.prototype.jY=function(){return{hasMargin:!1,paddingTop:0,paddingBottom:0,paddingLeft:0,paddingRight:0}},b.prototype.getAutoFitWidth=function(t,n,e,i,r){var r,o,a,u,s,r=r&&r.sheet,o=O(e),a=tt(this,r,e),u,s;return(K(this,r,e,a[0],a[1])+o)/i},b.prototype.getAutoFitHeight=function(t,n,e,i,r){var o,r,a,u,o=r&&r.sheet,r=tt(this,o,e,+o.getColumnWidth(r.col)*i),a,u;return J(this,o,e,r[0],r[1])/i},b.prototype.getHitInfo=function(t,n,e,i,r){var o,a,u,t,n,r,a,r,s,o,u,a,c,o=this;return r&&(a=r.sheetArea,u=r.sheet,i=e.cellType.An(i,e,u.zoom()),d(a)||3===a)&&i?(t={x:t,y:n,row:r.row,col:r.col,cellStyle:e,cellRect:i,sheetArea:a,sheet:u},n=u.zoom(),e.font&&(e.font=G.W.V(e.font,n).font),s=K(o,u,e,a=(r=tt(o,u,e,i.width-1,i.height-2))[0],r=r[1]),o=J(o,u,e,a,r),u=i.x+q(e,i,n,s),a=i.y+$(e,i,n,o),(c=new G.Rect(u,a,s,o)).contains(t.x,t.y)&&(t.isReservedLocation=!0),t):f},b.prototype.processMouseDown=function(t){if(!t)return!1;t.isReservedLocation&&(this.pG=!0)},b.prototype.processMouseLeave=function(t){if(x.prototype.processMouseLeave.call(this,t),!t)return!1;this.pG=!1},b.prototype.processMouseUp=function(t){var n,e,i,r,o,a;return!!t&&(e=t.sheet,!!((n=this).pG&&e&&t.isReservedLocation&&(n.pG=!1,i=t.row,r=t.col,o=t.sheetArea,a=R(n,t))))&&(j(n,e,i,r,a.value,o),!0)},b.prototype.wG=function(t,n){return L(t,n,this._items,!0)},b.prototype.triggerButtonClicked=function(t,n,e,i){var r=t.parent;r&&r.j3(t,n,e,i)},b.prototype.Je=function(t){var t={items:t.items,direction:t.direction&&Z[t.direction],maxColumnCount:t.maxColumnCount,maxRowCount:t.maxRowCount,isFlowLayout:t.isFlowLayout,itemSpacing:t.itemSpacing,textAlign:t.textAlign&&W[t.textAlign],boxSize:t.boxSize};this.fromJSON(t)},b.prototype.toJSON=function(){var i,r,o,i=this,r={typeName:i.typeName};return a(u,function(t,n){var e;o=i["_"+t],("items"===t?o&&0<o.length:o!==n)&&(r[t]="object"==typeof o?C(o):o)}),r},b.prototype.fromJSON=function(e){var i=this;a(u,function(t){var n=e[t];d(n)||(i["_"+t]=n)})},e(_,N=r=b),_.prototype.BY=function(t,n,e,i,r,o){var e=Q(e,y)?e.value:e;t.beginPath(),t.fillStyle="white",t.arc(i+o,r+o,o,0,2*Math.PI),t.fill(),t.beginPath(),t.strokeStyle="black",t.arc(i+o,r+o,o,0,2*Math.PI),t.stroke(),n!==f&&p(n,e)&&(t.beginPath(),t.strokeStyle="black",t.arc(i+o,r+o,.5*o,0,2*Math.PI),t.fillStyle="black",t.fill(),t.stroke())},t.RadioButtonList=i=_,e(E,k=r),E.prototype.BY=function(t,n,e,i,r,o){t.strokeStyle="black",t.strokeRect(i+.5,r+.5,2*o+.05,2*o+.05),t.fillStyle="white",t.fillRect(i+1,r+1,2*o-1,2*o-1);var e=B(e,n);n!==f&&e&&(t.beginPath(),t.lineWidth=2.5,t.moveTo(i+3,r+o),t.lineTo(i+o,r+2*o-3.5),t.lineTo(i+2*o-1.5,r+3),t.stroke())},E.prototype.wG=function(t,n){return L(t,n,this._items,!1)},t.CheckBoxList=n=E,(m=A=t.SelectionMode||(t.SelectionMode={}))[m.single=0]="single",m[m.multiple=1]="multiple",s={selectedBackColor:"rgb(227,119,0)",selectedForeColor:"white",padding:"5",items:f,itemSpacing:{horizontal:5,vertical:5},selectionMode:A.multiple},e(w,g=r),w.prototype.RY=function(t,n,e,i,r,o,a,u,s){var e,n,c,f,e;t.save(),t.beginPath(),e=B(n,e),n=Q(n,V)?n.text:n,c=this._selectedBackColor,f=this._selectedForeColor,e&&(t.fillStyle=c,t.fillRect(r+1,o+1,a-1,u-1),t.fillStyle=f),t.textAlign="center",t.textBaseline!==l&&(t.textBaseline=l),e=this.jY(),t.fillText(n,r+e.paddingLeft+(a-e.paddingLeft-e.paddingRight)/2,o+e.paddingTop+u-e.paddingTop-e.paddingBottom-s),t.restore()},w.prototype.wG=function(t,n){return L(t,n,this._items,this._selectionMode===A.single)},w.prototype.jY=function(){var t,n,e,i,r,t=0,n=0,e=0,i=0;return this._padding&&(r=D(this._padding),t=typeof(t=parseInt(r[0],10))==o&&0<t?t:0,i=typeof(i=parseInt(r[1],10))==o&&0<i?i:0,n=typeof(n=parseInt(r[2],10))==o&&0<n?n:0,e=typeof(e=parseInt(r[3],10))==o&&0<e?e:0),{hasMargin:!0,paddingTop:t,paddingBottom:n,paddingLeft:e,paddingRight:i}},w.prototype.OY=function(t){return 0},w.prototype.toJSON=function(){var i,r,o,i=this,o=g.prototype.toJSON.call(this);return a(s,function(t,n){var e;r=i["_"+t],("items"===t?r&&0<r.length:r!==n)&&(o[t]="object"==typeof r?C(r):r)}),o},w.prototype.fromJSON=function(e){g.prototype.fromJSON.call(this,e);var i=this;a(s,function(t){var n=e[t];d(n)||(i["_"+t]=n)})},v=w,t.ButtonList=v,a(u,function(u){r.prototype[u]=function(t){var n,e,i,r,o,a,a,a,n="_"+u,e=this;if(0===arguments.length)return e[n];if("items"===u){for(i=[],r=0;r<t.length;r++)o=t[r],d(o.text)||d(o.value)?d(o.text)?d(o.value)?d(o)||"object"==typeof o||i.push({text:o,value:o}):(o.text=o.value,i.push(o)):(o.value=o.text,i.push(o)):i.push(o);t=i}if("itemSpacing"===u)a=e[n],e[n]={horizontal:a.horizontal,vertical:a.vertical},d(t.horizontal)||(a=parseInt(t.horizontal,10),isNaN(a))||(e[n].horizontal=a),d(t.vertical)||(a=parseInt(t.vertical,10),isNaN(a))||(e[n].vertical=a);else if("boxSize"===u){if(d(t))return e[n];"number"==typeof t&&0<=t&&(e[n]=t),"auto"===t&&(e[n]=t)}else e[n]=t;return e}}),G.CellTypes.ti[11]=i,G.CellTypes.ti[12]=n,a(s,function(u){v.prototype[u]=function(t){var n,e,i,r,o,a,a,a,n="_"+u,e=this;if(0===arguments.length)return e[n];if("items"===u){for(i=[],r=0;r<t.length;r++)o=t[r],d(o.text)||d(o.value)?d(o.text)?d(o.value)?d(o)||"object"==typeof o||i.push({text:o,value:o}):(o.text=o.value,i.push(o)):(o.value=o.text,i.push(o)):i.push(o);t=i}return"itemSpacing"===u?(a=e[n],e[n]={horizontal:a.horizontal,vertical:a.vertical},d(t.horizontal)||(a=parseInt(t.horizontal,10),isNaN(a))||(e[n].horizontal=a),d(t.vertical)||(a=parseInt(t.vertical,10),isNaN(a))||(e[n].vertical=a)):e[n]=t,e}}),G.CellTypes.ti[13]=v},"./dist/plugins/celltype/rangecelltype.js":function(t,n,e){"use strict";var i,pt,r,s,bt,yt,e,wt,Mt,Ct,a,u,i,o,c;function h(t){return t.map(function(t){return{start:t.start,size:t.size}})}function f(){this.FY=0,this.PY=0,this.Sx=0,this.Tx=0}function l(){}function d(t,n,e,i,r){var o,n,o=c.call(this)||this;return o.allowOverflow=!1,o.typeName="16",n=1===arguments.length?new pt.Range(0,0,t.getRowCount(),t.getColumnCount()):new pt.Range(n,e,i,r),t&&n&&(o.GY=(new a).yN(t,n),o.UY=(new u).yN(t,n)),o}function v(t,n,B,e,i,r,L){var o,a,u,s,c,F,f,P,G,l,h,d,U,v,H,z,V,m,g,p,Y,n,b,Z,y,W,Q,J,K,X,q,w,$,tt,M,C,S,T,C,nt,A,I,x,N,k,D,_,C,N,k,et,it,rt,E,j,ot,at,ut,st,ct,ft,O,T,k,lt,k,T,R,ht,dt,vt,mt,gt,R;for(void 0===L&&(L=1),o=n.x,a=n.y,u=n.width,s=n.height,c=e.sheet,F=e.sheetArea,f=e.isPrinting,P=e.needTopGridline,G=e.needLeftGridline,l=[],h=[],d=[],U=!0,v=[],H=c.BO(),z=r.rowCount,V=r.colCount,m=r.rowSize,g=r.colSize,p=r.cellStyleList,Y=r.sparklines,i.HY(B),b=(n=i.zY()).baseRow,Z=n.baseCol,W=(y=i.VY).hl,y.cg(new pt.Rect(0,0,u,s)),Q=new pt.Yx(y,y._y(1,3),y.Yy(1,3),3),J=i.YY(!0),a+=1,--s,o+=1,--u,X=K=0,m=m.map(function(t){var n=t.size*s,e=Ct(n);return 1<=(X+=n-e)&&(e++,X--),{start:Ct(t.start*s),size:e}}),g=g.map(function(t){var n=t.size*u,e=Ct(n);return 1<=(K+=n-e)&&(e++,K--),{start:Ct(t.start*u),size:e}}),q=y.conditionalFormats,w=0;w<z;w++){for($={row:w+b,y:a,height:s},tt=[],M=0;M<V;M++)if(p[w][M]&&(S=(C=p[w][M]).style,T=C.isSpan,C=C.span,nt=!1,A=J[w][M],!T||C)){if(S=S.clone(!0),I=Ct(o+g[M].start),x=Ct(a+m[w].start),k=N=void 0,D=T?C.colCount:1,_=T?C.rowCount:1,N=g[M+D]?g[M+D].start:u,C=Ct(N-g[M].start),k=m[w+_]?m[w+_].start:s,N=Ct(k-m[w].start),$.y=x,$.height=N,A.formatStyle&&(A.formatStyle.h5(S),S=A.formatStyle),S.v5(W),k=Mt,T){for(k={row:w,col:M,x:Ct(I),y:Ct(x),width:Ct(C),height:Ct(N),rowCount:_,colCount:D},et={},it={},rt=[],j=E=void 0,E=at=ot=0;E<D-1;E++)st=(ut=g[M+E])?ut.size:0,ot+=it[E]=st;for(it[E]=Ct(C)-ot,j=0;j<_-1;j++)st=(ct=m[w+j])?ct.size:0,at+=et[j]=st;for(et[j]=Ct(N)-at,j=0;j<_;j++){for(ft=[],O=0;O<D;O++)p[j+w]&&p[j+w][M+O]&&ft.push(p[j+w][M+O].style);rt.push(ft)}k.spanSizeInfo={styleList:rt,rowSizes:et,colSizes:it}}Q.PN(w,M,Ct(I),Ct(x),Ct(C),Ct(N),S,k,P&&0===w,G&&0===M),(T=S.formatter)&&pt.util.St(T)&&(!(k=c.parent&&c.parent.xO(T))||!(lt=k.getExpression())||(k=(0,yt.evaluateFormula)(c,T.replace("@",JSON.stringify(A.value))))instanceof bt.CalcError||(A.value=k)),T=null,Y[w][M]&&(T=Y[w][M].clone())&&(T.ZY=y.name(),T.WY=T.QY(y),T.KY=T.JY(y),T.XY=y),A&&A.value&&"SparklineExValue"===A.value.typeName&&(v.push({value:A.value,x:I,y:x,width:C,height:N,option:e}),nt=!0),A.validStyle&&h.push({style:A.validStyle,x:I,y:x,width:C,height:N}),tt.push({col:M+Z,x:I,y:x,width:C,height:N}),l.push({data:nt?null:A.value,row:w,col:M,x:I,y:x,width:C,height:N,style:S,sparkline:T,baseRow:w+b,baseCol:M+Z,conditionalFormats:q,imageLoader:H,cellLayout:{row:w,col:M,x:I,y:x,width:C,height:N}}),S&&S.decoration&&S.decoration.icons&&0<S.decoration.icons.length&&d.push({style:S,x:I,y:x,width:C,height:N})}0<tt.length&&y.Dn.vfe(d,tt,$,f,c,F)}for(t.save(),P&&(a-=2,s+=4),G&&(o-=2,u+=4),t.rect(o,a,u,s),t.clip(),0<l.length&&y.Dn.eO(t,l,F,f,1,c,b,Z,L),Q.paint(t),0<h.length&&y.Dn.EO(t,h),0<d.length&&y.Dn.ase(t,d,{isPrinting:f,printZoomFactor:1,sheet:c,imageLoader:H}),t.restore(),w=0;w<v.length;w++)ht=(R=v[w]).value,dt=R.x,vt=R.y,mt=R.width,gt=R.height,R=R.option,wt.dn(t,ht,dt,vt,mt,gt,R)}i=this&&this.__extends||(o=function(t,n){return(o=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(t,n){t.__proto__=n}:function(t,n){for(var e in n)Object.prototype.hasOwnProperty.call(n,e)&&(t[e]=n[e])}))(t,n)},function(t,n){if("function"!=typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function e(){this.constructor=t}o(t,n),t.prototype=null===n?Object.create(n):(e.prototype=n.prototype,new e)}),Object.defineProperty(n,"__esModule",{value:!0}),n.paintRangeTemplate=n.RangeTemplate=n.qY=n.$Y=void 0,pt=e("Core"),r=e("Bindings"),s=e("Sparkline"),bt=e("CalcEngine"),yt=e("SheetsCalc"),e=pt.CellTypes.Base,wt=pt.CellTypes.Context,Mt=null,Ct=Math.floor,f.prototype.yN=function(t,n){var e=this,i=n.row,r=n.col,o=n.rowCount,a=n.colCount;return e.FY=i,e.PY=r,e.Sx=o,e.Tx=a,e.TP=e.ZF(t,n),e.tZ=e.nZ(t,n),e},f.prototype.eZ=function(){return this.tZ},f.prototype.nZ=function(t,n){for(var e,i,r,o,a,u,s,c,f,l,h,d,v,m,i,r,g,p,b,e=this,i=n.row,r=n.col,o=n.rowCount,a=n.colCount,u=0,s=[],c=0,f=[],l=0,h=i+o,d=r+a,v=i;v<h;v++)l=t.getRowHeight(v),c+=l,f.push(l);for(m=r;m<d;m++)l=t.getColumnWidth(m),u+=l,s.push(l);return l=0,i=f.map(function(t){var n=l/c,e;return l+=t,{start:n,size:t/c}}),l=0,r=s.map(function(t){var n=l/u,e;return l+=t,{start:n,size:t/u}}),g=e.ZF(t,n),{rowCount:o,colCount:a,rowSize:i,colSize:r,cellStyleList:p=e.iZ(t,n,g,i,r),sparklines:b=e.rZ(t,n),totalHeight:c,totalWidth:u}},f.prototype.oZ=function(t,n,e,i,r){for(var o,a,u,s,c,f,l,h,d,o=null,a=0,u=r;a<u.length;a++)if(c=(s=u[a]).rowOffset,f=s.colOffset,l=s.rowCount,h=s.colCount,(d=new pt.Range(c+e,f+i,l,h)).contains(t,n)){o=s;break}return o},f.prototype.aZ=function(t,n,e){for(var i,r,o,i,a,u,s,c,f,l,i=[0,0],r=i[0],o=i[1],i=t.rowOffset,a=t.colOffset,u,s,c=i+t.rowCount,f=a+t.colCount,l=i;l<c;l++)o+=n[l]?n[l].size:0;for(l=a;l<f;l++)r+=e[l]?e[l].size:0;return{width:r,height:o}},f.prototype.iZ=function(t,n,e,i,r){for(var o,a,u,s,c,f,l,h,d,v,o=n.row,a=n.col,u=n.rowCount,s=n.colCount,c=[],f=o;f<o+u;f++){for(l=[],h=a;h<a+s;h++)(d=this.oZ(f,h,o,a,e))&&d.rowOffset+o===f&&d.colOffset+a===h?(v=this.aZ(d,i,r),l.push({style:t.getActualStyle(f,h,3,!0),spanWidth:v.width,spanHeight:v.height,isSpan:!0,span:d})):l.push(d?{style:t.getActualStyle(f,h,3,!0),isSpan:!0}:{style:t.getActualStyle(f,h,3,!0)});c.push(l)}return c},f.prototype.ZF=function(t,n){for(var t,e,i,r,o,a,u,s,c,t=t.Ut.getSpans(),e=[],i=n.row,r=n.col,o=n.rowCount,a=n.colCount,u=0,s=t;u<s.length;u++)(c=s[u]).intersect(i,r,o,a)&&e.push({rowOffset:c.row-i,colOffset:c.col-r,rowCount:c.rowCount,colCount:c.colCount});return e},f.prototype.rZ=function(t,n){for(var e,i,r,o,a,u,s,c,f,e=n.row,i=n.col,r=n.colCount,o=n.rowCount,a=[],u=e;u<e+o;u++){for(s=[],c=i;c<i+r;c++)f=t.getSparkline(u,c),s.push(f?f.clone():null);a.push(s)}return a},f.prototype.toJSON=function(){var t,n,e,i,r,o,a,u,t,s,c,f,l,t=this.eZ(),n=t.rowCount,e=t.colCount,i=t.rowSize,r=t.colSize,o=t.cellStyleList,a=t.sparklines,u=t.totalWidth,t=t.totalHeight,s,c,f,l;return{rowCount:n,colCount:e,rowSize:h(i),colSize:h(r),cellStyleList:o.map(function(t){return t.map(function(t){var n,e,i,r,t;return t?(n=t.style,e=t.spanWidth,i=t.spanHeight,r=t.isSpan,t=t.span,{style:n.toJSON(),spanWidth:e,spanHeight:i,isSpan:r,span:t}):null})}),sparklines:a.map(function(t){return t.map(function(t){if(t)return{sparklineType:t.sparklineType(),sp:t.toJSON(),setting:t.setting().toJSON()}})}),totalWidth:u,totalHeight:t}},f.prototype.fromJSON=function(t){var n,e,i,r,o,a,u,t,i,r,o,a;t&&(n=t.rowCount,e=t.colCount,i=t.rowSize,r=t.colSize,o=t.cellStyleList,a=t.sparklines,u=t.totalWidth,t=t.totalHeight,i=h(i),r=h(r),o=o.map(function(t){return t.map(function(t){var n,e,i,r,t,o;return t?(n=t.style,e=t.spanWidth,i=t.spanHeight,r=t.isSpan,t=t.span,o=null,n&&(o=new pt.Style).fromJSON(n),{style:o,spanWidth:e,spanHeight:i,span:t,isSpan:r}):null})}),a=a.map(function(t){return t.map(function(t){var n,e;if(t)return n=new s.Sparkline,e=new s.SparklineSetting(t.setting),n.fromJSON(t.sp),n.setting(e),n.sparklineType(t.sparklineType),n})}),this.tZ={rowCount:n,colCount:e,rowSize:i,colSize:r,cellStyleList:o,sparklines:a,totalWidth:u,totalHeight:t})},f.prototype.L0=function(){this.tZ=null},a=f,n.$Y=a,l.prototype.yN=function(t,n,e){var i=this;return i.Z5=n,i.VY=new pt.Worksheet,i.uZ=t.parent&&t.parent.options.allowDynamicArray,i.VY.getCalcService&&(i.VY.getCalcService().allowDynamicArray=i.uZ,i.sZ=i.cZ(t)),i.fZ(t,e),i},l.prototype.cZ=function(t){for(var n,e,i,r,o,a,u,s,c,f,l,h,d,v,l,n=this.Z5,e=n.row,i=n.col,r=n.colCount,o=n.rowCount,a=[],u=t.b3&&t.b3(),s=e;s<e+o;s++)for(c=i;c<i+r;c++)(f=t.getFormula(s,c))&&(l=u&&u.sT(s,c))&&l.isDynamicArray&&(h=l.row,d=l.col,v=l.rowCount,l=l.colCount,1<v&&a.push({row:h+1,col:d,rowCount:v-1,colCount:l}),1<l)&&a.push({row:h,col:d+1,rowCount:1,colCount:l-1});return a},l.prototype.lZ=function(){for(var t,n,e,i,r,o,a,u,s,o,t,n=this.sZ,e=this.VY,i=0,r=n;i<r.length;i++)a=(o=r[i]).row,u=o.col,s=o.rowCount,o=o.colCount,e.clear(a,u,s,o,3,1)},l.prototype.HY=function(t){var n,t,n=this.VY;n.suspendEvent(),t=new r.CellBindingSource(t),this.lZ(),n.setDataSource(t),n.resumeEvent()},l.prototype.fZ=function(t,n){var e,i,t,e,i=this.VY,t=t.toJSON({includeBindingSource:!0,ignoreFormula:!!n});delete t.charts,delete t.shapes,i.suspendCalcService(),i.fromJSON(JSON.parse(JSON.stringify(t))),i.resumeCalcService(),this.hZ()},l.prototype.hZ=function(){for(var t,n,e,i,r,o,a,u,s,c,f,t=this,n=t.Z5,e=n.row,i=n.col,r=n.colCount,o=n.rowCount,a=[],u=[],s=[],c=e;c<e+o;c++){for(s=[],f=i;f<i+r;f++)s.push(t.dZ(c,f,3));u.push(s)}this.vZ=u},l.prototype.zY=function(){var t=this.Z5,n,e;return{baseRow:t.row,baseCol:t.col}},l.prototype.YY=function(t){for(var n,e,i,r,o,a,u,s,c,f,l,h,d,v,m,g,n=this.VY,e=this.Z5,i=e.row,r=e.col,o=e.colCount,a=e.rowCount,u=[],s=i;s<i+a;s++){for(c=[],l=f=void 0,h=r;h<r+o;h++)d=n.getText(s,h),v=n.getValue(s,h,3,1),m=n.Jt.$t(s,h,3,1),g=n.getBindingPath(s,h),f=this.mZ(s,h,3),l=this.gZ(n,s,h,v,t),c.push({value:m,formatStyle:f,text:d,validStyle:l,bindingPath:g});u.push(c)}return u},l.prototype.dZ=function(t,n,e){var i,t,i;return this.VY.b8&&(t=this.VY.getDataValidator(t,n,e))?t.highlightStyle():null},l.prototype.gZ=function(t,n,e,i,r){var r,t,i;return r&&t.isValid&&!t.isValid(n,e,i)?(t=(r=this.Z5).row,i=r.col,this.vZ[n-t][e-i]):null},l.prototype.mZ=function(t,n,e){var i=this.VY.conditionalFormats;return i?i.bL(new pt.Style,t,n,e):null},l.prototype.getCellValueInfo=function(t){for(var n,e,i,r,o,a,u,s,c,f,n=this.Z5,e=n.row,i=n.col,r=n.colCount,o=n.rowCount,a=[],u=t.Ut,s=e;s<e+o;s++){for(c=[],f=i;f<i+r;f++)c.push({bindPath:t.getBindingPath(s,f),formula:t.getFormula(s,f),value:u.getValue(s,f,3,Mt,1)});a.push(c)}return a},l.prototype.setValueToDataStruct=function(t,n,e,i){i[t]||(i[t]={}),i[t][n]=e},l.prototype.toJSON=function(){var t,n,e,i,r,o,a,u,t=this.VY,n=this.uZ,e=this.sZ.map(function(t){var n,e,i,r;return{row:t.row,col:t.col,rowCount:t.rowCount,colCount:t.colCount}}),i=this.Z5,r,o,a,u;return{spillRanges:e,allowDynamicArray:n,range:{row:i.row,col:i.col,rowCount:i.rowCount,colCount:i.colCount},templatejson:JSON.stringify(t.toJSON({includeBindingSource:!0}))}},l.prototype.fromJSON=function(t){var n,e,t,i,r,o,t;t&&((e=(n=this).VY=new pt.Worksheet).suspendCalcService&&e.suspendCalcService(),n.sZ=t.spillRanges,n.uZ=t.allowDynamicArray,e.getCalcService&&(e.getCalcService().allowDynamicArray=n.uZ),e.fromJSON(JSON.parse(t.templatejson)),n.lZ(),i=(t=t.range).row,r=t.col,o=t.rowCount,t=t.colCount,n.Z5=new pt.Range(i,r,o,t),this.hZ(),e.resumeCalcService)&&e.resumeCalcService()},l.prototype.L0=function(){this.VY.L0(),this.VY=null,this.Z5=null},u=l,n.qY=u,i(d,c=e),d.prototype.getAutoFitWidth=function(){return this.GY.tZ.totalWidth},d.prototype.getAutoFitHeight=function(){return this.GY.tZ.totalHeight},d.prototype.updateTemplate=function(t,n){t&&n&&(this.GY.yN(t,n),this.UY.yN(t,n))},d.prototype.paintContent=function(t,n,e,i,r,o,a,u){var s,c,c,s=this.UY,c=this.GY;s&&c&&(c=this.GY.eZ(),a.cellPadding&&(u.needTopGridline=!0,u.needLeftGridline=!0),v(t,{x:e,y:i,width:r,height:o},n,u,s,c))},d.prototype.toJSON=function(){return{typeName:this.typeName,layout:this.GY.toJSON(),resolver:this.UY.toJSON()}},d.prototype.fromJSON=function(t){t.layout&&(this.GY=new a,this.GY.fromJSON(t.layout)),t.resolver&&(this.UY=new u,this.UY.fromJSON(t.resolver))},n.RangeTemplate=i=d,pt.CellTypes.ti[16]=i,n.paintRangeTemplate=v},"./dist/plugins/comment/comment-actions.js":function(B,t,n){"use strict";var e,i,a,u,r,s,o,n,c,f,l,h,d,v,m,g,p,b,y,w,M,C,S,T,A,I,x,N,k;function D(t,n,e){var i,r,o,i=!1,r=t.Ut.pI.pZ();return!!r&&(o=r.location(),t.Qy().execute({cmd:d,sheetName:t.name(),row:r.bZ,col:r.yZ,oldValue:o.clone(),newValue:new a.Point(o.x+n,o.y+e),propertyName:"location"}))}function _(t){var n=t.comment;n&&(o(t.row)||o(t.col))&&(t.row=n.bZ,t.col=n.yZ)}function E(t,n){var e=x.call(this)||this;return _(n),e.Mf=t,e.tT=n,e}function j(t,n){var e=N.call(this)||this;return _(n),e.Mf=t,e.tT=n,e}function O(t,n){var e,i,r;if((n?t.canUndo():t.canExecute())&&(e=t.wZ)){for(i=0;i<e.length;i++)(r=e[i])&&(n?r.undo():r.execute());return!0}return!1}function R(t,n){var e,i,r,o,e=k.call(this)||this,i=e;if(i.wZ=[],i.Mf=t,r=(i.tT=n).commands)for(o=0;o<r.length;o++)i.add(r[o]);return e}e=this&&this.__extends||(I=function(t,n){return(I=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(t,n){t.__proto__=n}:function(t,n){for(var e in n)Object.prototype.hasOwnProperty.call(n,e)&&(t[e]=n[e])}))(t,n)},function(t,n){if("function"!=typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function e(){this.constructor=t}I(t,n),t.prototype=null===n?Object.create(n):(e.prototype=n.prototype,new e)}),Object.defineProperty(t,"__esModule",{value:!0}),t.CommentPropertyUndoAction=t.CommentDeleteUndoAction=void 0,i=n("Common"),a=n("Core"),u=n("Core"),r=a.GC$,s=a.Events,o=i.Common.lt.ht,n=u.Commands.ActionBase,c="deleteComment",f="deleteCommentByKey",l="deleteCommentByBackspaceKey",h="deactivateComment",d="moveComment",v="moveCommentUp",m="moveCommentDown",g="moveCommentLeft",p="moveCommentRight",b="changeComment",y="changeCommentTransaction",w=null,M=u.Commands.zA,e(E,x=n),E.prototype.execute=function(){var t,n,e,i,r,o,o,t=this;return!!t.canExecute()&&(n=t.Mf,t.X5(n,!0),e=n.comments.get(t.tT.row,t.tT.col),r=(i=n.Ut).pI,o={sheet:n,sheetName:n.name(),comment:e,cancel:!1},n.ki(s.CommentRemoving,o),o.cancel||(i.startTransaction(),r.remove(e.bZ,e.yZ),r.MZ=w,n.cR(),n.ki(s.CommentRemoved,{sheet:n,sheetName:n.name(),comment:e}),o=u.Commands.TI(n.name()),t.tT[o]=i.endTransaction()),t.q5(n,!0),!0)},E.prototype.undo=function(){var t,n,e,t=this,n=t.Mf;return t.X5(n,!0),e=u.Commands.TI(n.name()),n.Ut.undo(t.tT[e]),n.e4(),t.q5(n,!0),!0},t.CommentDeleteUndoAction=C=E,e(j,N=n),j.prototype.execute=function(){var t,n,e,i,r,t=this,n=t.tT,e=t.Mf,i=e.comments.get(n.row,n.col);return!(!t.canExecute()||!i||(t.X5(e,!0),i[r=n.propertyName](n.newValue),"location"===r&&(n.displayMode?i.displayMode(n.displayMode):n.displayMode=i.displayMode()),t.q5(e,!0),0))},j.prototype.undo=function(){var t,n,e,i,t=this,n=t.tT,e=t.Mf;return t.X5(e,!0),!!(i=e.comments.get(n.row,n.col))&&(i[n.propertyName](n.oldValue),t.q5(e,!0),!0)},j.prototype.toJSON=function(){return this.tT},t.CommentPropertyUndoAction=S=j,u.Commands.ChangeComment=S,e(R,k=n),R.prototype.execute=function(){return O(this,!1)},R.prototype.undo=function(){return O(this,!0)},R.prototype.add=function(t){this.wZ.push(t)},T=R,u.Commands[f]={canUndo:!1,execute:function(t,n){var t,n,t=u.Commands.Tp(t,n),n=t.Ut.pI.pZ();return!!n&&t.Qy().execute({cmd:c,sheetName:t.name(),row:n.bZ,col:n.yZ})}},u.Commands[h]={canUndo:!1,execute:function(t,n){var t,n,t=u.Commands.Tp(t,n),n=t.Ut.pI;return!!n.pZ()&&(n.CZ(),t.cR(),t.repaint(),!0)}},u.Commands[v]={canUndo:!1,execute:function(t,n){var e;return D(u.Commands.Tp(t,n),0,-1)}},u.Commands[m]={canUndo:!1,execute:function(t,n){var e;return D(u.Commands.Tp(t,n),0,1)}},u.Commands[g]={canUndo:!1,execute:function(t,n){var e;return D(u.Commands.Tp(t,n),-1,0)}},u.Commands[p]={canUndo:!1,execute:function(t,n){var e;return D(u.Commands.Tp(t,n),1,0)}},u.Commands[c]={canUndo:!0,execute:function(t,n,e){return M(t,C,n,e)}},u.Commands[d]={canUndo:!0,execute:function(t,n,e){return M(t,S,n,e)}},u.Commands[b]={canUndo:!0,execute:function(t,n,e){return M(t,S,n,e)}},u.Commands[y]={canUndo:!0,execute:function(t,n,e){return M(t,T,n,e)}},u.Commands.SZ=A=function(t){t.register(f,u.Commands[f],46,!1,!1,!1,!1),t.register(l,u.Commands[f],8,!1,!1,!1,!1),t.register(h,u.Commands[h],27,!1,!1,!1,!1),t.register(v,u.Commands[v],38,!1,!1,!1,!1),t.register(m,u.Commands[m],40,!1,!1,!1,!1),t.register(g,u.Commands[g],37,!1,!1,!1,!1),t.register(p,u.Commands[p],39,!1,!1,!1,!1),t.register(c,u.Commands[c]),t.register(b,u.Commands[b]),t.register(y,u.Commands[y]),t.register(d,u.Commands[d])}},"./dist/plugins/comment/comment-touch.js":function(t,n,e){"use strict";var i,n,r,a,o,u,s,e,c,f,l,h,d,v,m;function g(t,n){return d.call(this,t,n)||this}function p(t,n,e){return v.call(this,t,n,e,new l(t,n))||this}function b(t,n,e){return m.call(this,t,n,e,new s(t,n))||this}function y(t,n,e,i){var r,o,n,r=this,o=r.TZ=n.TZ;r.AZ=new a.IZ(r),r.xZ=new a.NZ(t,"Comment"+o.bZ+o.yZ,r.AZ,2,200),r.kZ=e,r.DZ=i,(n=r.xZ)._Z=function(){return 3!==o.commentState()},n.EZ=function(){return!0},n.jZ=function(t){return i.OZ(t)},n.RZ=function(t){return i.BZ(t)},n.LZ=function(t){return i.FZ(t)},n.PZ=function(t){return i.GZ(t)},n.UZ=function(t){return i.HZ(t)}}function w(t,n){var e=this;e.zZ=t,e.VZ=n,e.TZ=n.TZ,e.Mf=e.TZ.Mf,e.YZ=new a.ZZ(e.Mf)}i=this&&this.__extends||(h=function(t,n){return(h=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(t,n){t.__proto__=n}:function(t,n){for(var e in n)Object.prototype.hasOwnProperty.call(n,e)&&(t[e]=n[e])}))(t,n)},function(t,n){if("function"!=typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function e(){this.constructor=t}h(t,n),t.prototype=null===n?Object.create(n):(e.prototype=n.prototype,new e)}),Object.defineProperty(n,"__esModule",{value:!0}),n=e("Core"),r=e("./dist/plugins/comment/comment.js"),a=e("Touch"),n.Of.touch&&(o=n.GC$,u=n.mt.vi,w.prototype.WZ=function(t){var t,n,e,t=new a.QZ(t.X,t.Y),n=o(this.zZ).offset();return n&&(e=document.body,t.X+=n.left+e.clientLeft||0,t.Y+=n.top+e.clientTop||0),t},w.prototype.OZ=function(t){t.KZ=35},w.prototype.BZ=function(t){var n,e,n=this,e=n.WZ(t.JZ);n.VZ.XZ({target:t.qZ,isTouch:!0,button:0,pageX:e.X,pageY:e.Y,stopPropagation:function(){}}),n.YZ.$Z()},w.prototype.FZ=function(t){var n,e,i,r,r,i,n=this,e=t.nW.tW,i=n.Mf,r=i.parent;1!==e&&r&&r.options.allowUserZoom?(i.rt.s9=!1,r=n.VZ,o(r.eW).remove(),n.YZ.iW(e)):(i=n.WZ(t.JZ),n.VZ.pg({target:t.qZ,isTouch:!0,button:0,pageX:i.X,pageY:i.Y,stopPropagation:function(){}}))},w.prototype.GZ=function(t){var n,e,i,r,r,n=this,e=t.nW.tW,i,r=n.Mf.parent;1!==e&&r&&r.options.allowUserZoom?n.YZ.rW(e):(r=n.WZ(t.JZ),n.VZ.bg({target:t.qZ,isTouch:!0,button:0,pageX:r.X,pageY:r.Y,stopPropagation:function(){}}))},w.prototype.HZ=function(t){var n=this,e=n.TZ,n=n.Mf;try{n.suspendPaint(),3===e.commentState()?e.commentState(1):1===e.commentState()&&e.commentState(2)}finally{n.resumePaint()}},s=w,y.prototype.oW=function(){var t=this,n=t.kZ;n&&n.aW(t.xZ,!0)},y.prototype.uW=function(){var t=this,n=t.kZ;n&&n.aW(t.xZ,!1)},y.prototype.sW=function(t){return this.AZ.sW()},y.prototype.cW=function(t){return this.AZ.cW()},y.prototype.fW=function(t){return this.AZ.fW()},i(b,m=e=y),c=b,i(p,v=e),f=p,i(g,d=s),g.prototype.BZ=function(t){var n,e,n=this,e=n.WZ(t.JZ);n.VZ.lW({target:t.qZ,isTouch:!0,button:0,pageX:e.X,pageY:e.Y,stopPropagation:function(){}}),n.YZ.$Z()},l=g,r.hW.ch("touch",{init:function(t){var n,e,i,n=this,e,i=n.TZ.Mf.parent.kZ;n.dW=new c(t[0],n,i),n.dW.oW(),n.vW=new f(t[1],n,i),n.vW.oW()},detachEditor:function(t){var n=this,e=n.TZ.Mf;n.vW=new f(t,n,e.parent.kZ),n.vW.oW()},preProcessMouseDownEdit:function(t){var n,e,n=t.e,e=this.vW;e&&!n.isTouch&&e.sW(n)&&(u(n),t.r=!0)},preProcessMouseDownDragResize:function(t){var n,e,n=t.e,e=this.dW;e&&!n.isTouch&&e.sW(n)&&(u(n),t.r=!0)},preProcessMouseMove:function(t){var n,e,i,r,n=t.e,e=n.isTouch,i=this.dW,r=this.vW;i&&!e&&i.fW(n)&&(u(n),t.r=!0),r&&!e&&r.fW(n)&&(u(n),t.r=!0)},preProcessMouseUp:function(t){var n,e,i,r,n=t.e,e=n.isTouch,i=this.dW,r=this.vW;i&&!e&&i.cW(n)&&(u(n),t.r=!0),r&&!e&&r.cW(n)&&(u(n),t.r=!0)},dispose:function(){var t=this;t.dW.uW(),t.dW=null,t.vW.uW(),t.vW=null}}))},"./dist/plugins/comment/comment.entry.js":function(t,n,e){"use strict";var i,r,i=this&&this.__createBinding||(Object.create?function(t,n,e,i){void 0===i&&(i=e);var r=Object.getOwnPropertyDescriptor(n,e);r&&("get"in r?n.__esModule:!r.writable&&!r.configurable)||(r={enumerable:!0,get:function(){return n[e]}}),Object.defineProperty(t,i,r)}:function(t,n,e,i){t[i=void 0===i?e:i]=n[e]}),r=this&&this.__exportStar||function(t,n){for(var e in t)"default"===e||Object.prototype.hasOwnProperty.call(n,e)||i(n,t,e)};Object.defineProperty(n,"__esModule",{value:!0}),r(e("./dist/plugins/comment/comment.js"),n),r(e("./dist/plugins/comment/comment-actions.js"),n),e("./dist/plugins/comment/comment-touch.js")},"./dist/plugins/comment/comment.js":function(i,t,L){"use strict";var F,s,A,P,h,d,G,I,x,U,T,H,L,r,z,V,Y,g,Z,c,W,N,Q,J,K,X,q,$,tt,l,nt,et,S,it,rt,ot,at,ut,st,ct,ft,lt,ht,dt,vt,mt,gt,pt,bt,yt,wt,Mt,Ct,p,b,St,Tt,v,m,o,a,u,At,It,xt,Nt,kt,Dt,_t,f,y,Et,jt,Ot,w,M,C,k,Rt,Bt,Lt,Ft,Pt,Gt,Ut,Ht,zt,Vt,Yt,Zt,Wt,Qt,Jt,Kt,Xt,qt,D,$t,tn,nn,en,rn,on,an,un,sn,cn,fn,ln,hn,dn,_,vn,mn,gn,pn,bn,yn,wn,Mn,Cn,Sn,Tn,n,An,In,n,n,n;function E(t,n){return new A.Point(t,n)}function j(t,n,e,i){return new A.Rect(t,n,e,i)}function O(t){return t.height}function R(t){return t.width}function xn(t,n){var t=t.options;return!t.isProtected||t.protectionOptions.allowEditObjects||n&&!n.locked()}function Nn(t,n){var t=t.options;return!t.isProtected||t.protectionOptions.allowEditObjects||n&&!n.lockText()}function kn(t){var n=96,e=72,i=37.7952755905512;try{return-1!==t.indexOf("pt")?parseFloat(t.replace("pt","")):-1!==t.indexOf("in")?72*parseFloat(t.replace("in","")):-1!==t.indexOf("cm")?parseFloat(t.replace("cm",""))*i*72/96:parseFloat(t)}catch(t){return 0}}function Dn(t){var n,e,i,r,o,a,u,s,c,f,l,n=t.itemsData,e=t.collapseIndexMap={},i=n.length,c=!1;if(0===t.direction){for(r=i-1;0<=r;r--)if((o=n[r])&&1===o.count&&o.info&&o.info.collapsed){for(a=o.index+o.count,u=r+1;u<i;u++)(s=n[u])&&s.info&&s.info.level>o.info.level&&s.index===a&&(a=s.index+s.count);for(f=o.index+1;f<a;f++)e[f]=!0}}else for(r=0;r<i;r++)if((o=n[r])&&1===o.count&&o.info&&o.info.collapsed){if((a=o.index-1)<0&&-1===o.info.level)break;for(l=r-1;0<=l;l--)(s=n[l])&&s.info&&s.info.level>o.info.level&&s.index+s.count-1===a&&(a=s.index-1);for(f=a+1;f<o.index;f++)e[f]=!0}}function _n(t,n){var e;return n&&(n.items?n.items[t]&&n.items[t].viewCollapsed:n.itemsData&&(n.collapseIndexMap||Dn(n),n.collapseIndexMap[t]))}function En(t,n,e,i){var t=t[n];return!t||i&&_n(n,i)?void 0:!1===t.visible||t.size}function jn(t,n,e,i){var t=t[n];return!t||i&&_n(n,i)?void 0:!1===t.visible||t.size}function On(t,e,i){function n(t){var t,n,t,t=S(t,"ClientData");return(!t||"Note"===t.ObjectType)&&(n=parseInt(S(t,"Row").c_[0],10),t=parseInt(S(t,"Column").c_[0],10),n===e)&&t===i}return t.filter(n)[0]}function Rn(t,n){for(var e,i,r,o,a,u,e=t.defaults.rowHeight,i=0,r=0,a=t.getRowCount()||A.XmlConstants.Io;i<n&&r<a;)i+=o=t.Ut.getSize(!0,3,r)||e,r++;return u=0<(u=i-n)?(r--,o-u):n-i,{row:r,rowOffset:u}}function Bn(t,n){for(var e,i,r,o,a,u,e=t.defaults.colWidth,i=0,r=0,a=t.getColumnCount()||A.XmlConstants.xo;i<n&&r<a;)i+=o=t.Ut.getSize(!1,3,r)||e,r++;return u=0<(u=i-n)?(r--,o-u):n-i,{col:r,colOffset:u}}function Ln(t,n){if(!et(n))return"double";if(t)switch(t.toLowerCase()){case"solid":return"solid";case"1 1":return"dotted";case"dash":case"dashdot":case"longdash":case"longdashdot":case"longdashdotdot":return"dashed"}return"solid"}function Fn(t){var n,e;if(t)switch(t.toLowerCase()){case"solid":n="solid";break;case"dotted":n="1 1";break;case"dashed":n="dash";break;case"double":e="thinThin"}return{dashStyle:n,lineStyle:e}}function Pn(t,n){var e,i,r,o,o,r,t,i,e=n.location()||{x:9,y:-18},i=n.bZ,r=n.yZ,o=t.getSpan(i,r);return o&&(r=o.col+o.colCount-1),o=$(t,0,r+1),r=nt(t,0,i),t=["position:absolute"],0<=(i=l(o+e.x+7))&&t.push("margin-left:"+i+"pt"),0<=(i=l(r+e.y+7))&&t.push("margin-top:"+i+"pt"),(i=l(n.width()-14)+"pt")&&t.push("width:"+i),(i=l(n.height()-14)+"pt")&&t.push("height:"+i),t.push("z-index:"+n.zIndex()),t.push("visibility:"+(1===n.displayMode()?"visible":"hidden")),t.join(";")}function Gn(t){var n=A.ColorHelper.convertColorToHex(t);return n&&"string"==typeof n&&2<n.length?"#"+n.substring(2).toLowerCase():t}function Un(t,n){var t=(t||"").trim().split(n);return{key:t[0],value:t[1]}}function Hn(t,n,e,i,r){var o,a,u,s,c,f,l,t,o,a=this.Ut.pI;if(t&&a)for(s=a.all(),c=0;c<s.length;c++)f=(u=s[c]).bZ,l=u.yZ,f===n&&l===e||n<=f&&f<n+i&&e<=l&&l<e+r&&a.remove(f,l);(u=a.get(n,e))&&(t=a.mW(u))&&t.gW()}function zn(){var t=this,n=t.pW&&t.pW();n&&n.bW(t)}function Vn(t,n,e){var i=this,i=i.pW&&i.pW();i&&i.yW(t,n,e)}function Yn(t,n){var e,i,n,e=-1,i=-1;n&&0<=n.rowViewportIndex&&0<=n.colViewportIndex&&(e=n.row,i=n.col),!t.parent||e<0||i<0||(n=t.Ut.pI.get(e,i),t.Ut.pI.wW(n))}function Zn(t,n){return t&&t.getRowHeight(n)}function Wn(t,n){return t&&t.getColumnWidth(n)}function Qn(t,n){return t&&t.getViewportLeftColumn(n)}function Jn(t,n){return t&&t.getViewportTopRow(n)}function Kn(t,n,e,i){var r=this;arguments.length<=1?r.top=r.right=r.bottom=r.left=t||0:(r.top=t,r.right=n,r.bottom=e,r.left=i)}function Xn(t){var n=this;n.bZ=-1,n.yZ=-1,n.text(t||""),n.zIndex(Ft)}function qn(t,n,e){return bn.push(t),s.mt.p0(t,n,$n(t),e)}function $n(t){var r=t;return function(t,n){var e=this,i=e.Mf;i&&(i.Ut.MW({type:"property",comment:e,name:r,value:n,newValue:t}),i.hP()&&i.My<=0&&(i.CW(),"indicatorColor"!==r&&"indicatorSize"!==r||i.repaint(i.getCellRect(e.bZ,e.yZ))),i.ki(c.CommentChanged,{sheet:i,sheetName:i.name(),comment:e,propertyName:r}))}}function te(t,n,e,i,r){var n=j(n,e,i,i);n.cursor=r,t.push(n)}function ne(t,n,e,i){(0,A.GC$)(t.SW).css(n,e),(0,A.GC$)(t.TW).css(n,i)}function ee(t,n){for(var e,i,r,e=t.length,i=0,r=0;r<e;r++)i+=J(t[r],n);return i}function ie(t,n){t&&t.P_(n)}function re(t){var t=t;if(t){if("number"==typeof t)return 400<t;if("string"==typeof t)return-1!==t.toLowerCase().indexOf("bold")||400<parseInt(t,10)}}function oe(t){var t=t;return t&&-1!==["italic","oblique"].indexOf(t.toLowerCase().trim())}function B(t,n){var e,i,i,e=this,i=t&&t.Mf;e.AW=1,e.IW=1,e.TZ=t,e.xW(),e._zoomFactor=i.zoom(),e.NW=n,e.li=n.kW,e.Hc(),i=e.DW(e._W(),t.width(),t.height()),e.EW=E(i.x,i.y),e.jW(),e.OW()}function e(t){var n=this;n.Mf=t,n.RW={BW:!1,x:0,y:0,LW:h,FW:-1},n.kW=h,n.PW=h,n.MZ=h,n.wB=[],n.GW=0,n.UW=[],n.HW(),n.zW(),n.cE={}}function ae(t){var n=this;n.Mf=h,n.VW=!0,n.YW=n.ZW(),t.appendChild(n.YW)}function ue(t,n){if(t){var t=t.trim().toLowerCase();if(-1!==["false"].indexOf(t))return!1;if(-1!==["true"].indexOf(t))return!0}return n}Object.defineProperty(t,"__esModule",{value:!0}),t.hW=t.Comment=t.Padding=t.DisplayMode=t.CommentState=void 0,F=L("Common"),s=L("Core"),A=L("Core"),P=s.Commands,h=null,d=void 0,G=Math.max,I=Math.min,x=Math.floor,U=Math.atan2,T=Math.abs,H="default",L=s.GC$.extend,r=s.mt.En,z=F.Common.Uf,V="comment",Y=s.hi,g=s.Bf,Z=s.mt,c=s.Events,W=Z.vi,N=Z.w0,Q=Z.M0,J=Z.bi,K=parseFloat,X=F.Common.zf,q=s.Lf,$=A.ExcelHelper.getActualColumnWidth,tt=A.ExcelHelper.pointToPixel,l=A.ExcelHelper.pixelToPoint,nt=A.ExcelHelper.getActualRowHeight,et=F.Common.lt.ht,S=A.mt.xr,it=A.mt.go,rt=A.mt.c1,ot=A.mt.n1,at=A.mt.vo,ut=A.mt.d1,st=A.mt.h1,ct=A.IndexHelper.nr,ft=A.Util.wr,lt=A.Util.ho,ht=7,dt=document,vt=window,mt=A.UsedRangeUtil.vh,gt=A.XFileConstants.Rr,pt=A.XFileConstants.Lr,bt=A.XFileConstants.ou,wt="mouse",Mt="move",Ct="DOMMouseScroll",p="left",b="top",St="right",Tt="bottom",v="width",m="height",o="position",a="absolute",u="overflow",At="visible",It="z-index",xt="hidden",Nt="box-sizing",kt="content-box",Dt="padding",_t="px",f="div",y=".comment",Et=".floatBlockCanvas",jt=".hostContainer",Ot=".lineCanvasContainer",w=".host",M=".editor",C="gc-spread-",k="className",Rt="cursor",Bt="text",Lt=701,Ft=898,Pt="gc-no-user-select",Gt=" ",Ut="unselectable",Ht="on",zt="comment_editor",Vt="comment_indicator",Yt="font-family",Zt="font-style",Wt="font-size",Qt="font-weight",Jt="color",Kt="textArea",Xt=".lineCanvas",qt=".commentDocument",D="-resize",$t="line-height",tn="background-color",nn="text-align",en="mousedown",rn="mousemove",on="mouseup",an="mousewheel",un="text-decoration",sn="black",(n=cn=cn||{})[n.none=0]="none",n[n.single=1]="single",n[n.double=2]="double",n[n.singleaccounting=3]="singleaccounting",n[n.doubleaccounting=4]="doubleaccounting",s.GC$.extend(A.Worksheet.prototype,{CW:function(t){var n,e,i,r,o,a,u,n=this,e=n.pW&&n.pW();if(n.hP()&&!n.D_)for(i=n.Fi(),r=void 0,o=0;o<=2;o++)for(a=0;a<=2;a++)!(r=i.c9(o,a))||0===R(r)||0===O(r)||t&&!r.intersectRect(t)||(u=n.Ut.pI,e&&u&&e.WW(u))}}),(fn=s.CellRange).prototype.comment=function(t){var n=this,e=n.sheet,i=n.row,r=n.col;return 0===arguments.length?e.Ut.pI.get(i,r):(t instanceof gn&&e.Ut.pI.WB(i,r,t),n)},ln=function(t,n){var e,n;!t.Ut.pI.Oy()&&(e=t.uw(),n=t.hitTest(n.pageX-e.left,n.pageY-e.top))&&Yn(t,n)},hn=function(t,e){e.bind(c.FloatingElementSelected+y,function(t,n){var n;"comments"!==n.type&&((n=e.Ut.pI).CZ(),n.wW(h))}),t.bind(en+y,function(t){e.Ut.pI.CZ(),ln(e,t)}).bind(an+y,function(t){ln(e,t)}).bind(rn+y,function(t){ln(e,t)})},dn=function(t,n){n.unbind(y),t.unbind(y)},c.CommentChanged="CommentChanged",(n=_=t.CommentState||(t.CommentState={}))[n.active=1]="active",n[n.edit=2]="edit",n[n.normal=3]="normal",(n=vn=t.DisplayMode||(t.DisplayMode={}))[n.alwaysShown=1]="alwaysShown",n[n.hoverShown=2]="hoverShown",Kn.prototype.clone=function(){var t=this;return new Kn(t.top,t.right,t.bottom,t.left)},Kn.prototype.toString=function(){var n=this,e="",t;return[b,St,Tt,p].forEach(function(t){e+=n[t]+_t+Gt}),e.trim()},mn=Kn,t.Padding=mn,Xn.prototype.clone=function(){var e,i,e=this,i=new Xn;return bn.forEach(function(t){var n=e[t]();e[t].isDefault&&e[t].isDefault(n)||i[t](n&&n.clone?n.clone():n)}),i.Mf=e.Mf,i.bZ=e.bZ,i.yZ=e.yZ,i},Xn.prototype.toJSON=function(){var e,i,e=this,i={rowIndex:e.bZ,colIndex:e.yZ};return bn.forEach(function(t){var n=e[t]();e[t].isDefault&&e[t].isDefault(n)||(i[t]=n&&n.clone?n.clone():n)}),i},Xn.prototype.wh=function(t){var n,e,i,r,o,o,o,a,u,s,u,o,t,e,r,i,a,u,s,c,f,n=this,e=n.Mf,i={n_:"fill",color2:"#ffffe1"},r={n_:"stroke"},o=Fn(n.borderStyle());return o.dashStyle?r.dashStyle=o.dashStyle:o.lineStyle&&(r.lineStyle=o.lineStyle),o=n.opacity(),et(o)||1===o||(i.opacity=Math.floor(65535*o)+"f"),o=["Left","Center","Right"][n.horizontalAlign()||0]||"Left",!(a={n_:"ClientData",ObjectType:"Note",c_:[{n_:"Row",c_:[n.bZ]},{n_:"Column",c_:[n.yZ]},{n_:"AutoFill",c_:["False"]}]})===n.dynamicMove()&&a.c_.push({n_:"MoveWithCells"}),!1===n.dynamicSize()&&a.c_.push({n_:"SizeWithCells"}),!1===n.locked()&&a.c_.push({n_:"Locked",c_:["False"]}),!1===n.lockText()&&a.c_.push({n_:"LockText",c_:["False"]}),"Left"!==o&&a.c_.push({n_:"TextHAlign",c_:[o]}),1===n.displayMode()&&a.c_.push({n_:"Visible"}),(u=n.padding())&&(s=[l(u.left)+"pt",l(u.top)+"pt",l(u.right)+"pt",l(u.bottom)+"pt"].join(",")),u={n_:"textbox",style:"mso-direction-alt:auto"+(n.autoSize()?";mso-fit-shape-to-text:t":""),c_:[{n_:"div",style:"text-align:"+o}]},o={n_:"shape",id:"_x0000_s"+t,type:"#_x0000_t202",style:Pn(e,n),fillcolor:Gn(n.backColor()),strokecolor:Gn(n.borderColor()),strokeweight:l(n.borderWidth()||1)+"pt",c_:[r,i,{n_:"shadow",color:"black",obscured:"t"},{n_:"path","o:connecttype":"none"},u,a]},s?u.inset=s:o["o:insetmode"]="auto",t=[],re(n.fontWeight())&&t.push({n_:"b"}),oe(n.fontStyle())&&t.push({n_:"i"}),1&(e=n.textDecoration())?t.push({n_:"u"}):8&e?t.push({n_:"u",val:"double"}):2&e&&t.push({n_:"strike"}),(r=-1!==(r=n.fontSize()||"9pt").indexOf("px")?l(parseFloat(r)):r.replace("pt",""))&&t.push({n_:"sz",val:r}),(i=n.foreColor())?(i=st(i),t.push(i)):t.push({n_:"color",indexed:"81"}),n.fontFamily()&&t.push({n_:"rFont",val:n.fontFamily()}),t.push({n_:"family",val:"2"}),a={n_:"t"},u=n.text(),(c=(s=et(u)?"":u).length!==s.trim().length)&&(a["xml:space"]="preserve"),a.c_=[at(s)],{vmlDrawingData:o,commentData:f={n_:"comment",ref:ct(n.yZ)+(n.bZ+1),authorId:"0",c_:[{n_:"text",c_:[{n_:"r",c_:[{n_:"rPr",c_:t},a]}]}]}}},Xn.prototype.fromJSON=function(e,t){var i;e&&(i=this,bn.forEach(function(t){var n=e[t];n!==d&&("location"===t?i.location(new A.Point(n.x,n.y),!1):"padding"===t?i.padding(new mn(n.top,n.right,n.bottom,n.left),!1):i[t](n,!1))}),e.rowIndex!==d&&(i.bZ=e.rowIndex),e.colIndex!==d)&&(i.yZ=e.colIndex)},Xn.prototype.yh=function(f,t,l,h,d){var v,m,g,n,t,p,b,y,w,M,C;t&&(m=$(f,0,(v=this).yZ+1),g=nt(f,0,v.bZ),t=(n=S(t,"text")).c_)&&(p=1===t.length,b=[],t.forEach(function(t){var n,e,i,i,r,r,o,r,o,a,i,r,u,n,o,s,c,t,i,r,o,n,e,o,n=S(t,"rPr");n&&p&&((e=(i=S(n,"rFont"))?i.val:e)&&v.fontFamily(e),i=0,(r=S(n,"u"))&&(o=1,i|=2===(o=(r=r.val)?cn[r]:o)?8:1),S(n,"strike")&&(i|=2),i&&v.textDecoration(i),S(n,"b")&&v.fontWeight("bold"),S(n,"i")&&v.fontStyle("italic"),(e=S(n,"color"))&&(r=ut(e),v.foreColor(r)),e=S(n,"sz").val)&&v.fontSize(e+"pt"),(o=S(t,"t"))?o.c_&&b.push(o.c_[0]):"t"===t.n_&&t.c_&&b.push(t.c_[0]),(e=l.fillcolor)&&v.backColor(e.split(" ")[0]),(e=l.strokecolor)&&v.borderColor(e.split(" ")[0]),(e=l.strokeweight)&&v.borderWidth(tt(parseFloat(e.replace("pt","")))),(e=l.style)&&(a=e.split(";")).forEach(function(t){var t=Un(t,":"),n=t.key,e=t.value;if(!et(e))switch(n){case"margin-left":y=kn(e);break;case"margin-top":w=kn(e);break;case"width":M=e;break;case"height":C=e;break;case"z-index":v.zIndex(parseInt(e,10))}}),(e=S(l,"fill"))&&(i=e.opacity)&&("f"===i.substr(-1)?v.opacity(parseFloat(i.substr(0,i.length-1))/65535):v.opacity(parseFloat(i))),(e=S(l,"stroke"))&&v.borderStyle(Ln(e.dashStyle,e.lineStyle)),(e=S(l,"textbox"))&&((r=e.style)&&-1!==r.indexOf("mso-fit-shape-to-text:t")&&v.autoSize(!0),u=[0,0,0,0],e.inset&&e.inset.trim().split(",").forEach(function(t,n){var t=t||["0.1in","0.05in"][n%2];u[n]=tt(parseFloat(t.replace("pt","")))}),v.padding(new mn(u[1],u[2],u[3],u[0]))),n=S(l,"ClientData"),S(n,"SizeWithCells")&&v.dynamicSize(!1),S(n,"MoveWithCells")&&v.dynamicMove(!1),(e=S(n,"Locked"))&&v.locked(ue(e.c_[0],!0)),(e=S(n,"LockText"))&&v.lockText(ue(e.c_[0],!0)),(e=rt(S(n,"TextHAlign")))&&-1!==(o=["left","center","right"].indexOf(e.toLowerCase()))&&v.horizontalAlign(o),S(n,"Visible")&&v.displayMode(1),(e=rt(S(n,"Anchor")))?(t=e.split(",").map(function(t){return parseInt(t,10)}),i=$(f,0,t[0])+t[1]-7,r=nt(f,0,t[2])+t[3]-7,o=$(f,0,t[4])+t[5]+7,n=nt(f,0,t[6])+t[7]+7,v.location(new A.Point(i-m,r-g),!1),v.width(o-i),v.height(n-r),t&&(s=t[6]+1,c=t[4]+1)):(e=tt(y)-m-7,o=tt(w)-g-7,v.location(new A.Point(e,o)),v.width(tt(parseFloat(M.replace("pt","")))+14),v.height(tt(parseFloat(C.replace("pt","")))+14),s=Rn(f,v.location().y+g+v.height()).row+2,c=Bn(f,v.location().x+m+v.width()).col+2),A.Util.Co(h)&&A.Util.So(f,s,c,d)}),v.text(ot(b.join(""))))},gn=Xn,t.Comment=gn,pn={},bn=[],(yn=[[Bt,""],["location",E(9,-18)],[v,160,function(t){return 0<t}],[m,100,function(t){return 0<t}],["fontFamily","Arial"],["fontStyle","normal"],["fontSize","9pt",function(t){return/^\d+pt$/.test(t)&&0<parseInt(t,10)}],["fontWeight","normal"],["textDecoration",0],["foreColor","black"],["locked",!0],["lockText",!0],["horizontalAlign",0],["autoSize",!1],["dynamicSize",!0,function(t){return"boolean"==typeof t&&this.dynamicMove()}],["dynamicMove",!0,function(t){return t||this.dynamicSize(!1),!0}],["backColor","#FFFFE1"],["opacity",1,function(t){return 0<=t&&t<=1}],["borderWidth",1,function(t){return 1<=t}],["borderStyle","solid"],["borderColor","black"],["padding"],["showShadow",!1],["displayMode",2],["commentState",3],["zIndex",-1],["ignoreDefaultLocation",!1],["indicatorColor","red",function(t){return"string"==typeof t}],["indicatorSize",6,function(t){return"number"==typeof t&&1<t}]]).forEach(function(t){pn[t[0]]=qn(t[0],t[1],t[2])}),wn=pn.zIndex,pn.zIndex=function(){var t,n,e,t=wn.apply(this,arguments);return 0===arguments.length&&t===Ft&&(n=this.Mf.comments.GW,e=this.lp,t=Ft-(n-1-e)),t},Mn=pn.commentState,pn.commentState=function(t,n){var e,i,e=Mn.apply(this,arguments);return n&&(i=this.Mf).Rj("comment",null,null,A.SheetArea.viewport,this,this),e},L(gn.prototype,pn),B.prototype.Hc=function(){var t=this,n=t.TZ.Mf;t.QW=C+"floatBlockCanvas",t.KW=C+"host-container",t.JW=C+"host",t.XW=C+"lineCanvas",t.qW=r(f),(0,A.GC$)(t.qW).addClass(C+"floatBlockCanvas-container").css([o,u,Nt],[a,xt,kt]),t.SW=r("canvas"),g.Wl(t.SW,null,n),(0,A.GC$)(t.SW).addClass(t.QW).css([p,b,o],[0,0,a]),t.TW=r(f),(0,A.GC$)(t.TW).addClass(t.KW).css([o,Nt,u],[a,kt,xt]),t.Ti=r(f),(0,A.GC$)(t.Ti).addClass(t.JW+Gt+Pt).css([p,b,v,m,o,"word-wrap","word-break","white-space",u,Nt,Ut,$t],[0,0,"100%","100%",a,"break-word","normal","pre-wrap",xt,kt,Ht,"normal"]),(0,A.GC$)(t.TW).append(t.Ti),(0,A.GC$)(t.qW).append(t.SW).append(t.TW),t.$W=r(f),(0,A.GC$)(t.$W).addClass(C+"lineCanvas-container").css([o,u,"pointer-events"],[a,xt,"none"]),t.tQ=r("canvas"),g.Wl(t.tQ,h,n),(0,A.GC$)(t.tQ).addClass(t.XW).css([p,St,o],[0,0,a]),(0,A.GC$)(t.$W).append(t.tQ),t.nQ=[],t.eQ=7,t.iQ=!1,t.Eb=!1,B.et(t,"init",[t.SW,t.Ti])},B.prototype.rQ=function(){var t=this,n=t.TZ.Mf;!t.YW&&n&&n.pW&&(t.YW=n.pW().YW),t.YW&&(t.YW.appendChild(t.$W),t.oQ(),t.YW.appendChild(t.qW),t.aQ(t.SW,Et),t.aQ(t.TW,jt),t.uQ()?t.sQ():t.cQ(),t.EW=t._W(),t.fQ())},B.prototype.lQ=function(){var t=this;t.qW&&t.$W&&t.YW&&(t.hQ(t.SW,Et),t.hQ(t.TW,jt),t.dQ(),t.vQ(),t.mQ(),(0,A.GC$)(t.qW).remove(),(0,A.GC$)(t.$W).remove())},B.prototype.gQ=function(){return this.TZ.width()*this._zoomFactor},B.prototype.pQ=function(){return this.TZ.height()*this._zoomFactor},B.prototype._W=function(){var t=this,n=t.TZ;return n!==t.NW.PW||n.commentState()!==_.normal||n.ignoreDefaultLocation()?t.bQ(n.location()):(n.yQ=t.bQ(E(9,-18)),n.yQ)},B.prototype.bQ=function(t){var n,e,i,r,o,e,n,n=this,e=n.TZ,i=e&&e.Mf,r=n._zoomFactor,o=E(0,0);return i&&(e=n.wQ(i,e.bZ,e.yZ,n.AW,n.IW)).x!==h&&void 0!==e.x&&e.y!==h&&void 0!==e.y&&R(e)&&O(e)&&(n=i.Fi(),o.x=e.x+R(e)+t.x*r-n.XC,o.y=e.y+t.y*r-n.qC),o},B.prototype.wQ=function(t,n,e,i,r){var o,a,u,s,c,f,l,o,s,l,c,o=this,a=j(0,0,0,0),u=t.Fi(),s=Jn(t,i),c=Qn(t,r),o=o._zoomFactor,f=N(t,c,e,!1,d,d,!0);return c===t.Ab&&(f+=t.my),l=N(t,s,n,!0,d,d,!0),s===t.Tb&&(l+=t.ly),a.y=s<=n?l:-l,a.x=c<=e?f:-f,(s=t.getSpan(n,e))!==d&&s!==h?(a.height=0===i&&Q(t,n,n+s.rowCount,!0)||N(t,n,n+s.rowCount,!0),a.width=0===r&&Q(t,e,e+s.colCount,!1)||N(t,e,e+s.colCount,!1)):(a[m]=Zn(t,n)*o,a[v]=Wn(t,e)*o),a.x+=u.XC,a.y+=u.qC,l=u.F6,c=u.L6,1===i?a.y+=c:2===i&&(a.y+=c+t.Sy(u)),1===r?a.x+=l:2===r&&(a.x+=l+t.Gy(u)),a},B.prototype.MQ=function(t){var n,e,i,r,o,e,n,n=this,e=n.TZ,i=e&&e.Mf,r=n._zoomFactor,o=E(0,0);return i&&(e=n.wQ(i,e.bZ,e.yZ,n.AW,n.IW)).x!==h&&e.x!==d&&e.y!==h&&e.y!==d&&R(e)&&O(e)&&(n=i.Fi(),o.x=(t.x-(e.x+R(e)-n.XC))/r,o.y=(t.y-(e.y-n.qC))/r),o},B.prototype.CQ=function(){var t=this;t.EW=t._W(),t.jW(),t.OW(),t.fQ()},B.prototype.SQ=function(){var t,n,t=this,n=t.DW(t._W(),t.TZ.width(),t.TZ.height());t.EW=E(n.x,n.y),t.OW()},B.prototype.TQ=function(){var t,n,t,t=this,n=t.TZ;n.dynamicMove()?n.dynamicSize()?t.AQ():(t.IQ(),t.OW()):(t.jW(),t.OW(),t=t.MQ(t.EW===n.yQ?t._W():t.EW),n.location(t))},B.prototype.gW=function(){var t=this;t.EW=t._W(),t.fQ()},B.prototype.IQ=function(){var t,n,e,t=this,n=t.TZ,e=t.xQ();t.EW=e,n.location(t.MQ(e),!1),t.fQ()},B.prototype.xQ=function(){for(var t,n,e,n,i,r,o,a,u,i,s,c,u,i,t=this,n=t.TZ,e=n&&n.Mf,n=t._zoomFactor,i=Qn(e,t.IW),r=Jn(e,t.AW),o=0,a=0;a<t.IW;a++)o+=e.getViewportWidth(a);for(u=N(e,i,t.NQ,!1,d,d,!0),i<t.NQ?o+=u:o-=u,(i=Wn(e,t.NQ))<t.kQ&&(t.kQ=i),o+=t.kQ*n,c=s=0;c<t.IW;c++)s+=e.getViewportHeight(c);return u=N(e,r,t.DQ,!0,d,d,!0),r<t.DQ?s+=u:s-=u,(i=Zn(e,t.DQ))<t._Q&&(t._Q=i),E(o,s+=t._Q*n)},B.prototype.EQ=function(){var t,n,e,i,r,r,r,o,o,t=this,n=t.TZ,e=n&&n.Mf,i=N(e,t.NQ,t.jQ,!1,d,!0),r=Wn(e,t.NQ);r<t.kQ&&(t.kQ=r),(r=Wn(e,t.jQ))<t.OQ&&(t.OQ=r),i=i-t.kQ+t.OQ,r=N(e,t.DQ,t.RQ,!0,d,!0),(o=Zn(e,t.DQ))<t._Q&&(t._Q=o),(o=Zn(e,t.RQ))<t.BQ&&(t.BQ=o),r=r-t._Q+t.BQ,n.width(i),n.height(r)},B.prototype.AQ=function(){var t=this;t.EQ(),t.IQ()},B.prototype.jW=function(){var t,n,e,i,n,r,o,a,u,s,c,f,l,h,d,t=this,n=t.TZ,e=n&&n.Mf,i=t._zoomFactor;if(t.EW){for(n=Qn(e,t.IW),r=Jn(e,t.AW),0===t.IW?o=t.EW.x:1===t.IW?o=t.EW.x-e.getViewportWidth(0):2===t.IW&&(o=t.EW.x-(e.getViewportWidth(0)+e.getViewportWidth(1))),0===t.AW?a=t.EW.y:1===t.AW?a=t.EW.y-e.getViewportHeight(0):2===t.AW&&(a=t.EW.y-(e.getViewportHeight(0)+e.getViewportHeight(1))),u=E(o,a),c=s=0,f=n;f<e.getColumnCount();f++){if(!(s+(l=Wn(e,f)*i)<u.x)){t.NQ=f,t.kQ=(u.x-s)/i;break}s+=l}for(h=r;h<e.getRowCount();h++){if(!(c+(d=Zn(e,h)*i)<u.y)){t.DQ=h,t._Q=(u.y-c)/i;break}c+=d}}},B.prototype.OW=function(){var t,n,e,i,n,r,o,a,u,s,c,f,l,h,d,t=this,n=t.TZ,e=n&&n.Mf,i=t._zoomFactor;if(t.EW){for(n=Qn(e,t.IW),r=Jn(e,t.AW),0===t.IW?o=t.EW.x+t.gQ():1===t.IW?o=t.EW.x+t.gQ()-e.getViewportWidth(0):2===t.IW&&(o=t.EW.x+t.gQ()-(e.getViewportWidth(0)+e.getViewportWidth(1))),0===t.AW?a=t.EW.y+t.pQ():1===t.AW?a=t.EW.y+t.pQ()-e.getViewportHeight(0):2===t.AW&&(a=t.EW.y+t.pQ()-(e.getViewportHeight(0)+e.getViewportHeight(1))),u=E(o,a),c=s=0,f=n;f<e.getColumnCount();f++){if(!(s+(l=Wn(e,f)*i)<u.x)){t.jQ=f,t.OQ=(u.x-s)/i;break}s+=l}for(h=r;h<e.getRowCount();h++){if(!(c+(d=Zn(e,h)*i)<u.y)){t.RQ=h,t.BQ=(u.y-c)/i;break}c+=d}}},B.prototype.JO=function(t,n){var e=this,i=e.TZ;t<=e.DQ?i.dynamicMove()&&(e.DQ+=n,e.RQ+=n):t>e.DQ&&t<=e.RQ&&i.dynamicSize()&&(e.RQ+=n),e.AQ()},B.prototype.qO=function(t,n){var e=this,i=e.TZ;t<=e.NQ?i.dynamicMove()&&(e.NQ+=n,e.jQ+=n):t>e.NQ&&t<=e.jQ&&i.dynamicSize()&&(e.jQ+=n),e.AQ()},B.prototype.xP=function(t,n){var e,i,r,e=this,i=e.TZ,r=t+n-1;t<e.DQ?r<e.DQ?i.dynamicMove()&&(e.DQ-=n,e.RQ-=n):r<e.RQ&&i.dynamicMove()&&(i.dynamicSize()?e.RQ-=n:e.RQ-=e.DQ-t+1,e.DQ=t,e._Q=0):t<=e.RQ&&(r<e.RQ?i.dynamicSize()&&(e.RQ-=n):i.dynamicSize()&&(e.RQ=t,e.BQ=0)),e.AQ()},B.prototype.NP=function(t,n){var e,i,r,e=this,i=e.TZ,r=t+n-1;t<e.NQ?r<e.NQ?i.dynamicMove()&&(e.NQ-=n,e.jQ-=n):r<e.jQ&&i.dynamicMove()&&(i.dynamicSize()?e.jQ-=n:e.jQ-=e.NQ-t+1,e.NQ=t,e.kQ=0):t<=e.jQ&&(r<e.jQ?i.dynamicSize()&&(e.jQ-=n):i.dynamicSize()&&(e.jQ=t,e.OQ=0)),e.AQ()},B.prototype.fQ=function(){var t,n,e,e,t=this,n=t.TZ,e=n.Mf;t.LQ()&&(e=e.zoom(),t._zoomFactor!==e?(t._zoomFactor=e,t.EW=t.xQ()):(t._zoomFactor=e,t.EW!==n.yQ||1!==n.displayMode()&&2!==n.commentState()||(t.EW=t._W())),t.xW(),t.FQ(),t.PQ(),t.GQ(),t.UQ(),Z.Tt.chrome)&&t.HQ()},B.prototype.FQ=function(){var t,n,n,t=this,n=t.TZ.Mf,n=n.parent&&n.parent.options.useTouchLayout;t.eQ=n?11:7},B.prototype.xW=function(){var t=this,n=t.TZ,e=n.Mf;t.AW=e.C0(n.bZ),t.IW=e.S0(n.yZ)},B.prototype.PQ=function(){var t,n,e,t=this,n,e=2===t.TZ.commentState()?t.li:t.Ti;t.zQ(),t.VQ(e),t.YQ(e),t.ZQ(e),t.WQ()},B.prototype.YQ=function(t){var n=this,e=n.TZ;t===n.Ti&&(t.innerHTML=X.j0(e.text()))},B.prototype.ZQ=function(t,n){var e,i,r,o,r,a,o,u,r,s,c,f,l,h,s,d,v,m,s,v,d,f,m,c,l,u,r,n,f,v,d,s,c,a,e=this,i=e.TZ,r=n||2===i.commentState()||1===i.displayMode()?e._W():e.EW,o=e._zoomFactor;r&&(r=e.Eb?e.DW(r,i.width(),i.height()):e.DW(r),e.QQ(r),a=R(r)*o,o=O(r)*o,s=(u=r.x)+a,c=(r=r.y)+o,f=e.eQ,l=e.KQ(e.AW,e.IW),h=2*(f+i.borderWidth()),u<l.x?(ne(e,p,u-l.x,u+f-l.x),a+=u-l.x,u=l.x):(ne(e,p,0,f),s>l.x+R(l)&&(a+=l.x+R(l)-1-s)),(a=I(R(l)-1,a))<0&&(s=i.Mf,d=i.yZ,v=s.r6(s.getColumnCount()-s.lL),m=s.getViewportRightColumn(1),!1===s.Vy)&&d===v&&d===m&&(u=l.x+R(l)-1-i.width(),a=i.width()),r<l.y?(ne(e,b,r-l.y,r+f-l.y),o+=r-l.y,r=l.y):(ne(e,b,0,f),c>l.y+O(l)&&(o+=l.y+O(l)-1-c)),o=I(O(l)-1,o),(s=(0,A.GC$)(e.qW)).css({left:u,top:r}),v=s.height(),d=s.width(),m=!1,(f=e.JQ(a,o))&&(a=f.adjustedWidth,o=f.adjustedHeight,m=!n&&f.needReposition),o<=0&&v<=0||a<=0&&d<=0||((1<T(o-v)||1<T(a-d))&&(s.css({width:a,height:o}),g.$l(e.SW,a,o)),l=(c=(0,A.GC$)(e.TW)).width(),u=c.height(),r=G(0,a-h),n=G(0,o-h),(1<T(u-n)||1<T(l-r))&&(0,A.GC$)(e.TW).css({width:r,height:n}),v=(f=(0,A.GC$)(t)).width(),d=f.height(),s=r,c=n,(a=i.padding())&&(s-=Math.ceil(K(a.left)+K(a.right)),c-=Math.ceil(K(a.top)+K(a.bottom))),(1<T(d-c)||1<T(v-s))&&(0,A.GC$)(t).css({width:G(0,s),height:G(0,c)}),m&&e.ZQ(t,!0)))},B.prototype.QQ=function(t){var n,e,i,i,r,o,a,n=this,e=n.TZ,i=n.EW;t.x===i.x&&t.y===i.y&&R(t)===e.width()&&O(t)===e.height()||(i=n.MQ(E(t.x,t.y)),r=R(t),o=O(t),a=e.location(),i.x===a.x&&i.y===a.y||e.location(i,!1),r!==e.width()&&e.width(r,!1),o!==e.height()&&e.height(o,!1),e.dynamicMove()&&(n.EW=E(t.x,t.y)))},B.prototype.WQ=function(){var t=this,n=t.TZ,e;xn(n&&n.Mf)?(t.aQ(t.SW,Et),t.aQ(t.TW,jt),t.oQ(),t.cQ(),t.sQ()):(n.locked()?(t.hQ(t.SW,Et),t.XQ(t.SW),t.hQ(t.TW,jt),t.XQ(t.TW),t.SW.style.cursor=H,t.TW.style.cursor=H):(t.aQ(t.SW,Et),t.aQ(t.TW,jt)),n.lockText()?(t.dQ(),t.XQ(t.Ti),t.mQ(),t.XQ(t.li),!n.locked()&&n.commentState()===_.active||n.commentState(3),t.Ti.style.cursor=n.locked()?H:Mt):(t.cQ(),t.sQ()),t.oQ())},B.prototype.zQ=function(){var t=this,n=t.TZ,e=t.NW,i=n&&n.Mf;switch(n.commentState()){case _.active:e.qQ(n),t.uQ()&&t.$Q(),0<i.getSelections().length&&i.e4(),Y.F1(i);break;case _.edit:e.qQ(n),t.uQ()||t.tK(),0<i.getSelections().length&&i.e4(),Y.F1(h);break;case _.normal:n===e.pZ()&&(e.CZ(),0===i.getSelections().length)&&i.cR()}},B.prototype.VQ=function(t){var n,e,i,r,i;function o(t,n,e){var e,i;return e?((i=(e=F.Common.ft)._(t)).a=n,e.j(i)):t}e=(n=this).TZ,(i=(0,A.GC$)(t)).css("font-family",e.fontFamily()).css("font-style",e.fontStyle()).css("font-size",parseInt(e.fontSize(),10)*n._zoomFactor+"pt").css("font-weight",e.fontWeight()),i.css("text-decoration",s.W.A5(e.textDecoration())),i.css("text-align",(r={0:"left",1:"center",2:"right",3:"general"})[e.horizontalAlign()]),e.padding()?i.css(Dt,e.padding().toString()):i.css(Dt,"0px"),i.css("background-color",o(e.backColor(),e.opacity(),t===n.Ti)).css("color",e.foreColor()),(0,A.GC$)(n.TW).css("border-width",e.borderWidth()).css("border-style",e.borderStyle()).css("border-color",e.borderColor()),i=n.NW.nK(e),(0,A.GC$)(n.$W).css(It,i),(0,A.GC$)(n.qW).css(It,i)},B.prototype.HQ=function(){var t,n,e,n,i,n,t,n=this.TZ.Mf,e=(0,A.GC$)(this.TW);n&&e&&(i=.5<=(n=n.uw()).left-x(n.left)?.5:0,n=.5<=n.top-x(n.top)?.5:0,e.css(p,K(e.css(p))+i),e.css(b,K(e.css(b))+n))},B.prototype.GQ=function(){var t,n,e,n,e,i,r,n,o,e,a,o,e,a,u,s,e,c,f,l,t=this,n=t.TZ,e=n.Mf,n=t.wQ(e,n.bZ,n.yZ,t.AW,t.IW),e=e.Fi(),i,r,n=E(n.x+R(n)-e.XC,n.y-e.qC),e=(0,A.GC$)(t.qW).position(),a=(0,A.GC$)(t.TW).position(),o=(0,A.GC$)(t.TW),o=e.left+a.left>n.x?E(e.left+a.left,e.top+a.top):e.top+a.top+o.height()<n.y?E(e.left+a.left+o.width(),e.top+a.top+o.height()):E(e.left+a.left+o.width(),e.top+a.top),e=t.eQ,a=T(n.x-o.x)+2*e,u=T(n.y-o.y)+2*e,s=I(n.x,o.x)-e,e=I(n.y,o.y)-e,c=s+a,f=e+u,l=t.KQ(t.AW,t.IW);s<l.x&&(a-=l.x-s,s=l.x),c>l.x+R(l)&&(a-=c-(l.x+R(l))),a=I(R(l),a),e<l.y&&(u-=l.y-e,e=l.y),f>l.y+O(l)&&(u-=f-(l.y+O(l))),u=I(O(l),u),(0,A.GC$)(t.$W).css(p,s).css(b,e).css(v,a).css(m,u),g.$l(t.tQ,a,u),n.x=n.x-s,n.y=n.y-e,o.x=o.x-s,o.y=o.y-e,t.eK(n,o)},B.prototype.eK=function(t,n){var e,i,r,e,e=this;e.iK||(e.iK=e.tQ.getContext("2d")),i=e.iK,r=e.TZ.borderColor(),i.strokeStyle=r,i.clearRect(0,0,g.Xl(e.tQ),g.ql(e.tQ)),i.beginPath(),i.moveTo(t.x,t.y),i.lineTo(n.x,n.y),i.stroke(),i.save(),q.Yl(i,t.x,t.y),i.fillStyle=r,i.beginPath(),e=U(n.y-t.y,n.x-t.x),i.rotate(e),i.moveTo(0,0),i.lineTo(7,-4),i.lineTo(7,4),i.lineTo(0,0),i.fill(),q.Yl(i,-t.x,-t.y),i.closePath(),i.restore()},B.prototype.UQ=function(){var t,n,e,i,r,o,a,u,s,c,t=this,n=t.TZ,e=n.Mf;t.rK=t.TZ.commentState(),t.oK||(t.oK=t.SW.getContext("2d")),i=t.oK,r=g.Xl(t.SW),o=g.ql(t.SW),a=(0,A.GC$)(t.TW).outerWidth(),u=(0,A.GC$)(t.TW).outerHeight(),s=t.eQ,i.clearRect(0,0,r,o),t.TZ.showShadow()&&(t.aK(i,r,o),i.clearRect(s,s,r-(c=2*(s+2)),o-c),t.uK(i,s,a,u)),xn(e,n)&&t.sK(i,s,r,o,a,u),i.restore()},B.prototype.uK=function(t,n,e,i){t.save(),t.fillStyle=sn,t.fillRect(n+2,i+n,e,2),t.fillRect(e+n,n+2,2,i),t.restore()},B.prototype.aK=function(t,n,e){var i,r,o;switch(t.save(),t.strokeStyle=sn,this.rK){case _.active:for(t.beginPath(),r=0;r<e;r++)for(i=r%2==0?1:3;i<n;)t.moveTo(i,r),t.lineTo(i+1,r+1),i+=4;t.stroke(),t.closePath();break;case _.edit:for(t.beginPath(),r=i=0,o=4;i<n+e;)t.moveTo(i+4,0),t.lineTo(0,r+4),i+=4,r+=4;t.stroke(),t.closePath()}t.restore()},B.prototype.sK=function(o,t,n,e,i,r){var a=this,u=a.nQ;a.rK!==_.active&&a.rK!==_.edit||(u.splice(0,u.length),te(u,0,0,t,"nw"+D),te(u,n-t,0,t,"ne"+D),te(u,0,e-t,t,"sw"+D),te(u,n-t,e-t,t,"se"+D),3*t<=r?(te(u,0,x(e/2-t/2),t,"w"+D),te(u,n-t,x(e/2-t/2),t,"e"+D)):(u.push(h),u.push(h)),3*t<=i?(te(u,x(n/2-t/2),0,t,"n"+D),te(u,x(n/2-t/2),e-t,t,"s"+D)):(u.push(h),u.push(h)),o.restore(),o.fillStyle="white",o.strokeStyle="#939393",o.lineWidth=1,q.Yl(o,.5,.5),A.GC$.each(u,function(t,n){var e,i,r,n;n&&(e=n.x,i=n.y,r=R(n),n=O(n),o.beginPath(),o.fillRect(e,i,r-1,n-1),o.strokeRect(e,i,r-1,n-1),o.stroke(),o.closePath())}),q.Yl(o,-.5,-.5))},B.prototype.cK=function(){var n,t,e,i,e,n=this,t=n.KQ(n.AW,n.IW);n.eW?(0,A.GC$)(n.eW).remove():n.eW=r(f),e=(0,A.GC$)(n.eW),i=(0,A.GC$)(n.TW),e.addClass("gc-spread-moveResizeContainer").css([o,p,b,v,m,"border"],[a,n.EW.x+n.eQ-t.x,n.EW.y+n.eQ-t.y,i.outerWidth()-2,i.outerHeight()-2,"gray solid thin"]),n.fK?(0,A.GC$)(n.fK).remove():n.fK=r(f),(e=(0,A.GC$)(n.fK)).bind("mousemove",function(t){n.pg(t)}).bind(on,function(t){n.bg(t)}).css([o,u,b,p,v,m,"background",It],[a,xt,t.y,t.x,R(t),O(t),"rgba(255,255,255,0.01)",901]),e.append(n.eW),n.YW&&n.YW.appendChild(n.fK)},B.prototype.lK=function(t){var n,e,i,r,o,a,u,t,a,s,c,s,f,f,n=this,e=n.eQ,i=n._zoomFactor,r,o=n.NW.RW;o.BW&&(a=n.hK(),u=t.pageX/i-o.x+a.x,t=t.pageY/i-o.y+a.y,0===u&&0===t||(a=n.KQ(n.AW,n.IW),c=(0,A.GC$)(n.eW),o.FW<0?(s=o.LW.x+u,f=o.LW.y+t,s=n.bQ(E(s,f)),c.css([p,b],[s.x+e-a.x,s.y+e-a.y])):(f=n.dK(u,t,o.FW),s=n.bQ(E(f.x,f.y)),c.css([p,b,v,m],[s.x+e-a.x,s.y+e-a.y,R(f)*i-2*e-2,O(f)*i-2*e-2]))))},B.prototype.tK=function(){var t,n,e,t=this,n=t.TZ;t.uQ()||(e=t.NW.kW,(0,A.GC$)(t.Ti).remove(),t.dQ(),(0,A.GC$)(e).remove(),(0,A.GC$)(t.TW).append(e),t.vK(e),t.ZQ(e),(0,A.GC$)(e).focus(),e.selectionStart=e.value.length,t.sQ(),2!==n.commentState()&&n.commentState(2,!0))},B.prototype.$Q=function(){var t,n,e,i,t=this,n=t.TZ,e=n.Mf;t.uQ()&&(i=t.NW.kW,t.mQ(),(0,A.GC$)(i).remove(),(0,A.GC$)(t.TW).append(t.Ti),t.vK(t.Ti),t.cQ(),B.et(t,"detachEditor",t.Ti),2===n.commentState()&&n.commentState(3),(0,A.GC$)(i).val()!==n.text())&&e.Qy().execute({cmd:"changeComment",sheetName:e.name(),row:n.bZ,col:n.yZ,oldValue:n.text(),newValue:(0,A.GC$)(i).val(),propertyName:Bt})},B.prototype.mK=function(t){var n,e,i,n,e=this.TZ.Mf,i=-1;return 0===t||2===t?i=e.getViewportHeight(t):1===t&&(i=N(e,e.getViewportBottomRow(0)+1,Jn(e,2)+1,!0)),i},B.prototype.gK=function(t){var n,e,i,n,e=this.TZ.Mf,i=-1;return 0===t||2===t?i=e.getViewportWidth(t):1===t&&(i=N(e,e.getViewportRightColumn(0)+1,Qn(e,2)+1,!1)),i},B.prototype.KQ=function(t,n){var e,i,r,o,a,i,e,i=this.TZ.Mf,r=i.Fi(),o=r.c9(t,n),a=i.Gy(r),i=i.Sy(r);return 0===t&&0===n||0===t&&2===n||2===t&&0===n||2===t&&2===n?o=j(0,0,r.F6+a+r.zy,r.L6+i+r.Iy):0===t&&1===n||2===t&&1===n?o=j(r.F6,0,a,r.L6+i+r.Iy):1===t&&0===n||1===t&&2===n?o=j(0,r.L6,r.F6+a+r.zy,i):1===t&&1===n&&(o=j(r.F6,r.L6,a,i)),o},B.prototype.vK=function(t){var n=this,e=n.TZ,i=(0,A.GC$)(t);t!==n.li&&t!==n.Ti||(t===n.li?t.value=e.text():t.innerHTML=X.j0(e.text()),i.css([Yt,Zt,Wt,Qt,Jt,tn,nn,un],[e.fontFamily(),e.fontStyle(),e.fontSize(),e.fontWeight(),e.foreColor(),e.backColor(),e.horizontalAlign(),e.textDecoration()]),e.padding()?i.css(Dt,e.padding().toString()):i.css(Dt,"0px"))},B.prototype.LQ=function(){return!(!this.qW||!this.qW.parentNode)},B.prototype.uQ=function(){var t=this;return t.LQ()&&t.TZ===t.NW.pZ()&&0<(0,A.GC$)(t.TW).find(Kt).length},B.prototype.pK=function(){var t,n,e,n,t=this,n=t.TZ.Mf,e=h;return t.LQ()&&(n=n.Fi(),e=j(t.EW.x+n.BA+n.XC,t.EW.y+n.LA+n.qC,t.gQ(),t.pQ())),e},B.prototype.bK=function(){var t,n,e,i,r,o,a,u,t,s,t=this,n=t.TZ,e=t._zoomFactor;return t.LQ()&&(i=t.pK())?(u=a=o=r=void 0,t=(t.eQ+n.borderWidth())*e,j(r=i.x+t,o=i.y+t,a=R(i)-2*t,u=O(i)-2*t)):h},B.prototype.yK=function(t){var n,e,i,r,o,a,u,o,n=this,e=n.TZ,i=e.Mf,r=t.target,o=n.NW.RW,a=r.style,u=H;o.BW?r[k]!==n.JW&&r[k]!==n.QW&&r[k]!==n.XW&&r[k]!==C+"floatPanel"||(u=0<=o.FW?"crosshair":Mt):r[k]===n.JW?!xn(i)&&e.lockText()?e.locked()||(u=Mt):u=Bt:r[k]!==n.QW&&r[k]!==n.KW||xn(i,e)&&(u=0<=(o=n.wK(t))&&o<n.nQ.length?n.nQ[o].cursor:Mt),a[Rt]=u},B.prototype.lW=function(t){var n,e,i,r,n=this,e=n.TZ,i=e&&e.Mf;if(i&&i.endEdit()&&e&&i.comments.get(e.bZ,e.yZ)&&(B.et(n,"preProcessMouseDownEdit",r={e:t,r:h}),!r.r))return i.ki(c.FloatingElementSelected,{type:"comments"}),n.NW.qQ(e),e.commentState(2,!0),n.bg(t),W(t)},B.prototype.XZ=function(t){var n,e,i,r,o,a,u,u,r,o,e,n=this,e=n.TZ,i=e&&e.Mf,r=n._zoomFactor,o=n.NW,a=o.RW;i.endEdit()&&(B.et(n,"preProcessMouseDownDragResize",u={e:t,r:h}),u.r||(i.ki(c.FloatingElementSelected,{type:"comments"}),a.x=t.pageX/r,a.y=t.pageY/r,a.LW=j(e.location().x,e.location().y,e.width(),e.height()),a.FW=n.wK(t),n.Fg(),a.BW=!0,n.yK(t),o.qQ(e),e.commentState(_.active,!0),xn(i,e)&&(n.CK={},n.CK.SK=Jn(i,n.AW),n.CK.TK=Qn(i,n.IW),n.cK(),a.FW<0?n.iQ=!0:n.Eb=!0),u=i.rt,r=i.uw(),o=E(t.pageX-r.left,t.pageY-r.top),e=i.hitTest(o.x,o.y),u.Rk={e9:e.rowViewportIndex,r9:e.colViewportIndex,Bk:e.hitTestType},u.fk=o,u.Ok(),u.s9=!0,t.stopPropagation()))},B.prototype.DW=function(t,n,e){var i,r,o,a,u,s,c,f,n,e,l,h,d,v,m,t,v,g,p,b,y,w,y,s,y,M,r,C,S,s,i=this,r=i.TZ,o=r&&r.Mf,a=i.eQ,u=i._zoomFactor,s=i.IW,c=i.AW,f=i.KQ(c,s),n=void 0!==n?n*u:i.gQ(),e=void 0!==e?e*u:i.pQ(),l=t.x,h=t.y,d=o.Fi(),v=i.wQ(o,0,0,c,s),m=t.x+(0-(v.x-d.XC))+n-a,t=t.y+(0-(v.y-d.qC))+e-a,v=0,g=0,p=0,b=0;return 0===s?(v=0-a,p=R(d)-d.XC):1===s?(y=N(o,o.getViewportRightColumn(0)+1,Qn(o,1),!1),v=f.x-a-y,p=w=i.gK(2)):2===s&&(v=0-a),l<v&&(i.Eb?n-=v-l:m+=v-l,l=v),1!==s&&2!==s||(p+=N(o,0,o.getColumnCount(),!1,m)),p<m&&(i.Eb?n-=m-p:i.iQ?l-=m-p:(y=i.NW.PW&&!r.ignoreDefaultLocation()?9:r.location().x,v<(y=l-(s=2*T(y)+Wn(o,r.yZ)+r.width()))?l=y:l<p?n-=m-p:(y=l-s,l=v<(M=m-s)?y<v?(n-=v-y,v):y:(y=l-(m-p))<v?(n-=v-y,v):y))),0===c?(g=0-a,b=O(d)-d.qC):1===c?(r=N(o,o.getViewportBottomRow(0)+1,Jn(o,1),!0),g=f.y-a-r,b=C=i.mK(2)):g=0-a,h<g&&(i.Eb?e-=g-h:t+=g-h,h=g),1!==c&&2!==c||(b+=N(o,0,o.getRowCount(),!0,t)),b<t&&(i.Eb?e-=t-b:i.iQ?h-=t-b:b<t&&(h=(s=h-(S=t-b))<g?(e-=g-s,g):s)),j(l,h,n/u,e/u)},B.prototype.hK=function(){var t,n,e,i,r,o,r,a,t,u,n,t=this,n=t.TZ.Mf,r=t.CK,o=r.SK,r=r.TK,a=Jn(n,t.AW),t=Qn(n,t.IW),u=N(n,o,a,!0),n=N(n,r,t,!1),e,i;return E(r<t?n:-n,o<a?u:-u)},B.prototype.AK=function(t){var n,e,i,r,o,a,u,s,c,t,r,s,f,f,l,l,c,n=this,e=n.TZ,i=e&&e.Mf,r=n._zoomFactor,o,a=n.NW.RW,u=P.ChangeComment;a.BW&&(s=n.hK(),c=t.pageX/r-a.x+s.x,t=t.pageY/r-a.y+s.y,0===c&&0===t||(s=r=void 0,a.FW<0?(f=a.LW.x+c,l=a.LW.y+t,r=n.bQ(E(f,l)),s=n.DW(r),(f=n.MQ(E(s.x,s.y))).x===e.location().x&&f.x===e.location().y||i.Qy().execute({cmd:"moveComment",sheetName:i.name(),row:e.bZ,col:e.yZ,oldValue:e.location().clone(),newValue:f,propertyName:"location"})):(e.autoSize(!1),l=n.dK(c,t,a.FW),r=n.bQ(E(l.x,l.y)),s=n.DW(r,R(l),O(l)),c=[],(f=n.MQ(E(s.x,s.y))).x===e.location().x&&f.y===e.location().y||c.push(new u(i,{cmd:"changeComment",sheetName:i.name(),row:e.bZ,col:e.yZ,oldValue:e.location().clone(),newValue:f,propertyName:"location"})),R(s)!==e.width()&&c.push(new u(i,{cmd:"changeComment",sheetName:i.name(),row:e.bZ,col:e.yZ,oldValue:e.width(),newValue:s.width,propertyName:v})),O(s)!==e.height()&&c.push(new u(i,{cmd:"changeComment",sheetName:i.name(),row:e.bZ,col:e.yZ,oldValue:e.height(),newValue:s.height,propertyName:m})),0<c.length&&i.Qy().execute({cmd:"changeCommentTransaction",sheetName:i.name(),commands:c}))))},B.prototype.pg=function(t){var n,e,i,i,r,o,e,e,n=this,e=n.TZ.Mf,i={e:t,r:h};if(B.et(n,"preProcessMouseMove",i),!(i.r||(this.yK(t),e.getSelections()&&0<e.getSelections().length)))return i=n.NW,r=t.target,o=e.rt,e=e.uw(),e=E(t.pageX-e.left,t.pageY-e.top),r&&i.RW.BW&&(n.eW&&n.lK(t),1===n.AW&&(o.fk.y=e.y),1===n.IW&&(o.fk.x=e.x),o.a9()),W(t)},B.prototype.bg=function(t){var n,e,i,i,r,e,n=this,e=n.TZ.Mf,i={e:t,r:h};if(B.et(n,"preProcessMouseUp",i),!(i.r||e.getSelections()&&0<e.getSelections().length))return i=t.target,r=n.NW,(e=e.rt).s9=!1,e.l9(),i&&(n.AK(t),n.fK&&((0,A.GC$)(n.fK).remove(),n.fK=null,n.iQ=!1,n.Eb=!1),n.u2(),r.RW.BW=!1,n.yK(t)),W(t)},B.prototype.wK=function(t){var n,e,n,i,r,o,a,n=this,e=n.nQ;if(0<e.length&&(n.rK===_.active||n.rK===_.edit))for(n=n.SW,i=t.pageX-(0,A.GC$)(n).offset().left,r=t.pageY-(0,A.GC$)(n).offset().top,o=0;o<e.length;o++)if((a=e[o])&&a.contains(i,r))return o;return-1},B.prototype.dK=function(t,n,e){var i,r,o,e,t,i=this,r=-1,o=-1;switch(e){case 0:o=r=0;break;case 1:r=2,o=0;break;case 2:r=0,o=2;break;case 3:o=r=2;break;case 4:r=0,o=1;break;case 5:r=2,o=1;break;case 6:r=1,o=0;break;case 7:r=1,o=2}return e=i.IK(t,r),t=i.oh(n,o),j(e.x,t.y,e.w,t.h)},B.prototype.IK=function(t,n){var e,i,e,r,o,t,e=this,i=2*e.eQ,e=e.NW.RW,r=R(e.LW)-i;return 0===n?r-=t:2===n&&(r+=t),o=e.LW.x,0<=r?0===n&&(o+=t):0===n?o+=R(e.LW)-i:2===n&&(o+=r),t=R(e.LW),{x:o,w:t=1!==n?T(r)+i:t}},B.prototype.oh=function(t,n){var e,i,e,r,o,t,e=this,i=2*e.eQ,e=e.NW.RW,r=O(e.LW)-i;return 0===n?r-=t:2===n&&(r+=t),o=e.LW.y,0<=r?0===n&&(o+=t):0===n?o=O(e.LW)-i:2===n&&(o+=r),t=O(e.LW),{y:o,h:t=1!==n?T(r)+i:t}},B.prototype.XQ=function(t){var n,e,i,n,n=this,e=n.TZ.Mf;if(t){switch(i=d,t){case n.SW:i=Et;break;case n.TW:i=jt;break;case n.$W:i=Ot;break;case n.Ti:i=w;break;case n.li:i=M}i&&((0,A.GC$)(t).unbind(an+i).unbind(Ct+i),n=function(t){e.P_(t),W(t)},(0,A.GC$)(t).bind(an+i,n).bind(Ct+i,n))}},B.prototype.aQ=function(t,n){var e,i,r,i,e=this,i=e.TZ,r=i&&i.Mf;e.hQ(t,n),i=function(t){ie(r,t)},(0,A.GC$)(t).bind(en+n,function(t){e.XZ(t)}).bind(rn+n,function(t){e.pg(t)}).bind(on+n,function(t){e.bg(t)}).bind(an+n,i).bind(Ct+n,i)},B.prototype.hQ=function(t,n){(0,A.GC$)(t).unbind(n)},B.prototype.oQ=function(){var o,t,a,u,s,t,o=this,t=o.TZ,a=t&&t.Mf,u=o.NW;o.vQ(),a&&(s=a.uw(),t=function(t){a.P_(t)},(0,A.GC$)(o.tQ).bind(en+Xt,function(t){var n,e,e,n=a.Ut.pI.hitTest(t.pageX-s.left,t.pageY-s.top);n?(e=n.comment,e=u.mW(e),n.area===zt?e.lW(t):n.area===Vt&&e.XZ(t),(0,A.GC$)(e.qW).css(It,parseInt((0,A.GC$)(o.$W).css(It)+1,10))):a.B_(t)}).bind(rn+Xt,function(t){var n,e,i,r,i,n=a.Ut.pI.hitTest(t.pageX-s.left,t.pageY-s.top),e=o.tQ.style;n?(i=n.comment,(r=u.mW(i)).pg(t),n.area===zt?e.cursor=Bt:n.area===Vt&&(e.cursor=Mt)):(a.L_(t),o.NW.wW(h),(i=a.Dg())&&(e.cursor=i.style.cursor))}).bind(on+Xt,function(t){var n,n,e,n=a.Ut.pI.hitTest(t.pageX-s.left,t.pageY-s.top);n?(n=n.comment,(e=u.mW(n)).bg(t)):a.F_(t)}).bind("dblclick"+Xt,function(t){a.U_(t)}).bind(an+Xt,t).bind(Ct+Xt,t))},B.prototype.vQ=function(){var t;(0,A.GC$)(this.tQ).unbind(Xt)},B.prototype.cQ=function(){var n,t,e,t,n=this,t=n.TZ,e=t&&t.Mf;t.commentState()!==_.edit&&n.Ti&&(n.dQ(),t=function(t){ie(e,t)},(0,A.GC$)(n.Ti).bind(en+w,function(t){n.lW(t)}).bind(rn+w,function(t){n.pg(t)}).bind(on+w,function(t){n.bg(t)}).bind(an+w,t).bind(Ct+w,t))},B.prototype.dQ=function(){var t=this,n;t.TZ.commentState()!==_.edit&&t.Ti&&(0,A.GC$)(t.Ti).unbind(w)},B.prototype.sQ=function(){var t,n,e,i,t=this,n=t.TZ,e=n&&n.Mf,i=t.li;n.commentState()===_.edit&&i&&(this.mQ(),(0,A.GC$)(i).bind(en+M,function(t){t.stopPropagation()}).bind(rn+M,function(t){t.stopPropagation()}).bind(on+M,function(t){t.stopPropagation()}).bind("keydown"+M,function(t){27!==t.keyCode&&9!==t.keyCode||(n.commentState(_.active,!0),W(t),Y.F1(e))}).bind("focusout"+M,function(){(0,A.GC$)(i).val()!==n.text()&&e.Qy().execute({cmd:"changeComment",sheetName:e.name(),row:n.bZ,col:n.yZ,oldValue:n.text(),newValue:(0,A.GC$)(i).val(),propertyName:Bt})}))},B.prototype.JQ=function(t,n){var e,i,r,o,r,a,u,s,c,f,l,h,l,d,v,m,g,p,b,y,w,M,C,S,T,d,e=this,i=e.TZ,r=e.eQ,o=i.padding(),r=2*(r+i.borderWidth());if(!(!i.autoSize()||e.Eb||e.xK||n<=0)){if(e.xK=!0,u=(a=i.Mf).Fi(),s=a.qc()&&a.qc().getBoundingClientRect(),f=i.commentState()===_.edit?(c=e.li).value:(c=e.Ti,X.dI(c.innerHTML)),h="",(l=c.style).font?h+=l.font:(i.fontStyle()&&(h+=Gt+i.fontStyle()),i.fontWeight()&&(h+=Gt+i.fontWeight()),i.fontSize()&&(h+=Gt+parseInt(i.fontSize(),10)*e._zoomFactor+"pt"),i.fontFamily()&&(h+=Gt+i.fontFamily())),l=c.getBoundingClientRect(),d=i.location().x<0,v=!1,p=m=J("M",h),b=g=5,y=u.x+u.width-(l.left-s.left),w=u.y+u.height-(l.top-s.top),d&&(y=l.left-s.left+l.width-u.x,v=!0),(M=A.q.un(f,y,h))&&0<M.length){for(S=C=0;S<M.length;S++)C<(T=a.Gi(M[S],h))&&(C=T);d=ee(M,h),o&&(C+=(o.left||0)+(o.right||0),d+=(o.top||0)+(o.bottom||0)),b=x(I(y,G(C,5))),p=x(I(w,d))}return 2===i.commentState()&&i.text(c.value),n=p+r,t=b+r,i.width(b,!1),i.height(p,!1),v&&i.location().x+b<=0&&(v=!1),e.xK=!1,{adjustedWidth:t,adjustedHeight:n,needReposition:v}}},B.prototype.mQ=function(){var t,n=this.li;n&&(0,A.GC$)(n).unbind(M)},B.prototype.Fg=function(){var n=this,t=n.NW.RW;t.BW||((0,A.GC$)(dt).bind(rn+qt,function(t){n.pg(t)}).bind(on+qt,function(t){n.bg(t)}),t.BW=!0)},B.prototype.u2=function(){var t=this.NW.RW;t.BW&&(t.BW=!1,A.GC$)(dt).unbind(qt)},Cn=B,t.hW=Cn,s.$e(Cn),e.prototype.getUsedRange=function(){var t,n,e,i,r,o,a,u,t,n=this.all(),e={};if(n)for(r=i=void 0,o=0,a=n;o<a.length;o++)i=(u=a[o]).bZ,r=u.yZ,mt(e,{minRow:i,minCol:r,maxRow:i,maxCol:r});return e},e.prototype.dispose=function(t){var n,e,n=this,e;n.all().forEach(function(t){n.NK(t)}),n.kK(),!1!==t&&(n.Mf=h)},e.prototype.add=function(t,n,e){var i,r,o,o,e,i=this,r=i.Mf,o=r.getSpan(t,n);return!o||o.row===t&&o.col===n?(o=i.get(t,n),e="string"==typeof e?new gn(e):e,i.WB(t,n,e),r.Rj("comment",t,n,A.SheetArea.viewport,o,e),r.ki(c.WorksheetDataChanged,{type:"comment"}),e):h},e.prototype.WB=function(t,n,e,i){var r=this,o=r.Mf,a=r.wB;r.DK(t,n),e&&(e.bZ=t,e.yZ=n,e.Mf=o,a.push(e),e.lp=r.GW,o.Ut.MW({type:"add",row:t,col:n,comment:e}),r.GW++,r._K(t,n,e),i||o.zw())},e.prototype.get=function(t,n){return this.cE[t+"_"+n]||h},e.prototype._K=function(t,n,e){this.cE[t+"_"+n]=e},e.prototype.EK=function(t,n,e){var i=t.bZ,r=t.yZ;this.get(i,r)===t&&this._K(i,r,d),this.Mf.Ut.MW({type:"rowcol",comment:t,row:i,col:r,newRow:n,newCol:e}),t.bZ=n,t.yZ=e,this._K(n,e,t)},e.prototype.remove=function(t,n){var e=this,i=e.DK(t,n),e=e.Mf;i&&(e.Rj(V,t,n,A.SheetArea.viewport,i,d),e.ki(c.WorksheetDataChanged,{type:"comment"}),e.zw())},e.prototype.DK=function(t,n){var e,i,r,i,e=this,i=e.Mf,r=e.get(t,n);return r&&(i.Ut.MW({type:"remove",row:t,col:n,comment:r}),e.NK(r),z.VP(e.wB,r),(i=e.mW(r))&&(Cn.et(i,"dispose"),z.VP(e.UW,i)),e._K(t,n,d)),r},e.prototype.clear=function(t){var n,e,i,r,o,a,o,n=this,e=n.Mf,i=n.wB;for(e.suspendPaint(),r=i.length-1;0<=r;r--)a=(o=i[r]).bZ,o=o.yZ,(!t||a>=t.row&&a<t.row+t.rowCount&&o>=t.col&&o<t.col+t.colCount)&&n.remove(a,o);e.resumePaint()},e.prototype.all=function(){return this.wB.concat()},e.prototype.CB=function(t,n,e,i,r,o){(t||i)&&(t&&this.EK(t,r,o),i)&&this.EK(i,n,e)},e.prototype.getOuterContainer=function(t){var t=this.mW(t);return t?t.qW:h},e.prototype.HW=function(){var t=r(Kt);(0,A.GC$)(t).addClass("gc-comment-editor").css(p,0).css(b,0).css(o,a).css("margin",0).css(Dt,0).css("word-wrap","break-word").css("word-break","normal").css(u,xt).css("resize","none").css("outline","none").css("border","0px").css(Nt,kt).css($t,"normal").attr("autocomplete","off").attr("gcUIElement","gcEditingInput"),this.kW=t},e.prototype.zW=function(){var i=this,t=i.Mf;t&&(t.D3(c.ColumnChanged+y,function(t,n){var n=n.propertyName;n!==v&&"isVisible"!==n||i.jK()}),t.D3(c.RowChanged+y,function(t,n){var n=n.propertyName;n!==m&&"isVisible"!==n||i.jK()}),t.D3(c.ColumnWidthChanged+y,function(){i.jK()}),t.D3(c.RowHeightChanged+y,function(){i.jK()}),t.D3(c.CommentChanged+y,function(t,n){var e,n,n;n&&(e=n.propertyName,n=n.comment,n=i.mW(n))&&("location"===e?n.CQ():e!==v&&e!==m||n.SQ())}))},e.prototype.kK=function(){var t,n=this.Mf;n&&n._3(y)},e.prototype.mW=function(t){var n,e,i,r,n,e=this.UW;if(t)for(i=0;i<e.length;i++)if((r=e[i]).TZ===t)return r;return h},e.prototype.Oy=function(){return 0===this.wB.length},e.prototype.RK=function(){var t,n,e,i,r,t,n=this.wB;if(0<n.length){for(e=n[0].zIndex(),i=1;i<n.length;i++)e<(r=n[i]).zIndex()&&(e=r.zIndex());return e}return 0},e.prototype.JO=function(t,n){for(var e,i,r,o,a,u,s,e=this,i=e.wB,r=e.UW,o=0;o<i.length;o++)t<=(a=i[o]).bZ&&e.EK(a,a.bZ+n,a.yZ);for(u=0;u<r.length;u++)(s=r[u]).LQ()&&s.JO(t,n)},e.prototype.qO=function(t,n){for(var e,i,r,o,a,u,s,e=this,i=e.wB,r=e.UW,o=0;o<i.length;o++)t<=(a=i[o]).yZ&&e.EK(a,a.bZ,a.yZ+n);for(u=0;u<r.length;u++)(s=r[u]).LQ()&&s.qO(t,n)},e.prototype.xP=function(t,n){for(var e,i,r,o,a,u,s,c,e=this,i=e.wB,r=e.UW,o=i.length-1;0<=o;o--)u=(a=i[o]).bZ,s=a.yZ,t<=u&&u<t+n&&e.remove(u,s);for(o=0;o<i.length;o++)t<(a=i[o]).bZ&&e.EK(a,a.bZ-n,a.yZ);for(o=0;o<r.length;o++)(c=r[o]).LQ()&&c.xP(t,n)},e.prototype.NP=function(t,n){for(var e,i,r,o,a,u,s,c,e=this,i=e.wB,r=e.UW,o=i.length-1;0<=o;o--)u=(a=i[o]).bZ,t<=(s=a.yZ)&&s<t+n&&e.remove(u,s);for(o=0;o<i.length;o++)t<(a=i[o]).yZ&&e.EK(a,a.bZ,a.yZ-n);for(o=0;o<r.length;o++)(c=r[o]).LQ()&&c.NP(t,n)},e.prototype.pZ=function(){return this.MZ},e.prototype.qQ=function(t){var n=this;t&&t!==n.MZ&&(n.CZ(),n.MZ=t)},e.prototype.CZ=function(){var t,n,e,t=this,n=t.MZ;n&&(e=t.mW(n))&&!e.iQ&&!e.Eb&&(e.uQ()&&e.$Q(),n.commentState(_.normal),t.MZ=h)},e.prototype.$c=function(t){var n,e,n=this,e=n.mW(t);e||(e=new Cn(t,n),n.UW.push(e)),e.rQ()},e.prototype.wW=function(t){var n=this,e=n.MZ;if(e)if(1===e.displayMode()){if(e.commentState()===_.edit)return}else if(e.commentState()===_.edit||e.commentState()===_.active)return;t!==n.PW&&(n.PW&&n.NK(n.PW),t&&2===t.displayMode()?n.RW.BW||t.BK||((n.PW=t).BK=vt.setTimeout(function(){n.$c(t)},200)):n.PW=h)},e.prototype.NK=function(t){var n=this,e=n.mW(t);e&&e.LQ()&&(e.lQ(),t===n.MZ)&&n.Mf.cR(),clearTimeout(t.BK),delete t.BK},e.prototype.LK=function(){var t=this.Mf.pW&&this.Mf.pW();t&&(0,A.GC$)(t.YW).show()},e.prototype.FK=function(){var t=this.Mf.pW&&this.Mf.pW();t&&(0,A.GC$)(t.YW).hide()},e.prototype.PK=function(t,n,e){var t,t,t=this.mW(t);return!(!t||!(t=t.pK()))&&t.contains(n,e)},e.prototype.GK=function(t,n,e){var t,t,t=this.mW(t);return!(!t||!(t=t.bK()))&&t.contains(n,e)},e.prototype.hitTest=function(t,n){for(var e,i,r,o,e=this,i=h,r=0;r<e.wB.length;r++)o=e.wB[r],xn(e.Mf,o)&&e.PK(o,t,n)&&(!i||o.zIndex()>i.zIndex())&&(i=o);return i?{x:t,y:n,comment:i,area:e.GK(i,t,n)?zt:Vt}:h},e.prototype.nK=function(t){var n=this,e=n.RK();return t===n.PW?e+2:t===n.MZ?e+1:t.zIndex()},e.prototype.jK=function(){this.UW.forEach(function(t){t.TQ()})},e.prototype.fromJSON=function(t,n){var e,i,r,o,e=this;if(t&&0!==t.length){for(i=e.GW=0;i<t.length;i++)r=t[i],(o=new gn).fromJSON(r,n),3!==o.commentState()&&(e.MZ=o),e.Mf.Ut.pI.WB(o.bZ,o.yZ,o,!0);e.Mf.zw()}},e.prototype.yh=function(t,n,e,i){var r,o,a,u,s,c,f,l,h,r=this;if(t&&n){for(r.GW=0,o=S(t,"commentList"),a=it(n,"shape"),o=o.c_,u=0;u<o.length;u++)s=o[u],h=On(a,f=(c=new gn).bZ=A.IndexHelper.qi(s.ref),l=c.yZ=A.IndexHelper.$i(s.ref)),s.lossless&&(c.showShadow(s.lossless.showShadow),c.indicatorSize(s.lossless.indicatorSize),c.indicatorColor(s.lossless.indicatorColor),c.ignoreDefaultLocation(s.lossless.ignoreDefaultLocation),c.commentState(s.lossless.commentState)),c.yh(r.Mf,s,h,e,i),3!==c.commentState()&&(r.MZ=c),r.Mf.Ut.pI.WB(c.bZ,c.yZ,c,!0);r.Mf.zw(),r.Ffe=S(t,"authors")}},e.prototype.toJSON=function(){var t,n,e,t=this.wB;if(!t||0===t.length)return d;for(n=[],e=0;e<t.length;e++)n.push(t[e].toJSON());return 0===n.length?d:n},Sn=e,ae.prototype.L0=function(){this.Mf=h},ae.prototype.ZW=function(){var t=r(f);return(0,A.GC$)(t).addClass("gc-comment-layoutPanel"+Gt+Pt).css([o,p,b,m,v,u,It,Ut],[a,0,0,0,0,At,Lt,Ht]),t},ae.prototype.bW=function(t){var n,e,i,e,n=this;t.Ut.pI.Oy()||(e=t.Fi(),(0,A.GC$)(n.YW).css(p,e.x+e.XC).css(b,e.y+e.qC),n.Mf!==t&&(n.Mf&&(e=(i=n.Mf.Ut).pI.pZ())&&e.commentState()===_.edit&&e.commentState(_.active,!0),n.Mf=t))},ae.prototype.yW=function(t,n,e){var i,r,o,a,u,e,s,n,s,i,i=e.row,r=e.col,o=e.x,a=e.y,u=R(e),e=O(e),s=this;n===A.SheetArea.viewport&&s.Mf&&(n=s.Mf.Ut.pI.get(i,r))&&(s=this.Mf,i=(n.indicatorSize()||6)*(s?s.zoom():1),t)&&0<u&&0<e&&(t.save(),t.rect(o,a,u,e),t.clip(),t.fillStyle=n.indicatorColor()||"red",t.beginPath(),t.moveTo(o+u-i,a),t.lineTo(o+u,a),t.lineTo(o+u,a+i),t.lineTo(o+u-i,a),t.fill(),t.restore())},ae.prototype.WW=function(t){var n,e,i,r,o,a,a;if(this.VW){for(t.LK(),n=this.Mf,e=t.all(),i=0;i<e.length;i++)r=e[i],o=t.mW(r),this.UK(t,r)?(1===r.displayMode()&&r===t.PW&&(t.PW=h),o&&o.LQ()?o.fQ():t.$c(r)):o&&o.LQ()&&t.NK(r);(a=t.pZ())&&(a=t.mW(a))&&a.LQ()&&0<n.getSelections().length&&n.Ut.do("clearSelection")}else t.FK()},ae.prototype.UK=function(t,n){var e=t.Mf;if(e&&Wn(e,n.yZ)&&Zn(e,n.bZ))switch(n.displayMode()){case 1:return!0;case 2:if(3!==n.commentState())return t&&n!==t.PW&&(t.PW=n),!0;if(n===t.PW)return!0}return!1},Tn=ae,n=s.Y8,s.GC$.extend(n.prototype,{MW:function(t){var n,e,n=this.G8;n&&(e=(e=n.commentChanges)||(n.commentChanges=[])).push(t)},HK:function(t,n){var e,i,r,o,a,u,u,s,e,i=this.pI;if(t)for(r=0;r<t.length;r++)a=(o=t[r]).comment,"add"===o.type?((u=new gn).fromJSON(a),(a=u).commentState(3)):a=i.get(a.rowIndex,a.colIndex),"add"===o.type?i.WB(o.row,o.col,a):"remove"===o.type?i.DK(o.row,o.col):"property"===o.type?(u=o.name,s=o.newValue,"commentState"!==u&&a[u](s)):"rowcol"===o.type&&i.EK(a,o.newRow,o.newCol);else n&&"changeComment"===n.cmd&&"commentState"!==n.propertyName&&(a=i.get(n.row,n.col))[n.propertyName](n.newValue)},zK:function(t){var n,e,i,r,o,a,u;if(t)for(e=(n=this).pI,i=t.length-1;0<=i;i--)o=(r=t[i]).comment,"add"===r.type?e.DK(r.row,r.col):"remove"===r.type?e.WB(r.row,r.col,r.comment):"property"===r.type?(a=r.name,u=r.value,o[a](u)):"rowcol"===r.type&&e.EK(o,r.row,r.col)},OL:function(t,n,e,i){for(var r,o,a,r=this,o=0;o<e;o++)for(a=0;a<i;a++)0===o&&0===a||r.getCell(t+o,n+a).comment()&&r.comments.remove(t+o,n+a)}}),n.ch("comments",{init:function(){this.pI=new Sn(this.Mf)},applyChanges:function(t){var n,e,i,t,i,n=this,e=t.command,i=t.changes,t=t.isUndo,i=i&&i.commentChanges;(i||e)&&(t?n.zK(i):n.HK(i,e))},undo:function(t){var t=t.commentChanges;t&&this.zK(t)},dispose:function(t){var n=this,t=t&&t.clearCache;n.pI&&n.pI.dispose(t),!1!==t&&(n.pI=h)}}),A.Worksheet.ch("comments",An={getUsedRange:function(t){var n,e,i;t.type&A.UsedRangeType.comment&&(i=(e=(n=this).comments).getUsedRange(),mt(t.range,i))},init:function(){var n=this;n.comments=n.Ut.pI,n.pW=function(){var t=n.parent;if(t)return t.VK||(t.VK=new Tn(t.j2())),(t.VK.Mf=n).parent.VK}},dispose:function(t){!1!==t.clearCache&&(this.pW=h,this.comments=h),dn(this,(0,A.GC$)(this.Dg()))},setHost:function(t){var n;t&&((n=this.Ut.pI)&&n.zW(),hn(t,this))},onLayoutChanged:function(t){var n,e,i,r,o,a,u;!et(t.sheetArea)&&3!==t.sheetArea||(e=(n=this).Ut.pI,i=t.changeType,r=t.row,o=t.rowCount,a=t.col,u=t.colCount,"addRows"===i?e.JO(r,o):"deletingRows"===i?e.xP(r,o):"addColumns"===i?e.qO(a,u):"deletingColumns"===i?e.NP(a,u):t.sheetArea===A.SheetArea.viewport&&("clear"===i?4==(4&t.type)&&e.clear(new s.Range(r,a,o,u)):"addSpan"===i?Hn.call(n,!0,r,a,o,u):"removeSpan"===i&&Hn.call(n,!1,r,a)))},paint:function(t){this.Ut.pI.Oy()||(zn.call(this),this.CW(t.clipRect))},paintCell:function(t){t.isPrinting||t.sheetArea!==A.SheetArea.viewport||Vn.call(this,t.ctx,t.sheetArea,t.cell)},toJson:function(t,n){var e;n&&n.ignoreStyle||(t.comments=this.Ut.pI.toJSON())},fromJson:function(t,n,e){var i,e,i;e&&e.ignoreStyle||t&&(e=n?t.commentManager:t.comments)&&this.Ut.pI.fromJSON(e,n)},lastNonNullRowAndCol:function(){var t,n,e,i,r,o,a,t=0,n=0,e=this.Ut.pI;if(e&&(i=e.UW)&&0<i.length)for(r=0,o=i.length;r<o;r++)(a=i[r])&&a.TZ&&(a.RQ>t&&(t=a.RQ),a.jQ>n)&&(n=a.jQ);return{lastNonNullRow:t,lastNonNullCol:n}},clearSelection:function(){this.Ut.pI.CZ()},processKeyDown:function(t){var n=this,e=n.Ut.pI.pZ();e&&n.rt.Pi(t.e)&&Nn(n,e)&&(e.commentState(2,!0),t.r=!0)},yh:function(t,n,e){var i,t,r,r,o,i,a,u,s,c,f,o,t,l,i=S(t,"legacyDrawing"),t=t.rels,r=e&&!1===e.includeStyles;if(i&&!r){for(r=this,o=t.c_,i=i&&i["r:id"],u=0,s=o;u<s.length;u++)if(0<(f=(c=s[u]).Target).indexOf(bt)){a=f.split("/").pop().slice(0,-4);break}o=A.Util.Gr(t,i,n),t=n.comments&&n.comments[a],(l=r.comments).yh(t,o,e,n)}},wh:function(t,n,e){var e,i,r,i,o,a;!t||e&&!1===e.includeStyles||(e=t.rels,i=this.comments&&this.comments.all(),r=this.parent.Cp,e&&i&&0<i.length&&(i=ft(e),a=this.wp,e.c_.push({n_:pt,Id:o=gt+i,Type:A.RelationshipConstants.hc,Target:"../"+A.XFileConstants.ou+a+"."+A.XFileConstants.Cr}),A.Util.Hr(t,r)))}}),s.Workbook.ch("comments",In={init:function(){P.SZ(this.commandManager())},dispose:function(){this.VK&&(this.VK.L0(),this.VK=h)},wh:function(t,n,e){var i,r,o,a,u,s,c,f,u,l,h,d,v,m,i,r=this.sheets;if(!e||!1!==e.includeStyles)for(o=0;o<r.length;o++)if(a=r[o],u=lt(t,a.name()),(c=(s=a.comments)&&s.all())&&0<c.length)for((f=A.Util.Ur(t,u)).c_.push({n_:"shapetype",id:"_x0000_t202",coordsize:"21600,21600",spt:"202",path:"m,l,21600r21600,l21600,xe",c_:[{n_:"stroke",joinstyle:"miter"},{n_:"path",gradientshapeok:"t","o:connecttype":"rect"}]}),u=s.Ffe||{n_:"authors",c_:[{n_:"author",c_:["Author"]}]},l=t[bt+a.wp]={n_:bt,r_:[13,14,15,16],c_:[u,{n_:"commentList",c_:[]}]},h=A.Util.qr(a.wp,f),d=0;d<c.length;d++)(m=(v=c[d]).wh(h)).commentData&&(m.commentData.lossless={showShadow:v.showShadow(),indicatorSize:v.indicatorSize(),indicatorColor:v.indicatorColor(),ignoreDefaultLocation:v.ignoreDefaultLocation(),commentState:v.commentState()}),h++,f.c_.push(m.vmlDrawingData),l.c_[1].c_.push(m.commentData)}})},"./dist/plugins/conditional/conditional.entry.js":function(t,n,e){"use strict";var i,r,i=this&&this.__createBinding||(Object.create?function(t,n,e,i){void 0===i&&(i=e);var r=Object.getOwnPropertyDescriptor(n,e);r&&("get"in r?n.__esModule:!r.writable&&!r.configurable)||(r={enumerable:!0,get:function(){return n[e]}}),Object.defineProperty(t,i,r)}:function(t,n,e,i){t[i=void 0===i?e:i]=n[e]}),r=this&&this.__exportStar||function(t,n){for(var e in t)"default"===e||Object.prototype.hasOwnProperty.call(n,e)||i(n,t,e)};Object.defineProperty(n,"__esModule",{value:!0}),r(e("./dist/plugins/conditional/conditional.js"),n),r(e("./dist/plugins/conditional/conditional.ns.js"),n)},"./dist/plugins/conditional/conditional.js":function(E,p,t){"use strict";var j,O,R,B,n,L,C,Q,F,P,G,U,H,z,o,b,J,g,S,K,X,q,$,tt,nt,et,it,rt,ot,at,ut,st,ct,t,ft,lt,ht,dt,T,vt,y,A,mt,gt,pt,bt,yt,wt,Mt,w,Ct,St,Tt,At,It,xt,t,Nt,kt,Dt,_t,Et,jt,Ot,V,Rt,Bt,Lt,Ft,Pt,Y,Gt,Ut,Ht,zt,Vt,Yt,n,Zt,Wt,Qt,Jt,n,Kt,Xt,e,qt,I,$t,tn,nn,en,rn,d,on,an,un,sn,cn,x,fn,N,ln,hn,dn,vn,mn,gn,v,pn,f,l,h,bn,yn,wn,Mn,Cn,Sn,Tn,An,In,xn,Nn,M,e,i,kn,Dn,_n,En,k,i,jn,On,Rn,i,Bn,Ln,i,Fn,Pn,Gn,i,Un,Hn,zn,Vn,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,Yn,e,e,i,Zn,Wn,Qn,Jn,Kn;function Xn(t){return Ct(St(t))}function Z(t){return t.rowCount}function W(t){return t.colCount}function qn(t){return""===t.trim()}function $n(t){return""===t}function te(t,n,e,i){switch(i&&"string"==typeof n&&"string"==typeof e&&(n=n.toLowerCase(),e=e.toLowerCase()),t){case $t.equalsTo:return n===e;case $t.notEqualsTo:return n!==e;case $t.greaterThan:return e<n;case $t.greaterThanOrEqualsTo:return e<=n;case $t.lessThan:return n<e;case $t.lessThanOrEqualsTo:return n<=e;default:return!1}}function ne(t){var n,e,n={},e;return rt.YK(t,n)?n.value:typeof t===X&&t.toLowerCase()===q}function r(t,n){var e,i,e=(n=n||{}).formula;(i=this).offsetRow=0,i.offsetCol=0,i.conType("string"==typeof t?v[t]:t),T(n.compareType)||i.ZK(n.compareType),T(n.expected)||i.expected(n.expected),T(e)||i.formula("string"==typeof e?ft(b.trim(e),"="):e),T(n.item1)||i.item1(n.item1),T(n.item2)||i.item2(n.item2),T(n.customValueType)||i.customValueType(n.customValueType),T(n.type)||i.type(n.type),i.ranges(n.ranges),i.WK=g,i.QK=g}function ee(t,n,e,i,r,o,a,u,s){var c=Math.round;switch(t.lineWidth=1,t.rect(o,a,u,s),e=c(++e),i=c(i),t.clip(),n.iconSetType){case 10:case 15:case 1:case 11:case 16:case 0:F.drawArrows(t,n.iconSetType,n.iconIndex,e,i,r);break;case 2:F.drawIconTypeIsTwo(t,n.iconSetType,n.iconIndex,e,i,r);break;case 3:F.drawStar(t,n.iconSetType,n.iconIndex,e,i,r);break;case 14:case 12:case 5:F.drawCircle(t,n.iconSetType,n.iconIndex,e,i,r);break;case 4:F.drawFlag(t,n.iconSetType,n.iconIndex,e,i,r);break;case 6:F.drawTrafficLight(t,n.iconSetType,n.iconIndex,e,i,r);break;case 7:F.drawIconTypeIsSen(t,n.iconSetType,n.iconIndex,e,i,r);break;case 8:F.drawIconTypeIsEight(t,n.iconSetType,n.iconIndex,e,i,r);break;case 9:F.drawIconTypeIsNine(t,n.iconSetType,n.iconIndex,e,i,r);break;case 18:F.drawSector(t,n.iconSetType,n.iconIndex,e,i,r);break;case 17:case 13:F.drawSignal(t,n.iconSetType,n.iconIndex,e,i,r);break;case 19:F.drawMagicCube(t,n.iconSetType,n.iconIndex,e,i,r)}}function ie(t,n,e){var i,r,o,a,u,i=[],r=t.row,o=t.rowCount,a=t.col,u=t.col+t.colCount-1;return a<n?n<=u&&u<=e?(i[0]=V(r,a,o,n-a),i[1]=V(r,n,o,u-n+1)):e<u&&(i[0]=V(r,a,o,n-a),i[1]=V(r,n,o,e-n+1),i[2]=V(r,e+1,o,u-e)):a<=e&&(n<=u&&u<=e?i[1]=t:e<u&&(i[1]=V(r,a,o,e-a+1),i[2]=V(r,e+1,o,u-e))),i}function re(t,n,e){var i,r,o,a,u,i=[],r=t.col,o=t.colCount,a=t.row,u=t.row+t.rowCount-1;return a<n?n<=u&&u<=e?(i[0]=V(a,r,n-a,o),i[1]=V(n,r,u-n+1,o)):e<u&&(i[0]=V(a,r,n-a,o),i[1]=V(n,r,e-n+1,o),i[2]=V(e+1,r,u-e,o)):a<=e&&(n<=u&&u<=e?i[1]=t:e<u&&(i[1]=V(a,r,e-a+1,o),i[2]=V(e+1,r,u-e,o))),i}function a(t,n,e){var i=this;i.KK=!0,i.ruleType(t),i.style(n),i.ranges(e)}function oe(t,n){return t===I.cellValueRule&&(n===en.between||n===en.notBetween)}function ae(t,n,e){var n,i,r,n;if(t&&n&&!(!(n=n[0])||n.row<0||n.col<0)){if(i=C.IndexHelper.nr(n.col)+(n.row+1),r="",r=n.rowCount===C.XmlConstants.Io?o("${0}:${1}",[C.IndexHelper.nr(n.col),C.IndexHelper.nr(n.col+n.colCount-1)]):n.colCount===C.XmlConstants.xo?o("${0}:${1}",[n.row+1,n.row+n.rowCount]):o("${0}${1}:${2}${3}",[C.IndexHelper.nr(n.col),n.row+1,C.IndexHelper.nr(n.col+n.colCount-1),n.row+n.rowCount]),n=Se(e),"top10"===t.type)return t.bottom?t.percent?o("IF(INT(COUNT({0})*{1}%)>0,SMALL({0},INT(COUNT({0})*{1}%)),MIN({0}))>={2}",[r,t.rank,i]):o("SMALL(({0}),MIN({1},COUNT({0})))>={2}",[r,t.rank,i]):t.percent?o("IF(INT(COUNT({0})*{1}%)>0,LARGE({0},INT(COUNT({0})*{1}%)),MIN({0}))<={2}",[r,t.rank,i]):o("LARGE(({0}),MIN({1},COUNT({0})))<={2}",[r,t.rank,i]);if("containsText"===t.type)return o('NOT(ISERROR(SEARCH("{0}",{1})))',[n,i]);if("notContainsText"===t.type)return o('ISERROR(SEARCH("{0}",{1}))',[n,i]);if("beginsWith"===t.type)return o('LEFT({0},{1}) = "{2}"',[i,e.length,n]);if("endsWith"===t.type)return o('RIGHT({0},{1}) = "{2}"',[i,e.length,n]);if("duplicateValues"===t.type)return o("AND(COUNTIF({0},{1})>1,NOT(ISBLANK({1})))",[r,i]);if("uniqueValues"===t.type)return o("AND(COUNTIF({0},{1})=1,NOT(ISBLANK({1})))",[r,i]);if("aboveAverage"===t.type||"belowAverage"===t.type||"aboveOrEqualToAverage"===t.type||"belowOrEqualToAverage"===t.type){if("aboveAverage"===t.type&&T(t.stdDev))return o("{0}>AVERAGE({1})",[i,r]);if(!T(t.aboveAverage)){if(!(T(t.equalAverage)||t.aboveAverage||T(t.equalAverage))&&t.equalAverage&&T(t.stdDev))return o("{0}<=AVERAGE({1})",[i,r]);if(!t.aboveAverage&&T(t.stdDev))return o("{0}<AVERAGE({1})",[i,r])}if(!T(t.equalAverage)&&t.equalAverage&&T(t.stdDev))return o("{0}>=AVERAGE({1})",[i,r]);if(!T(t.stdDev))return T(t.aboveAverage)||t.aboveAverage?o("({0}-AVERAGE({1}))>=STDEVP({1})*({2})",[i,r,t.stdDev]):o("({0}-AVERAGE({1}))<=STDEVP({1})*(-{2})",[i,r,t.stdDev])}}return null}function ue(t){return t&&t.font&&0===t.font.indexOf("normal normal")&&delete t.font,t}function u(t,n,e,i,r,o,a,u,s,c){var t,e,t=Zn.call(this,t,e)||this,e=t;return e.ranges(n),e.operator(i),e.value1("string"==typeof r?b.trim(r):r),e.value2("string"==typeof o?b.trim(o):o),e.text(a),e.formula(u),e.type(s),e.rank(c),e.cached=!1,e.JK=g,t}function se(t,n,e,i){var n,n,e,n=n.ranges(),n=Dt(n),e=Q.formulaToExpression(t,e,n.r,n.c,i);return Q.expressionToFormula(t,e,n.r,n.c,!i)}function ce(t,n){this.type=t,this.value=n}function s(t,n,e,i,r,o,a,u,s,c,f){var t,f,n,e,i,r,o,a,u,s,c,t=Wn.call(this,t,g,f)||this,f=t;return f.KK=!1,f.lowestValueCached=g,f.highestValueCached=g,f.XK={},f.cached=!1,f.JK=g,n=n,e=e,i=i,r=r,o=o,a=a,u=u,s=s,c=c,arguments.length<=1&&(n=1,e=g,i=Ot(255,248,105,107),r=4,o=50,a=Ot(255,255,235,132),u=2,s=g,c=Ot(255,99,190,123)),f.minColor(i),f.minValue(e),f.minType(n),f.midColor(a),f.midValue(o),f.midType(r),f.maxColor(c),f.maxValue(s),f.maxType(u),t}function fe(t){return t.c_[0]&&t.c_[0].c_[0]&&t.c_[0].c_[0].c_[0]}function c(t,n,e,i,r,o){var a,t,n,e,i,r,a=this,t=t,n=n,e=e,i=i,r=r;return 0===arguments.length&&(t=5,e=7,i=n=g,r=Ot(255,99,142,198)),(a=Qn.call(this,12,t,n,g,g,g,g,e,i,g,o)||this).KK=!1,a.Hc(r),a}function le(t,n,e){this.isGreaterThanOrEqualTo=t,this.iconValueType=n,this.iconValue=e}function m(t,n){var e,t,e=this,t=0===arguments.length?0:t;return(e=Jn.call(this,13,g,g,g)||this).KK=!1,e.ranges(n),e.Hc(t),e}function he(t){return t="string"==typeof t&&"="!==t[0]?'="'+J.Vi(t,'"','""')+'"':t}function D(t,n,e,i){var t,i,t=Kn.call(this,t,S,i)||this,i=t;return i.style(e),i.state(n),t}function _(t){this.qK=[],this.$K=g,this.tJ={},this.nJ=!0,this.eJ=t}function de(t,n){if(n)for(var e=0;e<n.length;e++)t.push(n[e])}function ve(t){for(var n,e,i,r,o,a,n=Y(t),e=0;e<n;e++)if(r=(i=t[e]).ranges)for(o=0;o<r.length;o++)if(1e3<(a=r[o]).rowCount)return 1}function me(t){for(var n,e,i,r,o,a,n=Y(t),e=0;e<n;e++)if(r=(i=t[e]).ranges())for(o=0;o<r.length;o++)if(1e3<(a=r[o]).rowCount)return 1}function ge(t){for(var n,e,i,r,n=[],e=Y(t),r=0;r<e;r++)i=t[r],n.push(V(i.row,i.col,Z(i),W(i)));return n}function pe(t,n){for(var e,i,e=0;e<t.length;e++)if((i=t[e])&&i.equals(n))return 1}function be(t,n){for(var e,i,r,o,e=!0,i=!0,r=!0,o=0;o<n.length;o++)if(n[o].iconSetType!==t){e=!1;break}for(o=0;o<n.length;o++)if(n[o].iconIndex!==o){i=!1;break}for(o=0;o<n.length;o++)if(n[o].iconIndex!==n.length-1-o){r=!1;break}return!e||!i&&!r}function ye(t){return!(!t.ruleType||t.ruleType()!==I.dataBarRule)}function we(t){var n;if(t.ruleType()===I.iconSetRule)return 3===(n=t.iconSetType())||2===n||19===n||be(n,t.iJ)}function Me(t){return t.ruleType()===I.rowStateRule||t.ruleType()===I.columnStateRule}function Ce(t){var n,e,i,n,e=/</g,i=/>/g;return"string"==typeof t?t.replace(/&/g,"&amp;").replace(e,"&lt;").replace(i,"&gt;"):T(t)?t:""+t}function Se(t){return"string"==typeof t?t.replace(/"/g,'""'):T(t)?t:""+t}function Te(t){var t=t.c_&&t.c_[0];if(t)return yt(t,"cfvo")}function Ae(t){var t,t,t=t.c_&&t.c_[0];return t&&(t=yt(t,"color"))&&0<t.length?t.map(function(t){return Mt(t)}):[]}function Ie(t,n,e){switch(t){case"cellIs":return En[n];case"containsText":return rn.contains;case"beginsWith":return rn.beginsWith;case"endsWith":return rn.endsWith;case"notContainsText":return rn.doesNotContain;case"timePeriod":return x[e]}}function xe(t,n,e){var i,r,o;switch(t){case I.cellValueRule:return i={type:"cellIs"},T(e)||(i.operator=En[e]),i;case I.specificTextRule:return r="containsText",o="contains",2===e?o=r="beginsWith":3===e?o=r="endsWith":1===e?(r="notContainsText",o="notContains"):0===e&&(o="containsText"),i={type:r,operator:o};case I.formulaRule:return i={type:"expression"},T(e)||(i.operator=e),i;case I.dateOccurringRule:return i={type:"timePeriod"},T(n)||(i.timePeriod=_n[n]),i;case I.top10Rule:return i={type:"top10"},T(e)||(i.operator=e),i;case I.uniqueRule:return i={type:"uniqueValues"},T(e)||(i.operator=e),i;case I.duplicateRule:return i={type:"duplicateValues"},T(e)||(i.operator=e),i;case I.averageRule:return i={type:"aboveAverage"},T(e)||(i.operator=e),i;case I.twoScaleRule:return i={type:"colorScale"},T(e)||(i.operator=e),i;default:return}}function Ne(t){var n;return{num:0,min:1,max:2,percent:3,percentile:4,formula:6,autoMin:5,autoMax:7}[t]}function ke(t){var n;return{0:"num",1:"min",2:"max",3:"percent",4:"percentile",6:"formula",5:"autoMin",7:"autoMax"}[t]}function De(t){var n;return{"3Arrows":0,"3ArrowsGray":1,"3Flags":4,"3TrafficLights1":5,"3TrafficLights2":6,"3Signs":7,"3Symbols":8,"3Symbols2":9,"4Arrows":10,"4ArrowsGray":11,"4RedToBlack":12,"4Rating":13,"4TrafficLights":14,"5Arrows":15,"5ArrowsGray":16,"5Rating":17,"5Quarters":18,"3Stars":3,"3Triangles":2,"5Boxes":19,NoIcons:20}[t]}function _e(t){var n;return{0:"3Arrows",1:"3ArrowsGray",4:"3Flags",5:"3TrafficLights1",6:"3TrafficLights2",7:"3Signs",8:"3Symbols",9:"3Symbols2",10:"4Arrows",11:"4ArrowsGray",12:"4RedToBlack",13:"4Rating",14:"4TrafficLights",15:"5Arrows",16:"5ArrowsGray",17:"5Rating",18:"5Quarters",3:"3Stars",2:"3Triangles",19:"5Boxes",20:"NoIcons"}[t]}function Ee(t){var n,t,n,t={beginsWith:2,endsWith:2,notContainsText:2,containsText:2,expression:3,containsBlanks:3,notContainsBlanks:3,containsErrors:3,notContainsErrors:3,timePeriod:4,today:4,tomorrow:4,yesterday:4,last7Days:4,lastMonth:4,nextMonth:4,thisWeek:4,nextWeek:4,lastWeek:4,thisMonth:4,top10:5,uniqueValues:6,duplicateValues:7,aboveAverage:8,belowAverage:8,aboveOrEqualToAverage:8,belowOrEqualToAverage:8}[t];return t!==S?t:1}function je(t){var n;return{1:"num",4:"percent",5:"percentile",7:"formula"}[t]}function Oe(t){var n;return{num:1,percent:4,percentile:5,formula:7}[t]}function Re(t){return"lowestValue"===t||"highestValue"===t}function Be(t){return"string"==typeof(t=St(t))&&"="!==t.charAt(0)?"="+t:t}function Le(t,n){for(var e,i,r,e=0,i=t.length;e<i;e++)if(r=t[e].rJ,!T(r)&&r===n)return t[e]}function Fe(t,n){var e;return T(t.val)?T(n)||(e=z(St(n.c_&&n.c_[0]))):e=t.val,e}function Pe(t,n){if(10===t){if(3===n)return{iconSetType:0,iconIndex:2};if(0===n)return{iconSetType:0,iconIndex:0}}else if(15===t){if(4===n)return{iconSetType:0,iconIndex:2};if(0===n)return{iconSetType:0,iconIndex:0};if(2===n)return{iconSetType:0,iconIndex:1};if(3===n)return{iconSetType:10,iconIndex:2};if(1===n)return{iconSetType:10,iconIndex:1}}else if(11===t){if(3===n)return{iconSetType:1,iconIndex:2};if(0===n)return{iconSetType:1,iconIndex:0}}else if(16===t){if(4===n)return{iconSetType:1,iconIndex:2};if(0===n)return{iconSetType:1,iconIndex:0};if(2===n)return{iconSetType:1,iconIndex:1};if(3===n)return{iconSetType:11,iconIndex:2};if(1===n)return{iconSetType:11,iconIndex:1}}else if(14===t){if(3===n)return{iconSetType:5,iconIndex:2};if(2===n)return{iconSetType:5,iconIndex:1};if(1===n)return{iconSetType:5,iconIndex:0}}else if(13===t){if(0===n)return{iconSetType:17,iconIndex:1};if(1===n)return{iconSetType:17,iconIndex:2};if(2===n)return{iconSetType:17,iconIndex:3};if(3===n)return{iconSetType:17,iconIndex:4}}return{iconSetType:t,iconIndex:n}}j=this&&this.__extends||(Vn=function(t,n){return(Vn=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(t,n){t.__proto__=n}:function(t,n){for(var e in n)Object.prototype.hasOwnProperty.call(n,e)&&(t[e]=n[e])}))(t,n)},function(t,n){if("function"!=typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function e(){this.constructor=t}Vn(t,n),t.prototype=null===n?Object.create(n):(e.prototype=n.prototype,new e)}),Object.defineProperty(p,"__esModule",{value:!0}),p.ConditionalFormats=p.StateRule=p.IconSetRule=p.IconCriterion=p.DataBarRule=p.ScaleRule=p.ScaleValue=p.NormalConditionRule=p.ConditionRuleBase=p.Condition=p.oJ=p.aJ=p.ConditionType=p.IconValueType=p.IconSetType=p.DataBarAxisPosition=p.BarDirection=p.ScaleValueType=p.AverageConditionType=p.QuarterType=p.DateOccurringType=p.Top10ConditionType=p.DateExConditionExpectType=p.DateCompareType=p.CustomValueType=p.ColorCompareType=p.TextCompareType=p.TextComparisonOperators=p.ComparisonOperators=p.LogicalOperators=p.GeneralComparisonOperators=p.RuleType=void 0,O=t("Common"),R=t("Core"),B=t("CalcEngine"),n=t("./dist/plugins/conditional/conditional.ns.js"),L=t("CalcEngine"),C=t("Core"),Q=t("SheetsCalc"),F=t("./dist/plugins/conditional/conditionalFormatIcon.js"),P=C.UsedRangeUtil.vh,G=C.UsedRangeUtil.hh,U=C.XFileConstants.Au,H=C.XFileConstants.ju,z=C.Util.mr,o=O.Common.zf.I5,b=R.GC$,J=O.Common.zf,g=null,S=void 0,K="undefined",X="string",q="true",$=Math.min,tt=Math.max,nt=Math.abs,et=Math.floor,it=Math.ceil,rt=B.Convert,ot=rt.q8,at=rt.uJ,ut=rt.sJ,st=String.fromCharCode(32),ct=String.fromCharCode(160),t=O.Common.zf,ft=t.cJ,lt=t.fJ,ht=t.dT,dt=t.OS,T=O.Common.lt.ht,vt=O.Common.$T,y=O.Common.ut,A=R.mt,mt=A.t1,gt=C.mt.getFormulaString,pt=A.vo,bt=C.IndexHelper.nr,yt=A.go,wt=A.h1,Mt=A.d1,w=A.xr,Ct=A.g1,St=A.n1,Tt=A.Lue,At=A.c1,It=C.range_parser.Dc,xt=C.range_parser.getRangeString,t=R.$e,Nt=A.G0,kt=A.C1,Dt=A.z0,_t=!!B,Et=R.Style,jt=O.Common.ft,Ot=jt.j,V=R.Ec,Rt=R.Range,Bt=O.Common.ct,Lt=O.Common.Uf,Ft=Lt.VP,Pt=Lt.hD,Y=Lt.tR,Gt=B.Functions,Ut=B.evaluateOperator,Ht=R.Pf,zt=C.Util.no,Vt=Array.isArray,Yt=C.NodeHelper.ur,n=new O.Common.ResourceManager(n.SR,"ConditionalFormatting"),Zt=n.getResource.bind(n),Wt=function(t){return/[\f\n\r\t\v]/.test(t)},Qt=function(t){var n,e,n=t.row<0?Q.BAND_INDEX_CONST:t.row,e=t.col<0?Q.BAND_INDEX_CONST:t.col;return(0,L.lJ)(g,g,n,e,n+t.rowCount-1,e+t.colCount-1)},Jt=function(t){var n;if(t instanceof B.Expression)n=t;else if(t instanceof Rt)n=Qt(t);else{if(!ot(t))throw Zt().Exp_NotSupport;t=at(t),isNaN(t)||((n=new B.Expression(2)).value=t)}return n},n=function(t,n,o,a){var u,s,t,u=t,s=n,t=function(t,n){var e,i,r,e=this;return e.hasOwnProperty("_ps")||(e._ps={}),i=e._ps,0===arguments.length?i[u]!==S?a?a.call(e,i[u]):i[u]:s:(i[u]!==t&&(r=i[u]!==S?i[u]:s,i[u]=t,!1!==n)&&o&&o.call(e,t,r),e)};return t.isDefault=function(t){return t===s},t},Kt=function(o,t,a){var u=this;return a=a||{},t=t||u,T(u.pivotTableName)||(a.pivot=!0),b.each(t,function(t,n){var e,i,r,e=u[n];T(e)||(i=e.call(u),"formula"===n?(u.getFormulaString?i=u.getFormulaString(o,S,S,!0):u.condition()&&u.condition().getFormulaString&&(i=u.condition().getFormulaString(o,S,S,!0)),i&&(a[n]=i)):"style"===n&&Vt(i)?(r=i.map(function(t){return t.toJSON()}),a[n]=r):"iconCriteria"===n||"icons"===n?a[n]=i:Bt.W0(i)?a[n]=Bt.Q0(i):i&&i.toJSON?a[n]=i.toJSON(o):T(i)||e.isDefault(i)||(a[n]=i))}),a},Xt=function(h,t,d,v){var m,g;d&&(m=this,b.each(t=t||m,function(t,n){var e,i,r,o,a,u,s,c,f,l,o;if(g=d[n],!T(g))if("ranges"===n){for(e=[],i=0;i<g.length;i++)r=g[i],e.push(V(r.row,r.col,Z(r),W(r)));m.ranges(e,!1)}else if("style"===n)Vt(g)?(o=g.map(function(t){var n=new Et;return n.fromJSON(t,v),n}),m.style(o)):(m.style(new Et,!1),m.style().fromJSON(g,v));else if("iconCriteria"===n)for(a=g.length,u=0;u<a;u++)s=g[u],m.hJ[u]=new Fn(s.isGreaterThanOrEqualTo,s.iconValueType,s.iconValue);else if("icons"===n)for(c=g.length,f=0;f<c;f++)l=g[f],m.iJ[f]={iconSetType:l.iconSetType,iconIndex:l.iconIndex};else"iconSetType"===n?m[n](g,!0):"item1"===n||"item2"===n?(m[n]((0,p.aJ)(),!1),m[n]().fromJSON(g,h)):"expected"===n?b.getType(g)!==X||5!==d.conType&&13!==d.conType?m[n](g,!1):"/OADate("===g.substr(0,8)?m[n](Bt.dJ(g),!1):m[n](new Date(g)):"condition"===n?((o=new M).fromJSON(g,h),m.condition(o,!1)):b.getType(g)===X&&"/OADate("===g.substr(0,8)?m[n](Bt.dJ(g),!1):m[n](g,!1)}))},e=R.Y8,b.extend(e.prototype,{vJ:function(t){var n,e,n,n=this,e=n.G8;!e||!t&&e.originalConditionalRules||(n=n.mJ.qK.map(function(t){return{rule:t,ranges:t.ranges().slice()}}),t?e.currentConditionalRules=n:e.originalConditionalRules=n)},gJ:function(t){var i=this.mJ,r=this.Mf;r.suspendPaint(),t&&(0===t.length&&i.qK&&1===i.qK.length&&i.constructor.et(r,"onRuleUpdated",{ranges:i.qK[0].ranges()}),i.qK=t.map(function(t){var n,e,n=t.rule,e=t.ranges;return"Object"===n.constructor.name&&(n=i.pJ(t.rule,r,!1),e=e.map(function(t){return new Rt(t.row,t.col,t.rowCount,t.colCount)})),n.ranges(e),i.constructor.et(r,"onRuleUpdated",{ranges:n.ranges()}),n}),i.C8()),r.resumePaint()},bJ:function(t,n,e,i){this.vJ(),this.mJ.JO(t,n,e,i),this.vJ(!0)},yJ:function(t,n,e,i){this.vJ(),this.mJ.xP(t,n,e,i),this.vJ(!0)},wJ:function(t,n,e,i){this.vJ(),this.mJ.qO(t,n,e,i),this.vJ(!0)},MJ:function(t,n,e,i){this.vJ(),this.mJ.NP(t,n,e,i),this.vJ(!0)},CJ:function(){this.vJ(),this.mJ.dl(),this.vJ(!0)},SJ:function(){this.vJ(),this.mJ.C8()}}),e.ch("conditionalFormat",{init:function(){this.mJ=new zn(this.Mf)},applyChanges:function(t){var n,t,t,n=t.changes,t=t.isUndo;n&&(t=t?n.originalConditionalRules:n.currentConditionalRules)&&this.gJ(t)},undo:function(t){var t=t.originalConditionalRules;t&&this.gJ(t)},dispose:function(t){var n=this,e;!1!==(t&&t.clearCache)&&n.mJ&&(n.mJ.L0(),n.mJ=g)}}),R.Worksheet.ch("conditionalFormat",qt={init:function(){this.conditionalFormats=this.Ut.mJ},getUsedRange:function(t){var n,e,i;t.type&C.UsedRangeType.conditionFormat&&(i=(e=(n=this).conditionalFormats).getUsedRange(),P(t.range,i))},dispose:function(t){var t;!1!==t.clearCache&&(t=this.conditionalFormats)&&t.TJ()},onLayoutChanged:function(t){var n,e,i,r,o,t,a,u,s,n=t.changeType,e=t.row,i=Z(t),r=t.col,o=W(t),t=t.sheetArea,a=T(t)||t===C.SheetArea.viewport,u=this.Ut,s=this.tables;"addRows"===n&&a?u.bJ(e,i,s&&s.AJ(e,-1,i,-1,!0),!1):"deleteRows"===n&&a?u.yJ(e,i):"addColumns"===n&&a?u.wJ(r,o):"deleteColumns"===n&&a?u.MJ(r,o):"clear"===n?u.CJ():"setColumnCount"!==n&&"setRowCount"!==n||3!==t&&1!==t||u.SJ()},toJson:function(t,n){var e,n,e=this.conditionalFormats,n=n&&n.ignoreStyle;e&&!n&&(t.conditionalFormats=e.toJSON(this))},fromJson:function(t,n,e){var e=e&&e.ignoreStyle;t&&t.conditionalFormats&&!e&&this.conditionalFormats.fromJSON(t.conditionalFormats,this,n,!0)},wh:function(t,n,e){var i,r,o,a,u,s,c,f,l,h,d,v,m,g,p,g,r,b,i=this,r=e&&!1===e.includeStyles,o=i.conditionalFormats;if(!r&&o&&Q&&!i.NMi&&(a=o.qK)&&0<a.length){for(u=n.styleManager,s=t.c_,c=[],h=l=f=void 0,d=0,v=a.length;d<v;d++)g=(m=a[d]).ruleType(),p=!0,we(m)||ye(m)?(c.push(m.IJ()),we(m)&&(p=!1)):g===I.formulaRule&&A.e1(m.D5,i.name(),i.parent&&i.parent.r4())&&(f||(l=new C.SimpleSharedStrings,h=new C.SimpleSharedStrings,f=new C.SharedDxfs(l,h)),c.push(m.IJ(f)),p=!1),Me(m)?(t.lossless||(t.lossless={}),t.lossless.stateRules||(t.lossless.stateRules=[]),t.lossless.stateRules.push(m.toJSON())):p&&((g=m.wh(u,void 0,void 0,e,i)).lossless?(t.lossless.dateOccurringRules||(t.lossless.dateOccurringRules=[]),t.lossless.dateOccurringRules.push(g.lossless)):s.push(g));0<c.length&&((r=w(t,U)).c_.push(b={n_:"ext",r_:[1,3],c_:[{n_:"conditionalFormattings",c_:c}]}),f)&&(r.lossless={sharedDxfs:f.iv(),sharedColors:l.wh(),commonSharedStrings:h.wh()})}},yh:function(t,r,o){var a,n,u,s,c,n,e,i,f,l,a=this,n=o&&!1===o.includeStyles,u=this.conditionalFormats,s=u.qK,c=C.Util.Co(o);if(Q&&u&&!n){for(n=yt(t,H),e=w(t,U),i=Tt(e,"conditionalFormattings"),f=r.styleManager,n&&0<n.length&&n.forEach(function(t){var e,i,n,e=C.NodeHelper.ur(t.pivot),i=It(t.sqref);c&&C.Util.Ao(a,i,!0,r),(n=t.c_).forEach(function(t){var n=u.xJ(t,i,f,a,o);n&&(n.pivot=e,T(t.priority)||n.priority(+t.priority),s.push(n))})}),u.NJ(i,r,a,s,e,c),l=s.length-1;-1<l;l--)s[l].pivot&&s.splice(l,1);t.lossless&&t.lossless.stateRules&&0<t.lossless.stateRules.length&&t.lossless.stateRules.forEach(function(t){var n=new Hn;n.fromJSON(t,a),u.qK.push(n)}),t.lossless&&t.lossless.dateOccurringRules&&0<t.lossless.dateOccurringRules.length&&t.lossless.dateOccurringRules.forEach(function(t){var n=new k;n.fromJSON(t,a),u.qK.push(n)}),u.nJ=!me(u.qK),u.C8()}}}),R.Workbook.ch("conditionalFormat",{fromJson:function(t,n,e){this.sheets.forEach(function(t){t.conditionalFormats&&t.conditionalFormats.getRules().forEach(function(t){t.kJ()})})},onCultureChanged:function(){Zt()}}),(e=I=p.RuleType||(p.RuleType={}))[e.conditionRuleBase=0]="conditionRuleBase",e[e.cellValueRule=1]="cellValueRule",e[e.specificTextRule=2]="specificTextRule",e[e.formulaRule=3]="formulaRule",e[e.dateOccurringRule=4]="dateOccurringRule",e[e.top10Rule=5]="top10Rule",e[e.uniqueRule=6]="uniqueRule",e[e.duplicateRule=7]="duplicateRule",e[e.averageRule=8]="averageRule",e[e.twoScaleRule=10]="twoScaleRule",e[e.threeScaleRule=11]="threeScaleRule",e[e.dataBarRule=12]="dataBarRule",e[e.iconSetRule=13]="iconSetRule",e[e.rowStateRule=14]="rowStateRule",e[e.columnStateRule=15]="columnStateRule",(e=$t=p.GeneralComparisonOperators||(p.GeneralComparisonOperators={}))[e.equalsTo=0]="equalsTo",e[e.notEqualsTo=1]="notEqualsTo",e[e.greaterThan=2]="greaterThan",e[e.greaterThanOrEqualsTo=3]="greaterThanOrEqualsTo",e[e.lessThan=4]="lessThan",e[e.lessThanOrEqualsTo=5]="lessThanOrEqualsTo",tn=[9,10,13,14,11,12],(e=nn=p.LogicalOperators||(p.LogicalOperators={}))[e.or=0]="or",e[e.and=1]="and",(e=en=p.ComparisonOperators||(p.ComparisonOperators={}))[e.equalsTo=0]="equalsTo",e[e.notEqualsTo=1]="notEqualsTo",e[e.greaterThan=2]="greaterThan",e[e.greaterThanOrEqualsTo=3]="greaterThanOrEqualsTo",e[e.lessThan=4]="lessThan",e[e.lessThanOrEqualsTo=5]="lessThanOrEqualsTo",e[e.between=6]="between",e[e.notBetween=7]="notBetween",(e=rn=p.TextComparisonOperators||(p.TextComparisonOperators={}))[e.contains=0]="contains",e[e.doesNotContain=1]="doesNotContain",e[e.beginsWith=2]="beginsWith",e[e.endsWith=3]="endsWith",(e=d=p.TextCompareType||(p.TextCompareType={}))[e.equalsTo=0]="equalsTo",e[e.notEqualsTo=1]="notEqualsTo",e[e.beginsWith=2]="beginsWith",e[e.doesNotBeginWith=3]="doesNotBeginWith",e[e.endsWith=4]="endsWith",e[e.doesNotEndWith=5]="doesNotEndWith",e[e.contains=6]="contains",e[e.doesNotContain=7]="doesNotContain",(e=on=p.ColorCompareType||(p.ColorCompareType={}))[e.backgroundColor=0]="backgroundColor",e[e.foregroundColor=1]="foregroundColor",(e=an=p.CustomValueType||(p.CustomValueType={}))[e.empty=0]="empty",e[e.nonEmpty=1]="nonEmpty",e[e.error=2]="error",e[e.nonError=3]="nonError",e[e.formula=4]="formula",(e=un=p.DateCompareType||(p.DateCompareType={}))[e.equalsTo=0]="equalsTo",e[e.notEqualsTo=1]="notEqualsTo",e[e.before=2]="before",e[e.beforeEqualsTo=3]="beforeEqualsTo",e[e.after=4]="after",e[e.afterEqualsTo=5]="afterEqualsTo",(e=sn=p.DateExConditionExpectType||(p.DateExConditionExpectType={}))[e.dateOccurring=0]="dateOccurring",e[e.yearOccurring=1]="yearOccurring",e[e.quarterOccurring=2]="quarterOccurring",e[e.monthOccurring=3]="monthOccurring",e[e.weekOccurring=4]="weekOccurring",e[e.dayOccurring=5]="dayOccurring",e[e.yearToDate=6]="yearToDate",(e=cn=p.Top10ConditionType||(p.Top10ConditionType={}))[e.top=0]="top",e[e.bottom=1]="bottom",(e=x=p.DateOccurringType||(p.DateOccurringType={}))[e.today=0]="today",e[e.yesterday=1]="yesterday",e[e.tomorrow=2]="tomorrow",e[e.last7Days=3]="last7Days",e[e.thisMonth=4]="thisMonth",e[e.lastMonth=5]="lastMonth",e[e.nextMonth=6]="nextMonth",e[e.thisWeek=7]="thisWeek",e[e.lastWeek=8]="lastWeek",e[e.nextWeek=9]="nextWeek",e[e.nextQuarter=10]="nextQuarter",e[e.thisQuarter=11]="thisQuarter",e[e.lastQuarter=12]="lastQuarter",e[e.nextYear=13]="nextYear",e[e.thisYear=14]="thisYear",e[e.lastYear=15]="lastYear",(e=fn=p.QuarterType||(p.QuarterType={}))[e.quarter1=0]="quarter1",e[e.quarter2=1]="quarter2",e[e.quarter3=2]="quarter3",e[e.quarter4=3]="quarter4",(e=N=p.AverageConditionType||(p.AverageConditionType={}))[e.above=0]="above",e[e.below=1]="below",e[e.equalOrAbove=2]="equalOrAbove",e[e.equalOrBelow=3]="equalOrBelow",e[e.above1StdDev=4]="above1StdDev",e[e.below1StdDev=5]="below1StdDev",e[e.above2StdDev=6]="above2StdDev",e[e.below2StdDev=7]="below2StdDev",e[e.above3StdDev=8]="above3StdDev",e[e.below3StdDev=9]="below3StdDev",(e=ln=p.ScaleValueType||(p.ScaleValueType={}))[e.number=0]="number",e[e.lowestValue=1]="lowestValue",e[e.highestValue=2]="highestValue",e[e.percent=3]="percent",e[e.percentile=4]="percentile",e[e.automin=5]="automin",e[e.formula=6]="formula",e[e.automax=7]="automax",(e=hn=p.BarDirection||(p.BarDirection={}))[e.leftToRight=0]="leftToRight",e[e.rightToLeft=1]="rightToLeft",(e=dn=p.DataBarAxisPosition||(p.DataBarAxisPosition={}))[e.automatic=0]="automatic",e[e.cellMidPoint=1]="cellMidPoint",e[e.none=2]="none",(e=vn=p.IconSetType||(p.IconSetType={}))[e.threeArrowsColored=0]="threeArrowsColored",e[e.threeArrowsGray=1]="threeArrowsGray",e[e.threeTriangles=2]="threeTriangles",e[e.threeStars=3]="threeStars",e[e.threeFlags=4]="threeFlags",e[e.threeTrafficLightsUnrimmed=5]="threeTrafficLightsUnrimmed",e[e.threeTrafficLightsRimmed=6]="threeTrafficLightsRimmed",e[e.threeSigns=7]="threeSigns",e[e.threeSymbolsCircled=8]="threeSymbolsCircled",e[e.threeSymbolsUncircled=9]="threeSymbolsUncircled",e[e.fourArrowsColored=10]="fourArrowsColored",e[e.fourArrowsGray=11]="fourArrowsGray",e[e.fourRedToBlack=12]="fourRedToBlack",e[e.fourRatings=13]="fourRatings",e[e.fourTrafficLights=14]="fourTrafficLights",e[e.fiveArrowsColored=15]="fiveArrowsColored",e[e.fiveArrowsGray=16]="fiveArrowsGray",e[e.fiveRatings=17]="fiveRatings",e[e.fiveQuarters=18]="fiveQuarters",e[e.fiveBoxes=19]="fiveBoxes",e[e.noIcons=20]="noIcons",(e=mn=p.IconValueType||(p.IconValueType={}))[e.number=1]="number",e[e.percent=4]="percent",e[e.formula=7]="formula",e[e.percentile=5]="percentile",Yn=gn=gn||{},gn[gn.contains=0]="contains",(e=v=p.ConditionType||(p.ConditionType={}))[e.relationCondition=0]="relationCondition",e[e.numberCondition=1]="numberCondition",e[e.textCondition=2]="textCondition",e[e.colorCondition=3]="colorCondition",e[e.formulaCondition=4]="formulaCondition",e[e.dateCondition=5]="dateCondition",e[e.dateExCondition=6]="dateExCondition",e[e.textLengthCondition=7]="textLengthCondition",e[e.top10Condition=8]="top10Condition",e[e.uniqueCondition=9]="uniqueCondition",e[e.averageCondition=10]="averageCondition",e[e.cellValueCondition=11]="cellValueCondition",e[e.areaCondition=12]="areaCondition",e[e.timeCondition=13]="timeCondition",e[e.stateCondition=14]="stateCondition",(e=pn=pn||{})[e.automatic=0]="automatic",e[e.middle=1]="middle",e[e.none=2]="none",f=function(t){return new Date(t.getFullYear(),t.getMonth(),t.getDate(),0,0,0,0)},l=function(t){return new Date(t.getFullYear(),t.getMonth(),t.getDate(),23,59,59,999)},h=function(t,n){t.setDate(n)},bn=function(t){return t.getDate()},yn=function(t,n){return t.getFullYear()===n.getFullYear()&&t.getMonth()===n.getMonth()&&t.getDate()===n.getDate()},wn=function(t,n){var e;return l(t)<n},Mn=function(t,n){return t<n},Cn=function(t,n){var e;return n<f(t)},Sn=function(t,n){return n<t},Tn=function(t,n){return t.getHours()===n.getHours()&&t.getMinutes()===n.getMinutes()&&t.getSeconds()===n.getSeconds()&&t.getMilliseconds()===n.getMilliseconds()},An=function(t,n){var e,i,e,i;return new Date(1899,11,30,t.getHours(),t.getMinutes(),t.getSeconds(),t.getMilliseconds())<new Date(1899,11,30,n.getHours(),n.getMinutes(),n.getSeconds(),n.getMilliseconds())},In=function(t,n){return!An(t,n)&&!Tn(t,n)},p.aJ=xn=function(t,n,e,i,r,o,a,u,s){return new M(t,{compareType:n,expected:e,formula:i,customValueType:r,type:o,ranges:a,item1:u,item2:s})},p.oJ=new Et,Nn=["conType","compareType","item1","item2","ignoreBlank","preciseCompareDate","expected","formula","treatNullValueAsZero","integerValue","forceValue2Text","useWildCards","ignoreCase","customValueType","expectTypeId","type","ranges","isPercent","regex"],r.prototype.context=function(t){var n,e;return 1===arguments.length&&(this.DJ=t,n=this.item1(),e=this.item2(),n&&n.context&&n.context(t),e)&&e.context&&e.context(t),this.DJ},r.prototype.U0=function(t){var n=this,e=n.item1(),i=n.item2();t?n.G3=!0:n._J=!0,e&&e.U0(t),i&&i.U0(t)},r.prototype.H0=function(){var t=this,n=t.item1(),e=t.item2();delete t.G3,delete t._J,n&&n.H0(),e&&e.H0()},r.prototype.initExpression=function(t,n,e){var i,r,i,r,r,t,o,i=this.item1(),r=this.item2();i&&i.initExpression&&i.initExpression(),r&&r.initExpression&&r.initExpression(),t=t||this.DJ,i=this.D5,t&&i&&!this.WK&&(e=this.ranges()?(n=(r=Dt(this.ranges())).r,r.c):(n=n||0,e||0),r=t.getCalcService(),t=t.Uw(),r)&&t&&(o=!1,this.G3&&(o=!this._J),this.WK=r.parse(t,i,n,e,!1,!0,o))},r.prototype.expression=function(t,n,e,i){var r,r,o;return 1===arguments.length?(this.WK=t,n=n||this.DJ,t?n&&(i=this.ranges()?(e=(r=Dt(this.ranges())).r,r.c):(e=e||0,i||0),r=n.getCalcService(),o=n.Uw(),r)&&o&&(this.D5=r.unparse(o,t,e,i)):this.D5=t):this.WK||this.initExpression(n,e,i),this.WK},r.prototype.getFormulaString=function(t,n,e,i){var r,o,a;return t=t||this.DJ,r=this.WK,o=this.D5,!t||!o||(r||(this.initExpression(t,n,e),r=this.WK),o&&(r.value&&14===r.value.type||r.value2&&14===r.value2.type))?o:(a=Dt(this.ranges()),n=T(n)?a.r:n,e=T(e)?a.c:e,t.getCalcService().unparse(t.Uw(),r,n,e,S,!!i))},r.prototype.formula=function(t,n,e){var i,r;if("string"!=typeof t)return i=this.item1(),r=this.item2(),0===e&&i&&i.formula?i.formula(t,n,e):1===e&&r&&r.formula?r.formula(t,n,e):this.getFormulaString(S,t,n);this.D5=t,this.WK=g},r.prototype.adjustOffset=function(t,n){var e,i,e=this,i=e.item1();i&&i.adjustOffset&&i.adjustOffset(t,n),(i=e.item2())&&i.adjustOffset&&i.adjustOffset(t,n),e.offsetRow=t,e.offsetCol=n},r.prototype.relationConditionEvaluate=function(i,r,o,e,t){var a,n,t,u,s;function c(t,n){var e;return i&&t&&3===t.conType()&&(e=i.getActualStyle(r,o,3,!0))&&(0===t.ZK()?n=e.backColor:1===t.ZK()&&(n=e.foreColor)),n}function f(t,n){if(t)return t.ignoreBlank(a.ignoreBlank()),arguments.length<5?c(t,e):n}function l(t,n){return!T(t)&&t.evaluate(i,r,o,n)}return n=f((a=this).item1(),e),t=f(a.item2(),t),(u=l(a.item1(),n)?1:0)+(s=l(a.item2(),t)?1:0)>a.ZK()},r.prototype.cellValueConditionEvaluate=function(t,n,e,i){var n=this.getExpected(t,n,e);return!(n!==g||!t||!t.EJ)||this.cellValueConditionCheckCondition(n,i)},r.prototype.cellValueConditionCheckCondition=function(t,n){var e,i,r,o,a,e,u,a,e=this,i=0,r=!1,o=e.ZK();if(T(n)&&T(t))switch(o){case $t.equalsTo:case $t.greaterThanOrEqualsTo:case $t.lessThanOrEqualsTo:return!0;case $t.notEqualsTo:case $t.greaterThan:case $t.lessThan:default:return!1}if("boolean"==typeof t||"boolean"==typeof n)return te(o,n,t);if(a={},T(n))e.treatNullValueAsZero()?r=!0:i=n;else{if(typeof n===X&&"number"==typeof t)return te(o,1,0);"boolean"!=typeof n&&ut(n,a)&&(i=a.value,r=!isNaN(i))}return e=0,u=!1,("number"==typeof t||t&&"string"==typeof t&&!qn(t))&&ut(t,a)&&(e=a.value,u=!0),a=tn[o],r?u?te(o,i,e):Ut(a,n,t):"string"==typeof n?u?Ut(a,n,e):"string"==typeof t?Ut(a,n,t):1===o:!!T(n)&&o===$t.notEqualsTo},r.prototype.numberConditionEvaluate=function(t,n,e,i){var n=this.numberConditionGetExpected(t,n,e);return!(n!==g||!t||!t.EJ)||(this.integerValue()&&(n=isNaN(n)?g:(0<n?et:it)(n)),this.numberConditionCheckCondition(n,i))},r.prototype.numberConditionCheckCondition=function(t,n){var e,i,r,e=this;if((T(n)||""===n)&&e.ignoreBlank())return!0;if(isNaN(n))return!1;if(T(t)){if(e.ignoreBlank())return!0;t=0}try{i=T(n)?0:parseFloat(n)}catch(t){return!1}return(!e.integerValue()||(r=i-et(i)==0))&&te(e.ZK(),i,t)},r.prototype.numberConditionGetExpected=function(t,n,e){var i,r,i=this;return i.D5&&0<i.D5.length&&(r=t.op())?r.evaluate(t.Uw(),i.expression(g,t),n,e):i.expected()},r.prototype.textConditionEvaluate=function(t,n,e,i){var r,o,a,u,t,s;function c(t,n){return r.testTextByCondition(n,t,"^","$",function(){return a?t.toLowerCase()===n.toLowerCase():t===n})}function f(t,n){return r.testTextByCondition(n,t,"^","",function(){return lt(n,t,a)})}function l(t,n){return r.testTextByCondition(n,t,"","$",function(){return ht(n,t,a)})}function h(t,n){return r.testTextByCondition(n,t,"","",function(){return dt(n,t===S||t===g?"":t,a)})}if(o=(r=this).compareType(),a=r.ignoreCase(),!r.forceValue2Text()&&y(i,Date))return o!==d.beginsWith&&o!==d.endsWith&&o!==d.contains&&(o===d.doesNotBeginWith||o===d.doesNotEndWith||o===d.doesNotContain);if(u=T(i)?"":i.toString(),r.ignoreBlank()&&""===u)return!0;if(t=this.getExpected(t,n,e),s=T(t)?"":t.toString(),r.hasWildcard(s)&&"number"==typeof i)return o===d.doesNotBeginWith||o===d.doesNotContain||o===d.doesNotEndWith||o===d.notEqualsTo;switch(o){case d.equalsTo:return c(s,u);case d.notEqualsTo:return!c(s,u);case d.beginsWith:return f(s,u);case d.doesNotBeginWith:return!f(s,u);case d.endsWith:return l(s,u);case d.doesNotEndWith:return!l(s,u);case d.contains:return h(s,u);case d.doesNotContain:return!h(s,u);default:return!1}},r.prototype.hasWildcard=function(t){return-1<t.indexOf("*")||-1<t.indexOf("?")},r.prototype.testTextByCondition=function(t,n,e,i,r){var o,n,o;return this.useWildCards()?this.regex()?vt.qT(this.regex()).test(t):(n=vt.jJ(n))?(n=e+n+i,(this.ignoreCase()?vt.OJ(n):vt.qT(n)).test(t)):r():r()},r.prototype.colorConditionEvaluate=function(t,n,e,i){var r,o,i,t;function a(t){return T(t)||""===t?g:jt._(t)}if(o=a((r=this).expected()),T(o)||""===o){if(r.ignoreBlank()||T(o)&&T(i))return!0}else if(i=a(i),(T(i)||""===i)&&t&&t.getDefaultStyle&&(t=t.getDefaultStyle(),r.ZK()===on.backgroundColor?i=t.backColor:r.ZK()===on.foregroundColor&&(i=t.foreColor)),!T(i)&&""!==i)return O.Common.ft.Tv(i,o);return!1},r.prototype.formulaConditionEvaluate=function(t,n,e,i){var r,o,o,a;if(!_t)return!1;if((r=this).customValueType()===an.formula)return(o=r.DJ&&r.DJ.getDataSource&&r.DJ.getDataSource())&&o.RJ&&(t.Uw().DJ=o.RJ(n)),o=r.getExpected(t,n,e),!(!r.ignoreBlank()||!T(o)&&""!==o)||ne(o);switch(a=rt.BJ,r.customValueType()){case an.empty:return T(i)||""===i;case an.nonEmpty:return!T(i)&&""!==i;case an.error:return a(i);case an.nonError:return!a(i);default:return!1}},r.prototype.formulaConditionGetExpected=function(t,n,e){var i,r,o,a,u,s,c,f,i=this;if(i.D5&&0<i.D5.length){if(!(r=t.op()))return i.expected();if(o=r.BI(t.Uw(),i.expression(S,t),(0,L.eV)(n,e),!0),f=c=s=u=a=void 0,rt.LE(o)){for(a=o.getRowCount(0),u=o.getColumnCount(0),s=[],c=0;c<a;c++)for(s[c]=[],f=0;f<u;f++)s[c][f]=o.getValue(0,c,f);o=s}else if(rt.Nh(o)){for(a=o.getRowCount(),u=o.getColumnCount(),s=[],c=0;c<a;c++)for(s[c]=[],f=0;f<u;f++)s[c][f]=o.getValue(c,f);o=s}return y(o,Array)?o[0][0]:o}return i.expected()},r.prototype.dateOrTimeEvaluate=function(t,n,e,i,r,o,a){var u,s,c,i,u=this;if((T(i)||""===i)&&u.ignoreBlank())return!0;if(!y(s=i,Date)){if(u.ZK()===un.notEqualsTo)return!0;if(!T(i))return!1;s=Bt.Y0(0)}if(c=g,i=this.getExpected(t,n,e),y(i,Date)?c=i:"string"==typeof i?c=Bt.yU(i):"number"==typeof i&&(c=Bt.Y0(i)),T(c))return!!u.ignoreBlank();switch(u.ZK()){case un.equalsTo:return r(c,s);case un.notEqualsTo:return!r(c,s);case un.after:return a(c,s);case un.afterEqualsTo:return a(c,s)||r(c,s);case un.before:return o(c,s);case un.beforeEqualsTo:return o(c,s)||r(c,s);default:return!1}},r.prototype.dateConditionEvaluate=function(t,n,e,i){var r=this.preciseCompareDate();return this.dateOrTimeEvaluate(t,n,e,i,yn,r?Sn:Cn,r?Mn:wn)},r.prototype.timeConditionEvaluate=function(t,n,e,i){return this.dateOrTimeEvaluate(t,n,e,i,Tn,In,An)},r.prototype.dateExConditionEvaluate=function(t,n,e,i){var t=this.LJ(t,n,e);return!T(t)&&this.dateExConditionCheckCondition(t,i)},r.prototype.getExConditionDateScope=function(t){var n,e,i,r,o,a,o,a,o,a,o,a,o,a,o,a,o,a,u,s,c,a,u,c,s,o,u,c,o,s,a,c,o,a,u,s,c,n=g,e=g,i=new Date,r=new Date(i.getFullYear(),i.getMonth(),i.getDate(),i.getHours(),i.getMinutes(),i.getSeconds(),i.getMilliseconds());switch(t){case x.last7Days:h(r,bn(r)-6),n=f(r),e=l(i);break;case x.yesterday:h(r,bn(r)-1),n=f(r),e=l(r);break;case x.today:n=f(i),e=l(i);break;case x.tomorrow:h(r,bn(r)+1),n=f(r),e=l(r);break;case x.lastWeek:h(o=i,bn(i)-i.getDay()-7),(a=r).setDate(bn(r)-r.getDay()-1),n=f(o),e=l(a);break;case x.thisWeek:h(o=i,bn(i)-i.getDay()),h(a=r,bn(r)-r.getDay()+6),n=f(o),e=l(a);break;case x.nextWeek:h(o=i,bn(i)-i.getDay()+7),h(a=r,bn(r)-r.getDay()+13),n=f(o),e=l(a);break;case x.lastMonth:h(o=i,1),o.setMonth(i.getMonth()-1),h(a=r,0),n=f(o),e=l(a);break;case x.thisMonth:h(o=i,1),h(a=r,1),a.setMonth(r.getMonth()+1),h(a,0),n=f(o),e=l(a);break;case x.nextMonth:h(o=i,1),o.setMonth(i.getMonth()+1),h(a=r,1),a.setMonth(r.getMonth()+2),h(a,0),n=f(o),e=l(a);break;case x.nextQuarter:u=(a=(o=i).getMonth())%3,o.setDate(1),o.setMonth(a-u+3),c=void 0,(s=r).setDate(1),s.setMonth(a-u+3+2),c=2===s.getMonth()||11===s.getMonth()?31:30,s.setDate(c),n=f(o),e=l(s);break;case x.thisQuarter:c=(u=(a=i).getMonth())%3,a.setDate(1),a.setMonth(u-c),o=void 0,(s=r).setDate(1),s.setMonth(u-c+2),o=2===s.getMonth()||11===s.getMonth()?31:30,s.setDate(o),n=f(a),e=l(s);break;case x.lastQuarter:o=(c=(u=i).getMonth())%3,u.setDate(1),u.setMonth(c-o-3),a=void 0,(s=r).setDate(1),s.setMonth(c-o-3+2),a=2===s.getMonth()||11===s.getMonth()?31:30,s.setDate(a),n=f(u),e=l(s);break;case x.nextYear:(c=i).setDate(1),c.setFullYear(c.getFullYear()+1),c.setMonth(0),(o=r).setFullYear(o.getFullYear()+1),o.setMonth(11),o.setDate(31),n=f(c),e=l(o);break;case x.thisYear:(a=i).setDate(1),a.setMonth(0),(u=r).setMonth(11),u.setDate(31),n=f(a),e=l(u);break;case x.lastYear:(s=i).setFullYear(s.getFullYear()-1),s.setDate(1),s.setMonth(0),(c=r).setFullYear(c.getFullYear()-1),c.setMonth(11),c.setDate(31),n=f(s),e=l(c)}return{from:n,to:e}},r.prototype.dateExConditionCheckCondition=function(t,n){var e,n,i,r,t,i,t,i,t,o,t,e;function a(t,n){switch(t){case fn.quarter1:return 0<=n.getMonth()&&n.getMonth()<=2;case fn.quarter2:return 3<=n.getMonth()&&n.getMonth()<=5;case fn.quarter3:return 6<=n.getMonth()&&n.getMonth()<=8;case fn.quarter4:return 9<=n.getMonth()&&n.getMonth()<=11;default:return!1}}if(n=n,(e=this).ignoreBlank()&&(T(n)||""===n))return!0;try{if(T(n)&&!e.treatNullValueAsZero())return!1;n=rt.r0(n)}catch(t){return!1}if((r=e.expectTypeId())===sn.dateOccurring){if(i=(t=this.getExConditionDateScope(t)).from,t=t.to,!T(i)&&!T(t))return i=(0,p.aJ)(v.dateCondition,un.afterEqualsTo,i,g),t=(0,p.aJ)(v.dateCondition,un.beforeEqualsTo,t,g),(o=(0,p.aJ)(v.relationCondition,nn.and,g,g,g,g,g,i,t)).evaluate(g,0,0,n)}else if(i=e.LJ(g,0,0),!T(i)){if(r===sn.yearOccurring)return i===n.getFullYear();if(r===sn.quarterOccurring)return a(i,n);if(r===sn.monthOccurring)return i===n.getMonth();if(r===sn.weekOccurring)return i===n.getDay();if(r===sn.dayOccurring)return i===bn(n);if(r===sn.yearToDate)return t=new Date,e=new Date,t.setMonth(0,1),t.setHours(0,0,0,0),e.setHours(23,59,59,999),t<=n&&n<=e}return!1},r.prototype.textLengthConditionEvaluate=function(t,n,e,i){var i,t;return!(!T(i)&&""!==i||!this.ignoreBlank())||(i=T(i)?0:i.toString().length,"number"==typeof(t=this.LJ(t,n,e))&&te(this.ZK(),i,t))},r.prototype.top10ConditionEvaluate=function(t,n,e,i){var r,n,o,e,r=this;if(T(i)||""===i)return r.ignoreBlank();if(n=r.LJ(t,n,e),!T(n)&&(o=void 0,o=r.FJ?(T(r.PJ)&&(r.PJ=r.getTopValues(t,n,r.ranges())),r.PJ):r.getTopValues(t,n,r.ranges()))){e=0;try{e=r.uJ(i)}catch(t){return!1}if(Lt.OS(o,e))return!0}return!1},r.prototype.LJ=function(t,n,e){var t=this.getExpected(t,n,e),t=parseInt(t,10);return isNaN(t)||!isFinite(t)?g:t},r.prototype.adjustRange=function(t,n){return V(t.row,t.col,Math.min(Z(t),n.getRowCount()),Math.min(W(t),n.getColumnCount()))},r.prototype.getTopValues=function(t,n,e){var i,r,o,a,u,s,c,c,f,l,h,i=0===this.type()?1:-1,r=[];if(e){for(o=this.GJ(t,e),a=Y(o),f=0;f<a;f++)for(u=this.adjustRange(o[f],t),l=0;l<Z(u);l++)for(s=l+u.row,h=0;h<W(u);h++)c=h+u.col,c=this.uJ(t.getValue(s,c)),T(c)||r.push(c);r.sort(function(t,n){return(n-t)*i}),Y(r)>n&&(r=r.slice(0,n))}return r},r.prototype.uJ=function(t){return("number"==typeof t||y(t,Date))&&_t?at(t):g},r.prototype.uniqueConditionEvaluate=function(t,n,e,i){var r,i,n,e,n,e,r=this,i=i;return T(i)||""===i?r.ignoreBlank():(_t&&ot(i)&&!Wt(i)&&!C.mt.isInfinityNumberString(i)&&(i=at(i)),n=this.getExpected(t,n,e),rt.YK(n,e={}),!T(n=e.value)&&(e=r.duplicatedArrayCached||r.getDuplicated(t,r.ranges()),!T(e)&&Lt.OS(e,i)?!0===n:!0!==n))},r.prototype.getDuplicated=function(t,n){var e,i,r,o,a,u,s,c,f,l,h,d,d,v,e=[],i={},r=this.GJ(t,n);if(r)for(o=Y(r),a=0;a<o;a++)for(u=r[a],s=Z(u=this.adjustRange(u,t)),c=W(u),f=0;f<s;f++)for(l=f+u.row,h=0;h<c;h++)d=h+u.col,d=t.getValue(l,d,3),(v=i[d=T(d)||!_t||!ot(d)||Wt(d)||C.mt.isInfinityNumberString(d)?d:at(d)])?1===v&&e.push(d):i[d]=1;return e},r.prototype.UJ=function(t,n){for(var e,i,e=t.length,i=0;i<e;i++)if(t[i].key===n)return!0;return!1},r.prototype.averageConditionEvaluate=function(t,n,e,i){var r,o,o,a,u,t,s,c;if(_t){if((r=this).ignoreBlank()&&(T(i)||""===i))return!0;if(r.HJ(),o=r.FJ?(T(r.PJ)&&(r.PJ=r.getExpected(t,n,e)),r.PJ):r.getExpected(t,n,e),a=ut(o,o={})?o.value:NaN,u=g,t=r.QK?r.zJ(t,r.QK,n,e):g,T(t)||(u=ut(t,o={})?o.value:NaN),ot(i)&&(s=at(i),!isNaN(a)))switch(c=isNaN(u),r.type()){case N.above:return a<s;case N.below:return s<a;case N.equalOrAbove:return a<=s;case N.equalOrBelow:return s<=a;case N.above1StdDev:return!c&&a+u<s;case N.below1StdDev:return!c&&s<a-u;case N.above2StdDev:return!c&&a+2*u<s;case N.below2StdDev:return!c&&s<a-2*u;case N.above3StdDev:return!c&&a+3*u<s;case N.below3StdDev:return!c&&s<a-3*u;default:return!1}}return!1},r.prototype.HJ=function(){var t=this;t.ranges()&&(t.WK=t.VJ("AVERAGE",t.ranges()),4<=t.type())&&t.type()<=9&&(t.QK=t.VJ("STDEV",t.ranges()))},r.prototype.VJ=function(t,n){var t,e,i,r;if(_t&&(t=Gt.findGlobalFunction(t))){for(e=[],i=Y(n),r=0;r<i;r++)e[r]=Jt(n[r]);return B.YJ(t,e)}return g},r.prototype.averageConditionGetExpected=function(t,n,e){var i=t.op();return i?i.BI(t.Uw(),this.expression(S,t),(0,L.eV)(n,e),!1):g},r.prototype.ZJ=function(){var t=this.conType();t!==v.averageCondition&&t!==v.top10Condition||(this.FJ=!0)},r.prototype.WJ=function(){var t=this;t.FJ=!1,t.PJ=S},r.prototype.zJ=function(t,n,e,i){var r=t.op();return r?r.BI(t.Uw(),n,(0,L.eV)(e,i),!1):g},r.prototype.QJ=function(t,n){for(var e,i,i=0;i<Y(n);i++)e=n[i],y(e,Array)&&0<Y(e)?1<Y(n)?t.push(e[0]):t.push.apply(t,e):t.push(e)},r.prototype.getValidList=function(t,n,e){for(var i,r,o,a,i=[],r=this.getValidListImp(t,n,e),o=0,a=Y(r);o<a;o++)i.push(r[o].value);return i},r.prototype.KJ=function(){return this.D5&&0<this.D5.length},r.prototype.getValidListImp=function(t,n,e){var i,r,t,o,a,u,s,c,f,c,i=this,r=[];if(i.D5&&0<i.D5.length)t=i.getExpected(t,n,e),y(t,Array)?i.QJ(r,t):r.push(t);else if(i.expected()&&0<i.expected().length&&(u=(a=(o=i.expected()).replace(/\\,/g,String.fromCharCode(206))).split(",")))for(s=0;s<Y(u);s++)c=u[s],T(c)||(f=new RegExp(String.fromCharCode(206),"g"),""!==(c=b.trim(c).replace(f,","))&&r.push({text:c,value:c}));return r},r.prototype.areaConditionEvaluate=function(t,n,e,i){var r,o,a,u,s,c;function f(t,n,e){return y(t,Date)&&y(n,Date)?t.valueOf()===n.valueOf():e||"string"!=typeof t||"string"!=typeof n?t===n:t.toLowerCase()===n.toLowerCase()}if(r=this,T(i)||""===i)return!0===r.ignoreBlank();for(o=r.getValidList(t,n,e),a=0;a<Y(o);a++){if(u=o[a],T(u)&&T(i))return!0;if(r.D5){if(f(u,i,!1))return!0}else if(s=t.getActualStyle(n,e,3,!0),f(c=A.Xf(s,u,!0),i,!0))return!0}return!1},r.prototype.areaConditionGetExpected=function(t,n,e){var i,r,o,a,u,s,c,f,l,h,d,v,m,l,t,i=this,r=[];if(i.D5){if(f=c=s=u=a=o=void 0,!(l=t.op()))return r;if(h=l.BI(t.Uw(),i.expression(S,t),(0,L.eV)(n,e),!0),rt.LE(h))for(o=h.getRowCount(0),a=h.getColumnCount(0),d=h.getRow(0),v=h.getColumn(0),(m=h.rT&&h.rT.Mf)&&(m.nre&&m.nre(),l=m.getRowCount(),t=m.getColumnCount(),o=l<o?tt(l-d,0):o,a=t<a?tt(t-v,0):a),u=0;u<o;u++)for(r[u]=[],s=0;s<a;s++)c=h.getValue(0,u,s),f=m?m.getText(d+u,v+s):c,r[u][s]={value:c,text:f};else if(rt.Nh(h))for(o=h.getRowCount(),a=h.getColumnCount(),u=0;u<o;u++)for(r[u]=[],s=0;s<a;s++)c=h.getValue(u,s),r[u][s]={value:c,text:c}}else r.push({value:i.expected(),text:i.expected()});return r},r.prototype.stateConditionEvaluate=function(t,n,e,i){var r=this.expected();return!(T(i)||T(r)||isNaN(i)||isNaN(i))&&0<(i&r)},r.prototype.reset=function(){var t=this;switch(t.ignoreBlank(!1),t.preciseCompareDate(!1),t.ZK(1),t.item1(g),t.item2(g),t.value1=g,t.value2=g,t.expected(g),t.ZK(0),t.integerValue(!1),t.operator=0,t.text="",t.ZK(0),t.useWildCards(!0),t.ignoreCase(!1),t.forceValue2Text(!1),t.customValueType(0),t.WK=g,t.type(0),this.expectTypeId(0),t.ranges(g),t.isPercent(!1),t.regex(g),t.conType()){case v.relationCondition:t.ignoreBlank(!1),t.ZK(1);break;case v.numberCondition:t.ZK(0),t.integerValue(!1);break;case v.textCondition:t.ZK(0),t.useWildCards(!0),t.forceValue2Text(!1);break;case v.colorCondition:t.ZK(0);break;case v.formulaCondition:t.customValueType(0),t.QK=g;break;case v.dateCondition:case v.timeCondition:t.ZK(0);break;case v.dateExCondition:t.expectTypeId(0);break;case v.textLengthCondition:t.ZK(0);break;case v.top10Condition:case v.averageCondition:t.type(0);break;case v.cellValueCondition:t.operator=6;break;case v.areaCondition:}},r.prototype.evaluate=function(t,n,e,i){var r=this.conType();return!T(r)&&this[v[r]+"Evaluate"](t,n,e,i)},r.prototype.getExpectedNormal=function(t,n,e,i,r,o){var a,u,s,u,a=this,u=a.D5,s=a.expected();return(u=u&&t.op())?u.BI(t.Uw(),a.expression(S,t),(0,L.eV)(n,e),!1,o):s},r.prototype.getExpected=function(t,n,e){var i=this;switch(i.conType()){case 2:return i.getExpectedNormal(t,n,e,n-i.offsetRow,e-i.offsetCol,!1);case 5:case 6:case 7:case 9:case 11:case 13:return i.getExpectedNormal(t,n,e,n-i.offsetRow,e-i.offsetCol,!1);case 8:return i.getExpectedNormal(t,n,e,n,e);case 0:return g;case 1:return i.numberConditionGetExpected(t,n,e);case 3:return g;case 4:return i.formulaConditionGetExpected(t,n,e);case 10:return i.averageConditionGetExpected(t,n,e);case 12:return i.areaConditionGetExpected(t,n,e);default:return g}},r.prototype.GJ=function(t,n){for(var e,i,r,o,e=[],i=0,r=Y(n);i<r;i++)o=t.JS(n[i]),e.push(o);return e},r.prototype.getExpressions=function(){var t=[],n=this;return 0===n.conType()?(n.item1()&&n.item1().getExpressions&&(t=n.item1().getExpressions()),n.item2()&&n.item2().getExpressions?t.concat(n.item2().getExpressions()):t):(n.WK||n.initExpression(),n.WK?[n.WK]:[])},r.prototype.setExpressions=function(t,n){var e=this,i;n&&n.push({type:"condition",condition:this,expressions:e.getExpressions(),newExpressions:t}),0===e.conType()?(e.item1()&&e.item1().setExpressions&&(i=e.item1().getExpressions().length,e.item1().setExpressions(t.slice(0,i))),e.item2()&&e.item2().setExpressions&&e.item2().setExpressions(t.slice(i))):e.expression(t[0])},r.prototype.toJSON=function(t){var t=Kt.call(this,t,Nn);return t.ignoreBlank&&!isNaN(t.ignoreBlank)&&(t.ignoreBlank=0!==parseInt(t.ignoreBlank,10)),t},r.prototype.fromJSON=function(t,n,e){var i,r;t&&(Xt.call(i=this,n,Nn,t,e),(r=n&&n.Lp&&n.Lp.useR1C1)&&n instanceof C.Worksheet&&(i.context(n),Nt(i)),i.U0(!0),i.initExpression(),i.H0())},r.fromSource=function(t){return(0,p.aJ)(12,g,t,g)},r.fromFormula=function(t){return(0,p.aJ)(12,g,"",t)},r.fromDay=function(t){var t=(0,p.aJ)(6,g,t);return t.expectTypeId(5),t},r.fromMonth=function(t){var t=(0,p.aJ)(6,g,t);return t.expectTypeId(3),t},r.fromQuarter=function(t){var t=(0,p.aJ)(6,g,t);return t.expectTypeId(2),t},r.fromWeek=function(t){var t=(0,p.aJ)(6,g,t);return t.expectTypeId(4),t},r.fromYear=function(t){var t=(0,p.aJ)(6,g,t);return t.expectTypeId(1),t},M=r,(p.Condition=M).prototype.conType=n("conType",g),M.prototype.ranges=n("ranges",g,function(t){var n=this.item1(),e=this.item2();n&&n.ranges&&n.ranges(t),e&&e.ranges&&e.ranges(t)}),M.prototype.ignoreBlank=n("ignoreBlank",!1),M.prototype.preciseCompareDate=n("preciseCompareDate",!1),M.prototype.compareType=n("compareType",S),M.prototype.ZK=M.prototype.compareType,M.prototype.expected=n("expected",S),M.prototype.item1=n("item1",g),M.prototype.item2=n("item2",g),M.prototype.treatNullValueAsZero=n("treatNullValueAsZero",!1),M.prototype.integerValue=n("integerValue",!1),M.prototype.forceValue2Text=n("forceValue2Text",!1),M.prototype.useWildCards=n("useWildCards",!0),M.prototype.regex=n("regex",g),M.prototype.ignoreCase=n("ignoreCase",!1),M.prototype.customValueType=n("customValueType",S),M.prototype.expectTypeId=n("expectTypeId",0),M.prototype.type=n("type",g),M.prototype.isPercent=n("isPercent",!1),a.prototype.stopIfTrue=function(t){},a.prototype.evaluate=function(t,n,e,i){var r,o,a,a,u,t,r=this,o=r.JJ(n,e);return r.zT(o)?(r.initCondition(),r.getBaseCoordinate(a={baseRow:0,baseCol:0}),r.condition().adjustOffset(n-a.baseRow,e-a.baseCol),a=g,u=rt.BJ,(t=r.condition().evaluate(t,n,e,i))&&!u(t)&&(a=r.getExpected(o)||p.oJ),r.condition().adjustOffset(0,0),a):g},a.prototype.JJ=function(t,n){return this.contains(t,n)},a.prototype.zT=function(t){return t},a.prototype.contains=function(t,n){var e,i,r,o,e=this.ranges();if(e)for(i=Y(e),r=void 0,o=0;o<i;o++)if((r=e[o]).contains(t,n))return!0;return!1},a.prototype.createCondition=function(){return this.KK=!1,null},a.prototype.initCondition=function(t){var n=this.condition();n||((n=this.createCondition())&&(n.ranges(this.ranges()),this.condition(n)),t&&this.context(t),this.context()&&n&&n.context(this.context()))},a.prototype.XJ=function(){var t,n,t=this;t.KK&&((n=t.condition())||(t.initCondition(),n=t.condition()),n)&&!n.WK&&n.initExpression()},a.prototype.context=function(t){return 1===arguments.length&&(this.DJ=t,this.condition())&&this.condition().context(t),this.DJ},a.prototype.getExpected=function(t){return this.style()},a.prototype.reset=function(){var t=this;t.ranges(g),t.condition(g),t.style(g),t.stopIfTrue(!1),t.priority(1)},a.prototype.intersects=function(t,n,e,i){var r,o,a,u,r=this.ranges();if(r)for(o=Y(r),a=void 0,u=0;u<o;u++)if((a=r[u]).intersect(t,n,e,i))return!0;return!1},a.prototype.isScaleRule=function(){return!1},a.prototype.isStateRule=function(){return!1},a.prototype.getBaseCoordinate=function(t){var n,e,i,r,o,a,o;if(t.baseRow=Number.MAX_VALUE,t.baseCol=Number.MAX_VALUE,0<(i=(e=(n=this).ranges())?e.length:0))for(r=0;r<i;r++)a=(o=e[r]).row,o=-1===(o=o.col)?0:o,t.baseRow=$(a=-1===a?0:a,t.baseRow),t.baseCol=$(o,t.baseCol);else t.baseRow=0,t.baseCol=0},a.prototype.qJ=function(t,n,e){var i,r,o,a,u,s,c,f,l,s,h,d,v,i=this,r=!1;if(i.XJ(),o=i.ranges())for(a=Y(o),u=0;u<a;u++)c=(s=o[u]).row,f=Z(s),l=s.col,s=W(s),h=c===t.row&&f===t.rowCount&&t.col<=l&&s<=t.colCount,d=c===n.row&&f===n.rowCount&&n.col<=l&&s<=n.colCount,(v=h||d)&&(o[u]=V(c,l,f+e,s),r=!0);return r},a.prototype.$J=function(t,n,e,i,r){var o,a,u,s,c,f,l,h,d,v,m,g,p,b,y,w,b,M,C,C,S,T,A,o=this,a=e?n:0,u=e?0:n;if(o.XJ(),s=o.ranges()){for(c=[],f=Y(s),l=0;l<f;l++)if(h=s[l],d=e?h.row:h.col,v=(e?Z:W)(h),-1!==d){if(i&&0<i.length){for(m=!1,g=0,p=i.length;g<p;g++)if((b=i[g])&&(y=!e&&b.col===t&&b.col===h.col&&b.colCount-n===h.colCount,w=!e&&b.col===t&&b.row===h.row&&b.rowCount===h.rowCount&&h.col>=b.col&&h.col+h.colCount<=b.col+b.colCount,b=e&&b.row===t&&b.row===h.row&&b.rowCount-n===h.rowCount,y||w||b)){s[l]=V(h.row,h.col,Z(h)+a,W(h)+u),m=!0;break}if(m)break}if(M=h,C=r&&i&&i[0]){if((C=e?ie(h,C.col,C.col+C.colCount-1):re(h,C.row,C.row+C.rowCount-1))[0]&&c.push(C[0]),C[2]&&c.push(C[2]),!C[1])continue;M=C[1]}t<=d?s[l]=V(M.row+a,M.col+u,Z(M),W(M)):t<=d+v&&(s[l]=V(M.row,M.col,Z(M)+a,W(M)+u))}for(S=0,T=c;S<T.length;S++)s.push(A=T[S])}},a.prototype.JO=function(t,n,e,i){this.$J(t,n,!0,e,i)},a.prototype.qO=function(t,n,e,i){this.$J(t,n,!1,e,i)},a.prototype.tX=function(t,n,e,i,r){var o,a,u,s,c,f,l,h,d,v,m,g,p,b,y,m,y,w,M,C,S,T,A,o=this,a=e?t:0,u=e?0:t,s=e?n:0,c=e?0:n;if(o.XJ(),f=o.ranges()){for(l=[],h=[],d=Y(f),v=0;v<d;v++)if(m=f[v],g=e?m.row:m.col,p=(e?Z:W)(m),-1!==g){if(b=m,y=r&&i&&i[0]){if((m=e?ie(m,y.col,y.col+y.colCount-1):re(m,y.row,y.row+y.rowCount-1))[0]&&l.push(m[0]),m[2]&&l.push(m[2]),!m[1])continue;b=m[1]}t<g?g+p<=t+n?h.push(b):f[v]=V(b.row-s,b.col-c,Z(b),W(b)):t<g+p&&(y=V(b.row,b.col,Z(b)-$(b.row+Z(b)-a,s),W(b)-$(b.col+W(b)-u,c)),0===W(y)||0===Z(y)?h.push(b):f[v]=y)}for(w=0,M=l;w<M.length;w++)f.push(C=M[w]);for(S=Y(h),T=0;T<S;T++)Ft(f,A=h[T])}},a.prototype.xP=function(t,n,e,i){this.tX(t,n,!0,e,i)},a.prototype.NP=function(t,n,e,i){this.tX(t,n,!1,e,i)},a.prototype.toJSON=function(t){return Kt.call(this,t)},a.prototype.fromJSON=function(t,n,e){t&&(Xt.call(this,n,g,t,e),this.initCondition(n))},a.prototype.kJ=function(){var t=this.condition();t&&Nt(t)},a.prototype.nX=function(){var t,n,e,i,r,t=this.JK,n=this.ranges();if(t){if((e=Y(t))!==(i=Y(n)))return!0;for(r=0;r<i;r++)if(!t[r].equals(n[r]))return!0}else this.JK=ge(n);return!1},(i=(p.ConditionRuleBase=e=a).prototype).ruleType=n("ruleType",g),i.ranges=n("ranges",g,function(t){var n,e,n=this.condition();n&&n.ranges()&&((e=n.DJ)&&e.Ut.vJ(),n.ranges(t),e)&&e.Ut.vJ(!0)}),i.condition=n("condition",g),i.style=n("style",g),i.priority=n("priority",1),i.stopIfTrue=n("stopIfTrue",!1),kn=["ruleType","style","operator","text","formula","type","rank","priority","stopIfTrue","ranges"],Dn={today:0,yesterday:1,tomorrow:2,last7Days:3,thisMonth:4,lastMonth:5,nextMonth:6,thisWeek:7,lastWeek:8,nextWeek:9},_n={0:"today",1:"yesterday",2:"tomorrow",3:"last7Days",4:"thisMonth",5:"lastMonth",6:"nextMonth",7:"thisWeek",8:"lastWeek",9:"nextWeek"},(i=En=En||{})[i.equal=0]="equal",i[i.notEqual=1]="notEqual",i[i.greaterThan=2]="greaterThan",i[i.greaterThanOrEqual=3]="greaterThanOrEqual",i[i.lessThan=4]="lessThan",i[i.lessThanOrEqual=5]="lessThanOrEqual",i[i.between=6]="between",i[i.notBetween=7]="notBetween",j(u,Zn=e),u.prototype.value1=function(t,n){var e,e;if(1!==arguments.length)return(e=this.condition())&&(e=e.formula(t,n,0))&&0<e.length?"="+ft(b.trim(e.toString()),"="):this.eX;this.eX=t},u.prototype.value2=function(t,n){var e,e;if(1!==arguments.length)return(e=this.condition())&&(e=e.formula(t,n,1))&&0<e.length?"="+ft(b.trim(e.toString()),"="):this.iX;this.iX=t},u.prototype.formula=function(t,n){var e=this,i=e.condition();if("string"!=typeof t)return i&&i.formula(t,n)||e.D5;e.D5=t,i&&i.formula(t)},u.prototype.cellValueRuleCreateCondition=function(){var t,n,e,i,r,o,a,u,s,c,f,l,t,h,a,t=this,n=t.value1(),e=t.value2(),i=t.ranges(),r=t.kf(n)?ft(n,"="):g,o=t.kf(e)?ft(e,"="):g,t=t.operator();return t===en.between?((a=(0,p.aJ)(v.cellValueCondition,3,n,r,S,S,i)).treatNullValueAsZero(!0),(u=(0,p.aJ)(v.cellValueCondition,5,e,o,S,S,i)).treatNullValueAsZero(!0),f=(0,p.aJ)(v.relationCondition,1,g,g,g,g,i,a,u),(s=(0,p.aJ)(v.cellValueCondition,5,n,r,S,S,i)).treatNullValueAsZero(!0),(c=(0,p.aJ)(v.cellValueCondition,3,e,o,S,S,i)).treatNullValueAsZero(!0),l=(0,p.aJ)(v.relationCondition,1,g,g,g,g,i,s,c),(0,p.aJ)(v.relationCondition,0,g,g,g,g,i,f,l)):t===en.notBetween?((a=(0,p.aJ)(v.cellValueCondition,4,n,r,S,S,i)).treatNullValueAsZero(!0),u=(0,p.aJ)(v.cellValueCondition,2,e,o,S,S,i),a.treatNullValueAsZero(!0),f=(0,p.aJ)(v.relationCondition,0,g,g,g,g,i,a,u),(s=(0,p.aJ)(v.cellValueCondition,2,n,r,S,S,i)).treatNullValueAsZero(!0),(c=(0,p.aJ)(v.cellValueCondition,4,e,o,S,S,i)).treatNullValueAsZero(!0),l=(0,p.aJ)(v.relationCondition,0,g,g,g,g,i,s,c),(0,p.aJ)(v.relationCondition,1,g,g,g,g,i,f,l)):((a=(0,p.aJ)(11,t,n,r,S,S,i)).treatNullValueAsZero(!0),a)},u.prototype.kf=function(t){return!T(t)&&"="===t[0]},u.prototype.specificTextRuleCreateCondition=function(){var t,n,e,i,e,n=this.operator();switch(n){case 2:t=2;break;case 3:t=4;break;case 0:t=6;break;case 1:t=7;break;default:t=0}return e=this.text(),i=g,e&&"="===e[0]&&(i=e),(e=(0,p.aJ)(2,t,e,i,S,S,this.ranges())).ignoreCase(!0),e.useWildCards(2!==n&&3!==n),e},u.prototype.formulaRuleCreateCondition=function(){var t=this,n=t.ranges();return(0,p.aJ)(4,g,g,t.D5,4,g,n)},u.prototype.dateOccurringRuleCreateCondition=function(){return(0,p.aJ)(6,g,this.type(),g,g,S,this.ranges())},u.prototype.top10RuleCreateCondition=function(){return(0,p.aJ)(8,g,this.rank(),g,g,this.type(),this.ranges())},u.prototype.uniqueRuleCreateCondition=function(){return(0,p.aJ)(9,g,!1,g,g,g,this.ranges())},u.prototype.duplicateRuleCreateCondition=function(){return(0,p.aJ)(9,g,!0,g,g,g,this.ranges())},u.prototype.averageRuleCreateCondition=function(){return(0,p.aJ)(10,g,g,g,g,this.type(),this.ranges())},u.prototype.createCondition=function(){return this[I[this.ruleType()]+"CreateCondition"]()},u.prototype.reset=function(){var t=this;switch(t.ranges(g),t.condition(g),t.style(g),t.stopIfTrue(!1),t.priority(1),t.operator(6),t.value1(g),t.value2(g),t.text(""),t.formula(g),t.type(0),t.rank(10),t.ruleType()){case 1:t.operator(6);break;case 2:t.operator(0);break;case 4:t.style(g);break;case 5:t.type(0),t.rank(10);break;case 8:t.type(0)}},u.prototype.evaluate=function(t,n,e,i){return this.rX(t),Zn.prototype.evaluate.call(this,t,n,e,i)},u.prototype.rX=function(t){var n,e,n=this;n.initCondition(),9===(e=n.condition()).conType()&&(n.nX()&&(n.dl(),n.JK=ge(n.ranges())),!1===n.cached)&&(e.duplicatedArrayCached=e.getDuplicated(t,n.ranges()),n.cached=!0)},u.prototype.dl=function(){this.cached=!1},u.prototype.JO=function(t,n,e,i){Zn.prototype.JO.call(this,t,n,e,i),this.dl()},u.prototype.qO=function(t,n,e,i){Zn.prototype.qO.call(this,t,n,e,i),this.dl()},u.prototype.xP=function(t,n,e,i){Zn.prototype.xP.call(this,t,n,e,i),this.dl()},u.prototype.NP=function(t,n,e,i){Zn.prototype.NP.call(this,t,n,e,i),this.dl()},u.prototype.toJSON=function(t){var n,e,i,r,o,a,n=this;return T(n.condition())&&this.initCondition(),e=Kt.call(n,t,kn),i=n.value1(),oe(e.ruleType,e.operator)&&(r=n.value2()),o=t&&t.parent&&1===t.parent.options.referenceStyle,T(i)||(n.kf(i)&&o&&(i=se(t,n,i,o)),e.value1=i),T(r)||(n.kf(r)&&o&&(r=se(t,n,r,o)),e.value2=r),(a=n.ruleType())===I.conditionRuleBase&&(e.condition=n.condition().toJSON()),e},u.prototype.fromJSON=function(t,n,e){var i=kn;T(t.condition)||(i=kn.concat(["condition"])),Xt.call(this,n,i,t,e),T(t.value1)||this.value1(t.value1),T(t.value2)||this.value2(t.value2),this.initCondition(n)},u.prototype.oX=function(t,n,e){var i,r,n,o,t,a,u,s,s,e,c,f,s,l,h,d,v,f,m,g,p,b,y,u,w,M,w,a,n,i=this,r=i.ruleType(),n=C.Util.ko(n),o={n_:H,sqref:xt(i.ranges())};return o.pivot=T(i.pivotTableName)?S:"1",t=t.getDxfIndex(i.style(),!0),a=i.operator&&i.operator(),u=i.type&&i.type(),s=[x.nextQuarter,x.thisQuarter,x.lastQuarter,x.nextYear,x.thisYear,x.lastYear],r===I.dateOccurringRule&&-1<s.indexOf(u)?o.lossless=i.toJSON(e):(e=(s=xe(r,u,a)).type,c=s.operator,f=i.condition(),s=s.timePeriod,l=i.priority()?""+i.priority():"1",h=i.stopIfTrue()?1:S,d=1===u?1:S,f=(v=f&&f.isPercent())?1:S,m=i.rank&&i.rank()||S,g=i.text&&i.text(),y=b=p=void 0,r===I.averageRule&&(y=0,u!==N.equalOrAbove&&u!==N.equalOrBelow||(b=1),u!==N.above1StdDev&&u!==N.below1StdDev||(y=1),u!==N.above2StdDev&&u!==N.below2StdDev||(y=2),u!==N.above3StdDev&&u!==N.below3StdDev||(y=3),u!==N.below&&u!==N.equalOrBelow&&u!==N.below1StdDev&&u!==N.below2StdDev&&u!==N.below3StdDev||(p=0)),u=[],w=T(i.value1())?i.D5:i.value1(),M=i.value2(),T(w)||u.push({n_:"formula",c_:[Ce(n?w:mt(w))]}),oe(r,a)&&!T(M)&&u.push({n_:"formula",c_:[Ce(n?M:mt(M))]}),w={n_:"cfRule",type:e,dxfId:t!==S?+t:t,priority:l,stopIfTrue:h,aboveAverage:p,equalAverage:b,bottom:d,percent:f,rank:m,operator:c,text:pt(g),stdDev:y,timePeriod:s},r===I.specificTextRule||r===I.dateOccurringRule||r===I.top10Rule||r===I.uniqueRule||r===I.duplicateRule||r===I.averageRule?(a=ae(w,i.ranges(),g))&&(n=[{n_:"formula",c_:[Ce(A.getFormulaString(a))]}],w.c_=n):w.c_=u,o.c_=[w]),o},u.prototype.IJ=function(t){var n,e,i,r,i,t,n=this,e={n_:"conditionalFormatting","xmlns:xm":"http://schemas.microsoft.com/office/excel/2006/main"},i=zt(),r={n_:"cfRule",type:"expression",id:i};return n.rJ=i,T(n.priority())||(r.priority=n.priority()),i={n_:"f",c_:[pt(gt(n.D5))]},t={n_:"dxf",v:t.cv(n.style(),!0)},r.c_=[i,t],e.c_=[r,{n_:"sqref",c_:[xt(n.ranges())]}],e},u.prototype.aX=function(){var t=this;if(kt(t.value1())||kt(t.value2())||kt(t.text())||kt(t.D5))return!0},u.prototype.wh=function(t,n,e,i,r){var o=this;if(!o.aX())return T(o.condition())&&o.initCondition(),n?o.IJ(e):o.oX(t,i,r)},u.prototype.uX=function(t,n,e,i){var r,o,i,e,a,u,a,s,i,c,f,l,h,a,r=this,o=t.type,i=C.Util.ko(i),e=e.getDxf(t.dxfId,void 0,!0),a=yt(t,"formula"),u=z(a&&At(a[0])),a=z(a&&At(a[1]));switch("cellIs"===o?(r.eX=(i?"":"=")+St(u),a&&(r.iX=(i?"":"=")+St(a))):r.D5=St(u),T(t.stopIfTrue)||r.stopIfTrue(1==+t.stopIfTrue),s=t.rank,i=Ee(o)){case 8:f=!0,0==+t.aboveAverage&&(f=!1),c=(l=1==+t.equalAverage)?f?2:3:f?0:1,T(t.stdDev)||(h=+t.stdDev,f?1==h?c=4:2==h?c=6:3==h&&(c=8):1==h?c=5:2==h?c=7:3==h&&(c=9));break;case 5:c=0,t.bottom&&(c=1),t.percent&&0===(s=Math.floor(n[0].rowCount*n[0].colCount*s/100))&&(s=1);break;case 4:c=0,"timePeriod"===t.type&&t.timePeriod&&(c=Dn[t.timePeriod])}r.type(c),T(s)||r.rank(+s),a=Ie(o,t.operator,t.timePeriod),r.operator(a),r.text(St(t.text)),r.ranges(n),r.ruleType(i),r.style(ue(e))},u.prototype.sX=function(t,n,e){var i,r,o,a,u,s,c,f,l,l,o,l,h,r,i=this,r=t.type,o=Ee(r);switch(T(t.stopIfTrue)||i.stopIfTrue(1==+t.stopIfTrue),u=t.rank,o){case 8:s=!0,0==+t.aboveAverage&&(s=!1),a=(c=1==+t.equalAverage)?s?2:3:s?0:1,T(t.stdDev)||(f=+t.stdDev,s?1==f?a=4:2==f?a=6:3==f&&(a=8):1==f?a=5:2==f?a=7:3==f&&(a=9));break;case 5:a=0,t.bottom&&(a=1),t.percent&&0===(u=Math.floor(n[0].rowCount*n[0].colCount*u/100))&&(u=1);break;case 4:a=0,"timePeriod"===t.type&&t.timePeriod&&(a=Dn[t.timePeriod])}i.type(a),T(u)||i.rank(+u),l=Ie(r,t.operator,t.timePeriod),i.operator(l),i.ruleType(o),o=(l=yt(t,"f"))&&St(Ct(At(l[0]))),l=l&&St(Ct(At(l[1]))),"cellIs"===r?(i.eX=o,i.iX=l):i.D5=o,r=(h=w(t,"dxf")).v,i.style(ue(e.fv(r))),i.ranges(n)},u.prototype.yh=function(t,n,e,i,r,o,a){var u=this;r?u.sX(t,n,o):u.uX(t,n,e,a),u.initCondition(i)},k=u,p.NormalConditionRule=k,i={operator:n("operator",g),text:n("text",g),type:n("type",g),rank:n("rank",g),priority:n("priority",1)},b.extend(k.prototype,i),p.ScaleValue=ce,On=["ruleType","ranges","minType","minValue","minColor","maxType","maxValue","maxColor","midType","midValue","midColor","priority"],j(s,Wn=e),s.prototype.stopIfTrue=function(t){return!1},s.prototype.isScaleRule=function(){return!0},s.prototype.createCondition=function(){return g},s.prototype.cX=function(t){var t=(0,p.aJ)(8,g,g,g,g,1).getTopValues(t,1,this.ranges());return 0<Y(t)?t[0]:g},s.prototype.fX=function(t){var t=(0,p.aJ)(8,g,g,g,g,0).getTopValues(t,1,this.ranges());return 0<Y(t)?t[0]:g},s.prototype.rX=function(t){var n=this;n.nX()&&(n.dl(),n.JK=ge(n.ranges())),!1===n.cached&&(n.lowestValueCached=n.cX(t),n.highestValueCached=n.fX(t),n.cached=!0)},s.prototype.dl=function(){this.lowestValueCached=g,this.highestValueCached=g,this.XK={},this.cached=!1},s.prototype.lX=function(t,n,e,i){var r,i;return i&&(r=t.op())?(i=r.parse(t.Uw(),i,n,e),r.BI(t.Uw(),i,(0,L.eV)(n,e),!1)):g},s.prototype.kf=function(t){return t&&"="===t[0]},s.prototype.hX=function(t){return T(t)||""===t?g:"="===t[0]?t.substr(1):t},s.prototype.dX=function(t,n,e,i){var t;return this.kf(i)?this.lX(t,n,e,this.hX(i.toString())):ut(i,t={})?t.value:NaN},s.prototype.vX=function(t){return this.rX(t),this.highestValueCached},s.prototype.mX=function(t){return this.rX(t),this.lowestValueCached},s.prototype.gX=function(t,n,e,i){var n,e,i,n=this.dX(t,n,e,i);return!isNaN(n)&&0<=n&&n<=100&&(e=this.mX(t),i=this.vX(t),typeof e!=K)&&e!==g&&typeof i!=K&&i!==g?e+(i-e)*n/100:g},s.prototype.pX=function(t,n,e,i){var r,o,a,u,s,c,f,l,h,f,f,l,h,r=this.XK;if(void 0===r[i])if(o=this.dX(t,n,e,i),!isNaN(o)&&0<=o&&o<=100){for(a=0,u=this.ranges(),s=Y(u),c=0;c<s;c++)f=this.VJ("PERCENTILE",[t.JS(u[c]),o/100]),l=t.op(),h=t.Uw(),f=l.unparse(h,f,n,e),f=l.parse(h,f,n,e),l=l.BI(h,f,(0,L.eV)(n,e),!1),a+=ut(l,h={})?h.value:0;r[i]=a/s}else r[i]=g;return r[i]},s.prototype.bX=function(t,n,e,i,r){var o,a,a,o=this;switch(i){case ln.formula:return o.kf(r)||(r="="+r),o.dX(t,n,e,r);case ln.highestValue:return o.vX(t);case ln.lowestValue:return o.mX(t);case ln.number:return o.dX(t,n,e,r);case ln.percent:return o.gX(t,n,e,r);case ln.percentile:return o.pX(t,n,e,r);case ln.automax:return(a=o.vX(t))<0?0:a;case ln.automin:return 0<(a=o.mX(t))?0:a;default:return g}},s.prototype.yX=function(t,n,e){return t===n&&t===e?1:t<=n?0:e<=t?1:(t-n)/(e-n)},s.prototype.wX=function(t,n,e){var n,e,i,r,o,n;return 0<=t&&t<=1?(n=jt._(n),e=jt._(e),i=n.a*(1-t)+e.a*t,r=n.r*(1-t)+e.r*t,o=n.g*(1-t)+e.g*t,n=n.b*(1-t)+e.b*t,Ot(parseFloat(i/255+""),parseInt(r+"",10),parseInt(o+"",10),parseInt(n+"",10))):g},s.prototype.VJ=function(t,n){var t,e,i,r;if(_t&&(t=Gt.findGlobalFunction(t))){for(e=[],i=Y(n),r=0;r<i;r++)e[r]=Jt(n[r]);return B.YJ(t,e)}return g},s.prototype.JO=function(t,n,e,i){Wn.prototype.JO.call(this,t,n,e,i),this.dl()},s.prototype.qO=function(t,n,e,i){Wn.prototype.qO.call(this,t,n,e,i),this.dl()},s.prototype.xP=function(t,n,e,i){Wn.prototype.xP.call(this,t,n,e,i),this.dl()},s.prototype.NP=function(t,n,e,i){Wn.prototype.NP.call(this,t,n,e,i),this.dl()},s.prototype.scaleEvaluate=function(t,n,e,i){var r,o,a,u,s,r=this;if(r.rX(t),r.contains(n,e)){if(T(i))return g;try{if(o=at(i),a=r.bX(t,n,e,r.minType(),r.minValue()),u=r.bX(t,n,e,r.midType(),r.midValue()),(s=r.bX(t,n,e,r.maxType(),r.maxValue()))<a)return g;if(isNaN(u)){if(!isNaN(a)&&!isNaN(s))return r.yX(o,a,s)}else if(!isNaN(a)&&!isNaN(s))return o<a?0:s<=o?2:a<=o&&o<=u?r.yX(o,a,u):1+r.yX(o,a,s)}catch(t){}}return g},s.prototype.twoScaleRuleEvaluate=function(t,n,e,i){var r,i,r,o,t,n;if(!T(i)){if(r={},i=ot(i)&&ut(i,r)?r.value:NaN,isNaN(i))return g;if(o=(r=this).bX(t,n,e,r.minType(),r.minValue()),t=r.bX(t,n,e,r.maxType(),r.maxValue()),!T(o)&&!T(t))return n=r.yX(i,o,t),r.wX(n,r.minColor(),r.maxColor())}return g},s.prototype.threeScaleRuleEvaluate=function(t,n,e,i){var r,o,i,o,a,t,n,r=this;if(r.MX=t,!T(i)){if(o={},i=ot(i)&&ut(i,o)?o.value:NaN,isNaN(i))return g;if(o=r.bX(t,n,e,r.minType(),r.minValue()),a=r.bX(t,n,e,r.midType(),r.midValue()),t=r.bX(t,n,e,r.maxType(),r.maxValue()),!T(o)&&!T(t)&&!T(a))return n=void 0,t<o?g:i<=o||o===t?t<=i?r.maxColor():r.minColor():t<=i?r.maxColor():i<=a?(n=r.yX(i,o,a),r.wX(n,r.minColor(),r.midColor())):(n=r.yX(i,a,t),r.wX(n,r.midColor(),r.maxColor()))}return g},s.prototype.evaluate=function(t,n,e,i){return this[I[this.ruleType()]+"Evaluate"](t,n,e,i)},s.prototype.Hc=function(){var t=this;t.minValue(g),t.minType(1),t.midValue(50),t.midType(4),t.maxValue(g),t.maxType(2),10===t.ruleType()&&(t.minColor(Ot(0,255,255,255)),t.maxColor(Ot(255,99,190,123))),11===t.ruleType()&&(t.midValue(50),t.midType(4),t.minColor(Ot(255,248,105,107)),t.midColor(Ot(255,255,235,132)),t.maxColor(Ot(255,99,190,123)))},s.prototype.reset=function(){var t=this;t.ranges(g),t.condition(g),t.style(g),t.Hc(),t.MX=g,t.stopIfTrue(!1),t.priority(1)},s.prototype.toJSON=function(t){return Kt.call(this,t,On)},s.prototype.fromJSON=function(t,n,e){Xt.call(this,n,On,t,e),this.initCondition(n)},s.prototype.aX=function(){var t=this;if(kt(t.minValue())||kt(t.midValue())||kt(t.maxValue()))return!0},s.prototype.wh=function(t){var n,e,i,r,o,a,u,s,c,r,o,a,n=this;if(!n.aX())return T(n.condition())&&n.initCondition(),e=n.ruleType(),(i={n_:H,sqref:xt(n.ranges())}).pivot=T(n.pivotTableName)?S:"1",r=ke(n.minType()),o=n.minValue(),a=ke(n.maxType()),u=n.maxValue(),s=n.minColor(),c=n.maxColor(),!T(r)&&"autoMin"!==r||(r="min"),!T(a)&&"autoMax"!==a||(a="max"),i.c_=[{n_:"cfRule",type:"colorScale",priority:n.priority()?""+n.priority():"1",c_:[{n_:"colorScale",c_:[{n_:"cfvo",type:r,val:T(o)||Re(r)?S:pt(mt(o))},{n_:"cfvo",type:a,val:T(u)||Re(a)?S:pt(mt(u))}]}]}],T(s)||i.c_[0].c_[0].c_.push(wt(s)),T(c)||i.c_[0].c_[0].c_.push(wt(c)),11===e&&(r=ke(n.midType()),o=n.midValue(),a=n.midColor(),i.c_[0].c_[0].c_.splice(1,0,{n_:"cfvo",type:r,val:T(o)?50:pt(mt(o))}),T(a)||i.c_[0].c_[0].c_.splice(4,0,wt(a))),i},s.prototype.yh=function(t,n,e,i){var r,o,t,a,u,s,o,t,c,r=this,o=Te(t),t=Ae(t),a=o[0],o=2===o.length?o[1]:(u=o[1],o[2]),c=t[0],t=u?(s=t[1],t[2]):t[1];u?r.ruleType(I.threeScaleRule):r.ruleType(I.twoScaleRule),r.minColor(c),r.minValue(Be(a.val)),r.minType(Ne(a.type)),r.midColor(s),u&&!T(u.val)&&r.midValue(Be(u.val)),r.midType(Ne(u&&u.type)),r.maxColor(t),r.maxValue(Be(o.val)),r.maxType(Ne(o.type)),r.ranges(n),r.initCondition(i)},Rn=s,p.ScaleRule=Rn,i={minValue:n("minValue",g),minType:n("minType",5),minColor:n("minColor",g),midValue:n("midValue",50,g,function(t){var n=this;if(n.MX){if(2===n.midType())return n.vX(n.MX);if(1===n.midType())return n.mX(n.MX)}return t}),midType:n("midType",g),midColor:n("midColor",g),maxType:n("maxType",7),maxValue:n("maxValue",g),maxColor:n("maxColor",g)},b.extend(Rn.prototype,i),Bn=["ruleType","ranges","gradient","color","showBorder","borderColor","dataBarDirection","negativeFillColor","useNegativeFillColor","negativeBorderColor","useNegativeBorderColor","axisPosition","axisColor","showBarOnly","minType","minValue","maxType","maxValue","priority"],j(c,Qn=Rn),c.prototype.Hc=function(t){var n=this;n.gradient(!0),n.color(t),n.showBorder(!1),n.borderColor("black"),n.dataBarDirection(0),n.negativeFillColor("red"),n.useNegativeFillColor(!0),n.negativeBorderColor("black"),n.useNegativeBorderColor(!1),n.axisPosition(0),n.axisColor("black"),n.showBarOnly(!1)},c.prototype.reset=function(){var t=this;t.ranges(g),t.condition(g),t.style(g),t.Hc(Ot(255,99,142,198)),t.stopIfTrue(!1),t.priority(1),t.minValue(g),t.minType(5),t.midValue(g),t.midType(g),t.maxValue(g),t.maxType(7),t.minColor(g),t.midColor(g),t.maxColor(g)},c.prototype.CX=function(t,n,e,i){var r,o,a,u,s,c,o,r=this,a=i?r.maxType():r.minType(),u=i?r.maxValue():r.minValue();if(6!==a&&4!==a)return r.bX(t,n,e,a,u);for(s=0;s<Y(r.ranges());s++)if(r.ranges()[s].intersect(n,-1,1,-1)&&(o=r.ranges()[s]))return c=o.row,o=o.col,r.bX(t,c=-1===c?0:c,o=-1===o?0:o,a,u)},c.prototype.SX=function(t,n,e){var i=0;return e<=t&&n<t?[1,0]:t<=n&&t<e?[0,0]:e===n?[.5,0]:[(t-n)/(e-n),0]},c.prototype.TX=function(t,n,e){var i,r,o,r,i=.5,r=nt(e-n);return 0<e&&0<=n?e===n||e<=t?[.5,.5]:t<=n?[n/e*.5,.5]:[.5*nt(t/e),.5]:0<e&&n<0?(o=e>nt(n)?.5:e/r,r=e>nt(n)?n/r:-.5,0<t?e<=t?[o,.5]:[t/e*o,.5]:t<0?t<=n?[r,.5]:[t/n*r,.5]:[0,.5]):e<=0&&n<0?e===n?[-.5,.5]:e<=t?[-e/n*.5,.5]:t<=n?[-.5,.5]:[-t/n*.5,.5]:0===e&&0===n?[0,.5]:[i=-1,-1]},c.prototype.AX=function(t,n,e){var i,r,o,a,u,s,r,o,i=-1,r=nt(n),o=nt(e),a=nt(e-n),u=n<0?-1:1;return 0<e&&0<=n||e<=0&&n<0?(s=tt(r,o),r=$(r,o),i=n<0?1:0,(o=nt(t))<=r&&o<s?[0,i]:s<=o&&r<o?[u,i]:r===s?[.5*u,i]:[u*(nt(t)-r)/a,i]):0<e&&n<0?(i=nt(n)/a,0===t?[0,i]:e<=t?[1-i,i]:[tt(t,n)/a,i]):0===e&&0===n?(i=.5,0===t?[0,i]:[.5*u,i]):[-1,i]},c.prototype.IX=function(t,n,e){var i=this;return 0===i.axisPosition()?i.AX(t,n,e):1===i.axisPosition()?i.TX(t,n,e):i.SX(t,n,e)},c.prototype.evaluate=function(t,n,e,i){var r,i,r,o,n,e,e,o,n,o,i,a;if(!T(i)){if(r={},i=ot(i,!0)&&ut(i,r)?r.value:NaN,isNaN(i))return g;if(o=(r=this).CX(t,n,e,!1),n=r.CX(t,n,e,!0),y(o,Date)&&(o=Bt.o0(o)),y(n,Date)&&(n=Bt.o0(n)),!T(o)&&!T(n))return n<o&&(e=n,n=o,o=e),e=void 0,!(o=r.IX(i,o,n))||Y(o)<2?g:(n=o[0],e=o[1],o=i<0&&r.useNegativeFillColor()?r.negativeFillColor():r.color(),i=i<0&&r.useNegativeBorderColor()?r.negativeBorderColor():r.borderColor(),a=r.axisColor(),o=Ht.vl(t,o),i=Ht.vl(t,i),a=Ht.vl(t,a),{fillColor:o,borderColor:i,showBorder:r.showBorder(),axisColor:a,isGradient:r.gradient(),direction:r.dataBarDirection(),axisLocation:e,scale:n,showBarOnly:r.showBarOnly()})}return g},c.prototype.toJSON=function(t){return Kt.call(this,t,Bn)},c.prototype.fromJSON=function(t,n,e){Xt.call(this,n,Bn,t,e),this.initCondition(n)},c.paintDataBar=function(t,n,e,i,r,o){var i,a,u,s,c,f,l,h,d,v,i,o,a,m,o,o,g,p,b,i=new R.Rect(e+2,i+2,r-4,o-4),a=i.x,u=i.y,s=et(nt(i.width*n.scale)),c=i.height;if(0===n.axisLocation)n.scale<=0&&(s=0);else if(1===n.axisLocation)n.scale<0?a=a+i.width-s:s=0;else{for(f=et(i.width*n.axisLocation+a)+.5,l=i.y,d=o-2,t.lineWidth=h=1,t.strokeStyle=n.axisColor,t.beginPath(),v=0;v<=d;v+=2)1===n.direction?(t.moveTo(2*e+r-f,l+v),t.lineTo(2*e+r-f,l+v+1)):(t.moveTo(f,l+v),t.lineTo(f,l+v+1));t.stroke(),0<n.scale?a=f+1:n.scale<0?a=f-s:s=0}n.showBorder&&(a=et(a)+.5,--s,u+=.5,--c),o=(i=a)+s,1===n.direction&&(i=2*e+r-a-s,o=2*e+r-a),0<=s&&0<=c&&(a=n.fillColor,n.isGradient&&(m=.9,a=t.createLinearGradient(i,u,o,u),o=jt._(n.fillColor),o=Ot(o.a,et(229.5+o.r*(1-.9)),et(229.5+o.g*(1-.9)),et(229.5+o.b*(1-.9))),g=n.scale<0?1-.9:.9,p=n.fillColor,b=n.scale<0?1:0,1===n.direction?(a.addColorStop(g,p),a.addColorStop(b,o)):(a.addColorStop(g,o),a.addColorStop(b,p))),t.fillStyle=a,t.fillRect(i,u,s,c),n.showBorder)&&0<s&&0<c&&(t.strokeStyle=n.borderColor,t.strokeRect(i,u,s,c))},c.prototype.oX=function(){var t,n,e,i,r,o,a,u,s,t=this,n={n_:H,sqref:xt(t.ranges())};return n.pivot=T(t.pivotTableName)?S:"1",e=t.showBarOnly()?0:S,i=ke(t.minType()),r=t.minValue(),o=ke(t.maxType()),a=t.maxValue(),u=t.color(),!T(i)&&"autoMin"!==i||(i="min"),!T(o)&&"autoMax"!==o||(o="max"),(s=[]).push({n_:"cfvo",type:i,val:T(r)||""===r||Re(i)?S:pt(mt(r))}),s.push({n_:"cfvo",type:o,val:T(a)||""===a||Re(o)?S:pt(mt(a))}),u&&s.push(wt(u)),n.c_=[{n_:"cfRule",type:"dataBar",priority:t.priority()?""+t.priority():"1",c_:[{n_:"dataBar",showValue:e,c_:s}]}],t.rJ&&n.c_[0].c_.push({n_:U,c_:[{n_:"ext",r_:[1,17],c_:[{n_:"id",c_:[t.rJ]}]}]}),n},c.prototype.IJ=function(){var t,n,e,i,e,r,r,o,o,a,u,s,t=this,n={n_:"conditionalFormatting",r_:[2]};return n.pivot=T(t.pivotTableName)?S:"1",i={n_:"cfRule",type:"dataBar",id:e=zt()},t.rJ=e,e={n_:"dataBar",minLength:0,maxLength:100},t.showBarOnly()&&(e.showValue="0"),t.showBorder()&&(e.border="1"),!1===t.gradient()&&(e.gradient="0"),!1===t.useNegativeFillColor()&&(e.negativeBarColorSameAsPositive="1"),t.useNegativeBorderColor()&&(e.negativeBarBorderColorSameAsPositive="0"),e.direction=1===t.dataBarDirection()?"rightToLeft":"leftToRight",1===(r=t.axisPosition())?e.axisPosition="middle":2===r&&(e.axisPosition="none"),r=[],(o=t.color())&&r.push(wt(o)),o=t.minType(),a=t.minValue(),u=t.maxType(),s=t.maxValue(),T(o)||5===o?r.push({n_:"cfvo",type:"autoMin"}):T(a)||""===a?r.push({n_:"cfvo",type:ke(o)}):r.push({n_:"cfvo",type:ke(o),c_:[{n_:"f",c_:[pt(gt(a))]}]}),T(u)||7===u?r.push({n_:"cfvo",type:"autoMax"}):T(s)||""===s?r.push({n_:"cfvo",type:ke(u)}):r.push({n_:"cfvo",type:ke(u),c_:[{n_:"f",c_:[pt(gt(s))]}]}),t.showBorder()&&t.borderColor()&&r.push(wt(t.borderColor(),S,"borderColor")),T(t.negativeFillColor())?r.push(wt("red",S,"negativeFillColor")):r.push(wt(t.negativeFillColor(),S,"negativeFillColor")),T(t.negativeBorderColor())?r.push(wt("black",S,"negativeBorderColor")):r.push(wt(t.negativeBorderColor(),S,"negativeBorderColor")),2!==t.axisPosition()&&r.push(wt(t.axisColor(),S,"axisColor")),e.c_=r,i.c_=[e],n.c_=[i,{n_:"sqref",c_:[xt(t.ranges())]}],n},c.prototype.wh=function(t,n){var e=this;if(!e.aX())return n?e.IJ():e.oX()},c.prototype.uX=function(t,n){var e,i,r,r,i,r,e=this,i=Te(t),r=Ae(t);e.color(r[0]),r=i[0],i=i[1],e.minType(Ne(r.type)),e.minValue(Be(r.val)),e.maxType(Ne(i.type)),e.maxValue(Be(i.val)),e.priority(+t.priority),e.ranges(n),r=w(t,"dataBar"),T(r.showValue)||e.showBarOnly(!Yt(r.showValue,!0)),t.c_[1]&&t.c_[1].n_===U&&(e.rJ=fe(t.c_[1]))},c.prototype.sX=function(t,n){var e,i,r,o,a,a,r,o,a,r,o,a,e=this,i=w(t,"dataBar");T(i.showValue)||e.showBarOnly(!Yt(i.showValue,!0)),T(i.border)||e.showBorder(Yt(i.border,!1)),T(i.gradient)||e.gradient(Yt(i.gradient,!0)),T(i.direction)||e.dataBarDirection("rightToLeft"===i.direction?1:0),T(i.axisPosition)||e.axisPosition(+pn[i.axisPosition]),T(i.negativeBarColorSameAsPositive)||e.useNegativeFillColor(!Yt(i.negativeBarColorSameAsPositive,!1)),T(i.negativeBarBorderColorSameAsPositive)||e.useNegativeBorderColor(!Yt(i.negativeBarBorderColorSameAsPositive,!0)),2===(r=yt(i,"cfvo")).length&&(e.minType(Ne(r[0].type)),o=yt(r[0],"f"),a=Fe(r[0],o&&o[0]),T(a)||e.minValue(Be(a)),e.maxType(Ne(r[1].type)),o=yt(r[1],"f"),a=Fe(r[1],o&&o[0]),T(a)||e.maxValue(Be(a))),(r=w(i,"fillColor"))&&e.color(Mt(r)),(o=w(i,"borderColor"))&&e.borderColor(Mt(o)),(a=w(i,"negativeFillColor"))&&e.negativeFillColor(Mt(a)),(r=w(i,"negativeBorderColor"))&&e.negativeBorderColor(Mt(r)),(o=w(i,"axisColor"))&&e.axisColor(Mt(o)),(a=Ae(t))&&0<a.length&&e.color(a[0]),e.ranges(n)},c.prototype.yh=function(t,n,e,i,r,o){var a=this;r?a.sX(t,n):a.uX(t,n),a.initCondition(i)},Ln=c,p.DataBarRule=Ln,i={gradient:n("gradient",!0),color:n("color",g),showBorder:n("showBorder",!1),borderColor:n("borderColor","black"),dataBarDirection:n("dataBarDirection",0),negativeFillColor:n("negativeFillColor","red"),useNegativeFillColor:n("useNegativeFillColor",!0),negativeBorderColor:n("negativeBorderColor","black"),useNegativeBorderColor:n("useNegativeBorderColor",!1),axisPosition:n("axisPosition",0),axisColor:n("axisColor","black"),showBarOnly:n("showBarOnly",!1)},b.extend(Ln.prototype,i),Fn=le,p.IconCriterion=Fn,Pn=["ruleType","ranges","iconSetType","iconCriteria","showIconOnly","reverseIconOrder","priority","icons"],j(m,Jn=Rn),m.prototype.xX=function(t){var n=this;n.iconSetType(t,!1),n.iconSetType()>=vn.threeArrowsColored&&n.iconSetType()<=vn.threeSymbolsUncircled?(n.hJ=[],n.hJ[0]=new Fn(!0,mn.percent,33),n.hJ[1]=new Fn(!0,mn.percent,67),n.iJ=[],n.iJ[0]={iconSetType:t,iconIndex:0},n.iJ[1]={iconSetType:t,iconIndex:1},n.iJ[2]={iconSetType:t,iconIndex:2}):n.iconSetType()>=vn.fourArrowsColored&&n.iconSetType()<=vn.fourTrafficLights?(n.hJ=[],n.hJ[0]=new Fn(!0,mn.percent,25),n.hJ[1]=new Fn(!0,mn.percent,50),n.hJ[2]=new Fn(!0,mn.percent,75),n.iJ=[],n.iJ[0]={iconSetType:t,iconIndex:0},n.iJ[1]={iconSetType:t,iconIndex:1},n.iJ[2]={iconSetType:t,iconIndex:2},n.iJ[3]={iconSetType:t,iconIndex:3}):n.iconSetType()>=vn.fiveArrowsColored&&n.iconSetType()<=vn.fiveBoxes?(n.hJ=[],n.hJ[0]=new Fn(!0,mn.percent,20),n.hJ[1]=new Fn(!0,mn.percent,40),n.hJ[2]=new Fn(!0,mn.percent,60),n.hJ[3]=new Fn(!0,mn.percent,80),n.iJ=[],n.iJ[0]={iconSetType:t,iconIndex:0},n.iJ[1]={iconSetType:t,iconIndex:1},n.iJ[2]={iconSetType:t,iconIndex:2},n.iJ[3]={iconSetType:t,iconIndex:3},n.iJ[4]={iconSetType:t,iconIndex:4}):n.iconSetType()>vn.fiveBoxes&&(n.hJ=[],n.iJ=[])},m.prototype.Hc=function(t){this.showIconOnly(!1),this.reverseIconOrder(!1),this.xX(t)},m.prototype.NX=function(t){var n=Y(this.hJ)+1;return this.reverseIconOrder()&&2<n?n-1-t:t},m.prototype.bX=function(t,n,e,i){var r,o,r=this,o=r.hJ[i];if(o)switch(o.iconValueType){case mn.formula:case mn.number:return r.dX(t,n,e,o.iconValue);case mn.percent:return r.gX(t,n,e,o.iconValue);case mn.percentile:return r.pX(t,n,e,o.iconValue);default:return g}},m.prototype.evaluate=function(t,n,e,i){var r,o,a,u,o,i,s,c,f,l,h,c,a,i,r=this,o=i;if(T(o))return g;if(a={},u=ot(i,!0)&&"boolean"!=typeof o&&ut(i,a)?a.value:NaN,isNaN(u))return g;if(o=0,i=r.iconSetType(),s=r.hJ,i>=vn.fiveArrowsColored?o=5:i>=vn.fourArrowsColored?o=4:i>=vn.threeArrowsColored&&(o=3),!s)return 0;for(f=0,l=o-1;0<l;l--)if(l<Y(s)+1&&(c=s[l-1],!T(c&&c.iconValue))&&(h=r.bX(t,n,e,l-1),!T(h))&&(c=c.isGreaterThanOrEqualTo?h<=u:h<u,u<Number.MAX_VALUE)&&c){f=l;break}return a=r.NX(f),(i=r.iJ)?{iconSetType:i[a]?i[a].iconSetType:vn.noIcons,iconIndex:i[a]?i[a].iconIndex:0,showIconOnly:r.showIconOnly()}:{iconSetType:vn.noIcons,iconIndex:0,showIconOnly:r.showIconOnly()}},m.prototype.reset=function(){var t=this;t.ranges(g),t.condition(g),t.style(g),t.showIconOnly(!1),t.reverseIconOrder(!1),t.iconSetType(0,g),t.hJ=g,t.stopIfTrue(!1),t.priority(1),t.minColor(g),t.minValue(g),t.minType(5),t.midColor(g),t.midValue(g),t.midType(g),t.maxColor(g),t.maxValue(g),t.maxType(7),t.iJ=g},m.prototype.icons=function(t){return 1===arguments.length&&(this.iJ=t),this.iJ},m.prototype.iconCriteria=function(){return this.hJ},m.prototype.toJSON=function(t){return Kt.call(this,t,Pn)},m.prototype.fromJSON=function(t,n,e){Xt.call(this,n,Pn,t,e),this.initCondition(n)},m.prototype.aX=function(){var t,n,e,i,t,n=this.hJ;if(n&&0<n.length)for(e=0;e<n.length;e++)if(i=n[e].iconValue,kt(i))return!0},m.prototype.oX=function(){var t,n,e,i,r,o,a,u,t=this,n={n_:H,sqref:xt(t.ranges())};for(n.pivot=T(t.pivotTableName)?S:"1",e=t.iconSetType(),T(e)&&(e=0),n.c_=[{n_:"cfRule",type:"iconSet",priority:t.priority()?""+t.priority():"1",c_:[{n_:"iconSet",iconSet:_e(e),reverse:t.reverseIconOrder()?"1":S,showValue:t.showIconOnly()?"0":S,c_:[{n_:"cfvo",type:"percent",val:"0"}]}]}],i=n.c_[0].c_[0].c_,o=0,a=(r=t.hJ).length;o<a;o++)u=r[o],i.push({n_:"cfvo",type:je(u.iconValueType),val:pt(gt(u.iconValue)),gte:!1===u.isGreaterThanOrEqualTo?"0":S});return t.rJ&&n.c_[0].c_.push({n_:U,c_:[{n_:"ext",r_:[1,17],c_:[{n_:"id",c_:[t.rJ]}]}]}),n},m.prototype.IJ=function(){var t,n,e,i,e,r,e,o,a,u,s,c,f,l,h,d,v,h,h,t=this,n={n_:"conditionalFormatting",r_:[2]};for(n.pivot=T(t.pivotTableName)?S:"1",i={n_:"cfRule",type:"iconSet",id:e=zt()},t.rJ=e,T(t.priority())||(i.priority=t.priority()),r={n_:"iconSet",iconSet:_e(e=t.iconSetType())},(e=be(e,t.iJ))&&(r.custom=1),t.showIconOnly()&&(r.showValue=0),!t.reverseIconOrder()||e||(r.reverse=1),o=[{n_:"cfvo",type:"percent",c_:[{n_:"f",c_:["0"]}]}],a=t.hJ,e&&t.reverseIconOrder()&&(a=a.concat([]).reverse()),u=0;u<a.length;u++)!(c={n_:"cfvo",type:je((s=a[u]).iconValueType),c_:[{n_:"f",c_:[pt(mt(s.iconValue))]}]})===s.isGreaterThanOrEqualTo&&(c.gte=0),o.push(c);for(f=t.iJ,l=0;l<f.length;l++)h={n_:"cfIcon",iconSet:_e((h=Pe(d=(h=f[l]).iconSetType,v=h.iconIndex)).iconSetType),iconId:h.iconIndex},o.push(h);return r.c_=o,i.c_=[r],n.c_=[i,{n_:"sqref",c_:[xt(t.ranges())]}],n},m.prototype.wh=function(t,n){var e=this;if(!e.aX())return T(e.condition())&&e.initCondition(),n?e.IJ():e.oX()},m.prototype.uX=function(t,n){var e,i,r,o,a,u,s,c,e=this,i=t.c_[0];if(i)for(r=De(i.iconSet||"3TrafficLights1"),e.showIconOnly(!Yt(i.showValue,!0)),e.reverseIconOrder(Yt(i.reverse,!1)),e.iconSetType(r),e.ranges(n),a=1,u=(o=Te(t)).length;a<u;a++)s=e.hJ[a-1],c=o[a],s?(c.type&&(s.iconValueType=Oe(c.type)),T(c.val)||(s.iconValue=Xn(c.val)),T(c.gte)||(s.isGreaterThanOrEqualTo=Yt(c.gte))):(s=new Fn(Yt(c.gte),Oe(c.type),Xn(c.val)),e.hJ[a-1]=s);t.c_[1]&&t.c_[1].n_===U&&(e.rJ=fe(t.c_[1]))},m.prototype.sX=function(t,n){var e,t,i,r,o,a,u,s,c,f,l,h,e=this,t=w(t,"iconSet");for(e.iconSetType(De(t.iconSet)),e.ranges(n),T(t.showValue)||e.showIconOnly(!Yt(t.showValue,!0)),T(t.reverse)||e.reverseIconOrder(Yt(t.reverse,!1)),r=1,o=(i=yt(t,"cfvo")).length;r<o;r++)a=e.hJ[r-1],s=(u=i[r]).val,T(s)&&(c=w(u,"f"),s=z(c&&c.c_&&c.c_[0])),a?(u.type&&(a.iconValueType=Oe(u.type)),T(s)||(a.iconValue=0===s?"=0":Xn(s)),T(u.gte)||(a.isGreaterThanOrEqualTo=Yt(u.gte))):(a=new Fn(Yt(u.gte),Oe(u.type),Xn(s)),e.hJ[r-1]=a);for(r=0,o=(f=yt(t,"cfIcon")).length;r<o;r++)l=e.iJ[r],h=f[r],l&&(T(h.iconSet)||(l.iconSetType=De(h.iconSet)),T(h.iconId)||(l.iconIndex=+h.iconId))},m.prototype.yh=function(t,n,e,i,r,o){var a=this;r?a.sX(t,n):a.uX(t,n),a.initCondition(i)},m.getIcon=function(t,n){return g},m.kX=function(t,n,e,i,r,o,a){var u;a.jt(n)?(u=a.Ot(n),t.drawImage(u,e,i,r,o)):a.Rt(n)},m.paintIconSet=function(t,n,e,i,r,o,a,u,s,c){var f,a,l,h,d,v,u,l,h=C.W.V(a.font,1).fontSize,d=2,v=2,f=e+2;if(n.showIconOnly&&(1===a.hAlign?f=e+r/2-h/2:2===a.hAlign&&(f=e+r-2-h-2)),a=1===a.vAlign?i+o/2-h/2:2===a.vAlign?i+o-2-u/2-h/2:i+2+u/2-h/2,n.iconSetType!==vn.noIcons)if((u=m.getIcon(n.iconSetType,n.iconIndex))&&"string"===b.getType(u)&&c)try{m.kX(t,u,f,a,h,h,c)}catch(t){}else ee(t,n,f,a,h,e,i,r,o)},Gn=m,p.IconSetRule=Gn,i={iconSetType:n("iconSetType",vn.threeArrowsColored,function(t){this.xX(t)}),reverseIconOrder:n("reverseIconOrder",!1),showIconOnly:n("showIconOnly",!1)},b.extend(Gn.prototype,i),Un=["ruleType","state","style","priority","stopIfTrue","ranges"],j(D,Kn=e),D.prototype.JJ=function(t,n){var e,i,r,o,e=this.ranges();if(e)for(i=Y(e),r=void 0,o=0;o<i;o++)if((r=e[o]).contains(t,n))return o;return-1},D.prototype.zT=function(t){return-1<t},D.prototype.getExpected=function(t){void 0===t&&(t=0);var n=this.style();return Vt(n)?n[t]:n},D.prototype.isRow=function(){var t,n,t=this,n=t.ruleType();return T(t.DX)&&(n===I.rowStateRule?t.DX=!0:n===I.columnStateRule&&(t.DX=!1)),this.DX},D.prototype.isStateRule=function(){return!0},D.prototype._X=function(){var t,n,t,t=this,n=t.state(),t=t.ranges();return(0,p.aJ)(v.stateCondition,gn.contains,n,S,S,S,t)},D.prototype.rowStateRuleCreateCondition=function(){return this._X()},D.prototype.columnStateRuleCreateCondition=function(){return this._X()},D.prototype.createCondition=function(){return this[I[this.ruleType()]+"CreateCondition"]()},D.prototype.EX=function(t){var n;return D.StatesPriority.indexOf(this.state())<D.StatesPriority.indexOf(t.state())},D.prototype.fromJSON=function(t,n,e){var i=Un;T(t.condition)||(i=Un.concat(["condition"])),Xt.call(this,n,i,t,e),this.initCondition(n)},D.prototype.toJSON=function(t){var n,t,e,n=this;return T(n.condition())&&this.initCondition(),t=Kt.call(n,t,Un),(e=n.ruleType())===I.conditionRuleBase&&(t.condition=n.condition().toJSON()),t},D.StatesPriority=[4,C.RowColumnStates.invalid,C.RowColumnStates.dirty,C.RowColumnStates.invalidFormula,C.RowColumnStates.inserted,256,C.RowColumnStates.selected,C.RowColumnStates.active,C.RowColumnStates.hover,C.RowColumnStates.edit],Hn=D,(p.StateRule=Hn).prototype.state=n("state",g),_.prototype.getUsedRange=function(){var t,n,e,i,r,o,a,u,s,c,t,n=this.getRules(),e={};if(n)for(i=void 0,r=0,o=n;r<o.length;r++)for(u=0,s=i=(a=o[r]).ranges();u<s.length;u++)c=s[u],P(e,G(c));return e},_.prototype.L0=function(){this.eJ=g},_.prototype.getRule=function(t){return this.qK[t]},_.prototype.count=function(){return Y(this.qK)},_.prototype.jX=function(){return this.qK},_.prototype.GJ=function(t){for(var n,e,i,r,o,n=[],e=this.eJ,i=Y(t),r=0;r<i;r++)o=e.JS(t[r]),n.push(o);return n},_.prototype.OX=function(t){for(var n,e,i,r,o,a,n=[],e=this.eJ,i=0,r=Y(t);i<r;i++)o=t[i],a=new Rt(o.row,o.col,Z(o),W(o)),0===o.row&&Z(o)===e.getRowCount()&&(a.row=-1),0===o.col&&W(o)===e.getColumnCount()&&(a.col=-1),n.push(a);return n},_.prototype.C8=function(){if(this.nJ&&(this.tJ={},this.qK))for(var t=0;t<Y(this.qK);t++)this.fE(this.qK[t])},_.prototype.TJ=function(){this.nJ&&(this.tJ={})},_.prototype.fE=function(t){var n,e,i,r,o,a,u,n,s,c,f,l,h,d,v,m,g,p;if(this.nJ)for(e=(n=this).tJ,u=n.GJ(t.ranges()),s=(n=n.eJ).getRowCount(),c=n.getColumnCount(),f=0;f<Y(u);f++)for(h=(l=u[f]).row,d=l.col,s<=h+(v=Z(l))-1&&(v=s-h),c<=d+(m=W(l))-1&&(m=c-d),g=0;g<v;g++)for((i=e[o=g+h])||(e[o]=i=[]),p=0;p<m;p++)(r=i[a=p+d])||(i[a]=r=[]),r.push(t)},_.prototype.RX=function(t){var n,e,i,r,o,a,u,s,c,f,l,h;if(this.nJ)for(n=this.tJ,a=this.GJ(t.ranges()),u=0;u<Y(a);u++)for(s=a[u],c=0;c<Z(s);c++)if(e=n[r=c+s.row])for(f=0;f<W(s);f++)if(i=e[o=f+s.col]){for(l=[],h=0;h<Y(i);h++)i[h]!==t&&l.push(i[h]);0===Y(l)&&(l=S),e[o]=l}},_.prototype.BX=function(t,n,e,i){var r,o,a,u,s,c;if(this.nJ)for(-1===n&&(n=0,i=this.eJ.getColumnCount()),-1===t&&(t=0,e=this.eJ.getRowCount()),a=this.tJ,s=0;s<e;s++)if(u=a[r=s+t])for(c=0;c<i;c++)u[o=c+n]=S},_.prototype.LX=function(t,n){for(var e,i,r,e=[],i=0;i<Y(this.qK);i++)(r=this.qK[i]).contains(t,n)&&e.push(r);return e},_.prototype.addSpecificTextRule=function(t,n,e,i){var i=new k(2,i,e,t,g,g,n);return this.addRule(i)},_.prototype.addCellValueRule=function(t,n,e,i,r){var r=new k(1,r,i,t,he(n),he(e));return this.addRule(r)},_.prototype.addDateOccurringRule=function(t,n,e){var e=new k(4,e,n,g,g,g,g,g,t);return this.addRule(e)},_.prototype.addFormulaRule=function(t,n,e){var e=new k(3,e,n,g,g,g,g,t);return this.addRule(e)},_.prototype.addTop10Rule=function(t,n,e,i){var i=new k(5,i,e,g,g,g,g,g,t,n);return this.addRule(i)},_.prototype.addUniqueRule=function(t,n){var n=new k(6,n,t);return this.addRule(n)},_.prototype.addDuplicateRule=function(t,n){var n=new k(7,n,t);return this.addRule(n)},_.prototype.addAverageRule=function(t,n,e){var e=new k(8,e,n,g,g,g,g,g,t);return this.addRule(e)},_.prototype.add3ScaleRule=function(t,n,e,i,r,o,a,u,s,c){var t,t=0===arguments.length?new Rn(11):new Rn(11,t,n,e,i,r,o,a,u,s,c);return this.addRule(t)},_.prototype.add2ScaleRule=function(t,n,e,i,r,o,a){var t,t=0===arguments.length?new Rn(10):new Rn(10,t,n,e,g,g,g,i,r,o,a);return this.addRule(t)},_.prototype.addDataBarRule=function(t,n,e,i,r,o){var t,t=0===arguments.length?new Ln:new Ln(t,n,e,i,r,o);return this.addRule(t)},_.prototype.addIconSetRule=function(t,n){var t=new Gn(t,n);return this.addRule(t)},_.prototype.addRowStateRule=function(t,n,e){var i,t,i=this,t=new Hn(I.rowStateRule,t,n,e);return i.addRule(t)},_.prototype.addColumnStateRule=function(t,n,e){var i,t,i=this,t=new Hn(I.columnStateRule,t,n,e);return i.addRule(t)},_.prototype.addRule=function(t){var n,e,i,r,o,a,a,a,r,o,u,s,c,f,l,h,n=this,e=n.eJ;if(e){if(!t)throw new Error(Zt().Exp_RuleIsNull);for(o=r=void 0,(i=t.ranges())&&(r=(a=Dt(i)).r,o=a.c,t.ranges(i.slice(0))),(a=(a=t.getExpected())&&a.formatter)&&"string"==typeof a&&e.SL(r||0,o||0,a),t.isStateRule()&&(r=t.state(),o=t.isRow(),e._1)&&e._1.enableState(r,o),e.Ut.vJ(),u=1,s=void 0,c=Y(n.qK),s=0;s<c;s++)h=(l=(f=n.qK[s])._ps).priority||1,l.priority=h+1,t.isStateRule()&&f.isStateRule()&&t.EX(f)&&(u=tt(u,l.priority),--l.priority);return t.priority(u),n.qK.push(t),_.et(e,"onRuleAdded",{ranges:i}),e.ki(C.Events.WorksheetDataChanged,{type:"conditionFormat"}),t.context(e),n.fE(t),e.Ut.vJ(!0),e.zw(),t}},_.prototype.removeRule=function(t){var n,e,i,r,r,o,i,a,u,s,c,n=this,e=n.eJ,i=e.parent;if(e){if(t&&((r=(r=t.getExpected())&&r.formatter)&&"string"==typeof r&&i.bp[r]&&i.o3(r),e.Ut.vJ(),n.RX(t),Ft(n.qK,t),e.Ut.vJ(!0),_.et(e,"onRuleRemoved",{priority:t.priority(),ranges:t.ranges()}),t.isStateRule())){for(o=t.state(),i=t.isRow(),a=!1,u=0,s=n.qK;u<s.length;u++)if((c=s[u]).isStateRule()&&c.state()===o){a=!0;break}a||e._1.disableState(o,i)}e.zw()}},_.prototype.FX=function(t,n,e,i,r){var o,a,u,s,n,i,e,r,c,f,f,f,n;return t.intersect(n,e,i,r)?(o=t.row,a=t.row+Z(t)-1,u=t.col,s=t.col+W(t)-1,i=(n=n)+i-1,r=(e=e)+r-1,c=[],-1!==o&&-1!==u&&-1!==n&&-1!==e&&(0<e-u&&(f=V(o,u,Z(t),e-u),c.push(f)),0<s-r&&(f=V(o,1+r,Z(t),s-r),c.push(f)),0<n-o&&(f=V(o,tt(e,u),n-o,$(r,s)-tt(e,u)+1),c.push(f)),0<a-i)&&(n=V(1+i,tt(e,u),a-i,$(r,s)-tt(e,u)+1),c.push(n)),0<Y(c)?c:g):[t]},_.prototype.removeRuleByRange=function(t,n,e,i){var r,o,a,u,s,c,f,l,h,d,v,m,g,p,r=this,o=r.eJ;if(o){if(a=[],r.qK)for(o.Ut.vJ(),r.BX(t,n,e,i),u=0,s=Y(r.qK);u<s;u++)if(c=r.qK[u],_.et(o,"onRuleRemoved",{ranges:[new Rt(t,n,e,i)]}),c&&c.ranges()&&c.intersects(t,n,e,i))if(o.pivotTables&&c.pivotTableName)(f=o.pivotTables.get(c.pivotTableName)).tqt(c,t,n,e,i);else{for(l=[],h=r.GJ(c.ranges()),d=0,v=Y(h);d<v;d++)(m=r.FX(h[d],t,n,e,i))&&(l=l.concat(m));0<Y(l)?c.ranges(r.OX(l)):a.push(c)}for(g=0,p=Y(a);g<p;g++)Ft(r.qK,a[g]);o.Ut.vJ(!0),o.zw()}},_.prototype.clearRule=function(){var t,n,e,i,r,o,a,a,u,s,t=this,n=t.eJ,e=n.parent;if(n){for(i=t.qK,n.Ut.vJ(),r=0;r<i.length;r++)a=(a=(o=i[r]).getExpected())&&a.formatter,_.et(n,"onRuleRemoved",{ranges:o.ranges()}),a&&"string"==typeof a&&e.bp[a]&&e.o3(a);if(n.pivotTables)for(u=n.pivotTables.all(),r=0;r<u.length;r++)(s=u[r]).iqt();t.qK.length=0,t.C8(),n.Ut.vJ(!0),n.zw()}},_.prototype.getRules=function(t,e){var n,i,r,i,o,a,i,u,s,c,n=this,i=n.qK;if(0===arguments.length||0===Y(i))return i;if(t=t===S?-1:t,e=e===S?-1:e,r=[],n.nJ)i=n.tJ,a=void 0,-1!==t&&-1!==e?(a=i[t])&&(o=a[e],de(r,o)):-1===t?b.each(i,function(t,n){o=n[e],de(r,o)}):(a=i[t])&&b.each(a,function(t,n){de(r,n)});else if(u=(i=n.eJ).getRowCount(),s=i.getColumnCount(),c=void 0,-1!==t&&-1!==e)de(r,n.LX(t,e));else if(-1===t)for(c=0;c<u;c++)de(r,n.LX(c,e));else for(c=0;c<s;c++)de(r,n.LX(t,c));return r},_.prototype.containsRule=function(t,n,e){return!(!t||!Lt.OS(this.qK,t))&&t.contains(n,e)},_.prototype.PX=function(t,n){var e,i,r,o,a,r,r,r,u,s,c,f,e=this,i=e.eJ;if(i){if(!t)throw new Error(Zt().Exp_RuleIsNull);for(a=o=void 0,(r=t.ranges())&&(o=(r=Dt(r)).r,a=r.c),(r=(r=t.getExpected())&&r.formatter)&&"string"==typeof r&&i.SL(o||0,a||0,r),i.Ut.vJ(),u=0,s=Y(e.qK);u<s;u++)n<=(f=(c=e.qK[u]._ps).priority||1)&&(c.priority=f+1);return t.priority(n),(e.qK[n]=t).context(i),e.fE(t),i.zw(),t}},_.prototype.qJ=function(t,n,e){var i,r,o,a,u,s,c,f,i=this,r,o=i.eJ.Ut,a=i.qK,u=Y(a),s=!1;for(o.vJ(),c=0;c<u;c++)(f=a[c])&&f.qJ(t,n,e)&&(s=!0);s&&i.C8()},_.prototype.$J=function(t,n,e,i,r){var o,a,u,s,o=this;if(o.qK&&o.eJ)for(a=Y(o.qK),u=0;u<a;u++)(s=o.qK[u])&&(e?s.JO(t,n,i,r):s.qO(t,n,i,r));o.C8()},_.prototype.JO=function(t,n,e,i){this.$J(t,n,!0,e,i)},_.prototype.qO=function(t,n,e,i){this.$J(t,n,!1,e,i)},_.prototype.tX=function(t,n,e,i,r){var o,a,u,s,o=this;if(o.qK&&o.eJ)for(u=(a=Y(o.qK))-1;0<=u;u--)(s=o.qK[u])&&(e?s.xP(t,n,i,r):s.NP(t,n,i,r),s.ranges().length<=0)&&(o.RX(s),o.qK.splice(u,1));o.C8()},_.prototype.xP=function(t,n,e,i){this.tX(t,n,!0,e,i)},_.prototype.NP=function(t,n,e,i){this.tX(t,n,!1,e,i)},_.prototype.dl=function(){var t,n,e,i,t=this.qK;if(t!==g&&0<Y(t))for(e=0,i=Y(t);e<i;e++)(n=t[e]).dl&&n.dl()},_.prototype.jB=function(t,n,e,B,L,i,r,F,P){var o,a,u,G,s,c,f,U,l,h,d,v,m,g,p,b,y,w,M,C,S,w,H,T,A,I,x,N,I,N,k,D,_,z,E,j,O,R,j,O,j,O,o=[],a=[],u=[],G=[],s=[],c=this,f=c.eJ,U=!P&&f.o5();for(-1===t&&(B=t=0,i=f.getRowCount()),-1===n&&(L=n=0,r=f.getColumnCount()),l=0;l<i;l++)for(h=0;h<r;h++)for(d=c.getRules(t+l,n+h),v=0;v<Y(d);v++)if(g=(m=d[v]).ranges(),!m.isStateRule()){for(p=[],b=0;b<Y(g);b++)y=g[b],M=(w=f.JS(y)).row,C=w.col,S=Z(w),w=W(w),(H=Pt(u,y)<=-1||-1<Pt(u,y)&&Pt(G,m)<=-1)&&y.contains(t+l,n+h)&&(u.push(y),G.push(m),(T=V(B+l,L+h,-1,-1)).rowCount=i+t<=M+S?i-l:t<M?S:M+S-t,T.colCount=r+n<=C+w?r-h:n<C?w:C+w-n,c===e&&y.containsRange(T)||p.push(T),F)&&!pe(s,T)&&s.push(T);0<p.length&&((A=o.indexOf(m))<0?(U&&(p=c.GX(p)),o.push(m),a.push(p)):(U&&(x=I=void 0,N=a[A][0].row,k=a[A][0].col,I=(D=p[0]).row-N,x=D.col-k,N=f.lT(N,I,!(I=N=void 0)),I=f.lT(k,x),D.row+=N,D.col+=I,p=c.GX(p)),a[A]=a[A].concat(p)))}for(_=0,z=o.length;_<z;_++)j=(E=c.pJ(o[_].toJSON(),o[_].context())).ranges(),E.ranges(a[_]),(O=E.D5)&&(R=1===f.parent.options.referenceStyle,j=Dt(j),O=Q.formulaToExpression(f,O,j.r,j.c,R),j=Dt(a[_]),O=Q.expressionToFormula(f,O,j.r,j.c,R),E.formula(O)),e.addRule(E);return c.C8(),s},_.prototype.GX=function(t){var n,e,t,i,r,o,a,u,s,c,f,l,h,n,e=this.eJ,i=[];if(0<t.length){for(r=(t=t[0]).row,o=t.col,a=t.rowCount,u=t.colCount,a+=e.lT(r,a,!0),u+=e.lT(o,u),s=[],c=void 0,f=0;f<u;f++)0===f?c=new Rt(r,o,1,1):0!==e.getColumnWidth(o+f)?c.colCount++:(s.push(c),f=e.O5(o+f-1)-1-o,c=new Rt(r,o+f+1,1,0));for(s.push(c),l=0;l<a;l++)if(0!==l)if(0!==e.getRowHeight(r+l))for(h=0;h<s.length;h++)s[h].rowCount++;else for(i=i.concat(ge(s)),l=e.j5(r+l-1)-1-r,h=0;h<s.length;h++)s[h].rowCount=0,s[h].row=r+l+1;i=i.concat(s)}return i},_.prototype.OB=function(t,n,e,i,r,o){var a,u,s,c,f,l,h,d,v,m,g,p,b,y,w,M,C,S,w,T,a=[],u=this,s=u.eJ,c=s.getRowCount(3),f=s.getColumnCount(3);for(-1===t&&(t=0,e=s.getRowCount()),-1===n&&(n=0,i=s.getColumnCount()),l=0;l<e;l++)for(h=0;h<i;h++)for(d=u.getRules(t+l,n+h),v=0;v<Y(d);v++)if(g=(m=d[v]).ranges(),!m.isStateRule()){for(p=[],b=0;b<Y(g);b++)y=g[b],M=(w=s.JS(y)).row,C=w.col,S=Z(w),w=W(w),pe(r,y)||Pt(a,y)<=-1&&y.contains(t+l,n+h)&&(a.push(y),M<t&&p.push(V(M,C,t-M,w)),C<n&&p.push(V(tt(t,M),C,$(t+e,M+S)-tt(t,M),n-C)),n+i<C+w&&p.push(V(tt(t,M),n+i,$(t+e,M+S)-tt(t,M),C+w-(n+i))),t+e<M+S)&&p.push(V(t+e,C,M+S-(t+e),w));s&&s.Ut.vJ(),u.UX(s,a,r,g,c,f,o),0<(T=g.concat(p)).length?(m.XJ(),m.ranges(T)):u.removeRule(m)}u.C8()},_.prototype.UX=function(t,n,e,i,r,o,a){for(var u,s,c,f,l,h,u=0;u<Y(n);u++){if(c=[s=n[u]],a)for(f=0;f<Y(e);f++)l=e[f],s.intersect(l.row,l.col,l.rowCount,l.colCount)&&(c=c.concat(t.BR(s,l,r,o)));for(h=0;h<Y(c);h++)Ft(i,c[h])}},_.prototype._e=function(t,n,e,i,r,o,a,u){var s,c,f,l,h,d,h,d,v,l,s=16,c=!1,f=!1,l=u.sheet,h=u.row,d=u.col,v=l.zoom(),l=this.U(l,h,d,n,u.sheetArea),h=l&&l.iconSet,d=l&&l.dataBar;return(d||h)&&(t.save(),t.beginPath(),d&&(Ln.paintDataBar(t,d,e,i,r,o),c=d.showBarOnly),h&&((r<(s=parseInt(16*v+"",10))||o<s)&&(t.rect(e,i,r,o),t.clip(),t.beginPath()),Gn.paintIconSet(t,h,e,i,r,o,a,u.lineHeight,v,u.imageLoader),f=h.showIconOnly),t.restore()),c||f},_.prototype.U=function(t,n,e,i,r){var r,o,a,u,s,c,f,l,h,d,v,m;if(T(r)||3===r){if(r=this,s=(o=t.Jt).yl(n,e))a=s.i,u=s.d;else{if(c=r.getRules(n,e),0<(f=Y(c))){for(c.sort(function(t,n){return t.priority()-n.priority()}),h=l=g,m=v=d=void 0,m=0;m<f&&(!l||!h);m++)(d=c[m])&&(y(d,Ln)&&(l=d),y(d,Gn))&&(h=d);if(l||h)for(l=h=g,m=0;m<f&&(!l||!h)&&!((d=c[m])&&(!l&&y(d,Ln)&&(l=d),!h&&y(d,Gn)&&(h=d),d.stopIfTrue())&&(v=d.evaluate(t,n,e,i)));m++);l&&(u=l.evaluate(t,n,e,i)),h&&(a=h.evaluate(t,n,e,i))}o.Ml(n,e,u,a)}return{dataBar:u,iconSet:a}}},_.prototype.O=function(t,n,e){var i,r,o;if(T(e)||3===e)for(i=this.getRules(t,n),r=0,o=Y(i);r<o;r++)if(i[r]instanceof Gn)return!0;return!1},_.prototype.toJSON=function(t){for(var n,e,i,n=[],e=0;e<Y(this.qK);e++)i=this.qK[e],n.push(i?i.toJSON(t):g);return 0===Y(n)?S:{rules:n}},_.prototype.fromJSON=function(t,n,e,i){var r,o,a,u,u;if(t&&(r=t.rules)){for(this.qK=[],o=Y(r),a=0;a<o;a++)(u=r[a]).pivot&&i||(u=this.pJ(u,n,e))&&this.qK.push(u);this.nJ=!ve(r),this.C8()}},_.prototype.xJ=function(t,n,e,i,r,o){var a,u;switch(t.type){case"dataBar":u=new Ln;break;case"iconSet":u=new Gn;break;case"colorScale":u=new Rn;break;default:u=new k}return u&&u.yh(t,n,e,i,o,void 0,r),u},_.prototype.pJ=function(t,n,e){var i,r,o,i=g;return t&&(o=(r=this.HX())[t.ruleType])&&(i=new o).fromJSON(t,n,e),i},_.prototype.HX=function(){var t;return this.$K||((t={})[0]=k,t[1]=k,t[2]=k,t[3]=k,t[4]=k,t[5]=k,t[6]=k,t[7]=k,t[8]=k,t[9]=Rn,t[10]=Rn,t[11]=Rn,t[12]=Ln,t[13]=Gn,t[14]=Hn,t[15]=Hn,this.$K=t),this.$K},_.prototype.NJ=function(t,n,e,i,r,o){var a,u,s,c,f,l,h,d,f,v,h,v,m;if(t&&t.c_&&!(t.c_.length<=0))for(s=0,c=(a=t.c_).length;s<c;s++)f=a[s],l=C.NodeHelper.ur(f.pivot),d=void 0,(h=w(f,"sqref"))&&(d=It(h.c_[0]),o)&&C.Util.Ao(e,d,!0,n),h=void 0,"dataBar"===(v=(f=w(f,"cfRule")).type)?(h=Le(i,f.id))||(h=new Ln,this.qK.push(h)):"iconSet"===v?(h=Le(i,f.id))||(h=new Gn,this.qK.push(h)):"expression"!==v&&"cellIs"!==v||(!u&&r.lossless&&((v=new C.SimpleSharedStrings).yh(r.lossless.sharedColors),(m=new C.SimpleSharedStrings).yh(r.lossless.commonSharedStrings),(u=new C.SharedDxfs(v,m)).rv(r.lossless.sharedDxfs)),h=new k(3),this.qK.push(h)),h&&(h.pivot=l,h.yh(f,d,n.styleManager,e,!0,u),T(f.priority)||h.priority(+f.priority))},_.prototype.bL=function(t,n,e,i){var r,o,a,u,s,c,f,l,h,d,l,h,r=this;if(r&&0<r.count()&&(o=r.getRules(n,e),a=Y(o),u=void 0,s=g,0<a))for(o.sort(function(t,n){return t.priority()-n.priority()}),c=0;c<a;c++)if(u=o[c]){if(f=r.eJ,u.isScaleRule())10!==u.ruleType()&&11!==u.ruleType()||(s=u.evaluate(f,n,e,f.getValue(n,e,i)))&&(t=t||new Et).backColor===S&&(t.backColor=s);else if(u.isStateRule()){if(i!==(T(u.nT)?C.SheetArea.viewport:u.nT))continue;l=u.state(),h=u.isRow(),d=u.ranges(),l=f._1.getState(n,e,l,h,d,i),(s=u.evaluate(f,n,e,l))&&(t=t||new Et,h=f.NMi&&i===C.SheetArea.colHeader,t.h5(s,!1,1,S,h))}else(s=u.evaluate(f,n,e,f.getValue(n,e,i)))&&(t=t||new Et).h5(s,!1,1);if(u.stopIfTrue()&&s)break}return t},_.prototype.wL=function(t,n,e,i){var r,o,a,u,s,c,f,l,h,h,d,v,d,v,r={yL:!1},o=this;if(o&&0<o.count()&&(a=o.getRules(t,n),u=Y(a),s=void 0,c=g,0<u))for(a.sort(function(t,n){return t.priority()-n.priority()}),f=0;f<u;f++)if(s=a[f]){if(l=o.eJ,s.isScaleRule()){if(h=s.ruleType(),"backColor"===e&&(10===h||11===h)&&(c=s.evaluate(l,t,n,l.getValue(t,n,i)))){r.Y6=c,r.yL=!0;break}}else if(s.isStateRule()){if(i!==(T(s.nT)?C.SheetArea.viewport:s.nT))continue;if(h=s.state(),d=s.isRow(),v=s.ranges(),d=l._1.getState(t,n,h,d,v,i),!((v=s.style())&&void 0!==v[e]||s.stopIfTrue()))continue;if((c=s.evaluate(l,t,n,d))&&c[e]!==S){r.Y6=c[e],r.yL=!0;break}}else{if(!((v=s.style())&&void 0!==v[e]||s.stopIfTrue()))continue;if((c=s.evaluate(l,t,n,l.getValue(t,n,i)))&&c[e]!==S){r.Y6=c[e],r.yL=!0;break}}if(s.stopIfTrue()&&c)break}return r},zn=_,t(p.ConditionalFormats=zn)},"./dist/plugins/conditional/conditional.ns.js":function(t,n,e){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.SR=void 0;var e=e("./dist/plugins/conditional/conditional.res.en.js");n.SR={en:e}},"./dist/plugins/conditional/conditional.res.en.js":function(t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.Exp_NotSupported=n.Exp_RuleIsNull=void 0,n.Exp_RuleIsNull="The argument 'rule' is null",n.Exp_NotSupported="Not supported exception"},"./dist/plugins/conditional/conditionalFormatIcon.js":function(B,t){"use strict";var s,c,f,l,n,e,i,r,o,a,u,h,d,v,v,m,g,p;function b(t,n,e,i,r){t.beginPath(),t.moveTo(n,e),t.lineTo(n+i,e),t.lineTo(n+i,e+r),t.lineTo(n,e+r),t.lineTo(n,e),t.closePath(),t.fill(),t.stroke()}function y(t,n,e,i,r,o){var i,r;t.translate(i,r),t.strokeStyle=p[n][e].strokeStyle,i=p[n][e].fillColor.split(" "),r=c(.2*o),t.fillStyle=i[0],b(t,r+.5,3*r+.5,r,2*r),t.fillStyle=i[1],b(t,2*r+.5,2*r+.5,r,3*r),t.fillStyle=i[2],b(t,3*r+.5,r+.5,r,4*r),t.fillStyle=i[3],b(t,4*r+.5,.5,r,5*r)}function w(t,n,e,i,r,o){var i,r;t.translate(i,r),t.strokeStyle=p[n][e].strokeStyle,i=p[n][e].fillColor.split(" "),t.fillStyle=p[n][e].strokeStyle,r=c(o/2),t.fillStyle=i[0],b(t,.5,.5,r,r),t.fillStyle=i[1],b(t,r+.5,.5,r,r),t.fillStyle=i[2],b(t,.5,r+.5,r,r),t.fillStyle=i[3],b(t,r+.5,r+.5,r,r)}function M(t,n,e,i,r,o){t.translate(i+o/2,r+o/2),t.strokeStyle=p[n][e].strokeStyle,4===e?(t.beginPath(),t.arc(0,0,o/2,0,p[n][e].rotate),t.closePath(),t.fillStyle=p[n][e].fillColor,t.fill(),t.beginPath(),t.arc(0,0,o/2,0,p[n][e].rotate),t.closePath(),t.stroke()):0===e?(t.beginPath(),t.arc(0,0,o/2,0,2*s),t.closePath(),t.fillStyle="white",t.fill(),t.beginPath(),t.arc(0,0,o/2,0,p[n][e].rotate),t.stroke(),t.closePath()):1===e?(t.beginPath(),t.arc(0,0,o/2,0,2*s),t.closePath(),t.fillStyle="white",t.fill(),t.beginPath(),t.moveTo(0,0),t.lineTo(0,-o/2),t.arc(0,0,o/2,.5*-s,0),t.lineTo(0,0),t.closePath(),t.fillStyle=p[n][e].fillColor,t.fill(),t.arc(0,0,o/2,0,2*s),t.stroke()):2===e?(t.beginPath(),t.arc(0,0,o/2,0,2*s),t.closePath(),t.fillStyle="white",t.fill(),t.beginPath(),t.moveTo(0,0),t.lineTo(0,-o/2),t.arc(0,0,o/2,.5*-s,.5*s),t.moveTo(0,0),t.closePath(),t.fillStyle=p[n][e].fillColor,t.fill(),t.arc(0,0,o/2,0,2*s),t.stroke()):3===e&&(t.beginPath(),t.arc(0,0,o/2,0,2*s),t.closePath(),t.fillStyle="white",t.fill(),t.beginPath(),t.moveTo(0,0),t.lineTo(0,-o/2),t.arc(0,0,o/2,.5*-s,s),t.lineTo(0,0),t.fillStyle=p[n][e].fillColor,t.fill(),t.arc(0,0,o/2,0,2*s),t.stroke(),t.closePath())}function C(t,n,e){t.moveTo(f(.1*s)*n,-l(.1*s)*n),t.lineTo(f(.3*s)*e,-l(.3*s)*e),t.lineTo(0*n,-l(.5*s)*n),t.lineTo(f(.7*s)*e,-l(.7*s)*e),t.lineTo(f(.9*s)*n,-l(.9*s)*n),t.lineTo(f(1.1*s)*e,-l(1.1*s)*e),t.lineTo(f(1.3*s)*n,-l(1.3*s)*n),t.lineTo(0*e,-l(1.5*s)*e),t.lineTo(f(1.7*s)*n,-l(1.7*s)*n),t.lineTo(f(1.9*s)*e,-l(1.9*s)*e),t.lineTo(f(.1*s)*n,-l(.1*s)*n)}function S(t,n,e,i,r,o){var a,o,u,a,o=o/1.8,u=o/2.5;t.translate(o+i,o+r),t.strokeStyle="#727272",t.fillStyle=p[n][e].fillColor,t.beginPath(),2===e&&(t.strokeStyle="#727272",C(t,o,u),t.fill(),t.stroke(),t.strokeStyle=p[n][e].strokeStyle,C(t,o,u),t.stroke(),t.closePath()),0===e&&(t.fillStyle="white",C(t,o,u),t.fill(),t.stroke(),t.strokeStyle="#727272",C(t,o,u),t.stroke(),t.closePath()),1===e&&(t.strokeStyle=p[n][e].fillColor,t.moveTo(0*o,-l(.5*s)*o),t.lineTo(f(.7*s)*u,-l(.7*s)*u),t.lineTo(f(.9*s)*o,-l(.9*s)*o),t.lineTo(f(1.1*s)*u,-l(1.1*s)*u),t.lineTo(f(1.3*s)*o,-l(1.3*s)*o),t.lineTo(0*u,-l(1.5*s)*u),t.fill(),t.stroke(),t.closePath(),t.beginPath(),t.moveTo(0*o,-l(.5*s)*o),t.lineTo(-f(.7*s)*u,-l(.7*s)*u),t.lineTo(-f(.9*s)*o,-l(.9*s)*o),t.lineTo(-f(1.1*s)*u,-l(1.1*s)*u),t.lineTo(-f(1.3*s)*o,-l(1.3*s)*o),t.lineTo(0*u,-l(1.5*s)*u),t.fillStyle="white",t.fill(),t.closePath(),t.beginPath(),t.strokeStyle="#727272",C(t,o,u),t.stroke(),t.closePath())}function T(t,n,e,i,r,o){2===e?x(t,n,e,i,r,o):0===e?A(t,n,e,i,r,o):1===e&&I(t,n,e,i,r,o)}function A(t,n,e,i,r,o){var o,a,o=o,a=c(o/2);t.translate(i+a,r+a),t.strokeStyle=p[n][e].strokeStyle,t.rotate(p[n][e].rotate),t.beginPath(),t.arc(0,0,a,0,2*s),t.closePath(),t.fillStyle=p[n][e].fillColor,t.fill(),t.beginPath(),t.arc(0,0,a,0,2*s),t.closePath(),t.stroke(),t.beginPath(),t.fillStyle=p[n][e].fillColor2,t.fillRect(.375*-o,.1*-o,.75*o,.2*o),t.closePath(),t.fill(),t.beginPath(),t.fillStyle=p[n][e].fillColor2,t.fillRect(.1*-o,.375*-o,.2*o,.75*o),t.closePath(),t.fill(),t.stroke()}function I(t,n,e,i,r,o){var o=o;t.translate(i,r),t.strokeStyle=p[n][e].strokeStyle,t.beginPath(),t.arc(.5*o,.5*o,.5*o,0,2*s),t.closePath(),t.fillStyle=p[n][e].fillColor,t.fill(),t.beginPath(),t.arc(.5*o,.5*o,.5*o,0,2*s),t.stroke(),t.closePath(),t.beginPath(),t.moveTo(o/3,.1*o),t.lineTo(o/1.5,.1*o),t.lineTo(.625*o,.6*o),t.lineTo(.375*o,.6*o),t.lineTo(o/3,.1*o),t.moveTo(.625*o,.85*o),t.arc(.5*o,.8*o,.15*o,0,2*s),t.fillStyle=p[n][e].fillColor2,t.fill(),t.closePath()}function x(t,n,e,i,r,o){var o=o;t.translate(c(i+o/2),c(o/2+r)),t.strokeStyle=p[n][e].strokeStyle,t.rotate(p[n][e].rotate),t.beginPath(),t.arc(0,0,o/2,0,2*s),t.closePath(),t.fillStyle=p[n][e].fillColor,t.fill(),t.beginPath(),t.arc(0,0,o/2,0,2*s),t.stroke(),t.closePath(),t.beginPath(),t.fillStyle=p[n][e].fillColor2,t.fillRect(.325*-o,.25*-o,.2*o,.5*o),t.closePath(),t.fill(),t.beginPath(),t.fillStyle=p[n][e].fillColor2,t.fillRect(.325*-o,.05*o,.65*o,.2*o),t.closePath(),t.fill(),t.stroke()}function N(t,n,e,i,r,o){2===e?_(t,n,e,i,r,o):0===e?D(t,n,e,i,r,o):1===e&&k(t,n,e,i,r,o)}function k(t,n,e,i,r,o){var o=o;t.translate(i,r),t.beginPath(),t.strokeStyle=p[n][e].strokeStyle,t.moveTo(o/3,.5),t.lineTo(o/1.5,.5),t.lineTo(.625*o,.65*o),t.lineTo(.375*o,.65*o),t.lineTo(o/3,.5),t.moveTo(.65*o,.85*o),t.arc(.5*o,.85*o,.15*o,0,2*s),t.fillStyle=p[n][e].fillColor,t.fill(),t.stroke()}function D(t,n,e,i,r,o){var o,i,r,o=o;t.translate(c(i+o/2),c(r+o/2)),t.strokeStyle=p[n][e].strokeStyle,t.rotate(p[n][e].rotate),t.beginPath(),R(t,-(i=.5*o),-(r=.075*o)),O(t,-i,r),O(t,-r,r),O(t,-r,i),O(t,r,i),O(t,r,r),O(t,i,r),O(t,i,-r),O(t,r,-r),O(t,r,-i),O(t,-r,-i),O(t,-r,-r),O(t,-i,-r),t.fillStyle=p[n][e].fillColor,t.fill(),t.stroke()}function _(t,n,e,i,r,o){var o=o;t.translate(c(i+o/2),c(r+o/2)),t.strokeStyle=p[n][e].strokeStyle,t.rotate(p[n][e].rotate),t.beginPath(),t.fillStyle=p[n][e].fillColor,t.fillRect(.375*-o,.25*-o,.2*o,.5*o),t.closePath(),t.fill(),t.beginPath(),t.fillStyle=p[n][e].fillColor,t.fillRect(.375*-o,.05*o,.75*o,.2*o),t.closePath(),t.fill(),t.stroke()}function E(t,n,e,i,r,o){var o=1.2*o;t.translate(i,r),t.strokeStyle=d,t.fillStyle=d,b(t,c(.2*o)+.5,.5,c(.06*o),c(.8*o)),t.strokeStyle=p[n][e].strokeStyle,t.beginPath(),R(t,.4*o,.5),O(t,.4*o,.5*o),O(t,.9*o,.25*o),O(t,.4*o,.5),t.fillStyle=p[n][e].fillColor,t.fill(),t.stroke()}function L(t,n,e,i,r,o){(2===e?j:1===e?U:G)(t,n,e,i,r,o)}function F(t,n,e,i,r,o){var o=c(o);t.strokeStyle=p[n][e].strokeStyle,t.fillStyle=p[n][e].fillColor,b(t,i+.5,r+.5,o,o),t.beginPath(),t.arc(o/2+i+.5,o/2+r+.5,.375*o,0,2*s),t.fillStyle=p[n][e].fillColor2,t.fill(),t.stroke()}function j(t,n,e,i,r,o){var o=o;t.strokeStyle=p[n][e].strokeStyle,t.beginPath(),t.arc(o/2+i,o/2+r,o/2,0,2*s),t.fillStyle=p[n][e].fillColor,t.closePath(),t.fill(),t.stroke()}function P(t,n,e,i,r,o){1===e?H(t,n,e,i,r,o):0===e?z(t,n,e,i,r,o):2===e&&V(t,n,e,i,r,o)}function G(t,n,e,i,r,o){var o=o;t.strokeStyle=p[n][e].strokeStyle,t.beginPath(),t.translate(i+c(o/2),r+c(o/2)),t.beginPath(),R(t,0,-o/2),O(t,o/2,0),O(t,0,o/2),O(t,-o/2,0),O(t,0,-o/2),t.fillStyle=p[n][e].fillColor,t.closePath(),t.fill(),t.stroke()}function U(t,n,e,i,r,o){var o=c(o);t.translate(i,r),t.strokeStyle=p[n][e].strokeStyle,t.beginPath(),R(t,0,o),O(t,o/2,o-o/2*Math.sqrt(3)),O(t,o,o),O(t,0,o),t.fillStyle=p[n][e].fillColor,t.closePath(),t.fill(),t.stroke()}function H(t,n,e,i,r,o){var o=o;t.strokeStyle=p[n][e].strokeStyle,t.translate(c(o/2+i),c(o/2+r)),t.beginPath(),t.rotate(p[n][e].rotate),R(t,-o/2,-o/5.4),O(t,o/2,-o/5.4),O(t,o/2,o/5.4),O(t,-o/2,o/5.4),O(t,-o/2,-o/5.4),t.fillStyle=p[n][e].fillColor,t.fill(),t.stroke()}function z(t,n,e,i,r,o){t.strokeStyle=p[n][e].strokeStyle;var o=o;t.translate(c(o/2+i),c(o/2+r)),t.beginPath(),R(t,-o/2,-o/3),O(t,o/2,-o/3),O(t,0,o/3),O(t,-o/2,-o/3),t.fillStyle=p[n][e].fillColor,t.fill(),t.stroke()}function V(t,n,e,i,r,o){t.strokeStyle=p[n][e].strokeStyle;var o=o;t.translate(c(o/2+i),c(o/2+r)),t.beginPath(),R(t,-o/2,o/3),O(t,o/2,o/3),O(t,0,-o/3),O(t,-o/2,o/3),t.fillStyle=p[n][e].fillColor,t.fill(),t.stroke()}function Y(t,n,e,i,r,o){var o,a,i,r,u,o,o=o/3.5,a=p[n].length-1;t.strokeStyle=p[n][a-e].strokeStyle,t.translate(c(1.75*o+i),c(1.75*o+r)),t.rotate(p[n][a-e].rotate),t.beginPath(),i=.25*o,r=1.25*o,R(t,-(u=.75*o),-(o=1.75*o)),O(t,i,-o),O(t,i,i),O(t,r,-u),O(t,r,i),O(t,-i,o),O(t,-o,i),O(t,-o,-u),O(t,-u,i),O(t,-u,-o),t.fillStyle=p[n][a-e].fillColor,t.fill(),t.stroke()}function O(t,n,e){t.lineTo(c(n)+.5,c(e)+.5)}function R(t,n,e){t.moveTo(c(n)+.5,c(e)+.5)}Object.defineProperty(t,"__esModule",{value:!0}),t.drawArrows=t.drawIconTypeIsTwo=t.drawCircle=t.drawTrafficLight=t.drawIconTypeIsSen=t.drawFlag=t.drawIconTypeIsNine=t.drawIconTypeIsEight=t.drawStar=t.drawSector=t.drawMagicCube=t.drawSignal=void 0,s=Math.PI,c=Math.round,f=Math.cos,l=Math.sin,p=[[{strokeStyle:e="#326f5b",fillColor:i="#76a797",fillColor2:"",rotate:s},{strokeStyle:r="#A4802b",fillColor:o="#EAC282",fillColor2:"",rotate:-.5*s},{strokeStyle:a="#9E381C",fillColor:u="#D86344",fillColor2:"",rotate:0}],[{strokeStyle:h="#646262",fillColor:d="#808080",fillColor2:"",rotate:s},{strokeStyle:h,fillColor:d,fillColor2:"",rotate:-.5*s},{strokeStyle:h,fillColor:d,fillColor2:"",rotate:0}],[{strokeStyle:a,fillColor:u,fillColor2:"",rotate:0},{strokeStyle:r,fillColor:o,fillColor2:"",rotate:0},{strokeStyle:e,fillColor:i,fillColor2:"",rotate:s}],[{strokeStyle:r,fillColor:"#FFFFFF",fillColor2:"",rotate:0},{strokeStyle:r,fillColor:o,fillColor2:"",rotate:0},{strokeStyle:r,fillColor:o,fillColor2:"",rotate:0}],[{strokeStyle:a,fillColor:u,fillColor2:"",rotate:0},{strokeStyle:r,fillColor:o,fillColor2:"",rotate:0},{strokeStyle:e,fillColor:i,fillColor2:"",rotate:0}],[{strokeStyle:a,fillColor:u,fillColor2:"",rotate:0},{strokeStyle:r,fillColor:o,fillColor2:"",rotate:0},{strokeStyle:e,fillColor:i,fillColor2:"",rotate:0}],[{strokeStyle:v="#303030",fillColor:m="#505050",fillColor2:"#d86344",rotate:0},{strokeStyle:v,fillColor:m,fillColor2:"#eac282",rotate:0},{strokeStyle:v,fillColor:m,fillColor2:i,rotate:0}],[{strokeStyle:a,fillColor:u,fillColor2:"",rotate:0},{strokeStyle:r,fillColor:o,fillColor2:"",rotate:0},{strokeStyle:e,fillColor:i,fillColor2:"",rotate:0}],[{strokeStyle:a,fillColor:u,fillColor2:"white",rotate:.25*s},{strokeStyle:r,fillColor:o,fillColor2:"white",rotate:0},{strokeStyle:e,fillColor:i,fillColor2:"white",rotate:-.25*s}],[{strokeStyle:a,fillColor:u,fillColor2:"",rotate:.25*s},{strokeStyle:r,fillColor:o,fillColor2:"",rotate:0},{strokeStyle:e,fillColor:i,fillColor2:"",rotate:-.25*s}],[{strokeStyle:e,fillColor:i,fillColor2:"",rotate:s},{strokeStyle:r,fillColor:o,fillColor2:"",rotate:-.75*s},{strokeStyle:r,fillColor:o,fillColor2:"",rotate:-.25*s},{strokeStyle:a,fillColor:u,fillColor2:"",rotate:0}],[{strokeStyle:h,fillColor:d,fillColor2:"",rotate:s},{strokeStyle:h,fillColor:d,fillColor2:"",rotate:-.75*s},{strokeStyle:h,fillColor:d,fillColor2:"",rotate:-.25*s},{strokeStyle:h,fillColor:d,fillColor2:"",rotate:0}],[{strokeStyle:v="#353535",fillColor:m,fillColor2:"",rotate:0},{strokeStyle:d,fillColor:"#b1b1b1",fillColor2:"",rotate:0},{strokeStyle:"#b28578",fillColor:"#edb9ab",fillColor2:"",rotate:0},{strokeStyle:a,fillColor:u,fillColor2:"",rotate:0}],[{strokeStyle:g="#727272",fillColor:"#4d82b8 #b3b3b3 #b3b3b3 #b3b3b3",fillColor2:"",rotate:0},{strokeStyle:g,fillColor:"#4d82b8 #4d82b8 #b3b3b3 #b3b3b3",fillColor2:"",rotate:0},{strokeStyle:g,fillColor:"#4d82b8 #4d82b8 #4d82b8 #b3b3b3",fillColor2:"",rotate:0},{strokeStyle:g,fillColor:n="#4d82b8 #4d82b8 #4d82b8 #4d82b8",fillColor2:"",rotate:0}],[{strokeStyle:v,fillColor:m,fillColor2:"",rotate:0},{strokeStyle:a,fillColor:u,fillColor2:"",rotate:0},{strokeStyle:r,fillColor:o,fillColor2:"",rotate:0},{strokeStyle:e,fillColor:i,fillColor2:"",rotate:0}],[{strokeStyle:e,fillColor:i,fillColor2:"",rotate:s},{strokeStyle:r,fillColor:o,fillColor2:"",rotate:-.75*s},{strokeStyle:r,fillColor:o,fillColor2:"",rotate:-.5*s},{strokeStyle:r,fillColor:o,fillColor2:"",rotate:-.25*s},{strokeStyle:a,fillColor:u,fillColor2:"",rotate:0}],[{strokeStyle:h,fillColor:d,fillColor2:"",rotate:s},{strokeStyle:h,fillColor:d,fillColor2:"",rotate:-.75*s},{strokeStyle:h,fillColor:d,fillColor2:"",rotate:-.5*s},{strokeStyle:h,fillColor:d,fillColor2:"",rotate:-.25*s},{strokeStyle:h,fillColor:d,fillColor2:"",rotate:0}],[{strokeStyle:g,fillColor:"#b3b3b3 #b3b3b3 #b3b3b3 #b3b3b3",fillColor2:"",rotate:0},{strokeStyle:g,fillColor:"#4d82b8 #b3b3b3 #b3b3b3 #b3b3b3",fillColor2:"",rotate:0},{strokeStyle:g,fillColor:"#4d82b8 #4d82b8 #b3b3b3 #b3b3b3",fillColor2:"",rotate:0},{strokeStyle:g,fillColor:"#4d82b8 #4d82b8 #4d82b8 #b3b3b3",fillColor2:"",rotate:0},{strokeStyle:g,fillColor:n,fillColor2:"",rotate:0}],[{strokeStyle:m,fillColor:m,fillColor2:"",rotate:2*s},{strokeStyle:m,fillColor:m,fillColor2:"",rotate:.5*s},{strokeStyle:m,fillColor:m,fillColor2:"",rotate:.5*s},{strokeStyle:m,fillColor:m,fillColor2:"",rotate:+s},{strokeStyle:m,fillColor:m,fillColor2:"",rotate:2*s}],[{strokeStyle:g,fillColor:"#b3b3b3 #b3b3b3 #b3b3b3 #b3b3b3",fillColor2:"",rotate:0},{strokeStyle:g,fillColor:"#b3b3b3 #b3b3b3 #4d82b8 #b3b3b3",fillColor2:"",rotate:0},{strokeStyle:g,fillColor:"#b3b3b3 #b3b3b3 #4d82b8 #4d82b8",fillColor2:"",rotate:0},{strokeStyle:g,fillColor:"#4d82b8 #b3b3b3 #4d82b8 #4d82b8",fillColor2:"",rotate:0},{strokeStyle:g,fillColor:n,fillColor2:"",rotate:0}]],t.drawSignal=y,t.drawMagicCube=w,t.drawSector=M,t.drawStar=S,t.drawIconTypeIsEight=T,t.drawIconTypeIsNine=N,t.drawFlag=E,t.drawIconTypeIsSen=L,t.drawTrafficLight=F,t.drawCircle=j,t.drawIconTypeIsTwo=P,t.drawArrows=Y},"./dist/plugins/contextMenu/context-menu-dialog.js":function(t,n,e){"use strict";var i,e,r,o,a,u,s,c,f,l,h;function d(t,n){var t,e,t=h.call(this,t,r(t))||this,e;return t.zX=n,t}i=this&&this.__extends||(l=function(t,n){return(l=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(t,n){t.__proto__=n}:function(t,n){for(var e in n)Object.prototype.hasOwnProperty.call(n,e)&&(t[e]=n[e])}))(t,n)},function(t,n){if("function"!=typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function e(){this.constructor=t}l(t,n),t.prototype=null===n?Object.create(n):(e.prototype=n.prototype,new e)}),Object.defineProperty(n,"__esModule",{value:!0}),n.ContextMenuViewDialog=void 0,e=e("Core"),r=e.mt.gi,o=e.zc,a=e.GC$,u="gc.command.executed",s="left",c="top",i(d,h=o),d.prototype.VX=function(t,n,e){var i,t,i=this,t=t[0];i.YX&&i.YX.ZX&&i.YX.ZX(t,n,e,i.zX)},d.prototype.rQ=function(t,n,e,i,r){var o,e,o=this,e=o.WX(e,i);o.YX=t,o.VX(e,n,r)},d.prototype.WX=function(t,n){var e,i,e=this,i=e.Xc();return i.css([s,c],[t,n]),i.empty(),h.prototype.$c.call(this),e.aY(),i},d.prototype.QX=function(t){var n,e,i,r,t,n,e=this.Xc();return"block"!==e.css("display")||((i=e.offset()).top+=document.body.clientTop||0,i.left+=document.body.clientLeft||0,r=t.x,t=t.y,r<i.left)||r>e.width()+i.left||t<i.top||t>e.height()+i.top},d.prototype.aY=function(){var t=this;t.zX.bind(u,function(){t.close()})},d.prototype.KX=function(){var t;this.zX.unbind(u)},d.prototype.close=function(){var t,n,e,e,t=this,n=t.YX;n&&n.DJ&&((e=n.JX)&&e.menuItemData.needKeepFocus||(e=n.DJ.getActiveSheet())&&e.rt&&!e.il&&e.rt.aA(),t.YX.L0()),t.KX(),t.Yc(t.Zc)&&a("#"+t.Zc).remove(),h.prototype.close.call(this)},n.ContextMenuViewDialog=d},"./dist/plugins/contextMenu/context-menu.entry.js":function(t,n,e){"use strict";var i,r,r,i=this&&this.__createBinding||(Object.create?function(t,n,e,i){void 0===i&&(i=e);var r=Object.getOwnPropertyDescriptor(n,e);r&&("get"in r?n.__esModule:!r.writable&&!r.configurable)||(r={enumerable:!0,get:function(){return n[e]}}),Object.defineProperty(t,i,r)}:function(t,n,e,i){t[i=void 0===i?e:i]=n[e]}),r=this&&this.__exportStar||function(t,n){for(var e in t)"default"===e||Object.prototype.hasOwnProperty.call(n,e)||i(n,t,e)};Object.defineProperty(n,"__esModule",{value:!0}),n.XX=void 0,r(e("./dist/plugins/contextMenu/context-menu.js"),n),r(e("./dist/plugins/contextMenu/menu-view.js"),n),r(e("./dist/plugins/contextMenu/context-menu.ns.js"),n),r=e("./dist/plugins/contextMenu/context-menu-dialog.js"),n.XX=r.ContextMenuViewDialog},"./dist/plugins/contextMenu/context-menu.js":function(f,d,v){"use strict";var m,g,p,J,v,l,K,gt,M,X,b,t,y,C,n,q,$,e,S,T,i,A,I,r,x,o,N,k,D,_,E,j,O,R,B,L,F,P,G,U,H,z,a,V,Y,Z,W,Q,pt,bt,yt,wt,Mt,Ct,St,Tt,At,It,xt,Nt,kt,Dt,_t,Et,jt,Ot,Rt,Bt,Lt,Ft,Pt,Gt,Ut,Ht,zt,Vt,Yt,u,Zt,Wt,Qt,Jt,Kt,Xt,tt,nt,qt,$t,tn,nn,en,rn,on,an,un,sn,cn,fn,ln,hn,dn,vn,mn,gn,pn,bn,yn,wn,Mn,Cn,Sn,Tn,An,In,et,it,xn,Nn,kn,rt,Dn,_n,En,jn,ot,at,On,Rn,Bn,ut,s,Ln,st,Fn,Pn,Gn,Un,Hn,zn,h,Vn,Yn,Zn,Wn,Qn,Jn,Kn,Xn,qn,$n,te,ne,ee,ie,ct,ft,lt,ht,re,oe,ae,ue,se,ce,fe,le,he,dt,m,w,de,vt,ve;function me(t){var n,e;if(t.slicers&&(n=t.slicers.all())&&!gt(n))for(e in n)if(n[e].isSelected())return 1}function ge(t,n,e){for(var i,r,o,a,u,i=n===le?"rowCount":"colCount",r=0;r<t.length;r++)for(a=-1===(o=t[r])[n]?0:o[n],u=0;u<o[i];u++)e(a+u)}function pe(t,n){for(var e=[],i=-1,r,r=t.row;r<t.row+t.rowCount;r++)!1!==n[r]&&-1===i&&(i=r),!1===n[r]&&-1!==i&&(e.push([i,r-i]),i=-1);return-1!==i&&e.push([i,r-i]),e}function be(t,n){var e,e,e,n;if(1===n.colCount&&-1===n.row){if((e=n.col)===t.k9()&&0<=(e=e-1)&&!t.getColumnVisible(e))return!0}else if(1===n.rowCount&&-1===n.col&&(e=n.row)===t.N9()&&0<=(n=e-1)&&!t.getRowVisible(n))return!0}function ye(t){var n,e,i;if(t.slicers){if(!(n=t.slicers.all())||gt(n))return null;for(i in e=[],n)n[i].isSelected()&&e.push(n[i]);return e}}function we(t,n){var e,n,i,e=n.name,n=n.group;if(!([b+Un,b+Gn,b+s].indexOf(e)<0&&b+s!==n)){if((i=(0,J.jf)(t))&&i.NMi&&(b+s===e||b+s===n))return!1;switch(e){case b+Fn:case b+Ln:case b+zn:case b+st:case b+Hn:if(i&&!0===i.ST().ES)return!1}}return!0}function Me(t,n){var n;return[b+Bn].indexOf(n.name)<0||!(n=(0,J.jf)(t))||!n.NMi}function Ce(t,n){var n;return[b+at,b+Rn,b+ot,b+On].indexOf(n.name)<0||!(n=(0,J.jf)(t))||!n.NMi}function Se(t,n){var n,t,n=n.name;return[b+In,b+nn,b+en,b+tn].indexOf(n)<0||!(t=(0,J.jf)(t))||!t.NMi||n!==b+en&&n!==b+tn}function Te(t,n){var e,n,i,e,t,r,o,a,u,e=[b+rt,b+nt,b+Xt,b+tt],n=n.name;if(e.indexOf(n)<0)return!0;if(e=(i=(0,J.jf)(t)).getActiveRowIndex(),t=i.getActiveColumnIndex(),i&&i.comments){if(r=i.comments.get(e,t))return n!==b+rt;if(n!==b+nt&&n!==b+Xt){if(n===b+rt)return!0;for(o=i.getSelections(),a=0;a<o.length;a++)if(Ie(u=o[a],i))return!0}return!1}}function Ae(t,n){var e,i,r,o,a,u;if(n.comments)for(e=n.comments.all(),r=i=void 0,o=0;o<t.length;o++)for(a=t[o],u=0;u<e.length;u++)if(!e[u].locked()&&(r=e[u].bZ,i=e[u].yZ,r>=a.row)&&r<a.row+a.rowCount&&i>=a.col&&i<a.col+a.colCount)return 1}function Ie(t,n){var e,i,r,o;if(n.comments)for(e=n.comments.all(),r=i=void 0,o=0;o<e.length;o++)if(r=e[o].bZ,i=e[o].yZ,r>=t.row&&r<t.row+t.rowCount&&i>=t.col&&i<t.col+t.colCount)return 1}function xe(t,n){var n,t,n,t,t;return[b+Nn,b+kn].indexOf(n.name)<0||!((n=(0,J.jf)(t))&&n.NMi||!(t=n.getSelections())||1!==t.length||(t=Be(n,n=t[0]))&&(t=t.range(),n.row<t.row||n.col<t.col||n.row+n.rowCount>t.row+t.rowCount||n.col+n.colCount>t.col+t.colCount))}function Ne(t,n){var n,t;return[b+ct].indexOf(n.name)<0||(t=(n=(0,J.jf)(t))&&n.ST())&&!t.ES&&t._S&&1===t._S.length&&1===n.getSelections().length&&De(n)}function ke(t,n){var n,t;return[b+ft].indexOf(n.name)<0||(t=(n=(0,J.jf)(t))&&n.ST())&&t.ES&&t._S&&1===t._S.length&&1===n.getSelections().length&&De(n)}function De(t){var n,e,i,r,o,a;if(t.NMi)return!1;if(n=t.getActiveRowIndex(),e=t.getActiveColumnIndex(),!(i=t.ST()).TT)return!1;if(t.tables&&t.tables.find(n,e))return!1;for(r=t.Ut.getSpans(),o=0;o<r.length;o++)if(n>=(a=r[o]).row&&n<a.row+a.rowCount&&e>=a.col&&e<a.col+a.colCount)return!1;return!0}function _e(t,n){var t,e,n,i,r,t,o,a,u,a,t=(0,J.jf)(t),e=[b+$+an,b+$+un].indexOf(n.name),n=[b+$+fn,b+$+sn,b+$+cn,b+$+ln,b+$+hn,b+$+dn].indexOf(n.name),i=-1<e,r=-1<n;return t&&t.NMi&&(t=t.NMi,i||r)?!(o=t.qNi())||(u=[(a=t.options.menuItemVisibility).promoteMenuItemVisible,a.demoteMenuItemVisible],a=[a.addAboveMenuItemVisible,a.addAfterMenuItemVisible,a.addBeforeMenuItemVisible,a.addBelowMenuItemVisible,a.moveUpMenuItemVisible,a.moveDownMenuItemVisible],o=i&&u[e])||!t.qX()?o:r&&a[n]:!(i||r)}function Ee(t,n,e){var t,i,r,o,a,u,s,t,c,f,e,l,t=(0,J.jf)(t),i=9,r=b+q,o=[vn,mn].map(function(t){return r+t}).indexOf(n.name),a,u=-1<o,s=-1<je(9,function(t){return r+gn+(t+1)}).indexOf(n.name);return t&&t.NMi&&(t=t.NMi).qNi()&&(s||u)?(f=[(c=t.options.menuItemVisibility).expandAllLevelMenuItemVisible,c.collapseAllLevelMenuItemVisible],s?(e=e.$X=e.$X||t.MDi()+1,(l=parseInt(n.name.charAt((r+gn).length),10))<=Math.min(9,e)&&c.expandToLevelMenuItemVisible):u&&f[o]):!(s||u)}function je(t,n){for(var e,i,e=[],i=0;i<t;i++)e.push(n(i,e));return e}function Oe(t,n){var t,e,i,r,o,a,u,s,c;if([b+$+ct,b+$+ft].indexOf(n.name)<0)return!0;if(!(t=(0,J.jf)(t))||!t.NMi){if(e=t.ST(),i=t.getActiveRowIndex(),r=!1,t.tables)for(o=t.tables.all(),a=0;a<o.length;a++)if(i>=(u=o[a]).Ky&&i<u.Ky+u.Sx){r=!0;break}for(s=t.Ut.getSpans(),a=0;a<s.length;a++)if(i>(c=s[a]).row&&i<c.row+c.rowCount)return!1;if(e.TT&&(!e._S||1===e._S.length)&&1===t.getSelections().length)if(n.name===b+$+ft){if(e.ES&&(r||e._S&&t.getColumnCount()%e._S[0].colCount==0))return!0}else if(n.name===b+$+ct&&!e.ES&&(r||e._S&&t.getColumnCount()%e._S[0].colCount==0))return!0}return!1}function Re(t,n){var t,e,i,r,o,a,u,s,c;if([b+q+ct,b+q+ft].indexOf(n.name)<0)return!0;if(!(t=(0,J.jf)(t))||!t.NMi){if(e=t.ST(),i=t.getActiveColumnIndex(),r=!1,t.tables)for(o=t.tables.all(),a=0;a<o.length;a++)if(i>=(u=o[a]).iw&&i<u.iw+u.Tx){r=!0;break}for(s=t.Ut.getSpans(),a=0;a<s.length;a++)if(i>(c=s[a]).col&&i<c.col+c.colCount)return!1;if(e.TT&&(!e._S||1===e._S.length)&&1===t.getSelections().length)if(n.name===b+q+ct){if(!e.ES&&(r||e._S&&t.getRowCount()%e._S[0].rowCount==0))return!0}else if(n.name===b+q+ft&&e.ES&&(r||e._S&&t.getRowCount()%e._S[0].rowCount==0))return!0}return!1}function Be(t,n){var e,i,r;if(n)for(J.mt.J0(n,t.getRowCount(),t.getColumnCount()),e=n.row;e<n.row+n.rowCount;e++)for(i=n.col;i<n.col+n.colCount;i++)if(t.tables&&(r=t.tables.find(e,i)))return r;return null}function Le(t,n,e,i){for(var r,o,r=0;r<n.length;r++)(o=n[r]).jj(e,i,!0,dt,o.tq())}function Fe(t){for(var n,e,i,r,n=t,e=0;e<n.length-1;e++)for(i=e+1;i<n.length;i++)n[e].row<n[i].row&&(r=n[e],n[e]=n[i],n[i]=r);return n}function Pe(t){for(var n,e,i,r,n=t,e=0;e<n.length-1;e++)for(i=e+1;i<n.length;i++)n[e].col<n[i].col&&(r=n[e],n[e]=n[i],n[i]=r);return n}function Ge(t,n,e,i){var r=t.Ut.getSpans(dt,3);0<=n?(He(t,r,n,i,3),He(t,t.Ut.getSpans(dt,2),n,i,2)):0<=e&&(Ue(t,r,e,i,3),Ue(t,t.Ut.getSpans(dt,1),e,i,1))}function Ue(t,n,e,i,r){for(var o,a,u,s,c,f,l,h,o=0,a=n.length;o<a;o++)if(e>(u=n[o]).col&&e<u.col+u.colCount)for(s=t.Z_(u.row,u.col,r),c=e;c<e+i;c++)for(f=u.row;f<u.row+u.rowCount;f++)t.setStyle(f,c,s,r),f===u.row+u.rowCount-1&&(h=(l=t.getCell(u.row+u.rowCount-1,u.col)).borderBottom())&&t.getCell(f,c).borderBottom(h)}function He(t,n,e,i,r){for(var o,a,u,s,c,f,l,h,o=0,a=n.length;o<a;o++)if(e>(u=n[o]).row&&e<u.row+u.rowCount)for(s=t.Z_(u.row,u.col,r),c=e;c<e+i;c++)for(f=u.col;f<u.col+u.colCount;f++)t.setStyle(c,f,s,r),f===u.col+u.colCount-1&&(h=(l=t.getCell(u.row,u.col+u.colCount-1)).borderRight())&&t.getCell(c,f).borderRight(h)}function mt(t,n,e,i,r,o){var a,u,s,c,f,e,r,a=(0,J._f)(t,n.sheetName);return!!a&&(u=n.considerAllSheets,s=t.i4(),a.suspendPaint(),c=J.Commands.TI(a.name()),e?(e=void 0,(e=r?r(a,n):e)&&e.cancel||(u?J.Commands.NI(s,n):a.Ut.undo(n[c]),o&&o(a,n,e))):(u?J.Commands.II(s):a.Ut.startTransaction(),f=i(a,n),u?J.Commands.xI(s,n):n[c]=a.Ut.endTransaction()),a.resumePaint(),u&&(r=(0,J.jf)(t))&&a!==r&&r.repaint(),f)}function ze(t,n,e){var i;if(0<e){for(i=n+1;i<t.getRowCount();i++)if((e-=t.getRowHeight(i))<=0)return i-n}else if(e<0)for(i=n-1;0<=i;i--)if(0<=(e+=t.getRowHeight(i)))return i-n;return 0}function Ve(t,n,e){var i;if(0<e){for(i=n+1;i<t.getColumnCount();i++)if((e-=t.getColumnWidth(i))<=0)return i-n}else if(e<0)for(i=n-1;0<=i;i--)if(0<=(e+=t.getColumnWidth(i)))return i-n;return 0}function Ye(t,n,e,i){var t=(0,J._f)(t,n.sheetName);t&&e.execute({cmd:ut,sheetName:t.name(),pasteOption:i})}function Ze(i,r,t,o){return mt(i,r,t,function(t){var n,e,n=ye(t);if(n&&0!==n.length){for(e in n)n.hasOwnProperty(e)&&n[e].sortState(o);i.changeSelectionInCommandExecuting(r,null,null,[],n)}})}function We(t){t.jT(8,w().hideSheetFailureInfo)}function Qe(t,n){var e,i,r,e=n.name(),i=t._se(e),r={sheetName:e,propertyName:"isVisible",cancel:!1,sheetIndex:i,sheetPosition:t.getSheetPosition(e),oldValue:!1,newValue:!0};if(t.ki(J.Events.SheetChanging,r),r.cancel)return!1;n.visible(!0),t.ki(J.Events.SheetChanged,{sheetName:e,propertyName:"isVisible",sheetIndex:i,sheetPosition:t.getSheetPosition(e),oldValue:!1,newValue:!0})}function Je(t,n,e){var i,i,i={oldSheet:n,newSheet:e,cancel:!1};return t.ki(J.Events.ActiveSheetChanging,i),!i.cancel&&(i={oldValue:!0,newValue:!1,sheetName:n.name(),propertyName:"isSelected",cancel:!1,sheetIndex:t._se(n.name()),sheetPosition:t.getSheetPosition(n.name())},t.ki(J.Events.SheetChanging,i),!i.cancel)&&(i={oldValue:!1,newValue:!0,sheetName:e.name(),propertyName:"isSelected",cancel:!1,sheetIndex:t._se(e.name()),sheetPosition:t.getSheetPosition(e.name())},t.ki(J.Events.SheetChanging,i),!i.cancel)&&void 0}function Ke(t,n){var e,n,e=(0,J.jf)(t);t.ki(J.Events.ActiveSheetChanged,{oldSheet:n,newSheet:e}),n={oldValue:!0,newValue:!1,sheetName:n.name(),propertyName:"isSelected",sheetIndex:t._se(n.name()),sheetPosition:t.getSheetPosition(n.name())},t.ki(J.Events.SheetChanged,n),n={oldValue:!1,newValue:!0,sheetName:e.name(),propertyName:"isSelected",sheetIndex:t._se(e.name()),sheetPosition:t.getSheetPosition(e.name())},t.ki(J.Events.SheetChanged,n)}function Xe(t){var t=t.slice(t.lastIndexOf(".")+1);return t===$+ft||t===$+ct||t===q+ft||t===q+ct}function c(){var t=this;t.menuView=new p.MenuView,t.menuData=t.nq()}Object.defineProperty(d,"__esModule",{value:!0}),d.ContextMenu=void 0,m=v("Common"),g=v("./dist/plugins/contextMenu/context-menu-dialog.js"),p=v("./dist/plugins/contextMenu/menu-view.js"),J=v("Core"),v=v("./dist/plugins/contextMenu/context-menu.ns.js"),l=J.GC$,K=m.Common.lt.ht,gt=m.Common.lt._h,M=J.mt.vi,X="gc.spread.contextMenu.",b="gc.spread.",t="gc-spread-",y="gc.spread.pivot",C="gc-spread-pivot-selected",n="viewport",q="colHeader",$="rowHeader",e="slicer",S="timeline",T="sheetTab",i="corner",A="pivotPageFilter",I="pivotTopLeft",r="pivotHeader",x="pivotEmptyLabel",o="pivotContent",N="pivotGrandTotal",k="FieldName",D="SortType",_="pivotSummarizeValuesBy",E="pivotExpandOrCollapse",j="pivotTableGroup",O="OpenPivotGroupDialog",R="pivotTableUnGroup",B="pivotShowValueAs",L="pivotShowDetails",F="pivotRefresh",P="removeField",G="pivotTable",U="removePivotGrandTotal",H="openValueFieldSettingDialogCmd",z="pivotSum",a="UpdatePivotValueFieldCmd",V="pivotCount",Y="pivotAverage",Z="pivotMax",W="pivotMin",Q="pivotProduct",pt="pivotNoCalculation",bt="pivotGrandtotal",yt="pivotColumnTotal",wt="pivotRowTotal",Mt="pivotOf",Ct="pivotParentRowTotal",St="pivotDifferenceFrom",Tt="pivotPercentDifferenceFro",At="pivotRunningTotalIn",It="pivotPercentRunningTotalIn",xt="pivotRankSmallestToLargest",Nt="pivotOfParentTotal",kt="pivotParentColumnTotal",Dt="pivotRankLargestToSmallest",_t="pivotIndex",Et="pivotMoreOptions",jt="pivotFilter",Ot="pivotClearFilterFrom",Rt="pivotKeepOnlySelectedItems",Bt="pivotHideSelectedItems",Lt="pivotTop10",Ft="pivotLabelFilters",Pt="pivotValueFilters",Gt="pivotExpand",Ut="pivotCollapse",Ht="pivotExpandEntireField",zt="pivotCollapseEntireField",Vt="createDialogForValueFilter",Yt="createDialogForLabelFilter",u="OpenPivotShowValueAsDialog",Zt="filterFieldLabelValue",Wt="ClearCommand",Qt="pivotSort",Jt="createDialogForPivotSort",Kt="removeSlicer",Xt="toggleComment",tt="deleteComment",nt="editComment",qt="unhideSheet",$t="hideSheet",tn="unhideRows",nn="unhideColumns",en="hideRows",rn="pinRows",on="pinColumns",an="promote",un="demote",sn="addAfter",cn="addBefore",fn="addAbove",ln="addBelow",hn="moveUp",dn="moveDown",vn="expandAllLevels",mn="collapseAllLevels",gn="expandLevel",pn="expandLevel1",bn="expandLevel2",yn="expandLevel3",wn="expandLevel4",Mn="expandLevel5",Cn="expandLevel6",Sn="expandLevel7",Tn="expandLevel8",An="expandLevel9",In="hideColumns",et="sortAscend",it="sortDescend",xn="sortMoreOptions",Nn="sort",kn="filter",rt="insertComment",Dn="deleteSheet",_n="insertNote",En="replyComment",jn="insertSheet",ot="insertRows",at="insertColumns",On="deleteRows",Rn="deleteColumns",Bn="clearContents",ut="paste",s="pasteOptions",Ln="pasteFormatting",st="pasteValues",Fn="pasteFormula",Pn="pasteAll",Gn="cut",Un="copy",Hn="pasteValuesFormatting",zn="pasteFormulaFormatting",h="separator",Vn="groupHeader",Yn="slicerSortAscend",Zn="slicerSortDescend",Wn="table",Qn="tableInsert",Jn="tableDelete",Kn="tableInsertRowsAbove",Xn="tableInsertRowsBelow",qn="tableInsertColumnsLeft",$n="tableInsertColumnsRight",te="tableInsertRows",ne="tableInsertColumns",ee="tableDeleteRows",ie="tableDeleteColumns",ct="insertCopiedCells",ft="insertCutCells",lt="shiftCellsDown",ht="shiftCellsRight",re="allSheets",oe="tableInsertRowsAboveForContextMenu",ae="tableInsertRowsBelowForContextMenu",ue="tableDeleteRowsForContextMenu",se="tableInsertColumnsLeftForContextMenu",ce="tableInsertColumnsRightForContextMenu",fe="tableDeleteColumnsForContextMenu",le="row",he="col",dt=void 0,m=new m.Common.ResourceManager(v.SR,"ContextMenu"),w=m.getResource.bind(m),de={sheetTab:function(t,n,e){return new RegExp("sheetTab","i").test(e.workArea)&&t.tabStripHitInfo&&t.tabStripHitInfo.sheetTab&&"newSheet"!==t.tabStripHitInfo.sheetTab.sheetName&&"allSheets"!==t.tabStripHitInfo.sheetTab.sheetName},outline:function(t,n,e){return!!(new RegExp("outline","i").test(e.workArea)&&t.worksheetHitInfo&&t.worksheetHitInfo.outlineHitInfo)},viewport:function(t,n,e){if(new RegExp("viewport","i").test(e.workArea)&&t.worksheetHitInfo&&3===t.worksheetHitInfo.hitTestType&&!t.worksheetHitInfo.floatingObjectHitInfo&&!t.worksheetHitInfo.shapeHitInfo&&!t.worksheetHitInfo.pivotTableInfo&&!t.worksheetHitInfo.commentHitInfo)return we(n,e)&&Me(n,e)&&Te(n,e)&&xe(n,e)&&Ne(n,e)&&ke(n,e)},rowHeader:function(t,n,e){if(new RegExp("rowHeader","i").test(e.workArea)&&t.worksheetHitInfo&&2===t.worksheetHitInfo.hitTestType)return we(n,e)&&Me(n,e)&&Ce(n,e)&&Se(n,e)&&Oe(n,e)&&_e(n,e)},colHeader:function(t,n,e){var i,r,r,o,i=t.worksheetHitInfo;if(new RegExp("colHeader","i").test(e.workArea)&&i&&1===i.hitTestType&&(r=(r=(0,J.jf)(n))&&r.Ut.getFreeAreaRowCount(1),!(o=i.row<r)))return we(n,e)&&Me(n,e)&&Ce(n,e)&&Se(n,e)&&Re(n,e)&&Ee(n,e,t)},corner:function(t,n,e){if(new RegExp("corner","i").test(e.workArea)&&t.worksheetHitInfo&&0===t.worksheetHitInfo.hitTestType)return we(n,e)&&Me(n,e)&&Te(n,e)&&xe(n,e)},slicer:function(t,n,e){return new RegExp("slicer","i").test(e.workArea)&&t.worksheetHitInfo&&t.worksheetHitInfo.shapeHitInfo&&t.worksheetHitInfo.shapeHitInfo.shape&&"Slicer"===t.worksheetHitInfo.shapeHitInfo.shape.drawingType},timeline:function(t,n,e){var e,t,e=new RegExp("timeline","i").test(e.workArea),t=t.worksheetHitInfo&&t.worksheetHitInfo.shapeHitInfo&&t.worksheetHitInfo.shapeHitInfo.shape&&"Timeline"===t.worksheetHitInfo.shapeHitInfo.shape.drawingType;return e&&t},chart:function(t,n,e){return new RegExp("chart","i").test(e.workArea)&&t.worksheetHitInfo&&t.worksheetHitInfo.floatingObjectHitInfo&&t.worksheetHitInfo.floatingObjectHitInfo.floatingObject&&"2"===t.worksheetHitInfo.floatingObjectHitInfo.floatingObject.typeName},shape:function(t,n,e){return new RegExp("shape","i").test(e.workArea)&&t.worksheetHitInfo&&t.worksheetHitInfo.shapeHitInfo},table:function(t,n,e){var n=(0,J.jf)(n),n=n&&n.tables;return new RegExp("table","i").test(e.workArea)&&t.worksheetHitInfo&&3===t.worksheetHitInfo.hitTestType&&!t.worksheetHitInfo.floatingObjectHitInfo&&!t.worksheetHitInfo.shapeHitInfo&&!t.worksheetHitInfo.pivotTableInfo&&!t.worksheetHitInfo.commentHitInfo&&n&&n.eq()},vpWithoutTb:function(t,n,e){var i,t,r;if(new RegExp("vpWithoutTb","i").test(e.workArea)&&t.worksheetHitInfo&&3===t.worksheetHitInfo.hitTestType&&!t.worksheetHitInfo.floatingObjectHitInfo&&!t.worksheetHitInfo.shapeHitInfo&&!t.worksheetHitInfo.pivotTableInfo&&!t.worksheetHitInfo.commentHitInfo)return!((t=(0,J.jf)(n).tables)&&t.eq())&&we(n,e)&&Me(n,e)&&Te(n,e)&&xe(n,e)},pivotTablePageFilterArea:function(t,n,e){var n=(0,J.jf)(n),n=n&&n.pivotTables;return new RegExp("pivotPageFilter","i").test(e.workArea)&&t.worksheetHitInfo&&3===t.worksheetHitInfo.hitTestType&&n&&t.worksheetHitInfo.pivotTableCellInfo&&0===t.worksheetHitInfo.pivotTableCellInfo.menuArea},pivotTableCornerArea:function(t,n,e){var n=(0,J.jf)(n),n=n&&n.pivotTables;return new RegExp("pivotTopLeft","i").test(e.workArea)&&t.worksheetHitInfo&&3===t.worksheetHitInfo.hitTestType&&n&&t.worksheetHitInfo.pivotTableCellInfo&&1===t.worksheetHitInfo.pivotTableCellInfo.menuArea},pivotTableEmptyLabelArea:function(t,n,e){var n=(0,J.jf)(n),n=n&&n.pivotTables;return new RegExp("pivotEmptyLabel","i").test(e.workArea)&&t.worksheetHitInfo&&3===t.worksheetHitInfo.hitTestType&&n&&t.worksheetHitInfo.pivotTableCellInfo&&3===t.worksheetHitInfo.pivotTableCellInfo.menuArea},pivotTableHeaderArea:function(t,n,e){var n=(0,J.jf)(n),n=n&&n.pivotTables;return new RegExp("pivotHeader","i").test(e.workArea)&&t.worksheetHitInfo&&3===t.worksheetHitInfo.hitTestType&&n&&t.worksheetHitInfo.pivotTableCellInfo&&2===t.worksheetHitInfo.pivotTableCellInfo.menuArea},pivotTableGrandTotalArea:function(t,n,e){var n=(0,J.jf)(n),n=n&&n.pivotTables;return new RegExp("pivotGrandTotal","i").test(e.workArea)&&t.worksheetHitInfo&&3===t.worksheetHitInfo.hitTestType&&n&&t.worksheetHitInfo.pivotTableCellInfo&&5===t.worksheetHitInfo.pivotTableCellInfo.menuArea},pivotTableContentArea:function(t,n,e){var n=(0,J.jf)(n),n=n&&n.pivotTables;return new RegExp("pivotContent","i").test(e.workArea)&&t.worksheetHitInfo&&3===t.worksheetHitInfo.hitTestType&&n&&t.worksheetHitInfo.pivotTableCellInfo&&4===t.worksheetHitInfo.pivotTableCellInfo.menuArea},pivotTable:function(t,n,e){var n=(0,J.jf)(n),n=n&&n.pivotTables;return new RegExp("pivotTable","i").test(e.workArea)&&t.worksheetHitInfo&&3===t.worksheetHitInfo.hitTestType&&n&&t.worksheetHitInfo.pivotTableCellInfo}},vt=[],c.prototype.nq=function(){return[{text:w().copy,name:b+Un,command:X+Un,iconClass:t+Un,workArea:n+q+$+e+i+G+S},{text:w().cut,name:b+Gn,command:X+Gn,iconClass:t+Gn,workArea:n+q+$+e+i+S},{text:w().pasteOptions,name:b+s,iconClass:t+s,type:Vn,workArea:n+q+$+e+i+S},{command:X+Pn,name:b+Pn,iconClass:t+Pn,group:b+s,text:w().pasteAll,workArea:n+q+$+e+i+S},{command:X+Fn,name:b+Fn,iconClass:t+Fn,group:b+s,text:w().pasteFormula,workArea:n+q+$+i},{command:X+st,name:b+st,iconClass:t+st,group:b+s,text:w().pasteValues,workArea:n+q+$+i},{command:X+Ln,name:b+Ln,iconClass:t+Ln,group:b+s,text:w().pasteFormatting,workArea:n+q+$+i},{command:X+Hn,name:b+Hn,iconClass:t+Hn,group:b+s,text:w().pasteValuesFormatting,workArea:n+q+$+i},{command:X+zn,name:b+zn,iconClass:t+zn,group:b+s,text:w().pasteFormulaFormatting,workArea:n+q+$+i},{text:w().paste,name:b+ut,command:X+st,iconClass:t+s,workArea:n+q+$+i},{type:h},{text:w().pinRows,name:b+rn,command:X+rn,workArea:$},{text:w().pinColumns,name:b+on,command:X+on,workArea:q},{type:h},{text:w().promote,name:b+$+an,command:X+an,workArea:$},{text:w().demote,name:b+$+un,command:X+un,workArea:$},{type:h},{text:w().moveUp,name:b+$+hn,command:X+hn,workArea:$},{text:w().moveDown,name:b+$+dn,command:X+dn,workArea:$},{type:h},{text:w().addAfter,name:b+$+sn,command:X+sn,workArea:$},{text:w().addBefore,name:b+$+cn,command:X+cn,workArea:$},{text:w().addAbove,name:b+$+fn,command:X+fn,workArea:$},{text:w().addBelow,name:b+$+ln,command:X+ln,workArea:$},{type:h},{text:w().expandAllLevels,name:b+q+vn,command:X+vn,workArea:q},{text:w().collapseAllLevels,name:b+q+mn,command:X+mn,workArea:q},{text:w().expandLevel1,name:b+q+pn,command:X+pn,workArea:q},{text:w().expandLevel2,name:b+q+bn,command:X+bn,workArea:q},{text:w().expandLevel3,name:b+q+yn,command:X+yn,workArea:q},{text:w().expandLevel4,name:b+q+wn,command:X+wn,workArea:q},{text:w().expandLevel5,name:b+q+Mn,command:X+Mn,workArea:q},{text:w().expandLevel6,name:b+q+Cn,command:X+Cn,workArea:q},{text:w().expandLevel7,name:b+q+Sn,command:X+Sn,workArea:q},{text:w().expandLevel8,name:b+q+Tn,command:X+Tn,workArea:q},{text:w().expandLevel9,name:b+q+An,command:X+An,workArea:q},{type:h},{text:w().clearContents,command:X+Bn,name:b+Bn,workArea:n+q+$+i},{type:h},{text:w().headerInsertCopiedCells,name:b+$+ct,command:X+$+ct,workArea:$},{text:w().headerInsertCutCells,name:b+$+ft,command:X+$+ft,workArea:$},{text:w().headerInsertCopiedCells,name:b+q+ct,command:X+q+ct,workArea:q},{text:w().headerInsertCutCells,name:b+q+ft,command:X+q+ft,workArea:q},{text:w().insertCopiedCells,name:b+ct,subMenu:[{text:w().shiftCellsRight,name:b+ct+ht,command:X+ct+ht,iconClass:t+ht},{text:w().shiftCellsDown,name:b+ct+lt,command:X+ct+lt,iconClass:t+lt}],workArea:n},{text:w().insertCutCells,name:b+ft,subMenu:[{text:w().shiftCellsRight,name:b+ft+ht,command:X+ft+ht,iconClass:t+ht},{text:w().shiftCellsDown,name:b+ft+lt,command:X+ft+lt,iconClass:t+lt}],workArea:n},{text:w().insertRows,name:b+ot,command:X+ot,workArea:$},{text:w().insertColumns,name:b+at,command:X+at,workArea:q},{text:w().deleteRows,name:b+On,command:X+On,workArea:$},{text:w().deleteColumns,name:b+Rn,command:X+Rn,workArea:q},{type:h},{text:w().tableInsert,name:b+Qn,subMenu:[{text:w().tableInsertColumnsLeft,name:b+qn,command:se,iconClass:t+qn},{text:w().tableInsertColumnsRight,name:b+$n,command:ce,iconClass:t+$n},{text:w().tableInsertRowsAbove,name:b+Kn,command:oe,iconClass:t+Kn},{text:w().tableInsertRowsBelow,name:b+Xn,command:ae,iconClass:t+Xn}],workArea:Wn},{text:w().tableDelete,name:b+Jn,subMenu:[{text:w().tableDeleteColumns,name:b+ie,command:fe,iconClass:t+ie},{text:w().tableDeleteRows,name:b+ee,command:ue,iconClass:t+ee}],workArea:Wn},{type:h},{text:w().insertSheet,name:b+jn,command:X+jn,workArea:T},{text:w().deleteSheet,name:b+Dn,command:X+Dn,workArea:T},{type:h},{text:w().filter,name:b+kn,command:X+kn,workArea:n+i},{text:w().sort,name:b+Nn,subMenu:[{text:w().sortAscend,name:b+et,command:X+et,iconClass:t+et},{text:w().sortDescend,name:b+it,command:X+it,iconClass:t+it}],workArea:n+i},{text:w().slicerSortAscend,name:b+Yn,command:X+Yn,iconClass:t+et,workArea:e},{text:w().slicerSortDescend,name:b+Zn,command:X+Zn,iconClass:t+it,workArea:e},{type:h},{text:w().insertComment,name:b+rt,command:X+rt,iconClass:t+rt,workArea:n+i,needKeepFocus:!0},{text:w().editComment,name:b+nt,command:X+nt,iconClass:t+nt,workArea:n+i,needKeepFocus:!0},{text:w().deleteComment,name:b+tt,command:X+tt,iconClass:t+tt,workArea:n+i},{text:w().toggleComment,name:b+Xt,command:X+Xt,workArea:n+i},{type:h},{text:w().hideRows,name:b+en,command:X+en,workArea:$},{text:w().unhideRows,name:b+tn,command:X+tn,workArea:$},{text:w().hideColumns,name:b+In,command:X+In,workArea:q},{text:w().unhideColumns,name:b+nn,command:X+nn,workArea:q},{type:h},{text:w().hideSheet,name:b+$t,command:X+$t,workArea:T},{text:w().unhideSheet,name:b+qt,command:X+qt,workArea:T},{type:h},{text:w().removeSlicer,name:b+Kt,command:X+Kt,workArea:e+S},{type:h},{text:w().sort,name:b+Nn,subMenu:[{text:w().sortAscend,name:b+et,command:Qt,iconClass:t+et,commandOptions:{subType:0},placeholder:D},{text:w().sortDescend,name:b+it,command:Qt,iconClass:t+it,commandOptions:{subType:1},placeholder:D},{text:w().pivotTableSortMoreOptions,name:b+xn,command:Jt}],workArea:r+o},{text:w().pivotTableRefresh,name:y+F,command:F,iconClass:t+F,workArea:A+I+o+r+N+x},{text:w().pivotTableRemove_,name:y+P,command:P,iconClass:t+P,workArea:A+I+o+r,placeholder:k},{text:w().pivotTableRemoveGrandTotal,name:y+U,command:U,workArea:N},{text:w().pivotTableSummarizeValuesBy,name:y+_,subMenu:[{text:w().pivotTableSum,name:b+z,command:a,commandOptions:{subTotalType:8}},{text:w().pivotTableCount,name:b+V,command:a,commandOptions:{subTotalType:1}},{text:w().pivotTableAverage,name:b+Y,command:a,commandOptions:{subTotalType:0}},{text:w().pivotTableMax,name:b+Z,command:a,commandOptions:{subTotalType:3}},{text:w().pivotTableMin,name:b+W,command:a,commandOptions:{subTotalType:4}},{text:w().pivotTableProduct,name:b+Q,command:a,commandOptions:{subTotalType:5}}],workArea:I+o+N},{text:w().pivotTableShowValueAs,name:y+B,subMenu:[{text:w().pivotTableNoCalculation,name:b+pt,command:a,commandOptions:{showValueAsType:0}},{text:w().pivotTableGrandTotal,name:b+bt,command:a,commandOptions:{showValueAsType:1}},{text:w().pivotTableColumnTotal,name:b+yt,command:a,commandOptions:{showValueAsType:3}},{text:w().pivotTableRowTotal,name:b+wt,command:a,commandOptions:{showValueAsType:2}},{text:w().pivotTableOf,name:b+Mt,command:u,commandOptions:{showValueAsType:4}},{text:w().pivotTableParentRowTotal,name:b+Ct,command:a,commandOptions:{showValueAsType:5}},{text:w().pivotTableParentColumnTotal,name:b+kt,command:a,commandOptions:{showValueAsType:6}},{text:w().pivotTableOfParentTotal,name:b+Nt,command:u,commandOptions:{showValueAsType:7}},{text:w().pivotTableDifferenceFrom,name:b+St,command:u,commandOptions:{showValueAsType:8}},{text:w().pivotTablePercentDifferenceFrom,name:b+Tt,command:u,commandOptions:{showValueAsType:9}},{text:w().pivotTableRunningTotalIN,name:b+At,command:u,commandOptions:{showValueAsType:10}},{text:w().pivotTablePercentRunningTotalIn,name:b+It,command:u,commandOptions:{showValueAsType:11}},{text:w().pivotTableRankSmallestToLargest,name:b+xt,command:u,commandOptions:{showValueAsType:12}},{text:w().pivotTableRankLargestToSmallest,name:b+Dt,command:u,commandOptions:{showValueAsType:13}},{text:w().pivotTableIndex,name:b+_t,command:a,commandOptions:{showValueAsType:14}}],workArea:I+o},{text:w().pivotTableFilter,name:y+jt,iconClass:t+jt,subMenu:[{text:w().pivotTableClearFilterFrom_,name:b+Ot,command:Wt,iconClass:t+Ot,placeholder:k,commandOptions:{clearType:0}},{text:w().pivotTableKeepOnlySelectedItems,name:b+Rt,command:Zt,commandOptions:{subType:1}},{text:w().pivotTableHideSelectedItems,name:b+Bt,command:Zt,commandOptions:{subType:2}},{text:w().pivotTableTop10,name:b+Lt,command:Vt,commandOptions:{isTop10:!0}},{text:w().pivotTableLabelFilters,name:b+Ft,command:Yt},{text:w().pivotTableValueFilters,name:b+Pt,command:Vt}],workArea:r},{text:w().pivotTableExpandOrCollapse,name:y+E,subMenu:[{text:w().pivotTableExpand,name:b+Gt,command:Gt,iconClass:t+Gt},{text:w().pivotTableCollapse,name:b+Ut,command:Ut,iconClass:t+Ut},{text:w().pivotTableExpandEntireField,name:b+Ht,command:Ht,iconClass:t+Ht},{text:w().pivotTableCollapseEntireField,name:b+zt,command:zt,iconClass:t+zt}],workArea:r},{text:w().pivotTableGroup,name:y+j,command:O,iconClass:t+j,workArea:r},{text:w().pivotTableUnGroup,name:y+R,command:R,iconClass:t+R,workArea:r},{text:w().pivotTableShowDetails,name:y+L,command:L,iconClass:t+L,workArea:o},{text:w().pivotTableValueFieldSettings,name:y+H,command:H,iconClass:t+H,workArea:I+o+N}]},c.prototype.Hc=function(t){var n=this;n.iq||(n.Qy=t.commandManager(),K(n.rq)&&(n.rq=new g.ContextMenuViewDialog(t.j2(),l(t.oM))),n.oq(t),n.aq={filter:{menuDataDict:[b+kn],checkFunction:function(t){if(t&&t.rowFilter)return!0}},comments:{menuDataDict:[b+rt,b+nt,b+tt,b+Xt],checkFunction:function(t){if(t&&t.comments)return!0}},slicer:{menuDataDict:[b+Yn,b+Zn,b+Kt],checkFunction:function(t){if(t&&t.slicers)return!0}},floatingObject:{menuDataDict:[b+st,b+Ln,b+Fn],checkFunction:function(t){var n,t,e;return!(t&&t.uq&&(t=(n=t.uq()).fromSheet)&&t.dP)||void 0}},table:{menuDataDict:[b+Qn,b+Jn],checkFunction:function(t){if(t&&t.tables)return!0}},tableSheet:{menuDataDict:[b+ut,b+rn,b+on,b+an,b+un,b+fn,b+sn,b+cn,b+ln,b+hn,b+dn,b+vn,b+mn,b+pn,b+bn,b+yn,b+wn,b+Mn,b+Cn,b+Sn,b+Tn,b+An],checkFunction:function(t){if(t&&t.NMi)return!0}}},n.iq=!0)},c.prototype.cq=function(t,n){var e,i,r,o,a,u,s,s,u,a,r,c,e=this;if(n.focus(),i=e.fq(t,n),K(i))M(t);else{if(r=(0,J.jf)(n)){if(a=r.getActiveRowIndex(),u=r.getActiveColumnIndex(),J.Worksheet.et(r,"preProcessContextMenu",s={r:!1,hitInfo:i}),s.r)return;if(r.isEditing()&&i.worksheetHitInfo&&i.worksheetHitInfo.col===u&&i.worksheetHitInfo.row===a||n.getTab()&&n.getTab().Og)return}e.Hc(n),e.lq(i,n),(r=(0,J.jf)(n))&&(s=r.getSelections()[0],K(s)||K(r.pivotTables)||(u=r.pivotTables.findPivotTable(s.row,s.col),!K(u)&&i.worksheetHitInfo&&(a=(i.worksheetHitInfo.pivotTableInfo=u).getPivotInfoImp(s.row,s.col,!1,!1,!0),K(a)||(i.worksheetHitInfo.pivotTableCellInfo=a)))),r=e.hq(e.menuData,i,n),(c=e.onOpenMenu(e.menuData,r,i,n))||(M(t),r.length&&e.dq(r,i,n),e.onMenuOpened())}},c.prototype.lq=function(t,n){var e=this;e.rq.QX(t)&&e.vq(t,n)},c.prototype.vq=function(t,n){var e,i,e=this,i=(0,J.jf)(n);i&&i.isEditing()&&i.endEdit(),e.mq(t)?e.gq(t,n):e.pq(t)&&e.bq(t,n)},c.prototype.pq=function(t){return!!t.worksheetHitInfo},c.prototype.yq=function(t,n,e,i){var r=!0,o,a;if(1===i){for(o=0;o<t.length;o++)-1===(a=t[o]).row&&e>=a.col&&e<a.col+a.colCount&&(r=!1);return r}if(2===i){for(o=0;o<t.length;o++)-1===(a=t[o]).col&&n>=a.row&&n<a.row+a.rowCount&&(r=!1);return r}for(o=0;o<t.length;o++)if((a=t[o]).contains(n,e))return!1;return!0},c.prototype.mq=function(t){return!(!t.tabStripHitInfo||!t.tabStripHitInfo.sheetTab)},c.prototype.wq=function(t){return t.tabStripHitInfo.sheetTab.sheetName},c.prototype.Mq=function(t){return t.tabStripHitInfo.sheetTab.sheetIndex},c.prototype.bq=function(t,n){var e,n,t,e=this,n=(0,J.jf)(n),t=t.worksheetHitInfo;t.floatingObjectHitInfo||t.commentHitInfo||t.shapeHitInfo||(e.kk(n,t),e.Cq(n))},c.prototype.Cq=function(t){var n,e,t,n,n=t.getActiveRowIndex(),e=t.getActiveColumnIndex(),t=t.comments;t&&(n=t.get(n,e))&&t.PW===n&&t.NK(n)},c.prototype.Sq=function(t){return 3===t.hitTestType},c.prototype.PA=function(t,n,e){t.PA&&t.PA(n,e)},c.prototype.kk=function(t,n){var e,i,r,o,a,u,e,i,e=this,i=t.Ut.getSelections(),r=n.row,o=n.col;t.JA(n.rowViewportIndex<0?-1:n.row,n.colViewportIndex<0?-1:n.col)&&(a=!1,e.yq(i,r,o,n.hitTestType)?a=!0:0<(e=(u=t.shapes&&t.shapes.all()||[]).filter(function(t){return t.isSelected()})).length&&(e.forEach(function(t){return t.isSelected(!1)}),a=!0),a)&&((i=t.rt).kk(t,n,r,o),i.X9())},c.prototype.gq=function(t,n){var e,i,r,e=this.Mq(t),i=n.e2(e);i&&(i.b2()||((r=n.qv()).forEach(function(t){t.b2()&&t.b2(!1,!0)}),i.b2(!0,!0)),n.I2(e,2,!1,!0),this.Tq(this.menuData,t,n))},c.prototype.fq=function(t,n){var e,i,t,e=n.wM(),i=t.pageX-e.left,t=t.pageY-e.top;return n.hitTest(i=0<=i?i:1,t=0<=t?t:1,!0)},c.prototype.onOpenMenu=function(t,n,e,i){},c.prototype.onMenuOpened=function(){},c.prototype.dq=function(t,n,e){var i=this;i.rq.QX(n)&&(i.Aq(),e.iy(),i.Iq(t,n,e))},c.prototype.Aq=function(){this.rq.close()},c.prototype.Iq=function(t,n,e){var i,r,o,n,i=this,r=e.uC(),o=n.x,n=n.y;o-=r.left,n-=r.top,i.rq.rQ(i.menuView,t,o,n,e)},c.prototype.hq=function(t,n,e){var i,r,t,i=this,r={};return l.extend(!0,r,t),t=i.xq(r,n,e),i.Nq(t,n),i.kq(t,e),i.Dq(t,e),i._q(t,e),i.Eq(t),t=i.jq(t),i.Oq(t),t},c.prototype.xq=function(t,a,u){var s,c,f,s=this,c=[],f=Object.keys(de);return l.each(t,function(t,n){var e,i,r,o;if(!K(n))for(n.type===h&&c.push(n),e=0;e<f.length;e++)if(i=f[e],(r=de[i])(a,u,n)&&(o=s.Rq(n,a)))return void c.push(n)}),c},c.prototype.Bq=function(t,n,e){var i,r,o,a,u,s,c,f,l,h,d,v,m,g,r,g,p,i=e.placeholder,r=e.name,o=n.area,a=n.value,u=n.menuArea,s=n.colHeadFieldInfo,c=n.rowInfos,f=n.colInfos,l=n.cornerFieldInfo,h=n.activeRowFieldInfo,d=n.activeColFieldInfo;if(K(i))r===b+Ft&&(r=h&&h.name||d&&d.name||s&&s.fieldName||l&&l.fieldName,g=t.dh,p=r&&g.getFieldInfoByName(r)&&2===g.getFieldInfoByName(r).W5)&&(e.text=w().pivotTableLabelFilters_Date);else if(i===k){if(v=void 0,0===u)v=n.pageFieldInfo.fieldName;else if(2===o&&2===u){if(s)v=s.fieldName;else if(v=d&&d.name,K(v)){for(m=d.index;0<=m&&f[m]&&K(f[m].itemName);)m-=1;v=f[m].fieldName}}else if(3===o&&2===u){if(v=h&&h.name,K(v)){for(m=h.index;0<=m&&c[m]&&K(c[m].itemName);)m-=1;v=c[m].fieldName}}else 1===o?1===u?v=n.value:2===u&&l&&(v=l.fieldName):4===u&&(v=n.valueFieldName,2===o?v=d&&d.name||a:3===o&&(v=h&&h.name||a));e.text=e.text.replace("{0}",'"'+v+'"')}else i===D&&4===u&&(v=void 0,0===(g=e.commandOptions.subType)?v=w().pivotTableSortAscend:1===g&&(v=w().pivotTableSortDescend),e.text=v);K(e.commandOptions)&&(e.commandOptions={}),e.commandOptions.pivotTableName=t.name(),e.commandOptions.pivotTableCellInfo=n},c.prototype.Oq=function(t){for(var n,e,i,r,n=0,e=!1,i=0;i<t.length&&((r=t[i].name)!==b+$+ct&&r!==b+$+ft&&r!==b+q+ct&&r!==b+q+ft||(e=!0),r!==b+ot&&r!==b+at||(n=i,!e));i++);e&&t.splice(n,1)},c.prototype.Nq=function(t,n){var n,e,n=n.worksheetHitInfo,e;!n||n.row!==dt&&n.col!==dt||t.splice(0,t.length)},c.prototype.kq=function(o,t){var a,u,t,a=this,u=(0,J.jf)(t),t=a.aq;return l.each(t,function(t,n){var e,i,r;if(!n.checkFunction(u))for(i=0,r=(e=n.menuDataDict).length;i<r;i++)a.Lq(o,e[i],function(t,n){t[n]=null})}),o},c.prototype.Rq=function(t,n){var e,i,r,n,o,a,u,s,c,f,l,h,d,v,m,g,p,e=this,i=n.worksheetHitInfo&&n.worksheetHitInfo.pivotTableInfo;if(i&&(r=n.worksheetHitInfo&&n.worksheetHitInfo.pivotTableCellInfo)){if(n=i.options.subtotalsPosition,o=r.value,a=r.area,u=r.menuArea,s=r.cornerFieldInfo,c=r.colHeadFieldInfo,f=r.activeRowFieldInfo,l=r.activeColFieldInfo,h=r.rowInfos,d=r.colInfos,v=r.valueFieldName,-1<(m=[y+E,y+jt,y+L]).indexOf(t.name)&&((2===a||3===a)&&4===u||(!K(s)||!K(c))&&o===w().sigmaValueTemp||3===a&&f&&h[f.index].isSubtotal&&void 0===h[f.index].collapseIndex&&1!==n||2===a&&l&&d[l.index].isSubtotal&&void 0===d[l.index].collapseIndex&&1!==n))return!1;if(-1<(g=[y+j,y+R]).indexOf(t.name)&&(!K(s)||!K(c)))return!1;if(-1<(p=[y+H,y+P,y+_,y+B]).indexOf(t.name)&&K(v)&&4===u&&4===a)return!1;t&&t.subMenu?t.subMenu.forEach(function(t){e.Bq(i,r,t),e.Fq(i,r,t)}):e.Bq(i,r,t)}return!0},c.prototype.Fq=function(t,n,e){var i,r,o,a,n,i,r,u,s,n,t,c,f,l,h,l,i=n.activeRowFieldInfo,r=n.activeColFieldInfo,o=n.cornerFieldInfo,a=n.colHeadFieldInfo,n=n.valueFieldName,i=i&&i.name||r&&r.name||a&&a.fieldName||o&&o.fieldName||n,r=t.dh,u=i&&r.getFieldInfoByName(i),s=r.K;switch(e.commandOptions&&u&&(n=e.commandOptions.showValueAsType,t=e.commandOptions.subTotalType,K(n)||(c=u.Or&&u.Or.showDataAs||0)===n&&(e.iconClass=C),K(t)||(f=u.getSubTotalType())===t&&(e.iconClass=C)),e.name){case b+Ot:h=!1,(l=s.Pq[u.a])&&l.C()&&(h=!0),l=!!l&&l.on(),h||l||(e.disable=!0);break;case b+Rt:case b+Bt:K(o)&&K(a)||(e.disable=!0)}},c.prototype.Dq=function(t,n){var n,e,i,r,o,n=(0,J.jf)(n),e=n&&n.getSelections();e&&0<e.length&&(i=Be(n,e[0]),r=n.getActiveRowIndex(),o=n.getActiveColumnIndex(),i)&&l.each(t,function(t,n){var n;K(n)||n.name===b+Qn&&(n=n.subMenu,i.checkTableLastRow(r)&&n.splice(3,1),i.checkTableLastCol(o))&&n.splice(1,1)})},c.prototype.Eq=function(t){for(var n,e,i,n=this,i,e=t.length-1;0<=e;e--)t[e]?t[e].subMenu&&n.Eq(t[e].subMenu):t.splice(e,1);return t},c.prototype.jq=function(t){for(var n,e,i,r,o,a,u,n=[],i=t.length,e=0;e<i;e++)t[e]&&t[e].type===h&&t[e+1]&&t[e+1].type===h||n.push(t[e]);for(i=n.length,u=a=!(o=r=0),e=0;e<i&&(a&&n[e].type===h?r++:a=!1,u&&n[i-1-e].type===h?o++:u=!1,a||u);e++);return n.splice(i-o,o),n.splice(0,r),n},c.prototype._q=function(t,n){var e=this;e.Gq(t,n),e.Uq(t,n)},c.prototype.Gq=function(t,n){for(var e,i,r,o,a,e=this,i=(0,J.jf)(n),r=i&&i.tables,o=i&&i.NMi,a=0;a<t.length;a++)if(t[a]){switch(t[a].name){case b+ot:i.rR()||(t[a].disable=!0);break;case b+On:(!i.rR()||r&&r.containTableHeaderTotalRowForSheet())&&(t[a].disable=!0);break;case b+at:case b+Rn:i.oR()||(t[a].disable=!0);break;case b+Kn:r&&(r.isAcrossTables()||r.containTableHeader()||r.noRoomToInsertRow())&&(t[a].disable=!0);break;case b+Xn:r&&(r.isAcrossTables()||r.noRoomToInsertRow())&&(t[a].disable=!0);break;case b+ee:r&&(r.checkTableRow()||r.isAcrossTables()||r.containTableHeaderTotalRow())&&(t[a].disable=!0);break;case b+qn:case b+$n:r&&(r.isAcrossTables()||r.noRoomToInsertColumn())&&(t[a].disable=!0);break;case b+ie:r&&(r.checkTableCol()||r.isAcrossTables()||r.isWholeTableCol())&&(t[a].disable=!0);break;case b+on:o&&(t[a].disable=!o.enablePinColumn());break;case b+rn:o&&(t[a].disable=!o.enablePinRow())}t[a]&&t[a].subMenu&&e.Gq(t[a].subMenu,n)}},c.prototype.Uq=function(t,n){var e,i,r,o,a,u,s,s,e=this,i=(0,J.jf)(n),r=i&&i.options.isProtected,o=i&&i.options.protectionOptions;if(r&&o)for(a=void 0,u=0;u<t.length;u++)if(t[u]){switch(t[u].name){case b+ot:o.allowInsertRows||(t[u].disable=!0);break;case b+at:o.allowInsertColumns||(t[u].disable=!0);break;case b+On:o.allowDeleteRows||(t[u].disable=!0);break;case b+Rn:o.allowDeleteColumns||(t[u].disable=!0);break;case b+kn:o.allowFilter||(t[u].disable=!0);break;case b+et:case b+it:o.allowSort||(t[u].disable=!0);break;case b+en:case b+tn:case b+In:case b+nn:i.NMi||(t[u].disable=!0);break;case b+Yn:case b+Zn:o.allowEditObjects||t.splice(0,t.length);break;case b+rt:o.allowEditObjects||(t[u]=null);break;case b+nt:s=void 0,i.comments&&(s=(a=i.comments.get(i.getActiveRowIndex(),i.getActiveColumnIndex()))&&a.lockText()),!o.allowEditObjects&&s&&(t[u]=null);break;case b+tt:s=void 0,i.comments&&(s=!Ae(i.getSelections(),i)),!o.allowEditObjects&&s&&(t[u]=null);break;case b+Kn:case b+Xn:case b+qn:case b+$n:case b+ee:case b+ie:t[u].disable=!0}t[u]&&t[u].subMenu&&e.Uq(t[u].subMenu,n)}},c.prototype.Tq=function(t,n,e){var n,i,r,o;if(n.tabStripHitInfo&&(n=this,i=e.qv(),r=n.Hq(b+qt))){for(o=0;o<i.length;o++)if(i[o].visible()===J.SheetTabVisible.hidden)return void(r.disable=!1);r.disable=!0}},c.prototype.Hq=function(t){var n=this;return n.zq(n.menuData,t)},c.prototype.zq=function(t,n){var e,i,e;return this.Lq(t,n,function(t,n){i=t[n]}),i},c.prototype.Lq=function(t,n,e){for(var i,r,o,i=this,r=t.length,o=0;o<r;o++)if(!K(t[o])){if(n===t[o].name)return void e(t,o);t[o].subMenu&&i.Lq(t[o].subMenu,n,e)}},c.prototype.Vq=function(t,n){for(var e,i,r,o,e=this,i=t.length,r=0;r<i;r++)o=t[r],K(o)||(n(o),o.subMenu&&e.Vq(o.subMenu,n))},c.prototype.oq=function(d){var c,t,n,e,i,i,r,o,a,u,s,f,l,h,v,m,g,p,b,y,w,M,C,S,T,A,I,x,N,k,D,_,E,j,B,L,F,P,G,O,U,H,z,V,Y,Z,W,Q;function R(t,n,e){for(var i,r,i=0;i<e;i++)-1===t.indexOf(r=n+i)&&t.push(r)}this.Yq||((c=d.commandManager()).register(X+Un,t={canUndo:!1,execute:function(t,n){var t=(0,J._f)(t,n.sheetName);t&&(me(t)?c.execute({cmd:"copyFloatingObjects",sheetName:t.name()}):c.execute({cmd:Un,sheetName:t.name(),ignoreClipboard:!0}))}},null,!1,!1,!1,!1),c.register(X+Gn,n={canUndo:!1,execute:function(t,n){var t=(0,J._f)(t,n.sheetName);t&&(me(t)?c.execute({cmd:"cutFloatingObjects",sheetName:t.name()}):c.execute({cmd:Gn,sheetName:t.name(),ignoreClipboard:!0}))}},null,!1,!1,!1,!1),c.register(X+Pn,e={canUndo:!1,execute:function(t,n){var t=(0,J._f)(t,n.sheetName);t&&(t.isPasteFloatingObject&&t.isPasteFloatingObject()?c.execute({cmd:"pasteFloatingObjects",sheetName:t.name()}):t.isPasteShapes&&t.isPasteShapes()?c.execute({cmd:"pasteShapes",sheetName:t.name()}):c.execute({cmd:ut,sheetName:t.name(),pasteOption:0}))}},null,!1,!1,!1,!1),c.register(X+ct+ht,i={canUndo:!1,execute:function(t,n){var t=(0,J._f)(t,n.sheetName);t&&c.execute({cmd:ut,sheetName:t.name(),pasteOption:0,shiftCells:J.InsertShiftCell.right,isHeaderPaste:Xe(n.itemName)})}},null,!1,!1,!1,!1),c.register(X+ft+ht,i,null,!1,!1,!1,!1),c.register(X+q+ct,i,null,!1,!1,!1,!1),c.register(X+q+ft,i,null,!1,!1,!1,!1),c.register(X+ct+lt,i={canUndo:!1,execute:function(t,n){var t=(0,J._f)(t,n.sheetName);t&&c.execute({cmd:ut,sheetName:t.name(),pasteOption:0,shiftCells:J.InsertShiftCell.down,isHeaderPaste:Xe(n.itemName)})}},null,!1,!1,!1,!1),c.register(X+ft+lt,i,null,!1,!1,!1,!1),c.register(X+$+ct,i,null,!1,!1,!1,!1),c.register(X+$+ft,i,null,!1,!1,!1,!1),c.register(X+Fn,r={canUndo:!1,execute:function(t,n){var e=3;Ye(t,n,c,3)}},null,!1,!1,!1,!1),c.register(X+st,o={canUndo:!1,execute:function(t,n){var e=1;Ye(t,n,c,1)}},null,!1,!1,!1,!1),c.register(X+Ln,a={canUndo:!1,execute:function(t,n){var t=(0,J._f)(t,n.sheetName);t&&c.execute({cmd:ut,sheetName:t.name(),pasteOption:2})}},null,!1,!1,!1,!1),c.register(X+Hn,u={canUndo:!1,execute:function(t,n){var e=4;Ye(t,n,c,4)}},null,!1,!1,!1,!1),c.register(X+zn,s={canUndo:!1,execute:function(t,n){var e=5;Ye(t,n,c,5)}},null,!1,!1,!1,!1),c.register(X+Bn,f={canUndo:!1,execute:function(t,n){var t=(0,J._f)(t,n.sheetName);t&&c.execute({cmd:"clear",sheetName:t.name()})}},null,!1,!1,!1,!1),c.register(X+rt,l={canUndo:!0,execute:function(v,t,n){return mt(v,t,n,function(t,n){var e,i,r,n,o,e,i,a,u,e,i,s,o,c,f,l,h,d,e=n.commentState||2,i=n.displayMode,r=n.activeRow,n=n.activeCol,o=t.comments.add(r,n,"");o&&(o.commentState(e),i&&o.displayMode(i),e=t.C0(r),i=t.S0(n),a=t.getCellRect(r,n,e,i),e=(u=t.Fi()).c9(e,i),i=o.location(),s=o.width(),o=o.height(),h=l=f=c=void 0,d=v.ib,a.y+i.y<e.y?(l=ze(t,r,a.y+i.y-e.y),c=d.Jy(t,l),d.yy(t,c.Ky,0),t.tw()):a.y+i.y+o>e.y+e.height&&(l=ze(t,r,a.y+i.y+o-(e.y+e.height)),c=d.Jy(t,l),d.yy(t,c.Ky,0),t.tw()),a.x+i.x+s>e.x+e.width)&&(h=Ve(t,n,a.x+i.x+s-(e.x+e.width)),f=d.rw(t,h),d.wy(t,f.iw,0),t.ow())},function(t,n){var e,i,e,i,e=n.activeRow,i=n.activeCol,e=t.comments.get(e,i);if(e)return n.displayMode=e.displayMode(),n.commentState=e.commentState(),i={sheet:t,sheetName:t.name(),comment:e,cancel:!1},t.ki(J.Events.CommentRemoving,i),{cancel:i.cancel,comment:e}},function(t,n,e){t.ki(J.Events.CommentRemoved,{sheet:t,sheetName:t.name(),comment:e.comment})})}},null,!1,!1,!1,!1),c.register(X+nt,h={canUndo:!1,execute:function(t,n){var t,e,n,t,t=(0,J._f)(t,n.sheetName);t&&(e=n.activeRow,n=n.activeCol,t=t.comments.get(e,n))&&t.commentState(2,!0)}},null,!1,!1,!1,!1),c.register(X+tt,v={canUndo:!0,execute:function(t,s,n){return mt(t,s,n,function(t){var n,e,i,r,o,a,u,n=s.selections,e=n.length;if(!(e<=0))for(i=0;i<e;i++)for(o=(r=n[i]).row;o<r.row+r.rowCount;o++)for(a=r.col;a<r.col+r.colCount;a++)!(u=t.comments.get(o,a))||t.options.isProtected&&!t.options.protectionOptions.allowEditObjects&&u.locked()||c.execute({cmd:tt,sheetName:t.name(),row:u.bZ,col:u.yZ})})}},null,!1,!1,!1,!1),c.register(X+Xt,m={canUndo:!1,execute:function(t,n){var t,e,n,t,t=(0,J._f)(t,n.sheetName);t&&(e=n.activeRow,n=n.activeCol,t=t.comments.get(e,n))&&(2===t.displayMode()?t.displayMode(1):t.displayMode(2))}},null,!1,!1,!1,!1),c.register(X+ot,g={canUndo:!0,execute:function(t,v,n){return v.considerAllSheets=!0,mt(t,v,n,function(t){for(var n,e,i,r,o,a,u,s,c,f,l,h,d,n=Fe(v.selections),i=0;i<n.length;i++){for(e=n[i],r=t.getRange(e.row-1,0,1,e.colCount),o=[],a=0;a<r.colCount;a++)t.getCell(r.row,a).locked()||o.push(a);for(u=e.row,s=e.rowCount,t.addRows(u,s),c=0;c<o.length;c++)for(f=n[i].row;f<n[i].row+n[i].rowCount;f++)t.getCell(f,o[c]).locked(!1);if(t.tables&&0<s)for(l=t.tables.AB(u,-1,s,-1),h=0;h<l.length;h++)(d=l[h]).jj(u,s,!1,!1);Ge(t,u,-1,s)}})}},null,!1,!1,!1,!1),c.register(X+at,p={canUndo:!0,execute:function(t,v,n){return v.considerAllSheets=!0,mt(t,v,n,function(t){for(var n,e,i,r,o,a,u,s,c,f,l,h,d,n=Pe(v.selections),i=0;i<n.length;i++){for(e=n[i],r=t.getRange(0,e.col-1,e.rowCount,1),o=[],a=0;a<r.rowCount;a++)t.getCell(a,r.col).locked()||o.push(a);for(u=e.col,s=e.colCount,t.addColumns(u,s),c=0;c<o.length;c++)for(f=u;f<u+s;f++)t.getCell(o[c],f).locked(!1);if(t.tables&&0<s)for(l=t.tables.AB(-1,u,-1,s),h=0;h<l.length;h++)(d=l[h]).Ej(u,s,!1,!1);Ge(t,-1,u,s)}})}},null,!1,!1,!1,!1),c.register(X+On,b={canUndo:!0,execute:function(t,h,n){return h.considerAllSheets=!0,mt(t,h,n,function(t){for(var n,e,i,r,o,a,u,s,c,f,l,n=Fe(h.selections),e=t.filterRowsVisibleInfo&&t.filterRowsVisibleInfo.rowsVisibleInfo,i=e&&0<Object.keys(e).length,r=0;r<n.length;r++)if(a=(o=n[r]).row,u=o.rowCount,s=t.getRowCount(),i)for(f=(c=pe(o,e)).length-1;0<=f;f--)a=c[f][0],u=c[f][1],l=t.tables&&t.tables.AB(a,-1,u,-1),t.deleteRows(a,u),0<l.length&&0<s-t.getRowCount()&&(s=t.getRowCount(),Le(t,l,a,u));else l=t.tables&&t.tables.AB(a,-1,u,-1),t.deleteRows(a,u),0<l.length&&0<s-t.getRowCount()&&Le(t,l,a,u)})}},null,!1,!1,!1,!1),c.register(X+Rn,y={canUndo:!0,execute:function(t,c,n){return c.considerAllSheets=!0,mt(t,c,n,function(t){for(var n,e,i,r,o,a,u,s,n=Pe(c.selections),e=0;e<n.length;e++)if(i=t.getColumnCount(),r=n[e].col,o=n[e].colCount,a=void 0,t.tables&&(a=t.tables.AB(-1,r,-1,o)),t.deleteColumns(r,o),t.tables&&0<i-t.getColumnCount())for(u=0;u<a.length;u++)(s=a[u]).Ej(r,o,!0)})}},null,!1,!1,!1,!1),c.register(X+jn,w={canUndo:!1,execute:function(t){var n,e,i,r,o,a,u,s,n=t.getActiveSheetIndex(),e=t.getActiveSheetTabIndex(),i=[],r=(0,J.jf)(t),o=0<=e?t.bb("",J.SheetType.tableSheet):t.S2(t.T2(n)),a;t.qv().forEach(function(t){t.b2()&&i.push(t)}),i.forEach(function(t){t.b2(!1,!0)}),u={sheetName:o.name(),propertyName:"insertSheet",cancel:!1,sheetIndex:-1!==n?n:e,sheetPosition:t.getSheetPosition(o.name())},t.ki(J.Events.SheetChanging,u),u.cancel||(t.ki(J.Events.ActiveSheetChanging,s={oldSheet:r,newSheet:o}),0<=e?t.yb(e,2,o):t.A2(Math.max(0,n),2,o),o.b2(!0,!0),t.ki(J.Events.SheetChanged,{sheetName:o.name(),propertyName:"insertSheet",sheetIndex:-1!==n?n:e,sheetPosition:t.getSheetPosition(o.name())}),t.ki(J.Events.ActiveSheetChanged,{oldSheet:r,newSheet:o}))}},null,!1,!1,!1,!1),c.register(X+Dn,M={canUndo:!1,execute:function(r,t){var o,n,e,a,u,n,s,n,o=(0,J.jf)(r),n=r.qv();1<n.length&&(e=[],a=[],n.forEach(function(t,n){var t,t;t.b2()&&(t=t.name(),e.push(t),t=r._se(t),a.push(t))}),e.length!==n.length)?1<=e.length&&(r.suspendPaint(),r.suspendCalcService(),u={oldSheet:o,cancel:!1},n=r.sheets,r.options&&r.options.saveChangesForSheet&&J.Commands.II(n),s=[],e.forEach(function(t,n){var n,e,i,i,i,n=a[n],e=(0,J._f)(r,t),i={sheetName:t,propertyName:"deleteSheet",cancel:!1,sheetIndex:n,sheetPosition:r.getSheetPosition(t)};e===o&&r.ki(J.Events.ActiveSheetChanging,u),r.ki(J.Events.SheetChanging,i),u.cancel||i.cancel||(i=r.getSheetIndex(t),!K(i)&&0<=i?(r.removeSheet(i),-1===r.getActiveSheetIndex()&&r.setActiveSheetTab(0)):(i=r.getSheetTabIndex(t),!K(i)&&0<=i&&(r.removeSheetTab(i),-1===r.getActiveSheetTabIndex())&&r.setActiveSheetIndex(0)),s.push(t),r.ki(J.Events.SheetChanged,{sheetName:t,propertyName:"deleteSheet",sheetIndex:n,sheetPosition:r.getSheetPosition(t)}),i=(0,J.jf)(r),e===o&&r.ki(J.Events.ActiveSheetChanged,{oldSheet:e,newSheet:i}))}),t.deletedSheets=s,r.options&&r.options.saveChangesForSheet&&J.Commands.xI(n,t),(n=(0,J.jf)(r))&&!n.isSelected()&&n.b2(!0,!0),r.resumeCalcService(!1),r.resumePaint()):We(o),r.undoManager().clear()}},null,!1,!1,!1,!1),c.register(X+kn,C={canUndo:!0,execute:function(t,u,n){return mt(t,u,n,function(t){var n,e,i,r,o,a,i,n,e=u.selections[0],i=Be(t,e),r=u.activeRow,o=u.activeCol;i?(a=i.range()).contains(r,o,1,1)&&(i=i.name(),c.execute({cmd:"contextmenuFilterForTable",sheetName:t.name(),cmdOption:{tableName:i,activeRow:r,activeCol:o,expectedText:t.getText(r,o)}})):t.rowFilter&&c.execute({cmd:"contextmenuFilterForSheet",sheetName:t.name(),cmdOption:{activeRow:r,activeCol:o,selection:e,expectedText:t.getText(r,o)}})})}},null,!1,!1,!1,!1),c.register(X+et,S={canUndo:!0,execute:function(t,o,n){return mt(t,o,n,function(t){var n,e,i,e,r,r,n=o.activeCol,e=o.selections,i=Be(t,e[0]),e=i?i.dataRange():e[0],r=t.TB(e,!0,null),r={sheet:t,sheetName:t.name(),col:n,ascending:!0,range:e,compareFunction:dt,groupSort:r.groupSort,ignoreHidden:r.ignoreHidden,cancel:!1};t.ki(J.Events.RangeSorting,r),!1===r.cancel&&(t.sortRange(e.row,e.col,e.rowCount,e.colCount,!0,[{index:n,ascending:!0,compareFunction:r.compareFunction}],{groupSort:r.groupSort,ignoreHidden:r.ignoreHidden},dt,!!i),t.ki(J.Events.RangeSorted,r))})}},null,!1,!1,!1,!1),c.register(X+it,T={canUndo:!0,execute:function(t,o,n){return mt(t,o,n,function(t){var n,e,i,e,r,r,n=o.activeCol,e=o.selections,i=Be(t,e[0]),e=i?i.dataRange():e[0],r=t.TB(e,!0,null),r={sheet:t,sheetName:t.name(),col:n,ascending:!1,range:e,compareFunction:dt,groupSort:r.groupSort,ignoreHidden:r.ignoreHidden,cancel:!1};t.ki(J.Events.RangeSorting,r),!1===r.cancel&&(t.sortRange(e.row,e.col,e.rowCount,e.colCount,!0,[{index:n,ascending:!1,compareFunction:r.compareFunction}],{groupSort:r.groupSort,ignoreHidden:r.ignoreHidden},dt,!!i),t.ki(J.Events.RangeSorted,r))})}},null,!1,!1,!1,!1),c.register(X+Yn,A={canUndo:!0,execute:function(t,n,e){return Ze(t,n,e,1)}},null,!1,!1,!1,!1),c.register(X+Zn,I={canUndo:!0,execute:function(t,n,e){return Ze(t,n,e,2)}},null,!1,!1,!1,!1),c.register(X+rn,x={canUndo:!0,execute:function(t,a,n){return mt(t,a,n,function(t){var n,e,i,r,o,n=a.selections;if(0<n.length){for(e=[],i=0,r=n;i<r.length;i++)R(e,(o=r[i]).row,o.rowCount);try{t.NMi.togglePinnedRows(e)}catch(t){return!1}}})}},null,!1,!1,!1,!1),c.register(X+on,N={canUndo:!0,execute:function(t,a,n){return mt(t,a,n,function(t){var n,e,i,r,o,n=a.selections;if(0<n.length){for(e=[],i=0,r=n;i<r.length;i++)R(e,(o=r[i]).col,o.colCount);try{t.NMi.togglePinnedColumns(e)}catch(t){return!1}}})}},null,!1,!1,!1,!1),c.register(X+an,k={canUndo:!0,execute:function(t,n,e){return mt(t,n,e,function(t){try{t.NMi.promoteHierarchyLevel(n.activeRow)}catch(t){return!1}})}},null,!1,!1,!1,!1),c.register(X+un,D={canUndo:!0,execute:function(t,n,e){return mt(t,n,e,function(t){try{t.NMi.demoteHierarchyLevel(n.activeRow)}catch(t){return!1}})}},null,!1,!1,!1,!1),c.register(X+sn,_={canUndo:!0,execute:function(t,n,e){return mt(t,n,e,function(t){try{t.NMi.addHierarchyItemAfter(n.activeRow)}catch(t){return!1}})}},null,!1,!1,!1,!1),c.register(X+cn,E={canUndo:!0,execute:function(t,n,e){return mt(t,n,e,function(t){try{t.NMi.addHierarchyItemBefore(n.activeRow)}catch(t){return!1}})}},null,!1,!1,!1,!1),c.register(X+fn,j={canUndo:!0,execute:function(t,n,e){return mt(t,n,e,function(t){try{t.NMi.addHierarchyItemAbove(n.activeRow)}catch(t){return!1}})}},null,!1,!1,!1,!1),c.register(X+ln,B={canUndo:!0,execute:function(t,n,e){return mt(t,n,e,function(t){try{t.NMi.addHierarchyItemBelow(n.activeRow)}catch(t){return!1}})}},null,!1,!1,!1,!1),c.register(X+hn,L={canUndo:!0,execute:function(t,n,e){return mt(t,n,e,function(t){try{t.NMi.moveUp(n.activeRow)}catch(t){return!1}})}},null,!1,!1,!1,!1),c.register(X+dn,F={canUndo:!0,execute:function(t,n,e){return mt(t,n,e,function(t){try{t.NMi.moveDown(n.activeRow)}catch(t){return!1}})}},null,!1,!1,!1,!1),c.register(X+vn,P={canUndo:!0,execute:function(t,n,e){return mt(t,n,e,function(t){try{t.NMi.expandAllHierarchyLevels()}catch(t){return!1}})}},null,!1,!1,!1,!1),c.register(X+mn,G={canUndo:!0,execute:function(t,n,e){return mt(t,n,e,function(t){try{t.NMi.collapseAllHierarchyLevels()}catch(t){return!1}})}},null,!1,!1,!1,!1),O={canUndo:!0,execute:function(t,e,n){return mt(t,e,n,function(t){try{var n=parseInt(e.cmd.charAt((X+gn).length),10)-1;t.NMi.expandHierarchyLevel(n)}catch(t){return!1}})}},je(9,function(t){c.register(X+gn+(t+1),O,null,!1,!1,!1,!1)}),c.register(X+re,U={canUndo:!1,execute:function(t,n){var n,e,n,i,n=n.itemName.substr(10),e=t.ep(),n=t.getSheetPosition(n);t.w2.g2(n),(i=t.getTab()).G2(e,n)}},null,!1,!1,!1,!1),c.register(X+en,H={canUndo:!0,execute:function(t,e,n){return mt(t,e,n,function(n){t.suspendCalcService(),ge(e.selections,le,function(t){n.setRowVisible(t,!1)}),t.resumeCalcService(!1)})}},null,!1,!1,!1,!1),c.register(X+In,z={canUndo:!0,execute:function(t,e,n){return mt(t,e,n,function(n){t.suspendCalcService(),ge(e.selections,he,function(t){n.setColumnVisible(t,!1)}),t.resumeCalcService(!1)})}},null,!1,!1,!1,!1),c.register(X+$t,V={canUndo:!1,execute:function(t){var n,e,i,r,o,a,u,s,c,f,l,f,l,e,h,h,n=0,e=t.qv();if(e.forEach(function(t){t.visible()===J.SheetTabVisible.visible&&(n+=1)}),i=(0,J.jf)(t),n<=1)We(i);else{if(o=[],e.forEach(function(t){t.b2()&&o.push(t)}),n!==o.length){for(a=0;a<o.length;a++)f={sheetName:s=(u=o[a]).name(),propertyName:"isVisible",cancel:!1,sheetIndex:c=t._se(s),sheetPosition:t.getSheetPosition(s),oldValue:!0,newValue:!1},t.ki(J.Events.SheetChanging,f),l={cancel:!1,oldSheet:u},s===i.name()&&t.ki(J.Events.ActiveSheetChanging,l),f.cancel||l.cancel||(u.b2(!1,!0),vt.push(u),u.visible(!1),f=(0,J.jf)(t),a===o.length-1&&f&&!f.isSelected()&&(r={oldValue:!1,newValue:!0,sheetName:l=f.name(),propertyName:"isSelected",cancel:!1,sheetIndex:t._se(l),sheetPosition:d.getSheetPosition(l)},t.ki(J.Events.SheetChanging,r)),t.ki(J.Events.SheetChanged,{sheetName:s,propertyName:"isVisible",sheetIndex:c,sheetPosition:t.getSheetPosition(s),oldValue:!0,newValue:!1}));h=(e=(0,J.jf)(t))&&e.name(),r&&(r.cancel?e.Ut.qj(!1):(e.Ut.qj(!0),t&&t.w2&&t.w2.repaint(),h={oldValue:!1,newValue:!0,sheetName:h,propertyName:"isSelected",sheetIndex:t._se(h),sheetPosition:t.getSheetPosition(h)},t.ki(J.Events.SheetChanged,h))),i!==e&&t.ki(J.Events.ActiveSheetChanged,{oldSheet:i,newSheet:e})}else We(i);t.undoManager().clear()}}},null,!1,!1,!1,!1),c.register(X+tn,Y={canUndo:!0,execute:function(i,r,t){return mt(i,r,t,function(n){var t,e,t=r.selections,e=r.isAnyHiddenRowOrColBeforeFirstVisibleRowOrCol;K(e)&&(e=r.isAnyHiddenRowOrColBeforeFirstVisibleRowOrCol=be(n,t[0])),1===t.length&&e?(n.setRowVisible(t[0].row-1,!0),n.$A(t[0].row-1)):(i.suspendCalcService(),ge(t,le,function(t){n.setRowVisible(t,!0),t===n.pw()&&(n.Tb=0,n.tw())}),i.resumeCalcService(!1))})}},null,!1,!1,!1,!1),c.register(X+nn,Z={canUndo:!0,execute:function(i,r,t){return mt(i,r,t,function(n){var t,e,t=r.selections,e=r.isAnyHiddenRowOrColBeforeFirstVisibleRowOrCol;K(e)&&(e=r.isAnyHiddenRowOrColBeforeFirstVisibleRowOrCol=be(n,t[0])),1===t.length&&e?(n.setColumnVisible(t[0].col-1,!0),n.o9(t[0].col-1)):(i.suspendCalcService(),ge(t,he,function(t){n.setColumnVisible(t,!0),t===n.Sw()&&(n.Ab=0,n.ow())}),i.resumeCalcService(!1))})}},null,!1,!1,!1,!1),c.register(X+qt,W={canUndo:!1,execute:function(e,t){var i,n,r,o,a,u,t,s,i=e.qv();if(0===vt.length)for(n=0;n<i.length;n++)i[n].visible()===J.SheetTabVisible.hidden&&(vt.push(i[n]),i[n].b2(!1));if(r=(0,J.jf)(e),0<vt.length){if(i.forEach(function(t){t!==r&&t.b2(!1,!0)}),a=o=void 0,t&&!K(t.activeSheetIndex)&&(o=i[t.activeSheetIndex]),t&&t.unhideSheetIndexes&&0<t.unhideSheetIndexes.length&&((t=t.unhideSheetIndexes).forEach(function(t){var n,n,n=i[t];!1!==(u=Qe(e,n))&&-1<(n=vt.indexOf(i[t]))&&vt.splice(n,1)}),o=o||i[t[t.length-1]]),!o){if(!(o=vt.pop()))return;if(!1===(u=Qe(e,o)))return}if(!o)return;if(!1===(s=Je(e,r,o)))return;e.setActiveSheet(o.name())}(0,J.jf)(e)!==r&&Ke(e,r)}},null,!1,!1,!1,!1),c.register(X+Kt,Q={canUndo:!1,execute:function(t,n){var n,e,i,r,o,n=(0,J._f)(t,n.sheetName);if(n&&(t.suspendPaint(),e=[],i=n.slicers.all())&&!gt(i)){for(r in i)i.hasOwnProperty(r)&&(o=i[r]).isSelected()&&e.push(o.name());c.execute({cmd:"deleteSlicers",sheetName:n.name(),slicerNames:e}),t.resumePaint()}}},null,!1,!1,!1,!1),this.Yq=!0)},c.prototype.openAllSheetsListContextMenu=function(t,n,e,i){var r,e,r=this.menuView.maxHeight();!K(r)&&-1!==r||this.menuView.maxHeight(400),e=this.Zq(n,e),this.Hc(n),this.lq(e,n),this.dq(t,e,n),K(r)?this.menuView.maxHeight(-1):this.menuView.maxHeight(r),this.menuView.Wq&&this.menuView.Wq.hU(i)},c.prototype.Zq=function(t,n){var n,e,n=this.fq(n,t),e=2;return 0===t.options.tabStripPosition&&(n.x=n.x+2,n.y=n.y-2),n},ve=c,d.ContextMenu=ve,J.Workbook.ch("contextmenu",{init:function(){var t=this;t.contextMenu||(t.contextMenu=new ve),t.contextMenu.oq(this)},setHost:function(){var n,t,n=this,t=n.Ti;n.contextMenu||(n.contextMenu=new ve),l(t).bind("contextmenu.gcSheet",function(t){if(n.options.allowContextMenu)return n.contextMenu.cq(t,n)})},dispose:function(){l(this.Ti).unbind("contextmenu.gcSheet")},onCultureChanged:function(){var t,n,e,i,t=this.contextMenu;t&&(n=t.menuData,e=t.nq(),i={},t.Vq(e,function(t){K(t.name)||(i[t.name]=t.text)}),t.Vq(n,function(t){K(t.name)||K(i[t.name])||(t.text=i[t.name])}))},fromJson:function(t){var n=this.contextMenu&&this.contextMenu.menuView,e=t.contextMenu;n&&!K(e)&&(n.Qq=t.scrollable,n.Kq=t.maxHeight)},toJson:function(t){var n=this.contextMenu&&this.contextMenu.menuView;!n||K(n.Qq)&&K(n.Kq)||(t.contextMenu={},t.contextMenu.scrollable=n.Qq,t.contextMenu.maxHeight=n.Kq)}})},"./dist/plugins/contextMenu/context-menu.ns.js":function(t,n,e){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.SR=void 0;var e=e("./dist/plugins/contextMenu/context-menu.res.en.js");n.SR={en:e}},"./dist/plugins/contextMenu/context-menu.res.en.js":function(t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.pivotTableRefresh=n.hideSheetFailureInfo=n.tableDeleteColumns=n.tableDeleteRows=n.tableDelete=n.tableInsertColumnsRight=n.tableInsertColumnsLeft=n.tableInsertRowsBelow=n.tableInsertRowsAbove=n.tableInsert=n.removeFloatingObject=n.removeSlicer=n.toggleComment=n.deleteComment=n.editComment=n.unhideRows=n.unhideColumns=n.unhideSheet=n.hideSheet=n.hideColumns=n.hideRows=n.sortDescend=n.sortAscend=n.slicerSortDescend=n.slicerSortAscend=n.headerInsertCutCells=n.headerInsertCopiedCells=n.shiftCellsDown=n.shiftCellsRight=n.insertCutCells=n.insertCopiedCells=n.sort=n.filter=n.insertComment=n.deleteSheet=n.insertSheet=n.deleteColumns=n.deleteRows=n.insertColumns=n.insertRows=n.clearContents=n.pasteFormulaFormatting=n.pasteValuesFormatting=n.pasteFormatting=n.pasteValues=n.pasteFormula=n.pasteAll=n.pasteOptions=n.cut=n.copy=void 0,n.pivotTableExpandEntireField=n.pivotTableCollapse=n.pivotTableExpand=n.pivotTableValueFilters=n.pivotTableLabelFilters_Date=n.pivotTableLabelFilters=n.pivotTableTop10=n.pivotTableHideSelectedItems=n.pivotTableKeepOnlySelectedItems=n.pivotTableClearFilterFrom_=n.pivotTableFieldSettings=n.pivotTableHideFieldList=n.pivotTableSubtotal_=n.pivotTableFilter=n.pivotTableExpandOrCollapse=n.pivotTableUnGroup=n.pivotTableGroup=n.pivotTableShowDetails=n.pivotTableIndex=n.pivotTableRankLargestToSmallest=n.pivotTableRankSmallestToLargest=n.pivotTablePercentRunningTotalIn=n.pivotTableRunningTotalIN=n.pivotTablePercentDifferenceFrom=n.pivotTableDifferenceFrom=n.pivotTableOfParentTotal=n.pivotTableParentColumnTotal=n.pivotTableParentRowTotal=n.pivotTableOf=n.pivotTableRowTotal=n.pivotTableColumnTotal=n.pivotTableGrandTotal=n.pivotTableNoCalculation=n.pivotTableShowValueAs=n.pivotTableMoreOptions=n.pivotTableDistinctCount=n.pivotTableProduct=n.pivotTableMin=n.pivotTableMax=n.pivotTableAverage=n.pivotTableCount=n.pivotTableSum=n.pivotTableSummarizeValuesBy=n.pivotTableSort=n.pivotTableNumberFormat=n.pivotTableOptions=n.pivotTableValueFieldSettings=n.pivotTableRemoveGrandTotal=n.pivotTableRemove_=n.pivotTableMove=void 0,n.paste=n.expandLevel9=n.expandLevel8=n.expandLevel7=n.expandLevel6=n.expandLevel5=n.expandLevel4=n.expandLevel3=n.expandLevel2=n.expandLevel1=n.collapseAllLevels=n.expandAllLevels=n.addBelow=n.addAbove=n.addBefore=n.addAfter=n.moveDown=n.moveUp=n.demote=n.promote=n.pinColumns=n.pinRows=n.pivotTableSortMoreOptions=n.pivotTableSortDescend=n.pivotTableSortAscend=n.sigmaValueTemp=n.sigmaValue=n.pivotTableMove_ToColumns=n.pivotTableMove_ToRight=n.pivotTableMove_ToLeft=n.pivotTableMove_ToEnd=n.pivotTableMove_Down=n.pivotTableMove_Up=n.pivotTableMove_ToBeginning=n.pivotTableExpandTo_=n.pivotTableCollapseTo_=n.pivotTableCollapseEntireField=void 0,n.copy="Copy",n.cut="Cut",n.pasteOptions="Paste Options:",n.pasteAll="All",n.pasteFormula="Formulas",n.pasteValues="Values",n.pasteFormatting="Formatting",n.pasteValuesFormatting="Values&Formatting",n.pasteFormulaFormatting="Formula&Formatting",n.clearContents="Clear Contents",n.insertRows="Insert",n.insertColumns="Insert",n.deleteRows="Delete",n.deleteColumns="Delete",n.insertSheet="Insert",n.deleteSheet="Delete",n.insertComment="Insert Comment",n.filter="Filter",n.sort="Sort",n.insertCopiedCells="Insert Copied Cells...",n.insertCutCells="Insert Cut Cells...",n.shiftCellsRight="Shift Cells Right",n.shiftCellsDown="Shift Cells Down",n.headerInsertCopiedCells="Insert Copied Cells",n.headerInsertCutCells="Insert Cut Cells",n.slicerSortAscend="Sort A to Z",n.slicerSortDescend="Sort Z to A",n.sortAscend="Sort A to Z",n.sortDescend="Sort Z to A",n.hideRows="Hide",n.hideColumns="Hide",n.hideSheet="Hide",n.unhideSheet="Unhide",n.unhideColumns="Unhide",n.unhideRows="Unhide",n.editComment="Edit Comment",n.deleteComment="Delete Comment",n.toggleComment="Show/Hide Comment",n.removeSlicer="Remove",n.removeFloatingObject="Remove",n.tableInsert="Insert",n.tableInsertRowsAbove="Table Rows Above",n.tableInsertRowsBelow="Table Row Below",n.tableInsertColumnsLeft="Table Columns to the Left",n.tableInsertColumnsRight="Table Columns to the Right",n.tableDelete="Delete",n.tableDeleteRows="Table Rows",n.tableDeleteColumns="Table Columns",n.hideSheetFailureInfo="A workbook must contain at least one visible worksheet.\nTo hide, delete or move the selected sheet(s), you must first insert a new sheet or unhide a sheet that is already hidden.",n.pivotTableRefresh="Refresh",n.pivotTableMove="Move",n.pivotTableRemove_="Remove {0}",n.pivotTableRemoveGrandTotal="Remove GrandTotal",n.pivotTableValueFieldSettings="Value Field Settings...",n.pivotTableOptions="PivotTable Options...",n.pivotTableNumberFormat="Number Format...",n.pivotTableSort="Sort",n.pivotTableSummarizeValuesBy="Summarize Values By",n.pivotTableSum="Sum",n.pivotTableCount="Count",n.pivotTableAverage="Average",n.pivotTableMax="Max",n.pivotTableMin="Min",n.pivotTableProduct="Product",n.pivotTableDistinctCount="Distinct Count",n.pivotTableMoreOptions="More Options",n.pivotTableShowValueAs="Show Value As",n.pivotTableNoCalculation="No Calculation",n.pivotTableGrandTotal="% of Grand Total",n.pivotTableColumnTotal="% of Column Total",n.pivotTableRowTotal="% of Row Total",n.pivotTableOf="% Of...",n.pivotTableParentRowTotal="% of Parent Row Total",n.pivotTableParentColumnTotal="% of Parent Column Total",n.pivotTableOfParentTotal="% of Parent Total...",n.pivotTableDifferenceFrom="Difference From...",n.pivotTablePercentDifferenceFrom="% Difference From...",n.pivotTableRunningTotalIN="Running Total In...",n.pivotTablePercentRunningTotalIn="% Running Total In...",n.pivotTableRankSmallestToLargest="Rank Smallest to Largest...",n.pivotTableRankLargestToSmallest="Rank Largest to Smallest...",n.pivotTableIndex="Index",n.pivotTableShowDetails="Show Details",n.pivotTableGroup="Group...",n.pivotTableUnGroup="Ungroup...",n.pivotTableExpandOrCollapse="Expand/Collapse",n.pivotTableFilter="Filter",n.pivotTableSubtotal_="Subtotal {0}",n.pivotTableHideFieldList="Hide Field List",n.pivotTableFieldSettings="Field Settings...",n.pivotTableClearFilterFrom_="Clear Filter From {0}",n.pivotTableKeepOnlySelectedItems="Keep Only Selected Items",n.pivotTableHideSelectedItems="Hide Selected Items",n.pivotTableTop10="Top 10...",n.pivotTableLabelFilters="Label Filters...",n.pivotTableLabelFilters_Date="Date Filters...",n.pivotTableValueFilters="Value Filters...",n.pivotTableExpand="Expand",n.pivotTableCollapse="Collapse",n.pivotTableExpandEntireField="Expand Entire Field",n.pivotTableCollapseEntireField="Collapse Entire Field",n.pivotTableCollapseTo_="Collapse to {0}",n.pivotTableExpandTo_="Expand to {0}",n.pivotTableMove_ToBeginning="Move {0} to Beginning",n.pivotTableMove_Up="Move {0} Up",n.pivotTableMove_Down="Move {0} Down",n.pivotTableMove_ToEnd="Move {0} to end",n.pivotTableMove_ToLeft="Move {0} to left",n.pivotTableMove_ToRight="Move {0} to Right",n.pivotTableMove_ToColumns="Move {0} to columns",n.sigmaValue="\u2211 Values",n.sigmaValueTemp="Values",n.pivotTableSortAscend="Sort Smallest to Largest",n.pivotTableSortDescend="Sort Largest to Smallest",n.pivotTableSortMoreOptions="More Sort Options...",n.pinRows="Pin/Unpin Rows",n.pinColumns="Pin/Unpin Columns",n.promote="Promote",n.demote="Demote",n.moveUp="Move Up",n.moveDown="Move Down",n.addAfter="Add After",n.addBefore="Add Before",n.addAbove="Add Above",n.addBelow="Add Below",n.expandAllLevels="Expand All Levels",n.collapseAllLevels="Collapse All Levels",n.expandLevel1="Expand to Level 1",n.expandLevel2="Expand to Level 2",n.expandLevel3="Expand to Level 3",n.expandLevel4="Expand to Level 4",n.expandLevel5="Expand to Level 5",n.expandLevel6="Expand to Level 6",n.expandLevel7="Expand to Level 7",n.expandLevel8="Expand to Level 8",n.expandLevel9="Expand to Level 9",n.paste="Paste"},"./dist/plugins/contextMenu/menu-view.js":function(B,t,n){"use strict";var i,f,M,l,n,b,h,o,u,y,e,a,L,C,F,P,s,c,d,G,U,H,r,v,m,g,z,V,Y,p,Z,W,Q,J,K,X,q,$,tt,nt,et,it,rt,ot,at,ut,st,ct,n,ft,w,lt,S,T,A,ht,dt,vt,I,x,N,k,D,_,mt,E,gt,pt,bt,yt,wt,Mt,Ct,St,j,Tt,At,n;function It(t){return t instanceof Object}function O(t,n,e){var i=this;i.Ti=t,i.Jq=n,i.Xq(t,n,e)}function R(){}function xt(t,n,e,i,r){var o,a,e;b(n.pivotTableName)&&(n.pivotTableName=t.name()),b(n.pivotTableCellInfo)&&(n.pivotTableCellInfo=t.getPivotInfoImp(e,i,!1,!1,!0)),"gc.spread.sortAscend"!==r&&"gc.spread.sortDescend"!==r||!t.isSortValueField(n.pivotTableCellInfo)||(o="gc.spread.sortAscend"===r?0:1,(e=(a=t.dh).Q.map(function(t){return t.Zc})).sort(function(t,n){var t=t.localeCompare(n);return 1==o?-1*t:t}),n.sortValueInfo={sortedFieldNames:e,sortType:o})}Object.defineProperty(t,"__esModule",{value:!0}),t.MenuView=void 0,i=n("Common"),f=n("Core"),M=f.GC$,l=f.mt.En,n=i.Common.lt,b=n.ht,h=n.Eh,o=n.tv,u=void 0,y=null,e=document,a=window,L=Math.max,C=Math.min,F=Math.floor,s="mouseenter",c="mouseleave",d="click",G="mousewheel",U="DOMMouseScroll",H="gc.command.executed",r=".",m=".gcScrollWrapper",z="container",Y="disable-hover",p="text",Z="icon",X="separator",q="sup-indicator",tt="group-container",nt="title",et="group-header",it="groupitems-container",rt="groupitem",ot="nonexecutable",ut="disable",st="gcUIElement",ct="gcContextMenu",ft=" ui-widget",w=" ui-state-hover",lt=" ui-icon ui-icon-triangle-1-e",S="DIV",T="SPAN",A="keydown.ctx.gcSheet",dt="inline-block",vt="visible",I="hidden",x="block",N=ht="none",k="overflow",D=(v="gc-ui-contextmenu")+(g="-")+(V="hover"),_=v+g+(W="menuitem"),mt=v+g+(Q="nonselective-menuitem"),E=v+g+(J="menuitem-content"),gt=v+g+(at="executable"),pt=v+g+(K="sup-container"),bt=v+g+($="subitems-container"),yt=(n="gc-statusbar-contextmenu")+g+"check",wt=n+g+"check-container",Mt=n+g+"content",Ct=n+g+"status",St=12,(n=j=j||{})[n.up=0]="up",n[n.down=1]="down",O.prototype.Xq=function(t,n,e){var i,r,o,a,i=this,r=i.qq=M(document.createElement("DIV")),o=i.$q=document.createElement("DIV"),a=i.t$=document.createElement("DIV");r[0].className="gc-ui-contextmenu-scroll-wrapper",o.className="gc-ui-contextmenu-scroll-indicator",o.innerText=String.fromCharCode(708),a.className="gc-ui-contextmenu-scroll-indicator",a.innerText=String.fromCharCode(709),t.append(M(o)),t.append(r),r.append(n),r.height(e.height-12),t.append(M(a)),i.n$=r.height()+12,i.e$=i.i$(n),i.NK(j.up),i.aY()},O.prototype.i$=function(t){var n=0;return t[0].childNodes.forEach(function(t){n+=t.offsetHeight}),n},O.prototype.r$=function(){return this.qq},O.prototype.o$=function(t){var n=this;if(b(t))return n.qq.scrollTop();n.qq.scrollTop(t),n.a$(t)},O.prototype.hU=function(t){for(var n,e,i,r,n,e=this.Jq[0].childNodes,i=0,r=0;r<t;r++)i+=e[r].offsetHeight;this.o$(i-12)},O.prototype.aY=function(){var e=this,t=e.$q,n=e.t$,i=e.qq,r=e.n$,o=e.e$;M(t).bind(s+m,function(){e.u$=a.setInterval(function(){var t,n,t=i.scrollTop(),n;e.o$(F(t<=10?0:t-10))},100)}),M(t).bind(c+m,function(){a.clearInterval(e.u$)}),M(t).bind(d+m,function(){e.o$(0)}),M(n).bind(s+m,function(){e.u$=a.setInterval(function(){var t,n,t=i.scrollTop(),n;e.o$(o-r-10<=t?o-r+2:t+10)},100)}),M(n).bind(c+m,function(){a.clearInterval(e.u$)}),M(n).bind(d+m,function(){e.o$(o-r)}),i.bind(G+m,function(t){e.a$(i.scrollTop()+(t.deltaY||-t.wheelDelta||0))}).bind(U+m,function(t){e.a$(i.scrollTop()+(t.deltaY||-t.wheelDelta||0))})},O.prototype.KX=function(){var t=this,n=t.$q,e=t.t$,t=t.qq;M(n).unbind(m),M(e).unbind(m),t.unbind(m)},O.prototype.eG=function(){var t=this;t.KX(),t.Ti.append(t.Jq),M(t.qq).remove(),M(t.$q).remove(),M(t.t$).remove(),t.Ti=u,t.Jq=u,t.qq=u,t.$q=u,t.t$=u},O.prototype.$c=function(t){switch(t){case j.up:this.$q.style.display=x;break;case j.down:this.t$.style.display=x}},O.prototype.NK=function(t){switch(t){case j.up:this.$q.style.display=N;break;case j.down:this.t$.style.display=N}},O.prototype.a$=function(t){var n=this,e=n.n$,i=n.e$;t<1?(n.$c(j.down),n.NK(j.up),n.s$(!0)):i-e-1<t?(n.$c(j.up),n.NK(j.down),n.s$(!1)):(n.$c(j.up),n.$c(j.down),n.s$(!0))},O.prototype.s$=function(t){var n=this,e=n.qq,n=n.n$;t&&(n-=12),e.height(n)},Tt=O,R.prototype.ZX=function(t,n,e,i){var r=this;r.Ti=M(t),r.c$=o(n),r.Qy=e.commandManager(),r.DJ=e,r.zX=i,r.f$=[],r.l$={},r.h$=[],r.d$={},r.JX=y,r.v$()},R.prototype.m$=function(){var t,n,e,i,r,o,a,u,s,c,f,s,c,n,l,s,h,d,v,m,g,d,h,m,v,m,p,d,t=this,n=t.g$,e=t.Ti,i=t.hostInfo;n[0].style.maxHeight="",r=parseInt(e.css("left"),10),o=parseInt(e.css("top"),10),a=e.width(),u=e.height(),(s=t.U2(u))&&(c=t.Wq=t.p$(e,n),u=t.b$()),"number"==typeof t.Kq&&(s?((f=c.r$())[0].style.maxHeight=t.Kq+"px",n.css(k,y)):(n[0].style.maxHeight=t.Kq+"px",n.css(k,I),u=n.height()+2)),c=(s=t.y$()).windowTop,n=s.windowLeft,l=s.windowWidth,s=s.windowHeight,b(i)?(g=(m=t.w$()).contextTop,d=m.contextLeft,h=m.contextWidth,m=m.contextHeight,v=g+o-Math.max(c,g),m=C(c+s,g+m)-(g+o),p=c+s-g+o,d=C(n+l,d+h)-(d+r),h<r+a?e.css("left",r=0<r-a?r-a:r):d<a&&e.css("left",r-a),m<u&&(u<=v?e.css("top",o-u):u<=v+m?e.css("top",o+m-u):p<u?e.css("top",c+s-g-u):e.css("top",c<g?0:c-g))):(i.left+r+a>n+l&&e.css("left",r=0<r-a?r-a:r),d=((h=t.DJ&&t.DJ.getHost())&&h.getBoundingClientRect().top)<i.top,v=i.top,d?u<=v+o?e.css("top",o-u):e.css("top",-v):s-v-o<u&&e.css("top",s-v-u))},R.prototype.y$=function(){return{windowTop:a.scrollY||a.pageYOffset,windowLeft:a.scrollX||a.pageXOffset,windowWidth:a.clientWidth||a.innerWidth,windowHeight:a.clientHeight||a.innerHeight}},R.prototype.w$=function(){var t,n,e,i,r,t,e,t=this;return t.DJ&&(n=(e=(t=M(t.DJ.getHost())).offset()).top,e=e.left,i=t.width(),r=t.height()),{contextTop:n,contextLeft:e,contextWidth:i,contextHeight:r}},R.prototype.p$=function(t,n){return new Tt(t,n,{height:this.b$()})},R.prototype.M$=function(){var t=this,n=t.g$;"number"==typeof t.Kq&&(n[0].style.maxHeight=t.Kq+"px",n.css(k,I))},R.prototype.v$=function(){var t,n,e,n,n,t=this,n=t.c$;b(n)||!It(n)||n.length<1||(n instanceof Array||(n=[n]),n=t.S$(e="menuView",n),t.l$.menuView=n,n=t.A$(t.c$),t.g$=n,t.M$(),n.appendTo(t.Ti),t.m$(),t.aY(),t.h$.push({name:e,menuView:n}))},R.prototype.S$=function(t,n){for(var e,i,r,o,a,e=this,i=n.length,r=0,o=[];r<i;r++)a=n[r],b(a)||"separator"===a.type||(a.subMenu?e.l$[a.name]=e.S$(a.name,a.subMenu):"groupHeader"===a.type&&(e.I$(a,n),e.l$[a.name]=e.S$(t,a.groups)),o.push(e.x$(t,a)));return o},R.prototype.x$=function(t,n){var e,i,r,r,e=this,i="groupHeader"===n.type?e.N$():e.k$(),r=e.createMenuItemElement(n);if(!b(r))return r instanceof HTMLElement&&(r=M(r)),b(n.itemClass)||i.addClass(n.itemClass),b(n.title)||i.attr("title",n.title),r.appendTo(i),r={name:n.name,host:i,menuItemData:n,menuName:t},this.SpreadJSDesignerAutoTest&&this.SpreadJSDesignerAutoTest(r.host,r.menuItemData),e.f$.push(r),r},R.prototype.k$=function(){var t=M(l(S));return t.addClass(_),t},R.prototype.N$=function(){var t=M(l(S));return t.addClass(mt),t},R.prototype.createMenuItemElement=function(t){var n,e,e,n=this,e=t.type,e="groupHeader"===e?n.D$(t):"groupItem"===e?n._$(t):"statusBar"===e?n.E$(t):t.subMenu?n.j$(t):n.O$(t);return e},R.prototype.O$=function(t){var n,e,e,n=M(l(S)).addClass(E);return t.command?t.disable?n.addClass(v+g+ut):n.addClass(gt):n.addClass(v+g+ot),e=M(l(T)).addClass(v+g+Z),t.iconClass&&e.addClass(t.iconClass),e.appendTo(n),t.text&&((e=M(l(T)).addClass(v+g+p))[0].innerHTML=i.Common.zf.j0(t.text),e.appendTo(n)),n},R.prototype.B$=function(t){return M(l(S)).addClass(v+g+X)},R.prototype.D$=function(t){var n,e,i,r,o,a,u,s,c,n=this,e=M(l(S)).addClass(v+g+tt);if(!(t.groups.length<=0)){for((i=n.O$(t)).addClass(v+g+et),i.appendTo(e),r=M(l(S)).addClass(v+g+it),a=(o=t.groups).length,u=0;u<a;u++)(c=(s=n.L$("name",o[u].name)).host).addClass(v+g+rt),c.appendTo(r);r.appendTo(e)}return e},R.prototype._$=function(t){var n,e,i,n,e=this.O$(t),i;return e.find(r+v+g+p).remove(),e.attr(nt,t.text),e},R.prototype.E$=function(t){var n,e,i,r,t,o,a,o,i,n=l("div"),e=M(n).addClass(E),i=t.visible,r=t.menuContent,t=t.status,o=l("div");return M(o).addClass(yt),a=l("div"),M(a).addClass(wt),a.appendChild(o),a.style.visibility=i?vt:I,(o=l("div")).innerText=r,M(o).addClass(Mt),i=l("div"),M(i).addClass(Ct),t?(i.innerText=t,i.style.display=dt):i.style.display=ht,n.appendChild(a),n.appendChild(o),n.appendChild(i),e},R.prototype.j$=function(t){var n,e,i,r,o,a,n=this,e=M(l(S)).addClass(pt),i=n.O$(t);return 0<t.subMenu.length&&((r=M(l(T)).addClass(v+g+q+lt)).appendTo(i),o=n.A$(t.subMenu),a=M(l(S)).addClass(bt),o.appendTo(a),a.appendTo(n.Ti),n.d$[t.name]=a),i.appendTo(e),e},R.prototype.A$=function(t){for(var n,e,i,r,o,a,a,u,n=this,e=M(l(S)).addClass(v+g+z+ft),i=t.length,r=0;r<i;r++)b(t[r])||(o=t[r].name,b(o)?"separator"===t[r].type&&(a=n.N$(),(u=n.B$(t[r])).appendTo(a),a.appendTo(e)):(a=n.L$("name",o),b(a)||a.host.appendTo(e)));return e},R.prototype.L$=function(t,n){for(var e,i,r,o,e,i=this.f$,r=i.length,o=0;o<r;o++)if(n instanceof M?n[0]===i[o][t][0]:i[o][t]===n)return i[o]},R.prototype.I$=function(t,n){var e,i,r;for(t.groups=[],e=n.length,i=0;i<e;i++)(r=n[i])&&r.group&&r.group===t.name&&(r.type="groupItem",t.groups.push(r),n.splice(i,1),i--)},R.prototype.aY=function(){var o=this;M(r+_).bind(s,function(){var t,n,e,i,r,t=M(this),n=o.L$("host",t);for(o.JX=n,i=0,r=(e=o.h$).length;i<r&&n.menuName!==o.h$[r-i-1].name;i++)o.F$();o.P$(),o.G$(!1)}).bind(c,function(){o.JX=y,o.P$()}).bind(d,function(t){var n,n,e,n=M(this),n=o.L$("host",n);o.JX=n,(e=o.U$(!1,t))&&o.lQ()}),M(e).bind(A,function(t){var n,e,e;if(!t.target||M(t.target).attr(st)!==ct){switch(t.keyCode){case 27:(n=o.F$())||o.lQ();break;case 32:case 13:(n=o.U$(!0,t))&&o.lQ();break;case 9:t.shiftKey?o.H$(!1,!0):o.H$(!0,!0);break;case 37:e=o.F$(),(e=o.L$("name",e))&&(o.JX=e),o.JX&&o.JX.menuItemData.group&&o.H$(!1,!0);break;case 38:o.H$(!1,!1);break;case 39:o.JX&&o.JX.menuItemData.group&&o.H$(!0,!0),o.G$(!0);break;case 40:o.H$(!0,!1)}t.preventDefault?t.preventDefault():t.returnValue=!1}})},R.prototype.z$=function(t,n){var e,i,r,o,a,i,u,s,c,f,u,l,h,d,n,h,v,m,g,p,m,b,d,c,f,y,o,w,e=this,i=e.w$(),r=i.contextTop,o=i.contextLeft,a=i.contextWidth,i=i.contextHeight,u=e.y$(),s=u.windowTop,c=u.windowLeft,f=u.windowWidth,u=u.windowHeight,l=n.parentRelatedLeft,h=n.parentRelatedTop,d=n.parentAbsoluteLeft,n=n.parentWidth;return t.css("top",h+2),h=t.width(),v=t.height(),m=t.position(),p=(g=t.offset()).top,m=m.top,d+n+h>C(c+f,o+a)?t.css("left",l-h-1):t.css("left",l+n),d=e.V$(),(c=e.U2(v))&&(f=M(t[0].firstChild),b=e.p$(t,f),v=e.b$()),"number"==typeof e.Kq&&(c?(y=b.r$())[0].style.maxHeight=e.Kq+"px":(t[0].style.maxHeight=e.Kq+"px",t.css(k,I),v=t.height())),(w=(o=C(s+u,r+i))-p)<v&&(d<v?t.css("top",s<r?0:s-r):t.css("top",m+o-p-v)),b},R.prototype.Y$=function(t){return t.command},R.prototype.getCommandOptions=function(t,n,e){},R.prototype.U$=function(t,n){var e,i,i,e=this,i=e.JX;if(i&&!i.menuItemData.disable){if(!(i=i.menuItemData).subMenu)return e.zA(n),!0;0<i.subMenu.length&&e.G$(t)}},R.prototype.zA=function(t){var n,e,i,t,r,n,o,a,u,s,c,t,n=this,e=n.JX,i=n.Y$(e.menuItemData);b(i)||(t=n.getCommandOptions(e.menuItemData,e.host[0],t),r=n.Qy,h(i)?i(n.DJ,t):(o=(n=(0,f.jf)(n.DJ))&&n.getActiveColumnIndex(),a=n&&n.getActiveRowIndex(),u=n&&n.tables&&n.tables.find(a,o),s=n&&n.pivotTables&&n.pivotTables.findPivotTable(a,o),c=e.menuItemData.name,b(s)?r.execute({cmd:i,sheetName:n&&n.name(),selections:n&&n.getSelections(),activeRow:a,activeCol:o,commandOptions:t,tableName:u?u.name():"",itemName:c}):(t=e.menuItemData.commandOptions,xt(s,t=b(t)?{}:t,a,o,c),r.execute({cmd:i,sheetName:n.name(),selections:n.getSelections(),activeRow:a,activeCol:o,commandOptions:t,itemName:c}))))},R.prototype.KX=function(){M(r+_).unbind(s).unbind(c).unbind(d),M(e).unbind(A)},R.prototype.L0=function(){var t=this;t.Ti=y,t.c$=y,t.Qy=y,t.DJ=y,t.zX=y,t.f$=y,t.l$=y,t.JX=y,t.g$=y,t.d$=y,t.Wq&&(t.Wq.eG(),t.Wq=u),t.KX()},R.prototype.F$=function(){var t,t,n,e,t=this;if(1<t.h$.length)return(e=(n=(t=t.h$.pop()).menuView).find(r+_)).removeClass(D+w),t.menuView.hide(),t.subMenuWrapper&&(t.subMenuWrapper.eG(),t.subMenuWrapper=u),t.name},R.prototype.P$=function(){var t,n,e,i,r,t=this,n=t.Z$(!0);if(n){for(e=0,i=n.length;e<i;e++)n[e].host.removeClass(D+w);t.JX&&((r=t.JX.menuItemData).disable?t.JX.host.addClass(v+g+Y+w):t.JX.host.addClass(D+w))}},R.prototype.lQ=function(){var t=this;t.zX.trigger(H),t.L0()},R.prototype.H$=function(t,n){var e,n,i,r,r,r,t,r,o,e,n,a,e=this,n=e.Z$(n);e.JX&&!(i=e.W$(e.JX,n))&&(r=e.l$[e.JX.menuItemData.group])&&(r=r[0],i=e.W$(r,n)),i=t?"number"==typeof(i=i!==u&&i!==n.length-1?i:-1)?i+1:0:"number"==typeof(i=i!==u&&0!==i?i:n.length)?i-1:0,e.JX=n[i],e.P$(),r=e.h$[e.h$.length-1],t=n.length,(r=r&&("menuView"===r.name?e.Wq:r.subMenuWrapper))&&(n=(e=(o=r.o$())+e.JX.host.position().top)+n[i].host.height()+2,a=r.r$().height(),e<o+12?0===i?r.o$(0):r.o$(e-12):o+a<n&&(i===t-1?r.o$(r.r$().height()):r.o$(e-12),r.o$(n-a)))},R.prototype.Z$=function(t){for(var n,e,i,r,o,a,u,s,c,n=this,e=n.h$[n.h$.length-1].name,i=n.l$[e],r=0,o=i.length,a=[];r<o;r++)if("groupHeader"===i[r].menuItemData.type)if(u=n.l$[i[r].menuItemData.name],t)for(s=0,c=u.length;s<c;s++)a.push(u[s]);else a.push(u[0]);else a.push(i[r]);return a},R.prototype.W$=function(t,n){for(var e,i,e=n.length,i=0;i<e;i++)if(t.name===n[i].name)return i},R.prototype.G$=function(t){var n,e,i,r,o,e,a,u,s,s,n=this,e=n.JX;e&&(i=e.menuItemData).subMenu&&0<i.subMenu.length&&(i.name!==n.h$[n.h$.length-1].name&&((r=n.d$[i.name]).show(),o=e.host,e=n.d$[e.menuName],a=o.offset(),u=o.position(),s=e&&e.position(),s=n.z$(r,{parentRelatedLeft:(s||u).left,parentRelatedTop:s?u.top+s.top:u.top,parentAbsoluteLeft:a.left,parentWidth:e?e.width():o.width()+3}),n.h$.push({name:i.name,menuView:r,subMenuWrapper:s})),n.JX=y,t)&&n.H$(!0,!1)},R.prototype.b$=function(){var t=this,n=t.V$();return n="number"==typeof t.Kq&&!1!==t.Qq?C(n,t.Kq):n},R.prototype.V$=function(){var t,n,e,i,e,t,r,t,t=this,n=t.hostInfo,e=t.w$(),i=e.contextTop,e=e.contextHeight,t=t.y$(),r=t.windowTop,t=t.windowHeight;return n?t:C(r+t,i+e)-L(r,i)},R.prototype.U2=function(t){var n,e,n=this;return!1!==n.Qq&&((e=n.b$())<t||void 0)},R.prototype.scrollable=function(t){var n=this;if(b(t))return n.Qq;n.Qq=t},R.prototype.maxHeight=function(t){var n=this;if(b(t))return n.Kq;(n.Kq=t)<0&&(n.Kq=void 0)},R.prototype.getHost=function(){return this.Ti},t.MenuView=R},"./dist/plugins/data/binding.js":function(t,n,e){"use strict";var i,r,u,r,e,s,c,h,d,f,o,v,m,o,l,a,g,p;function b(t){this.rT=t}function y(t){this.Hc(t)}function w(t){var n=t&&t.H3;n&&n.Q$()&&i.Worksheet.et(t,"resetBinding",{sheet:t})}function M(t,n){var e=t&&t.H3;return!(!e||!e.Q$(n)||(t.clearPendingChanges(),i.Worksheet.et(t,"initBinding",{sheet:t,data:n}),0))}function C(t,n,e){var i,r,o,a,u,s,c,f,f,f,i,t,u,i=t,r=i._dataSource,o={value:h,hasBinding:!1};if(r)if(a=i.Mf,(u=i.K$)===m){if(f=a?a.getBindingPath(n,e):h)return{value:r.getValue(f),hasBinding:!0}}else{if(n<0||t.getRowCount()<=n)return o;if(f=(a||t).getColumnCount(),e<0||f<=e)return o;if(a?(i.J$||(i.J$=a.Ut.EE(!1,3)),(s=i.J$[e])&&(c=s.name)):t.Pq&&(i.J$?(s=i.J$[e])&&(c=s.dataField):c=t.Pq[e]),u)return f=v[u],t=x(i=s&&s.value)?i:h,u=a&&a.onItemGotten?a.onItemGotten.bind(a):d,f.getValue(r,t,c,n,e,u)}return o}function S(t,n,e,i){var r,o,a,u,s,c,f,l,l,l,u,r,r=t,o=r._dataSource,a=!1;if(o)if(u=r.Mf,(s=r.K$)===m)(l=u?u.getBindingPath(n,e):h)&&(o.setValue(l,i),a=!0);else{if(n<0||t.getRowCount()<=n)return a;if(l=(u||t).getColumnCount(),e<0||l<=e)return a;u?(r.J$||(r.J$=u.Ut.EE(!1,3)),(c=r.J$[e])&&(f=c.name)):t.Pq&&(r.J$?(c=r.J$[e])&&(f=c.dataField):f=t.Pq[e]),s&&(l=v[s],r=x(u=c&&c.value)?u:h,a=l.setValue(o,r,f,n,e,i,d))}return a}function T(e){var i=h;return e&&(I(e)?i=m:u.each(v,function(t,n){if(n.isDataSource(e))return i=t,!1})),i}function A(t,n){return t&&n&&n!==m?v[n].getProperties(t):h}function I(t){return a&&t instanceof a}function x(t){return"function"==typeof t}function N(t,n,e){var i,r,o,a,u;if(t&&n)if(i=t[n],c(i))for(o=(r=n.split(".")).length,a=0;a<o&&(u=r[a],t);a++)a===o-1?x(t[u])?t[u](e):t[u]=e:t=x(t[u])?(c(t[u]())&&t[u]({}),t[u]()):(c(t[u])&&(t[u]={}),t[u]);else x(i)?t[n](e):t[n]=e}function k(t,n,e){var i,r,o,a,u;if(!t||!n)return h;if(i=t[n],!c(i))return x(i)?i():i;r=null,e?(r=e[n])||(r=n.split("."),e[n]=r):r=n.split("."),o=r.length,a=0;do{if(t=x(t[u=r[a]])?t[u]():t[u],c(t))return h}while(++a<o);return t}function D(){this.pathCache={}}Object.defineProperty(n,"__esModule",{value:!0}),n.X$=n.q$=n.setValueByPath=n.$$=n.CellBindingSource=void 0,i=e("Core"),r=e("Core"),u=r.GC$,r=e("Common"),e=e("./dist/plugins/data/data.ns.js"),s=u.isNumeric,c=r.Common.lt.ht,h=null,d=void 0,f="string",n.X$=o,v=n.X$=o={},m="cellBinding",o=new r.Common.ResourceManager(e.SR,"Bindings"),l=o.getResource.bind(o),i.Workbook.ch("binding",{onCultureChanged:function(){l()}}),b.prototype.setValue=function(t,n){N(this.rT,t,n)},b.prototype.getValue=function(t){return k(this.rT,t)},b.prototype.getSource=function(){return this.rT},a=b,n.CellBindingSource=a,y.prototype.bind=function(r,t){var n,e,i,t,i,o,a,n=this,e=n.Mf,i=n._dataSource;if(t&&n.ttt(t,{type:"bind",oldDataSource:i}),i&&(i.ntt&&(i.subscribe=i.ntt,delete i.ett,delete i.ntt),x(i.dispose))&&i.dispose(),n.itt(n.rtt),n.itt(n.ott),n.Hc(e),n._dataSource=r){if(!(t=n.K$=T(r)))throw new Error(l().Exp_NotSupportedDataSource);n.att=n.utt(),e&&u[u.sd]({jS:e.parent}),e&&(i=n.rtt,o=r.currentPosition,r.subscribe&&i.push(r.subscribe(n.stt,n)),o&&o.subscribe&&i.push(o.subscribe(n.ctt,n)),x(r.subscribe)&&!r.ntt&&(a=r.ntt=r.subscribe,r.ett=!1,r.subscribe=function(t,n){var e,i,e=[].concat.apply([],arguments),i;return e[0]=function(){if(!r.ett&&x(t))return t.apply(n,arguments)},a.apply(r,e)}),n.RA()),n.Pq=A(r,t)}return M(e,r)},y.prototype.RA=function(){var t,n,e,i,r,i,o,a,t=this,n=t.Mf,e=t._dataSource;if(n&&e&&(i=t.K$,t.itt(t.ott),r=h,i!==m&&(i=n.getActiveRowIndex(),r=e.currentPosition?(-1<=i&&i<e.count()&&e.currentPosition(i),e.currentItem()):t.ftt(i)),r))for(a in o=function(){n&&n.repaint()},r)r[a]&&x(r[a].subscribe)&&t.ott.push(r[a].subscribe(o,h,h))},y.prototype.itt=function(t){var n,e;if(t)for(n=0;n<t.length;n++)(e=t[n])&&x(e.dispose)&&e.dispose()},y.prototype.getRowCount=function(){var t,n,t,e,t=this,n=t._dataSource,t=t.K$,e=0;return e=n&&t&&t!==m?v[t].getDataLength(n):e},y.prototype.getColumnCount=function(){var t,t,t,t,t=this.Pq;return t?t.length:(t=this._dataSource)&&(t=t[0],"null"===(t=u.getType(t))||t===f||"number"===t)?1:0},y.prototype.getSource=function(){return this._dataSource},y.prototype.ltt=function(){return this.Pq},y.prototype.htt=function(t){this.Pq=t},y.prototype.ftt=function(t){var n=this._dataSource,e=this.K$,i=h;return i=n&&e&&e!==m?v[e].getDataItem(n,t):i},y.prototype.utt=function(){var t,n,e,i,t=this;if(!t.att)for(n=t.getRowCount(),e=0;e<n;e++)if(i=t.ftt(e)){t.att=i.entityAspect&&i.entityType||i.constructor;break}return t.att},y.prototype.getValue=function(t,n){return C(this,t,n)},y.prototype.setValue=function(t,n,e,i){var r,o,r=this;return i&&(o=C(r,t,n).value,r.ttt(i,{type:"setValue",row:t,col:n,oldValue:o})),S(r,t,n,e)},y.prototype.dtt=function(){var t=v[this.K$];return t&&t.canAdd&&t.canAdd()},y.prototype.vtt=function(){var t=v[this.K$];return t&&t.canInsert&&t.canInsert()},y.prototype.mtt=function(){var t=v[this.K$];return t&&t.canRemove&&t.canRemove()},y.prototype.allowSetCount=function(){var t,t,t=this.K$;return t===m||(t=v[t])&&t.allowSetCount&&t.allowSetCount()},y.prototype.kE=function(t,n,e){var i,r,o,a,i=this,r=i._dataSource;!r||t>i.getRowCount()||(o=i.K$,a=i.utt(),o&&o!==m&&!i.gtt&&(i.ptt=!0,e&&i.ttt(e,{type:"addItems",row:t,rowCount:n}),v[o].addItems(r,t,n,a,d),i.ptt=!1))},y.prototype.btt=function(t,n,e){var i,r,o,a,o,o,r,i=this,r=i.K$,o=i.getRowCount(),a=i._dataSource;!a||o<=t||r&&r!==m&&!i.gtt&&(i.ptt=!0,o=(o=i.Mf)&&o.onItemRemoved?o.onItemRemoved.bind(o):d,r=v[r].removeItems(a,t,n,o),e&&r&&0<r.length&&i.ttt(e,{type:"removeItems",row:t,removedItems:r}),i.ptt=!1)},y.prototype.ytt=function(t,n){var e,i,e,e=this,i=e._dataSource,e=e.K$;v[e].undoRemoveItems(i,t,n)},y.prototype.Q$=function(t){return I(t||this._dataSource)},y.prototype.Hc=function(t){var n=this;n._dataSource=h,n.K$="",n.att=h,n.Pq=h,n.rtt=[],n.ott=[],n.J$=h,w(n.Mf=t)},y.prototype.stt=function(t){var n,e,i,r,o,a,n=this,e=n.Mf;if(e&&!n.ptt){if(t){if(n.gtt=!0,!isNaN(t.length)&&(e.setRowCountCore(t.length),i=e.Ut,c(n.Pq))&&0===i._E(!1,3)&&(n.Pq=A(n._dataSource),e.setColumnCount(n.getColumnCount()),r=n.ltt()))for(o=0,a=r.length;o<a;o++)i.do("setItem",!1,3,o,{name:r[o]});n.gtt=!1}e.zw()}},y.prototype.ctt=function(){var t,n,t,t,t=this,n=t.Mf,t=t._dataSource;n&&t&&t.currentPosition&&(t=t.currentPosition(),n.ui!==t)&&(n.t4(t,n.ci,d,d,2),n.zw())},y.prototype.ttt=function(t,n){var e,e;this.Mf&&this.Mf.Ut&&!c(this.Mf.Ut.P8)&&this.Mf.Ut.P8<=0||(e=(e=t.bindingChanges)||(t.bindingChanges=[]),n.bindingManager=this,e.push(n))},y.prototype.wtt=function(t){var n,e,i,n=this,e=t.type,i=t.row;"bind"===e?n.bind(t.dataSource):"setValue"===e?n.setValue(i,t.col,t.value):"addItems"===e?n.kE(i,t.rowCount):"removeItems"===e&&n.btt(i,t.rowCount)},y.prototype.Mtt=function(t){var n,e,i,n=this,e=t.type,i=t.row;"bind"===e?n.bind(t.oldDataSource):"setValue"===e?n.setValue(i,t.col,t.oldValue):"addItems"===e?n.btt(i,t.rowCount):"removeItems"===e&&n.ytt(i,t.removedItems)},y.prototype.toJSON=function(){var t,n,t=this._dataSource;return t?{type:n=this.K$,source:t=n===m?t.getSource():v[n].toJSON(t)}:h},y.prototype.fromJSON=function(t){var n,t,e,n=t&&t.source;n&&(e=void 0,e=(t=t.type)===m?new a(n):v[t].fromJSON(n))&&this.bind(e)},n.$$=y,n.setValueByPath=N,n.q$=k,D.prototype.isDataSource=function(t){return u.isArray(t)},D.prototype.getDataLength=function(t){return t.length},D.prototype.getDataItem=function(t,n){return t[n]},D.prototype.addItems=function(t,n,e,i){for(var r,o,r=0;r<e;r++)o={},i&&(o=i.createEntity?i.createEntity():new i),t.splice(n,0,o)},D.prototype.removeItems=function(t,n,e){var i=this.getDataLength(t);if(n<i)return t.splice(n,Math.min(e,i-n))},D.prototype.undoRemoveItems=function(t,n,e){for(var i=0,r=e.length;i<r;i++)t.splice(n+i,0,e[i])},D.prototype.getProperties=function(t){var n,e,i,r,n=t.length,e=h;if(0<n)for(r in e=[],i=t[0])x(i[r])||e.push(r);return e},D.prototype.getValue=function(t,n,e,i,r){var o=h,a=!1,t=this.getDataItem(t,i);return c(t)||(n?u.isEmptyObject(t)||(o=n(t),a=!0):e?(o=k(t,e,this.pathCache),a=!0):typeof t!=f&&!s(t)||0!==r||(o=t,a=!0)),{value:o,hasBinding:a}},D.prototype.setValue=function(t,n,e,i,r,o){var a=!1,u=this.getDataItem(t,i);return c(u)||(n?(u[e]=o,n(u,o),a=!0):e?(N(u,e,o),a=!0):typeof u!=f&&!s(u)||0!==r||(t[i]=o,a=!0)),a},D.prototype.fromJSON=function(t){return t},D.prototype.toJSON=function(t){return t},v.defaultBindingSource=new D},"./dist/plugins/data/data.dataview.js":function(t,n,e){"use strict";var i,r,u,s,o;function a(){}Object.defineProperty(n,"__esModule",{value:!0}),n.X$=void 0,i=e("Common"),r=e("./dist/plugins/data/binding.js"),Object.defineProperty(n,"X$",{enumerable:!0,get:function(){return r.X$}}),u=i.Common.lt.ht,s=null,a.prototype.isDataSource=function(t){var n=window.wijmo;return n&&n.data&&n.data.isDataView&&n.data.isDataView(t)},a.prototype.getDataLength=function(t){return t.count()},a.prototype.getDataItem=function(t,n){return t.item(n)},a.prototype.addItems=function(t,n,e,i){if(i)for(var r=0;r<e;r++)t.ett=!0,t.add(i.createEntity?i.createEntity():new i),t.ett=!1,t.commitEdit()},a.prototype.removeItems=function(t,n,e){var i,r,o,a,u,i=this.getDataLength(t);if(n<i){for(r=[],o=Math.min(e,i-n),a=0;a<o;a++)u=t.item(n),t.remove(u),r.push(u);return r}},a.prototype.undoRemoveItems=function(t,n,e){for(var i,r,o,i=t.getSource(),r=0,o=e.length;r<o;r++)i.splice(n+r,0,e[r]);t.refresh()},a.prototype.getProperties=function(t){var n,e,i,r,n=0,e=s,i=t.getProperties();if(i&&0<i.length)for(n=i.length,e=[],r=0;r<n;r++)e.push(i[r].name);return e},a.prototype.canInsert=function(){return!1},a.prototype.getValue=function(t,n,e,i,r){var o=s,a=!1,i=this.getDataItem(t,i);return u(i)||(n?(o=n(i),a=!0):e&&(o=t.getProperty(i,e),a=!0)),{value:o,hasBinding:a}},a.prototype.setValue=function(t,n,e,i,r,o){var a=!1,i=this.getDataItem(t,i);return u(i)||(n?(n(i,o),a=!0):e&&(t.setProperty(i,e,o),a=!0)),a},a.prototype.fromJSON=function(t){return t},a.prototype.toJSON=function(t){return t.local},r.X$.dataViewBinding=new a},"./dist/plugins/data/data.entry.js":function(t,n,e){"use strict";var i,r,o,i=this&&this.__createBinding||(Object.create?function(t,n,e,i){void 0===i&&(i=e);var r=Object.getOwnPropertyDescriptor(n,e);r&&("get"in r?n.__esModule:!r.writable&&!r.configurable)||(r={enumerable:!0,get:function(){return n[e]}}),Object.defineProperty(t,i,r)}:function(t,n,e,i){t[i=void 0===i?e:i]=n[e]}),r=this&&this.__exportStar||function(t,n){for(var e in t)"default"===e||Object.prototype.hasOwnProperty.call(n,e)||i(n,t,e)};Object.defineProperty(n,"__esModule",{value:!0}),n.q$=n.setValueByPath=n.$$=n.CellBindingSource=void 0,e("./dist/plugins/data/worksheet-databind.js"),o=e("./dist/plugins/data/binding.js"),Object.defineProperty(n,"CellBindingSource",{enumerable:!0,get:function(){return o.CellBindingSource}}),Object.defineProperty(n,"$$",{enumerable:!0,get:function(){return o.$$}}),Object.defineProperty(n,"setValueByPath",{enumerable:!0,get:function(){return o.setValueByPath}}),Object.defineProperty(n,"q$",{enumerable:!0,get:function(){return o.q$}}),r(e("./dist/plugins/data/data.ko.js"),n),r(e("./dist/plugins/data/data.dataview.js"),n),r(e("./dist/plugins/data/data.ns.js"),n)},"./dist/plugins/data/data.ko.js":function(t,n,e){"use strict";var m,i,s,c,g,o,f,l,u,p,a,r,e;function h(){}Object.defineProperty(n,"__esModule",{value:!0}),n.X$=void 0,m=e("Core"),i=e("Common"),s=e("./dist/plugins/data/binding.js"),Object.defineProperty(n,"X$",{enumerable:!0,get:function(){return s.X$}}),c=i.Common.lt.ht,g=m.GC$,o=g.isFunction,f=g.getType,l=g.isNumeric,u=null,p="string",a=window.ko,h.prototype.isDataSource=function(t){return a&&a.isObservable(t)},h.prototype.getDataLength=function(t){return t().length},h.prototype.getDataItem=function(t,n){return t()[n]},h.prototype.addItems=function(t,n,e,i){for(var r,o,r=0;r<e;r++)o={},i&&(o=i.createEntity?i.createEntity():new i),t.splice(n,0,o)},h.prototype.removeItems=function(t,n,e){var i=this.getDataLength(t);if(n<i)return t.splice(n,Math.min(e,i-n))},h.prototype.undoRemoveItems=function(t,n,e){for(var i=0,r=e.length;i<r;i++)t.splice(n+i,0,e[i])},h.prototype.getProperties=function(t){var t,n,e,i,r,t=t(),n,e=[];if(0<t.length)for(r in i=t[0])(!o(i[r])||a&&a.isObservable(i[r]))&&e.push(r);return e},h.prototype.getValue=function(t,n,e,i,r){var o=u,a=!1,t=this.getDataItem(t,i);return c(t)||(n?(o=n(t),a=!0):e?(o=(0,s.q$)(t,e),a=!0):f(t)!==p&&!l(t)||0!==r||(o=t,a=!0)),{value:o,hasBinding:a}},h.prototype.setValue=function(t,n,e,i,r,o){var a=!1,u=this.getDataItem(t,i);return c(u)||(n?(n(u,o),a=!0):e?((0,s.setValueByPath)(u,e,o),a=!0):f(u)!==p&&!l(u)||0!==r||(t()[i]=o,a=!0)),a},h.prototype.fromJSON=function(t){return a?a.observableArray(t):u},h.prototype.toJSON=function(t){return t()},s.X$.koBinding=new h,a&&((e=a.bindingHandlers)["gc-spread-sheets"]=e["gcspread-sheets"]=e.wijspread={init:function(t,n,e,i){var n,r,o,a,u,s,c,f,l,h,d,v;if(!g(t).data("workbook")&&(r=(n=n())&&n.sheets,o=new m.Workbook(g("#"+t.id)[0],n),r)){for(u=a=void 0,s=r.length,c=o.getSheetCount();c<s;)a=o.S2(o.T2(c)),o.A2(c,0,a),c=o.getSheetCount();for(f=0;f<s;f++)a=o.getSheet(f),l=(u=r[f]).name,h=u.autoGenerateColumns,d=u.data,v=u.columns,typeof l==p&&0<l.length&&a.ub(l),"boolean"==typeof h&&(a.autoGenerateColumns=h),d&&a.setDataSource(d),v&&0<v.length&&(a.autoGenerateColumns=!1,a.bindColumns(v))}},update:function(t,n,e,i){}})},"./dist/plugins/data/data.ns.js":function(t,n,e){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.SR=void 0;var e=e("./dist/plugins/data/data.res.en.js");n.SR={en:e}},"./dist/plugins/data/data.res.en.js":function(t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.Exp_NotSupportedDataSource=void 0,n.Exp_NotSupportedDataSource="The data source is not supported!"},"./dist/plugins/data/worksheet-databind.js":function(t,n,e){"use strict";var r,n,s,h,c,e,i,d,o,a,v,u;function f(t,n,e){t.Ut.do("setItem",!1,3,n,e="string"==typeof e?{name:e}:e);var i=e&&e.formatter,r=e&&e.cellType;i&&t.setFormatter&&t.setFormatter(-1,n,i),r&&t.setCellType(-1,n,r),e&&!h(e.width)&&t.setColumnWidth(n,e.width)}function l(t,n,e,i,r,o){for(var a,u,s,c,f,l,f,a=t.H3,u="dataManagerBindingSource"===a.K$,s=0;s<e;s++)for(c=0;c<i;c++)l=(f=a.getValue(s,c)).value,f&&f.hasBinding&&(v.W0(f=l)&&(f=v.Q0(l)),o?t.c8(n,s,c,f,r):t.s8(n,s,c,f,u))}function m(t,n,e,i){var t=t.getSpan(n,e,i);return!(!t||t.row===n&&t.col===e)}function g(t,n,e,i){for(var r,o,a,u,s,u,r=t.options.colHeaderAutoTextIndex,o=0;o<e;o++)if(0<=r&&o===r||-1===r&&o===e-1)for(a=0;a<i;a++)u=n[o]&&n[o][a]&&n[o][a].value,s=t.Ut.q_(!1,3,a),h(u)&&s&&!m(t,o,a,1)&&(u=s.displayName||s.name)&&t.s8(n,o,a,u)}function p(t,n){var t,e;return"Object"===n.constructor.name&&(t=t.findByName(n.tableName))&&(t.H3?n=t.H3:((e=new s.$$).fromJSON(n),t.H3=n=e)),n}Object.defineProperty(n,"__esModule",{value:!0}),r=e("Core"),n=e("Common"),s=e("./dist/plugins/data/binding.js"),h=n.Common.lt.ht,c=r.GC$.isEmptyObject,e=r.GC$.extend,i=r.Worksheet.prototype,d=null,o="bindingPath",a=new RegExp("^\\d*(\\.\\d+)?\\*$"),v=n.Common.ct,e(i,u={getDataSource:function(){var t=this.H3;return t?t.getSource():d},setDataSource:function(t,n){var e,i,r,o,a,u,n,t,e=this,i=e.H3;if(i&&(i.getSource()!==t||e.NMi)){if(e.suspendPaint(),n&&e.sF(),t){if((i=e.H3).Ctt=!0,!(r=i.bind(t,e.Ut.G8))&&(e.setRowCountCore(i.getRowCount()),e.autoGenerateColumns)&&(e.setColumnCount(i.getColumnCount()),o=i.ltt()))for(a=0,u=o.length;a<u;a++)e.Ut.do("setItem",!1,3,a,{name:o[a]})}else e.H3=new s.$$(e);e.clearPendingChanges(),n=!1,i&&i.Ctt&&(n=i.Stt,delete i.Stt,delete i.Ctt),e.recalcAll&&e.recalcAll(n),(t=e.ST())&&t.DS===e&&t.c5(),e.resumePaint()}},bindColumn:function(t,n){var e=this;e.suspendPaint();try{f(e,t,n)}finally{e.resumePaint()}},bindColumns:function(t){var n,e,i,r,o,n=this;n.suspendPaint();try{if(t)for(e=t.length,isNaN(e)||n.setColumnCount(e),i=0;i<e;i++)o=(r=t[i]).size,a.test(o)&&(r.starSize=o),f(n,i,r)}finally{n.resumePaint()}},getDataItem:function(t){var n,e,i,r,o,a,u,s,n=this,e=n.H3;if(!e||0===e.getRowCount())return d;if(i=n.getColumnCount(),r={},o=e.ftt(t))for(a in o)o.hasOwnProperty(a)&&"function"!=typeof a&&(r[a]=o[a]);for(u=0;u<i;u++)(s=n.Ut.q_(!1,3,u))&&s.name&&0<s.name.length&&h(r[s.name])&&(r[s.name]=n.getValue(t,u));return r},getDataColumnName:function(t){var n,n,n=this;return 0<=t&&t<n.getColumnCount()&&n.getDataSource()?(n=n.Ut.q_(!1,3,t))&&(n.displayName||n.name):d},getBindingPath:function(t,n){return this.Ut.getValueForKey(t,n,o)},setBindingPath:function(t,n,e){var i=this;return i.Ut.do("setValueForKey",t,n,o,e),i.ki(r.Events.WorksheetDataChanged,{type:"bindingPath"}),i.zw(),i}}),r.CellRange.prototype.bindingPath=r.CellRange.p0(i.getBindingPath,i.setBindingPath),r.Worksheet.ch("binding",{init:function(){var t=this;t.autoGenerateColumns=!0,t.H3=new s.$$(t)},dispose:function(t){var n;!1!==t.clearCache&&(this.H3=d)},onLayoutChanged:function(t){var n,e,i,r,o,a,u,s,c,f,l,n=this,e=t.changeType,i=t.row,r=t.rowCount,o=t.sheetArea;if(h(o)||3===o||2===o)if(a=n.H3,"addingRows"===e)a&&!1===a.dtt()?t.canAdd=!1:a&&!1===a.vtt()&&(t.newRow=n.getRowCount());else if("addRows"===e)a&&a.kE(i,r,n.Ut.G8);else if("deletingRows"===e){if(a)if(!1===a.mtt())t.canDelete=!1;else for(n.aj||(n.aj=[]),u=n.aj,s=n.Ut,c=a.getRowCount(),f=0;f<r&&i+f<s.getRowCount();f++)l=d,i+f<c&&(l=a.ftt(i+f)),u.push({row:i+f,data:l})}else"deleteRows"===e?a&&a.btt(i,r,n.Ut.G8):"settingRowCount"!==e||!a.getSource()||a.allowSetCount()||3!==o&&2!==o||(t.canSet=!1)},toJson:function(t,n){var e,i,r,n,r,o,e=this,i=e.getColumnCount(),r=e.getDataSource();n&&n.includeBindingSource&&r&&(l(e,n=t.data.dataTable||{},e.getRowCount(),i),c(n)||(t.data.dataTable=n),g(e,r=t.colHeaderData.dataTable||{},e.getRowCount(1),i),c(r)||(t.colHeaderData.dataTable=r)),!0!==(o=e.autoGenerateColumns)&&(t.autoGenerateColumns=e.autoGenerateColumns)},fromJson:function(t,n){var e,i,r,o,r,e=this;e.H3=new s.$$(e),n&&(i=e.H3,r=t.dataSource,o=t.dataBinding,r&&i.bind(r),o)&&i.fromJSON(o,n),r=t.autoGenerateColumns,h(r)||(e.autoGenerateColumns=r)},preFromJson:function(){this.H3=new s.$$(this)},wh:function(t,n,e){var i,r,o,a,e,u,i=this,r=i.getColumnCount(),o=i.getDataSource(),a=t.lossless;a=a||(t.lossless={}),e&&e.includeBindingSource&&o&&(l(i,t,i.getRowCount(),r,n.sharedStrings,!0),g(i,e=a.colHeaderData.dataTable||{},i.getRowCount(1),r),c(e)||(a.colHeaderData.dataTable=e)),!0!==(u=i.autoGenerateColumns)&&(a.autoGenerateColumns=i.autoGenerateColumns)},yh:function(t){var n,t,n=this;n.H3=new s.$$(n),t=t.lossless&&t.lossless.autoGenerateColumns,h(t)||(n.autoGenerateColumns=t)}}),r.Y8.ch("binding",{priority:6e3,getValue:function(t){var n,e,i,r,i,n=t.row,e=t.col,i=t.sheetArea,r=this.Mf.H3;3===i&&r&&r._dataSource&&(i=r.getValue(n,e),t.isValueGet=i.hasBinding,t.value=i.value)},setValue:function(t){var n,e,i,r,o,a,u,u,s,n=t.row,e=t.col,i=t.value,r=t.sheetArea,o=this.Mf,a=o.H3;3===r&&a&&a._dataSource&&(u=a.getValue(n,e)).hasBinding&&(i!==(u=u.value)?(o.isDirtySuspended()||(s=o.getDataItem(n),this.dE(n,e,{gE:s,d6:u},r)),t.isValueSet=a.setValue(n,e,i,o.Ut.G8)):t.isValueSet="dataManagerBindingSource"!==a.K$)},applyChanges:function(t){var n,t,e,i,r,o,n=t.changes,t=t.isUndo,e=n&&n._bindingChanges;if(e)if(t)for(i=e.length-1;0<=i;i--)(r=e[i]).bindingManager&&(o=p(this.Mf.tables,r.bindingManager)).Mtt(r);else for(i=0;i<e.length;i++)r=e[i],(o=p(this.Mf.tables,r.bindingManager)).wtt&&o.wtt(r)},undoValue:function(t){var n,e,i,n=t.bindingChanges;if(n)for(e=n.length-1;0<=e;e--)(i=n[e]).bindingManager.Mtt(i)}})},"./dist/plugins/dragMerge/dragMerge-action.js":function(t,n,e){"use strict";var i,s,e,r,o,c,a,u,f;function l(t,n){return t.JS(n)}function h(t,n){return f.call(this,t,n)||this}i=this&&this.__extends||(u=function(t,n){return(u=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(t,n){t.__proto__=n}:function(t,n){for(var e in n)Object.prototype.hasOwnProperty.call(n,e)&&(t[e]=n[e])}))(t,n)},function(t,n){if("function"!=typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function e(){this.constructor=t}u(t,n),t.prototype=null===n?Object.create(n):(e.prototype=n.prototype,new e)}),Object.defineProperty(n,"__esModule",{value:!0}),n.Commands=void 0,s=e("Core"),Object.defineProperty(n,"Commands",{enumerable:!0,get:function(){return s.Commands}}),e=s.Commands.ActionBase,r=s.Commands.zA,o="dragMerge",c=Math.max,i(h,f=e),h.prototype.canExecute=function(){var t,n,e,n,n,t=this.Mf,n=this.tT,e=l(t,n.oldSelection),n=l(t,n.newSelection);if(e.equals(n)){if((n=t.getSpan(e.row,e.col))&&e.equals(n))return!1;if(1===e.rowCount&&1===e.colCount)return!1}return!0},h.prototype.canUndo=function(){var t,t,t=s.Commands.TI(this.Mf.name()),t=this.tT[t];return s.Commands.AI(t)},h.prototype.undo=function(){var t,n,e,t=this;if(!t.canUndo())return!1;n=t.Mf,t.X5(n,!0),e=s.Commands.TI(n.name()),n.Ut.undo(t.tT[e]),t.q5(n,!0)},h.prototype.execute=function(){var t,n,e,i,r,i,o,a,r,u,t=this,n=t.Mf,e=t.tT,i=e.oldSelection,r=e.newSelection;if(!t.canExecute())return!1;n.Ut.startTransaction(),t.X5(n,!0),n.Ut.do("clearSpan",i.row,i.col,i.rowCount,i.colCount),i=r.row,o=r.col,a=r.rowCount,r=r.colCount,n.addSpan(i,o,a,r),n.setSelection(i,o,c(a,1),c(r,1)),t.q5(n,!0),e[u=s.Commands.TI(n.name())]=n.Ut.endTransaction()},a=h,s.Commands[o]={canUndo:!0,execute:function(t,n,e){return r(t,a,n,e)}},s.Commands.Ttt=function(t){t.register(o,s.Commands[o])}},"./dist/plugins/dragMerge/dragMerge-event.js":function(t,n,e){"use strict";var i,n,l,u,h,p;function s(t,n){t.ki(i.Events.DragMerging,n)}function c(t,n){t.ki(i.Events.DragMerged,n)}Object.defineProperty(n,"__esModule",{value:!0}),n=(i=e("Core")).GC$,l=null,u=void 0,h=Math.abs,p=i.Ec,n.extend(i.nk.prototype,{Att:function(t){var n,e,i,r,n,e,i=t,r=this.Mf.Ut.findSpan(t.row,t.col);return i=r&&r.containsRange(t)?r:i},zL:function(t,n,e){var i,r,o,a,u,s,c,f,r,o,i,a,r,i=this.Mf,r=i.parent,o=i.U5(),a=i.Dn,u=4,s=8,c=2,f=4;if(r&&r.options.allowUserDragMerge&&o&&!i.Oi&&a.Itt){if(o=(r=a.Itt).x,i=r.y,a=r.width,r=r.height,h(o+a-n)<=2&&h(i+r/2-e)<=4)return{right:!0};if(h(o+a/2-n)<=4&&h(i+r-e)<=2)return{bottom:!0}}return l},pk:function(t){var n,t,e,i,i,r,o,a,u,n=this;n.ab=!0,n.rb=!0,n.Uk=!0,n.Rk={e9:t.rowViewportIndex,r9:t.colViewportIndex,Bk:t.hitTestType},n.xtt=t.dragMergeInfo,e=(t=n.Mf).Ut,i=t.U5(),n.Ntt=n.Att(i),r=(i=t.JS(n.Ntt)).row,o=i.col,a=i.rowCount,u=i.colCount,e.GT(r,o,a,u)?(n.rb=!1,n.Uk=!1):(n.ktt=t.Ut.getSpans(i),t.suspendPaint(),e.do("clearSpan",r,o,a,u),t.resumePaint(),n.Dtt=i,n._tt(),n.Ett(i),n.Ok())},Hk:function(){var t,n,e,e,i,r,n,r,n,e,i,t=this,n=t.Mf,e=n.parent;e&&!e.options.allowUserDragMerge?t.ND():(e=t.Q9(),i=t.K9(),r=t.Dtt||t.Ntt,n=n.JS(r),0<=e&&0<=i&&(r=t.xtt,n=t.jtt(n,e,i,r),e=(t.Ott=n).rowCount,i=n.colCount,0<e)&&0<i&&(t._tt(),t.Ett(n),t.Dtt=n,t.a9()))},_tt:function(){var t,n,n,t=this.Mf,n=this.Dtt;n&&((n=t.j1(n)).x-=2,n.y-=2,n.width+=4,n.height+=4,t.Dn.O1(n))},jtt:function(t,n,e,i){var r,o,a,u,s,t,c,f,l,h,d,v,m,g,r,o=this.Mf,a=t.row,u=t.col,s=t.rowCount,t=t.colCount;return i.right?(h=e-(f=u)+1,d=c=a,v=u+t,m=l=s,g=e-u-t+1):i.bottom&&(l=n-(c=a)+1,d=a+s,v=f=u,m=n-a-s+1,g=h=t),o.Ut.eE(d,v,m,g)&&(c=a,f=u,l=s,h=t),p(c,f,l,h)},ND:function(){var t,n,e,i,r,o,a,t,e,t=this,n=t.Mf,e=n.parent,i=t.ktt,r=t.Ntt,o=t.Ott||r;t.ab=!1,t.rb=!1,t.Uk=!1,t.Ott=u,t.ktt=u,t.Dtt=u,t.Ntt=u,t.l9(),e&&e.options.allowUserDragMerge&&(a=n.Ut,n.suspendPaint(),0<i.length&&i.forEach(function(t){a.do("addSpan",t)}),n.resumePaint(),t={sheetName:n.name(),sheet:n,mergeRange:o,cancel:!1},s(n,t),t.cancel||(e={cmd:"dragMerge",sheetName:n.name(),oldSelection:r,newSelection:o},n.Qy().execute(e),c(n,{sheetName:n.name(),sheet:n,mergeRange:o})))},Ett:function(t){var n,e,i=this.Mf.Dn,r;(0,i.Rtt)(i,t)}})},"./dist/plugins/dragMerge/dragMerge.entry.js":function(t,n,e){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),e("./dist/plugins/dragMerge/dragMerge-action.js"),e("./dist/plugins/dragMerge/dragMerge.js"),e("./dist/plugins/dragMerge/dragMerge-event.js")},"./dist/plugins/dragMerge/dragMerge.js":function(t,n,e){"use strict";var y,n,i,f,e,r,o,a;function l(t){var t=t.parent;return t&&t.options.backColor||r}function u(t,n,e){var i,i,e,t,n,i=t.C0(e.row);if((1===i||i!==t.C0(e.row+e.rowCount-1))&&0<(i=t.dw(1)).length)return e=n.y+n.height/2,t=i[0],n=i[i.length-1],t.y<=e&&e<=t.y+t.height||n.y<=e&&e<=n.y+n.height?1:void 0}function s(t,n,e){var i,i,e,t,n,i=t.S0(e.col);if((1===i||i!==t.S0(e.col+e.colCount-1))&&0<(i=t.yw(1)).length)return e=n.x+n.width/2,t=i[0],n=i[i.length-1],t.x<=e&&e<=t.x+t.width||n.x<=e&&e<=n.x+n.width?1:void 0}function w(t,n,e){var n,i,r,o,a,t,i=t.Fi(),r=t.Gy(i),o=t.Sy(i),a=u(t,n,e),t=s(t,n,e),n=1===a&&1===t?i.c9(a,t):1===a?new y.Rect(i.b6,i.Cy,i.F6+r+i.zy,o):1===t?new y.Rect(i.Py,i.T6,r,i.L6+o+i.Iy):new y.Rect(i.b6,i.T6,i.F6+r+i.zy,i.L6+o+i.Iy);return n}Object.defineProperty(n,"__esModule",{value:!0}),y=e("Core"),n=e("Common"),i=e("./dist/plugins/dragMerge/dragMerge-action.js"),f=n.Common.ft,e=y.GC$,r="white",e.extend(y.g7.prototype,{Btt:function(t,n){var e,i,r,r,o,a,u,s,c,f,l,h,d,v,m,g,p,b,i,c,e=this,i=e.Mf,r=i.rt;(0,y.needPaintSelection)(i)&&(c=(r=i.j1(r.Att(n))).x,f=r.y,l=r.width,h=r.height,b=w(i,p=new y.Rect(d=c+l-(u=2),v=f+h/2-(s=o=4),m=4,g=a=8),n),c=w(i,i=new y.Rect(d=c+l/2-4,v=f+h-2,m=8,g=4),n),e.Itt=r,e.Ltt(t,p,i,b,c))},Ltt:function(t,n,e,i,r){var o,a=this.Mf,a=y.Pf.vl(a,a.getSelectionBorderColor());t.save(),t.fillStyle=a,i&&(t.rect(i.x,i.y,i.width,i.height),t.clip()),t.beginPath(),t.rect(n.x,n.y,n.width,n.height),t.fill(),t.restore(),t.save(),t.fillStyle=a,r&&(t.rect(r.x,r.y,r.width,r.height),t.clip()),t.beginPath(),t.rect(e.x,e.y,e.width,e.height),t.fill(),t.restore()},Rtt:function(t,n){var e,i,r,o,t,a,u,o,s,o,s,o,s,o,s,r,i,c,s,e=t,i=e.Mf,r=i.parent,o=i.rt,t=t.J(),a=2,u=1;r&&r.options.allowUserDragMerge&&o.Uk&&(o=i.getActiveRowIndex(),s=i.getActiveColumnIndex(),s=(o=i.getActualStyle(o,s))&&o.backColor,o=l(i),(s=f._(y.Pf.vl(i,s||o))).a*=.6/255,t.fillStyle=f.j(s),t.strokeStyle=y.Pf.vl(i,i.getSelectionBorderColor()),t.lineWidth=2,t.beginPath(),o=r.SC,r=(s=i.j1(n)).x,i=s.y,c=s.width,s=s.height,2007<o?(t.rect(r,i,c-1,s-1),t.strokeRect(r-1,i-1,c+1,s+1)):(t.rect(r+1,i+1,c-2-.5,s-2-.5),t.strokeRect(r-.5,i-.5,c,s)),t.fill(),t.restore(),e.Btt(t,n))}}),y.Workbook.ch("dragMerge",o={init:function(){i.Commands.Ttt(this.commandManager())}}),y.Worksheet.ch("dragMerge",a={paintAdornment:function(t){var t,n,e,i,i,t=t.ctx,n=this,e=n.Dn,i=n.Ut.getSelections();n.parent&&n.parent.options.allowUserDragMerge&&1===i.length&&!n.Oi&&(i=n.U5(),e.Btt(t,i))}})},"./dist/plugins/fill/drag-fill.js":function(w,t,n){"use strict";var e,l,x,h,t,n,u,N,k,C,d,n,S,T,i,f,A,a,I,D,_,E,v,r,o,s,t,m,M,c,F,P,g,G,U,H;function j(t){return t.rowCount}function O(t){return t.colCount}function R(t,n){return t.getRowCount(n)}function B(t,n){return t.getColumnCount(n)}function z(t,n,e,i){return t&&n&&n.containsRange(t)&&(!N(e)&&(1===e&&t.row===n.row&&j(t)===j(n)||0===e&&t.col===n.col&&O(t)===O(n))||!(N(i)||(2!==i&&3!==i||t.col!==n.col||O(t)!==O(n))&&(0!==i&&1!==i||t.row!==n.row||j(t)!==j(n))))}function p(t,n){var e,i,r,o,a,u,s,c,f,l,s,e=G.call(this)||this,i=e,r=n[E],o=0===r,a=o||1===r,u=n[D],s=n[I],c=s.row,f=s.col,l=j(s),s=O(s);return i.Mf=t,4===(i.Ftt=n)[_]?i.Ptt=new x.Commands.JI(t,{ranges:[n[D]]}):i.Gtt=a?d(c,o?u.col:f,l,s+O(u)):d(2===r?u.row:c,f,l+j(u),s),i.Utt=a?1:0,e}function b(t,n){var e,i,e=U.call(this)||this,i=e;return i.Mf=t,i.Htt=n,i.ztt=n[I],i.Vtt=n[D],i.Ytt=n[_],i.Ztt=n[E],e}function L(t,n,e,i,r,o){var a,i,r,n,a=t.getSelections();t.IA(),t.n4(n,e,i,r,!0),i=t.getSelections(),r=0<n?n:t.N9(),n=0<e?e:t.k9(),t.O6(r,n,t.R9,t.B9),t.jA(a),t.parent&&o.Z3&&t.parent.changeSelectionInCommandExecuting(o,null,null,i)}function V(t){var n,e,n,e=t.parent.getActiveSheet();e&&t!==e&&e.repaint()}function y(t,n){return H.call(this,t,n)||this}e=this&&this.__extends||(g=function(t,n){return(g=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(t,n){t.__proto__=n}:function(t,n){for(var e in n)Object.prototype.hasOwnProperty.call(n,e)&&(t[e]=n[e])}))(t,n)},function(t,n){if("function"!=typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function e(){this.constructor=t}g(t,n),t.prototype=null===n?Object.create(n):(e.prototype=n.prototype,new e)}),Object.defineProperty(t,"__esModule",{value:!0}),l=n("Common"),x=n("Core"),h=n("./dist/plugins/fill/fill.js"),t=n("./dist/plugins/fill/fill.ns.js"),n=n("CalcEngine"),u=!!n,N=l.Common.lt.ht,k=null,C=void 0,d=x.Ec,n=x.GC$,S=Math.max,T=Math.floor,i=x.Commands.ActionBase,f=x.Commands.CI,A=x.Commands.SI,a=2047,I="startRange",D="fillRange",_="autoFillType",E="fillDirection",v="cancel",r="fill",o="dragDrop",s=n.isEmptyObject,t=new l.Common.ResourceManager(t.SR,"Fill"),m=t.getResource.bind(t),n.extend(x.Worksheet.prototype,M={fillAuto:function(t,n,e){if(!n)throw new Error(m().Exp_RangeIsNull);var i=this,r=e.fillType,o=e.series,a=e.direction,u=e.step,s=e.stop,c=new h.Wtt(i),f=e.Qtt;if(z(t,n,a?k:o,a)){i.suspendPaint(),t&&(i.rt.Ktt=t);try{4===r?c.Jtt(n,o,!1,e.withTag,e.withoutStyle,f):0===r?c.Xtt(n,a):1===r||2===r?c.qtt(1===r,n,o,u,s):3===r&&c.$tt(n,o,3,u,N(s)?k:l.Common.ct.o0(s),e.unit)}finally{i.resumePaint()}}}}),x.Worksheet.ch(r,{init:function(){this.tnt=new h.nnt(this)},setHost:function(t){var t;t&&((t=this.Qy()).fill||t.register(r,x.Commands.fill),t[o]||t.register(o,x.Commands[o]))},dispose:function(t){var t;!1!==t.clearCache&&(t=this).tnt&&(t.tnt.L0(),t.tnt=k)}}),x.Workbook.ch(r,{onCultureChanged:function(){m()}}),e(p,G=i),p.prototype.canExecute=function(){var t=this,n=t.Mf,t=t.Ftt,e=t[I],i=t[D];return!(!n.PT(i.row,i.col,j(i),O(i),void 0,void 0,void 0,void 0,!0,x.SheetArea.viewport)||4!==t[_]&&i.intersect(e.row,e.col,j(e),O(e)))},p.prototype.execute=function(){var t,n,e,i,r,o,o,t=this;if(t.canExecute()){e=(n=t.Ftt)[D],r=(i=t.Mf).parent.i4(),x.Commands.II(r),t.X5(i,!0);try{u&&i.suspendCalcService(),o=i.getSelections(),i.isDirtySuspended()||(t.ent=new f(i,n[D],a)),4===n[_]?t.int(i):t.rnt(i),i.EA(o,i.getSelections())&&i.jA(o)}finally{t.q5(i,!0),u&&i.resumeCalcService(!1),x.Commands.xI(r,n),i.Q1i&&i.Q1i(e.row,e.col,j(e),O(e)),o=[],i.isDirtySuspended()||(t.ont=new f(i,e,a),t.ont.yI(t.ent.bI()),o=t.ont.MI()),A(i,e.row,e.col,j(e),O(e),o,1)}}},p.prototype.int=function(t){var n,e,i,e,n,r,o,r,o,n,n=this;n.Ptt.execute(t),i=(e=n.Ftt)[I],e=e[D],n=0===n.Utt,o=j(i),r=O(i),o=n?S(1,o-j(e)):o,n=n?r:S(1,r-O(e)),i.equals(e)||(r=d(i.row,i.col,o,n),t.O6(S(t.N9(),r.row),S(t.k9(),r.col),t.R9,t.B9),t.IA(),t.n4(r.row,r.col,j(r),O(r)))},p.prototype.rnt=function(t){var n,e,i,r,o,a,u,s,c,f,l,h,d,v,m,g,p,b,y,i,w,M,n=this,e=n.Mf,i=n.Ftt,r=i[I],o=i[D],a=i[_],u=n.Gtt,f={fillType:4,series:n.Utt,withTag:!0,withoutStyle:!(e.lF&x.CopyToOptions.style)},l=e.tables,h=!1,d=new x.Range(u.row,u.col,u.rowCount,u.colCount);if(l)try{(m=2===(v=i[E]))&&(g=r.rowCount,p=0===l.AB(r.row,r.col,g,r.colCount).length)&&(h=!0,d.rowCount-=g),b=[],l.yx(k,d,C,C,C,b,{applyDragFillAfterTableExpand:h}),0<b.length&&(f.Qtt=b)}catch(t){return e.jT(6,t.message),void e.resumePaint()}if(1===a){if(e.fillAuto(r,u,f),e.lF&x.CopyToOptions.style&&e.Ut.eE(r.row,r.col,r.rowCount,r.colCount))for(s=0;s<o.rowCount;s++)for(c=0;c<o.colCount;c++)(y=e.vI(r.row+T(s%r.rowCount),r.col+T(c%r.colCount)))&&y.clone&&(y=y.clone()),e.CL(o.row+s,o.col+c,y)}else 0===a?(i=e.lF&~x.CopyToOptions.comment,n.ant(r,o,i)):2===a?n.ant(r,o,192):3===a&&((w=!(1!==j(r)||1!==O(r)||-1===r.row&&-1!==r.col||-1===r.col&&-1!==r.row))?n.ant(r,o,M=187):(f.withoutStyle=!0,e.fillAuto(r,u,f)));e.O6(S(t.N9(),u.row),S(t.k9(),u.col),t.R9,t.B9),t.IA&&t.IA(),e.n4(u.row,u.col,j(u),O(u))},p.prototype.ant=function(t,n,e){var i=this,r=i.Mf,t=r.JS(t),n=r.JS(n),o=t.row,a=t.col,u=j(t),s=O(t),c=n.row,f=n.col,l=j(n),h=O(n),t=i.Ftt[E],d=3===t,v=1===t,m=T(l/u),n=l%u,g=T(h/s),t=h%s,p,b,y,w,M;if(r.HB=!0,0===i.Utt){for(p=0;p<m;p++)r.vT(o,a,w=d?c+p*u:c+l-(p+1)*u,f,u,s,e,!0,!0);0!=n&&r.vT(b=d?o:o+(m+1)*u-l,a,w=d?c+u*m:c+l-m*u-n,f,n,s,e,!0,!0)}else{for(p=0;p<g;p++)r.vT(o,a,c,M=v?f+p*s:f+h-(p+1)*s,u,s,e,!0,!0);0!=t&&r.vT(o,y=v?a:a+(g+1)*s-h,c,M=v?f+s*g:f+h-g*s-t,u,t,e,!0,!0)}delete r.HB,r.recalcRange(c,f,l,h)},p.prototype.undo=function(){var t,n,e,i,r,o,a,t=this,n=t.Mf,e=!1;if(t.canUndo()){t.X5(n,!0);try{u&&n.suspendCalcService(),i=n.getSelections(),r=t.Ftt,o=n.R_,a=r[D],e=4===r[_]?t.unt(n):t.snt(n),!n.cnt&&o&&o.close(),A(n,a.row,a.col,j(a),O(a),t.ont?t.ont.MI():[],1,C,!0),n.EA(i,n.getSelections())&&n.jA(i)}finally{t.q5(n,!0),u&&n.resumeCalcService(!1)}}return e},p.prototype.unt=function(t){var n,e,i,e,r,n=this,e=n.Ftt[I],i=e.row,e=e.col,r=x.Commands.TI(t.name());return t.Ut.undo(n.Ftt[r]),t.O6(S(t.N9(),i),S(t.k9(),e),t.R9,t.B9),!0},p.prototype.snt=function(t){var n,e,i,r,i,o,n,e=this.Ftt,i=e[I],r=i.row,i=i.col;u&&t.suspendCalcService();try{o=x.Commands.TI(t.name()),t.Ut.undo(e[o]),t.O6(S(t.N9(),r),S(t.k9(),i),t.R9,t.B9)}finally{u&&t.resumeCalcService(!1)}return t.invalidateLayout(),!0},c=p,e(b,U=i),b.prototype.execute=function(){var t,n,e,i,r,o,a,u,s,c,f,t=this,n=!1;if(t.canExecute()){i=(e=t.Mf).parent,r=t.Vtt,o=t.Htt,a=e.parent.i4(),x.Commands.II(a),t.XI(),t.X5(e,!0),e.QI=!0;try{u=e.getSelections(),s=void 0,c=e.rt,(f={sheet:e,sheetName:e.name(),cancel:!1})[D]=r,f[_]=t.Ytt,f[E]=t.Ztt,e.ki(x.Events.DragFillBlock,f),c.fnt=f[_],c.lnt=f[v],f[v]||(t.hnt(f),e.ki(x.Events.DragFillBlockCompleted,f)),n=!0,s=e.getSelections(),e.EA(u,s)&&e.jA(u),i&&o.Z3&&i.changeSelectionInCommandExecuting(o,null,null,s)}finally{t.q5(e,!0),e.QI=!1,t.dnt(e,r),x.Commands.xI(a,t.Htt)}}return n},b.prototype.hnt=function(t){var n,e,i,r,o,i,r,n=this,e=n.Mf,i=e.rt,r=n.Vtt,o=n.Ytt;i.fnt=o,i.lnt||((i={})[I]=n.ztt,i[D]=r,i[_]=5===t[_]?o:t[_],i[E]=n.Ztt,r=new c(e,i),e.suspendEvent(),r.execute(),e.resumeEvent(),n.Htt.vnt=r)},b.prototype.XI=function(){var t=this;t.Mf.isDirtySuspended()||(t.ent=new f(t.Mf,t.Vtt,a))},b.prototype.undo=function(){var t,n,e,i,r,o,a,u,t=this;if(t.canUndo()){n=t.Mf,e=t.Vtt,i=n.parent,r=t.Htt,t.XI(),t.X5(n,!0);try{o=n.getSelections(),n.suspendEvent(),a=x.Commands.TI(n.name()),n.Ut.undo(t.Htt[a]),n.resumeEvent(),u=r[I],n.EA(o,[u])&&n.jA(o),i&&r.Z3&&i.changeSelectionInCommandExecuting(r,null,null,[u])}finally{t.q5(n,!0),t.dnt(n,e,!0)}}return!0},b.prototype.dnt=function(t,n,e){var i,r,o,i=this,r=[];t.isDirtySuspended()||((o=new f(t,n,a)).yI(i.ent.bI()),r=o.MI()),A(t,n.row,n.col,j(n),O(n),r,1,C,e)},F=b,e(y,H=i),y.prototype.canExecute=function(){var t,n,e,i,r,o,a,u,s,c,f,l,h,c,d,v,m,g,c,t=this,n=t.Mf,e=t.tT,i=e.fromRow,r=e.fromColumn,o=j(e),a=e.columnCount,u=e.toRow,s=e.toColumn,c=!e.copy,f,l;if(n.tables&&n.tables.mx(n,{row:i,col:r,rowCount:o,colCount:a},n,{row:u,col:s,rowCount:o,colCount:a},c))return!1;if(!n.zT(i,r,o,a,R(n),B(n)))return!1;if(!e.insert&&!n.zT(u,s,o,a,R(n),B(n)))return!1;if(e.cmd===x.RangeChangedAction[0]&&n.tables&&(h=!1,0<(c=n.tables.AB(i,r,o,a)).length)){for(v=(d=c[0].range()).row;v<d.row+d.rowCount;v++)if(n.isRowFilterOut(v)){h=!0;break}return!(h&&d.contains(e.mouseTargetRow,e.mouseTargetCol,1,1))}return c=t.mnt(m=0<=u&&s<0&&0<=i&&r<0&&0<o&&a<0,g=u<0&&0<=s&&i<0&&0<=r&&o<0&&0<a),n.PT(u,s,o,a,k,k,c,k,k,x.SheetArea.viewport)&&n.PT(i,r,o,a,k,k,c,k,k,x.SheetArea.viewport)},y.prototype.mnt=function(t,n){var e,i,e,i,r,e,r,e,e=this,i=e.tT,e=e.Mf,i=i.insert,r=e.options.isProtected,e=e.options.protectionOptions;return!(!r||s(e)||(r=e.allowDragInsertRows,e=e.allowDragInsertColumns,!i)||!(r&&t||e&&n))},y.prototype.vx=function(t){var n=[].concat(t.parent.sheets);return t&&t.NMi&&n.push(t),n},y.prototype.execute=function(){var t,n,e,i,r,o,a,u,s,c,f,l,h,d,v,m,g,p,b,y,w,M,C,S,T,A,I,t=this,n=!1;if(t.canExecute()){e=t.Mf,i=t.tT,t.XI(),a=o=r=void 0,u=i.fromRow,s=i.fromColumn,c=i.toRow,f=i.toColumn,l=j(i),h=i.columnCount,d=i.option,v=l,m=h,g=t.vx(e),(p=e.o5())&&(v+=e.lT(c,l,!0),m+=e.lT(f,h)),x.Commands.II(g),t.X5(e,!0),e.QI=!0,b=void 0;try{try{b={shiftCells:i.insert&&i.shiftCells===x.InsertShiftCell.down,isCopy:i.copy,isFirst:!0},e.tables&&e.tables.yx(e,new x.Range(c,f,v,m),new x.Range(u,s,l,h),k,k,k,{shiftInfo:b})}catch(t){return e.jT(6,t.message),void e.resumePaint()}i.insert?0<=s&&u<0?(r=s,a=h,y=o=f,e.addColumns(o,a),i.copy?e.copyTo(-1,o<=r?r+a:r,-1,o,-1,a,d):(e.moveTo(-1,o<=r?r+a:r,-1,o,-1,a,d),e.deleteColumns(o<=r?r+a:r,a),r<o&&(y=o-a)),L(e,-1,y,R(e),a,i)):0<=u&&s<0?(r=u,a=l,w=o=c,e.addRows(o,a),i.copy?e.copyTo(o<=r?r+a:r,-1,o,-1,a,-1,d):(e.moveTo(o<=r?r+a:r,-1,o,-1,a,-1,d),e.deleteRows(o<=r?r+a:r,a),r<o&&(w=o-a)),L(e,w,-1,a,B(e),i)):0<=u&&0<=s&&(M=i.shiftCells,C=new x.Range(c,f,1,1),S=new x.Range(u,s,l,h),N(M)||(T={cmd:"clipboardPaste",sheetName:e.name(),clipboardHtml:"",clipboardImage:"",clipboardText:"",fromRanges:[S],fromSheet:e,isCutting:!i.copy,pasteOption:0,pastedRanges:[new x.Range(c,f,l,h)],cA:C,fA:S,sA:M,bx:!0,px:b&&b.ignoreFooterShiftIndex},e.Qy().execute(T),A=e.getSelections()[0],M===x.InsertShiftCell.down&&u<c&&!i.copy&&s===f?e.setSelection(A.row-l,A.col,A.rowCount,A.colCount):M===x.InsertShiftCell.right&&s<f&&!i.copy&&u===c&&e.setSelection(A.row,A.col-h,A.rowCount,A.colCount))):(i.copy?e.copyTo(u,s,c,f,l,h,d):e.moveTo(u,s,c,f,l,h,d),e&&(L(e,c,f,v,m,i),I=i.Kh,i.copy||e.isDirtySuspended()||(I.wx=t.gnt(e,I.qI,u,s,l,h)),e.isDirtySuspended()||(I.Mx=t.gnt(e,I.$I,c,f,l,h)))),n=!0}finally{e.rt.q6={},t.q5(e,!0),e.QI=!1,x.Commands.xI(g,i)}V(e)}return n},y.prototype.gnt=function(t,n,e,i,r,o){var a,u,a=new f(t,d(e,i,r,o),this.tT.option),u=t.tables&&t.tables.WI&&t.tables.WI(e,i,r,o);return u&&0<u.length&&(this.tT.tableNamesObj={r:e,c:i,rc:r,cc:o,tableNames:u}),a.yI(n.bI()),A(t,e,i,r,o,a.MI(),0,u),a},y.prototype.XI=function(){var t,n,t,e,i,r,o,a,u,s,c,o,a,i,r,t=this,n=t.Mf,t=t.tT,e=t.Kh={},i=t.fromRow,r=t.fromColumn,o=t.toRow,a=t.toColumn,u=t.option,s=i<0?0:i,c=r<0?0:r,o=o<0?0:o,a=a<0?0:a,i=i<0?R(n):j(t),r=r<0?B(n):t.columnCount;t.insert||n.isDirtySuspended()||(t.copy||(e.qI=new f(n,d(s,c,i,r),u)),e.$I=new f(n,d(o,a,i,r),u)),e.pnt=n.R9,e.bnt=n.B9,e.ynt=n.ui,e.wnt=n.ci},y.prototype.undo=function(){var t,n,e,i,r,o,a,u,s,c,f,l,h,d,v,m,g,p,b,y,w,M,C,S,t=this;if(t.canUndo()){if(n=t.Mf,i=(e=t.tT).fromRow,r=e.fromColumn,o=e.toRow,a=e.toColumn,u=j(e),s=e.columnCount,!n.zT(i,r,u,s,R(n),B(n)))return!1;if(!e.insert&&!n.zT(o,a,u,s,R(n),B(n)))return!1;f=e.Kh,t.X5(n,!(c=void 0)),l=t.vx(n),x.Commands.NI(l,e);try{e.insert?0<=r&&0<=i||(0<=r?(c=s,n&&L(n,-1,r,R(n),c,e)):0<=i&&(c=u,n)&&L(n,i,-1,c,B(n),e)):(v=i<0?0:i,m=r<0?0:r,g=o<0?0:o,p=a<0?0:a,b=i<0?R(n):u,y=r<0?B(n):s,n&&(L(n,i,r,u,s,e),w=e.tableNamesObj,M=[],C=[],w&&(w.r===g&&w.c===p&&w.rc===b&&w.cc===y?C=w.tableNames:M=w.tableNames),A(n,g,p,b,y,f.Mx?f.Mx.MI():[],0,M,!0),A(n,v,m,b,y,f.wx?f.wx.MI():[],0,C,!0))),n&&(-1!==f.ynt&&-1!==f.wnt&&((S=n.getSelections()[0]).contains(f.ynt,f.wnt)?n.XA(f.ynt,f.wnt):n.XA(S.row,S.col)),-2!==f.pnt)&&-2!==f.bnt&&-1!==f.ynt&&-1!==f.wnt&&n.showCell(f.ynt,f.wnt,3,3)}finally{t.q5(n,!0)}V(n)}return!0},P=y,x.Commands.fill={canUndo:!0,execute:function(t,n,e){return x.Commands.zA(t,F,n,e)}},x.Commands[o]={canUndo:!0,execute:function(t,n,e){return x.Commands.zA(t,P,n,e)}}},"./dist/plugins/fill/fill-event.js":function(r,t,n){"use strict";var g,C,m,i,p,t,b,y,d,w,c,M,S,T,v,A,e,o,f,l,h,a,I,n,x;function N(t){return t.rowViewportIndex}function k(t){return t.colViewportIndex}function s(t){return t.frozenRowCount()}function G(t){return t.frozenColumnCount()}function u(t){return t.hitTestType}function D(t,n){return t.getRowCount(n)}function _(t,n){return t.getColumnCount(n)}function E(t){return t.colCount}function j(t){return t.rowCount}function O(t){return t.height}function R(t){return t.width}function B(t){var n,t,n=7,t=t.parent;return n=t?2007<t.SC?2:7:n}function L(t,n,e,i,r,o,a){var u,s,c;t.save(),o=o||h,a=a||2,n===i?(t.rect(n-2,e,7,v(r-e)),t.clip(),t.beginPath(),e<r?(e-=3,r+=3):(e+=3,r-=3),u=(0,C.Zx)(n-1,e-1,i-1,r+1,o,a),s=(0,C.Zx)(n,e,i,r,o,a),c=(0,C.Zx)(n+1,e-1,i+1,r+1,o,a)):e===r&&(t.rect(n,e-2,v(i-n),7),t.clip(),t.beginPath(),n<i?(n-=3,i+=3):(n+=3,i-=3),u=(0,C.Zx)(n-1,e-1,i+1,r-1,o,a),s=(0,C.Zx)(n,e,i,r,o,a),c=(0,C.Zx)(n-1,e+1,i+1,r+1,o,a)),u&&u.qx(t),s&&s.qx(t),c&&c.qx(t),t.strokeStyle=o,t.stroke(),t.beginPath(),t.restore()}function F(t,n,e,i,r,o,a,u,s,c,f){var l=n?C.Events.DragDropBlock:C.Events.DragDropBlockCompleted,e={sheet:t,sheetName:t.name(),fromRow:e,fromCol:i,toRow:r,toCol:o,rowCount:a,colCount:u,copy:s,insert:c,copyOption:f};return n&&(e.cancel=!1),t.ki(l,e),e}function P(t,n,e,i,r){for(var o,a,u,o=0;o<e.rowCount;o++){for(a=0;a<e.colCount;a++){if(!(u=t.getSpan(e.row+o,e.col+a))||u.rowCount!==n.rowCount||u.colCount!==n.colCount)return!1;i&&(a+=n.colCount)}r&&(o+=n.rowCount)}return!0}function U(t,n,e){var i,r,o,a,u,s,c,f,r,a,i,i=n.row,r=n.rowCount,o=n.col,a=n.colCount,u=e.row,s=e.rowCount,c=e.col,f=e.colCount,r=i===u&&r===s,a=o===c&&a===f;return(r||a)&&(i=t.getSpan(i,o))&&P(t,i,n,r,a)&&!t.Ut.GT(u,c,s,f)&&P(t,i,e,r,a)}Object.defineProperty(t,"__esModule",{value:!0}),g=n("Common"),C=n("Core"),m=n("SheetsCalc"),i=n("./dist/plugins/fill/fill-ui.js"),p=n("./dist/plugins/fill/fill.js"),t=n("./dist/plugins/fill/fill.ns.js"),b=n("CalcEngine"),y=!!b,d=C.GC$,w=C.Ec,c=g.Common.lt.ht,M=null,S=void 0,T=Math.min,v=Math.abs,A=Math.max,e=5,o=3,f="drag",l="corner",h="black",a=2047,I=g.Common.zf,n=new g.Common.ResourceManager(t.SR,"Fill"),x=n.getResource.bind(n),d.extend(C.nk.prototype,{bk:function(t){var n,e,i,r,r,o,a,a,o,r,a,e,n=this;n.zk||(e=n.Mf,i=M,1===(r=e.Ut.getSelections()).length?i=r[0]:r.length<1&&(i=e.Ut.getSpan(e.ui,e.ci)),i&&(n.zk=!0,n.rb=!0,n.Mnt=i,(r=e.tables&&e.tables.find(i.row,i.col))&&(o=n.Cnt=!0,a=r.range(),o=!(r.showHeader()&&i.row===a.row||r.showFooter()&&i.row===a.row+a.rowCount-1||i.col!==a.col||i.colCount!==a.colCount)&&o)&&(n.Snt=!0,n.e_=!0,n.Tnt=r.name()),a=e.getRangeRect(N(t),k(t),i),(o=n.q6).x=a.x,o.y=a.y,o.width=a.width-1,o.height=a.height-1,o.row=i.row,o.col=i.col,o.rowCount=j(i),o.colCount=E(i),r=e.JS(i),a=t.row,e=t.col,(a=a<r.row?r.row:a)>=r.row+j(r)&&(a=r.row+j(r)-1),(e=e<r.col?r.col:e)>=r.col+E(r)&&(e=r.col+E(r)-1),o.hitRow=a,o.hitCol=e,o.rowOffset=a-r.row,o.colOffset=e-r.col,n.Rk={e9:N(t),r9:k(t),Bk:u(t)},n.Ok()))},Vk:function(){var t,n,e,i,r,o,a,i,e,u,s,t=this;t.Rk&&t.rb&&t.zk&&t.Mnt&&(n=t.fk,e=t.q6,r=(i=t.Mf.getCellRect(e.hitRow,e.hitCol)).width/2,o=i.x+r,a=i.height/2,i=i.y+a,e.hitTarget={x:n.x,y:n.y},e=t.Q9(),u=t.K9(),s=!1,(v(o-n.x)>5+r||v(i-n.y)>5+a)&&(s=!0),0<=e&&0<=u&&s&&t.Ant(e,u),t.a9())},Ant:function(t,n){var e,i,r,o,a,u,s,c,f,l,h,l,a,f,c,l,a,t,n,o,e=this;e.zk&&e.Mnt&&(i=e.Mf,r=e.q6,o=i.o5(),a=i.U5(),u=D(i),s=_(i),c=T(s-E(r),n-r.colOffset),f=T(u-j(r),t-r.rowOffset),o&&(l=i.ox(n,r.colOffset+1),f-=h=i.ox(t,r.rowOffset+1,!0),0===i.getColumnWidth(c-=l)&&(c=i.r6(c)),0===i.getRowHeight(f))&&(f=i.nI(f)),-1===a.row&&-1!==a.col?(r.row=-1,r.col=A(0,c)):-1!==a.row&&-1===a.col?(r.row=A(0,f),r.col=-1):(r.row=r.row<0?-1:A(0,f),r.col=r.col<0?-1:A(0,c)),e.Snt&&(a=(l=i.tables&&i.tables.find(t,n))&&l.range(),!l||l.name()!==e.Tnt||t===a.row||l.showFooter()&&t===a.row+a.rowCount?e.e_=!1:e.e_=!0,e.e_?(r.col=a.col,e.i_=!e.isPressShiftKey):e.i_=e.isPressShiftKey),r.hitRow=t,r.hitCol=n,f=i.JS(r),o&&(c=i.lT(f.row,f.rowCount,!0),l=i.lT(f.col,f.colCount),f.rowCount+=c,f.colCount+=l,f.rowCount=T(u,f.rowCount),f.colCount=T(s,f.colCount),f.row+f.rowCount>u&&(f.row=u-f.rowCount,r.row=f.row),f.col+f.colCount>s)&&(f.col=s-f.colCount,r.col=f.col),(a=e.Int)&&f.row===a.row&&f.col===a.col&&j(f)===j(a)&&E(f)===E(a)&&f.row>i.N9()&&f.col>i.k9()&&f.row+j(f)-1<i.P6()&&f.col+E(f)-1<i.G6()||(e.xnt=f,i.Dn.o_(),e.Int=f,(t=i.parent)&&t.options.showDragDropTip&&(n=r.x+r.width+5,o=r.y+r.height+5,t.Tw(I.j0(e.Nnt(f)),n,o))))},Nnt:function(t){var n,e,i,r,o,a,u,s,c,f,l,h,d,v;return t&&y?(i=j(e=(n=this.Mf).U5()),r=E(e),o=n.getActiveRowIndex(),a=n.getActiveColumnIndex(),u=void 0,s=n.o5(),o=o<0?0:o,a=a<0?0:a,u=1===i&&1===r?b.knt(M,M,t.row-o,t.col-a,!0,!0):(h=l=f=c=void 0,v=d=0,-1===e.row&&0<=e.col?(c=l=m.BAND_INDEX_CONST,f=t.col-a,h=t.col-a+r-1,v=r):-1===e.col&&0<=e.row?(f=h=m.BAND_INDEX_CONST,c=t.row-o,l=t.row-o+i-1,d=i):0<=e.row&&0<=e.col&&(c=t.row-o,l=t.row-o+i-1,f=t.col-a,h=t.col-a+r-1,d=i,v=r),s&&(l+=n.lT(t.row,d,!0),h+=n.lT(t.col,v)),b.lJ(M,M,c,f,l,h,!0,!0,!0,!0,o,a)),n.op().unparse(n.Uw(),u,o,a)):S},kD:function(t){var n,e,i,r,o,a,a,u,s,c,f,l,h,d,a,v,m,g,p,p,b,p,b,b,n=this,e=!1,i="",r=!1,o=n.Mf;n.Rk=M,n.l9(),a=o.U5(),u=n.q6.row,s=n.q6.col,c=n.q6.hitRow,f=n.q6.hitCol,n.i_&&a.contains(c,f)||(a=a&&(0<j(a)||0<E(a))?{r:a.row,c:a.col,rc:j(a),cc:E(a)}:{r:o.ui,c:o.ci,rc:1,cc:1},!0===n.zk&&!0===n.rb&&(l=a.r,h=a.c,d=a.rc,a=a.cc,v=o.options.protectionOptions,m=o.lF,g=void 0,n.shiftCells=null,n.i_&&(n.shiftCells=n.Dnt?C.InsertShiftCell.right:C.InsertShiftCell.down),p={fromRow:l,fromColumn:h,rowCount:d,columnCount:a,toRow:u,toColumn:s,isDragInsert:n.i_,isDragCopy:n.t_},o.ki(C.Events.BeforeDragDrop,p),(i=p.invalidMessage)&&0!==i.length||(!n.i_||-1!==l&&-1!==h?u===l&&s===h||(p=o.GT(l,h,d,a),b=o.GT(u,s,d,a),!p&&!b||(b=!1,b=!(p||n.shiftCells!==C.InsertShiftCell.right&&n.shiftCells!==C.InsertShiftCell.down)||b)||(e=!0,i=x().Exp_ChangeMergedCell),e||y&&(o.KT(l,h,d,a)||o.KT(u,s,d,a))&&(e=!0,i=x().Exp_ChangePartOfArray),!e&&o.options.isProtected&&(!n.t_&&o.dA(w(l,h,d,a),!0,C.SheetArea.viewport)||o.dA(w(u,s,d,a),!0,C.SheetArea.viewport))&&(e=!0,i=o.FT()),e)||(n.i_&&(n.Dnt?s=n.q6.hitCol:u=n.q6.hitRow),(g=F(o,!0,l,h,u,s,d,a,n.t_,!1,m)).cancel)||(r=o.Qy().execute({cmd:"dragDrop",sheetName:o.name(),fromRow:l,fromColumn:h,toRow:u,toColumn:s,rowCount:d,columnCount:a,copy:n.t_,insert:n.i_,shiftCells:n.shiftCells,option:g.copyOption,mouseTargetRow:c,mouseTargetCol:f}),F(o,!1,l,h,u,s,d,a,n.t_,!1,g.copyOption)):0<=h?(n.t_&&(s<=h||h+a<=s)||!n.t_&&(s<h||h+a<s))&&((o.GT(-1,h,-1,a)||o.GT(-1,s,-1,0))&&(e=!0,i=x().Exp_ChangeMergedCell),p=v&&v.allowDragInsertColumns,!e&&o.options.isProtected&&!0!==p&&(e=!0,i=x().Exp_ColumnReadOnly),e||(g=F(o,!0,-1,h,-1,s,-1,a,n.t_,!0,m)).cancel||(r=o.Qy().execute({cmd:"dragDrop",sheetName:o.name(),fromRow:-1,fromColumn:h,toRow:-1,toColumn:s,rowCount:-1,columnCount:a,copy:n.t_,insert:!0,option:g.copyOption,mouseTargetRow:c,mouseTargetCol:f}),F(o,!1,-1,h,-1,s,-1,a,n.t_,!0,g.copyOption))):0<=l&&h<0&&(n.t_&&(u<=l||l+d<=u)||!n.t_&&(u<l||l+d<u))&&((o.GT(l,-1,d,-1)||o.GT(u,-1,0,-1))&&(e=!0,i=x().Exp_ChangeMergedCell),e||y&&(o.KT(l,-1,d,-1)||o.KT(u,-1,0,-1))&&(e=!0,i=x().Exp_ChangePartOfArray),b=v&&v.allowDragInsertRows,!e&&o.options.isProtected&&!0!==b&&(e=!0,i=x().Exp_RowReadOnly),e||(g=F(o,!0,l,-1,u,-1,d,-1,n.t_,!0,m)).cancel||(r=o.Qy().execute({cmd:"dragDrop",sheetName:o.name(),fromRow:l,fromColumn:-1,toRow:u,toColumn:-1,rowCount:d,columnCount:-1,copy:n.t_,insert:!0,option:g.copyOption,mouseTargetRow:c,mouseTargetCol:f}),F(o,!1,l,-1,u,-1,d,-1,n.t_,!0,g.copyOption)))))),n.rb=!1,n.zk=!1,n.Snt=!1,n.Cnt=!1,n.e_=!1,n.Tnt=M,n.Mnt=M,n.i_=!1,n.t_=!1,n.Int=M,n.xnt=M,n.iy(),r||(n.q6={},o.repaint()),e&&o.jT(3,i)},wk:function(t){var n=this;!0!==n.Yk&&!0!==n.rb&&(n._nt(),n.Ktt)&&(n.rb=!0,n.Yk=!0,n.hO=!0,n.Ent=t,n.jnt=k(t),n.Ont=N(t),n.Rnt=k(t),n.Bnt(),n.Rk={e9:N(t),r9:k(t),Bk:u(t)},n.Ok())},Bnt:function(){var t,n,e,i,n,t=this,n=s(t.Mf),e=G(t.Mf),i=t.Lnt();0<=i&&i<n?t.Fnt=0:n<=i&&i<=D(t.Mf)&&(t.Fnt=1),t.Pnt()?t.Gnt=1:t.Gnt=t.Ent,0<=(n=t.Unt())&&n<e?t.Hnt=0:e<=n&&n<=_(t.Mf)&&(t.Hnt=1),t.znt()?t.Vnt=1:t.Vnt=t.jnt},Zk:function(){var t,n,e,i,t=this;t.Rk&&t.Yk&&t.rb&&t.Ktt&&(t.Ont=t.nD(),t.Rnt=t.eD(),t.Ynt=t.Q9(),t.Znt=t.K9(),0<=t.Ynt&&0<=t.Znt&&(t.Wnt(),t.Qnt(),n=t.Mf.parent,e=!1,(i=t.Knt())&&(e=t.Jnt(t.Ktt,t.Xnt,!0)),n&&n.options.showDragFillTip&&e&&t.qnt(),t.$nt()),t.a9())},tet:function(){var t,n,e,i,r,r,o,a,u,u,s,a,c,f,l,h,d,h,d,v,m,t=this,n=t.Mf,e=t.Ktt,i=t.Xnt,r=n.parent.options.defaultDragFillType,r=t.net(3===r?5:r,3===r),o=t.eet(),a=t.Knt();return 1===r?(u=0===o||1===o?1:0,a=(s=new p.Wtt(n)).Jtt(a,u,!0),u=t.iet(o,i,e),f=(c=n.getActualStyle(u.row,u.col)).cellType||n.$f(),l=c.formatter||c._autoFormatter,h=g.Formatter&&g.Formatter.GeneralFormatter,a instanceof Date&&h&&(l=new h(g.Common.CultureManager.Fe().DateTimeFormat.shortDatePattern+" hh:mm:ss AM/PM;@","0")),h=3,(d=t.Rk)&&(h=d.Bk),d={sheet:n,row:u.row,col:u.col,sheetArea:h,quotePrefix:c.quotePrefix},f.format(a,l,v={},d)):0!==r||(u=t.iet(o,i,e),m=n.getFormula(u.row,u.col))?M:n.getText(u.row,u.col)},iet:function(t,n,e){var i,r,o,e,a,u,i=e.row,r=e.col,o=j(e),e=E(e),a=w(i,r,1,1);return 3===t?(u=j(n)%o,a.row=u=0===u?i+o-1:i+u-1,a.col=r):1===t?(u=0===(u=E(n)%e)?r+e-1:r+u-1,a.row=i,a.col=u):0===t?(u=0===(u=E(n)%e)?r:r+e-u,a.row=i,a.col=u):2===t&&(u=j(n)%o,a.row=u=0===u?i:i+o-u,a.col=r),a},qnt:function(){var t,n,e,i,r,o,a,o,n,t=this,n=t.Mf,e;if(4===t.net()||t.znt()||t.Pnt())return t.iy(),M;a=t.eet(),o=t.Knt(),n=n.j1(o),o=t.tet(),3===a||1===a?(i=n.x+n.width+3,r=n.y+n.height+3):0===a?(i=n.x+3,r=n.y+n.height+3):2===a&&(i=n.x+n.width+3,r=n.y+3),t.Tw(o,i,r)},$nt:function(){var t=this;t.ret(),t.oet(),t.aet(),t.uet=t.Knt()},ret:function(){var t,n,t=this.Mf;this.uet&&((n=t.j1(this.uet)).x-=2,n.y-=2,n.width+=4,n.height+=4,t.Dn.O1(n))},oet:function(t){var n;this.Mf.Dn.E1(this.Ktt,M,t)},aet:function(){var t,n,e,i,e,r,t,t=this.Mf,n=t.Dn,e=this.Knt();e&&(i=n.J(),e=t.j1(e),r=t.getSelectionBorderColor(),t=B(t),i.save(),i.beginPath(),n.cet(i,e,r,t),i.restore())},Qnt:function(){this.Xnt=this.dO()},znt:function(){return-1===this.Ktt.col&&-1!==this.Ktt.row},Pnt:function(){return-1===this.Ktt.row&&-1!==this.Ktt.col},lO:function(){return 4===this.bO||5===this.bO},dO:function(){var t,n,e,i,r,t=this,n=-1,e=-1,i=-1,r=-1;switch(t.bO){case 0:i=t.Pnt()?n=-1:(n=t.Lnt(),j(t.Ktt)),e=t.Znt,r=t.Unt()-e;break;case 1:i=t.Pnt()?n=-1:(n=t.Lnt(),j(t.Ktt)),e=t.fet()+1,r=t.Znt-e+1;break;case 2:n=t.Ynt,i=t.Lnt()-n,r=t.znt()?e=-1:(e=t.Unt(),E(t.Ktt));break;case 3:n=t.let()+1,i=t.Ynt-n+1,r=t.znt()?e=-1:(e=t.Unt(),E(t.Ktt));break;case 5:n=t.Ynt,i=t.let()-n+1,r=t.znt()?e=-1:(e=t.Unt(),E(t.Ktt));break;case 4:i=t.Pnt()?n=-1:(n=t.Ktt.row,j(t.Ktt)),e=t.Znt,r=t.fet()-e+1}return w(n,e,i,r)},het:function(){var t=this.let();return-1!==t?this.Mf._y(this.Gnt).findRow(t):M},det:function(){return this.Mf._y(this.Ont).findRow(this.vet())},vet:function(){return this.Mf.getViewportBottomRow(this.Ont)},met:function(){var t=this.fet();return-1!==t?this.Mf.Yy(this.Vnt).findCol(t):M},pet:function(){return this.Mf.Yy(this.Rnt).findCol(this.bet())},bet:function(){return this.Mf.getViewportRightColumn(this.Rnt)},Wnt:function(){var t,n,e,i,r,o,a,u,r,i,s,c,f,l,o,a,l,f,o,a,s,c,f,o,a,s,f,a,c,h,t=this,n=t.znt(),e=t.Pnt(),i=d(t.Mf.Dg()).offset(),r=t.fk.e,o=t.fk.x,a=t.fk.y,u=r.pageX-i.left,r=r.pageY-i.top,i=!1;n||e?e?t.Znt>=t.Unt()&&t.Znt<=t.fet()?t.bO=4:t.Znt<t.Unt()?t.bO=0:t.Znt>t.fet()&&(t.bO=1):n&&(t.Ynt>=t.Lnt()&&t.Ynt<=t.let()?t.bO=5:t.Ynt<t.Lnt()?t.bO=2:t.Ynt>t.let()&&(t.bO=3)):t.Ynt>=t.Lnt()&&t.Ynt<=t.let()?t.Znt>=t.Unt()&&t.Znt<=t.fet()?(s=v(t.Znt-t.fet()))<(c=v(t.Ynt-t.let()))?t.bO=5:c<s?t.bO=4:a>(f=(f=t.het())||t.det()).y+f.height?t.bO=3:(o=(l=(l=t.met())||t.pet()).x+l.width-o,a=f.y+f.height-a,u>=l.x&&u<=l.x+l.width&&r>=f.y&&r<=f.y+f.height?t.bO=a<=o?4:5:i=!0):t.Znt<t.Unt()?t.bO=0:t.Znt>t.fet()&&(t.bO=1):t.Ynt<t.Lnt()?t.Znt>=t.Unt()&&t.Znt<=t.fet()?t.bO=2:t.Znt<t.Unt()?(s=v(t.Znt-t.Unt()),c=v(t.Ynt-t.Lnt()),t.bO=s<=c?2:0):t.Znt>t.fet()&&(s=v(t.Znt-t.fet()),c=v(t.Ynt-t.Lnt()),t.bO=s<=c?2:1):t.Ynt>t.let()&&(t.Znt>=t.Unt()&&t.Znt<=t.fet()?t.bO=3:t.Znt<t.Unt()?(s=v(t.Znt-t.Unt()),c=v(t.Ynt-t.let()),t.bO=s<=c?3:0):t.Znt>t.fet()&&(s=v(t.Znt-t.fet()),c=v(t.Ynt-t.let()),t.bO=s<=c?3:1)),(l=t.Mf.Dn.yet)&&(a=(f=t.let())+1,s=(o=t.fet())+1,c=t.Mf.getRowHeight(f,3),f=t.Mf.getColumnWidth(o,3),o=t.Mf.getRowHeight(a,3),a=t.Mf.getColumnWidth(s,3),s=l.x+l.width/2-T(10,f/2),f=l.x+l.width/2+T(10,a/2),a=l.y+l.height/2-T(10,c/2),c=l.y+l.height/2+T(10,o/2),h=!1,(h=n||e?e?s<=u&&u<=f:a<=r&&r<=c:s<=u&&u<=f&&a<=r&&r<=c)||i?(t.hO=!0,t.bO=4):t.hO=!1)},Lnt:function(){return this.Ktt?-1===this.Ktt.row?0:this.Ktt.row:-1},let:function(){var t=this;return t.Ktt?-1===t.Ktt.row?D(t.Mf)-1:t.Ktt.row+j(t.Ktt)-1:-1},Unt:function(){return this.Ktt?-1===this.Ktt.col?0:this.Ktt.col:-1},fet:function(){var t=this;return t.Ktt?-1===t.Ktt.col?_(t.Mf)-1:t.Ktt.col+E(t.Ktt)-1:-1},wet:function(t,n){var n,e,i,r,r,i,r,t,n=w(n.row,n.col,n.rowCount,n.colCount),e=this.Mf;return e.Ut.findSpan(t.row,t.col)&&(i=t.rowCount,r=n.rowCount,0!==Math.floor(r%i)&&(r=Math.ceil(r/i)*i,n.row+r<=e.getRowCount())&&(n.rowCount=r),i=t.colCount,r=n.colCount,0!==Math.floor(r%i))&&(t=Math.ceil(r/i)*i,n.col+t<=e.getColumnCount())&&(n.colCount=t),n},DD:function(){var t,n,e,i,r,o,a,u,t=this,n=t.Mf;t.Rk=M,t.l9(),t.iy(),t.Yk&&t.rb?(t.Yk=!1,t.rb=!1,(e=t.Knt())&&(!(i=t.Jnt(t.Ktt,t.Xnt))||t.hO?(t.Met(),t.Ax(e)):(r=n.rt.Ktt,o=t.wet(r,t.Xnt),a=t.net(),n.Qy().execute({cmd:"fill",sheetName:n.name(),startRange:r,fillRange:o,autoFillType:a,fillDirection:n.rt.eet()}),!(u=t.lnt)&&t.Cet()&&n.parent.options.showDragFillSmartTag&&4!==t.fnt?t.Tet(t.fnt):t.Ax(e),t.Met()))):t.Met()},Tet:function(t){var n,e,e,n=this.Mf,e=n.Dn.yet,e={x:e.x+e.width,y:e.y+e.height,fillType:t};n.R_=new i.Aet(n.parent.j2(),n,e),n.R_.rQ()},_nt:function(){var t,n,n,e,t=this.Mf,n=t.Ut.getSelections();1===n.length?(n=n[0],(e=t.Ut.getSpans(n))&&0<e.length&&(n=t.kR(e,n)),this.Ktt=n):0<=t.ui&&0<=t.ci&&(this.Ktt=w(t.ui,t.ci,1,1))},Met:function(){this.rb=!1,this.Yk=!1},Ax:function(t){this.Mf.Dn.E1(t)},net:function(t,n){var e,i,t,r,e=this,i=e.Mf,t=t!==S?t:i.parent.options.defaultDragFillType;return e.lO()?4:5!==t?t:(r=1===j(e.Ktt)&&1===E(e.Ktt)&&!e.Pnt()&&!e.znt())?e.a_&&!n?1:0:e.a_&&!n?0:1},Knt:function(){var t,n,e,i,r,t=this;return t.Ktt?t.lO()?t.Ktt:t.Xnt?(r=i=e=n=0,r=t.Iet()?(n=(2===t.bO?t.Xnt:t.Ktt).row,e=j(t.Ktt)+j(t.Xnt),i=t.Ktt.col,E(t.Ktt)):(n=t.Ktt.row,e=j(t.Ktt),i=(0===t.bO?t.Xnt:t.Ktt).col,E(t.Ktt)+E(t.Xnt)),w(n,i,e,r)):M:M},Jnt:function(t,n,e){var i,r,o,i=this.Mf,r=!0,o="";return i.Ut.eE(n.row,n.col,j(n),E(n))&&!U(i,t,n)&&(r=!1,o=x().Exp_FillRangeContainsMergedCell),r&&i.options.isProtected&&i.dA(n,!0,C.SheetArea.viewport)&&(r=!1,o=i.FT()),r||e||i.ki(C.Events.InvalidOperation,{sheet:i,sheetName:i.name(),invalidType:C.InvalidOperationType.dragFill,message:o,fillRange:n}),r},Cet:function(){return this.xet()||this.Net()},xet:function(){return 3===this.bO||1===this.bO},Net:function(){return 0===this.bO||2===this.bO},Iet:function(){return 2===this.bO||3===this.bO||5===this.bO},eet:function(){var t=this.bO;return 0<=t&&t<=3?t:4===t?0:5===t?2:3},VL:function(t,n,e){var i,r,o,t,a,u,s,a,o,i=this,r=M,o=N(t),t=k(t),a=i.Mf,u=a.parent;if(!c(o)&&!c(t)&&(u.options.allowUserDragDrop||u.options.allowUserDragFill)&&(-1!==(s=a.U5()).row||-1!==s.col)){if(0<=o&&0<=t&&1===a.Ut.getSelections().length){if(i.yD(o,t,n,e))return r;(r=(a=a.getRangeRect(o,t,s)).x-4<n&&n<a.x+4&&a.y<=e&&e<a.y+a.height?{action:f,side:"left"}:r)||(o=i.Mf.Dn.yet)&&o.x<=n&&n<=o.x+o.width&&o.y<=e&&e<=o.y+o.height&&(r={action:f,side:l}),r||a.x+a.width-4<n&&n<a.x+a.width+4&&a.y<=e&&e<a.y+a.height&&(r={action:f,side:"right"}),r||a.y-4<e&&e<a.y+4&&a.x<=n&&n<a.x+a.width&&(r={action:f,side:"top"}),r||a.y+a.height-4<e&&e<a.y+a.height+4&&a.x<=n&&n<a.x+a.width&&(r={action:f,side:"bottom"}),r&&(n<a.x||n>a.x+a.width||e<a.y||e>a.y+a.height)&&(r.outside=!0)}u&&u.options.allowUserDragDrop||r&&r.side!==l&&(r.side=M),u&&u.options.allowUserDragFill||r&&r.side===l&&(r.side=M)}return r},ket:function(t,n){var e,i,r,e=this,i,r=e.Mf.getSpan(t,n,3);return r?!c(e.Mf.getValue(r.row,r.col,3,0)):!c(e.Mf.getValue(t,n,3,0))},Det:function(t,n){var e,i,r,r,e,i,r=this.Mf.tables;return!(!r||0===r.all().length)&&(r=r.AB(t,n,1,1)[0])&&r.footerIndex()===t},_et:function(t,n,e,i){for(var r,o,r=this,o=n;o<n+i;o++)if(!r.ket(t,o)||r.Det(t,o))return!1;return!0},Eet:function(t,n,e,i){for(var r,o,r=this,o=n;o<n+i;o++)if(r.ket(t,o))return!1;return!0},jet:function(t,n,e,i){var r,o,a,u,s,c,f,l,h,r=this,o=r.Mf;if("left"===i){for(a=0;a<n;a++)r.ket(t,a)&&(e.searchArray[a]=!0);for(u=n-1,s=1;e.searchArray[u];)u--,s++;e.searchLength=s}if("right"===i){for(c=o.getColumnCount(),f=n;f<c;f++)r.ket(t,f)&&(e.searchArray[f-n]=!0);for(l=0,h=1;e.searchArray[l];)l++,h++;e.searchLength=h}return e},Oet:function(t,n,e,i,r){for(var o,a,u,s,c,f,l,h,d,v,o=this,a=o.Mf,u=0,s={searchArray:new Array(i),searchLength:1},c={searchArray:new Array(a.getColumnCount()-r),searchLength:1},f=n;f<e;f++)s=o.jet(f,t.col,s,"left"),c=o.jet(f,t.col+t.colCount-1,c,"right");for(;o.Eet(e+u,t.col,1,t.colCount);){for(h=!(l=!0),s=o.jet(e+u,i,s,"left"),c=o.jet(e+u,r,c,"right"),d=i-1;d>=i-s.searchLength;d--)if(o.ket(e+u,d)){u++,l=!1;break}if(l){for(v=r+1;v<=r+c.searchLength;v++)if(o.ket(e+u,v)){u++,h=!0;break}if(!h)return u}}return u},Ret:function(t){for(var n,e,n=this,e=0;n._et(t.row+t.rowCount+e,t.col,1,t.colCount);)e++;return e},Bet:function(t){var n,e,i,r,o,n=this;return n._et(t.row+t.rowCount,t.col,1,t.colCount)?n.Ret(t):(r=t.row-2,o=t.row+t.rowCount,i=1===t.colCount?e=t.col:(e=t.col,t.col+t.colCount-1),n.Oet(t,r,o,e,i))},H_:function(){var t,n,e,i,i,r,o,t=this,n=t.Mf,e=n.rt.Ktt,i=t.Bet(e);0!==i&&(i=w(e.row+e.rowCount,e.col,i,e.colCount),t.bO=3,t.Xnt=i,r=t.net(),o=t.lnt,n.Qy().execute({cmd:"fill",sheetName:n.name(),startRange:e,fillRange:i,autoFillType:r,fillDirection:t.bO}),!o)&&n.parent.options.showDragFillSmartTag&&4!==t.fnt&&t.Tet(t.fnt)}}),d.extend(C.g7.prototype,{Let:function(t,n){var e,i,r,o,t,a,e,u,s,n,e=this.Mf,i=t.x,r=t.y,o=R(t),t=O(t),a=e.U5(),e=e.Fi(),u=4,s=-2.5;return 2007<n&&(u=5,s=-3),n=new C.Rect(-4,-4,u,u),-1===a.col?(n.x=e.b6,n.y=r+t+s):-1===a.row?(n.x=i+o+s,n.y=e.T6):(n.x=i+o+s,n.y=r+t+s),n},yO:function(t,n,e,i,r){var o,a,u,s,s,i,c,f,l,h,u,n,e,o=this,a=o.Mf,u=a.Fi(),s=a.parent,s=s&&s.SC,i=o.Let(i,s),c=i.x,f=i.y,l=R(i),h=O(i),u=u.c9(n,e);r&&!i.intersectRect(r)||i.intersectRect(u)&&(n=-1.5,(e=new C.Rect(c+(n=2007<s?-1:n),f+n,l+2,h+2)).x=A(e.x,u.x),e.y=A(e.y,u.y),o.O1(e),t.save(),r&&!r.containsRect(i)&&(t.rect(r.x,r.y,R(r),O(r)),t.clip()),t.beginPath(),t.fillStyle=C.Pf.vl(a,a.getSelectionBorderColor()),t.fillRect(c,f,l,h),o.yet=new C.Rect(i.x,i.y,4,4),t.beginPath(),t.restore())},cet:function(t,n,e,i){var r=n.x,o=n.y,a=r+R(n),n=o+O(n);L(t,r-2,o,a+1,o,e,i),L(t,r-1,n,a+1,n,e,i),L(t,r,o-1,r,n+1,e,i),L(t,a,o-1,a,n+1,e,i)},Fet:function(t,n){var e,i,r,o,a,u,s,c,f,l,h,d,v,m,g,l,p,b,y,w,y,a,y,f,c,M,e=this,i=e.Mf,r=i.rt,o=r.q6,a=o.hitTarget;o&&a&&(u=o.hitCol,s=o.hitRow,c=o.row,f=o.col,l=r.i_,h=i.Pet,v=i.getSelectionBorderColor(),m=B(i),g=8,t.save(),!0===l?(l=i.Yy(0).findCol(u)||i.Yy(1).findCol(u)||i.Yy(2).findCol(u),p=i._y(0).findRow(s)||i._y(1).findRow(s)||i._y(2).findRow(s),-1===o.row&&-1!==o.col?l&&(b=l.x,y=R(l),o.col=u,a.x>b+y/2&&(o.col<i.rD()||o.col===i.G6())&&(b=l.x+R(l),o.col++),(h=h&&0===R(h)?h:r.q6)&&(d=new C.Rect(h.x-8,h.y-8,R(h)+16,O(h)+16),e.O1(d,n),e.E1(i.U5(),n)),i.Uet=new C.Rect(b,o.y,0,O(o)),t.rect(n.x,n.y,R(n),O(n)),t.clip(),t.beginPath(),L(t,b-8,o.y,b+8,o.y,v,m),L(t,b,o.y,b,o.y+O(o),v,m),L(t,b-8,o.y+O(o),b+8,o.y+O(o),v,m)):-1!==o.row&&-1===o.col?p&&(w=p.y,y=O(p),o.row=s,a.y>w+y/2&&(o.row<i.iD()||o.row===i.P6())&&(w=p.y+O(p),o.row++),(h=h&&0===O(h)?h:r.q6)&&(d=new C.Rect(h.x-8,h.y-8,R(h)+16,O(h)+16),e.O1(d,n),e.E1(i.U5(),n)),i.Uet=new C.Rect(o.x,w,R(o),0),t.rect(n.x,n.y,R(n),O(n)),t.clip(),t.beginPath(),L(t,o.x,w-8,o.x,w+8,v,m),L(t,o.x,w,o.x+R(o),w,v,m),L(t,o.x+R(o),w-8,o.x+R(o),w+8,v,m)):-1!==o.row&&-1!==o.col&&(a=i.Yy(0).findCol(f)||i.Yy(1).findCol(f)||i.Yy(2).findCol(f),y=i._y(0).findRow(c)||i._y(1).findRow(c)||i._y(2).findRow(c),p)&&l&&y&&a&&(b=a.x,w=y.y,h&&(d=new C.Rect(h.x-8,h.y-8,R(h)+16,O(h)+16),e.O1(d,n),e.E1(i.U5(),n)),f=!1,c=i.getCellRect(s,u),(f=!r.Cnt&&c?(M=o.hitTarget.x-c.x)<T(16,i.nn(u)/4):f)?b=l.x:w=p.y,i.Uet=new C.Rect(b,w,R(o),O(o)),i.U5().contains(s,u)||(t.rect(n.x,n.y,R(n),O(n)),t.clip(),t.beginPath(),f?(L(t,b-8,w,b+8,w,v,m),L(t,b,w,b,w+O(o),v,m),L(t,b-8,w+O(o),b+8,w+O(o),v,m),r.Dnt=!0):(L(t,b,w-8,b,w+8,v,m),L(t,b,w,b+R(o),w,v,m),L(t,b+R(o),w-8,b+R(o),w+8,v,m),r.Dnt=!1)))):(h&&(d=new C.Rect(h.x-8,h.y-8,R(h)+16,O(h)+16),e.O1(d,n),e.E1(i.U5(),n)),t.rect(n.x,n.y,R(n),O(n)),t.clip(),t.beginPath(),e.cet(t,o,v,m)),t.beginPath(),t.restore())},o_:function(){var t,n,e,i,e,r,o,a,u,s,c,f,l,u,c,t=this,n=t.Mf,e=n.sw,i=n.rt.xnt;e&&e.dragInfo&&i&&(e=t.J(),r=n.Fi(),o=n.rt.q6,a=n.j1(i),u=n.frozenTrailingColumnCount(),s=n.frozenTrailingRowCount(),c=n.getColumnCount()-u,f=n.getRowCount()-s,l=r.c9(1,1),0<u&&i.col+i.colCount<=c&&a.x+R(a)>l.x+R(l)&&a.intersectRect(l)&&(a=a.getIntersectRect(l)),0<s&&i.row+i.rowCount<=f&&a.y+O(a)>l.y+O(l)&&a.intersectRect(l)&&(a=a.getIntersectRect(l)),u=new C.Rect(r.b6,r.T6,r.Hy+r.zy,r.Ay+r.Iy),0<=R(a)&&0<=O(a)&&(o.x=a.x,o.y=a.y,o.width=R(a),o.height=O(a),t.Fet(e,u)),c=n.rt.i_,n.Pet=!0===c?n.Uet:new C.Rect(o.x,o.y,R(o),O(o)))}})},"./dist/plugins/fill/fill-ui.js":function(B,t,n){"use strict";var e,L,a,n,u,s,i,c,f,r,o,l,h,d,v,m,g,p,b,y,w,M,F,P,C,S,T,A,I,x,N,k,G,r,D,U,H,z,_,E;function j(t,n,e,i,r,o){var t=t.Oi,a=t?"160px":"150px",t=t?"25px":"20px",a=u(s("div")).css([M,P,C,"padding",S],["block",a,t,0,0]).addClass("gc-smartMenu-item-default "+e+" ui-state-default"+f),t=u(s("div")).addClass(m).appendTo(a),e=u(s("div")).addClass("gc-menu-item-text").appendTo(a),n=u(s("input")).attr({id:n,value:r,type:"radio",name:"fill-group",style:"display:none"}).appendTo(t);return u(s("span")).text(i).appendTo(e),o?(t.addClass(v),n.prop("checked","checked")):n.prop("checked",""),a}function O(t,n){var t,e,t=_.call(this,t,i(n.parent.Ti))||this;return t.Mf=n,t.Het=u("."+p),(e=t.g$=t.Xc()).addClass(l),j(n,"smartMenuCopyCells",o,D().CopyCells,"0",!0).appendTo(e),j(n,"smartMenuFillSeries",o,D().FillSeries,"1").appendTo(e),n.NMi||(j(n,"smartMenuFillFormattingOnly",o,D().FillFormattingOnly,"2").appendTo(e),j(n,"smartMenuFillWithoutFormatting",o,D().FillWithoutFormatting,"3").appendTo(e)),t}function R(t,n,e){var t,n,t=E.call(this,t,i(n.parent.Ti))||this;return t.Mf=n,t.zet=e,n=t.Vet=t.Xc().addClass("gc-smart-tag-default "+p+" gc-no-user-select ui-widget-header"+f),t.Yet=u(s("div")).attr("class","fillSmartTag").css(b,y).appendTo(n),t.Zet=u(s("div")).attr("class","fillSmartTagDown").css([b,M],[y,"none"]).appendTo(n),t}e=this&&this.__extends||(z=function(t,n){return(z=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(t,n){t.__proto__=n}:function(t,n){for(var e in n)Object.prototype.hasOwnProperty.call(n,e)&&(t[e]=n[e])}))(t,n)},function(t,n){if("function"!=typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function e(){this.constructor=t}z(t,n),t.prototype=null===n?Object.create(n):(e.prototype=n.prototype,new e)}),Object.defineProperty(t,"__esModule",{value:!0}),t.Aet=void 0,L=n("Common"),a=n("Core"),n=n("./dist/plugins/fill/fill.ns.js"),u=a.GC$,s=a.mt.En,i=a.mt.gi,c=u(document),f=" btn btn-default",o="gc-fill-type-item",l="gc-fill-menu-container",h=(r="ui-state-hover ")+"gc-smartMenu-item-hover",d=r+"gc-smart-tag-hover",v="ui-icon ui-icon-check gc-check-image",m="gc-menu-item-input",g="ui-state-active gc-smart-tag-active",p="gc-tag-container",b="float",y="left",w="top",M="display",F="width",P="min-width",C="height",S="margin",T="change",A="input[type=radio]",I="mouseover",x="mouseout",N="click",k="fillTypeChanged",G="keydown.ui-fill",r=new L.Common.ResourceManager(n.SR,"Fill"),D=r.getResource.bind(r),_=a.zc,e(O,_),O.prototype.$c=function(){_.prototype.$c.call(this)},O.prototype.aY=function(){var r,t,n,r=this,t;u("."+o).bind(I,function(){u(this).addClass(h)}).bind(x,function(){u(this).removeClass(h)}).bind(N,function(){var t,n,e,i,e,t=u(this),n=r.Het,e=t.find(A),i=e[0];i.checked=!0,e.trigger(T),n.trigger(N),n.trigger(x),t.removeClass(h),e=parseInt(u(i).attr("value"),10),r.Wet(e)}),(n=r.g$.find(A)).bind(T,function(){u("."+m).removeClass(v),u(this).parent().addClass(v)})},O.prototype.Qet=function(){u("."+o).unbind(I).unbind(x).unbind(N),this.g$.find(A).unbind(T)},O.prototype.Wet=function(t){var n=this,e=n.Mf,i=e.rt;if(n.Ket!==t){n.Ket=t,e.cnt=!0,e.suspendEvent();try{a.Commands.undo.execute(e.parent,{sheetName:e.name()})}finally{e.resumeEvent()}e.cnt=!1,e.Qy().execute({cmd:"fill",sheetName:e.name(),startRange:i.Ktt,fillRange:i.Xnt,autoFillType:t,fillDirection:i.bO}),n.Het.trigger(k,t)}},O.prototype.Jet=function(){return!!u("."+l).length},U=O,E=a.zc,e(R,E),R.prototype.Xet=function(t,n,e){var i=this,r=i.Mf.Oi,n=u(n),o=i.qet,i=i.Zet,a=r?"38px":"32px",r=r?"24px":"18px";o&&o.Jet()||(t?n.addClass(d):n.removeClass(d),n.css([F,C],[t?a:r,r]),e)||(t?i.show():i.hide())},R.prototype.$et=function(){var r=this,t=r.Vet,n=a.mt.pi(),o=a.mt.Tt.safari&&(n.ipad||n.iphone);t.bind(I,function(){r.Xet(!0,this,o)}).bind(x,function(){r.Xet(!1,this,o)}),t.bind(N,function(){var t,n,e,i,n,e,t=u(this),n=r.qet,e=r.Zet,i;n&&n.Jet()?(o&&e.hide(),t.removeClass(g),r.tit()):(o&&e.show(),t.addClass(g),r.nit(),(e=(n=r.g$)&&n.find(A)[r.zet.fillType])&&!e.checked&&(e.checked=!0,u(e).trigger(T)))}),c.bind(G,function(t){27===t.keyCode&&(r.qet&&r.qet.Jet()?r.tit():r.close(),a.mt.vi(t))})},R.prototype.rQ=function(){var t=this,n=t.Vet,e=t.zet,i=t.Mf.Oi,r=i?"3px":"0px",i=i?"24px":"18px";n&&(n.css([y,w],[e.x,e.y]),t.$c(),t.$et(),t.Yet.css(S,r),t.Zet.css(C,i),t.c5())},R.prototype.nit=function(){var t,n,n,e,i,i,r,o,a,t=this,n=t.Mf;t.qet||(t.qet=new U(n.parent.j2(),n),t.g$=t.qet.Xc()),e=(n=t.Vet).css(y),i=n.css(w),i=parseFloat(i),o=t.qet,a=t.zet,o.Ket=a.fillType,isNaN(i)||(r=i+n.height()+2),t.g$.css([y,w],[e,r]),o.$c(),o.aY(),o.Het.unbind(k).bind(k,function(t,n){a.fillType=n})},R.prototype.tit=function(){var t=this.qet;t&&(t.Qet(),t.close())},R.prototype.c5=function(){var t=this,n=t.qet,t=t.Vet;n&&(n.Jet()&&t.trigger(N),t.trigger(x))},R.prototype.close=function(){var t,n,t,t=this,n=t.Mf;t.c5(),c.unbind(G),E.prototype.close.call(this),(t=n.fg)&&(t.style.cursor="default"),n&&n.Zg()},R.prototype.lf=function(t){var n;return!(!this.Wc||!E.prototype.hf.call(this,this.Wc.get(0),t))||this.g$&&E.prototype.hf.call(this,this.g$.get(0),t)},t.Aet=R},"./dist/plugins/fill/fill.entry.js":function(t,n,e){"use strict";var i,r,i=this&&this.__createBinding||(Object.create?function(t,n,e,i){void 0===i&&(i=e);var r=Object.getOwnPropertyDescriptor(n,e);r&&("get"in r?n.__esModule:!r.writable&&!r.configurable)||(r={enumerable:!0,get:function(){return n[e]}}),Object.defineProperty(t,i,r)}:function(t,n,e,i){t[i=void 0===i?e:i]=n[e]}),r=this&&this.__exportStar||function(t,n){for(var e in t)"default"===e||Object.prototype.hasOwnProperty.call(n,e)||i(n,t,e)};Object.defineProperty(n,"__esModule",{value:!0}),e("./dist/plugins/fill/drag-fill.js"),e("./dist/plugins/fill/fill-event.js"),r(e("./dist/plugins/fill/fill-ui.js"),n),r(e("./dist/plugins/fill/fill.js"),n),r(e("./dist/plugins/fill/fill.ns.js"),n)},"./dist/plugins/fill/fill.js":function(D,t,n){"use strict";var e,r,i,o,_,n,E,a,q,w,M,C,$,j,i,O,N,i,R,B,tt,nt,et,L,i,k,F,P,G,U,H,z,rt,V,Y,i,n,Z,W,Q,n,J,K,X,ot,at,ut,st,ct,ft,lt,ht,dt,n,i,n,i,n,vt,mt,gt,pt,bt,yt,wt,Mt,Ct,u,s,St,Tt;function it(t){return!At(t)&&a.q8(t)}function At(t){return"string"==typeof t}function It(t,n){return-1!==t.lastIndexOf(n)}function xt(t){var n=[t];return n.rowCount=1,n.colCount=N(t),n}function Nt(t){return t}function kt(t,n,e,i){var n=xt(n),e=xt(e),i=xt([i]),t=t?r.Common.eit(n,e,i,!0,Nt,q,q,q):r.Common.iit(n,e,i,!0,q,q,q),n=t&&t[0][0];return typeof n===tt?r.Common.st.E8(n,13):n}function Dt(t){return t.toLowerCase()}function c(t){this.rit=[],this.oit=[],this.ait=[],this.uit=q,this.sit=[],this.cit=q,this.lit=$(t)?-1:t}function f(t){this.hit=-1,this.dit=[],this.MV=-1,this.Mf=t}function _t(){this.vit="",this.mit="",this.MV=0,this.git=1,this._padding=""}function l(t){var n,e,i,r,n=t.length,e=1;if(1<n)for(e=t[1]-t[0],r=2;r<n;r++)if(e!==(i=t[r]-t[r-1])){e=0;break}return e}function h(t,n){return 0<t?(t-1)%n:n-Math.abs(t)%n-1}function d(t){for(var n="",e=0;e<t;)n+="0",e++;return n}function v(t,n){return 12*(n.getFullYear()-t.getFullYear())+(n.getMonth()-t.getMonth())}function Et(t){return t.every(function(t){var n;return 1===t.getDate()})}function jt(t){return t.every(function(t){var n,e,i,r,n=t.getFullYear(),e=t.getMonth(),i,r;return t.getDate()===new Date(n,e+1,0).getDate()})}function Ot(t){var n,e,n=0,e;return t.every(function(t){var t=t.getDate();return(n=n||t)===t})?n:0}function Rt(t,n){for(var e,i,r,o,e=t.length,i=!0,o=2;o<e&&(i=n===(r=v(t[o-1],t[o])));o++);return i}function Bt(t){return t.every(function(t){var n=t.getHours(),e=t.getMinutes(),t=t.getSeconds();return 0!==n||0!==e||0!==t})}function Lt(t,n){return new Date(t,n+1,0).getDate()}function m(t){return"0"===t[0]}function Ft(n,t,e){var i,r,o,r,o,a,u,a=e?1:2,u=e?2:1;return t.every(function(t){return!!(i=t.match(n.pit))&&(r=i[a],(o=r.length)>n.yit&&m(r)&&(n.yit=o),o=parseInt(r,10),r=i[u],$(n.cit)&&(n.cit=r),r!==n.cit?(n.wit=!0,n.cit=q,n.sit=[]):n.sit.push(o),!0)})}function g(){}function Pt(){var t=null!==vt&&vt.apply(this,arguments)||this;return t.Mit=0,t.uit=nt,t}function p(){return null!==mt&&mt.apply(this,arguments)||this}function b(){return null!==gt&&gt.apply(this,arguments)||this}function y(){return null!==pt&&pt.apply(this,arguments)||this}function S(){var t=bt.call(this)||this;return t.pit=q,t.sit=[],t.cit=q,t.wit=!1,t.yit=0,t.uit=et,t.Cit=!1,t.Sit=!1,t.Tit=new Y,t}function T(t){var n=yt.call(this)||this;return n.Ait=new V(t),n}function A(){var t=null!==wt&&wt.apply(this,arguments)||this;return t.pit=/^\d+$/,t}function Gt(){var t=null!==Mt&&Mt.apply(this,arguments)||this;return t.pit=/^(.*\D+)(\d+)$/,t}function Ut(){var t=null!==Ct&&Ct.apply(this,arguments)||this;return t.pit=/^(\d+)(\D+.*)$/,t}function I(){var t=null!==u&&u.apply(this,arguments)||this;return t.pit=/^(.*\D+)(\d+)(\D+.*)$/,t}function Ht(){return null!==s&&s.apply(this,arguments)||this}function zt(){return null!==St&&St.apply(this,arguments)||this}function Vt(){var t=null!==Tt&&Tt.apply(this,arguments)||this;return t.Cit=!0,t}function Yt(t){var n,e,e,t,i,r,o,n=this;n.Iit=[new Z,new W,new Q],n.xit=new ct,n.Nit=new ft,e=F.culture(),e=F.Fe(e).isJCKCulture,t=new J(t),i=new K,r=new X,o=new ot,n.kit=e?[t,i,new st,r,o,new at]:[t,i,r,o]}function Zt(t){t.forEach(function(t){t&&t.dispose()})}function x(t){this.Mf=t,this.Dit=!1,this._it=[]}e=this&&this.__extends||(dt=function(t,n){return(dt=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(t,n){t.__proto__=n}:function(t,n){for(var e in n)Object.prototype.hasOwnProperty.call(n,e)&&(t[e]=n[e])}))(t,n)},function(t,n){if("function"!=typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function e(){this.constructor=t}dt(t,n),t.prototype=null===n?Object.create(n):(e.prototype=n.prototype,new e)}),Object.defineProperty(t,"__esModule",{value:!0}),t.Wtt=t.nnt=t.FillDateUnit=t.FillType=t.FillSeries=t.FillDirection=t.AutoFillType=void 0,r=n("Common"),i=n("Core"),o=n("CalcEngine"),_=n("SheetsCalc"),n=n("./dist/plugins/fill/fill.ns.js"),E=!!o,a=r.Common.lt,q=null,w=void 0,M=Math.floor,C=i.Ec,$=a.ht,j=a.uJ,i=r.Common.Uf,O=i.Eit,N=i.tR,i=r.Common.ct,R=i.o0,B=i.Y0,tt="number",nt="date",et="string",L="default",i=new r.Common.ResourceManager(n.SR,"Fill"),k=i.getResource.bind(i),F=r.Common.CultureManager,(n=P=t.AutoFillType||(t.AutoFillType={}))[n.copyCells=0]="copyCells",n[n.fillSeries=1]="fillSeries",n[n.fillFormattingOnly=2]="fillFormattingOnly",n[n.fillWithoutFormatting=3]="fillWithoutFormatting",n[n.clearValues=4]="clearValues",n[n.auto=5]="auto",(i=G=t.FillDirection||(t.FillDirection={}))[i.left=0]="left",i[i.right=1]="right",i[i.up=2]="up",i[i.down=3]="down",(n=U=t.FillSeries||(t.FillSeries={}))[n.column=0]="column",n[n.row=1]="row",(i=H=t.FillType||(t.FillType={}))[i.direction=0]="direction",i[i.linear=1]="linear",i[i.growth=2]="growth",i[i.date=3]="date",i[i.auto=4]="auto",(n=z=t.FillDateUnit||(t.FillDateUnit={}))[n.day=0]="day",n[n.weekday=1]="weekday",n[n.month=2]="month",n[n.year=3]="year",c.prototype.jit=function(){return N(this.rit)},c.prototype.Oit=function(){for(var t=this,n=[],e=t.oit,i,r,i=0;i<N(e);i++)r=e[i],n.push("object"===t.uit?t.r0(r):r);return n},c.prototype.Rit=function(){var t,n,e,i,r,t=this,n=t.rit;if(0<N(n)){for(i=[],r=void 0,-1===(e=t.lit)&&(e=n[0]),r=0;r<N(n);r++)i[r]=n[r]-e+1;return i}return q},c.prototype.Bit=function(){var t=this.oit;return N(t)?t:q},c.prototype.Eit=function(t,n,e){if(!it(e))throw new Error(k().Exp_NumberOnly);var i=this;$(i.uit)&&(i.uit=e instanceof Date?nt:tt),O(i.rit,t,n),O(i.oit,t,j(e))},c.prototype.ZP=function(t,n){var e=this,i=$(e.uit);it(n)?(i&&(n instanceof Date?e.uit=nt:e.uit=tt),e.oit.push(j(n))):i&&(e.uit=At(n)?et:L),e.rit.push(t),e.ait.push(n)},c.prototype.Lit=function(t){return this.uit===nt?this.r0(t):t},c.prototype.r0=function(n){var e=q;if(n instanceof Date)e=n;else if(o)try{e=o.Convert.r0(n)}catch(t){e=n}return e},rt=c,f.prototype.L0=function(){this.Mf=q},f.prototype.Fit=function(){var t=this.Mf;return t.parent&&t.parent.Ow()||[]},f.prototype.Pit=function(t){var n,e,i,r,o,a,u,s,c,f,l,h,d,v,m,g,n=t.length,e=!1;if(t&&0<n)for(i=Dt(t[0]),r=this.Fit(),f=c=s=u=a=o=void 0,o=0;o<r.length;o++)if(0<=(s=(u=(a=r[o]).map(Dt)).indexOf(i))){for(c=s,l=u.length,v=d=h=void 0,m=1;m<n;m++){if(d=Dt(t[m]),!(0<=(h=u.indexOf(d)))){e=!1;break}if(v=h-c+l,f){if(f!==v){e=!1;break}}else e=!0,f=v,c=h}if(g=1===n,e||g){e=!0,this.hit=s,this.dit=a,this.MV=g?1:f;break}}return e},f.prototype.Sl=function(t){var n=this.dit,e=this.hit,i=this.MV,r=n.length,o,a,a;return n[(e+i*h(t,r))%r]},V=f,_t.prototype.Sl=function(t){var t=this.MV*(t-1)+this.git,n=this._padding.length,t=""+Math.abs(t),e,i=this._padding+t,r=i.length,t=n<t.length?t:i.substr(r-n);return this.vit+t+this.mit},Y=_t,g.prototype.match=function(t){return!1},g.prototype.getTargetValue=function(t,n,e,i,r){},g.prototype.resetProp=function(){},g.prototype.Git=function(t,n){return t.indexOf(n+1)},g.prototype.dispose=function(){},e(Pt,vt=i=g),e(p,mt=n=Pt),p.prototype.match=function(t){var n,e,i,r,n=this.Mit=v(t[0],t[1]),e=Et(t),i=t.length,r=!0;return e&&2<i&&(r=Rt(t,n)),e&&r},p.prototype.getTargetValue=function(t,n){var e,t=t.ait[0],i=t.getFullYear(),r,o,a,t=t.getMonth()+this.Mit*(n-1);return new Date(i+parseInt(t/12,10),t%12,1)},Z=p,e(b,gt=n),b.prototype.match=function(t){var n,e,i,r,n=this.Mit=v(t[0],t[1]),e=jt(t),i=t.length,r=!0;return e&&2<i&&(r=Rt(t,n)),e&&r},b.prototype.getTargetValue=function(t,n){var e,t=t.ait[0],i=t.getFullYear(),r,o,a,t=t.getMonth()+this.Mit*(n-1),n=i+parseInt(t/12,10),i=t%12;return new Date(n,i,Lt(n,i))},W=b,e(y,pt=n),y.prototype.match=function(t){var n,e,i,r,o,a,n=!1;return Bt(t)||(e=this.Mit=v(t[0],t[1]),r=0<(i=Ot(t)),o=t.length,a=!0,this.Uit=i,r&&2<o&&(a=Rt(t,e)),n=r&&a),n},y.prototype.getTargetValue=function(t,n){var e,t=t.ait[0],i=t.getFullYear(),r,o,a,t=t.getMonth()+this.Mit*(n-1),n=i+parseInt(t/12,10),u;return new Date(n,t%12,this.Uit)},Q=y,e(S,bt=i),S.prototype.resetProp=function(){this.sit=[],this.yit=0,this.cit=q,this.wit=!1,this.Cit=!1,this.Sit=!1},S.prototype.getInternal=function(t){for(var n,e,i,r,n=!1,e=t[0],r=1;r<t.length;r++)if(i=t[r],1!==Math.abs(i-e)){n=!0;break}return n},e(T,yt=n=S),T.prototype.dispose=function(){var t=this;t.Ait&&(t.Ait.L0(),t.Ait=q)},T.prototype.match=function(t){return this.Ait.Pit(t)},T.prototype.getTargetValue=function(t,n,e,i,r){var o,t=t.ait.length,e=this.Git(e,i),i=q,a;return i=-1!==e?this.Ait.Sl(a=t*r+e+1):i},J=T,e(A,wt=n),A.prototype.match=function(t){var n=this,e,i,i;return t.every(function(t){return!!(e=t.match(n.pit))&&((i=t.length)>n.yit&&m(t)&&(n.yit=i),i=parseInt(t,10),n.sit.push(i),!0)})},A.prototype.getTargetValue=function(t,n,e,i,r){var o=t.ait,a=this.Tit,u=l(this.sit),o=o.length,s=0!==u,n=s?0:h(n,o),e=this.Git(e,i),i=q,c;return this.Cit=s,this.Sit=this.getInternal(t.rit),-1!==e&&(a.MV=u,a.git=this.sit[n],a._padding=d(this.yit),i=a.Sl(c=o*r+e+1)),i},K=A,e(Gt,Mt=n),Gt.prototype.match=function(t){return Ft(this,t,!1)},Gt.prototype.getTargetValue=function(t,n,e,i,r){var o=t.ait,a=this.Tit,u=l(this.sit),o=o.length,s=0!==u,n=s?0:h(n,o),e=this.Git(e,i),i=q,c;return this.Cit=s,this.Sit=this.getInternal(t.rit),-1!==e&&(a.vit=this.cit,a.MV=u,a.git=this.sit[n],a._padding=d(this.yit),i=a.Sl(c=o*r+e+1)),i},X=Gt,e(Ut,Ct=n),Ut.prototype.match=function(t){return Ft(this,t,!0)},Ut.prototype.getTargetValue=function(t,n,e,i,r){var o=t.ait,a=this.Tit,u=l(this.sit),o=o.length,s=0!==u,n=s?0:h(n,o),e=this.Git(e,i),i=q,c;return this.Cit=s,this.Sit=this.getInternal(t.rit),-1!==e&&(a.mit=this.cit,a.MV=u,a.git=this.sit[n],a._padding=d(this.yit),i=a.Sl(c=o*r+e+1)),i},ot=Ut,e(I,u=n),I.prototype.resetProp=function(){u.prototype.resetProp.call(this),this.Hit=q},I.prototype.match=function(t){var n,e,i,e,n,i,r,r=this;return t.every(function(t){return!!(n=t.match(r.pit))&&(e=n[2],(i=e.length)>r.yit&&m(e)&&(r.yit=i),i=parseInt(e,10),e=n[1],$(r.cit)&&(r.cit=e),n=n[3],$(r.Hit)&&(r.Hit=n),e!==r.cit||n!==r.Hit?(r.wit=!0,r.cit=q,r.Hit=q,r.sit=[]):r.sit.push(i),!0)})},I.prototype.getTargetValue=function(t,n,e,i,r){var o=this,a=t.ait,u=o.Tit,s=l(o.sit),a=a.length,c=0!==s,n=c?0:h(n,a),e=o.Git(e,i),i=q,f;return o.Cit=c,o.Sit=o.getInternal(t.rit),-1!==e&&(u.vit=o.cit,u.mit=o.Hit,u.MV=s,u.git=o.sit[n],u._padding=d(o.yit),i=u.Sl(f=a*r+e+1)),i},ut=["-","_",":",".",","],e(Ht,s=at=I),Ht.prototype.resetProp=function(){s.prototype.resetProp.call(this),this.zit=q},Ht.prototype.match=function(t){var i,r,o,i,r,o,a,u,a=this;return t.every(function(n){var t,t,t,e,t=a.zit;if(u=$(t)?ut.some(function(t){if(It(n,t))return a.zit=t,!0}):It(n,t)){if(t=a.zit,t=n.lastIndexOf(t),i=n.substring(0,t+1),$(a.cit))a.cit=i;else if(a.cit!==i)return!1;if(t=n.substr(t+1),i=t.match(e=/^(\d+)(\D+.*)$/))return r=i[1],(o=r.length)>a.yit&&m(r)&&(a.yit=o),o=parseInt(r,10),r=i[2],$(a.Hit)&&(a.Hit=r),r!==a.Hit?(a.cit=q,a.Hit=q,!(a.sit=[])):(a.sit.push(o),!0)}return!1})},st=Ht,e(zt,St=i),zt.prototype.getTargetValue=function(t,n,e){return kt(!0,t.Bit(),e,n)},ct=zt,e(Vt,Tt=i),Vt.prototype.getTargetValue=function(t,n,e,i){var t=t.ait,r,o;return t[h(n,t.length)]},ft=Vt,Yt.prototype.getRule=function(t,n){var e,i,r,o,a,e=[],i=this.Nit;for(t===nt?(e=this.Iit,i=this.xit):t===et?e=this.kit:t===tt&&(i=this.xit),r=0;r<e.length;r++)if(a=void 0,(o=e[r]).resetProp(),o.match(n)){if(a=o.wit,$(a)||!1===a)return o;if(!0===a)return i}return i},Yt.prototype.L0=function(){var t=this;t.Iit&&(Zt(t.Iit),t.Iit=q),t.kit&&(Zt(t.kit),t.kit=q),t.xit&&(t.xit.dispose(),t.xit=q),t.Nit&&(t.Nit.dispose(),t.Nit=q)},t.nnt=Yt,x.prototype.qtt=function(t,n,e,i,r){var o=this,t=t?1:2;$(i)&&$(r)?o.$tt(n,e,t):o.$tt(n,e,t,i,r,q)},x.prototype.$tt=function(t,n,e,i,r,o){var a,u,t,s,c,f,l,h,d,v,m,g,p,b,y,w,M,C,S,t,T,A,g,I,x,a=this,u=a.Mf,t=u.JS(t),s=t.row,c=t.col,f=t.rowCount,l=t.colCount;if(u.Ut.eE(s,c,f,l))throw new Error(k().Exp_RangeContainsMergedCell);for(b=0,w=(y=1===n)?l:f,C=y?s+f:c+l,S=(p=3<arguments.length)?1:w,T=(t=this.Mf.rt.Ktt).row===s&&t.rowCount===f&&t.col>c||t.col===c&&t.colCount===l&&t.row>s,h=M=y?s:c;h<C;h++)if(g=T&&p?s+f-1:s,(I=y?a.Vit(h,A=T&&p?c+l-1:c,1,S,n):a.Vit(g,h,S,1,n))&&I.jit())for(m=I.rit[0],p?(g=T?I.oit[N(I.oit)-1]:I.oit[0],d=a.Yit(T,g,w,e,i,r,o),T&&(b=w-N(d),m=I.rit[N(I.rit)-1])):d=a.Zit(I,w,e),v=0;v<N(d);v++)x=I.Lit(d[v]),y?a.Wit(u,h,m,h,c+b+v,x,e):a.Wit(u,m,h,s+b+v,h,x,e)},x.prototype.Vit=function(t,n,e,i,r){for(var o=q,a=this.Mf,u,s=1===r,c=s?n+i-1:t+e-1,f=s?n:t;f<=c;)it(u=s?a.getValue(t,c):a.getValue(c,n))&&(o=o||new rt(f)).Eit(0,c,u),c--;return o},x.prototype.Yit=function(t,n,e,i,r,o,a){for(var u,s,c,f,l,h,d,u=[],s=n,f=0<=r,l=$(o),c=0;c<e;c++)h=o<=s,d=s<=o,t&&(l||f&&h||!f&&d)?(u.unshift(s),1===i?s-=r:2===i?s/=r:3!==i||$(a)||(s=this.Qit(!0,a,n,s,r,c+1))):!t&&(l||f&&d||!f&&h)&&(u.push(s),1===i?s+=r:2===i?s*=r:3!==i||$(a)||(s=this.Qit(!1,a,n,s,r,c+1)));return u},x.prototype.Zit=function(t,n,e){var i=[],r,o=1===e;if(o||2===e){for(1===t.jit()&&t.ZP(t.rit[0]+1,o?t.Lit(t.oit[0]+1):t.Oit()[0]),r=0;r<n;r++)i.push(kt(!!o,t.Bit(),t.Rit(),r+1));return i}return q},x.prototype.Jtt=function(t,n,e,i,r,o){var a,u,s,t,c,f,l,t,u,h,d,s,a=this,u=a.Mf,s=u.Ut,t=u.JS(t),c=t.row,f=t.col,l=t.rowCount,t=t.colCount,u=u.JS(u.rt.Ktt),h=u.row,d=u.col;if(s.GT(h,d,u.rowCount,u.colCount)||s.GT(c,f,l,t))throw new Error(k().Exp_ChangeMergedCell);return s=a.Kit(u,l,t,n,e,!(c<h||f<d),i,r,o),a.Jit&&a.Jit.IB&&(a.Jit.IB.reFilter(),delete a.Jit),s},x.prototype.Kit=function(t,n,e,i,r,o,a,u,s){var c=this,f=o?1:-1,l,h,d,v,m=t.row,g=t.col,p=t.rowCount,b=t.colCount;if(1===i){if(l=M(e/b),h=e%b,!r)for(v=1;v<l;v++)d=C(m,g+v*f*b,p,b),c.Xit(t,d,i,4,r,o,w,w,w,a,u);if(r&&1<l&&0===h&&(l-=1,h=b),0<l&&0<h)return d=C(m,o?g+l*b:g-l*b+b-h,p,h),c.Xit(t,d,i,4,r,o,q,o?0:b-h,w,a,u)}else{if(l=M(n/p),h=n%p,c.Dit||(d=C(m+f*p,g,n-p,e),c.qit(t,d,f,s)),!r)for(v=1;v<l;v++)d=C(m+v*f*p,g,p,b),c.Xit(t,d,i,4,r,o,q,q,!0,a,u);if(r&&1<l&&0===h&&(l-=1,h=p),0<l&&0<h)return d=C(o?m+l*p:m-l*p+p-h,g,h,b),c.Xit(t,d,i,4,r,o,o?0:p-h,q,!0,a,u)}},x.prototype.Xit=function(t,n,B,e,i,r,L,F,P,o,a){for(var u,s,c,f,l,h,d,v,G,U,H,m,z,V,Y,g,p,b,y,w,M,C,S,T,A,I,x,N,k,Z,D,f,l,_,E,W,Q,J,j,K,X,O,R,u=this,s=u.Mf,c=1===B,G=c?t.row:t.col,U=c?t.col:t.row,H=c?n.row:n.col,m=c?n.col:n.row,z=c?t.rowCount:t.colCount,V=c?t.colCount:t.rowCount,Y=c?n.colCount:n.rowCount,d=0;d<z;d++){for(b=0,M=y=G+d,C=w=H+d,S=(c?F:L)||0,T=c?0:S,A=c?q:P,I=p=g=q;b<V;)if(k=q,Z=x=U+b,D=N=m+b-S,c||(y=x,x=M,w=N,N=C),h=s.Ut.findSpan(y,x),(f=s.getFormula&&s.getFormula(y,x))&&""!==f||(k=s.getValue(y,x)),(f=u.Dit)&&$(I)&&(I=!1===r?s.getValue(U+V-1,x):s.getValue(y,x)),f||4!==e||!it(k)&&!At(k)||(g=g||new rt,l=it(k)?k instanceof Date?nt:tt:et,(p=p||l)!==l))if(!f&&k&&g&&g.jit()){if(v=u.$it(c,t,n,M,C,g,i,r,T,A,o,a),i&&v)return v;p=g=q}else{if(f||!h||h&&(c?h.row:h.col)===M)if(l=D===m+Y-1,_=f?I:k,i){if(f)return _;if(h&&l||!h&&(l&&r||!r&&D===m))return k}else!(D<m+Y&&m<=D)||!f&&!c&&(c||P&&s.XT&&s.XT(D))||f&&-1!==u._it.indexOf(w)||u.Wit(s,y,x,w,N,_,e,o,a);h?b+=c?h.colCount:h.rowCount:b++}else g.ZP(Z,k),h?b+=c?h.colCount:h.rowCount:b++;if(u.Dit)for(E=t.row,W=t.col,Q=t.rowCount,J=t.colCount,K=j=void 0,X=!1===r?-1:1,O=1;O<Q;O++)for(j=E+X*O,R=0;R<J;)K=W+R,-1===u._it.indexOf(j)&&u.Wit(s,E,W,j,K,I,e,o,a),R++;if(g&&g.jit()&&(v=u.$it(c,t,n,M,C,g,i,r,T,A,o,a),i)&&!$(v))return v}return q},x.prototype.qit=function(t,n,e,i){var r,o,a,n,u,s,n,c,f,t,l,h,d,v,m,g,p,b,y,w,M,C,S,T,A,r=this,o=r.Mf,a=o.tables,n=t.union(n),u=n.row,s=n.rowCount,n=t.row,c=t.col,f=t.rowCount,t=t.colCount;if(a)for(h=0,d=l=a.AB(n,c,f,t);h<d.length;h++){if(m=(v=d[h]).Ky,g=v.iw,p=s,i)for(b=0,y=i;b<y.length;b++)if((w=y[b]).row===m&&w.col===g){p=w.rowCount,r.Jit=v;break}if(M=v.IB,C=r._it,S=void 0,M&&M.isFiltered&&M.isFiltered()){for(T=0;T<p;T++)M.isRowFilteredOut(S=u+e*T)&&r._it.push(S);if(0<C.length){r.Dit=!0;break}}}if(A=o.IB,!0!==r.Dit&&A&&A.isFiltered&&A.isFiltered()){for(C=r._it,S=void 0,T=0;T<s;T++)A.isRowFilteredOut(S=u+e*T)&&r._it.push(S);0<C.length&&(r.Dit=!0)}},x.prototype.Wit=function(t,n,e,i,r,o,a,u,s){var c,a,o,a,c=t.Ut;E&&(t.hasFormula(n,e,3)||t.hasFormula(i,r,3))&&(t.setFormula(i,r,q),0!==a&&4!==a||(a=t.b3(),t.getFormula(n,e)&&_.CalcOperatorAdjustor.copyFormula(a,n,e,a,i,r,1,1,w,!0))),t.setValue(i,r,o),a=s?0:64,u&&(a|=128),t.vT(n,e,i,r,1,1,a|=1024,w,!0),t.removeSpan(i,r,3),(o=c.findSpan(n,e))&&n===o.row&&e===o.col&&t.EL(i,r,o.rowCount,o.colCount,3)},x.prototype.$it=function(t,n,e,i,r,o,a,u,s,c,f,l){var h,d,v,m,g,p,b,y,w,M,C,S,T,A,I,x,N,k,I,D,x,I,h=this,d=h.Mf,b=t?e.col:e.row,y=t?n.col:n.row,w=t?e.colCount:e.rowCount,M=t?n.colCount:n.rowCount;if(s=s||0,C=o.jit(),S=(b-y-s)/M,T=h.Cit(o.rit,o.oit),A=o.uit,T){for(g=[],m=0;m<C;m++)g[m]=m+1;v=C}else p=o.rit[0],v=o.rit[C-1]-p+1,1===C&&A!==et&&o.ZP(o.rit[0]+1,o.Lit(o.oit[0]+1)),g=o.Rit();for(m=0;m<v;m++)if(I=o.ait,k=N=x=void 0,D=b+w-1,I=(x=(k=(x=A!==nt&&A!==et?x:d.tnt&&d.tnt.getRule(A,I))?(N=x.getTargetValue(o,v*S+m+1,g,m,S),T=x.Cit||T,I=x.Sit||!1,T&&!I):(N=kt(!0,o.Bit(),g,v*S+m+1),T))?o.rit[m]:p+m)+S*M,a){if(T&&(u&&I===D||!u&&I===b)||!T&&I+s===D)return o.Lit(N)}else I<b+w&&b<=I&&(t?h.Wit(d,i,x,r,I,o.Lit(N),4,f,l):c&&d.XT&&d.XT(I)||h.Wit(d,x,i,I,r,o.Lit(N),4,f,l));return q},x.prototype.Cit=function(t,n){var e,i,r,o,e=N(n);if(e<=1||N(t)!==e)return!1;for(i=t[1]-t[0],r=n[1]-n[0],o=2;o<e;o++)if(t[o]-t[o-1]!=i||n[o]-n[o-1]!=r)return!1;return!0},x.prototype.Xtt=function(t,n){var e=this,i=this.Mf,r=i.Ut.getSpans(),t=i.JS(t),o=t.row,a=t.col,u=t.rowCount,t=t.colCount,s,s=0===n?C(o,a+t-1,u,1):1===n?C(o,a,u,1):C(2===n?o+u-1:o,a,1,t);(s=i.nR(r,s))&&e.trt(s,o,a,u,t,n)},x.prototype.trt=function(t,n,e,i,r,o){var a=this,u=t.row,s=t.col,c=t.rowCount,f=t.colCount,l,h,d,v,m,g,p,b=a.Mf.Ut,y,m=0===o?(y=b.eE(n,e,i,r-f),g=0,p=-1*f,d=r,v=f,1):1===o?(y=b.eE(n,e+f,i,r-f),g=0,d=r,v=p=f,1):p=(v=2===o?(y=b.eE(n,e,i-c,r),g=-1*c,d=i,c):(y=b.eE(n+c,e,i-c,r),d=i,g=c),0);if(y)throw new Error(k().Exp_TargetContainsMergedCells);if(d%v!=0)throw new Error(k().Exp_MergedCellsIdentical);for(l=M(d/v),h=1;h<l;h++)a.Xit(t,C(u+h*g,s+h*p,c,f),m,0,w,w,w,w,!0)},x.prototype.Qit=function(t,n,e,i,r,o){var a,t,u,s,a=t?-1:1,t=M(o*r),u=Math.abs(r),s=B(1<n?e:i);if(0===n)s.setDate(s.getDate()+a*r);else if(1===n)for(;0<u;)s.setDate(s.getDate()+a*(0<r?1:-1)),6!==s.getDay()&&0!==s.getDay()&&u--;else 2===n?s.setMonth(s.getMonth()+a*t):s.setFullYear(s.getFullYear()+a*t);return R(s)},t.Wtt=x},"./dist/plugins/fill/fill.ns.js":function(t,n,e){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.SR=void 0;var e=e("./dist/plugins/fill/fill.res.en.js");n.SR={en:e}},"./dist/plugins/fill/fill.res.en.js":function(t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.Exp_ChangePartOfArray=n.Exp_RangeIsNull=n.Exp_CellReadOnly=n.Exp_RowReadOnly=n.Exp_ColumnReadOnly=n.Exp_ChangeMergedCell=n.Exp_FillCellsReadOnly=n.Exp_FillRangeContainsMergedCell=n.Exp_MergedCellsIdentical=n.Exp_TargetContainsMergedCells=n.Exp_RangeContainsMergedCell=n.Exp_NumberOnly=n.FillWithoutFormatting=n.FillFormattingOnly=n.FillSeries=n.CopyCells=void 0,n.CopyCells="Copy Cells",n.FillSeries="Fill Series",n.FillFormattingOnly="Fill Formatting Only",n.FillWithoutFormatting="Fill Without Formatting",n.Exp_NumberOnly="Only works for Numbers",n.Exp_RangeContainsMergedCell="Range should not have merged cells.",n.Exp_TargetContainsMergedCells="Target range should not have merged cells.",n.Exp_MergedCellsIdentical="This operation requires the merged cells to be identically sized.",n.Exp_FillRangeContainsMergedCell="Cannot fill range that contains a merged cell.",n.Exp_FillCellsReadOnly="The cells you are trying to fill are protected and therefore read-only.",n.Exp_ChangeMergedCell="Cannot change part of merged cell.",n.Exp_ColumnReadOnly="The column you are trying to change is protected and therefore read-only.",n.Exp_RowReadOnly="The row you are trying to change is protected and therefore read-only.",n.Exp_CellReadOnly="The cell you are trying to change is protected and therefore read-only.",n.Exp_RangeIsNull="range is null",n.Exp_ChangePartOfArray="Cannot change part of an array."},"./dist/plugins/filter/filter-actions.js":function(B,t,n){"use strict";var e,t,g,i,s,p,c,L,n,r,o,a,u,f,l,h,b,d,y,i,w,v,m,M,C,S,T,A,F,P,G,U,H,z;function I(t,n){var e,t;return t?(t=n.tables.findByName(t))&&(e=t.rowFilter()):e=n.rowFilter(),e}function V(t,n,e,i,r){return{sheet:t,sheetName:t.name(),table:n,tableCol:e,filterValues:i,conditionInfo:0===b(i)&&r?r.toJSON():d}}function Y(t,n,e,i){return{sheet:t,sheetName:t.name(),col:n,filterValues:e,conditionInfo:0===b(e)&&i?i.toJSON():d}}function x(t,n,e,i,r){var o=e?t-e.range().col:-1;e?n.ki(g.Events.TableFiltering,V(n,e,o,i,r)):n.ki(g.Events.RangeFiltering,Y(n,t,i,r))}function Z(t,n,e){var i,i;e?(i=t-e.range().col,i={sheet:n,sheetName:n.name(),table:e,tableCol:i},n.ki(g.Events.TableFilterClearing,i)):(i={sheet:n,sheetName:n.name(),col:t},n.ki(g.Events.RangeFilterClearing,i))}function W(t,n,e){var i,i;e?(i=t-e.range().col,i={sheet:n,sheetName:n.name(),table:e,tableCol:i},n.ki(g.Events.TableFilterCleared,i)):(i={sheet:n,sheetName:n.name(),col:t},n.ki(g.Events.RangeFilterCleared,i))}function N(t,n,e,i,r,o){var a=i?n-i.range().col:-1;t.filter(n),i?e.ki(g.Events.TableFiltered,V(e,i,a,r,o)):e.ki(g.Events.RangeFiltered,Y(e,n,r,o))}function k(t,n){t.suspendPaint();var e=g.Commands.TI(t.name());return t.Ut.undo(n[e]),t.resumePaint(),!0}function D(t,n){var t,n,t=F.call(this,t,n)||this,n=t;return n.nrt=n.tT.cmdOption,n.nrt.rowFilter=I(n.nrt.tableName,n.Mf),t}function _(t,n){var t,n,t=P.call(this,t,n)||this,n=t;return n.nrt=n.tT.cmdOption,t}function E(t,n){return G.call(this,t,n)||this}function j(t,n){return U.call(this,t,n)||this}function O(t,n){return H.call(this,t,n)||this}function R(t,n){return z.call(this,t,n)||this}e=this&&this.__extends||(A=function(t,n){return(A=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(t,n){t.__proto__=n}:function(t,n){for(var e in n)Object.prototype.hasOwnProperty.call(n,e)&&(t[e]=n[e])}))(t,n)},function(t,n){if("function"!=typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function e(){this.constructor=t}A(t,n),t.prototype=null===n?Object.create(n):(e.prototype=n.prototype,new e)}),Object.defineProperty(t,"__esModule",{value:!0}),t=n("./dist/plugins/filter/filter-ns.js"),g=n("Core"),i=n("Common"),s=n("./dist/plugins/filter/filter.js"),p=n("ConditionalFormatting"),c=i.Common.lt.ht,L=i.Common.lt.Oh,n=g.Commands.ActionBase,r="sortFilter",o="filterTextSelectAction",a="filterByCondition",u="clearFilter",f="contextmenuFilterForSheet",l="contextmenuFilterForTable",h=g.Commands.zA,b=i.Common.Uf.tR,d=void 0,y=null,i=new i.Common.ResourceManager(t.SR,"Filter"),w=i.getResource.bind(i),e(D,F=n),D.prototype.execute=function(){var t,n,e,i,r,o,a,u,s,a,t=this,n=t.nrt.rowFilter,e=t.nrt.colIndex,i=t.nrt.compareFunction,r=t.nrt.isAsc,o=!c(t.nrt.tableName),a=t.nrt.color,u=t.nrt.isBackColor,s={groupSort:t.nrt.groupSort,ignoreHidden:t.nrt.ignoreHidden};t.Mf.suspendPaint(),t.Mf.Ut.startTransaction();try{a!==d?n.sortColumnByColor(e,r,a,u,s,o):n.ert(e,r,i,s,o)}finally{a=g.Commands.TI(t.Mf.name()),t.tT[a]=t.Mf.Ut.endTransaction(),t.Mf.resumePaint()}},D.prototype.undo=function(){return k(this.Mf,this.tT)},v=D,g.Commands[r]={canUndo:!0,execute:function(t,n,e){return h(t,v,n,e)}},e(_,P=n),_.prototype.execute=function(){var t,n,e,i,r,i,t=this,n=t.nrt.colIndex,i=t.tT.cmdOption.tableName,e=I(i,t.Mf);e&&(i&&(r=t.Mf.tables.findByName(i)),t.Mf.suspendPaint(),t.Mf.suspendCalcService(),t.Mf.Ut.startTransaction(),Z(n,t.Mf,r),e.removeFilterItems(n),W(n,t.Mf,r),i=g.Commands.TI(t.Mf.name()),t.tT[i]=t.Mf.Ut.endTransaction(),t.Mf.resumeCalcService(!1),t.Mf.resumePaint())},_.prototype.undo=function(){return k(this.Mf,this.tT)},m=_,g.Commands[u]={canUndo:!0,execute:function(t,n,e){return h(t,m,n,e)}},e(E,G=n),E.prototype.execute=function(){var t,n,e,i,r,o,a,u,s,c,f,l,h,d,v,m,h,u,t=this,n=t.tT.cmdOption.colIndex,e=t.tT.cmdOption.checkedValues,i=t.tT.cmdOption.allValuesLength,r=b(e),o=w().Blanks,u=t.tT.cmdOption.tableName,s=t.Mf,a=I(u,s);if(a){if(u&&(c=s.tables.findByName(u)),s.suspendPaint(),s.suspendCalcService(),s.Ut.startTransaction(),x(n,s,c,e,y),a.removeFilterItems(n),r!==i)if(a.irt)a.rrt[n]=e;else{for(f=[],l=0;l<r;l++)d=void 0,v=(h=e[l]).text,m=h.value,h=h.type,v===o&&(v=""),(d=new p.Condition(2))._ps.expected=v,d._ps.compareType=0,d._ps.useWildCards=!1,("date"===h||"blank"===h&&a.ort)&&(d.art=!0,d.urt=m),f.push(d);a.addFilterItem(n,f)}N(a,n,s,c,e,y),u=g.Commands.TI(s.name()),t.tT[u]=s.Ut.endTransaction(),s.resumeCalcService(!1),s.resumePaint()}},E.prototype.undo=function(){return k(this.Mf,this.tT)},M=E,g.Commands[o]={canUndo:!0,execute:function(t,n,e){return h(t,M,n,e)}},e(j,U=n),j.prototype.execute=function(){var t,n,e,i,r,o,a,o,t=this,n=t.tT.cmdOption.colIndex,e=t.tT.cmdOption.condition,r=t.tT.cmdOption.tableName,o=t.Mf,i=I(r,t.Mf);if(c(e))return o.jT(7,w().invalidCondition),!1;i&&(r&&(a=t.Mf.tables.findByName(r)),t.Mf.suspendPaint(),t.Mf.Ut.startTransaction(),x(n,t.Mf,a,[],e),i.removeFilterItems(n),i.addFilterItem(n,e),N(i,n,t.Mf,a,[],e),o=g.Commands.TI(t.Mf.name()),t.tT[o]=t.Mf.Ut.endTransaction(),t.Mf.resumePaint())},j.prototype.undo=function(){return k(this.Mf,this.tT)},C=j,g.Commands[a]={canUndo:!0,execute:function(t,n,e){return h(t,C,n,e)}},e(O,H=n),O.prototype.execute=function(){var t,n,t,e,i,r,t,o,a,u,i,u,t=this,n=t.Mf,t=t.tT.cmdOption,e=t.selection,i=t.activeRow,r=t.activeCol,t=t.expectedText;n.Ut.startTransaction(),1===e.rowCount&&1===e.colCount&&(e=this.Mf.expandSelection(n,e),this.Mf.deleteBlankContent(n,e)),n.rowFilter()?(o=void 0,(u=(a=n.rowFilter()).extendedRange||a.range).contains(i,r,1,1)?(x(r,n,d,[t],y),o=new p.Condition(p.ConditionType.textCondition,{compareType:0,expected:t}),a.addFilterItem(r,o),N(a,r,n,d,[t],y)):u.row-1!==i||c(a.srt[r])?(n.rowFilter().unfilter(),n.rowFilter(new s.HideRowFilter(e))):(i=n.getText(u.row,r),x(r,n,d,[t],y),o=new p.Condition(p.ConditionType.textCondition,{compareType:0,expected:i}),a.addFilterItem(r,o),N(a,r,n,d,[t],y))):n.rowFilter(new s.HideRowFilter(e)),u=g.Commands.TI(n.name()),this.tT[u]=n.Ut.endTransaction()},O.prototype.undo=function(){return k(this.Mf,this.tT)},S=O,g.Commands[f]={canUndo:!0,execute:function(t,n,e){return h(t,S,n,e)}},e(R,z=n),R.prototype.execute=function(){var t,n,t,e,i,r,t,o,e,a,e,a,t=this,n=t.Mf,t=t.tT.cmdOption,e=t.tableName,i=t.expectedText,r=t.activeCol,t=t.activeRow;n.Ut.startTransaction(),o=I(e,n),e=n.tables.findByName(e),o&&e&&(a=e.range(),e.showHeader()&&a.row===t&&!c(o.srt[r-a.col])&&(i=n.getText(t+1,r)),x(r,n,d,[i],y),e=new p.Condition(p.ConditionType.textCondition,{compareType:0,expected:i}),o.removeFilterItems(r),o.addFilterItem(r,e),N(o,r,n,d,[i],y),a=g.Commands.TI(n.name()),this.tT[a]=n.Ut.endTransaction())},R.prototype.undo=function(){return k(this.Mf,this.tT)},T=R,g.Commands[l]={canUndo:!0,execute:function(t,n,e){return h(t,T,n,e)}},g.Commands.crt=function(t){t.register(r,g.Commands[r]),t.register(o,g.Commands[o]),t.register(a,g.Commands[a]),t.register(u,g.Commands[u]),t.register(f,g.Commands[f]),t.register(l,g.Commands[l])}},"./dist/plugins/filter/filter-button-images.js":function(t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.getFilterButtonImageSrc=void 0;var e="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAACXBIWXMAAA7DAAAOwwHHb6hkAAAKTWlDQ1BQaG90b3Nob3AgSUNDIHByb2ZpbGUAAHjanVN3WJP3Fj7f92UPVkLY8LGXbIEAIiOsCMgQWaIQkgBhhBASQMWFiApWFBURnEhVxILVCkidiOKgKLhnQYqIWotVXDjuH9yntX167+3t+9f7vOec5/zOec8PgBESJpHmomoAOVKFPDrYH49PSMTJvYACFUjgBCAQ5svCZwXFAADwA3l4fnSwP/wBr28AAgBw1S4kEsfh/4O6UCZXACCRAOAiEucLAZBSAMguVMgUAMgYALBTs2QKAJQAAGx5fEIiAKoNAOz0ST4FANipk9wXANiiHKkIAI0BAJkoRyQCQLsAYFWBUiwCwMIAoKxAIi4EwK4BgFm2MkcCgL0FAHaOWJAPQGAAgJlCLMwAIDgCAEMeE80DIEwDoDDSv+CpX3CFuEgBAMDLlc2XS9IzFLiV0Bp38vDg4iHiwmyxQmEXKRBmCeQinJebIxNI5wNMzgwAABr50cH+OD+Q5+bk4eZm52zv9MWi/mvwbyI+IfHf/ryMAgQAEE7P79pf5eXWA3DHAbB1v2upWwDaVgBo3/ldM9sJoFoK0Hr5i3k4/EAenqFQyDwdHAoLC+0lYqG9MOOLPv8z4W/gi372/EAe/tt68ABxmkCZrcCjg/1xYW52rlKO58sEQjFu9+cj/seFf/2OKdHiNLFcLBWK8ViJuFAiTcd5uVKRRCHJleIS6X8y8R+W/QmTdw0ArIZPwE62B7XLbMB+7gECiw5Y0nYAQH7zLYwaC5EAEGc0Mnn3AACTv/mPQCsBAM2XpOMAALzoGFyolBdMxggAAESggSqwQQcMwRSswA6cwR28wBcCYQZEQAwkwDwQQgbkgBwKoRiWQRlUwDrYBLWwAxqgEZrhELTBMTgN5+ASXIHrcBcGYBiewhi8hgkEQcgIE2EhOogRYo7YIs4IF5mOBCJhSDSSgKQg6YgUUSLFyHKkAqlCapFdSCPyLXIUOY1cQPqQ28ggMor8irxHMZSBslED1AJ1QLmoHxqKxqBz0XQ0D12AlqJr0Rq0Hj2AtqKn0UvodXQAfYqOY4DRMQ5mjNlhXIyHRWCJWBomxxZj5Vg1Vo81Yx1YN3YVG8CeYe8IJAKLgBPsCF6EEMJsgpCQR1hMWEOoJewjtBK6CFcJg4Qxwicik6hPtCV6EvnEeGI6sZBYRqwm7iEeIZ4lXicOE1+TSCQOyZLkTgohJZAySQtJa0jbSC2kU6Q+0hBpnEwm65Btyd7kCLKArCCXkbeQD5BPkvvJw+S3FDrFiOJMCaIkUqSUEko1ZT/lBKWfMkKZoKpRzame1AiqiDqfWkltoHZQL1OHqRM0dZolzZsWQ8ukLaPV0JppZ2n3aC/pdLoJ3YMeRZfQl9Jr6Afp5+mD9HcMDYYNg8dIYigZaxl7GacYtxkvmUymBdOXmchUMNcyG5lnmA+Yb1VYKvYqfBWRyhKVOpVWlX6V56pUVXNVP9V5qgtUq1UPq15WfaZGVbNQ46kJ1Bar1akdVbupNq7OUndSj1DPUV+jvl/9gvpjDbKGhUaghkijVGO3xhmNIRbGMmXxWELWclYD6yxrmE1iW7L57Ex2Bfsbdi97TFNDc6pmrGaRZp3mcc0BDsax4PA52ZxKziHODc57LQMtPy2x1mqtZq1+rTfaetq+2mLtcu0W7eva73VwnUCdLJ31Om0693UJuja6UbqFutt1z+o+02PreekJ9cr1Dund0Uf1bfSj9Rfq79bv0R83MDQINpAZbDE4Y/DMkGPoa5hpuNHwhOGoEctoupHEaKPRSaMnuCbuh2fjNXgXPmasbxxirDTeZdxrPGFiaTLbpMSkxeS+Kc2Ua5pmutG003TMzMgs3KzYrMnsjjnVnGueYb7ZvNv8jYWlRZzFSos2i8eW2pZ8ywWWTZb3rJhWPlZ5VvVW16xJ1lzrLOtt1ldsUBtXmwybOpvLtqitm63Edptt3xTiFI8p0in1U27aMez87ArsmuwG7Tn2YfYl9m32zx3MHBId1jt0O3xydHXMdmxwvOuk4TTDqcSpw+lXZxtnoXOd8zUXpkuQyxKXdpcXU22niqdun3rLleUa7rrStdP1o5u7m9yt2W3U3cw9xX2r+00umxvJXcM970H08PdY4nHM452nm6fC85DnL152Xlle+70eT7OcJp7WMG3I28Rb4L3Le2A6Pj1l+s7pAz7GPgKfep+Hvqa+It89viN+1n6Zfgf8nvs7+sv9j/i/4XnyFvFOBWABwQHlAb2BGoGzA2sDHwSZBKUHNQWNBbsGLww+FUIMCQ1ZH3KTb8AX8hv5YzPcZyya0RXKCJ0VWhv6MMwmTB7WEY6GzwjfEH5vpvlM6cy2CIjgR2yIuB9pGZkX+X0UKSoyqi7qUbRTdHF09yzWrORZ+2e9jvGPqYy5O9tqtnJ2Z6xqbFJsY+ybuIC4qriBeIf4RfGXEnQTJAntieTE2MQ9ieNzAudsmjOc5JpUlnRjruXcorkX5unOy553PFk1WZB8OIWYEpeyP+WDIEJQLxhP5aduTR0T8oSbhU9FvqKNolGxt7hKPJLmnVaV9jjdO31D+miGT0Z1xjMJT1IreZEZkrkj801WRNberM/ZcdktOZSclJyjUg1plrQr1zC3KLdPZisrkw3keeZtyhuTh8r35CP5c/PbFWyFTNGjtFKuUA4WTC+oK3hbGFt4uEi9SFrUM99m/ur5IwuCFny9kLBQuLCz2Lh4WfHgIr9FuxYji1MXdy4xXVK6ZHhp8NJ9y2jLspb9UOJYUlXyannc8o5Sg9KlpUMrglc0lamUycturvRauWMVYZVkVe9ql9VbVn8qF5VfrHCsqK74sEa45uJXTl/VfPV5bdra3kq3yu3rSOuk626s91m/r0q9akHV0IbwDa0b8Y3lG19tSt50oXpq9Y7NtM3KzQM1YTXtW8y2rNvyoTaj9nqdf13LVv2tq7e+2Sba1r/dd3vzDoMdFTve75TsvLUreFdrvUV99W7S7oLdjxpiG7q/5n7duEd3T8Wej3ulewf2Re/ranRvbNyvv7+yCW1SNo0eSDpw5ZuAb9qb7Zp3tXBaKg7CQeXBJ9+mfHvjUOihzsPcw83fmX+39QjrSHkr0jq/dawto22gPaG97+iMo50dXh1Hvrf/fu8x42N1xzWPV56gnSg98fnkgpPjp2Snnp1OPz3Umdx590z8mWtdUV29Z0PPnj8XdO5Mt1/3yfPe549d8Lxw9CL3Ytslt0utPa49R35w/eFIr1tv62X3y+1XPK509E3rO9Hv03/6asDVc9f41y5dn3m978bsG7duJt0cuCW69fh29u0XdwruTNxdeo94r/y+2v3qB/oP6n+0/rFlwG3g+GDAYM/DWQ/vDgmHnv6U/9OH4dJHzEfVI0YjjY+dHx8bDRq98mTOk+GnsqcTz8p+Vv9563Or59/94vtLz1j82PAL+YvPv655qfNy76uprzrHI8c";function i(t){return 0===t?"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAACXBIWXMAAA7DAAAOwwHHb6hkAAAKTWlDQ1BQaG90b3Nob3AgSUNDIHByb2ZpbGUAAHjanVN3WJP3Fj7f92UPVkLY8LGXbIEAIiOsCMgQWaIQkgBhhBASQMWFiApWFBURnEhVxILVCkidiOKgKLhnQYqIWotVXDjuH9yntX167+3t+9f7vOec5/zOec8PgBESJpHmomoAOVKFPDrYH49PSMTJvYACFUjgBCAQ5svCZwXFAADwA3l4fnSwP/wBr28AAgBw1S4kEsfh/4O6UCZXACCRAOAiEucLAZBSAMguVMgUAMgYALBTs2QKAJQAAGx5fEIiAKoNAOz0ST4FANipk9wXANiiHKkIAI0BAJkoRyQCQLsAYFWBUiwCwMIAoKxAIi4EwK4BgFm2MkcCgL0FAHaOWJAPQGAAgJlCLMwAIDgCAEMeE80DIEwDoDDSv+CpX3CFuEgBAMDLlc2XS9IzFLiV0Bp38vDg4iHiwmyxQmEXKRBmCeQinJebIxNI5wNMzgwAABr50cH+OD+Q5+bk4eZm52zv9MWi/mvwbyI+IfHf/ryMAgQAEE7P79pf5eXWA3DHAbB1v2upWwDaVgBo3/ldM9sJoFoK0Hr5i3k4/EAenqFQyDwdHAoLC+0lYqG9MOOLPv8z4W/gi372/EAe/tt68ABxmkCZrcCjg/1xYW52rlKO58sEQjFu9+cj/seFf/2OKdHiNLFcLBWK8ViJuFAiTcd5uVKRRCHJleIS6X8y8R+W/QmTdw0ArIZPwE62B7XLbMB+7gECiw5Y0nYAQH7zLYwaC5EAEGc0Mnn3AACTv/mPQCsBAM2XpOMAALzoGFyolBdMxggAAESggSqwQQcMwRSswA6cwR28wBcCYQZEQAwkwDwQQgbkgBwKoRiWQRlUwDrYBLWwAxqgEZrhELTBMTgN5+ASXIHrcBcGYBiewhi8hgkEQcgIE2EhOogRYo7YIs4IF5mOBCJhSDSSgKQg6YgUUSLFyHKkAqlCapFdSCPyLXIUOY1cQPqQ28ggMor8irxHMZSBslED1AJ1QLmoHxqKxqBz0XQ0D12AlqJr0Rq0Hj2AtqKn0UvodXQAfYqOY4DRMQ5mjNlhXIyHRWCJWBomxxZj5Vg1Vo81Yx1YN3YVG8CeYe8IJAKLgBPsCF6EEMJsgpCQR1hMWEOoJewjtBK6CFcJg4Qxwicik6hPtCV6EvnEeGI6sZBYRqwm7iEeIZ4lXicOE1+TSCQOyZLkTgohJZAySQtJa0jbSC2kU6Q+0hBpnEwm65Btyd7kCLKArCCXkbeQD5BPkvvJw+S3FDrFiOJMCaIkUqSUEko1ZT/lBKWfMkKZoKpRzame1AiqiDqfWkltoHZQL1OHqRM0dZolzZsWQ8ukLaPV0JppZ2n3aC/pdLoJ3YMeRZfQl9Jr6Afp5+mD9HcMDYYNg8dIYigZaxl7GacYtxkvmUymBdOXmchUMNcyG5lnmA+Yb1VYKvYqfBWRyhKVOpVWlX6V56pUVXNVP9V5qgtUq1UPq15WfaZGVbNQ46kJ1Bar1akdVbupNq7OUndSj1DPUV+jvl/9gvpjDbKGhUaghkijVGO3xhmNIRbGMmXxWELWclYD6yxrmE1iW7L57Ex2Bfsbdi97TFNDc6pmrGaRZp3mcc0BDsax4PA52ZxKziHODc57LQMtPy2x1mqtZq1+rTfaetq+2mLtcu0W7eva73VwnUCdLJ31Om0693UJuja6UbqFutt1z+o+02PreekJ9cr1Dund0Uf1bfSj9Rfq79bv0R83MDQINpAZbDE4Y/DMkGPoa5hpuNHwhOGoEctoupHEaKPRSaMnuCbuh2fjNXgXPmasbxxirDTeZdxrPGFiaTLbpMSkxeS+Kc2Ua5pmutG003TMzMgs3KzYrMnsjjnVnGueYb7ZvNv8jYWlRZzFSos2i8eW2pZ8ywWWTZb3rJhWPlZ5VvVW16xJ1lzrLOtt1ldsUBtXmwybOpvLtqitm63Edptt3xTiFI8p0in1U27aMez87ArsmuwG7Tn2YfYl9m32zx3MHBId1jt0O3xydHXMdmxwvOuk4TTDqcSpw+lXZxtnoXOd8zUXpkuQyxKXdpcXU22niqdun3rLleUa7rrStdP1o5u7m9yt2W3U3cw9xX2r+00umxvJXcM970H08PdY4nHM452nm6fC85DnL152Xlle+70eT7OcJp7WMG3I28Rb4L3Le2A6Pj1l+s7pAz7GPgKfep+Hvqa+It89viN+1n6Zfgf8nvs7+sv9j/i/4XnyFvFOBWABwQHlAb2BGoGzA2sDHwSZBKUHNQWNBbsGLww+FUIMCQ1ZH3KTb8AX8hv5YzPcZyya0RXKCJ0VWhv6MMwmTB7WEY6GzwjfEH5vpvlM6cy2CIjgR2yIuB9pGZkX+X0UKSoyqi7qUbRTdHF09yzWrORZ+2e9jvGPqYy5O9tqtnJ2Z6xqbFJsY+ybuIC4qriBeIf4RfGXEnQTJAntieTE2MQ9ieNzAudsmjOc5JpUlnRjruXcorkX5unOy553PFk1WZB8OIWYEpeyP+WDIEJQLxhP5aduTR0T8oSbhU9FvqKNolGxt7hKPJLmnVaV9jjdO31D+miGT0Z1xjMJT1IreZEZkrkj801WRNberM/ZcdktOZSclJyjUg1plrQr1zC3KLdPZisrkw3keeZtyhuTh8r35CP5c/PbFWyFTNGjtFKuUA4WTC+oK3hbGFt4uEi9SFrUM99m/ur5IwuCFny9kLBQuLCz2Lh4WfHgIr9FuxYji1MXdy4xXVK6ZHhp8NJ9y2jLspb9UOJYUlXyannc8o5Sg9KlpUMrglc0lamUycturvRauWMVYZVkVe9ql9VbVn8qF5VfrHCsqK74sEa45uJXTl/VfPV5bdra3kq3yu3rSOuk626s91m/r0q9akHV0IbwDa0b8Y3lG19tSt50oXpq9Y7NtM3KzQM1YTXtW8y2rNvyoTaj9nqdf13LVv2tq7e+2Sba1r/dd3vzDoMdFTve75TsvLUreFdrvUV99W7S7oLdjxpiG7q/5n7duEd3T8Wej3ulewf2Re/ranRvbNyvv7+yCW1SNo0eSDpw5ZuAb9qb7Zp3tXBaKg7CQeXBJ9+mfHvjUOihzsPcw83fmX+39QjrSHkr0jq/dawto22gPaG97+iMo50dXh1Hvrf/fu8x42N1xzWPV56gnSg98fnkgpPjp2Snnp1OPz3Umdx590z8mWtdUV29Z0PPnj8XdO5Mt1/3yfPe549d8Lxw9CL3Ytslt0utPa49R35w/eFIr1tv62X3y+1XPK509E3rO9Hv03/6asDVc9f41y5dn3m978bsG7duJt0cuCW69fh29u0XdwruTNxdeo94r/y+2v3qB/oP6n+0/rFlwG3g+GDAYM/DWQ/vDgmHnv6U/9OH4dJHzEfVI0YjjY+dHx8bDRq98mTOk+GnsqcTz8p+Vv9563Or59/94vtLz1j82PAL+YvPv655qfNy76uprzrHI8cfvM55PfGm/K3O233vuO+638e9H5ko/ED+UPPR+mPHp9BP9z7nfP78L/eE8/sl0p8zAAAAIGNIUk0AAHolAACAgwAA+f8AAIDpAAB1MAAA6mAAADqYAAAXb5JfxUYAAAMOSURBVHjaXJNdaJRHFIbfM7PfGremUTfkpxgpiheiBOmFtYUgRXNRqNnd75sEhBoIKhrwQpFUUSsihhIQ41+FNrUGqYhRY43STZqgARNRTIzRaFqz6xJTtals3K8xRQ3x7UV215+LB2bOxTNn3jMDs+mEIgmS+LwQiqSQ9JG03FHX54666pn7TLmJEZVIjCCRGMkYGxvNiI9FvaENZzLw/PmqtCDFV/4WkERw8TI03K6XqqrNWLBgPoafDmNwMCbd3TestpMDHpJAuIcWSZjSUrnS0SFOWamXJLpuDYAkAiYAkioYDCIej0+Lx12QrervFxOemjWfCvIyIcmTVeLVC1986OkUklhRtlgutLYrkpnOKlt1dl0BSfTHmnCnm5oTm0AS6I0xLaDLrK1PusTp/cb7/rUAyH8kSL+Vqt0ebpuGP699LCRROAdqf/suGforCpLi4DMpAOQQLAEgfE2sRDZIv5cknGxi74HDFnZ/32olk9f//vOTPIj05ZnKZpp14QlnfZgpTOXvNGsvjrvuH9MnOwAOYlhQ/UPYmxRkJVvzPHw8JF8EdrKoZEeapSt2cHDo4Sxn7R0hiV8/hEQe3Ad21jZNJQnbDklSBBas0ddvRj2Fi4qZIhaL+Q3ni8N0ZohGe4Dv6sKZfFP0kvkSWLZdGvLpiUTuTS9cVMxI5H5+fz+UfXyOto/Ns5bUL7dyjsBjTsKDbbVnM0iqYNHXYi9ZLiSlaRbFn089zlzvwN1IzkDlmDhfdiin5KgOBY5qO9iojX1K9+VRcOCXnlySsFkOkjj/WGschtR0Kt/Ga9D2aYj5DWKaIeYSxTlFMS2T66udBDbXHS94Z97ZUB8Ayt7+iVVddlkzl5LCvrklvQ9dr1fnF0IQbng5O/VQsmAJSfnxSLuqCG3Rxxpfz3xbXv0IEkzm5YR7lXOCGs6+PVNJYjaQnoKwSgBIDSqkjjPUuv3QLP9ImW+hG1/lKJtzp5jaCmW2nrNAUpOUkqrWrJUb23T5rhZf0eoWhbeEKX7O4eTPHe8DSTjF59T/AwCfnhbaDaIICgAAAABJRU5ErkJggg==":1===t?"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAACXBIWXMAAA7DAAAOwwHHb6hkAAAKTWlDQ1BQaG90b3Nob3AgSUNDIHByb2ZpbGUAAHjanVN3WJP3Fj7f92UPVkLY8LGXbIEAIiOsCMgQWaIQkgBhhBASQMWFiApWFBURnEhVxILVCkidiOKgKLhnQYqIWotVXDjuH9yntX167+3t+9f7vOec5/zOec8PgBESJpHmomoAOVKFPDrYH49PSMTJvYACFUjgBCAQ5svCZwXFAADwA3l4fnSwP/wBr28AAgBw1S4kEsfh/4O6UCZXACCRAOAiEucLAZBSAMguVMgUAMgYALBTs2QKAJQAAGx5fEIiAKoNAOz0ST4FANipk9wXANiiHKkIAI0BAJkoRyQCQLsAYFWBUiwCwMIAoKxAIi4EwK4BgFm2MkcCgL0FAHaOWJAPQGAAgJlCLMwAIDgCAEMeE80DIEwDoDDSv+CpX3CFuEgBAMDLlc2XS9IzFLiV0Bp38vDg4iHiwmyxQmEXKRBmCeQinJebIxNI5wNMzgwAABr50cH+OD+Q5+bk4eZm52zv9MWi/mvwbyI+IfHf/ryMAgQAEE7P79pf5eXWA3DHAbB1v2upWwDaVgBo3/ldM9sJoFoK0Hr5i3k4/EAenqFQyDwdHAoLC+0lYqG9MOOLPv8z4W/gi372/EAe/tt68ABxmkCZrcCjg/1xYW52rlKO58sEQjFu9+cj/seFf/2OKdHiNLFcLBWK8ViJuFAiTcd5uVKRRCHJleIS6X8y8R+W/QmTdw0ArIZPwE62B7XLbMB+7gECiw5Y0nYAQH7zLYwaC5EAEGc0Mnn3AACTv/mPQCsBAM2XpOMAALzoGFyolBdMxggAAESggSqwQQcMwRSswA6cwR28wBcCYQZEQAwkwDwQQgbkgBwKoRiWQRlUwDrYBLWwAxqgEZrhELTBMTgN5+ASXIHrcBcGYBiewhi8hgkEQcgIE2EhOogRYo7YIs4IF5mOBCJhSDSSgKQg6YgUUSLFyHKkAqlCapFdSCPyLXIUOY1cQPqQ28ggMor8irxHMZSBslED1AJ1QLmoHxqKxqBz0XQ0D12AlqJr0Rq0Hj2AtqKn0UvodXQAfYqOY4DRMQ5mjNlhXIyHRWCJWBomxxZj5Vg1Vo81Yx1YN3YVG8CeYe8IJAKLgBPsCF6EEMJsgpCQR1hMWEOoJewjtBK6CFcJg4Qxwicik6hPtCV6EvnEeGI6sZBYRqwm7iEeIZ4lXicOE1+TSCQOyZLkTgohJZAySQtJa0jbSC2kU6Q+0hBpnEwm65Btyd7kCLKArCCXkbeQD5BPkvvJw+S3FDrFiOJMCaIkUqSUEko1ZT/lBKWfMkKZoKpRzame1AiqiDqfWkltoHZQL1OHqRM0dZolzZsWQ8ukLaPV0JppZ2n3aC/pdLoJ3YMeRZfQl9Jr6Afp5+mD9HcMDYYNg8dIYigZaxl7GacYtxkvmUymBdOXmchUMNcyG5lnmA+Yb1VYKvYqfBWRyhKVOpVWlX6V56pUVXNVP9V5qgtUq1UPq15WfaZGVbNQ46kJ1Bar1akdVbupNq7OUndSj1DPUV+jvl/9gvpjDbKGhUaghkijVGO3xhmNIRbGMmXxWELWclYD6yxrmE1iW7L57Ex2Bfsbdi97TFNDc6pmrGaRZp3mcc0BDsax4PA52ZxKziHODc57LQMtPy2x1mqtZq1+rTfaetq+2mLtcu0W7eva73VwnUCdLJ31Om0693UJuja6UbqFutt1z+o+02PreekJ9cr1Dund0Uf1bfSj9Rfq79bv0R83MDQINpAZbDE4Y/DMkGPoa5hpuNHwhOGoEctoupHEaKPRSaMnuCbuh2fjNXgXPmasbxxirDTeZdxrPGFiaTLbpMSkxeS+Kc2Ua5pmutG003TMzMgs3KzYrMnsjjnVnGueYb7ZvNv8jYWlRZzFSos2i8eW2pZ8ywWWTZb3rJhWPlZ5VvVW16xJ1lzrLOtt1ldsUBtXmwybOpvLtqitm63Edptt3xTiFI8p0in1U27aMez87ArsmuwG7Tn2YfYl9m32zx3MHBId1jt0O3xydHXMdmxwvOuk4TTDqcSpw+lXZxtnoXOd8zUXpkuQyxKXdpcXU22niqdun3rLleUa7rrStdP1o5u7m9yt2W3U3cw9xX2r+00umxvJXcM970H08PdY4nHM452nm6fC85DnL152Xlle+70eT7OcJp7WMG3I28Rb4L3Le2A6Pj1l+s7pAz7GPgKfep+Hvqa+It89viN+1n6Zfgf8nvs7+sv9j/i/4XnyFvFOBWABwQHlAb2BGoGzA2sDHwSZBKUHNQWNBbsGLww+FUIMCQ1ZH3KTb8AX8hv5YzPcZyya0RXKCJ0VWhv6MMwmTB7WEY6GzwjfEH5vpvlM6cy2CIjgR2yIuB9pGZkX+X0UKSoyqi7qUbRTdHF09yzWrORZ+2e9jvGPqYy5O9tqtnJ2Z6xqbFJsY+ybuIC4qriBeIf4RfGXEnQTJAntieTE2MQ9ieNzAudsmjOc5JpUlnRjruXcorkX5unOy553PFk1WZB8OIWYEpeyP+WDIEJQLxhP5aduTR0T8oSbhU9FvqKNolGxt7hKPJLmnVaV9jjdO31D+miGT0Z1xjMJT1IreZEZkrkj801WRNberM/ZcdktOZSclJyjUg1plrQr1zC3KLdPZisrkw3keeZtyhuTh8r35CP5c/PbFWyFTNGjtFKuUA4WTC+oK3hbGFt4uEi9SFrUM99m/ur5IwuCFny9kLBQuLCz2Lh4WfHgIr9FuxYji1MXdy4xXVK6ZHhp8NJ9y2jLspb9UOJYUlXyannc8o5Sg9KlpUMrglc0lamUycturvRauWMVYZVkVe9ql9VbVn8qF5VfrHCsqK74sEa45uJXTl/VfPV5bdra3kq3yu3rSOuk626s91m/r0q9akHV0IbwDa0b8Y3lG19tSt50oXpq9Y7NtM3KzQM1YTXtW8y2rNvyoTaj9nqdf13LVv2tq7e+2Sba1r/dd3vzDoMdFTve75TsvLUreFdrvUV99W7S7oLdjxpiG7q/5n7duEd3T8Wej3ulewf2Re/ranRvbNyvv7+yCW1SNo0eSDpw5ZuAb9qb7Zp3tXBaKg7CQeXBJ9+mfHvjUOihzsPcw83fmX+39QjrSHkr0jq/dawto22gPaG97+iMo50dXh1Hvrf/fu8x42N1xzWPV56gnSg98fnkgpPjp2Snnp1OPz3Umdx590z8mWtdUV29Z0PPnj8XdO5Mt1/3yfPe549d8Lxw9CL3Ytslt0utPa49R35w/eFIr1tv62X3y+1XPK509E3rO9Hv03/6asDVc9f41y5dn3m978bsG7duJt0cuCW69fh29u0XdwruTNxdeo94r/y+2v3qB/oP6n+0/rFlwG3g+GDAYM/DWQ/vDgmHnv6U/9OH4dJHzEfVI0YjjY+dHx8bDRq98mTOk+GnsqcTz8p+Vv9563Or59/94vtLz1j82PAL+YvPv655qfNy76uprzrHI8cfvM55PfGm/K3O233vuO+638e9H5ko/ED+UPPR+mPHp9BP9z7nfP78L/eE8/sl0p8zAAAAIGNIUk0AAHolAACAgwAA+f8AAIDpAAB1MAAA6mAAADqYAAAXb5JfxUYAAALLSURBVHjadJNtaNVlGMav+/kfjy3GTDfcsQW1CMrhWSZ6AsmXmflFDts5/0eYA52i02M6tdBIRQQJBLX8Yg4xYlMEJaHphzxKzoiaZptN0MBtacyXoYIobUgT/fXhtOMS+vBw89wXXPfLdd0CLNxwyACF648YYH7tnuEYAeQbv3CA/EeHBcivazbAUo1fv6hwfYtJEjDy2XP//8vpGbA9ZiE7xQ6USs3S7sUx9YHNbMqYn1IerGmQ3pr8uYXsNUAqnZ+LvqHJAA2BeIoGT6DJbMqBbAwArR77vs4/uhOje9BxlXEcww13pXDvtwaoes1MB6iz8xfxGkIIiLCUIEXaDTxiFJOmKp5YxDcciS6jVpRi8g1H87PVgLYslwO0GYzf+x377ubwXoLKafXEE/WUTfC9tBIhwNTJdAPkw4R1fdkkOmJW1/LAYNBV54iDJK8HH7NPd+/9MTqeWER//62YHxrrJvCDydd99Z/tpjLboz7znQF2/vSfufwY9Ne1e9r9JtHKaUvxqWY3UgXX23dNbccOlhQUFxUN9GweVsaWIQNZRfkeByidrnDxRD19N29U5AnChkMO0BMYAwRA4GkPAKuZc/2F8JWTDlB716sCIm9PXcz1K9+/lCc4erstABQmP3U8LBvlV2VJr8yyIHMSv+LUk1QmCzADBjQnrB0dT9TT0/243NfqXx8szwaAzq6Q1bDJnWnrmlKV3EZVchvvJbfQ2nqmDLDqD0/YXFqs8t0l/Haxu3j+vOPDO9ifu4P9jwPAeSk6RE/RpHc+4KefL8waYWEDrOPX9ol/cycA1KH7pvCTsxFAPxZGXQ1YmDhlgNIHsoWQd5wONw4JxgfhwmeKXSUjXbq0Oi/j80el28UjqpdqK1ivcCB7KJwXTuHKcwWAPtPCoJkShy7kjKU3dIXLAvQyVdq1C3WVXNbE2RgUOphuqVXH3T8DAFTcPgRQEEuLAAAAAElFTkSuQmCC":2===t?e+"fvM55PfGm/K3O233vuO+638e9H5ko/ED+UPPR+mPHp9BP9z7nfP78L/eE8/sl0p8zAAAAIGNIUk0AAHolAACAgwAA+f8AAIDpAAB1MAAA6mAAADqYAAAXb5JfxUYAAAJKSURBVHjanJJfSJNhFMaf9/02R9MFCVZLUOgfpLMCmwrd7KIIm6X4fXoTY1oXltaN86oEi4xodtNNeNMHJZQ0gpDQmUKEyUAiyKCFW4PNtSFMoyKJSp4uputbJIUX5+K855zfe85zDkhiza4u2+HXn4M64dcBvw5BTotLtyDJ49KvI2fapK/Q/8qkwAjYiEHj4rrBG+ft4p+AB51f8pKazxxDY/djhLYj95bJLKG5fR+w5whUVxNUtR6qOiHUrmABNH3AkgcoqsBM11O56gvVUy2GV6CQNA/WjFdkMpnyhYV0NjZOAf6ksQMZCGQL3e526fUWm0kKrlAJRT7CUXeac+Gp3bRTaJpHXsReoLl3yGQAKPUtlaJh8yHxKI0s+C3xLHHXwjIqlbXtTKc/lKTScaRSFItMAWReB4WtdfdMJCVJTI18xihLNzFCyWXC4WxjMpksjiOK5BytjXIGUH0XCowjkFsESeF27BQLSy9F/2FK0ip6wa2VtV7OxxNF8XgciUQCKpMCZFoaRdQ6PXIHshvQDtACUJDARA/tVTVe6rHrSs97mMPh16j3vQECvpKc4iSLWzrGqXWMrahnx6h1jP5oPRf8Ho1FLA5nG/c7vayq8TIajdoikRi0nqCEdn9gDaCQLNVOXZOuk310nbhCV0Mvhx+OWlbhykGnh+Hou20sy2rUdLtbAJxUfs9PwW9PQM4qjuqjfDEd6ssX+VP56kdZ/+s80H9nZJcBYDxT6x8b+vspDw4Fbf+TuC7gpn7ZtoFCSdJE0vxrAN8Jcr/DWZzEAAAAAElFTkSuQmCC":3===t?e+"fvM55PfGm/K3O233vuO+638e9H5ko/ED+UPPR+mPHp9BP9z7nfP78L/eE8/sl0p8zAAAAIGNIUk0AAHolAACAgwAA+f8AAIDpAAB1MAAA6mAAADqYAAAXb5JfxUYAAAMuSURBVHjaZJN/aNR1GMefz+f7/d6P3aZGDGVKERLDbXdMJAQhlr+ujWo62g5DpUBiEyJjpxi0ZRtyDSQvV0cDd2uw213b1EHiFjbGZq5bIbc5dTuyybRyK+ZCDrG0evWHdwfWHx8+PDwPz/vzeb2fR451DGvpQB2ODJvnP24zDkewD7Zct6h9qD1j4TzPWNgsip80isbCxuS7vzinGm5aZwcwbwVPGoAhgAIEsAAN2NKxSscmYKRvE1iRPrY3Vt7Ski4WQKaJOmbjyF3WS//3jfr4hVXGEA55J5aXc+ZMdF0yOZWbFtCAKtx5zCUQLQBk32svPFJ8eHN16u+fCn6fv+MErKWlRWdvPzr9QpUVnIroxravlYz0tTvWdi9XRFGA6ugKOMPh7qHu7u5Ue3s7ra2tBIMnaG4+Sl1dHTU1NZSXl7P42x39zRxKYl82mYD8Q0wA8bjFmv855Xqzdu/swsICDx78xfz8r0xMXKa+/iBer5fx8W+PDi22PjH43pKSoi2bzIS+reVlUYCVn18q11hl9vb2GIFAgFQqxczMDKFQCK/Xy8WLF4ozkN2e00o8O07YA1KpxCUCyKYSUX1fxDQgc3NzRjAY/DMej+Pz+ejpiTkzAAEpqfpEJHeP2PZJXO32VBsbKryydY3IPZB1a3IVIH6/n1AoREVFBWmQjzknK7aLHm4bWXs5cel48uq0ziQGolE9e/uG8vsPceDttygrK8s2cBfkZ9zQ8syGbeaVyQmp3v8VNXWDvFo3SPX+8/hqzxEPjqiD9X5eqqoiN8fFjzeu5wHidh9xZTjIgZr1BqAaWi6Zm3e8z/OVDZS90kBv74AdUH7/IbZu3oJps0h8N7N62IXpLt2VnVbZWfKc+jTx+aM/3bti85RuZ3RsvBjQxFgWO9VnTSebzB+SMyvhtMMTFsv9+l4r26Czq0sxcV9F+3eprnOJwumr14ozpMMfnLV/duQjPdeDmiTiaGrutLs3Nhjujc86sxD/uHs/DxCPjFrbXly0N7ZEbR9GcPb0jz4NS/q/1P/nwlOFlYpOrZ4UkeUiOt8nRk6xyGNzT3YXTGBZeqEcgP53ACxeTBjELwuFAAAAAElFTkSuQmCC":4===t?e+"fvM55PfGm/K3O233vuO+638e9H5ko/ED+UPPR+mPHp9BP9z7nfP78L/eE8/sl0p8zAAAAIGNIUk0AAHolAACAgwAA+f8AAIDpAAB1MAAA6mAAADqYAAAXb5JfxUYAAAMNSURBVHjalJNfaFt1FMfP796bm9hublCwa93AVd3W5d67ddisFFw1lovUl7r0jx2rWWW6prpCkzfrUwjVFx0LwSrYPtiO0YJPDsuwIOJKq1PL0q43iZ3OuUp04p8owmbl40PXMgaCPnzhcPjCOef7PV8BxD6WETrKjXcviUbjTlW870/ta9mqfiqv1kuRQePjk68pkj4FSfX66HRA8ujfDPapvveWN4n1xKAC5H9CB3SRo767m9uhvRxQUGXAEXOt3uCodViWpT4Yi+tC1Rrhj99/luV8QQ43unrkxWaNVSqvXSNgHSeQSqU2A4Zt2xUdHR3bp6amwp8uTNU91jRgij2PAWg1da+sTwmeGTv768TExN8jIyOk0xlOnTpNMpkiFovR3t6O67rcuPHDJkCtr6U7zVH/gffPKrwravLzC75EIkGxWOTWrVWKxR+Zn79EPB7HdV3m5uYaAK12/xfmxm0P1uwW62D36p77nzdXVr4Txwn5h4aGVkqlEp6XJ5PJ4LouMzMzDYAGiPXkGwGJLGIAyqmPYod6sEM9vziRF0xALMvS0+n0zdnZWTo7O5mcnNwHaNevi27bqN0v+w1pWyj5AOUEjygn1I3VeLzaund/xfj4uAASi8WWM5kMLS0tAAYgV69+K5cvvyq/zZ7TpG1hzZaqbZbsDR3DPnSi2n6ka0uhUJB8Pt+QSCTo7++nqamJ204YXV1PG5aF2nFxUgn7PlGAWIefVXYoihVufcBWorLZrOTz+YMDAwN/tba2UlZWRi6Xq7itmQbb9JnU25qMvvmRAKrmoafEqY/edOqf2bljV/iebDYrgPT29q6Ew2FM06RQKFQMDw+L4ziabaP3nXwpIBy9oACVnBblHOh52N4Vqaxr7jYAFQwGty4uLm72PE/3PK8yt+QZuawnjgSN0TOiDj36nCmP9364pjiY1hJ67RX8F5dMBUjtW7Xav+Xh3PRnIiK6CF/qd/66886YHvW3Sfh8lQHfy11Z2MCegBgioknbCZQTPr1l71di/IcUqjsgLfHzvn8GACNDKumTxWELAAAAAElFTkSuQmCC":5===t?e+"fvM55PfGm/K3O233vuO+638e9H5ko/ED+UPPR+mPHp9BP9z7nfP78L/eE8/sl0p8zAAAAIGNIUk0AAHolAACAgwAA+f8AAIDpAAB1MAAA6mAAADqYAAAXb5JfxUYAAANBSURBVHjaXJNfSGR1HMXP73fvdcYdo7Vy1KRlZ9DdnOvv5uTODK0s1mxDyKIYSRYoUwQikkgzPUS0RuW6QRCEuIiM/XuxNdiH6m17WnZFCMSHtjuOszONf0ZnGgW1iLbw9DBl0sPhy3k5HDjfD0h6w/VvSJJC8a5sOPeUYQ1TIjAuPOc+kN6Kae2JthodGBCVrSEdpmXAd8pJUrb2julgiWgJ9MMXABIXYADApQA0ACLc8Jjg9bAkKbhbD5LimDTgNQn15sc6SZD1onyPZIAUSyQOSS124oLzDxL7hwRJjaTIFbYcUJ5xB0lYp29oZ8+OypZnPhfvkXiHdGz8nHHs7++6e+vede6UiiiVio69vR2v1+2S5slqQRJ4XvdXkBS7O+uuUv43bO79UvPZp4nfr8/N/Tk7O8urVz9cu3x5zH6x76Xvuru7f+zq6joIhUKFYrHYSBJA4yVBUm5sbWPm15nqH1bvOpRScnBwcL1QKPD+/b+4vV3k0tIy4/E4I5EIFxcXu0nKckDwWUlSV6peqGCUW/mvJUmoNr82MTHBg4MD2rbNqakpRiIR3r59a5ykzOc3QBJob5txkZSbuQ00h/q5ub7htZSJ9NYmlDLF5OQkFxYW2NfXx/n5+YskhWk2G0p9IV5BXgDBAZ1k5Z07tx6wAlHmcjlHjrUim13D8vIaYrEYr12bZmdnJ0k6ygvVHi0GOD2SpHGPhApGmclkKjKZ15HJpHHzJrV4PM6RkRF2dHQwm83WeTweMTw8cCwA1YKkUwWjVMEofaFXeS99w1CksKwWIxaLsaenh1VVVUyn0yf8fmBoKCpIoqeBAr3n50DywdXVlWorEGUqufp0imnpM8eEaZpaPB5nOBymrutMpVKuM2dGdQvjGh+icfFxCCA0YJB0tKC9Mpn8qTKZhLSS0BOJUWmaprBtu8K2bW1lZeVR27alUq3SwpDBh2t1fAUN/eepkYfCOvW26/grWxNB6XukvYJJwgKE+c1zUs270TQdkmq4WeKtTwS+hETiCgUJafrb/89CWTU9/8JT9k2UnP7HN1Ag+OQV8Ps6Yb78vigj/a08ahGCaGzql/zIrbmhy/9IzAmSztMvzJz8ewAvdf7cUVI5hQAAAABJRU5ErkJggg==":6===t?"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAAAXNSR0IArs4c6QAAAeBJREFUOBGtkj1oU1EUx8+5fSC00VZoCwpOtUOcBMHFdhA0g5ODg0HSDg0EuoibOrTRodBdhWIMlCAFFTMphCqVakgGcS2InSoiQQ22SUxe373H+7+ax2uJkz3w7rnn6/fOvecSHaQsfqjNLLyvCXQvbrValUqlItGYihrNts50ds0b6Ki/uw+CgLTWXdPpEHC7/Pl0xzenuE8lfd/EYe/JtAaK/wlotnSm7QdPs2dHv/7yg2ew9wN6dcBIml2rxYLG9hdi3mShLWE6QSJjXuzI8QfnRxtdUKlUEmamRCLh6uD3sLTq9aSQqnl96jr+4nkeBYHO+9Zvww+RAzHGWO6eO/wL8E1GickvJ8fX/6QSXV3ZyBsmHCMEAP5fUiwWBV8U4o7QWb0Q175+7gK2RVE8SEaOseKJ/ktr5W7B/gnA7wCHLr7asPs4HPJycqTR0utM6snAlXdhMWIA9LwDBCHyeOLozvf2KrF6G7tWvkEUXraL9wKEGfLo3OGfuvnajvDjUPryFHPWuCq7FAqFeTuBLGyMEV0opbKpVOqOe4mydKa/3vjxQrc6W0OD49PRYhQhEQB0gElgD58DYvm2ePKWpS64h2Ro13WOu2a6N3zz033kQHK53Bx0Op2+C30g8htq3/HPc2QfaQAAAABJRU5ErkJggg==":7===t?"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAAAXNSR0IArs4c6QAAAdVJREFUOBFjYKAQMIL0/9ztovn31991YLP+/2f4z8TIz/DvvyQjE6MNl9f+ozA7Tpw48R8IGCwtLcH6QOIsIILddc91IKUJYv/fZiv65dvfQ4wMTKu4Q47ANYPk/vz5A6JQANgAmMj/pTaCn9/+2M3AyHSYJ/poIQMD3CKwkr9//8KUwmm4Af/nWvN+/Ppl539GhisCKQEZjIyM/+GqoAyQC4DiKMJgA/7PNOZ6/+XdVqD3HgtJ6cQzMjb8Q1FFyIC3Hz7mAwPHFmj83bd3z19506ECDAygLkaGKSIVd6bCDPv37x8DKBCRAdgFIuV32oGCIIwXYAtEJmQdnedeJbedefUfRCOLw9ggA9ANQTHg64+/6T9//zsAomGakGlQLKDHBNyAqqNPDH7++qfFyMwU+evXP00QH1kziA3SjNMFX7/9Tf/x68/qBjOxF99//VkD4mMzAN0F4EjN2v+K58+XT89AsQCM/cfAtCALDG5lFh4+qWmOYl8WL15cD4yBBpCBoHQAigkmJqaG2NjYRrAXvr1/H/nz9/9Xf/8y5v/49bcHRAO98wokDtIEUggyAOYFEBskBpIDg7AV189ELL9eBeODaBAfJI4sNmfOnDoQRhajmA0AtPr0ppdKGGIAAAAASUVORK5CYII=":8===t?"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAAAXNSR0IArs4c6QAAAO5JREFUOBFjYBgFRIfAjRs3eI8dO7bz+PHjRsiaWJA5uNhnzpxhffny5dr///+7MjExgfQ4w9QywRggev/+/Rx79+6NRBYDamJ8//79/J8/f7r+/v373q9fv6KQ5VEM+Pbt24rv378v27ZtWwFMEZDdCdQUDdT8+u/fv+4uLi4vYXIgmhGZs3HjRr9///6tBYoxA3EqEPMAXTCBkZHxKzMzs6Ofn99pZPUgNooBIIGVK1eCvLAEqJEB6F9GIP0XSPuFhoZuB8mjAwwDQAoWL16cAtQ4G6o4MS4ubgGUTTw1b968wrlz51YRr2PkqgQA82JlH8nI1QYAAAAASUVORK5CYII=":9===t?"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAAAXNSR0IArs4c6QAAAPlJREFUOBHtULkNg0AQPJBBogVyKICE1CSkxIgCqMkFUAApiQlISCiAAlwABIjfM2dZOnwteKXTfjNzuyvE34zfE7Rt65/n+bBtOwuC4MV+13XuPM+FaZp5GIa9yrmpCeNpmh5wdxCeTdNErI3jWEPUgwB7ssY6TRNYliUzDOMJgk9PEMmIe/iMuWraCmxWVeWu6ypFmJNsWVYUx7FcibWvaROwgTXEvu8Sg18FRhfbtn05F69NUJalC4EaKA9PHgwiXKd3HCdKkuQyhTbBMAwFCJLMsfkd14HzcZ8C/nJEkwDVjuPIAaxBitI0ffExZg3CuYr9x58LvAEtbX2YkfGdBQAAAABJRU5ErkJggg==":11===t?"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAAAXNSR0IArs4c6QAAAO5JREFUOBFjYBgFRIfAjRs3eI8dO7bz+PHjRsiaWJA5uNhnzpxhffny5dr///+7MjExgfQ4w9QywRggev/+/Rx79+6NRBYDamJ8//79/J8/f7r+/v373q9fv6KQ5VEM+Pbt24rv378v27ZtWwFMEZDdCdQUDdT8+u/fv+4uLi4vYXIgmhGZs3HjRr9///6tBYoxA3EqEPMAXTCBkZHxKzMzs6Ofn99pZPUgNooBIIGVK1eCvLAEqJEB6F9GIP0XSPuFhoZuB8mjAwwDQAoWL16cAtQ4G6o4MS4ubgGUTTw1b968wrlz51YRr2PkqgQA82JlH8nI1QYAAAAASUVORK5CYII=":12===t?"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAAAXNSR0IArs4c6QAAAgRJREFUOBFjYKAQMIL0nzx5cs6/f/+SCZnFyMh4kpeX105bW/sXTC0TiCEmJpbz58+fc0DMgAe/YWJiCkXWDNILNkBRUfEHUGPw379/3/3+/RtsCIhGwv+A8pFmZmaPQZqQAdgAkICjo+MDoAExQPwPpBFIgzHIRUDv1QLl9yBrhLHBYQDjgOjt27fXAzU0AP0LFgbSmzw8PAKA9H9kdTA2hgH///9n2gIEQEO+mpzfvp2FmfWgeO3kuzAN6DTcCzAJoE0g/zZoXj+8h+Pti7lMLx5deJHpmwKTB9H/09JY74XamoHYGAaABIFh8PemhAb//3//1wBN4/r769fsRwmu0x8luUrdjXRov/v++sM/f/5a4DOA4RMrZ+dOq7C1QC8Z/P/7/8K/P38z/nz/+fjfn98+QDf4qq0/NgmvAaCYAHrlpziDzI0/f//e+AuMjb9//jH9+8dQrrL6yFmQZhDA6gWQBDAaG+Pu79/+8OudjX9//4kAeqcLKLbm7+9fHf8bGuD64AyQJhj4+fPnpaTHj5se3Xm08d/fv57AGJmgsupwubqIbtSP778enNm/IhymFqsB6enpvx/fO+IL9ILbn39/L6oIaJaBNDDOmvVb8Ldg2I9vv2yAYQNOAlgNACn+zfD/+r+//+4x/mMoAGkEiYGA4oEDP1iZmCp3a4mpQEQoJAFYGTPePuR04gAAAABJRU5ErkJggg==":13===t?"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAyJpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuMy1jMDExIDY2LjE0NTY2MSwgMjAxMi8wMi8wNi0xNDo1NjoyNyAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvIiB4bWxuczp4bXBNTT0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL21tLyIgeG1sbnM6c3RSZWY9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9zVHlwZS9SZXNvdXJjZVJlZiMiIHhtcDpDcmVhdG9yVG9vbD0iQWRvYmUgUGhvdG9zaG9wIENTNiAoV2luZG93cykiIHhtcE1NOkluc3RhbmNlSUQ9InhtcC5paWQ6NjlBNDZFRkFFMDUxMTFFOTkyRTA4QkVCNjlCMDYwMEEiIHhtcE1NOkRvY3VtZW50SUQ9InhtcC5kaWQ6NjlBNDZFRkJFMDUxMTFFOTkyRTA4QkVCNjlCMDYwMEEiPiA8eG1wTU06RGVyaXZlZEZyb20gc3RSZWY6aW5zdGFuY2VJRD0ieG1wLmlpZDo2OUE0NkVGOEUwNTExMUU5OTJFMDhCRUI2OUIwNjAwQSIgc3RSZWY6ZG9jdW1lbnRJRD0ieG1wLmRpZDo2OUE0NkVGOUUwNTExMUU5OTJFMDhCRUI2OUIwNjAwQSIvPiA8L3JkZjpEZXNjcmlwdGlvbj4gPC9yZGY6UkRGPiA8L3g6eG1wbWV0YT4gPD94cGFja2V0IGVuZD0iciI/Poa+1GoAAAE5SURBVHjapJO/SgNBEIdzS6x9CR8gEIjNYSkISWNI1BCw0MLCQCqDhWC0SGIltpo3SIrY2NgI1ygoJo1WIZBW0gn+Qc9vYC8sS+5OyMB3c7v3m7mZnTvH9/3EPJaUi+d5V7idf+jvYcV13a9gQ2m/D08xwW9QMIOnCdj8wOVhEhL8C1voxvaDoAJJMsKVtdi2I57fzsqszAWiG9yJpbmGRuQhWnYKy/AOkvCOxKGjUvYGYmnhGKTkNjwzpV1Tw3oBMmEViP3AInRgHS4JSOvqKrANTXhQEWNrQRdSUgXsgUwhCzkqvZjZgmWf8KoJ9DWCH0PPwLC6PsQebMKZbqlJOyouwUCPU4LX4Jy31vAlkO9lIzIB4m/pE1ahDwfGflFuqcKJa+EFhlDVgQnjsz+EJVk78/7OfwIMAP6mWr/ROcXGAAAAAElFTkSuQmCC":14===t?"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAoAAAAKCAYAAACNMs+9AAAAAXNSR0IArs4c6QAAAGBJREFUGBljYCAHzJo1a8L///+ZsOlFEQQqygcqXr1q1SpOdMUoCqGSQe/fv987c+ZMEWTF2BSC5C0ZGRkXEaPwONAZccgKWZA5UPY6QUHBmLCwsO9Y5CBC+HyNUxPZEgCPEyCkHm49GwAAAABJRU5ErkJggg==":""}n.getFilterButtonImageSrc=i},"./dist/plugins/filter/filter-dialog.js":function(B,t,n){"use strict";var e,m,i,g,L,F,P,n,G,U,l,H,z,V,Y,h,p,d,Z,W,r,v,Q,J,K,X,q,$,tt,b,a,nt,o,et,it,rt,u,ot,at,ut,st,s,ct,ft,lt,ht,dt,vt,mt,gt,pt,bt,yt,y,wt,Mt,Ct,St,Tt,At,It,xt,c,Nt,kt,Dt,_t,Et,w,jt,Ot,Rt,Bt,Lt,Ft,Pt,Gt,Ut,Ht,zt,Vt,Yt,Zt,Wt,Qt,Jt,M,C,Kt,Xt,qt,$t,tn,nn,en,S,rn,on,f,T,A,an,I,x,un,sn,cn,fn,ln,hn,dn,vn,mn,gn,pn,bn,yn,wn,Mn,Cn,Sn,Tn,et,An,In,xn,Nn,kn,Dn,_n,En,et,N,An,In,jn,On,Rn,Bn,xn,Ln,Fn,Pn,Gn,Un,Hn,zn,Vn,Yn,Zn,Wn,Qn,Jn;function Kn(t){return typeof t===qt?JSON.stringify(t):i.Common.ft.j(i.Common.ft._(t))}function Xn(t,n,e,i){var r,o;try{e.suspendPaint(),i&&(o={tableName:r=i.nM?i.nM.name():p,colIndex:t,condition:n},(0,L.zA)("filterByCondition",o,e))}finally{e.resumePaint()}}function k(t,n,e,i,r,o){var a=this;a.uit=p,a.frt=o,a.lrt=t,a.Mf=i,a.hrt=(0,m.GC$)(t),a.Wc=n,a.drt=!1,a.vrt=e,a.IB=e.rowFilter,a.mrt=r,a.grt=h}function D(t,n,e,i,r,o){return Un.call(this,t,n,e,i,r,o)||this}function qn(t,n,e,i,r,o){var t,n,t=Hn.call(this,t,n,e,i,r,o)||this,n=Cn;return i._isExternalFilter&&(n=n.slice(0,7).concat(n.slice(n.length-1))),t.Lz=n,t}function $n(t,n,e,i,r,o){var t=zn.call(this,t,n,e,i,r,o)||this;return t.Lz=Sn,t}function _(t,n,e,i,r,o){var t,n,t=Vn.call(this,t,n,e,i,r,o)||this,n=Tn;return i._isExternalFilter&&(n=n.slice(0,4).concat(n.slice(n.length-1))),t.Lz=n,t}function E(t,n,e,i,r,o){return Yn.call(this,t,n,e,i,r,o)||this}function j(t,n,e,i){var r,o,t,r=this,o=n.parent;return(t=r=Zn.call(this,t,Z.gi(o&&o.Ti),!0)||this).Mf=n,t.prt=t.Zc+"_OK",t.brt=t.Zc+"_Cancel",t.yrt=t.Zc+"_Close",t.vrt=e,t.IB=e.rowFilter,t.frt=i,t.Wc=t.Xc(),r}function te(t,n,e,i){var t,n,t=Wn.call(this,t,n,e,i)||this,n=t;return n.YC=230,n.ZC=140,n.vrt=e,n.IB=n.vrt.rowFilter,n.frt=i,n.uY=n.wrt(),n.Mrt(),t}function O(t,n,e,i,r,o,a){var t,n,t=Qn.call(this,t,n,e,i)||this,n=t;return n.YC=416,n.ZC=100,n.Crt=36,n.Srt=24,n.Trt=8,n.Art=7,n.frt=i,n.Irt=r,n.xrt=o?0:1,n.vz=typeof a!==qt&&a?Kn(a):a,n.Nrt=h,n.krt=h,n.Mrt(),t}function R(t,n,e,i,r,o,a,u,s){var t,n,t=Jn.call(this,t,n,e,i)||this,n=t;return n.vrt=e,n.IB=n.vrt.rowFilter,n.frt=i,n.Drt=o,n._rt=r,n.Ert=a,n.jrt=s,n.Ort=u,n.Rrt(o),n.Mrt(),t}e=this&&this.__extends||(Gn=function(t,n){return(Gn=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(t,n){t.__proto__=n}:function(t,n){for(var e in n)Object.prototype.hasOwnProperty.call(n,e)&&(t[e]=n[e])}))(t,n)},function(t,n){if("function"!=typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function e(){this.constructor=t}Gn(t,n),t.prototype=null===n?Object.create(n):(e.prototype=n.prototype,new e)}),Object.defineProperty(t,"__esModule",{value:!0}),t.Brt=t.Lrt=t.Frt=t.Prt=t.Grt=void 0,m=n("Core"),i=n("Common"),g=n("ConditionalFormatting"),L=n("./dist/plugins/filter/filter.js"),F=n("CellTypes"),P=n("./dist/plugins/filter/filter-button-images.js"),n=n("./dist/plugins/filter/filter-ns.js"),G=i.Formatter.GeneralFormatter,U=m.mt.Ese,l=i.Common.CultureManager,H=i.Common.ct,z=i.Common.lt.Oh,V=i.Common.zf.j0,Y=i.Common.zf.dI,h=null,p=void 0,d=m.mt.En,Z=m.mt,W=i.Common.Uf.tR,r=Z.vi,v="left",Q="top",J="float",K="relative",X="gc-ui-filter-subitems-container",q="gc-no-user-select",$="gc-filter-dialog-style",tt="position",b="gc-ui-filter-subitem-item",a="gc-ui-filter-allDate-item",nt="gc-filter-alldates-arrow",u=(rt="gc-filter-hover")+" form-control well "+(it=(et="ui-state-hover ")+(o="gc-filter-item-hover")),ot="gc-filter-button-hover "+et,at="gc-filter-submenu-check",ut="gc-filter-submenu-check-img",st="gc-filter-allDate-check-img",s="gc-filter-alldates-list",ct="gc-filter-addDates-container",ft="gc-filter-subMenu-wrap",lt="top10_dialog",ht="custom_dialog",dt="gc-sub-color-sort",vt="gc-sub-color-filter",mt="automatic",gt="more_color",pt="gc-filter-dialog-color-title",bt="gc-color-item",yt="color-checked-wrap",y="gc-color-item-list",wt="gc-filter-sort",Mt="gc-filter-color-dialog-background",Ct="gc-filter-color-dialog-font",St="gc-filter-color-dialog-style",Tt="TextFilter",At="NumberFilter",It="DateFilter",xt="#D3F0E0",c="#86BFA0",Nt="#000000",kt="#FFFFFF",Dt="transparent",_t="border-box",Et="data-isCheck",w="inline-block",jt="content-box",Ot="#top10-item",Rt="#gc-color-dialog-selected",Bt="#gc-color-dialog-noFill",Lt="thin solid rgb(160,160,160)",Ft="data-checked",Pt="gc-filter-dialog-close",Gt="1px solid #c2c2c2",Ut="gc-filter-top10-rank-illegal",Ht="1px solid #e0e0e0",zt="data-isNeedDialog",Vt="data-isCustom",Yt="data-conditionType",Zt="data-operatorType",Wt="data-colIndex",Qt="data-colorType",Jt="data-color",M="<div class=",C="<span class=",Kt="<img class=",Xt="<li class=",qt="object",$t="</span><span>",tn="</div></div>",nn=".filter-custom-select-input",en="gc-spread-filter-dialog-title",S="display",rn="box-sizing",on="none",f="width",T="height",A="padding",an="border",I="click",x="mouseover",un="mouseout",sn="resize",cn="inherit",fn="#E81123",ln="white",hn="backgroundColor",dn="#f0f0f0",mn=(vn="margin")+"Left",gn=vn+"Top",pn=vn+"Right",bn="font-size",yn=188,wn=16,Mn=1e4,Cn=[[1,"Equal","E",1,0],[1,"NotEqual","N",1,1],[1,"GreaterThan","G",1,2],[1,"GreaterOrEquals","O",1,3],[1,"LessThan","L",1,4],[1,"LessThanOrEquals","Q",1,5],[1,"Between","W",0,1],[1,"Top10","T",8,0],[0,"AboveAverage","A",10,0],[0,"BelowAverage","O",10,1],[1,"Custom","F",1,0]],Sn=[[1,"Equal","E",2,0],[1,"NotEqual","N",2,1],[1,"Begin","I",2,2],[1,"End","T",2,4],[1,"Contain","A",2,6],[1,"NotContain","D",2,7],[1,"Custom","F",2,0]],Tn=[[1,"Equal","E",5,0],[1,"Before","B",5,2],[1,"After","A",5,4],[1,"Between","W",0,1],[0,"Tomorrow","T",6,2],[0,"Today","O",6,0],[0,"Yesterday","D",6,1],[0,"NextWeek","K",6,9],[0,"ThisWeek","H",6,7],[0,"LastWeek","L",6,8],[0,"NextMonth","M",6,6],[0,"ThisMonth","S",6,4],[0,"LastMonth","N",6,5],[0,"NextQuarter","N",6,10],[0,"ThisQuarter","N",6,11],[0,"LastQuarter","N",6,12],[0,"NextYear","N",6,13],[0,"ThisYear","N",6,14],[0,"LastYear","N",6,15],[0,"YearToDate","A",6,0,6],[0,"AllDates","P",6,1],[1,"Custom","F",6,0]],kn=[["Q1","1",6,0,2],["Q2","B",6,1,2],["Q3","A",6,2,2],["Q4","4",6,3,2],["Jan","J",6,0,3],["Feb","F",6,1,3],["Mar","M",6,2,3],["Apr","A",6,3,3],["May","Y",6,4,3],["Jun","U",6,5,3],["Jul","L",6,6,3],["Aug","T",6,7,3],["Sep","S",6,8,3],["Oct","O",6,9,3],["Nov","N",6,10,3],["Dec","D",6,11,3]],Dn=["IsEquals-0-1","NotEquals-1-11","IsGreaterThan-2-1","IsGreaterOrEqual-3-1","IsLess-4-1","LessOrEqual-5-1",et="IsBeginWith-2-2","NotBeginWith-3-2",An="IsEndWith-4-2",In="NotEndWith-5-2",xn="IsContain-6-2",Nn="NotContains-7-2"],_n=["IsEquals-0-2","NotEquals-1-2","IsGreaterThan-2-1","IsGreaterOrEqual-3-1","IsLess-4-1","LessOrEqual-5-1",et,"NotBeginWith-3-2",An,In,xn,Nn],En=["IsEquals-0-5","NotEquals-1-5","IsAfter-4-5","AfterOrEqual-5-5","IsBefore-2-5","BeforeOrEqual-3-5",et,"NotBeginWith-4-2",An,In,xn,Nn],et=new i.Common.ResourceManager(n.SR,"Filter"),N=et.getResource.bind(et),k.prototype.Hc=function(){this.Dn(this.Urt()),this.Fz()},k.prototype.Hrt=function(t){return(0,P.getFilterButtonImageSrc)(t)},k.prototype.Urt=function(){var t=(0,m.GC$)(d("div")).attr("id",X+"_"+this.frt);return t.addClass($+" "+q+" "+ft),t.css([tt,S,rn],["fixed",on,_t]),this.grt=t,(0,m.GC$)(this.lrt).append(this.grt),t},k.prototype.rf=function(){return"none"!==this.grt[0].style.display},k.prototype.$c=function(){(0,m.GC$)("."+ft).hide(),this.grt.show(),this.zrt()},k.prototype.NK=function(){this.grt.hide(),this.grt.find("."+u).removeClass(u)},k.prototype.Vrt=function(t){return this.uit=t,this},k.prototype.zrt=function(t){var n,e,i,r,e,o,i,a,u,s,a,r,c,f,l,h,d,o,n=this.hrt.offset(),e=this.mrt.Fc.offset(),i=document.documentElement,r=e.left,e=e.top,o=i.clientWidth,i=i.clientHeight,a=this.grt.width(),u=this.grt.height(),c,f=this.hrt.parent().parent().offset(),l=f.top,h=this.Wc.offset(),d=this.Wc[0].getBoundingClientRect(),r=h.left+this.Wc.width()+a-r>o?(s=-1*(a+2)+d.left+"px",!1):(s=this.Wc.width()+d.left+"px",!0),o=n.top-h.top,a=i<l+o+u-e?e+i-u-f.top-6+d.top:o+d.top;this.grt.css([v,Q],[s,a+="px"]),t&&t.call(this,r)},k.prototype.Yrt=function(t,n){var e=this,i,r;Xn(t,n,e.Mf,e.IB),this.mrt.close()},k.prototype.Zrt=function(){var t;(0,m.GC$)("."+o,this.grt[0]).trigger(I)},k.prototype.Wrt=function(){var t,n,e,i,n,n,t,n=this.vrt,e=this.Mf,i=n.col,n=n.rowFilter;n&&(n={rowFilter:n,colIndex:i},e.Qy().execute({cmd:"clearFilter",sheetName:e.name(),cmdOption:n}))},k.prototype.Qrt=function(){return this.NK(),h},k.prototype.Krt=function(){this.rf()||(this.$c(),this.Jrt())},k.prototype.Dn=function(t){},k.prototype.Fz=function(){},k.prototype.Jrt=function(){},k.prototype.Xrt=function(){},k.prototype.qrt=function(){},e(D,Un=An=k),D.prototype.Dn=function(t){this.$rt()},D.prototype.Fz=function(){var n=this;n.grt.bind(x,function(t){r(t)}).bind(un,function(t){r(t)}),(0,m.GC$)("."+b,n.grt[0]).bind(x,function(t){(0,m.GC$)("."+b).removeClass(u),(0,m.GC$)(this).addClass(u),r(t)}).bind(un,function(t){(0,m.GC$)(this).removeClass(u),r(t)}).bind(I,function(t){(0,m.GC$)(this).attr("id")!==ct&&n.tot((0,m.GC$)(this)),r(t)}),this.not&&this.not()},D.prototype.eot=function(t){return t!==p&&"TRUE"===t||"FALSE"===t},D.prototype.iot=function(){var t,n,e,i,r,o,a,u,s,c,f,l,h,d,v,t=this.IB.rrt[this.vrt.col],n=this.Lz,o=!1;if(t&&0<t.length&&t[0]instanceof g.Condition)for(s=(t=t[0]).compareType(),c=t.expected(),a=t.expectTypeId(),10===(u=t.conType())&&(s=t.type()),8===u&&(s=0),0===(u=this.eot(c)?11:u)&&(f=t.item1().compareType(),l=t.item2().compareType(),5===Math.max(f,l))&&3===Math.min(f,l)&&(o=!0),h=0,d=W(n);h<d;h++){if((i=0===u&&n[h][3]===u&&o||n[h][3]===u&&0!==u||11===u&&(1===n[h][3]||2===n[h][3]))&&8===u){e=h;break}if(r=n[h][4]===s&&!o||6===n[h][3]&&c===n[h][4]||o,i&&r&&(isNaN(a)||0===a)){e=h;break}}isNaN(a)||6!==a||(e=19),isNaN(a)||2!==a&&3!==a||(e=20,this.oot&&this.oot(kn,c,a)),e!==p&&0!==e?v=(0,m.GC$)("."+b)[e]:!t||3===u||e!==p||2===u&&0===s?0===e&&5===u&&(v=(0,m.GC$)("."+b)[e]):v=(0,m.GC$)("."+b)[W(n)-1],(0,m.GC$)(v).attr(Et,1),(0,m.GC$)(v).find("."+ut).css([S],[w])},D.prototype.Jrt=function(){var t=(0,m.GC$)("."+b).removeClass(u)[0];(0,m.GC$)(t).addClass(u)},D.prototype.aot=function(t){var n;if(0!==t)n=t;else switch(this.uit){case At:n=1;break;case Tt:n=2;break;case It:n=5}return n},D.prototype.uot=function(t,n,e,i){var r=this.Mf,o;switch(t){case lt:o=new Ln(r.parent.j2(),r,this.vrt,lt);break;case ht:o=new Pn(r.parent.j2(),r,this.vrt,ht,this.mrt._rt,i,n,e,this.aot(n))}o&&o.rQ()},D.prototype.tot=function(t){var n,e,i,r,o,a,u,t,t,n=this.vrt.col,e=parseInt(t.attr(zt),10),i=parseInt(t.attr(Yt),10),r=parseInt(t.attr(Zt),10),a=parseInt(t.attr("data-expectTypeId"),10),u=parseInt(t.attr(Vt),10),t=parseInt(t.attr(Et),10);isNaN(a)||(u=e=0),0===e&&1===t?(this.Wrt(),this.mrt.close()):1===e?(this.mrt.close(),this.uot(o=8===i&&0===r?lt:ht,i,r,u)):(t=new g.Condition(i),10===i?t.type(r):t.compareType(r),6!==i||isNaN(a)?6===i&&(t=new g.Condition(i)).expected(r):((t=new g.Condition(i)).expectTypeId(a),t.expected(r)),this.Yrt(n,t))},D.prototype.$rt=function(){},D.prototype.sot=function(t){for(var n,e,i,n="",e=0,i=t.length;e<i;e++)n+=e===i-1?this.cot(t[e],1):this.cot(t[e],0);this.grt.html(n),(0,m.GC$)(this.lrt).append(this.grt),this.fot(),this.iot()},D.prototype.fot=function(){var t=this.lrt.offsetHeight-2,n=this.lrt.offsetTop;(0,m.GC$)("."+b+",."+a).css([A,T,"line-height","white-space","clear",an,f,T,bn,vn],["0 10px 0 0",t,t,"nowrap","both",on,"auto","auto","12px",0]),this.grt.css([v,Q],["100%",n]),(0,m.GC$)(".gc-filter-hotkey").css(["text-decoration"],["underline"]),(0,m.GC$)("."+at).css([S,f,"textAlign"],[w,"24px","center"]),(0,m.GC$)("."+at+" img").css([S,"verticalAlign"],[w,"text-bottom"]),(0,m.GC$)("."+ut+",."+st).hide(),(0,m.GC$)("#"+ct).css([tt],[K]),(0,m.GC$)("."+nt).css([mn,f,T,"background-position"],["5px","16px","16px","center bottom"]),(0,m.GC$)("#"+s).css([tt,S,f],["absolute","none","auto"])},D.prototype.cot=function(t,n){var e="",i=t[0],r=N()[t[1]],o=t[3],t=t[4],e;return M+'"'+b+'" '+Vt+'="'+n+'" '+zt+' ="'+i+'" '+Yt+'="'+o+'" '+Zt+'="'+t+'">'+M+'"'+wt+'">'+C+'"'+at+'">'+Kt+'"'+ut+'" src="'+this.Hrt(11)+'">'+$t+r+"</span>"+tn},D.prototype.qrt=function(){var t,n,t=(0,m.GC$)("."+o,this.grt[0]).removeClass(u),n=(0,m.GC$)("."+b);(0===t.index()?(0,m.GC$)(n[n.length-1]):(0,m.GC$)(n[t.index()-1])).addClass(u)},D.prototype.Xrt=function(){var t=(0,m.GC$)("."+o,this.grt[0]);0<t.length&&t[0].nextSibling?(t.removeClass(u),(0,m.GC$)(t[0].nextSibling).addClass(u)):this.Jrt()},e(qn,Hn=In=D),qn.prototype.$rt=function(){this.sot(this.Lz)},t.Grt=qn,e($n,zn=In),$n.prototype.$rt=function(){this.sot(Sn)},t.Prt=$n,e(_,Vn=In),_.prototype.$rt=function(){this.sot(this.Lz)},_.prototype.cot=function(t,n){var e="",i=t[0],r=N()[t[1]],o=t[3],a=t[4],e;return e="AllDates"===t[1]?'<div id="'+ct+'" class="'+b+'" '+Vt+'="'+n+'" '+zt+' ="'+i+'" '+Yt+'="'+o+'" '+Zt+'="'+a+'">'+M+'"'+wt+'">'+C+'"'+at+'">'+Kt+'"'+ut+'" src="'+this.Hrt(11)+'">'+$t+r+"</span>"+C+'"'+nt+' gc-filterDialog-rightArrow"></span></div>'+this.lot()+"</div>":"YearToDate"===t[1]?M+'"'+b+'" data-expectTypeId="'+t[5]+'" '+Vt+'="'+n+'" '+zt+' ="'+i+'" '+Yt+'="'+o+'" '+Zt+'="'+a+'">'+M+'"'+wt+'">'+C+'"'+at+'">'+Kt+'"'+ut+'" src="'+this.Hrt(11)+'">'+$t+r+"</span>"+tn:M+'"'+b+'" '+Vt+'="'+n+'" '+zt+' ="'+i+'" '+Yt+'="'+o+'" '+Zt+'="'+a+'">'+M+'"'+wt+'">'+C+'"'+at+'">'+Kt+'"'+ut+'" src="'+this.Hrt(11)+'">'+$t+r+"</span>"+tn},_.prototype.$c=function(){(0,m.GC$)("."+ft).hide(),this.grt.show(),this.zrt(this.hot)},_.prototype.hot=function(t){var n,e,i,r,t,o,r,o,a,u;this.grt.show(),n=(0,m.GC$)("#"+s),e=(0,m.GC$)("#"+ct),i=this.grt,n.length<=0||(r=(o=document.documentElement).clientWidth,o=o.clientHeight,u=(a=this.mrt.Fc.offset()).top,r=!(i.offset().left+i.width()+n.width()>r)&&t?i.width()+"px":-1*n.width()+"px",t=e.offset().top+n.height()-u>o?u+o-n.height()-e.offset().top-5:0,n.css([v,Q],[r,t+="px"]))},_.prototype.lot=function(){for(var t,n,t='<div id="'+s+'" class="'+$+'">',n=0;n<W(kn);n++)t+=M+'"'+a+'" data-expectTypeId="'+kn[n][4]+'" '+Yt+'="6"  '+Zt+'="'+kn[n][3]+'">'+M+'"'+wt+'">'+C+'"'+at+'">'+Kt+'"'+st+'" src="'+this.Hrt(11)+'">'+$t+N()[kn[n][0]]+"</span>"+tn;return t+="</div>"},_.prototype.Jrt=function(){var t,t;(this.vot()?(t=(0,m.GC$)("."+a).removeClass(u),(0,m.GC$)(t[0])):(t=(0,m.GC$)("."+b).removeClass(u)[0],(0,m.GC$)(t))).addClass(u)},_.prototype.vot=function(){var t=!1,n=(0,m.GC$)("#"+s);return t=0!==n.length?n.css(S)!==on:t},_.prototype.mot=function(){(0,m.GC$)("#"+s).hide(),(0,m.GC$)("."+a).removeClass(u)},_.prototype.not=function(){var n=this;(0,m.GC$)("."+a,n.grt[0]).bind(x,function(){(0,m.GC$)(this).addClass(u),(0,m.GC$)("#"+ct).addClass(u)}).bind(un,function(){(0,m.GC$)(this).removeClass(u)}).bind(I,function(t){n.tot((0,m.GC$)(this)),r(t)}),(0,m.GC$)("#"+ct,n.grt[0]).bind(x,function(){(0,m.GC$)("#"+s).show()}).bind(un,function(){n.mot()}).bind(I,function(t){(0,m.GC$)("#"+s).show(),n.Jrt(),r(t)})},_.prototype.got=function(){var t=!1,n=(0,m.GC$)("#"+ct);return t=0!==n.length?n.hasClass(u):t},_.prototype.oot=function(t,n,e){for(var i,r,o,r=0;r<W(t);r++)if(t[r][3]===n&&t[r][4]===e){i=r;break}o=(0,m.GC$)("."+a)[i],(0,m.GC$)(o).attr(Et,1),(0,m.GC$)(o).find("."+st).css([S],[w]).attr(Et,1)},_.prototype.Zrt=function(){var t,t=this.vot()?(0,m.GC$)("."+o,(0,m.GC$)("#"+s)[0]):(0,m.GC$)("."+o,this.grt[0]);t.trigger(I)},_.prototype.Qrt=function(){var t=h;return this.vot()?(this.mot(),t=this):this.NK(),t},_.prototype.Krt=function(){var t=this.rf(),n=this.vot();t?!n&&this.got()&&((0,m.GC$)("#"+s).show(),this.Jrt()):(this.$c(),this.Jrt())},_.prototype.qrt=function(){var t,n,n,t;(this.vot()?(t=(0,m.GC$)("."+o,(0,m.GC$)("#"+s)[0]).removeClass(u),n=(0,m.GC$)("."+a),0===t.index()?(0,m.GC$)(n[n.length-1]):(0,m.GC$)(n[t.index()-1])):(n=(0,m.GC$)("."+o,this.grt[0]).removeClass(u),t=(0,m.GC$)("."+b),0===n.index()?(0,m.GC$)(t[t.length-1]):(0,m.GC$)(t[n.index()-1]))).addClass(u)},_.prototype.Xrt=function(){var t,n,n;this.vot()?(t=(0,m.GC$)("."+o,(0,m.GC$)("#"+s)[0]).removeClass(u),n=(0,m.GC$)("."+a),(t.index()===n.length-1?(0,m.GC$)(n[0]):(0,m.GC$)(n[t.index()+1])).addClass(u)):0<(n=(0,m.GC$)("."+o,this.grt[0])).length&&n[0].nextSibling?(n.removeClass(u),(0,m.GC$)(n[0].nextSibling).addClass(u)):this.Jrt()},t.Frt=_,e(E,Yn=An),E.prototype.Dn=function(){this.pot(this.mrt.bot,this.mrt.yot)},E.prototype.wot=function(){var t,n,e,n,t,i,n=this.IB.nrt;if(n&&n.color!==p){if(e=n.isBackColor?0:1,n=n.color,t=this.mrt.bot,i=this.mrt.yot,"{"===n[0]?n=JSON.parse(n):""!==n&&(n=Kn(n)),""===n&&0==e&&t[mt]===p||""===n&&0!=e&&i[mt]===p)return p;t={colorType:e,color:n}}return t},E.prototype.Mot=function(){var t=this.IB.rrt[this.vrt.col],n;return n=t&&0<t.length&&t[0]instanceof g.Condition&&3===t[0].conType()?{colorType:t[0].compareType(),color:t[0].expected()}:n},E.prototype.pot=function(t,n){this.Cot(t,n),this.Sot()},E.prototype.Tot=function(t,n){this.mrt.Aot(t,n),this.mrt.close()},E.prototype.Iot=function(t){var n,e,i,r,o;this.mrt.close(),e=(n=this).Mf,r=t?this.mrt.bot:this.mrt.yot,this.xot&&(i=this.xot.color),(o=new Fn(e.parent.j2(),e,this.vrt,this.frt,r,t,i)).rQ()},E.prototype.Not=function(t,n){var e,i,n,r,e=new g.Condition(3),i=this.vrt.col,n=n?0:1,r=this.Mot();r&&r.colorType===n&&r.color===t?(this.Wrt(),this.mrt.close()):(e.compareType(n),e.expected(t),this.Yrt(i,e))},E.prototype.Sot=function(){(0,m.GC$)("."+pt,this.grt[0]).css([T,"line-height","textIndent","whiteSpace"],["32px","32px","8px","nowrap"]),(0,m.GC$)("."+y,this.grt[0]).css(["listStyle","padding",T,"lineHeight",an,"whiteSpace",f,vn,bn,rn],[on,"2px 0","23px","23px","1px solid transparent","nowrap","140px",0,"12px","content-box"]),(0,m.GC$)("."+bt,this.grt[0]).css([f,an,pn,T,rn,"whiteSpace",J],["75px","1px solid rgb(130,130,130)","24px","22px",_t,"nowrap",v]),(0,m.GC$)("."+yt,this.grt[0]).css([S,f,T,"verticalAlign",vn,"textAlign",J],[w,"22px","22px","middle","0 3px 0 2px","center",v]),(0,m.GC$)("."+yt+" img",this.grt[0]).css([gn,S],["3px",on]),(0,m.GC$)(".gc-color-dialog-more-color",this.grt[0]).css([A],["0 5px 0 0"]),(0,m.GC$)("."+yt+" img.checked",this.grt[0]).css([gn,S],["3px","block"])},E.prototype.Cot=function(t,n){var e,i,r,e;this.frt===dt?(e=N().SortCellTitle,i=N().SortFontTitle,r=this.wot()):this.frt===vt&&(e=N().FilterCellTitle,i=N().FilterFontTitle,r=this.Mot()),this.xot=r,e=this.kot(e,t[mt],t.data,0,r),""!==(e+=this.kot(i,n[mt],n.data,1,r))?this.grt.html(e):this.drt=!0,(0,m.GC$)(this.lrt).append(this.grt),this.grt.find("canvas").forEach(function(t,n,e){var t,i,r,o,a,u,t=t,i="{"===t.textContent[0]?JSON.parse(t.textContent):t.textContent,r=73,o=20;t.width=73,t.height=20,a=t.getContext("2d"),m.W.setFillStyle(a,i,0,0,73,20,u=function(){a.fillRect(0,0,73,20)})})},E.prototype.kot=function(t,n,e,i,r){var o,a,u,s,c,f,l,h,r,t,n,t,u=!1,s="checked";for(l in r&&i===r.colorType&&""!==r.color?a=Kn(r.color):r&&""===r.color&&i===r.colorType&&(a=r.color),c=M+"'"+pt+"'>"+t+"</div><ul class='"+(o=0===i?Mt:Ct)+"' style='padding: 7px 0 0 0;margin:0'>",f=0,e)e.hasOwnProperty(l)&&f<5&&(h="",a!==p&&a===l&&(h=s,u=!0),c+=Xt+'"'+y+'" '+Wt+'="'+e[l]+'" '+Qt+'="'+i+'">'+C+'"'+yt+'">'+Kt+'"'+h+'" src="'+this.Hrt(11)+'"></span>'+M+'"'+bt+'"><canvas>'+l+"</canvas></div></li>",f++);return 0===f&&a===p||n===p&&1===f?"":(n!==p&&(r=0===i?N().NoFill:N().Automatic,t="",a!==p&&""===a&&(t=s,u=!0),c+=Xt+'"'+y+'" '+Wt+'="'+mt+'" '+Qt+'="'+i+'" '+Jt+' = "">'+C+'"'+yt+'"><img  class="'+t+'" src="'+this.Hrt(11)+'"></span>'+M+'"'+wt+'">'+r+"</div></li>"),5===f&&(n=u||a===p?"":s,t=0===i?N().CellColor:N().FontColor,c+=Xt+'"'+y+'" '+Wt+'="'+gt+'" '+Qt+'="'+i+'" >'+C+'"'+yt+'">'+Kt+'"'+n+'" src="'+this.Hrt(11)+'"></span>'+M+'"'+wt+' gc-color-dialog-more-color">'+t+"</div></li>"),c+"</ul>")},E.prototype.Jrt=function(){var t=(0,m.GC$)("."+y,this.grt[0]).removeClass(u)[0];(0,m.GC$)(t).addClass(u)},E.prototype.Fz=function(){var o=this;o.grt.bind(x,function(t){r(t)}).bind(un,function(t){r(t)}),(0,m.GC$)("."+y,o.grt[0]).bind(I,function(){var t,n=(0,m.GC$)(this).find("canvas"),e=(0,m.GC$)(this).attr(Wt),i=(0,m.GC$)(this).attr(Qt),r=!1;n&&0<n.length?"{"===(t=n.text())[0]&&(t=JSON.parse(t)):t=(0,m.GC$)(this).attr(Jt),0===(i=parseInt(i,10))&&(r=!0),"more_color"===e?o.Iot(r):o.frt===dt?o.Tot(t,r):o.frt===vt&&o.Not(t,r)}).bind(x,function(t){(0,m.GC$)("."+y,o.grt[0]).removeClass(u),(0,m.GC$)(this).addClass(u),r(t)}).bind(un,function(t){(0,m.GC$)(this).removeClass(u),r(t)})},E.prototype.Dot=function(t){var e=0;return t.forEach(function(t,n){(0,m.GC$)(t).hasClass(o)&&(e=n)}),e},E.prototype.qrt=function(){var t,n,t,t=(0,m.GC$)("."+y,this.grt[0]),n=this.Dot(t);(0===n?(0,m.GC$)(t.removeClass(u)[t.length-1]):(t=t.removeClass(u)[n-1],(0,m.GC$)(t))).addClass(u)},E.prototype.Xrt=function(){var t,n,t,t=(0,m.GC$)("."+y,this.grt[0]),n=this.Dot(t);n===t.length-1?this.Jrt():(t=t.removeClass(u)[n+1],(0,m.GC$)(t).addClass(u))},t.Lrt=E,Zn=m.Tse,e(j,Zn),j.prototype.rQ=function(){},j.prototype.Mrt=function(){this.$c(),this.Dn(),this._ot(),this.Eot()},j.prototype.Dn=function(){},j.prototype.Eot=function(){var t=this,n=t.Wc.width(),e=t.Wc.height(),i=t.Fc.width(),t=t.Fc.height();this.Wc.css([tt,v,Q],["fixed",(i-n)/2+"px",(t-e)/2+"px"])},j.prototype._ot=function(){var e,t,e=this,t=function(t){t.stopPropagation(),e.jot(),e.Oot(),e.close()};(0,m.GC$)("#"+e.prt).bind(I,function(t){var n;t.stopPropagation(),e.Rot()&&(e.Oot(),e.close())}),(0,m.GC$)("#"+e.brt).bind(I,t),(0,m.GC$)("#"+e.yrt).bind(I,t).bind(x,function(){this.style.backgroundColor=fn,this.style.color=ln}).bind(un,function(){this.style.backgroundColor=cn,this.style.color=cn}),(0,m.GC$)("#"+e.prt+", #"+e.brt).bind(x,function(){(0,m.GC$)(this).addClass(ot)}).bind(un,function(){(0,m.GC$)(this).removeClass(ot)}),(0,m.GC$)(document).bind(sn,function(){e.Eot()})},j.prototype.tot=function(t){var n=this.vrt,e,i,r;Xn(n.col,t,this.Mf,n.rowFilter)},j.prototype.Rot=function(){return!0},j.prototype.jot=function(){},j.prototype.Oot=function(){},t.Brt=xn=j,e(te,Wn=xn),te.prototype.wrt=function(){var t,n,n,e,i,t={rank:0,item:10},n=this,n=n.IB.rrt[n.vrt.col];return t=n&&0<n.length&&n[0]instanceof g.Condition&&8===n[0].conType()?{rank:e=n[0].type(),item:i=n[0].expected()}:t},te.prototype.Dn=function(){var t=this.Bot();this.Xc().html(t),this.setStyle(),this.Fz()},te.prototype.Lot=function(t){1===t.value.length?t.value=t.value.replace(/[^1-9]/g,""):t.value=t.value.replace(/\D/g,"")},te.prototype.Fz=function(){var t=this;(0,m.GC$)(Ot).bind("keyup",function(){(0,m.GC$)(this).removeClass(Ut),t.Lot(this)}).bind("paste",function(){(0,m.GC$)(this).removeClass(Ut),t.Lot(this)}),t.bindMoveEvent((0,m.GC$)("."+en,t.Wc[0])[0])},te.prototype.Rot=function(){var t,n,e,i,r,t=this,n=parseInt((0,m.GC$)("#top10-rank").val(),10),e=parseInt((0,m.GC$)(Ot).val(),10),i=new g.Condition(8),r=!1;return e?(r=!0,i.type(n),i.expected(e),t.tot(i)):(0,m.GC$)(Ot).addClass(Ut).focus(),r},te.prototype.Bot=function(){var t="",n="",n=1===this.uY.rank?'<select id="top10-rank"><option value="0">'+N().top+'</option><option value="1" selected = "selected">'+N().bottom+"</option></select>":'<select id="top10-rank"><option value="0" selected="selected">'+N().top+'</option><option value="1">'+N().bottom+"</option></select>";return t+='<div class="gc-popup ui-widget '+$+'"><div class="ui-dialog-titlebar ui-widget-header ui-corner-all ui-helper-clearfix gc-spread-filter-dialog-title"><span class="gc-filter-dialog-title">'+N().Top10Filter+'</span><span id="'+this.yrt+'" class="gc-filter-dialog-close">\xd7</span></div><div id="top10-desc"><div class="top10-show-text">'+N().Show+'</div><div class="ui-dialog-hr"></div></div><div class="top10-wrap">'+n+'<input id="top10-item" class="gc-filter-top10-rank" type="text"  value="'+this.uY.item+'" /></div><div class="top10-footer top10-wrap"><input type="button" id="'+this.prt+'" value="'+N().OK+'"><input id="'+this.brt+'" type="button" class="gc-filter-dialog-close" value="'+N().Cancel+'"/></div></div>'},te.prototype.setStyle=function(){(0,m.GC$)(".gc-popup",this.Wc[0]).css([hn,f,T],[dn,this.YC,this.ZC]),(0,m.GC$)(".ui-dialog-titlebar",this.Wc[0]).css({height:"34px",background:"white",fontSize:"12px",fontWeight:"normal",color:"#222",border:"none",borderRadius:"0"}),(0,m.GC$)(".gc-filter-dialog-title",this.Wc[0]).css({float:"left",height:"34px",lineHeight:"34px",display:w,marginLeft:"15px"}),(0,m.GC$)(".top10-show-text",this.Wc[0]).css({float:"left"}),(0,m.GC$)(".ui-dialog-hr",this.Wc[0]).css({position:"absolute",left:"24px",right:"0",margin:"0 5px",height:"12px",borderBottom:Ht,borderWidth:"thin"}),(0,m.GC$)("#top10-desc",this.Wc[0]).css({height:"24px",lineHeight:"24px",marginLeft:"15px",position:K,fontSize:"10px"}),(0,m.GC$)("#"+this.yrt,this.Wc[0]).css({float:"right",fontSize:"18px",width:"36px",height:"34px",lineHeight:"34px",textAlign:"center"}),(0,m.GC$)("#top10-rank",this.Wc[0]).css({width:"120px",marginRight:"20px",height:"21px",textIndent:"5px",fontSize:"inherit",padding:"0",marginBottom:0}),(0,m.GC$)(Ot,this.Wc[0]).css({width:"60px",textIndent:"5px",padding:0,height:"21px",margin:0,fontSize:"inherit",display:w}),(0,m.GC$)(".top10-wrap",this.Wc[0]).css({padding:"0px 12px",textAlign:"right",color:"#9B9C9C",fontSize:"13px"}),(0,m.GC$)(".top10-footer",this.Wc[0]).css({padding:"20px 12px 12px"}),(0,m.GC$)("#"+this.prt+", #"+this.brt).css({width:"75px",height:"23px",lineHeight:"21px",fontSize:"12px",backgroundColor:"#E1E1E1",border:Gt,padding:0,display:w}),(0,m.GC$)("#"+this.prt,this.Wc[0]).css({marginRight:"12px"})},Ln=te,e(O,Qn=xn),O.prototype.Dn=function(){var t,t,n,t=this.Fot();this.Wc.append(t),t=(0,m.GC$)("#color-spread-wrap",this.Wc[0])[0],this.eU=this.Pot(),n=this.Got(t),this.Uot(t,n),this.Fz(this.Nrt,this.krt)},O.prototype.Pot=function(){return xt},O.prototype.Got=function(t){var n=this.Irt.colorNumber,e,i,r=!1,i=this.Crt*this.Art+4;return Math.ceil(n/this.Art)>this.Trt?(e=this.Srt*this.Art,r=!0,i+=20):e=this.Srt*Math.ceil(n/this.Art),(0,m.GC$)(t).height(e),(0,m.GC$)(t).width(i),r},O.prototype.Hot=function(t,n,e){var i,r,e;t.suspendPaint(),i=t.options,r=n.options,i.showHorizontalScrollbar=!1,i.allowContextMenu=!1,i.showVerticalScrollbar=e,i.scrollbarMaxAlign=!0,i.tabStripVisible=!1,i.allowUserResize=!1,i.allowUserDragDrop=!1,i.allowUserDragFill=!1,i.allowUserZoom=!1,i.grayAreaBackColor="#fff",r.colHeaderVisible=!1,r.rowHeaderVisible=!1,r.selectionBackColor=Dt,r.selectionBorderColor=Dt,r.gridline={showVerticalGridline:!1,showHorizontalGridline:!1},r.isProtected=!0,n.setColumnCount(this.Art+2),e=this.Irt.colorNumber,n.setRowCount(Math.ceil(e/this.Art)+1),n.defaults.rowHeight=21,n.defaults.colWidth=36,n.setColumnWidth(0,2),n.setColumnWidth(this.Art+1,2),n.setRowHeight(0,2),t.resumePaint()},O.prototype.zot=function(t,n){var e,i,r,o,a;for(a in n.suspendPaint(),e=(this.Art-this.Irt.colorNumber)*this.Crt/2,n.setColumnWidth(0,e),this.Irt.data)this.Irt.data.hasOwnProperty(a)&&(i=(o=this.Vot(i,r)).row,r=o.col,this.Yot(i,r,a,n));n.resumePaint()},O.prototype.Yot=function(t,n,e,i){var r=new F.Button;r.buttonBackColor("{"===e[0]?JSON.parse(e):e),r.marginLeft(3),r.marginTop(3),r.marginRight(3),r.marginBottom(3),i.setCellType(t,n,r,3),e===this.vz&&this.Zot(i,t,n,this.eU)},O.prototype.Vot=function(t,n){return t===p&&n===p?n=t=1:n<this.Art?n+=1:(t+=1,n=1),{row:t,col:n}},O.prototype.Wot=function(t,n){var e,i,r,o;for(o in n.suspendPaint(),i=e=p,this.Irt.data)this.Irt.data.hasOwnProperty(o)&&(e=(r=this.Vot(e,i)).row,i=r.col,this.Yot(e,i,o,n));n.resumePaint()},O.prototype.Zot=function(t,n,e,i){var r,r;t.suspendPaint(),this.Qot&&((r=t.Z_(this.Qot.row,this.Qot.col,3)).backColor="#ffffff",r.borderLeft=new m.LineBorder(c,m.LineStyle.empty),r.borderTop=new m.LineBorder(c,m.LineStyle.empty),r.borderRight=new m.LineBorder(c,m.LineStyle.empty),r.borderBottom=new m.LineBorder(c,m.LineStyle.empty),t.setStyle(this.Qot.row,this.Qot.col,r,3)),this.Qot={row:n,col:e},(r=t.Z_(n,e,3)).backColor=i,r.borderLeft=new m.LineBorder(c,m.LineStyle.thin),r.borderTop=new m.LineBorder(c,m.LineStyle.thin),r.borderRight=new m.LineBorder(c,m.LineStyle.thin),r.borderBottom=new m.LineBorder(c,m.LineStyle.thin),t.setStyle(n,e,r,3),t.resumePaint()},O.prototype.Uot=function(t,n){var t,e,t=new m.Workbook(t);t.xU=!0,e=t.getActiveSheet(),this.Nrt=t,this.krt=e,this.Hot(t,e,n),this.Irt.colorNumber<this.Art?this.zot(t,e):this.Wot(t,e)},O.prototype.Kot=function(){var t,n,t=p;for(n in this.Irt.data)if(this.Irt.data.hasOwnProperty(n)){t=n;break}return"{"===t[0]?JSON.parse(t):t},O.prototype.Fot=function(){var t,n,n,n,e,e,e,t=(0,m.GC$)(d("div")).addClass("gc-popup ui-widget "+St+" "+$+" "+q);return t.css({backgroundColor:"#f0f0f0"}),n=this.Jot(),t.append(n),n=this.Xot(),t.append(n),n=(0,m.GC$)(d("div")).css([A],["0 12px"]),(e=this.qot())!==p&&n.append(e),e=this.$ot(),n.append(e),e=this.tat(),n.append(e),t.append(n),t.append(this.nat()),t},O.prototype.Jot=function(){var t=(0,m.GC$)(d("div")),n=(0,m.GC$)(d("span")),e=(0,m.GC$)(d("span")).attr("id",this.yrt);return t.css([f,T,hn,A,rn],["100%","34px","#fff","0 0 0 12px",_t]),n.css(["float",T,"lineHeight",S],[v,"34px","34px",w]).html(N().ColorTitle),e.css(["float",T,"lineHeight",S,bn,f,"textAlign"],["right","34px","34px",w,"18px","36px","center"]).html("\xd7").addClass(Pt),t.append(n),t.append(e),t.addClass(en),t},O.prototype.Xot=function(){var t=(0,m.GC$)(d("div")),n=(0,m.GC$)(d("div")),e;return 0===this.xrt&&this.frt===dt?e=N().SortCell:0===this.xrt&&this.frt===vt?e=N().FilterCell:1===this.xrt&&this.frt===dt?e=N().SortFont:1===this.xrt&&this.frt===vt&&(e=N().FilterFont),t.css(A,"0 12px"),n.css([T,"lineHeight"],["24px","24px"]).html(e),t.append(n),t},O.prototype.qot=function(){var t,n,e,e,t=p;return this.Irt[mt]!==p&&(n=""===this.vz,e=1===this.xrt?N().Automatic:N().NoFill,(e=(0,m.GC$)(d("div")).html(e)).attr("id","gc-color-dialog-noFill"),n?(e.attr(Ft,"checked"),e.css([hn,A,an,"textAlign","margin"],["rgb(134,191,160)","0 12px",Lt,"center","5px 0"])):e.css([hn,A,an,"textAlign","margin"],[Dt,"0 12px",Lt,"center","5px 0"]),t=e),t},O.prototype.$ot=function(){var t=(0,m.GC$)(d("div")).attr("id","color-spread-wrap");return t.css([hn,A,an,f,"box-sizing"],["#fff","6px","1px solid rgb(160,160,160)","288px",jt]),t},O.prototype.tat=function(){var t,n,e,i,r,o,t=this,n=(0,m.GC$)(d("div")),e=(0,m.GC$)(d("div")).html(N().Selected),i=d("canvas"),r=(0,m.GC$)(i).attr("id","gc-color-dialog-selected");return n.css([tt,A,rn,vn,T],[K,"0 12px",jt,"12px 0","16px"]),e.css([J,f,"text-align"],[v,"60px","center"]),o=1===t.xrt?Nt:kt,t.vz===p&&(t.vz=t.Kot()),""!==t.vz&&(o=t.vz),r.css([tt,v,an],["absolute","70px",Lt]),i.width=188,i.height=16,t.eat(r,o),n.append(e),n.append(r),n},O.prototype.eat=function(t,n){var n,e,t,n=typeof n===qt?JSON.stringify(n):n;t.text(n),e=t[0].getContext("2d"),t=function(){e.fillRect(0,0,188,16)},m.W.setFillStyle(e,"{"===n[0]?JSON.parse(n):n,0,0,188,16,t)},O.prototype.Rot=function(){var t,t=(0,m.GC$)(Bt),t=1===t.length&&"checked"===t.attr(Ft)?"":this.vz;return this.iat(t),!0},O.prototype.iat=function(t){var n=0===this.xrt;this.frt===dt?this.rat(t,n):this.frt===vt&&this.oat(t,n)},O.prototype.rat=function(t,n,e){var i,r,o,i,r,a,i=this,r=i.vrt,o=r.rowFilter,i=i.Mf;o&&i&&i._B()&&(e=e!==p&&e,r=r.col,a={sheet:i,sheetName:i.Zc,col:r,ascending:e,color:t,isBackColor:n,cancel:!1},i.ki(m.Events.RangeSorting,a),!1===a.cancel)&&(i.suspendPaint(),o.sortColumnByColor(r,e,t,n),i.resumePaint(),i.ki(m.Events.RangeSorted,a))},O.prototype.oat=function(t,n){var e,i,e=new g.Condition(3),i;e.compareType(n?0:1),e.expected(t),this.tot(e)},O.prototype.Fz=function(t,r){var o=this;(0,m.GC$)(Bt).bind(I,function(){var t=1===o.xrt?Nt:kt;o.eat((0,m.GC$)(Rt),t),(0,m.GC$)(this).css(hn,"rgb(134,191,160)"),(0,m.GC$)(this).attr(Ft,"checked")}),t.bind(m.Events.ButtonClicked,function(t,n){var e,n,i,e,e=n.row,n=n.col,i=r.getCellType(e,n);o.Zot(r,e,n,o.eU),e=i.buttonBackColor(),o.eat((0,m.GC$)(Rt),e),(0,m.GC$)(Bt).css(hn,Dt).attr(Ft,""),o.vz=e}),t.bind(m.Events.TouchToolStripOpening,function(t,n){n.handled=!0}),o.bindMoveEvent((0,m.GC$)("."+en,o.Wc[0])[0])},O.prototype.nat=function(){var t,n,e,i,t=(0,m.GC$)(d("div")),n=(0,m.GC$)(d("input")).attr({type:"button",value:N().OK,id:this.prt}),e=(0,m.GC$)(d("input")).attr({type:"button",value:N().Cancel,id:this.brt}).addClass(Pt),i={width:"75px",height:"23px",lineHeight:"21px",fontSize:"12px",backgroundColor:"#E1E1E1",border:Gt,padding:"0",display:w,margin:"0"};return t.addClass("color-custom-footer").css({textAlign:"right",padding:"10px 12px 12px"}),n.css(i).css({marginRight:"12px"}),e.css(i),t.append(n[0]),t.append(e[0]),t},Fn=O,e(R,Jn=xn),R.prototype.Dn=function(){var t=this,n=t.aat(this.uY);t.Wc.append(n),(0,m.GC$)(".gc-popup",this.Wc[0]).addClass("gc-spread-filter-custom-dialog"),t.Fz()},R.prototype.Fz=function(){var o=this;(0,m.GC$)(nn).bind("change",function(){var t=(0,m.GC$)(this).find("option")[this.selectedIndex];(0,m.GC$)(this).parent().find("input").val((0,m.GC$)(t).text()).attr("gc-data",(0,m.GC$)(this).val())}),1e4<o._rt.length&&(o.Oot=function(){var t,n,t=o.uat;if(t)for(n=0;n<t.length;n++)t[n].workbook.destroy();(o.uat=null,m.GC$)("#first-condition-expected input, #sec-condition-expected input").remove(),(0,m.GC$)(nn).remove(),(0,m.GC$)(".gc-filter-dialog-style").remove(),(0,m.GC$)(".filter-custom-select-first-option").remove()},(0,m.GC$)(nn).bind("mousedown",function(t){var n,e,i,r;if(t.preventDefault(),t.stopPropagation(),n=(0,m.GC$)(this).parent().find("div")[0],e=o.uat,n&&e)for(i="none"===n.style.display,r=0;r<e.length;r++)e[r].container===n?(e[r].container.style.display=i?"block":"none",i&&e[r].workbook.refresh()):e[r].container.style.display="none"}),(0,m.GC$)(".gc-filter-dialog-style").bind("mousedown",function(t){for(var n,e,i,n=o.uat,i=0;i<n.length;i++)(e=n[i].container).contains(t.target)||(e.style.display="none")})),(0,m.GC$)(".filter-custom-select-first-option").bind("click",function(t){t.stopPropagation(),t.preventDefault(),(0,m.GC$)(this).parent().trigger("change")}),(0,m.GC$)("#first-condition-expected input, #sec-condition-expected input").bind("change",function(){var e,i,e=(0,m.GC$)(this).val(),i=-1;o._rt.forEach(function(t,n){t.text===e&&(i=n)}),""===e&&((0,m.GC$)(this).parent().find("select")[0].value=""),(0,m.GC$)(this).attr("gc-data",i)}),o.bindMoveEvent((0,m.GC$)("."+en,o.Wc[0])[0])},R.prototype.cat=function(t,n,e){var i,r,t,t,t,o,i=t.val(),t=t.attr("gc-data");return 2===n&&-1===Number(t)?i:(t=this._rt[t])?2===n?t.text:t.value:11!==n||isNaN(Number(i))?(t={},(o=new G).getPreferredDisplayFormatter(i,t),t.value):parseFloat(i)},R.prototype.Rot=function(){var t,n,n,e,t=this,n=parseInt((0,m.GC$)("#filter-logical-wrap input:checked").val(),10),n=t.fat(n),e=!1;return t.tot(n),n?e=!0:(0,m.GC$)("#first-condition-type").focus(),e},R.prototype.aJ=function(t,n){var t,e,n,t,t,t=t.val().trim();return t?(e=parseInt(t.split("-")[0],10),t=parseInt(t.split("-")[1],10),n=this.cat(n,t,e),t=new g.Condition(t),this.eot(n)&&t.conType(2),t.compareType(e),"string"===z(n)&&(n=Y(n)),t.expected(n),t.treatNullValueAsZero(!1),t.ignoreCase(!0),"string"===z(n)&&-1===n.indexOf("*")&&-1===n.indexOf("?")?t.useWildCards(!1):"string"!==z(n)||-1===n.indexOf("*")&&-1===n.indexOf("?")||(t.conType(2),t.useWildCards(!0)),t):h},R.prototype.fat=function(t){var n,e,i,n=this.aJ((0,m.GC$)("#first-condition-type"),(0,m.GC$)("#first-condition-expected input")),e=this.aJ((0,m.GC$)("#sec-condition-type"),(0,m.GC$)("#sec-condition-expected input"));return n?(e?((i=new g.Condition(0)).compareType(t),i.item1(n),i.item2(e)):i=n,i):null},R.prototype.hat=function(){var t=this.vrt,n=t.rowFilter,e=this.Mf.getText(t.row,t.col);return e=n&&n.range.row<=0?this.Mf.getText(t.row,t.col,t.sheetArea):e},R.prototype.aat=function(t){var n,e,n,n,t,n,i;return this.uat=[],n=this.hat(),(e=(0,m.GC$)(d("div")).addClass("gc-popup ui-widget "+$)).css({backgroundColor:"#f0f0f0"}),e.append(this.dat()),e.append(this.vat(n)),n=this.mat("first-condition-type","first-condition-expected",t.compareType1||0,t.expected1,t.conType1,!0),e.append(n),e.append(this.gat(t.logic)),n=this.mat("sec-condition-type","sec-condition-expected",t.compareType2,t.expected2,t.conType2),e.append(n),t=(0,m.GC$)(d("div")),n=(0,m.GC$)(d("p")).html(N().Explain1).css({margin:"0",lineHeight:"initial",backgroundColor:Dt}),i=(0,m.GC$)(d("p")).html(N().Explain2).css({margin:"0",lineHeight:"initial",backgroundColor:Dt}),t.append(n),t.append(i),t.css({fontSize:"10px",textIndent:"12px"}),e.append(t),e.append(this.pat()),e},R.prototype.mat=function(t,n,e,i,r,o){var a=(0,m.GC$)(d("div")),e;return a.addClass("gc-spread-filter-dialog-condition"),a.append(this.bat(e,r,o).attr("id",t)),e=(1e4<this._rt.length?this.yat(this._rt,i):this.wat(this._rt,i)).attr("id",n),a.append(e),a},R.prototype.dat=function(){var t='\n            <div class="gc-spread-filter-dialog-title">\n                <span class="gc-spread-filter-dialog-title-text">'.concat(N().CustomTitle,'</span>\n                <span id="').concat(this.yrt,'" class="gc-spread-filter-dialog-title-close ').concat(Pt,'">').concat("\xd7","</span>\n            </div>\n        ");return(0,m.GC$)(U(t))},R.prototype.gat=function(t){var n=(0,m.GC$)(d("div")),e=(0,m.GC$)(d("input")).attr({name:"filter-logical",id:"filter-dialog-and",type:"radio"}).val(1).css([f,S],["unset",w]),i=(0,m.GC$)(d("input")).attr({name:"filter-logical",id:"filter-dialog-or",type:"radio"}).val(0).css([f,S],["unset",w]),r=(0,m.GC$)(d("label")).attr({for:"filter-dialog-and"}).html(N().And).css([pn,"font-weight",bn,S,"margin-bottom",A],["10px","inherit","13px",w,"0","0"]),o=(0,m.GC$)(d("label")).attr({for:"filter-dialog-or"}).html(N().Or).css([pn,"font-weight",bn,S,"margin-bottom",A],["10px","inherit","13px",w,"0","0"]);return n.attr("id","filter-logical-wrap"),n.css({padding:"0 0 0 40px",height:"30px"}),0===t?(i.prop("checked",!0),e.prop("checked",!1)):(i.prop("checked",!1),e.prop("checked",!0)),n.append(e),n.append(r),n.append(i),n.append(o),n},R.prototype.vat=function(t){var n,e,e,i,t,n=(0,m.GC$)(d("div")),e=(0,m.GC$)(d("div")).html(N().ShowRows);return n.css(A,"0 12px"),e.css([T,"lineHeight"],["24px","24px"]),n.append(e),e=(0,m.GC$)(d("div")),i=(0,m.GC$)(d("div")),t?((t=(0,m.GC$)(d("div")).html(V(t))).css([J,"maxWidth","textOverflow","whiteSpace","overflow"],[v,"300px","ellipsis","nowrap","hidden"]),e.css({height:"24px",lineHeight:"24px",marginLeft:"15px",fontSize:"10px"}),i.css({overflow:"hidden",margin:"0 5px",height:"12px",borderBottom:Ht,borderWidth:"thin"}),e.append(t)):(e.css({height:"12px",lineHeight:"2px",marginLeft:"15px",fontSize:"10px"}),i.css({margin:"0 5px",height:"2px",borderBottom:Ht,borderWidth:"thin"})),e.append(i),n.append(e),n},R.prototype.bat=function(t,n,e){var i,r,o,a,u,s,c,f,i=[],r=!1;for(i=6===this.Ert||5===this.Ert?En:1===this.Ert?Dn:_n,o=t===p?'<option selected="selected" >&nbsp;</option>':"<option>&nbsp;</option>",s=!1,c=0;c<i.length;c++)u=!1,(u=(a=i[c].split("-"))[2]&&(s=!1,s=n===parseInt(a[2],10)||6===this.jrt&&5===parseInt(a[2],10)||11===parseInt(a[2],10)||s)&&t===parseInt(a[1],10)?!0:u)&&(r=!0),o+="<option ".concat(u?'selected="selected"':"",' value="').concat(a[1]+"-"+a[2],'" style="height:20px">').concat(N()[a[0]],"</option>");return(f=(0,m.GC$)(d("select"))).addClass("gc-spread-filter-dialog-custom-select"),f[0].innerHTML=o,!r&&e&&(0,m.GC$)((0,m.GC$)("option",f[0])[1]).attr("selected","selected"),f},R.prototype.Mat=function(t){var t=V(t);return t=t&&100<t.length?t.substr(0,100)+"...":t},R.prototype.wat=function(t,n){for(var e,i,r,o,a,u,s,c,f,f,e=-1,i=n,o="",a=!0,u=N().Blanks,s=0;s<t.length;s++)t[s].text===u&&t[s].value===h||(c=this.Mat(t[s].text),"date"===z(t[s].value)&&(r=r||l.Fe(l.culture()).DateTimeFormat,c=H.Pe(t[s].value,r.shortDatePattern)),t[s].value+""==n+""&&(e=s,i=c),c=c.replace(/\s/g,"&nbsp;"),a?(o+='<option class="filter-custom-select-first-option" value="'+s+'">'+c+"</option>",a=!a):o+='<option value="'+s+'">'+c+"</option>");return"date"===z(i)&&(r=r||l.Fe(l.culture()).DateTimeFormat,i=H.Pe(i,r.shortDatePattern)),f='\n            <div class="gc-spread-filter-dialog-value-select-wrap">\n                <select class="filter-custom-select-input gc-spread-filter-dialog-value-select">'.concat(o,'</select>\n                <input class="gc-spread-filter-dialog-value-select-input" gc-data=').concat(e,"></input>\n            </div>\n        "),(f=(0,m.GC$)(U(f))).find(".gc-spread-filter-dialog-value-select-input").val(i),f.find(".gc-spread-filter-dialog-value-select")[0].selectedIndex=-1,f},R.prototype.yat=function(t,n){var e,i,r,o,a,u,u,e=n,r,o=(0,m.GC$)(U('\n            <div class="gc-spread-filter-dialog-value-select-wrap">\n                <div class="gc-spread-filter-dialog-value-select-spread"></div>\n                <select class="filter-custom-select-input gc-spread-filter-dialog-value-select">\n                    <option value="0">0</option>\n                </select>\n                <input class="gc-spread-filter-dialog-value-select-input"></input>\n            </div>\n        ')),a=o.find(".gc-spread-filter-dialog-value-select-input"),u=o.find(".gc-spread-filter-dialog-value-select-spread");return u.css(S,on),this.Cat(u[0],t,n,u=function(t){a.val(t)}),"date"===z(e)&&(i=i||l.Fe(l.culture()).DateTimeFormat,e=H.Pe(e,i.shortDatePattern)),u(e),o},R.prototype.Cat=function(e,t,n,i){var r,r,o,o,a,a,r=new m.Workbook(e,{allowContextMenu:!1,showHorizontalScrollbar:!1,showVerticalScrollbar:!0,scrollbarMaxAlign:!0,tabStripVisible:!1,allowUserResize:!1,allowUserDragDrop:!1,allowUserDragFill:!1,allowUserZoom:!1,grayAreaBackColor:"white",sheetCount:1});this.uat.push({container:e,workbook:r}),o=(r=r.getActiveSheet()).options,r.suspendPaint(),o.colHeaderVisible=!1,o.rowHeaderVisible=!1,o.selectionBackColor="transparent",o.selectionBorderColor="transparent",o.gridline={showVerticalGridline:!1,showHorizontalGridline:!1},o.isProtected=!0,r.defaults.rowHeight=17,r.defaults.colWidth=540,r.setRowCount(t.length),(o=new m.Style).foreColor="white",o.backColor="#1E90FF",a=new m.Range(-1,0,-1,1),r.cellStates.add(a,1,o),r.autoGenerateColumns=!1,r.bindColumn(0,"text"),r.setDataSource(t),r.setColumnCount(1),r.bind(m.Events.CellClick,function(t,n){e.style.display="none";var n=n.sheet.getValue(n.row,n.col);i(n)}),(a=new m.Style).vAlign=1,r.setStyle(-1,0,a),r.resumePaint()},R.prototype.pat=function(){var t,n,e,i,t=(0,m.GC$)(d("div")),n=(0,m.GC$)(d("input")).attr({type:"button",value:N().OK,id:this.prt}),e=(0,m.GC$)(d("input")).attr({type:"button",value:N().Cancel,id:this.brt}).addClass(Pt),i={width:"75px",height:"23px",lineHeight:"21px",fontSize:"12px",backgroundColor:"#E1E1E1",border:Gt,padding:0,display:w};return t.addClass("custom-footer").css({textAlign:"right",padding:"10px 12px 12px"}),n.css(i).css({marginRight:"12px"}),e.css(i),t.append(n[0]),t.append(e[0]),t},R.prototype.Rrt=function(t){var n,e,i,n=this,e=n.IB.rrt[n.vrt.col],i={conType1:2,conType2:p,compareType1:0,compareType2:p,expected1:p,expected2:p,logic:1};e=e&&e.length&&e[0]instanceof g.Condition?e[0]:h,n.uY=n.Sat(i,t,e)},R.prototype.Tat=function(t,n){var e,i,r,t,o,e=l.Fe(l.culture()).DateTimeFormat,i={},r=t.expectTypeId();if(0===r)i=t.getExConditionDateScope(t.expected());else if(6===r)t=new Date,o=new Date,t.setMonth(0,1),t.setHours(0,0,0,0),o.setHours(23,59,59,999),i={from:t,to:o};else if(3===r)return n.conType1=this.jrt,n.compareType1=this.Ort,n.expected1=p,n;return n.conType1=5,n.conType2=5,n.compareType1=5,n.compareType2=2,n.expected1=H.Pe(i.from,e.shortDatePattern),n.expected2=H.Pe(i.to,e.shortDatePattern),n},R.prototype.Sat=function(t,n,e){var i,r,o,a,u,a,u,i=e&&(e.conType()===this.Ert||11===e.conType()&&(1===this.Ert||2===this.Ert)),r=e&&(e.compareType()===this.Ort||0===e.conType());return!e||1!==n||6!==e.conType()||0!==e.expectTypeId()&&6!==e.expectTypeId()&&3!==e.expectTypeId()?(o=!0,1===this.jrt&&e&&0===e.conType()&&(a=e.item1().compareType(),u=e.item2().compareType(),5===Math.max(a,u)&&3===Math.min(a,u)||(o=!1)),1===n||i&&r&&o?e&&0===e.conType()?(this.Ert=this.jrt,t.conType1=e.item1().conType(),t.conType2=e.item2().conType(),t.compareType1=e.item1().compareType(),t.compareType2=e.item2().compareType(),t.expected1=e.item1().expected(),t.expected2=e.item2().expected(),t.logic=e.compareType()):e&&0!==e.conType()&&3!==e.conType()&&(a=e.compareType(),u=e.conType(),t.conType1=u,t.expected1=e.expected(),t.compareType1=a):0===this.Ert?(this.Ert=this.jrt,1===this.jrt?(t.conType1=1,t.conType2=1,t.compareType1=3,t.compareType2=5):5===this.jrt&&(t.conType1=5,t.compareType1=5,t.conType2=5,t.compareType2=3)):1===this.Ert&&this.Aat(e)?(t.conType1=this.jrt,t.compareType1=this.Ort,t.expected1=e.expected()):(t.conType1=this.jrt,t.compareType1=this.Ort,t.expected1=p),t):this.Tat(e,t)},R.prototype.eot=function(t){return t!==p&&"TRUE"===t||"FALSE"===t},R.prototype.Aat=function(t){var n,e;return!!t&&(n=!1,e=t.expected(),!(1!==t.conType()||!this.eot(e))||n)},Pn=R},"./dist/plugins/filter/filter-ns.js":function(t,n,e){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.SR=void 0;var e=e("./dist/plugins/filter/filter.res.en.js");n.SR={en:e}},"./dist/plugins/filter/filter-ui.js":function(i,r,t){"use strict";var F,a,y,P,G,U,H,o,t,z,V,Y,Z,d,u,c,w,f,x,v,W,Q,J,m,K,X,q,$,tt,nt,et,it,rt,n,ot,at,ut,l,st,ct,h,ft,lt,ht,dt,vt,mt,gt,pt,bt,g,p,yt,wt,b,Mt,Ct,St,Tt,At,M,It,xt,Nt,kt,Dt,_t,s,Et,jt,C,Ot,S,T,A,I,Rt,Bt,Lt,Ft,Pt,Gt,Ut,Ht,zt,Vt,Yt,Zt,Wt,Qt,Jt,Kt,N,Xt,k,D,qt,$t,_,tn,nn,en,rn,on,an,un,sn,cn,fn,ln,hn,dn,E,vn,mn,gn,pn,bn,yn,wn,Mn,Cn,Sn,j,Tn,n,O,An,In,xn,n,n,Nn;function kn(t,n,e,i,r,o,a,u){var s=this;s.rowFilter=t,s.row=n,s.col=e,s.sheetArea=i,s.x=r,s.y=o,s.width=a,s.height=u}function R(t,n){(0,y.GC$)(t).addClass(n)}function Dn(t,n){return"object"==typeof t?JSON.stringify(t):(t=n.getColor(t),a.Common.ft.j(a.Common.ft._(t)))}function _n(t,n){var e,i,r,t,n,e,t,e={date:0,number:1,string:2,boolean:3,blank:4},i=t.value,r=n.value,t=t.type,n=n.type;if(t!==n)return e[t]<e[n]?-1:1;if("date"===t&&"date"===n){if((e=i.getFullYear())<(t=r.getFullYear()))return 1;if(t<e)return-1}return r<i?1:i<r?-1:0}function En(t,n,e,i,r){var o;t?(o=void 0,"string"==typeof t?(o=r[t])===_&&(o=r[t]=Dn(t,e)):o=JSON.stringify(t),n.data[o]===_&&n.colorNumber++,n.data[o]=i):n[tn]=tn}function B(t,n){(0,y.GC$)(t).removeClass(n)}function jn(t,n,e){t.css([A,I],[n+g,e+g])}function On(t){(0,y.GC$)(t).css([Rt,s,C,"outline"],[0,0,0,T])}function L(t){return t.concat([])}function Rn(t,n){var e,i,e,i,r,i,o;if(x(t)||""===t||"number"==typeof t&&isNaN(t))return"blank";if(e=Qt(t),i="number"==typeof t,"General"===n||x(n)){if(e)return"date"}else if(!V(n)&&(e||i))return e=/d|D|m|M|y|Y|z|Z|g|G|e/,r=(i=n instanceof a.Formatter.FormatterBase)?n:new a.Formatter.GeneralFormatter(n),i=Bn(i=i?n.formatString():n),(o=e.test(i)&&!(r.hasFormattedColor&&r.hasFormattedColor())&&!("General"===i||""===i||void 0===i))?"date":"number";return Zt(t)}function Bn(t){var n,e;return t&&(e=/:mm|:m|mm:|m:/gi,t=(t=t.replace(n=/AM\/PM/gi,"")).replace(e,"")),t}function Ln(t){for(var n,e,i,r,o,n="",e=!1,i=0,r=t.length;i<r;i++)'"'===(o=t[i])&&(e=!e),"E"===o||e||(n+=o.toLowerCase());return n}function Fn(t,n,e,i,r){var t,o,a,u,s,t;if(n&&t)return s=[],(t=t.format(e))&&(o=(t=t.split("/"))[0]||"",a=t[1]||"",u=t[2]||""),s.push({value:o,level:0,status:i}),s.push({value:a,level:1,status:i}),s.push({value:u,level:2,status:i}),{key:n,value:e,children:s,status:i,type:r}}function Pn(t,n,e,i,r,o,a,u){var s,c;if(n)return(s=[]).push({value:n,level:t.outlineColumn&&t.outlineColumn.Un(r)?t.getCell(i,r).textIndent():0,status:o}),(c=t.NMi)&&c._Ni&&t.outlineColumn&&t.outlineColumn.Un(r)&&(s[0].level=c._Ni(i),x(u)||(s[0].status=o=j[!u])),{key:n,value:e,children:s,status:o,type:a}}function Gn(t){var n,e,i,e,e,r,i,e,e,t,r;if(x(t)&&(t=""),(e=(n=new a.Formatter.GeneralFormatter(t)).formatters)&&!(e.length<=0)&&(i=e[0]))return e=(e=a.Common.CultureManager.getCultureInfo())&&e.id,r=i.localeIDFormatPart,i=i.dbNumberFormatPart,e=r&&r.Iat||e,e=a.Common.CultureManager.xat(e,Ln(t)),t=r&&r.Nat||"",r=i&&i.Nat||"",new a.Formatter.GeneralFormatter(r+t+e)}function e(t,n,e,i,r){var o,a,t,o=this,a=n.parent;return(t=o=Nn.call(this,t,u.gi(a&&a.Ti))||this).kat={},t._rt=[],t.Dat=[],t._at=[],t.Eat=[],t.jat=[],t.Oat=[],t.Rat=[],t.Bat=!1,t.Lat=0,t.Fat=!1,t.Pat={Number:0,Text:0,Date:0},t.Gat="",t.Uat=f,t.sheet=n,t.filterButtonInfo=e,t.Vat=26,t.Yat=191,t.Zat=150,t.Wat=1.2,t.Hat=237,t.zat=410,r&&(t.Yue=u.w1({},r)),t.rEscape=/[\-\[\]{}()+.,\\\^$|#\s]/g,t.elementList=[],t.activeItemIndex=f,t.Wc=t.Xc(),t.Qat=t.Kat(),t.Jat=t.Xat(),t.qat=i,t.$at=t.tut(),t.nut(),t.eut(),o}F=this&&this.__extends||(xn=function(t,n){return(xn=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(t,n){t.__proto__=n}:function(t,n){for(var e in n)Object.prototype.hasOwnProperty.call(n,e)&&(t[e]=n[e])}))(t,n)},function(t,n){if("function"!=typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function e(){this.constructor=t}xn(t,n),t.prototype=null===n?Object.create(n):(e.prototype=n.prototype,new e)}),Object.defineProperty(r,"__esModule",{value:!0}),r.iut=r.rut=void 0,a=t("Common"),y=t("Core"),P=t("./dist/plugins/filter/filter-dialog.js"),G=t("ConditionalFormatting"),U=t("CellTypes"),H=t("./dist/plugins/filter/filter.js"),o=t("./dist/plugins/filter/filter-button-images.js"),t=t("./dist/plugins/filter/filter-ns.js"),z=a.Common.$T,V=y.mt.St,Y=a.Common.zf.j0,Z=a.Formatter.Hf,d=y.mt.En,u=y.mt,c=u.vi,w=a.Common.Uf.tR,f=null,x=a.Common.lt.ht,v=parseFloat,W=y.GC$.inArray,Q="gc-sortASC",J="gc-sortDES",m="gc-filterOK",K="gc-filterCancel",X="gc-filterSearch",q="gc-filterCheckAll",$="gc-filterUnCheckAll",tt="gc-filter-item-container",et="gc-filter-button",it="gc-filter-item-link ",rt="gc-filter-sort",ot="gc-filter-button-hover "+(n="ui-state-hover "),l=(nt="gc-filter-hover")+" form-control well "+(ut=n+(at="gc-filter-item-hover")),st=" ui-corner-all ",ct="ui-button-disabled",h=" ui-state-disabled",ft="gc-filter-button-disable",lt="gc-sub-color-filter",ht="gc-sub-content-flter",dt="gc-sub-color-sort",vt="gc-no-user-select",mt=" gc-filter-check",gt="gc-filter-check-outerDiv",pt="gc-filter-button-active",bt=".ui-filter-dialog",g="px",p="font-size",yt="string",wt="mouseout",b="click",Mt="keydown",Ct="keyup",St="search",Tt="input",At="span",M="div",It="button",xt="DOMMouseScroll",Nt="mousewheel",kt="mousedown",Dt="mouseover",_t="mouseup",Et=(s="margin")+"Left",jt=s+"Top",Ot=(C="padding")+"Top",S="display",T="none",A="width",I="height",Rt="border",Bt="position",Lt="absolute",Ft="background-color",Pt="left",Gt="top",Ut="box-sizing",Ht="content-box",zt="block",Vt="gc-filter-button-container",Yt="gc-filter-dialog-resizable",Zt=a.Common.lt.Oh,Wt=a.Common.ct.Y0,Qt=a.Common.ct.W0,Jt="gc-sortASC-tr",Kt="gc-sortDEC-tr",N="gc-sort-color-tr",Xt="clear_filter",k="gc-color-filter",D="gc-major_filter",qt="gc-search-tr",$t="gc-filter-function-tr",_=void 0,tn="automatic",nn="gc-async-process-tr",en="TextFilter",rn="NumberFilter",on="DateFilter",an="gc-filter-choose-area",un="filter-button-tr",sn="gc-filter-dialog-style",cn="gc-sortColor",fn="gc-filter-color",ln="gc-clearFilter",hn="gc-majorFilter",dn="gc-filterDialog-rightArrow",E="gc-filter-disable-item",vn=500,mn=100,gn=20,pn=10,bn=30,yn=5e4,wn=237,Mn=410,Cn=191,Sn=150,(n=j=j||{})[n.true=1]="true",n[n.false=2]="false",n[n[void 0]=2]="undefined",n[n.null=3]="null",(n=Tn=Tn||{})[n.false=0]="false",n[n.true=1]="true",n=new a.Common.ResourceManager(t.SR,"Filter"),O=n.getResource.bind(n),kn.prototype.jt=function(){var t=this,n=t.rowFilter,t=t.col,e=n.getSortState(t);return n?n.isFiltered(t)?[3,4,5][e]:e:0},r.rut=kn,Nn=y.zc,F(e,Nn),e.prototype.tut=function(){var t,n,e,i,r,t=this,n=[],e=this.qat,i=t.zat,r=t.Vat;return e.sortByValue?n=n.concat([1,1]):(n=n.concat([0,0]),i-=2*r),e.sortByColor?n=n.concat([1]):(n=n.concat([0]),i-=r),!0===e.filterByValue||!0===e.filterByColor?n=n.concat([1]):(n=n.concat([0]),i-=r),!0===e.filterByColor?n=n.concat([1]):(n=n.concat([0]),i-=r),!0===e.filterByValue?n=n.concat([1]):(n=n.concat([0]),i-=r),!0===e.listFilterArea?n=n.concat([1,1,1,1]):(n=n.concat([0,0,0,0]),i-=254),t.zat=i,n},e.prototype.rQ=function(){var t,n,e,i,r,n,t=this,n=t.sheet.parent,e=t.filterButtonInfo,i=t.qat,r=t.Wc;t.aut=!!n&&n.options.useTouchLayout,(i.filterByValue||i.listFilterArea||i.sortByColor||i.filterByColor)&&(t.uut(e.col),t.sut(),t.fut(),t.lut()),1===(0,y.GC$)("#"+D).length&&(t.hut=t.dut((0,y.GC$)("#"+D)[0].children[2]),t.hut.Vrt(t.Gat).Hc()),1===(0,y.GC$)("#"+k).length&&(t.vut=t.mut((0,y.GC$)("#"+k)[0].children[2],lt),t.vut.Hc()),1===(0,y.GC$)("#"+N).length&&(t.gut=t.mut((0,y.GC$)("#"+N)[0].children[2],dt),t.gut.Hc()),r.hide(),t.$c(function(){0<t.elementList.length&&(0,y.GC$)(t.elementList[0]).focus()}),t.put(t.aut),n=e.x+e.width-237-6,r.css([Pt,Gt],[n=n<5?5:n,e.y+e.height]),t.if(),t.ese(),t.aY(),t.but(),setTimeout(function(){t.Wc.focus()}),t.sheet.rt.u2()},e.prototype.if=function(){var t,n,e,t,e,i,r,o,a,i,u,e,a,t=this,n=t.Wc;0===n.length||(e=t.sheet.parent,t=t.filterButtonInfo,e=e.getHost().getBoundingClientRect(),i=n[0].getBoundingClientRect(),r=parseInt(n.css("left"),10),o=parseInt(n.css("top"),10),a=i.width,i=i.height,isNaN(r))||isNaN(o)||isNaN(a)||isNaN(i)||(a=!1,(u=0)<(u=(e=e.height)<o+i?o+i-e:u)&&(0<t.y-i?o=t.y-i:(o-=u,a=!0)),n.css({left:r+"px",top:(o=o<0&&!a?0:o)+"px"}))},e.prototype.yut=function(){var t;1===(0,y.GC$)("#"+D).length&&(t=(0,y.GC$)("#"+D)[0],(0,y.GC$)(t).addClass(E+h))},e.prototype.sut=function(){var t=this;t.itemList&&0<t.itemList.length?t.wut(t.dataSource):t.sheet.endEdit()},e.prototype.put=function(t){var n,t,e,i,r,n,t,e,o,a,u,s,c,f,l,h,r,d,i,n=this;t&&(t=n.Hat*n.Wat,e=n.zat*n.Wat,i=t-n.Hat,r=e-n.zat,jn(n.Wc,t,e),n=(0,y.GC$)("."+rt),t=v(n.css(Ot))+r/30,e=(0,y.GC$)("."+et),o=v(e.css(A))+i/4,a=v(e.css(I))+r/8,u=(0,y.GC$)("#"+m),s=v(u.css(Et))+i/2,c=(0,y.GC$)("#"+X),f=v(c.css(A))+i,l=v(c.css(I))+r/8,h=(0,y.GC$)("."+gt),r=v(h.css(jt))+r/10,d=(0,y.GC$)("#"+$),i=v(d.css(Et))+i,n.css(C,t+g+" 6px"),jn(e,o,a),u.css(Et,s+g),jn(c,f,l),h.css(jt,r+g),d.css(Et,i+g))},e.prototype.close=function(){var t,n,e,n=this,e=n.sheet;n.Zue&&n.Zue.disconnect(),n.Zue=f,null!=(t=n.Yue)&&t.keepDialogSize&&n.qat.listFilterArea&&(n.filterButtonInfo.rowFilter.dialogOptions=u.w1({},u.w1(n.Yue,{dialogWidth:n.Wc[0].clientWidth,dialogHeight:n.Wc[0].clientHeight}))),n.Wc.hide(),n.Mut&&(n.Mut.L0(),n.Mut=null),Nn.prototype.close.call(n),(0,y.GC$)(n._itemSpanElement).remove(),(0,y.GC$)(n._itemInputElement).remove(),e.Cut=null,e&&e.Zg()},e.prototype.Sut=function(){1===(0,y.GC$)("#"+Jt).length&&this.Tut(),1===(0,y.GC$)("#"+N).length&&this.Aut()},e.prototype.Tut=function(){var t,n,e,t,i,r,t=this,n=t.elementList,e=t.Iut(Q,O().SortAscending),t=t.Iut(J,O().SortDescending),i=(0,y.GC$)("#"+Jt)[0],r=(0,y.GC$)("#"+Kt)[0];(0,y.GC$)(i.children[0]).append((0,y.GC$)(d("img")).attr("src",(0,o.getFilterButtonImageSrc)(6))),(0,y.GC$)(r.children[0]).append((0,y.GC$)(d("img")).attr("src",(0,o.getFilterButtonImageSrc)(7))),(0,y.GC$)(i.children[1]).append(e),(0,y.GC$)(r.children[1]).append(t),n.push(i),n.push(r)},e.prototype.Aut=function(){var t,n,e,i,t,t,r,t=this,n=t.elementList,e=t.Iut(cn,O().SortColor),i=(0,y.GC$)("#"+N)[0],t=t.xut(),t=this.Nut(t),r=(0,y.GC$)(d("span"));r.addClass(dn),(0,y.GC$)(i.children[0]).append(t),(0,y.GC$)(i.children[1]).append(e),(0,y.GC$)(i.children[2]).append(r),n.push(i)},e.prototype.kut=function(t){var n,e,n,i,r,t,n=this,e=n.elementList,n=n.Iut(fn,O().FilterColor),i=(0,y.GC$)("#"+k)[0],r=(0,y.GC$)(d("span"));r.addClass(dn),t=this.Nut(t.isShowColorFilterSelect),(0,y.GC$)(i.children[0]).append(t),(0,y.GC$)(i.children[1]).append(n),(0,y.GC$)(i.children[2]).append(r),e.push(i)},e.prototype.Dut=function(t){var n,e,i,t,r,o,a,e,n=this,e=n.sheet,i=n.filterButtonInfo.col,t=n.Nut(t.isShowMajorCheck),r=(0,y.GC$)("#"+D)[0],o;e.outlineColumn&&e.outlineColumn.Un(i)&&(0,y.GC$)(r).addClass(E+h),(0,y.GC$)(r.children[0]).append(t),(a=n.Iut(hn,"")).appendTo(r.children[1]),(e=(0,y.GC$)(d("span"))).addClass(dn),(0,y.GC$)(r.children[2]).append(e),n.elementList.push(r)},e.prototype._ut=function(){var t,n,e,i,r,i,t=1===(0,y.GC$)("#"+k).length,n=1===(0,y.GC$)("#"+D).length;(t||n)&&(i=(e=this).elementList,r=(0,y.GC$)("#"+Xt)[0],e.Eut(r),i.push(r),i=e.jut(),t&&e.kut(i),n)&&e.Dut(i)},e.prototype.Out=function(){var t=this;t.qat.listFilterArea&&(t.Rut(),t.But(),t.Lut(),t.Fut())},e.prototype.Fut=function(){var t=et+" gc-filter-button-default ui-button ui-state-default"+st+"btn btn-default",n=(0,y.GC$)("#"+un)[0],e=d(It),i=d(It),r=(0,y.GC$)(e).text(O().OK).css(p,"1em").attr("id",m),o=(0,y.GC$)(i).text(O().Cancel).css(p,"1em").attr("id",K);R(e,t),R(i,t),(0,y.GC$)(n.children[1]).append(r).append(o).addClass(Vt),this.elementList.push(e),this.elementList.push(i)},e.prototype.But=function(){var t,n,e,n,t,t=this,n=(0,y.GC$)("#"+nn),e=n[0].children[1];n.css([S,Bt],[T,Lt]),n=(0,y.GC$)(d(At)).css([A,I,s,Rt,S],[t.Yat,2,"-5px 0 0 4px","solid 1px #A7ABB0",zt]),t=t.Put=(0,y.GC$)(d(At)).css([A,I,Ft,S],[0,2,"#A7ABB0",zt]),(0,y.GC$)(n).append(t),(0,y.GC$)(e).append(n)},e.prototype.Lut=function(){var t,n,e,i,n,t=this,n=t.jut(),e=(0,y.GC$)("#"+an)[0],i=(0,y.GC$)(d("img")).attr("src",(0,o.getFilterButtonImageSrc)(11)).addClass("gc-filter-checked");i.css(["verticalAlign","margin-top"],["top","4px"]),n.isShowSelectCheck||i.css([S],[T]),R((n=t.itemList=(0,y.GC$)(d(M)).css([A,I,Ut],[t.Yat,t.Zat,Ht]))[0],tt),(0,y.GC$)(e.children[0]).append(i).css([S],["inline-block"]),(0,y.GC$)(e.children[1]).append(n)},e.prototype.Rut=function(){var t,n,e,i,e,e,r,o,t=this,n=(0,y.GC$)(d(M)).css([s,C],[0,0]),e=(0,y.GC$)(d(M)).appendTo(n),i=(0,y.GC$)("#"+qt)[0],e=(0,y.GC$)(d(Tt)).attr({type:St,placeholder:O().Search,id:X}).appendTo(e);R(n[0],"gc-search-outer-div ui-widget-header"+st+"ui-multiselect-header ui-helper-clearfix"),t.elementList.push(e[0]),e=(0,y.GC$)(d(M)).appendTo(n),r=t.Gut(q,O().CheckAll,"gc-check-image ui-icon ui-icon-check"),o=t.Gut($,O().UncheckAll,"gc-uncheck-image ui-icon ui-icon-closethick"),R(e[0],gt),e.append(r).append(o),(0,y.GC$)(i.children[1]).append(n),t.elementList.push(r[0]),t.elementList.push(o[0])},e.prototype.eut=function(){var t=this;t.Sut(),t._ut(),t.Out()},e.prototype.ese=function(){var t,n,e,i,r,o,n,t=this,n=this.Yue,e=this.Wc,i=this.itemList;e.css(["min-width","min-height"],[e.width()+g,e.height()+g]),r=e[0].getBoundingClientRect(),n&&t.qat.listFilterArea&&(o=n.dialogWidth,n=n.dialogHeight,o&&o>t.Hat&&(o=Math.min(o,document.body.clientWidth-r.left-20),e.css(A,o),i)&&i.css(A,t.Yat+(o-t.Hat)),n)&&n>t.zat&&(n=Math.min(n,document.body.clientHeight-r.top-20),e.css(I,n),i)&&i.css(I,t.Zat+(n-t.zat))},e.prototype.dut=function(t){var n=this,e=f;switch(this.Gat){case rn:e=new P.Grt(t,n.Wc,n.filterButtonInfo,n.sheet,n,ht);break;case en:e=new P.Prt(t,n.Wc,n.filterButtonInfo,n.sheet,n,ht);break;case on:e=new P.Frt(t,n.Wc,n.filterButtonInfo,n.sheet,n,ht)}return e},e.prototype.mut=function(t,n){var e=this,i=f;return n===lt?i=new P.Lrt(t,e.Wc,e.filterButtonInfo,e.sheet,e,lt):n===dt&&(i=new P.Lrt(t,e.Wc,e.filterButtonInfo,e.sheet,e,dt)),i},e.prototype.xut=function(){var t,n=this.filterButtonInfo,e,i=!1,r=n.rowFilter.nrt;return i=r!==f&&r.color!==_&&n.col===r.index?!0:i},e.prototype.Nut=function(t){var n,e,n=(0,y.GC$)(d("div")),e=(0,y.GC$)(d("img")).attr("src",(0,o.getFilterButtonImageSrc)(11)).addClass("gc-filter-checked");return t||e.css([S],[T]),n.append(e),n},e.prototype.Kat=function(){var t,n,e,i,r,e,t=this,n=t.filterButtonInfo,e=n.rowFilter,i=n.col,r=t.sheet.getText(t.filterButtonInfo.row,i,n.sheetArea),e=e&&e.Uoe();return""===(r=e&&e.row<=0?t.sheet.getText(n.row,i,n.sheetArea):r||t.sheet.getText(0,i,1))&&1===t.sheet.options.colHeaderAutoText?r="(Column "+(i+1)+")":""===r&&(r="(Column "+u.Vf(i+1)+")"),r='"'+r},e.prototype.Eut=function(t){var n=this,e;n.Jat?(e=(0,o.getFilterButtonImageSrc)(12),(0,y.GC$)(t).addClass("gc-filter-item")):(e=(0,o.getFilterButtonImageSrc)(13),(0,y.GC$)(t).addClass(E+h)),(0,y.GC$)(t.children[0]).append((0,y.GC$)(d("img")).attr("src",e).css([A],["18px"])),n.Uut(ln,n.Qat,(0,y.GC$)(t.children[1]))},e.prototype.Hut=function(t){var n;return 0===t.conType()&&0===t.item1().compareType()&&0===t.item2().compareType()&&5===t.item1().conType()&&5===t.item2().conType()},e.prototype.jut=function(){var t,n,e,i,r,o,a,r,o,u,r,t=this,n=!1,e=!1,i=!1,r=t.filterButtonInfo,o=r.col,a,r=r.rowFilter.rrt[o];return r&&0<r.length&&((r=r[0])instanceof G.Condition?(o=r.conType(),0===(u=r.compareType())&&3!==o&&t.qat.listFilterArea?i=!0:0===u&&3!==o&&!t.qat.listFilterArea||0!==u&&3!==o?n=!0:3===o&&(e=!0),r=this.Hut(r),(5===o&&0===u||r)&&(n=!(i=!1))):i=t.qat.listFilterArea),{isShowColorFilterSelect:e,isShowMajorCheck:n,isShowSelectCheck:i}},e.prototype.Xat=function(){var t,n=!1,e=this.filterButtonInfo,i=e.col,r,e=e.rowFilter.rrt[i];return n=e&&0<e.length?!0:n},e.prototype.zut=function(){var t=Math.max(this.Pat.Date,this.Pat.Number,this.Pat.Text);return t===this.Pat.Text?en:t===this.Pat.Number?rn:t===this.Pat.Date?on:void 0},e.prototype.fut=function(){var t,t,n,t=this.zut();this.Gat=t,t=O()[t],(n=(0,y.GC$)("#"+hn)).text(t)},e.prototype.Vut=function(t){var n,t,e,n=this,t=n.Yat*t,e;(0,y.GC$)(n.Put).css([A],[t])},e.prototype.Yut=function(t){var n;(0,y.GC$)("#"+nn).css([S],[t?zt:T])},e.prototype.Wrt=function(){var t,n,e,i,n,r,n,t=this,n=t.filterButtonInfo,e=this.sheet,i=n.col,n=n.rowFilter;n&&(n={tableName:r=n.nM?n.nM.name():_,colIndex:i},e.Qy().execute({cmd:"clearFilter",sheetName:e.name(),cmdOption:n}),t.close())},e.prototype.lut=function(){var t,n,e,i,r,n,t=!1,n=this.bot,e=this.yot,i=n.colorNumber,r=e.colorNumber;n.automatic&&i++,e.automatic&&r++,(i!==_&&1<i||r!==_&&1<r)&&(t=!0),n=this.jut(),t||(n.isShowColorFilterSelect||this.Zut(k),this.xut())||this.Zut(N)},e.prototype.Zut=function(t){var n;(0,y.GC$)("#"+t).addClass(E+h).find("."+dn)},e.prototype.nut=function(){var t,n,e,i,r,o,a,u,s,c,f,l,h,n=this,e=n.Wc,i=" gc-sort-container ui-menu-item",a=n.table=(0,y.GC$)(d("table")).css([C,S],[0,"table"]).attr({cellspacing:0,cellpadding:0});for(R(a[0],"gc-layout-table"),u=[Jt,Kt,N,Xt,k,D,qt],s=n.$at,r=0;r<10;r++)if(1===s[r])for(c=d("tr"),f=(0,y.GC$)(c).appendTo(a),r<6&&((0,y.GC$)(c).attr("id",u[r]).css([S,I,p],["table-row","26px","9pt"]),(0,y.GC$)(c).addClass($t)),6===r&&(0,y.GC$)(c).attr("id",u[r]),7===r&&(0,y.GC$)(c).attr("tabindex",0).attr("id",an),8===r&&(0,y.GC$)(c).attr("id",nn),9===r&&(0,y.GC$)(c).attr("id",un),On(c),o=0;o<3;o++)l=d("td"),(0,y.GC$)(l).appendTo(f),On(l),0===o?R(l,"gc-layout-table-first-column"):2===o?R(l,"gc-layout-table-last-column"):1===o&&(0===r?R(l,"gc-filter-sort-asc-container"+i+"gc-layout-table-middle-column"):1===r&&R(l,"gc-filter-sort-desc-container"+i+"gc-layout-table-middle-column"));n.table.appendTo(e),e.css(["box-shadow",A,I,Ut],["rgba(0, 0, 0, 0.15) 2px 4px 5px",n.Hat+g,n.zat+g,Ht]),R(e[0],sn+" "+vt),e.appendTo(n.qc()),null!=(t=n.Yue)&&t.allowResize&&(e.addClass(Yt),h=e[0],n.Zue=new y.Mfe(h,function(){var t,t,t=h.getBoundingClientRect();e.css(["max-width","max-height"],[document.body.clientWidth-t.left-10+g,document.body.clientHeight-t.top-10+g]),(t=(0,y.GC$)("."+tt)[0])&&(t.style.height=h.clientHeight-(n.zat-n.Zat)+g,t.style.width=h.clientWidth-(n.Hat-n.Yat)+g,n.Mut.Cg(),n.Ofe())},40))},e.prototype.aY=function(){var s,n,e,t,i,r,o,t,s=this,n=!1,e=!1,t=(0,y.GC$)("."+et);(0,y.GC$)("#"+Jt).bind(_t,function(t){n&&(n=!1,s.Wut(!0),s.close(),c(t))}).bind(kt,function(t){c(t),n=!0}),(0,y.GC$)("#"+Kt).bind(_t,function(t){e&&(e=!1,s.Wut(!1),s.close(),c(t))}).bind(kt,function(t){c(t),e=!0}),(0,y.GC$)("."+$t).bind(Dt,function(){s.hut&&(0,y.GC$)(this).attr("id")!==D&&s.hut.rf()&&(s.hut.NK(),B((s.Uat=f,y.GC$)("#"+D)[0],l)),s.vut&&(0,y.GC$)(this).attr("id")!==k&&s.vut.rf()&&(s.vut.NK(),B((s.Uat=f,y.GC$)("#"+k)[0],l)),s.gut&&(0,y.GC$)(this).attr("id")!==N&&s.gut.rf()&&(s.gut.NK(),B((s.Uat=f,y.GC$)("#"+N)[0],l)),!(0,y.GC$)(this).hasClass(h.trim())&&(0,y.GC$)(this).index()<6&&R(this,l)}).bind(wt,function(){s.hut&&(0,y.GC$)(this).attr("id")===D&&(clearTimeout(i),s.hut.rf())||s.vut&&(0,y.GC$)(this).attr("id")===k&&(clearTimeout(r),s.vut.rf())||s.gut&&(0,y.GC$)(this).attr("id")===N&&(clearTimeout(o),s.gut.rf())||B(this,l)}),(0,y.GC$)("#"+Xt).bind(b,function(){s.Jat&&s.Wrt()}),(0,y.GC$)("#"+D).bind(Dt,function(){(0,y.GC$)(this).hasClass(E)||(i=setTimeout(function(){s.Uat=s.hut,s.Uat.$c()},500))}),(0,y.GC$)("#"+k).bind(Dt,function(){(0,y.GC$)(this).hasClass(E)||(r=setTimeout(function(){s.Uat=s.vut,s.Uat.$c()},500))}),(0,y.GC$)("#"+N).bind(Dt,function(){(0,y.GC$)(this).hasClass(E)||(o=setTimeout(function(){s.Uat=s.gut,s.Uat.$c()},500))}),(0,y.GC$)("#"+q).bind(b,function(t){s.Qut(t,!0)}),(0,y.GC$)("#"+$).bind(b,function(t){s.Qut(t,!1)}),(0,y.GC$)("#"+X).bind(Mt,function(t){13===(t.which||t.keyCode)&&t.preventDefault()}).bind(Ct,function(t){W(t.keyCode,[9,37,38,39,40])<0&&(s.Kut(),s.but())}).bind(St,function(t){s.Kut(),s.but()}),t.bind(Dt,function(){R(this,ot)}).bind(wt,function(){B(this,ot)}),t.bind(kt,function(){B(this,ot),R(this,pt)}).bind(wt,function(){B(this,pt)}),(0,y.GC$)("#"+m).bind(b,function(){var t,n,e,i,r,o,a,u,n,t,n=s.filterButtonInfo.rowFilter;if(!1===s.Jut?(n.irt=!0,s.Xut()):(s.qut(),!0===s.Jut?n.ort=!0:s.sheet.NMi&&(n.irt=!0)),e=s.Oat,i=[],r=s.Dat,o=e.length,a=r.length,s.Bat){for(u=0;u<(a<o?o:a);u++)r[u]&&i.push(r[u]),!e[u]||e[u].repeat||e[u].noCheck||i.push(e[u]);s.Dat=i}n=s.Dat,s.sheet.suspendPaint(),s.aL(n),s.sheet.resumePaint(),s.close()}),(0,y.GC$)("#"+K).bind(b,function(){s.close()}),s.Wc.bind(Nt,function(t){c(t)}).bind(xt,function(t){c(t)}).bind(Mt+bt,function(t){s.$ut(t)}).bind(Ct+bt,function(t){c(t)}),s.itemList&&0<s.itemList.length&&(s.Mut.bind(y.Events.TopRowChanged,function(t,n){s.Rfe(n)}),s.Mut.bind(y.Events.CellClick,t=function(t,n){!1===s.Jut?s.nst(n):s.est(n)}),s.Mut.bind(y.Events.CellChanged,t),s.Mut.bind(y.Events.TouchToolStripOpening,function(t,n){n.handled=!0}))},e.prototype.Rfe=function(t){var n,e,t,i,r,r;t.oldTopRow>t.newTopRow||(n=this,e=t.sheet,t=t.newTopRow,i=e.dw(1).length,r=n.ist,r=e.getColumnWidth(r),n.rst(e,r,t,i))},e.prototype.rst=function(t,n,e,i,r){var o,a,u,i,s,c,o,f,l,h,d,v,d,i,o=this,a=t.parent,u=o.ist,i=e+i,c=o.Jut,o=o.itemList.width()-(a.options.showVerticalScrollbar?22:0),f=0;for(!1!==c&&(s=t.outlineColumn.ost()),l=Math.min(i,t.getRowCount()),h=e;h<l;h++)d=r&&r[h].name||t.getText(h,u),v=!1===c?30:s[h].cellContent.left,d=y.q.Wt(d),f=Math.max(d+v,f);(i=Math.ceil(Math.max(o,f)/n))!==t.getColumnCount()&&t.setColumnCount(i),o<f&&(a.options.showHorizontalScrollbar=!0)},e.prototype.zce=function(t,n){for(var e,i,r,o,a,u,s,c,f,l,h,d,e=this,i=e.dataSource[n].name,r=e.dataSource[n].level,o=n,a=n;0<=a&&!((u=e.dataSource[a].level)<r);a--)(s=e.dataSource[a].name)===i&&(o=a);for(a=c=n;a<e.dataSource.length&&!((f=e.dataSource[a].level)<r);a++)(l=e.dataSource[a].name)===i&&(c=a);for(h=e.ust(e.dataSource[n].status),d=o;d<=c;d++)t.outlineColumn.setCheckStatus(d,h)},e.prototype.est=function(t){var n,e,i,r,o,a,a,t,u,s,a,t,a,t,o,r,a,n=this,e=t.sheet,i=t.row,r=t.sheetArea,o=n.ist;n.activeItemIndex=i,a=n.ast.outlineColumn.getCheckStatus(),"add_current"===n.dataSource[0].key&&0===i&&(n.Bat=1===a[0]),e.suspendPaint(),t.ignoreClick||!e.sw||(u=(t=(a=e.sw.cellTypeHitInfo)&&a.outlineColumnHitInfo)&&t.indicator)||(e.outlineColumn.getCheckStatus(i,o)===n.dataSource[i].status&&(s=e.outlineColumn).setCheckStatus(i,n.ust(n.dataSource[i].status)),(a=n.sheet.NMi)&&a.qNi&&a.qNi()&&n.zce(e,i),n.sst()),e.Oi&&e.aR("transparent"),t=(0,y.GC$)("."+at,this.Wc[0]),0<w(t)?B(t,ut):n.cst(e),t=(a=e.Z_(i,o,r))&&a.clone()||new y.Style,R(o=(0,y.GC$)(d(M)),l),this.Wc.append(o),r=o.css("backgroundColor"),a=o.css("color"),o.remove(),t.backColor=r,t.foreColor=a,e.setStyle(i,-1,t),e.resumePaint(),n.qut(),n.but()},e.prototype.nst=function(t){var n,e,i,r,o,a,u,s,c,s,f,a,t,c,u,s,f,n=this,e=t.sheet,i=t.row,r=t.sheetArea,o=n.ist,a=t.col;n.activeItemIndex=i,u=n.Eat,(c=(s="add_current"===n.dataSource[0].key)&&0===i)&&(0===a?n.Bat=Boolean(this.dataSource[0].status):(n.Bat=!Boolean(this.dataSource[0].status),this.dataSource[0].status=n.Bat?1:0)),s=s?i-1:i,e.suspendPaint(),!t.ignoreClick&&e.sw&&(f=void 0,0===a?f=t.newValue?1:0:c||(f=u[s].status?0:1,this.dataSource[i].status=f),c||(u[s].status=f,n.Lat+=f?1:-1)),e.Oi&&e.aR("transparent"),a=(0,y.GC$)("."+at,this.Wc[0]),0<w(a)?B(a,ut):n.cst(e),c=(t=e.Z_(i,o,r))&&t.clone()||new y.Style,R(u=(0,y.GC$)(d(M)),l),this.Wc.append(u),s=u.css("backgroundColor"),f=u.css("color"),u.remove(),c.backColor=s,c.foreColor=f,e.setStyle(i,-1,c),e.resumePaint(),n.but()},e.prototype.sst=function(){for(var t,n,e,i,r,t=this,n,e,i=t.ast.outlineColumn.getCheckStatus(),r=0;r<i.length;)t.dataSource[r].status=i[r],r++},e.prototype.ust=function(t){return 1===t?2:1},e.prototype.cst=function(t){for(var n,e,i,n=t.getRowCount(),e=0;e<n;e++)if((i=t.Z_(e,-1))&&(i.backColor||i.foreColor)){i.foreColor=i.backColor=void 0,t.setStyle(e,-1,i);break}},e.prototype.fst=function(t){for(var n=this,e=n.dataSource,i=0,r=n.Eat,o=e[0]&&"add_current"===e[0].key?1:0;i<r.length;)e[i+o].status=t,r[i].status=t,i++},e.prototype.qut=function(){var t,n,e,i,r,o,a,u,s,c,f,l,h,t=this,n=t.ast.outlineColumn.getCheckStatus(),e=0,i=t._at||t.Dat,r=t.Eat,a=0;for(t.Bat=1===n[0],"add_current"===t.dataSource[0].key&&(e=1),t.Dat=[],u=0;u<r.length&&(o=r[u],!(a>=i.length));u++)if(o.key===i[a].text){for(a++,s=o.children,c=_,f=0;f<s.length;f++)l=s[f],h=n[e],!1!==l.show&&(e+=1),c=h||c,3!==h&&(l.status=h);2!==c?t.Dat.push({text:o.key,value:o.value,type:o.type}):t.lst(u,o)}},e.prototype.Xut=function(){var t,n,e,i,r,o,a,u,s,c,f,t=this,n=t._at||t.Dat,e=t.Eat,r=0;for("add_current"===t.dataSource[0].key&&(t.Bat=Boolean(t.dataSource[0].status)),t.Dat=[],a=(o=t.filterButtonInfo).col,(s=(u=o.rowFilter).hst)[a]=[],c=0;c<e.length&&(i=e[c],!(r>=n.length));c++)i.key===n[r].text&&(r++,(f=i.status)?t.Dat.push({text:i.key,value:i.value,type:i.type}):(t.lst(c,i),s[a].push(i.key)))},e.prototype.lst=function(t,n){var e,i,r,e=this,i=e.Rat;if(i[t])if(i[t].value===n.value)e.Rat[t]=null;else for(r=t+1;r<i.length;){if(i[r]&&i[r].value===n.value){e.Rat[r]=null;break}r++}},e.prototype.Qut=function(t,n){var e,i,r,o,a,r,a,e=this,i=e.ast,a=e._at;i.suspendPaint(),e.Dat=n?L(a):[],!n&&e.Bat&&(e.Bat=!1),o=j[n],!1===e.Jut?(r=Tn[n],e.fst(r),e.Lat=n?a.length:0):(r=i.outlineColumn)&&(r.dst(o),e.sst(),n)&&e.Fat&&((a=r.mst.vst[0])&&a.checkBox&&(r.mst.vst[0].checkBox.checkStatus=0),r.refresh()),i.resumePaint(),e.but(),c(t)},e.prototype.gst=function(t){switch(t){case D:this.Uat=this.hut;break;case k:this.Uat=this.vut;break;case N:this.Uat=this.gut}},e.prototype.pst=function(t){var n=this;n.Uat=t,n.Uat.$c(),n.Uat.Jrt()},e.prototype.bst=function(t){var n,e,i,r,n=w(t);0!==n&&(e=this,r=(i=t.attr("id"))===Jt,1===n?r||i===Kt?(e.Wut(r),e.close()):i===K?e.close():i===D?e.Uat!==f?e.Uat.Zrt():e.pst(e.hut):i===k?e.pst(e.vut):i===N?e.pst(e.gut):i===Xt?e.Wrt():(0,y.GC$)("#"+m).trigger(b):2===w(t)||3===w(t)?e.Uat&&e.Uat.Zrt():(0,y.GC$)("#"+m).trigger(b))},e.prototype.yst=function(t,n){var e,n,t,i,r,e=this;return!(!t[0]||"INPUT"===t[0].nodeName||(w(t)?(e.Uat===f&&e.gst(n),e.Uat===f||e.Uat.drt||e.Uat.Krt(),t.trigger(kt),t.trigger(_t),t.trigger(b)):x(this.activeItemIndex)||(n=e.ast,t=this.activeItemIndex,n.outlineColumn.getCheckStatus(t,i=0)===e.dataSource[t].status&&(r=n.outlineColumn).setCheckStatus(t,e.ust(e.dataSource[t].status)),e.sst()),0))},e.prototype.wst=function(){for(var t,n,e,i,r,o,a,u,s,t=this,n=t.Eat,e=t._at,i=0,r=[],o=0;o<n.length;o++)if(!x(e[i])&&n[o].key===e[i].text)for(i++,a=n[o].children,u=0;u<a.length;u++)!1!==(s=a[u]).show&&r.push(s.value||n[o].key);return r},e.prototype.Mst=function(t,n,e){var i,r,e,r,i=this,r=i.elementList,e=!w(n)&&x(i.activeItemIndex)?r[0]:(w(n)?B(n,ut):i.cst(i.ast),r=i.wst(),4===t?i.Cst(r,n,e):i.Sst(r,n,t));return e},e.prototype.Sst=function(t,n,e){for(var i,r,o,a,u,s,c,f,l,h,d,i=this,r=i.elementList,o=n[0],u=r.length-2,s=L(r),c=i.activeItemIndex||0,f=0,l=0;l<w(t);l++)s.splice(-2,0,t[l]);if(d=3===e,0<=(h=o?W(o,s):u+c)){for(a=d?s[h+1]:s[h-1],c=c||0,f=d?h+1:h-1,0<=W(a,t)&&0<w(n)&&(h=d?h+c:c+(r.length-2),a=d?s[h+1]:s[h],f=d?h+1:h);d&&h<w(s)&&i.Tst(a);)f=h+1,a=s[(h+=1)+1];if(!d){for(;0<h&&i.Tst(a);)f=h-1,a=s[--h-1];a=a||s[w(s)-1]}a=a||s[0]}return typeof a==yt?f-u:a},e.prototype.Cst=function(t,n,e){var i,r,o,a,u,s,c,i=this,r=i.elementList,o=n[0],s=L(r),c=i.activeItemIndex||0;if(s.splice(-2,0,t[c]),w(n)){if(0<=(u=W(o,s))){for(a=e?s[u-1]||s[w(s)-1]:s[u+1];e&&0<u&&i.Tst(a);)a=s[--u-1];for(;!e&&i.Tst(a)&&u<w(s);)a=s[(u+=1)+1]}}else a=e?r[r.length-3]:i.Tst(r[r.length-2])?r[r.length-1]:r[r.length-2];return typeof(a=a||s[0])==yt?c:a},e.prototype.$ut=function(t){var n,e,i,r,r,i,r,n=this,e=(0,y.GC$)("."+at,n.Wc[0]),r=t.which||t.keyCode,r=W(r,[27,13,38,40,9,37,39,32]);if(0<e.length&&(i=e.attr("id")),0===r)n.close(),c(t);else if(1===r)this.bst(e);else if(4<r){if(5===r)n.Uat===f&&n.gst(i),n.Uat!==f&&(n.Uat=n.Uat.Qrt());else if(6===r)n.Uat===f&&n.gst(i),n.Uat===f||n.Uat.drt||n.Uat.Krt();else if(7===r&&!this.yst(e,i))return;c(t)}else 1<r&&n.Uat!==f&&n.Uat.rf()?(2===r||4===r&&t.shiftKey?n.Uat.qrt():3!==r&&(4!==r||t.shiftKey)||n.Uat.Xrt(),c(t)):1<r&&("number"==typeof(i=n.Mst(r,e,t.shiftKey))?(n.est({sheet:n.ast,row:e=i,sheetArea:3,ignoreClick:!0}),n.ast.OA(e,n.ist),(0,y.GC$)("#"+an).focus()):(((r=(e=(0,y.GC$)(i)).attr("id"))!==X&&r!==m&&r!==K&&r!==q&&r!==$?e.find("i"):e).focus(),R(e,nt+" "+ut)),c(t))},e.prototype.Tst=function(t){return typeof t!=yt&&(t=(0,y.GC$)(t),0!==w(t))&&!!(t.hasClass(ct)||t.hasClass(h)||t.hasClass(ft))},e.prototype.aL=function(t){var n,e,i,r,o,a,u,n=this,e=n.sheet;if(e)try{e.suspendPaint(),(r=(i=n.filterButtonInfo).rowFilter)&&(o=i.col,u={tableName:a=r.nM?r.nM.name():_,colIndex:o,checkedValues:t,allValuesLength:w(n._rt)},e.Qy().execute({cmd:"filterTextSelectAction",sheetName:e.name(),cmdOption:u}))}finally{e.resumePaint()}},e.prototype.Kut=function(){var t,n,e,i,r,o,a,u,s,c,f,l,h,d,v,m,d,g,g,p,b,t=this,n=y.GC$.trim((0,y.GC$)("#"+X).val().toLowerCase()),e=!1===t.Jut?t.Ast:t.Eat,i=t.jat,o={},a=t.Rat;if(a.forEach(function(t){t&&t.repeat&&delete t.repeat}),n){for(s=[],c=void 0,(u=z.jJ(n))||(c=new RegExp(n.replace(t.rEscape,"\\$&"),"gi")),r=0;r<e.length;r++)for(l=(f=e[r]).children,h=0;h<l.length;h++){if(d=l[h],v=f.key,m=f.type,d=d.value||v,(g=u&&z.OJ(u).exec(d))&&0===g.index||!u&&-1!==d.search(c)){if(o[v])break;if(s.push({text:v,value:f.value,type:m}),(g=a[r])&&g.value===f.value)g.repeat=!0;else for(p=r+1;p<a.length;){if((b=a[p])&&b.value===f.value){b.repeat=!0;break}p++}o[v]=!0;break}a[r]&&a[r].repeat&&delete a[r].repeat}t.Ist=!0,t._at=L(s),t.Oat=a,t.Dat=L(s),t.Lat=t._at.length,t.xst(o)}else if(w(i)){for(this.Fat=!1,r=0;r<i.length;r++)1!==i[r].status&&(i[r].status=1);t._at=L(t._rt),t.Dat=L(t._rt),!1===t.Jut?(t.Nst(i,!1),t.Eat=t.Ast):t.kst(i),t.dataSource=i,t.Lat=i.length}else this.Fat=!1,t.jat=L(t.dataSource)},e.prototype.Iut=function(t,n){var e=(0,y.GC$)(d("i"));return e.attr({id:t}).text(n).css([S,C,"cursor",s,"text-decoration","text-align",p,"outline",I],[zt,"0 6px","default","0px 0 1px 2px",T,Pt,"12px",T,"inherit"]),R(e[0],it+rt+st),e},e.prototype.Uut=function(t,n,e){var i,r,t,n,e,i=O().Clear,r=(0,y.GC$)(d("i")).html(i.replace("{0}",'"'));r.attr({id:t}).css([S,C,"cursor",s,"text-decoration","text-align",p,"outline",I,"white-space"],["inline","0 6px","default","0px 0 1px 2px",T,Pt,"12px",T,"inherit","nowrap"]),e.append(r),t=e.width()-r[0].offsetWidth,e='<span class="filterName">'+Y(n)+'</span><span style="vertical-align: top">"</span>',n=i.replace("{0}",e),r.html(n),(0,y.GC$)(".filterName",r[0]).css(["max-width","overflow","text-overflow",S,"vertical-align"],[t+"px","hidden","ellipsis","inline-block","text-bottom"]),R(r[0],it+rt+st)},e.prototype.Gut=function(t,n,e){var i=d(At),n=(0,y.GC$)(d(At)).text(n),r=d("i"),o=(0,y.GC$)(r);return R(i,"gc-check-uncheck-all "+e),o.attr({id:t}).css(["float",Et,C,p,I],[Pt,"7px","0","12px","16px"]).append((0,y.GC$)(i)).append(n),R(r,mt+mt+"-style"),o},e.prototype.Dst=function(t){"date"===t?this.Pat.Date++:"number"===t||"boolean"===t?this.Pat.Number++:"string"===t&&this.Pat.Text++},e.prototype._st=function(){var t,n,e,i,t=this.Pat.Date,n=this.Pat.Number,e=this.Pat.Text,i=t+n+e;return t<i&&n<i&&e<i?"mix":i===t?"type":i===n?"number":i===e?"text":void 0},e.prototype.Est=function(t){var n,t,e,n=!0,t=t.rrt[this.filterButtonInfo.col];return n=t&&0<t.length&&t[0]instanceof G.Condition&&(t=t[0],e=this.Hut(t),0!==t.compareType()||e||0===t.compareType()&&5===t.conType())?!1:n},e.prototype.jst=function(t){var n,e,i,n=this,e=n.kat[t];return x(e)&&(i=t.replace(/(\[[^hms]+\])|(General)/gi,""),e=Z.a0(i),n.kat[t]=e),e},e.prototype.Ost=function(t,n){return"number"===Zt(n)&&"string"===Zt(t)&&this.jst(t)?Wt(n):n},e.prototype.Rst=function(t,n,e,i,r,o){En(t!==f&&t.backColor,e,i,r,o),En(t!==f&&t.foreColor,n,i,r,o)},e.prototype.uut=function(t){var n,e,i,e,r,o,a,u,s,c,f,i,n=this,e=n.filterButtonInfo.rowFilter;e&&(r=(e=(i=n.sheet).JS(e.extendedRange||e.range)).col,o={},a=[],u={},s=[],c={data:{},colorNumber:0},f={data:{},colorNumber:0},i=i.outlineColumn&&i.outlineColumn.Un(t),n.hasBlank=!1,r<=t&&t<r+e.colCount&&n.Bst(t,c,f,o,u,a,s),n.Lst(c,f,i,a,s,u,t))},e.prototype.Bst=function(t,n,e,i,r,o,a){var u,s,c,f,l,h,d,v,m,g,p,b,y,u=this,s=u.filterButtonInfo.rowFilter;if(s)for(l=(c=u.sheet).currentTheme(),h={},d=c.JS(s.extendedRange||s.range),v=u.qat.sortByColor||u.qat.filterByColor,m=d.rowCount,c._isExternalFilter&&(m=Math.min(m,100)),g=0;g<m;g++)p=d.row+g,(y=(b=0<c.getRowHeight(p))||!s.isFiltered()||s.Fst(p,t))&&v&&(f=c.getActualStyle(p,t,3,!1,!1,!0),this.Rst(f,e,n,l,p,h)),u.Pst(i,r,o,p,t,a)},e.prototype.Lst=function(t,n,e,i,r,o,a){var u,s,u=this;u.bot=t,u.yot=n,e||(s=i.length)<=5e4&&(i.sort(_n),r.sort(_n)),u._rt=i,u.Rat=r,u._at=L(i),!1===u.Jut?(u.Eat=u.Gst(a,o,i),u.Ast=L(u.Eat),u.Lat=u.Dat.length):(u.Eat=u.Ust(a,o,i),u.Lat=u.Eat.length),u.jat=u.dataSource},e.prototype.Hst=function(t,n,e){var i,r,e,i,r=this.sheet;return e||((e=r.l0(t,n,"_autoFormatter"))&&e.formatCached?e.formatCached:void 0)},e.prototype.zst=function(t){var n,e;return this.sheet.l0(-1,t,"formatter")},e.prototype.Pst=function(t,n,e,i,r,o,a,u,s,c,f,l){var h,d,v,s,u,a,m,g,p,b,y,w,M,p,C,S,T,c,c,A,I,c,f,l,p,h=this,d=h.sheet,v=h.filterButtonInfo.rowFilter,u=a?u:d.getValue(i,r),a=a?s:d.vL(i,r,u),s=a=a&&a.trim(),m=O().Blanks,g=h.Est(v),p=d.NMi;h.Vst||(h.Vst=[]),h.Vst.hasOwnProperty(r)?w=h.Vst[r]:h.Vst[r]=w=v.isFiltered(r),h.Yst||(h.Yst=[]),h.Yst.hasOwnProperty(r)?M=h.Yst[r]:h.Yst[r]=M=d.outlineColumn&&d.outlineColumn.Un(r),p?(C=!(p=!1),v.hst||(v.hst={}),h.Zst||(h.Zst=[]),h.Zst.hasOwnProperty(r)?b=h.Zst[r]:h.Zst[r]=b=h.zst(r),b&&!V(b)&&(u=h.Ost(b,u)),T="date"===(S=c),h.Dst(S),1===h.Pat.Date&&(h.Wst=Gn(b)),T&&(s=v.Qst.format(u)),(c=d.NMi).qNi&&c.qNi()?(c=f,""!==a&&!x(a)||(S="blank",h.hasBlank=!0,a=m),c?(n[a]=!0,h.Dat.push({text:a,value:u,type:S}),o.push({text:a,value:u,type:S})):o.push({text:a,value:u,noCheck:!0,type:S}),!1!==l&&e.push({text:a,value:u,type:S,noCheck:!c})):(A=v.isFiltered(),I=!0,""!==a||!C&&A&&!I?t[s]||C&&(f?(p=n[a]=!0,h.Dat.push({text:a,value:u,type:S}),o.push({text:a,value:u,type:S})):o.push({text:a,value:u,noCheck:!0,type:S}),!1!==l)&&(e.push({text:a,value:u,type:S,noCheck:!p}),t[s]=!0):h.hasBlank||(S="blank",h.hasBlank=!0,f?(p=n[m]=!0,h.Dat.push({text:m,value:u,type:S}),o.push({text:m,value:u,type:S})):o.push({text:m,value:u,noCheck:!0,type:S}),!1!==l&&e.push({text:m,value:u,type:S,noCheck:!p})))):(C=0<d.getRowHeight(i),T="date"===(S=Rn(u=(b=d.getFormatter(i,r))&&!V(b)?h.Ost(b,u):u,y=h.Hst(i,r,b))),h.Dst(S),1===h.Pat.Date&&(h.Wst=Gn(b)),T&&(s=v.Qst.format(u)),c=d.getRowVisible(i,3,!0),f=v.Kst(i,r),A=v.isFiltered(),I=v.Fst(i,r),l=d._o(i),p=g&&(C||!w||M&&c&&!f),""!==a||!C&&A&&!I?t[s]||c&&l&&(p?(n[a]=!0,h.Dat.push({text:a,value:u,type:S}),o.push({text:a,value:u,type:S})):o.push({text:a,value:u,noCheck:!0,type:S}),!C&&A&&!I||(e.push({text:a,value:u,type:S}),t[s]=!0)):h.hasBlank||(h.hasBlank=!0,e.push({text:m,value:u,type:S}),p?(n[m]=!0,h.Dat.push({text:m,value:u,type:S}),o.push({text:m,value:u,type:S})):o.push({text:m,value:u,noCheck:!0,type:S})))},e.prototype.Ust=function(t,n,e){var i,r,o,a,u,s,c,f,l,h,d,v,m,g,p,b,y,w,M,C,S,i=this,o=[],a=[],g=i.sheet,p=g.JS(i.filterButtonInfo.rowFilter.extendedRange||i.filterButtonInfo.rowFilter.range),b=g.outlineColumn;if(b&&b.Un(t))for(h=0;h<e.length;h++)y=e[h].text,w=e[h].value,M=e[h].type,C=e[h].noCheck,l=j[!!n[y]],d=Pn(g,y,w,p.row+h,t,l,M,C),o.push(d),(m=d.children[0])&&!1!==m.show&&a.push({name:m.value||d.key,level:i.Ist?0:m.level,status:m.status});else for(h=0;h<e.length;h++)switch(y=e[h].text,w=e[h].value,M=e[h].type){case"date":for(l=j[!!n[y]],u=(v=(d=Fn(i.Wst,y,w,l,M)).children)[0].value,s=v[1].value||v[0].value,v[0].show=v[1].show=!0,u===c&&(v[0].show=!1,s===f)&&(v[1].show=!1),c=u,f=s,o.push(d),m=d.children,S=0;S<3;S++)m[S]&&!1!==m[S].show&&a.push({name:m[S].value||d.key,level:m[S].level,status:m[S].status});break;case"number":case"string":case"boolean":case"blank":case"array":case"object":l=j[!!n[y]],d=Pn(g,y,w,p.row+h,t,l,M),o.push(d),(m=d.children[0])&&!1!==m.show&&a.push({name:m.value||d.key,level:m.level,status:m.status})}return i.dataSource=a,o},e.prototype.Gst=function(t,n,e,i){var r=this,o=[],a=[],u,s,c,f,l,c,h,u;for(i&&(o=[],a=[]),f=0;f<e.length;f++)l=e[f].text,c=e[f].value,h=e[f].type,u=void 0===(u=e[f].noCheck)?n[l]:!u,s=Tn[u],o.push(c={key:l,value:c,children:[{value:l,level:0,status:s}],status:s,type:h,checked:u}),a.push({name:c.children[0].value||c.key,level:0,status:s});return r.dataSource=a,o},e.prototype.wut=function(t){var n,e,i,r,o,n=this,e=0,i=n.itemList,r=!1,o=n.Mut;o||(o=new y.Workbook(i[0],{allowContextMenu:!1,showHorizontalScrollbar:!1,showVerticalScrollbar:!1,scrollbarMaxAlign:!0,tabStripVisible:!1,allowUserResize:!1,allowUserDragDrop:!1,allowUserDragFill:!1,allowUserZoom:!1,grayAreaBackColor:"white",sheetCount:1}),r=!0),o.xU=!0,n.Mut=o,n.ast=o.getActiveSheet(),n.ist=0,!1===n.Jut?(n.ist=1,n.Nst(t,r)):(n.kst(t),n.sst())},e.prototype.kst=function(t){var n,e,i,r,r,n=this,e=n.Mut;0<n.Mut.sheets.length&&(n.Mut.removeSheet(0),n.ast=_),e.addSheet(0,new y.Worksheet("sheet1")),i=n.ast=e.sheets[0],e.suspendEvent(),i.suspendPaint(),(r=i.options).colHeaderVisible=!1,r.rowHeaderVisible=!1,r.selectionBackColor="transparent",r.selectionBorderColor="transparent",r.gridline={showVerticalGridline:!1,showHorizontalGridline:!1},r.protectionOptions.allowOutlineRows=!0,r.isProtected=!0,i.defaults.rowHeight=20,i.defaults.colWidth=10,i.setRowCount(0===t.length?0:t.length+1),(r=new y.Style).font='12px "Segoe UI", Calibri, Thonburi, Arial, Verdana, sans-serif, "Mongolian Baiti", "Microsoft Yi Baiti", "Javanese Text"',i.setDefaultStyle(r),i.Jst=!0,i.outlineColumn.options({columnIndex:n.ist,showIndicator:!0,showCheckBox:!0,Jut:this.Jut}),i.outlineColumn.Xst(),i.showRowOutline(!1),i.setColumnCount(1),0<t.length&&n.Ist?(n.Ist=!1,t.unshift({name:O().add_current_filter,level:0,status:0,key:"add_current",value:"add_current",children:[]}),n.Fat=!0):0===t.length&&(n.Ist=!1),n.qst(i,t),n.Ofe(),i.outlineColumn.$st(),this.tct(t),i.resumePaint(),e.resumeEvent()},e.prototype.Ofe=function(){var t,n,e,i,r,o,a,u,t=this,n=t.ast,e=t.Mut,i=t.dataSource,r,o=t.itemList.height();e.suspendPaint(),e.options.showHorizontalScrollbar=!1,e.options.showVerticalScrollbar=!1,20*i.length>o&&(e.options.showVerticalScrollbar=!0),a=n.dw(1).length,u=n.getViewportTopRow(1),t.rst(n,10,u,a,i),!e.options.showVerticalScrollbar&&e.options.showHorizontalScrollbar&&20*i.length>(o-=22)&&(e.options.showVerticalScrollbar=!0),e.resumePaint()},e.prototype.tct=function(t){for(var n,e,n,i,r,o,a,u,n=this,e=n.Mut,n=n.ast=e.sheets[0],i=n.rowOutlines,o=[],a=[],u=0;u<t.length;u++)r=t[u].level,t[u+1]&&t[u+1].level===r+1&&(0===r?o.push(u):1===r&&a.push(u));1===o.length?1!==a.length&&a.forEach(function(t){i.setCollapsed(t,!0)}):(o.forEach(function(t){i.setCollapsed(t,!0)}),a.forEach(function(t){i.setCollapsed(t,!0)})),n.$A(0)},e.prototype.Nst=function(t,n){var e,i,r,o,a,u,r,n,r,n,e=this,i=e.Mut,r=e.sheet,o,a=e.itemList.height(),u=e.ast=i.sheets[0];i.suspendEvent(),u.suspendPaint(),r.endEdit(),n||u.reset(),r=i.options,n=u.options,r.showHorizontalScrollbar=!1,r.showVerticalScrollbar=!1,n.colHeaderVisible=!1,n.rowHeaderVisible=!1,n.selectionBackColor="transparent",n.selectionBorderColor="transparent",n.gridline={showVerticalGridline:!1,showHorizontalGridline:!1},n.isProtected=!0,u.defaults.rowHeight=20,u.defaults.colWidth=30,u.setRowCount(0===t.length?0:t.length+1),(r=new y.Style).font='12px "Segoe UI", Calibri, Thonburi, Arial, Verdana, sans-serif, "Mongolian Baiti", "Microsoft Yi Baiti", "Javanese Text"',r.vAlign=2,u.setDefaultStyle(r),u.Jst=!0,0<t.length&&e.Ist?(e.Ist=!1,t.unshift({name:O().add_current_filter,level:0,status:0,key:"add_current",value:"add_current",children:[]}),e.Fat=!0):0===t.length&&(e.Ist=!1),e.nct(u,t,i),20*t.length>a&&(i.options.showVerticalScrollbar=!0),n=u.dw(1).length,e.rst(u,30,0,n,t),u.resumePaint(),i.resumeEvent()},e.prototype.qst=function(t,n){var e,i,r,o,a,u,s;if(0!==n.length){if(o=i=0,a=t.outlineColumn,u=(e=this).ist,t.suspendPaint(),t.autoGenerateColumns=!1,t.bindColumn(0,"name"),t.setDataSource(n),"text"!==(s=e._st())&&"number"!==s||e.sheet.outlineColumn&&e.sheet.outlineColumn.Un(e.filterButtonInfo.col))for(;o<n.length;o++)i=n[o].level,t.getCell(o,u).textIndent(i);else t.getCell(-1,u).textIndent(i);for(a.refresh(),o=0;o<n.length;o++)r=n[o].status,a.ect(o,r);t.resumePaint()}},e.prototype.nct=function(t,n,e){var n,n;0!==n.length&&(t.suspendPaint(),t.autoGenerateColumns=!1,t.bindColumn(1,"name"),t.bindColumn(0,"status"),t.setDataSource(n),t.setColumnCount(2),(n=new y.Style).locked=!1,t.setStyle(-1,0,n),(n=new U.CheckBox)._caption="  ",n._textAlign=2,t.setCellType(-1,0,n),e.bind(y.Events.EditStarting,function(t,n){n.cancel=!0}),t.resumePaint())},e.prototype.xst=function(t){var n=this;!1===n.Jut?(n.Eat=n.Gst(n.filterButtonInfo.col,t,n._at,!0),n.Lat=n.Dat.length,n.Nst(n.dataSource,!1)):(n.Ust(n.filterButtonInfo.col,t,n._at),n.kst(n.dataSource))},e.prototype.Wut=function(t){var n,e,i,n,r,r,o,e,r,o,a,n=this,e=n.filterButtonInfo,i=e.rowFilter,n=n.sheet,r=i.Uoe(),r=n.JS(r);i&&n&&n._B()&&(o=n.TB(r,!0,null),e=e.col,r={sheet:n,sheetName:n.name(),col:e,ascending:t,range:r,compareFunction:_,groupSort:o.groupSort,ignoreHidden:o.ignoreHidden,cancel:!1},n.ki(y.Events.RangeSorting,r),!1===r.cancel)&&(o=i.nM?i.nM.name():_,(0,H.zA)("sortFilter",a={tableName:o,colIndex:e,compareFunction:r.compareFunction,groupSort:r.groupSort,ignoreHidden:r.ignoreHidden,isAsc:t},n),n.ki(y.Events.RangeSorted,r))},e.prototype.Aot=function(t,n,e){var i,r,o,i,r,a,o,u,i=this,r=i.filterButtonInfo,o=r.rowFilter,i=i.sheet;o&&i&&i._B()&&(e=e!==_&&e,r=r.col,a={sheet:i,sheetName:i.Zc,col:r,ascending:e,color:t,isBackColor:n,cancel:!1},i.ki(y.Events.RangeSorting,a),!1===a.cancel)&&(o=o.nM?o.nM.name():_,(0,H.zA)("sortFilter",u={tableName:o,colIndex:r,isAsc:e,color:t,isBackColor:n},i),i.ki(y.Events.RangeSorted,a))},e.prototype.but=function(){var t,n,e,t=(0,y.GC$)("#"+m),n=ct+h+" "+ft,e=!1===this.Jut?this.Lat:0<w(this.Dat);(this.Bat||e?(t.prop("disabled",!1),B):(t.prop("disabled",!0),R))(t[0],n)},r.iut=e},"./dist/plugins/filter/filter.entry.js":function(t,n,e){"use strict";var i,r,i=this&&this.__createBinding||(Object.create?function(t,n,e,i){void 0===i&&(i=e);var r=Object.getOwnPropertyDescriptor(n,e);r&&("get"in r?n.__esModule:!r.writable&&!r.configurable)||(r={enumerable:!0,get:function(){return n[e]}}),Object.defineProperty(t,i,r)}:function(t,n,e,i){t[i=void 0===i?e:i]=n[e]}),r=this&&this.__exportStar||function(t,n){for(var e in t)"default"===e||Object.prototype.hasOwnProperty.call(n,e)||i(n,t,e)};Object.defineProperty(n,"__esModule",{value:!0}),r(e("./dist/plugins/filter/filter-ns.js"),n),e("./dist/plugins/filter/filter-actions.js"),r(e("./dist/plugins/filter/filter-ui.js"),n),r(e("./dist/plugins/filter/filter.js"),n)},"./dist/plugins/filter/filter.js":function(c,t,n){"use strict";var f,J,x,K,a,X,g,e,N,D,_,E,j,l,k,h,v,B,m,q,p,O,$,L,F,n,b,y,w,tt,nt,i,et,P,n,G,U,H,z,V,R,Y,Z,W,n,Q,it,rt,ot,at,e,ut;function st(t,n,e){var t,n,t={cmd:t,sheetName:e.name(),cmdOption:n};e._isExternalFilter?(n=K.Commands[t.cmd])&&n.execute(e.parent,t,0):e.Qy().execute(t)}function ct(t,n,e,i){for(var r,o,o=0;o<tt(t);o++)if((r=t[o])&&r.row===n&&r.col===e&&r.sheetArea===i)return r;return m}function ft(t,n){var e,i,t,e=d(t),i=t.compareType();2===e||7===e?(t=t.art,-1!==b(n,"T")||t?-1===b(n,"DT")&&t&&n.push("DT"):n.push("T")):3===e?0===i&&-1===b(n,"BC")?n.push("BC"):1===i&&-1===b(n,"FC")&&n.push("FC"):-1===b(n,"V")&&n.push("V")}function lt(t){for(var n,e,i,r,o,n=[],e=0;e<tt(t);e++)0===d(i=t[e])?(r=i.item1(),o=i.item2(),r&&ft(r,n),o&&ft(o,n)):ft(i,n);return n}function M(t){return t.getColumnCount()}function C(t,n){return t.getRowCount(n)}function d(t){return t.conType()}function ht(t,n,e,i){var r=t.getSpan(n,e,i);return r=!r&&t.Cb?t.Cb.D7(n,e,i):r}function S(t){return $(t)?t:2<=t.length&&"="===t[0]?t.substring(1):"="===t?"":t}function dt(t){return"number"==typeof t?"number":t instanceof Date||"string"==typeof t&&0===t.indexOf("/OADate(")&&t.indexOf(")")===t.length-2?"date":"boolean"==typeof t?"boolean":""}function vt(t){var n=t.formula();return n=$(n)&&(n="string"==typeof(n=t.expected())?'"'+n+'"':n)instanceof Date?B(n)+"":n}function mt(t,n,e){var t,i,e,i,t=_(t,"colorFilter");t&&(i=j(t.dxfId,0),e=e.getDxf(i),i=E(t.cellColor,!0),n.push(p(3,i?0:1,e&&e.backColor)))}function gt(t,n){var t,e,i,t,r,o,a,u,s,c,f,l,h,d,v,m,f,f,t=_(t,"filters");if(t){if(e="1"===t.blank,i=D(t,"filter"),t=D(t,"dateGroupItem"),e&&(i=i||[]).push({n_:"filter",val:""}),i)for(r=0,o=i;r<o.length;r++)a=o[r],(u=p(2,0,k(a.val))).ignoreCase(!0),u.ignoreBlank(e),n.push(u);if(t)for(s=0,c=t;s<c.length;s++)f=c[s],l=j(f.day,1),h=j(f.hour,0),d=j(f.minute,0),v=j(f.month,0),m=j(f.second,0),f=j(f.year,0),f=new Date(f,0<v?v-1:v,l,h,d,m),(u=p(5,0,f)).ignoreBlank(!e),n.push(u)}}function pt(t,n,e){var i,r,o,o,r={none:0,equal:0,lessThan:4,lessThanOrEqual:5,notEqual:1,greaterThan:2,greaterThanOrEqual:3};switch(t){case"string":i=2;break;case"number":i=1,o=parseFloat(e),isNaN(o)||(e=o);break;case"date":i=5,e="string"==typeof e&&0===e.indexOf("/OADate(")?(o=parseInt(e.replace("/OADate(",""),10),v(o)):v(parseInt(e,10)),r={none:0,equal:0,lessThan:2,lessThanOrEqual:3,notEqual:1,greaterThan:4,greaterThanOrEqual:5};break;default:i=11}return p(i,r[n],e)}function bt(t,n,s){var t,e,t,i,t,r,o;function a(t,n){var e,i,r,o,a,r,u,r="notEqual"===t,o=n.indexOf("*"),a=n.lastIndexOf("*");return-1!==o?(e=o===n.length-1&&0!==o?p(2,i=r?3:2,n.substring(0,n.length-1)):0===o&&o===a?p(2,i=r?5:4,n.substring(1)):(r=r?7:6,-1!==o&&-1!==a&&(n=n.substr(1,n.length-2)),p(2,r,n))).ignoreCase(!0):e=pt(u=dt(s),t,n),e}(t=_(t,"customFilters"))&&(e=t.and,i=(t=D(t,"customFilter"))[0],t=t[1],r=void 0,i&&(r=a(i.operator,i.val)),t?n.push(p(0,o="1"===e?1:0,m,m,m,m,m,r,a(t.operator,t.val))):n.push(r))}function yt(t,n,e){var t,i,r,t,e,o,t=_(t,"dynamicFilter");t&&(i=Z[t.type],r=t.val,t=t.maxVal,e=new K.Range(e.row,e.col,e.rowCount,1),o=void 0,100===i||101===i?o=p(10,m,m,m,m,i-100,[e]):16===i?(o=p(6,m,0)).expectTypeId(6):17<=i&&i<=20?(o=p(6,m,i-17)).expectTypeId(2):21<=i&&i<=32?(o=p(6,m,i-21)).expectTypeId(3):0<=i&&i<=15&&(o=p(6,m,i)),o)&&($(r)||(o.value=r),$(t)||(o.maxValue=t),n.push(o))}function wt(t,n){var t,e,i,t,e,t=_(t,"top10");t&&(e=l(t.val,NaN),i=E(t.percent,!1),t=E(t.top,!0)?0:1,(e=p(8,m,e,m,m,t)).isPercent(i),n.push(e))}function Mt(t,n,e,i){var r,o,a;if(1===e.colCount){for(r=[],a=e.row;a<e.row+e.rowCount;a++)o=t.getValue(a,e.col),$(o)||r.push(o);return r.sort(function(t,n){return i?n-t:t-n}),r[n-1]}}function Ct(t){var n,e,i,r,o,a,r,n=[],e=[];for(e.push(t);0<e.length;)0===(o=(r=(i=e.shift())instanceof X.Condition)?i.conType():i.conType)?(a=r?i.item1():i.item1,r=r?i.item2():i.item2,$(a)||e.push(a),$(r)||e.push(r)):n.push(i);return n}function St(t,n){var e,t,i,n,e=t.expected(),t=0===t.compareType(),i,n={n_:"colorFilter",dxfId:n.getDxfIndex(t?{backColor:e}:{backColor:{type:1,patternColor:e}})};return t||(n.cellColor="0"),n}function Tt(t,n,e){var i,r,o,n,a,i={n_:"top10"},r=1===n.type(),o=n.isPercent(),n=n.expected(),a=NaN;return r&&(i.top=0),o&&(i.percent=1),$(n)||(o&&(n=Math.ceil(e.rowCount%n/100)),$(e))||(a=Mt(t,n,e,!r)),isNaN(n)||(i.val=n),isNaN(a)||(i.filterVal=a),i}function At(t,n,e,i,r){var o,n;return $(t)?m:(o=Y[t],6===n&&(o=W[e][t]),(n={n_:"dynamicFilter"}).type=o&&"null"!==o?o:"null",o&&"Q"!==o[0]&&"M"!==o[0]&&($(i)||(n.val=i),$(r)||(n.maxVal=r)),n)}function It(t,n,e){for(var i,r,n,o,a,u,s,c,i=n.type(),r=n.conType(),n=n.expectTypeId()||0,o=0,a=0,s=0;s<e.rowCount;s++)c=parseFloat(t.getValue(e.row+s,e.col)),isNaN(c)||(o+=c,a++);return At(i,r,n,u=0<a?o/a:u)}function xt(t){var n,e,i,r,o,n=new Date,e=n.getDay(),i=n.getDate(),r=new Date(n),o=new Date(n);switch(t){case 3:r.setDate(i-6);break;case 1:r.setDate(i-1);break;case 0:break;case 2:r.setDate(i+1);break;case 8:r.setDate(i-e-7),o.setDate(i-e-1);break;case 7:r.setDate(i-e),o.setDate(i-e+6);break;case 9:r.setDate(i-e+7),o.setDate(i-e+13);break;case 5:r.setDate(1),r.setMonth(r.getMonth()-1),o.setDate(0);break;case 4:r.setDate(1),o.setMonth(o.getMonth()+1),o.setDate(0);break;case 6:r.setDate(1),r.setMonth(r.getMonth()+1),o.setMonth(o.getMonth()+2),o.setDate(0)}return r.setHours(0),r.setMinutes(0),r.setSeconds(0),o.setHours(23),o.setMinutes(59),o.setSeconds(59),{from:r,to:o}}function Nt(t){var n,e,t,i,r,o,n=t.expected(),e=t.conType(),t=t.expectTypeId();return 0<=n&&n<=15||21<=n&&n<=32?(o=xt(n)).from&&o.to&&(i=o.from,r=o.to):n=-1,At(n,e,t,i,r)}function T(t,n){var e,i,e={n_:"customFilter"},i;return"none"!==(t={"-1":"none",0:"equal",4:"lessThan",5:"lessThanOrEqual",1:"notEqual",2:"greaterThan",3:"greaterThanOrEqual"}[t])&&(e.operator=t),e.val=""+n,e}function A(t,n,e){var i;return $(t)&&$(e)?m:(i={n_:"customFilters"},n&&(i.and="1"),$(t)||(i.c_||(i.c_=[]),i.c_.push(t)),$(e)||(i.c_||(i.c_=[]),i.c_.push(e)),i)}function I(t,n,e){var i,r,e,o,i={n_:"filters",c_:[]};return e&&(i.blank="1"),(t=[].concat(t))&&0<t.length&&(r=[],e=[],n||t.forEach(function(t){var t,t,t=t.expected();$(t)||(""===t?i.blank="1":(t={n_:"filter",val:h(t)},r.push(t)))}),0<r.length&&(e=e.concat(r)),o=[],0<(e=n&&(t.forEach(function(t){o.push(_t(t.expected()))}),0<o.length)?e.concat(o):e).length)&&(i.c_=e),i}function kt(t,n){var e,i,r,e,e=t.compareType();if(!$(e))return i=t.expected(),r=void 0,e=T(e,r=$(i)?S(t.D5)+"":i+""),n?e:A(e)}function Dt(t,n){var e,i,r,e=t.expected(),i=-1;switch(t.compareType()){case 0:return I(t);case 1:i=1;break;case 2:e+="*";break;case 3:i=1,e+="*";break;case 4:e="*"+e;break;case 5:i=1,e="*"+e;break;case 6:e="*"+e+"*";break;case 7:i=1,e="*"+e+"*"}return r=T(""+i,e),n?r:A(r)}function _t(t,n){var e,i,r,o,a,u,t,e={n_:"dateGroupItem"},i=t.getFullYear(),r=t.getMonth()+1,o=t.getDate(),a=t.getHours(),u=t.getMinutes(),t=t.getSeconds();return 0<i&&(e.year=i),0<=r&&r<12&&(e.month=r),0<o&&o<32&&(e.day=o),a<24&&(e.hour=a),u<60&&(e.minute=u),t<60&&(e.second=t),e.dateTimeGrouping="day",e}function Et(t,n){var e,i,r,e,e=t.compareType();if(0===e)return I(t,n);switch(i=-1,e){case 0:break;case 1:i=1;break;case 2:i=4;break;case 3:i=5;break;case 4:i=2;break;case 5:i=3}return-1!==i?(e=T(""+i,r=vt(t)),n?e:A(e)):void 0}function jt(t,n){return t.every(function(t){return t.conType()===n})}function Ot(t){var n=-1;switch(t){case 0:case 2:case 4:case 6:n=0;break;case 1:case 3:case 5:case 7:n=1;break;default:n=0}return""+n}function Rt(t,n){switch(n){case 0:case 1:return t;case 2:case 3:return t.concat("*");case 4:case 5:return"*".concat(t);case 6:case 7:return"*".concat(t).concat("*");default:return t}}function Bt(t,n,e,i,r){var o;if(!$(n))return 3===(o=n.conType())?St(n,i):8===o?Tt(t,n,e):10===o?It(t,n,e):6===o?Nt(n):11===o||1===o?kt(n,r):2===o?Dt(n,r):5===o?Et(n,r):void 0}function Lt(t,n,e){var i,r,o,a,u,s,c,t,f,l,h,d,t,f,t,v,t,i=Ct(t),r=i.length,o;if(0===t.compareType()){if(jt(i,5))return I(i,!0);if(jt(i,2)){if(a=!1,r<=2)for(u=0,s=i;u<s.length;u++)if(0!==(c=s[u]).compareType()){a=!0;break}return a?(f=(t=i[0]).compareType(),l=t.expected(),h=T(Ot(f),$(l)?S(t.D5):Rt(l,f)),d=void 0,2===r&&(f=(t=i[1]).compareType(),l=t.expected(),d=T(Ot(f),$(l)?S(t.D5):Rt(l,f))),A(h,!1,d)):I(i)}if(jt(i,11)){if(t=!0,t=i.length<=2?!1:t)return I(i);if(0<i.length)return t=(f=i[0]).compareType(),l=f.expected(),d=h=void 0,h=T(t,$(l)?S(f.D5):l),2===r&&(t=(f=i[1]).compareType(),l=f.expected(),d=T(t,$(l)?S(f.D5):l)),A(h,!1,d)}return A(v=Bt(n,i[0],e,t=void 0,!0),!1,t=1<r?Bt(n,i[1],e,void 0,!0):t)}if(2===r)return h=Bt(n,i[0],e,void 0,!0),$(h)||(d=Bt(n,i[1],e,void 0,!0),$(d))?m:A(h,!0,d)}function Ft(t,n,e){var n,i,n,r,t,r;if(t&&!$(t.ascending)&&!$(t.index))return i={n_:"sortState",ref:n=K.range_parser.getRangeString([new K.Range(n.row,t.index,n.rowCount,1)])},n={n_:"sortCondition",ref:n},t.ascending||(n.descending=1),(r=t.color)!==q&&(t=t.isBackColor,"{"===r[0]&&(r=JSON.parse(r)),r=t?{backColor:r}:{foreColor:r},n.sortBy=t?K.SortBy.cellColor:K.SortBy.fontColor,n.dxfId=e.getDxfIndex(r)),i.c_||(i.c_=[]),i.c_.push(n),i}function Pt(t){for(var n in t)if(t.hasOwnProperty(n)&&!t[n])return;return 1}function Gt(t,n,e){for(var i,r,o,a,u,s,c,f,i=0;i<tt(n);i++)if(!$(n[i]))for(o=(r=n[i]).conditions,a=0;a<tt(o);a++)(u=o[a])&&(s=void 0,f=t[c=r.index],!1===u.isCondition?s=u:(s=p()).fromJSON(u,e),(f=f||(t[c]=[])).push(s))}function Ut(t){for(var n,e,i,r,o,a,n=0,e=[],i=0;i<tt(t);i++)if(r=t[i]){for(o=[],a=void 0,a=0;a<tt(r);a++)o.push(r[a]instanceof X.Condition?r[a].toJSON():J(J({},r[a]),{isCondition:!1}));e[n]={index:i,conditions:o},n++}return e}function r(t){var n=this;n.range=t,n.ict=!0,t&&(n.rct=new K.Range(t.row,t.col,t.rowCount,t.colCount)),n.reset(),n.typeName="",n.filterHandler=m,n.oct()}function Ht(t,n){var e,i,n,r,o,a,u,s,c,f,l;if(n&&(e=t.getRowCount(),i=t.getColumnCount(),r=(n=zt(t,n,e,i)).row,o=n.col,a=n.rowCount,u=n.colCount,s=t.tables,!$(s)))for(c=r;c<r+a;c++)for(f=o;f<o+u;f++)if(l=s.find(c,f))return l}function zt(t,n,e,i){var r=n.row,o=n.col,a=n.rowCount,n=n.colCount;return e=e||t.getRowCount(),i=i||t.getColumnCount(),-1===r&&(r=0,a=e),-1===o&&(o=0,n=i),new K.Range(r,o,a=e<r+a?e-r:a,n=i<o+n?i-o:n)}function o(t){var t=ut.call(this,t)||this;return t.dialogOptions={allowResize:!0,keepDialogSize:!0},t.act=!0,t.typeName=nt,t.uct=et.extend({},R),t.Qst=new a.Formatter.GeneralFormatter("yyyy/mm/dd"),t}function u(){this.c5()}function Vt(t,n,e,i){var r=t.typeName,r,o;r&&r!==nt?(r=(0,K.getTypeFromString)(r))&&(o=new r):o=new Q,o&&((n.IB=o).Mf=n,o.fromJSON(t,e),o.sct=!!i,i)&&o.reFilter()}function Yt(t,n,e,i){var r,r,o,r,r=t.lossless&&t.lossless.typeName;r&&r!==nt?(r=(0,K.getTypeFromString)(r))&&(o=new r):o=new Q,o&&((n.IB=o).Mf=n,o.yh(t,void 0,e),(r=n.parent)&&!0!==r.options.allowAutoExtendFilterRange&&(r.options.allowAutoExtendFilterRange=!0),o.sct=!!i,i)&&o.reFilter()}function Zt(a){a&&(a.bind("shiftCellsDown"+i,function(t,n){var e,i,r,o,n,e=a.rowFilter();e&&e.range&&(i=n.row,r=n.col,o=n.changedRowCount,n=n.changedColCount,e.range.row+e.range.rowCount===i&&--i,e.range.col+e.range.colCount===r&&1!==e.range.colCount&&--r,e.range.contains(i,r,1,1))&&(0<o?e.JO(i,o):o<0&&e.xP(i,o),0<n?e.qO(r,n):n<0&&e.NP(r,n))}),a.bind(K.Events.CellChanged+i,function(){Wt(a,!0)}),a.bind(K.Events.RangeChanged+i,function(){Wt(a,!0)}),a.bind(K.Events.RowChanged+i,function(){Wt(a,!0)}),a.bind(K.Events.ColumnChanged+i,function(){Wt(a,!0)}))}function Wt(t,n){var t=t.rowFilter();t&&(t.ict=n)}function Qt(t){t&&(t.unbind("shiftCellsDown"+i),t.unbind(K.Events.CellChanged+i),t.unbind(K.Events.RangeChanged+i),t.unbind(K.Events.RowChanged+i),t.unbind(K.Events.ColumnChanged+i))}function Jt(t,n,e){void 0===e&&(e=0);var i=n.row,r=n.col,o=n.rowCount,n=n.colCount;return-1===i&&(i=e,o=t.getRowCount()),-1===r&&(r=0,n=t.getColumnCount()),i<=0?i=0:(i--,o+=1),O(i,r,o,n)}function Kt(t){for(var n,e,i,n=[],e=Object.keys(t),i=0;i<e.length;i++)n.push(+e[i])}function s(t,n){n&&(t.filterRowsVisibleInfo=n)}function Xt(t){var n,e,t;return!$(t)&&(n=t.type(),10!==(e=t.conType())||(t=Y[n],!$(t)))}f=this&&this.__extends||(at=function(t,n){return(at=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(t,n){t.__proto__=n}:function(t,n){for(var e in n)Object.prototype.hasOwnProperty.call(n,e)&&(t[e]=n[e])}))(t,n)},function(t,n){if("function"!=typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function e(){this.constructor=t}at(t,n),t.prototype=null===n?Object.create(n):(e.prototype=n.prototype,new e)}),J=this&&this.__assign||function(){return(J=Object.assign||function(t){for(var n,e,i,r,e=1,i=arguments.length;e<i;e++)for(r in n=arguments[e])Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r]);return t}).apply(this,arguments)},x=this&&this.__spreadArray||function(t,n,e){if(e||2===arguments.length)for(var i=0,r=n.length,o;i<r;i++)!o&&i in n||((o=o||Array.prototype.slice.call(n,0,i))[i]=n[i]);return t.concat(o||Array.prototype.slice.call(n))},Object.defineProperty(t,"__esModule",{value:!0}),t.HideRowFilter=t.RowFilterBase=t.FilterActionType=t.zA=void 0,K=n("Core"),a=n("Common"),X=n("ConditionalFormatting"),g=n("./dist/plugins/filter/filter-ui.js"),e=n("./dist/plugins/filter/filter-ns.js"),N=n("./dist/plugins/filter/filter-button-images.js"),D=K.mt.go,_=K.mt.xr,E=K.NodeHelper.ur,j=K.NodeHelper.sr,l=K.NodeHelper.ar,k=K.mt.n1,h=K.mt.vo,v=a.Common.ct.Y0,B=a.Common.ct.o0,m=null,q=void 0,p=X.aJ,O=K.Ec,$=a.Common.lt.ht,L=a.Common.lt.Nh,F=parseInt,n=a.Common.Uf,b=n.hD,y=n.OS,w=n.VP,tt=n.tR,nt="HideRowFilter",i=".filter",et=K.GC$,P=et.each,n=new a.Common.ResourceManager(e.SR,"Filter"),G=n.getResource.bind(n),U=K.UsedRangeUtil.vh,H=K.UsedRangeUtil.hh,t.zA=st,et.extend(K.Worksheet.prototype,z={rowFilter:function(t){var n=this,e=n.IB;return!tt(arguments)||t&&Ht(n,t.range)?e:(n.Ut.cct(e,0),e&&e.reset(),(e=n.IB=t)&&(n.IB.Mf=n),n.zw(),n.Ut.cct(e,0,q,!0),n)},fct:function(){var t,r,n,e,i,o,a,u,s,c,f,l,h,e,t=this,r=[],n=t.rowFilter(),e=n&&n.range,i=t.tables;if(e&&(s=e.row,f=void 0,l=(c=e.col)<0?M(t):c+e.colCount,a=c<0?0:c,f=s<1?(o=C(t,1)-1,1):(o=s-1,3),0<=o))for(;a<l;)n.filterButtonVisible(a)?((u=new g.rut(n)).sheetArea=f,(h=ht(t,u.row=o,a,f))?(u.row=h.row,u.col=h.col,a+=h.colCount):(u.col=a,a++),r.push(u)):a++;return i&&(e=i.all(),P(e,function(t,n){if(o=n.headerIndex(),n&&n.showHeader()&&0<=o)for(var e=n.range(),i=void 0,i=0;i<e.colCount;i++)a=e.col+i,n.filterButtonVisible(i)&&(u=new g.rut(n.rowFilter(),o,a,3),r.push(u))})),r},AO:function(){var t=this,n,n;return n=(n=t.lct)||(t.lct=t.fct())},XT:function(t,n){var e=this.filterRowsVisibleInfo;return!(3!==(n=$(n)?3:n)&&2!==n||!e||e.hct(t))},iA:function(){return this.filterRowsVisibleInfo.dct()},an:function(t,n,e){var i,r,o,a,n,i,a,o,i=this,r=i.zoom(),o=i.parent,a=1<r?1:r,n=3===n||n===q?i.defaults.rowHeight:i.defaults.colHeaderRowHeight,i=F((Math.min(20,n)*a).toString());return o&&o.options.useTouchLayout&&(i=F((n*r).toString())),a={x:t.x+t.width-i,y:t.y+t.height-i,width:i,height:i},e&&0!==e.columnHeaderFitMode&&(o=e.cellWidth)&&(a.x=t.x+o-i),a}}),(e=V=t.FilterActionType||(t.FilterActionType={}))[e.filter=0]="filter",e[e.unfilter=1]="unfilter",R={sortByValue:!0,sortByColor:!0,filterByColor:!0,filterByValue:!0,listFilterArea:!0},Y={"-1":"null",0:"aboveAverage",1:"belowAverage"},Z={null:-1,aboveAverage:100,belowAverage:101,tomorrow:2,today:0,yesterday:1,nextWeek:9,thisWeek:7,lastWeek:8,nextMonth:6,thisMonth:4,lastMonth:5,nextQuarter:10,thisQuarter:11,lastQuarter:12,nextYear:13,thisYear:14,lastYear:15,yearToDate:16,Q1:17,Q2:18,Q3:19,Q4:20,M1:21,M2:22,M3:23,M4:24,M5:25,M6:26,M7:27,M8:28,M9:29,M10:30,M11:31,M12:32},W=[["today","yesterday","tomorrow","lastWeek","thisMonth","lastMonth","nextMonth","thisWeek","lastWeek","nextWeek","nextQuarter","thisQuarter","lastQuarter","nextYear","thisYear","lastYear"],[],["Q1","Q2","Q3","Q4"],["M1","M2","M3","M4","M5","M6","M7","M8","M9","M10","M11","M12"],[],[],["yearToDate"]],r.prototype.getUsedRange=function(){var t,n,t,n=this.extendedRange;return H(n)},r.prototype.oct=function(){var n=this;Object.defineProperty(n,"extendedRange",{get:function(){return n.vct()?(n.ict&&n.mct(),n.rct):n.range},set:function(t){n.rct=t,n.vct()&&n.mct()}})},r.prototype.vct=function(){var t=this,n=t.Mf,n=n&&n.parent;return n&&n.options.allowAutoExtendFilterRange&&t.act},r.prototype.mct=function(){var t,n,e,n,i,r,o,a,u,i,s,n,t=this,n=t.Mf,e=n&&n.Ut,n=t.range;if(n&&e){for(t.rct=new K.Range(n.row,n.col,n.rowCount,n.colCount),r=(i=t.rct).row,o=i.col,a=i.colCount,s=i=r+(u=n.rowCount),n=-1;t.gct(e,s,o,1,a);)s++;n=Math.max(i,s),t.rct.rowCount=n-r,t.ict=!1}},r.prototype.L0=function(){this.Mf=m,this.nM=m},r.prototype.gct=function(t,n,e,i,r){for(var o,a,o=n;o<n+i;o++)for(a=e;a<e+r;a++)if(!$(t.getValue(o,a,K.SheetArea.viewport,!0)))return!0;return!1},r.prototype.filterButtonVisible=function(t,n){var e,i,r,o,a,u,s,i,c,f,u,l,h,e=this,i=e.Uoe();if(!$(i)){if(r=e.Mf,o=e.pct(i),a=e.bct(i,r),s=e.srt,i=o<=t&&t<a,c=tt(u=arguments),u=typeof(f=u[0]),0===c){for(l=o;l<a;l++)if(s[l]||s[l]===q)return!0;return!1}if(h=t,1===c){if("number"==u)return i&&s[h]===q&&(s[h]=!0),s[h];if("boolean"==u){for(r&&r.Ut.cct(e,3),l=o;l<a;l++)s[l]=f;r&&r.Ut.cct(e,3,q,!0)}}else 2===c&&i&&(r&&r.Ut.cct(e,4,t),s[h]=n,r)&&r.Ut.cct(e,4,t,!0);return r&&r.zw(),e}},r.prototype.pct=function(t){return t.col<0?0:t.col},r.prototype.bct=function(t,n){return n&&t.col<0?M(n):t.col+t.colCount},r.prototype.addFilterItem=function(t,n){var e,i,r,o,a,u,e=this,i=e.Mf,r=e.Uoe(),o=e.rrt,a=o[t];if($(n))throw new Error(G().Exp_FilterItemIsNull);if(t<-1||t>=M(i))throw new Error(G().Exp_InvalidColumnIndex);if(r&&(i.Ut.cct(e,5),!(t<(r=i.JS(r)).col||t>=r.col+r.colCount))){if(a=a||[],n instanceof X.Condition)a.push(n);else if(L(n))for(u=0;u<n.length;u++)a.push(n[u]);o[t]=a,i.Ut.cct(e,5,q,!0)}},r.prototype.removeFilterItems=function(t,n){this.Mf.Ut.cct(this,6),this.yct(t),this.unfilter(t,n),this.Mf.Ut.cct(this,6,q,!0)},r.prototype.yct=function(t){var n=this,e=n.rrt;n.wct(t),e[t]&&e.splice(t,1,m)},r.prototype.unfilter=function(t,n){var e,i,r,o,a,e=this,i=e.Mf;if(i){if(i.Ut.cct(e,2),r=[],o=e.Mct,a=void 0,$(t))for(a=tt(o)-1;0<=a;a--)r.push(o[a]),e.Cct(o[a]);else r.push(t),e.Cct(t),e.reFilter(n);n||e.Sct(i,1,r),i.Ut.cct(e,2,q,!0)}},r.prototype.Tct=function(t){var n,e,i,r,o,a,u,s,n=this,e=n.Uoe();if(n.Cct(t),n.rrt[t]&&e&&(-1===(i=e.col)||!(t<i||t>=i+e.colCount))){for(r=(e=n.Mf.JS(e)).row,o=e.rowCount,a=n.Act(t,r,o),u=void 0,(s=n.Ict(r,o,t,a)).forEach(function(t){t.ZJ()}),u=r;u<r+o;u++)n.isRowFilteredOut(u)||n.xct(s,u,t,a);s.forEach(function(t){t.WJ()}),n.Nct(t,!0)}},r.prototype.Act=function(t,n,e){for(var i,r,o,a,u,s,c,f,l,h,d,d,v,i=this,r=i.Mf,o=lt(i.rrt[t]),a={},u=tt(o),s=n;s<n+e;s++){for(h={},c=0;c<u;c++)"T"===(f=o[c])?(d=r.getText(s,t),h[f]=d&&d.trim()):"DT"===f?(d=r.getValue(s,t),v=i.Qst,h[f]=v.format(d)):"BC"===f?(l=r.getActualStyle(s,t,3,!1,!1,!0))&&(h[f]=l.backColor):"FC"===f?(l=r.getActualStyle(s,t,3,!1,!1,!0))&&(h[f]=l.foreColor):"V"===f&&(h[f]=r.getValue(s,t));a[s]=h}return a},r.prototype.filter=function(t,n){var e,i,r,o,a,e=this,i=e.Mf,r=e.rrt;if(i){if(i.Ut.cct(e,7),!(a=[])===e.sct&&(delete e.sct,e.Mct=[]),$(t))for(o=0;o<tt(r);o++)r[o]&&(a.push(o),e.Tct(o));else{if(!r[t])return;a.push(t),e.Tct(t)}n||e.Sct(i,0,a),i.Ut.cct(e,7,q,!0)}},r.prototype.Sct=function(t,n,e){var i,n,i=this;t.kct&&t.kct(),n=i.Dct(n,e),i.filterHandler&&i.filterHandler(n),i.onFilter(n),t.zw()},r.prototype.Dct=function(t,n){var e,i,r,o,a,u,s,c,e=this,i=e.Mf,r=e.Uoe(),o=[],a=[];if(r)for(c=void 0,c=s=(u=i.JS(r)).row;c<s+u.rowCount;c++)(e.isRowFilteredOut(c)?a:o).push(c);return{action:t,sheet:i,range:r,filteredRows:o,filteredOutRows:a,columns:n}},r.prototype.onFilter=function(t){},r.prototype.isFiltered=function(t){var n=this.Mct;return arguments.length?y(n,t):0<n.length},r.prototype.isRowFilteredOut=function(t){var n,e,i,r,n=this,e=n.Uoe();return!(!n.isFiltered()||!e||(i=e.row,r=n._ct[t],-1!==i&&(t<i||t>=i+e.rowCount))||tt(r)>=tt(n.Mct))},r.prototype.reset=function(){var t=this,n=t.Mf;n&&n.Ut.cct(t,8),t.nrt=m,t.unfilter(),t.rrt=[],t.Mct=[],t.Ect=[],t._ct={},t.srt={}},r.prototype.rn=function(t,n,e){var i,r,o,i,a,u,n,i=this,r=!1,o=i.Mf,i=i.Uoe();return r=i&&(a=(i=o.JS(i,e)).row,n=(u=i.col)<=n&&n<u+i.colCount,1===e&&t===C(o,e)-1&&a-1<0&&n||3===e&&t===a-1&&n)?!0:r},r.prototype.getFilterItems=function(t){var n;return this.rrt[t]||[]},r.prototype.getFilteredItems=function(){return this.Ect},r.prototype.sortColumn=function(t,n){this.ert(t,n,null)},r.prototype.ert=function(t,n,e,i,r){var o,a,u,u,s,c,o=this,a=o.Mf;if(a){u=o.Uoe(),u=a.JS(u),a.suspendPaint();try{a.Ut.cct(o,1,t),s={index:t,ascending:n,compareFunction:e},(c=a.sortRange(u.row,u.col,u.rowCount,u.colCount,!0,[s],i,m,r))&&(o.nrt=s,o.isFiltered(t))&&o.reFilter(),a.Ut.cct(o,1,t,!0)}finally{a.resumePaint()}}},r.prototype.sortColumnByColor=function(t,n,e,i,r,o){var a,u,s,s,s,c,a=this,u=a.Mf;u&&(s=a.Uoe(),s=u.JS(s),u.suspendPaint(),u.Ut.cct(a,1,t),(c=u.sortRange(s.row,s.col,s.rowCount,s.colCount,!0,[s={index:t,ascending:n,color:e,isBackColor:i}],r,m,o))&&(a.nrt=s,a.isFiltered(t))&&a.reFilter(),u.Ut.cct(a,1,t,!0),u.resumePaint())},r.prototype.getSortState=function(t){var n=this.nrt,e=0;return e=n&&n.index===t?n.ascending?1:2:e},r.prototype.reFilter=function(t){var n,e=this,i=e.Mct,r=tt(i);for(e.Mf.Ut.cct(e,13),e._ct={},e.Ect=[],e.Mct=[],n=0;n<r;n++)e.filter(i[n],t);e.Mf.Ut.cct(e,13,q,!0)},r.prototype.openFilterDialog=function(){},r.prototype.jct=function(t,n){var e=this._ct,i=e[t];$(i)?i=[n]:(y(i,n)&&w(i,n),i.push(n)),e[t]=i},r.prototype.Rct=function(t){var n=this.Ect;y(n,t)||n.push(t)},r.prototype.Cct=function(t){var n,e,i,r,o,n=this,e=n._ct,r;if(n.Uoe()&&n.isFiltered(t)){for(o in n.Nct(t,!1),e)o&&(i=e[o])&&y(i,t)&&(w(i,t),tt(i)||(e[o]=q));n.wct(t)}},r.prototype.Nct=function(t,n){var e=this.Mct;if(n){if(tt(e)){if(e[tt(e)-1]===t)return;w(e,t)}e.push(t)}else w(e,t)},r.prototype.wct=function(t){for(var n,e,i,r,o,a,u,n=this,e=n.rrt,i=e.length,r=[],o=[],a=0;a<i;a++)a===t?r=r.concat(e[a]):o=o.concat(e[a]);for(u=r.length,a=0;a<u;a++)y(o,r[a])||w(n.Ect,r[a])},r.prototype.Ict=function(t,n,e,i){for(var r,o,a,u,s,c,f,l,h,h,r=this,o=r.rrt[e],a={},u=[],s=0;s<tt(o);s++)2!==d(c=o[s])||0!==c.compareType()||c.forceValue2Text()||c.useWildCards()||c.ignoreCase()||c.ignoreBlank()?u.push(c):c.art?a[(f=r.Qst).format(c.urt)]=c:a[c.expected()]=c;for(s=t;s<t+n;s++)l=r.isRowFilteredOut(s),a[(h=i[s]).T]===q&&a[h.DT]===q||(h=a[h.T]||a[h.DT],r.jct(s,e),l)||r.Rct(h);return u},r.prototype.xct=function(t,n,e,i){for(var r,o,a,u,s,c,f,l,r=this,o=r.Uoe(),a=0;a<tt(t);a++)if(s=(u=t[a]).item1(),c=u.item2(),l=f=void 0,0===d(u)?(s&&(f=r.Bct(s,n,e,o,i)),c&&(l=r.Bct(c,n,e,o,i))):f=r.Bct(u,n,e,o,i),u.evaluate(r.Mf,n,e,f,l)){r.jct(n,e),r.Rct(u);break}},r.prototype.Bct=function(t,n,e,i,r){var o,a,u,s,r,n,o,i,o=this,a=m,u=d(t),s=t.compareType(),r=r[n];return 8!==u&&10!==u||(n=[],(i=(o=o.Mf.JS(i)).col)<=e&&e<i+o.colCount&&n.push(O(o.row,e,o.rowCount,1)),t.ranges(n)),2===u||7===u?a=r.T:3===u?0===s?a=r.BC:1===s&&(a=r.FC):a=r.V,a},r.prototype.Lct=function(t,n){var e,i,r,i,e,o,e=this,i=e.Mct;return!!tt(i)&&(i=e._ct[t],e=tt(i),!!($(i)||e<0)||(o=b(i,n))<0)},r.prototype.Kst=function(t,n){var e,i,r,n,e,t,e=this,i=e.Mct;return!!tt(i)&&(r=-1,n=b(i,n),e=e._ct[t],t=tt(e),-1<(r=0<n?i[n-1]:r)?!!t&&r===e[t-1]:!t)},r.prototype.Fst=function(t,n){var e,i,r,e,t,e=this,i=e.Mct;return!tt(i)||(r=b(i,n),e=e._ct[t],(t=tt(e)||0)>=tt(i))||!(r<0||t<tt(i)-1)&&(!e||b(e,n)<0)},r.prototype.JO=function(t,n,e){var i,r,o,a,u,s,c,f,l,h,d,v,m,g,p,i=this,r=i.range;if(r&&(o=C(i.Mf)-n-1,a=r.row,u=r.col,s=r.rowCount,c=r.colCount,-1<a&&(o=a+s-1,t<a||e&&t===a&&0===t?i.Fct(O(a+n,u,s,c)):t<a+s&&i.Fct(O(a,u,s+n,c))),f=i._ct,i.isFiltered())&&f){for(l=[],h=void 0,Object.keys(f).forEach(function(t){l.push(+t)}),l.sort(function(t,n){return n-t}),d={},v=[],h=0;h<tt(l);h++)t<=(m=l[h])&&m<=o?d[m+n]=f[m]:m<t&&(d[m]=f[m]);for(-1!==u&&-1!==c||(u=0,c=i.Mf.getColumnCount()),g=0;g<c;g++)v.push(g+u);for(p=0;p<n;p++)d[p+t]=x([],v,!0);i._ct=d}},r.prototype.qO=function(t,n,e){var i,r,o,a,u,r,s,c,f,l,h,d,v,v,i=this,r=i.range;if(r=i.nM&&(e||t>r.col&&t<=r.col+r.colCount)?i.nM.dataRange():r){if(o=r.row,a=r.col,u=r.rowCount,r=r.colCount,c=-1,(f=s=0)<=t&&i.Pct()){for(l=0;l<n;l++)l+t<=i.Gct()&&s++;i.Gct(i.Gct()+s)}for(-1<a&&(t<=a&&!e?i.Fct(O(o,(c=a)+n,u,f=r)):t<a+r&&(f=r-((c=t)-a),i.Fct(O(o,a,u,r+(h=e?0:n))))),c<0&&(c=0,f=M(i.Mf)-n),l=c+f-1;c<=l;l--)t<=l&&(d=l+n,0<=(v=b(i.Mct,l))&&(i.Mct[v]=d),v=i.rrt[l],tt(v))&&(w(i.rrt,l),i.rrt[d]=v);i.reFilter()}},r.prototype.xP=function(t,n){var e,i,r,o,a,u,s,c,f,i,l,h,d,v,e=this,i=e.range,r=e.Mf,o=r&&r.parent;if(i&&(a=0,u=C(r)+n-1,s=i.row,c=i.col,f=i.rowCount,i=i.colCount,-1<s&&(u=(a=s)+f-1,t<=s?r.cp?(e.Fct(O(t,c,f,i)),delete r.cp):s===t+1||s+f<=t+n?o&&!o.options.allowAutoExtendFilterRange&&0!==f&&e.Fct(m):s<t+n?e.Fct(O(t,c,s+f-(t+n),i)):e.Fct(O(s-n,c,f,i)):t<s+f&&e.Fct(O(s,c,f-Math.min(s+f-t,n),i))),l=e._ct,e.isFiltered())&&l)for(h=a;h<=u;h++)t<=h&&h<t+n?l[h]=q:t+n<=h&&(v=l[d=h])&&(l[d-n]=v,l[d]=q)},r.prototype.Fct=function(t){this.Mf.Ut.cct(this,14),this.range=t,this.ict=!0,this.Mf.Ut.cct(this,14,q,!0)},r.prototype.Uct=function(t){var n,e,i,r,o,a,u,s,c,f,l,h,d,v,f,n=this,e=n.Mf,i=n.range;if(i)if(t){if(!t.equals(i)){if(a=i.col,u=i.colCount,s=t.col,c=t.colCount,f=M(e),n.isFiltered()&&!(a<0&&s<0))for(a<0&&(a=0,u=f),s<0&&(s=0,c=f),r=0;r<u;r++)((o=a+r)<s||s+c<=o)&&n.removeFilterItems(o);if(l=i.row,h=i.rowCount,d=t.row,v=t.rowCount,f=C(e),n.isFiltered()&&n._ct&&!(l<0&&d<0))for(l<0&&(l=0,h=f),d<0&&(d=0,v=f),r=0;r<h;r++)((o=l+r)<d||d+v<=o)&&(n._ct[o]=q)}}else n.reset();!n.Pct()||t&&t.contains(-1,n.Gct())||(n.nrt=m),n.Fct(t)},r.prototype.NP=function(t,n){var e,i,r,o,r,a,u,s,c,f,l,h,e=this,i=e.range,r=e.Gct(),o=t+n;if(i){for(0<=t&&e.Pct()&&(t<=r&&r<o?e.Gct(-1):o<=r&&e.Gct(r-n)),r=i.row,a=i.col,u=i.rowCount,s=a<0?(a=0,M(e.Mf)+n):i.colCount,c=a;c<a+s;c++)t<=c&&(c<o?e.removeFilterItems(c):(f=c-n,l=b(e.Mct,c),h=e.rrt[c],0<=l&&(e.Mct[l]=f),tt(h)&&(w(e.rrt,c),e.rrt[f]=h)));0<=a&&(t<a?o<=a?e.Fct(O(r,a-n,u,s)):o<=a+s?e.Fct(O(r,t,u,a+s-o)):e.Fct(m):t<a+s&&(o<=a+s?e.Fct(O(r,a,u,s-n)):e.Fct(O(r,a,u,t-a)))),e.reFilter()}},r.prototype.Pct=function(){var t=this,n=t.nrt;return!!n&&-1<n.index&&0!==t.getSortState(n.index)},r.prototype.Gct=function(t){var n=this,e=n.nrt,t,t=tt(arguments)?(e?e.index=t:n.nrt={index:t,ascending:!1},n):e?e.index:-1;return t},r.prototype.d5=function(t,n,e,i){var r,o,t,n,e,r=this,o=r.range;o&&(t=O(t,n,e,i),r.filterButtonVisible()?(n=o.row-1,e=o.rowCount+1,n<0&&(e=n=-1),t.containsRange(O(n,o.col,e,o.colCount))&&r.unfilter()):t.containsRange(o)&&r.unfilter())},r.prototype.fromJSON=function(t,n){var e,i,r,o,a,u,s,c,f,l,h,d;if(t){for(i=t.range,r=t.filterItemMap,o=(e=this).rrt,a=t.sortInfo,u=t.showFilterButton,s=t.filterButtonVisibleInfo,h=e.Mf,i&&(e.range=O(i.row,i.col,i.rowCount,i.colCount)),t.dialogVisibleInfo&&(e.uct=et.extend({},R,t.dialogVisibleInfo)),Gt(o,r,n),l=t.filteredColumns||t.filteredColMap,c=0;c<tt(l);c++)$(l[c])||e.Mct.push(l[c]);if(a&&a.color===q?e.nrt={index:a.index,ascending:a.ascending}:a&&a.color!==q&&(e.nrt={index:a.index,ascending:a.ascending,color:a.color,isBackColor:a.isBackColor}),u!==q)if(d=e.range,s)e.srt=s;else if(d)for(c=e.pct(d);c<e.bct(d,h);c++)e.srt[c]=u}},r.prototype.yh=function(t,n,e){var i,r,o,a,u,s,c,o,i,f,l,h,d,v,m,g,p,p,b,t,y,w,s,t,i,M,M,s,i,M,C,S,T,A,I,x,N,k;if(t&&(i=t.ref&&t.ref.toUpperCase(),o=(r=t.lossless)&&r.range,i&&"#REF!"!==i||o)){if(u=(a=this).Mf,o?s=o:(s=K.range_parser.Dc(i)[0],(c=r&&r.isSJSFilter)||(0<=s.row&&(s.row=s.row+1),0<=s.rowCount&&(s.rowCount=s.rowCount-1))),o=D(t,"filterColumn"),i=_(t,"sortState")||n,s&&(a.range=O(s.row,s.col,s.rowCount,s.colCount)),r&&r.dialogVisibleInfo&&(a.uct=et.extend({},R,r.dialogVisibleInfo)),f=a.range,l=a.rrt,h=f&&f.col,o)for(v=0,m=o;v<m.length;v++)p=(g=m[v]).colId,$(p)||$(h)||(mt(g,b=(b=l[p=parseInt(p,10)+h])||[],e),gt(g,b),bt(g,b,u.getValue(f.row,p)),yt(g,b,f),wt(g,b),0<b.length&&(a.rrt[p]=b,a.Mct.push(p)),!d&&0<b.length&&(d=!0));if((t=r&&r.filterItemMap)&&Gt(l,t),(y=r&&r.filterColumns)&&0<y.length)for(w=0;w<y.length;w++)-1===a.Mct.indexOf(y[w])&&a.Mct.push(y[w]);if(i&&(t=(s=_(i,"sortCondition")).sortBy,i=!s.descending,M=K.range_parser.Dc(s.ref)[0].col,a.nrt={index:M,ascending:i},t!==K.SortBy.fontColor&&t!==K.SortBy.cellColor||(M=j(_(s,"dxfId"),0),i=void 0,(s=e.getDxf(M))&&(i=s.backColor),a.nrt.color=i||"",a.nrt.isBackColor=t===K.SortBy.cellColor)),f&&(C=(M=u.Ut.Q_(!0,3)).getHiddenRows(),S=M.infos,d)&&C&&0<C.length&&o&&0<o.length&&u.filterRowsVisibleInfo){for(T=u.filterRowsVisibleInfo.rowsVisibleInfo||{},A=!0,I=f.row,x=f.row+f.rowCount;I<x;I++)0<=C.indexOf(I)&&(A=T[I]=!1,S[I])&&!1===S[I].visible&&(S[I].visible=!0);!1===A&&(u.filterRowsVisibleInfo.rowsVisibleInfo=T,u.filterRowsVisibleInfo.empty=!1)}for(N=!0,(r&&(!1===r.showTableHeader||!1===r.showFilterButton)||!f&&!n||o&&0<o.length&&!0===E(o[0].hiddenButton,!1))&&(N=!1),!f&&r&&(a.range=f=r.filterRange),k=r&&r.filterButtonVisibleInfo,I=a.pct(f);I<a.bct(f,u);I++)a.srt[I]=k?k[I]:N}},r.prototype.getToJsonRowFilter=function(){var t,n,e,i,r,o,a,u,s,c,f,l,t=[],n=this.Mf,e=this.range,i=n.parent&&n.parent.options.saveChangesForSheet,o=r=0;if((e=i&&this.extendedRange?this.extendedRange:e)&&(r=e.row,o=Math.min(n.getRowCount()-1,e.row+e.rowCount-1)),n&&(a=n.filterRowsVisibleInfo&&n.filterRowsVisibleInfo.rowsVisibleInfo,!$(a)))for(s=void 0,c=0,f=u=Object.keys(a);c<f.length;c++)r<=(s=+(l=f[c]))&&s<o&&!1===a[s]&&t.push(s);return t},r.prototype.toJSON=function(){var t,n,e,i,r,o,a,u,s,c,f,l,h,d,v,t=this,n={},e=t.range,i=t.srt,r=t.rrt,o=t.Mct,a=t.nrt,u=[],c=0,f=t.typeName,l=t.f8;if(l&&(n.adjustRangeForFrozen=l),e&&(n.range=e),f&&(n.typeName=f),t.uct){for(d in h={},t.uct)t.uct.hasOwnProperty(d)&&!1===t.uct[d]&&(h[d]=!1);n.dialogVisibleInfo=h}if(u=Ut(r),tt(u)&&(n.filterItemMap=u),tt(o)&&(n.filteredColumns=o),a&&(n.sortInfo=a),i)if(et.isEmptyObject(i))n.showFilterButton=!0;else{for(s in n.filterButtonVisibleInfo=et.extend({},i),v=!1,i)if(i[s]){v=!0;break}n.showFilterButton=v}return n.filteredOutRows=t.getToJsonRowFilter(),n},r.prototype.wh=function(B,t,n){var e,i,r,o,a,u,s,c,f,l,h,L,d,v,m,g,p,b,y,p,w,M,C,S,T,F,P,A,I,x,N,G,k,U,D,H,z,C,V,_,C,E,Y,j,Z,l,C,n,l,W,O,Q,R,e=B.c_,i=this,r=i.Mf,o=i.range,a=i.rrt,u=i.Mct,s=[],c=o&&o.col,f=i.nM,l=1,h=!1;if(f&&(!1===(L=f.jO)&&(l=0),h=!0),d=n&&K.OpenSaveFileType.excel===n.fileType,a&&0<a.length&&u&&0<u.length)for(m=0;m<tt(a);m++)if(g=a[m]){if(d&&(!o||m<c||m>=c+o.colCount||u.indexOf(m)<0))return;if(b=void 0,(p=g[0])instanceof X.Condition)for(b=p,y=1;y<g.length;y++)b=(0,X.aJ)(0,0,q,q,q,q,q,b,g[y]);b&&(Xt(b)?(p={n_:"filterColumn",colId:(f?m-f.iw:m-c)+""},o&&(w=new K.Range(o.row+(d?1:0),c,(o.rowCount<0?r.getRowCount():o.rowCount)-(d?1:0),o.colCount<0?r.getColumnCount():o.colCount),M=void 0,1===tt(g)&&(M=Bt(r,b,w,t),!$(M))||(M=Lt(b,r,w)),$(M)||(p.c_=[M])),s.push(p)):d||(v=$(v)?[]:v).push({index:m,conditions:[b instanceof X.Condition?b.toJSON():J(J({},b),{isCondition:!1})]}))}if(C=r.getSpans(),S=[],o&&C&&0<C.length){for(T=o.row-1,F=0<s.length,P=o.colCount,A=0,I=C;A<I.length;A++)if(N=(x=I[A]).row,G=x.rowCount,k=x.col,U=x.colCount,c<=k&&k+U<=P&&(T===N||T==N+G-1))for(D=k;D<k+U-1;D++)H=D-c,!F&&!0!==h||((z=s[D])&&+z.colId==H?s[D].showButton=0:S.push({n_:"filterColumn",colId:H,showButton:0}));s=s.concat(S)}if((C=i.nrt)&&o&&(h?V=Ft(C,o,t):s.push(Ft(C,o,t))),C=!0,_=i.srt){if(E=!1,et.isEmptyObject(_))E=!0;else for(m in _)if(_[m]){E=!0;break}if(0!==l){if(f&&(!E||!Pt(_)))if(0===s.length){if(d&&o)for(m=0;m<o.colCount;m++)s.push({n_:"filterColumn",colId:m+"",hiddenButton:"1"})}else for(Y=void 0,j=0,Z=s;j<Z.length;j++)_[(Y=Z[j]).colId]||(Y.hiddenButton=1)}else C=!1}if(o&&C){if(l=i.f8?r.frozenRowCount():0,C=!(n&&n.fileType===K.OpenSaveFileType.excel),n={n_:"autoFilter",ref:K.range_parser.jc(C?o:Jt(r,o,l))},C&&(n.lossless||(n.lossless={}),n.lossless.isSJSFilter=C,n.lossless.filterButtonVisibleInfo=_,(W=(l=i.typeName)&&l!==nt)?(n.lossless.typeName=l,n.lossless.filterItemMap=Ut(a)):$(v)||(n.lossless.filterItemMap=v,n.lossless.filterColumns=i.Mct),O=i.uct)){for(R in Q={},O)O.hasOwnProperty(R)&&!1===O[R]&&(Q[R]=!1);n.lossless.dialogVisibleInfo=Q}0<s.length&&(n.c_=s),(e=e||(B.c_=[])).push(n),V&&e.push(V)}},r.prototype.Hct=function(t){var t=t.options;return!t.isProtected||t.protectionOptions.allowFilter},r.prototype.hitTest=function(t,n,e){var i,r,o,t,a,u,s,c,t,a,u,s,f,l,u,f,l,s,i=this.Mf;if(i){if(r=t.rowViewportIndex,o=t.colViewportIndex,t=t.hitTestType,a=i.yw(o),1===t?(u=i.jF().findY(e),s=a.findX(n),c=1):3===t&&(u=i.dw(r).findY(e),s=a.findX(n),c=3),!u||!s)return m;if(u=ht(i,t=u.row,a=s.col,c),s=i.AO(),u){if(f=u.row,l=u.col,!u.contains(t,a,1,1))return m;t=f,a=l}return s&&(u=ct(s,t,a,c))&&(f=i.getCellRect(t,a,r,o,!0),l=i.Lt(a),(s=i.an(f,c,{columnHeaderFitMode:l,cellWidth:i.getColumnWidth(a)})).x<=n)&&n<=s.x+s.width&&s.y<=e&&e<=s.y+s.height?new g.rut(u.rowFilter,u.row,u.col,u.sheetArea,s.x,s.y,s.width,s.height):m}},r.prototype.Uoe=function(){return this.extendedRange||this.range},t.RowFilterBase=n=r,f(o,ut=n),o.prototype.onFilter=function(t){var n=this,e=n.Mf;e&&(n.zct(e,t.filteredRows,t.filteredOutRows),e.iP())},o.prototype.filterDialogVisibleInfo=function(t){var n;return 0===arguments.length?(this.uct||(this.uct=et.extend({},R)),this.uct):t?(n={},t.sortByValue!==q&&(n.sortByValue=!!t.sortByValue),t.sortByColor!==q&&(n.sortByColor=!!t.sortByColor),t.filterByColor!==q&&(n.filterByColor=!!t.filterByColor),t.filterByValue!==q&&(n.filterByValue=!!t.filterByValue),t.listFilterArea!==q&&(n.listFilterArea=!!t.listFilterArea),et.extend(this.uct,n),this):void 0},o.prototype.zct=function(t,n,e){var i,r,i,i=t.filterRowsVisibleInfo;i&&((r=t.getCalcService()).suspend(),r.Vct="filter",i=i.Yct(n,e),t.recalcRows&&t.recalcRows(i),delete r.Vct,r.resume(!1),r.Zct())},o.prototype.openFilterDialog=function(t){var n,e,t,n=this,e=n.Mf;n.Hct(e)&&(t=new g.iut(e.parent.j2(),e,t,n.filterDialogVisibleInfo(),n.dialogOptions),(e.Cut=t).rQ())},Q=o,t.HideRowFilter=Q,u.prototype.hct=function(t){var t;return!!this.empty||(t=this.rowsVisibleInfo[t],!!$(t))||t},u.prototype.Yct=function(t,n){for(var e,i,r,o,a,u,s,c,f,l,e=[],i=this.rowsVisibleInfo,r=0,o=t.length;r<o;r++)(u=i[a=t[r]])!==q&&u!==m&&e.push(a),delete i[a];for(s=0,c=n.length;s<c;s++)(l=i[f=n[s]])!==q&&l!==m||e.push(f),i[f]=!1;return this.empty=!1,e},u.prototype.c5=function(){this.rowsVisibleInfo={},this.empty=!0},u.prototype.Wct=function(t,n){for(var e,i,r,e=this.rowsVisibleInfo,r=0;r<n;r++)i=e[r+t],$(i)||delete e[r+t]},u.prototype.rE=function(t,n){for(var e,i,r,o,a,u,s,e=this.rowsVisibleInfo,i={},r,a=0,u=Object.keys(e);a<u.length;a++)t<=(o=+(s=u[a]))?i[o+n]=e[o]:i[o]=e[o];this.rowsVisibleInfo=i},u.prototype.aE=function(t,n){for(var e,i,r,o,a,u,s,c,e=this.rowsVisibleInfo,i={},r,o=t+n,u=0,s=Object.keys(e);u<s.length;u++)t<=(a=+(c=s[u]))&&a<o?delete e[a]:o<=a?i[a-n]=e[a]:i[a]=e[a];this.rowsVisibleInfo=i},u.prototype.dct=function(){return!this.empty},u.prototype.clone=function(){var t=new u;return t.rowsVisibleInfo=et.extend({},this.rowsVisibleInfo),t.empty=this.empty,t},it=u,K.Worksheet.ch("filter",rt={init:function(){var n=this;n.IB=m,n.filterRowsVisibleInfo=new it,n.$L.push({tF:function(t){return n.filterRowsVisibleInfo.hct(t)}}),Zt(n)},getUsedRange:function(t){var n,e,e;t.type&K.UsedRangeType.filter&&(e=(e=(n=this).IB)&&e.getUsedRange(),U(t.range,e))},processMouseDown:function(t){var n=t.hitInfo.filterButtonHitInfo;n&&(n.rowFilter.openFilterDialog(n),t.r=!0)},onLayoutChanged:function(t){var n,e,i,r,o,a,u,s,n,n=this,e=t.changeType,i=t.row,r=t.rowCount,o=t.col,a=t.colCount,u=n.IB;"invalidateLayout"===e?n.lct=m:(s=$(t.sheetArea)||t.sheetArea===K.SheetArea.viewport,u&&(n=n.Ut,"addRows"===e&&s?n.Qct(i,r,t.rowExpand):"deleteRows"===e&&s?n.Kct(i,r):"addColumns"===e&&s?n.Jct(o,a):"deleteColumns"===e&&s?n.Xct(o,a):"clear"===e&&u.range&&n.qct(i,o,r,a)))},dispose:function(t){var n=this,e=n.Cut,t=t&&t.clearCache;e&&e.close(),!1!==t&&Qt(n)},toJson:function(t,n){var e,n,e=this.IB,n=n&&n.ignoreStyle;e&&!n&&(t.rowFilter=e.toJSON())},wh:function(t,n,e){var i=this.IB,r=e&&!1===e.includeStyles;!i||r||this.NMi||i.wh(t,n.styleManager,e)},yh:function(t,n,e){var i,e,i,i=e&&!1===e.includeStyles,e=e&&e.isApplyRefilter;i||(i=_(t,"autoFilter"),$(i))||Yt(i,this,n.styleManager,e)},fromJson:function(t,n,e){var i,t,e,i=t.rowFilter,t=t.isApplyRefilter,e=e&&e.ignoreStyle;i&&!e&&Vt(i,this,n,t)},paintCell:function(t){var n,e,i,r,o,a,u,s,c,f,l,h,d,v,m,s,o,u,t,m,e,i,n=this,e=t.cell,i=e.width,r=e.height,o=e.cellLayout,a=n.BO(),u=n.AO(),s=[],c=t.ctx;if(e&&e.cornerX&&0!==e.columnHeaderFitMode&&(f=e.columnHeaderFitMode,h=(l=e.cornerX)-e.x),(!o||!y(s,o))&&u&&0<i&&0<r&&(m=ct(u,d=e.baseRow||e.row,v=e.baseCol||e.col,t.sheetArea))){s=new g.rut(m.rowFilter,m.row,m.col,m.sheetArea,e.x,e.y,i,r),u=(o=n.an(new K.Rect(s.x,s.y,s.width,s.height),s.sheetArea,{cellWidth:h,columnHeaderFitMode:f})).width,t=o.height,m=o.x,e=o.y,i=(0,N.getFilterButtonImageSrc)(s.jt()),c.save(),c.rect(s.x,s.y,s.width,s.height),c.clip(),c.beginPath(),c.lineWidth=1,c.fillStyle="#FFFFFF",c.strokeStyle="#CCCCCC",c.fillRect(m+1,e+1,u-3,t-3),c.strokeRect(m+1-.5,e+2-.5,u-3,t-4);try{a.jt(i)?c.drawImage(a.Ot(i),m,e+1,u-3,t-3):a.Rt(i)}catch(t){}c.beginPath(),c.restore()}}}),K.Workbook.ch("filter",ot={init:function(){K.Commands.crt(this.commandManager())},onCultureChanged:function(){G()}}),et.extend(K.Y8.prototype,{cct:function(t,n,e,i){var r,o,a,u,s,r=this,o=r.G8;if(o){switch(o.originalFilter||(o.originalFilter=[]),a={type:n,newState:i,rowFilter:t},n){case 0:u=void 0,u=t?{range:t.range,typeName:t.typeName,filteredColumns:t.Mct.concat([]),filteredItems:t.Ect.concat([]),filterItemMap:t.rrt.concat([]),filteredInRowsWithColIndexs:et.extend({},t._ct),filterButtonVisibleInfo:et.extend({},t.srt),sortInfo:et.extend({},t.nrt)}:m,s=r.Mf.filterRowsVisibleInfo.clone(),a.changeInfo={rowFilter:u,filterRowsVisibleInfo:s};break;case 2:case 7:a.changeInfo={filteredColumns:t.Mct.concat([]),filterRowsVisibleInfo:r.Mf.filterRowsVisibleInfo.clone()};break;case 1:a.changeInfo=t.nrt;break;case 3:a.changeInfo=et.extend({},t.srt);break;case 4:a.changeInfo={col:e,val:t.srt[e]};break;case 5:case 6:a.changeInfo={filterItemMap:t.rrt.concat([]),filterRowsVisibleInfo:r.Mf.filterRowsVisibleInfo.clone(),filteredColumns:t.Mct.concat([])};break;case 8:a.changeInfo={range:t.range,filteredColumns:t.Mct.concat([]),filteredItems:t.Ect.concat([]),filteredInRowsWithColIndexs:et.extend({},t._ct),filterButtonVisibleInfo:et.extend({},t.srt),sortInfo:et.extend({},t.nrt),filterRowsVisibleInfo:r.Mf.filterRowsVisibleInfo.clone()};break;case 9:case 10:a.changeInfo={range:t.range,filteredInRowsWithColIndexs:et.extend({},t._ct),filteredColumns:t.Mct.concat([]),filterRowsVisibleInfo:r.Mf.filterRowsVisibleInfo.clone()};break;case 11:case 12:a.changeInfo={range:t.range,sortInfo:et.extend({},t.nrt),filterItemMap:t.rrt.concat([]),filteredColumns:t.Mct.concat([]),filterRowsVisibleInfo:r.Mf.filterRowsVisibleInfo.clone()};break;case 13:a.changeInfo={filteredInRowsWithColIndexs:et.extend({},t._ct),filteredItems:t.Ect.concat([]),filteredColumns:t.Mct.concat([])};break;case 14:a.changeInfo={range:t.range}}o.originalFilter.push(a)}},$ct:function(t){var n,e,i,r,o,o,n,e=this.Mf,i=t.rowFilter,r=t.changeInfo;if(i||0===t.type){if(i&&"Object"===i.constructor.name){if(!i.range)return;i.tableName?(o=e.tables.findByName(i.tableName))&&(i=o.rowFilter()):r&&r.rowFilter?Vt(t.rowFilter,e,!1):i=e.rowFilter()}switch(r&&r.filterRowsVisibleInfo&&"Object"===r.filterRowsVisibleInfo.constructor.name&&((o=new it).rowsVisibleInfo=a.Common.lt.Dh({},r.filterRowsVisibleInfo.rowsVisibleInfo),o.empty=r.filterRowsVisibleInfo.empty,r.filterRowsVisibleInfo=o),t.type){case 0:r.rowFilter&&"Object"!==r.rowFilter.constructor.name?r.rowFilter?e.IB=et.extend(i,r.rowFilter):e.IB=r.rowFilter:r.rowFilter||(e.IB=null),s(e,r.filterRowsVisibleInfo);break;case 1:i.nrt=r;break;case 3:i.srt=r;break;case 4:i.srt[r.col]=r.val;break;case 5:case 6:i.rrt=r.filterItemMap,i.Mct=r.filteredColumns,s(e,r.filterRowsVisibleInfo);break;case 2:case 7:i.Mct=r.filteredColumns,s(e,r.filterRowsVisibleInfo);break;case 8:et.extend(i,r),s(e,r.filterRowsVisibleInfo);break;case 9:case 10:i.range=r.range,i._ct=r.filteredInRowsWithColIndexs,i.Mct=r.filteredColumns,s(e,r.filterRowsVisibleInfo);break;case 11:case 12:i.range=r.range,i.nrt=r.sortInfo,i.rrt=r.filterItemMap,i.Mct=r.filteredColumns,s(e,r.filterRowsVisibleInfo);break;case 13:i._ct=r.filteredInRowsWithColIndexs,i.Ect=r.filteredItems,i.Mct=r.filteredColumns;break;case 14:i.range=r.range}}},tft:function(t,n){var e,i,r,e=tt(t);if(n)for(i=0;i<e;i++)(r=t[i]).newState&&this.$ct(r);else for(i=e-1;0<=i;i--)(r=t[i]).newState||this.$ct(r)},Qct:function(t,n,e){var i=this.Mf.IB;i&&(this.cct(i,9),i.JO(t,n,e),this.cct(i,9,q,!0))},Kct:function(t,n){var e=this.Mf.IB;e&&(this.cct(e,10),e.xP(t,n),this.cct(e,10,q,!0))},Jct:function(t,n){var e=this.Mf.IB;e&&(this.cct(e,11),e.qO(t,n),this.cct(e,11,q,!0))},Xct:function(t,n){var e=this.Mf.IB;e&&(this.cct(e,12),e.NP(t,n),this.cct(e,12,q,!0))},qct:function(t,n,e,i){var r=this.Mf.IB;r&&r.d5(t,n,e,i)}}),K.Y8.ch("filter",{applyChanges:function(t){var n,t,n,n=t.changes,t=t.isUndo,n=n&&n.originalFilter;n&&tt(n)&&this.tft(n,!t)},undo:function(t){var t=t.originalFilter;tt(t)&&this.tft(t)}})},"./dist/plugins/filter/filter.res.en.js":function(t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.ThisWeek=n.NextWeek=n.Yesterday=n.Today=n.Tomorrow=n.After=n.Before=n.NotContain=n.Contain=n.End=n.Begin=n.BelowAverage=n.AboveAverage=n.Top10=n.Between=n.LessThanOrEquals=n.LessThan=n.GreaterOrEquals=n.GreaterThan=n.NotEqual=n.Equal=n.Custom=n.NumberFilter=n.DateFilter=n.TextFilter=n.Clear=n.Automatic=n.NoFill=n.CellColor=n.FontColor=n.SortFontTitle=n.SortCellTitle=n.FilterFontTitle=n.FilterCellTitle=n.FilterColor=n.SortColor=n.Or=n.And=n.ShowRows=n.Show=n.Exp_FilterItemIsNull=n.Blanks=n.UncheckAll=n.CheckAll=n.Search=n.Cancel=n.OK=n.SortDescending=n.SortAscending=n.Exp_InvalidColumnIndex=void 0,n.Aug=n.Jul=n.Jun=n.May=n.Apr=n.Mar=n.Feb=n.Jan=n.Q4=n.Q3=n.Q2=n.Q1=n.BeforeOrEqual=n.IsBefore=n.AfterOrEqual=n.IsAfter=n.NotContains=n.IsContain=n.NotEndWith=n.IsEndWith=n.NotBeginWith=n.IsBeginWith=n.LessOrEqual=n.IsLess=n.IsGreaterOrEqual=n.IsGreaterThan=n.NotEquals=n.IsEquals=n.Selected=n.FilterFont=n.FilterCell=n.SortFont=n.SortCell=n.bottom=n.top=n.ColorTitle=n.CustomTitle=n.Top10Filter=n.AllDates=n.YearToDate=n.LastYear=n.ThisYear=n.NextYear=n.LastQuarter=n.ThisQuarter=n.NextQuarter=n.LastMonth=n.ThisMonth=n.NextMonth=n.LastWeek=void 0,n.invalidCondition=n.add_current_filter=n.Day=n.Year=n.Explain2=n.Explain1=n.Dec=n.Nov=n.Oct=n.Sep=void 0,n.Exp_InvalidColumnIndex="Invalid column index.",n.SortAscending="Sort Ascending",n.SortDescending="Sort Descending",n.OK="OK",n.Cancel="Cancel",n.Search="Search",n.CheckAll="Check all",n.UncheckAll="Uncheck all",n.Blanks="(Blanks)",n.Exp_FilterItemIsNull="FilterItem is null.",n.Show="Show",n.ShowRows="Show rows where:",n.And="And",n.Or="Or",n.SortColor="Sort By Color",n.FilterColor="Filter By Color",n.FilterCellTitle="Filter By Cell Color",n.FilterFontTitle="Filter By Font Color",n.SortCellTitle="Sort By Cell Color",n.SortFontTitle="Sort By Font Color",n.FontColor="More Font Colors...",n.CellColor="More Cell Colors...",n.NoFill="No Fill",n.Automatic="Automatic",n.Clear="Clear Filter From {0}",n.TextFilter="Text Filters",n.DateFilter="Date Filters",n.NumberFilter="Number Filters",n.Custom="Custom Filter...",n.Equal="Equals...",n.NotEqual="Does Not Equal...",n.GreaterThan="Greater Than...",n.GreaterOrEquals="Greater Than Or Equal To...",n.LessThan="Less Than...",n.LessThanOrEquals="Less Than Or Equal To...",n.Between="Between...",n.Top10="Top 10...",n.AboveAverage="Above Average",n.BelowAverage="Below Average",n.Begin="Begins With...",n.End="Ends With...",n.Contain="Contains...",n.NotContain="Does Not Contain...",n.Before="Before...",n.After="After...",n.Tomorrow="Tomorrow",n.Today="Today",n.Yesterday="Yesterday",n.NextWeek="Next Week",n.ThisWeek="This Week",n.LastWeek="Last Week",n.NextMonth="Next Month",n.ThisMonth="This Month",n.LastMonth="Last Month",n.NextQuarter="Next Quarter",n.ThisQuarter="This Quarter",n.LastQuarter="Last Quarter",n.NextYear="Next Year",n.ThisYear="This Year",n.LastYear="Last Year",n.YearToDate="Year To Date",n.AllDates="All Dates in Period",n.Top10Filter="Top 10 Auto Filter",n.CustomTitle="Custom AutoFilter",n.ColorTitle="Available Cell Colors",n.top="top",n.bottom="bottom",n.SortCell="Select a cell color to sort by:",n.SortFont="Select a font color to sort by:",n.FilterCell="Select a cell color to filter by:",n.FilterFont="Select a font color to filter by:",n.Selected="Selected:",n.IsEquals="equals",n.NotEquals="does not equal",n.IsGreaterThan="is greater than",n.IsGreaterOrEqual="is greater than or equal to",n.IsLess="is less than",n.LessOrEqual="is less than or equal to",n.IsBeginWith="begins with",n.NotBeginWith="does not begin with",n.IsEndWith="ends with",n.NotEndWith="does not end with",n.IsContain="contains",n.NotContains="does not contain",n.IsAfter="is after",n.AfterOrEqual="is after or equal to",n.IsBefore="is before",n.BeforeOrEqual="is before or equal to",n.Q1="Quarter 1",n.Q2="Quarter 2",n.Q3="Quarter 3",n.Q4="Quarter 4",n.Jan="January",n.Feb="February",n.Mar="March",n.Apr="April",n.May="May",n.Jun="June",n.Jul="July",n.Aug="August",n.Sep="September",n.Oct="October",n.Nov="November",n.Dec="December",n.Explain1="Use ? to represent any single character",n.Explain2="Use * to represent any series of characters",n.Year="",n.Day="",n.add_current_filter="Add current selection to filter",n.invalidCondition="Error in parse line"},"./dist/plugins/floatingObject/drawing/StatefulChartElementBase.js":function(t,n,e){"use strict";var i,r,o,a,u,s,c;function f(t){return c.call(this,t)||this}i=this&&this.__extends||(s=function(t,n){return(s=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(t,n){t.__proto__=n}:function(t,n){for(var e in n)Object.prototype.hasOwnProperty.call(n,e)&&(t[e]=n[e])}))(t,n)},function(t,n){if("function"!=typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function e(){this.constructor=t}s(t,n),t.prototype=null===n?Object.create(n):(e.prototype=n.prototype,new e)}),Object.defineProperty(n,"__esModule",{value:!0}),n.StatefulChartElementBase=void 0,r=e("./dist/plugins/floatingObject/drawing/stateful.js"),o=e("./dist/plugins/floatingObject/drawing/common.js"),a=null,c=r.StatefulBase,i(f,c),Object.defineProperty(f.prototype,"ChartFormat",{get:function(){var t=this;return o.UnitHelper.isNullOrUndefined(t.I5)&&(t.I5=t.GetDefaultFormat()),t.I5},set:function(t){var n,e,n=this;o.UnitHelper.isNullOrUndefined(n.I5)||n.I5.SetParentForChildren(t),e=n.I5,n.I5=t,o.UnitHelper.isNullOrUndefined(e)||(n.I5.ParentStateful=e.ParentStateful)},enumerable:!1,configurable:!0}),f.prototype.CreateFormat=function(){return a},f.prototype.GetDefaultFormat=function(){return this.CreateFormat()},f.prototype.GetFormatInternal=function(){return this.I5},f.prototype.FromShapeProperties=function(t){var n=this;o.UnitHelper.isNullOrUndefined(t)?n.ClearFormat():(o.UnitHelper.isNullOrUndefined(n.I5)&&(n.I5=n.CreateFormat()),n.I5.FromOOModel(t))},f.prototype.FromSJSShapeProperties=function(t){var n=this;o.UnitHelper.isNullOrUndefined(t)?n.ClearFormat():(o.UnitHelper.isNullOrUndefined(n.I5)&&(n.I5=n.CreateFormat()),n.I5.FromSJSOOModel(t))},f.prototype.ToShapeProperties=function(){return o.UnitHelper.isNullOrUndefined(this.I5)?a:this.I5.ToOOModel()},f.prototype.ToSJSShapeProperties=function(){return o.UnitHelper.isNullOrUndefined(this.I5)?a:this.I5.ToSJSOOModel()},f.prototype.Delete=function(){o.UnitHelper.isNullOrUndefined(this.I5)||(this.I5.ParentStateful=a)},f.prototype.ClearFormat=function(){var t=this;o.UnitHelper.isNullOrUndefined(t.I5)||(t.I5.SetParentForChildren(a),t.I5.ParentStateful=a,t.I5=a)},n.StatefulChartElementBase=f},"./dist/plugins/floatingObject/drawing/chart.ns.js":function(t,n,e){"use strict";var i,r,i=this&&this.__createBinding||(Object.create?function(t,n,e,i){void 0===i&&(i=e);var r=Object.getOwnPropertyDescriptor(n,e);r&&("get"in r?n.__esModule:!r.writable&&!r.configurable)||(r={enumerable:!0,get:function(){return n[e]}}),Object.defineProperty(t,i,r)}:function(t,n,e,i){t[i=void 0===i?e:i]=n[e]}),r=this&&this.__exportStar||function(t,n){for(var e in t)"default"===e||Object.prototype.hasOwnProperty.call(n,e)||i(n,t,e)};Object.defineProperty(n,"__esModule",{value:!0}),r(e("./dist/plugins/floatingObject/drawing/drawingInterface.js"),n),r(e("./dist/plugins/floatingObject/drawing/stateful.js"),n),r(e("./dist/plugins/floatingObject/drawing/common.js"),n),r(e("./dist/plugins/floatingObject/drawing/color.js"),n),r(e("./dist/plugins/floatingObject/drawing/colorData.js"),n),r(e("./dist/plugins/floatingObject/drawing/colorFormat.js"),n),r(e("./dist/plugins/floatingObject/drawing/effects.js"),n),r(e("./dist/plugins/floatingObject/drawing/fillFormat.js"),n),r(e("./dist/plugins/floatingObject/drawing/fontData.js"),n),r(e("./dist/plugins/floatingObject/drawing/fontFormat.js"),n),r(e("./dist/plugins/floatingObject/drawing/gradient.js"),n),r(e("./dist/plugins/floatingObject/drawing/lineFormat.js"),n),r(e("./dist/plugins/floatingObject/drawing/picture.js"),n),r(e("./dist/plugins/floatingObject/drawing/threeDFormat.js"),n),r(e("./dist/plugins/floatingObject/drawing/StatefulChartElementBase.js"),n)},"./dist/plugins/floatingObject/drawing/color.js":function(t,n,e){"use strict";var i,r,o,a,u,s,c,f,l,h,e;function d(t,n,e,i){var r=this;r.value=t,r.state=n,r.name=e,r.knownColor=i}function v(){}Object.defineProperty(n,"__esModule",{value:!0}),n.KnownColorTable=n.KnownColor=n.ARGBColor=void 0,i=e("Common"),r=e("./dist/plugins/floatingObject/drawing/common.js"),o=e("./dist/plugins/floatingObject/drawing/drawingInterface.js"),a=i.Common.ft,u=r.UnitHelper.isNullOrUndefined,s=null,d.FromKnownColor=function(t){return new d(0,d.StateKnownColorValid,s,t)},d.FromIndexedColor=function(t,n){var e,e=(e=d.IndexedColors)||(d.IndexedColors=[4278190080,4294967295,4294901760,4278255360,4278190335,4294967040,4294902015,4278255615,4278190080,4294967295,4294901760,4278255360,4278190335,4294967040,4294902015,4278255615,4286578688,4278222848,4278190208,4286611456,4286578816,4278222976,4290822336,4286611584,4288256511,4288230246,4294967244,4291624959,4284874854,4294934656,4278216396,4291611903,4278190208,4294902015,4294967040,4278255615,4286578816,4286578688,4278222976,4278190335,4278242559,4291624959,4291624908,4294967193,4288269567,4294941132,4291598847,4294954137,4281558783,4281584844,4288269312,4294953984,4294940928,4294927872,4284901017,4288059030,4278203238,4281571686,4278203136,4281545472,4288230144,4288230246,4281545625,4281545523,d.FromKnownColor(f.WindowText).ToArgb(),d.FromKnownColor(f.Window).ToArgb()]);return d.FromArgb(e[t]).GetTintColor(n)},d.FromArgb=function(t){return new d(t,d.StateARGBValueValid,s,0)},d.FromArgbs=function(t,n,e,i){return d.CheckByte(t,"alpha"),d.CheckByte(n,"red"),d.CheckByte(e,"green"),d.CheckByte(i,"blue"),new d(d.MakeArgb(t,n,e,i),d.StateARGBValueValid,s,0)},d.FromBaseColor=function(t,n){return d.CheckByte(t,"alpha"),new d(d.MakeArgb(t,n.R,n.G,n.B),d.StateARGBValueValid,s,0)},d.FromRgb=function(t,n,e){return d.FromArgbs(255,t,n,e)},d.CheckByte=function(t,n){if(t<0||255<t)throw new Error("InvalidEx2BoundArgument")},d.MakeArgb=function(t,n,e,i){var r;return Math.pow(2,24)*t+(n<<16|e<<8|i)},Object.defineProperty(d.prototype,"Transparent",{get:function(){return d.FromKnownColor(f.Transparent)},enumerable:!1,configurable:!0}),Object.defineProperty(d.prototype,"R",{get:function(){return this.Value>>16&255},enumerable:!1,configurable:!0}),Object.defineProperty(d.prototype,"G",{get:function(){return this.Value>>8&255},enumerable:!1,configurable:!0}),Object.defineProperty(d.prototype,"B",{get:function(){return 255&this.Value},enumerable:!1,configurable:!0}),Object.defineProperty(d.prototype,"A",{get:function(){return this.Value>>24&255},enumerable:!1,configurable:!0}),Object.defineProperty(d.prototype,"IsKnownColor",{get:function(){return 0!=(this.state&d.StateKnownColorValid)},enumerable:!1,configurable:!0}),Object.defineProperty(d.prototype,"IsEmpty",{get:function(){return 0===this.state},enumerable:!1,configurable:!0}),Object.defineProperty(d.prototype,"IsNamedColor",{get:function(){return 0!=(this.state&d.StateNameValid)||this.IsKnownColor},enumerable:!1,configurable:!0}),Object.defineProperty(d.prototype,"IsSystemColor",{get:function(){return!!this.IsKnownColor&&(!(26<this.knownColor)||167<this.knownColor)},enumerable:!1,configurable:!0}),Object.defineProperty(d.prototype,"Name",{get:function(){var t,n,t=this;return 0!=(t.state&d.StateNameValid)?t.name:t.IsKnownColor?(n=h.KnownColorToName(t.knownColor),u(n)?"":n):t.value.toString(16)},enumerable:!1,configurable:!0}),Object.defineProperty(d.prototype,"Value",{get:function(){var t=this;return 0!=(t.state&d.StateValueMask)?t.value:t.IsKnownColor?h.KnownColorToArgb(t.knownColor):d.NotDefinedValue},enumerable:!1,configurable:!0}),d.prototype.Equals=function(t){return t instanceof d&&this.Value===t.Value},d.prototype.GetTintColor=function(t){var n,n,n=this;return 0===t||u(t)?n:(n=a.Cv({r:n.R,g:n.G,b:n.B},t),d.FromArgbs(n.a,n.r,n.g,n.b))},d.prototype.GetBrightness=function(){var t,n,e,i,r,t=this.R/255,n=this.G/255,e=this.B/255,i=t,r=t;return((i=(i=t<n?n:t)<e?e:i)+(r=e<(r=n<t?n:t)?e:r))/2},d.prototype.GetHue=function(){var t,n,e,t,i,r,o,o,t=this;return t.R===t.G&&t.G===t.B?0:(i=0,o=r=n=t.R/255,o=(r=(r=r<(e=t.G/255)?e:r)<(t=t.B/255)?t:r)-(o=t<(o=e<n?e:n)?t:o),n===r?i=(e-t)/o:e===r?i=2+(t-n)/o:t===r&&(i=4+(n-e)/o),(i*=60)<0&&(i+=360),i)},d.prototype.GetSaturation=function(){var t,n,e,i,r,t,o,t=this.R/255,n=this.G/255,e=this.B/255,i=0,r=t,t=t;return(r=(r=r<n?n:r)<e?e:r)===(t=e<(t=n<t?n:t)?e:t)?0:(o=(r+t)/2)<=.5?(r-t)/(r+t):(r-t)/(2-r-t)},d.prototype.ToArgb=function(){return this.Value},d.prototype.ToKnownColor=function(){return this.knownColor},d.prototype.ToString=function(){var t,n,t=this,n="ARGBColor";return n+=" [",0!=(t.state&d.StateNameValid)||0!=(t.state&d.StateKnownColorValid)?n+=t.Name:0!=(t.state&d.StateValueMask)?n=(n=(n=(n=n+"A="+t.A)+", R="+t.R)+", G="+t.G)+", B="+t.B:n+="Empty",n+="]"},d.StateKnownColorValid=1,d.StateARGBValueValid=2,d.StateValueMask=2,d.StateNameValid=8,d.NotDefinedValue=0,c=d,n.ARGBColor=c,r.ChartUtility.nft=function(t,n){var e,i,t,e=n.ColorType;return e===o.ColorType.Index?c.FromIndexedColor(n.Value,n.Tint):e===o.ColorType.Theme?(i=r.ChartUtility.toThemeColorString(n.Value,n.Tint),t=a._(t.getColor(i)),n.Transparency&&(t.a=parseInt(255*(1-n.Transparency)+"",10)),c.FromArgbs(t.a,t.r,t.g,t.b)):e===o.ColorType.Auto?c.FromKnownColor(f.WindowText):e===o.ColorType.None?new c:c.FromArgb(n.Value).GetTintColor(n.Tint)},(e=f=n.KnownColor||(n.KnownColor={}))[e.ActiveBorder=1]="ActiveBorder",e[e.ActiveCaption=2]="ActiveCaption",e[e.ActiveCaptionText=3]="ActiveCaptionText",e[e.AliceBlue=28]="AliceBlue",e[e.AntiqueWhite=29]="AntiqueWhite",e[e.AppWorkspace=4]="AppWorkspace",e[e.Aqua=30]="Aqua",e[e.Aquamarine=31]="Aquamarine",e[e.Azure=32]="Azure",e[e.Beige=33]="Beige",e[e.Bisque=34]="Bisque",e[e.Black=35]="Black",e[e.BlanchedAlmond=36]="BlanchedAlmond",e[e.Blue=37]="Blue",e[e.BlueViolet=38]="BlueViolet",e[e.Brown=39]="Brown",e[e.BurlyWood=40]="BurlyWood",e[e.ButtonFace=168]="ButtonFace",e[e.ButtonHighlight=169]="ButtonHighlight",e[e.ButtonShadow=170]="ButtonShadow",e[e.CadetBlue=41]="CadetBlue",e[e.Chartreuse=42]="Chartreuse",e[e.Chocolate=43]="Chocolate",e[e.Control=5]="Control",e[e.ControlDark=6]="ControlDark",e[e.ControlDarkDark=7]="ControlDarkDark",e[e.ControlLight=8]="ControlLight",e[e.ControlLightLight=9]="ControlLightLight",e[e.ControlText=10]="ControlText",e[e.Coral=44]="Coral",e[e.CornflowerBlue=45]="CornflowerBlue",e[e.Cornsilk=46]="Cornsilk",e[e.Crimson=47]="Crimson",e[e.Cyan=48]="Cyan",e[e.DarkBlue=49]="DarkBlue",e[e.DarkCyan=50]="DarkCyan",e[e.DarkGoldenrod=51]="DarkGoldenrod",e[e.DarkGray=52]="DarkGray",e[e.DarkGreen=53]="DarkGreen",e[e.DarkKhaki=54]="DarkKhaki",e[e.DarkMagenta=55]="DarkMagenta",e[e.DarkOliveGreen=56]="DarkOliveGreen",e[e.DarkOrange=57]="DarkOrange",e[e.DarkOrchid=58]="DarkOrchid",e[e.DarkRed=59]="DarkRed",e[e.DarkSalmon=60]="DarkSalmon",e[e.DarkSeaGreen=61]="DarkSeaGreen",e[e.DarkSlateBlue=62]="DarkSlateBlue",e[e.DarkSlateGray=63]="DarkSlateGray",e[e.DarkTurquoise=64]="DarkTurquoise",e[e.DarkViolet=65]="DarkViolet",e[e.DeepPink=66]="DeepPink",e[e.DeepSkyBlue=67]="DeepSkyBlue",e[e.Desktop=11]="Desktop",e[e.DimGray=68]="DimGray",e[e.DodgerBlue=69]="DodgerBlue",e[e.Firebrick=70]="Firebrick",e[e.FloralWhite=71]="FloralWhite",e[e.ForestGreen=72]="ForestGreen",e[e.Fuchsia=73]="Fuchsia",e[e.Gainsboro=74]="Gainsboro",e[e.GhostWhite=75]="GhostWhite",e[e.Gold=76]="Gold",e[e.Goldenrod=77]="Goldenrod",e[e.GradientActiveCaption=171]="GradientActiveCaption",e[e.GradientInactiveCaption=172]="GradientInactiveCaption",e[e.Gray=78]="Gray",e[e.GrayText=12]="GrayText",e[e.Green=79]="Green",e[e.GreenYellow=80]="GreenYellow",e[e.Highlight=13]="Highlight",e[e.HighlightText=14]="HighlightText",e[e.Honeydew=81]="Honeydew",e[e.HotPink=82]="HotPink",e[e.HotTrack=15]="HotTrack",e[e.InactiveBorder=16]="InactiveBorder",e[e.InactiveCaption=17]="InactiveCaption",e[e.InactiveCaptionText=18]="InactiveCaptionText",e[e.IndianRed=83]="IndianRed",e[e.Indigo=84]="Indigo",e[e.Info=19]="Info",e[e.InfoText=20]="InfoText",e[e.Ivory=85]="Ivory",e[e.Khaki=86]="Khaki",e[e.Lavender=87]="Lavender",e[e.LavenderBlush=88]="LavenderBlush",e[e.LawnGreen=89]="LawnGreen",e[e.LemonChiffon=90]="LemonChiffon",e[e.LightBlue=91]="LightBlue",e[e.LightCoral=92]="LightCoral",e[e.LightCyan=93]="LightCyan",e[e.LightGoldenrodYellow=94]="LightGoldenrodYellow",e[e.LightGray=95]="LightGray",e[e.LightGreen=96]="LightGreen",e[e.LightPink=97]="LightPink",e[e.LightSalmon=98]="LightSalmon",e[e.LightSeaGreen=99]="LightSeaGreen",e[e.LightSkyBlue=100]="LightSkyBlue",e[e.LightSlateGray=101]="LightSlateGray",e[e.LightSteelBlue=102]="LightSteelBlue",e[e.LightYellow=103]="LightYellow",e[e.Lime=104]="Lime",e[e.LimeGreen=105]="LimeGreen",e[e.Linen=106]="Linen",e[e.Magenta=107]="Magenta",e[e.Maroon=108]="Maroon",e[e.MediumAquamarine=109]="MediumAquamarine",e[e.MediumBlue=110]="MediumBlue",e[e.MediumOrchid=111]="MediumOrchid",e[e.MediumPurple=112]="MediumPurple",e[e.MediumSeaGreen=113]="MediumSeaGreen",e[e.MediumSlateBlue=114]="MediumSlateBlue",e[e.MediumSpringGreen=115]="MediumSpringGreen",e[e.MediumTurquoise=116]="MediumTurquoise",e[e.MediumVioletRed=117]="MediumVioletRed",e[e.Menu=21]="Menu",e[e.MenuBar=173]="MenuBar",e[e.MenuHighlight=174]="MenuHighlight",e[e.MenuText=22]="MenuText",e[e.MidnightBlue=118]="MidnightBlue",e[e.MintCream=119]="MintCream",e[e.MistyRose=120]="MistyRose",e[e.Moccasin=121]="Moccasin",e[e.NavajoWhite=122]="NavajoWhite",e[e.Navy=123]="Navy",e[e.OldLace=124]="OldLace",e[e.Olive=125]="Olive",e[e.OliveDrab=126]="OliveDrab",e[e.Orange=127]="Orange",e[e.OrangeRed=128]="OrangeRed",e[e.Orchid=129]="Orchid",e[e.PaleGoldenrod=130]="PaleGoldenrod",e[e.PaleGreen=131]="PaleGreen",e[e.PaleTurquoise=132]="PaleTurquoise",e[e.PaleVioletRed=133]="PaleVioletRed",e[e.PapayaWhip=134]="PapayaWhip",e[e.PeachPuff=135]="PeachPuff",e[e.Peru=136]="Peru",e[e.Pink=137]="Pink",e[e.Plum=138]="Plum",e[e.PowderBlue=139]="PowderBlue",e[e.Purple=140]="Purple",e[e.Red=141]="Red",e[e.RosyBrown=142]="RosyBrown",e[e.RoyalBlue=143]="RoyalBlue",e[e.SaddleBrown=144]="SaddleBrown",e[e.Salmon=145]="Salmon",e[e.SandyBrown=146]="SandyBrown",e[e.ScrollBar=23]="ScrollBar",e[e.SeaGreen=147]="SeaGreen",e[e.SeaShell=148]="SeaShell",e[e.Sienna=149]="Sienna",e[e.Silver=150]="Silver",e[e.SkyBlue=151]="SkyBlue",e[e.SlateBlue=152]="SlateBlue",e[e.SlateGray=153]="SlateGray",e[e.Snow=154]="Snow",e[e.SpringGreen=155]="SpringGreen",e[e.SteelBlue=156]="SteelBlue",e[e.Tan=157]="Tan",e[e.Teal=158]="Teal",e[e.Thistle=159]="Thistle",e[e.Tomato=160]="Tomato",e[e.Transparent=27]="Transparent",e[e.Turquoise=161]="Turquoise",e[e.Violet=162]="Violet",e[e.Wheat=163]="Wheat",e[e.White=164]="White",e[e.WhiteSmoke=165]="WhiteSmoke",e[e.Window=24]="Window",e[e.WindowFrame=25]="WindowFrame",e[e.WindowText=26]="WindowText",e[e.Yellow=166]="Yellow",e[e.YellowGreen=167]="YellowGreen",l=function(t){t[1]=4290032820,t[2]=4288263377,t[3]=4278190080,t[4]=4289440683,t[5]=4293980400,t[6]=4288716960,t[7]=4285098345,t[8]=4293125091,t[9]=4294967295,t[10]=4278190080,t[11]=4278190080,t[12]=4285361517,t[13]=4281571839,t[14]=4294967295,t[15]=4278216396,t[16]=4294244348,t[17]=4290760155,t[18]=4278190080,t[19]=4294967265,t[20]=4278190080,t[21]=4293980400,t[22]=4278190080,t[23]=4291348680,t[24]=4294967295,t[25]=4284769380,t[26]=4278190080,t[168]=4293980400,t[169]=4294967295,t[170]=4288716960,t[171]=4290367978,t[172]=4292338930,t[173]=4293980400,t[174]=4281571839},v.ArgbToKnownColor=function(t){var n,e,i;for(this.EnsureColorTable(),n=0;n<v.colorTable.length;n++)if((e=v.colorTable[n])===t&&!(i=c.FromArgb(n)).IsSystemColor)return i;return c.FromArgb(t)},v.Encode=function(t,n,e,i){return n<<16|e<<8|i|t<<24},v.EnsureColorNameTable=function(){u(v.colorNameTable)&&v.InitColorNameTable()},v.EnsureColorTable=function(){u(v.colorTable)&&this.InitColorTable()},v.InitColorNameTable=function(){var t,n,t=[];for(n in f)f.hasOwnProperty(n)&&(t[f[n]]=n);v.colorNameTable=t},v.InitColorTable=function(){var t=[];l(t),t[27]=16777215,t[28]=-984833,t[29]=-332841,t[30]=-16711681,t[31]=-8388652,t[32]=-983041,t[33]=-657956,t[34]=-6972,t[35]=-16777216,t[36]=-5171,t[37]=-16776961,t[38]=-7722014,t[39]=-5952982,t[40]=-2180985,t[41]=-10510688,t[42]=-8388864,t[43]=-2987746,t[44]=-32944,t[45]=-10185235,t[46]=-1828,t[47]=-2354116,t[48]=-16711681,t[49]=-16777077,t[50]=-16741493,t[51]=-4684277,t[52]=-5658199,t[53]=-16751616,t[54]=-4343957,t[55]=-7667573,t[56]=-11179217,t[57]=-29696,t[58]=-6737204,t[59]=-7667712,t[60]=-1468806,t[61]=-7357301,t[62]=-12042869,t[63]=-13676721,t[64]=-16724271,t[65]=-7077677,t[66]=-60269,t[67]=-16728065,t[68]=-9868951,t[69]=-14774017,t[70]=-5103070,t[71]=-1296,t[72]=-14513374,t[73]=-65281,t[74]=-2302756,t[75]=-460545,t[76]=-10496,t[77]=-2448096,t[78]=-8355712,t[79]=-16744448,t[80]=-5374161,t[81]=-983056,t[82]=-38476,t[83]=-3318692,t[84]=-11861886,t[85]=-16,t[86]=-989556,t[87]=-1644806,t[88]=-3851,t[89]=-8586240,t[90]=-1331,t[91]=-5383962,t[92]=-1015680,t[93]=-2031617,t[94]=-329006,t[95]=-2894893,t[96]=-7278960,t[97]=-18751,t[98]=-24454,t[99]=-14634326,t[100]=-7876870,t[101]=-8943463,t[102]=-5192482,t[103]=-32,t[104]=-16711936,t[105]=-13447886,t[106]=-331546,t[107]=-65281,t[108]=-8388608,t[109]=-10039894,t[110]=-16777011,t[111]=-4565549,t[112]=-7114533,t[113]=-12799119,t[114]=-8689426,t[115]=-16713062,t[116]=-12004916,t[117]=-3730043,t[118]=-15132304,t[119]=-655366,t[120]=-6943,t[121]=-6987,t[122]=-8531,t[123]=-16777088,t[124]=-133658,t[125]=-8355840,t[126]=-9728477,t[127]=-23296,t[128]=-47872,t[129]=-2461482,t[130]=-1120086,t[131]=-6751336,t[132]=-5247250,t[133]=-2396013,t[134]=-4139,t[135]=-9543,t[136]=-3308225,t[137]=-16181,t[138]=-2252579,t[139]=-5185306,t[140]=-8388480,t[141]=-65536,t[142]=-4419697,t[143]=-12490271,t[144]=-7650029,t[145]=-360334,t[146]=-744352,t[147]=-13726889,t[148]=-2578,t[149]=-6270419,t[150]=-4144960,t[151]=-7876885,t[152]=-9807155,t[153]=-9404272,t[154]=-1286,t[155]=-16711809,t[156]=-12156236,t[157]=-2968436,t[158]=-16744320,t[159]=-2572328,t[160]=-40121,t[161]=-12525360,t[162]=-1146130,t[163]=-663885,t[164]=-1,t[165]=-657931,t[166]=-256,t[167]=-6632142,v.colorTable=t},v.KnownColorToArgb=function(t){return this.EnsureColorTable(),t<=f.MenuHighlight?this.colorTable[t]:0},v.KnownColorToName=function(t){return this.EnsureColorNameTable(),t<=f.MenuHighlight?v.colorNameTable[t]:s},v.IsKnowColor=function(t){return v.EnsureColorTable(),-1!==v.colorTable.indexOf(t)},h=v,n.KnownColorTable=h},"./dist/plugins/floatingObject/drawing/colorData.js":function(t,n,e){"use strict";var i,u,r,e;function o(){}Object.defineProperty(n,"__esModule",{value:!0}),n.ColorData=n.ColorDataFlag=void 0,i=e("./dist/plugins/floatingObject/drawing/drawingInterface.js"),(e=u=n.ColorDataFlag||(n.ColorDataFlag={}))[e.None=0]="None",e[e.ColorType=1]="ColorType",e[e.Value=2]="Value",e[e.Tint=4]="Tint",e[e.All=7]="All",o.ConvertHexStringToInt=function(t){return parseInt(t,16)},o.prototype.Equals=function(t){return this.ColorType===t.ColorType&&this.Value===t.Value&&this.Tint===t.Tint},o.prototype.Clone=function(){return this},o.prototype.Compose=function(t,n){void 0===n&&(n=!0),t.Flag!==u.None&&(n?this.ConflictCompose(t):this.NonConflictCompose(t))},o.prototype.ConflictCompose=function(t){var n=this;(t.Flag&u.ColorType)===u.ColorType&&n.ColorType!==t.ColorType&&(n.ColorType=t.ColorType,n.Value=0,n.Tint=0),(t.Flag&u.Value)===u.Value&&(n.Value=t.Value),(t.Flag&u.Tint)===u.Tint&&(n.Tint=t.Tint),n.Flag|=t.Flag},o.prototype.NonConflictCompose=function(t){var n=this;(n.Flag&u.ColorType)!==u.ColorType&&(t.Flag&u.ColorType)===u.ColorType&&(n.ColorType=t.ColorType,n.Value=t.Value,n.Tint=t.Tint,n.Flag=t.Flag)},o.prototype.RemoveDuplicateStyle=function(t){return this.Compare(t,!1)},o.prototype.RemoveDifferentStyle=function(t){return this.Compare(t,!0)},o.prototype.Compare=function(t,n){var e,i,r,o,a,e=this,i=!1;return(e.Flag&u.ColorType)===u.ColorType&&(a=(t.Flag&u.ColorType)!==u.ColorType||e.ColorType!==t.ColorType,n?(a||((e.Flag&u.Value)===u.Value&&(r=(t.Flag&u.Value)!==u.Value||e.Value!==t.Value)&&(e.Flag=u.None,i=!0),(e.Flag&u.Tint)===u.Tint&&(o=(t.Flag&u.Tint)!==u.Tint||e.Tint!==t.Tint)))&&(e.Flag=u.None,i=!0):a||((e.Flag&u.Value)!==u.Value||(r=(t.Flag&u.Value)!==u.Value||e.Value!==t.Value)||(e.Flag&=~u.Value,i=!0),(e.Flag&u.Tint)!==u.Tint||(o=(t.Flag&u.Tint)!==u.Tint||e.Tint!==t.Tint)||(e.Flag&=~u.Tint,i=!0),e.Flag===u.ColorType&&(e.Flag=u.None,i=!0))),i},o.prototype.UpdateDefaultValueFlag=function(){this.ColorType===i.ColorType.None?this.Flag=u.None:this.Flag=u.All},o.prototype.UpdateFlagFromBottom=function(){},o.prototype.ClearFlag=function(){this.Flag=u.None},o.prototype.SetFullFlag=function(){this.Flag=u.All},o.prototype.IsFullFlag=function(){return this.Flag===u.All},n.ColorData=o},"./dist/plugins/floatingObject/drawing/colorFormat.js":function(t,n,e){"use strict";var i,r,o,a,u,s,c,f,l,h,d,v,m,g,p,b,y,w,M,C,S,T,A;function I(t,n){return t.getColor(n)!==n}function x(t,n){var e,e,t,e=A.call(this,n)||this;return void 0===n&&(n=b),(e=e).eft=f.ColorSchemeIndex.None,e.ift=b,e.rft=0,e.oft=0,e.aft=m,e.uft=g,e.DJ=t,e.sft=n,(t=e.DJ.DrawingType)===f.DrawingType.Shape?e.xrt=f.SolidColorType.Theme:t===f.DrawingType.Chart?e.xrt=f.SolidColorType.Automatic:t===f.DrawingType.Picture&&(e.xrt=f.SolidColorType.None),e}function N(t){delete t.hslClr,delete t.prstClr,delete t.scrgbClr,delete t.srgbClr,delete t.sysClr}function k(t,n,e){0<n.length&&(t.lumMod=n),0<e.length&&(t.lumOff=e)}function D(t){var n=null;switch(t){case f.ST_SystemColorVal.scrollBar:n=23;break;case f.ST_SystemColorVal.activeCaption:n=2;break;case f.ST_SystemColorVal.inactiveCaption:n=17;break;case f.ST_SystemColorVal.menu:n=21;break;case f.ST_SystemColorVal.window:n=24;break;case f.ST_SystemColorVal.windowFrame:n=25;break;case f.ST_SystemColorVal.menuText:n=22;break;case f.ST_SystemColorVal.windowText:n=26;break;case f.ST_SystemColorVal.activeBorder:n=1;break;case f.ST_SystemColorVal.inactiveBorder:n=16;break;case f.ST_SystemColorVal.appWorkspace:n=4;break;case f.ST_SystemColorVal.highlight:n=13;break;case f.ST_SystemColorVal.highlightText:n=14;break;case f.ST_SystemColorVal.btnFace:n=168;break;case f.ST_SystemColorVal.btnShadow:n=170;break;case f.ST_SystemColorVal.grayText:n=12;break;case f.ST_SystemColorVal.inactiveCaptionText:n=18;break;case f.ST_SystemColorVal.btnHighlight:n=169;break;case f.ST_SystemColorVal.infoText:n=20;break;case f.ST_SystemColorVal.infoBk:n=19;break;case f.ST_SystemColorVal.gradientActiveCaption:n=171;break;case f.ST_SystemColorVal.gradientInactiveCaption:n=172;break;case f.ST_SystemColorVal.menuHighlight:n=174;break;case f.ST_SystemColorVal.menuBar:n=173}return n}function _(t){var n=null;switch(t){case 1:n=f.ST_SystemColorVal.activeBorder;break;case 2:n=f.ST_SystemColorVal.activeCaption;break;case 168:n=f.ST_SystemColorVal.btnFace;break;case 169:n=f.ST_SystemColorVal.btnHighlight;break;case 170:n=f.ST_SystemColorVal.btnShadow;break;case 171:n=f.ST_SystemColorVal.gradientActiveCaption;break;case 172:n=f.ST_SystemColorVal.gradientInactiveCaption;break;case 12:n=f.ST_SystemColorVal.grayText;break;case 13:n=f.ST_SystemColorVal.highlight;break;case 14:n=f.ST_SystemColorVal.highlightText;break;case 16:n=f.ST_SystemColorVal.inactiveBorder;break;case 17:n=f.ST_SystemColorVal.inactiveCaption;break;case 18:n=f.ST_SystemColorVal.inactiveCaptionText;break;case 20:n=f.ST_SystemColorVal.infoText;break;case 21:n=f.ST_SystemColorVal.menu;break;case 173:n=f.ST_SystemColorVal.menuBar;break;case 174:n=f.ST_SystemColorVal.menuHighlight;break;case 22:n=f.ST_SystemColorVal.menuText;break;case 24:n=f.ST_SystemColorVal.window;break;case 25:n=f.ST_SystemColorVal.windowFrame;break;case 26:n=f.ST_SystemColorVal.windowText}return n}function E(t){var n=f.ST_SchemeColorVal.accent1;switch(t){case 4:n=f.ST_SchemeColorVal.accent1;break;case 5:n=f.ST_SchemeColorVal.accent2;break;case 6:n=f.ST_SchemeColorVal.accent3;break;case 7:n=f.ST_SchemeColorVal.accent4;break;case 8:n=f.ST_SchemeColorVal.accent5;break;case 9:n=f.ST_SchemeColorVal.accent6;break;case 0:n=f.ST_SchemeColorVal.bg1;break;case 2:n=f.ST_SchemeColorVal.bg2;break;case 11:n=f.ST_SchemeColorVal.folHlink;break;case 10:n=f.ST_SchemeColorVal.hlink;break;case 12:n=f.ST_SchemeColorVal.phClr;break;case 13:n=f.ST_SchemeColorVal.dk1;break;case 14:n=f.ST_SchemeColorVal.lt1;break;case 15:n=f.ST_SchemeColorVal.dk2;break;case 16:n=f.ST_SchemeColorVal.lt2;break;case 1:n=f.ST_SchemeColorVal.tx1;break;case 3:n=f.ST_SchemeColorVal.tx2}return n}function j(t){var n=4;switch(t){case f.ST_SchemeColorVal.bg1:n=0;break;case f.ST_SchemeColorVal.tx1:n=1;break;case f.ST_SchemeColorVal.bg2:n=2;break;case f.ST_SchemeColorVal.tx2:n=3;break;case f.ST_SchemeColorVal.accent2:n=5;break;case f.ST_SchemeColorVal.accent3:n=6;break;case f.ST_SchemeColorVal.accent4:n=7;break;case f.ST_SchemeColorVal.accent5:n=8;break;case f.ST_SchemeColorVal.accent6:n=9;break;case f.ST_SchemeColorVal.hlink:n=10;break;case f.ST_SchemeColorVal.folHlink:n=11;break;case f.ST_SchemeColorVal.phClr:n=12;break;case f.ST_SchemeColorVal.dk1:n=13;break;case f.ST_SchemeColorVal.lt1:n=14;break;case f.ST_SchemeColorVal.dk2:n=15;break;case f.ST_SchemeColorVal.lt2:n=16}return n}i=this&&this.__extends||(T=function(t,n){return(T=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(t,n){t.__proto__=n}:function(t,n){for(var e in n)Object.prototype.hasOwnProperty.call(n,e)&&(t[e]=n[e])}))(t,n)},function(t,n){if("function"!=typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function e(){this.constructor=t}T(t,n),t.prototype=null===n?Object.create(n):(e.prototype=n.prototype,new e)}),Object.defineProperty(n,"__esModule",{value:!0}),n.ColorFormat=n.createColorFormat=n.createColorFormatFromRGB=void 0,r=e("Common"),o=e("Core"),a=e("./dist/plugins/floatingObject/drawing/colorData.js"),u=e("./dist/plugins/floatingObject/drawing/color.js"),s=e("./dist/plugins/floatingObject/drawing/common.js"),c=e("./dist/plugins/floatingObject/drawing/stateful.js"),f=e("./dist/plugins/floatingObject/drawing/drawingInterface.js"),l=o.Util.StringToByteArray,h=o.NodeHelper.sr,d=r.Common.ft,v=s.UnitHelper.isNullOrUndefined,m=s.ShapeConstants.DefaultTransparent,g=s.ShapeConstants.DefaultSatMod,p=s.ShapeConstants.PositionConver,b=null,y=Math.abs,w=Math.floor,n.createColorFormatFromRGB=M=function(t,n,e){var t=new S(t);return t.ColorType=n,t.RGB=e,t},n.createColorFormat=C=function(t,n,e,i){var t=new S(t);return t.ColorType=n,t.ObjectThemeColor=e,i&&(t.TintAndShade=i),t},A=c.StatefulBase,i(x,A),x.prototype.setColor=function(t,n){var e,t,t,e=this;t&&I(t.currentTheme(),n)?(t=s.ChartUtility.fromThemeColorString(n))&&(e.ObjectThemeColor=t.index,void 0!==t.tint)&&(e.Brightness=t.tint):(t=d._(n),e.RGB=u.ARGBColor.FromArgbs(t.a,t.r,t.g,t.b))},x.prototype.GetColorData=function(){var t,n,e,i,i,r,t=this,n=new a.ColorData;if(n.ColorType=f.ColorType.RGB,(e=t.xrt)===f.SolidColorType.None)n.ColorType=f.ColorType.None;else if(e===f.SolidColorType.Automatic){if(n.ColorType=f.ColorType.Auto,i=t.GetAutoColorFormat(),!v(i))return i.GetColorData()}else e===f.SolidColorType.RGB?v(t.ift)||(n.ColorType=f.ColorType.RGB,i=this.ift,1!=(r=1-t.aft)&&(i=u.ARGBColor.FromArgbs(parseInt(255*r,10),i.R,i.G,i.B)),n.Value=i.ToArgb(),n.Tint=t.rft||t.oft):e===f.SolidColorType.Theme&&(n.ColorType=f.ColorType.Theme,n.Value=t.eft,n.Tint=t.rft||t.oft,n.Transparency=t.aft);return n},x.prototype.HasOwnColor=function(){return this.GetState(f.ColorFormatStates.ObjectThemeColor)||this.GetState(f.ColorFormatStates.RGB)||this.GetAutoColorFormat()!==b},x.prototype.GetAutoColorFormat=function(){if(this.ColorType===f.SolidColorType.Automatic&&!v(this.AutoColorFormat)){var t=this.AutoColorFormat();if(!v(t)&&t.ColorType!==f.SolidColorType.Automatic)return t}return b},x.prototype.OnParentChanged=function(t){this.sft=t},x.prototype.ClearModel=function(){var t,n,e;for(this.cft=b,this.fft=b,t=0,n=this.Children;t<n.length;t++)(e=n[t]).ClearModel()},x.prototype.CalcBrightness=function(t,n){return t&&0<t.length&&n&&0<n.length?n[0]/p:t&&0<t.length?t[0]/p-1:0},x.prototype.CalcLumModeOff=function(t,n){var e=this;0<e.Brightness?(t.push(w((1-e.Brightness)*p)),n.push(w(e.Brightness*p))):e.Brightness<0&&t.push(w((1+e.Brightness)*p))},x.prototype.lft=function(t){var n=this;0<n.Brightness?(t.lumMod={val:String(w((1-n.Brightness)*p))},t.lumOff={val:String(w(n.Brightness*p))}):n.Brightness<0&&(t.lumMod={val:String(w((1+n.Brightness)*p))})},x.prototype.FromCT_ColorProperties=function(t){var n,e,i,i,e,i,e,e,i,n=this;n.cft=t,v(t)?n.ColorType=f.SolidColorType.None:v(t.schemeClr)?v(t.srgbClr)||v(t.srgbClr.val)||3!==t.srgbClr.val.length?v(t.scrgbClr)?v(t.sysClr)?v(t.prstClr)||(e=t.prstClr,i=s.ChartUtility.GetPresetColorRGB(e.val),n.RGB=u.ARGBColor.FromRgb(i[0],i[1],i[2]),n.Brightness=n.CalcBrightness(e.lumMod,e.lumOff),!v(e.alpha)&&0<e.alpha.length&&n.FromTransparency(e.alpha[0])):(e=(i=t.sysClr).val,v(e)?v(i.lastClr)||3!==i.lastClr.length||(n.RGB=u.ARGBColor.FromRgb(i.lastClr[0],i.lastClr[1],i.lastClr[2])):n.RGB=u.ARGBColor.FromKnownColor(e),n.Brightness=n.CalcBrightness(i.lumMod,i.lumOff),!v(i.alpha)&&0<i.alpha.length&&n.FromTransparency(i.alpha[0])):(e=t.scrgbClr,n.RGB=u.ARGBColor.FromRgb(e.r,e.g,e.b)):(i=t.srgbClr,n.RGB=u.ARGBColor.FromRgb(i.val[0],i.val[1],i.val[2]),n.Brightness=n.CalcBrightness(i.lumMod,i.lumOff),!v(i.alpha)&&0<i.alpha.length&&n.FromTransparency(i.alpha[0]),!v(i.tint)&&0<i.tint.length&&n.FromTint(i.tint[0]),!v(i.satMod)&&0<i.satMod.length&&n.FromSatMod(i.satMod[0])):(e=t.schemeClr,n.ObjectThemeColor=e.val,n.Brightness=n.CalcBrightness(e.lumMod,e.lumOff),n.rft=0,!v(e.tint)&&0<e.tint.length&&n.FromTint(e.tint[0]),!v(e.alpha)&&0<e.alpha.length&&n.FromTransparency(e.alpha[0]),!v(e.satMod)&&0<e.satMod.length&&n.FromSatMod(e.satMod[0]),(i=e.shade)&&i.length&&n.FromShade(i[0]))},x.prototype.hft=function(t){var n,e,i,e,i,e,i,n=this,e=t.lumMod,i=t.lumOff;e=e&&[h(e.val)],i=i&&[h(i.val)],n.Brightness=n.CalcBrightness(e,i),e=t.alpha,v(e)||n.FromTransparency(h(e.val)),n.rft=0,i=t.tint,v(i)||n.FromTint(h(i.val)),e=t.shade,v(e)||n.FromShade(h(e.val)),i=t.satMod,v(i)||n.FromSatMod(h(i.val))},x.prototype.dft=function(t){var n=this;n.lft(t=t||{}),n.Transparency!==m&&(t.alpha={val:String(n.ToTransparency())}),0<n.TintAndShade?t.tint={val:String(n.ToTint())}:n.TintAndShade<0&&(t.shade={val:String(n.ToShade())}),n.SatMod!==g&&(t.satMod={val:String(n.ToSatMod())})},x.prototype.FromSJSCT_ColorProperties=function(t){var n,e,i,r,e,r,i,e,i,r,n=this;n.fft=t,v(t)?n.ColorType=f.SolidColorType.None:v(t.schemeClr)?v(t.srgbClr)?v(t.scrgbClr)?v(t.sysClr)?v(t.prstClr)||(i=t.prstClr,r=s.ChartUtility.GetPresetColorRGB(+f.ST_PresetColorVal[i.val]),n.RGB=u.ARGBColor.FromRgb(r[0],r[1],r[2]),n.hft(i)):(i=(r=t.sysClr).val,v(i)?v(r.lastClr)||(e=l(r.lastClr),n.RGB=u.ARGBColor.FromRgb(e[0],e[1],e[2])):n.RGB=u.ARGBColor.FromKnownColor(D(+f.ST_SystemColorVal[i])),n.hft(r)):(e=t.scrgbClr,n.RGB=u.ARGBColor.FromRgb(+e.r,+e.g,+e.b),n.hft(e)):(i=t.srgbClr,(r=l(i.val||i))&&3===r.length&&(n.RGB=u.ARGBColor.FromRgb(r[0],r[1],r[2]),n.hft(i))):(e=t.schemeClr,n.ObjectThemeColor=j(f.ST_SchemeColorVal[e.val||e]),n.hft(e))},x.prototype.ToCT_ColorProperties=function(t){var n,e,i,r,o,o,a,a,o,n=this,e=n.cft||t,i=[],r=[],o=e.schemeClr;return o&&s.ChartUtility.removeEmptyArrayProperties(o),n.ColorType===f.SolidColorType.Theme?(N(e),(o=o||(e.schemeClr={})).val=n.ObjectThemeColor,n.CalcLumModeOff(i,r),k(o,i,r),0<n.TintAndShade?o.tint=[n.ToTint()]:n.TintAndShade<0&&(o.shade=[n.ToShade()]),n.Transparency!==m&&(o.alpha=[n.ToTransparency()]),n.SatMod!==g&&(o.satMod=[n.ToSatMod()])):n.ColorType===f.SolidColorType.RGB&&(N(e),delete e.schemeClr,o=b,n.ift&&n.ift.IsKnownColor&&(o=n.ift.ToKnownColor()),v(o)?((a=e.srgbClr={}).val=[n.RGB.R,n.RGB.G,n.RGB.B],n.CalcLumModeOff(i,r),k(a,i,r),n.Transparency!==m&&(a.alpha=[n.ToTransparency()]),n.SatMod!==g&&(a.satMod=[n.ToSatMod()]),0<n.TintAndShade?a.tint=[n.ToTint()]:n.TintAndShade<0&&(a.shade=[n.ToShade()])):((a=e.sysClr={}).val=o,a.lastClr=[n.RGB.R,n.RGB.G,n.RGB.B],n.CalcLumModeOff(i,r),k(a,i,r),n.Transparency!==m&&(a.alpha=[n.ToTransparency()]))),o=t&&t.colorFillType,v(o)||(e.colorFillType=o),e},x.prototype.ToSJSCT_ColorProperties=function(t){var n,e,i,i,r,r,i,n=this,e=n.fft||t,i=e.schemeClr;return i&&s.ChartUtility.removeEmptyArrayProperties(i),n.ColorType===f.SolidColorType.Theme?(N(e),(i=i||(e.schemeClr={})).val=f.ST_SchemeColorVal[E(n.ObjectThemeColor)],n.dft(i)):n.ColorType===f.SolidColorType.RGB&&(N(e),delete e.schemeClr,i=b,n.ift&&n.ift.IsKnownColor&&(i=n.ift.ToKnownColor()),v(i)?((r=e.srgbClr={}).val=[n.RGB.R,n.RGB.G,n.RGB.B].map(function(t){return("00"+t.toString(16)).substr(-2)}).join(""),n.dft(r)):((r=e.sysClr={}).val=f.ST_SystemColorVal[_(i)],r.lastClr=[n.RGB.R,n.RGB.G,n.RGB.B].map(function(t){return("00"+t.toString(16)).substr(-2)}).join(""),n.dft(r))),i=t&&t.colorFillType,v(i)||(e.colorFillType=i),e},x.prototype.FromTint=function(t){this.TintAndShade=1-t/p},x.prototype.FromShade=function(t){this.TintAndShade=t/p-1},x.prototype.ToTint=function(){return w(y((1-this.TintAndShade)*p))},x.prototype.ToShade=function(){return w(y((1+this.TintAndShade)*p))},x.prototype.FromTransparency=function(t){this.Transparency=1-t/p},x.prototype.ToTransparency=function(){return w((1-this.Transparency)*p)},x.prototype.FromSatMod=function(t){this.SatMod=t/p},x.prototype.ToSatMod=function(){return w(this.SatMod*p)},x.prototype.Clone=function(){var t,n,t=this,n=new x(t.DJ);return n.oft=t.oft,n.xrt=t.xrt,n.DJ=t.DJ,n.ift=t.ift,n.eft=t.eft,n.rft=t.rft,n.AutoColorFormat=t.AutoColorFormat,n},x.prototype.FromOOModel=function(t){this.FromCT_ColorProperties(t)},x.prototype.FromSJSOOModel=function(t){this.FromSJSCT_ColorProperties(t)},x.prototype.ToOOModel=function(){var t=this.ColorType;return t===f.SolidColorType.Automatic?{}:t===f.SolidColorType.None?{colorFillType:f.ColorFillType.NoFillProperties}:this.ToCT_ColorProperties({colorFillType:0})},x.prototype.ToSJSOOModel=function(){var t=this.ColorType;return t===f.SolidColorType.Automatic?{}:t===f.SolidColorType.None?{colorFillType:f.ColorFillType.NoFillProperties}:this.ToSJSCT_ColorProperties({colorFillType:0})},x.prototype.Color_FromOOModel=function(t){this.FromCT_ColorProperties(t)},x.prototype.Color_ToOOModel=function(){return this.ToCT_ColorProperties({})},x.prototype.Color_ToSJSOOModel=function(){return this.ToSJSCT_ColorProperties({})},x.prototype.GradientStop_FromOOModel=function(t){this.FromCT_ColorProperties(t)},x.prototype.GradientStop_ToOOModel=function(){return this.ToCT_ColorProperties({})},x.prototype.ColorData_FromOOModel=function(t){t.ColorType===f.ColorType.Index?this.RGB=u.ARGBColor.FromArgb(t.Value):t.ColorType===f.ColorType.Theme&&(this.ObjectThemeColor=t.Value,this.TintAndShade=t.Tint)},x.prototype.ColorData_ToOOModel=function(){var t,n,t=this,n=new a.ColorData;return t.ColorType===f.SolidColorType.RGB?(n.Value=t.RGB.Value,n.ColorType=f.ColorType.RGB):t.ColorType===f.SolidColorType.Theme&&(n.Value=t.ObjectThemeColor,n.Tint=t.TintAndShade,n.ColorType=f.ColorType.Theme),n},Object.defineProperty(x.prototype,"Brightness",{get:function(){return this.GetState(f.ColorFormatStates.Brightness)||v(this.sft)?this.oft:this.sft.Brightness},set:function(t){if(t<-1||1<t)throw new Error;this.oft=t,this.Dirty(f.ColorFormatStates.Brightness)},enumerable:!1,configurable:!0}),Object.defineProperty(x.prototype,"ObjectThemeColor",{get:function(){return this.GetState(f.ColorFormatStates.ObjectThemeColor)||v(this.sft)?this.eft:this.sft.ObjectThemeColor},set:function(t){var n,e,n=this,e={13:1,14:0,15:3,16:2};v(e[t])||(t=e[t]),n.eft=t,n.Dirty(f.ColorFormatStates.ObjectThemeColor),n.ColorType=f.SolidColorType.Theme,n.ift=b,n.UnDirty(f.ColorFormatStates.RGB),n.oft=0,n.Dirty(f.ColorFormatStates.Brightness)},enumerable:!1,configurable:!0}),Object.defineProperty(x.prototype,"RGB",{get:function(){var t=this;return t.HasOwnColor()||v(t.sft)?t.DJ.nft(t.GetColorData()):t.sft.RGB},set:function(t){var n=this;n.ift=t,n.Transparency=1-t.A/255,n.Dirty(f.ColorFormatStates.RGB),n.ColorType=f.SolidColorType.RGB,n.eft=f.ColorSchemeIndex.None,n.Dirty(f.ColorFormatStates.ObjectThemeColor),n.oft=0,n.rft=0,n.Dirty(f.ColorFormatStates.Brightness),n.Dirty(f.ColorFormatStates.TintAndShade)},enumerable:!1,configurable:!0}),Object.defineProperty(x.prototype,"TintAndShade",{get:function(){var t;return this.rft},set:function(t){this.rft=t,this.Dirty(f.ColorFormatStates.TintAndShade)},enumerable:!1,configurable:!0}),Object.defineProperty(x.prototype,"Transparency",{get:function(){var t=this;return t.GetState(f.ColorFormatStates.Transparency)||v(t.sft)?t.aft:t.sft.Transparency},set:function(t){t=Math.max(0,Math.min(1,t)),this.aft=t,this.Dirty(f.ColorFormatStates.Transparency)},enumerable:!1,configurable:!0}),Object.defineProperty(x.prototype,"SatMod",{get:function(){var t=this;return t.GetState(f.ColorFormatStates.SatMod)||v(t.sft)?t.uft:t.sft.SatMod},set:function(t){this.uft=t,this.Dirty(f.ColorFormatStates.SatMod)},enumerable:!1,configurable:!0}),Object.defineProperty(x.prototype,"ColorType",{get:function(){var t=this;return t.GetState(f.ColorFormatStates.ColorType)||v(t.sft)?t.xrt:t.sft.ColorType},set:function(t){this.xrt=t,this.Dirty(f.ColorFormatStates.ColorType)},enumerable:!1,configurable:!0}),S=x,n.ColorFormat=S},"./dist/plugins/floatingObject/drawing/common.js":function(B,e,t){"use strict";var r,c,n,s,o,t,l,f,u,h,d,i,v,a,m,g,L,p,b,M,y,F,w,C,P,S,T,G,U,H,z,V,n,t,n,t;function Y(t){return"number"==typeof t||t instanceof Date}function Z(t,n,e){e.configurable=!0,e.enumerable=!0,Object.defineProperty(t,n,e)}function A(){}function I(){}function W(t,n){var n=Math.pow(10,n);return Math.round(t*n)/n}function x(){}function N(t,n,e,i){var r=this;r.Row=t,r.Column=n,r.RowCount=e,r.ColumnCount=i}function k(t,n){this.Worksheet=t,this.vft=n,this.UpdateRects()}function D(t,n,e,i,r){var o=this;o.WorksheetName=t,o.Row=n,o.Column=e,void 0!==i&&(o.LastRow=i),void 0!==r&&(o.LastColumn=r)}function Q(t){if(null==t)return 1;if(Array.isArray(t))return 0===t.length;if(!(t instanceof Date)&&"object"==typeof t){for(var n in t)return;return 1}}function _(t,n){var e,i;if(Q(t))return null;for(e in t)0<=n.indexOf(e)||(i=t[e],Array.isArray(i)?0!==i.length&&null!==J(i,n)||delete t[e]:"object"==typeof i&&null===(i=_(i,n))&&delete t[e]);return Q(t)?null:t}function J(t,n){var e,i,e=[],i=t.length;return t.forEach(function(t){var t=_(t,n);null!==t&&e.push(t)}),e.length<i&&[].splice.apply(t,[].concat(0,i,e)),e.length?t:null}function K(t){delete t.solidFill,delete t.pattFill,delete t.blipFill,delete t.gradFill,delete t.noFill,delete t.grpFill,delete t.uFill,delete t.uFillTx}function E(){}function j(){}function X(t){return 8===t||!T.Is3DChart(t)&&(T.IsBarChart(t)||T.IsColumnChart(t)||T.IsLineChart(t))}function q(t){var n,e,i,r,n=t.ChartType;if(0!==n)return X(n);for(i=0,r=(e=t.SeriesCollection.AllSers).length;i<r;i++)if(X(e[i].ChartType))return 1}function O(){}function R(){}function $(t){return parseFloat(t||"0")/1e5}function tt(t){var n=null;switch(t){case s.ST_SystemColorVal.scrollBar:n=23;break;case s.ST_SystemColorVal.activeCaption:n=2;break;case s.ST_SystemColorVal.inactiveCaption:n=17;break;case s.ST_SystemColorVal.menu:n=21;break;case s.ST_SystemColorVal.window:n=24;break;case s.ST_SystemColorVal.windowFrame:n=25;break;case s.ST_SystemColorVal.menuText:n=22;break;case s.ST_SystemColorVal.windowText:n=26;break;case s.ST_SystemColorVal.activeBorder:n=1;break;case s.ST_SystemColorVal.inactiveBorder:n=16;break;case s.ST_SystemColorVal.appWorkspace:n=4;break;case s.ST_SystemColorVal.highlight:n=13;break;case s.ST_SystemColorVal.highlightText:n=14;break;case s.ST_SystemColorVal.btnFace:n=168;break;case s.ST_SystemColorVal.btnShadow:n=170;break;case s.ST_SystemColorVal.grayText:n=12;break;case s.ST_SystemColorVal.inactiveCaptionText:n=18;break;case s.ST_SystemColorVal.btnHighlight:n=169;break;case s.ST_SystemColorVal.infoText:n=20;break;case s.ST_SystemColorVal.infoBk:n=19;break;case s.ST_SystemColorVal.gradientActiveCaption:n=171;break;case s.ST_SystemColorVal.gradientInactiveCaption:n=172;break;case s.ST_SystemColorVal.menuHighlight:n=174;break;case s.ST_SystemColorVal.menuBar:n=173}return n}function nt(t){return t=!t||t instanceof Array?t:[t]}function et(t){var n=4;switch(t){case s.ST_SchemeColorVal.bg1:n=0;break;case s.ST_SchemeColorVal.tx1:n=1;break;case s.ST_SchemeColorVal.bg2:n=2;break;case s.ST_SchemeColorVal.tx2:n=3;break;case s.ST_SchemeColorVal.accent2:n=5;break;case s.ST_SchemeColorVal.accent3:n=6;break;case s.ST_SchemeColorVal.accent4:n=7;break;case s.ST_SchemeColorVal.accent5:n=8;break;case s.ST_SchemeColorVal.accent6:n=9;break;case s.ST_SchemeColorVal.hlink:n=10;break;case s.ST_SchemeColorVal.folHlink:n=11;break;case s.ST_SchemeColorVal.phClr:n=12;break;case s.ST_SchemeColorVal.dk1:n=13;break;case s.ST_SchemeColorVal.lt1:n=14;break;case s.ST_SchemeColorVal.dk2:n=15;break;case s.ST_SchemeColorVal.lt2:n=16}return n}function it(t){return t?"1":"0"}Object.defineProperty(e,"__esModule",{value:!0}),e.mft=e.toColorSchemeIndex=e.gft=e.toKnownColor=e.pft=e.ChartGroupType=e.BevelType=e.ChartElementBase=e.AxisUtility=e.ShapeUtility=e.ChartUtility=e.ShapeConstants=e.ChartConstants=e.Reference=e.Range=e.CellRect=e.UnitHelper=e.NumberExtension=e.DateTimeExtension=void 0,r=t("Core"),c=t("CalcEngine"),n=t("Common"),s=t("./dist/plugins/floatingObject/drawing/drawingInterface.js"),o=t("SheetsCalc"),t=n.Common.ct,l=null,f=void 0,u=Math.max,h=Math.min,d=Math.floor,i=Math.log,v=Math.pow,a=Math.ceil,m=Math.abs,g=r.XmlConstants.Io,L=r.XmlConstants.xo,A.FromOADate=t.Y0,A.ToOADate=t.o0,A.OADateMinAsDouble=-657435,A.OADateMaxAsDouble=2958466,p=A,e.DateTimeExtension=p,I.log=function(t,n){return i(t)/i(n)},I.round=function(t,n){var n=v(10,n);return Math.round(t*n)/n},I.isNaNOrInfinite=function(t){return isNaN(t)||!isFinite(t)},I.GetTriangleAngle=function(t,n,e){var e,i;return 0===t&&0===n?0:(e=(t*t+e*e-n*n)/m(2*t*e),t<(i=0)&&0<n?i=90:t<0&&n<0?i=180:0<t&&n<0&&(i=270),180*Math.acos(e)/Math.PI+i)},I.INT32_MAX_VALUE=2147483647,I.DOUBLE_MAX_VALUE=Number.MAX_VALUE,I.DOUBLE_MIN_VALUE=-Number.MAX_VALUE,b=I,e.NumberExtension=b,x.pointToPixel=function(t){return W(96*t/72,2)},x.IsNullOrEmpty=function(t){return x.isNullOrUndefined(t)||""===t},x.IsNegativeInfinity=function(t){return t===Number.NEGATIVE_INFINITY},x.IsPositiveInfinity=function(t){return t===Number.POSITIVE_INFINITY},x.isNullOrUndefined=function(t){return t===f||t===l},M=x,e.UnitHelper=M,Object.defineProperty(N.prototype,"Left",{get:function(){return this.Column},enumerable:!1,configurable:!0}),Object.defineProperty(N.prototype,"Top",{get:function(){return this.Row},enumerable:!1,configurable:!0}),Object.defineProperty(N.prototype,"Right",{get:function(){return this.Column+this.ColumnCount},enumerable:!1,configurable:!0}),Object.defineProperty(N.prototype,"Bottom",{get:function(){return this.Row+this.RowCount},enumerable:!1,configurable:!0}),Object.defineProperty(N.prototype,"IsFullColumn",{get:function(){return 0===this.Row&&this.RowCount===b.INT32_MAX_VALUE},enumerable:!1,configurable:!0}),Object.defineProperty(N.prototype,"IsFullRow",{get:function(){return 0===this.Column&&this.ColumnCount===b.INT32_MAX_VALUE},enumerable:!1,configurable:!0}),N.prototype.Intersect=function(t){var n,t,e,i,r,t,n=this,t=t,e=u(n.Column,t.Column),i=u(n.Row,t.Row),r=h(n.Right,t.Right),t=h(n.Bottom,t.Bottom);r<=e||t<=i?(n.Column=0,n.Row=0,n.ColumnCount=0,n.RowCount=0):(n.Column=e,n.Row=i,n.ColumnCount=r-e,n.RowCount=t-i)},N.prototype.IntersectsWith=function(t){var n,e,n=this,e;return!(n.Left>=t.Right||n.Right<=t.Left||n.Top>=t.Bottom||n.Bottom<=t.Top)},y=N,e.CellRect=y,k.prototype.UpdateRects=function(){var t,n,e,i,r,o,a,u,s,c,f,l,t=this;for(t.bft=[],o=(r=t.Worksheet).getRowCount(),a=r.getColumnCount(),u=0;u<t.vft.length;u++){if(s=(i=t.vft[u]).Row,c=i.Column,n=i.RowCount,e=i.ColumnCount,(s<0||n<0||c<0||e<0)&&((s<0||n<0)&&(s=0,n=b.INT32_MAX_VALUE),(c<0||e<0)&&(c=0,e=b.INT32_MAX_VALUE),t.vft[u]=new y(s,c,n,e)),(0!==s||n!==b.INT32_MAX_VALUE)&&(s<0||n<=0||g<s+n))throw new Error;if((0!==c||e!==b.INT32_MAX_VALUE)&&(c<0||e<=0||L<c+e))throw new Error}for(f=0,l=t.vft;f<l.length;f++)i=l[f],n=h(i.Bottom,o+1)-i.Top,e=h(i.Right,a+1)-i.Left,t.bft.push(new y(i.Row,i.Column,n,e))},Object.defineProperty(k.prototype,"Row",{get:function(){var t=this.bft[0].Row;return t<0?0:t},enumerable:!1,configurable:!0}),Object.defineProperty(k.prototype,"Column",{get:function(){var t=this.bft[0].Column;return t<0?0:t},enumerable:!1,configurable:!0}),Object.defineProperty(k.prototype,"RowCount",{get:function(){var t,n,e,i,r,t=this,n=t.bft[0].RowCount,e=t.bft[0].Row;return n<0||e<0?(i=t.Worksheet).getRowCount():n},enumerable:!1,configurable:!0}),Object.defineProperty(k.prototype,"ColumnCount",{get:function(){var t,n,e,i,r,t,n=this.bft[0].ColumnCount,e=this.bft[0].Column,i,r=this.Worksheet.getColumnCount();return n<0||e<0?r:n},enumerable:!1,configurable:!0}),Object.defineProperty(k.prototype,"EntireRow",{get:function(){for(var t,n,e,t=[],n=0;n<this.bft.length;n++)(e=this.bft[n]).Column=-1,e.ColumnCount=-1,t.push(e);return new k(this.Worksheet,t)},enumerable:!1,configurable:!0}),Object.defineProperty(k.prototype,"EntireColumn",{get:function(){for(var t,n,e,t=[],n=0;n<this.bft.length;n++)(e=this.bft[n]).Row=-1,e.RowCount=-1,t.push(e);return new k(this.Worksheet,t)},enumerable:!1,configurable:!0}),Object.defineProperty(k.prototype,"Text",{get:function(){var t=this;return t.Worksheet.xnn(t.Row,t.Column,t.RowCount,t.ColumnCount)},enumerable:!1,configurable:!0}),Object.defineProperty(k.prototype,"Areas",{get:function(){for(var t,n,e,i,r,t,n=[],e=0,i=this.bft;e<i.length;e++)r=i[e],n.push(new k(this.Worksheet,[r]));return n},enumerable:!1,configurable:!0}),Object.defineProperty(k.prototype,"Hidden",{get:function(){return this.Worksheet.Tnn(this.vft)},enumerable:!1,configurable:!0}),e.Range=k,(n=w=w||{})[n.Row=1]="Row",n[n.Column=2]="Column",n[n.RowIsRelative=4]="RowIsRelative",n[n.ColumnIsRelative=8]="ColumnIsRelative",n[n.LastRowIsRelative=16]="LastRowIsRelative",n[n.LastColumnIsRelative=32]="LastColumnIsRelative",n[n.Range=64]="Range",n[n.Error=128]="Error",Object.defineProperty(D.prototype,"Row",{get:function(){return(this.Kind&w.Row)===w.Row?this.Ky:0},set:function(t){this.Ky=t,this.Kind|=w.Row},enumerable:!1,configurable:!0}),Object.defineProperty(D.prototype,"Column",{get:function(){return(this.Kind&w.Column)===w.Column?this.yft:0},set:function(t){this.yft=t,this.Kind|=w.Column},enumerable:!1,configurable:!0}),Object.defineProperty(D.prototype,"RowCount",{get:function(){var t,n,e,t=this;return t.IsRange?(t.Kind&w.Row)===w.Row?t.RowIsRelative&&t.LastRowIsRelative||!t.RowIsRelative&&!t.LastRowIsRelative?t.LastRow-t.Row+1:-1:(n=t.Worksheet).getRowCount():1},enumerable:!1,configurable:!0}),Object.defineProperty(D.prototype,"ColumnCount",{get:function(){var t=this;return t.IsRange?(t.Kind&w.Column)===w.Column?t.ColumnIsRelative&&t.LastColumnIsRelative||!t.ColumnIsRelative&&!t.LastColumnIsRelative?t.LastColumn-t.Column+1:-1:t.Worksheet.getColumnCount():1},enumerable:!1,configurable:!0}),Object.defineProperty(D.prototype,"LastColumn",{get:function(){var t,n,e,t=this;return t.IsRange?(t.Kind&w.Column)===w.Column?t.wft:(e=(n=t.Worksheet).getColumnCount())-1:t.Column},set:function(t){this.wft=t,this.Kind|=w.Column|w.Range},enumerable:!1,configurable:!0}),Object.defineProperty(D.prototype,"LastRow",{get:function(){var t,n,e,t=this;return t.IsRange?(t.Kind&w.Row)===w.Row?t.Mft:(e=(n=t.Worksheet).getRowCount())-1:t.Row},set:function(t){this.Mft=t,this.Kind|=w.Row|w.Range},enumerable:!1,configurable:!0}),Object.defineProperty(D.prototype,"RowIsRelative",{get:function(){return(this.Kind&(w.Row|w.RowIsRelative))==(w.Row|w.RowIsRelative)},enumerable:!1,configurable:!0}),Object.defineProperty(D.prototype,"ColumnIsRelative",{get:function(){return(this.Kind&(w.Column|w.ColumnIsRelative))==(w.Column|w.ColumnIsRelative)},enumerable:!1,configurable:!0}),Object.defineProperty(D.prototype,"LastRowIsRelative",{get:function(){return this.IsRange?(this.Kind&(w.Row|w.LastRowIsRelative))==(w.Row|w.LastRowIsRelative):this.RowIsRelative},enumerable:!1,configurable:!0}),Object.defineProperty(D.prototype,"LastColumnIsRelative",{get:function(){return this.IsRange?(this.Kind&(w.Column|w.LastColumnIsRelative))==(w.Column|w.LastColumnIsRelative):this.ColumnIsRelative},enumerable:!1,configurable:!0}),Object.defineProperty(D.prototype,"IsRange",{get:function(){return(this.Kind&w.Range)===w.Range},set:function(t){t?this.Kind|=w.Range:this.Kind&=~w.Range},enumerable:!1,configurable:!0}),Object.defineProperty(D.prototype,"IsError",{get:function(){return"#REF"===this.WorksheetName},enumerable:!1,configurable:!0}),D.prototype.GetSourceRange=function(t,n){var e,i,r,o,e,e=this,i=e.Row,r=e.Column,o=e.LastRow,e=e.LastColumn;return new y(i,r,o-i+1,e-r+1)},D.prototype.ToR1C1Text=function(t){var n,e,i,r,o,a;return t===f&&(t=l),e=(n=this).D5,M.isNullOrUndefined(e)?(n.Kind&w.Error)===w.Error?n.GetPrevText(t)+"#REF!":(i="",(n.Kind&w.Row)===w.Row&&(r=n.Row,n.RowIsRelative?i+=0===r?"R":"R["+r.toString()+"]":i+="R"+(r+1).toString()),(n.Kind&w.Column)===w.Column&&(o=n.Column,n.ColumnIsRelative?i+=0===o?"C":"C["+o.toString()+"]":i+="C"+(o+1).toString()),n.IsRange&&(a=!1,(n.Kind&(w.Row|w.Column))!=(w.Row|w.Column)&&((n.Kind&w.Row)===w.Row?n.RowIsRelative===n.LastRowIsRelative&&n.Row===n.LastRow&&(a=!0):n.ColumnIsRelative===n.LastColumnIsRelative&&n.Column===n.LastColumn&&(a=!0)),a||(i+=":",(n.Kind&w.Row)===w.Row&&(r=n.LastRow,n.LastRowIsRelative?i+=0===r?"R":"R["+r.toString()+"]":i+="R"+(r+1).toString()),(n.Kind&w.Column)===w.Column&&(o=n.LastColumn,n.LastColumnIsRelative?i+=0===o?"C":"C["+o.toString()+"]":i+="C"+(o+1).toString()))),n.GetPrevText(t)+i):e},D.prototype.ToA1Text=function(t,n,e){var i,r,o,a,u;return e===f&&(e=l),r=(i=this).D5,M.isNullOrUndefined(r)?(i.Kind&w.Error)===w.Error?i.GetPrevText(e)+"#REF!":(o="",(i.Kind&w.Column)===w.Column&&(u=i.Column,i.ColumnIsRelative?u+=n:o+="$",isNaN(u)||(o+=i.GetColumnIndexInA1Letter(u))),(i.Kind&w.Row)===w.Row&&(a=i.Row,i.RowIsRelative?a+=t:o+="$",o+=(a+1).toString()),i.IsRange&&(o+=":",(i.Kind&w.Column)===w.Column&&(u=i.LastColumn,i.LastColumnIsRelative?u+=n:o+="$",isNaN(u)||(o+=i.GetColumnIndexInA1Letter(u))),(i.Kind&w.Row)===w.Row)&&(a=i.LastRow,i.LastRowIsRelative?a+=t:o+="$",o+=(a+1).toString()),i.GetPrevText(e)+o):r},D.prototype.GetPrevText=function(t){var n,e,i,n=this,e="";return 0<n.Workbook&&(e="["+n.Workbook.toString()+"]"),i=n.WorksheetName,(i=M.isNullOrUndefined(i)?t:i)&&(M.isNullOrUndefined(n.LastWorksheetName)?e+=i:e+=i+":"+n.LastWorksheetName),e?((n.IsSpecialSheetName(i)||n.IsSpecialSheetName(n.LastWorksheetName))&&(e="'"+e.replace("'","''")+"'"),e+="!"):""===i&&(e="!"),e},D.prototype.IsSpecialSheetName=function(t){var n,e;if(!M.isNullOrUndefined(t)){if(t===D.ErrorWorksheetName)return!1;for(n=0;n<t.length;n++)if(!("A"<=(e=t[n])&&e<="Z"||"a"<=e&&e<="z"||"0"<=e&&e<="9"||"_"===e))return!0}return!1},D.prototype.GetColumnIndexInA1Letter=function(t){for(var n,e,i,n="ABCDEFGHIJKLMNOPQRSTUVWXYZ",e=[],i=0;(i=t%26,!isNaN(i))&&(e.unshift(n[i]),0!==(t=parseInt(t/26+"",10)));)t--;return e.join("")},D.ErrorWorksheetName="#REF",C=D,e.Reference=C,e.ChartConstants={XValuesMinMax:"XValuesMinMax",ValuesMinMax:"ValuesMinMax",PrimaryValuesMinMax:"PrimaryValuesMinMax",SecondaryValuesMinMax:"SecondaryValuesMinMax",PrimaryXValuesMinMax:"PrimaryXValuesMinMax",SecondaryXValuesMinMax:"SecondaryXValuesMinMax",Collection:"Collection",Restore:"Restore",ChartType:"ChartType",AxisGroup:"AxisGroup",AreAllXValuesDateTime:"AreAllXValuesDateTime",XValuesFormula:"XValuesFormula",XValues:"XValues",CategoryNames:"CategoryNames",CategoryType:"CategoryType",SecondaryPlot:"SecondaryPlot",SplitType:"SplitType",SplitValue:"SplitValue",IsMultiLevelXValues:"IsMultiLevelXValues",PlotOrder:"PlotOrder",FIELD_TYPE_CELLRANGE:"CELLRANGE",FIELD_TYPE_SERIESNAME:"SERIESNAME",FIELD_TYPE_CATEGORYNAME:"CATEGORYNAME",FIELD_TYPE_VALUE:"VALUE",FIELD_TYPE_XVALUE:"XVALUE",FIELD_TYPE_YVALUE:"YVALUE",FIELD_TYPE_BUBBLESIZE:"BUBBLESIZE",FIELD_TYPE_PERCENTAGE:"PERCENTAGE",FIELD_TYPE_TXLINK:"TxLink",FIELD_TEXT_CELLRANGE:"[CELLRANGE]",FIELD_TEXT_SERIESNAME:"[SERIES NAME]",FIELD_TEXT_CATEGORYNAME:"[CATEGORY NAME]",FIELD_TEXT_VALUE:"[VALUE]",FIELD_TEXT_XVALUE:"[XVALUE]",FIELD_TEXT_YVALUE:"[YVALUE]",FIELD_TEXT_BUBBLESIZE:"[BUBBLE SIZE]",CHART_LATIN_HEAD_FONT:"+mj-lt",CHART_LATIN_BODY_FONT:"+mn-lt",CHART_EA_HEAD_FONT:"+mj-ea",CHART_EA_BODY_FONT:"+mn-ea",CHART_CS_HEAD_FONT:"+mj-cs",CHART_CS_BODY_FONT:"+mn-cs",DefaultLineColorBrightness:.85,DefaultMarkerSize:7},e.ShapeConstants={ShapeTypePrefix:"Shape",PositiveFixedAngleConvert:6e4,PositionConver:1e5,CropPositionConver:1e3,ShadeConver:2e5,DefaultBrightness:.5,RelativeRectConver:1e3,DefaultTransparent:0,PositiveFixedPercentageConvert:1e5,DefaultOffset:2.07995176,DefaultSatMod:1},P=["","Dotted-5%","Dotted-10%","Dotted-20%","Dotted-25%","Dotted-30%","Dotted-40%","Dotted-50%","Dotted-60%","Dotted-70%","Dotted-75%","Dotted-80%","Dotted-90%","HorizontalStripes-Dark","VerticalStripes-Dark","DiagonalStripes-DarkDownward","DiagonalStripes-DarkUpward","SmallCheckerBoard","Trellis","HorizontalStripes-Light","VerticalStripes-Light","DiagonalStripes-LightDownward","DiagonalStripes-LightUpward","SmallGrid","DottedDiamondGrid","DiagonalStripes-WideDownward","DiagonalStripes-WideUpward","Stripes-Slashes","Stripes-Backslashes","VerticalStripes-Narrow","HorizontalStripes-Narrow","VerticalStripes-AlternatingVerticalLines","HorizontalStripes-AlternatingHorizontalLines","LargeConfetti","LargeGrid","HorizontalBrick","LargeCheckerBoard","SmallConfetti","ZigZag","SolidDiamondGrid","DiagonalBrick","OutlinedDiamondGrid","Plaid","Sphere","Weave","DottedGrid","Divot","Shingle","Wave"],(t=S=S||{})[t["background 1"]=0]="background 1",t[t["background 2"]=2]="background 2",t[t["text 1"]=1]="text 1",t[t["text 2"]=3]="text 2",t[t["accent 1"]=4]="accent 1",t[t["accent 2"]=5]="accent 2",t[t["accent 3"]=6]="accent 3",t[t["accent 4"]=7]="accent 4",t[t["accent 5"]=8]="accent 5",t[t["accent 6"]=9]="accent 6",t[t.hyperlink=10]="hyperlink",t[t.followedhyperlink=11]="followedhyperlink",E.nft=function(t,n){},E.Cft=function(t,n){return n===s.ThemeFont.Major?t.getFont("Headings"):n===s.ThemeFont.Minor?t.getFont("Body"):""},E.colorFormatToString=function(t,n,e,i){var t=t&&t.Color;return E.colorFormatToStringImp(t,n,e,i)},E.colorFormatToStringImp=function(t,n,e,i){var n,n;if(t&&t.ColorType!==s.SolidColorType.None){if(n&&(n=t.GetColorData()).ColorType===s.ColorType.Theme)return E.toThemeColorString(n.Value,n.Tint);if(n=t.RGB)return e?"rgba("+n.R+","+n.G+","+n.B+","+n.A/255+")":"rgb("+n.R+","+n.G+","+n.B+")"}else if(t&&t.ColorType===s.SolidColorType.None&&i)return"";return"transparent"},E.isMarkerScatterChart=function(t){return 0<=[1,33,35,26,27,28,42].indexOf(t)},E.getFillFormatResult=function(t,n,e,i,r,o){var a,u,s,c,s,c,a;return 1===(t&&t.Type)?(u={},s=t&&t.PatternColor,c=t&&t.Color,s=E.colorFormatToStringImp(s,n,e,i),c=E.colorFormatToStringImp(c,n,e,i),r?(u.type="Pattern",u.color=o?s:c,u.pattern=[],u.pattern.push({style:{fill:o?c:s},content:P[t.Pattern]})):(u.type=t.Pattern,u.foregroundColor=s,u.backgroundColor=c),u):E.colorFormatToString(t,n,e,i)},E.getTransparencyFromColorFormat=function(t,n){var t,n,t=t&&t.Color;if(t&&(t.ColorType!==s.SolidColorType.None||n)){if(!M.isNullOrUndefined(t.Transparency))return parseFloat(t.Transparency.toFixed(2));if(n=t.RGB)return parseFloat((n.A/255).toFixed(2))}return 0},E.toThemeColorString=function(t,n){return S[t]+" "+parseInt(100*n+"",10)},E.fromThemeColorString=function(t){var t,n,e,i,t,e,t=t.split(" "),n=t.length,e=t[0].toLowerCase(),i=t[1],t=t[2];if("hyperlink"===e||"followedhyperlink"===e){if(1===n)return{index:S[e],tint:0};if(2===n)return{index:S[e],tint:parseInt(i,10)/100}}if(2<=n&&(e=S[e+" "+i])!==f)return 2===n?{index:e,tint:0}:3===n?{index:e,tint:parseInt(t,10)/100}:void 0},E.InitPresetColors=function(){var t=E.presetColors;t[s.ST_PresetColorVal.aliceBlue]=[240,248,255],t[s.ST_PresetColorVal.antiqueWhite]=[250,235,215],t[s.ST_PresetColorVal.aqua]=[0,255,255],t[s.ST_PresetColorVal.aquamarine]=[127,255,212],t[s.ST_PresetColorVal.azure]=[240,255,255],t[s.ST_PresetColorVal.beige]=[245,245,220],t[s.ST_PresetColorVal.bisque]=[255,228,196],t[s.ST_PresetColorVal.black]=[0,0,0],t[s.ST_PresetColorVal.blanchedAlmond]=[255,235,205],t[s.ST_PresetColorVal.blue]=[0,0,255],t[s.ST_PresetColorVal.blueViolet]=[138,43,226],t[s.ST_PresetColorVal.brown]=[165,42,42],t[s.ST_PresetColorVal.burlyWood]=[222,184,135],t[s.ST_PresetColorVal.cadetBlue]=[95,158,160],t[s.ST_PresetColorVal.chartreuse]=[127,255,0],t[s.ST_PresetColorVal.chocolate]=[210,105,30],t[s.ST_PresetColorVal.coral]=[255,127,80],t[s.ST_PresetColorVal.cornflowerBlue]=[100,149,237],t[s.ST_PresetColorVal.cornsilk]=[255,248,220],t[s.ST_PresetColorVal.crimson]=[220,20,60],t[s.ST_PresetColorVal.cyan]=[0,255,255],t[s.ST_PresetColorVal.darkBlue]=[0,0,139],t[s.ST_PresetColorVal.darkCyan]=[0,139,139],t[s.ST_PresetColorVal.darkGoldenrod]=[184,134,11],t[s.ST_PresetColorVal.darkGray]=[169,169,169],t[s.ST_PresetColorVal.darkGreen]=[0,100,0],t[s.ST_PresetColorVal.darkGrey]=[169,169,169],t[s.ST_PresetColorVal.darkKhaki]=[189,183,107],t[s.ST_PresetColorVal.darkMagenta]=[139,0,139],t[s.ST_PresetColorVal.darkOliveGreen]=[85,107,47],t[s.ST_PresetColorVal.darkOrange]=[255,140,0],t[s.ST_PresetColorVal.darkOrchid]=[153,50,204],t[s.ST_PresetColorVal.darkRed]=[139,0,0],t[s.ST_PresetColorVal.darkSalmon]=[233,150,122],t[s.ST_PresetColorVal.darkSeaGreen]=[143,188,143],t[s.ST_PresetColorVal.darkSlateBlue]=[72,61,139],t[s.ST_PresetColorVal.darkSlateGray]=[47,79,79],t[s.ST_PresetColorVal.darkSlateGrey]=[47,79,79],t[s.ST_PresetColorVal.darkTurquoise]=[0,206,209],t[s.ST_PresetColorVal.darkViolet]=[148,0,211],t[s.ST_PresetColorVal.deepPink]=[255,20,147],t[s.ST_PresetColorVal.deepSkyBlue]=[0,191,255],t[s.ST_PresetColorVal.dimGray]=[105,105,105],t[s.ST_PresetColorVal.dimGrey]=[105,105,105],t[s.ST_PresetColorVal.dkBlue]=[0,0,139],t[s.ST_PresetColorVal.dkCyan]=[0,139,139],t[s.ST_PresetColorVal.dkGoldenrod]=[184,134,11],t[s.ST_PresetColorVal.dkGray]=[169,169,169],t[s.ST_PresetColorVal.dkGreen]=[0,100,0],t[s.ST_PresetColorVal.dkGrey]=[169,169,169],t[s.ST_PresetColorVal.dkKhaki]=[189,183,107],t[s.ST_PresetColorVal.dkMagenta]=[139,0,139],t[s.ST_PresetColorVal.dkOliveGreen]=[85,107,47],t[s.ST_PresetColorVal.dkOrange]=[255,140,0],t[s.ST_PresetColorVal.dkOrchid]=[153,50,204],t[s.ST_PresetColorVal.dkRed]=[139,0,0],t[s.ST_PresetColorVal.dkSalmon]=[233,150,122],t[s.ST_PresetColorVal.dkSeaGreen]=[143,188,139],t[s.ST_PresetColorVal.dkSlateBlue]=[72,61,139],t[s.ST_PresetColorVal.dkSlateGray]=[47,79,79],t[s.ST_PresetColorVal.dkSlateGrey]=[47,79,79],t[s.ST_PresetColorVal.dkTurquoise]=[0,206,209],t[s.ST_PresetColorVal.dkViolet]=[148,0,211],t[s.ST_PresetColorVal.dodgerBlue]=[30,144,255],t[s.ST_PresetColorVal.firebrick]=[178,34,34],t[s.ST_PresetColorVal.floralWhite]=[255,250,240],t[s.ST_PresetColorVal.forestGreen]=[34,139,34],t[s.ST_PresetColorVal.fuchsia]=[255,0,255],t[s.ST_PresetColorVal.gainsboro]=[220,220,220],t[s.ST_PresetColorVal.ghostWhite]=[248,248,255],t[s.ST_PresetColorVal.gold]=[255,215,0],t[s.ST_PresetColorVal.goldenrod]=[218,165,32],t[s.ST_PresetColorVal.gray]=[128,128,128],t[s.ST_PresetColorVal.green]=[0,128,0],t[s.ST_PresetColorVal.greenYellow]=[173,255,47],t[s.ST_PresetColorVal.grey]=[128,128,128],t[s.ST_PresetColorVal.honeydew]=[240,255,240],t[s.ST_PresetColorVal.hotPink]=[255,105,180],t[s.ST_PresetColorVal.indianRed]=[205,92,92],t[s.ST_PresetColorVal.indigo]=[75,0,130],t[s.ST_PresetColorVal.ivory]=[255,255,240],t[s.ST_PresetColorVal.khaki]=[240,230,140],t[s.ST_PresetColorVal.lavender]=[230,230,250],t[s.ST_PresetColorVal.lavenderBlush]=[255,240,245],t[s.ST_PresetColorVal.lawnGreen]=[124,252,0],t[s.ST_PresetColorVal.lemonChiffon]=[255,250,205],t[s.ST_PresetColorVal.lightBlue]=[173,216,230],t[s.ST_PresetColorVal.lightCoral]=[240,128,128],t[s.ST_PresetColorVal.lightCyan]=[224,255,255],t[s.ST_PresetColorVal.lightGoldenrodYellow]=[250,250,210],t[s.ST_PresetColorVal.lightGray]=[211,211,211],t[s.ST_PresetColorVal.lightGreen]=[144,238,144],t[s.ST_PresetColorVal.lightGrey]=[211,211,211],t[s.ST_PresetColorVal.lightPink]=[255,182,193],t[s.ST_PresetColorVal.lightSalmon]=[255,160,122],t[s.ST_PresetColorVal.lightSeaGreen]=[32,178,170],t[s.ST_PresetColorVal.lightSkyBlue]=[135,206,250],t[s.ST_PresetColorVal.lightSlateGray]=[119,136,153],t[s.ST_PresetColorVal.lightSlateGrey]=[119,136,153],t[s.ST_PresetColorVal.lightSteelBlue]=[176,196,222],t[s.ST_PresetColorVal.lightYellow]=[255,255,224],t[s.ST_PresetColorVal.lime]=[0,255,0],t[s.ST_PresetColorVal.limeGreen]=[50,205,50],t[s.ST_PresetColorVal.linen]=[250,240,230],t[s.ST_PresetColorVal.ltBlue]=[173,216,230],t[s.ST_PresetColorVal.ltCoral]=[240,128,128],t[s.ST_PresetColorVal.ltCyan]=[224,255,255],t[s.ST_PresetColorVal.ltGoldenrodYellow]=[250,250,120],t[s.ST_PresetColorVal.ltGray]=[211,211,211],t[s.ST_PresetColorVal.ltGreen]=[144,238,144],t[s.ST_PresetColorVal.ltGrey]=[211,211,211],t[s.ST_PresetColorVal.ltPink]=[255,182,193],t[s.ST_PresetColorVal.ltSalmon]=[255,160,122],t[s.ST_PresetColorVal.ltSeaGreen]=[32,178,170],t[s.ST_PresetColorVal.ltSkyBlue]=[135,206,250],t[s.ST_PresetColorVal.ltSlateGray]=[119,136,153],t[s.ST_PresetColorVal.ltSlateGrey]=[119,136,153],t[s.ST_PresetColorVal.ltSteelBlue]=[176,196,222],t[s.ST_PresetColorVal.ltYellow]=[255,255,224],t[s.ST_PresetColorVal.magenta]=[255,0,255],t[s.ST_PresetColorVal.maroon]=[128,0,0],t[s.ST_PresetColorVal.medAquamarine]=[102,205,170],t[s.ST_PresetColorVal.medBlue]=[0,0,205],t[s.ST_PresetColorVal.mediumAquamarine]=[102,205,170],t[s.ST_PresetColorVal.mediumBlue]=[0,0,205],t[s.ST_PresetColorVal.mediumOrchid]=[186,85,211],t[s.ST_PresetColorVal.mediumPurple]=[147,112,219],t[s.ST_PresetColorVal.mediumSeaGreen]=[60,179,113],t[s.ST_PresetColorVal.mediumSlateBlue]=[123,104,238],t[s.ST_PresetColorVal.mediumSpringGreen]=[0,250,154],t[s.ST_PresetColorVal.mediumTurquoise]=[72,209,204],t[s.ST_PresetColorVal.mediumVioletRed]=[199,21,133],t[s.ST_PresetColorVal.medOrchid]=[186,85,211],t[s.ST_PresetColorVal.medPurple]=[147,112,219],t[s.ST_PresetColorVal.medSeaGreen]=[60,179,113],t[s.ST_PresetColorVal.medSlateBlue]=[123,104,238],t[s.ST_PresetColorVal.medSpringGreen]=[0,250,154],t[s.ST_PresetColorVal.medTurquoise]=[72,209,204],t[s.ST_PresetColorVal.medVioletRed]=[199,21,133],t[s.ST_PresetColorVal.midnightBlue]=[25,25,112],t[s.ST_PresetColorVal.mintCream]=[245,255,250],t[s.ST_PresetColorVal.mistyRose]=[255,228,225],t[s.ST_PresetColorVal.moccasin]=[255,228,181],t[s.ST_PresetColorVal.navajoWhite]=[255,222,173],t[s.ST_PresetColorVal.navy]=[0,0,128],t[s.ST_PresetColorVal.oldLace]=[253,245,230],t[s.ST_PresetColorVal.olive]=[128,128,0],t[s.ST_PresetColorVal.oliveDrab]=[107,142,35],t[s.ST_PresetColorVal.orange]=[255,165,0],t[s.ST_PresetColorVal.orangeRed]=[255,69,0],t[s.ST_PresetColorVal.orchid]=[218,112,214],t[s.ST_PresetColorVal.paleGoldenrod]=[238,232,170],t[s.ST_PresetColorVal.paleGreen]=[152,251,152],t[s.ST_PresetColorVal.paleTurquoise]=[175,238,238],t[s.ST_PresetColorVal.paleVioletRed]=[219,112,147],t[s.ST_PresetColorVal.papayaWhip]=[255,239,213],t[s.ST_PresetColorVal.peachPuff]=[255,218,185],t[s.ST_PresetColorVal.peru]=[205,133,63],t[s.ST_PresetColorVal.pink]=[255,192,203],t[s.ST_PresetColorVal.plum]=[221,160,221],t[s.ST_PresetColorVal.powderBlue]=[176,224,230],t[s.ST_PresetColorVal.purple]=[128,0,128],t[s.ST_PresetColorVal.red]=[255,0,0],t[s.ST_PresetColorVal.rosyBrown]=[188,143,143],t[s.ST_PresetColorVal.royalBlue]=[65,105,225],t[s.ST_PresetColorVal.saddleBrown]=[139,69,19],t[s.ST_PresetColorVal.salmon]=[250,128,114],t[s.ST_PresetColorVal.sandyBrown]=[244,164,96],t[s.ST_PresetColorVal.seaGreen]=[46,139,87],t[s.ST_PresetColorVal.seaShell]=[255,245,238],t[s.ST_PresetColorVal.sienna]=[160,82,45],t[s.ST_PresetColorVal.silver]=[192,192,192],t[s.ST_PresetColorVal.skyBlue]=[135,206,235],t[s.ST_PresetColorVal.slateBlue]=[106,90,205],t[s.ST_PresetColorVal.slateGray]=[112,128,144],t[s.ST_PresetColorVal.slateGrey]=[112,128,144],t[s.ST_PresetColorVal.snow]=[255,250,250],t[s.ST_PresetColorVal.springGreen]=[0,255,127],t[s.ST_PresetColorVal.steelBlue]=[70,130,180],t[s.ST_PresetColorVal.tan]=[210,180,140],t[s.ST_PresetColorVal.teal]=[0,128,128],t[s.ST_PresetColorVal.thistle]=[216,191,216],t[s.ST_PresetColorVal.tomato]=[255,99,71],t[s.ST_PresetColorVal.turquoise]=[64,224,208],t[s.ST_PresetColorVal.violet]=[238,130,238],t[s.ST_PresetColorVal.wheat]=[245,222,179],t[s.ST_PresetColorVal.white]=[255,255,255],t[s.ST_PresetColorVal.whiteSmoke]=[245,245,245],t[s.ST_PresetColorVal.yellow]=[255,255,0],t[s.ST_PresetColorVal.yellowGreen]=[154,205,50]},E.GetPresetColorRGB=function(t){return E.presetColors[t]},E.GetDimensioin=function(t){var n;return{0:-1,1:2,33:2,34:2,35:2,36:2,11:3,48:3,57:2,58:2}[t]||1},E.AreValuesAllNum=function(t,n,e){var i,r,o;if(M.isNullOrUndefined(n))return null;for(i=t.getArray(n.row,n.col,n.rowCount,n.colCount),r=!0,o=0;o<i.length;o++)if(!this.AreAllNumbers(i[o],e)){r=!1;break}return r},E.AreValuesDateTime=function(t,n,e){var i,r,o,a,u,s,c,f,l,h,d,v,m,g,p,b,y,w;if(!M.isNullOrUndefined(n)&&0!==n.length){for(i=!0,o=this.GetStylesFromCellRefers(t,n,e),a=this.GetValuesFromCellRefers(t,n,e),u=0;u<o.length;u++){for(c=(s=o[u]).length,f=s[0]&&s[0].length,l=0;l<f;l++){for(h=0;h<c;h++)if(d=s[h][l],r=a[u]&&a[u][h]&&a[u][h][l],!M.isNullOrUndefined(r)&&!(r instanceof Date)&&(M.isNullOrUndefined(d)||!E.IsDatesOrTimesNumberFormat(d.FormatCode)||!Y(r))){i=!1;break}if(!i)break}if(!i)break}if(i)for(v=0,m=a;v<m.length;v++)for(p=0,b=g=m[v];p<b.length;p++)if(y=b[p],!M.isNullOrUndefined(y))for(w=0;w<y.length;w++)if(r=y[w],!M.isNullOrUndefined(r))return!0}return!1},E.AreAllNumbers=function(t,n){var e,i,r,o,a,o;if(!t)return!1;for(e=!0,i=0,r=t;i<r.length;i++)if(a=Y(o=r[i]),o=n&&(null===o||o&&o._error),!a&&!o){e=!1;break}return e},E.AreAllNull=function(t){for(var n,e,i,r,n=!0,e=0,i=t;e<i.length;e++)if(null!=(r=i[e])){n=!1;break}return n},E.AreAllDate=function(t,n){for(var e,i,r,o,e=0,i=t;e<i.length;e++)if(r=i[e],o=n&&(null===r||r&&r._error),!(r instanceof Date||o))return!1;return!0},E.TryAllToNumbers=function(t,n,e){var i,r,o,a,u,s;if(M.isNullOrUndefined(t)||0===t.length)return!1;for(i=!0,r=[],o=t.length,a=0;a<o;a++)u=t[a],M.isNullOrUndefined(u)?e||r.push(u):this.TryToDouble(u,s={value:void 0})?r.push(s.value):(c.Convert&&c.Convert.Sft(u)?r.push(Number.NaN):r.push(0),i=!1);return Array.prototype.push.apply(n,r),i},E.TryToDouble=function(t,n,e){var i,r,o,a,u,s,c,f,i={JAN:1,FEB:2,MAR:3,APR:4,MAY:5,JUN:6,JUL:7,AUG:8,SEP:9,OCT:10,NOV:11,DEC:12},r=l;if(!t)return!(n.value=0);o=typeof t;try{if("number"==o)r=t;else if("string"==o&&e){if(0===(t=t.trim()).length)return!(n.value=0);if(a=".",s=!(u=","),"%"===t.charAt(t.length-1)&&(s=!0,t=t.substr(0,t.length-1)),"$"===t[0]||"$"===t[t.length-1])return!1;if(t.indexOf(".")!==t.lastIndexOf("."))return!1;if(2<=t.length&&"0"===t[0]&&"x"===t[1])return!1;if(r=+t,b.isNaNOrInfinite(r)){if(c=t.charCodeAt(0),c|=32,4<t.length&&96<=c&&c<=122&&!i[f=(f=t[0]+t[1]+t[2]).toUpperCase()])return!1;if("/"===t[0]||"/"===t[t.length-1])return!1;if("#"===t[0]||"#"===t[t.length-1])return!1;if(r=new Date(t),b.isNaNOrInfinite(r.valueOf()))return!1;r=p.ToOADate(r)}s&&(r/=100)}else if("boolean"==o)r=t?1:0;else{if(!(t instanceof Date))return!1;r=p.ToOADate(t)}}catch(t){return!1}return n.value=r,!0},E.IsBarChart=function(t){return t===s.ChartType.barClustered||t===s.ChartType.barClustered3D||t===s.ChartType.barStacked||t===s.ChartType.barStacked100||t===s.ChartType.barStacked1003D||t===s.ChartType.barStacked3D},E.Tft=function(t){var n,e,n=E.chartTypeDict;if(!n)for(e in n=E.chartTypeDict={},s.ChartType)n[s.ChartType[e]]=e.toLowerCase();return n[t]},E.IsColumnChart=function(t){return 0<=E.Tft(t).indexOf("column")},E.IsAnyPieChart=function(t){return this.IsPieChart(t)||this.IsDoughnutChart(t)||this.IsOfPieChart(t)},E.IsFunnelChart=function(t){return t===s.ChartType.funnel},E.IsPieChart=function(t){return 0<=E.Tft(t).indexOf("pie")},E.IsPieOrDoughnutChart=function(t){return E.IsPieChart(t)||E.IsDoughnutChart(t)},E.IsRadarChart=function(t){return t===s.ChartType.radar||t===s.ChartType.radarFilled||t===s.ChartType.radarMarkers},E.IsOfPieChart=function(t){return t===s.ChartType.pieOfPie||t===s.ChartType.barOfPie},E.IsStackedChart=function(t){return 0<=E.Tft(t).indexOf("stacked")},E.IsStacked100Chart=function(t){return 0<=E.Tft(t).indexOf("stacked100")},E.IsLineChart=function(t){return t===s.ChartType.line3D||t===s.ChartType.line||t===s.ChartType.lineMarkers||t===s.ChartType.lineMarkersStacked||t===s.ChartType.lineMarkersStacked100||t===s.ChartType.lineStacked||t===s.ChartType.lineStacked100},E.IsLineMarkerChart=function(t){return t===s.ChartType.lineMarkers||t===s.ChartType.lineMarkersStacked||t===s.ChartType.lineMarkersStacked100},E.IsLineSeries=function(t){return t===s.ChartType.line||t===s.ChartType.lineMarkers||t===s.ChartType.lineMarkersStacked||t===s.ChartType.lineMarkersStacked100||t===s.ChartType.lineStacked||t===s.ChartType.lineStacked100||t===s.ChartType.xyScatterLines||t===s.ChartType.xyScatterLinesNoMarkers||t===s.ChartType.xyScatterSmooth||t===s.ChartType.xyScatterSmoothNoMarkers||t===s.ChartType.radar||t===s.ChartType.radarMarkers},E.IsMarkerSeries=function(t){return t===s.ChartType.lineMarkers||t===s.ChartType.lineMarkersStacked||t===s.ChartType.lineMarkersStacked100||t===s.ChartType.radarMarkers||t===s.ChartType.xyScatter||t===s.ChartType.xyScatterLines||t===s.ChartType.xyScatterSmooth},E.IsErrorBarSeries=function(t){return!E.Is3DChart(t)&&(E.IsBarChart(t)||E.IsAreaChart(t)||E.IsLineChart(t)||E.IsColumnChart(t)||E.IsScatterChart(t)||E.IsBubbleChart(t))},E.IsTrendlineSeries=function(t){return!E.Is3DChart(t)&&!E.IsStackedChart(t)&&(t===s.ChartType.barClustered||t===s.ChartType.columnClustered||t===s.ChartType.line||t===s.ChartType.lineMarkers||t===s.ChartType.area||E.IsScatterChart(t)||E.IsBubbleChart(t))},E.IsFillSeries=function(t){return!this.IsLineSeries(t)&&t!==s.ChartType.xyScatter},E.IsAreaChart=function(t){return 0<=E.Tft(t).indexOf("area")},E.IsScatterChart=function(t){return 0<=E.Tft(t).indexOf("scatter")},E.IsSurfaceChart=function(t){return 0<=E.Tft(t).indexOf("surface")},E.IsBubbleChart=function(t){return 0<=E.Tft(t).indexOf("bubble")},E.IsSmoothLine=function(t){return 0<=E.Tft(t).indexOf("smooth")},E.Is3DChart=function(t){var n=E.Tft(t);return 0<=n.indexOf("3d")&&t!==s.ChartType.bubble3DEffect||this.IsSurfaceChart(t)||0<=n.indexOf("cylinder")||0<=n.indexOf("cone")||0<=n.indexOf("pyramid")},E.IsSurface3DChart=function(t){return t===s.ChartType.surface||t===s.ChartType.surfaceWireframe},E.IsDoughnutChart=function(t){return t===s.ChartType.doughnut||t===s.ChartType.doughnutExploded},E.IsExplodedChart=function(t){return t===s.ChartType.pieExploded3D||t===s.ChartType.doughnutExploded||t===s.ChartType.pieExploded},E.HasSeriesAx=function(t){return t===s.ChartType.column3D||t===s.ChartType.area3D||t===s.ChartType.line3D||this.IsSurfaceChart(t)},E.IsStockChart=function(t){return 0<=E.Tft(t).indexOf("stock")},E.IsTreeMap=function(t){return t===s.ChartType.treemap},E.IsSunburstChart=function(t){return t===s.ChartType.sunburst},E.IsSunburstOrTreemapChart=function(t){return E.IsTreeMap(t)||E.IsSunburstChart(t)},E.IsStockHLC=function(t){return t===s.ChartType.stockHLC},E.IsBuiltInComboChart=function(t){return this.IsStockChart(t)},E.IsComboChart=function(t){return t===s.ChartType.combo},E.ConvertToTextUnderlineType=function(t){var n=s.TextUnderlineType.None;return t===s.UnderlineType.Single?n=s.TextUnderlineType.Single:t===s.UnderlineType.Double&&(n=s.TextUnderlineType.Double),n},E.ToUnderlineType=function(t){var n=s.UnderlineType.None;return t===s.TextUnderlineType.Single?n=s.UnderlineType.Single:t===s.TextUnderlineType.Double&&(n=s.UnderlineType.Double),n},E.MapToGroupType=function(t){var n;return{12:9,13:9,14:9,15:3,16:3,17:3,6:3,18:8,19:8,20:8,21:2,22:2,23:2,9:11,24:11,25:11,26:11,27:11,28:11,5:4,10:12,29:12,30:12,32:12,31:5,4:5,1:14,33:14,34:14,35:14,36:14,8:7,37:7,38:7,39:1,40:1,7:1,3:10,41:10,2:13,42:13,43:13,44:6,45:6,46:6,47:6,11:14,48:14,49:11,50:11,51:11,52:11}[t]||V.UnKnown},E.HasSeriesLines=function(t){return this.IsOfPieChart(t)},E.HasHiLoLines=function(t){return this.IsStockChart(t)},E.HasUpDownBars=function(t){return t===s.ChartType.stockOHLC||t===s.ChartType.stockVOHLC},E.RangeToReferences=function(t){for(var n,e,i,r,n=[],e=0,i=t.Areas;e<i.length;e++)r=i[e],n.push(E.CreateReference(r.Worksheet.name(),r.Row,r.Column,r.RowCount,r.ColumnCount));return n},E.CreateReference=function(t,n,e,i,r){return 1===i&&1===r?new C(t,n,e):new C(t,n,e,n+i-1,e+r-1)},E.ReferencesToFormula=function(t,n){var e,i;if(n===f&&(n=!1),M.isNullOrUndefined(t)||0===t.length)return l;for(e=[],i=0;i<t.length;i++)0<i&&e.push(","),e.push(n?t[i].ToR1C1Text():t[i].ToA1Text(0,0));return e.join("")},E.getRangeInfoByFormula=function(t,n){var e,n,i,t;return n&&(n=(e=(0,o.formulaToRanges)(t,n,0,0))[0])&&(t=(i=t.parent).getSheetFromName(n.sheetName))?{sheet:t,range:n.ranges&&n.ranges[0]}:{range:{}}},E.isContinuousRange=function(t,n,e){if(t.sheet!==n.sheet)return!1;var i,r,o,e,a,u,s,r,s,e;if(e){if(o=(i=t.range).rowCount,e=i.col,a=i.colCount,r=(u=n.range).rowCount,s=u.col,o===r&&e+a===s)return!0}else if(o=(i=t.range).rowCount,r=i.row,a=i.colCount,e=(u=n.range).colCount,s=i.row,a===e&&r+o===s)return!0},E.GetValuesFromCellRefers=function(t,n,e){var i,r,o,a,a,i=[];if(!M.isNullOrUndefined(n)&&0!==n.length&&!n.some(function(t){return t.IsError}))for(r=0,o=n;r<o.length;r++)a=o[r],a=this.GetValuesFromCellRefer(t,a,e),M.isNullOrUndefined(a)||i.push(a);return i},E.GetValuesFromCellRefer=function(t,n,e){var t,i,t=t.Mnn(n.WorksheetName);return M.isNullOrUndefined(t)?l:e?t._nn(n.Row,n.Column,n.RowCount,n.ColumnCount,!0):t.ynn(n.Row,n.Column,n.RowCount,n.ColumnCount,!0)},E.GetStylesFromCellRefers=function(t,n,e){var i,r,o,a,a,i=[];if(!M.isNullOrUndefined(n)&&0!==n.length&&!n.some(function(t){return t.IsError}))for(r=0,o=n;r<o.length;r++)a=o[r],a=this.GetStylesFromCellRefer(t,a,e),M.isNullOrUndefined(a)||i.push(a);return i},E.GetStylesFromCellRefer=function(t,n,e){var t,i,t=t.Mnn(n.WorksheetName);return M.isNullOrUndefined(t)?l:e?t.pnn(n.Row,n.Column,n.RowCount,n.ColumnCount):t.Onn(n.Row,n.Column,n.RowCount,n.ColumnCount)},E.GetPrimaryAxises=function(t){var n,e,i,r,n=[],e=t.axes.length;if(t.axes&&0<e)for(i=0;i<e;i++)r=t.axes[i],M.isNullOrUndefined(r.AxisGroup)?2<e?0!==i&&1!==i||(n.push(r.axId),n.push(r.crossAx),n.axisGroup=r.AxisGroup):0===i&&(n.push(r.axId),n.push(r.crossAx),n.axisGroup=r.AxisGroup):0===r.AxisGroup&&(n.push(r.axId),n.push(r.crossAx),n.axisGroup=r.AxisGroup);return n},E.GetSJSPrimaryAxises=function(t){var n=[];return t.valAx&&(Array.isArray(t.valAx)?(n.push(t.valAx[0].axId.val),n.push(t.valAx[0].crossAx.val)):(n.push(t.valAx.axId.val),n.push(t.valAx.crossAx.val))),n},E.GetSJSSecondaryAxises=function(t){var n,e,n=[];return t.valAx&&Array.isArray(t.valAx)&&(e=t.valAx.length,n.push(t.valAx[e-1].axId.val),n.push(t.valAx[e-1].crossAx.val)),n},E.GetAxises=function(t,n){var e,i,r,o,a,u,e=E.GetPrimaryAxises(t);if(n===s.AxisGroup.primary)return e;if(i=[],!M.isNullOrUndefined(t.axes))for(o=0,a=r=t.axes.filter(function(t){return e.indexOf(t.axId)<0});o<a.length;o++)u=a[o],i.push(u.axId);return i},E.GetSJSAxises=function(t,n){var e=E.GetSJSPrimaryAxises(t);return n===s.AxisGroup.primary?e:E.GetSJSSecondaryAxises(t)},E.GetCategoryAxises=function(t){for(var n,e,i,r,n=[],e=0,i=t.chartGroups;e<i.length;e++)r=i[e],!M.isNullOrUndefined(r.axId)&&0<r.axId.length&&n.push(r.axId[0]);return n},E.GetSJSCategoryAxises=function(t){for(var n,e,i,r,o,n=[],e,i=0,r=E.GetSJS_ChartGroups(t);i<r.length;i++)(o=[].concat(r[i])).forEach(function(t){!M.isNullOrUndefined(t)&&!M.isNullOrUndefined(t.axId)&&0<t.axId.length&&n.push(t.axId.val||t.axId[0].val)});return n},E.GetIs2016ChartByPlotArea=function(t){var n;return!!E.Get2016ChartType(t)},E.GetIs2016ChartByChartType=function(t){return 53===t||54===t||55===t||56===t||57===t||58===t||59===t||60===t},E.GetSJS2016ChartType=function(t){var t,n,t=t&&t.plotAreaRegion&&t.plotAreaRegion.series;return n=(t=t&&[].concat(t))&&0<t.length?s.SeriesType[t[0].layoutId]:n},E.Get2016ChartType=function(t){var t,n,t=t&&t.plotAreaRegion&&t.plotAreaRegion.series;return n=t&&0<t.length?t[0].layoutId:n},E.GetChartType=function(t){var n,n,e,i,r,o,o,n=E.Get2016ChartType(t);if(n)return E.GetChartTypeBy2016InnerChartType(n);if(n=this.GetStockChartType(t),!M.isNullOrUndefined(n))return n;for(e=[],i=0,r=t.chartGroups;i<r.length;i++)o=r[i],o=E.GetChartTypeByChartBase(o),e.indexOf(o)<0&&e.push(o);return 0===e.length?s.ChartType.columnClustered:1<e.length?s.ChartType.combo:e[0]},E.GetSJSChartType=function(t){var n,n,t,n=E.GetSJS2016ChartType(t);return n?E.GetChartTypeBy2016InnerChartType(n):(n=this.GetSJS_StockChartType(t),M.isNullOrUndefined(n)?1<(t=E.GetSJS_ChartTypeByChartGroupBase(t)).length?s.ChartType.combo:t[0]:n)},E.GetStockChartType=function(t){var n=E.GetStockChart(t);if(0!==n.length)if(!M.isNullOrUndefined(t.chartGroups)&&1<t.chartGroups.length){if(3===n[0].ser.length)return s.ChartType.stockVHLC;if(4===n[0].ser.length)return s.ChartType.stockVOHLC}else{if(3===n[0].ser.length)return s.ChartType.stockHLC;if(4===n[0].ser.length)return s.ChartType.stockOHLC}return l},E.GetSJS_ChartGroups=function(t){var n;return[t.area3DChart,t.areaChart,t.bar3DChart,t.barChart,t.bubbleChart,t.doughnutChart,t.line3DChart,t.lineChart,t.ofPieChart,t.pie3DChart,t.pieChart,t.radarChart,t.scatterChart,t.stockChart,t.surface3DChart,t.surfaceChart].filter(function(t){return!M.isNullOrUndefined(t)})},E.GetSJS_StockChartType=function(t){var n,n,n=t.stockChart;if(!M.isNullOrUndefined(n)&&n.ser)if(n=[].concat(n.ser).length,1<E.GetSJS_ChartGroups(t).length){if(3===n)return s.ChartType.stockVHLC;if(4===n)return s.ChartType.stockVOHLC}else{if(3===n)return s.ChartType.stockHLC;if(4===n)return s.ChartType.stockOHLC}return l},E.GetChartTypeByChartBase=function(t,n){return n===f&&(n=l),t.chartType===s.CT_ChartType.CT_BarChart||t.chartType===s.CT_ChartType.CT_Bar3DChart?E.GetChartTypeByBarChart(t):t.chartType===s.CT_ChartType.CT_AreaChart||t.chartType===s.CT_ChartType.CT_Area3DChart?E.GetChartTypeByAreaChart(t):t.chartType===s.CT_ChartType.CT_LineChart||t.chartType===s.CT_ChartType.CT_Line3DChart?E.GetChartTypeByLineChart(t):0<=[s.CT_ChartType.CT_PieChart,s.CT_ChartType.CT_Pie3DChart,s.CT_ChartType.CT_DoughnutChart,s.CT_ChartType.CT_OfPieChart].indexOf(t.chartType)?E.GetChartTypeByPieChart(t):t.chartType===s.CT_ChartType.CT_RadarChart?E.GetChartTypeByRadarChart(t,n):t.chartType===s.CT_ChartType.CT_ScatterChart?E.GetChartTypeByScatterChart(t,n):t.chartType===s.CT_ChartType.CT_BubbleChart?E.GetChartTypeByBubbleChart(t):t.chartType===s.CT_ChartType.CT_SurfaceChart||t.chartType===s.CT_ChartType.CT_Surface3DChart?E.GetChartTypeBySurfaceChart(t):s.ChartType.columnClustered},E.GetSJS_ChartTypeByChartGroupBase=function(t,n){var e=[];return t.barChart&&e.push(E.GetSJSChartTypeByBarChart(t.barChart)),t.bar3DChart&&e.push(E.GetSJSChartTypeByBarChart(t.bar3DChart,!0)),t.areaChart&&e.push(E.GetSJSChartTypeByAreaChart(t.areaChart)),t.area3DChart&&e.push(E.GetSJSChartTypeByAreaChart(t.area3DChart,!0)),t.lineChart&&e.push(E.GetSJSChartTypeByLineChart(t.lineChart)),t.line3DChart&&e.push(E.GetSJSChartTypeByLineChart(t.line3DChart,!0)),t.radarChart&&e.push(E.GetSJSChartTypeByRadarChart(t.radarChart,n)),t.scatterChart&&e.push(E.GetSJSChartTypeByScatterChart(t.scatterChart,n)),t.pieChart&&e.push(s.ChartType.pie),t.pie3DChart&&e.push(s.ChartType.pie3D),t.doughnutChart&&e.push(s.ChartType.doughnut),t.ofPieChart&&e.push(t.ofPieChart.ofPieType&&t.ofPieChart.ofPieType.val===s.ST_OfPieType[1]?s.ChartType.barOfPie:s.ChartType.pieOfPie),t.surfaceChart&&e.push(E.GetSJSChartTypeBySurfaceChart(t.surfaceChart)),t.surface3DChart&&e.push(E.GetSJSChartTypeBySurfaceChart(t.surface3DChart,!0)),t.bubbleChart&&e.push(E.GetSJSChartTypeByBubbleChart(t.bubbleChart)),0<e.length?e:[s.ChartType.columnClustered]},E.GetSJS_SeriesChartTypeByChartBase=function(t,n){return n===f&&(n=l),t.chartType===s.CT_ChartType.CT_BarChart||t.chartType===s.CT_ChartType.CT_Bar3DChart?E.GetSJSChartTypeByBarChart(t,t.chartType===s.CT_ChartType.CT_Bar3DChart):t.chartType===s.CT_ChartType.CT_AreaChart||t.chartType===s.CT_ChartType.CT_Area3DChart?E.GetSJSChartTypeByAreaChart(t,t.chartType===s.CT_ChartType.CT_Area3DChart):t.chartType===s.CT_ChartType.CT_LineChart||t.chartType===s.CT_ChartType.CT_Line3DChart?E.GetSJSChartTypeByLineChart(t,t.chartType===s.CT_ChartType.CT_Line3DChart):0<=[s.CT_ChartType.CT_PieChart,s.CT_ChartType.CT_Pie3DChart,s.CT_ChartType.CT_DoughnutChart,s.CT_ChartType.CT_OfPieChart].indexOf(t.chartType)?E.GetChartTypeByPieChart(t,!0):t.chartType===s.CT_ChartType.CT_RadarChart?E.GetSJSChartTypeByRadarChart(t,n):t.chartType===s.CT_ChartType.CT_ScatterChart?E.GetSJSChartTypeByScatterChart(t,n):t.chartType===s.CT_ChartType.CT_BubbleChart?E.GetSJSChartTypeByBubbleChart(t):t.chartType===s.CT_ChartType.CT_SurfaceChart||t.chartType===s.CT_ChartType.CT_Surface3DChart?E.GetSJSChartTypeBySurfaceChart(t,t.chartType===s.CT_ChartType.CT_Surface3DChart):s.ChartType.columnClustered},E.GetChartTypeBy2016InnerChartType=function(t){if(!M.isNullOrUndefined(t))switch(t){case s.CT_ChartType.CT_BoxWhisker:return s.ChartType.boxWhisker;case s.CT_ChartType.CT_Funnel:return s.ChartType.funnel;case s.CT_ChartType.CT_ParetoLine:return s.ChartType.paretoLine;case s.CT_ChartType.CT_RegionMap:return s.ChartType.regionMap;case s.CT_ChartType.CT_Sunburst:return s.ChartType.sunburst;case s.CT_ChartType.CT_Treemap:return s.ChartType.treemap;case s.CT_ChartType.CT_Waterfall:return s.ChartType.waterfall;case s.CT_ChartType.CT_ClusteredColumn:return s.ChartType.clusteredColumn}return s.CT_ChartType.CT_Treemap},E.Get2016InnerChartTypeByChartType=function(t){if(!M.isNullOrUndefined(t))switch(t){case s.ChartType.boxWhisker:return s.CT_ChartType.CT_BoxWhisker;case s.ChartType.funnel:return s.CT_ChartType.CT_Funnel;case s.ChartType.paretoLine:return s.CT_ChartType.CT_ParetoLine;case s.ChartType.regionMap:return s.CT_ChartType.CT_RegionMap;case s.ChartType.sunburst:return s.CT_ChartType.CT_Sunburst;case s.ChartType.treemap:return s.CT_ChartType.CT_Treemap;case s.ChartType.waterfall:return s.CT_ChartType.CT_Waterfall;case s.ChartType.clusteredColumn:return s.CT_ChartType.CT_ClusteredColumn}return s.CT_ChartType.CT_Treemap},E.GetChartTypeByBarChart=function(t){var n=t.chartType===s.CT_ChartType.CT_Bar3DChart||!M.isNullOrUndefined(t.shape);if(M.isNullOrUndefined(t.grouping))return n?t.barDir===s.ST_BarDir.bar?s.ChartType.barClustered3D:s.ChartType.columnClustered3D:t.barDir===s.ST_BarDir.bar?s.ChartType.barClustered:s.ChartType.columnClustered;switch(t.grouping){case s.ST_BarGrouping.percentStacked:return n?t.barDir===s.ST_BarDir.bar?s.ChartType.barStacked1003D:s.ChartType.columnStacked1003D:t.barDir===s.ST_BarDir.bar?s.ChartType.barStacked100:s.ChartType.columnStacked100;case s.ST_BarGrouping.clustered:return n?t.barDir===s.ST_BarDir.bar?s.ChartType.barClustered3D:s.ChartType.columnClustered3D:t.barDir===s.ST_BarDir.bar?s.ChartType.barClustered:s.ChartType.columnClustered;case s.ST_BarGrouping.standard:return n?t.barDir===s.ST_BarDir.bar?s.ChartType.barClustered3D:s.ChartType.column3D:t.barDir===s.ST_BarDir.bar?s.ChartType.barClustered:s.ChartType.columnClustered;case s.ST_BarGrouping.stacked:return n?t.barDir===s.ST_BarDir.bar?s.ChartType.barStacked3D:s.ChartType.columnStacked3D:t.barDir===s.ST_BarDir.bar?s.ChartType.barStacked:s.ChartType.columnStacked}return s.ChartType.columnClustered},E.GetSJSChartTypeByBarChart=function(t,n){var t,e,i,n,t=[].concat(t)[0],e=!!n,i=s.ST_BarDir[t.barDir.val],n=t.grouping&&t.grouping.val;if(M.isNullOrUndefined(n))return e?i===s.ST_BarDir.bar?s.ChartType.barClustered3D:s.ChartType.columnClustered3D:i===s.ST_BarDir.bar?s.ChartType.barClustered:s.ChartType.columnClustered;switch(s.ST_BarGrouping[n]){case s.ST_BarGrouping.percentStacked:return e?i===s.ST_BarDir.bar?s.ChartType.barStacked1003D:s.ChartType.columnStacked1003D:i===s.ST_BarDir.bar?s.ChartType.barStacked100:s.ChartType.columnStacked100;case s.ST_BarGrouping.clustered:return e?i===s.ST_BarDir.bar?s.ChartType.barClustered3D:s.ChartType.columnClustered3D:i===s.ST_BarDir.bar?s.ChartType.barClustered:s.ChartType.columnClustered;case s.ST_BarGrouping.standard:return e?i===s.ST_BarDir.bar?s.ChartType.barClustered3D:s.ChartType.column3D:i===s.ST_BarDir.bar?s.ChartType.barClustered:s.ChartType.columnClustered;case s.ST_BarGrouping.stacked:return e?i===s.ST_BarDir.bar?s.ChartType.barStacked3D:s.ChartType.columnStacked3D:i===s.ST_BarDir.bar?s.ChartType.barStacked:s.ChartType.columnStacked}return s.ChartType.columnClustered},E.GetChartTypeByAreaChart=function(t){var n=t.chartType===s.CT_ChartType.CT_Area3DChart;if(M.isNullOrUndefined(t.grouping))return n?s.ChartType.area3D:s.ChartType.area;switch(t.grouping){case s.ST_Grouping.percentStacked:return n?s.ChartType.areaStacked1003D:s.ChartType.areaStacked100;case s.ST_Grouping.standard:return n?s.ChartType.area3D:s.ChartType.area;case s.ST_Grouping.stacked:return n?s.ChartType.areaStacked3D:s.ChartType.areaStacked}return s.ChartType.area},E.GetSJSChartTypeByAreaChart=function(t,n){var t,e,n,t=[].concat(t)[0],e=!!n,n=t.grouping&&t.grouping.val;if(M.isNullOrUndefined(n))return e?s.ChartType.area3D:s.ChartType.area;switch(s.ST_Grouping[n]){case s.ST_Grouping.percentStacked:return e?s.ChartType.areaStacked1003D:s.ChartType.areaStacked100;case s.ST_Grouping.standard:return e?s.ChartType.area3D:s.ChartType.area;case s.ST_Grouping.stacked:return e?s.ChartType.areaStacked3D:s.ChartType.areaStacked}return s.ChartType.area},E.GetChartTypeByLineChart=function(t){var n,e,n=t.chartType===s.CT_ChartType.CT_Line3DChart,e=t.marker;if(M.isNullOrUndefined(t.grouping)){if(n)return s.ChartType.line3D}else switch(t.grouping){case s.ST_Grouping.percentStacked:return n?s.ChartType.line3D:e?s.ChartType.lineMarkersStacked100:s.ChartType.lineStacked100;case s.ST_Grouping.standard:return n?s.ChartType.line3D:e?s.ChartType.lineMarkers:s.ChartType.line;case s.ST_Grouping.stacked:return n?s.ChartType.line3D:e?s.ChartType.lineMarkersStacked:s.ChartType.lineStacked;default:return s.ChartType.area}return e?s.ChartType.lineMarkers:s.ChartType.line},E.GetSJSChartTypeByLineChart=function(t,n){var t,e,i,n,t=[].concat(t)[0],e=!!n,i=r.NodeHelper.ur(t.marker&&t.marker.val),n=t.grouping&&t.grouping.val;if(M.isNullOrUndefined(n)){if(e)return s.ChartType.line3D}else switch(s.ST_Grouping[n]){case s.ST_Grouping.percentStacked:return e?s.ChartType.line3D:i?s.ChartType.lineMarkersStacked100:s.ChartType.lineStacked100;case s.ST_Grouping.standard:return e?s.ChartType.line3D:i?s.ChartType.lineMarkers:s.ChartType.line;case s.ST_Grouping.stacked:return e?s.ChartType.line3D:i?s.ChartType.lineMarkersStacked:s.ChartType.lineStacked;default:return s.ChartType.area}return i?s.ChartType.lineMarkers:s.ChartType.line},E.GetChartTypeByPieChart=function(t,n){var e,i;return t.chartType===s.CT_ChartType.CT_PieChart?s.ChartType.pie:t.chartType===s.CT_ChartType.CT_Pie3DChart?s.ChartType.pie3D:t.chartType===s.CT_ChartType.CT_OfPieChart?(i=t.ofPieType,(i=n?s.ST_OfPieType[t.ofPieType&&t.ofPieType.val]:i)===s.ST_OfPieType.bar?s.ChartType.barOfPie:s.ChartType.pieOfPie):t.chartType===s.CT_ChartType.CT_DoughnutChart?s.ChartType.doughnut:s.ChartType.pie},E.GetChartTypeByRadarChart=function(t,n){var e=n&&n.marker&&n.marker.symbol&&n.marker.symbol===s.MarkerStyle.MarkerStyleNone;if(!M.isNullOrUndefined(t.radarStyle))switch(t.radarStyle){case s.ST_RadarStyle.standard:case s.ST_RadarStyle.marker:return e?s.ChartType.radar:s.ChartType.radarMarkers;case s.ST_RadarStyle.filled:return s.ChartType.radarFilled}return 2},E.GetSJSChartTypeByRadarChart=function(t,n){var t,e,t=[].concat(t)[0],e=n&&n.marker&&n.marker.symbol&&n.marker.symbol&&n.marker.symbol.val===s.SymbolShape[4];if(!M.isNullOrUndefined(t.radarStyle))switch(s.ST_RadarStyle[t.radarStyle.val]){case s.ST_RadarStyle.standard:case s.ST_RadarStyle.marker:return e?s.ChartType.radar:s.ChartType.radarMarkers;case s.ST_RadarStyle.filled:return s.ChartType.radarFilled}return 2},E.GetChartTypeByScatterChart=function(t,n){var e,i,e,n,r,t,n,n,e=t.scatterStyle;return M.isNullOrUndefined(e)?s.ChartType.xyScatter:(i={0:1,1:36,2:35,3:s.ChartType.xyScatter,4:34,5:33},t=4===(r=(n=n||t.ser[0])&&n.marker&&n.marker.symbol),n=(n=n&&n.spPr&&n.spPr.ln)&&n.noFill,2===(e=e)?n?e=3:t&&(e=1):5===e&&t&&(e=4),i[e])},E.GetSJSChartTypeByScatterChart=function(t,n){var t,e,i,e,n,t,t,n,n,t=[].concat(t)[0],e=t.scatterStyle&&t.scatterStyle.val;return M.isNullOrUndefined(e)?s.ChartType.xyScatter:(i={0:1,1:36,2:35,3:s.ChartType.xyScatter,4:34,5:33},e=s.ST_ScatterStyle[e],t=(n=n||t.ser[0])&&n.marker&&n.marker.symbol&&n.marker.symbol.val,t=4===s.ST_MarkerStyle[t],n=(n=n&&n.spPr&&n.spPr.ln)&&n.noFill,2===e?n?e=3:t&&(e=1):5===e&&t&&(e=4),i[e])},E.GetChartTypeByBubbleChart=function(t){return t.bubble3D?s.ChartType.bubble3DEffect:s.ChartType.bubble},E.GetSJSChartTypeByBubbleChart=function(t){var n;return(n=t.bubble3D?r.NodeHelper.ur(t.bubble3D.val):n)?s.ChartType.bubble3DEffect:s.ChartType.bubble},E.GetChartTypeBySurfaceChart=function(t){var n;return t.chartType===s.CT_ChartType.CT_Surface3DChart?t.wireframe?s.ChartType.surfaceWireframe:s.ChartType.surface:t.wireframe?s.ChartType.surfaceTopViewWireframe:s.ChartType.surfaceTopView},E.GetSJSChartTypeBySurfaceChart=function(t,n){return n?r.NodeHelper.ur(t.wireframe&&t.wireframe.val)?s.ChartType.surfaceWireframe:s.ChartType.surface:r.NodeHelper.ur(t.wireframe&&t.wireframe.val)?s.ChartType.surfaceTopViewWireframe:s.ChartType.surfaceTopView},E.GetTextFieldTypeString=function(t){var n;return{0:e.ChartConstants.FIELD_TYPE_CELLRANGE,1:e.ChartConstants.FIELD_TYPE_SERIESNAME,2:e.ChartConstants.FIELD_TYPE_CATEGORYNAME,3:e.ChartConstants.FIELD_TYPE_VALUE,4:e.ChartConstants.FIELD_TYPE_XVALUE,5:e.ChartConstants.FIELD_TYPE_YVALUE,6:e.ChartConstants.FIELD_TYPE_BUBBLESIZE,7:e.ChartConstants.FIELD_TYPE_PERCENTAGE,8:e.ChartConstants.FIELD_TYPE_TXLINK}[t]||""},E.GetTextFieldTypeText=function(t){var n;return{0:e.ChartConstants.FIELD_TEXT_CELLRANGE,1:e.ChartConstants.FIELD_TEXT_SERIESNAME,2:e.ChartConstants.FIELD_TEXT_CATEGORYNAME,3:e.ChartConstants.FIELD_TEXT_VALUE,4:e.ChartConstants.FIELD_TEXT_XVALUE,5:e.ChartConstants.FIELD_TEXT_YVALUE,6:e.ChartConstants.FIELD_TEXT_BUBBLESIZE}[t]||""},E.GetTextFieldType=function(t){var n=s.TextFieldType.CellRange;switch(t){case e.ChartConstants.FIELD_TYPE_CELLRANGE:n=s.TextFieldType.CellRange;break;case e.ChartConstants.FIELD_TYPE_SERIESNAME:n=s.TextFieldType.SeriesName;break;case e.ChartConstants.FIELD_TYPE_CATEGORYNAME:n=s.TextFieldType.CategoryName;break;case e.ChartConstants.FIELD_TYPE_VALUE:n=s.TextFieldType.Value;break;case e.ChartConstants.FIELD_TYPE_XVALUE:n=s.TextFieldType.XValue;break;case e.ChartConstants.FIELD_TYPE_YVALUE:n=s.TextFieldType.YValue;break;case e.ChartConstants.FIELD_TYPE_BUBBLESIZE:n=s.TextFieldType.BubbleSize;break;case e.ChartConstants.FIELD_TYPE_PERCENTAGE:n=s.TextFieldType.Percentage;break;case e.ChartConstants.FIELD_TYPE_TXLINK:n=s.TextFieldType.TxLink}return n},E.GetPrimaryPieChart=function(t){return t[0]},E.GetPlotAreaCharts=function(t,n){return t.chartGroups?t.chartGroups.filter(function(t){return t.chartType===n}):[]},E.GetSJSPlotAreaCharts=function(t,n){return M.isNullOrUndefined(t[n])?[]:[].concat(t[n])},E.GetAreaChart=function(t){return E.GetPlotAreaCharts(t,4)},E.GetSJSAreaChart=function(t){return E.GetSJSPlotAreaCharts(t,"areaChart")},E.GetArea3DChart=function(t){var t=E.GetPlotAreaCharts(t,5);return 0<t.length?t[0]:l},E.GetSJSArea3DChart=function(t){var t=E.GetSJSPlotAreaCharts(t,"area3DChart");return 0<t.length?t[0]:l},E.GetBarChart=function(t){return E.GetPlotAreaCharts(t,6)},E.GetSJSBarChart=function(t){return E.GetSJSPlotAreaCharts(t,"barChart")},E.GetBar3DChart=function(t){var t=E.GetPlotAreaCharts(t,7);return 0<t.length?t[0]:l},E.GetSJSBar3DChart=function(t){var t=E.GetSJSPlotAreaCharts(t,"bar3DChart");return 0<t.length?t[0]:l},E.GetLineChart=function(t){return E.GetPlotAreaCharts(t,8)},E.GetSJSLineChart=function(t){return E.GetSJSPlotAreaCharts(t,"lineChart")},E.GetLine3DChart=function(t){var t=E.GetPlotAreaCharts(t,9);return 0<t.length?t[0]:l},E.GetSJSLine3DChart=function(t){var t=E.GetSJSPlotAreaCharts(t,"line3DChart");return 0<t.length?t[0]:l},E.GetStockChart=function(t){return E.GetPlotAreaCharts(t,0)},E.GetSJSStockChart=function(t){return E.GetSJSPlotAreaCharts(t,"stockChart")},E.GetRadarChart=function(t){return E.GetPlotAreaCharts(t,2)},E.GetSJSRadarChart=function(t){return E.GetSJSPlotAreaCharts(t,"radarChart")},E.GetScatterChart=function(t){return E.GetPlotAreaCharts(t,1)},E.GetSJSScatterChart=function(t){return E.GetSJSPlotAreaCharts(t,"scatterChart")},E.GetPieCharts=function(t){var n=[10,11,12,13];return t.chartGroups?t.chartGroups.filter(function(t){return 0<=n.indexOf(t.chartType)}):[]},E.GetPieChart=function(t){return E.GetPlotAreaCharts(t,10)},E.GetSJSPieChart=function(t){return E.GetSJSPlotAreaCharts(t,"pieChart")},E.GetPie3DChart=function(t){var t=E.GetPlotAreaCharts(t,11);return 0<t.length?t[0]:l},E.GetSJSPie3DChart=function(t){var t=E.GetSJSPlotAreaCharts(t,"pie3DChart");return 0<t.length?t[0]:l},E.GetDoughnutChart=function(t){return E.GetPlotAreaCharts(t,12)},E.GetSJSDoughnutChart=function(t){return E.GetSJSPlotAreaCharts(t,"doughnutChart")},E.GetOfPieChart=function(t){return E.GetPlotAreaCharts(t,13)},E.GetSJSOfPieChart=function(t){return E.GetSJSPlotAreaCharts(t,"ofPieChart")},E.GetSurfaceChart=function(t){return E.GetSurface3DChartOrChart(t,14)},E.GetSJSSurfaceChart=function(t){return E.GetSJSSurface3DChartOrChart(t,"surfaceChart")},E.GetSurface3DChart=function(t){return E.GetSurface3DChartOrChart(t,15)},E.GetSJSSurface3DChart=function(t){return E.GetSJSSurface3DChartOrChart(t,"surface3DChart")},E.GetSurface3DChartOrChart=function(t,n){var t=E.GetPlotAreaCharts(t,n);return 0<t.length?t[0]:l},E.GetSJSSurface3DChartOrChart=function(t,n){var t=E.GetSJSPlotAreaCharts(t,n);return 0<t.length?t[0]:l},E.GetBubbleChart=function(t){return E.GetPlotAreaCharts(t,3)},E.GetSJSBubbleChart=function(t){return E.GetSJSPlotAreaCharts(t,"bubbleChart")},E.GetAxes=function(t,n){return t.axes.filter(function(t){return t.axisType===n})},E.removeEmptyArrayProperties=function(t){var n,e;for(n in t)t.hasOwnProperty(n)&&(void 0===(e=t[n])||Array.isArray(e)&&0===e.length)&&delete t[n]},E.allSeriesIsScatterOrBubble=function(t){var n,e,i,n,r,n=t.ChartType;if(E.IsBubbleChart(n)||E.IsScatterChart(n))return!0;if(0===n&&0<(i=(e=t.SeriesCollection.AllSers).length)){if(n=e[0].ChartType,r=void 0,E.IsBubbleChart(n)){for(r=1;r<i;r++)if(!E.IsBubbleChart(e[r].ChartType))return!1;return!0}if(E.IsScatterChart(n)){for(r=1;r<i;r++)if(!E.IsScatterChart(e[r].ChartType))return!1;return!0}}return!1},E.getLineFormatInfo=function(t,n,e,i,r){var t,o,a,o,t=t&&t.Format&&t.Format.Line;return t?(a={},0<=(o=t.Weight)&&(a.width=o),o=E.colorFormatToString(t,n,e,i),e||(a.transparency=E.getTransparencyFromColorFormat(t,r)),(o||""===o&&i)&&(a.color=o),M.isNullOrUndefined(t.DashStyle)||(a.dashStyle=t.DashStyle),a):l},E.isSupportConnectedLineChartType=function(t){return t===s.ChartType.line||t===s.ChartType.lineMarkers||t===s.ChartType.xyScatterLines||t===s.ChartType.xyScatterLinesNoMarkers||t===s.ChartType.xyScatterSmooth||t===s.ChartType.xyScatterSmoothNoMarkers},E.isSupportConnected=function(t,n){var e,i,r;if(E.isSupportConnectedLineChartType(t)||E.IsRadarChart(t))return!0;if(0===t)for(e=n.SeriesCollection.AllSers,i=0;i<e.length;i++)if(r=e[i].ChartType,E.isSupportConnectedLineChartType(r)||E.IsRadarChart(r))return!0;return!1},E.isSupportGaps=function(t){return t!==s.ChartType.sunburst&&t!==s.ChartType.treemap&&t!==s.ChartType.lineMarkersStacked&&t!==s.ChartType.lineMarkersStacked100&&t!==s.ChartType.lineStacked&&t!==s.ChartType.lineStacked100},E.IsDatesOrTimesNumberFormat=function(t){var n,e,i,r,o,a,u,s;if(!t||0===t.length)return!1;if("["===(t=t.toUpperCase().trim())[0]){if(-1===(n=t.indexOf("]"))||n===t.length-1)return!1;t=t.substr(n+1)}for(r=!(e=-1),o=l,a=i=0;a<t.length;a++){if("["===(s=t[a]))for(;s=t[a],++a<t.length&&"]"!==s;);if("Y"===s||"D"===s||"M"===s||"H"===s||"S"===s)r?i++:0!==a&&"\\"===t[a-1]||(r=!0,e=a,i=1);else{if(r=!1," "===s&&o)return!0;0!==i&&(u=t.substr(e,i),e=a,i=0,o=(M.isNullOrUndefined(o)||o)&&E.IsValidDateOrTimeFormatPattern(u))}}return 0!==i&&a===t.length&&(u=t.substr(e,i),o=(M.isNullOrUndefined(o)||o)&&E.IsValidDateOrTimeFormatPattern(u)),o},E.IsValidDateOrTimeFormatPattern=function(t){var n,e,i,r,o,a,n={Y:4,D:4,M:5,H:2,S:2};if(!t)return!1;for(e={},i=0;i<t.length;i++)e[r=t[i]]=e[r]?e[r]+1:1;for(o in e)if(e.hasOwnProperty(o)){if(void 0===(a=n[o]))return!1;if(a<e[o])return!1}return!0},E.ToPatternType=function(t){var n=0;switch(t){case 0:n=1;break;case 1:n=2;break;case 2:n=3;break;case 3:n=4;break;case 4:n=5;break;case 5:n=6;break;case 6:n=7;break;case 7:n=8;break;case 8:n=9;break;case 9:n=10;break;case 10:n=11;break;case 11:n=12;break;case 16:n=13;break;case 17:n=14;break;case 27:n=15;break;case 28:n=16;break;case 34:n=17;break;case 52:n=18;break;case 14:n=19;break;case 15:n=20;break;case 25:n=21;break;case 26:n=22;break;case 36:n=23;break;case 45:n=24;break;case 29:n=25;break;case 30:n=26;break;case 32:n=27;break;case 31:n=28;break;case 19:n=29;break;case 18:n=30;break;case 21:n=31;break;case 20:n=32;break;case 40:n=33;break;case 37:n=34;break;case 41:n=35;break;case 35:n=36;break;case 39:n=37;break;case 53:n=38;break;case 43:n=39;break;case 42:n=40;break;case 44:n=41;break;case 46:n=42;break;case 47:n=43;break;case 48:n=44;break;case 38:n=45;break;case 49:n=46;break;case 50:n=47;break;case 51:n=48;break;case 12:n=49;break;case 13:n=50;break;case 22:n=51;break;case 23:n=52;break;case 24:n=53;break;case 33:n=54}return n},E.ToST_PresetPatternVal=function(t){var n=0;switch(t){case 2:n=1;break;case 3:n=2;break;case 4:n=3;break;case 5:n=4;break;case 6:n=5;break;case 7:n=6;break;case 8:n=7;break;case 9:n=8;break;case 10:n=9;break;case 11:n=10;break;case 12:n=11;break;case 13:n=16;break;case 14:n=17;break;case 15:n=27;break;case 16:n=28;break;case 17:n=34;break;case 18:n=52;break;case 19:n=14;break;case 20:n=15;break;case 21:n=25;break;case 22:n=26;break;case 23:n=36;break;case 24:n=45;break;case 25:n=29;break;case 26:n=30;break;case 27:n=32;break;case 28:n=31;break;case 29:n=19;break;case 30:n=18;break;case 31:n=21;break;case 32:n=20;break;case 33:n=40;break;case 34:n=37;break;case 35:n=41;break;case 36:n=35;break;case 37:n=39;break;case 38:n=53;break;case 39:n=43;break;case 40:n=42;break;case 41:n=44;break;case 42:n=46;break;case 43:n=47;break;case 44:n=48;break;case 45:n=38;break;case 46:n=49;break;case 47:n=50;break;case 48:n=51;break;case 49:n=12;break;case 50:n=13;break;case 51:n=22;break;case 52:n=23;break;case 53:n=24;break;case 54:n=33}return n},E.presetColors={},E.defineProperty=Z,E.simpleJSONObject=_,E.Aft=K,T=E,(e.ChartUtility=T).InitPresetColors(),j.InitGradientStopPresetColor=function(t,n){},j.InitGradientStopTwoColor=function(t,n){},j.InitGradientTwoColorCornerStops=function(t,n){},j.InitGradientTwoColorCenterStops=function(t,n){},j.InitGradientOneColorCornerStops=function(t,n){},j.InitGradientOneColorCenterStops=function(t,n){},j.InitGradientStopOneColor=function(t,n){},j.InitGradientStops=function(t,n,e){},j.GetGradientAngle=function(t,n){var e=0;switch(t){case s.GradientStyle.GradientHorizontal:1===n?e=90:2===n||4===n?e=270:3===n&&(e=90);break;case s.GradientStyle.GradientVertical:2!==n&&4!==n||(e=180);break;case s.GradientStyle.GradientDiagonalUp:1===n||3===n?e=45:2!==n&&4!==n||(e=225);break;case s.GradientStyle.GradientDiagonalDown:1===n||3===n?e=135:2!==n&&4!==n||(e=315);break;case s.GradientStyle.GradientFromCorner:case s.GradientStyle.GradientFromCenter:e=135}return e},j.GetTintAndShadeByDegree=function(t){return 2*(t-.5)},j.ToLum=function(t){return 1e5-d(2e5*(1-t))},j.FromLum=function(t){return 1-(1e5-t)/2e5},e.ShapeUtility=j,O.CalculateValidMinimum=function(t,n,e,i,r,o){return e?t===b.DOUBLE_MAX_VALUE||t<=0?n===b.DOUBLE_MIN_VALUE||n<=0?t=1:n<1?t=n/i:1===n?t=1/i:1<n&&(t=1):n<=t?n===b.DOUBLE_MIN_VALUE||n<=0||(n<1&&r&&!o?t=n/i:1===n&&r&&!o?t=1/i:1<n&&(r||!o)&&(t=1)):r&&(t=1):t===b.DOUBLE_MAX_VALUE?n===b.DOUBLE_MIN_VALUE?t=0:n<0?t=2*n:0===n?t=-1:0<n&&(t=0):n<=t&&n!==b.DOUBLE_MIN_VALUE&&(n<0&&r&&!o?n!==t&&(t=2*n):0===n&&r&&!o?t=-1:0<n&&(r||!o)&&(t=0)),t},O.CalculateValidMaximum=function(t,n,e,i){return e?n<=t&&(t<1?n=1:1===t?n=i:1<t&&(n=t*i)):n<=t&&(t<0?n=0:0===t?n=1:0<t&&n!==t&&(n=2*t)),n},O.calcMinMax=function(t,n,e,i){var r,o,a,u,s,r=n-t,o=.05*r,s=i.ChartType;return e?(a=t,(u=n)<1&&(a=u=1)):0<=t?(u=n,q(i)&&(u+=o),n<6*r?a=0:(a=t-r/2,(T.IsScatterChart(s)||T.IsBubbleChart(s))&&(a=t))):n<=0?(a=t,q(i)&&(a-=o),0<6*r+t?u=0:(u=n+r/2,(T.IsScatterChart(s)||T.IsBubbleChart(s))&&(u=n))):(a=t-o,u=n+o),{Min:a,Max:u}},O.CalculateMinimum2=function(t,n,e,i,r){return t=i?v(r,d(b.log(t,r))):d(t/e)*e},O.Ift={},O.CalculateMaximum2=function(t,n,e,i,r){return n=i?v(r,a(b.log(n,r))):a(n/e)*e},O.CalculateMajorUnit=function(t,n,e,i,r,o){var n,a,n=m(n-t);return r?a=o:(n/(a=v(10,d(b.log(n,10))))<=1.6?a/=5:n/a<=4?a/=2:8<n/a&&(a*=2),e||(a=u(a,i))),a},O.CalculateMinorUnit=function(t,n,e,i){var i,i=i?e:e/5;return i},O.GenerateAxisId=function(){for(var t=0;;)if(t=d(9e7*Math.random())+1e7,!this.Ift[t]){this.Ift[t]=!0;break}return t},e.AxisUtility=O,Object.defineProperty(R.prototype,"Format",{get:function(){return this.I5},enumerable:!1,configurable:!0}),Object.defineProperty(R.prototype,"ChartFormat",{get:function(){return M.isNullOrUndefined(this.I5)&&(this.I5=this.GetDefaultFormat()),this.I5},enumerable:!1,configurable:!0}),R.prototype.CreateFormat=function(){return l},R.prototype.GetDefaultFormat=function(){return this.CreateFormat()},R.prototype.GetFormatInternal=function(){return this.I5},R.prototype.FromShapeProperties=function(t){var n=this;M.isNullOrUndefined(t)?n.ClearFormat():(M.isNullOrUndefined(n.I5)&&(n.I5=n.CreateFormat()),n.I5.FromOOModel(t))},R.prototype.FromSJSShapeProperties=function(t){var n=this;M.isNullOrUndefined(t)?n.ClearFormat():(M.isNullOrUndefined(n.I5)&&(n.I5=n.CreateFormat()),n.I5.FromSJSOOModel(t))},R.prototype.ToShapeProperties=function(){return M.isNullOrUndefined(this.I5)?l:this.I5.ToOOModel()},R.prototype.ToSJSShapeProperties=function(){return M.isNullOrUndefined(this.I5)?l:this.I5.ToSJSOOModel()},R.prototype.Delete=function(){M.isNullOrUndefined(this.I5)||(this.I5.ParentStateful=l)},R.prototype.ClearFormat=function(){var t=this;M.isNullOrUndefined(t.I5)||(t.I5.SetParentForChildren(l),t.I5.ParentStateful=l,t.I5=l)},e.ChartElementBase=R,(n=z=e.BevelType||(e.BevelType={}))[n.BevelNone=0]="BevelNone",n[n.BevelRelaxedInset=1]="BevelRelaxedInset",n[n.BevelCircle=2]="BevelCircle",n[n.BevelSlope=3]="BevelSlope",n[n.BevelCross=4]="BevelCross",n[n.BevelAngle=5]="BevelAngle",n[n.BevelSoftRound=6]="BevelSoftRound",n[n.BevelConvex=7]="BevelConvex",n[n.BevelCoolSlant=8]="BevelCoolSlant",n[n.BevelDivot=9]="BevelDivot",n[n.BevelRiblet=10]="BevelRiblet",n[n.BevelHardEdge=11]="BevelHardEdge",n[n.BevelArtDeco=12]="BevelArtDeco",(t=V=e.ChartGroupType||(e.ChartGroupType={}))[t.UnKnown=0]="UnKnown",t[t.Area3DGroup=1]="Area3DGroup",t[t.Bar3DGroup=2]="Bar3DGroup",t[t.Column3DGroup=3]="Column3DGroup",t[t.Line3DGroup=4]="Line3DGroup",t[t.Pie3DGroup=5]="Pie3DGroup",t[t.SurfaceGroup=6]="SurfaceGroup",t[t.AreaGroup=7]="AreaGroup",t[t.BarGroup=8]="BarGroup",t[t.ColumnGroup=9]="ColumnGroup",t[t.DoughnutGroup=10]="DoughnutGroup",t[t.LineGroup=11]="LineGroup",t[t.PieGroup=12]="PieGroup",t[t.RadarGroup=13]="RadarGroup",t[t.XYGroup=14]="XYGroup",e.pft=$,e.toKnownColor=tt,e.gft=nt,e.toColorSchemeIndex=et,e.mft=it},"./dist/plugins/floatingObject/drawing/drawingInterface.js":function(B,t){"use strict";var n,e,L,i,r,o,a,u,s,c,f,l,h,d,v,m,g,p,b,y,w,M,C,S,T,A,I,x,N,k,D,_,E,j,F,P,G,U,H,z,V,Y,Z,W,Q,J,K,X,q,$,tt,nt,et,it,rt,ot,at,ut,st,ct,ft,lt,ht,dt,vt,mt,gt,pt,bt,yt,wt,Mt,Ct,St,Tt,At,It,xt,Nt,kt,Dt,_t,Et,jt,Ot,Rt,Bt,Lt,Ft,Pt,Gt,Ut,Ht,zt,Vt,Yt,Zt,Wt,Qt,Jt,Kt,Xt,qt,$t,tn,nn,en,rn,on,an,un,sn,cn,fn,ln,hn,dn,vn,mn,gn,pn,bn,yn,wn,Mn,Cn,Sn,Tn,An,In,xn,Nn,kn,Dn,_n,En,jn,On,Rn,Bn,Ln,Fn,Pn,Gn,Un,Hn,zn,Vn,Yn,O,O,O,O,O,O,O,O,O,O,O,O,O,O,O,O,O,O,O,O,O,O,O,O,O,O,O,O,O,O,O,O,O,O,O,O,O,O,O,O,O,O,O,O,O,O,O,O,O,O,O,O,O,O,O,O,O,O,O,O,O,O,O,O,O,O,O,O,O,O,O,O,O,O,O,O,O,O,O,O,O,O,O,O,O,O,O,O,O,O,O,O,O,O,O,O,O,O,O,O,O,O,O,O,O,O,O,O,O,O,O,O,O,O,O,O,O,O,O,O,O,O,O,O,O,O,O,O,O,O,O,O,O,O,O,O,O,O,O,O,O,O,O,O,O,O,O,O;function R(){}Object.defineProperty(t,"__esModule",{value:!0}),t.ST_CompoundLine=t.ST_SchemeColorVal=t.ST_SystemColorVal=t.ST_RectAlignment=t.ST_LightRigDirection=t.ST_TextTabAlignType=t.ST_TextShapeType=t.ST_TextWrappingType=t.ST_TextVerticalType=t.ST_TextVertOverflowType=t.ST_TextAutonumberScheme=t.ST_TextAlignType=t.ST_TextFontAlignType=t.ST_PresetShadowVal=t.ST_EffectContainerType=t.ST_LightRigType=t.ST_BlendMode=t.ST_TileFlipMode=t.StyleDataFlag=t.TextParagraphElementType=t.ExtDataType=t.SeriesType=t.ShadowEffectType=t.ST_AxPos=t.ST_OfPieType=t.ST_BarDir=t.ST_BarGrouping=t.ST_RadarStyle=t.ST_ScatterStyle=t.ST_Grouping=t.ST_PresetColorVal=t.ST_FontCollectionIndex=t.CT_HiddenExtensionType=t.CT_AxisType=t.ST_SeriesLayout=t.CT_ChartType=t.ColorFillType=t.AnchorType=t.ST_CrossBetween=t.ST_Orientation=t.ST_BevelPresetType=t.ST_PresetMaterialType=t.ST_PathShadeType=t.ST_BlipCompression=t.ST_LineCap=t.ST_PresetPatternVal=t.ST_TextUnderlineType=t.OOXMLFileHelper=t.ST_TextCapsType=t.ST_TextStrikeType=void 0,t.TrendlineType=t.ST_TrendlineType=t.ChartType=t.BarShape=t.ST_RegionLabelLayout=t.ST_ParentLabelLayout=t.ST_Shape=t.AxisGroup=t.CategoryType=t.AxisOrientation=t.AxisCrossPoint=t.DisplayUnit=t.TickMark=t.TimeUnit=t.ScaleType=t.TickLabelPosition=t.AxisType=t.LightRigDirection=t.LightRigType=t.PresetLightingDirection=t.PresetCamera=t.SoftEdgeType=t.ShadowStyle=t.ShadowType=t.PictureColorType=t.LineStyle=t.LineJoinStyle=t.LineCapStyle=t.LineDashStyle=t.ArrowheadWidth=t.ArrowheadStyle=t.ArrowheadLength=t.GradientStyle=t.PatternType=t.GradientColorType=t.PresetTexture=t.PresetGradientType=t.FillType=t.TextureType=t.TextureFlipType=t.TextureAlignment=t.DrawingType=t.ST_TextHorzOverflowType=t.ST_TextAnchoringType=t.ReferenceKind=t.ThemeFont=t.ColorSchemeIndex=t.ST_GeoProjectionType=t.ST_GeoMappingLevel=t.ST_PenAlignment=void 0,t.ST_TimeUnit=t.PictureFormatType=t.ColorFormatStates=t.LineFormatStates=t.ST_2016ChartPosLegend=t.ST_AnchorType=t.ST_LineEndLength=t.ST_LineEndType=t.ST_LineEndWidth=t.ST_PresetLineDashVal=t.ST_PresetCameraType=t.ST_DispBlanksAs=t.ST_SizeRepresents=t.ST_SplitType=t.ST_MarkerStyle=t.ST_LayoutTarget=t.ST_LayoutMode=t.ST_LegendPos=t.ST_PosAlign=t.ST_Crosses=t.ST_TickMarksType=t.ST_BuiltInUnit=t.ST_TickLblPos=t.ST_TickMark=t.DisplayBlanksAs=t.ColorType=t.UnderlineType=t.TextFieldType=t.ReflectionType=t.TextUnderlineType=t.SolidColorType=t.ImageType=t.ChartElements=t.Placement=t.VertAlignType=t.LineType=t.SymbolShape=t.RowCol=t.LegendPosition=t.ChartSplitType=t.SizeRepresents=t.DrawingPictureType=t.ErrorBarValueType=t.ST_ErrValType=t.ErrorBarType=t.ST_ErrDir=t.MarkerStyle=t.DataLabelPosition=t.ST_DLblPos=void 0,(O=n=t.ST_TextStrikeType||(t.ST_TextStrikeType={}))[O.noStrike=0]="noStrike",O[O.sngStrike=1]="sngStrike",O[O.dblStrike=2]="dblStrike",(O=e=t.ST_TextCapsType||(t.ST_TextCapsType={}))[O.none=0]="none",O[O.small=1]="small",O[O.all=2]="all",R.HiddenScene3dUri="{31F19639-BCED-4A60-ADC4-E9642A236FB7}",R.HiddenSp3dUri="{E45631CC-5BF2-4C18-A39C-3461C7D3F71A}",R.HiddenFillUri="{909E8E84-426E-40DD-AFC4-6F175D3DCCD1}",R.HiddenLineUri="{91240B29-F687-4F45-9708-019B960494DF}",t.OOXMLFileHelper=R,(O=i=t.ST_TextUnderlineType||(t.ST_TextUnderlineType={}))[O.none=0]="none",O[O.words=1]="words",O[O.sng=2]="sng",O[O.dbl=3]="dbl",O[O.heavy=4]="heavy",O[O.dotted=5]="dotted",O[O.dottedHeavy=6]="dottedHeavy",O[O.dash=7]="dash",O[O.dashHeavy=8]="dashHeavy",O[O.dashLong=9]="dashLong",O[O.dashLongHeavy=10]="dashLongHeavy",O[O.dotDash=11]="dotDash",O[O.dotDashHeavy=12]="dotDashHeavy",O[O.dotDotDash=13]="dotDotDash",O[O.dotDotDashHeavy=14]="dotDotDashHeavy",O[O.wavy=15]="wavy",O[O.wavyHeavy=16]="wavyHeavy",O[O.wavyDb=17]="wavyDb",(O=r=t.ST_PresetPatternVal||(t.ST_PresetPatternVal={}))[O.pct5=0]="pct5",O[O.pct10=1]="pct10",O[O.pct20=2]="pct20",O[O.pct25=3]="pct25",O[O.pct30=4]="pct30",O[O.pct40=5]="pct40",O[O.pct50=6]="pct50",O[O.pct60=7]="pct60",O[O.pct70=8]="pct70",O[O.pct75=9]="pct75",O[O.pct80=10]="pct80",O[O.pct90=11]="pct90",O[O.horz=12]="horz",O[O.vert=13]="vert",O[O.ltHorz=14]="ltHorz",O[O.ltVert=15]="ltVert",O[O.dkHorz=16]="dkHorz",O[O.dkVert=17]="dkVert",O[O.narHorz=18]="narHorz",O[O.narVert=19]="narVert",O[O.dashHorz=20]="dashHorz",O[O.dashVert=21]="dashVert",O[O.cross=22]="cross",O[O.dnDiag=23]="dnDiag",O[O.upDiag=24]="upDiag",O[O.ltDnDiag=25]="ltDnDiag",O[O.ltUpDiag=26]="ltUpDiag",O[O.dkDnDiag=27]="dkDnDiag",O[O.dkUpDiag=28]="dkUpDiag",O[O.wdDnDiag=29]="wdDnDiag",O[O.wdUpDiag=30]="wdUpDiag",O[O.dashDnDiag=31]="dashDnDiag",O[O.dashUpDiag=32]="dashUpDiag",O[O.diagCross=33]="diagCross",O[O.smCheck=34]="smCheck",O[O.lgCheck=35]="lgCheck",O[O.smGrid=36]="smGrid",O[O.lgGrid=37]="lgGrid",O[O.dotGrid=38]="dotGrid",O[O.smConfetti=39]="smConfetti",O[O.lgConfetti=40]="lgConfetti",O[O.horzBrick=41]="horzBrick",O[O.diagBrick=42]="diagBrick",O[O.solidDmnd=43]="solidDmnd",O[O.openDmnd=44]="openDmnd",O[O.dotDmnd=45]="dotDmnd",O[O.plaid=46]="plaid",O[O.sphere=47]="sphere",O[O.weave=48]="weave",O[O.divot=49]="divot",O[O.shingle=50]="shingle",O[O.wave=51]="wave",O[O.trellis=52]="trellis",O[O.zigZag=53]="zigZag",(O=o=t.ST_LineCap||(t.ST_LineCap={}))[O.rnd=0]="rnd",O[O.sq=1]="sq",O[O.flat=2]="flat",(O=a=t.ST_BlipCompression||(t.ST_BlipCompression={}))[O.email=0]="email",O[O.screen=1]="screen",O[O.print=2]="print",O[O.hqprint=3]="hqprint",O[O.none=4]="none",(O=u=t.ST_PathShadeType||(t.ST_PathShadeType={}))[O.shape=0]="shape",O[O.circle=1]="circle",O[O.rect=2]="rect",(O=s=t.ST_PresetMaterialType||(t.ST_PresetMaterialType={}))[O.legacyMatte=0]="legacyMatte",O[O.legacyPlastic=1]="legacyPlastic",O[O.legacyMetal=2]="legacyMetal",O[O.legacyWireframe=3]="legacyWireframe",O[O.matte=4]="matte",O[O.plastic=5]="plastic",O[O.metal=6]="metal",O[O.warmMatte=7]="warmMatte",O[O.translucentPowder=8]="translucentPowder",O[O.powder=9]="powder",O[O.dkEdge=10]="dkEdge",O[O.softEdge=11]="softEdge",O[O.clear=12]="clear",O[O.flat=13]="flat",O[O.softmetal=14]="softmetal",(O=c=t.ST_BevelPresetType||(t.ST_BevelPresetType={}))[O.relaxedInset=0]="relaxedInset",O[O.circle=1]="circle",O[O.slope=2]="slope",O[O.cross=3]="cross",O[O.angle=4]="angle",O[O.softRound=5]="softRound",O[O.convex=6]="convex",O[O.coolSlant=7]="coolSlant",O[O.divot=8]="divot",O[O.riblet=9]="riblet",O[O.hardEdge=10]="hardEdge",O[O.artDeco=11]="artDeco",(O=f=t.ST_Orientation||(t.ST_Orientation={}))[O.maxMin=0]="maxMin",O[O.minMax=1]="minMax",(O=l=t.ST_CrossBetween||(t.ST_CrossBetween={}))[O.between=0]="between",O[O.midCat=1]="midCat",(O=h=t.AnchorType||(t.AnchorType={}))[O.TwoCellAnchor=0]="TwoCellAnchor",O[O.OneCellAnchor=1]="OneCellAnchor",O[O.AbsoluteAnchor=2]="AbsoluteAnchor",O[O.RelSizeAnchor=3]="RelSizeAnchor",O[O.AbsSizeAnchor=4]="AbsSizeAnchor",(O=d=t.ColorFillType||(t.ColorFillType={}))[O.SolidColorFillProperties=0]="SolidColorFillProperties",O[O.PatternFillProperties=1]="PatternFillProperties",O[O.GradientFillProperties=2]="GradientFillProperties",O[O.BlipFillProperties=3]="BlipFillProperties",O[O.GroupFillProperties=4]="GroupFillProperties",O[O.NoFillProperties=5]="NoFillProperties",(O=v=t.CT_ChartType||(t.CT_ChartType={}))[O.CT_StockChart=0]="CT_StockChart",O[O.CT_ScatterChart=1]="CT_ScatterChart",O[O.CT_RadarChart=2]="CT_RadarChart",O[O.CT_BubbleChart=3]="CT_BubbleChart",O[O.CT_AreaChart=4]="CT_AreaChart",O[O.CT_Area3DChart=5]="CT_Area3DChart",O[O.CT_BarChart=6]="CT_BarChart",O[O.CT_Bar3DChart=7]="CT_Bar3DChart",O[O.CT_LineChart=8]="CT_LineChart",O[O.CT_Line3DChart=9]="CT_Line3DChart",O[O.CT_PieChart=10]="CT_PieChart",O[O.CT_Pie3DChart=11]="CT_Pie3DChart",O[O.CT_DoughnutChart=12]="CT_DoughnutChart",O[O.CT_OfPieChart=13]="CT_OfPieChart",O[O.CT_SurfaceChart=14]="CT_SurfaceChart",O[O.CT_Surface3DChart=15]="CT_Surface3DChart",O[O.CT_BoxWhisker=16]="CT_BoxWhisker",O[O.CT_Funnel=17]="CT_Funnel",O[O.CT_ParetoLine=18]="CT_ParetoLine",O[O.CT_RegionMap=19]="CT_RegionMap",O[O.CT_Sunburst=20]="CT_Sunburst",O[O.CT_Treemap=21]="CT_Treemap",O[O.CT_Waterfall=22]="CT_Waterfall",O[O.CT_ClusteredColumn=23]="CT_ClusteredColumn",(O=m=t.ST_SeriesLayout||(t.ST_SeriesLayout={}))[O.boxWhisker=0]="boxWhisker",O[O.funnel=1]="funnel",O[O.paretoLine=2]="paretoLine",O[O.regionMap=3]="regionMap",O[O.sunburst=4]="sunburst",O[O.treemap=5]="treemap",O[O.waterfall=6]="waterfall",O[O.clusteredColumn=7]="clusteredColumn",(O=g=t.CT_AxisType||(t.CT_AxisType={}))[O.CT_CatAx=0]="CT_CatAx",O[O.CT_DateAx=1]="CT_DateAx",O[O.CT_SerAx=2]="CT_SerAx",O[O.CT_ValAx=3]="CT_ValAx",(O=p=t.CT_HiddenExtensionType||(t.CT_HiddenExtensionType={}))[O.CT_HiddenScene3dExtension=0]="CT_HiddenScene3dExtension",O[O.CT_HiddenFillPropertiesExtension=1]="CT_HiddenFillPropertiesExtension",O[O.CT_HiddenLinePropertiesBaseExtension=2]="CT_HiddenLinePropertiesBaseExtension",O[O.CT_HiddenShape3dExtension=3]="CT_HiddenShape3dExtension",O[O.CT_OfficeArtExtension=4]="CT_OfficeArtExtension",(O=b=t.ST_FontCollectionIndex||(t.ST_FontCollectionIndex={}))[O.major=0]="major",O[O.minor=1]="minor",O[O.none=2]="none",(O=y=t.ST_PresetColorVal||(t.ST_PresetColorVal={}))[O.aliceBlue=0]="aliceBlue",O[O.antiqueWhite=1]="antiqueWhite",O[O.aqua=2]="aqua",O[O.aquamarine=3]="aquamarine",O[O.azure=4]="azure",O[O.beige=5]="beige",O[O.bisque=6]="bisque",O[O.black=7]="black",O[O.blanchedAlmond=8]="blanchedAlmond",O[O.blue=9]="blue",O[O.blueViolet=10]="blueViolet",O[O.brown=11]="brown",O[O.burlyWood=12]="burlyWood",O[O.cadetBlue=13]="cadetBlue",O[O.chartreuse=14]="chartreuse",O[O.chocolate=15]="chocolate",O[O.coral=16]="coral",O[O.cornflowerBlue=17]="cornflowerBlue",O[O.cornsilk=18]="cornsilk",O[O.crimson=19]="crimson",O[O.cyan=20]="cyan",O[O.darkBlue=21]="darkBlue",O[O.darkCyan=22]="darkCyan",O[O.darkGoldenrod=23]="darkGoldenrod",O[O.darkGray=24]="darkGray",O[O.darkGreen=25]="darkGreen",O[O.darkGrey=26]="darkGrey",O[O.darkKhaki=27]="darkKhaki",O[O.darkMagenta=28]="darkMagenta",O[O.darkOliveGreen=29]="darkOliveGreen",O[O.darkOrange=30]="darkOrange",O[O.darkOrchid=31]="darkOrchid",O[O.darkRed=32]="darkRed",O[O.darkSalmon=33]="darkSalmon",O[O.darkSeaGreen=34]="darkSeaGreen",O[O.darkSlateBlue=35]="darkSlateBlue",O[O.darkSlateGray=36]="darkSlateGray",O[O.darkSlateGrey=37]="darkSlateGrey",O[O.darkTurquoise=38]="darkTurquoise",O[O.darkViolet=39]="darkViolet",O[O.deepPink=40]="deepPink",O[O.deepSkyBlue=41]="deepSkyBlue",O[O.dimGray=42]="dimGray",O[O.dimGrey=43]="dimGrey",O[O.dkBlue=44]="dkBlue",O[O.dkCyan=45]="dkCyan",O[O.dkGoldenrod=46]="dkGoldenrod",O[O.dkGray=47]="dkGray",O[O.dkGreen=48]="dkGreen",O[O.dkGrey=49]="dkGrey",O[O.dkKhaki=50]="dkKhaki",O[O.dkMagenta=51]="dkMagenta",O[O.dkOliveGreen=52]="dkOliveGreen",O[O.dkOrange=53]="dkOrange",O[O.dkOrchid=54]="dkOrchid",O[O.dkRed=55]="dkRed",O[O.dkSalmon=56]="dkSalmon",O[O.dkSeaGreen=57]="dkSeaGreen",O[O.dkSlateBlue=58]="dkSlateBlue",O[O.dkSlateGray=59]="dkSlateGray",O[O.dkSlateGrey=60]="dkSlateGrey",O[O.dkTurquoise=61]="dkTurquoise",O[O.dkViolet=62]="dkViolet",O[O.dodgerBlue=63]="dodgerBlue",O[O.firebrick=64]="firebrick",O[O.floralWhite=65]="floralWhite",O[O.forestGreen=66]="forestGreen",O[O.fuchsia=67]="fuchsia",O[O.gainsboro=68]="gainsboro",O[O.ghostWhite=69]="ghostWhite",O[O.gold=70]="gold",O[O.goldenrod=71]="goldenrod",O[O.gray=72]="gray",O[O.green=73]="green",O[O.greenYellow=74]="greenYellow",O[O.grey=75]="grey",O[O.honeydew=76]="honeydew",O[O.hotPink=77]="hotPink",O[O.indianRed=78]="indianRed",O[O.indigo=79]="indigo",O[O.ivory=80]="ivory",O[O.khaki=81]="khaki",O[O.lavender=82]="lavender",O[O.lavenderBlush=83]="lavenderBlush",O[O.lawnGreen=84]="lawnGreen",O[O.lemonChiffon=85]="lemonChiffon",O[O.lightBlue=86]="lightBlue",O[O.lightCoral=87]="lightCoral",O[O.lightCyan=88]="lightCyan",O[O.lightGoldenrodYellow=89]="lightGoldenrodYellow",O[O.lightGray=90]="lightGray",O[O.lightGreen=91]="lightGreen",O[O.lightGrey=92]="lightGrey",O[O.lightPink=93]="lightPink",O[O.lightSalmon=94]="lightSalmon",O[O.lightSeaGreen=95]="lightSeaGreen",O[O.lightSkyBlue=96]="lightSkyBlue",O[O.lightSlateGray=97]="lightSlateGray",O[O.lightSlateGrey=98]="lightSlateGrey",O[O.lightSteelBlue=99]="lightSteelBlue",O[O.lightYellow=100]="lightYellow",O[O.lime=101]="lime",O[O.limeGreen=102]="limeGreen",O[O.linen=103]="linen",O[O.ltBlue=104]="ltBlue",O[O.ltCoral=105]="ltCoral",O[O.ltCyan=106]="ltCyan",O[O.ltGoldenrodYellow=107]="ltGoldenrodYellow",O[O.ltGray=108]="ltGray",O[O.ltGreen=109]="ltGreen",O[O.ltGrey=110]="ltGrey",O[O.ltPink=111]="ltPink",O[O.ltSalmon=112]="ltSalmon",O[O.ltSeaGreen=113]="ltSeaGreen",O[O.ltSkyBlue=114]="ltSkyBlue",O[O.ltSlateGray=115]="ltSlateGray",O[O.ltSlateGrey=116]="ltSlateGrey",O[O.ltSteelBlue=117]="ltSteelBlue",O[O.ltYellow=118]="ltYellow",O[O.magenta=119]="magenta",O[O.maroon=120]="maroon",O[O.medAquamarine=121]="medAquamarine",O[O.medBlue=122]="medBlue",O[O.mediumAquamarine=123]="mediumAquamarine",O[O.mediumBlue=124]="mediumBlue",O[O.mediumOrchid=125]="mediumOrchid",O[O.mediumPurple=126]="mediumPurple",O[O.mediumSeaGreen=127]="mediumSeaGreen",O[O.mediumSlateBlue=128]="mediumSlateBlue",O[O.mediumSpringGreen=129]="mediumSpringGreen",O[O.mediumTurquoise=130]="mediumTurquoise",O[O.mediumVioletRed=131]="mediumVioletRed",O[O.medOrchid=132]="medOrchid",O[O.medPurple=133]="medPurple",O[O.medSeaGreen=134]="medSeaGreen",O[O.medSlateBlue=135]="medSlateBlue",O[O.medSpringGreen=136]="medSpringGreen",O[O.medTurquoise=137]="medTurquoise",O[O.medVioletRed=138]="medVioletRed",O[O.midnightBlue=139]="midnightBlue",O[O.mintCream=140]="mintCream",O[O.mistyRose=141]="mistyRose",O[O.moccasin=142]="moccasin",O[O.navajoWhite=143]="navajoWhite",O[O.navy=144]="navy",O[O.oldLace=145]="oldLace",O[O.olive=146]="olive",O[O.oliveDrab=147]="oliveDrab",O[O.orange=148]="orange",O[O.orangeRed=149]="orangeRed",O[O.orchid=150]="orchid",O[O.paleGoldenrod=151]="paleGoldenrod",O[O.paleGreen=152]="paleGreen",O[O.paleTurquoise=153]="paleTurquoise",O[O.paleVioletRed=154]="paleVioletRed",O[O.papayaWhip=155]="papayaWhip",O[O.peachPuff=156]="peachPuff",O[O.peru=157]="peru",O[O.pink=158]="pink",O[O.plum=159]="plum",O[O.powderBlue=160]="powderBlue",O[O.purple=161]="purple",O[O.red=162]="red",O[O.rosyBrown=163]="rosyBrown",O[O.royalBlue=164]="royalBlue",O[O.saddleBrown=165]="saddleBrown",O[O.salmon=166]="salmon",O[O.sandyBrown=167]="sandyBrown",O[O.seaGreen=168]="seaGreen",O[O.seaShell=169]="seaShell",O[O.sienna=170]="sienna",O[O.silver=171]="silver",O[O.skyBlue=172]="skyBlue",O[O.slateBlue=173]="slateBlue",O[O.slateGray=174]="slateGray",O[O.slateGrey=175]="slateGrey",O[O.snow=176]="snow",O[O.springGreen=177]="springGreen",O[O.steelBlue=178]="steelBlue",O[O.tan=179]="tan",O[O.teal=180]="teal",O[O.thistle=181]="thistle",O[O.tomato=182]="tomato",O[O.turquoise=183]="turquoise",O[O.violet=184]="violet",O[O.wheat=185]="wheat",O[O.white=186]="white",O[O.whiteSmoke=187]="whiteSmoke",O[O.yellow=188]="yellow",O[O.yellowGreen=189]="yellowGreen",(O=w=t.ST_Grouping||(t.ST_Grouping={}))[O.percentStacked=0]="percentStacked",O[O.standard=1]="standard",O[O.stacked=2]="stacked",(O=M=t.ST_ScatterStyle||(t.ST_ScatterStyle={}))[O.none=0]="none",O[O.line=1]="line",O[O.lineMarker=2]="lineMarker",O[O.marker=3]="marker",O[O.smooth=4]="smooth",O[O.smoothMarker=5]="smoothMarker",(O=C=t.ST_RadarStyle||(t.ST_RadarStyle={}))[O.standard=0]="standard",O[O.marker=1]="marker",O[O.filled=2]="filled",(O=S=t.ST_BarGrouping||(t.ST_BarGrouping={}))[O.percentStacked=0]="percentStacked",O[O.clustered=1]="clustered",O[O.standard=2]="standard",O[O.stacked=3]="stacked",(O=T=t.ST_BarDir||(t.ST_BarDir={}))[O.bar=0]="bar",O[O.col=1]="col",(O=A=t.ST_OfPieType||(t.ST_OfPieType={}))[O.pie=0]="pie",O[O.bar=1]="bar",(O=I=t.ST_AxPos||(t.ST_AxPos={}))[O.b=0]="b",O[O.l=1]="l",O[O.r=2]="r",O[O.t=3]="t",(O=x=t.ShadowEffectType||(t.ShadowEffectType={}))[O.OuterShadowEffect=0]="OuterShadowEffect",O[O.InnerShadowEffect=1]="InnerShadowEffect",O[O.PresetShadowEffect=2]="PresetShadowEffect",(O=N=t.SeriesType||(t.SeriesType={}))[O.BarSer=0]="BarSer",O[O.AreaSer=1]="AreaSer",O[O.LineSer=2]="LineSer",O[O.PieSer=3]="PieSer",O[O.RadarSer=4]="RadarSer",O[O.ScatterSer=5]="ScatterSer",O[O.BubbleSer=6]="BubbleSer",O[O.SurfaceSer=7]="SurfaceSer",O[O.boxWhisker=16]="boxWhisker",O[O.funnel=17]="funnel",O[O.paretoLine=18]="paretoLine",O[O.regionMap=19]="regionMap",O[O.sunburst=20]="sunburst",O[O.treemap=21]="treemap",O[O.waterfall=22]="waterfall",O[O.clusteredColumn=23]="clusteredColumn",(O=k=t.ExtDataType||(t.ExtDataType={}))[O.InvertSolidFillFmt=0]="InvertSolidFillFmt",O[O.SeriesDataLabelsRange=1]="SeriesDataLabelsRange",O[O.ChartDispNaAsBlank=2]="ChartDispNaAsBlank",(O=D=t.TextParagraphElementType||(t.TextParagraphElementType={}))[O.RegularTextRun=0]="RegularTextRun",O[O.TextLineBreak=1]="TextLineBreak",O[O.TextField=2]="TextField",(O=_=t.StyleDataFlag||(t.StyleDataFlag={}))[O.None=0]="None",O[O.Font=1]="Font",O[O.Fill=2]="Fill",O[O.Border=4]="Border",O[O.Alignment=8]="Alignment",O[O.Protection=16]="Protection",O[O.FormatCode=32]="FormatCode",O[O.All=63]="All",(O=E=t.ST_TileFlipMode||(t.ST_TileFlipMode={}))[O.none=0]="none",O[O.x=1]="x",O[O.y=2]="y",O[O.xy=3]="xy",(O=j=t.ST_BlendMode||(t.ST_BlendMode={}))[O.over=0]="over",O[O.mult=1]="mult",O[O.screen=2]="screen",O[O.darken=3]="darken",O[O.lighten=4]="lighten",(O=F=t.ST_LightRigType||(t.ST_LightRigType={}))[O.legacyFlat1=0]="legacyFlat1",O[O.legacyFlat2=1]="legacyFlat2",O[O.legacyFlat3=2]="legacyFlat3",O[O.legacyFlat4=3]="legacyFlat4",O[O.legacyNormal1=4]="legacyNormal1",O[O.legacyNormal2=5]="legacyNormal2",O[O.legacyNormal3=6]="legacyNormal3",O[O.legacyNormal4=7]="legacyNormal4",O[O.legacyHarsh1=8]="legacyHarsh1",O[O.legacyHarsh2=9]="legacyHarsh2",O[O.legacyHarsh3=10]="legacyHarsh3",O[O.legacyHarsh4=11]="legacyHarsh4",O[O.threePt=12]="threePt",O[O.balanced=13]="balanced",O[O.soft=14]="soft",O[O.harsh=15]="harsh",O[O.flood=16]="flood",O[O.contrasting=17]="contrasting",O[O.morning=18]="morning",O[O.sunrise=19]="sunrise",O[O.sunset=20]="sunset",O[O.chilly=21]="chilly",O[O.freezing=22]="freezing",O[O.flat=23]="flat",O[O.twoPt=24]="twoPt",O[O.glow=25]="glow",O[O.brightRoom=26]="brightRoom",(O=P=t.ST_EffectContainerType||(t.ST_EffectContainerType={}))[O.sib=0]="sib",O[O.tree=1]="tree",(O=G=t.ST_PresetShadowVal||(t.ST_PresetShadowVal={}))[O.shdw1=0]="shdw1",O[O.shdw2=1]="shdw2",O[O.shdw3=2]="shdw3",O[O.shdw4=3]="shdw4",O[O.shdw5=4]="shdw5",O[O.shdw6=5]="shdw6",O[O.shdw7=6]="shdw7",O[O.shdw8=7]="shdw8",O[O.shdw9=8]="shdw9",O[O.shdw10=9]="shdw10",O[O.shdw11=10]="shdw11",O[O.shdw12=11]="shdw12",O[O.shdw13=12]="shdw13",O[O.shdw14=13]="shdw14",O[O.shdw15=14]="shdw15",O[O.shdw16=15]="shdw16",O[O.shdw17=16]="shdw17",O[O.shdw18=17]="shdw18",O[O.shdw19=18]="shdw19",O[O.shdw20=19]="shdw20",(O=U=t.ST_TextFontAlignType||(t.ST_TextFontAlignType={}))[O.auto=0]="auto",O[O.t=1]="t",O[O.ctr=2]="ctr",O[O.base=3]="base",O[O.b=4]="b",(O=H=t.ST_TextAlignType||(t.ST_TextAlignType={}))[O.l=0]="l",O[O.ctr=1]="ctr",O[O.r=2]="r",O[O.just=3]="just",O[O.justLow=4]="justLow",O[O.dist=5]="dist",O[O.thaiDist=6]="thaiDist",(O=z=t.ST_TextAutonumberScheme||(t.ST_TextAutonumberScheme={}))[O.alphaLcParenBoth=0]="alphaLcParenBoth",O[O.alphaUcParenBoth=1]="alphaUcParenBoth",O[O.alphaLcParenR=2]="alphaLcParenR",O[O.alphaUcParenR=3]="alphaUcParenR",O[O.alphaLcPeriod=4]="alphaLcPeriod",O[O.alphaUcPeriod=5]="alphaUcPeriod",O[O.arabicParenBoth=6]="arabicParenBoth",O[O.arabicParenR=7]="arabicParenR",O[O.arabicPeriod=8]="arabicPeriod",O[O.arabicPlain=9]="arabicPlain",O[O.romanLcParenBoth=10]="romanLcParenBoth",O[O.romanUcParenBoth=11]="romanUcParenBoth",O[O.romanLcParenR=12]="romanLcParenR",O[O.romanUcParenR=13]="romanUcParenR",O[O.romanLcPeriod=14]="romanLcPeriod",O[O.romanUcPeriod=15]="romanUcPeriod",O[O.circleNumDbPlain=16]="circleNumDbPlain",O[O.circleNumWdBlackPlain=17]="circleNumWdBlackPlain",O[O.circleNumWdWhitePlain=18]="circleNumWdWhitePlain",O[O.arabicDbPeriod=19]="arabicDbPeriod",O[O.arabicDbPlain=20]="arabicDbPlain",O[O.ea1ChsPeriod=21]="ea1ChsPeriod",O[O.ea1ChsPlain=22]="ea1ChsPlain",O[O.ea1ChtPeriod=23]="ea1ChtPeriod",O[O.ea1ChtPlain=24]="ea1ChtPlain",O[O.ea1JpnChsDbPeriod=25]="ea1JpnChsDbPeriod",O[O.ea1JpnKorPlain=26]="ea1JpnKorPlain",O[O.ea1JpnKorPeriod=27]="ea1JpnKorPeriod",O[O.arabic1Minus=28]="arabic1Minus",O[O.arabic2Minus=29]="arabic2Minus",O[O.hebrew2Minus=30]="hebrew2Minus",O[O.thaiAlphaPeriod=31]="thaiAlphaPeriod",O[O.thaiAlphaParenR=32]="thaiAlphaParenR",O[O.thaiAlphaParenBoth=33]="thaiAlphaParenBoth",O[O.thaiNumPeriod=34]="thaiNumPeriod",O[O.thaiNumParenR=35]="thaiNumParenR",O[O.thaiNumParenBoth=36]="thaiNumParenBoth",O[O.hindiAlphaPeriod=37]="hindiAlphaPeriod",O[O.hindiNumPeriod=38]="hindiNumPeriod",O[O.hindiNumParenR=39]="hindiNumParenR",O[O.hindiAlpha1Period=40]="hindiAlpha1Period",(O=V=t.ST_TextVertOverflowType||(t.ST_TextVertOverflowType={}))[O.overflow=0]="overflow",O[O.ellipsis=1]="ellipsis",O[O.clip=2]="clip",(O=Y=t.ST_TextVerticalType||(t.ST_TextVerticalType={}))[O.horz=0]="horz",O[O.vert=1]="vert",O[O.vert270=2]="vert270",O[O.wordArtVert=3]="wordArtVert",O[O.eaVert=4]="eaVert",O[O.mongolianVert=5]="mongolianVert",O[O.wordArtVertRtl=6]="wordArtVertRtl",(O=Z=t.ST_TextWrappingType||(t.ST_TextWrappingType={}))[O.none=0]="none",O[O.square=1]="square",(O=W=t.ST_TextShapeType||(t.ST_TextShapeType={}))[O.textNoShape=0]="textNoShape",O[O.textPlain=1]="textPlain",O[O.textStop=2]="textStop",O[O.textTriangle=3]="textTriangle",O[O.textTriangleInverted=4]="textTriangleInverted",O[O.textChevron=5]="textChevron",O[O.textChevronInverted=6]="textChevronInverted",O[O.textRingInside=7]="textRingInside",O[O.textRingOutside=8]="textRingOutside",O[O.textArchUp=9]="textArchUp",O[O.textArchDown=10]="textArchDown",O[O.textCircle=11]="textCircle",O[O.textButton=12]="textButton",O[O.textArchUpPour=13]="textArchUpPour",O[O.textArchDownPour=14]="textArchDownPour",O[O.textCirclePour=15]="textCirclePour",O[O.textButtonPour=16]="textButtonPour",O[O.textCurveUp=17]="textCurveUp",O[O.textCurveDown=18]="textCurveDown",O[O.textCanUp=19]="textCanUp",O[O.textCanDown=20]="textCanDown",O[O.textWave1=21]="textWave1",O[O.textWave2=22]="textWave2",O[O.textDoubleWave1=23]="textDoubleWave1",O[O.textWave4=24]="textWave4",O[O.textInflate=25]="textInflate",O[O.textDeflate=26]="textDeflate",O[O.textInflateBottom=27]="textInflateBottom",O[O.textDeflateBottom=28]="textDeflateBottom",O[O.textInflateTop=29]="textInflateTop",O[O.textDeflateTop=30]="textDeflateTop",O[O.textDeflateInflate=31]="textDeflateInflate",O[O.textDeflateInflateDeflate=32]="textDeflateInflateDeflate",O[O.textFadeRight=33]="textFadeRight",O[O.textFadeLeft=34]="textFadeLeft",O[O.textFadeUp=35]="textFadeUp",O[O.textFadeDown=36]="textFadeDown",O[O.textSlantUp=37]="textSlantUp",O[O.textSlantDown=38]="textSlantDown",O[O.textCascadeUp=39]="textCascadeUp",O[O.textCascadeDown=40]="textCascadeDown",(O=Q=t.ST_TextTabAlignType||(t.ST_TextTabAlignType={}))[O.l=0]="l",O[O.ctr=1]="ctr",O[O.r=2]="r",O[O.dec=3]="dec",(O=J=t.ST_LightRigDirection||(t.ST_LightRigDirection={}))[O.tl=0]="tl",O[O.t=1]="t",O[O.tr=2]="tr",O[O.l=3]="l",O[O.r=4]="r",O[O.bl=5]="bl",O[O.b=6]="b",O[O.br=7]="br",(O=K=t.ST_RectAlignment||(t.ST_RectAlignment={}))[O.tl=0]="tl",O[O.t=1]="t",O[O.tr=2]="tr",O[O.l=3]="l",O[O.ctr=4]="ctr",O[O.r=5]="r",O[O.bl=6]="bl",O[O.b=7]="b",O[O.br=8]="br",(O=X=t.ST_SystemColorVal||(t.ST_SystemColorVal={}))[O.scrollBar=0]="scrollBar",O[O.background=1]="background",O[O.activeCaption=2]="activeCaption",O[O.inactiveCaption=3]="inactiveCaption",O[O.menu=4]="menu",O[O.window=5]="window",O[O.windowFrame=6]="windowFrame",O[O.menuText=7]="menuText",O[O.windowText=8]="windowText",O[O.captionText=9]="captionText",O[O.activeBorder=10]="activeBorder",O[O.inactiveBorder=11]="inactiveBorder",O[O.appWorkspace=12]="appWorkspace",O[O.highlight=13]="highlight",O[O.highlightText=14]="highlightText",O[O.btnFace=15]="btnFace",O[O.btnShadow=16]="btnShadow",O[O.grayText=17]="grayText",O[O.btnText=18]="btnText",O[O.inactiveCaptionText=19]="inactiveCaptionText",O[O.btnHighlight=20]="btnHighlight",O[O.Item3dDkShadow=21]="Item3dDkShadow",O[O.Item3dLight=22]="Item3dLight",O[O.infoText=23]="infoText",O[O.infoBk=24]="infoBk",O[O.hotLight=25]="hotLight",O[O.gradientActiveCaption=26]="gradientActiveCaption",O[O.gradientInactiveCaption=27]="gradientInactiveCaption",O[O.menuHighlight=28]="menuHighlight",O[O.menuBar=29]="menuBar",(O=q=t.ST_SchemeColorVal||(t.ST_SchemeColorVal={}))[O.bg1=0]="bg1",O[O.tx1=1]="tx1",O[O.bg2=2]="bg2",O[O.tx2=3]="tx2",O[O.accent1=4]="accent1",O[O.accent2=5]="accent2",O[O.accent3=6]="accent3",O[O.accent4=7]="accent4",O[O.accent5=8]="accent5",O[O.accent6=9]="accent6",O[O.hlink=10]="hlink",O[O.folHlink=11]="folHlink",O[O.phClr=12]="phClr",O[O.dk1=13]="dk1",O[O.lt1=14]="lt1",O[O.dk2=15]="dk2",O[O.lt2=16]="lt2",(O=$=t.ST_CompoundLine||(t.ST_CompoundLine={}))[O.sng=0]="sng",O[O.dbl=1]="dbl",O[O.thickThin=2]="thickThin",O[O.thinThick=3]="thinThick",O[O.tri=4]="tri",(O=tt=t.ST_PenAlignment||(t.ST_PenAlignment={}))[O.ctr=0]="ctr",O[O.in=1]="in",(O=nt=t.ST_GeoMappingLevel||(t.ST_GeoMappingLevel={}))[O.dataOnly=0]="dataOnly",O[O.postalCode=1]="postalCode",O[O.county=2]="county",O[O.state=3]="state",O[O.countryRegion=4]="countryRegion",O[O.countryRegionList=5]="countryRegionList",O[O.world=6]="world",(O=et=t.ST_GeoProjectionType||(t.ST_GeoProjectionType={}))[O.mercator=0]="mercator",O[O.miller=1]="miller",O[O.robinson=2]="robinson",O[O.albers=3]="albers",(O=it=t.ColorSchemeIndex||(t.ColorSchemeIndex={}))[O.None=-4142]="None",O[O.LT1=0]="LT1",O[O.DK1=1]="DK1",O[O.LT2=2]="LT2",O[O.DK2=3]="DK2",O[O.Accent1=4]="Accent1",O[O.Accent2=5]="Accent2",O[O.Accent3=6]="Accent3",O[O.Accent4=7]="Accent4",O[O.Accent5=8]="Accent5",O[O.Accent6=9]="Accent6",O[O.Hlink=10]="Hlink",O[O.FolHlink=11]="FolHlink",(O=rt=t.ThemeFont||(t.ThemeFont={}))[O.None=0]="None",O[O.Major=1]="Major",O[O.Minor=2]="Minor",(O=ot=t.ReferenceKind||(t.ReferenceKind={}))[O.Empty=0]="Empty",O[O.Row=1]="Row",O[O.Column=2]="Column",O[O.RowIsRelative=4]="RowIsRelative",O[O.ColumnIsRelative=8]="ColumnIsRelative",O[O.LastRowIsRelative=16]="LastRowIsRelative",O[O.LastColumnIsRelative=32]="LastColumnIsRelative",O[O.Range=64]="Range",O[O.Error=128]="Error",(O=at=t.ST_TextAnchoringType||(t.ST_TextAnchoringType={}))[O.t=0]="t",O[O.ctr=1]="ctr",O[O.b=2]="b",O[O.just=3]="just",O[O.dist=4]="dist",(O=ut=t.ST_TextHorzOverflowType||(t.ST_TextHorzOverflowType={}))[O.overflow=0]="overflow",O[O.clip=1]="clip",(O=st=t.DrawingType||(t.DrawingType={}))[O.Shape=0]="Shape",O[O.Chart=1]="Chart",O[O.Picture=2]="Picture",O[O.Connector=3]="Connector",O[O.GroupShape=4]="GroupShape",(O=ct=t.TextureAlignment||(t.TextureAlignment={}))[O.TextureTopLeft=0]="TextureTopLeft",O[O.TextureTop=1]="TextureTop",O[O.TextureTopRight=2]="TextureTopRight",O[O.TextureLeft=3]="TextureLeft",O[O.TextureCenter=4]="TextureCenter",O[O.TextureRight=5]="TextureRight",O[O.TextureBottomLeft=6]="TextureBottomLeft",O[O.TextureBottom=7]="TextureBottom",O[O.TextureBottomRight=8]="TextureBottomRight",(O=ft=t.TextureFlipType||(t.TextureFlipType={}))[O.None=0]="None",O[O.Horizontal=1]="Horizontal",O[O.Vertical=2]="Vertical",O[O.Both=3]="Both",(O=lt=t.TextureType||(t.TextureType={}))[O.TextureTypeNone=0]="TextureTypeNone",O[O.TexturePreset=1]="TexturePreset",O[O.TextureUserDefined=2]="TextureUserDefined",(O=ht=t.FillType||(t.FillType={}))[O.Solid=0]="Solid",O[O.Patterned=1]="Patterned",O[O.Gradient=2]="Gradient",O[O.Textured=3]="Textured",O[O.Background=4]="Background",O[O.Picture=5]="Picture",O[O.Group=6]="Group",(O=dt=t.PresetGradientType||(t.PresetGradientType={}))[O.GradientEarlySunset=0]="GradientEarlySunset",O[O.GradientLateSunset=1]="GradientLateSunset",O[O.GradientNightfall=2]="GradientNightfall",O[O.GradientDaybreak=3]="GradientDaybreak",O[O.GradientHorizon=4]="GradientHorizon",O[O.GradientDesert=5]="GradientDesert",O[O.GradientOcean=6]="GradientOcean",O[O.GradientCalmWater=7]="GradientCalmWater",O[O.GradientFire=8]="GradientFire",O[O.GradientFog=9]="GradientFog",O[O.GradientMoss=10]="GradientMoss",O[O.GradientPeacock=11]="GradientPeacock",O[O.GradientWheat=12]="GradientWheat",O[O.GradientParchment=13]="GradientParchment",O[O.GradientMahogany=14]="GradientMahogany",O[O.GradientRainbow=15]="GradientRainbow",O[O.GradientRainbowII=16]="GradientRainbowII",O[O.GradientGold=17]="GradientGold",O[O.GradientGoldII=18]="GradientGoldII",O[O.GradientBrass=19]="GradientBrass",O[O.GradientChrome=20]="GradientChrome",O[O.GradientChromeII=21]="GradientChromeII",O[O.GradientSilver=22]="GradientSilver",O[O.GradientSapphire=23]="GradientSapphire",(O=vt=t.PresetTexture||(t.PresetTexture={}))[O.TexturePapyrus=0]="TexturePapyrus",O[O.TextureCanvas=1]="TextureCanvas",O[O.TextureDenim=2]="TextureDenim",O[O.TextureWovenMat=3]="TextureWovenMat",O[O.TextureWaterDroplets=4]="TextureWaterDroplets",O[O.TexturePaperBag=5]="TexturePaperBag",O[O.TextureFishFossil=6]="TextureFishFossil",O[O.TextureSand=7]="TextureSand",O[O.TextureGreenMarble=8]="TextureGreenMarble",O[O.TextureWhiteMarble=9]="TextureWhiteMarble",O[O.TextureBrownMarble=10]="TextureBrownMarble",O[O.TextureGranite=11]="TextureGranite",O[O.TextureNewsprint=12]="TextureNewsprint",O[O.TextureRecycledPaper=13]="TextureRecycledPaper",O[O.TextureParchment=14]="TextureParchment",O[O.TextureStationery=15]="TextureStationery",O[O.TextureBlueTissuePaper=16]="TextureBlueTissuePaper",O[O.TexturePinkTissuePaper=17]="TexturePinkTissuePaper",O[O.TexturePurpleMesh=18]="TexturePurpleMesh",O[O.TextureBouquet=19]="TextureBouquet",O[O.TextureCork=20]="TextureCork",O[O.TextureWalnut=21]="TextureWalnut",O[O.TextureOak=22]="TextureOak",O[O.TextureMediumWood=23]="TextureMediumWood",(O=mt=t.GradientColorType||(t.GradientColorType={}))[O.GradientColorNone=0]="GradientColorNone",O[O.GradientOneColor=1]="GradientOneColor",O[O.GradientTwoColors=2]="GradientTwoColors",O[O.GradientPresetColors=3]="GradientPresetColors",O[O.GradientMultiColor=4]="GradientMultiColor",(O=gt=t.PatternType||(t.PatternType={}))[O.none=0]="none",O[O.dottedPercent5=1]="dottedPercent5",O[O.dottedPercent10=2]="dottedPercent10",O[O.dottedPercent20=3]="dottedPercent20",O[O.dottedPercent25=4]="dottedPercent25",O[O.dottedPercent30=5]="dottedPercent30",O[O.dottedPercent40=6]="dottedPercent40",O[O.dottedPercent50=7]="dottedPercent50",O[O.dottedPercent60=8]="dottedPercent60",O[O.dottedPercent70=9]="dottedPercent70",O[O.dottedPercent75=10]="dottedPercent75",O[O.dottedPercent80=11]="dottedPercent80",O[O.dottedPercent90=12]="dottedPercent90",O[O.darkHorizontal=13]="darkHorizontal",O[O.darkVertical=14]="darkVertical",O[O.darkDownwardDiagonal=15]="darkDownwardDiagonal",O[O.darkUpwardDiagonal=16]="darkUpwardDiagonal",O[O.smallCheckerBoard=17]="smallCheckerBoard",O[O.trellis=18]="trellis",O[O.lightHorizontal=19]="lightHorizontal",O[O.lightVertical=20]="lightVertical",O[O.lightDownwardDiagonal=21]="lightDownwardDiagonal",O[O.lightUpwardDiagonal=22]="lightUpwardDiagonal",O[O.smallGrid=23]="smallGrid",O[O.dottedDiamond=24]="dottedDiamond",O[O.wideDownwardDiagonal=25]="wideDownwardDiagonal",O[O.wideUpwardDiagonal=26]="wideUpwardDiagonal",O[O.dashedUpwardDiagonal=27]="dashedUpwardDiagonal",O[O.dashedDownwardDiagonal=28]="dashedDownwardDiagonal",O[O.narrowVertical=29]="narrowVertical",O[O.narrowHorizontal=30]="narrowHorizontal",O[O.dashedVertical=31]="dashedVertical",O[O.dashedHorizontal=32]="dashedHorizontal",O[O.largeConfetti=33]="largeConfetti",O[O.largeGrid=34]="largeGrid",O[O.horizontalBrick=35]="horizontalBrick",O[O.largeCheckerBoard=36]="largeCheckerBoard",O[O.smallConfetti=37]="smallConfetti",O[O.zigZag=38]="zigZag",O[O.solidDiamond=39]="solidDiamond",O[O.diagonalBrick=40]="diagonalBrick",O[O.outlinedDiamond=41]="outlinedDiamond",O[O.plaid=42]="plaid",O[O.sphere=43]="sphere",O[O.weave=44]="weave",O[O.dottedGrid=45]="dottedGrid",O[O.divot=46]="divot",O[O.shingle=47]="shingle",O[O.wave=48]="wave",(O=pt=t.GradientStyle||(t.GradientStyle={}))[O.GradientHorizontal=0]="GradientHorizontal",O[O.GradientVertical=1]="GradientVertical",O[O.GradientDiagonalUp=2]="GradientDiagonalUp",O[O.GradientDiagonalDown=3]="GradientDiagonalDown",O[O.GradientFromCorner=4]="GradientFromCorner",O[O.GradientFromTitle=5]="GradientFromTitle",O[O.GradientFromCenter=6]="GradientFromCenter",O[O.GradientTopSpotlight=7]="GradientTopSpotlight",O[O.GradientBottomSpotlight=8]="GradientBottomSpotlight",(O=bt=t.ArrowheadLength||(t.ArrowheadLength={}))[O.short=0]="short",O[O.medium=1]="medium",O[O.long=2]="long",(O=yt=t.ArrowheadStyle||(t.ArrowheadStyle={}))[O.none=0]="none",O[O.triangle=1]="triangle",O[O.stealth=2]="stealth",O[O.diamond=3]="diamond",O[O.oval=4]="oval",O[O.open=5]="open",(O=wt=t.ArrowheadWidth||(t.ArrowheadWidth={}))[O.narrow=0]="narrow",O[O.medium=1]="medium",O[O.wide=2]="wide",(O=Mt=t.LineDashStyle||(t.LineDashStyle={}))[O.solid=0]="solid",O[O.squareDot=1]="squareDot",O[O.dash=2]="dash",O[O.longDash=3]="longDash",O[O.dashDot=4]="dashDot",O[O.longDashDot=5]="longDashDot",O[O.longDashDotDot=6]="longDashDotDot",O[O.sysDash=7]="sysDash",O[O.sysDot=8]="sysDot",O[O.sysDashDot=9]="sysDashDot",O[O.dashDotDot=10]="dashDotDot",O[O.roundDot=11]="roundDot",(O=Ct=t.LineCapStyle||(t.LineCapStyle={}))[O.flat=2]="flat",O[O.square=1]="square",O[O.round=0]="round",(O=St=t.LineJoinStyle||(t.LineJoinStyle={}))[O.round=0]="round",O[O.miter=1]="miter",O[O.bevel=2]="bevel",(O=Tt=t.LineStyle||(t.LineStyle={}))[O.LineSingle=0]="LineSingle",O[O.LineThinThin=1]="LineThinThin",O[O.LineThinThick=2]="LineThinThick",O[O.LineThickThin=3]="LineThickThin",O[O.LineThickBetweenThin=4]="LineThickBetweenThin",(O=At=t.PictureColorType||(t.PictureColorType={}))[O.PictureAutomatic=0]="PictureAutomatic",O[O.PictureGrayscale=1]="PictureGrayscale",O[O.PictureBlackAndWhite=2]="PictureBlackAndWhite",O[O.PictureWatermark=3]="PictureWatermark",(O=It=t.ShadowType||(t.ShadowType={}))[O.Shadow1=0]="Shadow1",O[O.Shadow2=1]="Shadow2",O[O.Shadow3=2]="Shadow3",O[O.Shadow4=3]="Shadow4",O[O.Shadow5=4]="Shadow5",O[O.Shadow6=5]="Shadow6",O[O.Shadow7=6]="Shadow7",O[O.Shadow8=7]="Shadow8",O[O.Shadow9=8]="Shadow9",O[O.Shadow10=9]="Shadow10",O[O.Shadow11=10]="Shadow11",O[O.Shadow12=11]="Shadow12",O[O.Shadow13=12]="Shadow13",O[O.Shadow14=13]="Shadow14",O[O.Shadow15=14]="Shadow15",O[O.Shadow16=15]="Shadow16",O[O.Shadow17=16]="Shadow17",O[O.Shadow18=17]="Shadow18",O[O.Shadow19=18]="Shadow19",O[O.Shadow20=19]="Shadow20",O[O.Shadow21=20]="Shadow21",O[O.Shadow22=21]="Shadow22",O[O.Shadow23=22]="Shadow23",O[O.Shadow24=23]="Shadow24",O[O.Shadow25=24]="Shadow25",O[O.Shadow26=25]="Shadow26",O[O.Shadow27=26]="Shadow27",O[O.Shadow28=27]="Shadow28",O[O.Shadow29=28]="Shadow29",O[O.Shadow30=29]="Shadow30",O[O.Shadow31=30]="Shadow31",O[O.Shadow32=31]="Shadow32",O[O.Shadow33=32]="Shadow33",O[O.Shadow34=33]="Shadow34",O[O.Shadow35=34]="Shadow35",O[O.Shadow36=35]="Shadow36",O[O.Shadow37=36]="Shadow37",O[O.Shadow38=37]="Shadow38",O[O.Shadow39=38]="Shadow39",O[O.Shadow40=39]="Shadow40",O[O.Shadow41=40]="Shadow41",O[O.Shadow42=41]="Shadow42",O[O.Shadow43=42]="Shadow43",(O=xt=t.ShadowStyle||(t.ShadowStyle={}))[O.ShadowStyleInnerShadow=0]="ShadowStyleInnerShadow",O[O.ShadowStyleOuterShadow=1]="ShadowStyleOuterShadow",(O=Nt=t.SoftEdgeType||(t.SoftEdgeType={}))[O.SoftEdgeTypeNone=0]="SoftEdgeTypeNone",O[O.SoftEdgeType1=1]="SoftEdgeType1",O[O.SoftEdgeType2=2]="SoftEdgeType2",O[O.SoftEdgeType3=3]="SoftEdgeType3",O[O.SoftEdgeType4=4]="SoftEdgeType4",O[O.SoftEdgeType5=5]="SoftEdgeType5",O[O.SoftEdgeType6=6]="SoftEdgeType6",(O=kt=t.PresetCamera||(t.PresetCamera={}))[O.CameraLegacyObliqueTopLeft=0]="CameraLegacyObliqueTopLeft",O[O.CameraLegacyObliqueTop=1]="CameraLegacyObliqueTop",O[O.CameraLegacyObliqueTopRight=2]="CameraLegacyObliqueTopRight",O[O.CameraLegacyObliqueLeft=3]="CameraLegacyObliqueLeft",O[O.CameraLegacyObliqueFront=4]="CameraLegacyObliqueFront",O[O.CameraLegacyObliqueRight=5]="CameraLegacyObliqueRight",O[O.CameraLegacyObliqueBottomLeft=6]="CameraLegacyObliqueBottomLeft",O[O.CameraLegacyObliqueBottom=7]="CameraLegacyObliqueBottom",O[O.CameraLegacyObliqueBottomRight=8]="CameraLegacyObliqueBottomRight",O[O.CameraLegacyPerspectiveTopLeft=9]="CameraLegacyPerspectiveTopLeft",O[O.CameraLegacyPerspectiveTop=10]="CameraLegacyPerspectiveTop",O[O.CameraLegacyPerspectiveTopRight=11]="CameraLegacyPerspectiveTopRight",O[O.CameraLegacyPerspectiveLeft=12]="CameraLegacyPerspectiveLeft",O[O.CameraLegacyPerspectiveFront=13]="CameraLegacyPerspectiveFront",O[O.CameraLegacyPerspectiveRight=14]="CameraLegacyPerspectiveRight",O[O.CameraLegacyPerspectiveBottomLeft=15]="CameraLegacyPerspectiveBottomLeft",O[O.CameraLegacyPerspectiveBottom=16]="CameraLegacyPerspectiveBottom",O[O.CameraLegacyPerspectiveBottomRight=17]="CameraLegacyPerspectiveBottomRight",O[O.CameraOrthographicFront=18]="CameraOrthographicFront",O[O.CameraIsometricTopUp=19]="CameraIsometricTopUp",O[O.CameraIsometricTopDown=20]="CameraIsometricTopDown",O[O.CameraIsometricBottomUp=21]="CameraIsometricBottomUp",O[O.CameraIsometricBottomDown=22]="CameraIsometricBottomDown",O[O.CameraIsometricLeftUp=23]="CameraIsometricLeftUp",O[O.CameraIsometricLeftDown=24]="CameraIsometricLeftDown",O[O.CameraIsometricRightUp=25]="CameraIsometricRightUp",O[O.CameraIsometricRightDown=26]="CameraIsometricRightDown",O[O.CameraIsometricOffAxis1Left=27]="CameraIsometricOffAxis1Left",O[O.CameraIsometricOffAxis1Right=28]="CameraIsometricOffAxis1Right",O[O.CameraIsometricOffAxis1Top=29]="CameraIsometricOffAxis1Top",O[O.CameraIsometricOffAxis2Left=30]="CameraIsometricOffAxis2Left",O[O.CameraIsometricOffAxis2Right=31]="CameraIsometricOffAxis2Right",O[O.CameraIsometricOffAxis2Top=32]="CameraIsometricOffAxis2Top",O[O.CameraIsometricOffAxis3Left=33]="CameraIsometricOffAxis3Left",O[O.CameraIsometricOffAxis3Right=34]="CameraIsometricOffAxis3Right",O[O.CameraIsometricOffAxis3Bottom=35]="CameraIsometricOffAxis3Bottom",O[O.CameraIsometricOffAxis4Left=36]="CameraIsometricOffAxis4Left",O[O.CameraIsometricOffAxis4Right=37]="CameraIsometricOffAxis4Right",O[O.CameraIsometricOffAxis4Bottom=38]="CameraIsometricOffAxis4Bottom",O[O.CameraObliqueTopLeft=39]="CameraObliqueTopLeft",O[O.CameraObliqueTop=40]="CameraObliqueTop",O[O.CameraObliqueTopRight=41]="CameraObliqueTopRight",O[O.CameraObliqueLeft=42]="CameraObliqueLeft",O[O.CameraObliqueRight=43]="CameraObliqueRight",O[O.CameraObliqueBottomLeft=44]="CameraObliqueBottomLeft",O[O.CameraObliqueBottom=45]="CameraObliqueBottom",O[O.CameraObliqueBottomRight=46]="CameraObliqueBottomRight",O[O.CameraPerspectiveFront=47]="CameraPerspectiveFront",O[O.CameraPerspectiveLeft=48]="CameraPerspectiveLeft",O[O.CameraPerspectiveRight=49]="CameraPerspectiveRight",O[O.CameraPerspectiveAbove=50]="CameraPerspectiveAbove",O[O.CameraPerspectiveBelow=51]="CameraPerspectiveBelow",O[O.CameraPerspectiveAboveLeftFacing=52]="CameraPerspectiveAboveLeftFacing",O[O.CameraPerspectiveAboveRightFacing=53]="CameraPerspectiveAboveRightFacing",O[O.CameraPerspectiveContrastingLeftFacing=54]="CameraPerspectiveContrastingLeftFacing",O[O.CameraPerspectiveContrastingRightFacing=55]="CameraPerspectiveContrastingRightFacing",O[O.CameraPerspectiveHeroicLeftFacing=56]="CameraPerspectiveHeroicLeftFacing",O[O.CameraPerspectiveHeroicRightFacing=57]="CameraPerspectiveHeroicRightFacing",O[O.CameraPerspectiveHeroicExtremeLeftFacing=58]="CameraPerspectiveHeroicExtremeLeftFacing",O[O.CameraPerspectiveHeroicExtremeRightFacing=59]="CameraPerspectiveHeroicExtremeRightFacing",O[O.CameraPerspectiveRelaxed=60]="CameraPerspectiveRelaxed",O[O.CameraPerspectiveRelaxedModerately=61]="CameraPerspectiveRelaxedModerately",O[O.PresetCameraNone=62]="PresetCameraNone",(O=Dt=t.PresetLightingDirection||(t.PresetLightingDirection={}))[O.LightingTopLeft=0]="LightingTopLeft",O[O.LightingTop=1]="LightingTop",O[O.LightingTopRight=2]="LightingTopRight",O[O.LightingLeft=3]="LightingLeft",O[O.LightingNone=4]="LightingNone",O[O.LightingRight=5]="LightingRight",O[O.LightingBottomLeft=6]="LightingBottomLeft",O[O.LightingBottom=7]="LightingBottom",O[O.LightingBottomRight=8]="LightingBottomRight",(O=_t=t.LightRigType||(t.LightRigType={}))[O.LightRigLegacyFlat1=0]="LightRigLegacyFlat1",O[O.LightRigLegacyFlat2=1]="LightRigLegacyFlat2",O[O.LightRigLegacyFlat3=2]="LightRigLegacyFlat3",O[O.LightRigLegacyFlat4=3]="LightRigLegacyFlat4",O[O.LightRigLegacyNormal1=4]="LightRigLegacyNormal1",O[O.LightRigLegacyNormal2=5]="LightRigLegacyNormal2",O[O.LightRigLegacyNormal3=6]="LightRigLegacyNormal3",O[O.LightRigLegacyNormal4=7]="LightRigLegacyNormal4",O[O.LightRigLegacyHarsh1=8]="LightRigLegacyHarsh1",O[O.LightRigLegacyHarsh2=9]="LightRigLegacyHarsh2",O[O.LightRigLegacyHarsh3=10]="LightRigLegacyHarsh3",O[O.LightRigLegacyHarsh4=11]="LightRigLegacyHarsh4",O[O.LightRigThreePoint=12]="LightRigThreePoint",O[O.LightRigBalanced=13]="LightRigBalanced",O[O.LightRigSoft=14]="LightRigSoft",O[O.LightRigHarsh=15]="LightRigHarsh",O[O.LightRigFlood=16]="LightRigFlood",O[O.LightRigContrasting=17]="LightRigContrasting",O[O.LightRigMorning=18]="LightRigMorning",O[O.LightRigSunrise=19]="LightRigSunrise",O[O.LightRigSunset=20]="LightRigSunset",O[O.LightRigChilly=21]="LightRigChilly",O[O.LightRigFreezing=22]="LightRigFreezing",O[O.LightRigFlat=23]="LightRigFlat",O[O.LightRigTwoPoint=24]="LightRigTwoPoint",O[O.LightRigGlow=25]="LightRigGlow",O[O.LightRigBrightRoom=26]="LightRigBrightRoom",(O=Et=t.LightRigDirection||(t.LightRigDirection={}))[O.tl=0]="tl",O[O.t=1]="t",O[O.tr=2]="tr",O[O.l=3]="l",O[O.r=4]="r",O[O.bl=5]="bl",O[O.b=6]="b",O[O.br=7]="br",(O=jt=t.AxisType||(t.AxisType={}))[O.Category=0]="Category",O[O.Value=1]="Value",O[O.SeriesAxis=2]="SeriesAxis",(O=Ot=t.TickLabelPosition||(t.TickLabelPosition={}))[O.high=0]="high",O[O.low=1]="low",O[O.nextToAxis=2]="nextToAxis",O[O.none=3]="none",(O=Rt=t.ScaleType||(t.ScaleType={}))[O.ScaleLogarithmic=0]="ScaleLogarithmic",O[O.ScaleLinear=1]="ScaleLinear",(O=Bt=t.TimeUnit||(t.TimeUnit={}))[O.days=0]="days",O[O.months=1]="months",O[O.years=2]="years",(O=Lt=t.TickMark||(t.TickMark={}))[O.cross=0]="cross",O[O.inside=1]="inside",O[O.none=2]="none",O[O.outside=3]="outside",(O=Ft=t.DisplayUnit||(t.DisplayUnit={})).hundreds="hundreds",O.thousands="thousands",O.tenThousands="tenThousands",O.hundredThousands="hundredThousands",O.millions="millions",O.tenMillions="tenMillions",O.hundredMillions="hundredMillions",O.billions="billions",O.trillions="trillions",(O=Pt=t.AxisCrossPoint||(t.AxisCrossPoint={})).automatic="auto",O.maximum="max",O.minimum="min",(O=Gt=t.AxisOrientation||(t.AxisOrientation={}))[O.minMax=0]="minMax",O[O.maxMin=1]="maxMin",(O=Ut=t.CategoryType||(t.CategoryType={}))[O.AutomaticScale=0]="AutomaticScale",O[O.CategoryScale=1]="CategoryScale",O[O.TimeScale=2]="TimeScale",O[O.ValueScale=3]="ValueScale",(O=Ht=t.AxisGroup||(t.AxisGroup={}))[O.primary=0]="primary",O[O.secondary=1]="secondary",(O=zt=t.ST_Shape||(t.ST_Shape={}))[O.cone=0]="cone",O[O.coneToMax=1]="coneToMax",O[O.box=2]="box",O[O.cylinder=3]="cylinder",O[O.pyramid=4]="pyramid",O[O.pyramidToMax=5]="pyramidToMax",(O=Vt=t.ST_ParentLabelLayout||(t.ST_ParentLabelLayout={}))[O.none=0]="none",O[O.banner=1]="banner",O[O.overlapping=2]="overlapping",(O=Yt=t.ST_RegionLabelLayout||(t.ST_RegionLabelLayout={}))[O.none=0]="none",O[O.bestFitOnly=1]="bestFitOnly",O[O.showAll=2]="showAll",(O=Zt=t.BarShape||(t.BarShape={}))[O.ConeToPoint=0]="ConeToPoint",O[O.ConeToMax=1]="ConeToMax",O[O.Box=2]="Box",O[O.Cylinder=3]="Cylinder",O[O.PyramidToPoint=4]="PyramidToPoint",O[O.PyramidToMax=5]="PyramidToMax",(O=Wt=t.ChartType||(t.ChartType={}))[O.combo=0]="combo",O[O.xyScatter=1]="xyScatter",O[O.radar=2]="radar",O[O.doughnut=3]="doughnut",O[O.pie3D=4]="pie3D",O[O.line3D=5]="line3D",O[O.column3D=6]="column3D",O[O.area3D=7]="area3D",O[O.area=8]="area",O[O.line=9]="line",O[O.pie=10]="pie",O[O.bubble=11]="bubble",O[O.columnClustered=12]="columnClustered",O[O.columnStacked=13]="columnStacked",O[O.columnStacked100=14]="columnStacked100",O[O.columnClustered3D=15]="columnClustered3D",O[O.columnStacked3D=16]="columnStacked3D",O[O.columnStacked1003D=17]="columnStacked1003D",O[O.barClustered=18]="barClustered",O[O.barStacked=19]="barStacked",O[O.barStacked100=20]="barStacked100",O[O.barClustered3D=21]="barClustered3D",O[O.barStacked3D=22]="barStacked3D",O[O.barStacked1003D=23]="barStacked1003D",O[O.lineStacked=24]="lineStacked",O[O.lineStacked100=25]="lineStacked100",O[O.lineMarkers=26]="lineMarkers",O[O.lineMarkersStacked=27]="lineMarkersStacked",O[O.lineMarkersStacked100=28]="lineMarkersStacked100",O[O.pieOfPie=29]="pieOfPie",O[O.pieExploded=30]="pieExploded",O[O.pieExploded3D=31]="pieExploded3D",O[O.barOfPie=32]="barOfPie",O[O.xyScatterSmooth=33]="xyScatterSmooth",O[O.xyScatterSmoothNoMarkers=34]="xyScatterSmoothNoMarkers",O[O.xyScatterLines=35]="xyScatterLines",O[O.xyScatterLinesNoMarkers=36]="xyScatterLinesNoMarkers",O[O.areaStacked=37]="areaStacked",O[O.areaStacked100=38]="areaStacked100",O[O.areaStacked3D=39]="areaStacked3D",O[O.areaStacked1003D=40]="areaStacked1003D",O[O.doughnutExploded=41]="doughnutExploded",O[O.radarMarkers=42]="radarMarkers",O[O.radarFilled=43]="radarFilled",O[O.surface=44]="surface",O[O.surfaceWireframe=45]="surfaceWireframe",O[O.surfaceTopView=46]="surfaceTopView",O[O.surfaceTopViewWireframe=47]="surfaceTopViewWireframe",O[O.bubble3DEffect=48]="bubble3DEffect",O[O.stockHLC=49]="stockHLC",O[O.stockOHLC=50]="stockOHLC",O[O.stockVHLC=51]="stockVHLC",O[O.stockVOHLC=52]="stockVOHLC",O[O.boxWhisker=53]="boxWhisker",O[O.funnel=54]="funnel",O[O.paretoLine=55]="paretoLine",O[O.regionMap=56]="regionMap",O[O.sunburst=57]="sunburst",O[O.treemap=58]="treemap",O[O.waterfall=59]="waterfall",O[O.clusteredColumn=60]="clusteredColumn",(O=Qt=t.ST_TrendlineType||(t.ST_TrendlineType={}))[O.exp=0]="exp",O[O.linear=1]="linear",O[O.log=2]="log",O[O.movingAvg=3]="movingAvg",O[O.poly=4]="poly",O[O.power=5]="power",(O=Jt=t.TrendlineType||(t.TrendlineType={}))[O.exponential=0]="exponential",O[O.linear=1]="linear",O[O.logarithmic=2]="logarithmic",O[O.movingAverage=3]="movingAverage",O[O.polynomial=4]="polynomial",O[O.power=5]="power",(O=Kt=t.ST_DLblPos||(t.ST_DLblPos={}))[O.bestFit=0]="bestFit",O[O.b=1]="b",O[O.ctr=2]="ctr",O[O.inBase=3]="inBase",O[O.inEnd=4]="inEnd",O[O.l=5]="l",O[O.outEnd=6]="outEnd",O[O.r=7]="r",O[O.t=8]="t",(O=Xt=t.DataLabelPosition||(t.DataLabelPosition={}))[O.bestFit=0]="bestFit",O[O.below=1]="below",O[O.center=2]="center",O[O.insideBase=3]="insideBase",O[O.insideEnd=4]="insideEnd",O[O.left=5]="left",O[O.outsideEnd=6]="outsideEnd",O[O.right=7]="right",O[O.above=8]="above",(O=qt=t.MarkerStyle||(t.MarkerStyle={}))[O.MarkerStyleCircle=0]="MarkerStyleCircle",O[O.MarkerStyleDash=1]="MarkerStyleDash",O[O.MarkerStyleDiamond=2]="MarkerStyleDiamond",O[O.MarkerStyleDot=3]="MarkerStyleDot",O[O.MarkerStyleNone=4]="MarkerStyleNone",O[O.MarkerStylePicture=5]="MarkerStylePicture",O[O.MarkerStylePlus=6]="MarkerStylePlus",O[O.MarkerStyleSquare=7]="MarkerStyleSquare",O[O.MarkerStyleStar=8]="MarkerStyleStar",O[O.MarkerStyleTriangle=9]="MarkerStyleTriangle",O[O.MarkerStyleX=10]="MarkerStyleX",O[O.MarkerStyleAutomatic=11]="MarkerStyleAutomatic",(O=$t=t.ST_ErrDir||(t.ST_ErrDir={}))[O.x=0]="x",O[O.y=1]="y",(O=tn=t.ErrorBarType||(t.ErrorBarType={}))[O.both=0]="both",O[O.minus=1]="minus",O[O.plus=2]="plus",(O=nn=t.ST_ErrValType||(t.ST_ErrValType={}))[O.cust=0]="cust",O[O.fixedVal=1]="fixedVal",O[O.percentage=2]="percentage",O[O.stdDev=3]="stdDev",O[O.stdErr=4]="stdErr",(O=en=t.ErrorBarValueType||(t.ErrorBarValueType={}))[O.custom=0]="custom",O[O.fixedValue=1]="fixedValue",O[O.percentage=2]="percentage",O[O.standardDeviation=3]="standardDeviation",O[O.standardError=4]="standardError",(O=rn=t.DrawingPictureType||(t.DrawingPictureType={}))[O.Stretch=0]="Stretch",O[O.Stack=1]="Stack",O[O.StackScale=2]="StackScale",(O=on=t.SizeRepresents||(t.SizeRepresents={}))[O.SizeIsArea=0]="SizeIsArea",O[O.SizeIsWidth=1]="SizeIsWidth",(O=an=t.ChartSplitType||(t.ChartSplitType={}))[O.SplitByPosition=0]="SplitByPosition",O[O.SplitByValue=1]="SplitByValue",O[O.SplitByPercentValue=2]="SplitByPercentValue",O[O.SplitByCustomSplit=3]="SplitByCustomSplit",(O=un=t.LegendPosition||(t.LegendPosition={}))[O.custom=0]="custom",O[O.top=1]="top",O[O.right=2]="right",O[O.left=3]="left",O[O.bottom=4]="bottom",O[O.topRight=5]="topRight",(O=sn=t.RowCol||(t.RowCol={}))[O.rows=0]="rows",O[O.columns=1]="columns",(O=cn=t.SymbolShape||(t.SymbolShape={}))[O.circle=0]="circle",O[O.dash=1]="dash",O[O.diamond=2]="diamond",O[O.dot=3]="dot",O[O.none=4]="none",O[O.picture=5]="picture",O[O.plus=6]="plus",O[O.square=7]="square",O[O.star=8]="star",O[O.triangle=9]="triangle",O[O.x=10]="x",(O=fn=t.LineType||(t.LineType={}))[O.solid=0]="solid",O[O.dot=1]="dot",O[O.dash=2]="dash",O[O.lgDash=3]="lgDash",O[O.dashDot=4]="dashDot",O[O.lgDashDot=5]="lgDashDot",O[O.lgDashDotDot=6]="lgDashDotDot",O[O.sysDash=7]="sysDash",O[O.sysDot=8]="sysDot",O[O.sysDashDot=9]="sysDashDot",O[O.sysDashDotDot=10]="sysDashDotDot",(O=ln=t.VertAlignType||(t.VertAlignType={}))[O.Baseline=0]="Baseline",O[O.Superscript=1]="Superscript",O[O.Subscript=2]="Subscript",(O=hn=t.Placement||(t.Placement={}))[O.MoveAndSize=0]="MoveAndSize",O[O.Move=1]="Move",O[O.FreeFloating=2]="FreeFloating",(O=dn=t.ChartElements||(t.ChartElements={}))[O.All=0]="All",O[O.Chart=1]="Chart",O[O.PlotArea=2]="PlotArea",O[O.Series=3]="Series",O[O.SeriesCollection=4]="SeriesCollection",O[O.Point=5]="Point",O[O.DataLabel=6]="DataLabel",O[O.DataMarker=7]="DataMarker",O[O.CategoryAxis=8]="CategoryAxis",O[O.ValueAxis=9]="ValueAxis",O[O.SeriesAxis=10]="SeriesAxis",O[O.Lengend=11]="Lengend",O[O.FloorWall=12]="FloorWall",O[O.SideWall=13]="SideWall",O[O.BackWall=14]="BackWall",O[O.ChartTitle=15]="ChartTitle",O[O.AxisTitle=16]="AxisTitle",O[O.ChartGroup=17]="ChartGroup",(O=vn=t.ImageType||(t.ImageType={}))[O.PNG=0]="PNG",O[O.JPG=1]="JPG",O[O.JPEG=2]="JPEG",O[O.EMF=3]="EMF",(O=mn=t.SolidColorType||(t.SolidColorType={}))[O.None=0]="None",O[O.Automatic=1]="Automatic",O[O.RGB=2]="RGB",O[O.Theme=3]="Theme",(O=gn=t.TextUnderlineType||(t.TextUnderlineType={}))[O.None=0]="None",O[O.Words=1]="Words",O[O.Single=2]="Single",O[O.Double=3]="Double",O[O.Heavy=4]="Heavy",O[O.Dotted=5]="Dotted",O[O.DottedHeavy=6]="DottedHeavy",O[O.Dash=7]="Dash",O[O.DashHeavy=8]="DashHeavy",O[O.DashLong=9]="DashLong",O[O.DashLongHeavy=10]="DashLongHeavy",O[O.DotDash=11]="DotDash",O[O.DotDashHeavy=12]="DotDashHeavy",O[O.DotDotDash=13]="DotDotDash",O[O.DotDotDashHeavy=14]="DotDotDashHeavy",O[O.Wavy=15]="Wavy",O[O.WavyHeavy=16]="WavyHeavy",O[O.WavyDouble=17]="WavyDouble",(O=pn=t.ReflectionType||(t.ReflectionType={}))[O.ReflectionTypeNone=0]="ReflectionTypeNone",O[O.ReflectionType1=1]="ReflectionType1",O[O.ReflectionType2=2]="ReflectionType2",O[O.ReflectionType3=3]="ReflectionType3",O[O.ReflectionType4=4]="ReflectionType4",O[O.ReflectionType5=5]="ReflectionType5",O[O.ReflectionType6=6]="ReflectionType6",O[O.ReflectionType7=7]="ReflectionType7",O[O.ReflectionType8=8]="ReflectionType8",O[O.ReflectionType9=9]="ReflectionType9",(O=bn=t.TextFieldType||(t.TextFieldType={}))[O.CellRange=0]="CellRange",O[O.SeriesName=1]="SeriesName",O[O.CategoryName=2]="CategoryName",O[O.Value=3]="Value",O[O.XValue=4]="XValue",O[O.YValue=5]="YValue",O[O.BubbleSize=6]="BubbleSize",O[O.Percentage=7]="Percentage",O[O.TxLink=8]="TxLink",(O=yn=t.UnderlineType||(t.UnderlineType={}))[O.None=0]="None",O[O.Single=1]="Single",O[O.Double=2]="Double",O[O.SingleAccounting=3]="SingleAccounting",O[O.DoubleAccounting=4]="DoubleAccounting",(O=wn=t.ColorType||(t.ColorType={}))[O.None=0]="None",O[O.Auto=1]="Auto",O[O.RGB=2]="RGB",O[O.Index=3]="Index",O[O.Theme=4]="Theme",(O=Mn=t.DisplayBlanksAs||(t.DisplayBlanksAs={}))[O.connected=0]="connected",O[O.gaps=1]="gaps",O[O.zero=2]="zero",(O=Cn=t.ST_TickMark||(t.ST_TickMark={}))[O.cross=0]="cross",O[O.in=1]="in",O[O.none=2]="none",O[O.out=3]="out",(O=Sn=t.ST_TickLblPos||(t.ST_TickLblPos={}))[O.high=0]="high",O[O.low=1]="low",O[O.nextTo=2]="nextTo",O[O.none=3]="none",(O=Tn=t.ST_BuiltInUnit||(t.ST_BuiltInUnit={}))[O.hundreds=0]="hundreds",O[O.thousands=1]="thousands",O[O.tenThousands=2]="tenThousands",O[O.hundredThousands=3]="hundredThousands",O[O.millions=4]="millions",O[O.tenMillions=5]="tenMillions",O[O.hundredMillions=6]="hundredMillions",O[O.billions=7]="billions",O[O.trillions=8]="trillions",(O=An=t.ST_TickMarksType||(t.ST_TickMarksType={}))[O.in=1]="in",O[O.out=3]="out",O[O.cross=0]="cross",O[O.none=2]="none",(O=In=t.ST_Crosses||(t.ST_Crosses={}))[O.autoZero=1]="autoZero",O[O.max=2]="max",O[O.min=3]="min",(O=xn=t.ST_PosAlign||(t.ST_PosAlign={}))[O.min=0]="min",O[O.ctr=1]="ctr",O[O.max=2]="max",(O=Nn=t.ST_LegendPos||(t.ST_LegendPos={}))[O.b=4]="b",O[O.tr=5]="tr",O[O.l=3]="l",O[O.r=2]="r",O[O.t=1]="t",(O=kn=t.ST_LayoutMode||(t.ST_LayoutMode={}))[O.edge=0]="edge",O[O.factor=1]="factor",(O=Dn=t.ST_LayoutTarget||(t.ST_LayoutTarget={}))[O.inner=0]="inner",O[O.outer=1]="outer",(O=_n=t.ST_MarkerStyle||(t.ST_MarkerStyle={}))[O.circle=0]="circle",O[O.dash=1]="dash",O[O.diamond=2]="diamond",O[O.dot=3]="dot",O[O.none=4]="none",O[O.picture=5]="picture",O[O.plus=6]="plus",O[O.square=7]="square",O[O.star=8]="star",O[O.triangle=9]="triangle",O[O.x=10]="x",(O=En=t.ST_SplitType||(t.ST_SplitType={}))[O.auto=0]="auto",O[O.cust=1]="cust",O[O.percent=2]="percent",O[O.pos=3]="pos",O[O.val=4]="val",(O=jn=t.ST_SizeRepresents||(t.ST_SizeRepresents={}))[O.area=0]="area",O[O.w=1]="w",(O=On=t.ST_DispBlanksAs||(t.ST_DispBlanksAs={}))[O.span=0]="span",O[O.gap=1]="gap",O[O.zero=2]="zero",(O=Rn=t.ST_PresetCameraType||(t.ST_PresetCameraType={}))[O.legacyObliqueTopLeft=0]="legacyObliqueTopLeft",O[O.legacyObliqueTop=1]="legacyObliqueTop",O[O.legacyObliqueTopRight=2]="legacyObliqueTopRight",O[O.legacyObliqueLeft=3]="legacyObliqueLeft",O[O.legacyObliqueFront=4]="legacyObliqueFront",O[O.legacyObliqueRight=5]="legacyObliqueRight",O[O.legacyObliqueBottomLeft=6]="legacyObliqueBottomLeft",O[O.legacyObliqueBottom=7]="legacyObliqueBottom",O[O.legacyObliqueBottomRight=8]="legacyObliqueBottomRight",O[O.legacyPerspectiveTopLeft=9]="legacyPerspectiveTopLeft",O[O.legacyPerspectiveTop=10]="legacyPerspectiveTop",O[O.legacyPerspectiveTopRight=11]="legacyPerspectiveTopRight",O[O.legacyPerspectiveLeft=12]="legacyPerspectiveLeft",O[O.legacyPerspectiveFront=13]="legacyPerspectiveFront",O[O.legacyPerspectiveRight=14]="legacyPerspectiveRight",O[O.legacyPerspectiveBottomLeft=15]="legacyPerspectiveBottomLeft",O[O.legacyPerspectiveBottom=16]="legacyPerspectiveBottom",O[O.legacyPerspectiveBottomRight=17]="legacyPerspectiveBottomRight",O[O.orthographicFront=18]="orthographicFront",O[O.isometricTopUp=19]="isometricTopUp",O[O.isometricTopDown=20]="isometricTopDown",O[O.isometricBottomUp=21]="isometricBottomUp",O[O.isometricBottomDown=22]="isometricBottomDown",O[O.isometricLeftUp=23]="isometricLeftUp",O[O.isometricLeftDown=24]="isometricLeftDown",O[O.isometricRightUp=25]="isometricRightUp",O[O.isometricRightDown=26]="isometricRightDown",O[O.isometricOffAxis1Left=27]="isometricOffAxis1Left",O[O.isometricOffAxis1Right=28]="isometricOffAxis1Right",O[O.isometricOffAxis1Top=29]="isometricOffAxis1Top",O[O.isometricOffAxis2Left=30]="isometricOffAxis2Left",O[O.isometricOffAxis2Right=31]="isometricOffAxis2Right",O[O.isometricOffAxis2Top=32]="isometricOffAxis2Top",O[O.isometricOffAxis3Left=33]="isometricOffAxis3Left",O[O.isometricOffAxis3Right=34]="isometricOffAxis3Right",O[O.isometricOffAxis3Bottom=35]="isometricOffAxis3Bottom",O[O.isometricOffAxis4Left=36]="isometricOffAxis4Left",O[O.isometricOffAxis4Right=37]="isometricOffAxis4Right",O[O.isometricOffAxis4Bottom=38]="isometricOffAxis4Bottom",O[O.obliqueTopLeft=39]="obliqueTopLeft",O[O.obliqueTop=40]="obliqueTop",O[O.obliqueTopRight=41]="obliqueTopRight",O[O.obliqueLeft=42]="obliqueLeft",O[O.obliqueRight=43]="obliqueRight",O[O.obliqueBottomLeft=44]="obliqueBottomLeft",O[O.obliqueBottom=45]="obliqueBottom",O[O.obliqueBottomRight=46]="obliqueBottomRight",O[O.perspectiveFront=47]="perspectiveFront",O[O.perspectiveLeft=48]="perspectiveLeft",O[O.perspectiveRight=49]="perspectiveRight",O[O.perspectiveAbove=50]="perspectiveAbove",O[O.perspectiveBelow=51]="perspectiveBelow",O[O.perspectiveAboveLeftFacing=52]="perspectiveAboveLeftFacing",O[O.perspectiveAboveRightFacing=53]="perspectiveAboveRightFacing",O[O.perspectiveContrastingLeftFacing=54]="perspectiveContrastingLeftFacing",O[O.perspectiveContrastingRightFacing=55]="perspectiveContrastingRightFacing",O[O.perspectiveHeroicLeftFacing=56]="perspectiveHeroicLeftFacing",O[O.perspectiveHeroicRightFacing=57]="perspectiveHeroicRightFacing",O[O.perspectiveHeroicExtremeLeftFacing=58]="perspectiveHeroicExtremeLeftFacing",O[O.perspectiveHeroicExtremeRightFacing=59]="perspectiveHeroicExtremeRightFacing",O[O.perspectiveRelaxed=60]="perspectiveRelaxed",O[O.perspectiveRelaxedModeratel=61]="perspectiveRelaxedModeratel",(O=Bn=t.ST_PresetLineDashVal||(t.ST_PresetLineDashVal={}))[O.solid=0]="solid",O[O.dot=1]="dot",O[O.dash=2]="dash",O[O.lgDash=3]="lgDash",O[O.dashDot=4]="dashDot",O[O.lgDashDot=5]="lgDashDot",O[O.lgDashDotDot=6]="lgDashDotDot",O[O.sysDash=7]="sysDash",O[O.sysDot=8]="sysDot",O[O.sysDashDot=9]="sysDashDot",O[O.sysDashDotDot=10]="sysDashDotDot";(O=Ln=t.ST_LineEndWidth||(t.ST_LineEndWidth={}))[O.sm=0]="sm",O[O.med=1]="med",O[O.lg=2]="lg",(O=Fn=t.ST_LineEndType||(t.ST_LineEndType={}))[O.none=0]="none",O[O.triangle=1]="triangle",O[O.stealth=2]="stealth",O[O.diamond=3]="diamond",O[O.oval=4]="oval",O[O.arrow=5]="arrow",(O=Pn=t.ST_LineEndLength||(t.ST_LineEndLength={}))[O.sm=0]="sm",O[O.med=1]="med",O[O.lg=2]="lg",(O=Gn=t.ST_AnchorType||(t.ST_AnchorType={}))[O.twoCellAnchor=0]="twoCellAnchor",O[O.oneCellAnchor=1]="oneCellAnchor",O[O.absoluteAnchor=2]="absoluteAnchor",O[O.groupShapeAnchor=3]="groupShapeAnchor",(O=Un=t.ST_2016ChartPosLegend||(t.ST_2016ChartPosLegend={}))[O.t=1]="t",O[O.r=2]="r",O[O.l=3]="l",O[O.b=4]="b",(O=Hn=t.LineFormatStates||(t.LineFormatStates={}))[O.Color=1]="Color",O[O.PatternColor=2]="PatternColor",O[O.BeginArrowheadLength=4]="BeginArrowheadLength",O[O.BeginArrowheadStyle=8]="BeginArrowheadStyle",O[O.BeginArrowheadWidth=16]="BeginArrowheadWidth",O[O.DashStyle=32]="DashStyle",O[O.EndArrowheadLength=64]="EndArrowheadLength",O[O.EndArrowheadStyle=128]="EndArrowheadStyle",O[O.EndArrowheadWidth=256]="EndArrowheadWidth",O[O.InsetPen=512]="InsetPen",O[O.Pattern=1024]="Pattern",O[O.Style=2048]="Style",O[O.Transparency=4096]="Transparency",O[O.Visible=8192]="Visible",O[O.Weight=16384]="Weight",O[O.CapStyle=32768]="CapStyle",O[O.JoinStyle=65536]="JoinStyle",(O=zn=t.ColorFormatStates||(t.ColorFormatStates={}))[O.Brightness=1]="Brightness",O[O.ObjectThemeColor=2]="ObjectThemeColor",O[O.RGB=4]="RGB",O[O.TintAndShade=8]="TintAndShade",O[O.ColorType=16]="ColorType",O[O.Transparency=32]="Transparency",O[O.SatMod=64]="SatMod",(O=Vn=t.PictureFormatType||(t.PictureFormatType={}))[O.PictureShape=0]="PictureShape",O[O.PictureFill=1]="PictureFill",O[O.TextureFill=2]="TextureFill",(O=Yn=t.ST_TimeUnit||(t.ST_TimeUnit={}))[O.days=0]="days",O[O.months=1]="months",O[O.years=2]="years"},"./dist/plugins/floatingObject/drawing/effects.js":function(t,n,e){"use strict";var i,r,c,o,f,a,l,h,u,s,d,v,m,g,p,b,e,e,y,w,M,e,C;function S(t,n){var e,i,e=y.call(this,n)||this,i=e;return i.xft=5,i.Nft=!1,i.kft=c.ShapeConstants.DefaultOffset,i.Dft=c.ShapeConstants.DefaultOffset,i._ft=!1,i.Eft=100,i.aft=0,i.jft=!1,i.presetShadowOffset=-6,i.DJ=t,i.sft=n,e}function T(t){return w.call(this,t)||this}function A(t,n){var e,i,e=M.call(this,n)||this,i=e;return i.Eft=100,i.uit=f.ReflectionType.ReflectionType1,i.presetShadowOffset=-6,i.DJ=t,i.sft=n,e}function I(t,n){var e=C.call(this,n)||this;return e.DJ=t,e.sft=n,e}i=this&&this.__extends||(b=function(t,n){return(b=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(t,n){t.__proto__=n}:function(t,n){for(var e in n)Object.prototype.hasOwnProperty.call(n,e)&&(t[e]=n[e])}))(t,n)},function(t,n){if("function"!=typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function e(){this.constructor=t}b(t,n),t.prototype=null===n?Object.create(n):(e.prototype=n.prototype,new e)}),Object.defineProperty(n,"__esModule",{value:!0}),n.GlowFormat=n.ReflectionFormat=n.SoftEdgeFormat=n.ShadowFormat=void 0,r=e("./dist/plugins/floatingObject/drawing/stateful.js"),c=e("./dist/plugins/floatingObject/drawing/common.js"),o=e("./dist/plugins/floatingObject/drawing/colorFormat.js"),f=e("./dist/plugins/floatingObject/drawing/drawingInterface.js"),(e=a=a||{})[e.Blur=1]="Blur",e[e.Offset=2]="Offset",e[e.Size=4]="Size",e[e.Transparency=8]="Transparency",e[e.Type=16]="Type",l=c.UnitHelper.isNullOrUndefined,h=Math.floor,u=Math.sqrt,(e=s=s||{})[e.Blur=1]="Blur",e[e.Obscured=2]="Obscured",e[e.OffsetX=4]="OffsetX",e[e.OffsetY=8]="OffsetY",e[e.RotateWithShape=16]="RotateWithShape",e[e.Size=32]="Size",e[e.Style=64]="Style",e[e.Transparency=128]="Transparency",e[e.Type=256]="Type",e[e.Visible=512]="Visible",y=r.StatefulBase,i(S,y),S.prototype.OnStyleChange=function(){var t=this;t.xft=0,t.kft=0,t.Dft=0,t.Eft=100,t.aft=0,t.UnDirty(s.Type),t.Style===f.ShadowStyle.ShadowStyleInnerShadow?t._ft=!1:t.Style===f.ShadowStyle.ShadowStyleOuterShadow&&(t._ft=!0)},S.prototype.OnTypeChange=function(){var t=this;t.xft=5,t.kft=t.presetShadowOffset,t.Dft=t.presetShadowOffset,t.Eft=100,t.aft=.5,t.UnDirty(s.Style)},S.prototype.GetDefaultColor=function(){var t=new o.ColorFormat(this.DJ,this.sft&&this.sft.Oft);return t.ColorType=f.SolidColorType.None,t},S.prototype.IncrementOffsetX=function(t){this.OffsetX+=t},S.prototype.IncrementOffsetY=function(t){this.OffsetY+=t},S.prototype.FromOOModel=function(t){this.cft=t},S.prototype.ToOOModel=function(){return this.cft},S.prototype.ToCT_PresetShadowEffect=function(){var t,n,e,i,r,t=this,n=t.OffsetX,e=t.OffsetY,i=u(n*n+e*e),r={dist:0,dir:0};return r.dist=i,r.dir=h(c.NumberExtension.GetTriangleAngle(n,e,i)*c.ShapeConstants.PositiveFixedAngleConvert),r.prst=t.Type,t.ToCT_Color(r),r},S.prototype.ToCT_InnerShadowEffect=function(){var t,n,e,i,r,t=this,n=t.OffsetX,e=t.OffsetY,i=u(n*n+e*e),r={blurRad:0,dist:0,dir:0};return r.blurRad=t.Blur,r.dist=i,0===n&&0===e||(r.dir=h(c.NumberExtension.GetTriangleAngle(n,e,i)*c.ShapeConstants.PositiveFixedAngleConvert)),r.scrgbClr=t.ToCT_ScRgbColor(),r},S.prototype.ToCT_OuterShadowEffect=function(){var t,n,e,i,r,t=this,n=t.OffsetX,e=t.OffsetY,i=u(n*n+e*e),r={blurRad:0,dist:0,dir:0,sx:1e5,sy:1e5,kx:0,ky:0,algn:f.TextureAlignment.TextureBottom,rotWithShape:!0};return r.blurRad=t.Blur,r.dist=i,0===n&&0===e||(r.dir=h(c.NumberExtension.GetTriangleAngle(n,e,i)*c.ShapeConstants.PositiveFixedAngleConvert)),r.rotWithShape=!0===t.RotateWithShape,r.sx=h(t.Size*c.ShapeConstants.RelativeRectConver),r.sy=h(t.Size*c.ShapeConstants.RelativeRectConver),r.scrgbClr=t.ToCT_ScRgbColor(),r},S.prototype.ToCT_Color=function(t){var n,e,i,r,o,o,n=this;l(n.Oft)||(n.Oft.ColorType===f.SolidColorType.Theme?((o={}).val=n.Oft.ObjectThemeColor,0!==n.Oft.Brightness&&(e=h(1e5*n.Oft.Brightness),o.lumMod=[e],i=h(1e5*(1-n.Oft.Brightness)),o.lumOff=[i]),0<n.Oft.TintAndShade&&n.Oft.TintAndShade<1&&(r=h(n.Oft.TintAndShade*c.ShapeConstants.ShadeConver),o.shade=[r]),t.schemeClr=o):n.Oft.ColorType===f.SolidColorType.RGB&&((o={}).val=[n.Oft.RGB.R,n.Oft.RGB.G,n.Oft.RGB.B],0!==n.Oft.Brightness&&(e=h(1e5*n.Oft.Brightness),o.lumMod=[e],i=h(1e5*(1-n.Oft.Brightness)),o.lumOff=[i]),0!==n.Transparency&&(r=h(n.Transparency*c.ShapeConstants.PositiveFixedPercentageConvert),o.alpha=[r]),t.srgbClr=o))},S.prototype.ToCT_ScRgbColor=function(){var t,n,t={};return 0!==this.Transparency&&(n=h(this.Transparency*c.ShapeConstants.PositiveFixedPercentageConvert),t.alpha=[n]),t},S.prototype.SetState=function(t,n){y.prototype.SetState.call(this,t,n),t!==s.Blur&&t!==s.OffsetX&&t!==s.OffsetY&&t!==s.RotateWithShape&&t!==s.Size&&t!==s.Transparency||this.GetState(s.Style)||(this.RN=f.ShadowStyle.ShadowStyleOuterShadow)},Object.defineProperty(S.prototype,"ForeColor",{get:function(){var t=this;return l(t.Oft)&&(t.Oft=t.GetDefaultColor()),t.Oft},enumerable:!1,configurable:!0}),Object.defineProperty(S.prototype,"Obscured",{get:function(){var t=this;return t.GetState(s.Obscured)||l(t.sft)?t.Nft:t.sft.Obscured},set:function(t){this.Nft=t,this.SetState(s.Obscured,!0)},enumerable:!1,configurable:!0}),Object.defineProperty(S.prototype,"Blur",{get:function(){var t=this;return t.GetState(s.Blur)||l(t.sft)?t.xft:t.sft.Blur},enumerable:!1,configurable:!0}),Object.defineProperty(S.prototype,"Blue",{set:function(t){this.xft=t,this.SetState(s.Blur,!0)},enumerable:!1,configurable:!0}),Object.defineProperty(S.prototype,"OffsetX",{get:function(){var t=this;return t.GetState(s.OffsetX)||l(t.sft)?t.kft:t.sft.OffsetX},set:function(t){this.kft=t,this.SetState(s.OffsetX,!0)},enumerable:!1,configurable:!0}),Object.defineProperty(S.prototype,"OffsetY",{get:function(){var t=this;return t.GetState(s.OffsetY)||l(t.sft)?t.Dft:t.sft.OffsetY},set:function(t){this.Dft=t,this.SetState(s.OffsetY,!0)},enumerable:!1,configurable:!0}),Object.defineProperty(S.prototype,"RotateWithShape",{get:function(){var t=this;return t.GetState(s.RotateWithShape)||l(t.sft)?t._ft:t.sft.RotateWithShape},set:function(t){var n=this;n.Style===f.ShadowStyle.ShadowStyleInnerShadow||n.GetState(s.Type)||(n._ft=t,n.SetState(s.RotateWithShape,!0))},enumerable:!1,configurable:!0}),Object.defineProperty(S.prototype,"Size",{get:function(){var t=this;return t.GetState(s.Size)||l(t.sft)?t.Eft:t.sft.Size},set:function(t){this.Eft=t,this.SetState(s.Size,!0)},enumerable:!1,configurable:!0}),Object.defineProperty(S.prototype,"Style",{get:function(){var t=this;return t.GetState(s.Style)||l(t.sft)?t.RN:t.sft.Style},set:function(t){var n=this;n.Style!==t&&n.OnStyleChange(),n.RN=t,n.SetState(s.Style,!0)},enumerable:!1,configurable:!0}),Object.defineProperty(S.prototype,"Transparency",{get:function(){var t=this;return t.GetState(s.Transparency)||l(t.sft)?t.aft:t.sft.Transparency},set:function(t){this.aft=t,this.SetState(s.Transparency,!0)},enumerable:!1,configurable:!0}),Object.defineProperty(S.prototype,"Type",{get:function(){var t=this;return t.GetState(s.Type)||l(t.sft)?t.uit:t.sft.Type},set:function(t){this.uit=t,this.SetState(s.Type,!0),this.OnTypeChange()},enumerable:!1,configurable:!0}),Object.defineProperty(S.prototype,"Visible",{get:function(){var t=this;return t.GetState(s.Visible)||l(t.sft)?t.jft:t.sft.Visible},set:function(t){var n=this;n.jft=t,n.SetState(s.Visible,!0),!1===t||n.GetState(s.Style)||(n.RN=f.ShadowStyle.ShadowStyleOuterShadow)},enumerable:!1,configurable:!0}),n.ShadowFormat=S,w=r.StatefulBase,i(T,w),T.prototype.FromOOModel=function(t){this.cft=t},T.prototype.ToOOModel=function(){return this.cft},n.SoftEdgeFormat=T,M=r.StatefulBase,i(A,M),Object.defineProperty(A.prototype,"Blur",{get:function(){var t=this;return t.GetState(a.Blur)||l(t.sft)?t.xft:t.sft.Blur},enumerable:!1,configurable:!0}),Object.defineProperty(A.prototype,"Blue",{set:function(t){this.xft=t,this.SetState(a.Blur,!0)},enumerable:!1,configurable:!0}),Object.defineProperty(A.prototype,"Offset",{get:function(){var t=this;return t.GetState(a.Offset)||l(t.sft)?t.Xy:t.sft.Offset},set:function(t){this.Xy=t,this.SetState(a.Offset,!0)},enumerable:!1,configurable:!0}),Object.defineProperty(A.prototype,"Size",{get:function(){var t=this;return t.GetState(a.Size)||l(t.sft)?t.Eft:t.sft.Size},set:function(t){this.Eft=t,this.SetState(a.Size,!0)},enumerable:!1,configurable:!0}),Object.defineProperty(A.prototype,"Transparency",{get:function(){var t=this;return t.GetState(a.Transparency)||l(t.sft)?t.aft:t.sft.Transparency},set:function(t){this.aft=t,this.SetState(a.Transparency,!0)},enumerable:!1,configurable:!0}),A.prototype.FromOOModel=function(t){this.cft=t},A.prototype.ToOOModel=function(){return this.cft},A.prototype.OnTypeChange=function(){var t=this;t.xft=5,t.Xy=t.presetShadowOffset,t.Eft=100,t.aft=.5},n.ReflectionFormat=A,(e=g=g||{})[e.Color=1]="Color",e[e.Radius=2]="Radius",e[e.Transparency=4]="Transparency",C=r.StatefulBase,i(I,C),Object.defineProperty(I.prototype,"Color",{get:function(){var t=this;return l(t._x)&&(t._x=t.GetDefaultColor()),t._x},enumerable:!1,configurable:!0}),Object.defineProperty(I.prototype,"Radius",{get:function(){var t=this;return t.GetState(g.Radius)||l(t.sft)?t.radius:t.sft.Radius},set:function(t){this.radius=t,this.Dirty(g.Radius)},enumerable:!1,configurable:!0}),Object.defineProperty(I.prototype,"Transparency",{get:function(){var t=this;return t.GetState(g.Transparency)||l(t.sft)?t.aft:t.sft.Transparency},set:function(t){this.aft=t,this.Dirty(g.Transparency)},enumerable:!1,configurable:!0}),I.prototype.FromOOModel=function(t){this.cft=t},I.prototype.ToOOModel=function(){return this.cft},I.prototype.GetDefaultColor=function(){var t=new o.ColorFormat(this.DJ,this.sft&&this.sft.Color);return t.ColorType=f.SolidColorType.None,t},I.prototype.SetState=function(t,n){var e=this;C.prototype.SetState.call(e,t,n),t!==g.Radius&&t!==g.Transparency||e._x&&e._x.ColorType===f.SolidColorType.None&&(e._x.ColorType=f.SolidColorType.RGB)},I.prototype.ToCT_Color=function(t){var n,e,i,r,o,a,u,s,s,n=this,o=n._x;l(o)||(a=o.ColorType,u=o.Brightness,a===f.SolidColorType.Theme?((s={}).val=o.ObjectThemeColor,0!==u&&(e=h(1e5*u),s.lumMod=[e],i=h(1e5*(1-u)),s.lumOff=[i]),0<o.TintAndShade&&o.TintAndShade<1&&(r=h(o.TintAndShade*c.ShapeConstants.ShadeConver),s.shade=[r]),t.schemeClr=s):a===f.SolidColorType.RGB&&((s={}).val=[o.RGB.R,o.RGB.G,o.RGB.B],0!==u&&(e=h(1e5*u),s.lumMod=[e],i=h(1e5*(1-u)),s.lumOff=[i]),0!==n.Transparency&&(r=h(n.Transparency*c.ShapeConstants.PositiveFixedPercentageConvert),s.alpha=[r]),t.srgbClr=s))},n.GlowFormat=I},"./dist/plugins/floatingObject/drawing/fillFormat.js":function(t,n,e){"use strict";var i,r,o,a,u,s,c,f,l,e,h,d,v,m,e,g,p,b,y,w,M,C,S,T,A,I,x,N,o,k;function D(t){return{l:String(t.l),t:String(t.t),r:String(t.r),b:String(t.b)}}function _(t,n,e,i){var r,o,r=k.call(this,n)||this,o=r;return o.Rft=!0,o.Bft=c.ST_PathShadeType.rect,o.Ox=c.PatternType.none,o.Lft=!0,o.jft=!0,o.Fft=C,o.DJ=t,o.uit=c.FillType.Solid,o.sft=n,o.Pft=e,o.Wc=i,o.Gft=new s.PictureFormat(c.PictureFormatType.PictureFill,n&&n.PictureFormat),o.Gft.Container=i,o.Uft=1,o.Hft=1,o.zft=new u.GradientStops(o.DJ),r}i=this&&this.__extends||(N=function(t,n){return(N=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(t,n){t.__proto__=n}:function(t,n){for(var e in n)Object.prototype.hasOwnProperty.call(n,e)&&(t[e]=n[e])}))(t,n)},function(t,n){if("function"!=typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function e(){this.constructor=t}N(t,n),t.prototype=null===n?Object.create(n):(e.prototype=n.prototype,new e)}),Object.defineProperty(n,"__esModule",{value:!0}),n.FillFormat=void 0,r=e("./dist/plugins/floatingObject/drawing/stateful.js"),o=e("./dist/plugins/floatingObject/drawing/common.js"),a=e("./dist/plugins/floatingObject/drawing/colorFormat.js"),u=e("./dist/plugins/floatingObject/drawing/gradient.js"),s=e("./dist/plugins/floatingObject/drawing/picture.js"),c=e("./dist/plugins/floatingObject/drawing/drawingInterface.js"),f=e("Core"),l=f.ExcelHelper.pixelToEMU,e=o.ShapeConstants,h=e.PositiveFixedPercentageConvert,d=e.PositiveFixedAngleConvert,v=e.PositionConver,m=o.ShapeUtility,e=o.UnitHelper,g=o.pft,p=o.ChartUtility,b=o.mft,y=f.NodeHelper.sr,w=f.NodeHelper.ur,M=e.isNullOrUndefined,C=null,S=void 0,T=Math.floor,A="The specified value is out of range",(o=I=I||{})[o.GradientStops=1]="GradientStops",o[o.GradientStyle=2]="GradientStyle",o[o.GradientColorType=4]="GradientColorType",o[o.Pattern=8]="Pattern",o[o.PresetTexture=16]="PresetTexture",o[o.RotateWithObject=32]="RotateWithObject",o[o.TextureAlignment=64]="TextureAlignment",o[o.TextureHorizontalScale=128]="TextureHorizontalScale",o[o.TextureName=256]="TextureName",o[o.TextureOffsetX=512]="TextureOffsetX",o[o.TextureOffsetY=1024]="TextureOffsetY",o[o.TextureTile=2048]="TextureTile",o[o.TextureType=4096]="TextureType",o[o.TextureVerticalScale=8192]="TextureVerticalScale",o[o.Transparency=16384]="Transparency",o[o.Type=32768]="Type",o[o.Visible=65536]="Visible",o[o.Color=131072]="Color",o[o.PatternColor=262144]="PatternColor",o[o.PictureFormat=524288]="PictureFormat",o[o.GradientDegree=1048576]="GradientDegree",o[o.GradientAngle=2097152]="GradientAngle",o[o.GradientVariant=4194304]="GradientVariant",o[o.PresetGradientType=8388608]="PresetGradientType",k=r.StatefulBase,i(_,k),Object.defineProperty(_.prototype,"Parent",{get:function(){return this.sft},enumerable:!1,configurable:!0}),Object.defineProperty(_.prototype,"PictureFormat",{get:function(){return this.Gft},set:function(t){var n,e,n=this;M(n.Gft)||n.Gft.SetParentForChildren(t),e=n.Gft,n.Gft=t,M(e)||(n.Gft.ParentStateful=e.ParentStateful)},enumerable:!1,configurable:!0}),Object.defineProperty(_.prototype,"PatternColor",{get:function(){return this.PatternColorInternal},enumerable:!1,configurable:!0}),Object.defineProperty(_.prototype,"Color",{get:function(){return this.ColorInternal},enumerable:!1,configurable:!0}),Object.defineProperty(_.prototype,"GradientAngle",{get:function(){var t=this;if(!t.IsDirty(I.GradientAngle)&&!M(t.sft))return t.sft.GradientAngle;if(t.GradientStyle===c.GradientStyle.GradientFromCenter||t.GradientStyle===c.GradientStyle.GradientFromCorner)throw new Error;return t.Vft},set:function(t){this.Vft=t,this.Dirty(I.GradientAngle)},enumerable:!1,configurable:!0}),Object.defineProperty(_.prototype,"GradientColorType",{get:function(){return this.GetGradientColorType()},enumerable:!1,configurable:!0}),Object.defineProperty(_.prototype,"GradientDegree",{get:function(){var t=this;return t.IsDirty(I.GradientDegree)||M(t.sft)?t.Yft:t.sft.GradientDegree},enumerable:!1,configurable:!0}),Object.defineProperty(_.prototype,"GradientStops",{get:function(){var t=this;return t.IsDirty(I.GradientStops)||M(t.sft)?t.zft:t.sft.GradientStops},enumerable:!1,configurable:!0}),Object.defineProperty(_.prototype,"GradientStyle",{get:function(){var t=this;return t.IsDirty(I.GradientStyle)||M(t.sft)?t.Zft:t.sft.GradientStyle},enumerable:!1,configurable:!0}),Object.defineProperty(_.prototype,"GradientVariant",{get:function(){var t=this;return t.IsDirty(I.GradientVariant)||M(t.sft)?t.Wft:t.sft.GradientVariant},enumerable:!1,configurable:!0}),Object.defineProperty(_.prototype,"Pattern",{get:function(){var t=this;return t.IsDirty(I.Pattern)||M(t.sft)?t.Ox:t.sft.Pattern},set:function(t){this.Ox=t,this.Dirty(I.Pattern)},enumerable:!1,configurable:!0}),Object.defineProperty(_.prototype,"PresetGradientType",{get:function(){var t=this;return t.IsDirty(I.PresetGradientType)||M(t.sft)?t.Qft:t.sft.PresetGradientType},enumerable:!1,configurable:!0}),Object.defineProperty(_.prototype,"RotateWithObject",{get:function(){var t=this;return t.IsDirty(I.RotateWithObject)||M(t.sft)?t.Lft:t.sft.RotateWithObject},set:function(t){this.Lft=t,this.Dirty(I.RotateWithObject)},enumerable:!1,configurable:!0}),Object.defineProperty(_.prototype,"TextureAlignment",{get:function(){var t=this;return t.IsDirty(I.TextureAlignment)||M(t.sft)?t.Kft:t.sft.TextureAlignment},set:function(t){this.Kft=t,this.Dirty(I.TextureAlignment)},enumerable:!1,configurable:!0}),Object.defineProperty(_.prototype,"TextureHorizontalScale",{get:function(){var t=this;return t.IsDirty(I.TextureHorizontalScale)||M(t.sft)?t.Uft:t.sft.TextureHorizontalScale},set:function(t){this.Uft=t,this.Dirty(I.TextureHorizontalScale)},enumerable:!1,configurable:!0}),Object.defineProperty(_.prototype,"TextureOffsetX",{get:function(){var t=this;return t.IsDirty(I.TextureOffsetX)||M(t.sft)?t.Jft:t.sft.TextureOffsetX},set:function(t){this.Jft=t,this.Dirty(I.TextureOffsetX)},enumerable:!1,configurable:!0}),Object.defineProperty(_.prototype,"TextureOffsetY",{get:function(){var t=this;return t.IsDirty(I.TextureOffsetY)||M(t.sft)?t.Xft:t.sft.TextureOffsetY},set:function(t){this.Xft=t,this.Dirty(I.TextureOffsetY)},enumerable:!1,configurable:!0}),Object.defineProperty(_.prototype,"TextureVerticalScale",{get:function(){var t=this;return t.IsDirty(I.TextureVerticalScale)||M(t.sft)?t.Hft:t.sft.TextureVerticalScale},set:function(t){this.Hft=t,this.Dirty(I.TextureVerticalScale)},enumerable:!1,configurable:!0}),Object.defineProperty(_.prototype,"Transparency",{get:function(){var t=this;return(t.IsDirty(I.Transparency)||M(t.sft)?t.ColorInternal:t.sft).Transparency},set:function(t){this.ColorInternal.Transparency=t,this.Dirty(I.Transparency)},enumerable:!1,configurable:!0}),Object.defineProperty(_.prototype,"Type",{get:function(){var t=this;return t.IsDirty(I.Type)||M(t.sft)?t.uit:t.sft.Type},set:function(t){this.uit=t,this.Dirty(I.Type)},enumerable:!1,configurable:!0}),Object.defineProperty(_.prototype,"Visible",{get:function(){var t=this;return t.IsDirty(I.Visible)||M(t.sft)?t.jft:t.sft.Visible},set:function(t){this.jft=t,this.Dirty(I.Visible)},enumerable:!1,configurable:!0}),Object.defineProperty(_.prototype,"ColorInternal",{get:function(){var t=this;return M(t._x)&&(t._x=new a.ColorFormat(t.DJ,M(t.sft)?C:t.sft.Color),t._x.AutoColorFormat=t.Pft),t._x},enumerable:!1,configurable:!0}),Object.defineProperty(_.prototype,"PatternColorInternal",{get:function(){var t=this;return M(t.qft)&&(t.qft=new a.ColorFormat(t.DJ,M(t.sft)?C:t.sft.PatternColor)),t.qft},enumerable:!1,configurable:!0}),Object.defineProperty(_.prototype,"PresetTexture",{get:function(){var t=this;return t.IsDirty(I.PresetTexture)||M(t.sft)?t.$ft:t.sft.PresetTexture},set:function(t){this.$ft=t,this.Dirty(I.PresetTexture)},enumerable:!1,configurable:!0}),_.prototype.GetGradientColorType=function(){for(var t,n,e,i,r,t=[],n=0,e=this.zft.GradientStopList;n<e.length;n++)i=e[n],this.FindInColorStops(i.Color,t)||t.push(i.Color);return 0===(r=t.length)?c.GradientColorType.GradientColorNone:1===r?c.GradientColorType.GradientOneColor:2===r?c.GradientColorType.GradientTwoColors:c.GradientColorType.GradientMultiColor},_.prototype.FindInColorStops=function(t,n){for(var e,i,r,o,e=0,i=n;e<i.length;e++)if((o=(r=i[e]).ColorType)===t.ColorType)if(o===c.SolidColorType.Theme){if(r.ObjectThemeColor===t.ObjectThemeColor&&r.TintAndShade===t.TintAndShade)return!0}else if(o===c.SolidColorType.RGB&&r.RGB.Equals(t.RGB)&&r.TintAndShade===t.TintAndShade)return!0;return!1},_.prototype.t0t=function(t){this.Yft=t,this.Dirty(I.GradientDegree)},_.prototype.n0t=function(t){this.zft=t,this.Dirty(I.GradientStops)},_.prototype.e0t=function(t){this.Zft=t,this.Dirty(I.GradientStyle)},_.prototype.i0t=function(t){this.Wft=t,this.Dirty(I.GradientVariant)},_.prototype.r0t=function(t){if(t===c.PatternType.none)throw new Error(A);var n=this;n.Pattern===c.PatternType.none&&n.o0t(c.FillType.Patterned),n.Ox=t,n.Dirty(I.Pattern)},_.prototype.a0t=function(t){this.Qft=t,this.Dirty(I.PresetGradientType)},_.prototype.o0t=function(t){this.uit=t,this.Dirty(I.Type)},_.prototype.InitGradientInfo=function(t,n,e){if(t===c.GradientStyle.GradientFromTitle)throw new Error(A);var i=this;i.e0t(t),i.i0t(n),i.o0t(c.FillType.Gradient),i.a0t(e)},_.prototype.OneColorGradient=function(t,n,e){if(e<0||1<e)throw new Error(A);var i=this;i.InitGradientInfo(t,n,c.PresetGradientType.GradientEarlySunset),i.t0t(e),m.InitGradientStops(i.DJ,i,c.GradientColorType.GradientOneColor)},_.prototype.TwoColorGradient=function(t,n){this.InitGradientInfo(t,n,c.PresetGradientType.GradientEarlySunset),m.InitGradientStops(this.DJ,this,c.GradientColorType.GradientTwoColors)},_.prototype.PresetGradient=function(t,n,e){this.InitGradientInfo(t,n,e),m.InitGradientStops(this.DJ,this,c.GradientColorType.GradientPresetColors)},_.prototype.Patterned=function(t){this.SetPatternColor(),this.o0t(c.FillType.Patterned),this.r0t(t)},_.prototype.SetPatternColor=function(){var t=this;t.Color.ObjectThemeColor=c.ColorSchemeIndex.LT1,t.PatternColor.ObjectThemeColor=c.ColorSchemeIndex.Accent1,t.Color.ClearModel(),t.PatternColor.ClearModel()},_.prototype.Solid=function(){this.o0t(c.FillType.Solid),M(this._x)||this._x.ClearModel()},_.prototype.ClearColor=function(){this._x=C},_.prototype.GetState=function(t,n){var e=this;return n===S&&(n=!1),t!==I.Color||M(e._x)?t!==I.PatternColor||M(e.qft)?k.prototype.GetState.call(e,t,n):e.qft.IsDirtyIncludingParent(n):e._x.IsDirtyIncludingParent(n)},_.prototype.IsDirtyIncludingParent=function(t){void 0===t&&(t=!1);var n=this;return!(M(n.qft)||!n.qft.IsDirtyIncludingParent())||!(M(n._x)||!n._x.IsDirtyIncludingParent())||!M(n.zft)&&0<n.zft.Count||!(M(n.Gft)||!n.Gft.IsDirtyIncludingParent())||k.prototype.IsDirtyIncludingParent.call(n,t)},_.prototype.OnParentChanged=function(t){var n=this;n.sft=t,M(n.sft)?(M(n._x)||(n._x.ParentStateful=C),M(n.qft)||(n.qft.ParentStateful=C)):(M(n._x)||(n._x.ParentStateful=n.sft.Color),M(n.qft)||(n.qft.ParentStateful=n.sft.PatternColor))},_.prototype.FromOOModel=function(t,n){if(M(n))throw new Error("colorFillType not provided!");var e=this;e.Fft=t,n===c.ColorFillType.SolidColorFillProperties?(e.ColorInternal.FromOOModel(e.Fft),e.uit=c.FillType.Solid,e.SetState(I.Type,!0)):n===c.ColorFillType.PatternFillProperties?(e.FromCT_PatternFillProperties(t),e.uit=c.FillType.Patterned,e.SetState(I.Type,!0)):n===c.ColorFillType.GradientFillProperties?(e.FromCT_GradientFillProperties(t),e.uit=c.FillType.Gradient,e.SetState(I.Type,!0)):n===c.ColorFillType.BlipFillProperties?(e.Gft.FromOOModel(t),e.uit=c.FillType.Picture,e.SetState(I.Type,!0)):n===c.ColorFillType.GroupFillProperties?(e.uit=c.FillType.Group,e.SetState(I.Type,!0)):n===c.ColorFillType.NoFillProperties&&(e.uit=c.FillType.Solid,e.SetState(I.Type,!0))},_.prototype.FromSJSOOModel=function(t,n){if(M(n))throw new Error("colorFillType not provided!");var e=this;n===c.ColorFillType.SolidColorFillProperties?(e.ColorInternal.FromSJSOOModel(t),e.uit=c.FillType.Solid,e.SetState(I.Type,!0)):n===c.ColorFillType.PatternFillProperties?(e.FromSJSCT_PatternFillProperties(t),e.uit=c.FillType.Patterned,e.SetState(I.Type,!0)):n===c.ColorFillType.GradientFillProperties?(e.FromSJSCT_GradientFillProperties(t),e.uit=c.FillType.Gradient,e.SetState(I.Type,!0)):n===c.ColorFillType.BlipFillProperties?(e.Gft.FromSJSOOModel(t),e.uit=c.FillType.Picture,e.SetState(I.Type,!0)):n===c.ColorFillType.GroupFillProperties?(e.uit=c.FillType.Group,e.SetState(I.Type,!0)):n===c.ColorFillType.NoFillProperties&&(e.uit=c.FillType.Solid,e.SetState(I.Type,!0))},_.prototype.ToOOModel=function(t){var n;if(this.Visible)switch(this.Type){case c.FillType.Solid:n=this.ToCT_SolidColorFillProperties();break;case c.FillType.Patterned:n=this.ToCT_PatternFillProperties();break;case c.FillType.Gradient:n=this.ToCT_GradientFillProperties();break;case c.FillType.Textured:n=this.ToCT_TileFillProperties();break;case c.FillType.Background:break;case c.FillType.Picture:n=this.ToCT_PictureFillProperties();break;case c.FillType.Group:n={colorFillType:c.ColorFillType.GroupFillProperties}}else n={colorFillType:c.ColorFillType.NoFillProperties};return n},_.prototype.ToSJSOOModel=function(t){var n;if(this.Visible)switch(this.Type){case c.FillType.Solid:n=this.ToSJSCT_SolidColorFillProperties();break;case c.FillType.Patterned:n=this.ToSJSCT_PatternFillProperties();break;case c.FillType.Gradient:n=this.ToSJSCT_GradientFillProperties();break;case c.FillType.Textured:n=this.ToSJSCT_TileFillProperties();break;case c.FillType.Background:break;case c.FillType.Picture:n=this.ToSJSCT_PictureFillProperties();break;case c.FillType.Group:n={colorFillType:c.ColorFillType.GroupFillProperties}}else n={colorFillType:c.ColorFillType.NoFillProperties};return n},_.prototype.ToSJS_FillGroup=function(t){var n,n,e,n=this;p.Aft(t),(e=(n=n.ToSJSOOModel()).colorFillType)===c.ColorFillType.SolidColorFillProperties?t.solidFill=n:e===c.ColorFillType.PatternFillProperties?t.pattFill=n:e===c.ColorFillType.GradientFillProperties?t.gradFill=n:e===c.ColorFillType.BlipFillProperties?t.blipFill=n:e===c.ColorFillType.NoFillProperties&&(t.noFill={}),delete n.colorFillType},_.prototype.FromCT_PatternFillProperties=function(t){this.r0t(t.prst),this.ColorInternal.FromOOModel(t.bgClr),this.PatternColorInternal.FromOOModel(t.fgClr)},_.prototype.FromSJSCT_PatternFillProperties=function(t){this.r0t(p.ToPatternType(c.ST_PresetPatternVal[t.prst])),this.ColorInternal.FromSJSOOModel(t.bgClr),this.PatternColorInternal.FromSJSOOModel(t.fgClr)},_.prototype.ToCT_PatternFillProperties=function(){var t,n,t=this;return t.DJ.DrawingType===c.DrawingType.GroupShape?C:((n={colorFillType:c.ColorFillType.PatternFillProperties}).prst=t.Pattern,t.PatternColorInternal.ColorType!==c.SolidColorType.None&&(n.fgClr=t.PatternColorInternal.Color_ToOOModel()),t.Color.ColorType!==c.SolidColorType.None&&(n.bgClr=t.Color.Color_ToOOModel()),n)},_.prototype.ToSJSCT_PatternFillProperties=function(){var t,n,t=this;return t.DJ.DrawingType===c.DrawingType.GroupShape?C:((n={colorFillType:c.ColorFillType.PatternFillProperties}).prst=c.ST_PresetPatternVal[p.ToST_PresetPatternVal(+t.Pattern)],t.PatternColorInternal.ColorType!==c.SolidColorType.None&&(n.fgClr=t.PatternColorInternal.Color_ToSJSOOModel()),t.Color.ColorType!==c.SolidColorType.None&&(n.bgClr=t.Color.Color_ToSJSOOModel()),n)},_.prototype.FromCT_GradientFillProperties=function(t){var n=this;n.n0t(new u.GradientStops(n.DJ)),n.zft.FromOOModel(t.gsLst),n.RotateWithObject=t.rotWithShape,M(t.path)?M(t.lin)||(n.FromCT_LinearShadeProperties(t.lin),n.FromTitleCT_RelativeRect(t.tileRect)):n.FromCT_PathShadeProperties(t.path)},_.prototype.FromSJSCT_GradientFillProperties=function(t){var n,e,i,n=this;n.n0t(new u.GradientStops(n.DJ)),n.zft.FromSJSOOModel(t.gsLst),n.RotateWithObject=w(t.rotWithShape,!1),e=t.path,i=t.lin,M(e)?M(i)||(n.FromSJSCT_LinearShadeProperties(i),n.FromTitleSJSCT_RelativeRect(t.tileRect)):n.FromSJSCT_PathShadeProperties(e)},_.prototype.ToCT_GradientFillProperties=function(){var t,n,t=this,n={colorFillType:c.ColorFillType.GradientFillProperties};return n.rotWithShape=t.RotateWithObject,!M(t.GradientStops)&&0<t.GradientStops.Count&&(n.gsLst=t.GradientStops.ToOOModel()),t.GradientStyle===c.GradientStyle.GradientFromCenter||t.GradientStyle===c.GradientStyle.GradientFromCorner||t.GradientStyle===c.GradientStyle.GradientTopSpotlight||t.GradientStyle===c.GradientStyle.GradientBottomSpotlight?n.path=t.ToCT_PathShadeProperties():n.lin=t.ToCT_LinearShadeProperties(),n.tileRect=t.ToTitleCT_RelativeRect(),n},_.prototype.ToSJSCT_GradientFillProperties=function(){var t,n,t=this,n={};return n.rotWithShape=b(t.RotateWithObject),!M(t.GradientStops)&&0<t.GradientStops.Count&&(n.gsLst=t.GradientStops.ToSJSOOModel()),t.GradientStyle===c.GradientStyle.GradientFromCenter||t.GradientStyle===c.GradientStyle.GradientFromCorner||t.GradientStyle===c.GradientStyle.GradientTopSpotlight||t.GradientStyle===c.GradientStyle.GradientBottomSpotlight?n.path=t.ToSJSCT_PathShadeProperties():n.lin=t.ToSJSCT_LinearShadeProperties(),n.tileRect=t.ToSJSTitleCT_RelativeRect(),n.colorFillType=c.ColorFillType.GradientFillProperties,n},_.prototype.ToCT_PictureFillProperties=function(){return this.Gft.ToOOModel()},_.prototype.ToSJSCT_PictureFillProperties=function(){return this.Gft.ToSJSOOModel()},_.prototype.FromTitleCT_RelativeRect=function(t){var n=this;M(t)||(t.l===-h&&t.t===-h?n.i0t(1):t.t===-h&&t.r===-h?n.i0t(2):t.l===-h&&t.b===-h?n.i0t(3):t.r===-h&&t.b===-h&&n.i0t(4))},_.prototype.FromTitleSJSCT_RelativeRect=function(t){var n,e,i,r,t,n=this;M(t)||(e=g(t.l),i=g(t.t),r=g(t.r),t=g(t.b),e===-h&&i===-h?n.i0t(1):i===-h&&r===-h?n.i0t(2):e===-h&&t===-h?n.i0t(3):r===-h&&t===-h&&n.i0t(4))},_.prototype.ToTitleCT_RelativeRect=function(){var t,n,t={l:0,r:0,t:0,b:0},n=this.GradientVariant;return this.GradientStyle===c.GradientStyle.GradientFromCorner&&(1===n?(t.l=-h,t.t=-h):2===n?(t.t=-h,t.r=-h):3===n?(t.l=-h,t.b=-h):4===n&&(t.r=-h,t.b=-h)),t},_.prototype.ToSJSTitleCT_RelativeRect=function(){return D(this.ToTitleCT_RelativeRect())},_.prototype.FromCT_LinearShadeProperties=function(t){this.GradientAngle=(t.ang||0)/d,this.u0t=!0,this.Rft=t.scaled},_.prototype.FromSJSCT_LinearShadeProperties=function(t){this.GradientAngle=parseFloat(t.ang||"0")/d,this.u0t=!0,this.Rft=f.NodeHelper.ur(t.scaled,!1)},_.prototype.ToCT_LinearShadeProperties=function(){return{ang:T(this.GradientAngle*d),scaled:this.Rft}},_.prototype.ToSJSCT_LinearShadeProperties=function(){return{ang:String(T(this.GradientAngle*d)),scaled:b(this.Rft)}},_.prototype.FromCT_PathShadeProperties=function(t){M(t)||(this.Bft=t.path,this.FromCT_RelativeRect(t.fillToRect))},_.prototype.FromSJSCT_PathShadeProperties=function(t){M(t)||(this.Bft=c.ST_PathShadeType[t.path],this.FromSJSCT_RelativeRect(t.fillToRect))},_.prototype.ToCT_PathShadeProperties=function(){return{path:this.Bft,fillToRect:this.ToCT_RelativeRect()}},_.prototype.ToSJSCT_PathShadeProperties=function(){return{path:c.ST_PathShadeType[this.Bft],fillToRect:this.ToSJSCT_RelativeRect()}},_.prototype.FromCT_RelativeRect=function(t){var n,e;M(t)||(e=this,t.l===(n=.5*h)&&t.t===n&&t.r===n&&t.b===n?e.e0t(c.GradientStyle.GradientFromCenter):t.r===h&&t.b===h?(e.e0t(c.GradientStyle.GradientFromCorner),e.i0t(1)):t.l===h&&t.b===h?(e.e0t(c.GradientStyle.GradientFromCorner),e.i0t(2)):t.r===h&&t.t===h?(e.e0t(c.GradientStyle.GradientFromCorner),e.i0t(3)):t.l===h&&t.t===h?(e.e0t(c.GradientStyle.GradientFromCorner),e.i0t(4)):t.l===n&&t.t===.8*-h?e.e0t(c.GradientStyle.GradientTopSpotlight):t.l===n&&t.t===1.3*h&&e.e0t(c.GradientStyle.GradientBottomSpotlight))},_.prototype.FromSJSCT_RelativeRect=function(t){var n,e,i,r,o,t;M(t)||(n=.5*h,e=this,i=y(t.l),r=y(t.r),o=y(t.t),t=y(t.b),i===n&&o===n&&r===n&&t===n?e.e0t(c.GradientStyle.GradientFromCenter):r===h&&t===h?(e.e0t(c.GradientStyle.GradientFromCorner),e.i0t(1)):i===h&&t===h?(e.e0t(c.GradientStyle.GradientFromCorner),e.i0t(2)):r===h&&o===h?(e.e0t(c.GradientStyle.GradientFromCorner),e.i0t(3)):i===h&&o===h?(e.e0t(c.GradientStyle.GradientFromCorner),e.i0t(4)):i===n&&o===.8*-h?e.e0t(c.GradientStyle.GradientTopSpotlight):i===n&&o===1.3*h&&e.e0t(c.GradientStyle.GradientBottomSpotlight))},_.prototype.ToCT_RelativeRect=function(){var t,n,e,t={l:0,r:0,t:0,b:0},n=.5*h;return this.GradientStyle===c.GradientStyle.GradientFromCenter?(t.l=n,t.t=n,t.r=n,t.b=n):this.GradientStyle===c.GradientStyle.GradientFromCorner?1===(e=this.GradientVariant)?(t.r=h,t.b=h):2===e?(t.l=h,t.b=h):3===e?(t.t=h,t.r=h):4===e&&(t.l=h,t.t=h):this.GradientStyle===c.GradientStyle.GradientTopSpotlight?(t.l=n,t.r=n,t.t=.8*-d,t.b=1.8*h):this.GradientStyle===c.GradientStyle.GradientBottomSpotlight&&(t.l=n,t.r=n,t.t=1.3*h,t.b=.3*-d),t},_.prototype.ToSJSCT_RelativeRect=function(){return D(this.ToCT_RelativeRect())},_.prototype.ToCT_SolidColorFillProperties=function(){return this.ColorInternal.ToOOModel()},_.prototype.ToSJSCT_SolidColorFillProperties=function(){return this.ColorInternal.ToSJSOOModel()},_.prototype.ToCT_TileFillProperties=function(){var t=this.Gft.ToOOModel();return t.tile=this.ToCT_TileInfoProperties(),t},_.prototype.ToSJSCT_TileFillProperties=function(){var t=this.Gft.ToSJSOOModel();return t.tile=this.ToSJSCT_TileInfoProperties(),t},_.prototype.ToCT_TileInfoProperties=function(){var t=this;return{algn:t.TextureAlignment,tx:t.TextureOffsetX,ty:t.TextureOffsetY,sx:T(t.TextureHorizontalScale*v),sy:T(t.TextureVerticalScale*v)}},_.prototype.ToSJSCT_TileInfoProperties=function(){var t=this;return{algn:c.ST_RectAlignment[t.TextureAlignment],tx:l(t.TextureOffsetX),ty:l(t.TextureOffsetY),sx:T(t.TextureHorizontalScale*v),sy:T(t.TextureVerticalScale*v)}},_.prototype.Clone=function(){var t,n,t=this,n=new _(t.DJ,t.sft,t.Pft,t.Wc);return M(t.qft)||(n.qft=t.qft.Clone()),M(t._x)||(n._x=t._x.Clone()),n.Yft=t.Yft,n.Rft=t.Rft,n.zft=t.zft,n.Wft=t.Wft,n.Ox=t.Ox,n.Qft=t.Qft,n.$ft=t.$ft,n.s0t=t.s0t,n.c0t=t.c0t,n.uit=t.uit,n.Vft=t.Vft,n.Lft=t.Lft,n.Kft=t.Kft,n.Uft=t.Uft,n.Jft=t.Jft,n.Xft=t.Xft,n.f0t=t.f0t,n.Hft=t.Hft,n.aft=t.aft,n.jft=t.jft,n.l0t=t.l0t,n.sft=t.sft,n},n.FillFormat=_},"./dist/plugins/floatingObject/drawing/fontData.js":function(t,n,e){"use strict";var i,r,l,o,h,a,e;function u(){var t=this;t.Flag=h.None,t.Size=0,t.Family=0,t.CharSet=0,t.Scheme=r.ThemeFont.None,t.Underline=r.UnderlineType.None,t.VertAlign=r.VertAlignType.Baseline}Object.defineProperty(n,"__esModule",{value:!0}),n.FontData=void 0,i=e("./dist/plugins/floatingObject/drawing/common.js"),r=e("./dist/plugins/floatingObject/drawing/drawingInterface.js"),l=e("./dist/plugins/floatingObject/drawing/colorData.js"),o=i.UnitHelper.isNullOrUndefined,(e=h=h||{})[e.None=0]="None",e[e.Color=1]="Color",e[e.Size=2]="Size",e[e.Name=4]="Name",e[e.Family=8]="Family",e[e.CharSet=16]="CharSet",e[e.Scheme=32]="Scheme",e[e.Bold=64]="Bold",e[e.Italic=128]="Italic",e[e.Underline=256]="Underline",e[e.Strike=512]="Strike",e[e.VertAlign=1024]="VertAlign",e[e.Shadow=2048]="Shadow",e[e.Outline=4096]="Outline",e[e.Condense=8192]="Condense",e[e.Extend=16384]="Extend",e[e.All=32767]="All",u.prototype.Equals=function(t){var n;return!o(t)&&(n=this).Size===t.Size&&n.Color.Equals(t.Color)&&n.Name===t.Name&&n.Family===t.Family&&n.CharSet===t.CharSet&&n.Scheme===t.Scheme&&n.Bold===t.Bold&&n.Italic===t.Italic&&n.Underline===t.Underline&&n.Strike===t.Strike&&n.VertAlign===t.VertAlign&&n.Shadow===t.Shadow&&n.Outline===t.Outline&&n.Condense===t.Condense&&n.Extend===t.Extend&&n.NotUsed===t.NotUsed},u.prototype.Clone=function(){var t,n,t=new u,n=this;return t.Color=n.Color,t.Size=n.Size,t.Name=n.Name,t.Family=n.Family,t.CharSet=n.CharSet,t.Scheme=n.Scheme,t.Bold=n.Bold,t.Italic=n.Italic,t.Underline=n.Underline,t.Strike=n.Strike,t.VertAlign=n.VertAlign,t.Shadow=n.Shadow,t.Outline=n.Outline,t.Condense=n.Condense,t.Extend=n.Extend,t.Flag=n.Flag,t.NotUsed=n.NotUsed,t},u.prototype.UpdateDefaultValueFlag=function(){var t,n,t=this,n=h.None;t.Color.UpdateDefaultValueFlag(),t.Color.Flag!==l.ColorDataFlag.None&&(n|=h.Color),0!==t.Size&&(n|=h.Size),o(t.Name)||(n|=h.Name),0!==t.Family&&(n|=h.Family),0!==t.CharSet&&(n|=h.CharSet),t.Scheme!==r.ThemeFont.None&&(n|=h.Scheme),t.Bold&&(n|=h.Bold),t.Italic&&(n|=h.Italic),t.Underline!==r.UnderlineType.None&&(n|=h.Underline),t.Strike&&(n|=h.Strike),t.VertAlign!==r.VertAlignType.Baseline&&(n|=h.VertAlign),t.Shadow&&(n|=h.Shadow),t.Outline&&(n|=h.Outline),t.Condense&&(n|=h.Condense),t.Extend&&(n|=h.Extend),t.Flag=n},u.prototype.UpdateFlagFromBottom=function(){var t=this;t.Color.UpdateFlagFromBottom(),t.Color.Flag===l.ColorDataFlag.None?t.Flag&=~h.Color:t.Flag|=h.Color},u.prototype.UpdateDefaultValueFlagForDxf=function(){var t,n,e,t=this,n=t.Flag,e=h.None;(n&h.Bold)===h.Bold&&(e|=h.Bold),(n&h.Italic)===h.Italic&&(e|=h.Italic),t.Color.UpdateDefaultValueFlag(),t.Color.Flag!==l.ColorDataFlag.None&&(e|=h.Color),0!==t.Size&&(e|=h.Size),o(t.Name)||(e|=h.Name),0!==t.Family&&(e|=h.Family),0!==t.CharSet&&(e|=h.CharSet),t.Scheme!==r.ThemeFont.None&&(e|=h.Scheme),t.Underline!==r.UnderlineType.None&&(e|=h.Underline),t.Strike&&(e|=h.Strike),t.VertAlign!==r.VertAlignType.Baseline&&(e|=h.VertAlign),t.Shadow&&(e|=h.Shadow),t.Outline&&(e|=h.Outline),t.Condense&&(e|=h.Condense),t.Extend&&(e|=h.Extend),t.Flag=e},u.prototype.Compose=function(t,n){void 0===n&&(n=!0),t.Flag!==h.None&&(n?this.ConflictCompose(t):this.NonConflictCompose(t))},u.prototype.ConflictCompose=function(t){var n,e,n=this,e=t.Flag;(e&h.Color)===h.Color&&n.Color.Compose(t.Color),(e&h.Size)===h.Size&&(n.Size=t.Size),(e&h.Name)===h.Name&&(n.Name=t.Name),(e&h.Family)===h.Family&&(n.Family=t.Family),(e&h.CharSet)===h.CharSet&&(n.CharSet=t.CharSet),(e&h.Scheme)===h.Scheme?n.Scheme=t.Scheme:(e&h.Name)===h.Name&&(n.Scheme=r.ThemeFont.None,e&=~h.Scheme),(e&h.Bold)===h.Bold&&(n.Bold=t.Bold),(e&h.Italic)===h.Italic&&(n.Italic=t.Italic),(e&h.Underline)===h.Underline&&(n.Underline=t.Underline),(e&h.Strike)===h.Strike&&(n.Strike=t.Strike),(e&h.VertAlign)===h.VertAlign&&(n.VertAlign=t.VertAlign),(e&h.Shadow)===h.Shadow&&(n.Shadow=t.Shadow),(e&h.Outline)===h.Outline&&(n.Outline=t.Outline),(e&h.Condense)===h.Condense&&(n.Condense=t.Condense),(e&h.Extend)===h.Extend&&(n.Extend=t.Extend),n.Flag|=e},u.prototype.NonConflictCompose=function(t){var n,e,n=this,e=n.Flag;n.Color.Compose(t.Color,!1),(e&h.Size)!==h.Size&&(n.Size=t.Size),(e&h.Name)!==h.Name&&(n.Name=t.Name),(e&h.Family)!==h.Family&&(n.Family=t.Family),(e&h.CharSet)!==h.CharSet&&(n.CharSet=t.CharSet),(e&h.Scheme)!==h.Scheme&&(n.Scheme=t.Scheme),(e&h.Bold)!==h.Bold&&(n.Bold=t.Bold),(e&h.Italic)!==h.Italic&&(n.Italic=t.Italic),(e&h.Underline)!==h.Underline&&(n.Underline=t.Underline),(e&h.Strike)!==h.Strike&&(n.Strike=t.Strike),(e&h.VertAlign)!==h.VertAlign&&(n.VertAlign=t.VertAlign),(e&h.Shadow)!==h.Shadow&&(n.Shadow=t.Shadow),(e&h.Outline)!==h.Outline&&(n.Outline=t.Outline),(e&h.Condense)!==h.Condense&&(n.Condense=t.Condense),(e&h.Extend)!==h.Extend&&(n.Extend=t.Extend),n.Flag|=t.Flag},u.prototype.RemoveDuplicateStyle=function(t){return this.Compare(t,!1)},u.prototype.RemoveDifferentStyle=function(t){return this.Compare(t,!0)},u.prototype.Compare=function(t,n){var e,i,r,o,a,u,s,c,f,e=this,i=e.Flag,r=t.Flag,o=[],a=!1;if((i&h.Color)===h.Color&&(u=(u=(r&h.Color)!==h.Color)||(n?(a=e.Color.RemoveDifferentStyle(t.Color),e.Color.Flag===l.ColorDataFlag.None):(a=e.Color.RemoveDuplicateStyle(t.Color),e.Color.Flag!==l.ColorDataFlag.None)),s=n?u:!u)&&o.push(h.Color),(i&h.Size)===h.Size&&(u=(r&h.Size)!==h.Size||e.Size!==t.Size,s=n?u:!u)&&o.push(h.Size),(i&h.Name)===h.Name&&(u=(r&h.Name)!==h.Name||e.Name!==t.Name,s=n?u:!u)&&o.push(h.Name),(i&h.Family)===h.Family&&(u=(r&h.Family)!==h.Family||e.Family!==t.Family,s=n?u:!u)&&o.push(h.Family),(i&h.CharSet)===h.CharSet&&(u=(r&h.CharSet)!==h.CharSet||e.CharSet!==t.CharSet,s=n?u:!u)&&o.push(h.CharSet),(i&h.Scheme)===h.Scheme&&(u=(r&h.Scheme)!==h.Scheme||e.Scheme!==t.Scheme,s=n?u:!u)&&o.push(h.Scheme),(i&h.Bold)===h.Bold&&(u=(r&h.Bold)!==h.Bold||e.Bold!==t.Bold,s=n?u:!u)&&o.push(h.Bold),(i&h.Italic)===h.Italic&&(u=(r&h.Italic)!==h.Italic||e.Italic!==t.Italic,s=n?u:!u)&&o.push(h.Italic),(i&h.Underline)===h.Underline&&(u=(r&h.Underline)!==h.Underline||e.Underline!==t.Underline,s=n?u:!u)&&o.push(h.Underline),(i&h.Strike)===h.Strike&&(u=(r&h.Strike)!==h.Strike||e.Strike!==t.Strike,s=n?u:!u)&&o.push(h.Strike),(i&h.VertAlign)===h.VertAlign&&(u=(r&h.VertAlign)!==h.VertAlign||e.VertAlign!==t.VertAlign,s=n?u:!u)&&o.push(h.VertAlign),(i&h.Shadow)===h.Shadow&&(u=(r&h.Shadow)!==h.Shadow||e.Shadow!==t.Shadow,s=n?u:!u)&&o.push(~h.Shadow),(i&h.Outline)===h.Outline&&(u=(r&h.Outline)!==h.Outline||e.Outline!==t.Outline,s=n?u:!u)&&o.push(h.Outline),(i&h.Condense)===h.Condense&&(u=(r&h.Condense)!==h.Condense||e.Condense!==t.Condense,s=n?u:!u)&&o.push(h.Condense),(i&h.Extend)===h.Extend&&(u=(r&h.Extend)!==h.Extend||e.Extend!==t.Extend,s=n?u:!u)&&o.push(h.Extend),0<(c=o.length))for(a=!0,f=0;f<c;f++)i&=~o[f];return e.Flag=i,a},u.prototype.ClearFlag=function(){this.Color.ClearFlag(),this.Flag=h.None},u.prototype.SetFullFlag=function(){this.Color.SetFullFlag(),this.Flag=h.All},u.prototype.IsFullFlag=function(){return this.Flag===h.All&&this.Color.IsFullFlag()},n.FontData=u},"./dist/plugins/floatingObject/drawing/fontFormat.js":function(B,t,n){"use strict";var e,L,F,P,i,G,r,U,H,y,S,p,w,z,c,o,V,d,Y,Z,W,Q,J,K,X,q,n,v,h,$,a,F,f,tt,nt,s,m,u,l,et,it,g,b,n,rt,ot,at,ut,st,ct,ft,lt,ht,dt,vt,mt,gt,pt,bt;function yt(t,e,i,r){t.forEach(function(t){var n=e[t];r&&(n=r(n)),i[t]=n})}function M(t){if(t){var t=parseInt(t,10);if(!isNaN(t))return t}}function wt(t,n){return f(t)?n:t}function Mt(t){var n=0;switch(t){case 0:n=1;break;case 1:n=2;break;case 2:n=3;break;case 3:n=4;break;case 4:n=5;break;case 5:n=6;break;case 6:n=7;break;case 7:n=8;break;case 8:n=9;break;case 9:n=10;break;case 10:n=11;break;case 11:n=12;break;case 16:n=13;break;case 17:n=14;break;case 27:n=15;break;case 28:n=16;break;case 34:n=17;break;case 52:n=18;break;case 14:n=19;break;case 15:n=20;break;case 25:n=21;break;case 26:n=22;break;case 36:n=23;break;case 45:n=24;break;case 29:n=25;break;case 30:n=26;break;case 32:n=27;break;case 31:n=28;break;case 19:n=29;break;case 18:n=30;break;case 21:n=31;break;case 20:n=32;break;case 40:n=33;break;case 37:n=34;break;case 41:n=35;break;case 35:n=36;break;case 39:n=37;break;case 53:n=38;break;case 43:n=39;break;case 42:n=40;break;case 44:n=41;break;case 46:n=42;break;case 47:n=43;break;case 48:n=44;break;case 38:n=45;break;case 49:n=46;break;case 50:n=47;break;case 51:n=48;break;case 12:n=49;break;case 13:n=50;break;case 22:n=51;break;case 23:n=52;break;case 24:n=53;break;case 33:n=54}return n}function Ct(t){var n={};return t.d&&(n.d=M(t.d)),t.sp&&(n.sp=M(t.sp)),n}function St(t){var n={ds:[]},e=t.ds,t=t.dumy;return e&&(e=s(e)).forEach(function(t){n.ds.push(Ct(t))}),t&&(n.dumy=w(t)),n}function Tt(t){var n={w:1,len:1};return t.type&&(n.type=y.ST_LineEndType[t.type]),t.w&&(n.w=y.ST_LineEndWidth[t.w]),t.len&&(n.len=y.ST_LineEndLength[t.len]),n}function At(t){var n,e,i,r,o,a,u,s,t,e;if(t)return n={},t.w&&(n.w=c(S(t.w))),t.cap&&(n.cap=y.ST_LineCap[t.cap]),t.cmpd&&(n.cmpd=y.ST_CompoundLine[t.cmpd]),t.algn&&(n.algn=y.ST_PenAlignment[t.algn]),zt(t,n),e=t.prstDash,i=t.custDash,r=t.round,o=t.bevel,a=t.miter,u=t.headEnd,s=t.tailEnd,t=t.extLst,e&&(e=e.val,f(e)||(n.prstDash=y.ST_PresetLineDashVal[e])),i&&(n.custDash=St(i)),r&&(n.round=!0),o&&(n.bevel={}),a&&(n.miter={lim:S(a.lim)}),u&&(n.headEnd=Tt(u)),s&&(n.tailEnd=Tt(s)),t&&(n.extLst=A(t)),n}function It(t,n,e){t[n]&&(e[n]=[S(t[n].val)])}function xt(t,n){var e,i,r,o;for(t.tint&&(n.tint=[M(t.tint.val)]),t.shade&&(n.shade=[M(t.shade.val)]),t.comp&&(n.comp=[{}]),t.inv&&(n.inv=[{}]),t.gray&&(n.gray=[{}]),t.alpha&&(n.alpha=[M(t.alpha.val)]),i=0,r=e=["alphaMod","alphaOff","hue","hueMod","hueOff","sat","satMod","satOff","lum","lumMod","lumOff","red","redMod","redOff","green","greenMod","greenOff","blue","blueMod","blueOff"];i<r.length;i++)It(t,o=r[i],n);t.gamma&&(n.gamma=[{}]),t.invGamma&&(n.invGamma=[{}])}function Nt(t){var n;if(t)return n={},t.r&&(n.r=S(t.r)),t.g&&(n.g=S(t.g)),t.b&&(n.b=S(t.b)),xt(t,n),n}function kt(t){var n,e;if(t)return n={},e=t.val,f(e)||(n.val=V(e)),xt(t,n),n}function Dt(t){var n;if(t)return n={},t.hue&&(n.hue=S(t.hue)),t.sat&&(n.sat=S(t.sat)),t.lum&&(n.lum=S(t.lum)),xt(t,n),n}function _t(t){var n;if(t)return n={},t.val&&(n.val=tt(y.ST_SystemColorVal[t.val])),t.lastClr&&(n.lastClr=V(t.lastClr)),xt(t,n),n}function Et(t){var n,e;if(t)return n={},e=t.val,f(e)||(n.val=nt(y.ST_SchemeColorVal[e])),xt(t,n),n}function jt(t){var n,e;if(t)return n={},e=t.val,f(e)||(n.val=y.ST_PresetColorVal[e]),xt(t,n),n}function T(t,n){var n,e,i,r,o,a,t;if(t)return n=n||{},e=t.scrgbClr,i=t.srgbClr,r=t.hslClr,o=t.sysClr,a=t.schemeClr,t=t.prstClr,e&&(n.scrgbClr=Nt(e)),i&&(n.srgbClr=kt(i)),r&&(n.hslClr=Dt(r)),o&&(n.sysClr=_t(o)),a&&(n.schemeClr=Et(a)),t&&(n.prstClr=jt(t)),n}function Ot(t){var n={};return t.pos&&(n.pos=S(t.pos)),T(t,n)}function Rt(t){var n={gs:[]},e=t.gs,t=t.dumy;return e&&(e=s(e)).forEach(function(t){n.gs.push(Ot(t))}),t&&(n.dumy=w(t.v_)),n}function Bt(t){var n={};return t.ang&&(n.ang=M(t.ang)),t.scaled&&(n.scaled=w(t.scaled)),n}function Lt(t){var n;if(t)return n={l:0,r:0,t:0,b:0},t.l&&(n.l=M(t.l)),t.r&&(n.r=M(t.r)),t.t&&(n.t=M(t.t)),t.b&&(n.b=M(t.b)),n}function Ft(t){var n,e,n={},e=t.path;return f(e)||(n.path=y.ST_PathShadeType[e]),t.fillToRect&&(n.fillToRect=Lt(t.fillToRect)),n}function Pt(t){var n,e,i,r,t;if(t)return n={rotWithShape:!0},t.flip&&(n.flip=y.ST_TileFlipMode[t.flip]),t.rotWithShape&&(n.rotWithShape=w(t.rotWithShape)),e=t.gsLst,i=t.lin,r=t.path,t=t.tileRect,e&&(n.gsLst=Rt(e)),i&&(n.lin=Bt(i)),r&&(n.path=Ft(r)),t&&(n.tileRect=Lt(t)),n}function Gt(t){var n={rad:0,grow:!0};return t.rad&&(n.rad=M(t.rad)),t.grow&&(n.grow=w(t.grow)),n}function Ut(t){var n,e,t,n={};return n.useA=wt(p(t.useA),!0),e=t.clrFrom,t=t.clrTo,e&&(n.clrFrom=T(e)),t&&(n.clrTo=T(t)),n}function Ht(t){var n,e,e,t;if(t)return n={},e=t.prst,f(e)||(n.prst=Mt(y.ST_PresetPatternVal[e])),e=t.fgClr,t=t.bgClr,e&&(n.fgClr=T(e)),t&&(n.bgClr=T(t)),n}function zt(t,n){var n,e,i,r,o,a,n=n||{},e=t.solidFill,i=t.gradFill,r=t.blipFill,o=t.pattFill,a=t.grpFill;return t.noFill&&(n.noFill=!0),e&&(n.solidFill=T(e)),i&&(n.gradFill=Pt(i)),r&&(n.blipFill=wn(r)),o&&(n.pattFill=Ht(o)),a&&(n.grpFill={}),n}function Vt(t){var n,e,n={},e=t.blend;return f(e)||(n.blend=y.ST_BlendMode[e]),zt(t,n)}function Yt(t){var n={hue:0,sat:0,lum:0};return t.hue&&(n.hue=M(t.hue)),t.sat&&(n.sat=M(t.sat)),t.lum&&(n.lum=M(t.lum)),n}function Zt(t){var n={bright:0,contrast:0};return t.bright&&(n.bright=M(t.bright)),t.contrast&&(n.contrast=M(t.contrast)),n}function Wt(t){var n={hue:0,amt:0};return t.hue&&(n.hue=M(t.hue)),t.amt&&(n.amt=M(t.amt)),n}function Qt(t){var n,t,n={};return n.type=wt(t.type,"png"),(t=t.blob)&&(n.blob=t.v_),n}function Jt(t,n){var n=n||{};return t.lat&&(n.lat=M(t.lat)),t.lon&&(n.lon=M(t.lon)),t.rev&&(n.rev=M(t.rev)),n}function Kt(t){var n={zoom:1e5};return t.fov&&(n.fov=M(t.fov)),t.zoom&&(n.zoom=M(t.zoom)),t.prst&&(n.prst=y.ST_PresetCameraType[t.prst]),Jt(t.rot,n)}function Xt(t){var n={};return t.rig&&(n.rig=y.ST_LightRigType[t.rig]),t.dir&&(n.dir=y.ST_LightRigDirection[t.dir]),Jt(t.rot,n)}function qt(t){var n={};return t.x&&(n.x=M(t.x)),t.y&&(n.y=M(t.y)),t.z&&(n.z=M(t.z)),n}function $t(t){var n={};return t.dx&&(n.dx=M(t.dx)),t.dy&&(n.dy=M(t.dy)),t.dz&&(n.dz=M(t.dz)),n}function tn(t){var n={},e=t.anchor,i=t.norm,r=t.up,t=t.extLst;return e&&(n.anchor=qt(e)),i&&(n.norm=$t(i)),r&&(n.up=$t(r)),t&&(n.extLst=A(t)),n}function nn(t){var n,e,i,r,t,n={},e=t.camera,i=t.lightRig,r=t.backdrop,t=t.extLst;return e&&(n.camera=Kt(e)),i&&(n.lightRig=Xt(i)),r&&(n.backdrop=tn(r)),t&&(n.extLst=A(t)),n}function en(t){var n={w:76200,h:76200,prst:1};return t.w&&(n.w=M(t.w)),t.h&&(n.h=M(t.h)),t.prst&&(n.prst=y.ST_BevelPresetType[t.prst]),n}function rn(t){var n,e,i,r,o,t,n={};return t.z&&(n.z=c(M(t.z))),t.extrusionH&&(n.extrusionH=c(M(t.extrusionH))),t.contourW&&(n.contourW=c(M(t.contourW))),t.prstMaterial&&(n.prstMaterial=y.ST_PresetMaterialType[t.prstMaterial]),e=t.bevelT,i=t.bevelB,r=t.extrusionClr,o=t.contourClr,t=t.extLst,e&&(n.bevelT=en(e)),i&&(n.bevelB=en(i)),r&&(n.extrusionClr=T(r)),o&&(n.contourClr=T(o)),t&&(n.extLst=A(t)),n}function on(t){var n={};return t.asvg&&(n.asvg=t.asvg),t.embed&&(n.embed=t.embed),n}function an(t){var n={};return t.id&&(n.id=t.id),t["xmlns:a16"]&&(n.name=t["xmlns:a16"]),n}function un(t){var n={};return t.cellRange&&(n.cellRange=t.cellRange),t.spid&&(n.spid=t.spid),n}function sn(t){var n,e,e,e,i,r,o,a,u,t,n={creationId:[]},e=wt(t.uri,""),e=(n.uri=e)===l.hiddenScene3dUri?0:e===l.hiddenSp3dUri?3:e===l.hiddenFillUri||e===l.hiddenFillUri2?1:e===l.hiddenLineUri||e===l.hiddenLineUri2?2:e===l.hiddenASvgBlip||e===l.hiddenASvgBlip2?5:4;return n.hiddenExtensionType=e,e=t.hiddenScene3d,i=t.hiddenSp3d,r=t.hiddenFill,o=t.hiddenLine,a=t.svgBlip,u=t.creationId,t=t.cameraTool,e&&(n.Scene3d=nn(e)),i&&(n.Shape3d=rn(i)),r&&(n.Fill=zt(r)),o&&(n.Line=At(o)),a&&(n.svgBlip=on(a)),u&&(u=s(u)).forEach(function(t){n.creationId.push(an(t))}),t&&(n.cameraTool=un(t)),n}function A(t){var n={},t=t.ext,e=[];return t&&((t=s(t)).forEach(function(t){e.push(sn(t))}),0<e.length)&&(n.ext=e),n}function cn(t){var n,e,n={},e=t.blend;return f(e)||(n.blend=y.ST_BlendMode[e]),pn(t.cont,n)}function fn(t){var n={};return n.rad=wt(M(t.rad),0),T(t,n)}function ln(t){var n={blurRad:0,dist:0,dir:0,shadowEffectType:1};return t.blurRad&&(n.blurRad=M(t.blurRad)),t.dist&&(n.dist=M(t.dist)),t.dir&&(n.dir=M(t.dir)),T(t,n)}function hn(n){var e,t,e={blurRad:0,dist:0,dir:0,sx:1e5,sy:1e5,kx:0,ky:0,algn:7,rotWithShape:!0,shadowEffectType:0},t;return["blurRad","dist","dir","sx","sy","kx","ky"].forEach(function(t){e[t]=M(n[t])}),n.algn&&(e.algn=y.ST_RectAlignment[n.algn]),n.rotWithShape&&(e.rotWithShape=w(n.rotWithShape)),T(n,e)}function dn(t){var n={dist:0,dir:0,shadowEffectType:2};return t.dist&&(n.dist=M(t.dist)),t.dir&&(n.dir=M(t.dir)),t.prst&&(n.prst=y.ST_PresetShadowVal[t.prst]),T(t,n)}function vn(n){var e,t,e={blurRad:0,stA:1e5,stPos:0,endA:0,endPos:1e5,dist:0,dir:0,fadeDir:54e5,sx:1e5,sy:1e5,kx:0,ky:0,algn:7,rotWithShape:!0},t;return["blurRad","stA","stPos","endA","endPos","dist","dir","fadeDir","sx","sy","kx","ky"].forEach(function(t){e[t]=M(n[t])}),n.algn&&(e.algn=y.ST_RectAlignment[n.algn]),n.rotWithShape&&(e.rotWithShape=w(n.rotWithShape)),e}function mn(t){var n={tx:0,ty:0};return t.tx&&(n.tx=M(t.tx)),t.ty&&(n.ty=M(t.ty)),n}function gn(t,n){var e,i,r,o,a,u,s,c,f,l,h,d,v,m,g,p,b,y,t,w,M,C,e=t.alphaBiLevel,i=t.alphaCeiling,r=t.alphaFloor,o=t.alphaInv,a=t.alphaMod,u=t.alphaModFix,s=t.alphaRepl,c=t.biLevel,f=t.blur,l=t.clrChange,h=t.clrRepl,d=t.duotone,v=t.fillOverlay,m=t.grayscl,g=t.hsl,p=t.lum,b=t.tint,y=t.blipBlob,t=t.extLst;if(e&&(n.alphaBiLevel={thresh:S(e.thresh)}),i&&(n.alphaCeiling={}),r&&(n.alphaFloor={}),o&&(n.alphaInv=T(o)),a&&(n.alphaMod=pn(a.cont)),u&&(n.alphaModFix={amt:wt(S(u.amt),1e5)}),s&&(n.alphaRepl={a:S(s.a)}),c&&(n.biLevel={thresh:S(c.thresh)}),f&&(n.blur=Gt(f)),l&&(n.clrChange=Ut(l)),h&&(n.clrRepl=T(h)),d&&(n.duotone=d.c_.map(T)),v&&(n.fillOverlay=Vt(v)),m&&(n.grayscl={}),g&&(n.hsl=Yt(g)),p&&(n.lum=Zt(p)),b&&(n.tint=Wt(b)),y&&(n.blipBlob=Qt(y)),t&&(n.extLst=A(t),w=n.extLst&&n.extLst.ext,Array.isArray(w))&&n.embed){for(M=-1,C=0;C<w.length;C++)if(5===w[C].hiddenExtensionType){M=C;break}-1!==M&&(n.embed=w[M].svgBlip.embed,w.splice(M,1)),0===w.length&&(delete n.extLst.ext,0===Object.keys(n.extLst).length)&&delete n.extLst}}function pn(t,n){var n,e,i,r,o,a,u,s,c,f,l,h,d,n=n||{};return t.type?n.type=y.ST_EffectContainerType[t.type]:n.type=0,t.name&&(n.name=t.name),e=t.cont,i=t.effect,r=t.alphaOutset,o=t.blend,a=t.fill,u=t.glow,s=t.innerShdw,c=t.outerShdw,f=t.prstShdw,l=t.reflection,h=t.relOff,d=t.softEdge,gn(t,n),e&&(n.cont=pn(e)),i&&(n.effect={ref:i.ref}),r&&(n.alphaOutset={rad:wt(M(r.rad),0)}),o&&(n.blend=cn(o)),a&&(n.fill=zt(a)),u&&(n.glow=fn(u)),s&&(n.innerShdw=ln(s)),c&&(n.outerShdw=hn(c)),f&&(n.prstShdw=dn(f)),l&&(n.reflection=vn(l)),h&&(n.relOff=mn(h)),d&&(n.softEdge={rad:S(d.rad)}),n}function bn(t){var n={cstate:4};return t["r:embed"]&&(n.embed=t["r:embed"]),t.link&&(n.link=t.link),t.cstate&&(n.cstate=y.ST_BlipCompression[t.cstate]),gn(t,n),n}function yn(e){var i,t,r,i={},t,r=["tx","ty"];return["tx","ty","sx","sy"].forEach(function(t){var n;e[t]&&(n=M(e[t]),-1!==r.indexOf(t)&&(n=c(n)),i[t]=n)}),e.flip&&(i.flip=y.ST_TileFlipMode[e.flip]),e.algn&&(i.algn=y.ST_RectAlignment[e.algn]),i}function wn(t){var n,e,i,r,t,n={};return t.dpi&&(n.dpi=M(t.dpi)),t.rotWithShape&&(n.rotWithShape=w(t.rotWithShape)),e=t.blip,i=t.srcRect,r=t.tile,t=t.stretch,e&&(n.blip=bn(e)),i&&(n.srcRect=Lt(i)),r&&(n.tile=yn(r)),t&&(n.stretch=Lt(t.fillRect)),n}function Mn(t){var n,e,i,r,o,a,u,s,t,n={},e=t.blur,i=t.fillOverlay,r=t.glow,o=t.innerShdw,a=t.outerShdw,u=t.prstShdw,s=t.reflection,t=t.softEdge;return e&&(n.blur=Gt(e)),i&&(n.fillOverlay=Vt(i)),r&&(n.glow=fn(r)),o&&(n.innerShdw=ln(o)),a&&(n.outerShdw=hn(a)),u&&(n.prstShdw=dn(u)),s&&(n.reflection=vn(s)),t&&(n.softEdge={rad:S(t.rad)}),n}function Cn(n){var e,t,e={sx:1e5,sy:1e5,kx:0,ky:0,tx:0,ty:0},t;return["sx","sy","kx","ky","tx","ty"].forEach(function(t){e[t]=M(n[t])}),e}function Sn(t){var n,t,n=pn(t),t=t.xfrm;return t&&(n.xfrm=Cn(t)),t}function Tn(n){var e,t,e={pitchFamily:0,charset:1},t;return["typeface","panose","pitchFamily","charset"].forEach(function(t){e[t]=n[t]}),e}function An(t){var n={name:"",builtIn:!1};return t.embed&&(n.embed=t.embed),t.name&&(n.name=t.name),t.builtIn&&(n.builtIn=w(t.builtIn)),n}function In(n){var e,t,i,i,r,e={invalidUrl:"",action:"",tgtFrame:"",tooltip:"",history:!0,highlightClick:!1,endSnd:!1},t,i=["history","highlightClick","endSnd"];return n.id,yt(["id","invalidUrl","action","tgtFrame","tooltip"],n,e),i.forEach(function(t){e[t]=w(n[t])}),i=n.snd,r=n.extLst,i&&(e.snd=An(i)),r&&(e.extLst=A(r)),e}function xn(t){var n,e,i,r,i,r,o,a,u,s,c,f,l,h,d,v,m,g,n={},e,i=["kumimoji","normalizeH","noProof","dirty","err","smtClean"],r=["altLang","bmk"];return yt(["kern","spc","baseline","smtId"],t,n,M),yt(i,t,n,w),yt(r,t,n),t.sz&&(n.sz=z(S(t.sz)/100)),t.b&&(n.b=p(t.b)),t.i&&(n.i=p(t.i)),t.u&&(n.u=y.ST_TextUnderlineType[t.u]),t.strike&&(n.strike=y.ST_TextStrikeType[t.strike]),t.cap&&(n.cap=y.ST_TextCapsType[t.cap]),i=t.effectLst,r=t.effectDag,o=t.highlight,a=t.uLnTx,u=t.uLn,s=t.uFillTx,c=t.uFill,f=t.latin,l=t.ea,h=t.cs,d=t.sym,v=t.hlinkClick,m=t.hlinkMouseOver,g=t.extLst,n.ln=At(t.ln),zt(t,n),i&&(n.effectLst=Mn(i)),r&&(n.effectDag=Sn(r)),o&&(n.highlight=T(o)),a&&(n.uLnTx={}),u&&(n.uLn=At(u)),s&&(n.uFillTx={}),c&&(n.uFill=zt(c)),f&&(n.latin=Tn(f)),l&&(n.ea=Tn(l)),h&&(n.cs=Tn(h)),d&&(n.sym=Tn(d)),v&&(n.hlinkClick=In(v)),m&&(n.hlinkMouseOver=In(m)),g&&(n.extLst=A),n}function Nn(t){var n,e,t,n={},e=t.spcPct,t=t.spcPts;return e&&(n.spcPct=S(e.val)),t&&(n.spcPts=S(t.val)),n}function kn(t){var n={startAt:1};return t.type&&(n.type=y.ST_TextAutonumberScheme[t.type]),t.startAt&&(n.startAt=M(t.startAt)),n}function Dn(t){var n={};return t.pos&&(n.pos=M(t.pos)),t.algn&&(n.algn=y.ST_TextTabAlignType[t.algn]),n}function _n(t){var n,e,t,n={tab:[]},e=t.tab,t=t.dumy;return e&&(e=s(e)).forEach(function(t){n.tab.push(Dn(t))}),t&&(n.dumy=w(t)),n}function En(t){var n,e,i,i,r,o,a,u,s,c,f,l,h,d,v,m,g,p,b,t,n={},e,i=["rtl","eaLnBrk","latinLnBrk","hangingPunct"];return yt(["marL","marR","lvl","indent","defTabSz"],t,n,M),yt(i,t,n,w),t.fontAlgn&&(n.fontAlgn=y.ST_TextFontAlignType[t.fontAlgn]),t.algn&&(n.algn=y.ST_TextAlignType[t.algn]),i=t.lnSpc,r=t.spcBef,o=t.spcAft,a=t.buClrTx,u=t.buClr,s=t.buSzTx,c=t.buSzPct,f=t.buSzPts,l=t.buFontTx,h=t.buFont,d=t.buNone,v=t.buAutoNum,m=t.buChar,g=t.buBlip,p=t.tabLst,b=t.defRPr,t=t.extLst,i&&(n.lnSpc=Nn(i)),r&&(n.spcBef=Nn(r)),o&&(n.spcAft=Nn(o)),a&&(n.buClrTx={}),u&&(n.buClr=T(u)),s&&(n.buSzTx={}),c&&(n.buSzPct=S(c.val)),f&&(n.buSzPts=S(f.val)),l&&(n.buFontTx={}),h&&(n.buFont=Tn(h)),d&&(n.buNone={}),v&&(n.buAutoNum=kn(v)),m&&(n.buChar={char:m.char}),g&&(n.buBlip=bn(g.blip)),p&&(n.tabLst=_n(p)),b&&(n.defRPr=xn(b)),t&&(n.extLst=A(t)),n}function jn(t){var n,e,i,t,n={elementType:2};t.id&&(n.id=M(t.id)),t.type&&(n.type=M(t.type)),e=t.rPr,i=t.pPr,t=t.t,e&&(n.rPr=xn(e)),i&&(n.pPr=En(i)),t&&(n.t=t)}function On(t){var n={};return t.name&&(n.name=t.name),t.fmla&&(n.fmla=t.fmla),n}function Rn(t){var n,e,t,n={gd:[]},e=s(t.gd),t=t.dumy;return e&&e.forEach(function(t){n.gd.push(On(t))}),t&&(n.dumy=w(t)),n}function Bn(t){var n,e,n={},e=t.prst;f(e)||(n.prst=y.ST_TextShapeType[e]),Rn(t.avLst)}function Ln(t){var n={fontScale:1e5,lnSpcReduction:0};t.fontScale&&(n.fontScale=M(t.fontScale)),t.lnSpcReduction&&(n.lnSpcReduction=M(t.lnSpcReduction))}function Fn(t,n,e,i,r){var o,a,u,t,e,s,c,f,l,o=[],a=new P.Evaluator,u,t=(n.source||t.Uw()).getEvaluatorContext((0,P.eV)(e,i)),e=(0,P.h0t)(t,n,!1,0,0,!0,!0),s=a.evaluate(e||n,t,!0,!0);if(s instanceof P.CalcReference)for(c=s.getSource().getName(),f=0;f<s.getRangeCount();f++)l=h.CreateReference(c,s.getRow(f),s.getColumn(f),s.getRowCount(f),s.getColumnCount(f)),n.rowRelative&&(l.Kind|=y.ReferenceKind.RowIsRelative),n.columnRelative&&(l.Kind|=y.ReferenceKind.ColumnIsRelative),n.endRowRelative&&(l.Kind|=y.ReferenceKind.LastRowIsRelative),n.endColumnRelative&&(l.Kind|=y.ReferenceKind.LastColumnIsRelative),o.push(l);return o}function Pn(t,n,e,i,r){var o,a,u,o=t&&t.getCalcService();if(n&&o){a=void 0;try{u=o.parse(t.Uw(),n,0,0,!1,!1,!r),a=Fn(t,u,0,0,n)}catch(t){}if(a&&0<a.length)return a[0]}return m}function C(t){this.d0t=t}function I(t,n,e,i){var t,r,t=ht.call(this,t)||this;return n===u&&(n=m),e===u&&(e=m),i===u&&(i=m),(r=t).v0t=m,r.m0t=m,r.g0t=m,r.p0t=e||"",r.b0t=i,r.InitRichTextFields(n),t}function x(t,n,e){var i,r,i=this;return n===u&&(n=m),e===u&&(e=m),(r=i=dt.call(this,n)||this).y0t=y.ThemeFont.None,r.w0t=m,r.M0t=m,r.C0t=m,r.DJ=t,r.S0t=new U.FillFormat(t,n&&n.FillInternal),r.sft=n,e&&(f(e.Size)||(r.Eft=e.Size),f(e.Bold)||(r.T0t=e.Bold)),r}function N(t,n){var e=this;e.DJ=t,e.A0t=n,e._font=new b(t),e._font.ParentStateful=n.Font}function k(t,n,e){var e,i,e=vt.call(this,t,e)||this,i=e;return i.I0t=m,i.x0t=m,i._text=n,i.DJ=t,i.elementType=y.TextParagraphElementType.RegularTextRun,e}function D(t,n,e){var e,i,e=mt.call(this,t,e)||this,i=e;return i.uit=n,i.d0t=t,i.N0t=new et(i.d0t),i.elementType=y.TextParagraphElementType.TextField,e}function _(t,n){var t=gt.call(this,t,n)||this;return t.elementType=y.TextParagraphElementType.TextLineBreak,t}function E(t,n){var e=this;e.k0t=m,e.D0t=m,e._0t=" ",e.DJ=t,e.v0t=n,e._font=new b(t),e._font.ParentStateful=e.v0t.Font,e.j0t=[]}function j(t,n){this.O0t=[],this.R0t=m,this.B0t=m,this.DJ=t,this.b0t=n,this._font=new b(t,m,n),this.L0t=void 0,this.F0t={top:void 0,bottom:void 0,left:void 0,right:void 0},this.P0t=void 0,this.G0t=void 0,this.U0t=void 0,this.lrt=void 0,this.H0t=void 0,this.z0t=void 0}function O(t,n){var e,i,e=pt.call(this)||this,i=e;return i.Format1=t,i.Format2=n,e}function R(t,n){var e,i,e=bt.call(this)||this,i=e;return i.Format1=t,i.Format2=n,e}e=this&&this.__extends||(lt=function(t,n){return(lt=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(t,n){t.__proto__=n}:function(t,n){for(var e in n)Object.prototype.hasOwnProperty.call(n,e)&&(t[e]=n[e])}))(t,n)},function(t,n){if("function"!=typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function e(){this.constructor=t}lt(t,n),t.prototype=null===n?Object.create(n):(e.prototype=n.prototype,new e)}),L=this&&this.__assign||function(){return(L=Object.assign||function(t){for(var n,e,i,r,e=1,i=arguments.length;e<i;e++)for(r in n=arguments[e])Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r]);return t}).apply(this,arguments)},Object.defineProperty(t,"__esModule",{value:!0}),t.ComboFontFormat=t.ComboColorFormat=t.DrawingTextBody=t.DrawingTextParagraph=t.DrawingLineBreak=t.DrawingTextField=t.DrawingTextRun=t.DrawingTextElement=t.FontFormat=t.DrawingText=t.ReferenceText=t.V0t=void 0,F=n("Common"),P=n("CalcEngine"),i=n("Core"),G=n("./dist/plugins/floatingObject/drawing/stateful.js"),r=n("./dist/plugins/floatingObject/drawing/common.js"),U=n("./dist/plugins/floatingObject/drawing/fillFormat.js"),H=n("./dist/plugins/floatingObject/drawing/fontData.js"),y=n("./dist/plugins/floatingObject/drawing/drawingInterface.js"),S=i.NodeHelper.sr,p=i.NodeHelper.ur,w=i.NodeHelper.fr,z=i.ExcelHelper.pointToPixel,c=i.ExcelHelper.emuToPixles,o=i.ExcelHelper.pixelToEMU,V=i.Util.StringToByteArray,d=i.mt.u1,Y=i.mt.n1,Z=i.mt.vo,W=i.mt.r1,J=91440,K=c(Q=45720),X=c(J),q="overflow",n=F.Common.lt,v=n._h,h=r.ChartUtility,$=h.Aft,a=r.ChartConstants,F=r.UnitHelper,f=F.isNullOrUndefined,tt=r.toKnownColor,nt=r.toColorSchemeIndex,s=r.gft,m=null,u=void 0,l={hiddenScene3dUri:"{31F19639-BCED-4A60-ADC4-E9642A236FB7}",hiddenSp3dUri:"{E45631CC-5BF2-4C18-A39C-3461C7D3F71A}",hiddenFillUri:"{909E8E84-426E-40DD-AFC4-6F175D3DCCD1}",hiddenFillUri2:"{909E8E84-426E-40dd-AFC4-6F175D3DCCD1}",hiddenLineUri:"{91240B29-F687-4F45-9708-019B960494DF}",hiddenLineUri2:"{91240B29-F687-4f45-9708-019B960494DF}",hiddenASvgBlip:"{96DAC541-7B7A-43D3-8B79-37D633B846F1}",hiddenASvgBlip2:"{96DAC541-7B7A-43d3-8B79-37D633B846F1}"},t.V0t=T,Object.defineProperty(C.prototype,"Formula",{get:function(){return this.GetFormula(!1)},set:function(t){t!==this.Formula&&this.UpdateTextByFormulas(t)},enumerable:!1,configurable:!0}),Object.defineProperty(C.prototype,"FormulaR1C1",{get:function(){return this.GetFormula(!0)},set:function(t){t!==this.Formula&&this.UpdateTextByFormulas(t,!0)},enumerable:!1,configurable:!0}),Object.defineProperty(C.prototype,"Parent",{get:function(){return this.d0t},enumerable:!1,configurable:!0}),Object.defineProperty(C.prototype,"ReferingText",{get:function(){return this.GetReferingText()},enumerable:!1,configurable:!0}),Object.defineProperty(C.prototype,"Worksheet",{get:function(){return this.d0t.sheet()},enumerable:!1,configurable:!0}),Object.defineProperty(C.prototype,"TextRefer",{get:function(){return this.Y0t},set:function(t){this.SetTextRefer(t)},enumerable:!1,configurable:!0}),C.prototype.SetTextRefer=function(t,n){this.SetTextReferInternal(t,n=n===u?!0:n),this.OnSetTextRefer(t)},C.prototype.OnSetTextRefer=function(t){},C.prototype.GetReferingText=function(){var t="";return t=f(this.Y0t)?t:this.GetFirstCellText(this.Y0t)},C.prototype.GetFirstCellText=function(t){var n,n,n,n,n=this.Worksheet;return f(t.WorksheetName)&&(t.WorksheetName=n.name()),n=(n=(n=n.parent)&&n.getSheetFromName(t.WorksheetName))&&n.getText(t.Row,t.Column),f(n)?"":n},C.prototype.GetTextList=function(t){var n,e,i,r,o,a,n=[],e=this.Worksheet;for(f(t.WorksheetName)&&(t.WorksheetName=e.name()),i=e.Mnn(t.WorksheetName),r=t.Row;r<=t.LastRow;r++)for(o=t.Column;o<=t.LastColumn;o++)a=i.Snn(r,o).Text,n.push(f(a)?"":a);return n},C.prototype.SetTextReferInternal=function(t,n){this.Y0t=t},C.prototype.GetFormula=function(t){var n,e;return t===u&&(t=!1),(n=this.Y0t)?(e=this.Worksheet.name(),t?n.ToR1C1Text(e):n.ToA1Text(0,0,e)):""},C.prototype.UpdateTextByFormulas=function(t,n){this.Y0t=Pn(this.Worksheet,t,0,0,n=n===u?!1:n)},et=C,t.ReferenceText=et,e(I,ht=et),I.prototype.InitRichTextFields=function(t){var n,e,n=this,e=n.CreateDrawingTextBody(n.d0t,n.b0t);f(n.v0t)||n.v0t.Font.SetParentForChildren(e.Font),n.v0t=e,n.v0t.Font.ParentStateful=t,f(n.p0t)||n.v0t.AddParagraph(n.p0t)},Object.defineProperty(I.prototype,"TextBody",{get:function(){return this.v0t},enumerable:!1,configurable:!0}),Object.defineProperty(I.prototype,"Font",{get:function(){return this.v0t.Font},enumerable:!1,configurable:!0}),Object.defineProperty(I.prototype,"Text",{get:function(){return f(this.TextRefer)?this.v0t.Text:this.ReferingText},set:function(t){this.SetTextInternal(t)},enumerable:!1,configurable:!0}),I.prototype.SetTextInternal=function(t){this.SetTextReferInternal(m),this.UpdateTextBody(t)},I.prototype.UpdateTextBody=function(t){this.v0t.Clear();var t=f(t)?this.p0t:t;f(t)||this.v0t.AddParagraph(t)},I.prototype.OnSetTextRefer=function(t){ht.prototype.OnSetTextRefer.call(this,t),this.UpdateTextBody(m)},I.prototype.FromOOModel=function(t){var n=this;n.m0t=t,n.InitRichTextFields(n.v0t.Font.ParentStateful),f(t.rich)||n.v0t.FromOOModel(t.rich),!f(t.strRef)&&t.strRef.f&&n.UpdateTextByFormulas(t.strRef.f)},I.prototype.FromSJSOOModel=function(t){var n=this;n.g0t=t,n.InitRichTextFields(n.v0t.Font.ParentStateful),f(t.rich)||n.v0t.FromSJSOOModel(t.rich),!f(t.strRef)&&t.strRef.f&&t.strRef.f.v_&&n.UpdateTextByFormulas(t.strRef.f.v_)},I.prototype.ToOOModel=function(t){var n,e,n=this,e=f(n.m0t)?{}:n.m0t;return f(n.Y0t)||(e.strRef={f:n.Formula}),e.rich=n.v0t.ToOOModel(t),e},I.prototype.ToSJSOOModel=function(t){var n,e,n=this,e=f(n.g0t)?{}:n.g0t;return f(n.Y0t)||(e.strRef={f:{v_:n.Formula}}),e.rich=n.v0t.ToSJSOOModel(t),e},I.prototype.SetParagraphSplitFlag=function(t){for(var n,e,i,n=this.v0t,e=0,i=n.Count;e<i;e++)n.Get(e).SplitSpaceFlag=t},I.prototype.CreateDrawingTextBody=function(t,n){return new st(t,n)},t.DrawingText=I,g={Bold:1,Color:2,Italic:4,Name:8,OutlineFont:16,Shadow:32,Size:64,Strikethrough:128,Subscript:256,Superscript:512,ThemeFont:1024,Underline:2048},dt=G.StatefulBase,e(x,dt),Object.defineProperty(x.prototype,"Bold",{get:function(){var t=this.sft;return t&&!this.GetState(g.Bold)?t.Bold:this.T0t},set:function(t){this.T0t=t,this.SetState(g.Bold,!0)},enumerable:!1,configurable:!0}),Object.defineProperty(x.prototype,"Color",{get:function(){return this.FillInternal.Color},enumerable:!1,configurable:!0}),Object.defineProperty(x.prototype,"Italic",{get:function(){var t=this.sft;return t&&!this.GetState(g.Italic)?t.Italic:this.Z0t},set:function(t){this.Z0t=t,this.SetState(g.Italic,!0)},enumerable:!1,configurable:!0}),Object.defineProperty(x.prototype,"Name",{get:function(){var t=this.sft;return t&&!this.HasOwnFont()?t.Name:this.GetOwnFont()},set:function(t){this.SetFont(t),this.ClearOOFontNames()},enumerable:!1,configurable:!0}),Object.defineProperty(x.prototype,"Size",{get:function(){var t=this.sft;return t&&!this.GetState(g.Size)?t.Size:this.Eft},set:function(t){this.Eft=t,this.SetState(g.Size,!0)},enumerable:!1,configurable:!0}),Object.defineProperty(x.prototype,"Strikethrough",{get:function(){var t=this.sft;return t&&!this.GetState(g.Strikethrough)?t.Strikethrough:this.W0t},set:function(t){this.W0t=t,this.SetState(g.Strikethrough,!0)},enumerable:!1,configurable:!0}),Object.defineProperty(x.prototype,"Subscript",{get:function(){var t=this.sft;return t&&!this.GetState(g.Subscript)?t.Subscript:this.Q0t},set:function(t){this.Q0t=t,this.SetState(g.Subscript,!0)},enumerable:!1,configurable:!0}),Object.defineProperty(x.prototype,"Superscript",{get:function(){var t=this.sft;return t&&!this.GetState(g.Superscript)?t.Superscript:this.K0t},set:function(t){this.K0t=t,this.SetState(g.Superscript,!0)},enumerable:!1,configurable:!0}),Object.defineProperty(x.prototype,"Underline",{get:function(){var t=this.sft;return t&&!this.GetState(g.Underline)?t.Underline:this.J0t},set:function(t){this.J0t=t,this.SetState(g.Underline,!0)},enumerable:!1,configurable:!0}),Object.defineProperty(x.prototype,"ThemeFont",{get:function(){var t=this.sft;return t&&!this.GetState(g.ThemeFont)?t.ThemeFont:this.y0t},set:function(t){this.SetThemeFont(t),this.ClearOOFontNames()},enumerable:!1,configurable:!0}),x.prototype.IsDirtyIncludingParent=function(t){return!(!this.S0t||!this.S0t.IsDirtyIncludingParent(t))||dt.prototype.IsDirtyIncludingParent.call(this,t)},x.prototype.HasOwnFont=function(){return this.IsDirty(g.Name)||this.IsDirty(g.ThemeFont)},x.prototype.OnParentChanged=function(t){this.sft=t,this.S0t&&(this.S0t.ParentStateful=t&&t.FillInternal)},x.prototype.GetOwnFont=function(){return this.y0t===y.ThemeFont.None?this.Zc:this.DJ.Cft(this.y0t)},x.prototype.SetFont=function(t){var n=this;t===a.CHART_CS_HEAD_FONT||t===a.CHART_EA_HEAD_FONT||t===a.CHART_LATIN_HEAD_FONT?n.SetThemeFont(y.ThemeFont.Major):t===a.CHART_CS_BODY_FONT||t===a.CHART_EA_BODY_FONT||t===a.CHART_LATIN_BODY_FONT?n.SetThemeFont(y.ThemeFont.Minor):(n.Zc=t,n.SetState(g.Name,!0),n.y0t=y.ThemeFont.None,n.SetState(g.ThemeFont,!1))},x.prototype.SetThemeFont=function(t){var n=this;n.y0t=t,n.SetState(g.ThemeFont,!0),n.Zc=m,n.SetState(g.Name,!1)},x.prototype.ClearOOFontNames=function(){this.M0t=m,this.C0t=m,this.w0t=m},x.prototype.GetActualFormat=function(){var t,n,e,i,t,n=new x(this.DJ);for(e in g)if(this.IsDirty(i=g[e]))switch(i){case g.Bold:n.Bold=this.Bold;break;case g.Italic:n.Italic=this.Italic;break;case g.Name:n.Name=this.Name;break;case g.Size:n.Size=this.Size;break;case g.Strikethrough:n.Strikethrough=this.Strikethrough;break;case g.Subscript:n.Superscript=this.Superscript;break;case g.Superscript:n.Subscript=this.Subscript;break;case g.ThemeFont:n.ThemeFont=this.ThemeFont;break;case g.Underline:n.Underline=this.Underline}return n},Object.defineProperty(x.prototype,"FillInternal",{get:function(){var t=this;return t.S0t||(t.S0t=new U.FillFormat(t.DJ,t.sft&&t.sft.FillInternal)),t.S0t},enumerable:!1,configurable:!0}),x.prototype.TextCharacterProperties_FromOOModel=function(t){var n,e,n=this;n.SuspendClearChildrenState(),n.X0t=t,f(t.latin)||(n.M0t=t.latin.typeface),f(t.ea)||(n.w0t=t.ea.typeface),f(t.cs)||(n.C0t=t.cs.typeface),n.M0t?n.SetFont(n.M0t):n.w0t?n.SetFont(n.w0t):n.C0t&&n.SetFont(n.C0t),f(t.sz)||(e=t.sz,n.Eft!==e&&(n.Size=e)),f(t.b)||(n.Bold=t.b),f(t.i)||(n.Italic=t.i),f(t.strike)||(n.Strikethrough=t.strike===y.ST_TextStrikeType.sngStrike||t.strike===y.ST_TextStrikeType.dblStrike),f(t.u)||(n.Underline=t.u),f(t.baseline)||0===t.baseline?n.Subscript=!1:n.Subscript=!0,f(t.solidFill)?f(t.noFill)?f(t.blipFill)?f(t.gradFill)?f(t.pattFill)?n.SetFillField(m):n.FillInternal.FromOOModel(t.pattFill,y.ColorFillType.PatternFillProperties):n.FillInternal.FromOOModel(t.gradFill,y.ColorFillType.GradientFillProperties):n.FillInternal.FromOOModel(t.blipFill,y.ColorFillType.BlipFillProperties):n.FillInternal.Color.ColorType=y.SolidColorType.None:n.FillInternal.FromOOModel(t.solidFill,y.ColorFillType.SolidColorFillProperties),n.ResumeClearChilrenState()},x.prototype.TextCharacterProperties_FromSJSOOModel=function(t){var n,e,e,n=this;n.SuspendClearChildrenState(),f(t.latin)||(n.M0t=t.latin.typeface),f(t.ea)||(n.w0t=t.ea.typeface),f(t.cs)||(n.C0t=t.cs.typeface),n.M0t?n.SetFont(n.M0t):n.w0t?n.SetFont(n.w0t):n.C0t&&n.SetFont(n.C0t),f(t.sz)||(e=z(S(t.sz)/100),n.Eft!==e&&(n.Size=e)),f(t.b)||(n.Bold=p(t.b)),f(t.i)||(n.Italic=p(t.i)),f(t.strike)||(n.Strikethrough=y.ST_TextStrikeType[t.strike]===y.ST_TextStrikeType.sngStrike||y.ST_TextStrikeType[t.strike]===y.ST_TextStrikeType.dblStrike),f(t.u)||(n.Underline=y.ST_TextUnderlineType[t.u]),n.Subscript=!1,e=t.solidFill,f(e)?f(t.noFill)?f(t.blipFill)?f(t.gradFill)?f(t.pattFill)?n.SetFillField(m):n.FillInternal.FromSJSOOModel(t.pattFill,y.ColorFillType.PatternFillProperties):n.FillInternal.FromSJSOOModel(t.gradFill,y.ColorFillType.GradientFillProperties):n.FillInternal.FromSJSOOModel(t.blipFill,y.ColorFillType.BlipFillProperties):n.FillInternal.Color.ColorType=y.SolidColorType.None:n.FillInternal.FromSJSOOModel(e,y.ColorFillType.SolidColorFillProperties),n.ResumeClearChilrenState()},x.prototype.AdjustStateful=function(t,n){f(t)||(t.SetParentForChildren(n),f(n)||(n.ParentStateful=t.ParentStateful),t.ParentStateful=m)},x.prototype.SetFillField=function(t){this.AdjustStateful(this.S0t,t),this.S0t=t},x.prototype.TextCharacterProperties_ToOOModel=function(){var t,n,e,e,t,t=this;return t.IsDirtyIncludingParent(!0)?(n=t.X0t||{},t.IsPropDirtyIncludingParent(g.Name,!0)?(e=t.Name,f(n.latin)&&(n.latin={}),n.latin.typeface=e):t.IsPropDirtyIncludingParent(g.ThemeFont,!0)&&t.ThemeFont!==y.ThemeFont.None?(f(n.latin)&&(n.latin={}),n.latin.typeface=t.ThemeFont===y.ThemeFont.Major?a.CHART_LATIN_HEAD_FONT:a.CHART_LATIN_BODY_FONT):(t.M0t||t.w0t||t.C0t)&&(t.M0t&&(f(n.latin)&&(n.latin={}),n.latin.typeface=t.M0t),t.w0t&&(f(n.ea)&&(n.ea={}),n.ea.typeface=t.w0t),t.C0t)&&(f(n.cs)&&(n.cs={}),n.cs.typeface=t.C0t),t.IsPropDirtyIncludingParent(g.Size,!0)&&1<t.Size?n.sz=t.Size:delete n.sz,t.IsPropDirtyIncludingParent(g.Bold,!0)&&(n.b=t.Bold),t.IsPropDirtyIncludingParent(g.Italic,!0)&&(n.i=t.Italic),t.IsPropDirtyIncludingParent(g.Strikethrough,!0)&&(n.strike=t.Strikethrough?y.ST_TextStrikeType.sngStrike:y.ST_TextStrikeType.noStrike),t.IsPropDirtyIncludingParent(g.Underline,!0)&&(n.u=t.Underline),t.Subscript&&f(n.baseline)?n.baseline=-25e3:t.Superscript&&f(n.baseline)?n.baseline=3e4:t.Subscript||t.Superscript||delete n.baseline,$(n),!f(t.S0t)&&t.S0t.IsDirtyIncludingParent(!0)&&((t=(e=t.S0t.ToOOModel()).colorFillType)===y.ColorFillType.SolidColorFillProperties?n.solidFill=e:t===y.ColorFillType.PatternFillProperties?n.pattFill=e:t===y.ColorFillType.GradientFillProperties?n.gradFill=e:t===y.ColorFillType.BlipFillProperties?n.blipFill=e:t===y.ColorFillType.NoFillProperties&&(n.noFill=!0),delete e.colorFillType),n):{}},x.prototype.TextCharacterProperties_ToSJSOOModel=function(){var t,n,e,t=this;return t.IsDirtyIncludingParent(!0)?(n={},!f(t.S0t)&&t.S0t.IsDirtyIncludingParent(!0)&&t.S0t.ToSJS_FillGroup(n),t.IsPropDirtyIncludingParent(g.Name,!0)?(e=t.Name,f(n.latin)&&(n.latin={}),n.latin.typeface=W(e)):t.IsPropDirtyIncludingParent(g.ThemeFont,!0)&&t.ThemeFont!==y.ThemeFont.None?(f(n.latin)&&(n.latin={}),n.latin.typeface=W(t.ThemeFont===y.ThemeFont.Major?a.CHART_LATIN_HEAD_FONT:a.CHART_LATIN_BODY_FONT)):(t.M0t||t.w0t||t.C0t)&&(t.M0t&&(f(n.latin)&&(n.latin={}),n.latin.typeface=W(t.M0t)),t.w0t&&(f(n.ea)&&(n.ea={}),n.ea.typeface=W(t.w0t)),t.C0t)&&(f(n.cs)&&(n.cs={}),n.cs.typeface=W(t.C0t)),t.IsPropDirtyIncludingParent(g.Size,!0)&&1<t.Size?n.sz=Math.round(100*i.ExcelHelper.pixelToPoint(t.Size))+"":delete n.sz,t.IsPropDirtyIncludingParent(g.Bold,!0)&&(n.b=t.Bold?"1":"0"),t.IsPropDirtyIncludingParent(g.Italic,!0)&&(n.i=t.Italic?"1":"0"),t.IsPropDirtyIncludingParent(g.Strikethrough,!0)&&(n.strike=t.Strikethrough?y.ST_TextStrikeType[1]:y.ST_TextStrikeType[0]),t.IsPropDirtyIncludingParent(g.Underline,!0)&&(n.u=y.ST_TextUnderlineType[t.Underline]),t.Subscript&&f(n.baseline)?n.baseline=-25e3:t.Superscript&&f(n.baseline)?n.baseline=3e4:t.Subscript||t.Superscript||delete n.baseline,n):{}},x.prototype.FromOOModel=function(t){var n=this;n.Bold=t.Bold,n.Italic=t.Italic,n.Name=t.Name,t.Scheme!==y.ThemeFont.None&&(n.ThemeFont=t.Scheme),n.Size=t.Size,n.Underline=h.ConvertToTextUnderlineType(t.Underline),n.Strikethrough=t.Strike,n.Subscript=(t.VertAlign&y.VertAlignType.Subscript)===y.VertAlignType.Subscript,n.Superscript=(t.VertAlign&y.VertAlignType.Superscript)===y.VertAlignType.Superscript,n.FillInternal.ColorInternal.ColorData_FromOOModel(t.Color)},x.prototype.FromSJSOOModel=function(t){this.FromOOModel(t)},x.prototype.ToOOModel=function(){var t,n,t,t=this,n=new H.FontData;return n.Bold=t.Bold,n.Italic=t.Italic,n.Name=t.Name,n.Scheme=t.ThemeFont,n.Size=t.Size,n.Underline=h.ToUnderlineType(t.Underline),n.Strike=t.Strikethrough,t.Subscript?n.VertAlign=y.VertAlignType.Subscript:t.Superscript&&(n.VertAlign=y.VertAlignType.Superscript),(t=t.S0t)&&t.ColorInternal.IsDirtyIncludingParent(!0)&&t.ColorInternal.ColorType!==y.SolidColorType.None&&(n.Color=t.ColorInternal.ColorData_ToOOModel()),n},x.prototype.ToSJSOOModel=function(){this.ToOOModel()},b=x,t.FontFormat=b,Object.defineProperty(N.prototype,"Font",{get:function(){return this._font},enumerable:!1,configurable:!0}),Object.defineProperty(N.prototype,"Text",{get:function(){return""},enumerable:!1,configurable:!0}),Object.defineProperty(N.prototype,"IsCustomText",{get:function(){return!1},enumerable:!1,configurable:!0}),N.prototype.Delete=function(){this.A0t.DeleteElement(this),this.A0t=m},N.prototype.FromOOModel=function(t){},N.prototype.ToOOModel=function(){},N.prototype.ToSJSOOModel=function(){},t.DrawingTextElement=n=N,e(k,vt=n),Object.defineProperty(k.prototype,"Text",{get:function(){return this._text},set:function(t){this._text=t},enumerable:!1,configurable:!0}),k.prototype.FromOOModel=function(t){var n=this;n.I0t=t,n._text=t.t,f(t.rPr)?n._font=new b(n.DJ,n._font.ParentStateful):n._font.TextCharacterProperties_FromOOModel(t.rPr)},k.prototype.FromSJSOOModel=function(t){var n=this;n.x0t=t,n._text=Y(t.t.v_),f(t.rPr)?n._font=new b(n.DJ,n._font.ParentStateful):n._font.TextCharacterProperties_FromSJSOOModel(t.rPr)},k.prototype.ToOOModel=function(){var t=this.I0t||{elementType:y.TextParagraphElementType.RegularTextRun};return t.t=this.Text,t.rPr=this._font.TextCharacterProperties_ToOOModel(),t},k.prototype.ToSJSOOModel=function(){var t=this.x0t||{};return t.rPr=this._font.TextCharacterProperties_ToSJSOOModel(),t.t={v_:Z(this.Text)},t},rt=k,t.DrawingTextRun=rt,e(D,mt=n),Object.defineProperty(D.prototype,"Type",{get:function(){return this.uit},set:function(t){this.uit=t},enumerable:!1,configurable:!0}),Object.defineProperty(D.prototype,"Text",{get:function(){return this.Type===y.TextFieldType.TxLink?this.N0t.ReferingText:h.GetTextFieldTypeText(this.Type)},enumerable:!1,configurable:!0}),Object.defineProperty(D.prototype,"Worksheet",{get:function(){return this.d0t&&this.d0t.Parent},enumerable:!1,configurable:!0}),D.prototype.FromOOModel=function(t){var n=this;n.cft=t,n.Type=h.GetTextFieldType(t.type),f(t.rPr)?n._font=new b(n.DJ,n._font.ParentStateful):n._font.TextCharacterProperties_FromOOModel(t.rPr)},D.prototype.FromSJSOOModel=function(t){var n=this;n.fft=t,n.Type=h.GetTextFieldType(t.type),f(t.rPr)?n._font=new b(n.DJ,n._font.ParentStateful):n._font.TextCharacterProperties_FromSJSOOModel(t.rPr)},D.prototype.q0t=function(){var t;return("{"+this.$0t(8)+"-"+this.$0t(4)+"-"+this.$0t(4)+"-"+this.$0t(4)+"-"+this.$0t(12)+"}").toUpperCase()},D.prototype.$0t=function(t){return Math.random().toString(16).slice(-t)},D.prototype.ToOOModel=function(){var t,n,e,t=this,n=t.cft||{elementType:y.TextParagraphElementType.TextField},e=/{[0-9A-F]{8}-[0-9A-F]{4}-[0-9A-F]{4}-[0-9A-F]{4}-[0-9A-F]{12}}/;return(f(n.id)||n.id&&!e.test(n.id))&&(n.id=this.q0t()),n.type=h.GetTextFieldTypeString(t.Type),f(n.rPr)&&(n.rPr={}),n.rPr=t._font.TextCharacterProperties_ToOOModel(),n.t=t.Text,n},D.prototype.ToSJSOOModel=function(){var t,n,e,t=this,n=t.fft||{},e=/{[0-9A-F]{8}-[0-9A-F]{4}-[0-9A-F]{4}-[0-9A-F]{4}-[0-9A-F]{12}}/;return(f(n.id)||n.id&&!e.test(n.id))&&(n.id=this.q0t()),n.type=h.GetTextFieldTypeString(t.Type),f(n.rPr)&&(n.rPr={}),n.rPr=t._font.TextCharacterProperties_ToSJSOOModel(),n.t={v_:Z(t.Text)},n},D.prototype.UpdateTextByFormulas=function(t,n){this.N0t.UpdateTextByFormulas(t,n)},ot=D,t.DrawingTextField=ot,e(_,gt=n),Object.defineProperty(_.prototype,"Text",{get:function(){return"\r\n"},enumerable:!1,configurable:!0}),_.prototype.FromOOModel=function(t){this.cft=t},_.prototype.FromSJSOOModel=function(t){this.fft=t},_.prototype.ToOOModel=function(){return this.cft||{elementType:y.TextParagraphElementType.TextLineBreak}},_.prototype.ToSJSOOModel=function(){return this.fft||{}},at=_,t.DrawingLineBreak=at,Object.defineProperty(E.prototype,"SplitSpaceFlag",{get:function(){return this._0t},set:function(t){this._0t=t},enumerable:!1,configurable:!0}),Object.defineProperty(E.prototype,"Algn",{get:function(){return this.E0t},set:function(t){this.E0t=t},enumerable:!1,configurable:!0}),Object.defineProperty(E.prototype,"Text",{get:function(){for(var t,n,e,i,t="",n=0,e=this.j0t;n<e.length;n++)i=e[n],f(i.Text)||(t+=i.Text);return t},set:function(t){this.Clear(),this.AddRun(t)},enumerable:!1,configurable:!0}),E.prototype.Get=function(t){return this.j0t[t]},Object.defineProperty(E.prototype,"Count",{get:function(){return this.j0t.length},enumerable:!1,configurable:!0}),Object.defineProperty(E.prototype,"Font",{get:function(){return this._font},enumerable:!1,configurable:!0}),E.prototype.AddRun=function(t,n){return this.AddRunInternal(t,n)},E.prototype.AddField=function(t){return this.AddFieldInternal(t)},E.prototype.Clear=function(){for(var t,n,e,t=0,n=this.j0t;t<n.length;t++)(e=n[t]).Font.ParentStateful=m;this.j0t.length=0},E.prototype.FromOOModel=function(t){var n,e,i,r,o,a,u,s,n=this;if((n.k0t=t).pPr&&n.FromParagraphProperties(t.pPr),t.elements)for(e=t.elements.length,i=n.j0t=[],r=n.DJ,o=0;o<e;o++)s=void 0,(u=(a=t.elements[o]).elementType)===y.TextParagraphElementType.RegularTextRun?s=n.CreateDrawingTextRun(r,a.t):u===y.TextParagraphElementType.TextLineBreak?s=n.CreateDrawingLineBreak(r):u===y.TextParagraphElementType.TextField&&(s=n.CreateDrawingTextField(r,h.GetTextFieldType(a.type))),s&&(s.FromOOModel(a),i.push(s))},E.prototype.FromSJSOOModel=function(t){var i,r,o,i=this;i.D0t=t,r=i.j0t=[],o=i.DJ,t.c_&&t.c_.forEach(function(t){var n,e;t.pPr?i.FromSJSParagraphProperties(t.pPr):t.r?(n=i.CreateDrawingTextRun(o,t.r.t?t.r.t.v_:""),e=t.r):t.br?(n=i.CreateDrawingLineBreak(o),e=t.br):t.fld&&(n=i.CreateDrawingTextField(o,h.GetTextFieldType(t.fld.type)),e=t.fld),n&&(n.FromSJSOOModel(e),r.push(n))})},E.prototype.FromParagraphProperties=function(t){var n;t&&(n=this,f(t.algn)||(n.E0t=t.algn),t.defRPr)&&n._font.TextCharacterProperties_FromOOModel(t.defRPr)},E.prototype.FromSJSParagraphProperties=function(t){var n;t&&(n=this,f(t.algn)||(n.E0t=y.ST_TextAlignType[t.algn]),t.defRPr)&&n._font.TextCharacterProperties_FromSJSOOModel(t.defRPr)},E.prototype.ToParagraphProperties=function(t){var n=this;return f(n.E0t)||(t.algn=n.E0t),f(n._font)||(t.defRPr=n._font.TextCharacterProperties_ToOOModel()),t},E.prototype.ToSJSParagraphProperties=function(t){var n=this;return f(n.E0t)||0===n.E0t||(t.algn=y.ST_TextAlignType[n.E0t]),f(n._font)||(t.defRPr=n._font.TextCharacterProperties_ToSJSOOModel()),t},E.prototype.AddRunInternal=function(t,n){var e,e,t,e=this;return n===u&&(n=-1),e=e.CreateDrawingTextRun(e.DJ,t),t=this.j0t,n<0||n>=t.length?t.push(e):t.splice(n,0,e),e},E.prototype.AddFieldInternal=function(t){var t=this.CreateDrawingTextField(this.DJ,t);return this.j0t.push(t),t},E.prototype.ToOOModel=function(){var t,n,e,i,r,o,t=this,n=t.k0t||{elements:[]};for(n.pPr=t.ToParagraphProperties(n.pPr||{}),e=n.elements=[],i=0,o=(r=t.j0t).length;i<o;i++)e.push(r[i].ToOOModel());return(t.DJ.DrawingType===y.DrawingType.Chart||f(t.k0t))&&f(n.endParaRPr)&&(n.endParaRPr={}),n},E.prototype.ToSJSOOModel=function(){var t,n,e,i,r,o,a,u,s,t=this,n=t.D0t||{n_:"p",c_:[]},e=d(n,"pPr")||{},i=d(n,"endParaRPr")||{};for(n.c_=[],t.ToSJSParagraphProperties(e),n.c_.push({pPr:e}),r=0,a=(o=t.j0t).length;r<a;r++)u=o[r].elementType,s=o[r].ToSJSOOModel(),u===y.TextParagraphElementType.RegularTextRun?n.c_.push({r:s}):u===y.TextParagraphElementType.TextLineBreak?n.c_.push({br:s}):u===y.TextParagraphElementType.TextField&&n.c_.push({fld:s});return n.c_.push({endParaRPr:i}),n},E.prototype.To2016ChartOOModel=function(){var t,n,e,i,r,o,a,t=this,n=t.k0t||{elements:[]};for(n.pPr||(n.pPr={}),e=n.pPr,f(t._font)||(e.defRPr=t._font.TextCharacterProperties_ToOOModel()),i=n.elements=[],r=0,a=(o=t.j0t).length;r<a;r++)i.push(o[r].ToOOModel());return f(t._font)||(n.endParaRPr=t._font.TextCharacterProperties_ToOOModel()),n},E.prototype.To2016ChartSJSOOModel=function(){var t,n,t=this,n=t.ToSJSOOModel();return f(t._font)||(n.c_[n.c_.length-1].endParaRPr=t._font.TextCharacterProperties_ToSJSOOModel()),n},E.prototype.Delete=function(){for(var t,n,t=this,n=t.j0t.length-1;0<=n;n--)t.DeleteElement(t.j0t[n]);t.v0t.DeleteParagraph(t),t.v0t=m},E.prototype.DeleteElement=function(t){t.Font.ParentStateful=m;var t=this.j0t.indexOf(t);0<=t&&this.j0t.splice(t,1)},E.prototype.CreateDrawingTextRun=function(t,n){return new rt(t,n,this)},E.prototype.CreateDrawingLineBreak=function(t){return new at(t,this)},E.prototype.CreateDrawingTextField=function(t,n){return new ot(t,n,this)},ut=E,t.DrawingTextParagraph=ut,Object.defineProperty(j.prototype,"Text",{get:function(){for(var t,n,e,i,t="",n=0,e=this.O0t;n<e.length;n++)""!==t&&(t+="\r\n"),t+=(i=e[n]).Text;return t},set:function(t){this.Clear(),this.AddParagraph(t)},enumerable:!1,configurable:!0}),j.prototype.Get=function(t){return this.O0t[t]},Object.defineProperty(j.prototype,"Count",{get:function(){return this.O0t.length},enumerable:!1,configurable:!0}),Object.defineProperty(j.prototype,"Font",{get:function(){return this._font},enumerable:!1,configurable:!0}),Object.defineProperty(j.prototype,"Rotation",{get:function(){return this.L0t},set:function(t){this.L0t=t},enumerable:!1,configurable:!0}),Object.defineProperty(j.prototype,"Inset",{get:function(){return this.F0t},set:function(t){this.F0t=t},enumerable:!1,configurable:!0}),Object.defineProperty(j.prototype,"anchorCtr",{get:function(){return this.P0t},set:function(t){this.P0t=t},enumerable:!1,configurable:!0}),Object.defineProperty(j.prototype,"anchor",{get:function(){return this.G0t},set:function(t){this.G0t=t},enumerable:!1,configurable:!0}),Object.defineProperty(j.prototype,"vert",{get:function(){return this.U0t},set:function(t){this.U0t=t},enumerable:!1,configurable:!0}),Object.defineProperty(j.prototype,"wrap",{get:function(){return this.lrt},set:function(t){this.lrt=t},enumerable:!1,configurable:!0}),Object.defineProperty(j.prototype,"horzOverflow",{get:function(){return this.H0t},set:function(t){this.H0t=t},enumerable:!1,configurable:!0}),Object.defineProperty(j.prototype,"vertOverflow",{get:function(){return this.z0t},set:function(t){this.z0t=t},enumerable:!1,configurable:!0}),j.prototype.setFontColor=function(t,n){var e,i,r,e=this,i=e.O0t.length;for(e._font&&e._font.Color.setColor(t,n),r=0;r<i;r++)e.O0t[r].Font.Color.setColor(t,n)},j.prototype.setFontTransparency=function(t){var n,e,i,n=this,e=n.O0t.length;for(n._font&&(n._font.Color.Transparency=t),i=0;i<e;i++)n.O0t[i].Font.Color.Transparency=t},j.prototype.updateFont=function(n,e,i,r){var t,o,t=this,o=[t._font];t.O0t.forEach(function(t){o.push(t.Font)}),o.forEach(function(t){t&&(t.Name=n,t.Size=e,t.Bold=i,t.Italic=r)})},j.prototype.AddParagraph=function(t,n){var e,t;return n===u&&(n=-1),e=this.CreateDrawingTextParagraph(this.DJ),f(t)||e.AddRun(t),t=this.O0t,n<0||n>=t.length?t.push(e):t.splice(n,0,e),e},j.prototype.Clear=function(){for(var t,n,e,t=0,n=this.O0t;t<n.length;t++)(e=n[t]).Font.ParentStateful=m;this.O0t.length=0},j.prototype.ToOOModel=function(t){var n,e,i,r,o,a,u,s,c,n=this,e=n.R0t||{p:[]},i=this.O0t,r=i.length;if(0===r&&!this._font.IsDirtyIncludingParent())return m;if(o=e.p=[],0<r)for(a=0;a<r;a++)u=i[a],o.push(t?u.To2016ChartOOModel():u.ToOOModel());else(c=(s=n.CreateDrawingTextParagraph(n.DJ)).ToOOModel()).pPr.defRPr=n._font.TextCharacterProperties_ToOOModel(),o.push(c);return e.bodyPr=n.t1t(e.bodyPr||{}),f(e.lstStyle)&&(e.lstStyle={}),e},j.prototype.ToSJSOOModel=function(t){var n,e,i,r,o,a,u,s,c,n=this,e=n.B0t||{bodyPr:{},p:[]},i=this.O0t,r=i.length;if(0===r&&!this._font.IsDirtyIncludingParent())return m;if(e.bodyPr=n.n1t(e.bodyPr||{}),o=e.p=[],0<r)for(a=0;a<r;a++)u=i[a],o.push(t?u.To2016ChartSJSOOModel():u.ToSJSOOModel());else(c=(s=n.CreateDrawingTextParagraph(n.DJ)).ToSJSOOModel()).c_[0].pPr.defRPr=n._font.TextCharacterProperties_ToSJSOOModel(),o.push(c);return e},j.prototype.FromOOModel=function(t){var n,e,i,r,o,a,a,o,u,s,c,f,l,h,n=this;for(n.R0t=t,e=0,i=n.O0t;e<i.length;e++)(r=i[e]).Clear();if(n.O0t.length=0,o=new b(n.DJ,m,n.b0t),(a=n._font)&&(a.SetParentForChildren(o),o.ParentStateful=a.ParentStateful,a.ParentStateful=m),n._font=o,t.p&&t.p.length)for(a=t.p[0].pPr,o=t.p[0].elements&&t.p[0].elements[0]&&t.p[0].elements[0].rPr,u=t.p[0].endParaRPr,s=void 0,a&&a.defRPr&&!v(a.defRPr)?s=L(L({},a.defRPr),o):u&&!v(u)?s=u:o&&!v(o)&&(s=o),s&&n._font.TextCharacterProperties_FromOOModel(s),c=0,f=t.p;c<f.length;c++)l=f[c],(h=n.CreateDrawingTextParagraph(n.DJ)).FromOOModel(l),n.O0t.push(h);n.e1t(t.bodyPr)},j.prototype.FromSJSOOModel=function(t){var n,e,i,r,o,a,a,o,u,u,a,s,c,f,l,h,n=this;for(n.B0t=t,e=0,i=n.O0t;e<i.length;e++)(r=i[e]).Clear();if(n.O0t.length=0,o=new b(n.DJ,m,n.b0t),(a=n._font)&&(a.SetParentForChildren(o),o.ParentStateful=a.ParentStateful,a.ParentStateful=m),n._font=o,t.p=t.p&&[].concat(t.p),t.p&&t.p.length)for(a=t.p[0],o=d(a,"pPr"),u=(u=d(a,"r")||d(a,"br")||d(a,"fld"))&&u.rPr,a=d(a,"endParaRPr"),s=void 0,o&&o.defRPr&&!v(o.defRPr)?s=L(L({},o.defRPr),u):a&&!v(a)?s=a:u&&!v(u)&&(s=u),s&&n._font.TextCharacterProperties_FromSJSOOModel(s),c=0,f=t.p;c<f.length;c++)l=f[c],(h=n.CreateDrawingTextParagraph(n.DJ)).FromSJSOOModel(l),n.O0t.push(h);n.i1t(t.bodyPr)},j.prototype.e1t=function(t){var n,e,e,e,e,e,e,e,e;t&&(n=this,e=t.rot,f(e)||(n.L0t=e),e=t.anchorCtr,f(e)||(n.P0t=e),e=t.anchor,f(e)||(n.G0t=e),e=t.vert,f(e)||(n.U0t=e),e=t.wrap,f(e)||(n.lrt=e),e=t.horzOverflow,f(e)||(n.H0t=e),e=t.vertOverflow,f(e)||(n.z0t=e),e=n.F0t,f(t.tIns)||(e.top=c(t.tIns,6)),f(t.bIns)||(e.bottom=c(t.bIns,6)),f(t.lIns)||(e.left=c(t.lIns,6)),f(t.rIns)||(e.right=c(t.rIns,6)))},j.prototype.t1t=function(t){var n,e,e,e,e,e,e,e,e,n=this,e=n.Rotation;return f(e)||(t.rot=e),e=n.P0t,f(e)||(t.anchorCtr=e),e=n.G0t,f(e)||(t.anchor=e),e=n.U0t,f(e)||(t.vert=e),e=n.lrt,f(e)||(t.wrap=e),e=n.H0t,f(e)||(t.horzOverflow=e),e=n.z0t,f(e)||(t.vertOverflow=e),e=n.F0t,f(e.top)||(t.tIns=o(e.top)),f(e.bottom)||(t.bIns=o(e.bottom)),f(e.left)||(t.lIns=o(e.left)),f(e.right)||(t.rIns=o(e.right)),t},j.prototype.i1t=function(t){var n,e,e,n=this;t.rot&&(e=M(t.rot),f(e)||-6e7===e||(n.L0t=e/6e4)),f(t.anchorCtr)||(n.P0t=p(t.anchorCtr)),f(t.anchor)||(n.G0t=y.ST_TextAnchoringType[t.anchor]),f(t.vert)||(n.U0t=y.ST_TextVerticalType[t.vert]),f(t.wrap)||(n.lrt=y.ST_TextWrappingType[t.wrap]),f(t.horzOverflow)||(n.H0t=y.ST_TextHorzOverflowType[t.horzOverflow]),f(t.vertOverflow)||(n.z0t=y.ST_TextVertOverflowType[t.vertOverflow]),e=n.F0t,f(t.tIns)||(e.top=c(S(t.tIns),6)),f(t.bIns)||(e.bottom=c(S(t.bIns),6)),f(t.lIns)||(e.left=c(S(t.lIns),6)),f(t.rIns)||(e.right=c(S(t.rIns),6))},j.prototype.n1t=function(t){var n,e,e,i,i,i,i,n=this,e=n.Rotation;return f(e)||0===e||(t.rot=6e4*parseInt(e+"",10)),e=n.F0t,f(e.top)||(i=o(e.top))!==Q&&(t.tIns=i),f(e.bottom)||(i=o(e.bottom))!==Q&&(t.bIns=i),f(e.left)||(i=o(e.left))!==J&&(t.lIns=i),f(e.right)||(i=o(e.right))!==J&&(t.rIns=i),!0===n.P0t&&(t.anchorCtr="1"),f(n.G0t)||0===n.G0t||(t.anchor=y.ST_TextAnchoringType[n.G0t]),f(n.U0t)||(t.vert=y.ST_TextVerticalType[n.U0t]),f(n.lrt)||0===n.lrt||(t.wrap=y.ST_TextWrappingType[n.lrt]),f(n.horzOverflow)||0===n.horzOverflow||(t.horzOverflow=y.ST_TextHorzOverflowType[n.horzOverflow]),f(n.vertOverflow)||0===n.vertOverflow||(t.vertOverflow=y.ST_TextVertOverflowType[n.vertOverflow]),t},j.prototype.Delete=function(){for(var t=this.O0t,n=t.length-1;0<=n;n--)this.DeleteParagraph(t[n])},j.prototype.DeleteParagraph=function(t){t.Font.ParentStateful=m;var t=this.O0t.indexOf(t);0<=t&&this.O0t.splice(t,1)},j.prototype.CreateDrawingTextParagraph=function(t){return new ut(t,this)},st=j,t.DrawingTextBody=st,pt=G.StatefulBase,e(O,pt),Object.defineProperty(O.prototype,"Stateful1",{get:function(){return this.Format1},enumerable:!1,configurable:!0}),Object.defineProperty(O.prototype,"Stateful2",{get:function(){return this.Format2},enumerable:!1,configurable:!0}),Object.defineProperty(O.prototype,"Brightness",{get:function(){var t=this;return(!f(t.Format2)&&t.Stateful2.IsPropDirtyIncludingParent(y.ColorFormatStates.Brightness,!1)?t.Format2:t.Format1).Brightness},set:function(t){this.Format1.Brightness=t},enumerable:!1,configurable:!0}),Object.defineProperty(O.prototype,"ColorType",{get:function(){var t=this;return(!f(t.Format2)&&t.Stateful2.IsPropDirtyIncludingParent(y.ColorFormatStates.ColorType,!1)?t.Format2:t.Format1).ColorType},set:function(t){this.Format1.ColorType=t},enumerable:!1,configurable:!0}),Object.defineProperty(O.prototype,"ObjectThemeColor",{get:function(){var t=this;return(!f(t.Format2)&&t.Stateful2.IsPropDirtyIncludingParent(y.ColorFormatStates.ObjectThemeColor,!1)?t.Format2:t.Format1).ObjectThemeColor},set:function(t){this.Format1.ObjectThemeColor=t},enumerable:!1,configurable:!0}),Object.defineProperty(O.prototype,"RGB",{get:function(){var t=this;return(!f(t.Format2)&&t.Stateful2.IsPropDirtyIncludingParent(y.ColorFormatStates.RGB,!1)?t.Format2:t.Format1).RGB},set:function(t){this.Format1.RGB=t},enumerable:!1,configurable:!0}),Object.defineProperty(O.prototype,"TintAndShade",{get:function(){var t=this;return(!f(t.Format2)&&t.Stateful2.IsPropDirtyIncludingParent(y.ColorFormatStates.TintAndShade,!1)?t.Format2:t.Format1).TintAndShade},set:function(t){this.Format1.TintAndShade=t},enumerable:!1,configurable:!0}),O.prototype.GetState=function(){},O.prototype.SetState=function(){},O.prototype.IsDirtyIncludingParent=function(){},O.prototype.IsPropDirtyIncludingParent=function(t,n){return this.Stateful1.IsPropDirtyIncludingParent(t,n)||this.Stateful2.IsPropDirtyIncludingParent(t,n)},O.prototype.Dirty=function(){},O.prototype.UnDirty=function(){},O.prototype.SuspendClearChildrenState=function(){},O.prototype.ResumeClearChilrenState=function(){},O.prototype.AddChildInternal=function(){},O.prototype.RemoveChildInternal=function(){},ct=O,t.ComboColorFormat=ct,bt=G.StatefulBase,e(R,bt),Object.defineProperty(R.prototype,"Stateful1",{get:function(){return this.Format1},enumerable:!1,configurable:!0}),Object.defineProperty(R.prototype,"Stateful2",{get:function(){return this.Format2},enumerable:!1,configurable:!0}),Object.defineProperty(R.prototype,"Bold",{get:function(){var t=this;return(!f(t.Format2)&&t.Stateful2.IsPropDirtyIncludingParent(g.Bold,!1)?t.Format2:t.Format1).Bold},set:function(t){this.Format1.Bold=t},enumerable:!1,configurable:!0}),Object.defineProperty(R.prototype,"Color",{get:function(){return new ct(this.Format1.Color,this.Format2.Color)},enumerable:!1,configurable:!0}),Object.defineProperty(R.prototype,"Italic",{get:function(){var t=this;return(!f(t.Format2)&&t.Stateful2.IsPropDirtyIncludingParent(g.Italic,!1)?t.Format2:t.Format1).Bold},set:function(t){this.Format1.Bold=t},enumerable:!1,configurable:!0}),Object.defineProperty(R.prototype,"Name",{get:function(){var t=this;return(!f(t.Format2)&&t.Stateful2.IsPropDirtyIncludingParent(g.Name,!1)?t.Format2:t.Format1).Name},set:function(t){this.Format1.Name=t},enumerable:!1,configurable:!0}),Object.defineProperty(R.prototype,"Size",{get:function(){var t=this;return(!f(t.Format2)&&t.Stateful2.IsPropDirtyIncludingParent(g.Size,!1)?t.Format2:t.Format1).Size},set:function(t){this.Format1.Size=t},enumerable:!1,configurable:!0}),Object.defineProperty(R.prototype,"Strikethrough",{get:function(){var t=this;return(!f(t.Format2)&&t.Stateful2.IsPropDirtyIncludingParent(g.Strikethrough,!1)?t.Format2:t.Format1).Strikethrough},set:function(t){this.Format1.Strikethrough=t},enumerable:!1,configurable:!0}),Object.defineProperty(R.prototype,"Subscript",{get:function(){var t=this;return(!f(t.Format2)&&t.Stateful2.IsPropDirtyIncludingParent(g.Subscript,!1)?t.Format2:t.Format1).Subscript},set:function(t){this.Format1.Subscript=t},enumerable:!1,configurable:!0}),Object.defineProperty(R.prototype,"Superscript",{get:function(){var t=this;return(!f(t.Format2)&&t.Stateful2.IsPropDirtyIncludingParent(g.Superscript,!1)?t.Format2:t.Format1).Superscript},set:function(t){this.Format1.Superscript=t},enumerable:!1,configurable:!0}),Object.defineProperty(R.prototype,"ThemeFont",{get:function(){var t=this;return(!f(t.Format2)&&t.Stateful2.IsPropDirtyIncludingParent(g.ThemeFont,!1)?t.Format2:t.Format1).ThemeFont},set:function(t){this.Format1.ThemeFont=t},enumerable:!1,configurable:!0}),Object.defineProperty(R.prototype,"Underline",{get:function(){var t=this;return(!f(t.Format2)&&t.Stateful2.IsPropDirtyIncludingParent(g.Underline,!1)?t.Format2:t.Format1).Underline},set:function(t){this.Format1.Underline=t},enumerable:!1,configurable:!0}),R.prototype.GetState=function(){},R.prototype.SetState=function(){},R.prototype.IsDirtyIncludingParent=function(){},R.prototype.IsPropDirtyIncludingParent=function(t,n){return this.Stateful1.IsPropDirtyIncludingParent(t,n)||this.Stateful2.IsPropDirtyIncludingParent(t,n)},R.prototype.Dirty=function(){},R.prototype.UnDirty=function(){},R.prototype.SuspendClearChildrenState=function(){},R.prototype.ResumeClearChilrenState=function(){},R.prototype.AddChildInternal=function(){},R.prototype.RemoveChildInternal=function(){},t.ComboFontFormat=R},"./dist/plugins/floatingObject/drawing/gradient.js":function(t,n,e){"use strict";var i,a,g,p,r,o,e,u,s,c,f;function l(t){this.r1t=t,this._x=new g.ColorFormat(this.r1t)}function h(t){this.o1t=t,this.a1t=[]}function b(t,n,e){var t=new c(t);return t.Position=n,t.Color=e,t}function y(t){return a.ARGBColor.FromArgb(t)}Object.defineProperty(n,"__esModule",{value:!0}),n.GradientStops=n.GradientStop=void 0,i=e("./dist/plugins/floatingObject/drawing/common.js"),a=e("./dist/plugins/floatingObject/drawing/color.js"),g=e("./dist/plugins/floatingObject/drawing/colorFormat.js"),p=e("./dist/plugins/floatingObject/drawing/drawingInterface.js"),r=e("Core"),o=i.ShapeConstants.PositionConver,e=i.ShapeUtility,u=i.gft,s=void 0,Object.defineProperty(l.prototype,"Color",{get:function(){return this._x},set:function(t){this._x=t},enumerable:!1,configurable:!0}),Object.defineProperty(l.prototype,"Position",{get:function(){return this.u_},set:function(t){this.u_=t},enumerable:!1,configurable:!0}),Object.defineProperty(l.prototype,"Transparency",{get:function(){return this._x.Transparency},set:function(t){this._x.Transparency=t},enumerable:!1,configurable:!0}),l.prototype.FromOOModel=function(t){this.Position=t.pos/o,this._x.FromOOModel(t)},l.prototype.FromSJSOOModel=function(t){var n=r.NodeHelper.sr(t.pos,o);this.Position=n/o,this._x.FromSJSOOModel(t)},l.prototype.ToOOModel=function(){var t=this._x.ToOOModel();return t.pos=Math.round(this.Position*o),t},l.prototype.ToSJSOOModel=function(){var t=this._x.ToSJSOOModel();return delete t.colorFillType,t.pos=Math.round(this.Position*o),t},c=l,n.GradientStop=c,h.prototype.Item=function(t){return this.a1t[t]},Object.defineProperty(h.prototype,"Count",{get:function(){return this.a1t.length},enumerable:!1,configurable:!0}),Object.defineProperty(h.prototype,"GradientStopList",{get:function(){return this.a1t},enumerable:!1,configurable:!0}),h.prototype.Delete=function(t){-1===t&&(t=this.Count-1),this.a1t.splice(t,1)},h.prototype.Insert=function(t,n,e,i,r){e===s&&(e=0),i===s&&(i=-1),r===s&&(r=0);var o=new c(this.o1t);o.Color.RGB=a.ARGBColor.FromArgb(t),o.Position=n,o.Transparency=e,o.Color.Brightness=r,i<0?this.a1t.push(o):this.a1t.splice(i,0,o)},h.prototype.FromOOModel=function(t){for(var n,e,i,r,n=0,e=t.gs;n<e.length;n++)i=e[n],(r=new c(this.o1t)).FromOOModel(i),this.GradientStopList.push(r)},h.prototype.FromSJSOOModel=function(t){for(var n,e,i,r,o,n,e=0,i=u(t.gs);e<i.length;e++)r=i[e],(o=new c(this.o1t)).FromSJSOOModel(r),this.GradientStopList.push(o)},h.prototype.ToOOModel=function(){for(var t,n,e,i,t={gs:[]},n=0,e=this.a1t;n<e.length;n++)i=e[n],t.gs.push(i.ToOOModel());return t},h.prototype.ToSJSOOModel=function(){for(var t,n,e,i,t={gs:[]},n=0,e=this.a1t;n<e.length;n++)i=e[n],t.gs.push(i.ToSJSOOModel());return t},f=h,n.GradientStops=f,e.InitGradientStopPresetColor=function(t,n){var e,i,r,o,a,u,s,c,f,l,h,d,v,m,m=n.GradientStops.GradientStopList;switch(n.PresetGradientType){case p.PresetGradientType.GradientEarlySunset:e=b(t,0,(0,g.createColorFormatFromRGB)(t,p.SolidColorType.RGB,y(130))),i=b(t,.3,(0,g.createColorFormatFromRGB)(t,p.SolidColorType.RGB,y(6684815))),r=b(t,.64999,(0,g.createColorFormatFromRGB)(t,p.SolidColorType.RGB,y(12189798))),o=b(t,.89999,(0,g.createColorFormatFromRGB)(t,p.SolidColorType.RGB,y(16711680))),a=b(t,1,(0,g.createColorFormatFromRGB)(t,p.SolidColorType.RGB,y(16744960))),m.push(e),m.push(i),m.push(r),m.push(o),m.push(a);break;case p.PresetGradientType.GradientLateSunset:e=b(t,0,(0,g.createColorFormatFromRGB)(t,p.SolidColorType.RGB,y(0))),i=b(t,.2,(0,g.createColorFormatFromRGB)(t,p.SolidColorType.RGB,y(64))),r=b(t,.5,(0,g.createColorFormatFromRGB)(t,p.SolidColorType.RGB,y(4194368))),o=b(t,.75,(0,g.createColorFormatFromRGB)(t,p.SolidColorType.RGB,y(9371712))),a=b(t,.89999,(0,g.createColorFormatFromRGB)(t,p.SolidColorType.RGB,y(15889152))),u=b(t,1,(0,g.createColorFormatFromRGB)(t,p.SolidColorType.RGB,y(16760576))),m.push(e),m.push(i),m.push(r),m.push(o),m.push(a),m.push(u);break;case p.PresetGradientType.GradientNightfall:e=b(t,0,(0,g.createColorFormatFromRGB)(t,p.SolidColorType.RGB,y(0))),i=b(t,.39999,(0,g.createColorFormatFromRGB)(t,p.SolidColorType.RGB,y(660108))),r=b(t,.7,(0,g.createColorFormatFromRGB)(t,p.SolidColorType.RGB,y(1580231))),o=b(t,.88,(0,g.createColorFormatFromRGB)(t,p.SolidColorType.RGB,y(7341524))),a=b(t,1,(0,g.createColorFormatFromRGB)(t,p.SolidColorType.RGB,y(9190801))),m.push(e),m.push(i),m.push(r),m.push(o),m.push(a);break;case p.PresetGradientType.GradientDaybreak:e=b(t,0,(0,g.createColorFormatFromRGB)(t,p.SolidColorType.RGB,y(6201087))),i=b(t,.39999,(0,g.createColorFormatFromRGB)(t,p.SolidColorType.RGB,y(8766207))),r=b(t,.7,(0,g.createColorFormatFromRGB)(t,p.SolidColorType.RGB,y(12900075))),o=b(t,1,(0,g.createColorFormatFromRGB)(t,p.SolidColorType.RGB,y(16772090))),m.push(e),m.push(i),m.push(r),m.push(o);break;case p.PresetGradientType.GradientHorizon:e=b(t,0,(0,g.createColorFormatFromRGB)(t,p.SolidColorType.RGB,y(14478325))),i=b(t,.08,(0,g.createColorFormatFromRGB)(t,p.SolidColorType.RGB,y(8628163))),r=b(t,.13,(0,g.createColorFormatFromRGB)(t,p.SolidColorType.RGB,y(7770041))),o=b(t,.21001,(0,g.createColorFormatFromRGB)(t,p.SolidColorType.RGB,y(8628163))),a=b(t,.52,(0,g.createColorFormatFromRGB)(t,p.SolidColorType.RGB,y(16777215))),u=b(t,.56,(0,g.createColorFormatFromRGB)(t,p.SolidColorType.RGB,y(10249571))),s=b(t,.58,(0,g.createColorFormatFromRGB)(t,p.SolidColorType.RGB,y(8400941))),c=b(t,.71001,(0,g.createColorFormatFromRGB)(t,p.SolidColorType.RGB,y(12603982))),f=b(t,.94,(0,g.createColorFormatFromRGB)(t,p.SolidColorType.RGB,y(15456980))),l=b(t,1,(0,g.createColorFormatFromRGB)(t,p.SolidColorType.RGB,y(5580316))),m.push(e),m.push(i),m.push(r),m.push(o),m.push(a),m.push(u),m.push(s),m.push(c),m.push(f),m.push(l);break;case p.PresetGradientType.GradientDesert:e=b(t,0,(0,g.createColorFormatFromRGB)(t,p.SolidColorType.RGB,y(16555979))),i=b(t,.87,(0,g.createColorFormatFromRGB)(t,p.SolidColorType.RGB,y(16298057))),r=b(t,.78999,(0,g.createColorFormatFromRGB)(t,p.SolidColorType.RGB,y(16298057))),o=b(t,.37,(0,g.createColorFormatFromRGB)(t,p.SolidColorType.RGB,y(16705522))),a=b(t,.33,(0,g.createColorFormatFromRGB)(t,p.SolidColorType.RGB,y(16339616))),u=b(t,.31,(0,g.createColorFormatFromRGB)(t,p.SolidColorType.RGB,y(12912713))),s=b(t,.17999,(0,g.createColorFormatFromRGB)(t,p.SolidColorType.RGB,y(11812485))),c=b(t,0,(0,g.createColorFormatFromRGB)(t,p.SolidColorType.RGB,y(16298057))),m.push(e),m.push(i),m.push(r),m.push(o),m.push(a),m.push(u),m.push(s),m.push(c);break;case p.PresetGradientType.GradientOcean:e=b(t,0,(0,g.createColorFormatFromRGB)(t,p.SolidColorType.RGB,y(251048))),i=b(t,.25,(0,g.createColorFormatFromRGB)(t,p.SolidColorType.RGB,y(2217696))),r=b(t,.75,(0,g.createColorFormatFromRGB)(t,p.SolidColorType.RGB,y(34790))),o=b(t,1,(0,g.createColorFormatFromRGB)(t,p.SolidColorType.RGB,y(23743))),m.push(e),m.push(i),m.push(r),m.push(o);break;case p.PresetGradientType.GradientCalmWater:e=b(t,.5,(0,g.createColorFormatFromRGB)(t,p.SolidColorType.RGB,y(13421823))),i=b(t,.41001,(0,g.createColorFormatFromRGB)(t,p.SolidColorType.RGB,y(10079487))),r=b(t,.32,(0,g.createColorFormatFromRGB)(t,p.SolidColorType.RGB,y(10053375))),o=b(t,.195,(0,g.createColorFormatFromRGB)(t,p.SolidColorType.RGB,y(13408767))),a=b(t,.8999,(0,g.createColorFormatFromRGB)(t,p.SolidColorType.RGB,y(10079487))),u=b(t,0,(0,g.createColorFormatFromRGB)(t,p.SolidColorType.RGB,y(13421823))),s=b(t,.59,(0,g.createColorFormatFromRGB)(t,p.SolidColorType.RGB,y(10079487))),c=b(t,.68,(0,g.createColorFormatFromRGB)(t,p.SolidColorType.RGB,y(10053375))),f=b(t,.805,(0,g.createColorFormatFromRGB)(t,p.SolidColorType.RGB,y(13408767))),l=b(t,.91001,(0,g.createColorFormatFromRGB)(t,p.SolidColorType.RGB,y(10079487))),h=b(t,1,(0,g.createColorFormatFromRGB)(t,p.SolidColorType.RGB,y(13421823))),m.push(e),m.push(i),m.push(r),m.push(o),m.push(a),m.push(u),m.push(s),m.push(c),m.push(f),m.push(l),m.push(h);break;case p.PresetGradientType.GradientFire:e=b(t,0,(0,g.createColorFormatFromRGB)(t,p.SolidColorType.RGB,y(16773632))),i=b(t,.45,(0,g.createColorFormatFromRGB)(t,p.SolidColorType.RGB,y(16742912))),r=b(t,.7,(0,g.createColorFormatFromRGB)(t,p.SolidColorType.RGB,y(16712448))),o=b(t,1,(0,g.createColorFormatFromRGB)(t,p.SolidColorType.RGB,y(5048328))),m.push(e),m.push(i),m.push(r),m.push(o);break;case p.PresetGradientType.GradientFog:e=b(t,0,(0,g.createColorFormatFromRGB)(t,p.SolidColorType.RGB,y(8685764))),i=b(t,.53,(0,g.createColorFormatFromRGB)(t,p.SolidColorType.RGB,y(13950719))),r=b(t,.83,(0,g.createColorFormatFromRGB)(t,p.SolidColorType.RGB,y(13950719))),o=b(t,1,(0,g.createColorFormatFromRGB)(t,p.SolidColorType.RGB,y(9874324))),m.push(e),m.push(i),m.push(r),m.push(o);break;case p.PresetGradientType.GradientMoss:e=b(t,0,(0,g.createColorFormatFromRGB)(t,p.SolidColorType.RGB,y(14543823))),i=b(t,.25,(0,g.createColorFormatFromRGB)(t,p.SolidColorType.RGB,y(10270830))),r=b(t,.5,(0,g.createColorFormatFromRGB)(t,p.SolidColorType.RGB,y(1403667))),o=b(t,1,(0,g.createColorFormatFromRGB)(t,p.SolidColorType.RGB,y(14543823))),a=b(t,.75,(0,g.createColorFormatFromRGB)(t,p.SolidColorType.RGB,y(10270830))),m.push(e),m.push(i),m.push(r),m.push(o),m.push(a);break;case p.PresetGradientType.GradientPeacock:e=b(t,0,(0,g.createColorFormatFromRGB)(t,p.SolidColorType.RGB,y(3381759))),i=b(t,.16,(0,g.createColorFormatFromRGB)(t,p.SolidColorType.RGB,y(52428))),r=b(t,.47,(0,g.createColorFormatFromRGB)(t,p.SolidColorType.RGB,y(10066431))),o=b(t,.60001,(0,g.createColorFormatFromRGB)(t,p.SolidColorType.RGB,y(3041170))),a=b(t,.71001,(0,g.createColorFormatFromRGB)(t,p.SolidColorType.RGB,y(3355596))),u=b(t,.81,(0,g.createColorFormatFromRGB)(t,p.SolidColorType.RGB,y(1143039))),s=b(t,1,(0,g.createColorFormatFromRGB)(t,p.SolidColorType.RGB,y(26265))),m.push(e),m.push(i),m.push(r),m.push(o),m.push(a),m.push(u),m.push(s);break;case p.PresetGradientType.GradientWheat:e=b(t,0,(0,g.createColorFormatFromRGB)(t,p.SolidColorType.RGB,y(16509639))),i=b(t,.17999,(0,g.createColorFormatFromRGB)(t,p.SolidColorType.RGB,y(16705522))),r=b(t,.36,(0,g.createColorFormatFromRGB)(t,p.SolidColorType.RGB,y(16435069))),o=b(t,.61,(0,g.createColorFormatFromRGB)(t,p.SolidColorType.RGB,y(16492925))),a=b(t,.82001,(0,g.createColorFormatFromRGB)(t,p.SolidColorType.RGB,y(16503964))),u=b(t,1,(0,g.createColorFormatFromRGB)(t,p.SolidColorType.RGB,y(16705522))),m.push(e),m.push(i),m.push(r),m.push(o),m.push(a),m.push(u);break;case p.PresetGradientType.GradientParchment:e=b(t,0,(0,g.createColorFormatFromRGB)(t,p.SolidColorType.RGB,y(16773073))),i=b(t,.64999,(0,g.createColorFormatFromRGB)(t,p.SolidColorType.RGB,y(15789013))),r=b(t,1,(0,g.createColorFormatFromRGB)(t,p.SolidColorType.RGB,y(13747103))),m.push(e),m.push(i),m.push(r);break;case p.PresetGradientType.GradientMahogany:e=b(t,0,(0,g.createColorFormatFromRGB)(t,p.SolidColorType.RGB,y(14070172))),i=b(t,.15,(0,g.createColorFormatFromRGB)(t,p.SolidColorType.RGB,y(13934188))),r=b(t,.35,(0,g.createColorFormatFromRGB)(t,p.SolidColorType.RGB,y(10900776))),o=b(t,.5,(0,g.createColorFormatFromRGB)(t,p.SolidColorType.RGB,y(6696978))),a=b(t,1,(0,g.createColorFormatFromRGB)(t,p.SolidColorType.RGB,y(14070172))),u=b(t,.85,(0,g.createColorFormatFromRGB)(t,p.SolidColorType.RGB,y(13934188))),s=b(t,.65,(0,g.createColorFormatFromRGB)(t,p.SolidColorType.RGB,y(10900776))),m.push(e),m.push(i),m.push(r),m.push(o),m.push(a),m.push(u),m.push(s);break;case p.PresetGradientType.GradientRainbow:e=b(t,.5,(0,g.createColorFormatFromRGB)(t,p.SolidColorType.RGB,y(10879915))),i=b(t,.395,(0,g.createColorFormatFromRGB)(t,p.SolidColorType.RGB,y(530939))),r=b(t,.32499,(0,g.createColorFormatFromRGB)(t,p.SolidColorType.RGB,y(1740104))),o=b(t,.24,(0,g.createColorFormatFromRGB)(t,p.SolidColorType.RGB,y(16776960))),a=b(t,.135,(0,g.createColorFormatFromRGB)(t,p.SolidColorType.RGB,y(15613719))),u=b(t,.6,(0,g.createColorFormatFromRGB)(t,p.SolidColorType.RGB,y(15210342))),s=b(t,0,(0,g.createColorFormatFromRGB)(t,p.SolidColorType.RGB,y(10879915))),c=b(t,.60501,(0,g.createColorFormatFromRGB)(t,p.SolidColorType.RGB,y(530939))),f=b(t,.67501,(0,g.createColorFormatFromRGB)(t,p.SolidColorType.RGB,y(1740104))),l=b(t,.76,(0,g.createColorFormatFromRGB)(t,p.SolidColorType.RGB,y(16776960))),h=b(t,.865,(0,g.createColorFormatFromRGB)(t,p.SolidColorType.RGB,y(15613719))),d=b(t,.94,(0,g.createColorFormatFromRGB)(t,p.SolidColorType.RGB,y(15210342))),v=b(t,1,(0,g.createColorFormatFromRGB)(t,p.SolidColorType.RGB,y(10879915))),m.push(e),m.push(i),m.push(r),m.push(o),m.push(a),m.push(u),m.push(s),m.push(c),m.push(f),m.push(l),m.push(h),m.push(d),m.push(v);break;case p.PresetGradientType.GradientRainbowII:e=b(t,0,(0,g.createColorFormatFromRGB)(t,p.SolidColorType.RGB,y(16724889))),i=b(t,.25,(0,g.createColorFormatFromRGB)(t,p.SolidColorType.RGB,y(16737843))),r=b(t,.5,(0,g.createColorFormatFromRGB)(t,p.SolidColorType.RGB,y(16776960))),o=b(t,.75,(0,g.createColorFormatFromRGB)(t,p.SolidColorType.RGB,y(108431))),a=b(t,1,(0,g.createColorFormatFromRGB)(t,p.SolidColorType.RGB,y(3368703))),m.push(e),m.push(i),m.push(r),m.push(o),m.push(a);break;case p.PresetGradientType.GradientGold:e=b(t,0,(0,g.createColorFormatFromRGB)(t,p.SolidColorType.RGB,y(15129772))),i=b(t,.12,(0,g.createColorFormatFromRGB)(t,p.SolidColorType.RGB,y(15128458))),r=b(t,.3,(0,g.createColorFormatFromRGB)(t,p.SolidColorType.RGB,y(13085772))),o=b(t,.45,(0,g.createColorFormatFromRGB)(t,p.SolidColorType.RGB,y(15128458))),a=b(t,.77,(0,g.createColorFormatFromRGB)(t,p.SolidColorType.RGB,y(13085772))),u=b(t,1,(0,g.createColorFormatFromRGB)(t,p.SolidColorType.RGB,y(15129772))),m.push(e),m.push(i),m.push(r),m.push(o),m.push(a),m.push(u);break;case p.PresetGradientType.GradientGoldII:e=b(t,0,(0,g.createColorFormatFromRGB)(t,p.SolidColorType.RGB,y(16508078))),i=b(t,.13,(0,g.createColorFormatFromRGB)(t,p.SolidColorType.RGB,y(12423722))),r=b(t,.21001,(0,g.createColorFormatFromRGB)(t,p.SolidColorType.RGB,y(12423722))),o=b(t,.63,(0,g.createColorFormatFromRGB)(t,p.SolidColorType.RGB,y(16508078))),a=b(t,.67,(0,g.createColorFormatFromRGB)(t,p.SolidColorType.RGB,y(12423722))),u=b(t,.69,(0,g.createColorFormatFromRGB)(t,p.SolidColorType.RGB,y(8609303))),s=b(t,.82001,(0,g.createColorFormatFromRGB)(t,p.SolidColorType.RGB,y(10651977))),c=b(t,1,(0,g.createColorFormatFromRGB)(t,p.SolidColorType.RGB,y(16442295))),m.push(e),m.push(i),m.push(r),m.push(o),m.push(a),m.push(u),m.push(s),m.push(c);break;case p.PresetGradientType.GradientBrass:e=b(t,1,(0,g.createColorFormatFromRGB)(t,p.SolidColorType.RGB,y(8541696))),i=b(t,.87,(0,g.createColorFormatFromRGB)(t,p.SolidColorType.RGB,y(16754688))),r=b(t,.72,(0,g.createColorFormatFromRGB)(t,p.SolidColorType.RGB,y(8541696))),o=b(t,.57001,(0,g.createColorFormatFromRGB)(t,p.SolidColorType.RGB,y(16754688))),a=b(t,.42,(0,g.createColorFormatFromRGB)(t,p.SolidColorType.RGB,y(8541696))),u=b(t,.28,(0,g.createColorFormatFromRGB)(t,p.SolidColorType.RGB,y(16754688))),s=b(t,.13,(0,g.createColorFormatFromRGB)(t,p.SolidColorType.RGB,y(8541696))),c=b(t,0,(0,g.createColorFormatFromRGB)(t,p.SolidColorType.RGB,y(16754688))),m.push(e),m.push(i),m.push(r),m.push(o),m.push(a),m.push(u),m.push(s),m.push(c);break;case p.PresetGradientType.GradientChrome:e=b(t,0,(0,g.createColorFormatFromRGB)(t,p.SolidColorType.RGB,y(16777215))),i=b(t,.16,(0,g.createColorFormatFromRGB)(t,p.SolidColorType.RGB,y(2039583))),r=b(t,.17999,(0,g.createColorFormatFromRGB)(t,p.SolidColorType.RGB,y(16777215))),o=b(t,.42,(0,g.createColorFormatFromRGB)(t,p.SolidColorType.RGB,y(6513507))),a=b(t,.53,(0,g.createColorFormatFromRGB)(t,p.SolidColorType.RGB,y(13619151))),u=b(t,.66,(0,g.createColorFormatFromRGB)(t,p.SolidColorType.RGB,y(13619151))),s=b(t,.75999,(0,g.createColorFormatFromRGB)(t,p.SolidColorType.RGB,y(2039583))),c=b(t,.78999,(0,g.createColorFormatFromRGB)(t,p.SolidColorType.RGB,y(16777215))),f=b(t,1,(0,g.createColorFormatFromRGB)(t,p.SolidColorType.RGB,y(8355711))),m.push(e),m.push(i),m.push(r),m.push(o),m.push(a),m.push(u),m.push(s),m.push(c),m.push(f);break;case p.PresetGradientType.GradientChromeII:e=b(t,0,(0,g.createColorFormatFromRGB)(t,p.SolidColorType.RGB,y(13355979))),i=b(t,.13,(0,g.createColorFormatFromRGB)(t,p.SolidColorType.RGB,y(6250335))),r=b(t,.21001,(0,g.createColorFormatFromRGB)(t,p.SolidColorType.RGB,y(6250335))),o=b(t,.63,(0,g.createColorFormatFromRGB)(t,p.SolidColorType.RGB,y(16777215))),a=b(t,.67,(0,g.createColorFormatFromRGB)(t,p.SolidColorType.RGB,y(11711154))),u=b(t,.69,(0,g.createColorFormatFromRGB)(t,p.SolidColorType.RGB,y(2697513))),s=b(t,.82001,(0,g.createColorFormatFromRGB)(t,p.SolidColorType.RGB,y(7829367))),c=b(t,1,(0,g.createColorFormatFromRGB)(t,p.SolidColorType.RGB,y(15395562))),m.push(e),m.push(i),m.push(r),m.push(o),m.push(a),m.push(u),m.push(s),m.push(c);break;case p.PresetGradientType.GradientSilver:e=b(t,0,(0,g.createColorFormatFromRGB)(t,p.SolidColorType.RGB,y(16777215))),i=b(t,.03501,(0,g.createColorFormatFromRGB)(t,p.SolidColorType.RGB,y(15132390))),r=b(t,.16,(0,g.createColorFormatFromRGB)(t,p.SolidColorType.RGB,y(8225942))),o=b(t,.235,(0,g.createColorFormatFromRGB)(t,p.SolidColorType.RGB,y(15132390))),a=b(t,.42501,(0,g.createColorFormatFromRGB)(t,p.SolidColorType.RGB,y(8225942))),u=b(t,.5,(0,g.createColorFormatFromRGB)(t,p.SolidColorType.RGB,y(15132390))),s=b(t,1,(0,g.createColorFormatFromRGB)(t,p.SolidColorType.RGB,y(15132390))),c=b(t,.965,(0,g.createColorFormatFromRGB)(t,p.SolidColorType.RGB,y(15132390))),f=b(t,.84,(0,g.createColorFormatFromRGB)(t,p.SolidColorType.RGB,y(8225942))),l=b(t,.765,(0,g.createColorFormatFromRGB)(t,p.SolidColorType.RGB,y(15132390))),h=b(t,.575,(0,g.createColorFormatFromRGB)(t,p.SolidColorType.RGB,y(8225942))),m.push(e),m.push(i),m.push(r),m.push(o),m.push(a),m.push(u),m.push(s),m.push(c),m.push(f),m.push(l),m.push(h);break;case p.PresetGradientType.GradientSapphire:e=b(t,0,(0,g.createColorFormatFromRGB)(t,p.SolidColorType.RGB,y(130))),i=b(t,.13,(0,g.createColorFormatFromRGB)(t,p.SolidColorType.RGB,y(18431))),r=b(t,.28,(0,g.createColorFormatFromRGB)(t,p.SolidColorType.RGB,y(130))),o=b(t,.42999,(0,g.createColorFormatFromRGB)(t,p.SolidColorType.RGB,y(18431))),a=b(t,.58,(0,g.createColorFormatFromRGB)(t,p.SolidColorType.RGB,y(130))),u=b(t,.72,(0,g.createColorFormatFromRGB)(t,p.SolidColorType.RGB,y(18431))),s=b(t,.87,(0,g.createColorFormatFromRGB)(t,p.SolidColorType.RGB,y(130))),c=b(t,1,(0,g.createColorFormatFromRGB)(t,p.SolidColorType.RGB,y(18431))),m.push(e),m.push(i),m.push(r),m.push(o),m.push(a),m.push(u),m.push(s),m.push(c)}},e.InitGradientStopTwoColor=function(t,n){var e,e,n,e=n.GradientStyle;e===p.GradientStyle.GradientFromCenter?this.InitGradientTwoColorCenterStops(t,n):e===p.GradientStyle.GradientFromCorner?this.InitGradientTwoColorCornerStops(t,n):(e=n.GradientStops.GradientStopList,1===(n=n.GradientVariant)||2===n?(e.push(b(t,0,(0,g.createColorFormat)(t,p.SolidColorType.Theme,p.ColorSchemeIndex.Accent1))),e.push(b(t,1,(0,g.createColorFormatFromRGB)(t,p.SolidColorType.RGB,y(16777215))))):3===n?(e.push(b(t,0,(0,g.createColorFormat)(t,p.SolidColorType.Theme,p.ColorSchemeIndex.Accent1))),e.push(b(t,.5,(0,g.createColorFormatFromRGB)(t,p.SolidColorType.RGB,y(16777215)))),e.push(b(t,1,(0,g.createColorFormat)(t,p.SolidColorType.Theme,p.ColorSchemeIndex.Accent1)))):4===n&&(e.push(b(t,.5,(0,g.createColorFormat)(t,p.SolidColorType.Theme,p.ColorSchemeIndex.Accent1))),e.push(b(t,0,(0,g.createColorFormatFromRGB)(t,p.SolidColorType.RGB,y(16777215)))),e.push(b(t,1,(0,g.createColorFormatFromRGB)(t,p.SolidColorType.RGB,y(16777215))))))},e.InitGradientTwoColorCornerStops=function(t,n){var n=n.GradientStops.GradientStopList;n.push(b(t,0,(0,g.createColorFormat)(t,p.SolidColorType.Theme,p.ColorSchemeIndex.Accent1))),n.push(b(t,1,(0,g.createColorFormatFromRGB)(t,p.SolidColorType.RGB,y(16777215))))},e.InitGradientTwoColorCenterStops=function(t,n){var e,n,e=n.GradientStops.GradientStopList,n=n.GradientVariant;1===n?(e.push(b(t,0,(0,g.createColorFormat)(t,p.SolidColorType.Theme,p.ColorSchemeIndex.Accent1))),e.push(b(t,1,(0,g.createColorFormatFromRGB)(t,p.SolidColorType.RGB,y(16777215))))):2===n?(e.push(b(t,0,(0,g.createColorFormatFromRGB)(t,p.SolidColorType.RGB,y(16777215)))),e.push(b(t,1,(0,g.createColorFormat)(t,p.SolidColorType.Theme,p.ColorSchemeIndex.Accent1)))):3===n?(e.push(b(t,0,(0,g.createColorFormat)(t,p.SolidColorType.Theme,p.ColorSchemeIndex.Accent1))),e.push(b(t,.5,(0,g.createColorFormatFromRGB)(t,p.SolidColorType.RGB,y(16777215)))),e.push(b(t,1,(0,g.createColorFormat)(t,p.SolidColorType.Theme,p.ColorSchemeIndex.Accent1)))):4===n&&(e.push(b(t,0,(0,g.createColorFormatFromRGB)(t,p.SolidColorType.RGB,y(16777215)))),e.push(b(t,.5,(0,g.createColorFormat)(t,p.SolidColorType.Theme,p.ColorSchemeIndex.Accent1))),e.push(b(t,1,(0,g.createColorFormatFromRGB)(t,p.SolidColorType.RGB,y(16777215)))))},e.InitGradientOneColorCornerStops=function(t,n){var e,n,e=(0,g.createColorFormat)(t,p.SolidColorType.Theme,p.ColorSchemeIndex.Accent1,this.GetTintAndShadeByDegree(n.GradientDegree)),n=n.GradientStops.GradientStopList;n.push(b(t,0,(0,g.createColorFormat)(t,p.SolidColorType.Theme,p.ColorSchemeIndex.Accent1))),n.push(b(t,1,e))},e.InitGradientOneColorCenterStops=function(t,n){var e,i,n,e=(0,g.createColorFormat)(t,p.SolidColorType.Theme,p.ColorSchemeIndex.Accent1,this.GetTintAndShadeByDegree(n.GradientDegree)),i=n.GradientStops.GradientStopList,n=n.GradientVariant;1===n?(i.push(b(t,0,(0,g.createColorFormat)(t,p.SolidColorType.Theme,p.ColorSchemeIndex.Accent1))),i.push(b(t,1,e))):2===n?(i.push(b(t,0,e)),i.push(b(t,1,(0,g.createColorFormat)(t,p.SolidColorType.Theme,p.ColorSchemeIndex.Accent1)))):3===n?(i.push(b(t,0,(0,g.createColorFormat)(t,p.SolidColorType.Theme,p.ColorSchemeIndex.Accent1))),i.push(b(t,.5,e)),i.push(b(t,1,(0,g.createColorFormat)(t,p.SolidColorType.Theme,p.ColorSchemeIndex.Accent1)))):4===n&&(i.push(b(t,0,e)),i.push(b(t,.5,(0,g.createColorFormat)(t,p.SolidColorType.Theme,p.ColorSchemeIndex.Accent1))),i.push(b(t,1,e)))},e.InitGradientStopOneColor=function(t,n){var e,e,i,n,e=n.GradientStyle;e===p.GradientStyle.GradientFromCenter?this.InitGradientOneColorCenterStops(t,n):e===p.GradientStyle.GradientFromCorner?this.InitGradientOneColorCornerStops(t,n):(e=this.GetTintAndShadeByDegree(n.GradientDegree),i=n.GradientStops.GradientStopList,1===(n=n.GradientVariant)||2===n?(i.push(b(t,0,(0,g.createColorFormat)(t,p.SolidColorType.Theme,p.ColorSchemeIndex.Accent1))),i.push(b(t,1,(0,g.createColorFormat)(t,p.SolidColorType.Theme,p.ColorSchemeIndex.Accent1,e)))):3===n?(i.push(b(t,0,(0,g.createColorFormat)(t,p.SolidColorType.Theme,p.ColorSchemeIndex.Accent1))),i.push(b(t,.5,(0,g.createColorFormat)(t,p.SolidColorType.Theme,p.ColorSchemeIndex.Accent1,e))),i.push(b(t,1,(0,g.createColorFormat)(t,p.SolidColorType.Theme,p.ColorSchemeIndex.Accent1)))):4===n&&(i.push(b(t,.5,(0,g.createColorFormat)(t,p.SolidColorType.Theme,p.ColorSchemeIndex.Accent1))),i.push(b(t,0,(0,g.createColorFormat)(t,p.SolidColorType.Theme,p.ColorSchemeIndex.Accent1))),i.push(b(t,1,(0,g.createColorFormat)(t,p.SolidColorType.Theme,p.ColorSchemeIndex.Accent1,e)))))},e.InitGradientStops=function(t,n,e){var i=this;if(n.n0t(new f(t)),e===p.GradientColorType.GradientOneColor)i.InitGradientStopOneColor(t,n);else if(e===p.GradientColorType.GradientTwoColors)i.InitGradientStopTwoColor(t,n);else{if(e!==p.GradientColorType.GradientPresetColors)throw new Error;i.InitGradientStopPresetColor(t,n)}n.GradientAngle=i.GetGradientAngle(n.GradientStyle,n.GradientVariant)}},"./dist/plugins/floatingObject/drawing/lineFormat.js":function(t,n,e){"use strict";var i,a,r,o,u,s,c,f,l,h,d,v,m;function g(t,n,e){return n<=t&&t<=e}function p(t,n,e){var i,r,i=m.call(this,n)||this,r=i;return r.u1t=s.ArrowheadLength.medium,r.s1t=s.ArrowheadStyle.none,r.c1t=s.ArrowheadWidth.medium,r.f1t=s.LineDashStyle.solid,r.l1t=s.ArrowheadLength.medium,r.h1t=s.ArrowheadStyle.none,r.d1t=s.ArrowheadWidth.medium,r.RN=s.LineStyle.LineSingle,r.jft=!0,r.v1t=-1,r.m1t=h,r.g1t=h,r.DJ=t,r.sft=n,r.Pft=e,r.p1t=s.LineCapStyle.flat,r.b1t=s.LineJoinStyle.round,r.S0t=new u.FillFormat(t,n&&n.FillInternal,e),i}i=this&&this.__extends||(v=function(t,n){return(v=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(t,n){t.__proto__=n}:function(t,n){for(var e in n)Object.prototype.hasOwnProperty.call(n,e)&&(t[e]=n[e])}))(t,n)},function(t,n){if("function"!=typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function e(){this.constructor=t}v(t,n),t.prototype=null===n?Object.create(n):(e.prototype=n.prototype,new e)}),Object.defineProperty(n,"__esModule",{value:!0}),n.LineFormat=void 0,a=e("Core"),r=e("./dist/plugins/floatingObject/drawing/stateful.js"),o=e("./dist/plugins/floatingObject/drawing/common.js"),u=e("./dist/plugins/floatingObject/drawing/fillFormat.js"),s=e("./dist/plugins/floatingObject/drawing/drawingInterface.js"),c=a.NodeHelper.sr,f=o.ChartUtility.Aft,l=o.UnitHelper.isNullOrUndefined,h=null,m=r.StatefulBase,i(p,m),Object.defineProperty(p.prototype,"PatternColor",{get:function(){return this.FillInternal.PatternColorInternal},enumerable:!1,configurable:!0}),Object.defineProperty(p.prototype,"Color",{get:function(){return this.FillInternal.ColorInternal},enumerable:!1,configurable:!0}),Object.defineProperty(p.prototype,"BeginArrowheadLength",{get:function(){return this.IsDirty(s.LineFormatStates.BeginArrowheadLength)||l(this.sft)?this.u1t:this.sft.BeginArrowheadLength},set:function(t){this.u1t=t,this.Dirty(s.LineFormatStates.BeginArrowheadLength)},enumerable:!1,configurable:!0}),Object.defineProperty(p.prototype,"BeginArrowheadStyle",{get:function(){return this.IsDirty(s.LineFormatStates.BeginArrowheadStyle)||l(this.sft)?this.s1t:this.sft.BeginArrowheadStyle},set:function(t){this.s1t=t,this.Dirty(s.LineFormatStates.BeginArrowheadStyle)},enumerable:!1,configurable:!0}),Object.defineProperty(p.prototype,"BeginArrowheadWidth",{get:function(){return this.IsDirty(s.LineFormatStates.BeginArrowheadWidth)||l(this.sft)?this.c1t:this.sft.BeginArrowheadWidth},set:function(t){this.c1t=t,this.Dirty(s.LineFormatStates.BeginArrowheadWidth)},enumerable:!1,configurable:!0}),Object.defineProperty(p.prototype,"DashStyle",{get:function(){return this.IsDirty(s.LineFormatStates.DashStyle)||l(this.sft)?this.f1t:this.sft.DashStyle},set:function(t){g(t,0,11)&&(this.f1t=t,this.Dirty(s.LineFormatStates.DashStyle))},enumerable:!1,configurable:!0}),Object.defineProperty(p.prototype,"CapStyle",{get:function(){return this.IsDirty(s.LineFormatStates.CapStyle)||l(this.sft)?this.p1t:this.sft.CapStyle},set:function(t){g(t,0,2)&&(this.p1t=t,this.Dirty(s.LineFormatStates.CapStyle))},enumerable:!1,configurable:!0}),Object.defineProperty(p.prototype,"JoinStyle",{get:function(){return this.IsDirty(s.LineFormatStates.JoinStyle)||l(this.sft)?this.b1t:this.sft.JoinStyle},set:function(t){g(t,0,2)&&(this.b1t=t,this.Dirty(s.LineFormatStates.JoinStyle))},enumerable:!1,configurable:!0}),Object.defineProperty(p.prototype,"EndArrowheadLength",{get:function(){return this.IsDirty(s.LineFormatStates.EndArrowheadLength)||l(this.sft)?this.l1t:this.sft.EndArrowheadLength},set:function(t){this.l1t=t,this.Dirty(s.LineFormatStates.EndArrowheadLength)},enumerable:!1,configurable:!0}),Object.defineProperty(p.prototype,"EndArrowheadStyle",{get:function(){return this.IsDirty(s.LineFormatStates.EndArrowheadStyle)||l(this.sft)?this.h1t:this.sft.EndArrowheadStyle},set:function(t){this.h1t=t,this.Dirty(s.LineFormatStates.EndArrowheadStyle)},enumerable:!1,configurable:!0}),Object.defineProperty(p.prototype,"EndArrowheadWidth",{get:function(){return this.IsDirty(s.LineFormatStates.EndArrowheadWidth)||l(this.sft)?this.d1t:this.sft.EndArrowheadWidth},set:function(t){this.d1t=t,this.Dirty(s.LineFormatStates.EndArrowheadWidth)},enumerable:!1,configurable:!0}),Object.defineProperty(p.prototype,"InsetPen",{get:function(){return this.IsDirty(s.LineFormatStates.InsetPen)||l(this.sft)?this.y1t:this.sft.InsetPen},set:function(t){this.y1t=t,this.Dirty(s.LineFormatStates.InsetPen)},enumerable:!1,configurable:!0}),Object.defineProperty(p.prototype,"Pattern",{get:function(){return this.FillInternal.Pattern},set:function(t){this.FillInternal.r0t(t)},enumerable:!1,configurable:!0}),Object.defineProperty(p.prototype,"PresetGradientType",{get:function(){return this.FillInternal.PresetGradientType},enumerable:!1,configurable:!0}),p.prototype.a0t=function(t){this.FillInternal.a0t(t)},Object.defineProperty(p.prototype,"GradientAngle",{get:function(){return this.FillInternal.GradientAngle},set:function(t){this.FillInternal.GradientAngle=t},enumerable:!1,configurable:!0}),Object.defineProperty(p.prototype,"GradientColorType",{get:function(){return this.FillInternal.GradientColorType},enumerable:!1,configurable:!0}),Object.defineProperty(p.prototype,"GradientDegree",{get:function(){return this.FillInternal.GradientDegree},enumerable:!1,configurable:!0}),p.prototype.t0t=function(t){this.FillInternal.t0t(t)},Object.defineProperty(p.prototype,"GradientStops",{get:function(){return this.FillInternal.GradientStops},enumerable:!1,configurable:!0}),Object.defineProperty(p.prototype,"GradientStyle",{get:function(){return this.FillInternal.GradientStyle},enumerable:!1,configurable:!0}),p.prototype.e0t=function(t){this.FillInternal.e0t(t)},Object.defineProperty(p.prototype,"GradientVariant",{get:function(){return this.FillInternal.GradientVariant},enumerable:!1,configurable:!0}),p.prototype.i0t=function(t){this.FillInternal.i0t(t)},Object.defineProperty(p.prototype,"Style",{get:function(){return this.IsDirty(s.LineFormatStates.Style)||l(this.sft)?this.RN:this.sft.Style},set:function(t){g(t,0,4)&&(this.RN=t,this.Dirty(s.LineFormatStates.Style))},enumerable:!1,configurable:!0}),Object.defineProperty(p.prototype,"Transparency",{get:function(){return this.FillInternal.Transparency},set:function(t){this.FillInternal.Transparency=t},enumerable:!1,configurable:!0}),Object.defineProperty(p.prototype,"Visible",{get:function(){return this.IsDirty(s.LineFormatStates.Visible)||l(this.sft)?this.jft:this.sft.Visible},set:function(t){this.jft=t,this.Dirty(s.LineFormatStates.Visible)},enumerable:!1,configurable:!0}),Object.defineProperty(p.prototype,"Weight",{get:function(){return this.IsDirty(s.LineFormatStates.Weight)||l(this.sft)?this.v1t:this.sft.Weight},set:function(t){this.v1t=t,this.Dirty(s.LineFormatStates.Weight)},enumerable:!1,configurable:!0}),p.prototype.OneColorGradient=function(t,n,e){this.FillInternal.OneColorGradient(t,n,e)},p.prototype.TwoColorGradient=function(t,n){this.FillInternal.TwoColorGradient(t,n)},p.prototype.PresetGradient=function(t,n,e){this.FillInternal.PresetGradient(t,n,e)},p.prototype.Solid=function(){this.FillInternal.Solid()},p.prototype.Patterned=function(t){this.FillInternal.Patterned(t)},Object.defineProperty(p.prototype,"FillInternal",{get:function(){var t=this;return t.S0t||(t.S0t=new u.FillFormat(t.DJ,t.sft&&t.sft.FillInternal,t.Pft)),t.S0t},enumerable:!1,configurable:!0}),Object.defineProperty(p.prototype,"Type",{get:function(){return this.FillInternal.Type},enumerable:!1,configurable:!0}),p.prototype.GetState=function(t,n){var e=this.S0t;if(e){if(t===s.LineFormatStates.Color&&e.Color)return e.Color.IsDirtyIncludingParent(n);if(t===s.LineFormatStates.PatternColor&&e.PatternColor)return e.PatternColor.IsDirtyIncludingParent(n)}return m.prototype.GetState.call(this,t,n)},p.prototype.IsDirtyIncludingParent=function(t){var n=this.S0t;return!(!n||!n.IsDirtyIncludingParent(t))||m.prototype.IsDirtyIncludingParent.call(this,t)},p.prototype.OnParentChanged=function(t){this.sft=t;var n=this.S0t;n&&t&&(n.ParentStateful=t.FillInternal)},p.prototype.FromOOModel=function(t){this.m1t=t,this.FromCT_LineProperties(t)},p.prototype.FromSJSOOModel=function(t){this.g1t=t,this.FromSJSCT_LineProperties(t)},p.prototype.ToOOModel=function(){return this.ToCT_LineProperties()},p.prototype.ToSJSOOModel=function(){return this.ToSJSCT_LineProperties()},p.prototype.FromCT_LineProperties=function(t){var n=this;l(t.solidFill)?l(t.pattFill)?l(t.gradFill)?l(t.noFill)||(n.FillInternal.ColorInternal.ColorType=s.SolidColorType.None):n.FillInternal.FromOOModel(t.gradFill,s.ColorFillType.GradientFillProperties):n.FillInternal.FromOOModel(t.pattFill,s.ColorFillType.PatternFillProperties):n.FillInternal.FromOOModel(t.solidFill,s.ColorFillType.SolidColorFillProperties),l(t.headEnd)||n.FromCT_LineEndProperties(t.headEnd),l(t.tailEnd)||n.FromCT_TailLineEndProperties(t.tailEnd),!l(t.w)&&0<=t.w?n.Weight=t.w:l(t.solidFill)&&l(t.gradFill)?(n.v1t=-1,n.UnDirty(s.LineFormatStates.Weight)):n.Weight=1,l(t.cmpd)||(n.Style=t.cmpd),n.Round=!!t.round,l(t.prstDash)?n.UnDirty(s.LineFormatStates.DashStyle):n.DashStyle=t.prstDash,l(t.cap)||(n.CapStyle=t.cap),t.bevel?n.JoinStyle=s.LineJoinStyle.bevel:t.round?n.JoinStyle=s.LineJoinStyle.round:t.miter&&(n.JoinStyle=s.LineJoinStyle.miter)},p.prototype.FromSJSCT_LineProperties=function(t){var n,e,i,r,i,o,i,n=this,e=t.solidFill,i=t.pattFill,r=t.gradFill;l(e)?l(i)?l(r)?l(t.noFill)||(n.FillInternal.ColorInternal.ColorType=s.SolidColorType.None):n.FillInternal.FromSJSOOModel(r,s.ColorFillType.GradientFillProperties):n.FillInternal.FromSJSOOModel(i,s.ColorFillType.PatternFillProperties):n.FillInternal.FromSJSOOModel(e,s.ColorFillType.SolidColorFillProperties),i=t.headEnd,o=t.tailEnd,l(i)||n.FromSJSCT_LineEndProperties(i),l(o)||n.FromSJSCT_TailLineEndProperties(o),l(t.w)?l(e)&&l(r)?(n.v1t=-1,n.UnDirty(s.LineFormatStates.Weight)):n.Weight=1:n.Weight=a.ExcelHelper.emuToPixles(c(t.w)),0===n.Weight&&l(t.noFill)&&(n.Weight=1),l(t.cmpd)||(n.Style=s.ST_CompoundLine[t.cmpd]),n.Round=!0,i=t.prstDash,l(i)?n.UnDirty(s.LineFormatStates.DashStyle):n.DashStyle=s.LineType[i.val],l(t.cap)||(n.CapStyle=s.ST_LineCap[t.cap]),t.bevel?n.JoinStyle=s.LineJoinStyle.bevel:t.round?n.JoinStyle=s.LineJoinStyle.round:t.miter&&(n.JoinStyle=s.LineJoinStyle.miter)},p.prototype.ToCT_LineProperties=function(){var t,n,e,i,i,i,t=this,n=t.m1t;return t.IsDirtyIncludingParent()||l(n)?(f(e=n||{}),t.jft?l(t.S0t)||((i=t.S0t.ToOOModel()).colorFillType===s.ColorFillType.SolidColorFillProperties?e.solidFill=i:i.colorFillType===s.ColorFillType.PatternFillProperties?e.pattFill=i:i.colorFillType===s.ColorFillType.GradientFillProperties?e.gradFill=i:i.colorFillType===s.ColorFillType.NoFillProperties&&(e.noFill=!0),delete i.colorFillType):e.noFill=!0,(i=t.ToCT_HeadLineEndProperties())&&(e.headEnd=i),(i=t.ToCT_TailLineEndProperties())&&(e.tailEnd=i),0<=t.Weight&&(e.w=t.Weight),t.GetState(s.LineFormatStates.Style,!0)&&(e.cmpd=t.Style),t.GetState(s.LineFormatStates.DashStyle,!0)&&(e.prstDash=t.DashStyle),t.Round&&(e.round=!0),t.GetState(s.LineFormatStates.CapStyle,!0)&&(e.cap=t.CapStyle),delete e.bevel,delete e.round,delete e.miter,t.GetState(s.LineFormatStates.JoinStyle,!0)&&((i=t.JoinStyle)===s.LineJoinStyle.bevel?e.bevel={}:i===s.LineJoinStyle.round?e.round=!0:i===s.LineJoinStyle.miter&&(e.miter={lim:8e5})),e):n},p.prototype.ToSJSCT_LineProperties=function(){var t,n,e,i,i,i,t=this,n=t.g1t;return t.IsDirtyIncludingParent()||l(n)?(e={},0<=t.Weight&&(e.w=a.ExcelHelper.pixelToEMU(t.Weight)),t.GetState(s.LineFormatStates.Style,!0)&&(e.cmpd=s.ST_CompoundLine[t.Style]),t.GetState(s.LineFormatStates.CapStyle,!0)&&(e.cap=s.ST_LineCap[t.CapStyle]),l(n&&n.algn)||(e.algn=n.algn),f(e),!t.jft||e.w<=0?e.noFill={}:l(t.S0t)||((i=t.S0t.ToSJSOOModel()).colorFillType===s.ColorFillType.SolidColorFillProperties?e.solidFill=i:i.colorFillType===s.ColorFillType.PatternFillProperties?e.pattFill=i:i.colorFillType===s.ColorFillType.GradientFillProperties?e.gradFill=i:i.colorFillType===s.ColorFillType.NoFillProperties&&(e.noFill={}),delete i.colorFillType),t.GetState(s.LineFormatStates.DashStyle,!0)&&(e.prstDash={val:s.ST_PresetLineDashVal[11===t.DashStyle?1:t.DashStyle]}),t.GetState(s.LineFormatStates.JoinStyle,!0)&&((i=t.JoinStyle)===s.LineJoinStyle.bevel?e.bevel={}:i===s.LineJoinStyle.round?e.round={}:i===s.LineJoinStyle.miter&&(e.miter={lim:8e5})),(i=t.ToSJSCT_HeadLineEndProperties())&&(e.headEnd=i),(i=t.ToSJSCT_TailLineEndProperties())&&(e.tailEnd=i),l(n&&n.extLst)||(e.extLst=n.extLst),e):n},p.prototype.FromCT_LineEndProperties=function(t){var n=this;n.s1t=t.type,n.c1t=t.w,n.u1t=t.len,n.SetState(s.LineFormatStates.BeginArrowheadStyle,!0),n.SetState(s.LineFormatStates.BeginArrowheadWidth,!0),n.SetState(s.LineFormatStates.BeginArrowheadLength,!0)},p.prototype.FromSJSCT_LineEndProperties=function(t){var n=this;n.s1t=s.ST_LineEndType[t.type],n.c1t=t.w?s.ST_LineEndWidth[t.w]:1,n.u1t=t.len?s.ST_LineEndLength[t.len]:1,n.SetState(s.LineFormatStates.BeginArrowheadStyle,!0),n.SetState(s.LineFormatStates.BeginArrowheadWidth,!0),n.SetState(s.LineFormatStates.BeginArrowheadLength,!0)},p.prototype.ToCT_HeadLineEndProperties=function(){var t,n,e,t={w:s.ArrowheadWidth.medium,len:s.ArrowheadLength.medium},n=this,e=!1;return n.GetState(s.LineFormatStates.BeginArrowheadStyle,!0)&&(t.type=n.BeginArrowheadStyle,e=!0),n.GetState(s.LineFormatStates.BeginArrowheadWidth,!0)&&(t.w=n.BeginArrowheadWidth,e=!0),n.GetState(s.LineFormatStates.BeginArrowheadLength,!0)&&(t.len=n.BeginArrowheadLength,e=!0),e?t:h},p.prototype.ToSJSCT_HeadLineEndProperties=function(){var t,n,e,t={w:s.ST_LineEndWidth[1],len:s.ST_LineEndWidth[1]},n=this,e=!1;return n.GetState(s.LineFormatStates.BeginArrowheadStyle,!0)&&(t.type=s.ST_LineEndType[n.BeginArrowheadStyle],e=!0),n.GetState(s.LineFormatStates.BeginArrowheadWidth,!0)&&(t.w=s.ST_LineEndWidth[n.BeginArrowheadWidth],e=!0),n.GetState(s.LineFormatStates.BeginArrowheadLength,!0)&&(t.len=s.ST_LineEndWidth[n.BeginArrowheadLength],e=!0),e?t:h},p.prototype.FromCT_TailLineEndProperties=function(t){var n;l(t)||((n=this).h1t=t.type,n.d1t=t.w,n.l1t=t.len,n.SetState(s.LineFormatStates.EndArrowheadStyle,!0),n.SetState(s.LineFormatStates.EndArrowheadWidth,!0),n.SetState(s.LineFormatStates.EndArrowheadLength,!0))},p.prototype.FromSJSCT_TailLineEndProperties=function(t){var n;l(t)||((n=this).h1t=s.ST_LineEndType[t.type],n.d1t=t.w?s.ST_LineEndWidth[t.w]:1,n.l1t=t.len?s.ST_LineEndLength[t.len]:1,n.SetState(s.LineFormatStates.EndArrowheadStyle,!0),n.SetState(s.LineFormatStates.EndArrowheadWidth,!0),n.SetState(s.LineFormatStates.EndArrowheadLength,!0))},p.prototype.ToCT_TailLineEndProperties=function(){var t,n,e,t={w:s.ArrowheadWidth.medium,len:s.ArrowheadLength.medium},n=!1,e=this;return e.GetState(s.LineFormatStates.EndArrowheadStyle,!0)&&(t.type=e.EndArrowheadStyle,n=!0),e.GetState(s.LineFormatStates.EndArrowheadWidth,!0)&&(t.w=e.EndArrowheadWidth,n=!0),e.GetState(s.LineFormatStates.EndArrowheadLength,!0)&&(t.len=e.EndArrowheadLength,n=!0),n?t:h},p.prototype.ToSJSCT_TailLineEndProperties=function(){var t,n,e,t={w:s.ST_LineEndWidth[1],len:s.ST_LineEndWidth[1]},n=!1,e=this;return e.GetState(s.LineFormatStates.EndArrowheadStyle,!0)&&(t.type=s.ST_LineEndType[e.EndArrowheadStyle],n=!0),e.GetState(s.LineFormatStates.EndArrowheadWidth,!0)&&(t.w=s.ST_LineEndWidth[e.EndArrowheadWidth],n=!0),e.GetState(s.LineFormatStates.EndArrowheadLength,!0)&&(t.len=s.ST_LineEndWidth[e.EndArrowheadLength],n=!0),n?t:h},p.prototype.Clone=function(){var t,n,t=this,n=new p(t.DJ);return n.S0t=t.S0t&&t.S0t.Clone(),n.u1t=t.u1t,n.s1t=t.s1t,n.c1t=t.c1t,n.f1t=t.f1t,n.l1t=t.l1t,n.h1t=t.h1t,n.d1t=t.d1t,n.y1t=t.y1t,n.jft=t.jft,n.v1t=t.v1t,n.l0t=t.l0t,n.sft=t.sft,n},n.LineFormat=p},"./dist/plugins/floatingObject/drawing/picture.js":function(t,n,e){"use strict";var i,r,a,o,e,u,s,f,c,l,h,d,v,m,g,p,b,y,w;function M(t,n){return d(t)?n:t}function C(t){return d(t)?0:parseInt(t,10)}function S(t,n){t&&parseFloat(t)}function T(t){var n=this;n.w1t=0,n.M1t=0,n.C1t=0,n.S1t=0,n.Wc=t}function A(t,n){var e,i,e=this;return t===m&&(t=o.PictureFormatType.PictureShape),(i=e=w.call(this,n=n===m?v:n)||this).oft=a.ShapeConstants.DefaultBrightness,i.xrt=o.PictureColorType.PictureAutomatic,i.T1t=a.ShapeConstants.DefaultBrightness,i.A1t=a.ShapeConstants.DefaultTransparent,i.I1t=t,i.sft=n,i.x1t=i.I1t===o.PictureFormatType.PictureShape,i.aft=a.ShapeConstants.DefaultTransparent,i.N1t={left:0,right:0,top:0,bottom:0},i.k1t={offsetX:0,offsetY:0,scaleX:1,scaleY:1,alignment:0,mirrorType:0},i}i=this&&this.__extends||(y=function(t,n){return(y=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(t,n){t.__proto__=n}:function(t,n){for(var e in n)Object.prototype.hasOwnProperty.call(n,e)&&(t[e]=n[e])}))(t,n)},function(t,n){if("function"!=typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function e(){this.constructor=t}y(t,n),t.prototype=null===n?Object.create(n):(e.prototype=n.prototype,new e)}),Object.defineProperty(n,"__esModule",{value:!0}),n.PictureFormat=n.Crop=void 0,r=e("./dist/plugins/floatingObject/drawing/stateful.js"),a=e("./dist/plugins/floatingObject/drawing/common.js"),o=e("./dist/plugins/floatingObject/drawing/drawingInterface.js"),e=e("Core"),u=e.ExcelHelper.emuToPixles,s=e.ExcelHelper.pixelToEMU,f=a.ShapeConstants.PositionConver,c=a.ShapeConstants.PositiveFixedPercentageConvert,l=a.ShapeUtility.FromLum,h=a.ShapeUtility.ToLum,d=a.UnitHelper.isNullOrUndefined,v=null,m=void 0,g=e.NodeHelper.sr,Object.defineProperty(T.prototype,"PictureHeight",{get:function(){return this.S1t},set:function(t){this.S1t=t},enumerable:!1,configurable:!0}),Object.defineProperty(T.prototype,"PictureOffsetX",{get:function(){return this.w1t},set:function(t){this.w1t=t},enumerable:!1,configurable:!0}),Object.defineProperty(T.prototype,"PictureOffsetY",{get:function(){return this.M1t},set:function(t){this.M1t=t},enumerable:!1,configurable:!0}),Object.defineProperty(T.prototype,"PictureWidth",{get:function(){return this.C1t},set:function(t){this.C1t=t},enumerable:!1,configurable:!0}),Object.defineProperty(T.prototype,"ShapeHeight",{get:function(){return this.Wc.Height},set:function(t){this.Wc.Height=t},enumerable:!1,configurable:!0}),Object.defineProperty(T.prototype,"ShapeLeft",{get:function(){return this.Wc.Left},set:function(t){this.Wc.Left=t},enumerable:!1,configurable:!0}),Object.defineProperty(T.prototype,"ShapeTop",{get:function(){return this.Wc.Top},set:function(t){this.Wc.Top=t},enumerable:!1,configurable:!0}),Object.defineProperty(T.prototype,"ShapeWidth",{get:function(){return this.Wc.Width},set:function(t){this.Wc.Width=t},enumerable:!1,configurable:!0}),T.prototype.Clone=function(){var t,n,t=this,n=new T(t.Wc);return n.S1t=t.S1t,n.w1t=t.w1t,n.M1t=t.M1t,n.C1t=t.C1t,n},p=T,n.Crop=p,w=r.StatefulBase,i(A,w),Object.defineProperty(A.prototype,"Brightness",{get:function(){return this.IsDirty(1)||d(this.sft)?this.oft:this.sft.Brightness},set:function(t){if(t<0||1<t)throw new Error;this.oft=t,this.Dirty(1)},enumerable:!1,configurable:!0}),Object.defineProperty(A.prototype,"ColorType",{get:function(){return this.IsDirty(2)||d(this.sft)?this.xrt:this.sft.ColorType},set:function(t){t===o.PictureColorType.PictureAutomatic?(this.oft=a.ShapeConstants.DefaultBrightness,this.T1t=a.ShapeConstants.DefaultBrightness):t===o.PictureColorType.PictureWatermark&&(this.oft=.85,this.T1t=.15),this.xrt=t,this.Dirty(2)},enumerable:!1,configurable:!0}),Object.defineProperty(A.prototype,"Contrast",{get:function(){return this.IsDirty(4)||d(this.sft)?this.T1t:this.sft.Contrast},set:function(t){if(t<0||1<t)throw new Error;this.T1t=t,this.Dirty(4)},enumerable:!1,configurable:!0}),Object.defineProperty(A.prototype,"Crop",{get:function(){var t=this;return t.D1t||(t.D1t=new p(t._1t)),t.D1t},enumerable:!1,configurable:!0}),Object.defineProperty(A.prototype,"CropBottom",{get:function(){return this.Crop.ShapeTop+this.Crop.ShapeHeight},set:function(t){this.Crop.ShapeHeight=t-this.Crop.ShapeTop},enumerable:!1,configurable:!0}),Object.defineProperty(A.prototype,"CropLeft",{get:function(){return this.Crop.ShapeLeft},set:function(t){this.Crop.ShapeLeft=t},enumerable:!1,configurable:!0}),Object.defineProperty(A.prototype,"CropRight",{get:function(){return this.Crop.ShapeLeft+this.Crop.ShapeWidth},set:function(t){this.Crop.ShapeWidth=t-this.Crop.ShapeLeft},enumerable:!1,configurable:!0}),Object.defineProperty(A.prototype,"CropTop",{get:function(){return this.Crop.ShapeTop},set:function(t){this.Crop.ShapeTop=t},enumerable:!1,configurable:!0}),Object.defineProperty(A.prototype,"Stretch",{get:function(){return this.N1t},set:function(t){this.N1t=JSON.parse(JSON.stringify(t))},enumerable:!1,configurable:!0}),Object.defineProperty(A.prototype,"Tile",{get:function(){return this.k1t},set:function(t){this.k1t=JSON.parse(JSON.stringify(t))},enumerable:!1,configurable:!0}),Object.defineProperty(A.prototype,"Transparency",{get:function(){return this.aft},set:function(t){t=Math.max(0,t),t=Math.min(1,t),this.aft=t},enumerable:!1,configurable:!0}),Object.defineProperty(A.prototype,"TransparencyColor",{get:function(){return this.IsDirty(8)||d(this.sft)?this.A1t:this.sft.TransparencyColor},set:function(t){this.A1t=t,this.Dirty(8)},enumerable:!1,configurable:!0}),Object.defineProperty(A.prototype,"TransparentBackground",{get:function(){return this.IsDirty(16)||d(this.sft)?this.x1t:this.sft.TransparentBackground},set:function(t){this.x1t=t;var n=this._1t.Fill;t&&(n.Transparency=1),n.Solid(),this.Dirty(16)},enumerable:!1,configurable:!0}),Object.defineProperty(A.prototype,"Container",{get:function(){return this._1t},set:function(t){var n;(this._1t=t)&&((n=this.Crop).PictureWidth=t.Width,n.PictureHeight=t.Height)},enumerable:!1,configurable:!0}),Object.defineProperty(A.prototype,"PicSrc",{get:function(){return this.pue},set:function(t){this.pue=t},enumerable:!1,configurable:!0}),Object.defineProperty(A.prototype,"PicFill",{get:function(){return this.IsDirty(32)||d(this.sft)?this.E1t:this.sft.PicFill},set:function(t){this.E1t=t,this.Dirty(32)},enumerable:!1,configurable:!0}),Object.defineProperty(A.prototype,"PicType",{get:function(){return this.IsDirty(64)||d(this.sft)?this.j1t:this.sft.PicType},set:function(t){this.j1t=t,this.Dirty(64)},enumerable:!1,configurable:!0}),A.prototype.ClearModel=function(){var t,n,e;for(this.O1t=v,this.fft=v,t=0,n=this.Children;t<n.length;t++)(e=n[t]).ClearModel()},Object.defineProperty(A.prototype,"PictureFormatType",{get:function(){return this.I1t},set:function(t){this.I1t=t},enumerable:!1,configurable:!0}),A.prototype.HasOwnPicture=function(){return this.IsDirty(1)||this.IsDirty(2)||this.IsDirty(4)||this.IsDirty(8)||this.IsDirty(16)},A.prototype.SetPictureInfo=function(t,n,e){this.PicFill=t,this.PicType=n,this.PictureFormatType=e},A.prototype.IncrementBrightness=function(t){this.Brightness+=t},A.prototype.IncrementContrast=function(t){this.Contrast+=t},A.prototype.FromOOModel=function(t){var n,e,n=this;n.O1t=t,d(t)||(n.FromCT_Blip(t.blip),e=n._1t,d(e))||(d(t.tile)||(n.PictureFormatType=o.PictureFormatType.TextureFill),n.Crop.PictureWidth=e.Width,n.Crop.PictureHeight=e.Height,n.PictureFormatType===o.PictureFormatType.PictureShape?n.FromCT_RelativeRect(t.srcRect):n.PictureFormatType===o.PictureFormatType.PictureFill?n.FromCT_Stretch(t.stretch):n.PictureFormatType===o.PictureFormatType.TextureFill&&n.FromCT_Tile(t.tile))},A.prototype.FromSJSOOModel=function(t){var n,e,i,r,t,n=this;n.fft=t,d(t)||(n.FromSJSCT_Blip(t.blip),e=n._1t,d(e))||(i=t.srcRect,r=t.stretch,t=t.tile,d(t)||(n.PictureFormatType=o.PictureFormatType.TextureFill),n.Crop.PictureWidth=e.Width,n.Crop.PictureHeight=e.Height,n.PictureFormatType===o.PictureFormatType.PictureShape?n.FromSJSCT_RelativeRect(i):n.PictureFormatType===o.PictureFormatType.PictureFill?n.FromSJSCT_Stretch(r):n.PictureFormatType===o.PictureFormatType.TextureFill&&n.FromSJSCT_Tile(t))},A.prototype.ToOOModel=function(){var t,n,e,e,t=this,n=t.O1t||{};return n.colorFillType=o.ColorFillType.BlipFillProperties,n.blip=t.ToCT_Blip(),e=t._1t,d(e)||((e=t.PictureFormatType)===o.PictureFormatType.PictureShape?(n.srcRect=t.ToCT_RelativeRect(),n.stretch={},n.stretch.fillRect={l:0,r:0,t:0,b:0}):e===o.PictureFormatType.PictureFill?(n.stretch=t.ToCT_Strecth(),n.srcRect={l:0,r:0,t:0,b:0},n.tile=v):e===o.PictureFormatType.TextureFill&&(n.stretch=v,n.srcRect=v,n.tile=t.ToCT_Tile())),n},A.prototype.ToSJSOOModel=function(){var t,n,e,e,t=this,n=t.fft||{};return n.colorFillType=o.ColorFillType.BlipFillProperties,n.blip=t.ToSJSCT_Blip(),e=t._1t,d(e)||((e=t.PictureFormatType)===o.PictureFormatType.PictureShape?(n.srcRect=t.ToCT_RelativeRect(),n.stretch={},n.stretch.fillRect={l:0,r:0,t:0,b:0}):e===o.PictureFormatType.PictureFill?(n.stretch=t.ToCT_Strecth(),n.srcRect={l:0,r:0,t:0,b:0},n.tile=v):e===o.PictureFormatType.TextureFill&&(n.stretch=v,n.srcRect=v,n.tile=t.ToSJSCT_Tile())),n},A.prototype.FromCT_Blip=function(t){var n;d(t)||((n=this).FromCT_ColorChangeEffect(t.clrChange),n.FromCT_LuminanceEffect(t.lum),d(t.alphaModFix)||(n.Transparency=1-t.alphaModFix.amt/c),d(t.grayscl)?d(t.biLevel)||(n.ColorType=o.PictureColorType.PictureBlackAndWhite):n.ColorType=o.PictureColorType.PictureGrayscale,n.FromCT_BlipBlob(t.blipBlob))},A.prototype.FromSJSCT_Blip=function(t){var n,e;d(t)||((n=this).FromSJSCT_ColorChangeEffect(t.clrChange),n.FromSJSCT_LuminanceEffect(t.lum),e=t.alphaModFix,d(e)||(n.Transparency=1-g(e.amt,1e5)/c),d(t.grayscl)?d(t.biLevel)||(n.ColorType=o.PictureColorType.PictureBlackAndWhite):n.ColorType=o.PictureColorType.PictureGrayscale,n.FromSJSCT_BlipBlob(t.blipBlob),t.lossless&&t.lossless.src&&(n.PicSrc=t.lossless.src))},A.prototype.ToCT_Blip=function(){var t,n,t=this,n=t.O1t&&t.O1t.blip||{cstate:o.ST_BlipCompression.none};return t.TransparencyColor!==a.ShapeConstants.DefaultTransparent&&(n.clrChange=t.ToCT_ColorChangeEffect()),t.Brightness===a.ShapeConstants.DefaultBrightness&&t.Contrast===a.ShapeConstants.DefaultBrightness||(n.lum=t.ToCT_LuminanceEffect()),t.Transparency!==a.ShapeConstants.DefaultTransparent?n.alphaModFix={amt:(1-t.Transparency)*c}:delete n.alphaModFix,t.ColorType===o.PictureColorType.PictureGrayscale?n.grayscl={}:t.ColorType===o.PictureColorType.PictureBlackAndWhite&&(n.biLevel={thresh:5e4}),n.blipBlob=t.ToCT_BlipBlob(),n},A.prototype.ToSJSCT_Blip=function(){var t,n,t=this,n={r_:[8]};return t.TransparencyColor!==a.ShapeConstants.DefaultTransparent&&(n.clrChange=t.ToCT_ColorChangeEffect()),t.Brightness===a.ShapeConstants.DefaultBrightness&&t.Contrast===a.ShapeConstants.DefaultBrightness||(n.lum=t.ToCT_LuminanceEffect()),t.Transparency!==a.ShapeConstants.DefaultTransparent&&(n.alphaModFix={amt:(1-t.Transparency)*c}),t.ColorType===o.PictureColorType.PictureGrayscale?n.grayscl={}:t.ColorType===o.PictureColorType.PictureBlackAndWhite&&(n.biLevel={thresh:5e4}),n.blipBlob={blob:t.PicFill},t.PicSrc!==n.blipBlob.blob&&(n.lossless={src:t.PicSrc}),n},A.prototype.FromCT_ColorChangeEffect=function(t){var n;t&&t.clrFrom&&t.clrFrom.srgbClr&&this.FromColorByteArr(t.val)},A.prototype.FromSJSCT_ColorChangeEffect=function(t){var n;t&&t.clrFrom&&t.clrFrom.srgbClr&&this.FromColorByteArr(t.val)},A.prototype.ToCT_ColorChangeEffect=function(){var t=this.ToColorByteArr(this.A1t);return{useA:!0,clrFrom:{srgbClr:{val:t}},clrTo:{srgbClr:{val:t,alpha:[0]}}}},A.prototype.FromColorByteArr=function(t){this.A1t=0|t[2]<<16|t[1]<<8|t[0]},A.prototype.ToColorByteArr=function(t){var n=[];return n[3]=Math.floor(t/(1<<24)),t%=1<<24,n[2]=Math.floor(t/65536),t%=65536,n[1]=Math.floor(t/256),t%=256,n[0]=Math.floor(t),n},A.prototype.FromCT_LuminanceEffect=function(t){t&&(this.Brightness=l(t.bright),this.Contrast=l(t.contrast))},A.prototype.FromSJSCT_LuminanceEffect=function(t){t&&(this.Brightness=l(C(t.bright)),this.Contrast=l(C(t.contrast)))},A.prototype.ToCT_LuminanceEffect=function(){return{bright:h(this.Brightness),contrast:h(this.Contrast)}},A.prototype.FromCT_BlipBlob=function(t){var n;t&&((n=this).pue=t.src||t.blob,n.E1t=t.blob,n.Dirty(32),n.j1t=t.type,n.Dirty(64))},A.prototype.FromSJSCT_BlipBlob=function(t){var n;t&&((n=this).pue=t.blob,n.E1t=t.blob,n.Dirty(32),n.j1t=M(t.type,"png"),n.Dirty(64))},A.prototype.ToCT_BlipBlob=function(){var t,n,t=this,n=t.O1t&&t.O1t.blip&&t.O1t.blip.blipBlob||{type:o.ImageType.PNG};return n.blob=t.PicFill,n.type=t.PicType,t.PicSrc!==n.blob&&(n.src=t.PicSrc),n},A.prototype.FromCT_Tile=function(t){this.k1t={offsetX:t.tx,offsetY:t.ty,scaleX:t.sx/f,scaleY:t.sy/f,alignment:t.algn,mirrorType:t.flip}},A.prototype.FromSJSCT_Tile=function(t){this.k1t={offsetX:u(g(t.tx,0)),offsetY:u(g(t.ty,0)),scaleX:g(t.sx,f)/f,scaleY:g(t.sy,f)/f,alignment:o.ST_RectAlignment[t.algn||"tl"],mirrorType:o.ST_TileFlipMode[t.flip||"none"]}},A.prototype.ToCT_Tile=function(){var t=this.Tile;return{tx:t.offsetX,ty:t.offsetY,sx:Math.round(t.scaleX*f),sy:Math.round(t.scaleY*f),algn:t.alignment,flip:t.mirrorType}},A.prototype.ToSJSCT_Tile=function(){var t=this.Tile;return{tx:s(Math.round(t.offsetX)),ty:s(Math.round(t.offsetY)),sx:Math.round(t.scaleX*f),sy:Math.round(t.scaleY*f),algn:o.ST_RectAlignment[t.alignment],flip:o.ST_TileFlipMode[t.mirrorType]}},A.prototype.FromCT_Stretch=function(t){var t,n,e,i,t,t=t&&t.fillRect;d(t)||(n=t.l/f,e=t.r/f,i=t.t/f,t=t.b/f,this.N1t={left:n,right:e,top:i,bottom:t})},A.prototype.FromSJSCT_Stretch=function(t){var t,n,e,i,t,t=t&&t.fillRect;d(t)||(n=(0,a.pft)(t.l),e=(0,a.pft)(t.r),i=(0,a.pft)(t.t),t=(0,a.pft)(t.b),this.N1t={left:n,right:e,top:i,bottom:t})},A.prototype.ToCT_Strecth=function(){var t=this.Stretch,n=t.left,e=t.right,i=t.top,t=t.bottom;return{fillRect:{l:Math.round(n*f),r:Math.round(e*f),t:Math.round(i*f),b:Math.round(t*f)}}},A.prototype.FromCT_RelativeRect=function(t){var n,e,i,r,t,o,i,t,n=this._1t;d(t)||d(n)||(e=t.l/f,i=t.r/f,r=t.t/f,t=t.b/f,i=(o=this.Crop).PictureWidth=n.Width/(1-e-i),t=o.PictureHeight=n.Height/(1-r-t),o.PictureOffsetX=(i-n.Width)/2-e*i,o.PictureOffsetY=(t-n.Height)/2-r*t)},A.prototype.FromSJSCT_RelativeRect=function(t){var n,e,i,r,t,o,i,t,n=this._1t;d(t)||d(n)||(e=(0,a.pft)(t.l),i=(0,a.pft)(t.r),r=(0,a.pft)(t.t),t=(0,a.pft)(t.b),i=(o=this.Crop).PictureWidth=n.Width/(1-e-i),t=o.PictureHeight=n.Height/(1-r-t),o.PictureOffsetX=(i-n.Width)/2-e*i,o.PictureOffsetY=(t-n.Height)/2-r*t)},A.prototype.ToCT_RelativeRect=function(){var t,n,e,i,t,r,o,n,a,u,s,c,t=this._1t,n=this.Crop,e=n.ShapeHeight,i=n.ShapeWidth;return d(t)||0===e||0===i?{l:0,r:0,t:0,b:0}:(t=n.PictureWidth,r=n.PictureHeight,o=n.PictureOffsetX,n=n.PictureOffsetY,{l:(a=((t-i)/2-o)/t)*f,r:(u=((t-i)/2+o)/t)*f,t:(s=((r-e)/2-n)/r)*f,b:(c=((r-e)/2+n)/r)*f})},A.prototype.Clone=function(){var t,n,t=this,n=new A;return n.oft=t.oft,n.T1t=t.T1t,n.xrt=t.xrt,t.D1t&&(n.D1t=t.D1t.Clone()),n.aft=t.aft,n.k1t=JSON.parse(JSON.stringify(t.k1t)),n.N1t=JSON.parse(JSON.stringify(t.N1t)),n.pue=t.pue,n.E1t=t.E1t,n.I1t=t.I1t,n.j1t=t.j1t,n._1t=t._1t,n.A1t=t.A1t,n.x1t=t.x1t,n},A.prototype.OnParentChanged=function(t){this.sft=t},n.PictureFormat=A},"./dist/plugins/floatingObject/drawing/stateful.js":function(t,n,e){"use strict";var i,e,o,r;function a(t){var n=this;n.R1t=[],n.B1t=0,n.l0t=0,n.L1t=t,n.L1t&&n.L1t.AddChildInternal(n)}Object.defineProperty(n,"__esModule",{value:!0}),n.StatefulBase=void 0,e=(i=e("Common")).Common.lt,o=e.ht,a.prototype.SetState=function(n,t){var e,i,e=this,i=n;t?e.l0t|=i:e.l0t&=~i,e.IsClearChildrenStateSuspended||e.R1t.forEach(function(t){t.SetState(n,!1)})},a.prototype.GetState=function(t,n){var e,i,r,e=this,i,r=(t&e.l0t)===t;return r=r||!n||o(e.L1t)?r:e.L1t.GetState(t,!0)},a.prototype.OnStateChanged=function(t){},a.prototype.Dirty=function(t){this.SetState(t,!0)},a.prototype.UnDirty=function(t){this.SetState(t,!1)},a.prototype.UnDirtyAll=function(){this.l0t=0},a.prototype.IsDirty=function(t){return this.GetState(t)},a.prototype.IsPropDirtyIncludingParent=function(t,n){var e,i,e=this,i;return!!e.GetState(t)||!(!n||o(e.L1t))&&e.L1t.IsPropDirtyIncludingParent(t,!0)},a.prototype.IsDirtyIncludingParent=function(t){var n=this;return 0<n.l0t||!(!t||o(n.L1t))&&n.L1t.IsDirtyIncludingParent(!0)},a.prototype.AddChildInternal=function(t){var n=this.R1t;-1===n.indexOf(t)&&n.push(t)},a.prototype.RemoveChildInternal=function(t){var n=this.R1t,t=n.indexOf(t);-1!==t&&n.splice(t,1)},a.prototype.SetParentForChildren=function(n){var t;this.R1t.slice(0).forEach(function(t){t.ParentStateful=n})},a.prototype.OnParentChanged=function(t){},a.prototype.SuspendClearChildrenState=function(){this.B1t++},a.prototype.ResumeClearChilrenState=function(){this.B1t--},Object.defineProperty(a.prototype,"ParentStateful",{get:function(){return this.L1t},set:function(t){var n=this;t!==n.L1t&&(n.L1t&&n.L1t.RemoveChildInternal(this),n.L1t=t,n.L1t&&n.L1t.AddChildInternal(this),n.OnParentChanged(t))},enumerable:!1,configurable:!0}),Object.defineProperty(a.prototype,"Children",{get:function(){return this.R1t},enumerable:!1,configurable:!0}),Object.defineProperty(a.prototype,"IsClearChildrenStateSuspended",{get:function(){return 0<this.B1t},enumerable:!1,configurable:!0}),n.StatefulBase=a},"./dist/plugins/floatingObject/drawing/threeDFormat.js":function(t,n,e){"use strict";var i,r,o,a,e,u,s,c,f,l,h,d,v,e,e,m;function g(t,n){var e,i,e=m.call(this,n)||this,i=e;return i.F1t=r.BevelType.BevelNone,i.P1t=r.BevelType.BevelNone,i.G1t=l.ExtrusionColorAutomatic,i.U1t=45,i.jft=!0,i.H1t=h,i.z1t=!0,i.V1t=100,i.Y1t=100,i.Z1t=!0,i.DJ=t,i.W1t=30,i.sft=n,i.Q1t(a.PresetCamera.PresetCameraNone),e}i=this&&this.__extends||(v=function(t,n){return(v=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(t,n){t.__proto__=n}:function(t,n){for(var e in n)Object.prototype.hasOwnProperty.call(n,e)&&(t[e]=n[e])}))(t,n)},function(t,n){if("function"!=typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function e(){this.constructor=t}v(t,n),t.prototype=null===n?Object.create(n):(e.prototype=n.prototype,new e)}),Object.defineProperty(n,"__esModule",{value:!0}),n.ThreeDFormat=n.ThreeDFormatStates=void 0,r=e("./dist/plugins/floatingObject/drawing/common.js"),o=e("./dist/plugins/floatingObject/drawing/stateful.js"),a=e("./dist/plugins/floatingObject/drawing/drawingInterface.js"),e=e("Core"),u=e.ExcelHelper.emuToPixles,s=r.ShapeConstants.PositiveFixedAngleConvert,c=r.UnitHelper.isNullOrUndefined,(e=f=n.ThreeDFormatStates||(n.ThreeDFormatStates={}))[e.BevelBottomDepth=1]="BevelBottomDepth",e[e.BevelBottomInset=2]="BevelBottomInset",e[e.BevelBottomType=4]="BevelBottomType",e[e.BevelTopDepth=8]="BevelTopDepth",e[e.BevelTopInset=16]="BevelTopInset",e[e.BevelTopType=32]="BevelTopType",e[e.ContourColor=64]="ContourColor",e[e.ContourWidth=128]="ContourWidth",e[e.Depth=256]="Depth",e[e.ExtrusionColor=512]="ExtrusionColor",e[e.ExtrusionColorType=1024]="ExtrusionColorType",e[e.FieldOfView=2048]="FieldOfView",e[e.LightAngle=4096]="LightAngle",e[e.Perspective=8192]="Perspective",e[e.PresetCamera=16384]="PresetCamera",e[e.PresetExtrusionDirection=32768]="PresetExtrusionDirection",e[e.PresetLighting=65536]="PresetLighting",e[e.PresetLightingDirection=131072]="PresetLightingDirection",e[e.PresetLightingSoftness=262144]="PresetLightingSoftness",e[e.PresetMaterial=524288]="PresetMaterial",e[e.PresetThreeDFormat=1048576]="PresetThreeDFormat",e[e.ProjectText=2097152]="ProjectText",e[e.RotationX=4194304]="RotationX",e[e.RotationY=8388608]="RotationY",e[e.RotationZ=16777216]="RotationZ",e[e.Visible=33554432]="Visible",e[e.Z=67108864]="Z",e[e.AutoScale=134217728]="AutoScale",e[e.DepthPercent=268435456]="DepthPercent",e[e.HeightPercent=536870912]="HeightPercent",e[e.RightAngleAxes=1073741824]="RightAngleAxes",(e=l=l||{})[e.ExtrusionColorAutomatic=0]="ExtrusionColorAutomatic",e[e.ExtrusionColorCustom=1]="ExtrusionColorCustom",h=null,m=o.StatefulBase,i(g,m),g.prototype.Q1t=function(t){var n=this;n.K1t=t,n.Dirty(f.PresetCamera)},g.prototype.InitDicCameraType=function(){var t=this.H1t=[];t[a.PresetCamera.CameraLegacyObliqueTopLeft]=[0,0,0],t[a.PresetCamera.CameraLegacyObliqueTop]=[0,0,0],t[a.PresetCamera.CameraLegacyObliqueTopRight]=[0,0,0],t[a.PresetCamera.CameraLegacyObliqueLeft]=[0,0,0],t[a.PresetCamera.CameraLegacyObliqueFront]=[0,0,0],t[a.PresetCamera.CameraLegacyObliqueRight]=[0,0,0],t[a.PresetCamera.CameraLegacyObliqueBottomLeft]=[0,0,0],t[a.PresetCamera.CameraLegacyObliqueBottom]=[0,0,0],t[a.PresetCamera.CameraLegacyObliqueBottomRight]=[0,0,0],t[a.PresetCamera.CameraLegacyPerspectiveTopLeft]=[0,0,0],t[a.PresetCamera.CameraLegacyPerspectiveTop]=[0,0,0],t[a.PresetCamera.CameraLegacyPerspectiveTopRight]=[0,0,0],t[a.PresetCamera.CameraLegacyPerspectiveLeft]=[0,0,0],t[a.PresetCamera.CameraLegacyPerspectiveFront]=[0,0,0],t[a.PresetCamera.CameraLegacyPerspectiveRight]=[0,0,0],t[a.PresetCamera.CameraLegacyPerspectiveBottomLeft]=[0,0,0],t[a.PresetCamera.CameraLegacyPerspectiveBottom]=[0,0,0],t[a.PresetCamera.CameraLegacyPerspectiveBottomRight]=[0,0,0],t[a.PresetCamera.CameraOrthographicFront]=[0,0,0],t[a.PresetCamera.CameraIsometricTopUp]=[314.7191,324.6037,60.16242],t[a.PresetCamera.CameraIsometricTopDown]=[45.28088,324.6037,299.8376],t[a.PresetCamera.CameraIsometricBottomUp]=[45.28088,35.39627,60.16242],t[a.PresetCamera.CameraIsometricBottomDown]=[314.7191,35.39627,299.8376],t[a.PresetCamera.CameraIsometricLeftUp]=[45,325,0],t[a.PresetCamera.CameraIsometricLeftDown]=[45,35,0],t[a.PresetCamera.CameraIsometricRightUp]=[315,35,0],t[a.PresetCamera.CameraIsometricRightDown]=[315,325,0],t[a.PresetCamera.CameraIsometricOffAxis1Left]=[64,18,0],t[a.PresetCamera.CameraIsometricOffAxis1Right]=[334,18,0],t[a.PresetCamera.CameraIsometricOffAxis1Top]=[306.5457,301.2619,57.6425],t[a.PresetCamera.CameraIsometricOffAxis2Left]=[26,18,0],t[a.PresetCamera.CameraIsometricOffAxis2Right]=[296,18,0],t[a.PresetCamera.CameraIsometricOffAxis2Top]=[53.45424,301.2619,302.3575],t[a.PresetCamera.CameraIsometricOffAxis3Left]=[64,342,0],t[a.PresetCamera.CameraIsometricOffAxis3Right]=[334,342,0],t[a.PresetCamera.CameraIsometricOffAxis3Bottom]=[306.5457,58.73808,302.3575],t[a.PresetCamera.CameraIsometricOffAxis4Left]=[26,342,0],t[a.PresetCamera.CameraIsometricOffAxis4Right]=[296,342,0],t[a.PresetCamera.CameraIsometricOffAxis4Bottom]=[53.45424,58.73808,57.64252],t[a.PresetCamera.CameraObliqueTopLeft]=[0,0,0],t[a.PresetCamera.CameraObliqueTop]=[0,0,0],t[a.PresetCamera.CameraObliqueTopRight]=[0,0,0],t[a.PresetCamera.CameraObliqueLeft]=[0,0,0],t[a.PresetCamera.CameraObliqueRight]=[0,0,0],t[a.PresetCamera.CameraObliqueBottomLeft]=[0,0,0],t[a.PresetCamera.CameraObliqueBottom]=[0,0,0],t[a.PresetCamera.CameraObliqueBottomRight]=[0,0,0],t[a.PresetCamera.CameraPerspectiveFront]=[0,0,0],t[a.PresetCamera.CameraPerspectiveLeft]=[20,0,0],t[a.PresetCamera.CameraPerspectiveRight]=[340,0,0],t[a.PresetCamera.CameraPerspectiveAbove]=[0,340,0],t[a.PresetCamera.CameraPerspectiveBelow]=[0,20,0],t[a.PresetCamera.CameraPerspectiveAboveLeftFacing]=[14.33758,39.30647,341.1238],t[a.PresetCamera.CameraPerspectiveAboveRightFacing]=[345.6624,39.30647,18.87615],t[a.PresetCamera.CameraPerspectiveContrastingLeftFacing]=[43.93887,10.39642,356.4465],t[a.PresetCamera.CameraPerspectiveContrastingRightFacing]=[316.0611,10.39642,3.553517],t[a.PresetCamera.CameraPerspectiveHeroicLeftFacing]=[14.29302,348.9837,2.626817],t[a.PresetCamera.CameraPerspectiveHeroicRightFacing]=[345.7069,348.9837,357.3732],t[a.PresetCamera.CameraPerspectiveHeroicExtremeLeftFacing]=[34.46068,8.12245,357.0914],t[a.PresetCamera.CameraPerspectiveHeroicExtremeRightFacing]=[325.5393,8.12245,2.9086],t[a.PresetCamera.CameraPerspectiveRelaxed]=[0,309.5601,0],t[a.PresetCamera.CameraPerspectiveRelaxedModerately]=[0,324.844,0]},g.prototype.SetPresetCamera=function(t){var n=this;n.K1t=t,n.Dirty(f.PresetCamera)},g.prototype.UpdatePresetCamera=function(){var t=this;t.K1t===a.PresetCamera.PresetCameraNone&&t.SetPresetCamera(a.PresetCamera.CameraOrthographicFront)},g.prototype.IncrementRotationX=function(t){this.RotationX+=t},g.prototype.IncrementRotationY=function(t){this.RotationY+=t},g.prototype.IncrementRotationZ=function(t){this.RotationZ+=t},g.prototype.ResetRotation=function(){var t=this;t.RotationX=0,t.RotationY=0,t.RotationZ=0},g.prototype.Clone=function(){var t,n,t=this,n=new g(t.DJ);return n.J1t=t.J1t,n.X1t=t.X1t,n.F1t=t.F1t,n.q1t=t.q1t,n.$1t=t.$1t,n.P1t=t.P1t,c(t.tlt)||(n.tlt=t.tlt.Clone()),n.nlt=t.nlt,n.elt=t.elt,c(t.ilt)||(n.ilt=t.ilt.Clone()),n.G1t=t.G1t,n.U1t=t.U1t,n.rlt=t.rlt,n.W1t=t.W1t,n.K1t=t.K1t,n.olt=t.olt,n.ult=t.ult,n.slt=t.slt,n.clt=t.clt,n.flt=t.flt,n.llt=t.llt,n.hlt=t.hlt,n.dlt=t.dlt,n.vlt=t.vlt,n.mlt=t.mlt,n.jft=t.jft,n._z=t._z,n.l0t=t.l0t,n.sft=t.sft,n},g.prototype.IsDirtyIncludingParent=function(t){var n=this;return!(!n.tlt||!n.tlt.IsDirtyIncludingParent(t))||!(!n.ilt||!n.ilt.IsDirtyIncludingParent(t))||m.prototype.IsDirtyIncludingParent.call(this,t)},g.prototype.OnParentChanged=function(t){var n=this;n.sft=t,c(n.sft)&&(n.tlt&&(n.tlt.ParentStateful=h),n.ilt)&&(n.ilt.ParentStateful=h)},g.prototype.FromOOModel=function(t){var n=this;n.cft=t,n.FromCT_Scene3D(n.cft.Scene3D),n.FromCT_View3D(n.cft.View3D),n.FromCT_Shape3D(n.cft.Shape3D)},g.prototype.FromSJSOOModel=function(t,n,e){var i=this;i.cft={scene3d:t,sp3d:n,extLst:e},t||n?(i.plt(t),i.blt(n)):e&&i.ylt(e)},g.prototype.wlt=function(t){var n,e,i,t;t&&(e=t.lat,i=t.lon,t=t.rev,(n=this).RotationX=parseInt(i,10)/s,n.RotationY=parseInt(e,10)/s,n.RotationZ=parseInt(t,10)/s)},g.prototype.Mlt=function(t){var n,e,t,n=this,e=t.prst,t=t.rot;n.Q1t(a.ST_PresetCameraType[e]),c(t)||n.wlt(t)},g.prototype.plt=function(t){var n,e,t,n=this,e=t.camera,t=t.extLst;e&&n.Mlt(e),t&&n.ylt(t)},g.prototype.Clt=function(t){var n,e,i,t,n={w:76200,h:76200,prst:1},e=t.w,i=t.h,t=t.prst;return e&&(n.w=parseInt(e,10)),i&&(n.h=parseInt(i,10)),t&&(n.prst=a.ST_BevelPresetType[t]),n},g.prototype.blt=function(t){var n,e,e,e,e;t&&(n=this,(e=t.extrusionH)&&0!==(e=u(parseInt(e,10)))&&(n.Depth=e,n.Dirty(f.Depth)),t.z&&0!==(e=u(parseInt(t.z,10)))&&(n.Z=e,n.Dirty(f.Z)),e=t.extLst)&&n.ylt(e)},g.prototype.ylt=function(t){var i,t,n,i=this,t=t&&t.ext;t&&(n=[].concat(t)).forEach(function(t){var n,e,t,n=c(t.uri)?"":t.uri,e=t.scene3d,t=t.sp3d;n===a.OOXMLFileHelper.HiddenScene3dUri?i.plt(e):n===a.OOXMLFileHelper.HiddenSp3dUri&&i.blt(t),(e||t)&&(i._InternalVisible=!1,i.Dirty(f.Visible))})},g.prototype.ToOOModel=function(t){var n,e,n=this,e=n.cft||{};return e.View3D=n.ToCT_View3D(),n.PresetCamera!==a.PresetCamera.PresetCameraNone&&(e.Scene3D=n.ToCT_Scene3D()),(n.IsPropDirtyIncludingParent(f.Depth,!0)||n.IsPropDirtyIncludingParent(f.Z,!0))&&(e.Shape3D=n.ToCT_Shape3D()),e},g.prototype.FromCT_View3D=function(t){var n=this;c(t)||(c(t.hPercent)||(n._HeightPercent=t.hPercent),c(t.depthPercent)||(n._DepthPercent=t.depthPercent),c(t.rotX)||(n.RotationY=t.rotX),c(t.rotY)||(n.RotationX=t.rotY),c(t.rAngAx)?n._RightAngleAxes=!1:n._RightAngleAxes=t.rAngAx,c(t.perspective))||(n.Perspective=t.perspective/2)},g.prototype.ToCT_View3D=function(){var t,n,t=this,n=t.cft&&t.cft.View3D||{};return!t._AutoScale&&t.IsDirty(f.HeightPercent)&&(n.hPercent=t._HeightPercent),t.IsDirty(f.DepthPercent)&&(n.depthPercent=t._DepthPercent),t.IsDirty(f.RotationY)&&(n.rotX=t.RotationY),t.IsDirty(f.RotationX)&&(n.rotY=t.RotationX),t.IsDirty(f.RightAngleAxes)&&(n.rAngAx=t._RightAngleAxes),!t._RightAngleAxes&&t.IsDirty(f.Perspective)&&(n.perspective=2*t.Perspective),n},g.prototype.FromCT_Scene3D=function(t){c(t)||this.FromCT_Camera(t.camera)},g.prototype.ToCT_Scene3D=function(){var t,n,n,t=this,n=t.cft,n=n&&n.Scene3D||{};return n.camera=t.ToCT_Camera(),!c(n.camera)&&c(n.lightRig)&&(n.lightRig=t.ToDefaultCT_LightRig()),c(n.camera)&&c(n.backdrop)&&c(n.lightRig)?h:n},g.prototype.GetActualCT_Scene3D=function(){var t=this;return c(t.cft)||c(t.cft.Scene3D)?c(t.sft)?h:t.GetActualCT_Scene3D():t.cft.Scene3D},g.prototype.FromCT_Shape3D=function(t){var n=this;c(t)||(0!==t.extrusionH&&(n.Depth=t.extrusionH,n.Dirty(f.Depth)),0!==t.z&&(n.Z=t.z,n.Dirty(f.Z)))},g.prototype.ToCT_Shape3D=function(){var t,n,n,t=this,n=t.cft,n=n&&n.Shape3D||{z:0,extrusionH:0,contourW:0,prstMaterial:a.ST_PresetMaterialType.warmMatte};return n.extrusionH=t.Depth,n.z=t.Z,n},g.prototype.ToDefaultCT_LightRig=function(){return{rig:a.LightRigType.LightRigThreePoint,dir:a.PresetLightingDirection.LightingTopLeft}},g.prototype.FromCT_Camera=function(t){c(t)||(this.Q1t(t.prst),c(t.rot))||this.FromCameraCT_SphereCoords(t.rot)},g.prototype.ToCT_Camera=function(){var t,n,n,t=this;return t.DJ.DrawingType===a.DrawingType.Shape||t.DJ.DrawingType===a.DrawingType.GroupShape?((n={zoom:1e5}).prst=t.PresetCamera,n.rot=t.ToCameraCT_SphereCoords(),n):(n=t.cft)&&n.Scene3D&&n.Scene3D.camera||h},g.prototype.FromCameraCT_SphereCoords=function(t){var n=this;c(t)||(n.RotationX=t.lon/s,n.RotationY=t.lat/s,n.RotationZ=t.rev/s)},g.prototype.ToCameraCT_SphereCoords=function(){var t,n,e,i,t,t=this;return 0===t.RotationX&&0===t.RotationY&&0===t.RotationZ?h:(e=t.RotationX,i=t.RotationY,t=t.RotationZ,(n={}).lon=e*s,n.lat=i*s,n.rev=t*s,n)},Object.defineProperty(g.prototype,"Perspective",{get:function(){var t=this;return t.Dirty(f.Perspective),c(t.sft)?t.W1t:t.sft.Perspective},set:function(t){var n=this;n.W1t=t,n.Dirty(f.Perspective)},enumerable:!1,configurable:!0}),Object.defineProperty(g.prototype,"PresetCamera",{get:function(){var t=this;return t.Dirty(f.PresetCamera),c(t.sft)?t.K1t:t.sft.PresetCamera},enumerable:!1,configurable:!0}),Object.defineProperty(g.prototype,"RotationX",{get:function(){var t=this;return t.Dirty(f.RotationX),c(t.sft)?t.Visible?t.dlt:0:t.sft.RotationX},set:function(t){var n=this;t!==n.dlt&&(n.dlt=t,n.Dirty(f.RotationX),n.UpdatePresetCamera())},enumerable:!1,configurable:!0}),Object.defineProperty(g.prototype,"RotationY",{get:function(){var t=this;return t.Dirty(f.RotationY),c(t.sft)?t.Visible?t.vlt:0:t.sft.RotationY},set:function(t){var n=this;if(n.DJ.DrawingType===a.DrawingType.Chart){if(t<-90&&180<=t)return}else if(t<0&&360<=t)return;n.vlt=t,n.Dirty(f.RotationY),n.UpdatePresetCamera()},enumerable:!1,configurable:!0}),Object.defineProperty(g.prototype,"RotationZ",{get:function(){var t=this;return t.Dirty(f.RotationZ),c(t.sft)?t.Visible?t.mlt:0:t.sft.RotationZ},set:function(t){var n=this;t!==n.mlt&&(n.mlt=t,n.Dirty(f.RotationZ),n.UpdatePresetCamera())},enumerable:!1,configurable:!0}),Object.defineProperty(g.prototype,"Visible",{get:function(){var t=this;return t.Dirty(f.Visible),c(t.sft)?t.jft:t.sft.Visible},set:function(t){var n=this;n.jft=t,n.Dirty(f.Visible)},enumerable:!1,configurable:!0}),Object.defineProperty(g.prototype,"Z",{get:function(){var t=this;return t.Dirty(f.Z),c(t.sft)?t.Visible?t._z:0:t.sft.Z},set:function(t){var n=this;n._z=t,n.Dirty(f.Z),n.UpdatePresetCamera()},enumerable:!1,configurable:!0}),Object.defineProperty(g.prototype,"Depth",{get:function(){var t=this;return t.Dirty(f.Depth),c(t.sft)?t.Visible?t.elt:0:t.sft.Depth},set:function(t){var n=this;n.elt=t,n.Dirty(f.Depth),n.UpdatePresetCamera()},enumerable:!1,configurable:!0}),Object.defineProperty(g.prototype,"DicCameraType",{get:function(){var t=this;return c(t.H1t)&&t.InitDicCameraType(),t.H1t},enumerable:!1,configurable:!0}),Object.defineProperty(g.prototype,"_InternalVisible",{get:function(){return this.jft},set:function(t){this.jft=t},enumerable:!1,configurable:!0}),Object.defineProperty(g.prototype,"_AutoScale",{get:function(){return this.z1t},set:function(t){var n=this;n.z1t=t,n.Dirty(f.AutoScale)},enumerable:!1,configurable:!0}),Object.defineProperty(g.prototype,"_DepthPercent",{get:function(){return this.V1t},set:function(t){var n=this;20<=t&&t<=2e3&&(n.V1t=t,n.Dirty(f.DepthPercent))},enumerable:!1,configurable:!0}),Object.defineProperty(g.prototype,"_HeightPercent",{get:function(){return this.Y1t},set:function(t){var n=this;5<=t&&t<=500&&(n.Y1t=t,n.Dirty(f.HeightPercent))},enumerable:!1,configurable:!0}),Object.defineProperty(g.prototype,"_RightAngleAxes",{get:function(){return this.Z1t},set:function(t){var n=this;n.Z1t=t,n.Dirty(f.RightAngleAxes)},enumerable:!1,configurable:!0}),n.ThreeDFormat=g},"./dist/plugins/floatingObject/floatingobject-actions.js":function(k,t,n){"use strict";var e,i,j,D,n,l,O,_,R,E,r,o,G,a,u,c,s,f,h,d,v,m,g,p,b,y,B,L,U,w,n,M,H,z,i,V,Y,C,Z,S,W,Q,J,K,X,q,n;function F(t){var t=t.WL,n=!1;return t&&t.QP().forEach(function(t){t&&t[B]()&&(n=!0)}),n}function $(t,n){var e=O(n),i,r;if(0<O(n))for(i=0;i<e;i++)(r=t.WL.ev(n[i]))&&r.isSelected(!0)}function P(t,n,e,i,r){var o,a,u,s,t,i,o=t.parent,a=[],u=t.WL;if(i)a=i;else for(s=0;s<e.length;s++)a.push(u.ev(e[s]));o&&n.Z3&&a[0]&&(t=a[0].startRow(),i=a[0].startColumn(),o.changeSelectionInCommandExecuting(n,t,i,[],a),n.Z3.X3=r)}function T(){return null!==S&&S.apply(this,arguments)||this}function A(t,n){return W.call(this,t,n)||this}function tt(t){var t,n,e,t=t,n=t.Mf;return!!t.canUndo()&&(t.X5(n,!0),e=j.Commands.TI(n.name()),n.Ut.undo(t.tT[e]),t.q5(n,!0),!0)}function I(t,n){return Q.call(this,t,n)||this}function x(t,n){return J.call(this,t,n)||this}function N(){var t=K.call(this)||this;return t.Mf=_,t}function nt(t,n){var e,i,e=X.call(this)||this,i=e;return i.OFFSET=15,i.Mf=t,i.tT=n,E(n.clipboardFloatingObjectData)&&(n.clipboardFloatingObjectData=n.fromSheet.dP),e}function et(t,n){var e,i,e=q.call(this)||this,i=e;return i.Mf=t,i.tT=n,e}function it(t){var n=[];return t.WL.QP().forEach(function(t){t[B]()&&n.push(t[L]())}),n}function rt(t,n,e){var i,r,o,a,u,s,i=t.uq(),r=i.fromSheet;for(i.fromSheet=t,i.isCutting=e,o=new D.Nlt,u=a=0;u<O(n);u++)(s=t.WL.ev(n[u]))&&(o.push(s),a++);return r&&(r.dP=_),t.dP=o,0<a}function ot(t){var n,e,e;switch(t.typeName){case"0":case"1":break;case"2":n="Chart "}return n}function at(t){var n=[];return t.WL.QP().forEach(function(t){t[B]()&&n.push(t[L]())}),n}function ut(r){return function(t,n){var t,n,e,i,t=j.Commands.Tp(t,n),n=0;return r===C.left?n=-1:r===C.right&&(n=1),e=0,r===C.up?e=-1:r===C.down&&(e=1),i=it(t),0<O(i)&&t.Qy().execute({cmd:v,sheetName:t.name(),floatingObjects:i,offsetX:n,offsetY:e})}}e=this&&this.__extends||(Z=function(t,n){return(Z=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(t,n){t.__proto__=n}:function(t,n){for(var e in n)Object.prototype.hasOwnProperty.call(n,e)&&(t[e]=n[e])}))(t,n)},function(t,n){if("function"!=typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function e(){this.constructor=t}Z(t,n),t.prototype=null===n?Object.create(n):(e.prototype=n.prototype,new e)}),Object.defineProperty(t,"__esModule",{value:!0}),t.DragCopyFloatingObjectUndoAction=t.ClipboardPasteFloatingObjectUndoAction=t.FloatingObjectCopyPasteUndoAction=t.ResizingFloatingObjectUndoAction=t.MovingFloatingObjectUndoAction=t.DeleteFloatingObjectUndoAction=t.FloatingObjectUndoActionBase=void 0,i=n("Common"),j=n("Core"),D=n("./dist/plugins/floatingObject/floatingobject.js"),n=j.GC$,l=n.isArray,O=i.Common.Uf.tR,_=null,R=Math.min,E=i.Common.lt.ht,r="unSelectAllFloatingObjects",o="deleteFloatingObjects",G="deleteFloatingObjectsByBackspaceKey",a="navigationNextFloatingObject",u="navigationPreviousFloatingObject",c="cutFloatingObjects",s="copyFloatingObjects",f="pasteFloatingObjects",h="dragCopyFloatingObjects",d="selectAllFloatingObjects",v="moveFloatingObjects",m="moveFloatingObjectsUp",g="moveFloatingObjectsDown",p="moveFloatingObjectsLeft",b="moveFloatingObjectsRight",y="resizeFloatingObjects",B="isSelected",L="name",U="cancel",w=j.Commands.zA,S=j.Commands.ActionBase,e(T,S),T.prototype.canExecute=function(){return!!F(this.Mf)},T.prototype.canUndo=function(){var t,t,n,t=j.Commands.TI(this.Mf.name()),t=this.tT[t],n=t&&t.floatingObjectChanges;return!!(n&&0<O(n))||!!((n=t&&t.slicerChanges)&&0<O(n))},t.FloatingObjectUndoActionBase=n=T,e(A,W=n),A.prototype.execute=function(){var t,n,e,i,r,o,a,u,s,c,f,t=this,n=!1,e=t.Mf,i=t.tT,r=i.floatingObjects;if(t.canExecute()&&l(r)){for(P(e,i,r),e.Ut.startTransaction(),t.X5(e,!0),o=e.WL,a=0,u=O(r);a<u;a++)(s=o.ev(r[a]))&&(c=e.slicers,t.klt(s)&&c&&c.DK(s[L]()),o.VP(r[a],!0),s[B](!1));e.cR(),t.q5(e,!0),i[f=j.Commands.TI(e.name())]=e.Ut.endTransaction(),n=0<O(r)}return n},A.prototype.undo=function(){var t,n,e,i,t=this,n=t.tT,e=t.Mf;return!!t.canUndo()&&(t.X5(e,!0),i=j.Commands.TI(e.name()),e.Ut.undo(n[i]),e.e4(),t.q5(e,!0),!0)},A.prototype.klt=function(t){return t&&"Slicer"===t.typeName},t.DeleteFloatingObjectUndoAction=M=A,e(I,Q=n),I.prototype.canExecute=function(){return!0},I.prototype.execute=function(){var t,n,e,i,r,o,a,u,s,c,f,t=this,n=!1,e=t.tT,i=e.floatingObjects,r=t.Mf;if(t.canExecute()&&l(i)){for(P(r,e,i),r.Ut.startTransaction(),t.X5(r,!0),o=r.WL,a=0,u=O(i);a<u;a++)(s=o.ev(i[a])).allowMove()&&(c=s.position(),s.position(new j.Point(c.x+e.offsetX,c.y+e.offsetY)));t.q5(r,!0),e[f=j.Commands.TI(r.name())]=r.Ut.endTransaction(),n=0<O(i)}return n},I.prototype.undo=function(){return tt(this)},t.MovingFloatingObjectUndoAction=H=I,e(x,J=n),x.prototype.execute=function(){var t,n,e,i,r,o,a,u,s,c,f,t=this,n=!1,e=t.tT,i=e.floatingObjects,r=t.Mf;if($(r,i),t.canExecute()&&l(i)){for(P(r,e,i),r.Ut.startTransaction(),t.X5(r,!0),o=r.WL,a=0,u=O(i);a<u;a++)(s=o.ev(i[a])).allowResize()&&(c=s.position(),s.width(s.width()+e.offsetWidth),s.height(s.height()+e.offsetHeight),s.position(new j.Point(c.x+e.offsetX,c.y+e.offsetY)));t.q5(r,!0),e[f=j.Commands.TI(r.name())]=r.Ut.endTransaction(),n=0<O(i)}return n},x.prototype.undo=function(){return tt(this)},t.ResizingFloatingObjectUndoAction=z=x,K=j.Commands.ActionBase,e(N,K),N.prototype.canExecute=function(){var t=this,n=t.tT.floatingObjects;return!!(0<O(n)&&t.Dlt(n))},N.prototype.canUndo=function(){var t,t,t,t=j.Commands.TI(this.Mf.name()),t=this.tT[t],t=t&&t.floatingObjectChanges;return!!(t&&0<O(t))},N.prototype.Dlt=function(t){for(var n,e,i,r,o,a,n,e=this.Mf,i=e.WL,r=0,o=O(t);r<o;r++)if((a=i.ev(t[r]))&&!e._lt(a))return!1;return!0},N.prototype.klt=function(t){return t&&"Slicer"===t.typeName},t.FloatingObjectCopyPasteUndoAction=i=N,e(nt,X=i),nt.prototype.execute=function(){var t,n,e,i,r,o,a,u,s,c,f,l,h,d,v,m,g,p,b,y,w,M,C,S,T,A,I,x,N,l,r,k,D,_,r,E,t=this,n=t.tT,e=n.floatingObjects;if(t.canExecute()){for(i=t.Mf,r=n.fromSheet,i.Ut.startTransaction(),t.X5(i,!0),o=[],a=i.WL,u=n.clipboardFloatingObjectData,void 0===n.ui&&(F(i)&&a.QP().forEach(function(t){t&&t[B]()&&o.push(t)}),n.ui=t.Mf.getActiveRowIndex(),n.Elt=t.Mf.getActiveColumnIndex()),F(i)&&a.QP().forEach(function(t){t&&t[B]()&&t[B](!1)}),s=[],f=c=void 0,d=h=l=Number.MAX_VALUE,v=[],f=O(e),c=0;c<f;c++)m=u.find(e[c]).position(),h=R(h,m.x),d=R(d,m.y),v.push(new j.Point(m.x-h,m.y-d));if(p=g=0,o.length)y=b=l,o.forEach(function(t){var t;t&&(t=t.position(),b=R(b,t.x),y=R(y,t.y))}),g=b<l?b+t.OFFSET:0,p=y<l?y+t.OFFSET:0;else{for(w=0;w<n.ui;w++)p+=i._o(w,3);for(M=0;M<n.Elt;M++)g+=i.Do(M,3)}for(f=O(e),c=0;c<f;c++)s.push(new j.Point(g+(C=v[c]).x,p+C.y));for(S=n.isCutting,T=r.WL,A=[],I=[],f=O(e),c=0;c<f;c++)(N=(x=u.find(e[c])).clone(i)).sheet(i),A.push(N),I.push(x);if(l=!1,r={sheet:i,sheetName:i.name(),objects:A,fromSheet:n.fromSheet,isCutting:n.isCutting,cancel:!1,action:n.isCutting?j.ClipboardActionType.cut:j.ClipboardActionType.copy},i.ki(j.Events.ClipboardPasting,r),!r.cancel){for(c=0;c<f;c++)N=A[c],k=void 0,D=!1,x=I[c],!S||T.ev(e[c])||a.ev(e[c])?(D=N.name()===x.name())&&(_=ot(N),k=t.klt(N)?i.slicers.G1i(N[L]()):a.jlt(_)):k=x.name(),D&&N[L](k),t.klt(N)&&(i.slicers.WB(N),N.width(x.width()),N.height(x.height())),N.isVisible(!0),N.position(s[c]),N[B](!0),a.ZP(N);P(i,n,null,A,!0),r={sheet:i,sheetName:i.name(),objects:A,fromSheet:n.fromSheet,isCutting:n.isCutting,action:n.isCutting?j.ClipboardActionType.cut:j.ClipboardActionType.copy},i.ki(j.Events.ClipboardPasted,r),l=!0}return t.q5(i,!0),n[E=j.Commands.TI(i.name())]=i.Ut.endTransaction(),l||(n.JD=!0),l}return!1},nt.prototype.undo=function(){var t,n,e,t=this;return!!t.canUndo()&&(n=t.Mf,t.X5(n,!0),e=j.Commands.TI(n.name()),n.Ut.undo(t.tT[e]),t.q5(n,!0),!0)},t.ClipboardPasteFloatingObjectUndoAction=V=nt,e(et,q=i),et.prototype.execute=function(){var t,n,e,i,r,o,a,u,s,c,f,f,s,l,t=this,n=!1,e=t.tT,i=e.floatingObjects,r=t.Mf;if(t.canExecute()){for(P(r,e,i),r.Ut.startTransaction(),t.X5(r,!0),o=r.WL,a=O(i),u=0;u<a;u++)(s=o.ev(i[u]))&&((c=s.clone(r)).sheet(r),f=s.position(),c.position(new j.Point(f.x+e.offsetX,f.y+e.offsetY)),c[L](o.jlt()),c[B](!0),s[B](!1),t.klt(c)&&r.slicers&&(f=c,s=r.slicers.G1i(f.columnName()),f[L](s),r.slicers.WB(f)),o.ZP(c));t.q5(r,!0),e[l=j.Commands.TI(r.name())]=r.Ut.endTransaction(),n=!0}return n},et.prototype.undo=function(){var t,n,e,t=this,n=t.Mf;return!!t.canUndo()&&(t.X5(n,!0),e=j.Commands.TI(n.name()),n.Ut.undo(t.tT[e]),t.q5(n,!0),!0)},t.DragCopyFloatingObjectUndoAction=Y=et,j.Commands[r]={canUndo:!1,execute:function(t,n){var t=j.Commands.Tp(t,n);return!!F(t)&&(t.suspendPaint(),t.Olt(),t.cR(),t.resumePaint(),!0)}},j.Commands[d]={canUndo:!1,execute:function(t,n){var t=j.Commands.Tp(t,n);t.isEditing()||(t.suspendPaint(),t.WL.QP().forEach(function(t){t[B](!0)}),t.resumePaint())}},j.Commands[o]={canUndo:!0,execute:function(t,n,e){var i,i,i=j.Commands.Tp(t,n);return e||(n.cmd||(n.cmd=o),n.floatingObjects)||(i=it(i),n.floatingObjects=i),0<O(n.floatingObjects)&&w(t,M,n,e)}},j.Commands[a]={canUndo:!1,execute:function(t,n){var t,e,i,r,o,a,u,s,t=j.Commands.Tp(t,n);if(F(t)){for(t.suspendPaint(),o=r=i=e=void 0,u=(a=t.WL.QP()).length,o=0;o<u;o++){if(s=a[o],i=i||s,e){r=s;break}s&&s[B]()&&(e=s)}return t.Olt(),(r=r||i)&&r[B](!0),t.resumePaint(),!0}return!1}},j.Commands[u]={canUndo:!1,execute:function(t,n){var t,e,i,r,o,a,u,t=j.Commands.Tp(t,n);if(F(t)){for(t.suspendPaint(),r=i=e=void 0,a=(o=t.WL.QP()).length,r=0;r<a;r++)if(u=o[r],(e=e||u)[B]())i=u;else if(u[B]()||(i=u),u[B]())break;return i&&(t.Olt(),i[B](!0)),t.resumePaint(),!0}return!1}},j.Commands[c]={canUndo:!0,execute:function(t,n,e){var i,r,o,a,a,o,u,s,i=!1;return e?i=w(t,M,n,e):(r=j.Commands.Tp(t,n),n.cmd||(n.cmd=c),o=r.uq(),n.floatingObjects||(a=it(r),n.floatingObjects=a,n.fromSheet=o.fromSheet,n.isCutting=o.isCutting),a=n.floatingObjects,s=u=o=void 0,0<O(a)&&(u=a.map(function(t){return r.WL.ev(t)}),o={sheet:r,sheetName:r.name(),objects:u,isCutting:!0,cancel:!1,action:j.ClipboardActionType.cut},r.ki(j.Events.ClipboardChanging,o),o.cancel?n.JD=!0:((s=rt(r,a,!0))&&(r.ieV&&r.ieV(),j.Commands.fI(r.parent)),i=w(t,M,n,e),r.ki(j.Events.ClipboardChanged,{sheet:r,sheetName:r.name(),objects:u})))),i}},j.Commands[s]={canUndo:!1,execute:function(t,n){var e,t,i,r,r,e=j.Commands.Tp(t,n),t=at(e);if(0<O(t)){if(i=t.map(function(t){return e.WL.ev(t)}),r={sheet:e,sheetName:e.name(),objects:i,isCutting:!1,cancel:!1,action:j.ClipboardActionType.copy},e.ki(j.Events.ClipboardChanging,r),!r.cancel)return(r=rt(e,t,!1))&&(e.ieV&&e.ieV(),j.Commands.fI(e.parent)),e.ki(j.Events.ClipboardChanged,{sheet:e,sheetName:e.name(),objects:i}),r;n.JD=!0}return!1}},j.Commands[f]={canUndo:!0,execute:function(t,n,e){var i,r,o,a,u,i=j.Commands.Tp(t,n);return!i.isEditing()&&!!(a=(o=(r=i.uq()).fromSheet)&&o.dP)&&(u=[],a.each(function(t){u.push(t[L]())}),0!==O(u))&&!i.xT&&(e||(n.cmd||(n.cmd=f),n.floatingObjects)||(n.floatingObjects=u,n.fromSheet=o,n.isCutting=r.isCutting),0<O(n.floatingObjects))&&w(t,V,n,e)}},j.Commands[h]={canUndo:!0,execute:function(t,n,e){return w(t,Y,n,e)}},(n=C=C||{})[n.left=0]="left",n[n.up=1]="up",n[n.right=2]="right",n[n.down=3]="down",j.Commands[p]=ut(C.left),j.Commands[m]=ut(C.up),j.Commands[b]=ut(C.right),j.Commands[g]=ut(C.down),j.Commands[v]={canUndo:!0,execute:function(t,n,e){return(0!==n.offsetX||0!==n.offsetY)&&w(t,H,n,e)}},j.Commands[y]={canUndo:!0,execute:function(t,n,e){return w(t,z,n,e)}},j.Commands.Rlt=function(t){var n=j.mt.Qf(),e=!n,n=n;t.register(r,j.Commands[r],27,!1,!1,!1,!1),t.register(d,j.Commands[d],65,e,!1,!1,n),t.register(o,j.Commands[o],46,!1,!1,!1,!1),t.register(G,j.Commands[o],8,!1,!1,!1,!1),t.register(a,j.Commands[a],9,!1,!1,!1,!1),t.register(u,j.Commands[u],9,!1,!0,!1,!1),t.register(c,j.Commands[c],88,e,!1,!1,n),t.register(s,j.Commands[s],67,e,!1,!1,n),t.register(h,j.Commands[h]),t.register(f,j.Commands[f],86,e,!1,!1,n),t.register(v,j.Commands[v]),t.register(m,j.Commands[m],38,!1,!1,!1,!1),t.register(g,j.Commands[g],40,!1,!1,!1,!1),t.register(p,j.Commands[p],37,!1,!1,!1,!1),t.register(b,j.Commands[b],39,!1,!1,!1,!1),t.register(y,j.Commands[y])}},"./dist/plugins/floatingObject/floatingobject-touch.js":function(t,n,e){"use strict";var o,a,e,i,u,r,s;function c(t,n,e){var i,r,e,i=this;i.AZ=new o.IZ(i),i.xZ=new o.NZ(t,"FL_"+n.name,i.AZ,2,200),i.kZ=e,i.DZ=new s(t,n),r=i.DZ,(e=i.xZ)._Z=function(){return n.Blt.isSelected()},e.EZ=function(){return!0},e.jZ=function(t){return r.OZ(t)},e.RZ=function(t){return r.BZ(t)},e.LZ=function(t){return r.FZ(t)},e.PZ=function(t){return r.GZ(t)},e.UZ=function(t){return r.HZ(t)}}function f(t,n){var e=this;e.Llt=n,e.Blt=n.Blt,e.zZ=t,e.YZ=new o.ZZ(n.Mf)}Object.defineProperty(n,"__esModule",{value:!0}),n.FloatingObjectTouchEventHandler=void 0,o=e("Touch"),a=e("Core"),e=e("./dist/plugins/floatingObject/floatingobject.js"),i=a.mt.vi,u=null,c.prototype.oW=function(){var t=this,n=t.kZ;n&&n.aW(t.xZ,!0)},c.prototype.uW=function(){var t=this,n=t.kZ;n&&n.aW(t.xZ,!1)},c.prototype.sW=function(t){return this.AZ.sW()},c.prototype.cW=function(t){return this.AZ.cW()},c.prototype.fW=function(t){return this.AZ.fW()},r=c,f.prototype.WZ=function(t){var t,n,e,t=new o.QZ(t.X,t.Y),n=(0,a.GC$)(this.zZ).offset();return n&&(e=document.body,t.X+=n.left+e.clientLeft||0,t.Y+=n.top+e.clientTop||0),t},f.prototype.OZ=function(t){t.KZ=3},f.prototype.BZ=function(t,n){var e,i,e=this,i=n?t.JZ:e.WZ(t.JZ);e.Llt.gg({target:t.qZ,isTouch:!0,button:0,pageX:i.X,pageY:i.Y,stopPropagation:function(){}}),n||e.YZ.$Z()},f.prototype.FZ=function(t,n){var e,i,t,r,o,e=this,i=n?t.JZ:e.WZ(t.JZ),t=t.nW.tW,r=e.Llt.Mf,o=r.parent;1!==t&&o&&o.options.allowUserZoom&&!n?(r.rt.u9=!1,e.Llt.Flt(),e.YZ.iW(t)):e.Llt.pg({isTouch:!0,button:0,pageX:i.X,pageY:i.Y,stopPropagation:function(){}})},f.prototype.GZ=function(t,n){var e,i,t,r,o,e=this,i=n?t.JZ:e.WZ(t.JZ),t=t.nW.tW,r,o=e.Llt.Mf.parent;1!==t&&o&&o.options.allowUserZoom&&!n?e.YZ.rW(t):this.Llt.bg({isTouch:!0,button:0,pageX:i.X,pageY:i.Y,stopPropagation:function(){}})},f.prototype.HZ=function(t,n){var e,i,n,t,r,o,e=this,n=n?t.JZ:e.WZ(t.JZ),t={e:{JZ:n},r:u};if(f.et(e,"preProcessTapped",t),!t.r)try{(i=e.Llt.Mf).suspendPaint(),e.Blt.isSelected()?(r=i.parent.touchToolStrip,o=100,r.open(n.X,n.Y-100)):(i.Olt(),e.Blt.isSelected(!0),i.ki(a.Events.FloatingElementSelected,{type:"floatingObject"}),a.hi.F1(i)),i.clearSelection()}finally{i.resumePaint()}},s=f,n.FloatingObjectTouchEventHandler=s,(0,a.$e)(s),a.Of.touch&&e.FloatingObjectRender.ch("touch",{init:function(t){var n,e,n=this,e;(n.dW=new r(t,n,n.Mf.parent.kZ)).oW()},dispose:function(){var t=this.dW;t&&t.uW()},preProcessMouseDown:function(t){var n,e,n=t.e,e=this.dW;e&&!n.isTouch&&e.sW(n)&&(i(n),t.r=!0)},preProcessMouseMove:function(t){var n,e,n=t.e,e=this.dW;e&&!n.isTouch&&e.fW(n)&&(i(n),t.r=!0)},preProcessMouseUp:function(t){var n,e,n=t.e,e=this.dW;e&&!n.isTouch&&e.cW(n)&&(i(n),t.r=!0)}})},"./dist/plugins/floatingObject/floatingobject.entry.js":function(t,n,e){"use strict";var i,r,r,i=this&&this.__createBinding||(Object.create?function(t,n,e,i){void 0===i&&(i=e);var r=Object.getOwnPropertyDescriptor(n,e);r&&("get"in r?n.__esModule:!r.writable&&!r.configurable)||(r={enumerable:!0,get:function(){return n[e]}}),Object.defineProperty(t,i,r)}:function(t,n,e,i){t[i=void 0===i?e:i]=n[e]}),r=this&&this.__exportStar||function(t,n){for(var e in t)"default"===e||Object.prototype.hasOwnProperty.call(n,e)||i(n,t,e)};Object.defineProperty(n,"__esModule",{value:!0}),n.Drawing=void 0,r(e("./dist/plugins/floatingObject/picture.js"),n),r(e("./dist/plugins/floatingObject/floatingobject.js"),n),r(e("./dist/plugins/floatingObject/floatingobject-actions.js"),n),r(e("./dist/plugins/floatingObject/floatingobject-touch.js"),n),r(e("./dist/plugins/floatingObject/floatingobject.ns.js"),n),r=e("./dist/plugins/floatingObject/drawing/chart.ns.js"),n.Drawing=r},"./dist/plugins/floatingObject/floatingobject.js":function(B,t,n){"use strict";var M,e,i,f,n,L,F,P,G,U,H,z,V,Y,Z,W,Q,l,r,o,h,D,_,J,K,X,q,$,n,a,tt,i,C,nt,et,it,d,v,rt,c,m,y,g,p,w,S,s,b,T,ot,e,at,ut,st,ct,ft,lt,ht,dt,vt,mt,gt,pt,bt,yt,wt,Mt,Ct,St,u,V,Tt,At,i,A,It,I,xt,Nt,kt,n;function x(){this.j0t={}}function Dt(t,n,e){for(var i=n=n||e,r=1;-1<t.indexOf(i);)i=n+"_"+r,r++;return i}function _t(t){return"string"==typeof t[T.Plt]?t[T.Plt]:t[T.Plt]()}function Et(t,n){var e,i,r,o,a,u,s,t,e=t.Glt;if(e){for(a=o=r=i=void 0,o=e.length,i=0;i<o;i++)if(u=e[i]){for(a=u.length,r=0;r<a;r++)(s=u[r])&&s.L0();u.length=0}e.length=0,t.Glt=y}(t=t.WL)&&!1!==n&&t.L0()}function jt(t,n,e){t.QP().forEach(function(t){t.JO(n,e)})}function Ot(n,e,i){var t,r,o,o=[];for(n.QP().forEach(function(t){Lt(e,-1,e+i-1,n.sheet().getColumnCount(),t)&&(t.dynamicMove()||t.dynamicSize())?o.push(t):t.xP(e,i)}),r=o.length,t=0;t<r;t++)n.VP(o[t].name())}function Rt(t,n,e){t.QP().forEach(function(t){t.qO(n,e)})}function Bt(n,e,i){var t,r,o,o=[];for(n.QP().forEach(function(t){Lt(-1,e,n.sheet().getRowCount(),e+i-1,t)&&(t.dynamicMove()||t.dynamicSize())?o.push(t):t.NP(e,i)}),r=o.length,t=0;t<r;t++)n.VP(o[t].name())}function Lt(t,n,e,i,r){var o,a,u,r,o=r[T.Ult](),a=r[T.Hlt](),u=r[T.zlt](),r=r[T.Vlt]();return t<=o&&n<=a&&u<=e&&r<=i}function Ft(t,r){var o=this;return r=r||{},M.GC$.each(t,function(t,n){var e,i,e=o[n],i=e.call(o);e.isDefault(i)||(r[n]=i)}),r}function Pt(t,e){var i;e&&(i=this,M.GC$.each(t,function(t,n){e[n]!==g&&i[n].call(i,e[n],!1)}))}function Gt(t){var r=t;return function(t,n){var e=this,i=e.sheet();r===T.Ylt&&(e.Zlt=!0),i&&i.zw(),e.onPropertyChanged(r,t,n)}}function Ut(t){var r=t;return function(t,n){var e=this,i=e.sheet();i&&(zt(e),e.Wlt||Qt(e),i.zw()),e.onPropertyChanged(r,t,n)}}function Ht(t){var r=t;return function(t,n){var e=this,i=e.sheet();i&&(hn(e),i.zw()),e.onPropertyChanged(r,t,n)}}function zt(o){var a,t,n,e,i;function r(t,n,e,i){var r=0,t=t.call(o),r=n.call(o,a,0,t);return r+=Vt(e.call(o),i.call(a,t))}(a=o.sheet())&&(t=r(o[T.Ult],Yt,o[T.Qlt],a.getRowHeight),n=r(o[T.Hlt],Zt,o[T.Klt],a.getColumnWidth),e=o.x(),i=o.y(),e===n&&i===t||(o.x(n,!1),o.y(t,!1),o.onPropertyChanged("position",new M.Point(n,t),new M.Point(e,i))))}function Vt(t,n){return 0<n&&n--,s(t,n)}function Yt(t,n,e,i){for(var r,o,r=0,o=n;o<e&&!(i<(r+=t.getRowHeight(o,3)));o++);return r}function Zt(t,n,e,i){for(var r,o,r=0,o=n;o<e&&!(i<(r+=t.getColumnWidth(o,3)));o++);return r}function Wt(o){var t=o.sheet();function n(t,n,e,i,r){var t,n,t=Jt(o,t,n),n=t.index;i.call(o,t.offset,!1),-1===t.offset&&(n+=1,i.call(o,0),n===r)&&(n=r-1),e.call(o,n,!1)}t&&(n(!0,o.y(),o[T.Ult],o[T.Qlt],t.getRowCount()),n(!1,o.x(),o[T.Hlt],o[T.Klt],t.getColumnCount()))}function Qt(r){var t;function n(t,n,e,i){var t=Jt(r,t,n);e.call(r,t.index,!1),i.call(r,t.offset,!1)}r.sheet()&&(n(!0,r.y()+r[T.Jlt](),r[T.zlt],r[T.Xlt]),n(!1,r.x()+r[T.qlt](),r[T.Vlt],r[T.$lt]))}function Jt(t,n,e){for(var i,r,o,a,u,s,i=0,r=0,o=t.sheet(),a=n?o.getRowCount():o.getColumnCount(),u=0;u<a;u++){if(0<(r=(i+=s=n?o.getRowHeight(u,3):o.getColumnWidth(u,3))-e)){r=0<r?s-r:-1;break}if(0===r){r=0,u+=1;break}}return a<=u&&(u=a-1,r=n?o.getRowHeight(u,3):o.getColumnWidth(u,3)),{offset:r,index:u}}function Kt(n,t){var e,t,e=new f.ColorFormat({DrawingType:0,sheet:function(){return n},nft:function(t){return n.nft(t)},Cft:function(t){return n.Cft(t)}});return e.setColor(n,t),delete(t=e.ToSJSOOModel()).colorFillType,e.DJ=g,t}function Xt(t,n){qt(n,$t(t))}function qt(t,n){t&&(t.style.zIndex=n+"")}function $t(t){var n=t.tht;return n=C(n)?t.nht:n}function tn(t,e){t.tht=e,t.Ti.forEach(function(t){for(var n=t.parentElement;-1===n.className.indexOf(T.eht);)n=n.parentElement;qt(n,e)})}function nn(t,n){C(t.tht)&&(t.nht+=n)}function N(t,n){this.Mf=t,this.iht=n}function en(e){var n=e.sheet();n&&((0,M.GC$)(c.body).bind("scroll"+T.rht,function(){var t=n.parent&&n.parent.getActiveSheet();t&&t.WL&&n.oht(t.ot())}),n.D3(M.Events.ColumnChanged+T.rht,function(t,n){var n=n.propertyName;n!==T.qlt&&n!==T.aht||rn(e)}),n.D3(M.Events.RowChanged+T.rht,function(t,n){var n=n.propertyName;n!==T.Jlt&&n!==T.aht||rn(e)}),n.D3(M.Events.ColumnWidthChanged+T.rht,function(){rn(e)}),n.D3(M.Events.RowHeightChanged+T.rht,function(){rn(e)}))}function rn(t){var n=t.sheet();t.isNeedToUpdateLayout=!0,n.oht(n.ot())}function on(t,n,e){return e&&0<e.width&&0<e.height&&(e.x===t||e.y===n||e.contains(t,n))}function an(t){return t===M.RelationshipConstants.Mc||t===M.RelationshipConstants.Cc||t===M.RelationshipConstants.Sc||t===M.RelationshipConstants.Tc||t===M.RelationshipConstants.Ac||t===M.RelationshipConstants.Ic}function un(t){return t===M.RelationshipConstants.Xr||t===M.RelationshipConstants.bc}function sn(t){return t instanceof Array}function cn(t,n,e,i){var t=t[n].v_,r;C(t)||(r=parseInt(t,10)),i&&(r=o(r)),e[n]=r}function fn(t){var n={};return cn(t,"row",n),cn(t,"col",n),cn(t,"rowOff",n,!0),cn(t,"colOff",n,!0),n}function ln(t){var n,t,n=t.toJSON(),t=t.tht;return isNaN(t)||(n.zIndex=t),n}function k(t){var n=this;n.sheet(t),en(n),n.vst={},n.uht=[]}function hn(u){var s,t,n,e,n;function i(t,n,e,i,r,o){var a,t,n,o,e,a=0,t=t.call(u),n=n.call(u),o=Vt(o.call(u),i.call(s,n));return a=e.call(u,s,t,n),t===n?a=S(0,o-r.call(u)):(0<(e=i.call(s,t,3))&&(a-=Vt(r.call(u),e)),a+=o),a}(s=u.sheet())&&(t=i(u[T.Ult],u[T.zlt],Yt,s.getRowHeight,u[T.Qlt],u[T.Xlt]),(n=i(u[T.Hlt],u[T.Vlt],Zt,s.getColumnWidth,u[T.Klt],u[T.$lt]))<0&&(n=0),t<0&&(t=0),(e=u[T.qlt]())!==n&&(u[T.qlt](n,!1),u.onPropertyChanged(T.qlt,n,e)),(n=u[T.Jlt]())!==t)&&(u[T.Jlt](t,!1),u.onPropertyChanged(T.Jlt,t,n))}function dn(t){return 0<=Tt.indexOf(t)}function vn(t){var n,n,e;if(!it(t)||"string"==typeof t&&""!==t)return!(t===(n=this).name()||(n=n.sheet())&&n.WL.ev(t));throw new Error(a().Exp_FloatingObjectNameEmptyError)}function mn(e){return function(t,n){this.onPropertyChanged(e,t,n)}}function gn(r,o){return function(t,n){var e=this,i=e.sheet();i&&(o&&yn(e),wn(e),Tn(e),i.zw()),e.onPropertyChanged(r,t,n)}}function pn(t,n,e,i){var r,o,a,r=this;r.Wlt=!0,o=t.call(r),a=n.call(r),e<=o?r.dynamicMove()&&(t.call(r,o+i),n.call(r,a+i)):e<a&&r.dynamicSize()&&n.call(r,a+i),r.Wlt=!1}function bn(t,n,e,i,r,o,a){var u,s,c,f,s,u=this;u.Wlt=!0,s=t.call(u),c=e.call(u),r<=s?a<s?u.dynamicMove()&&(t.call(u,s-o),e.call(u,c-o)):a<c&&(s=c-s+1-(f=a-s+1),u.dynamicMove()&&(t.call(u,r),n.call(u,0)),u.dynamicSize())&&e.call(u,r+s-1):r<=c&&(a<c?u.dynamicSize()&&e.call(u,c-o):u.dynamicSize()&&(e.call(u,r),i.call(u,0))),u.Wlt=!1}function yn(t){var n,e,n=Cn(t,t[T.Jlt]()),e=Sn(t,t[T.qlt]());t[T.qlt]()>e&&t[T.qlt](e,!1),t[T.Jlt]()>n&&t[T.Jlt](n,!1)}function wn(t){var n,e,n,e,n=t.x()+t[T.qlt](),e=Sn(t,n);e<n&&t.x(S(0,e-t[T.qlt]()),!1),t.x()<0&&t.x(0,!1),n=t.y()+t[T.Jlt](),(e=Cn(t,n))<n&&t.y(S(0,e-t[T.Jlt]()),!1),t.y()<0&&t.y(0,!1)}function Mn(t){var n,e,n,e;yn(t),wn(t),n=t[T.Ult](),e=t[T.Hlt](),(C(n)||C(e)?Wt:zt)(t),n=t[T.zlt](),e=t[T.Vlt](),(C(n)||C(e)?Qt:hn)(t)}function Cn(t,n){var t,e,t=t.sheet();return t?(e=t.getRowCount(),Yt(t,0,e,n)):T.sht}function Sn(t,n){var t,e,t=t.sheet();return t?(e=t.getColumnCount(),Zt(t,0,e,n)):T.sht}function Tn(t){Wt(t),Qt(t)}function An(t,n,e,i,r,o,a){for(var u,s,c,u=0,s=a?o.getRowHeight:o.getColumnWidth,c=t;c<n;c++)u+=p(s.call(o,c)*r);return u=(u-=p((e||0)*r))+p((i||0)*r)}function In(t,n,e,i){for(var r,o,r=0,o=0;o<t;o++)r+=i?e.getRowHeight(o,3):e.getColumnWidth(o,3);return r+=n}function xn(t){return t&&t.lossless&&t.lossless.isFloatingObject}function Nn(t,n){var e=0;return!1===t&&!1===n?e=2:!1===n&&(e=1),e}function kn(t,n){var e,i,r,o,a,u,s,c,f,l,h,d,v,n,m,g,p,b,y,w,M,C,S,T,A,I,x,N,e=t.getRowCount(),i=t.getColumnCount(),r=n.width(),o=n.height(),a=n.startRow(),u=n.startRowOffset()||0,s=n.startColumn(),c=n.startColumnOffset()||0,f=n.endRow(),l=n.endRowOffset()||0,h=n.endColumn(),d=n.endColumnOffset()||0,v=n.getOriginalWidth(),n=n.getOriginalHeight(),m,g,p=o<n?u:u+(o-n)/2,b=r<v?c:c+(r-v)/2;for(r=Math.min(r,v),o=Math.min(o,n),y=0,w=a,M=p,C=!1;w<e;)if(S=_(t,w,w+1),w++,C||(M-=S),M<0&&!C&&(a=w-1<0?0:w-1,u=S+M,C=!0),o+p<(y+=S)){f=w-1<0?0:w-1,l=S-(y-o-p);break}for(T=0,A=s,I=b,x=!1;A<i;)if(N=D(t,A,A+1),A++,x||(I-=N),I<0&&!x&&(s=A-1<0?0:A-1,c=N+I,x=!0),r+b<(T+=N)){h=A-1<0?0:A-1,d=N-(T-r-b);break}return{width:r,height:o,startRow:a,startRowOffset:u,startColumn:s,startColumnOffset:c,endRow:f,endRowOffset:l,endColumn:h,endColumnOffset:d}}function Dn(t,n){var e,i,r,o,a,u,s,c,f,l,h,d,v,n,m,g,p,b,y,w,M,C,S,T,A,I,x,N,k,e=t.getRowCount(),i=t.getColumnCount(),r=n.width(),o=n.height(),a=n.startRow(),u=n.startRowOffset()||0,s=n.startColumn(),c=n.startColumnOffset()||0,f=n.endRow(),l=n.endRowOffset()||0,h=n.endColumn(),d=n.endColumnOffset()||0,v=n.getOriginalWidth(),n=n.getOriginalHeight(),m=r/o,g=v/n,p={width:r,height:o,startRow:a,startRowOffset:u,startColumn:s,startColumnOffset:c,endRow:f,endRowOffset:l,endColumn:h,endColumnOffset:d},b=0,y=0,w=r,M=o;if(0<o&&0<n&&g<m)b=c+r/2-(w=g*o)/2,o=1/g*(r=w);else{if(!(0<r&&0<v&&1/g<1/m))return p;y=u+o/2-(M=1/g*r)/2,r=g*(o=M)}if(0<b){for(;s<i;)if(C=D(t,s,s+1),s++,(b-=C)<0){s--,c=b+C;break}for(S=0,T=s;T<i;)if(A=D(t,T,T+1),T++,w+c<(S+=A)){d=A-(S-w-c),h=T-1<0?0:T-1;break}}else if(0<y){for(;a<e;)if(I=_(t,a,a+1),a++,(y-=I)<0){a--,u=y+I;break}for(x=0,N=a;N<e;)if(k=_(t,N,N+1),N++,M+u<(x+=k)){l=k-(x-M-u),f=N-1<0?0:N-1;break}}return p.width=r,p.height=o,p.startRow=a,p.startRowOffset=u,p.endRow=f,p.endRowOffset=l,p.startColumn=s,p.startColumnOffset=c,p.endColumn=h,p.endColumnOffset=d,p}function _n(t,n){var e,i,r,o,a,u,s,c,f,l,h,d,v,n,m,g,p,b,y,w,e=t.getRowCount(),i=t.getColumnCount(),r=n.width(),o=n.height(),a=n.startRow(),u=n.startRowOffset()||0,s=n.startColumn(),c=n.startColumnOffset()||0,f=n.endRow(),l=n.endRowOffset()||0,h=n.endColumn(),d=n.endColumnOffset()||0,v=n.getOriginalWidth(),n=n.getOriginalHeight();for(r=Math.min(r,v),o=Math.min(o,n),m=0,g=a;g<e;)if(p=_(t,g,g+1),g++,o+u<(m+=p)){f=g-1<0?0:g-1,l=p-(m-o-u);break}for(b=0,y=s;y<i;)if(w=D(t,y,y+1),y++,r+c<(b+=w)){h=y-1<0?0:y-1,d=w-(b-r-c);break}return{width:r,height:o,startRow:a,startRowOffset:u,startColumn:s,startColumnOffset:c,endRow:f,endRowOffset:l,endColumn:h,endColumnOffset:d}}function En(t){return!t||"hidden"===t}function jn(t){switch(t){case"dotted":return"dot";case"dashed":return"dash";case"double":return"dbl"}return"solid"}function On(t){var n=1e5;return{l:parseInt(1e5*(t.l||0),10),t:parseInt(1e5*(t.t||0),10),r:parseInt(1e5*(t.r||0),10),b:parseInt(1e5*(t.b||0),10)}}function Rn(t){return 6e4*t}function E(t,n,e,i,r){var o=this;o.cht={startRowOffset:g,startColumnOffset:g,endRowOffset:g,endColumnOffset:g},o.typeName="0",o.iht="0",o.name(t),o.x(n||0,!1),o.y(e||0,!1),o[T.qlt](i||0,!1),o[T.Jlt](r||0,!1),o.Ti=[],o.Zlt=!1,o.nht=T.fht,o.Wlt=!1}function Bn(t,n,e){var i=t.lht,r,o,a,u;switch(n){case vt:r=s(i[T.hht]+i[T.dht],e.x),o=s(i[T.vht]+i[T.mht],e.y),a=b(e.x-i[T.hht]-i[T.dht]),u=b(e.y-i[T.vht]-i[T.mht]);break;case mt:r=i[T.hht],o=s(i[T.vht]+i[T.mht],e.y),a=i[T.dht],u=b(e.y-i[T.vht]-i[T.mht]);break;case gt:r=s(i[T.hht],e.x),o=s(i[T.vht]+i[T.mht],e.y),a=b(e.x-i[T.hht]),u=b(e.y-i[T.vht]-i[T.mht]);break;case pt:r=s(i[T.hht]+i[T.dht],e.x),o=i[T.vht],a=b(e.x-i[T.hht]-i[T.dht]),u=i[T.mht];break;case bt:r=s(i[T.hht],e.x),o=i[T.vht],a=b(e.x-i[T.hht]),u=i[T.mht];break;case yt:r=s(i[T.hht]+i[T.dht],e.x),o=s(i[T.vht],e.y),a=b(e.x-i[T.hht]-i[T.dht]),u=b(e.y-i[T.vht]);break;case wt:r=i[T.hht],o=s(i[T.vht],e.y),a=i[T.dht],u=b(e.y-i[T.vht]);break;case Mt:r=s(i[T.hht],e.x),o=s(i[T.vht],e.y),a=b(e.x-i[T.hht]),u=b(e.y-i[T.vht])}return new M.Rect(r,o,a,u)}function Ln(t){var t,n,t=(0,M.GC$)(t),n=t.position();return new M.Rect(n.left,n.top,t[T.qlt](),t[T.Jlt]())}function Fn(t,n,e,i,r,o){(0,M.GC$)(t).css([T.ght,T.pht,T.qlt,T.Jlt],[[i-1],[e-1],r,o]).addClass(T.bht).appendTo(n)}function Pn(t,n){var t;return t.GY?(t={inMoving:!1},n||(t.inMoving=!0),t):y}function Gn(t){var t,n,e,i,r,o,a,u,s,c,f,l,h,t,d,v,m,t,g,p,b,o,t=t,n=t.Mf,e=t.AW,i=t.IW,r=n.frozenTrailingRowCount(),o=n.frozenTrailingColumnCount(),a=n.Fi(),u=a.c9(e,i),t=t.Blt,d=t[T.Ult](),v=t[T.Hlt](),m=t[T.zlt](),t=t[T.Vlt](),g=n.frozenRowCount(),p=n.frozenColumnCount(),b=n.getRowCount(3)-r-1,o=n.getColumnCount(3)-o-1;return e===T.yht?(0<g&&(s=n.getViewportTopRow(e),d<g||s===g)&&(u.y-=a.L6,u[T.Jlt]+=a.L6),0<r&&(c=n.getViewportBottomRow(e),b<m)&&c===b&&(u[T.Jlt]+=a.Iy)):e===T.yht-1?((s=n.getViewportTopRow(e+1))<=m||s===g)&&(h=a.c9(e+1,i),u[T.Jlt]+=h[T.Jlt]):e===T.yht+1&&(d<=(c=n.getViewportBottomRow(e-1))||c===b)&&(h=a.c9(e-1,i),u.y=h.y,u[T.Jlt]+=h[T.Jlt]),i===T.yht?(0<p&&(f=n.getViewportLeftColumn(i),v<p||f===p)&&(u.x-=a.F6,u[T.qlt]+=a.F6),0<n.frozenTrailingColumnCount()&&(l=n.getViewportRightColumn(i),o<t||l===o)&&(u[T.qlt]+=a.zy)):i===T.yht-1?((f=n.getViewportLeftColumn(i+1))<=t||f===p)&&(h=a.c9(e,i+1),u[T.qlt]+=h[T.qlt]):i===T.yht+1&&(v<=(l=n.getViewportRightColumn(i-1))||l===o)&&(h=a.c9(e,i-1),u.x=h.x,u[T.qlt]+=h[T.qlt]),u}function Un(t,n,e,i,r){var o=Ln(t);(0,M.GC$)(t).css([T.ght,T.pht,T.qlt,T.Jlt],[o.y+e,o.x+n,o[T.qlt]+i,o[T.Jlt]+r])}function Hn(t){var t,n,e,i,r,o,a,e,u,s,c,f,l,h,d,t=t;if(t.wht)for(h in n=t.fk,e=Gn(t),i=t.Mht,a=void 0,a=Bn(t,o=(r=t.lht).direction,n=new M.Point(n.x-e.x,n.y-e.y)),r.endX=a.x,r.endY=a.y,r.endWidth=a[T.qlt],r.endHeight=a[T.Jlt],e=Ln(i),u=a.y-e.y,Un(i,s=a.x-e.x,u,c=a[T.qlt]-e[T.qlt],f=a[T.Jlt]-e[T.Jlt]),l=t.Cht)m(l,h)&&Un((d=l[h]).moveResizeDiv,s,u,c,f)}function zn(t,n){var t,e,t=t.Mf;t&&!1===(e=t.P_(n))&&M.mt.vi(n)}function Vn(t){var t,n,e,i,r,r,e,o,a,u,t=t,n=t.Mf,e=t.CK;if(e&&(i=v(n,e[T.Sht],n.getViewportTopRow(t.AW),!0),r=v(n,e[T.Tht],n.getViewportLeftColumn(t.IW),!1),r=e[T.Aht]-e[T.hht]+(e[T.Aht]>e[T.hht]?r:-1*r),e=e[T.Iht]-e[T.vht]+(e[T.Iht]>e[T.vht]?i:-1*i),0!==r||0!==e)){for(u in(o=[]).push(t.Blt.name()),a=t.Cht)m(a,u)&&o.push(u);n.Qy().execute({cmd:"dragCopyFloatingObjects",sheetName:n.name(),floatingObjects:o,offsetX:r,offsetY:e})}}function Yn(t){var t,n,e,i,r,o,a,r,o,u,r,o,s,c,f,t=t,n=t.Mf,e=t.CK,i=n.zoom();if(e){for(f in r=e[T.Sht],o=n.getViewportTopRow(t.AW),a=v(n,r,o,!0),(o<r||r===o&&e[T.Iht]<e[T.vht])&&(a*=-1),r=e[T.Tht],o=n.getViewportLeftColumn(t.IW),u=v(n,r,o,!1),(o<r||r===o&&e[T.Aht]<e[T.hht])&&(u*=-1),r=e[T.Aht]-e[T.hht]+u,o=e[T.Iht]-e[T.vht]+a,r/=i,o/=i,(s=[]).push(t.Blt.name()),c=t.Cht)m(c,f)&&s.push(f);n.Qy().execute({cmd:"moveFloatingObjects",sheetName:n.name(),floatingObjects:s,offsetX:r,offsetY:o})}}function Zn(t,n,e,i){var t=v(t,n,e,i);return e<n?-t:t}function Wn(t){var t,n,e,i,r,o,a,u,s,a,r,c,f,l,t=t,n=t.Mf,e=n.zoom(),i=t.Blt,r=t.lht;if(r){for(l in o=Zn(n,r[T.Sht],n.getViewportTopRow(t.AW),!0),a=Zn(n,r[T.Tht],n.getViewportLeftColumn(t.IW),!1),s=u=void 0,u=r[T.Aht]!==r[T.hht]?r[T.Aht]-r[T.hht]+a:0,u/=e,s=r[T.Iht]!==r[T.vht]?r[T.Iht]-r[T.vht]+o:0,s/=e,a=(r.endWidth+a)/e-i[T.qlt](),r=(r.endHeight+o)/e-i[T.Jlt](),(c=[]).push(i.name()),f=t.Cht)m(f,l)&&c.push(l);n.Qy().execute({cmd:"resizeFloatingObjects",sheetName:n.name(),floatingObjects:c,offsetX:u,offsetY:s,offsetWidth:a,offsetHeight:r})}}function Qn(t,n,e){var t,i,r,o,a,u,s,t=t,i=t.Mht;if(i)for(u in Jn(i,r=e.x-n.x,o=e.y-n.y),a=t.Cht)m(a,u)&&Jn((s=a[u]).moveResizeDiv,r,o)}function Jn(t,n,e){var i,t,i=(0,M.GC$)(t),t=(0,M.GC$)(t).position();i.css([T.ght,T.pht],[t[T.ght]+e,t[T.pht]+n])}function Kn(t){var t,n,e,i,r,o,r,a,u,s,c,f,e,t=t,n=t.CK;n&&(e=t.Blt,o=(r=(i=t.Mf).Fi())[T.qlt]-r.XC-r.BA,r=r[T.Jlt]-r.qC-r.LA,a=n.startX,u=n.startY,s=e.position().x,c=e.position().y,f=e[T.qlt](),e=e[T.Jlt](),s+n.endX-a<0&&(n.endX=a-s),c+n.endY-u<0&&(n.endY=u-c),s+f+n.endX-a>o&&(n.endX=o+a-s-f),c+e+n.endY-u>r&&(n.endY=r+u-c-e),n.startTopRow=i.getViewportTopRow(t.AW),n.startLeftColumn=i.getViewportLeftColumn(t.IW))}function Xn(t){var t,n,e,i,r,i,o,t=t,n=t.lht;n&&(r=(i=(e=t.Mf).Fi())[T.qlt]-i.XC-i.BA,i=i[T.Jlt]-i.qC-i.LA,o=(o=new M.Rect(n.endX,n.endY,n.endWidth,n.endHeight)).getIntersect(0,0,r,i),n.endX=o.x,n.endY=o.y,n.endWidth=o[T.qlt],n.endHeight=o[T.Jlt],n.startTopRow=e.getViewportTopRow(t.AW),n.startLeftColumn=e.getViewportLeftColumn(t.IW))}function qn(t){var n,e,i,t,r,o,a,u,s,c,f,n=d(T.xht),e=(0,M.GC$)(n),i=t;return e.addClass(T.eht).addClass(T.Nht).attr(T.kht,T.Dht).css(T._ht,T.fht).bind("mousedown",function(t){i.gg(t)}).bind(T.Eht,function(t){i.pg(t)}).bind(T.jht,function(t){i.bg(t)}),n.addEventListener("mousewheel",function(t){zn(i,t)},!1),n.addEventListener("DOMMouseScroll",function(t){zn(i,t)},!1),t=(0,M.GC$)(d(T.xht)).addClass(T.Oht+" "+T.Rht+" "+T.Bht+" "+T.Lht),r=(0,M.GC$)(d(T.xht)).addClass(T.Oht+" "+T.Rht+" "+T.Fht+" "+T.Lht),o=(0,M.GC$)(d(T.xht)).addClass(T.Oht+" "+T.Rht+" "+T.Pht+" "+T.Lht),a=(0,M.GC$)(d(T.xht)).addClass(T.Oht+" "+T.Ght+" "+T.Bht+" "+T.Lht),u=(0,M.GC$)(d(T.xht)).addClass(T.Oht+" "+T.Ght+" "+T.Pht+" "+T.Lht),s=(0,M.GC$)(d(T.xht)).addClass(T.Oht+" "+T.Uht+" "+T.Bht+" "+T.Lht),c=(0,M.GC$)(d(T.xht)).addClass(T.Oht+" "+T.Uht+" "+T.Fht+" "+T.Lht),f=(0,M.GC$)(d(T.xht)).addClass(T.Oht+" "+T.Uht+" "+T.Pht+" "+T.Lht),e.append(t).append(r).append(o).append(a).append(u).append(s).append(c).append(f),I.et(i,"init",n),n}function $n(t){var e,i,t,n,r,o,a,u,s,c,e=t,i=e.Hht&&e.GY;if(i&&!e.Mht){for(s in t=e.zht=d(T.xht),e.Mht=d(T.xht),e.Cht={},e.Yht.Vht.each(function(t){var n,t,n=t.Blt;n&&n.name()!==e.Blt.name()&&n.isSelected()&&!e.Cht[n.name()]&&(t=t.GY,e.Cht[n.name()]={offsetX:t.x-i.x,offsetY:t.y-i.y,height:t[T.Jlt],width:t[T.qlt],moveResizeDiv:d(T.xht)})}),n=Gn(e),(r=(0,M.GC$)(t)).css([T._ht,T.ght,T.pht,T.qlt,T.Jlt,T.Zht],[T.Wht,n.y,n.x,n[T.qlt],n[T.Jlt],"rgba(255,255,255,0.01)"]).addClass(T.Qht).bind(T.Eht,function(t){e.pg(t)}).bind(T.jht,function(t){e.bg(t)}),o=i.y-n.y,a=i.x-n.x,Fn(e.Mht,t,a,o,i[T.qlt],i[T.Jlt]),u=e.Cht)m(u,s)&&Fn((c=u[s]).moveResizeDiv,e.zht,a+c.offsetX,o+c.offsetY,c[T.qlt],c[T.Jlt]);e.fF&&(0,M.GC$)(e.fF).append(e.zht)}}function te(t){var n=t;n.p4||((0,M.GC$)(c).bind(T.Eht+T.rht,function(t){n.pg(t)}).bind(T.jht+T.rht,function(t){n.bg(t)}),n.p4=!0)}function ne(t){var t=t;t.p4&&(t.p4=!1,M.GC$)(c).unbind(T.Eht+T.rht).unbind(T.jht+T.rht)}function ee(t,n){var e,n,t,i,r,o,i,a,u,s,c,f,l,o,h,d,r,e;(0,M.GC$)(T.Kht,n).removeClass(T.Jht),t=Ln((n=t).Hht),i=n.Xht,r=n.Blt,n.qht&&(i=n.qht),o=I.$ht,a=(i=Ln(i)).x,u=i.y,s=t[T.Jlt]-i.y-i[T.Jlt],c=t[T.qlt]-i.x-i[T.qlt],f=0,l=o+2,o=w(o/2+1),"1"===r.typeName&&(h=r.borderWidth(),o<=(h=dn(d=r.borderStyle())?h:0)&&(f=h-o),s=t[T.Jlt]-u-i[T.Jlt]-h,c=t[T.qlt]-a-i[T.qlt]-h,a+=h,u+=h),r=[],0<a?(j(n,0<u,at,f,f,g,g,"nw"+T.tdt,vt,r),j(n,0<t[T.Jlt],ut,f,(i[T.Jlt]-l)/2+u,g,g,"w"+T.tdt,pt,r),j(n,0<s,st,f,g,g,f,"ne"+T.tdt,yt,r)):(O(n,at),O(n,ut),O(n,st)),j(n,0<u,ct,(i[T.qlt]-l)/2+a,f,g,g,"n"+T.tdt,mt,r),j(n,0<s,ft,(i[T.qlt]-l)/2+a,g,g,f,"n"+T.tdt,wt,r),0<c?(j(n,0<u,lt,g,f,f,g,"sw"+T.tdt,gt,r),j(n,0<t[T.Jlt],ht,g,(i[T.Jlt]-l)/2+u,f,g,"w"+T.tdt,bt,r),j(n,0<s,dt,g,g,f,f,"se"+T.tdt,Mt,r)):(O(n,lt),O(n,ht),O(n,dt)),n.ndt=!0,n.edt=r}function j(t,n,e,i,r,o,a,u,s,c){var t,f,l,n,f,e,t,t=t,f=(0,M.GC$)(e,t.Hht),l=I.$ht;n?f.css([T.pht,T.ght,T.idt,T.rdt,T.qlt,T.Jlt,T.odt],[i,r,o,a,l,l,u]).addClass(T.adt).attr("resizeDirection",s):O(t,e),c&&(n=(0,M.GC$)(t.Hht),e=f=0,C(i)||(f=i),C(r)||(e=r),C(o)||(f=n.width()-o-l),C(a)||(e=n.height()-a-l),t=new M.Rect(f,e,l,l),c.push({rect:t,cursor:u,direction:s}))}function O(t,n){(0,M.GC$)(n,t.Hht).removeClass(T.adt).addClass(T.Jht)}function ie(t,n){(0,M.GC$)(T.Kht,n).removeClass(T.adt).addClass(T.Jht),t.ndt=!1}function re(t){var t,n,e,i,r,o,a,t,e,r,a,n,u,s,c,f,l,t=t,n=t.Blt,e=n.udt||n.src(),i=n.pictureStretch(),r=M.Pf.vl(n.sheet(),n.backColor()),o=t.Xht;e&&o&&(a=(0,M.GC$)(o),t.sdt!==e&&(t.sdt=e,a.css([T.Zht+"-image",T.Zht+"-repeat"],["url('"+e+"')","no-repeat"])),a.css(T.Zht+"-color",r),i!==y)&&i!==g&&n.cdt&&(t=n.getOriginalWidth(),e=n.getOriginalHeight(),r=a[T.qlt](),a=a[T.Jlt](),u=void 0,(n=n.fdt)&&(s=r/n.width,c=a/n.height,u={position:-(f=s*n.left)+"px "+-(l=c*n.top)+"px",size:s+"px "+c+"px"}),M.mt.Wf(o,r,a,t,e,i,u))}function oe(t,n,e){var i,t,r,o,a,u,s,c,t,s,f,l,i=t.qht,t=t.Blt,r=t.borderWidth(),o=t.borderStyle(),a=M.Pf.vl(t.sheet(),t.borderColor()),u=t.borderRadius(),s=0,c=w(I.$ht/2+1),l=f=s=t=s=(r=dn(o)&&!t.noFill()?r:0)<c?c-r:s;c=S(r,c),n.x<0?t+=n.x-c:(n.x<c?t+=n.x-c:t+=0,l=e[T.qlt]-t-n[T.qlt]-2-2*r),n.y<0?s+=n.y-c:(n.y<c?s+=n.y-c:s+=0,f=e[T.Jlt]-s-n[T.Jlt]-2-2*r),(0,M.GC$)(i).css([T.ldt,T.pht,T.ght,T.rdt,T.idt,T.hdt+"-width",T.hdt+"-style",T.hdt+"-color",T.hdt+"-radius"],[T.ddt,t,s,f,l,r,o,a,u])}function R(t,n){this.sdt="";var e=this;e.Blt=t,e.name=t?t.name():"",e.Mf=n,e.p4=!1,e.ndt=!1}function ae(t){t.QP().forEach(function(t){(t.dynamicMove()?zt:Wt)(t),(t.dynamicSize()?hn:Qt)(t)})}function ue(t,n,e){var t,i,r,o,a,u,s,c,r,c,r,t,f,t=t.Mf,i=t.Fi(),r=t.yw(e),o=0,a=0,u=0,s=0;return r&&0<r.length&&(c=r[0],r=r[r.length-1],o=c.x,u=r.x+r[T.qlt]-o,0===e)&&o+u>i.x+i.width&&(u=i.x+i.width-o),(c=t.dw(n))&&0<c.length&&(r=c[0],t=c[c.length-1],a=r.y,s=t.y+t[T.Jlt]-a,0===n)&&a+s>i.y+i.height&&(s=i.y+i.height-a),(f=i.c9(n,e)).getIntersect(o,a,u,s)||new M.Rect(0,0,0,0)}function se(t,n,e,d){var i,v,m,t,g,p,b,y,w,M,C,S,i,v=t.Mf,m=new rt,t=v.WL;return t.isNeedToUpdateLayout&&(ae(t),t.isNeedToUpdateLayout=!1),g=v.Fi(),p=v.Jt,b=v.yw(e),y=v.dw(n),b.length<=0||y.length<=0||(w=b[0],M=b[b.length-1],C=y[0],S=y[y.length-1],t.QP().forEach(function(t){var n,e,i,r,o,a,u,u,s,c,u,f,l,u,h;if(t&&t.isVisible()){if(e=n=void 0,i=t[T.Ult](),r=t[T.Hlt](),o=t[T.zlt](),a=t[T.Vlt](),t.fixedPosition())n=(u=t.position()).x*d+g.b6,e=u.y*d+g.T6;else{if(u=b.findCol(r))n=u.x;else if(r<w.col)for(n=w.x,s=w.col-1;r<=s;s--)n-=p.Kt(s);else for(n=M.x+M[T.qlt],c=M.col+1;c<=r;c++)n+=p.Kt(c);if(n+=Vt(t[T.Klt](),v.getColumnWidth(r))*d,u=y.findRow(i))e=u.y;else if(i<C.row)for(e=C.y,f=C.row-1;i<=f;f--)e-=p.Gt(f);else for(e=S.y+S[T.Jlt],l=S.row+1;l<=i;l++)e+=p.Gt(l);e+=Vt(t[T.Qlt](),v.getRowHeight(i))*d}h=u=void 0,u=t.vdt(d),h=t.mdt(d),ce(v,i,r,o,a)||m.push({name:t.name(),x:n,y:e,width:u,height:h})}})),m}function ce(t,n,e,i,r){var o,a,u;if(t.rowOutlines)for(o=!0,u=n;u<=i;u++)if(!t.rowOutlines.isCollapsed(u)){o=!1;break}if(t.columnOutlines)for(a=!0,u=e;u<=r;u++)if(!t.columnOutlines.isCollapsed(u)){a=!1;break}return o||a}function fe(t){var n,e,i,r;if(t)for(e=(n=t.QP()).length,i=0;i<e;i++)if((r=n[i]).isSelected())return 1}function le(t){var n,t,n=t.target;return!(!t.target||"input"!==(t=n.tagName.toLowerCase())&&"textarea"!==t)}function he(t){this.Mf=t,this.Vht=new rt}function de(t,n,e){var i,r,o,o,o,i=void 0;return t&&(r=void 0,o=t.floatingObjectType,"0"===(o=M.mt.T1(o)?o+"":t.typeName)?i=new A:"1"===o?i=A.gdt():(r=(0,M.getTypeFromString)(o))&&(i=new r(e)),i)&&(i.fromJSON(t,n),o=t.zIndex,C(o)||(i.tht=o)),i}function ve(t){var n=!0,e=!0;return 2===t?e=n=!1:1===t&&(e=!1),{dynamicMove:n,dynamicSize:e}}function me(t,n){var e,i,e="png",i=t.lastIndexOf(".");return"svg"===(e=-1!==i?t.substr(i+1):e)&&(e="svg+xml"),n?"data:image/"+e+";base64,"+n:y}function ge(t){var n,e,i,t,r,i,o,a,u,t,e,s,c,f,l,h,d,n,e,r,v,n=Math.PI/180/6e4;if(t)return e=t.rot||0,i=t.off,t=t.ext,r=i.x,i=i.y,u=(o=t.cx)/2,t=(a=t.cy)/2,e=e*n,s=Math.sin(e),c=Math.cos(e),f=r+u,l=i+t,h=[],d=[],[{x:-u,y:-t},{x:u,y:-t},{x:-u,y:t},{x:u,y:t}].forEach(function(t){var t=pe(t,s,c);h.push(t.x+f),d.push(t.y+l)}),n=Math.min.apply(null,h),e=Math.max.apply(null,h),{x:n,y:r=Math.min.apply(null,d),width:e-n,height:(v=Math.max.apply(null,d))-r}}function pe(t,n,e){return{x:t.x*e-t.y*n,y:t.x*n+t.y*e}}Object.defineProperty(t,"__esModule",{value:!0}),t.FloatingObjectRender=t.FloatingObject=t.isFloatingObjectPicture=t.FloatingObjectModel=t.FloatingObjectCollection=t.propertyRefreshCallback=t.fromJsonFn=t.toJsonFn=t.Nlt=void 0,M=n("Core"),e=n("Common"),i=n("./dist/plugins/floatingObject/floatingobject.ns.js"),f=n("./dist/plugins/floatingObject/drawing/chart.ns.js"),n=n("./dist/plugins/floatingObject/drawing/common.js"),L=M.UsedRangeUtil.vh,F=M.XFileConstants.Ki,P=M.XFileConstants.au,G=M.mt.h1,U=M.Util.Ir,H=M.Util.Er,z=M.Util.jr,x.prototype.push=function(t){this.j0t[_t(t)]=t},x.prototype.remove=function(t){delete this.j0t[t]},x.prototype.find=function(t){return this.j0t[t]},x.prototype.empty=function(){delete this.j0t,this.j0t={}},x.prototype.each=function(t){var n,e,n=this.j0t;for(e in n)n.hasOwnProperty(e)&&t(n[e])},x.prototype.isEmpty=function(){var t,n,t=this.j0t;for(n in t)if(t.hasOwnProperty(n))return!1;return!0},t.Nlt=V=x,Y=M.mt.xr,Z=M.mt.s1,W=M.mt.go,Q=M.mt.c1,l=M.NodeHelper.ur,r=M.NodeHelper.sr,o=M.ExcelHelper.emuToPixles,h=M.ExcelHelper.pixelToEMU,D=M.ExcelHelper.getActualColumnWidth,_=M.ExcelHelper.getActualRowHeight,J=M.Util.ho,K=M.Util.Sr,X=M.Util.wr,q=n.ChartUtility.GetIs2016ChartByChartType,$=M.Util.To,n=new e.Common.ResourceManager(i.SR,"FloatingObjects"),a=n.getResource.bind(n),tt=e.Common.lt,i=e.Common.kh,C=tt.ht,nt=tt.dt,et=M.mt.p0,it=M.mt.T1,d=M.mt.En,v=M.mt.w0,rt=V,c=document,m=i,y=null,g=void 0,p=Math.ceil,w=Math.floor,S=Math.max,s=Math.min,b=Math.abs,T={xht:"div",Dht:"on",_ht:"z-index",pdt:"move",kht:"unselectable",yht:1,hdt:"border",sht:9007199254740992,bdt:"floatingObjects",rht:".gcFloatingObject",Plt:"name",ydt:"scroll",_X:"x",_Y:"y",qlt:"width",Jlt:"height",Ult:"startRow",Qlt:"startRowOffset",Hlt:"startColumn",Klt:"startColumnOffset",zlt:"endRow",Xlt:"endRowOffset",Vlt:"endColumn",$lt:"endColumnOffset",Cdt:"isSelected",Sdt:"isLocked",aht:"isVisible",Tdt:"canPrint",Adt:"dynamicSize",Idt:"dynamicMove",xdt:"fixedPosition",Ndt:"allowResize",kdt:"allowMove",fht:700,Wht:701,ldt:"position",ddt:"absolute",Zht:"background",Nht:"gc-no-user-select",Ddt:"gc-floatingobject-selected",_dt:"gc-floatingobject-unselected",adt:"gc-floatingobject-resize-indicator-select",Jht:"gc-floatingobject-resize-indicator-unSelect",Edt:"gc-floatingobject-content-container",eht:"gc-floatingobject-container",Qht:"gc-floatingobject-moving-container",bht:"gc-floatingobject-moving-div",Kht:".gc-floatingobject-resize-indicator",Oht:"gc-floatingobject-resize-indicator",Lht:"gc-floatingobject-absolute",Rht:"gc-floatingobject-top",Ght:"gc-floatingobject-middle",Uht:"gcfloatingobject-bottom",Bht:"gc-floatingobject-left",Fht:"gc-floatingobject-center",Pht:"gc-floatingobject-right",Ylt:"content",jdt:"gc-no-user-select",Odt:"100%",Rdt:"gc-floatingobject-background-cover",Bdt:".fos",pht:"left",Ldt:"center",idt:"right",ght:"top",Fdt:"middle",rdt:"bottom",tdt:"-resize",odt:"cursor",Eht:"mousemove",jht:"mouseup",hht:"startX",vht:"startY",dht:"startWidth",mht:"startHeight",Aht:"endX",Iht:"endY",Sht:"startTopRow",Tht:"startLeftColumn"},(n=ot=ot||{})[n.twoCell=0]="twoCell",n[n.oneCell=1]="oneCell",n[n.absolute=2]="absolute",e=T.xht+"."+T.Oht,at=e+"."+T.Rht+"."+T.Bht,ut=e+"."+T.Ght+"."+T.Bht,st=e+"."+T.Uht+"."+T.Bht,ct=e+"."+T.Rht+"."+T.Fht,ft=e+"."+T.Uht+"."+T.Fht,lt=e+"."+T.Rht+"."+T.Pht,ht=e+"."+T.Ght+"."+T.Pht,dt=e+"."+T.Uht+"."+T.Pht,vt=T.ght+T.pht,mt=T.ght+T.Ldt,gt=T.ght+T.idt,pt=T.Fdt+T.pht,bt=T.Fdt+T.idt,yt=T.rdt+T.pht,wt=T.rdt+T.Ldt,Mt=T.rdt+T.idt,(Ct=function(){var t=this;t.Olt=function(){var t=this.WL;t&&t.QP().forEach(function(t){t.isSelected(!1)})},t.kct=function(){var t,n=this.WL;n&&(n.isNeedToUpdateLayout=!0)},t.uq=function(){var t=this,n=t.parent,e=t.aM,n=n&&n.aM,e;return e=e||(t.aM=n||{fromSheet:y,isCutting:!1})},t.AT=function(){var t,n=this.uq(),e=n&&n.fromSheet;e&&(e.dP=y),n.fromSheet=y,n.isCutting=!1},t.Pdt=function(t){var n=this.options;return!n.isProtected||!t.isLocked()||n.protectionOptions.allowEditObjects},t._lt=function(t){var n=this.options;return!n.isProtected||!t.isLocked()||n.protectionOptions.allowEditObjects},t.isPasteFloatingObject=function(){var t,n,e,t,n=this.uq().fromSheet,e=this.dP;return(e=!e&&n?n.dP:e)&&!e.isEmpty()},t.Gdt=function(t,n){var e,i,r,e=this;return e.Glt||(e.Glt=[]),(i=e.Glt[t])||(e.Glt[t]=[]),(r=e.Glt[t][n])||(e.Glt[t][n]=new xt(e)),r=e.Glt[t][n]},t.oht=function(t,n){var e,i,r,o,a,u,s,e,i=this;if(!i.D_&&i.WL&&i.Dn&&i.Dn.J())for(r=i.Fi(),o=void 0,n!==y&&void 0!==n||(n=i.zoom()),a=0;a<=2;a++)for(u=0;u<=2;u++)(o=r.c9(a,u))&&(s=i.Gdt(a,u))&&s.Dn(a,u,n)}}).call(M.Worksheet.prototype),t.toJsonFn=Ft,t.fromJsonFn=Pt,t.propertyRefreshCallback=Gt,N.prototype.L0=function(){this.Mf=y},N.prototype.getUsedRange=function(){var t,n,e,i,r,o,a,u,s,c,t,n=this.all(),e={};if(n)for(a=o=r=i=void 0,u=0,s=n;u<s.length;u++)i=(c=s[u]).startRow(),r=c.startColumn(),o=c.endRow(),a=c.endColumn(),L(e,{minRow:i,minCol:r,maxRow:o,maxCol:a});return e},N.prototype.add=function(t,n,e,i,r,o,a,u){var s=this,c;return"1"===s.iht?c=A.gdt(t,n,e,i,r,o):"0"===s.iht&&(c=t),s.Mf.WL.ZP(c),c},N.prototype.get=function(t){return this.Mf.WL.ev(t)},N.prototype.remove=function(t){this.Mf.WL.VP(t)},N.prototype.clear=function(){return this.Mf.WL.d5(this.iht)},N.prototype.all=function(){return this.Mf.WL.QP(this.iht)},N.prototype.zIndex=function(t,n){return this.Mf.WL.tht(t,n)},N.prototype.Udt=function(i,r,o){this.all().forEach(function(t){var n=o?t.startRow():t.startColumn(),e=o?t.endRow():t.endColumn();r<n||e<i||!t.dynamicSize()||hn(t),zt(t)})},St=N,t.FloatingObjectCollection=St,k.prototype.Hdt=function(n){this.QP().forEach(function(t){nn(t,n)})},k.prototype.ZP=function(t,n){var e,i,r,e=this,i=e.sheet();if(i.suspendPaint(),!(r=t.name()))throw i.resumePaint(),new Error(a().Exp_FloatingObjectNameEmptyError);if(e.vst[r]){if(!n)throw i.resumePaint(),new Error(a().Exp_FloatingObjectHasSameNameError);r=e.jlt(r+"__"),t.name(r)}i.Ut.zdt(),e.Hdt(-1),t.sheet(i),e.vst[r]=t,e.uht.push(r),i.Vdt(t),i.Ut.zdt(!0),i.resumePaint()},k.prototype.ev=function(t){return this.vst[t]},k.prototype.VP=function(t,n){var e,i,r,n,o,e=this;return!!t&&(i=e.sheet(),(r=e.ev(t))?(i.Ut.zdt(),i.suspendPaint(),n?(n={sheet:i,sheetName:i.name(),floatingObject:r,cancel:!1},i.ki(M.Events.FloatingObjectRemoving,n),!1===n.cancel&&(delete e.vst[t],-1<(o=e.uht.indexOf(t))&&e.uht.splice(o),i.ki(M.Events.FloatingObjectRemoved,{sheet:i,sheetName:i.name(),floatingObject:r}))):(delete e.vst[t],-1<(o=e.uht.indexOf(t))&&e.uht.splice(o)),i.Ut.zdt(!0),i.resumePaint(),!0):void 0)},k.prototype.Ydt=function(t,n){var e,i,r,o,e=this,i=e.sheet();if(i.suspendPaint(),!n)throw new Error(a().Exp_FloatingObjectNameEmptyError);if(e.vst[n])throw new Error(a().Exp_FloatingObjectHasSameNameError);r=e.vst[t],delete e.vst[t],e.vst[n]=r,-1<(o=e.uht.indexOf(t))&&e.uht.splice(o),e.uht.push(n),r.onNameChanged&&r.onNameChanged(t,n),i.resumePaint()},k.prototype.d5=function(e){var i=this,t=i.sheet();t.suspendPaint(),M.GC$.each(this.vst,function(t,n){e&&e!==n.iht||i.VP(n.name())}),i.uht=[],t.resumePaint()},k.prototype.QP=function(e){var i=[];return M.GC$.each(this.vst,function(t,n){e&&e!==n.iht||i.push(n)}),i},k.prototype.tht=function(t,n){var e,t,e=isNaN(n),t=this.ev(t);if(t){if(e)return $t(t);tn(t,n)}if(e)return-1},k.prototype.toJSON=function(){var e=[];return this.QP().forEach(function(t){var n,t;t instanceof A&&t.Zdt()&&(n=t.toJSON(),t=t.tht,isNaN(t)||(n.zIndex=t),e.push(n))}),e},k.prototype.wh=function(){this.toJSON()},k.prototype.fromJSON=function(t,n){var e,i,r,o,a,u,u,u,a,u,a,e=this;if(t&&0!==t.length)for(i=0;i<t.length;i++)o=void 0,(r=t[i])&&(a=void 0,u=r.floatingObjectType,"0"===(u=M.mt.T1(u)?u+"":r.typeName)?o=new A:"1"===u?o=A.gdt():(a=(0,M.getTypeFromString)(u))&&(o=new a),o)&&(u=(a=(u=e.sheet())&&u.parent)&&a.Gie,o.fromJSON(r,n,u),e.ZP(o),a=r.zIndex,C(a)||(o.tht=a))},k.prototype.yh=function(t,n,e,i){var r,o,a;t&&0!==t.c_.length&&(o=(r=this).sheet(),a=M.Util.Co(i),t.c_.forEach(function(t){r.Wdt(o,t,e,n,a)}))},k.prototype.Wdt=function(t,n,e,i,r){var o,a;n.twoCellAnchor?(o=n.twoCellAnchor,a=f.ST_AnchorType.twoCellAnchor):n.oneCellAnchor?(o=n.oneCellAnchor,a=f.ST_AnchorType.oneCellAnchor):n.absoluteAnchor&&(o=n.absoluteAnchor,a=f.ST_AnchorType.absoluteAnchor),o&&(o.grpSp?this.Hoe(t,o,e,i,r):this.zoe(t,o,a,e,i,r))},k.prototype.zoe=function(t,n,e,i,r,o){var a,u,r,s,c,o,e,a,s,t,o,a,e,a=this,u={};a.fromBaseDrawingSJSFormat(n,u),(r=K(r.c_,u.Qdt))&&(s=an(r.Type),c=un(r.Type)&&xn(n.pic),s||c)&&(o&&$(t,n,g,i),e===f.ST_AnchorType.twoCellAnchor?a.Kdt(t,n,u):e===f.ST_AnchorType.oneCellAnchor?a.Jdt(t,n,u):e===f.ST_AnchorType.absoluteAnchor?a.Xdt(n,u):e===f.ST_AnchorType.groupShapeAnchor&&a.Voe(n,u),s?(o=(o=r.Target).split("/").pop().slice(0,-4),(e=A._getChartInstance&&A._getChartInstance(t))&&(a=i.charts[o],u.chartSpace=a,u.name=u.name||P,u.lossless=a.lossless,e.yh(u,i),this.ZP(e,!0))):c&&(s=A.gdt&&A.gdt())&&(t=(t=r.Target).split("/").pop(),o=i.media,a=u.name,u.src=me(t,o[t]),a&&(u.name=Dt(this.uht,a)),s.fromJSON(u),this.ZP(s),n.lossless)&&n.lossless.content&&((e=d(T.xht)).innerHTML=n.lossless.content,s.content((0,M.GC$)(e.firstChild)[0])))},k.prototype.Hoe=function(e,t,i,r,o){var a,u,a=this,u=t.grpSp&&t.grpSp.c_||t.c_||[];u.forEach(function(t){var n;"grpSp"===t.n_?(n=u[1].grpSpPr.xfrm,a.updateGroupXfrm(n,t.c_[1].grpSpPr.xfrm),a.Hoe(e,t,i,r,o)):t.graphicFrame&&(a.updateGroupXfrm(u[1].grpSpPr.xfrm,t.graphicFrame.xfrm),a.zoe(e,t,f.ST_AnchorType.groupShapeAnchor,i,r,o))})},k.prototype.convertXfrm=function(t){var n=function(t){return o(r(t),6)};t.chExt&&(t.chExt.cx=n(t.chExt.cx),t.chExt.cy=n(t.chExt.cy)),t.chOff&&(t.chOff.x=n(t.chOff.x),t.chOff.y=n(t.chOff.y)),t.ext.cx=n(t.ext.cx),t.ext.cy=n(t.ext.cy),t.off.x=n(t.off.x),t.off.y=n(t.off.y)},k.prototype.updateGroupXfrm=function(t,n){var e,i,r,o,a,u,s,t,c,f,l,h,d,v;t.hasConvert||(this.convertXfrm(t),t.hasConvert=!0),n.hasConvert||(this.convertXfrm(n),n.hasConvert=!0),e=t.chExt.cx,i=t.chExt.cy,r=t.chOff.x,o=t.chOff.y,a=t.off.x,u=t.off.y,s=t.ext.cx,t=t.ext.cy,c=n.off.x,f=n.off.y,l=n.ext.cx,h=n.ext.cy,n.off.x=a+(d=(c-r)/(e||1)*s),n.off.y=u+(v=(f-o)/(i||1)*t),n.ext.cx=l/(e||1)*s,n.ext.cy=h/(i||1)*t},k.prototype.Kdt=function(t,n,e){var i,r,o,a,n,u,u,o,o=n.editAs||0,a=n.from,n=n.to,u=ve(ot[o]);e.dynamicMove=u.dynamicMove,e.dynamicSize=u.dynamicSize,e.placement=o,a&&(u=fn(a),e.x=D(t,0,u.col)+u.colOff,e.y=_(t,0,u.row)+u.rowOff,e.startRow=u.row,e.startRowOffset=u.rowOff,e.startColumn=u.col,e.startColumnOffset=u.colOff),n&&(o=fn(n),i=D(t,0,o.col)+o.colOff,r=_(t,0,o.row)+o.rowOff,e.endRow=o.row,e.endRowOffset=o.rowOff,e.endColumn=o.col,e.endColumnOffset=o.colOff),e.height=r-e.y,e.width=i-e.x},k.prototype.Jdt=function(t,n,e){var i,n,i,i=n.from,n=n.ext;e.dynamicMove=!0,e.dynamicSize=!1,e.placement=1,i&&(i=fn(i),e.x=D(t,0,i.col)+i.colOff,e.y=_(t,0,i.row)+i.rowOff),n&&(e.width=o(r(n.cx),6),e.height=o(r(n.cy),6))},k.prototype.Xdt=function(t,n){var e=t.from||t.pos,t=t.ext;n.dynamicMove=!1,n.dynamicSize=!1,n.placement=2,e&&(n.x=o(r(e.x),6),n.y=o(r(e.y),6)),t&&(n.width=o(r(t.cx),6),n.height=o(r(t.cy),6))},k.prototype.Voe=function(t,n){var t,t,t=t.graphicFrame;n.dynamicMove=!1,n.dynamicSize=!1,n.placement=2,t=ge(t.xfrm),n.x=t.x,n.y=t.y,n.width=t.width,n.height=t.height},k.prototype.fromBaseDrawingSJSFormat=function(t,n){var e,i,r,t,o,o,o,e,o,a,u,s,c,e,e=t.graphicFrame,i=t.pic,r=t.AlternateContent,t=t.clientData;if((e=r&&r.Choice&&(o=r.Choice.graphicFrame)?o:e)&&((o=e.nvGraphicFramePr.cNvPr)&&(n.name=o.name,n.isVisible=!l(o.hidden)||!1,n.alt=o.descr),o=e.graphic.graphicData)&&o.chart&&(n.Qdt=o.chart[F]),i){for(s in(e=i.nvPicPr.cNvPr)&&(n.name=e.name,n.isVisible=!l(e.hidden)||!1,n.alt=e.descr),a=(o=i.blipFill.blip)&&o["r:embed"],u=sn(u=o&&o.extLst&&o.extLst.ext)?u:[u])u.hasOwnProperty(s)&&(c=u[s]&&u[s]["asvg:svgBlip"])&&(a=c["r:embed"]);n.Qdt=a}r&&((e=r.cNvPr)&&(n.name=e.name,n.isVisible=!l(e.hidden)||!1,n.alt=e.descr),r.chart)&&(n.Qdt=r.chart[F]),t?(n.isLocked=l(t.fLocksWithSheet,!0),n.canPrint=l(t.fPrintsWithSheet,!0)):(n.isLocked=!0,n.canPrint=!0)},k.prototype.L0=function(e){(0,M.GC$)(c.body).unbind("scroll"+T.rht);var t=this,n=t.sheet();n&&(n._3(M.Events.ColumnChanged+T.rht),n._3(M.Events.RowChanged+T.rht),n._3(M.Events.ColumnWidthChanged+T.rht),n._3(M.Events.RowHeightChanged+T.rht)),!1!==e&&(t.vst&&M.GC$.each(t.vst,function(t,n){n.L0(e)}),t.sheet(y))},k.prototype.hitTest=function(e,i,r){var o,t,a,n,u,s,s,o=this.sheet(),t=o.Fi(),a=y;if(t)for(n=0;n<=2;n++)for(u=0;u<=2;u++)if((s=t.c9(n,u))&&s.contains(e,i)&&((s=o.Gdt&&o.Gdt(n,u))&&s.Vht.each(function(t){var n=t.Blt;n&&n.isVisible()&&(o.Pdt(n)||r)&&on(e,i,t.qdt)&&(a?$t(a.floatingObject)<$t(n)&&(a.floatingobject=n):a={x:e,y:i,floatingObject:n,Dn:t})}),a))return a;return a},k.prototype.jlt=function(t){for(var n,e,e=(t=t||"FloatingObject")+(n=1).toString();this.ev(e);)e=t+(++n).toString();return e},u=k,t.FloatingObjectModel=u,V={sheet:et("sheet",g)},M.GC$.extend(u.prototype,V),(0,M.$e)(u),Tt=["dotted","dashed","solid","double","groove","ridge","inset","outset"],At=[T.Plt,T._X,T._Y,T.qlt,T.Jlt,T.Ult,T.Qlt,T.Hlt,T.Klt,T.zlt,T.Xlt,T.Vlt,T.$lt,T.Tdt,T.Cdt,T.Sdt,T.aht,T.Idt,T.Adt,T.xdt,T.Ndt,T.kdt,"alt"],i=[["sheet",y,function(){Mn(this)}],[T.Plt,g,function(t,n){var e,i,i,r,e=this,i=e.sheet();i&&(r=(i=i.WL).ev(n))===e&&i.Ydt(n,t),e.onPropertyChanged("name",t,n)},vn],[T._X,0,gn(T._X,!1)],[T._Y,0,gn(T._Y,!1)],[T.Jlt,0,gn(T.Jlt,!0)],[T.qlt,0,gn(T.qlt,!0)],[T.Ult,g,Ut(T.Ult)],[T.Qlt,0,Ut(T.Qlt)],[T.Hlt,g,Ut(T.Hlt)],[T.Klt,0,Ut(T.Klt)],[T.zlt,g,Ht(T.zlt)],[T.Xlt,0,Ht(T.Xlt)],[T.Vlt,g,Ht(T.Vlt)],[T.$lt,0,Ht(T.$lt)],[T.Cdt,!1,Gt(T.Cdt)],[T.Sdt,!0,mn(T.Sdt)],[T.Tdt,!0,mn(T.Tdt)],[T.aht,!0,Gt(T.aht)],[T.Idt,!0,function(t,n){mn(T.Idt).call(this,t,n)},function(t){return"boolean"==typeof t&&(t||this.dynamicSize(!1,!1),!this.fixedPosition())}],[T.Adt,!0,function(t,n){mn(T.Adt).call(this,t,n)},function(t){return"boolean"==typeof t&&this.dynamicMove()&&!this.fixedPosition()}],[T.xdt,!1,function(t,n){var e=this;t&&(e.dynamicMove(!1,!1),e.dynamicSize(!1,!1)),e.onPropertyChanged(T.xdt,t,n)}],[T.Ndt,!0,Gt(T.Ndt)],[T.kdt,!0,Gt(T.kdt)],["alt","",mn("alt")]],t.isFloatingObjectPicture=xn,E.prototype.position=function(t){var n,e,i,r,n=this,e=n.sheet();return 0===arguments.length?new M.Point(n.x(),n.y()):(i=n.x(),r=n.y(),!t||isNaN(t.x)||isNaN(t.y)||i===t.x&&r===t.y||(n.x(t.x,!1),n.y(t.y,!1),wn(n),Tn(n),e&&e.zw(),n.onPropertyChanged("position",t,new M.Point(i,r))),n)},E.prototype.cloneContent=function(){var t,n,e,t=this.content();return t?(n=void 0,n=t.cloneNode?t.cloneNode(!0):((e=d(T.xht)).innerHTML=t.outerHTML,e.firstChild),(0,M.GC$)(n).removeAttr("id")[0]):y},E.prototype.refreshContent=function(t){var n,e,i,r,o,a,u,n=this;n.Zlt&&t&&((e=(0,M.GC$)(t)).empty(),i=n.cloneContent(),r=T.Odt,o=T.Odt,u=a="",i&&i.style&&(a=i.style.width,u=i.style.height),""!==a&&(r=a),""!==u&&(o=u),i!==y&&(0,M.GC$)(i).css({width:r,height:o}).addClass(T.Rdt).addClass(T.Nht).attr(T.kht,T.Dht).appendTo(t),e.css(T.Zht,""),n.Zlt=!1)},E.prototype.toJSON=function(){var t,n,e,i,t=this,n=Ft.call(t,At),e=t.cht;for(i in e)C(e[i])||(n[i]=e[i]);return n.typeName=t.typeName,n[T.Ylt]=(0,M.GC$)(d(T.xht)).append(t.cloneContent()).html(),n},E.prototype.wh=function(t,n){var e,i,e=this,i=e.typeName;return"1"===i?e.toSJSFormat_PictureDrawing(t):"2"===i&&e.toSJSFormat_ChartDrawing(t,n),t},E.prototype.toSJSFormat_ChartDrawing=function(t,n){var e,i,e,e=this,i={from:{col:{v_:e.startColumn()},colOff:{v_:h(e.startColumnOffset())},row:{v_:e.startRow()},rowOff:{v_:h(e.startRowOffset())}},to:{col:{v_:e.endColumn()},colOff:{v_:h(e.endColumnOffset())},row:{v_:e.endRow()},rowOff:{v_:h(e.endRowOffset())}}},e={macro:"",nvGraphicFramePr:{cNvPr:{id:e.wp,name:e.name(),v_:""},cNvGraphicFramePr:{}},xfrm:{off:{x:"0",y:"0"},ext:{cx:"0",cy:"0"}},graphic:{graphicData:{r_:[],chart:{}}}};n?(e.graphic.graphicData.r_.push(19),e.graphic.graphicData.chart={r_:[20,8],"r:id":t._id},i.AlternateContent={r_:[14],Choice:{r_:[18],Requires:"cx1",graphicFrame:e}}):(e.graphic.graphicData.r_.push(6),e.graphic.graphicData.chart={r_:[7,8],"r:id":t._id},i.graphicFrame=e),i.clientData={},t.c_.push({twoCellAnchor:i})},E.prototype.toSJSFormat_PictureDrawing=function(t){var n,e,i,r,i,i,r,o,o,r,a,a,u,a,u,s,c,f,l,n=this,e=n.sheet(),i=n.pictureStretch();1===i?r=kn(e,n):2===i?r=Dn(e,n):3===i&&(r=_n(e,n)),i=Nn(n.dynamicMove(),n.dynamicSize()),i={editAs:ot[i]},r?(i.from={col:{v_:r.startColumn},colOff:{v_:h(r.startColumnOffset||0)},row:{v_:r.startRow},rowOff:{v_:h(r.startRowOffset||0)}},i.to={col:{v_:r.endColumn},colOff:{v_:h(r.endColumnOffset||0)},row:{v_:r.endRow},rowOff:{v_:h(r.endRowOffset||0)}}):(i.from={col:{v_:n.startColumn()},colOff:{v_:h(n.startColumnOffset()||0)},row:{v_:n.startRow()},rowOff:{v_:h(n.startRowOffset()||0)}},i.to={col:{v_:n.endColumn()},colOff:{v_:h(n.endColumnOffset()||0)},row:{v_:n.endRow()},rowOff:{v_:h(n.endRowOffset()||0)}}),!1===n.isLocked()&&(i.fLocksWithSheet="0"),r={id:n.wp,name:n.name()},n.isVisible()||(r.hidden="1"),(o=n.alt())&&(r.descr=o),r.extLst={ext:{r_:[26],creationId:{r_:[24,25]}}},o={cNvPr:r,cNvPicPr:{picLocks:{noChangeAspect:"1"}}},(r={}).blip={r_:[8],"r:embed":t._id,extLst:{ext:{r_:[23],useLocalDpi:{r_:[22],val:"0"}}}},(a=n.fdt)?(a=On(a),u={},C(a.l)||0===a.l||(u.l=a.l),C(a.t)||0===a.t||(u.t=a.t),C(a.r)||0===a.r||(u.r=a.r),C(a.b)||0===a.b||(u.b=a.b),r.srcRect=u):r.stretch={fillRect:{}},a={},n.$dt&&(a.rot=6e4*n.$dt),a.xfrm={off:{x:"0",y:"0"},ext:{cx:"0",cy:"0"}},a.prstGeom={prst:"rect",avLst:{}},n.backColor()?a.solidFill=Kt(e,n.backColor()):a.noFill={},u=En(n.borderStyle())?0:n.borderWidth(),s=n.borderColor(),c=jn(n.borderStyle()),f=n.noFill(),l=a.ln={},C(u)||(l.w=S(h(u),0)),"dbl"===c&&(l.cmpd="dbl"),f?l.noFill={}:l.solidFill=Kt(e,s),"dbl"!==c&&(l.prstDash={val:c}),i.pic={nvPicPr:o,blipFill:r,spPr:a,lossless:{isFloatingObject:!0}},i.clientData={},C(i.lossless)&&(i.lossless={}),i.lossless[T.Ylt]=(0,M.GC$)(d(T.xht)).append(n.cloneContent()).html(),t.c_.push({twoCellAnchor:i})},E.prototype.fromJSON=function(t,n){var e,n;t&&((e=this).tvt=!0,Pt.call(this,At,t,n),C(t[T.Ult])&&Tn(e),t.content&&((n=d(T.xht)).innerHTML=t.content,e.content((0,M.GC$)(n.firstChild)[0])),e.tvt=g)},E.prototype.yh=function(t,n){},E.prototype.clone=function(t){var n,e,e,i,n=this,e=(0,M.getTypeFromString)(n.typeName),e=new(e||E),i=JSON.stringify(n.toJSON());return e.fromJSON(JSON.parse(i)),e.content(n.cloneContent()),e},E.prototype.onPropertyChanged=function(t,n,e){var i,r,i=this;i.tvt||(r=i.sheet())&&(r.Ut.nvt(i,t,e,n),i.ki({sheet:r,sheetName:r.name(),floatingObject:i,propertyName:t}))},E.prototype.ki=function(t){var n,t,n=this.sheet();n&&(n.ki(M.Events.FloatingObjectChanged,t),t.propertyName===T.Cdt)&&(t={sheet:t.sheet,sheetName:t.sheetName,floatingObject:t.floatingObject},n.ki(M.Events.FloatingObjectSelectionChanged,t))},E.prototype.JO=function(t,n){var e=this;t=p(t),n=p(n),pn.call(e,e[T.Ult],e[T.zlt],t,n)},E.prototype.xP=function(t,n){var e=this,i;bn.call(e,e[T.Ult],e[T.Qlt],e[T.zlt],e[T.Xlt],t,n,t+n-1)},E.prototype.qO=function(t,n){var e=this;t=p(t),n=p(n),pn.call(e,e[T.Hlt],e[T.Vlt],t,n)},E.prototype.NP=function(t,n){var e,i,e=this;t=p(t),n=p(n),bn.call(e,e[T.Hlt],e[T.Klt],e[T.Vlt],e[T.$lt],t,n,i=t+n-1)},E.prototype.getHost=function(t,n){var e,i,r,e=this.Ti.concat();if(C(t)||C(n))return e;for(i=0;i<e.length;i++)if((r=e[i]).rowViewportIndex===t&&r.columnViewportIndex===n)return r;return y},E.prototype.evt=function(t,n,e){var i=this.Ti;t&&i.indexOf(t)<0&&(t.rowViewportIndex=n,t.columnViewportIndex=e,i.push(t))},E.prototype.ivt=function(t){var n=this.Ti,t=n.indexOf(t);0<=t&&n.splice(t,1)},E.prototype.rvt=function(t,n){var e,i,r,o,a,u,s,e=d(T.xht);return(0,M.GC$)(e).addClass(T.jdt).addClass(T.Edt).attr(T.kht,T.Dht).css(T.ldt,T.ddt),i=this.cloneContent(),r=T.Odt,o=T.Odt,u=a="",(s=i&&i.style)&&(a=s.width,u=s.height),""!==a&&(r=a),""!==u&&(o=u),i!==y&&(0,M.GC$)(i).css({width:r,height:o}).addClass(T.Rdt).addClass(T.jdt).attr(T.kht,T.Dht).appendTo(e),this.evt(e,t,n),e},E.prototype.Zdt=function(){return!0},E.prototype.L0=function(t){},E.prototype.ovt=function(){zt(this),hn(this)},E.prototype.vdt=function(t){var n,e,e,n=this;return 1===t?w(n.width()):(e=In(n.startColumn(),n.startColumnOffset(),n.sheet(),!1),e=Jt(n,!1,e+n[T.qlt]()),An(n.startColumn(),e.index,n.startColumnOffset(),e.offset,t,n.sheet(),!1))},E.prototype.mdt=function(t){var n,e,e,n=this;return 1===t?w(n.height()):(e=In(n.startRow(),n.startRowOffset(),n.sheet(),!0),e=Jt(n,!0,e+n[T.Jlt]()),An(n.startRow(),e.index,n.startRowOffset(),e.offset,t,n.sheet(),!0))},A=E,t.FloatingObject=A,It={content:et(T.Ylt,y,Gt(T.Ylt))},M.GC$.each(i,function(t,n){It[n[0]]=et(n[0],n[1],n[2],n[3])}),M.GC$.extend(A.prototype,It),R.prototype.wK=function(t){var n,n,e,i,r,o,a,n=(0,M.GC$)(t.target).attr("resizeDirection");if(n)return n;if(n=(0,M.GC$)(this.Hht).offset(),e=t.pageX-n.left,i=t.pageY-n.top,r=this.edt)for(o=0;o<r.length;o++)if((a=r[o]).rect.contains(e,i))return a.direction},R.prototype.avt=function(t){var n,e,n,i,r,o,a,u,n=t.target,e;if((0,M.GC$)(n).attr("resizeDirection"))return n.style.cursor;if(n=(0,M.GC$)(this.Hht).offset(),i=t.pageX-n.left,r=t.pageY-n.top,o=this.edt)for(a=0;a<o.length;a++)if((u=o[a]).rect.contains(i,r))return u.cursor},R.prototype.gg=function(t){var n,e,i,r,o,a,u,u,u,r,s,r,c,i,c,i,i,n=this,e=n.Mf,i=n.Blt,r=e.Ut.pI,o=n.AW,a=n.IW;if(e._lt(i)&&e.endEdit()&&(e.Zg(!0),R.et(n,"preProcessMouseDown",u={e:t,r:y}),!u.r)){if(0===t.button||2===t.button){if(u=i.isSelected(),t.ctrlKey||t.shiftKey?i.isSelected(!u):u||(e.Olt(),i.isSelected(!0)),u||M.hi.F1(e),r&&r.CZ(),e.e4(),e.G1&&e.G1(),2===t.button)return;if(u=e.rt,r=e.uw(),s=n.wK(t),r=new M.Point(t.pageX-r.left,t.pageY-r.top),c=Pn(n,s),!i.allowMove()&&(!i.allowResize()||c.inMoving))return;n.fk=r,n.uvt=!0,(n.wht=c).inMoving?((i={}).startTopRow=e.getViewportTopRow(o),i.startLeftColumn=e.getViewportLeftColumn(a),i.startX=r.x,i.startY=r.y,n.CK=i):($n(n),c={},i=Ln(n.Mht),c.startX=i.x,c.startY=i.y,c.startWidth=i[T.qlt],c.startHeight=i[T.Jlt],c.startTopRow=e.getViewportTopRow(o),c.startLeftColumn=e.getViewportLeftColumn(a),c.cursor=n.avt(t),c.direction=s,n.lht=c),te(n),i=e.hitTest(r.x,r.y),u.Rk={e9:i.rowViewportIndex,r9:i.colViewportIndex,Bk:i.hitTestType},u.fk=r,u.Ok(),u.u9=!0,e.ki(M.Events.FloatingElementSelected,{type:"floatingObject"})}return!1}},R.prototype.pg=function(t){var n,e,i,r,o,r,a,u,u,s,t,s,n=this,e=n.Mf,i=n.Hht,r=n.zht;if(e._lt(n.Blt)){if(R.et(n,"preProcessMouseMove",o={e:t,r:y}),!o.r)return u=(a=n.Blt).isLocked()&&e.options.isProtected,(0,M.GC$)(i).css(T.odt,u||!a.allowMove()?"default":T.pdt),e.vk?(i&&(0,M.GC$)(i).css(T.odt,"default"),!0):(u=e.rt,s=e.uw(),t=new M.Point(t.pageX-s.left,t.pageY-s.top),n.uvt?(n.wht.inMoving?(n.iQ=!0,$n(n),Qn(n,n.fk,t),(0,M.GC$)(r).css(T.odt,T.pdt)):n.Blt.allowResize()&&(n.Eb=!0,Hn(n),(0,M.GC$)(r).css(T.odt,n.lht[T.odt])),(n.iQ||n.Eb)&&(n.fk=t,u.fk=t,u.a9(),(0,M.GC$)(c.body).addClass(T.Nht).attr(T.kht,T.Dht))):(s=e.parent).options.enableAccessibility&&s.n2(a.alt()),!1);(r=o.cursor)&&(0,M.GC$)(i).css(T.odt,r)}},R.prototype.bg=function(t){var n,e,i,r,o,a,u,u,o,i,e,n=this,e=n.Mf,i=e.rt,r=n.Blt,o=n.Hht,a=n.wht;if(e._lt(r)&&(R.et(n,"preProcessMouseUp",u={e:t,r:y}),!u.r))return e.vk?((0,M.GC$)(o).css(T.odt,T.pdt),!0):(i.u9=!1,i.l9(),u=e.uw(),o=new M.Point(t.pageX-u.left,t.pageY-u.top),(i=n.CK)&&(i.endX=o.x,i.endY=o.y),a&&(e=r.fixedPosition(),a.inMoving&&n.iQ?(e&&Kn(n),(t.ctrlKey?Vn:Yn)(n)):n.Eb&&(e&&Xn(n),Wn(n)),(0,M.GC$)(c.body).removeClass(T.Nht)),n.Flt(),!1)},R.prototype.Flt=function(){var t=this;t.lht=y,t.CK=y,(t.Cht=y,M.GC$)(t.zht).remove(),t.Mht=y,t.uvt=!1,ne(t),t.iQ=!1,t.Eb=!1},R.prototype.Dn=function(t,n){var e,i,r,o,a,u,u,u,s,n,e=this,i=e.Blt,r=e.Mf;if(i){if(o=!1,e.svt=t,!(a=e.Hht)){if(t.width<=0||t.height<=0)return;Xt(i,a=e.Hht=qn(e)),(u=r.parent)&&(u=e.fF=u.j2())&&(0,M.GC$)(u).append(a)}(u=e.Xht)||(u=e.Xht=i.rvt(e.AW,e.IW),"1"===i.typeName?(e.qht=d(T.xht),(0,M.GC$)(e.qht).addClass(T.Nht+" "+T.Edt).attr(T.kht,T.Dht),a.appendChild(e.qht),e.qht.appendChild(u)):(a.appendChild(u),o=!0)),e.qht&&(oe(e,n,t),n.x=0,n.y=0),s=(0,M.GC$)(u),(0,M.GC$)(a).css([T.ght,T.pht,T.qlt,T.Jlt],[t.y,t.x,t[T.qlt],t[T.Jlt]]),s.css([T.ght,T.pht,T.qlt,T.Jlt],[n.y,n.x,n[T.qlt],n[T.Jlt]]),e.qdt=t,i.refreshContent&&i.refreshContent(u),e.qht&&re(e),i.isSelected()?(s.removeClass(T._dt).addClass(T.Ddt),i.allowResize()?ee(e,a):e.ndt&&ie(e,a)):(s.removeClass(T.Ddt).addClass(T._dt),ie(e,a)),o&&(n=u.firstChild,r.ki(M.Events.FloatingObjectLoaded,{sheet:r,sheetName:r.name(),floatingObject:i,element:n}))}},R.prototype.L0=function(){var t=this,n=t.Blt,e=t.Hht,i=t.zht,r=t.Xht;R.et(t,"dispose"),r&&n.ivt&&(n.ivt(r),n.L0(!1)),e&&((0,M.GC$)(e).remove(),t.Hht=y),i&&((0,M.GC$)(i).remove(),t.zht=y)},R.$ht=7,I=R,t.FloatingObjectRender=I,(0,M.$e)(I),he.prototype.L0=function(){var t=this.Vht;t.each(function(t){t.L0()}),t.empty(),this.Mf=y},he.prototype.Dn=function(d,v,t){var m,g,p,b,n,e,i,r,o,t;if(!(d<0||v<0)){for(g=(m=this).Mf,p=m.Vht,b=g.WL,n=se(m,d,v,t),e=[],p.each(function(t){n.find(t.name)&&b.ev(t.name)===t.Blt||e.push(t)}),r=e.length,i=0;i<r;i++)(o=e[i]).Yht=y,p.remove(o.name),o.L0();t=g.parent&&g.parent.options.useTouchLayout,I.$ht=t?11:7,n.each(function(t){var n,e,i,r,n,o,i,a,u,s,a,i,c,u,f,l,h,h,e,n=b.ev(t.name),e=w(I.$ht/2+1);n&&"1"===n.typeName&&(i=n.borderWidth(),e<(i=dn(r=n.borderStyle())?i:0))&&(e=i),n=ue(m,d,v),i=t.x-e-(o=1),a=t.y-e-1,u=t[T.qlt]+2*e+2,c=s=t[T.Jlt]+2*e+2,u=u,h=-1*(l=f=e)-1,(f=a-(a=S(n.y,a))+(f=e))<=0?c=c+f+h:f<e&&0<f&&(c-=e-f),(l=i-(i=S(n.x,i))+(l=e))<=0?u=u+l+h:l<e&&0<l&&(u-=e-l),(h=p.find(t.name))||((h=new I(b.ev(t.name),g)).Yht=m,p.push(h)),h.GY=t,h.AW=d,h.IW=v,e=new M.Rect(n.x,n.y,n[T.qlt],n[T.Jlt]),h.Dn(new M.Rect(i,a,u,c).getIntersectRect(e)||new M.Rect(i,a,0,0),new M.Rect(l,f,t[T.qlt],t[T.Jlt]))})}},xt=he,M.Worksheet.ch(T.bdt,Nt={getUsedRange:function(t){var n,e,e;t.type&M.UsedRangeType.picture&&(e=(e=(n=this).pictures)&&e.getUsedRange(),L(t.range,e))},init:function(){var t,e,t=this,e=t.cvt=[];t.Vdt=function(n){e.forEach(function(t){t.Vnn&&t.Vnn(n)})},t.WL=t.Ut.WL,t.pictures=new St(t,"1"),t.floatingObjects=new St(t,"0")},dispose:function(e){var t=this;Et(t,e.clearCache),t.WL&&M.GC$.each(t.WL.QP(),function(t,n){n.L0(e.clearCache)}),!1!==e.clearCache&&(t.pictures&&(t.pictures.L0(),t.pictures=y),t.floatingObjects&&(t.floatingObjects.L0(),t.floatingObjects=y),t.oht=y,t.Vdt=y,t.Gdt=y),t.unbind(M.Events.TableFiltered+T.Bdt),t.unbind(M.Events.RangeFiltered+T.Bdt),t.unbind(M.Events.FloatingElementSelected+T.Bdt)},setHost:function(t){var e;t&&((e=this).bind(M.Events.TableFiltered+T.Bdt,function(){e.kct()}),e.bind(M.Events.RangeFiltered+T.Bdt,function(){e.kct()}),e.bind(M.Events.FloatingElementSelected+T.Bdt,function(t,n){"floatingObject"!==n.type&&e.Olt()}))},onLayoutChanged:function(t){var n,e,i,r,t,o;!C(t.sheetArea)&&3!==t.sheetArea||(n=t.changeType,e=t.row,i=t.rowCount,r=t.col,t=t.colCount,o=this.WL,"addRows"===n?jt(o,e,i):"deleteRows"===n?Ot(o,e,i):"addColumns"===n?Rt(o,r,t):"deleteColumns"===n&&Bt(o,r,t))},paint:function(t){var n,t,n,t=t.clipRect;this.oht(t)},lastNonNullRowAndCol:function(){var n,e,t,n=0,e=0,t=this.WL;return t&&t.QP().forEach(function(t){t&&(t[T.zlt]()>n&&(n=t[T.zlt]()),t[T.Vlt]()>e)&&(e=t[T.Vlt]())}),{lastNonNullRow:n,lastNonNullCol:e}},toJson:function(t,n){var e,n,e;n&&n.ignoreStyle||0<(n=this.WL.toJSON()).length&&(t.floatingObjects=n)},fromJson:function(t,n,e){var i,e,r,r,i;e&&e.ignoreStyle||((e=this).WL=new u(e),e.Ut.WL=e.WL,e.WL.isNeedToUpdateLayout=!0,r=t&&t.floatingObjectArray,!(r=n?r&&r.floatingObjects:t.floatingObjects))||e.WL.fromJSON(r,n)},preProcessMouseDown:function(t){var t,n,e,t,n,e,t=t.e,n=this.uw(),e=t.pageX-n.left,t=t.pageY-n.top;!this.il&&this.mnn&&(e=(n=this.hitTest(e,t))&&n.formulaRangeHitInfo)&&(e.inBorder||e.inTopLeft||e.inTopRight||e.inBottomLeft||e.inBottomRight)||this.Olt()},processKeyDown:function(t){fe(this.WL)&&(t.r=!0)},onGroupChanged:function(t){this.floatingObjects.Udt(t.start,t.end,t.isRow),this.pictures.Udt(t.start,t.end,t.isRow)},processCompositionStart:function(t){fe(this.WL)&&(t.r=!0)},preProcessKeyDown:function(t){var n=this.WL;n&&le(t.e)&&fe(n)&&(t.r=!0)},fromJsonAfterSJSFormula:function(t,n,e){var i,r,o,a,r,a,i;(!e||!1!==e.includeStyles)&&(o=(r=this).WL,(a=t.lossless&&t.lossless.floatingObjects)&&r.WL.fromJSON(a),r=U(t,n))&&(a=r.rels,o.yh(r,a,n,e))}}),kt={priority:900,init:function(){M.Commands.Rlt(this.commandManager())},onCommandExecuting:function(t){var n;t.WL.QP().forEach(function(t){t.isSelected(!1)})},onCultureChanged:function(){a()},wh:function(t,n,e){for(var i,r,o,a,u,s,c,s,f,s,l,h,d,v,m,g,p,b,y,w,i=this,r=i.sheets,o=0;o<r.length;o++){if(a=r[o],(u=J(t,a.name())).lossless||(u.lossless={}),c=(s=a.charts)&&s.all(),f=(s=a.pictures)&&s.all(),l=(s=a.floatingObjects)&&s.all(),c&&0<c.length)for(z(u,i.Cp),d=(h=H(t,u)).rels,v=0;v<c.length;v++)m=c[v],g=M.OpenSaveFileType.sjs,e&&!C(e.fileType)&&(g=e.fileType),m.fileType=g,kt.toSJSFormat_Chart(t,m,h,d),delete m.fileType;if(f&&0<f.length){for(p={c_:[]},d=h=void 0,v=0;v<f.length;v++)y=";base64,",(w=(b=f[v]).src())&&0<w.indexOf(y)?(h||(z(u,i.Cp),d=(h=H(t,u)).rels),kt.toSJSFormat_Picture(t,b,p,d)):(u.lossless.floatingObjects||(u.lossless.floatingObjects=[]),u.lossless.floatingObjects.push(ln(b)));0<p.c_.length&&(h.c_=p.c_.concat(h.c_))}if(l&&0<l.length)for(u.lossless.floatingObjects||(u.lossless.floatingObjects=[]),v=0;v<l.length;v++)u.lossless.floatingObjects.push(ln(l[v]))}},toSJSFormat_Chart:function(t,n,e,i){var r,o,a,u,s,c,c,s,r=q(n.chartType()),o,a="rId"+X(i),u=n.wp;e._id=a,r&&(s=Y(t.workbook,"definedNames"),C(s)?(t.workbook.c_.push(c={n_:"definedNames",c_:[]}),n.workbookCustomNames=c):n.workbookCustomNames=s),c=n.wh(e),delete e._id,s=r?M.XFileConstants.uu:M.XFileConstants.au,i.c_.push({n_:"Relationship",Id:a,Type:r?M.RelationshipConstants.Cc:M.RelationshipConstants.Mc,Target:"../charts/"+s+u+"."+M.XFileConstants.Cr}),C(t.charts)&&(t.charts={}),t.charts[s+n.wp]=c,delete n.workbookCustomNames},toSJSFormat_Picture:function(t,n,e,i){var i=M.Util.Kr(n.src(),i,t);e._id=i,n.wh(e),delete e._id}},M.Workbook.ch(T.bdt,kt),M.GC$.extend(M.Y8.prototype,{nvt:function(t,n,e,i){var r,o,r=this.G8;r&&(o=(o=r.floatingObjectChanges)||(r.floatingObjectChanges=[])).push({type:"property",floatingObject:t,name:n,value:e,newValue:i})},zdt:function(t){var n,e,i,n,r,n=this.G8;n&&(e=(e=n.floatingObjectChanges)||(n.floatingObjectChanges=[]),i={},n=this.WL,M.GC$.each(n.vst,function(t,n){i[t]=n}),t?(r=e[e.length-1]).currentObjects=i:e.push({type:"collection",floatingObjects:i}))},fvt:function(o,a){var u,s,t,n;if(o)for(s=(u=this).WL,t=function(t){var t,n,e,n,i,i,r,t,t=o[t];"collection"===t.type?(n=a?t.currentObjects:t.floatingObjects,e=s.vst,s.vst={},u.Mf.suspendPaint(),u.Mf.clearSelection(),tt.y0(n,function(t,n){var t,t;"Object"===n.constructor.name?(t=(t=e[t])||de(n,!1,u.Mf),s.ZP(t)):s.ZP(n)}),u.Mf.resumePaint()):"property"===t.type&&(n=["startRow","startRowOffset","startColumn","startColumnOffset","endRow","endRowOffset","endColumn","endColumnOffset"],i="function"==typeof t.floatingObject.name?t.floatingObject.name():t.floatingObject.name,i=s.ev(i),r=t.name,t=a?t.newValue:t.value,i)&&(i.Wlt=!0,i[r](t),0<=n.indexOf(r)&&(zt(i),hn(i),i.sheet().zw()),i.Wlt=!1)},n=o.length-1;0<=n;n--)t(n)}}),M.Y8.ch(T.bdt,{init:function(){this.WL=new u(this.Mf)},applyChanges:function(t){var n,t,n,n=t.changes,t=t.isUndo,n=n&&n.floatingObjectChanges;n&&this.fvt(n,!t)},undo:function(t){var t=t.floatingObjectChanges;t&&this.fvt(t)},dispose:function(t){var n=this,e;!1!==(t&&t.clearCache)&&n.WL&&(n.WL.L0(),n.WL=y)}})},"./dist/plugins/floatingObject/floatingobject.ns.js":function(t,n,e){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.SR=void 0;var e=e("./dist/plugins/floatingObject/floatingobject.res.en.js");n.SR={en:e}},"./dist/plugins/floatingObject/floatingobject.res.en.js":function(t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.Exp_FloatingObjectNameEmptyError=n.Exp_FloatingObjectHasSameNameError=void 0,n.Exp_FloatingObjectHasSameNameError="The current worksheet already has a floating object with the same name.",n.Exp_FloatingObjectNameEmptyError="Floating object must have name"},"./dist/plugins/floatingObject/picture.js":function(t,n,e){"use strict";var i,o,a,r,u,s,c,f,l,e,h,d,v,m,g,p,b,y,i,w,M,C;function S(t){return"number"==typeof t&&!isNaN(t)}function T(t,n,e,i,r,o){var t,e,t=C.call(this,t,e,i,r,o)||this,e=t;return e.typeName="1",e.iht="1",e.MC=c,e.cdt=!1,e.lvt=!1,"string"==typeof n&&(e.lvt=!(S(r)&&S(o)),e.src(n)),t}function A(t){var n,t,e,i,r,n=t,t=n.src(),e=n.sheet();n.MC||(n.MC=new o.Wh(function(){A(n)})),i=n.MC;try{i.jt(t)?(n.cdt=!0,r=i.Ot(t),n.hvt=r.width,n.dvt=r.height,n.$dt&&n.$dt%90==0&&(n.udt=I(r,r.width,r.height,n.$dt)),n.lvt&&(n.width(r.width,!0),n.height(r.height,!0),n.lvt=!1),n.ki({sheet:e,sheetName:e.name(),picture:n,propertyName:"originalSize"}),n.isVisible()&&e&&e.repaint()):i.Rt(t)}catch(t){}}function I(t,n,e,i){var r,o,a,u,r=n,o=e;return 90!==i&&270!==i||(r=e,o=n),(a=document.createElement("canvas")).width=r,a.height=o,(u=a.getContext("2d")).translate(r/2,o/2),u.rotate(i/180*Math.PI),u.translate(-r/2,-o/2),u.drawImage(t,0,0,n,e,(r-n)/2,(o-e)/2,n,e),u.setTransform(1,0,0,1,0,0),a.toDataURL()}i=this&&this.__extends||(M=function(t,n){return(M=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(t,n){t.__proto__=n}:function(t,n){for(var e in n)Object.prototype.hasOwnProperty.call(n,e)&&(t[e]=n[e])}))(t,n)},function(t,n){if("function"!=typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function e(){this.constructor=t}M(t,n),t.prototype=null===n?Object.create(n):(e.prototype=n.prototype,new e)}),Object.defineProperty(n,"__esModule",{value:!0}),n.Picture=void 0,o=e("Core"),a=e("./dist/plugins/floatingObject/floatingobject.js"),r=o.mt.En,u=o.mt.p0,s=o.GC$,c=null,f=void 0,b=[l="src",e="backColor",d="borderRadius",v="borderWidth",m="borderStyle",p="noFill",g="borderColor",h="pictureStretch"],a.FloatingObject.gdt=function(t,n,e,i,r,o){return new y(t,n,e,i,r,o)},C=a.FloatingObject,i(T,C),T.prototype.onPropertyChanged=function(t,n,e){var i,r,i=this;i.tvt||(r=i.sheet())&&(r.Ut.nvt(i,t,e,n),this.ki({sheet:r,sheetName:r.name(),picture:i,propertyName:t}))},T.prototype.toJSON=function(){var t,n,e,i,r,t=this,n=C.prototype.toJSON.call(this);return a.toJsonFn.call(t,b,n),n.originalWidth=t.getOriginalWidth(),n.originalHeight=t.getOriginalHeight(),t.$dt&&(n.rot=t.$dt),(e=t.fdt)&&(i=e.left,r=e.top,n.srcRect={l:i,t:r,r:1-i-e.width,b:1-r-e.height}),n.isTakeOriginalSize=t.lvt,delete n.content,n},T.prototype.fromJSON=function(t,n,e){var i,r,e,n,o;t&&((i=this).tvt=!0,e&&(r=S(t.x)&&S(t.y)&&S(t.width)&&S(t.height))&&(t.endRow=null,t.endRowOffset=null,t.endColumn=null,t.endColumnOffset=null),C.prototype.fromJSON.call(this,t,n),a.fromJsonFn.call(i,b,t,n),t.rot&&(i.$dt=t.rot),i.cdt=!1,(e=t.srcRect)&&(n=e.l,o=e.t,i.fdt={left:n,top:o,width:1-n-e.r,height:1-o-e.b}),i.lvt=t.isTakeOriginalSize,A(i),i.tvt=f)},T.prototype.yh=function(t,n,e){this.fromJSON(t,n,e)},T.prototype.clone=function(){var t,n,t=new T,n=JSON.stringify(this.toJSON());return t.fromJSON(JSON.parse(n)),t},T.prototype.getOriginalWidth=function(){return this.hvt},T.prototype.getOriginalHeight=function(){return this.dvt},T.prototype.vvt=function(t){var n;return 0<=["dotted","dashed","solid","double","groove","ridge","inset","outset"].indexOf(t)},T.prototype.rvt=function(t,n){var e=r("div");return s(e).addClass("gc-floatingobject-content-container").addClass("gc-no-user-select").attr("unselectable","on").css("position","absolute"),this.evt(e,t,n),e},T.prototype.ki=function(t){var n,t,n=this.sheet();n&&(n.ki(o.Events.PictureChanged,t),"isSelected"===t.propertyName)&&(t={sheet:t.sheet,sheetName:t.sheetName,picture:t.picture},n.ki(o.Events.PictureSelectionChanged,t))},T.prototype.L0=function(t){var n=this;n.MC&&!1!==t&&(n.MC.L0(),n.MC=c)},y=T,n.Picture=y,i=[[l,f,function(t,n){var e=this;e.cdt=!1,A(e),e.srccallback||(e.srccallback=(0,a.propertyRefreshCallback)(l)),e.srccallback.call(e,t,n)}],[e,c,(0,a.propertyRefreshCallback)(e)],[d,-1,(0,a.propertyRefreshCallback)(d),S],[v,1,(0,a.propertyRefreshCallback)(v),S],[m,"none",function(t,n){var e=this;e.vvt(t)||e.borderWidth(0),e.bscallback||(e.bscallback=(0,a.propertyRefreshCallback)(m)),e.bscallback.call(e,t,n)}],[p,f],[g,c,(0,a.propertyRefreshCallback)(g)],[h,0,(0,a.propertyRefreshCallback)(h)]],w=y.prototype,s.each(i,function(t,n){w[n[0]]=u(n[0],n[1],n[2],n[3])})},"./dist/plugins/formulaTextbox/formulaTextBox.entry.js":function(t,n,e){"use strict";var i,r,o,a,u,i=this&&this.__createBinding||(Object.create?function(t,n,e,i){void 0===i&&(i=e);var r=Object.getOwnPropertyDescriptor(n,e);r&&("get"in r?n.__esModule:!r.writable&&!r.configurable)||(r={enumerable:!0,get:function(){return n[e]}}),Object.defineProperty(t,i,r)}:function(t,n,e,i){t[i=void 0===i?e:i]=n[e]}),r=this&&this.__exportStar||function(t,n){for(var e in t)"default"===e||Object.prototype.hasOwnProperty.call(n,e)||i(n,t,e)};Object.defineProperty(n,"__esModule",{value:!0}),n.findControl=void 0,o=e("Core"),r(e("./dist/plugins/formulaTextbox/formulatextbox.js"),n),r(e("./dist/plugins/formulaTextbox/formulatextbox-acrosssheet.js"),n),e("./dist/plugins/formulaTextbox/formulatextbox-event.js"),e("./dist/plugins/formulaTextbox/formulatextbox-actions.js"),e("./dist/plugins/formulaTextbox/formulatextbox-render.js"),a=e("./dist/plugins/formulaTextbox/formulatextbox.js"),n.findControl=u=function(t){return"string"==typeof t&&(t=document.getElementById(t)),(0,o.GC$)(t).data(a.CONST_FORMULATEXTBOX)}},"./dist/plugins/formulaTextbox/formulatextbox-acrosssheet.js":function(t,n,e){"use strict";var d,v,m,g,i,r;function o(t){var n,e,n=d.mt.En("textarea"),e;return(0,d.GC$)(n).css({display:"none"}),(0,d.GC$)(t).append(n),n}function a(){var t=this;t.bZ=-1,t.mvt=-1,t._text="",t.gvt=-1,t.Mf=null,t.XD=!1,t.pvt=-1,t.bvt=null,t.Vv=null,t.yvt=null}function u(){}Object.defineProperty(n,"__esModule",{value:!0}),n.wvt=n.Mvt=void 0,d=e("Core"),v=e("./dist/plugins/formulaTextbox/formulatextbox.js"),m=null,g=void 0,n.Mvt=o,a.prototype.d5=function(){var t=this;t.Cvt(),t.bZ=-1,t.mvt=-1,t._text="",t.gvt=-1,t.XD=!1,t.pvt=-1,t.Mf=null,t.Vv=null,t.yvt=null},a.prototype.Cvt=function(){var t,n,e,t=this;t.Mf.xT||(n=t.Mf.getCellType(t.bZ,t.mvt),e={sheet:t.Mf,row:t.bZ,col:t.mvt,sheetArea:3},t.bvt&&t.bvt.firstChild&&n.deactivateEditor(t.bvt.firstChild.firstChild,e)),(0,d.GC$)(t.bvt).remove(),t.bvt=null},a.prototype.Svt=function(t){var n,e,i,n=this,e=t.il;e&&(i=t.vA,n._text=e.text(),n.bZ=i?i.row:t.getActiveRowIndex(),n.mvt=i?i.col:t.getActiveColumnIndex(),n.nT=i?i.sheetArea:d.SheetArea.viewport,n.gvt=e.caret(),n.XD=e.XD,n.pvt=e.Tvt(),n.rl=e.rl,n.Avt=e.Avt,n.Ivt=e.Ivt,n.Mf=t,n.Vv=t.parent,n.yvt=t.rt.it())},a.prototype._6=function(t){var n=this;t.il&&n.Mf&&(n._text=t.il.text(),n.gvt=t.il.caret(),n.XD=t.il.XD,n.pvt=t.il.Tvt())},a.prototype.xvt=function(t){var n,t,n=this,t=t.il;t&&(t.rl=n.rl,t.Avt=n.Avt,t.Ivt=n.Ivt,t.text(n._text),t.caret(n.gvt),n.XD)&&(t.Nvt(),t.Tvt(n.pvt))},a.prototype.kvt=function(t){var n,e,i,r,n=t.oldSheet,e=this,i=n&&n.il;if(i)if(i.close(),(!e.Mf||e.Mf.xT)&&i.Dvt()||e.Avt!==i.Avt){e.Svt(n),r=n.getValue(e.bZ,e.mvt,e.nT),n.suspendEvent();try{if(!n.endEdit(!0))return}finally{n.resumeEvent()}n.setValue(e.bZ,e.mvt,r,e.nT,!0),n.Di=1,t.needTriggerSheetChange=!1}else e._text&&(e._6(n),i.destroy(),n.il=m,t.needTriggerSheetChange=!1)},a.prototype._vt=function(t){var n,t,e,i,i,r,i,r,n=t.oldSheet,t=t.newSheet,e=this;if(t&&!t.xT){if(e.bvt&&""===e._text&&(n&&n.cR(),e.d5()),e._text&&e.Mf===t)t.Di=0,t.Zg(),t.suspendEvent(),e.rl?(i=o(t.parent.Ti),(0,v.Evt)(t,i,m,t.ui,t.ci,3),t.Di=2,t.Dn.ID()):(r=i=void 0,e.nT===d.SheetArea.rowHeader?r=-(i=1):e.nT===d.SheetArea.colHeader&&(i=-1,r=1),t.f6(t.Dg(),e.bZ,e.mvt,i,r,!1)),t.resumeEvent(),e.xvt(t),e.GG(t,e.bZ,e.mvt,e.nT),n&&n.cR(),e.d5();else if(e._text&&!e.bvt){if(t.Di=1,n&&(n.Di=1),e.jvt(t),!e.Mf||e.Mf.xT)return;t.e4()}else if(e._text&&e.Mf!==t){if(t.Di=1,n&&(n.Di=1,n.cR()),e.jvt(t),!e.Mf||e.Mf.xT)return;t.e4()}(i=e.Mf)&&(r=t.il)&&(r.U6=i!==t)}},a.prototype.jvt=function(t){var n,e,i,r,o,a,u,s,c,f,l,f,l,h,n=this,e=n.Mf;e&&!e.xT&&(i=n.bZ,r=n.mvt,o=n.nT,a=e.getCellType(i,r,o),u={sheet:e,row:i,col:r,sheetArea:o,canvasOffset:this.yvt},(s=a.isImeAware(u))||o!==d.SheetArea.viewport)&&(t.Di=1,c=a.jn(u),n.bvt&&n.Cvt(),l=f=void 0,n.nT===d.SheetArea.rowHeader?l=-(f=1):n.nT===d.SheetArea.colHeader&&(f=-1,l=1),n.bvt=c,(0,d.GC$)(c).css("position","absolute"),(f=e.getCellRect(i,r,f,l)).width===g&&(f.width=0),f.height===g&&(f.height=0),(0,d.GC$)(c).attr("id","across"),l=e.getActualStyle(i,r,o),a.On(c,l,f,u),(h=n.Vv&&n.Vv.getHost()||document.body).insertBefore(c,m),n.rl&&(0,d.GC$)(c).css({display:"none"}),(0,v.Evt)(t,a.getEditingElement(),!0,t.ui,t.ci,3),c.firstChild&&!n.rl&&a.focus(c.firstChild.firstChild),n.xvt(t),a.Rn(c,l,f,u))},a.prototype.GG=function(t,n,e,i){var r,o,a,u,s,c,r,o,f;i===d.SheetArea.rowHeader?o=-1:i===d.SheetArea.colHeader&&(r=-1),a=t.getCellType(n,e,i),u=t.li,s=t.Fi(),c=t.getActualStyle(n,e,i),r=t.getCellRect(n,e,r,o),o=!1,i===d.SheetArea.rowHeader?o=r.x>=s.x&&r.y>=s.y+s.qC&&r.x+r.width<=s.Py&&r.y+r.height<=s.Ay+s.Iy:i===d.SheetArea.colHeader?o=r.x>=s.x+s.XC&&r.y>=s.y&&r.x+r.width<=s.Hy+s.zy&&r.y+r.height<=s.Cy:i===d.SheetArea.viewport&&(o=r.x>=s.b6&&r.y>=s.T6&&r.x+r.width<=s.Hy+s.zy&&r.y+r.height<=s.Ay+s.Iy),r&&0<r.width&&0<r.height&&o&&u&&u.parentNode&&a.Rn(u.parentNode.parentNode,c,r,f={sheet:t,row:n,col:e,sheetArea:i})},i=a,u.Ovt=function(t,n){(u.Rvt=u.Rvt?u.Rvt:new i).kvt(n)},u.Bvt=function(t,n){(u.Rvt=u.Rvt?u.Rvt:new i)._vt(n)},n.wvt=u},"./dist/plugins/formulaTextbox/formulatextbox-actions.js":function(t,n,e){"use strict";var b,n,y,r,o,w,a;function M(t){var n,n,e,n=t.il,e=t.rt,n=n.XD?e.Lvt:e.Lvt={anchorRow:t.ui,anchorCol:t.ci,leadingRow:t.qA,leadingCol:t.hR};return n}function u(t,n,e,i,r){var o,a,a,a,u,s,c,f,u,s,n,l,h,d,a,v,m,g,p,l,h,g,p,l,o=t.il,a=t.parent,a=a&&a.options;if(o&&o.Dvt()&&a&&a.allowUserEditFormula&&a.enableFormulaTextbox){switch(u=(a=M(t)).anchorRow,s=a.anchorCol,c=a.leadingRow,f=a.leadingCol,w(i)&&(i=u),w(r)&&(r=s),u=t.rt,n){case 3:d=t.sI(i,r,e,c);break;case 4:d=t.uI(i,r,e,c);break;case 1:d=t.lR(i,r,e,f);break;case 2:d=t.gR(i,r,e,f);break;case 5:d=t.yR();break;case 6:d=t.bR()}d&&(s=d.row,n=d.col,l=d.leadingCellRow||s,h=d.leadingCellCol||n,t.dR(s,n))&&(a.anchorRow=s,a.anchorCol=n,a.leadingRow=l,a.leadingCol=h,a=t.pivotTables&&t.pivotTables.findPivotTable(l,h),v=o.shift,m=o.ctrl,p=(g=a&&a.getPivotInfoImp(l,h,!1,!0))&&g.area,!o.Ivt&&a&&g&&4===p?(o.Fvt=new b.Range(l,h,1,1),l=g.valueFieldName,h=g.rowInfos,g=g.colInfos,(h||g)&&(p=t.rt.Pvt(p,l,h,g,a.position()))&&(o.Gvt(p,v,!m,!0),o.rb=!1)):(delete o.Fvt,(l=(0,y.Uvt)(u.Mf,(0,b.Ec)(s,n,1,1)))&&o.Gvt(l,!1,!0)),0<=s)&&0<=n&&t.OA(s,n)}}function i(t,n){var e;return!!t&&2!==t.Di&&((e=t.il)&&e.Dvt()?u(t,n,!1):(t=e?a.Hvt(t):t).G5(n,!1),!0)}function s(t,n,e,i){var r;return!!t&&2!==t.Di&&((r=t.il)&&r.Dvt()?u(t,n,!1,e,i):(t=r?a.Hvt(t):t).G5(n,!1,e,i),!0)}function c(t,n,e){var i,r,r,r,o,a,o,u,u,t,u,i=t.il,r=t.parent,r=r&&r.options;i&&i.Dvt()&&r&&r.allowUserEditFormula&&r.enableFormulaTextbox&&(r=t.rt,a=(o=M(t)).anchorRow,o=o.anchorCol,u=i.XD?(u=i.zvt(),(0,y.Vvt)(t,u.text)):(0,b.Ec)(a,o,1,1))&&(t=t.HR(u,n,e,a,o),u=(0,y.Uvt)(r.Mf,t))&&i.Gvt(u,!0,!1)}function f(t,n,e){if(t){if(2===t.Di)return!1;var i=t.il;if(i&&i.Dvt())c(t,n,e);else{if(!(t=i?a.Hvt(t):t).endEdit())return!1;t.HA(n,e)}return!0}return!1}function l(){}Object.defineProperty(n,"__esModule",{value:!0}),b=e("Core"),n=e("Common"),y=e("./dist/plugins/formulaTextbox/formulatextbox.js"),r=e("./dist/plugins/formulaTextbox/formulatextbox-acrosssheet.js"),o=void 0,w=n.Common.lt.ht,b.Commands.B5=i,b.Commands.UA=s,b.Commands.L5=f,l.YA=function(t){return l.Hvt(t)},l.ZA=function(t){return l.Hvt(t)},l.WA=function(t){return l.Hvt(t)},l.Hvt=function(t){var t,n,t=t,n=r.wvt.Rvt;return n&&n._text&&n.Mf&&(t=n.Mf,l.Yvt(t)),t},l.Yvt=function(t,n){var e,i;void 0===n&&(n=!0),e=t.parent,(i=r.wvt.Rvt)&&i._text&&e.e3(t,n)},l.KA=function(t,n,e){var i,r,o,n,i=!1,r=t.il;return r&&r.Dvt()?((o=M(t)).anchorRow=n,o.leadingRow=n,(n=(0,y.Uvt)(t,(0,b.Ec)(o.anchorRow,o.anchorCol,1,1)))&&r.Gvt(n,!1,!0),t.$A(e),i=!0):r&&(t=l.Hvt(t)),{sheet:t,r:i}},l.eI=function(t,n,e){var i,r,o,n,i=!1,r=t.il;return r&&r.Dvt()?((o=M(t)).anchorRow=n,o.leadingRow=n,(n=(0,y.Uvt)(t,(0,b.Ec)(o.anchorRow,o.anchorCol,1,1)))&&r.Gvt(n,!1,!0),t.$A(e),i=!0):r&&(t=l.Hvt(t)),{sheet:t,r:i}},l.Zvt=function(t,n){var e,n,i,r,o,e=!1,n=n?5:6,i=t.il,r=t.ui,o=t.ci;return i&&i.Dvt()?(i.XD||(t.rt.Lvt={anchorRow:r,anchorCol:o,leadingRow:t.qA,leadingCol:t.hR}),u(t,n,!1,r,o),e=!0):i&&(t=l.Hvt(t)),{sheet:t,r:e}},l.iI=function(t){return l.Zvt(t,!0)},l.rI=function(t){return l.Zvt(t,!1)},l.oI=function(t){return l.Hvt(t)},l.aI=function(t){return l.Hvt(t)},l.cI=function(t){var n,e,i,n,n=r.wvt.Rvt;if(n&&n._text&&n.Mf&&(t=n.Mf,e=n.bZ,i=n.mvt,l.Yvt(t,!1),(0,y.Wvt)(t),n.rl||t.t4(e,i,o,o,1),t.isEditing()))return n=t.getValue(e,i,3),!!t.ol(!0,void 0,void 0,!0)&&(t.setValue(e,i,n,3,!0),!0)},a=l,b.Commands.VA=a},"./dist/plugins/formulaTextbox/formulatextbox-event.js":function(t,n,e){"use strict";var S,T,d,A,b,n,I,e,y,x,w,M;function N(t,n,e,i){var r,t,r,o,a,u,s,c,r=t.il,t=t.Ut,r=r.Qvt(),o=S.SheetArea.viewport;return r===S.SheetArea.colHeader&&i===S.SheetArea.colHeader?n<(a=t.getFreeAreaRowCount(S.SheetArea.colHeader))&&(o=S.SheetArea.colHeader):r===S.SheetArea.rowHeader&&i===S.SheetArea.rowHeader&&e<(s=t.getFreeAreaColumnCount(S.SheetArea.rowHeader))&&(o=S.SheetArea.rowHeader),o}function k(t,n,e,i,r,o,a,u){var s=t.xA(n,e,n,e,a,u),s=(0,S.Ec)(s.row,s.col,1,1);return s=o&&0<=i?t.xA(n,e,i,r,a,u):s}Object.defineProperty(n,"__esModule",{value:!0}),S=e("Core"),T=e("CalcEngine"),d=e("SheetsCalc"),A=e("./dist/plugins/formulaTextbox/formulatextbox.js"),b=e("./dist/plugins/formulaTextbox/formulatextbox-acrosssheet.js"),n=e("Common"),I=n.Common.lt.ht,e=S.GC$.extend,y=null,x=void 0,w=Math.max,M=Math.min,e(S.nk.prototype,{Kvt:function(t){var n,e,i,r,r,o,a,u,s,c,f,l,h,d,v,m,g,p,b,y,w,M,C,o,s,a,c,e,f,r,o,s,n=this,e=n.Mf,i=e.il,r=e.parent,r=r&&0!==r.options.pivotAreaReference;i&&(n.Jvt(),o=e.frozenRowCount(),a=e.frozenColumnCount(),(u=i.XD)&&n.Lvt||(n.Lvt={anchorRow:-1,anchorCol:-1,leadingRow:-1,leadingCol:-1}),s=e.getRowCount(),c=e.getColumnCount(),f=t.hitTestType,l=t.row,h=t.col,d=n.shift,v=n.ctrl,i&&i.Xvt&&(i.Xvt===S.SelectionUnit.row?f=2:i.Xvt===S.SelectionUnit.column&&(f=1)),g=(m=n.Lvt).anchorRow,p=m.anchorCol,y=b=-1,M=N(e,l,h,f),0===f?(b=o?e.N9():e.Tb,y=a?e.k9():e.Ab,w=(0,S.Ec)(-1,-1,-1,-1),i.Gvt((0,A.Uvt)(e,w),d,!v,x,M),n.rb=!0):1===f?(M===S.SheetArea.viewport?(b=o?e.N9():e.Tb,w=e.xA(0,y=h,s-1,h,!0),d&&0<=p&&(w=e.xA(0,h,s-1,p,!0)),w=(0,S.Ec)(-1,w.col,-1,w.colCount)):M===S.SheetArea.colHeader&&(w=k(e,b=l,y=h,g,p,d,!0,M)),(C=t.tableSelectInfo&&t.tableSelectInfo.tableSelection)?n.kse(C,w,l,h,g,p,d,v,M):i.Gvt((0,A.Uvt)(e,w,x,M),d,!v,x,M),n.rb=!0):2===f?(b=l,y=a?e.k9():e.Ab,w=e.xA(l,0,l,c-1,!0),d&&0<=g&&(w=e.xA(l,0,g,c-1,!0)),w=(0,S.Ec)(w.row,-1,w.rowCount,-1),i.Gvt((0,A.Uvt)(e,w),d,!v,x,M),n.rb=!0):3===f&&(y=h,(b=l)!==x)&&h!==x&&(o=t.row,s=t.col,e=(c=(a=t.pivotTableInfo)&&a.getPivotInfoImp(o,s,!1,!0))&&c.area,C=t.tableSelectInfo&&t.tableSelectInfo.tableSelection,!(r&&T.Functions.findGlobalFunction("GETPIVOTDATA")&&!i.Ivt&&a&&c&&4===e)||(i.Fvt=new S.Range(o,s,1,1),f=c.valueFieldName,r=c.rowInfos,o=c.colInfos,I(f))||!r&&!o?n.kse(C,w,l,h,g,p,d,v,M):(s=n.Pvt(e,f,r,o,a.position()))&&(i.Gvt(s,d,!v,!0,M),n.rb=!0,n.LD=!0)),n.Wk=n.rb,d&&u||(m.anchorRow=b,m.anchorCol=y,m.leadingRow=b,m.leadingCol=y,m.sheetArea=M),n.Rk={e9:t.rowViewportIndex,r9:t.colViewportIndex,Bk:t.hitTestType},n.Ok())},kse:function(t,n,e,i,r,o,a,u,s){var c,f,l,c=this,f=c.Mf,l=f.il;delete l.Fvt,n=t||k(f,e,i,r,o,a,!0,s),l.Gvt((0,A.Uvt)(f,n,x,s),a,!u,x,s),c.rb=!0},Pvt:function(t,n,e,i,r){var o,a,t,u,s,c,r,c,f,r,l,h,a,o,a=this.Mf;if(4===t)return u=t=void 0,c=r.row,r=r.col,c=(s="",S.Ec)(c,r,1,1),t=(0,A.Uvt)(a,c,!0),f=[],r=[],r=Array.isArray(e)&&Array.isArray(i)?e.concat(i):Array.isArray(e)&&e||Array.isArray(i)&&i,l=/\"/g,h='""',r&&r.forEach(function(t){"number"==typeof t.fieldName?f.push(t.fieldName):f.push('"'+t.fieldName.replace(l,h)+'"'),"number"==typeof t.itemName?f.push(t.itemName):f.push('"'+t.itemName.replace(l,h)+'"')}),s=f.join(","),a='GETPIVOTDATA("'+(u=n.replace(l,h))+'",'+t,""!==s&&(a+=","+s),a+")"},qvt:function(t){var n,e,i,r,n=!1,e=b.wvt.Rvt;if(e&&e.bvt)if(i=e.Mf,(r=t.il)&&i.setFormula(e.bZ,e.mvt,r.text()),i!==t){if(S.Commands.VA.Yvt(i),!i.endEdit())return;n=!0}else r&&(r.destroy(),t.il=y),e.d5();return n},Qk:function(){var t,n,e,i,e,i,t=this,n=this.$vt(),e=t.Rk,i=t.Lvt;e&&t.rb&&(e=e.Bk,i=i.sheetArea,n&&n.Xvt&&(n.Xvt===S.SelectionUnit.row?e=2:n.Xvt===S.SelectionUnit.column&&(e=1)),e===S.SheetArea.viewport||i===S.SheetArea.colHeader||i===S.SheetArea.rowHeader?t.tmt():2===e?t.nmt():1===e&&t.emt())},tmt:function(){var t,n,e,i,n,r,o,a,r,o,e,t=this,n=t.Lvt,e=n.anchorRow,i=n.anchorCol,n=n.sheetArea,r=t.Q9(x,n,!0),o=t.K9(x,n,!0);0<=e&&0<=i&&0<=r&&0<=o&&(r=(a=t.Mf).xA(r,o,e,i,!0,n),o=(0,A.Uvt)(a,r,x,n))&&(e=a.il,t.LD?r.equals(e.Fvt)||(delete e.Fvt,e.Gvt(o,!0,!0)):e.Gvt(o,!0,!1)),t.a9()},nmt:function(){var t,n,e,i,e,n,r,t=this,n=t.Lvt.anchorRow,e=t.Q9();0<=n&&0<=e&&(e=(i=t.Mf).xA(e,0,n,i.getColumnCount()-1,!0),e=(0,S.Ec)(e.row,-1,e.rowCount,-1),n=(0,A.Uvt)(i,e))&&(r=i.il).Gvt(n,!0,!1),t.a9()},emt:function(){var t,n,e,i,e,n,r,t=this,n=t.Lvt.anchorCol,e=t.K9();0<=n&&0<=e&&(e=(i=t.Mf).xA(0,e,i.getRowCount()-1,n,!0),e=(0,S.Ec)(-1,e.col,-1,e.colCount),n=(0,A.Uvt)(i,e))&&(r=i.il).Gvt(n,!0,!1),t.a9()},_D:function(){var t=this;t.l9(),t.Rk=y,t.rb=!1,t.Wk=!1},Mk:function(t){var n,e,i,r,i,r,o,r,e,a,u,a,u,n=this,e=n.Mf,i=n.$vt(),r=t.formulaRangeHitInfo;r&&r.inBorder&&i&&(i.XD&&i.qD(),i.close(),r=(i=r.paramRange)&&i.text,o=I(i.sheetArea)?S.SheetArea.viewport:i.sheetArea,r)&&(r=(0,A.Vvt)(e,r))&&(n.Jvt(),e=e.JS(r,o),a=t.row,u=t.col,(a=a<e.row?e.row:a)>=e.row+e.rowCount&&(a=e.row+e.rowCount-1),(u=u<e.col?e.col:u)>=e.col+e.colCount&&(u=e.col+e.colCount-1),a=a-e.row,u=u-e.col,n.rb=!0,n.Kk=!0,n.imt={paramRange:i,fromRange:r,rowOffset:a,colOffset:u,sheetArea:o},n.Rk={e9:t.rowViewportIndex,r9:t.colViewportIndex,Bk:t.hitTestType},n.Ok())},Jk:function(){var t,n,e,i,r,o,a,u,s,c,f,l,s,c,l,h,d,v,o,m,g,g,m,g,h,p,t=this;t.rb&&t.Kk&&(e=(n=t.imt).sheetArea,i=t.Q9(x,e,!0),r=t.K9(x,e,!0),0<=i&&0<=r&&(o=n.fromRange,a=n.rowOffset,u=n.colOffset,s=n.toRow,c=n.toCol,l=r,i!==s||l!==c)&&(n.toRow=i,n.toCol=l,c=(s=t.Mf).getRowCount(e),l=s.getColumnCount(e),h=o.row,d=o.col,v=o.rowCount,o=o.colCount,(g=(m=s.Ut).getFreeAreaRowCount(e))<c&&(c=g),(g=m.getFreeAreaColumnCount(e))<l&&(l=g),m=h<0?-1:w(0,M(c-v,i-a)),g=d<0?-1:w(0,M(l-o,r-u)),h=(0,A.Uvt)(s,(0,S.Ec)(m,g,v,o),x,e))&&(p=t.$vt()).rmt(n.paramRange.index,h,!0),t.a9())},ED:function(){var t,t,t=this;t.l9(),t.rb=!1,t.Kk=!1,t.imt=y,(t=t.$vt()).onRangeMoved&&t.onRangeMoved()},Ck:function(t){var n,e,i,r,i,o,a,e,o,u,a,s,c,f,l,n=this,e=n.Mf,i=n.$vt(),r=t.formulaRangeHitInfo;if(r&&i&&(i.XD&&i.qD(),o=(i=r.paramRange)&&i.text,i)&&o&&(a=(0,A.Vvt)(e,o))){if(n.Jvt(),e=a.row,o=a.row<0?-1:a.row+a.rowCount-1,u=a.col,a=a.col<0?-1:a.col+a.colCount-1,r.inTopLeft)s=o,c=a,f=e,l=u;else if(r.inTopRight)s=o,c=u,f=e,l=a;else if(r.inBottomLeft)s=e,c=a,f=o,l=u;else{if(!r.inBottomRight)return;s=e,c=u,f=o,l=a}n.rb=!0,n.Xk=!0,n.omt={paramRange:i,anchorRow:s,anchorCol:c,toRow:f,toCol:l,sheetArea:t.hitTestType},n.Rk={e9:t.rowViewportIndex,r9:t.colViewportIndex,Bk:t.hitTestType},n.Ok()}},Ik:function(t,n){var e=t.il;return!(e&&e.qMi||(e&&e.Dvt()?(this.Kvt(n),0):!this.qvt(t)))},qk:function(){var t,n,e,i,r,o,a,u,s,i,r,u,s,e,o,a,c,f,o,i,a,r,s,t=this;t.rb&&t.Xk&&(n=t.omt,e=S.SheetArea.viewport,n&&!I(n.sheetArea)&&(e=n.sheetArea),i=t.Q9(x,e,!0),r=t.K9(x,e,!0),0<=i&&0<=r&&(o=n.anchorRow,a=n.anchorCol,u=n.toRow,s=n.toCol,r=r,(i=i)!==u||r!==s)&&(n.toRow=i,n.toCol=r,s=(u=t.Mf).getRowCount(e),e=u.getColumnCount(e),a=a<0?e-1:a,c=M(o=o<0?s-1:o,i),f=M(a,r),o=w(o,i)-c+1,i=w(a,r)-f+1,a=t.$vt(),(0===c&&o===s||a&&a.Xvt===S.SelectionUnit.column)&&(o=c=-1),(0===f&&i===e||a&&a.Xvt===S.SelectionUnit.row)&&(i=f=-1),r=n.paramRange,s=(0,A.Uvt)(u,(0,S.Ec)(c,f,o,i),x,r.sheetArea))&&a.rmt(r.index,s,!0),t.a9())},jD:function(){var t,t,n,t=this;t.l9(),t.rb=!1,t.Xk=!1,t.omt=y,(t=t.$vt()).rl&&-(t.umt=1)!==(n=t.text().lastIndexOf(",",t.caret()))&&(t.umt=n+1),t.onRangeResized&&t.onRangeResized()},ZL:function(t,n,e){var i,r,o,a,u,s,c,f,l,h,l,d,d,v,m,g,p,l,i=this.Mf,r=this.$vt(),o=r&&r.smt();if(o&&0!==o.length&&r.cmt&&(a=t.rowViewportIndex,u=t.colViewportIndex,s=t.hitTestType,!this.yD(a,u,n,e)))for(h=o.length-1;0<=h;h--)if(l=(c=o[h]).sheetArea,!1!==c.allowDrag&&(I(l)||l===s)&&!((d=b.wvt.Rvt)&&d._text||(f=(0,A.Vvt)(i,c.text),I(f)))){if(I(l)&&(l=S.SheetArea.viewport),(d=i.Ut.findSpan(f.row,f.col,l))&&d.containsRange(f)&&(f=d),m=(l=i.getRangeRect(a,u,f)).x-2,g=l.x+l.width+1-(v=5),p=l.y-2,l=l.y+l.height+1-5,5+m<=n&&n<g&&(1+p<=e&&e<=3+p||1+l<=e&&e<=3+l))return{paramRange:c,inBorder:!0};if(5+p<=e&&e<l&&(1+m<=n&&n<=3+m||1+g<=n&&n<=3+g))return{paramRange:c,inBorder:!0};if(g<=n&&n<5+g&&l<=e&&e<5+l)return{paramRange:c,inBottomRight:!0};if(m<=n&&n<5+m&&l<=e&&e<5+l)return{paramRange:c,inBottomLeft:!0};if(g<=n&&n<5+g&&p<=e&&e<5+p)return{paramRange:c,inTopRight:!0};if(m<=n&&n<5+m&&p<=e&&e<5+p)return{paramRange:c,inTopLeft:!0}}return y},$vt:function(){var t=this.Mf;return t.il||t.mnn},hI:function(){var t,n,e,i,r,o,o,a,u,s,c,f,l,n,h,o,t=this,n=t.Mf,e=n.il;if(e)if(i=n.ui,r=n.ci,o=(o=n.parent)&&1===o.options.referenceStyle,a=new d.SheetParserContext(n,o,(0,T.eV)(i,r)),u=new T.Parser,e.XD)for(f=e.fmt(),l=0;l<f.length;l++){s=f[l];try{c=u.parse(a,s.text)}catch(t){c=y}c&&1===c.type&&(t.lmt(c,i,r,!0,!0),e.rmt(s.index,u.unparse(a,c)))}else if(s=e.zvt()){try{c=u.parse(a,s.text)}catch(t){c=y}c&&1===c.type&&(c.isFullColumn||c.isFullRow?(t.lmt(c,i,r,!0,!0),e.rmt(s.index,u.unparse(a,c))):c.hmt()?(t.dmt(c,i,r),e.rmt(s.index,u.unparse(a,c))):(n=s.textOffset+s.text.lastIndexOf(":"),(h=e.caret()<=n)?(t.lmt(c,i,r,!0,!1),o=u.unparse(a,c),e.rmt(s.index,o),e.caret(s.textOffset+o.lastIndexOf(":"))):(t.lmt(c,i,r,!1,!0),e.rmt(s.index,u.unparse(a,c)))))}},lmt:function(t,n,e,i,r){var o,a,i,o,o=t.rowRelative,a=t.columnRelative;i&&(o&&a?(t.rowRelative=!1,t.columnRelative=!1,t.row+=n,t.column+=e):!o&&a?(t.rowRelative=!0,t.columnRelative=!1,t.row-=n,t.column+=e):(t.columnRelative=!0,t.column-=e)),i=t.endRowRelative,o=t.endColumnRelative,r&&(i&&o?(t.endRowRelative=!1,t.endColumnRelative=!1,t.endRow+=n,t.endColumn+=e):!i&&o?(t.endRowRelative=!0,t.endColumnRelative=!1,t.endRow-=n,t.endColumn+=e):(t.endColumnRelative=!0,t.endColumn-=e))},dmt:function(t,n,e){var i=t.rowRelative,r=t.columnRelative;i&&r?(t.rowRelative=!1,t.columnRelative=!1,t.row+=n,t.column+=e):!i&&r?(t.rowRelative=!0,t.columnRelative=!1,t.row-=n,t.column+=e):(t.columnRelative=!0,t.column-=e)},Jvt:function(){var t,n,e,t,n=this.Mf.il;n&&(e=n.Ti)&&n.vmt(e)&&n.mmt()}})},"./dist/plugins/formulaTextbox/formulatextbox-render.js":function(t,n,e){"use strict";var L,F,P,G,n,U;function f(t,n,e,i,r,o){var a,u,s,c,f,l,h,d,v,m,g,p,b,y,w,M,C,S,w,T,A,I,I,w,x,x,N,k,D,_,B,E,j,O,R,a=t.Mf,u=a.rt,s=a.C6(e,i),c=o&&o.smt(),f=c&&c.length;if(!(f<=0)&&(l=t.uO(e,i,r))){for(n.save(),n.rect(l.x,l.y,l.width,l.height),n.clip(),n.beginPath(),h=[],d=u.isFormulaRangeHovering,v=u.AD,m=u.Kk,g=u.imt,p=u.Xk,b=u.omt,T=0;T<f;T++)if(("number"!=typeof(w=(y=c[T]).sheetArea)||w===s)&&(w=y.text,M=y.ranges&&0<y.ranges.length?y.ranges:[(0,P.Vvt)(a,w)])){if((A=G.wvt.Rvt)&&A.Mf&&void 0!==w)if(U.OS(w,"!")){if(I=U.gmt(w,"!"),a.name()!==I&&"'"+a.name()+"'"!==I)continue}else if(I=U.gmt(w,"["),w=a.tables,x=(x=a.NMi)&&x._gi===L.SheetType.tableSheet&&x.name()===I,!(a.getCustomNames()[I]||w&&w.findByName(I)||x))continue;for(C=t.fO(e,i,M,l),N=0;N<C.length;N++)(k=C[N])&&0<k.width&&0<k.height&&(S=o.pmt(T),o.bmt(y)||y.isPivotClickCell?(d&&v.paramRange.index===T&&(n.beginPath(),n.lineWidth=2,n.strokeStyle=S,n.rect(k.x+1,k.y+1,k.width-3,k.height-3),n.stroke()),t.wO(n,k,S)):(d&&v.paramRange.index===T||m&&g.paramRange.index===T||p&&b.paramRange.index===T?(n.beginPath(),n.lineWidth=2,n.strokeStyle=S,n.rect(k.x+1,k.y+1,k.width-3,k.height-3)):(n.beginPath(),n.lineWidth=2,n.strokeStyle=S,n.rect(k.x,k.y,k.width-1,k.height-1)),n.stroke()),o.ymt(y)&&((D=F.Common.ft._(S)).a=.1,n.beginPath(),n.fillStyle=F.Common.ft.j(D),n.fillRect(k.x+1,k.y+1,k.width-3,k.height-3)),h.push({rect:k,color:S,allowDrag:y.allowDrag}))}if(0<h.length&&o.cmt)for(_=h.length,T=0;T<_;T++)k=h[T].rect,S=h[T].color,E=k.x-2,j=k.x+k.width+1-(B=5),O=k.y-2,R=k.y+k.height+1-5,!1===h[T].allowDrag||(A=G.wvt.Rvt)&&A._text||(n.beginPath(),n.fillStyle=S,n.fillRect(E,O,5,5),n.fillRect(j,O,5,5),n.fillRect(E,R,5,5),n.fillRect(j,R,5,5));n.beginPath(),n.restore()}}Object.defineProperty(n,"__esModule",{value:!0}),L=e("Core"),F=e("Common"),P=e("./dist/plugins/formulaTextbox/formulatextbox.js"),G=e("./dist/plugins/formulaTextbox/formulatextbox-acrosssheet.js"),n=L.GC$.extend,U=F.Common.zf,n(L.g7.prototype,{ID:function(){var t,n,n,e,t=this,n=t.Mf;0<n.My||(n=n.Fi(),e=t.J(),t.FA(n.x,n.y,n.width,n.height),t.jy(e))}}),L.Worksheet.ch("formulatextboxrender",{paintAdornment:function(t){var n,e,i,r,o,a,u,s,c,n=this,e=t.ctx,i=t.clipRect,r=n.Dn,o=n.Fi(),c=n.rt.$vt();if(c)for(u=-1;u<=2;u++)for(s=-1;s<=2;s++)-1===u&&-1===s||(a=-1===u?o.L1(s):-1===s?o.B1(u):o.c9(u,s))&&0!==a.width&&0!==a.height&&f(r,e,u,s,i,c)}})},"./dist/plugins/formulaTextbox/formulatextbox.js":function(n,u,t){"use strict";var p,h,d,b,v,y,s,c,w,t,a,l,f,m,g,M,e,C,S,r,T,i,A,o,I,x,N,k,F,P,G,U,H,D,_,E,z,V,Y,Z,W,Q,J,K,X,q,$,j,O,tt,nt,t,et,it,rt;function ot(t,n){for(var e,i,e=0,i=0;i<t.length;i++)t[i]===n&&e++;return e}function at(){var e=[];return b.GC$.each(p.sR().wmt,function(t,n){p.Functions.Mmt[t]&&(n.name=t,e.push(n))}),e}function ut(t){var e=[],i;return b.GC$.each(t,function(t,n){(i=n.description())&&(i.name=t,e.push(i))}),e}function st(t,n,e){if(t){var i=!1,r=!1;if(1===n.rowCount){if(t.hasHeadersRow()&&n.row===t.startRow())return 1;if(t.hasTotalsRow()&&n.row===t.endRow())return 1;if(n.row===e&&n.col>=t.startColumn()&&n.col+n.colCount<=t.startColumn()+t.dataRange().colCount)return 1}else t.hasHeadersRow()&&n.row===t.startRow()&&(n.rowCount===t.dataRange().rowCount+1&&(i=!0),t.hasTotalsRow())&&n.rowCount===t.dataRange().rowCount+1+1&&(i=!0),n.row===t.dataRange().row&&(n.rowCount===t.dataRange().rowCount&&(i=!0),t.hasTotalsRow())&&n.rowCount===t.dataRange().rowCount+1&&(i=!0);return n.col+n.colCount<=t.startColumn()+t.dataRange().colCount&&(r=!0),i&&r}}function ct(t){return t.replace(/'/g,"''")}function ft(t){var t=t.name();return h.Cmt(t.split(""),!1)?t:"'"+ct(t)+"'"}function R(t){var n,n,n=p.getMapping()&&p.getMapping().builtInFunctionsMapping,n=n&&n[t]&&n[t].alias||t;return m.j0(n)}function lt(t,n,e){var e;return e?(e=new RegExp("\u200b","g"),t.replace(e,"")===n.replace(e,"")):t===n}function ht(t,n,e,i){var r,o,a,u,a,s,s,c,f,f,e,r,l;return void 0===i&&(i=b.SheetArea.viewport),n?(r=t.il,u=(a=(o=v.wvt.Rvt)&&o.Mf||t).ui,a=a.ci,s=(s=t.parent)&&1===s.options.referenceStyle,c=15,(t.il&&t.il.Ivt||e)&&(c=0),n.row<0&&n.col<0&&(n=new b.Range(0,-1,t.getRowCount(),-1)),f=(f=t.tables)&&f.find(n.row,n.col),(o&&o.Ivt||e)&&(c=0),r&&!r.rl&&st(f,n,u)?(o&&o._text&&o.Mf!==t&&(a=-1),h.rangeToFormulaWithStructReference(t,n,u,a,c,s,f)):(e=t.NMi,!f&&i===b.SheetArea.viewport&&e&&e._gi===b.SheetType.tableSheet?mt(t,n.col,n.colCount,f=e):(r=h.rangeToFormula(n,u,a,c,s),o&&o._text||t.il&&t.il.rl&&t.il.Smt?(l=ft(t))+"!"+r:r))):y}function dt(t){for(var n,e,i,r,o,a,n=[],e=0,i="";i!==y;)i=t.getColumnName(e),o=void 0,t.Mf.NMi&&(o=t.FDi(e))&&(r=e),e++,i!==y&&n.push({name:i,description:"",isGroupColumn:o});return a={columns:n},M(r)||(a.groupInfo={rightGroupColumnIndex:r}),a}function vt(t){return t&&"["===t[0]&&"]"===t[t.length-1]}function mt(t,n,e,i){var r,o,r,i,r,r,e,n,r=dt(i),o=r.columns,r=r.groupInfo,i=i.name();if(-1===n&&(n=0),-1===e&&(e=o.length),r){if(r=r.rightGroupColumnIndex,1===e&&n<=r)return"";if(1<e&&n<=r){if(n+e<=r+1)return"";e-=r-n+1,n=r+1}}return 1===e?"".concat(i,"[").concat(o[n].name,"]"):1<e?(r=n+e-1,vt(e=o[n].name)||(e="[".concat(e,"]")),vt(n=o[r].name)||(n="[".concat(n,"]")),"".concat(i,"[").concat(e,":").concat(n,"]")):""}function gt(e,t,n,i,r,o){var a,u,n,t,s,c,f,a=e.parent,u=a&&a.options;(t&&u&&u.allowUserEditFormula&&u.enableFormulaTextbox||n)&&(e.il&&e.il.destroy(),e.il=new rt(t,null,a),n=e.il.text(),t=e.getFormulaInformation(i,r,o),"="!==n[0]||t&&t.hasFormula||"="===n||u.allowInvalidFormula||e.il.text(n="'"+n),s=e.il,c=e.rt,f=e.Dn,s.bind("AppendStarted",function(){s.close();var t=e.Di;1!==t&&(e.Di=1,e._i(t,1))}),s.bind("AppendEnded",function(){f.ID()}),s.bind(N,function(t,n){var n;e.xT||(n&&n.type!==T&&(c.By(n),n=e.getCellType(i,r,o),e.ki(b.Events.EditChange,{sheet:e,sheetName:e.name(),row:i,col:r,editingText:n.getEditorValue(e.li)})),f.ID(),e.ki(b.Events.FormulaTextBoxTextChanged,{sheet:e,sheetName:e.name(),text:s.text(),sheetArea:o}))}),s.bind("CaretChanged",function(){f.ID(),e.ki(b.Events.FormulaTextBoxCaretChanged,{sheet:e,sheetName:e.name(),caret:s.caret()})}),s.add(at()),s.add(ut(p.Functions.Tmt)),s.add(ut(e.Amt).concat(ut(a.Amt))),f.ID())}function pt(t){t.il&&(t.il.destroy(),t.il=y,t.Dn.ID());var n=t.parent&&t.parent.h6;f.activeElement===(n&&n.Ti)&&t.rt.aA()}function bt(t,n){var e,e,i,e;if(n){i=(e=(e=v.wvt.Rvt)&&e.Mf||t).ui,e=e.ci;try{return h.formulaToRange(t,n,i,e)}catch(t){}}return y}function yt(t,n){var t,e,i,e,i,r,e,t,o,i,o,t=(0,b.GC$)(t);return t.attr("contenteditable","false"),e=a("table"),(0,b.GC$)(e).css("border-spacing","0"),(0,b.GC$)(e).css("width","100%"),t.append(e),i=a("tbody"),e.appendChild(i),e=document.createElement("tr"),i.appendChild(e),i=document.createElement("td"),(0,b.GC$)(i).css("padding-right","0px"),e.appendChild(i),r=document.createElement("td"),(0,b.GC$)(r).css("width","23px"),(0,b.GC$)(r).css("padding-right","0px"),e.appendChild(r),e=t.width()-(0,b.GC$)(r).width(),t=a("div"),o=a("div"),(0,b.GC$)(o).width(e),(0,b.GC$)(o).css({"overflow-y":"auto","overflow-x":"hidden",height:"20px"}),o.appendChild(t),i.appendChild(o),i=a("div"),r.appendChild(i),(0,b.GC$)(t).css({display:"inline-block",float:"left",height:"auto",outline:"none"}),(0,b.GC$)(t).width(e),(0,b.GC$)(t).attr("contenteditable","true"),(0,b.GC$)(t).attr("spellcheck","false"),(o=(0,b.GC$)(i)).css({display:"block",float:"right",width:"23px",height:"23px",background:K,"background-repeat":"no-repeat"}),o.bind("click",function(){n.Imt?(n.Vv.ki("RangeSelectEnding",n),n.endSelectMode()):n.startSelectMode()}),{contentDiv:t,button:i}}function wt(t){for(var n,e,n=["FILTER","RANDARRAY","SEQUENCE","SORT","SORTBY","UNIQUE","MAP","REDUCE","SCAN","MAKEARRAY","BYROW","BYCOL","TEXTSPLIT","HSTACK","VSTACK","TOROW","TOCOL","WRAPROWS","WRAPCOLS","TAKE","DROP","EXPAND","CHOOSEROWS","CHOOSECOLS"],e=0;e<n.length;e++)if(t===n[e])return 1}function B(t,n,e){var i,r,n,n,o,a,i=this,r=t;if(i.rl=!1,i.Ivt=!1,i.xmt=!0,i.Smt=!0,i.Nmt=[],i.kmt=[],i.Dmt=[],i.U6=!1,n&&n.rangeSelectMode&&(!0===n.absoluteReference&&(i.Ivt=!0),!1===n.needSheetName&&(i.Smt=!1),!1===n.acrossSheet&&(i.xmt=!1),i.Xvt=n.selectionUnit,i.rl=!0,i.Imt=!1,i._mt=!1,r=(n=yt(i.Emt=t,i)).contentDiv,i.jmt=n.button,i.Omt=t,i.Avt=it,it++),i.cmt=!0,i.Hc(e&&e.getHost()||f.body),r&&i.Rmt(r),e&&(i.Bmt=!0,i.Lmt(e),i.Vv._3(b.Events.FormulaTextboxActiveSheetChanging+I,v.wvt.Ovt),i.Vv.D3(b.Events.FormulaTextboxActiveSheetChanging+I,v.wvt.Ovt),i.Vv._3(b.Events.FormulaTextboxActiveSheetChanged+I,v.wvt.Bvt),i.Vv.D3(b.Events.FormulaTextboxActiveSheetChanged+I,v.wvt.Bvt),i.Vv._3(b.Events.FormulaTextBoxUpdatePosition+A,void 0),i.Vv.D3(b.Events.FormulaTextBoxUpdatePosition+A,function(t,n){i.u_()})),n=i.text(),i.Fmt=i.Ost(n),o=i.vmt(r)){i.Pmt(i.Fmt);try{(a=l.getSelection()).selectAllChildren(r),0<a.rangeCount&&a.collapseToEnd()}catch(t){}(0,b.GC$)(i.Ti).data(j,n)}(0,b.GC$)(t).data(u.CONST_FORMULATEXTBOX,i)}function Mt(){var t,n,e,n,t=l.getSelection();0<t.rangeCount&&(n=t.getRangeAt(0),(e=f.createElement("span")).innerHTML="<br/>\u200b",n.insertNode(e),(n=f.createRange()).setStartAfter(e),n.setEndAfter(e),n.collapse(!1),t.removeAllRanges(),t.addRange(n))}function L(t){return"gcAttachedFormulaTextBox"===t.target.getAttribute("gcuielement")}Object.defineProperty(u,"__esModule",{value:!0}),u.FormulaTextBox=u.Vvt=u.Wvt=u.Evt=u.Uvt=u.CONST_FORMULATEXTBOX=void 0,p=t("CalcEngine"),h=t("SheetsCalc"),d=t("Common"),b=t("Core"),v=t("./dist/plugins/formulaTextbox/formulatextbox-acrosssheet.js"),y=null,s=void 0,c=Math.max,w=Math.min,t=b.GC$.extend,a=b.mt.En,l=window,f=document,m=d.Common.zf,g=b.mt.vi,M=d.Common.lt.ht,e=b.mt.Tt,C=e.msie&&parseInt(e.version,10)<10,S=m.Gmt,u.CONST_FORMULATEXTBOX="formulatextbox",r="gcUIElement",T="input",i="\xa0",A=".gcFormulaTextBoxInternal",o=".gcFormulaTextBox",I=".gcFormulaTextBoxAcrossSheetInternal",x=".gcsj-func-ac-row",N="TextChanged",k="CaretChanged",F="AppendStarted",P="AppendEnded",U=37,H=39,D=38,_=40,E=9,z=13,V=33,Y=34,Z=35,W=36,Q=27,J=["#0000ff","#008000","#9900cc","#800000","#00cc33","#cc6600","#cc0099"],K='url("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABMAAAARCAIAAACw+gCQAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAADsMAAA7DAcdvqGQAAAJSSURBVDhPY3hILqBYZ/eqV81LXpbNfp7S/yS0+Z5p+olD5x5OWXGyYcaBmql7yifuLOnbBkRFPVuACKIFqjNzwv2Qhhue5ReByK/qYlDtxb///n35+efd1z/PP/wB6vn2+/f7b79ffgIhiBaoTlPP5I2bN2/asmX7jh3Hjh+ft3wLUOfX779ef/h+6+nHtXsuffrx+/bj16euvwQiiBaETiAy904NTasGantRkvA8wetpsO0NJ839htKb9l/Jal6T3rgytX4FEEG0QHXuOnbr55+/P379AyIg40m8x8uZ3U+aC49bKn64eHzX0es4Xds0Y9ejl++vPXx3+f77Nx9/3PU3e5YR/CTM4WGs53pVPqBrgX6+8+QNFtdmNq0q6NpU1LOpe/6+o+fvH3fR36XCc9dE/KG3EdDNQPaF7VunLTuY0bA0omg2RAtUZ1LNUohjgCEJDJVtdlpPty6dr8x3yUDsvoPqRm2hqcp8Jy+9WbH/7cQ1EB0wnXEVCyBBt+fc8+NXXy9Yf/znz5/31swFaliiKjBZme/yrSe7z36YsuZBy4KbEC1QnRFFcxKqFgP1A1Fq7ZKcpqU1EzYuWX/kxIa1/WBtizYcAwqG5E71SZsA0QLVGZI3A+Lax+/+ACMwvHDmsn1v1xx8e+jSp83HXgP1ALmztryYsv4ZEEG0QHUGZk+FuHbHqadABORO3fC8Z/mdvmU3Oxdd9cuY1LX0VsOci/WzQQiiBaET4lQgii1fEFU6F4iAXgC6JShnakDWZKBmoDshCKIFqpMMQK7Ohw8BTajNa73pg9oAAAAASUVORK5CYII=")',X='url("data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz4KPHN2ZyB3aWR0aD0iMTZweCIgaGVpZ2h0PSIxNnB4IiB2aWV3Qm94PSIwIDAgMTYgMTYiIHZlcnNpb249IjEuMSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB4bWxuczp4bGluaz0iaHR0cDovL3d3dy53My5vcmcvMTk5OS94bGluayI+CiAgICA8dGl0bGU+U1BKUyBBbm90aGVyLVNlbGVjdGluZzwvdGl0bGU+CiAgICA8ZyBpZD0iU1BKUy1Bbm90aGVyLVNlbGVjdGluZyIgc3Ryb2tlPSJub25lIiBzdHJva2Utd2lkdGg9IjEiIGZpbGw9Im5vbmUiIGZpbGwtcnVsZT0iZXZlbm9kZCI+CiAgICAgICAgPGcgaWQ9IlN3aXRjaC1yb3cvY29sdW1uIiB0cmFuc2Zvcm09InRyYW5zbGF0ZSgwLjAwMDAwMCwgMS4wMDAwMDApIj4KICAgICAgICAgICAgPHJlY3QgaWQ9IlJlY3RhbmdsZS04IiBmaWxsPSIjRDVENUQ1IiB4PSIwIiB5PSIwIiB3aWR0aD0iMTYiIGhlaWdodD0iMTMiPjwvcmVjdD4KICAgICAgICAgICAgPHJlY3QgaWQ9IuefqeW9oiIgZmlsbD0iI0ZGRkZGRiIgeD0iMyIgeT0iNSIgd2lkdGg9IjEwIiBoZWlnaHQ9IjQiPjwvcmVjdD4KICAgICAgICAgICAgPHBhdGggZD0iTTMsNSBMMTMsNSBMMTMsOSBMMyw5IEwzLDUgWiBNNCw2IEw0LDggTDEyLDggTDEyLDYgTDQsNiBaIiBpZD0i55+p5b2iIiBmaWxsPSIjNjY2NjY2IiBmaWxsLXJ1bGU9Im5vbnplcm8iPjwvcGF0aD4KICAgICAgICAgICAgPHBhdGggZD0iTTAsMCBMMTYsMCBMMTYsMTMgTDAsMTMgTDAsMCBaIE0xLDEgTDEsMTIgTDE1LDEyIEwxNSwxIEwxLDEgWiIgaWQ9IuefqeW9oiIgZmlsbD0iIzY2NjY2NiIgZmlsbC1ydWxlPSJub256ZXJvIj48L3BhdGg+CiAgICAgICAgICAgIDxnIGlkPSLnvJbnu4QtOCI+CiAgICAgICAgICAgICAgICA8cmVjdCBpZD0i55+p5b2iIiBmaWxsPSIjODFCRUZDIiB4PSIxIiB5PSIxIiB3aWR0aD0iMTQiIGhlaWdodD0iMiI+PC9yZWN0PgogICAgICAgICAgICAgICAgPHBhdGggZD0iTTE2LDAgTDE2LDQgTDAsNCBMMCwwIEwxNiwwIFogTTE1LDEgTDEsMSBMMSwzIEwxNSwzIEwxNSwxIFoiIGlkPSLlvaLnirbnu5PlkIgiIGZpbGw9IiMzNjdGQzkiIGZpbGwtcnVsZT0ibm9uemVybyI+PC9wYXRoPgogICAgICAgICAgICA8L2c+CiAgICAgICAgICAgIDxnIGlkPSLnvJbnu4QtOSIgdHJhbnNmb3JtPSJ0cmFuc2xhdGUoMi41ODc3NjcsIDYuMDAwMDAwKSIgZmlsbC1ydWxlPSJub256ZXJvIj4KICAgICAgICAgICAgICAgIDxwb2x5Z29uIGlkPSJTaGFwZSIgZmlsbD0iI0ZBNzU0MSIgcG9pbnRzPSI1LjQxMjIzMjg1IDcgMi40MTIyMzI4NSAzLjk5NTM1Mjk1IDQuNDEyMjMyODUgMy45OTUzNTI5NSA0LjQxMjIzMjg1IDEgNi40MTIyMzI4NSAxIDYuNDEyMjMyODUgMy45OTUzNTI5NSA4LjQxNDAzOTk4IDMuOTk1MzUyOTUiPjwvcG9seWdvbj4KICAgICAgICAgICAgICAgIDxwYXRoIGQ9Ik0xMC44MjY2NDAyLDIuOTk1MzUyOTUgTDUuNDEyMDE5ODEsOC40MTUwOTU5NCBMMC4wMDA2NTkxMTExNjIsMi45OTUzNTI5NSBMMy40MTIyMzI4NSwyLjk5NTM1Mjk1IEwzLjQxMjIzMjg1LDAgTDcuNDEyMjMyODUsMCBMNy40MTIyMzI4NSwyLjk5NTM1Mjk1IEwxMC44MjY2NDAyLDIuOTk1MzUyOTUgWiBNNS40MTIyMzI4NSw3IEw4LjQxNDAzOTk4LDMuOTk1MzUyOTUgTDYuNDEyMjMyODUsMy45OTUzNTI5NSBMNi40MTIyMzI4NSwxIEw0LjQxMjIzMjg1LDEgTDQuNDEyMjMyODUsMy45OTUzNTI5NSBMMi40MTIyMzI4NSwzLjk5NTM1Mjk1IEw1LjQxMjIzMjg1LDcgWiIgaWQ9IlNoYXBlIiBmaWxsPSIjRkZGRkZGIj48L3BhdGg+CiAgICAgICAgICAgIDwvZz4KICAgICAgICA8L2c+CiAgICA8L2c+Cjwvc3ZnPg==")',q="background",$="background-repeat",j="text-before",O="caret-before",tt="\u200b",nt="=",u.Uvt=ht,b.Events.FormulaTextBoxTextChanged="FormulaTextBoxTextChanged",b.Events.FormulaTextBoxCaretChanged="FormulaTextBoxCaretChanged",b.Events.FormulaTextBoxUpdatePosition="FormulaTextBoxUpdatePosition",l.Vc.wf.push(function(t,n){var e,n,e=v.wvt;!n&&t.endEdit&&e&&(n=e.Rvt)&&n.bvt&&t.il&&(t.il&&t.il.destroy(),t.il=y,n.rl||n.d5())}),u.Evt=gt,u.Wvt=pt,u.Vvt=bt,t(b.Hv.prototype,{C2:function(t){return!(t&&t.il&&t.il.Dvt())},D2:function(t){return!t||!t.il||!!t.il.xmt}}),b.Worksheet.ch(u.CONST_FORMULATEXTBOX,{startEdit:function(t){t.preventFormulaTextBox||gt(this,t.element,s,t.row,t.col,t.sheetArea)},endEdit:function(){pt(this)},preProcessKeyDown:function(t){var n,n,n=this.il;(n&&n.$D(t.e)||(n=this.parent&&this.parent.h6)&&n.$D(t.e,t.c))&&(t.r=!0)}}),t=b.Hv.prototype,et=t.O2,b.Hv.ch(u.CONST_FORMULATEXTBOX,{preProcessMouseDbClick:function(t){var n,n,n,e,n=(0,b.jf)(this.Vv),n=n?n.il:void 0,n=n&&n.Dvt(),e=v.wvt.Rvt;n?t.r=!1:e&&e.bvt&&e.d5()}}),t.O2=function(){var t=(0,b.jf)(this.Vv),t=t&&t.il,n=v.wvt.Rvt,n=n&&n._text;return et.call(this)&&!n&&!t},it=1,B.prototype.Umt=function(t){var n,e,i,e,t,r,o,n=this;n.Hmt(),n.FD(),n._mt=!0,e=(0,v.Mvt)(n.Vv.Ti),(i=n.zmt())&&(i.suspendPaint(),gt(i,e,!0,i.ui,i.ci,3),(e=i.il).rl=!0,e.Avt=n.Avt,e.Ivt=n.Ivt,e.Smt=n.Smt,e.Xvt=n.Xvt,e.xmt=n.xmt,t&&(n.text(t),n.caret(t.length)),t=n.text(),(r=n.caret())<=0&&(r=t.length),n.focus(),n.caret(r),n.XD=!0,-(n.umt=1)!==(o=t.lastIndexOf(",",r))&&(n.umt=o+1),t||(n.text("="),t="=",n.caret(1),r=1),"="!==t[0]&&(t="="+t,r++),e.text(t),e.caret(r),e.XD=n.XD,e.umt=n.umt,i.resumePaint())},B.prototype.startSelectMode=function(t){var t,n,t=t;t&&0!==t.indexOf("=")&&(t="="+t),(n=this).rl=!0,n.Imt=!0,(0,b.GC$)(n.jmt).css([q,$],[X,"no-repeat"]),n.Umt(t)},B.prototype.endSelectMode=function(){this.Imt=!1,this.Vmt(),(0,b.GC$)(this.jmt).css([q,$],[K,"no-repeat"])},B.prototype.Vmt=function(){var t=this.zmt();t&&(t.ol(!0,s,!0),t.repaint())},B.prototype.Ak=function(t){t&&(this.Dmt=[t])},B.prototype.Gce=function(){this.Dmt=y},B.prototype.Ymt=function(){return this.Dmt},B.prototype.destroy=function(){var t=this;t.Imt&&t.Vmt(),t.Dmt=y,t.XD=!1,t.umt=-1,t.Zmt(),t.Wmt(),t.Qmt(),(0,b.GC$)(t.Kmt).remove(),(0,b.GC$)(t.Jmt).remove(),(0,b.GC$)(t.F0).remove()},B.prototype.bind=function(t,n,e){var i=this.Ti;i&&t&&(t=t.split(/\s+/).join(o+" "),(0,b.GC$)(i).bind(t+o,n,e))},B.prototype.unbind=function(t,n){var e=this.Ti;e&&t&&(t=t.split(/\s+/).join(o+" "),(0,b.GC$)(e).unbind(t+o,n))},B.prototype.unbindAll=function(){var t=this.Ti;t&&(0,b.GC$)(t).unbind(o)},B.prototype.caret=function(t){var n,e,i,r,n=this,e=n.Ti;if(e){if(i=f.activeElement===e,r=(0,b.GC$)(e),0===arguments.length)return i?n.Xmt(e).end:r.data(O);t!==n.caret()&&(i?(n.qmt(e,t),r.data(O,n.Xmt(e).end)):r.data(O,t),n.ki(k,{}))}},B.prototype.Xmt=function(t){var n,e,i,n,n,r,n=this,e=-1,i=-1;return n.$mt(t)?(e=t.selectionStart,i=t.selectionEnd):n.vmt(t)&&0<(n=l.getSelection()).rangeCount&&((r=(n=n.getRangeAt(0)).cloneRange()).selectNodeContents(t),r.setEnd(n.endContainer,n.endOffset),i=r.toString().length,(r=n.cloneRange()).selectNodeContents(t),r.setEnd(n.startContainer,n.startOffset),e=r.toString().length,r.detach()),{start:e,end:i}},B.prototype.qmt=function(t,n){var e,n,i,e,r,e=this;e.$mt(t)?t.setSelectionRange(n,n):e.vmt(t)&&(e=this.tgt(t,n))&&(n=l.getSelection(),i=f.createRange(),(r=e.node)&&1===r.childNodes.length?i.setStart(r.firstChild,e.offset):r.lastChild&&r.lastChild.length&&i.setStart(r.lastChild,r.lastChild.length),i.collapse(!0),n.removeAllRanges(),n.addRange(i),this.rl)&&(t.parentElement.scrollTop=t.parentElement.scrollHeight)},B.prototype.text=function(t){var n,e,i,i,r,o,a,u,a,a,i,r,n=this,e=n.Ti,i=n.zmt();if(!e)return"";if(!i||i.xT)return e.innerHTML="";if(i=n.$mt(e),r=n.vmt(e),o=n.ffe(e),0===arguments.length){if(a="",i)a=e.value;else if(r){if(0<(u=e.getElementsByClassName("gcsj-func-gray-formula")).length)return"";0<=(a=(a=C?b.mt.oi(e):e.innerText).replace(/\r\n?/g,"\n")).indexOf("\xa0")&&(a=b.mt.yi(a,"\xa0"," "))}else o&&0<=(a=(a=C?b.mt.oi(e):e.innerText).replace(/\r\n?/g,"\n")).indexOf("\xa0")&&(a=b.mt.yi(a,"\xa0"," "));return a}(t=null==t?"":t)!==n.text()&&(a=n.ngt(t),n.Fmt=a?n.Ost(a):n.Ost(t),i?e.value=t:r?(a=n.egt(n.Fmt,t),n.Pmt(a),n.caret(t.length)):o?e.innerHTML=t:e.value=t,i={},(r=v.wvt.Rvt)&&r._text&&(i={sheet:r.Mf,editor:r.bvt&&r.bvt.firstChild.firstChild,canvasOffset:r.yvt}),n.ki(N,i)),n.igt&&n.rgt()},B.prototype.I6=function(){var t=this;(0,b.GC$)(t.Ti).data(j,t.text())},B.prototype.autoComplete=function(t){if(0===arguments.length)return this.ogt;this.ogt=t},B.prototype.showHelp=function(t){if(0===arguments.length)return this.agt;this.agt=t},B.prototype.add=function(t){var n,e;if(t)if(b.GC$.isArray(t))for(n=t.length,e=0;e<n;e++)this.ZP(t[e]);else this.ZP(t)},B.prototype.ZP=function(t){var n,e,i,r,o,n=t&&S(R(t.name));if(n){for(i=(e=this.ugt).length,r=0;r<i;r++){if((o=S(e[r].name))===n)return;if(n<o)break}e.splice(r,0,t)}},B.prototype.remove=function(t){var n,e,i;if(t)for(t=S(t),e=(n=this.ugt).length,i=0;i<e;i++)if(S(n[i].name)===t){n.splice(i,1);break}},B.prototype.workbook=function(t){var n=this;if(0===arguments.length)return n.Vv;t===y?n.rl&&n.Vmt():(n.Lmt(t),n.sgt())},B.prototype.Lmt=function(t){var n,e;t&&((n=this).Vv&&n.Wmt(),e=n.Ti)&&(n.Vv=t)},B.prototype.smt=function(){var t,n,e,i,r,o,a,u,s,c,t=[],n=this.Fmt,e=n&&n.length,o=0,a=0;if(0<e)for(u=0;u<e;u++)r=(i=n[u]).text,11===i.type&&(s={textOffset:o,text:r,ranges:i.ranges,index:a,allowDrag:i.allowDrag},"number"==typeof i.sheetArea&&(s.sheetArea=i.sheetArea),t.push(s),a++),o+=r.length;return(c=this.Fvt)&&t.push({ranges:[c],index:a,allowDrag:!1,isPivotClickCell:!0}),t},B.prototype.zvt=function(){var t,n,e,i,r,o,a,t=this.Ti,n=this.smt();if(t&&n&&0<n.length)for(e=this.caret(),i=n.length,o=r=void 0,a=0;a<i;a++){if((o=(r=n[a]).textOffset)<=e&&e<=o+r.text.length)return r;if(e<=o)break}return y},B.prototype.ymt=function(t){var n,e,t;return!!t&&(n=this.caret(),e=t.text,(t=t.textOffset)<=n)&&n<=t+e.length},B.prototype.pmt=function(t){var n,e,i,r,o,a,u,s,c,n=this.smt(),e=n.length;if(t<0||e<=t)return"";for(i=[],a=o=0;a<e;a++){for(r=n[a],u=!1,s=0;s<i.length;s++)if(r.text&&i[s].text.replace(/\s+/g,"").toUpperCase()===r.text.replace(/\s+/g,"").toUpperCase()){u=!0;break}if(u){if(t===a){o=s;break}}else if(i.push(r),t===a){o=i.length-1;break}}return J[o%J.length]},B.prototype.Dvt=function(){var t,n,t;return!!this.XD||!!this.rl||!!(0,b.Df)(this.text())||!!(t=this.cgt(this.caret()))&&(n=t.type,t=t.text,1===n||8===n||7===n&&"%"!==t||5===n||9===n||15===n)},B.prototype.bmt=function(t){var n,e,n;return!(!t||!this.XD)&&(n=this.umt,e=this.caret(),n<=(n=t.textOffset))&&n<e},B.prototype.fmt=function(){var t,n,e,i,r,t=[],n=this.smt(),e=n.length;if(0<e)for(r=0;r<e;r++)i=n[r],this.bmt(i)&&t.push(i);return t},B.prototype.Gvt=function(t,n,e,i,r){var o,a,a,u,s,c,e,n,n,f,e,i,u;if(void 0===r&&(r=b.SheetArea.viewport),a=(o=this).Ti,t&&a){if(!o.XD){if(!o.Dvt())return;o.XD=!(n=!1),o.umt=o.caret(),o.ki(F,{})}a=o.umt,u=o.text(),s=o.caret(),u||(u="=",s=a=o.umt=1),c=s,e&&(n=!1,u=u.substr(0,a)+(s<0?"":u.substr(s)),o.Fmt=o.Ost(u),c=s=a),e=o.cgt(s),n?(n=(n=u.substr(0,s)).substr(0,n.length-e.text.length)).length>=a&&(e.text=t,c=n.length+t.length):(n=o.Fmt,f=d.Common.Uf.hD(n,e),e=o.rl&&1<n.length&&f===n.length-1&&11===e.type,i?(t=a<s||e?u+this.fgt()+t:u.slice(0,s)+t+u.slice(s),o.Fmt=o.Ost(t)):a<s||e?(n.splice(f+1,0,{text:this.fgt(),type:8}),n.splice(f+2,0,{text:t,type:11,sheetArea:r}),t=","+t):n.splice(f+1,0,{text:t,type:11,sheetArea:r}),c=s+t.length),o.lgt(),i={},(u=v.wvt.Rvt)&&u._text&&(i={sheet:u.Mf,editor:u.bvt&&u.bvt.firstChild.firstChild,canvasOffset:u.yvt}),o.ki(N,i),o.caret(c)}},B.prototype.qD=function(){var t=this;t.XD&&(t.XD=!1,t.umt=-1,t.ki(P,{}))},B.prototype.Nvt=function(){this.XD=!0,this.umt=this.caret()},B.prototype.Tvt=function(t){return void 0!==t&&(this.umt=t),this.umt},B.prototype.rmt=function(t,n,e){var i,r,o,a,u,s,c,f,l,i=this,r=i.Ti;if(r&&!(t<0)&&n){for(o="",a=!1,s=(u=i.Fmt)&&u.length,l=f=0;l<s;l++){if(11===(c=u[l]).type&&f++===t){u[l]={text:n,type:11,sheetArea:c.sheetArea},a=!0;break}o+=c.text}a&&(i.lgt(),i.ki(N,{}),e?i.caret(i.text().length):i.caret(o.length+n.length))}},B.prototype.sgt=function(){var t,n,n,t=this;t.Vv&&(n=t.Ti,t.Vv)&&n&&(n.setAttribute(r,"gcAttachedFormulaTextBox"),t.rl||(t.Vv.h6=t),t.Vv.D3(b.Events.FormulaTextboxEditStarted+A,t,t.hgt),t.Vv.D3(b.Events.FormulaTextboxEnterCell+A,t,t.dgt),t.Vv.D3(b.Events.FormulaTextboxEditEnded+A,t,t.vgt),t.Vv.D3(b.Events.FormulaTextboxActiveSheetChanged+A,t,t.mgt),t.Vv.D3(b.Events.FormulaTextboxRangeChanged+A,t,t.ggt),t.Vv.D3(b.Events.FormulaTextBoxTextChanged+A,t,t.pgt),t.Vv.D3(b.Events.FormulaTextBoxCaretChanged+A,t,t.bgt),t.Vv.D3(b.Events.ValueChanged+A,t,t.ygt),(n=(0,b.jf)(t.Vv))&&!t.rl&&t.text(t.wgt(n,n.ui,n.ci)),t.D3(N,t,t.Mgt),t.D3(k,t,t.Cgt))},B.prototype.refresh=function(t){var n,e,n,n=this.Vv,e=this;n&&(n=(0,b.jf)(n))&&!e.rl&&(e.rb=!!t||e.rb,e.text(e.wgt(n,n.ui,n.ci)),e.rb=!1)},B.prototype.Wmt=function(){var t=this,n=t.Vv;!t.Bmt&&n&&(t.rl||(n.h6=null,n._3(b.Events.FormulaTextboxEditStarted+A,t.hgt),n._3(b.Events.FormulaTextboxEnterCell+A,t.dgt),n._3(b.Events.FormulaTextboxEditEnded+A,t.vgt),n._3(b.Events.FormulaTextboxActiveSheetChanged+A,t.mgt),n._3(b.Events.FormulaTextboxRangeChanged+A,t.ggt),n._3(b.Events.FormulaTextBoxTextChanged+A,t.pgt),n._3(b.Events.FormulaTextBoxCaretChanged+A,t.bgt),n._3(b.Events.ValueChanged+A,t.ygt),t._3(N,t.Mgt),t._3(k,t.Cgt)),t.text("")),t.Vv=null},B.prototype.Hmt=function(){var t,n,n,t=this;t.rb||(t.rb=!0,(n=(n=this.Vv)&&(0,b.jf)(n))&&!n.isEditing()?(t.rl||n.f6(null,n.ui,n.ci,null,null,!1,null),t.Sgt=!0):n&&1===n.Di?(n.Di=2,n._i(1,2)):t.Sgt=!1,t.rb=!1,t.Tgt)||t.w6()},B.prototype.Agt=function(){var t=this,n=t.Ti,e=t.Igt;n.insertBefore(e,n.firstChild),e.innerText=t.igt},B.prototype.xgt=function(t,n){var e;t&&this.Ngt!==n&&(this.Ngt=n,t.style.display=n?"":"none")},B.prototype.rgt=function(){var t,n,e,i,t=this,n=t.Ti,e;t.vmt(n)?((i=t.Igt)||((i=t.Igt=a("span")).className="gcsj-func-gray-formula"),t.xgt(i,!0),t.Agt()):n.placeholder=t.igt},B.prototype.kgt=function(){var t,n,e,t=this;t.igt&&(t.igt="",n=t.Ti,(e=t.vmt(n))?t.xgt(t.Igt,!1):n&&(n.placeholder=""))},B.prototype.FD=function(){var t,n,n,e,i,r,o,a,i,t=this,n=t.Vv,n=n&&(0,b.jf)(n);n&&(e=n.il,t.Sgt&&e&&(i=e.text(),lt(r=t.text(),i,!0)||(o=t.caret(),a=n.getFormulaInformation(n.getActiveRowIndex(),n.getActiveColumnIndex(),3),t.text(i),a.isArrayFormula&&(o>=r.length&&(o-=1),o=c(0,o-1)),t.caret(o))),t.Sgt&&e||t.rl)&&2!==(i=n.Di)&&(n.Di=2,n._i(i,2))},B.prototype.wgt=function(t,n,e){var i,r,r,o,o,a,i="";if(t){if(r=(r=t.parent)&&r.options,(o=t.getFormulaInformation(n,e,3))&&o.hasFormula){if(i="="+o.formulaWithCulture,o.isDynamicArray)return this.igt=i,"";this.igt="",o.isArrayFormula&&(i="{"+i+"}")}else o=t.getActualStyle(n,e),i="string"==typeof(a=t.getValue(n,e))&&(o.quotePrefix||0<a.length&&"="===a[0]&&r&&r.allowUserEditFormula&&!r.allowInvalidFormula)?"'"+a:b.mt.mi(o,a,t,{sheet:t,row:n,col:e,sheetArea:3})||"";this.kgt()}return i},B.prototype.mgt=function(t,n){var t,e,i,t=t.data;t.rb||(e=n.newSheet,t.rl)||(t.rb=!0,t.close(),n&&e&&t.text(t.wgt(e,e.ui,e.ci)),t.rb=!1)},B.prototype.hgt=function(t,n){var t,e,e,e,t=t.data;t.rb||(e=(e=(e=t.Vv)&&(0,b.jf)(e))&&e.il)&&t.rl===e.rl&&t.Avt===e.Avt&&n.sheetArea!==b.SheetArea.colHeader&&n.sheetArea!==b.SheetArea.rowHeader&&(t.kgt(),t.rb=!0,t.text(e.text()),t.rb=!1)},B.prototype.dgt=function(t,n){var t,e,i,t=t.data;t.rl||t.rb||(t.rb=!0,n&&(t.text(t.wgt(n.sheet,n.row,n.col)),t.Ti)&&(e=t.$mt(t.Ti),i=t.ffe(t.Ti),n.readonly?e?t.Ti.disabled=!0:i&&(t.Ti.contentEditable="false"):e?t.Ti.disabled=!1:i&&(t.Ti.contentEditable="true")),t.rb=!1)},B.prototype.ggt=function(t,n){var t,e,i,r,o,n,t=t.data;t.rb||t.rl||(t.rb=!0,n&&(e=n.sheet,i=n.row,r=n.col,o=n.rowCount,n=n.colCount,new b.Range(i,r,o,n).contains(e.ui,e.ci))&&t.text(t.wgt(e,e.ui,e.ci)),t.rb=!1)},B.prototype.vgt=function(t,n){var t,e,t=t.data;t.rl&&t.Imt&&t._mt?n.ignore=!0:t.rb||n.sheetArea!==b.SheetArea.colHeader&&n.sheetArea!==b.SheetArea.rowHeader&&(t.rb=!0,t.close(),(e=v.wvt.Rvt)&&e._6(n.sheet),n&&n.sheet.il&&!n.sheet.il.rl&&!t.rl&&t.text(t.wgt(n.sheet,n.row,n.col)),t.rb=!1)},B.prototype.ygt=function(t,n){var e,i,e=n.sheet,i=e&&e.parent&&e.parent.h6;i&&i.Dgt()===n.row&&i._gt()===n.col&&i.zmt()===e&&t.data instanceof B&&(n.text=e.getText(n.row,n.col),t.data.pgt(t,n))},B.prototype.pgt=function(t,n){var t,e,t=t.data;t.rb||n.sheet.il&&(t.rl!==n.sheet.il.rl||t.Avt!==n.sheet.il.Avt)||n.sheetArea===b.SheetArea.colHeader||n.sheetArea===b.SheetArea.rowHeader||(t.rb=!0,n&&(e=t.caret(),t.text(n.text),t.caret(e)),t.rb=!1)},B.prototype.bgt=function(t,n){var t=t.data;t.rb||n.sheet.il&&(t.rl!==n.sheet.il.rl||t.Avt!==n.sheet.il.Avt)||(t.rb=!0,n&&t.caret(n.caret),t.rb=!1)},B.prototype.Mgt=function(t){var t,n,n,e,i,r,o,a,r,t=t.data;if(!t.rb&&(n=(n=t.Vv)&&(0,b.jf)(n))){if(n.isEditing()||(t.Hmt(),t.focus()),t.rb=!0,e=n.ui,i=n.ci,r=n.il,o=n.getCellType(e,i),r){if(t.rl!==r.rl||t.Avt!==r.Avt)return;a=r.caret(),r.text(t.text()),r.caret(a)}else r={sheet:n,row:e,col:i,sheetArea:3},o.setEditorValue(n.li,t.text(),r);t.rb=!1}},B.prototype.Cgt=function(t){var t,n,n,n,t=t.data;t.rb||(n=(n=t.Vv)&&(0,b.jf)(n))&&n.isEditing()&&((n=n.il)&&(t.rl!==n.rl||t.Avt!==n.Avt)||(t.rb=!0,n&&(n.caret(t.caret()),t.w6()),t.rb=!1))},B.prototype.Hc=function(t){var n,e,i,i,n=this;n.Egt=!1,n.jgt=!1,n.XD=!1,n.umt=-1,n.ugt=[],n.ogt=!0,n.agt=!0,n.Ogt=!0,(e=a("div")).className="gcsj-func-ac-popup",e.style.display="none",e.setAttribute(r,"gcFuncACPopup"),t.insertBefore(e,y),n.Kmt=e,n.Tgt=!1,(i=a("div")).className="gcsj-func-help-popup",i.style.display="none",i.setAttribute(r,"gcFuncHelpPopup"),t.insertBefore(i,y),n.Jmt=i,(n.Rgt=!1,b.GC$)(e).bind("mouseover",function(){n.Ogt=!1}).bind("mouseout",function(){n.Ogt=!0}),(0,b.GC$)(i).bind("mouseover",function(){n.Ogt=!1}).bind("mouseout",function(){n.Ogt=!0}),(0,b.GC$)(e).bind("scroll",function(){n.Bgt&&clearTimeout(n.Bgt),n.Bgt=l.setTimeout(function(){n.Ti&&n.Ti.focus()},100)}),(i=a("div")).style.display="none",i.setAttribute(r,"gcFuncHelpDiv"),t.insertBefore(i,y),n.F0=i,n.Vv=null,n.rb=!1,n.Sgt=!1,n.Bmt=!1},B.prototype.Rmt=function(t){var c,f,n;t&&(f=(c=this).vmt(t),c.$mt(t)||f)&&(n=(0,b.GC$)(t),c.Ti&&c.Zmt(),c.Ti=t,e&&(e.msie||e.chrome)?f||C||e.chrome?(c.D3("focus",function(){n.data(j,c.text())}),c.D3("click",function(){n.focus()}),"input keydown keyup cut paste".split(" ").forEach(function(t){c.D3(t,function(){c.Lgt()})})):c.D3(T,function(){c.Fgt()}):c.D3(T,function(){var t;f&&(t=c.Ti.lastChild,e.chrome)&&t&&"BR"===t.tagName&&c.Ti.removeChild(t),c.Fgt()}),c.D3("keydown",function(t){var n,e,i,r,o,a,u,s,u,u,s,n=t.ctrlKey,e=t.shiftKey,i=t.altKey,r=t.metaKey,o,a=t.keyCode;n||e||i||r||!c.Tgt||(a===_?(c.Pgt(1),g(t)):a===D?(c.Pgt(-1),g(t)):a===E&&(c.Ggt(),g(t))),a===Q&&c.close(),c.Ugt(t),s=(u=(0,b.jf)(c.Vv))&&u.rt.Pi(t),c.rl&&s&&(u=u.il)&&u.XD&&u.qD(),f&&(s?(8===a?L(t)&&b.di.processBackspaceAndLeftArrowKeyEvent(t,!0):46===a&&L(t)&&b.di.processDeleteAndRightArrowKeyEvent(t,!0),c.mmt()):13===a&&(n||i)?(L(t)&&Mt(),c.mmt(!0)):37===a?L(t)&&b.di.processBackspaceAndLeftArrowKeyEvent(t,!1):39===a&&L(t)&&b.di.processDeleteAndRightArrowKeyEvent(t,!1),f)&&n&&(90===a||89===a)&&g(t),u=c.text(),b.mt.Qf()&&f&&r&&(s=void 0,90===a)&&(e?(s=c.kmt.pop())&&(c.text(s),c.Nmt.push(u)):(s=c.Nmt.pop()||"",c.text(s),c.kmt.push(u)),t.preventDefault(),t.stopPropagation())}),c.D3("keyup",function(t){var n,e,i,t;c.Ugt(t),n=c.text(),f&&(e=void 0,i=t.keyCode,(t=t.ctrlKey)&&90===i?(e=c.Nmt.pop()||"",c.text(e),c.kmt.push(n)):t&&89===i&&(e=c.kmt.pop())&&(c.text(e),c.Nmt.push(n)))}),c.D3("focus",function(t){var n;e&&e.mozilla&&!c.Ti.innerText&&(c.Ti.innerText=""),c.Ugt(t),c.rl&&c.Imt&&(c._mt=!0,c.Umt())}),c.D3("blur",function(){c.Ogt&&c.close(),c.rl&&(c.Vmt(),c._mt=!1)}),c.D3("mousedown",function(){c._mt=!0,c.Ngt&&(c.kgt(),c.Hgt=!0),c.Hmt()}),c.D3("mouseup",function(){var t,n;c.Hgt&&(c.Hgt=!1,(t=c.Ti)!==(n=l.getSelection()).anchorNode)&&n.selectAllChildren(t),c.FD()}),c.D3("click",function(t){var n,n,n;c.XD&&c.qD(),(n=(n=(n=c.Vv)&&(0,b.jf)(n))&&n.il)&&n.XD&&!n.rl&&n.qD(),c.Ugt(t)}),c.D3("compositionstart",function(){c.Egt=!0}),c.D3("compositionend",function(){c.Egt=!1,(e.edge||e.chrome||e.msie)&&c.Lgt()}))},B.prototype.Zmt=function(){var t,n,n,t=this,n=t.Ti;n&&((n=(0,b.GC$)(n)).removeData(j),n.removeData(O),n.removeAttr(r),n.data(u.CONST_FORMULATEXTBOX)&&n.data(u.CONST_FORMULATEXTBOX,y),t.E3(),t.unbindAll(),t.rl&&((0,b.GC$)(t.Emt).empty(),t.Emt=y),t.Ti=y)},B.prototype.Lgt=function(){var t=this,n=(0,b.GC$)(t.Ti),e=t.text();n.data(j)!==e&&(t.Egt||n.data(j,e),t.Fgt())},B.prototype.Ugt=function(t){var n;e&&e.msie?setTimeout(function(t,n){return function(){t.zgt(t,n)}}(this,t),10):this.zgt(this,t)},B.prototype.zgt=function(t,n){var e,i,e,n,i,e,n,e=n.keyCode,i=e===U||e===H||e===W||e===Z||e===Y||e===V||e===E||e===z;t.ogt||(i=i||e===D||e===_),e=void 0!==n.button,(i||e)&&(n=t.Ti,i=(0,b.GC$)(n),(e=t.Xmt(n)).start===e.end)&&(n=e.end,i.data(O)!==n)&&(i.data(O,n),t.ki(k,{}),t.w6())},B.prototype.Dgt=function(){var t,n,t,t=this.zmt();return t?(n=t.ui,(t=t.vA)?t.row:n):s},B.prototype._gt=function(){var t,n,t,t=this.zmt();return t?(n=t.ui,(t=t.vA)?t.col:n):s},B.prototype.Qvt=function(){var t,n,t,t=this.zmt();return t?(n=b.SheetArea.viewport,(t=t.vA)?t.sheetArea:n):s},B.prototype.zmt=function(){if(this.Vv)return(0,b.jf)(this.Vv)},B.prototype.parseInternal=function(t,n,e,i,r){var o,a,u,u;return void 0===r&&(r=b.SheetArea.viewport),o=this,a=[],(0,b.kf)(t)&&ot(t,'"')%2!=1?(u=new p.Parser,u=h.Vgt(u,t,n,e,i,!0,s,s,r),a=o.Ygt(u,t)):a.push({text:t,type:17}),a},B.prototype.Ost=function(t){return this.parseInternal(t,this.zmt(),this.Dgt(),this._gt(),this.Qvt())},B.prototype.Fgt=function(){var t,n,e,i,r,t=this,n=t.text();"\n"!==n&&0<=n.indexOf("\n")?t.ki(N,{type:T}):(e=t.Ti,i=(0,b.GC$)(e),t.jgt=!0,t.Fmt=t.Ost(n),t.vmt(e)?t.Egt||("\n"===n?(i.empty(),t.ki(N,{type:T})):(r=t.caret(),t.Pmt(t.Fmt),t.ki(N,{type:T}),t.caret(r))):t.ki(N,{type:T}),r=t.caret(),i.data(O)!==r&&(i.data(O,r),t.ki(k,{})),t.Zgt(),t.Tgt||t.w6())},B.prototype.Wgt=function(){return d.Common.CultureManager.Fe().NumberFormat},B.prototype.Qgt=function(){var t=this.Wgt();return t&&t.arrayGroupSeperator||";"},B.prototype.Kgt=function(){var t=this.Wgt();return t&&t.arrayListSeparator||","},B.prototype.fgt=function(){var t=this.Wgt();return t&&t.listSeparator||","},B.prototype.Jgt=function(){var t=this.Wgt();return t&&t.numberDecimalSeparator||"."},B.prototype.Ygt=function(t,n){for(var e,i,r,o,a,u,s,c,f,l,h,h,e=[],i=[],r=n&&"="!==n[0],o=this.Qgt(),a=this.Kgt(),u=!1,s=0;s<t.length;s++)0<s&&s<t.length-1&&";"===t[s-1].text&&","===t[s].text&&"ARRAYROW"===t[s+1].text||(c=t[s],f=this.Xgt(c,i),l=c.text,2===f?e.push({text:l,type:f}):u&&8===f&&","===l?e.push({text:a,type:9}):u&&8===f&&";"===l?e.push({text:o,type:10}):8===f?e.push({text:l,type:f}):3===f?("ARRAY"===l&&(u=!0),e.push({text:"{",type:3})):4===f?"ARRAY"===l||"}"===l?(u=!1,e.push({text:"}",type:4})):e.push({text:l,type:4}):6===f?e.push({text:")",type:f}):13===f?e.push({text:d.Common.st.Ge(l),type:f,ranges:c.ranges,allowDrag:c.canDrag}):1===f&&r||null!==f&&(11===f&&t[s+1]&&"#"===t[s+1].text&&c.ranges&&0<c.ranges.length&&(h=new p.CalcReference(this.zmt().qgt,c.ranges).getSpillRef())&&h.$gt&&(s++,c.ranges=h.$gt,l+="#"),h={text:l,type:f,ranges:c.ranges,allowDrag:c.canDrag},11===f&&(h.sheetArea=c.sheetArea),e.push(h)));return e},B.prototype.Xgt=function(t,n){var e,i,r,t,r,e=t.type,i=t.subType,r=t.text,t=t.value;if(1===e){if(1===i)return"ARRAY"===r||"ARRAYROW"===r?(n.push(3),3):(n.push(5),"@"===t||"("===t.trim()?5:2);if(2===i){if(")"===t.trim())return 6;if(0<n.length){if(3===(r=n[n.length-1]))return n.pop(),4;if(5===r)return n.pop(),6}}if("="===t.trim())return 1}else if(3===e){if(0===i)return 8}else{if(5===e||6===e||4===e)return 7;if(0===e)return 7===i||0===i||12===i?11:5===i?12:4===i?13:3!==i&&6===i?16:14;if(7===e)return 15;if(8===e);}return 17},B.prototype.lgt=function(){for(var t,n,e,i,r,o,t=this,n=t.Ti,e=t.Fmt,i="",r=e&&e.length,o=0;o<r;o++)i+=e[o].text;t.$mt(n)?n.value=i:t.vmt(n)&&t.Pmt(e)},B.prototype.$mt=function(t){var t=t&&t.tagName;return"TEXTAREA"===t||"INPUT"===t},B.prototype.vmt=function(t){return t&&"DIV"===t.tagName&&"true"===t.contentEditable},B.prototype.ffe=function(t){return t&&"DIV"===t.tagName},B.prototype.t2t=function(t){return"gcEditingInput"===(0,b.GC$)(t).attr(r)},B.prototype.D3=function(t,n,e){var i=this.Ti;i&&t&&(t=t.split(/\s+/).join(A+" "),(0,b.GC$)(i).bind(t+A,n,e))},B.prototype._3=function(t,n){var e=this.Ti;e&&t&&(t=t.split(/\s+/).join(A+" "),(0,b.GC$)(e).unbind(t+A,n))},B.prototype.E3=function(){var t=this.Ti;t&&(0,b.GC$)(t).unbind(A)},B.prototype.ki=function(t,n){var e=this.Ti;e&&(0,b.GC$)(e).trigger(t,n)},B.prototype.cgt=function(t){var n,e,i,r,o;if(!(t<=0)&&0<(e=(n=this.Fmt)&&n.length))for(r=void(i=0),o=0;o<e;o++)if(t<=(i+=(r=n[o]).text.length))return r;return y},B.prototype.n2t=function(){var t,n,e,i,r,o,t=this.Vv;if(t&&(n=(0,b.jf)(t))&&(e=n.getCalcService().allowDynamicArray,i=n.il)){for(o=(r=[].concat(i.ugt)).length-1;0<=o;o--)!e&&r[o]&&wt(r[o].name)?r.splice(o,1):r[o].isFunc=!0;return r.concat(this.e2t(t,n)).concat(this.i2t(t.sheets)).concat(this.r2t(t))}return this.ugt},B.prototype.e2t=function(t,n){var e,n,n,e=[],n=n.getCustomNames();return n&&b.GC$.each(n,function(t,n){e.push({name:n.Zc,description:n.TZ})}),(n=t.getCustomNames())&&b.GC$.each(n,function(t,n){e.push({name:n.Zc,description:n.TZ})}),e},B.prototype.i2t=function(t){var i=[];return t.forEach(function(t){var t,n,e,t=t.tables;if(t&&(n=t.all()))for(e=0;e<n.length;e++)i.push({name:n[e].name(),description:p.sR().Fbx_TableName_Description+n[e].name()})}),i},B.prototype.r2t=function(t){for(var n,e,i,n=[],e=t.mp,i=0;i<e.length;i++)n.push({name:e[i].name(),description:p.sR().Fbx_TableSheetName_Description+e[i].name()});return n},B.prototype.o2t=function(t,n){var e,i,r,o;for(t=S(t),m.OS(t,"[")&&(t=t.substr(t.lastIndexOf("[")+1),t=m.Vi(t,"@","")),e=[],i=n&&n.length,o=0;o<i;o++)r=n[o],0===S(R(r.name)).indexOf(t)&&e.push(r);return e},B.prototype.a2t=function(){var t,n,e,i,r,o,t=this.caret();if(!(t<=0)&&0<(e=(n=this.Fmt)&&n.length))for(r=void(i=0),o=0;o<e;o++){if(i+(r=n[o]).text.length>=t)return r.text.substring(0,t-i);i+=r.text.length}return""},B.prototype.u2t=function(){for(var t,n,e,i,r,o,a,u,s,c,f,l,h,d,t=this.caret(),n=this.Fmt,e=n&&n.length,i=[],r=0,a=0;a<e;a++){if(o=n[a],i.push(o),6===o.type)for(u=0;0<i.length;)if(6===(s=i.pop()).type&&u++,5===s.type&&u--,0===u){0<i.length&&(s=i[i.length-1])&&2===s.type&&i.pop();break}if(t<=(r+=o.text.length))break}if(0<i.length)for(c=0;0<i.length;)if(8===(o=i.pop()).type)c++;else if(2===o.type){for(f=S(o.text),h=(l=this.n2t())&&l.length,d=void 0,a=0;a<h;a++)if(d=l[a],S(R(d.name))===f)return{func:d,activeParamterIndex:c,isFunc:d.isFunc};break}return y},B.prototype.Zgt=function(){var n,t,e,i,r,o,a,u,i,s,c,n=this,t=n.s2t(),e;if(n.ogt&&(0,b.kf)(n.text())&&t&&0<t.length&&!n.XD&&!n.Egt&&!n.rl){for(n.c2t(),i=n.Kmt,8<t.length?(i.style.height="204px",i.style.overflowY="scroll"):(i.style.height="auto",i.style.overflowY=""),r="",o=t.length,a=void 0,u=0;u<o;u++)r+="<div class='gcsj-func-ac-row'><div class='gcsj-func-ac-row-name' isFunc="+(a=t[u]).isFunc+">"+R(a.name)+"</div><div class='gcsj-func-ac-row-description'>"+(a.description||"")+"</div></div>";(i=(0,b.GC$)(n.Kmt)).html(r).show(),n.Tgt=!0,0<(s=i.find(x)).length&&(c="gcsj-ac-row-active",(0,b.GC$)(s[0]).addClass(c),s.bind("mouseover",function(){s.removeClass(c),(0,b.GC$)(this).addClass(c)}),s.bind("click",function(){n.Ggt()}),n.Ngi)&&s.bind("mousedown",function(t){n.Ggt(),g(t)}),n.u_()}else n.f2t()},B.prototype.Qmt=function(){var t,n,t=this,n=(0,b.GC$)(t.Kmt).find(x);n&&(n.unbind("mouseover"),n.unbind("click"),t.Ngi)&&n.unbind("mousedown")},B.prototype.s2t=function(){var t,n,e,i,r,n,r,o,a,u,s,c,n,t=this,n=t.cgt(t.caret()),e=n&&n.text,i=[],r=t.Fmt.indexOf(n);if(n&&14===n.type)return i;if(n=this._getTable(r),0<(r=t.h2t(r,n)).length){if(o=[],!n.Mf.NMi)for(s in a=JSON.parse(JSON.stringify(p.sR().d2t)),u=p.getMapping()&&p.getMapping().tableFunctionsMapping,a)(c=u&&u[a[s].name])&&(a[s].name=c),o.push(a[s]);if(i=i.concat(r).concat(o),m.dT(e,"[")||m.dT(e,"[@"))return i}else i=this.n2t();return n=[],n=(e=t.a2t())?t.o2t(e,i):n},B.prototype._getTable=function(t){var n,e,i,n,t,n,i,n=this.Fmt;return!(t<0||!n||t>=n.length)&&(i=(e=this.Vv)&&(0,b.jf)(e),M(t)&&(t=n.length),i)?(n=n[t],t=m.gmt(n.text,"["),i=(n=i.tables)&&n.findByName(t),M(i)?e.Efe(t):i):null},B.prototype.h2t=function(t,n){var e=[];return e=M(n)?e:dt(n).columns},B.prototype.f2t=function(){(0,b.GC$)(this.Kmt).hide(),this.Tgt=!1},B.prototype.Pgt=function(t){var n,e,i,r,o,a,u,s,n=(0,b.GC$)(this.Kmt).find(x),e=n.length;if(0!==e){if(i="gcsj-ac-row-active",r=0,t)for(o=0;o<e;o++)if((0,b.GC$)(n[o]).hasClass(i)){r=o+t;break}a=(0,b.GC$)(this.Kmt).scrollTop(),n.removeClass(i),(u=0)<e&&(u=n[0].offsetHeight),r=c(r,0),s=n[r=w(r,e-1)],(0,b.GC$)(s).addClass(i),s.offsetTop+s.offsetHeight>(0,b.GC$)(this.Kmt).scrollTop()+(0,b.GC$)(this.Kmt).height()?(0,b.GC$)(this.Kmt).scrollTop((0,b.GC$)(this.Kmt).scrollTop()+u):s.offsetTop<(0,b.GC$)(this.Kmt).scrollTop()?(0,b.GC$)(this.Kmt).scrollTop(s.offsetTop):(0,b.GC$)(this.Kmt).scrollTop(a)}},B.prototype.Ggt=function(){var t,n,e,n,i,r,o,a,u,s,c,f,l,h,d,d,l,f,d,t=this,n=(0,b.GC$)(t.Kmt).find(".gcsj-ac-row-active .gcsj-func-ac-row-name"),e=n.text(),n="true"===n.attr("isFunc");if(e){for(i=t.caret(),o=(r=t.Fmt)&&r.length,s=u=a=0,c=y;s<o&&!(i<=a+(u=(c=r[s]).text.length));)s++,a+=u;f=i-a,l=c.text,d=h=0,m.OS(l,"[")?-1===(h=l.lastIndexOf("[",f-1))?(h=l.indexOf("["),c.text=-1===h?e:e+l.substr(h),h=0):("@"===l.charAt(++h)&&(h+=1),-1===(d=l.indexOf("]",f))&&(d=l.length),c.text=l.substring(0,h)+e+l.substr(d)):(c.text=e,(d=l.substr(f))&&1<(l=t.Ost("="+d)).length&&r.splice(s+1,0,l[1])),c.type=n?2:11,d=r[f=s+1],!n||d&&5===d.type||r.splice(f,0,{text:"(",type:5}),t.f2t(),t.Ti.focus(),t.lgt(),t.caret(a+e.length+h+(n?1:0)),t.w6(),t.Fmt=t.Ost(t.text()),t.ki(N,{})}},B.prototype.w6=function(){var t,n,e,i,r,o,a,u,s,c,f,l,h,d,v,m,g,n,t=this;if(t.Tgt&&t.f2t(),(n=t.u2t())===y||!0!==n.isFunc)t.c2t();else if(e=t.fgt(),(i=t.agt&&(0,b.kf)(t.text())&&n&&!t.XD&&!t.Egt)&&!t.rl){for(a=(o=(r=n.func).parameters)&&o.length,u=w(a-1,n.activeParamterIndex),s=void 0,c="",f=0;f<a;f++)l=(s=o[f]).name,s.repeatable&&(l+=e+"..."),s.optional&&(l="["+l+"]"),h=f===a-1?"":e+" ",c+=l=f===u?"<span class='gcsj-func-help-paramter gcsj-func-help-paramter-active'>"+l+"</span>"+h:"<span class='gcsj-func-help-paramter'>"+l+"</span>"+h;n=(d="<div class='gcsj-func-help-title'><div class='gcsj-func-help-formula'><span class='gcsj-func-help-formula-name'>"+R(r.name)+"</span><span class='gcsj-func-help-paramter-paren'>(</span>"+c+"<span class='gcsj-func-help-paramter-paren'>)</span></div></div>")+(g="<div class='gcsj-func-help-body'>"+(m="<div class='gcsj-func-help-section-content'>"+(v="<div class='gcsj-func-help-section'><div class='gcsj-func-help-section-title'>"+p.sR().Fbx_Summary+"</div><div class='gcsj-func-help-section-content'>"+(r.description||"")+"</div></div>")+"</div>")+"</div>"),(0,b.GC$)(t.Jmt).html(n).show(),t.Rgt=!0,t.u_()}else t.c2t()},B.prototype.c2t=function(){(0,b.GC$)(this.Jmt).hide(),this.Rgt=!1},B.prototype.close=function(){this.f2t(),this.c2t()},B.prototype.$D=function(t,n){var e,i,r,o,a,t;return!this.XD&&(e=t.ctrlKey||t.shiftKey||t.altKey||t.metaKey,i=t.keyCode,r=t.ctrlKey,o=t.altKey,a=t.metaKey,t=t.srcElement||t.target,!this.Ngi&&t&&n&&n.isEditing&&"gcAttachedFormulaTextBox"===t.getAttribute("gcUIElement")?67===i&&(r||a)&&!o||88===i&&(r||a)&&!o:this.Tgt&&!e&&(i===_||i===D||i===E))},B.prototype.u_=function(){var t,n,e,n,i,r,t,o,o,i,e,r,a,u,t,s,e,t=this,n=y;t.Tgt?n=t.Kmt:t.Rgt&&(n=t.Jmt),n&&(e=(0,b.GC$)(t.Ti),n=(0,b.GC$)(n),i=e.parent(),r=e.outerHeight(),t.t2t(t.Ti)&&(r=(i=i.parent()).outerHeight()),t=i.css("top"),o=parseFloat(t),isNaN(o)||(t=o),o=i.css("left"),"auto"===t&&(t=e.offset().top,o=e.offset().left),i=t+r,e=(0,b.GC$)(f.body).outerHeight(),r=(0,b.GC$)(f.body).outerWidth(!0),a=n.outerHeight(),u=n[0].offsetWidth,e<(s=i+a)&&0<=(e=t-a)&&(i=e),r<(t=parseFloat(o))+u+2&&(t-=t+u+2-r),n.css("top",i).css("left",t))},B.prototype.focus=function(){(0,b.GC$)(this.Ti).focus()},B.prototype.Pmt=function(t){for(var n,e,i,r,o,a,u,s,c,n=this,e="",i="",r=t&&t.length,o=0,u=0;u<r;u++)s="",11===(a=t[u]).type&&(s=" style='color: "+n.pmt(o)+"'",o++),n.F0.innerText=a.text,e+="<span"+s+" class='gcsj-func-color-text'>"+n.F0.innerHTML+"</span>",i+=a.text;if(i||n.text())if(c=n.Ti,e)c.innerHTML="<span class='gcsj-func-color-content'>"+e+"</span>";else for(;c.firstChild;)c.removeChild(c.firstChild)},B.prototype.tgt=function(t,n){var e,i,r,o,a,e=(0,b.GC$)(t).find(".gcsj-func-color-content .gcsj-func-color-text"),i=e.length;for(n=c(0,n),a=0;a<i;a++)if((n-=(o=(r=e[a]).innerText).length)<=0)return{node:r,offset:o.length+n};return o?{node:r,offset:o.length}:y},B.prototype.y6=function(t,n){var e,i,r,e=l.getSelection(),i=this.Ti.children[0],r=document.createRange();r.setStart(i,t),r.setEnd(i,n),e.removeAllRanges(),e.addRange(r)},B.prototype.mmt=function(t){var n,e,e,i,n=this,e=n.Ti,e=n.vmt(e),i=n.text();e&&i&&(i=t?i.substr(0,i.length-2):i,n.Nmt.push(i))},B.prototype.egt=function(t,n){var e,i,r,o,a,u,s,c;if(n)for(o=n.length,a=r=i=e=0;a<t.length;a++){for(u=t[a].text;i<o;i++)if((s=n[i].toUpperCase())===(c=u[r]?u[r].toUpperCase():void 0))r+=1;else{if("\n"!==s)break;i+1<o&&"\u200b"===n[i+1]&&(i+=1)}t[a].text=n.substring(e,i),e=i,r=0}return t},B.prototype.ngt=function(t){var n,e,i,r,o;if("="===t[0]&&-1!==t.indexOf("\n")){for(e=t.length,i=!(n=[]),r=0;r<e;r++)(i='"'===(o=t[r])?!i:i)||"\n"!==o?n.push(o):r+1<e&&"\u200b"===t[r+1]&&(r+=1);return n.join("")}},rt=B,u.FormulaTextBox=rt},"./dist/plugins/group/group-actions.js":function(B,t,n){"use strict";var e,i,c,w,t,L,r,o,a,u,s,f,l,h,d,n,v,m,i,g,p,n,b,y,i,M,C,S,T,A,I,x,N,k,D,F,P,G,U,H,z;function _(t){var n=t.Mf;return t.v2t?n.rowOutlines:n.columnOutlines}function V(t){var n,e,i,r,o,a,t,n=this,e=!1;return(t?n.canExecute():n.canUndo())&&(i=n.Mf,r=n.tT.index,o=n.tT.count,a=_(n),i)&&a&&!d(r)&&!d(o)&&(t=t?a.group:a.ungroupRange,n.X5(i,!0),t.call(a,r,o),n.q5(i,!0),e=!0),e}function E(t,n,e){var t=A.call(this,t,n)||this;return t.v2t=e,t}function Y(t,n){return I.call(this,t,n,!1)||this}function Z(t,n){return x.call(this,t,n,!0)||this}function j(t,n,e){var t=N.call(this,t,n)||this;return t.v2t=e,t}function W(t,n){return k.call(this,t,n,!1)||this}function Q(t,n){return D.call(this,t,n,!0)||this}function J(t,n,e,i,r){for(var o=0,a,a=n;a<=e&&a<i;a++)o+=r.call(t,a)*t.zoom();return o}function K(t,n,e,i,r){for(var o=0,a,a=n;a<i&&o<e;a++)n++,o+=r.call(t,a)*t.zoom();return i<=n?i-1:n}function X(t,n,e,i,r){if(n<i)return i;if(r<n)return r;for(var o=n;o<=r;o++)if(e.call(t,o))return o;return-1}function q(t,n,e){var i,r,o,a,u,i,s,s,c,f,l,h,f,d,v,m,g,m,p,b,y,i,c,e,i=this,r=i.Mf,o=e.index,a=n?r.getRowCount():r.getColumnCount(),u=void 0,i=_(i),s=i.KMi;o<0||a<=o||s||(s=1===i.direction(),(0,w.isIndexValid)(i,c=s?o-1:o+1)&&(f=r.Fi(),l=n?r.frozenRowCount():r.frozenColumnCount(),h=n?r.frozenTrailingRowCount():r.frozenTrailingColumnCount(),f=n?f.Ty:f.Uy,d=n?r.Ny:r.Vy,v=n?r.getRowHeight:r.getColumnWidth,m=n?r.getViewportTopRow:r.getViewportLeftColumn,g=n?r.getViewportHeight:r.getViewportWidth,m=m.call(r,1),i=i.find(c,e.level))&&(c=s?i.start:o,e=s?o:i.end,s?(t?c=o:c<l&&(c=l),c<m&&(m=c),a-h<=e&&(e=a-h-1),p=g.call(r,1),y=X(r,m=(p+=d?0:f)<(b=J(r,m,e,a,v))?K(r,m,b-p,a,v):m,v,l,a-1)):(t?e=o:a<=e&&(e=a-1),a-h<=e&&(e=a-h-1),(c<m||(p=g.call(r,1),(p+=d?0:f)<(b=J(r,m,e,a,v))))&&(y=X(r,c,v,l,a-1))),n&&y!==u?(r.Tb=y,r.tw()):n||y===u||(r.Ab=y,r.ow())))}function $(t){var n,e,i,r,o,a,u,s,c,t,n=this,e=!1;return(t?n.canExecute():n.canUndo())&&(i=n.Mf,r=n.tT,o=_(n),a=r.collapsed,u=r.index,s=r.level,!i||!o||d(a)||d(u)||d(s)||(n.X5(i,!0),t||(a=!a),(c=1===o.direction()?0<=u-1&&o.find(u-1,s):u+1<o.items.length&&o.find(u+1,s))&&o.setCollapsed(u,a),d(r.index)&&(r.index=(0,w.getExtendIndex)(i,n.v2t,s)),q.call(n,a,n.v2t,r),i.iA&&i.iA()&&((t=i.getCalcService()).Vct="filter",i.recalcRange(0,0,i.getRowCount(),i.getColumnCount()),delete t.Vct,i.resumeCalcService(!1),t.Zct()),n.q5(i,!0),e=!0)),e}function O(t,n,e){var t=F.call(this,t,n)||this;return t.v2t=e,t}function tt(t,n){return P.call(this,t,n,!1)||this}function nt(t,n){return G.call(this,t,n,!0)||this}function R(t,n,e){var t=U.call(this,t,n)||this;return t.v2t=e,t}function et(t,n){return H.call(this,t,n,!1)||this}function it(t,n){return z.call(this,t,n,!0)||this}e=this&&this.__extends||(T=function(t,n){return(T=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(t,n){t.__proto__=n}:function(t,n){for(var e in n)Object.prototype.hasOwnProperty.call(n,e)&&(t[e]=n[e])}))(t,n)},function(t,n){if("function"!=typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function e(){this.constructor=t}T(t,n),t.prototype=null===n?Object.create(n):(e.prototype=n.prototype,new e)}),Object.defineProperty(t,"__esModule",{value:!0}),t.Commands=void 0,i=n("Common"),c=n("Core"),Object.defineProperty(t,"Commands",{enumerable:!0,get:function(){return c.Commands}}),w=n("./dist/plugins/group/group.js"),t=c.Commands.ActionBase,L=c.GC$,r="outlineColumn",o="removeColumnOutline",a="expandColumnOutline",u="expandColumnOutlineForLevel",s="outlineRow",f="removeRowOutline",l="expandRowOutline",h="expandRowOutlineForLevel",d=i.Common.lt.ht,e(E,A=t),E.prototype.execute=function(){var t,n,e,i,t,r,t=this,n=t.Mf,e=t.tT,i=n.Ut;return i.startTransaction(),t=V.call(t,!0),e[r=c.Commands.TI(n.name())]=i.endTransaction(),t},E.prototype.undo=function(){return V.call(this,!1)},e(Y,I=n=E),v=Y,e(Z,x=n),m=Z,e(j,N=t),j.prototype.execute=function(){var t,n,e,i,r,o,a,u,s,t=this,n=t.Mf,e=n.Ut,i=!1;return t.canExecute()&&(o=(r=t.tT).index,a=r.count,u=_(t),n)&&u&&!d(o)&&!d(a)&&(e.startTransaction(),t.X5(n,!0),u.ungroupRange(o,a),t.q5(n,!0),r[s=c.Commands.TI(n.name())]=e.endTransaction(),i=!0),i},j.prototype.undo=function(){var t,n,e,i,i,t=this,n=!1,e=t.Mf;return t.canUndo()&&(i=c.Commands.TI(e.name()),i=t.tT[i],e)&&i&&(t.X5(e,!0),e.Ut.undo(i),t.q5(e,!0),n=!0),n},e(W,k=i=j),g=W,e(Q,D=i),p=Q,e(O,F=t),O.prototype.canExecute=function(){var t,n,e,i,t,t=this,n,e=t.Mf.NMi;return!e||(i=t.tT.level,t=_(t),e.detailColumnsVisible())||i<t.getMaxLevel()},O.prototype.execute=function(){var t,n,e,i,t,r,t=this,n=t.Mf,e=t.tT,i=n.Ut;return i.startTransaction(),t=$.call(t,!0),e[r=c.Commands.TI(n.name())]=i.endTransaction(),t},O.prototype.undo=function(){return $.call(this,!1)},e(tt,P=n=O),b=tt,e(nt,G=n),y=nt,e(R,U=t),R.prototype.canExecute=function(){var t,n,e,i,t,t=this,n,e=t.Mf.NMi;return!e||(i=t.tT.level,t=_(t),e.detailColumnsVisible())||i<=t.getMaxLevel()},R.prototype.execute=function(){var t,n,e,i,r,o,a,a,a,t=this,n=t.Mf,e=!1;if(t.canExecute()&&(i=void 0,r=t.tT.level,o=_(t),n)&&o&&!d(r)){for(n.Ut.startTransaction(),t.X5(n,!0),n.suspendCalcService(),n.Ut.m2t(t.v2t),o.Xst(),i=0;i<r;i++)o.expand(i,!0,!0);o.expand(r,!1,!0),o.$st(),n.Ut.m2t(t.v2t,!0),a=t.tT.index,d(a)&&(a=(0,w.getExtendIndex)(n,t.v2t,r)),q.call(t,!1,t.v2t,{level:r-1,index:a}),(a=n.getCalcService()).Vct="filter",n.recalcRange(0,0,n.getRowCount(),n.getColumnCount()),delete a.Vct,n.resumeCalcService(!1),a.Zct(),t.q5(n,!0),a=c.Commands.TI(n.name()),t.tT[a]=n.Ut.endTransaction(),e=!0}return e},R.prototype.undo=function(){var t,n,e,i,i,t=this,n=!1;return t.canUndo()&&(e=t.Mf,i=c.Commands.TI(e.name()),i=t.tT[i],e)&&i&&(t.X5(e,!0),e.Ut.undo(i),t.q5(e,n=!0)),n},e(et,H=i=R),M=et,e(it,z=i),C=it,S=c.Commands.zA,c.Commands[r]={canUndo:!0,execute:function(t,n,e){return S(t,v,n,e)}},c.Commands[s]={canUndo:!0,execute:function(t,n,e){return S(t,m,n,e)}},c.Commands[o]={canUndo:!0,execute:function(t,n,e){return S(t,g,n,e)}},c.Commands[f]={canUndo:!0,execute:function(t,n,e){return S(t,p,n,e)}},c.Commands[a]={canUndo:!0,execute:function(t,n,e){return S(t,b,n,e)}},c.Commands[l]={canUndo:!0,execute:function(t,n,e){return S(t,y,n,e)}},c.Commands[u]={canUndo:!0,execute:function(t,n,e){return S(t,M,n,e)}},c.Commands[h]={canUndo:!0,execute:function(t,n,e){return S(t,C,n,e)}},c.Commands.g2t=function(t){t.register(r,c.Commands[r]),t.register(s,c.Commands[s]),t.register(o,c.Commands[o]),t.register(f,c.Commands[f]),t.register(a,c.Commands[a]),t.register(l,c.Commands[l]),t.register(u,c.Commands[u]),t.register(h,c.Commands[h])}},"./dist/plugins/group/group.entry.js":function(t,n,e){"use strict";var i,r,i=this&&this.__createBinding||(Object.create?function(t,n,e,i){void 0===i&&(i=e);var r=Object.getOwnPropertyDescriptor(n,e);r&&("get"in r?n.__esModule:!r.writable&&!r.configurable)||(r={enumerable:!0,get:function(){return n[e]}}),Object.defineProperty(t,i,r)}:function(t,n,e,i){t[i=void 0===i?e:i]=n[e]}),r=this&&this.__exportStar||function(t,n){for(var e in t)"default"===e||Object.prototype.hasOwnProperty.call(n,e)||i(n,t,e)};Object.defineProperty(n,"__esModule",{value:!0}),r(e("./dist/plugins/group/group-actions.js"),n),r(e("./dist/plugins/group/group.js"),n),r(e("./dist/plugins/group/group.ns.js"),n)},"./dist/plugins/group/group.js":function(b,f,t){"use strict";var w,n,x,M,t,e,I,y,U,H,A,z,c,N,V,v,l,h,Y,R,C,S,u,k,T,B,L,D,F,P,_,Z,Q,J,W,G,d,K,m,X,q,$,tt,nt,n,et,t,it,rt,ot,t,g,E,i,at,ut,n,n;function st(t,n){t.ki(x.Events.RangeGroupStateChanging,n)}function ct(t,n){t.ki(x.Events.RangeGroupStateChanged,n)}function ft(t,n){var t,e,t,t=t.options,e;return!t.isProtected||(t=t.protectionOptions,n?t.allowOutlineRows:t.allowOutlineColumns)}function lt(t,n){var e,i,n,i,r,o,e=n.what===d,i=ft(t,e);t.isEditing&&t.isEditing()||!i?i||t.jT(x.InvalidOperationType.groupProtected,(0,f.getSR)().Exp_GROUP_PROTECTED):(i=e?"expandRowOutlineForLevel":"expandColumnOutlineForLevel",st(t,r=dt(t,e,-1,n=n.info.index,!0)),o=vt(t,e,n-1),r&&!1===r.cancel&&(t.Qy().execute({cmd:i,sheetName:t.name(),level:n,index:o}),ct(t,dt(t,e,-1,n,!1))))}function ht(t,n){var e,i,i,n,r,o,a,u,e=n.what===m,i=ft(t,e);t.isEditing&&t.isEditing()||!i?i||t.jT(x.InvalidOperationType.groupProtected,(0,f.getSR)().Exp_GROUP_PROTECTED):j(e,t)&&(r=n=(i=n.info).index,o=i.level,u=e?"expandRowOutline":"expandColumnOutline",1===i.lineDirection?n--:n++,st(t,a=dt(t,e,n,o,!(a=void 0))),a)&&!1===a.cancel&&(t.Qy().execute({cmd:u,sheetName:t.name(),index:r,level:o,collapsed:i.isExpanded}),ct(t,dt(t,e,n,o,!1)))}function dt(t,n,e,i,r){var t={sheet:t,sheetName:t.name(),isRowGroup:n,index:e,level:i};return r&&(t.cancel=!1),t}function vt(t,n,e){var i,r,o,a,i=n?t.rowOutlines:t.columnOutlines;if(i)for(r=i.items,o=!1,a=0;a<r.length;a++)if(r[a])if(r[a].level===e)o=!0;else if(o)return a;return n?t.getActiveRowIndex():t.getActiveColumnIndex()}function mt(t,n){var e,i,r,o,a,r,a,u,e=this,i=e.gj(),r=i.width,o=i.height;return(r||o)&&(a=e.Fi(),r=new x.Rect(i.x,i.y,r,a.height),a=new x.Rect(i.x,i.y,a.width,o),r.contains(t,n)||a.contains(t,n))?(u=(u=gt(e,t,n,i.rowMaxLevel,!0))||gt(e,t,n,i.colMaxLevel,!1))||{what:"empty",info:I}:I}function r(t,n,e){var i=this;i.PADDING=2,i.Mf=t,i.v2t=n,i.$X=u(e)?e:j(n,t).getMaxLevel()}function o(t,n,e,i){var r=this;r.PADDING=2,r.LINE_SIZE=2,r.START_LINE_SIZE=6,r.p2t=[],r.b2t=[],r.y2t=[],r.Mf=t,r.v2t=n,r.w2t=e,r.$X=u(i)?i:j(n,t).getMaxLevel()}function gt(t,n,e,i,r){var o,a,u,s,o,a=new it(t,r,i).M2t(n,e,r);if(a)return{what:r?d:K,info:a};for(u=pt(t,r,i),s=0;s<=2;s++)if(a=u[s].C2t(n,e,r))return{what:r?m:X,info:a};return I}function pt(t,n,e){for(var i=[new rt(t,n,0,e),new rt(t,n,1,e),new rt(t,n,2,e)],r,r=0;r<=2;r++)i[r].S2t();return i}function bt(t,n){var n=n?t.width:t.height;return U(0,(n-2*this.PADDING)/(this.$X+2))}function j(t,n){return t?n.rowOutlines:n.columnOutlines}function yt(t,n,e,i){var r=this;r.children=[],r.parent=I,r.model=t,r.start=n,r.end=e,r.level=i}function wt(t){this.level=t?t.level:0,this.collapsed=!!t&&t.collapsed,this.viewCollapsed=!!t&&t.viewCollapsed}function Mt(t,n,e){var i,r,o,a;if(0<e){for(i=t.items,o=r=void 0,a=[],r=0;r<e;r++)a.push(I);if(t.items=i=i.slice(0,n).concat(a,i.slice(n)),t.T2t<=0&&0<n&&(o=i[n-1]))for(r=0;r<e;r++)i[n+r]=new E(o);It(t)}}function Ct(t,n,e){0<e&&(t.items.splice(n,e),It(t))}function St(t,n,e){for(var i,r,o,o,a,u,s,c,i=I,r=t.items,a=n,u=Y(r);a<u&&(!(o=r[a])||o.level<e||(i=i||new g(t,a,a,e),o.level>e&&(a=(o=St(t,a,e+1)).index,i.addChild(o.g)),a>i.end&&(i.end=a),!t.isGroupEnd(a,e)));a++);if(i)for(s=i.end+1,c=i.start;c<s;c++)r[c].groupInfo||(r[c].groupInfo=i);return{g:i,index:a}}function a(t,n){return-1<=n&&n<Y(t.items)}function Tt(t,n,e){var t,i,r,t=t&&t.items;if(t)for(i=t[n]&&t[n].groupInfo;i;){if((r=i.level)===e)return i;if(!(e<r))break;i=i.parent}return I}function At(t,n){switch(t){case"head":case"tail":return n===I;case"direction":return 1===n;case"itemsData":return 0===Y(n);default:return}}function It(t){t.A2t=I,t.refresh()}function O(t,n){!n&&t.I2t||(t.A2t=t.createRangeGroup(),Nt(t))}function xt(t){t.I2t&&!t.A2t&&(t.A2t=t.createRangeGroup())}function Nt(t,n){!t.I2t&&t.groupChangeHandler&&t.groupChangeHandler(n)}function kt(t,n,e){if(Dt(t,n),!a(t,n+e-1))throw new Error((0,f.getSR)().Exp_InvalidCount)}function Dt(t,n){if(!a(t,n))throw new Error((0,f.getSR)().Exp_InvalidIndex)}function _t(t,n){for(var e,i,e=t.parent;e&&(i=n?t.end===e.end:t.start===e.start);)e=(t=e).parent;return t}function s(t,n,e){var i=this;i.head=I,i.tail=I,i.A2t=I,i.items=new Array(t),i.T2t=0,i.x2t=!0,i.Mf=n,i.v2t=e}function p(t){return t&&new E(t)}function Et(t){return{items:t.items.map(p),head:p(t.head),tail:p(t.tail),x2t:t.x2t,direction:t.direction()}}function jt(t,n){t.items=n.items.map(p),t.head=p(n.head),t.tail=p(n.tail),t.x2t=n.x2t,t.direction(n.direction),O(t,!0)}function Ot(t,n,e,i,r){var o,a,u,s,c,f,l,h,d,v,m,g,p,b,y,w,p;if(t)for(o=0===i,a=t.rowItems,s=function(t){return o?t<n.rowCount:0<=t},c=function(t){return o?t+1:t-1},f=function(t){return o?t-1:t+1},l=function(t,n){var t=a[t];if(t)return t.level===n?t:l(t.parentIndex,n)},h=(u=function(){return o?0:n.rowCount-1})(),d=void 0;s(h);h=c(h))(v=a[h])&&-1!==v.level?(m=f(h),p=!(g=a[m])&&"number"==typeof v.level||g&&g.level<v.level,b=g&&g.level>v.level,w=y=void 0,p?(y=m,w=!!g&&(g.collapsed||g.viewCollapsed)):b?-1===v.level?w=!1:(p=void 0,(p=g.parentIndex===d?g:l(g.parentIndex,v.level))&&(y=p.parentIndex,w=p.viewCollapsed)):(y=g.parentIndex,w=g.viewCollapsed),v.parentIndex=y,!(v.viewCollapsed=w)&&e[h].hidden&&(e[h].visible=!1,k(r.infos[h])&&(r.infos[h]={}),r.infos[h].visible=!1)):d=h}function Rt(t,n,e,i,r,o){var a,u,s,c,f,a=t.itemsData;a&&(u=a[a.length-1],s=a[a.length-2],c=u&&u.info,f=s&&s.info,c)&&(i&&r&&1===u.count?f&&s.index===u.index-1&&f.level===c.level-1?f.collapsed=!0:0<n?a.splice(a.length-2,0,{index:u.index-1,count:1,info:{level:c.level-1,collapsed:!0}}):t.head={collapsed:!0,level:e-1}:!i&&o&&(f&&u.index===s.index+1&&c.level===f.level-1?u.collapsed=!0:n>=u.index+u.count&&a.push({index:u.index+u.count,count:1,info:{level:c.level-1,collapsed:!0}})))}w=this&&this.__spreadArray||function(t,n,e){if(e||2===arguments.length)for(var i=0,r=n.length,o;i<r;i++)!o&&i in n||((o=o||Array.prototype.slice.call(n,0,i))[i]=n[i]);return t.concat(o||Array.prototype.slice.call(n))},Object.defineProperty(f,"__esModule",{value:!0}),f.Outline=f.isIndexValid=f.OutlineInfo=f.OutlineState=f.OutlineDirection=f.getExtendIndex=f.getSR=void 0,n=t("Common"),x=t("Core"),M=t("./dist/plugins/group/group-actions.js"),t=t("./dist/plugins/group/group.ns.js"),e={},I=null,y=void 0,U=Math.max,H=Math.min,A=Math.round,z=Math.ceil,c=x.GC$,N=c.each,V=x.I.fl,v=n.Common.Uf,l=v.N2t,h=v.d5,Y=v.tR,R=8.25,C=17,S=4,u=x.mt.T1,k=n.Common.lt.ht,T=x.mt.p0,B=x.mt.vt,L=x.mt.o1,D=x.mt.xr,F=x.mt.go,P="rangegroup",Q=(Z=(_="gc-group")+"-box")+"-expand",J=Z+"-collapsed",W=_+"-line",G=_+"-dot",d="rgh",K="cgh",m="rg",X="cg",q=x.XFileConstants.Su,$=x.XFileConstants.bo,tt="1",nt="0",n=new n.Common.ResourceManager(t.SR,"Outlines"),f.getSR=n.getResource.bind(n),et=x.NodeHelper.ur,t={gj:function(){var t,n,e,n,n,i,r,o,a,t=this,n=t.k2t;return n||(n={x:(n=(e=t.options).sheetAreaOffset).left,y:n.top,width:0,height:0,rowMaxLevel:-1,colMaxLevel:-1},i=t.rowOutlines,r=t.columnOutlines,o=17*t.zoom(),t.showRowOutline()&&i&&!i.Oy()&&0<=(a=i.getMaxLevel())&&(n.width=o*(a+2)+4,n.rowMaxLevel=a),t.showColumnOutline()&&r&&!r.Oy()&&0<=(a=r.getMaxLevel())&&(n.height=o*(a+2)+4,n.colMaxLevel=a),t.k2t=n)},showRowOutline:T("showRowOutline",!0,function(){this.zw()}),showColumnOutline:T("showColumnOutline",!0,function(){this.zw()})},c.extend(x.Worksheet.prototype,t),f.getExtendIndex=vt,r.prototype.D2t=function(t){var n,e,i,r,o,a,u,i,s,c,f,l,h,o,d,v,m,g,p,o,d,c,b,y,w,v,M,C,S,T,n=this,e=n.Mf,i=n.$X;if(!(i<0)&&(r=n.v2t,o=e.gj(),a=bt.call(n,o,r))){if(u=i+2,i=n.PADDING,s=e.options,c=o.width,f=o.height,l=o.x,h=o.y,d=(o=e.Fi()).width,v=o.height,m=o.qC,g=o.XC,p=o.BA,o=o.LA,t.save(),t.fillStyle=V(_).backgroundColor,t.strokeStyle=V(_).borderTopColor,t.lineWidth=1,t.fillRect(l,h,r?c:d,r?v:f),t.strokeRect(l-.5,h-.5,r?c:d+1,r?v+1:f),r?t.strokeRect(l-.5,o-.5,c,m):t.strokeRect(p-.5,h-.5,g,f),b=U(0,(r?o-s.sheetAreaOffset.top:p-s.sheetAreaOffset.left)+(d=(r?m:g)-a)/2),y=i,r&&(v=b,b=y,y=v),t.restore(),c=r?s.colHeaderVisible:s.rowHeaderVisible,t.save(),c&&0<=d)for(w=0;w<u;w++)M=a-1,C=void 0,S=l+b,T=h+y,r?S=A(S)+.5:T+=.5,t.fillStyle=V(Z).backgroundColor,t.fillRect(S,T,M,M),t.font=R*e.zoom()+"pt Arial",t.strokeStyle=V(Z).borderTopColor,t.strokeRect(S,T,M,M),t.fillStyle=V(Z).color,C=B(t.font),n._2t(t,S,T,M,a,w+1,C),r?b+=a:y+=a;t.restore()}},r.prototype._2t=function(t,n,e,i,r,o,a){var o=""+o,u=t.measureText(o).width;u<=i&&a<=r&&(t.textBaseline="middle",t.fillText(o,n+(i-u)/2,e+i/2))},r.prototype.M2t=function(t,n,e){var i,r,o,o,a,u,s,i=this,r=i.Mf,o=i.$X;return o<0?I:(o=o+2,a=r.Fi(),s=(u=r.options).sheetAreaOffset,e?i.E2t(r,t,n,e,u.colHeaderVisible,a.qC,a.LA-s.top,o):i.E2t(r,t,n,e,u.rowHeaderVisible,a.XC,a.BA-s.left,o))},r.prototype.E2t=function(t,n,e,i,r,o,a,u){var s,c,f,t,l,h,d,v,o,s=this,c=t.gj(),f=bt.call(s,c,i),t=o-f;if(f&&r&&0<=t)for(l=U(0,a+t/2),h=s.PADDING,i&&(o=l,l=h,h=o),v=0;v<u;v++){if((d=new x.Rect(c.x+l,c.y+h,f,f)).contains(n,e))return{index:v};i?l+=f:h+=f}return I},it=r,o.prototype.S2t=function(){var e,t,e=this;-1!==e.$X&&(t=e.j2t(0,e.v2t),N(t,function(t,n){e.O2t(n)}))},o.prototype.O2t=function(t){var o,n,e,n,a,i,r,e,u,s,c,f,l,h,d,v,h,m,g,p,b,y,w,M,C,S,w,T,A,o=this,n=o.Mf,e=o.v2t,n=j(e,n).direction(),a=1===n,i=0===n,r=o.R2t(!0,e),e=o.R2t(!1,e),u=t.start,s=t.end,c=t.level;if(a?f=s+1:i&&(f=u-1),0===t.state()){if(l=!0,(l=(h=t.parent)&&(i&&u===h.start||a&&s===h.end)?!1:l)&&o.B2t(!0,c,f,r,e,n),u<=e&&r<=s){for(d=U(r,u),v=H(e,s),m=h=void 0,l&&(h={start:d,end:v,level:c,startLine:I},(a&&d===u||i&&v===s)&&(h.startLine=!0),o.p2t.push(h)),p=[],b=t.children,m=d;m<=v;m++)p.push(!1);for(N(b,function(t,n){var e=n.start,i=n.end,r;if(1===n.state())for(g=e;g<=i;g++)p[g-d]=!0;p[(r=a?i+1:i-1)-d]=!0,o.O2t(n)}),y=!0,m=0;m<Y(b);m++){if(M=(w=b[m]).start,w=(C=w.end)===s,(S=M===u)&&w){y=!1;break}if(a&&w||i&&S)for(g=M;g<=C;g++)p[g-d]=!0}if(y)for(T=d;T<=v;T++)p[T-d]||o.b2t.push(A={index:T,level:c+1})}}else 1===t.state()&&o.B2t(!1,c,f,r,e,n)},o.prototype.B2t=function(t,n,e,i,r,o){var n={isExpanded:t,level:n};t&&(n.paintLine=!0),i<=e&&e<=r&&(n.index=e,n.lineDirection=o,this.y2t.push(n))},o.prototype.L2t=function(t){var n=this,e=n.Mf,i=n.w2t;return n.v2t?e._y(i).findRow(t):e.Yy(i).findCol(t)},o.prototype.F2t=function(t){var n,e,i,r,o,a,u,s,c,e,f,l,h,d,n=this;-1!==n.$X&&(i=(e=n.Mf).gj(),r=n.v2t,o=bt.call(n,i,r))&&(a=parseInt(V(W).borderTopWidth,10),a=isNaN(a)?2:a,u=A(o/3),c=(o-a)/2+(s=n.PADDING),t.save(),t.fillStyle=V(_).color,e=e.Fi(),l=f=0,h=i.width,d=i.height,r?(l+=e.y+e.qC,d=e.height-e.qC):(f+=e.x+e.XC,h=e.width-e.XC),t.rect(f,l,h,d),t.clip(),n.P2t(t,n.b2t,r,i,o,c,a),r?n.G2t(t,n.p2t,r,i,o,c,a,u):n.U2t(t,n.p2t,r,i,o,c,a,u),n.H2t(t,n.y2t,r,i,o,c,a,s),t.beginPath(),t.restore())},o.prototype.P2t=function(o,t,a,u,s,c,f){var l,h,d,n,e,i,r,v,m,g,d=this,n=2,e,i,r=d.Mf.options.sheetAreaOffset,v=r.left,m=r.top;o.save(),o.fillStyle=V(G).color,g=d.p2t,N(t,function(t,n){var e,i,r,e,i,r,e,i,e=n.index,i=n.level,r=d.L2t(e);r&&!d.z2t(g,e,i)&&(e=a?r.y:r.x,0<=(i=(a?r.height:r.width)-f))&&(l=e+U(0,i/2),h=n.level*s+c,a?(r=l,l=h+.5,h=r,h-=m):(h+=.5,l-=v),o.strokeStyle="transparent",o.lineWidth=0,(e=u.x+l)%1!=0&&(e+=.5),(i=u.y+h)%1!=0&&(i+=.5),o.strokeRect(e,i,2,2),o.fillRect(e,i,2,2))}),o.restore()},o.prototype.z2t=function(t,n,e){for(var i,r,o,i=!1,r=Y(t),o=0;o<r;o++)if(t[o].level===e&&t[o].start<=n&&t[o].end>=n){i=!0;break}return i},o.prototype.G2t=function(t,n,e,i,r,o,a,u){var s,e,c,f,l,h,d,v,m,g,p,b,y,w,M,C,M;for(t.save(),t.strokeStyle=V(W).borderTopColor,t.fillStyle=V(W).borderTopColor,t.lineWidth=a,c=j(e,e=(s=this).Mf).direction(),d=(h=(l=e.options).sheetAreaOffset).top,f=0;f<Y(n);f++){for(m=(v=n[f]).start,g=v.end,b=p=void 0;p=s.L2t(m),m++,!p&&m<=g;);for(;b=s.L2t(g),g--,!b&&m<=g;);(p||b)&&(p?b=b||p:p=b,y=p.y,w=v.level*r+o,M=a,C=U(0,b.y+b.height-p.y),1===c?y+=1:--y,y-=d,t.beginPath(),M=i.x+w+M/2,M=z(M),t.moveTo(M,i.y+y),t.lineTo(M,i.y+y+C),t.stroke(),v.startLine)&&0<r/2-2*a&&(y=0===c?y+C-a-d:y)>=p.y-d&&y<b.y+b.height-d&&t.fillRect(z(i.x+w),i.y+y,u,a)}t.restore()},o.prototype.U2t=function(t,n,e,i,r,o,a,u){var s,e,c,f,l,h,d,v,m,g,p,b,y,w,M,C;for(t.save(),t.strokeStyle=V(W).borderTopColor,t.fillStyle=V(W).borderTopColor,t.lineWidth=a,c=j(e,e=(s=this).Mf).direction(),d=(h=(l=e.options).sheetAreaOffset).left,f=0;f<Y(n);f++){for(m=(v=n[f]).start,g=v.end,b=p=void 0;p=s.L2t(m),m++,!p&&m<=g;);for(;b=s.L2t(g),g--,!b&&m<=g;);(p||b)&&(p?b=b||p:p=b,y=p.x,w=v.level*r+o,M=U(0,b.x+b.width-p.x),1===c&&(y+=1),y-=d,C=i.y+w+a/2,C=z(C),t.beginPath(),t.moveTo(i.x+y,C),t.lineTo(i.x+y+M,C),t.stroke(),v.startLine)&&0<r/2-2*a&&(y=0===c?y+M-a-d:y)>=p.x-d&&y<b.x+b.width-d&&t.fillRect(i.x+y,z(i.y+w),a,u)}t.restore()},o.prototype.V2t=function(t){var t=V(t).backgroundImage;return t=(t="none"===t?"":t)&&(t=(t=t.split(",")[0]).replace(/url\(['"]?([^'"\)]+)['"]?\)/,"$1")).trim()},o.prototype.H2t=function(t,n,e,i,r,o,a,u){var s,c,f,l,h,d,B,L,F,P,G,l,v,m,g,f,l,p,b,y,w,M,C,C,S,T,A,I,x,N,k,D,_,E,x,T,j,O,R,S,S,O,C,k,D,I,D,s=this,f=s.Mf,l=f.options,h=l.sheetAreaOffset.left,d=l.sheetAreaOffset.top,B=V(Z).borderTopColor,L=V(Z).backgroundColor,F=V(Z).color,P=V(W).borderTopColor,G=1,l=f.BO(),v=s.V2t(Q),m=s.V2t(J);for(v&&!l.jt(v)&&l.Rt(v),m&&!l.jt(m)&&l.Rt(m),g=m&&l.Ot(m),f=v&&l.Ot(v),l=V(Q),p=V(J),b=f?l.backgroundColor:"",y=g?p.backgroundColor:"",w=f?l.borderTopColor:"",M=g?p.borderTopColor:"",c=0;c<Y(n);c++)t.save(),A=n[c],!(I=s.L2t(A.index))||(x=e?I.height:I.width)<=0?t.restore():(N=U(0,(x-r)/2),_=(e?I.y-d:I.x-h)+N,E=A.level*r+u,O=j=D=k=void 0,R=x-(x=H(T=r,x)),O=e?(S=_,_=E,E=S,S=x,x=T,T=S,j=.5,0):(j=0,.5),S=A.isExpanded?w:M,t.strokeStyle=S||B,t.lineWidth=1,C=A.isExpanded?b:y,t.fillStyle=C||L,t.fillRect(i.x+_,i.y+E,x,T),k=i.x+_+j,D=i.y+E+O,t.strokeRect(k,D,x,T),t.fillStyle=F,C=A.isExpanded?v:m,s.Y2t(t,A.isExpanded,C,k,D,x,T),t.restore(),A.paintLine&&0<R&&(t.save(),t.strokeStyle=P,_=e?I.y-d:I.x-h,E=A.level*r+o,O=0===A.lineDirection,C=e?a:N,k=e?N:a,e?(D=_,_=E,E=D,O&&(E+=N+T,k=R-N)):O&&(_+=N+x,C=R-N),t.beginPath(),t.lineWidth=a,I=z(i.x+_+a/2),D=z(i.y+E+a/2),e?(t.moveTo(I,i.y+E),t.lineTo(I,i.y+E+k-1)):(T=0,g&&!A.isExpanded&&(T=1),t.moveTo(i.x+_,D),t.lineTo(i.x+_+j+C+T,D)),t.stroke(),t.restore()))},o.prototype.Y2t=function(t,n,e,i,r,o,a){var u,s,c,c,e,f,u=this,s,c=this.Mf.BO();if(e&&c.jt(e)){e=(c=c.Ot(e)).width,f=c.height;try{t.drawImage(c,0,0,e,f,A(i),A(r),o-1,a-1)}catch(t){}}else u.Z2t(t,n,i,r,o,a)},o.prototype.Z2t=function(t,n,e,i,r,o){var a,u,n,s,a=A(r/4),u=A(r/2);n||(n=A(o/4),s=A(o/2),t.fillRect(e+r/2-1,i+n,2,o-s)),t.fillRect(e+a,i+o/2-1,u,2)},o.prototype.j2t=function(t,n){var e,i,r,o,a,u,s,c,e,f,l,e,e=this,i=e.Mf,r=[],a=-1,u=-1,s=j(n,i),c,e=(n?i._y:i.Yy).call(i,e.w2t),f=Y(e);for(f&&(l=e[0],e=e[f-1],a=U(0,(n?l.row:l.col)-1),u=n?H(i.getRowCount(),e.row+2):H(i.getColumnCount(),e.col+2));a<u;)(o=s.find(a,t))?(a=o.end+1,r.push(o)):a++;return r},o.prototype.R2t=function(t,n){var e=-1,i=this,r=i.Mf,i=i.w2t,o=r.frozenRowCount(),a=r.frozenColumnCount(),u=r.frozenTrailingRowCount(),s=r.frozenTrailingColumnCount(),c=r.getRowCount(),r=r.getColumnCount();return 0===i?e=t?0:(n?o:a)-1:1===i?e=t?n?o:a:(n?c-u:r-s)-1:2===i&&(e=t?n?c-u:r-s:(n?c:r)-1),e},o.prototype.W2t=function(t){t&&this.Mf.Oi&&(t.x-=2,t.y-=2,t.width+=4,t.height+=4)},o.prototype.C2t=function(t,n,e){var i,r,o,a,u,s,c,f,l,h,d,v,m,g,d,g,p,g,h,b,y,y,i=this,r=i.$X,o=i.Mf,a=o.options,u=a.sheetAreaOffset.left,s=a.sheetAreaOffset.top;if(!(r<0)&&(c=o.gj(),f=bt.call(i,c,e)))for(l=i.y2t,v=0;v<Y(l);v++)if(g=(m=l[v]).index,d=m.level*f+i.PADDING,(g=i.L2t(g))&&!((h=e?g.height:g.width)<=0)&&(p=H(f,h),h=(e?g.y-s:g.x-u)+U(0,(h-(g=f))/2),b=d,e&&(y=p,p=g,g=y,y=h,h=d,b=y),d=new x.Rect(c.x+h+.5,c.y+b+.5,p,g),i.W2t(d),d.contains(t,n)))return m;return I},rt=o,(n=ot=f.OutlineDirection||(f.OutlineDirection={}))[n.backward=0]="backward",n[n.forward=1]="forward",e.OutlineDirection=ot,(n=t=f.OutlineState||(f.OutlineState={}))[n.expanded=0]="expanded",n[n.collapsed=1]="collapsed",e.OutlineState=t,yt.prototype.state=function(t){var n=this,e=n.model;if(!arguments.length)return e?e.getState(n):0;e&&e.expandGroup(n,0===t)},yt.prototype.contains=function(t){return this.start<=t&&t<=this.end},yt.prototype.addChild=function(t){t&&(this.children.push(t),t.parent=this)},g=yt,f.OutlineInfo=g,e.OutlineInfo=g,E=wt,f.isIndexValid=a,s.prototype.L0=function(){this.Mf=I},s.prototype.getUsedRange=function(t){var t,n,e,i,r,t,o,n,a,r,u,a,u;if(t&x.UsedRangeType.axis)return n=(t=this).items,e=t.v2t,r=(i=Object.keys(n)).length,t=t.Mf,0<r&&t?(a=n[+i[o=0]],u=n[+i[r=(n=r)-1]],a&&-1===a.level&&(o=1),u&&-1===u.level&&(n=r),e?(a=t.getColumnCount()-1,{minRow:+i[o],minCol:0,maxRow:+i[n-1],maxCol:a}):(u=t.getRowCount()-1,{minRow:0,minCol:+i[o],maxRow:u,maxCol:+i[n-1]})):void 0},s.prototype.group=function(t,n){var e=this,i,r;for(kt(e,t,n),e.Mf.Ut.m2t(e.v2t),i=0;i<n;i++)e.items[r=t+i]?e.items[r].level++:e.items[r]=new E;e.I2t&&e.A2t&&(e.A2t=I),e.Mf.Ut.m2t(e.v2t,!0),O(e),e.x2t=!1},s.prototype.Xst=function(){this.I2t=!0,this.A2t=I},s.prototype.$st=function(){var t=this;t.I2t=!1,t.refresh()},s.prototype.ungroupRange=function(t,n){var e=this,i,r;for(kt(e,t,n),e.Mf.Ut.m2t(e.v2t),i=0;i<n;i++)(r=e.items[t+i])&&-1<r.level&&r.level--;e.Mf.Ut.m2t(e.v2t,!0),O(e)},s.prototype.ungroup=function(){var t=this,n=Y(t.items);t.Mf.Ut.m2t(t.v2t),t.items=new Array(n),O(t),t.x2t=!0},s.prototype.expand=function(t,n,e){var i,r,o,a,u,s,c;if(t<-1)throw new Error((0,f.getSR)().Exp_InvalidLevel);for(r=(i=this).items,(a=i.Mf).Ut.m2t(i.v2t),xt(i),u=a.op(),a.suspendPaint(),u.suspend(),s=0,c=r.length;s<c;s++)r[s]&&(o=i.find(s,t))&&(i.expandGroup(o,n,!0),s=o.end);e||i.Mf.Ut.m2t(i.v2t,!0),u.resume(!1),a.resumePaint()},s.prototype.expandGroup=function(t,n,e){if(!t)throw new Error((0,f.getSR)().Exp_GroupInfoIsNull);var i=this,r=i.direction(),o=-1;e||i.Mf.Ut.m2t(i.v2t),0===r?o=t.start-1:1===r&&(o=t.end+1),i.setCollapsed(o,!n,t.level,e),e||i.Mf.Ut.m2t(i.v2t,!0),i.Mf.zw()},s.prototype.tF=function(t){return!(!this.x2t&&a(this,t)&&this.isCollapsed(t))},s.prototype.isCollapsed=function(t){var t=this.items[t];return!!(t&&t.viewCollapsed&&-1<t.level)},s.prototype.find=function(t,n){var e=this,i;return xt(e),i=-1===n?e.A2t:(e.Mf.NMi||Dt(e,t),Tt(e,t,n))},s.prototype.getLevel=function(t){var t=this.items[t];return t?t.level:-1},s.prototype.getCollapsed=function(t){var t=this.items[t];return!!t&&!!t.collapsed},s.prototype.Q2t=function(t,n,e,i){for(var r,o,r=n;r<=e;r++)(o=t[r])||((o=t[r]=new E).level=-1),o.viewCollapsed=i},s.prototype.setCollapsed=function(t,n,e,i){var r,o,a,u,s,c,s,a,f,l,h,r=this,o=!1,a=r.items,s=r.Mf.Ut,c=[];if(i||s.m2t(r.v2t),xt(r),t<0?u=(u=r.head)||(r.head=new E):t<Y(a)?(u=a[t])||((u=a[t]=new E).level=-1):u=(u=r.tail)||(r.tail=new E),s=1===r.direction(),(a=e!==y)||u.collapsed===n?a&&(u.level===e-1&&(u.collapsed=n),o=!0,r.K2t(t,n,e)):(u.collapsed=n,o=!0,r.K2t(t,n,e)),o&&(l=r.find(t+=s?-1:1,r.getLevel(t)))){for(h=l.start;h<=l.end;h++)c.push(h);f={indexes:c}}Nt(r,f),i||r.Mf.Ut.m2t(r.v2t,!0)},s.prototype.J2t=function(t,n){var e,e,e=this.items;e[t]?e[t].collapsed!==n&&(e[t].collapsed=n):((e=e[t]=new E).level=-1,e.collapsed=n)},s.prototype.K2t=function(t,n,e){var i,r,o,a,u,s,c,s,f,e,l,h,d,v,m,g,p,b,i=this,r=i.items,o=1===i.direction(),a,u=e!==y,s=t+(o?-1:1),c=u?e:i.getLevel(s),s=Tt(i,s,c);if(s&&(f=o?s.end+1:s.start-1)!==t&&(s=null),k(s)&&(c=u?e:i.getLevel(t),s=Tt(i,t,c)),s)if(e=void 0,l=s.parent,n)u||(e=o?s.end+1:s.start-1,i.J2t(e,!0),s=_t(s,o)),i.Q2t(r,s.start,s.end,!0);else{for(h=!1,d=void 0;l;){if(r[d=o?l.end+1:l.start-1]&&r[d].collapsed&&-1<r[d].level){h=!0;break}l=l.parent}if(!h)for(u||(e=o?s.end+1:s.start-1,i.J2t(e,!1),s=_t(s,o)),i.Q2t(r,s.start,s.end,!1),v=[s],m=0;0<=m;)if(g=v[m],m--,r[d=o?g.end+1:g.start-1]&&r[d].collapsed&&-1!==r[d].level)i.Q2t(r,g.start,g.end,!0);else for(p=g.children,b=0;p&&b<p.length;b++)v[++m]=p[b]}},s.prototype.getMaxLevel=function(){var e=-1,t=this.items,i;return N(t,function(t,n){n&&(i=n.level,e<i)&&(e=i)}),e},s.prototype.PB=function(t,e,n,i){var r,o,a,u,s;if(!(n<=0||t===e)){for((r=this).Mf.Ut.m2t(r.v2t),e<0&&(e=0),o=[],a=r.items,u=l(a,(t=t<0?0:t)-1);0<=u&&u<t+n;)s=new E(a[u]),o.push({index:u-t,value:s}),u=l(a,u);i&&h(a,t,n),h(a,e,n),N(o,function(t,n){a[e+n.index]=n.value}),It(r),r.Mf.Ut.m2t(r.v2t,!0)}},s.prototype.FB=function(t,n,e,i,r){var o,a,u,o=this;if(o.Mf.Ut.m2t(o.v2t),n<0&&(n=0),e<0&&(e=0),a=[],t)for(u=l(t.items,n-1);0<=u&&u<n+i;)a[u-n]=new E(t.items[u]),u=l(t.items,u);h(o.items,e,i),0<a.length&&a.forEach(function(t,n){o.items[e+n]=t}),r&&h(t.items,n,i),o.Mf.Ut.m2t(o.v2t,!0)},s.prototype.refresh=function(){this.x2t||O(this)},s.prototype.X2t=function(t){var n=this,e=n.items,i,r=t-Y(e);r<0?e.splice(t,-r):n.items=e.concat(new Array(r)),It(n)},s.prototype.getState=function(t){var n=this,e=n.items,i,i=n.direction(),r=-1;return 0===i?r=t.start-1:1===i&&(r=t.end+1),(i=r<0?n.head:r<Y(e)?e[r]:n.tail)&&i.collapsed?1:0},s.prototype.q2t=function(t,n){var e=this,i=e.items;t<0?(e.head||(e.head=new E),e.head.level=n):t<Y(i)?(i[t]||(i[t]=new E),i[t].level=n):(e.tail||(e.tail=new E),e.tail.level=n),It(e)},s.prototype.suspendAdding=function(){this.T2t++},s.prototype.resumeAdding=function(){this.T2t--},s.prototype.createRangeGroup=function(){for(var t,n,e,i,r,o,a,t=this,n=t.items,e=Y(t.items),i=new g(t,0,e-1,-1),r=0;r<e;)n[r]&&(n[r].groupInfo=I),r++;for(r=0;r<e;)n[r]?(a=(o=St(t,r,0)).g,r=o.index+1,a&&-1<a.level&&i.addChild(a)):r++;return i},s.prototype.$2t=function(t,n){return 1===this.direction()?n===t.end+1:n===t.start-1},s.prototype.tpt=function(t,n,e,i){var r=this,o=-1,a=0;if(1===r.direction()&&(o=0,a=1),t===n)return r.$2t(t,e)||r.$2t(t,i)?{start:t.start,end:t.end,level:t.level}:{start:e,end:i,level:t.level};for(;t.level>n.level;){if(n===t.parent)return r.$2t(n,i)?{start:n.start,end:n.end,level:n.level}:{start:t.start+o,end:i,level:t.level-1};t=t.parent}for(;t.level<n.level;){if(t===n.parent)return r.$2t(t,e)?{start:t.start,end:t.end,level:t.level}:{start:e,end:n.end+a,level:n.level-1};n=n.parent}for(;0<=t.level;){if(t.parent===n.parent)return{start:t.start+o,end:n.end+a,level:n.level-1};t=t.parent,n=n.parent}return{start:t.start+o,end:n.end+a,level:n.level-1}},s.prototype.npt=function(t){var n,e,i,n,r,o,n=this,e=n.items,i=e[t],n=1===n.direction()?e[t-1]:e[t+1],r,o;return(i?i.level:-1)<(n?n.level:-1)?n&&n.groupInfo:i&&i.groupInfo},s.prototype.lB=function(t,n){var e,i,r,o,e,e=this,i=e.npt(t),r=e.npt(t+n-1);if(k(i)&&k(r))return{start:t,end:t+n-1,count:n,level:-1};if(!i||!r){for(o=i||r;o&&-1!==o.level;)o=o.parent;i=i||o,r=r||o}return(e=e.tpt(i,r,t,t+n-1)).count=e.end-e.start+1,e},s.prototype.kB=function(t,n){for(var e,i,r,o,e,e,e=this,i=e.items,r=t;r<t+n;r++)if(o=i[r]&&i[r].groupInfo&&i[r].groupInfo.level,!k(o)&&0<=o)return!0;return e=i[e=1===e.direction()?t-1:t+n]&&i[e].groupInfo&&i[e].groupInfo.level,!k(e)&&0<=e},s.prototype.ept=function(t){var n,e,e,n,e=this.items,e=e[t]&&e[t].groupInfo&&e[t].groupInfo.level;return k(e)?-1:e},s.prototype.ipt=function(t,n,e){for(var i,r,o,a,u,i=this,r=[],o=[],a=t;a<t+n;a++)(u=i.ept(a))===e&&o.push(a),i.ept(a+1)<e&&0<o.length&&(r.push(o),o=[]);return 0<o.length&&r.push(o),r},s.prototype.hB=function(t,n){var e,i,r,o,a,e=this;if(1===n)return e.ipt(t.start,t.count,t.level);for(i=[],r=e.getMaxLevel(),o=2===n?t.level+1:t.level,a=r;o<=a&&-1<=a;a--)i=i.concat(e.ipt(t.start,t.count,a));return i},s.prototype.vB=function(t,n,e){for(var i,r,o,a,i=this,r=t.length-1;0<=r;r--)(o=t[r]).collapse&&i.setCollapsed(o.head,!1),i.ungroupRange(o.start,o.count);for(r=t.length-1;0<=r;r--)o=t[r],a=v.hD(n,o.head)+e,1===i.direction()?i.group(a-o.count,o.count):i.group(a+1,o.count),o.collapse&&i.setCollapsed(a,o.collapse)},s.prototype.dB=function(t,n,e){var i,r,o,a,e,u,s,c,f,l,h,d,i=this,r=i.items;if(1===e)for(o=i.getMaxLevel(),a=n.level+1;a<=o;a++)t.splice.apply(t,w([0,0],i.ipt(n.start,n.count,a),!1));else 2===e&&t.push.apply(t,i.ipt(n.start,n.count,n.level));for(u=t[(e=t.length)-1].concat([]),s=[],a=e-2;0<=a;a--)f=(c=r[t[a][0]]).groupInfo,1===i.direction()?(l=f.end+1,h=v.hD(u,l),u.splice.apply(u,w([h,0],t[a],!1)),s.push({head:l,start:f.start,count:l-f.start,collapse:c.viewCollapsed})):(l=f.start-1,h=v.hD(u,l),u.splice.apply(u,w([h+1,0],t[a],!1)),s.push({head:l,start:f.start,count:f.end-l,collapse:c.viewCollapsed}));for(d=!1,a=0;a<n.count;a++)if(u[a]!==a+n.start){d=!0;break}return{array:u,isChanged:d,groupSwap:s}},s.prototype.isGroupEnd=function(t,n){var e,i,r,e,e,i,r,o,t,e=this,i=e.items,r=t+1;return!a(e,r)||!(e=i[r])||(r=!1,(e=e.level)<(i=i[t].level)&&0<=(t=i-n)&&t<(o=i-e))||r},s.prototype.hitTest=function(t,n,e){return mt.call(t,n,e)},s.prototype.getBtnRectangle=function(){var t,n,e,i,r,o,a,t,u,i,e,s,c,f,r,l,h,d,v,t,t=this.Mf,n=this.v2t,e=t.Fi(),i=t.options,r=i.sheetAreaOffset,o=n?e.qC:e.XC,a=t.gj(),t=n?a.rowMaxLevel:a.colMaxLevel,u=n?a.width:a.height,i=n?i.colHeaderVisible:i.rowHeaderVisible,e=n?e.LA-r.top:e.BA-r.left,s=2,c=t+2,f=U(0,(u-4)/c),r=o-f,l=[];if(f&&i&&0<=r)for(h=U(0,e+r/2),d=2,n&&(t=h,h=d,d=t),v=0;v<c;v++)l.push({x:a.x+h,y:a.y+d,width:f,height:f}),n?h+=f:d+=f;return l},s.prototype._e=function(t,n,e,i){var r,o,a,u,s,u,o,c,s,f,l,h;if(!this.Oy()&&(r=t.gj(),o=t.Fi(),a=t.Jt,u=r.width,s=r.height,u||s)){if(u=i?u:o.width,o=i?o.height:s,c=i?r.rowMaxLevel:r.colMaxLevel,s=i?a.kl:a._l,n.save(),n.beginPath(),!e||e.intersect(r.x,r.y,u,o))for(h=l=void 0,(f=new it(t,i,c)).D2t(n),l=s.call(t.Jt,function(){return pt(t,i,c)}),h=0;h<=2;h++)l[h].F2t(n);n.beginPath(),n.restore()}},s.prototype.rpt=function(t,n){var e;n&&((e=n.what)===d||e===K?lt(t,n):e!==m&&e!==X||ht(t,n))},s.prototype.Oy=function(){return this.x2t},s.prototype.Ry=function(){var t=parseInt(V(W).borderTopWidth,10);return isNaN(t)?2:t},s.prototype.fromJSON=function(t,n){var n,e,i,r,n,o,a,t,u,s,c,f,l,h,d,n=n&&n.ignoreStyle;if(t&&!n){if(i=(e=this).items,r=t.items,n=t.itemsData,o=t.direction,a=t.head,t=t.tail,f=[],k(o)||e.direction(o),a&&(e.head=a),t&&(e.tail=t),l=!1,r&&0<r.length)for(d=0;d<r.length;d++)k(r[d])||(h=new E(r[d]),e.direction()===ot.forward&&(l=!!h.viewCollapsed||l&&!(h.collapsed=!0)),i[d]=h,e.x2t=!1);else N(n,function(t,n){if(u=n.index,s=n.info,0<=u&&s){for(c=0;c<n.count&&!(u+c>=Y(i));c++)n.info.collapsed&&f.push(n),i[u+c]=new E(s);e.x2t=!1}});for(O(e,!0),d=0;d<f.length;d++)e.K2t(f[d].index,!0)}},s.prototype.toJSON=function(t){var t,t,n,e,i,r,o,a,u,t,s,t=t&&t.ignoreStyle;if(!t){for(n=[],e=(t=this).items,r=-1,o=[],i=0;i<Y(e);i++)a=n[r],(u=e[i])&&(o[i]={level:u.level,collapsed:u.collapsed,viewCollapsed:u.viewCollapsed},0<=r&&i===a.count+a.index&&u.level===a.info.level&&u.collapsed===a.info.collapsed?n[r].count++:n[++r]={index:i,count:1,info:{level:u.level,collapsed:u.collapsed}});return t={items:o,itemsData:n,direction:t.direction(),head:t.head,tail:t.tail},s={},N(t,function(t,n){At(t,n)||(s[t]=n)}),c.isEmptyObject(s)?y:s}},i=s,(f.Outline=i).prototype.direction=T("direction",1),e.Outline=i,c.extend(x.Y8.prototype,{m2t:function(t,n){var e,i,e=this,i=e.G8;i&&(i.originalOutlines||(i.originalOutlines=[]),!t||!n&&i.originalOutlines[0]?t||!n&&i.originalOutlines[1]||(i.originalOutlines[n?3:1]=Et(e.opt)):i.originalOutlines[n?2:0]=Et(e.apt))},upt:function(t,n,e){var i,n,i=this;void 0!==n&&(this.Mf.outlineColumn.NB=n),t&&((n=t[e?2:0])&&jt(i.apt,n),n=t[e?3:1])&&jt(i.opt,n)}}),x.Y8.ch(P,{init:function(){var t=this,n=t.Mf;t.opt=new i(t.getColumnCount(),n,!1),t.apt=new i(t.getRowCount(),n,!0)},applyChanges:function(t){var n,e,t,i,n,e=t.changes,t=t.isUndo,i=e&&e.originalOutlines;(i||e.oldOptions)&&this.upt(i,e.oldOptions,!t)},undo:function(t){var n=t.originalOutlines;(n||t.oldOptions)&&(this.upt(n,t.oldOptions),this.Mf.zw())},dispose:function(t){var n=this,e;!1!==(t&&t.clearCache)&&(n.opt&&(n.opt.L0(),n.opt=I),n.apt)&&(n.apt.L0(),n.apt=I)}}),x.Worksheet.ch(P,at={init:function(){var r=this;r.rowOutlines=r.Ut.apt,r.columnOutlines=r.Ut.opt,r.rowOutlines.groupChangeHandler=function(t){var t,n,n,e,i,n,t=t&&t.indexes;t&&r.recalcRows&&(n=r.getCalcService())&&!n.IsSuspended()&&r.recalcRows(t),(n=r.parent)&&r!==n.getActiveSheet()||r.iP(),n=t?(e=t[0],i=t[t.length-1],!0):(e=0,i=r.getRowCount()-1,!1),x.Worksheet.et(r,"onGroupChanged",{start:e,end:i,isRow:!0,fromSetCollapsed:n})},r.columnOutlines.groupChangeHandler=function(t){var n,n,e,i,t,n=r.parent;n&&r!==n.getActiveSheet()||r.rP(),t=(n=t&&t.indexes)?(e=n[0],i=n[n.length-1],!0):(e=0,i=r.getColumnCount()-1,!1),x.Worksheet.et(r,"onGroupChanged",{start:e,end:i,isRow:!1,fromSetCollapsed:t})},r.$L.push(r.rowOutlines),r.nF.push(r.columnOutlines)},dispose:function(t){var n=this;!1!==t.clearCache&&(n.rowOutlines&&(n.rowOutlines.groupChangeHandler=I),n.columnOutlines)&&(n.columnOutlines.groupChangeHandler=I),c(n.Dg()).unbind("mousedown.group")},setHost:function(t){var e;t&&(e=this,t.bind("mousedown.group",function(t){var n,t,n,n=e.uw(),t=mt.call(e,t.pageX-n.left,t.pageY-n.top);t&&((n=t.what)===m||n===d?e.rowOutlines.rpt(e,t):n!==X&&n!==K||e.columnOutlines.rpt(e,t))}))},preProcessMouseDbClick:function(t){var n=this;k(n.sw)||k(n.sw.outlineHitInfo)||(t.r=!0)},onPaintSuspend:function(t){var n=this;t.suspend?(n.rowOutlines.Xst(),n.columnOutlines.Xst()):(n.rowOutlines.$st(),n.columnOutlines.$st())},beforeLayoutChanged:function(t){var n,e;"invalidateLayout"===t.changeType&&(this.k2t=I)},onLayoutChanged:function(t){var n,e,i,r,o,a,t,u,s,c,f,n=this,e=t.changeType,i=t.row,r=t.rowCount,o=t.col,a=t.colCount,t=t.sheetArea,u=n.rowOutlines,s=n.columnOutlines,c=k(t)||3===t,f=this.Ut;"addRows"===e&&c?(f.m2t(!0),Mt(u,i,r),f.m2t(!0,!0)):"deleteRows"===e&&c?(f.m2t(!0),Ct(u,i,r),f.m2t(!0,!0)):"addColumns"===e&&c?(f.m2t(!1),Mt(s,o,a),f.m2t(!1,!0)):"deleteColumns"===e&&c?(f.m2t(!1),Ct(s,o,a),f.m2t(!1,!0)):"invalidateLayout"===e?n.k2t=I:"setColumnCount"===e?(f.m2t(!1),3!==t&&1!==t||s.X2t(a),f.m2t(!1,!0)):"setRowCount"!==e||3!==t&&2!==t||(f.m2t(!0),u.X2t(r),f.m2t(!0,!0))},paint:function(t){var n,t,e,i,r,n=t.ctx,t=t.clipRect,e=this,i=e.rowOutlines,r=e.columnOutlines;i&&i._e(e,n,t,!0),r&&r._e(e,n,t,!1)},fromJson:function(t,n,e){var i,r,o,a,o,a;t&&(i=this,r=void 0,o=t.showRowRangeGroup,a=t.showColumnRangeGroup,o=u(o)?o:t.showRowOutline,a=u(a)?a:t.showColumnOutline,k(o)||i.showRowOutline(o),k(a)||i.showColumnOutline(a),(r=t.rowRangeGroup||t.rowOutlines)&&i.rowOutlines.fromJSON(r,e),r=t.colRangeGroup||t.columnOutlines)&&i.columnOutlines.fromJSON(r,e)},toJson:function(t,n){var e,i,r,o,o,e=this,i=e.rowOutlines,r=e.columnOutlines,o=e.showRowOutline();!0!==o&&(t.showRowOutline=o),!0!==(o=e.showColumnOutline())&&(t.showColumnOutline=o),t.rowOutlines=i?i.toJSON(n):y,t.columnOutlines=r?r.toJSON(n):y},wh:function(t,n,e){var e,e,i,r,o,o,e,o,e,o,a,u,a,s,c,f,l,h,d,v,m,g,p,b,e=e&&!1===e.includeStyles;if(!e){for(i=(e=this).rowOutlines,r=e.columnOutlines,!0!==(o=e.showRowOutline())&&(t.lossless.showRowOutline=o),!0!==(o=e.showColumnOutline())&&(t.lossless.showColumnOutline=o),0!==i.direction()&&0!==r.direction()||((e=D(t,q))||t.c_.push(e={n_:q,c_:[]}),e.c_.push(o={n_:"outlinePr"}),0===i.direction()&&(o.summaryBelow="0"),0===r.direction()&&(o.summaryRight="0")),e=D(t,x.XFileConstants._u),o=i.getMaxLevel(),a=-1!==(a=r.getMaxLevel())?a+1:y,e.outlineLevelRow=u=-1!==o?o+1:y,e.outlineLevelCol=a,s=t.tempCols,c=r.items,f=e.defaultColWidth,l=0;l<c.length;l++)(h=c[l])&&(d=h.viewCollapsed,"1"!==(v=s[l]||{width:f,hidden:y,collapsed:y,outlineLevel:y}).hidden&&!d||(v.hidden="1"),!0===h.collapsed&&(v.collapsed="1"),-1!==h.level&&(v.outlineLevel=h.level+1),s[l]=v);for(m=D(t,$),g=i.items,l=0;l<g.length;l++)(p=g[l])&&(d=p.viewCollapsed,(b=m[l]||{}).v===y&&!1===d&&(b.v=0),b.f=!0===p.collapsed?1:0,b.l=p.level+1,m[l]=b)}},yh:function(t,n,e){var e,e,i,e,r,u,i,i,i,s,c,o,a,f,l,h,d,v,m,g,p,b,y,w,M,C,C,y,y,S,T,A,I,e=e&&!1===e.includeStyles;if(!e&&(t.lossless&&(e=t.lossless.showRowOutline,i=t.lossless.showColumnOutline,k(e)||this.showRowOutline(e),k(i)||this.showColumnOutline(i)),r=(e=this).rowOutlines,u=e.columnOutlines,(i=L(t,q+"&outlinePr"))&&("0"===i.summaryBelow&&r.direction(0),"0"===i.summaryRight)&&u.direction(0),(i=(i=D(t,x.XFileConstants.Eu))&&i.c_)&&0<i.length&&(s=u.items,c=e.getColumnCount(),i.forEach(function(t){var n,e,i,r,o,a;if((0<t.outlineLevel||!k(t.collapsed))&&(u.x2t=!1,n=t.min-1,e=t.max-1,i=+t.outlineLevel||0,r=et(t.hidden,!1),o=et(t.collapsed,!1),0<=n)&&0<=e)for(e===x.MAX_COLUMN_COUNT-1&&(e=Math.max(c,n)),a=n;a<=e;a++)s[a]=new E({level:i-1,collapsed:o,viewCollapsed:r}),c<a+2&&!(i<=0&&(!s[a-1]||s[a-1]&&s[a-1].level<0))&&(c=a+2)}),c>e.getColumnCount())&&e.setColumnCount(c),o=D(t,$))){for(a=e.Ut.Q_(!0),l=[],h=r.items,d=(f={rowItems:[],itemsData:[]}).rowItems,v=f.itemsData,m=o.rowCount,g=0===r.direction(),p=e.getRowCount(),b=0;b<m;b++)(y=o[b])?(w=!!y.f,(0<(M=+y.l||0)||w)&&(d[b]={level:M-1,collapsed:w},(C=v[v.length-1])&&b===C.index+C.count&&C.info.level===M-1&&C.info.collapsed===w?C.count++:v.push({index:b,count:1,info:{level:M-1,collapsed:w}})),C=!!y.v,y=l[b-1]&&l[b-1].hidden,v&&Rt(f,b,M,g,C,y),((y={}).hidden=C)&&0===M&&(y.visible=!1),l.push(y),p<+b+2&&(0<M||w)&&(p=+b+2)):l.push({});if(Ot(f,o,l,r.direction(),a),S=!1,T=void 0,A=[],d&&0<d.length)for(I=0;I<d.length;I++)k(d[I])||(T=new E(d[I]),r.direction()===ot.forward&&(S=!!T.viewCollapsed||S&&!(T.collapsed=!0)),h[I]=T,r.x2t=!1);for(O(r,!0),I=0;I<A.length;I++)r.K2t(A[I].index,!0);for(p>e.getRowCount()&&e.setRowCount(p),I=0;I<l.length;I++)!1===l[I].visible&&a.R8.push(I)}}}),x.Workbook.ch(P,ut={init:function(){M.Commands.g2t(this.commandManager())},onCultureChanged:function(){(0,f.getSR)()}})},"./dist/plugins/group/group.ns.js":function(t,n,e){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.SR=void 0;var e=e("./dist/plugins/group/group.res.en.js");n.SR={en:e}},"./dist/plugins/group/group.res.en.js":function(t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.Exp_GROUP_PROTECTED=n.Exp_GroupInfoIsNull=n.Exp_InvalidLevel=n.Exp_InvalidCount=n.Exp_InvalidIndex=void 0,n.Exp_InvalidIndex="Invalid index",n.Exp_InvalidCount="Invalid count",n.Exp_InvalidLevel="Invalid level",n.Exp_GroupInfoIsNull="groupInfo is null",n.Exp_GROUP_PROTECTED="You can not use this command on a protected sheet. To use this command, you must first unprotect sheet."},"./dist/plugins/hyperlink/hyperlink.js":function(B,t,n){"use strict";var e,w,f,l,o,i,M,a,n,r,C,u,h,L,d,s,c,S,F,v,m,g,P,G,U,H,z,V,Y,Z,W,Q,J,p,K,X,b,y,T,A,I,x,q,N,k,$,tt,nt,et,it,rt,ot,D,t,at,ut;function _(t,n){return at.call(this,t,n)||this}function E(t,n){return ut.call(this,t,n)||this}function j(t,n,e,i){return C(i)&&(i=3),!C(t.getHyperlink(n,e,i))}function st(){var t=i(X);return a(t).css(g,P).css(G,0).css(V,2).css(Y,"1px #c0c0c0 solid").css("box-shadow","1px 2px 5px rgba(0,0,0,0.4)").css(Z,J).css(Q,K).css(U,"9pt Arial"),t}function ct(t,n,e){var i,r,o,i,r,o,e;e&&(r=(i=t&&t.qc()).getElementsByClassName(b)[0],o=!1,C(r)&&((r=st()).className=b,i.insertBefore(r,s),o=!0),i=a(r),!o&&i.isVisible()||(i.text(e),o=(r=t.rt.it()).left+n.x,e=r.top+n.y+20,i.css(z,e).css(H,o),i.show()))}function O(t){var n,t,n,t=(t&&t.qc()).getElementsByClassName(b)[0];C(t)||a(t).hide()}function ft(t,n){C(n)||(n.drawUnderline&&(C(t.textDecoration)?t.textDecoration=1:0!==t.textDecoration&&1!=(1&t.textDecoration)&&(t.textDecoration+=1)),n.isVisited?n.visitedLinkColor===s?t.foreColor="rgba(0,0,0,0)":n.visitedLinkColor===d?t.foreColor=T:t.foreColor=n.visitedLinkColor:C(n.linkColor)?n.linkColor===d&&t.foreColor||(t.foreColor=y):t.foreColor=n.linkColor)}function R(t){if(t&&t.cellType){var t=t.cellType.typeName;if(!ot[t])return 1}}function lt(t,n,e,i,r,o,a){var u,s,c,t,a,u=0,s=0,c=t.width,t=t.height,a=ht(a);return a&&(c-=a),u=o=o||0,1===i?u=(c-n)/2:2===i&&(u=c-n-o),1===r?s=(t-e)/2:2===r&&(s=t-e),a&&(u+=a),{x:u,y:s}}function ht(t){var n={context:t,value:0};return r.et(t.sheet,"getOutlineColumnOffset",n),n.value}function dt(t,n){var e,i,r,e=o(n),i,r;return{x:0,y:0,width:c(0,w.q.Wt(t,n,!0)),height:t.split(/\r\n|\r|\n/).length*e}}function vt(t,n,e,i,r,o,a){var t,i,t=dt(t,i),i=lt(r,t.width,t.height,n,e,o,a);return t.x=i.x,t.y=i.y,t}function mt(t,n,e,i,r,o){var a,u,s,c,f,l,h,d,a,v,m,g,p,b,y,a=r.sheet,u=a.Dn;if(!C(e)){if(e.textOrientation)return!0;if(s=a.getValue(r.row,r.col,r.sheetArea),o=o||a.getText(r.row,r.col,r.sheetArea))for(o=o.replace(/\s+/g," "),c=e&&e.font?e.font:u.Nn(),c=u._n(c),f=[o],l=gt(e),e.wordWrap&&(o=(f=w.q.un(o,i.width-3-l,c)).join("\r\n")),h=e.hAlign,d=e.vAlign,a=vt(o,h=3===h?M(h,s,e.formatter||e._autoFormatter):h,d,c,i,l,r),v=i.y+a.y,m=0;m<f.length;m++)if(g=vt(f[m],h,d,c,i,l,r),p=i.x+g.x,b=S(p+g.width,i.x+i.width),v=S((y=v)+g.height,i.y+i.height),p<=t&&t<b&&y<=n&&n<v)return!0}return!1}function gt(t){return 8*(t.textIndent||0)}e=this&&this.__extends||(D=function(t,n){return(D=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(t,n){t.__proto__=n}:function(t,n){for(var e in n)Object.prototype.hasOwnProperty.call(n,e)&&(t[e]=n[e])}))(t,n)},function(t,n){if("function"!=typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function e(){this.constructor=t}D(t,n),t.prototype=null===n?Object.create(n):(e.prototype=n.prototype,new e)}),Object.defineProperty(t,"__esModule",{value:!0}),t.HyperlinkTargetType=void 0,w=n("Core"),f=n("Common"),l=n("SheetsCalc"),o=w.mt.vt,i=w.mt.En,M=w.mt.gt,a=w.GC$,n=w.Commands.ActionBase,r=w.CellTypes.Base,C=f.Common.lt.ht,u=f.Common.lt.tv,h=f.Common.zf.TY,L=f.Common.ft,d=void 0,s=null,c=Math.max,S=Math.min,F=Math.floor,v=window.open,m=f.Common.zf.fJ,g="position",P="absolute",G="margin",U="font",H="left",z="top",V="padding",Y="border",Z="box-sizing",W="pointer",Q="background-color",J="content-box",p="default",K="white",X="div",b="gc-spread-hyperlink-tooltip",T="followedHyperlink",A=y="hyperlink",I="openUrl",x="generateHyperlink",q=/^sjs:\/\/\w+[\!]\w+([\:]\w+)?/,N=/^(mailto:\/\/)?([a-z0-9_\-\.\!\#$%&'*\+/=?^`{|}~])+\@([a-z0-9\-])+\.([a-z0-9\-]){2,63}(\?subject=.+)?$/gi,k=/(((ht|f)tp(s?)):\/\/(?:www\.|(?!www))[a-z0-9][a-z0-9-]+[a-z0-9]\.[^\s]{2,}|www\.[a-z0-9][a-z0-9-]+[a-z0-9]\.[^\s]{2,}|((ht|f)tp(s?)):\/\/(?:www\.|(?!www))[a-z0-9]+\.[^\s]{2,}|www\.[a-z0-9]+\.[^\s]{2,})/gi,(t=$=t.HyperlinkTargetType||(t.HyperlinkTargetType={}))[t.blank=0]="blank",t[t.self=1]="self",t[t.parent=2]="parent",t[t.top=3]="top",w.GC$.extend(w.Y8.prototype,{getHyperlink:function(t,n,e){var i,e;return C(e)&&(e=3),(e=(i=this).W_(e).J_(t,n))&&!C(e.hyperlink)?e.hyperlink:s},setHyperlink:function(t,n,e,i){var r,o,a,u,u,s,o,c,r=this;if(C(i)&&(i=3),(o=e&&e.url)&&o.match(k)&&0<o.match(k).length?m(o,a="www.")&&(e.url="http://"+o):o&&o.match(N)&&0<o.match(N).length&&(m(o,u="mailto:")||(e.url=u+o)),u=0<r.P8?[["sheetModels",i],d]:d,s=r.W_(i).J_(t,n,!0,u?u[0]:d),C(s))u&&(u.length=0);else{if(o=s.hyperlink,C(e))s.hyperlink=null,delete s.hyperlink;else for(c in s.hyperlink={url:"",linkColor:d,visitedLinkColor:d,tooltip:"",target:0,drawUnderline:!0,isVisited:!1,command:""},s.hyperlink)e[c]!==d&&(s.hyperlink[c]=e[c]);u&&(u[0].push("hyperlink"),u[1]=o,u[2]=s.hyperlink)}u&&0<u.length&&r.G8.push(u)}}),w.GC$.extend(w.Worksheet.prototype,{getHyperlink:function(t,n,e){var i,r;return 0===e?s:(C(e)&&(e=3),r=(i=this).Ut,u(r.getHyperlink(t,n,e)))},setHyperlink:function(t,n,e,i){var r,o,a,u;0===i||(C(i)&&(i=3),a=(o=(r=this).Ut).getRowCount(i),u=o.getColumnCount(i),t<0)||a<=t||n<0||u<=n||(o.do("setHyperlink",t,n,e,i),this.zw())}}),e(_,at=n),_.prototype.execute=function(){var t,n,e,i,r,o,t,a,a,a,u,a,u,s,s,s,s,c,r,t=this,n=t.Mf,e=!1,i=n.parent,r=n,o=t.tT.url;if(!C(o))if(t=t.tT.target||0,0===o.indexOf(a="sjs://")||"#"===o[0]){if(a=a.length,a="#"===o[0]?o.substr(1):o.substr(a),(u=(u=(0,l.formulaToRanges)(n,a,0,0,!(u=void 0)))&&0===u.length?(0,l.formulaToRanges)(n,a,0,0,!1,!0):u)&&0<u.length){if(a=u[0].sheetName,u=u[0].ranges[0],a!==n.name()&&i.getSheetFromName(a).visible()===w.SheetTabVisible.visible){if(s=i.getSheetFromName(a),i.ki(w.Events.ActiveSheetChanging,s={oldSheet:r,newSheet:s,cancel:!1}),s.cancel)return;i.setActiveSheet(a),s=i.getActiveSheetIndex(),i.w2.Tg(s),r!==(n=i.getActiveSheet())&&i.ki(w.Events.ActiveSheetChanged,{oldSheet:r,newSheet:n})}i.getSheetFromName(a).visible()===w.SheetTabVisible.visible&&(n.OA(u.row+u.rowCount,u.col+u.colCount),n.setSelection(u.row,u.col,u.rowCount,u.colCount))}}else C(o)||(s="mailto:",o.match(k)&&0<o.match(k).length?m(o,c="www.")&&(o="http://"+o):o.match(N)&&0<o.match(N).length&&(m(o,s)||(o=s+o)),m(o,s)&&1<f.Common.zf.DU(o,"?")&&(o=(r=o.split("?"))[0]+"?"+r.slice(1).join("%3F")),v(h(o),["_blank","_self","_parent","_top"][t]));return!1},tt=_,w.Commands[I]={canUndo:!1,execute:function(t,n,e){return w.Commands.zA(t,tt,n,e)}},e(E,ut=n),E.prototype.execute=function(){var t,n,e,i,r,o,e,a,u,u,t=this,n=t.Mf,e=t.tT,i=e.url,r=e.row,o=e.col,e=e.sheetArea;if(null===i)a=null;else{if("string"!=typeof i)return!1;if(!((u=(!(u=i.match(k))||u.length<1)&&(!(u=i.match(N))||u.length<1)?i.match(q):u)&&0<u.length&&0===i.indexOf(u[0])&&i.length===u[0].length))return!1;a={url:i,linkColor:y,visitedLinkColor:T}}return n.Ut.startTransaction(),n.suspendPaint(),n.suspendEvent(),n.setHyperlink(r,o,a,e),n.resumeEvent(),n.resumePaint(),u=w.Commands.TI(n.name()),t.tT[u]=n.Ut.endTransaction(),!0},E.prototype.undo=function(){var t,n,e,t,n=this.Mf;return n.suspendPaint(),n.suspendEvent(),e=w.Commands.TI(n.name()),n.Ut.undo(this.tT[e]),n.resumeEvent(),n.resumePaint(),!0},nt=E,w.Commands[x]={canUndo:!0,execute:function(t,n,e){return w.Commands.zA(t,nt,n,e)}},w.Workbook.ch(A,et={init:function(){this.commandManager().register(I,w.Commands[I]),this.commandManager().register(x,w.Commands[x])}}),w.Worksheet.ch(A,it={setHyperlinkWhenEditing:function(t){var n,e,i,t,r,o,n=t.url,e=t.row,i=t.col,t=t.sheetArea,r=this,o=r.getParent();o.options.allowAutoCreateHyperlink&&o.commandManager().execute({cmd:x,sheetName:r.name(),url:n,row:e,col:i,sheetArea:t})}}),r.ch(A,rt={applyHyperlinkStyle:function(t){var n,e,i,r,n,n=t.sheet,e=t.row,i=t.col,r=t.style,n=n.getHyperlink(e,i,t.sheetArea);R(r)||ft(r,n)},getCellTextHitInfo:function(t){var n,e,i,r,o,a,u,s,c,f,l,f,n=t.context.sheetArea,e=t.cellStyle,i=t.context,r=i.sheet,o=i.row,a=i.col;j(r,o,a,n)&&!R(e)&&((u=t.cellRect)&&(s=r.C0(o),c=r.S0(a),f=r.Fi(),l=void 0,r.getSpan(o,a,n)||!C(n)&&3!==n?2===n?l=f.B1(s):1===n&&(l=f.L1(c)):l=f.c9(s,c),l)&&(u=u.getIntersectRect(l)),!C(n)||3===n)&&e&&u&&(f=r.getText(o,a,n),t.paddingHitInfo={row:o,col:a,x:t.x,y:t.y,sheetArea:n,sheet:r,isFocusAware:!0,isReservedLocation:mt(t.x,t.y,e,u,i,f)})},processMouseUpOnCellPadding:function(t){var n,e,i,r,o,e,t,e,t,e,n=t.sheet,e=t.cellStyle,i=t.row,r=t.col,o=t.sheetArea;n&&!n.isEditing()&&j(n,i,r,o)&&!R(e)&&t.isReservedLocation&&(e=n.Dg(),O(n),e&&(e.style.cursor=p),(t=n.Ut.getHyperlink(i,r,o)).isVisited=!0,e=t.command,C(e)||""===e||e===I?n.getParent().commandManager().execute({cmd:I,sheetName:n.name(),url:t.url,target:t.target}):"string"==typeof e?n.getParent().commandManager().execute({cmd:e,row:i,col:r,sheetName:n.name(),sheetArea:o}):"function"==typeof e&&e.call(s,n,i,r,o),t=n.getColumnCount(),e=new w.Range(i,-1,1,t),n.repaint(n.getRangeRect(1,1,e)))},processMouseMoveOnCellPadding:function(t){var n,e,i,r,o,r,n,n=t.row,e=t.col,i=t.sheet,r=t.cellStyle,o=t.sheetArea;!j(i,n,e,o)||R(r)||!i||i.isEditing()&&i.getActiveRowIndex()===n&&i.getActiveColumnIndex()===e||(r=i.Dg(),n=i.getHyperlink(n,e,o),t.isReservedLocation?r&&(ct(i,t,n.tooltip),r.style.cursor=W):(O(i),r&&(r.style.cursor=p)))},processMouseLeaveOnCellPadding:function(t){var n,e,i,t,e,n=t.sheet,e=t.row,i=t.col,t=t.sheetArea;O(n),j(n,e,i,t)&&n&&(e=n.Dg())&&(e.style.cursor=p)},onUpdateContainer:function(t){var n,e,i,t,n=t.cellStyle,e=t.context.row,i=t.context.col,t=t.context.sheet.getHyperlink(e,i);R(n)||ft(n,t)}}),ot={0:!0,1:!0,2:!0,3:!0,4:!0}},"./dist/plugins/inputMask/inputMask.entry.js":function(t,n,e){"use strict";var i,r,r,i=this&&this.__createBinding||(Object.create?function(t,n,e,i){void 0===i&&(i=e);var r=Object.getOwnPropertyDescriptor(n,e);r&&("get"in r?n.__esModule:!r.writable&&!r.configurable)||(r={enumerable:!0,get:function(){return n[e]}}),Object.defineProperty(t,i,r)}:function(t,n,e,i){t[i=void 0===i?e:i]=n[e]}),r=this&&this.__exportStar||function(t,n){for(var e in t)"default"===e||Object.prototype.hasOwnProperty.call(n,e)||i(n,t,e)};Object.defineProperty(n,"__esModule",{value:!0}),n.getNamedPatterns=n.namedPattern=n.validatePattern=n.IMCD=void 0,r(e("./dist/plugins/inputMask/integrate.js"),n),r=e("./dist/plugins/inputMask/inputMask/inputMask.js"),n.IMCD=r.InputMask,n.validatePattern=r.InputMask.validatePattern,n.namedPattern=r.InputMask.namedPattern,n.getNamedPatterns=r.InputMask.getNamedPatterns},"./dist/plugins/inputMask/inputMask/common.js":function(t,n){"use strict";var o,e,i;function r(t){if("string"==typeof t){if("true"===t.toLowerCase())return!0;if("false"===t.toLowerCase())return!1}return!0===t}function a(t,n,e){var i,r;if(!(e>=t.length))for(i=e;i<t.length;i++)for(r=0;r<n.length;r++)if(t.charAt(i)===n[r])return i;return-1}function u(t,n,e,i){if(n<=0)return"";var r=String(t);if(e!==o)for(;r.length<n;)i?r+=e:r=e+r;else for(;r.length<n;)r+=String(t);return r}function s(t){return t%400==0||t%4==0&&t%100!=0}function c(t,n){if(12<n)t+=parseInt((n/12).toString(),10),n%=12;else if(n<0)return 31;switch(n){case 2:return s(t)||t<0?29:28;case 4:case 6:case 9:case 11:return 30}return 31}function f(){this.OtherChar=0,this.Control=1,this.Numeric=2,this.MathSymbol=3,this.Symbol=4,this.Punctuation=5,this.Space=6,this.UpperCase=7,this.LowerCase=8}function l(){this.Ctype=new e}Object.defineProperty(n,"__esModule",{value:!0}),n.CharProcess=n.CharType=n.daysInMonth=n.fillString=n.indexOfAny=n.checkBool=n.markers=void 0,o=void 0,n.markers={group:["(",")"],groupSeparator:"|",quantifier:["{","}"],quantifierSeparator:",",optional:["[","]"],letter:"a",number:"0",upper:">",lower:"<",escape:String.fromCharCode(92),any:"#",year:"y",month:"M",day:"d",hour:"h",hourIn24:"H",minute:"m",second:"s",range:"-",hourFormat:"t"},n.checkBool=r,n.indexOfAny=a,n.fillString=u,n.daysInMonth=c,e=f,n.CharType=e,l.prototype.getCharType=function(t){var n,e,n=this,e=n.Ctype.OtherChar;return"A"<=t&&t<="Z"?n.Ctype.UpperCase:"a"<=t&&t<="z"?n.Ctype.LowerCase:"0"<=t&&t<="9"?n.Ctype.Numeric:(8216!==t.charCodeAt(0)&&8217!==t.charCodeAt(0)&&8220!==t.charCodeAt(0)&&8221!==t.charCodeAt(0)||(e=n.Ctype.Punctuation),12288===t.charCodeAt(0)?n.Ctype.Space:e)},l.prototype.isLower=function(t){return this.getCharType(t)===this.Ctype.LowerCase},l.prototype.isUpper=function(t){return this.getCharType(t)===this.Ctype.UpperCase},l.prototype.isAlphabet=function(t){return this.isUpper(t)||this.isLower(t)},l.CharEx=new l,n.CharProcess=l},"./dist/plugins/inputMask/inputMask/inputMask.js":function(t,n,e){"use strict";var x,M,C,i,e,e,S,N,e,o,r,a,u,s;function c(t){for(var n,e,i,n=0,e=t.length;n<e;n++)("\\"===(i=t[n])&&"\\"!==t[n+1]||0<=a.indexOf(i)&&"\\"!==t[n-1])&&(t=t.substring(0,n)+"\\"+t.substring(n,e),n++);return t}function f(t){return t===M.markers.letter||t===M.markers.number||t===M.markers.upper||t===M.markers.lower||t===M.markers.group[0]||t===M.markers.optional[0]||t===M.markers.escape||t===M.markers.any||t===M.markers.quantifier[0]||t===M.markers.range||t===M.markers.year||t===M.markers.month||t===M.markers.day||t===M.markers.hourIn24||t===M.markers.hour||t===M.markers.minute||t===M.markers.second||t===M.markers.hourFormat}function T(t,n){for(var e,i,r,o,a,u,s,c,e={result:!1},i=1,r="",o=n.Ose(),a=new C.OptionalRestriction(o);i<t.length-1;){if((u=t[i])===M.markers.escape){if(u=t.charAt(i+1),t[i+2]===M.markers.range&&(!f(t[i+3])||t[i+3]===M.markers.escape)){t[i+3]===M.markers.escape?(s=t[i+4]>u?u:t[i+4],c=t[i+4]>u?t[i+4]:u,a.add(new C.RangeRestriction(s,c,o)),i+=5):(s=t[i+3]>u?u:t[i+3],c=t[i+3]>u?t[i+3]:u,a.add(new C.RangeRestriction(s,c,o)),i+=4);continue}i++,-1===r.indexOf(u)&&(r+=u)}else if(u===M.markers.letter)a.add(new C.RangeRestriction("A","Z",o)),a.add(new C.RangeRestriction("a","z",o));else if(u===M.markers.upper)a.add(new C.RangeRestriction("A","Z",o,x.CaseType.upperCase)),a.add(new C.RangeRestriction("a","z",o,x.CaseType.upperCase));else if(u===M.markers.lower)a.add(new C.RangeRestriction("A","Z",o,x.CaseType.lowerCase)),a.add(new C.RangeRestriction("a","z",o,x.CaseType.lowerCase));else if(u===M.markers.number)a.add(new C.RangeRestriction("0","9",o));else{if(t.length>i+2&&t[i+1]===M.markers.range&&(!f(t[i+2])||t[i+2]===M.markers.escape)){t[i+2]===M.markers.escape?(s=t[i+3]>u?u:t[i+3],c=t[i+3]>u?t[i+3]:u,a.add(new C.RangeRestriction(s,c,o)),i+=4):(s=t[i+2]>u?u:t[i+2],c=t[i+2]>u?t[i+2]:u,a.add(new C.RangeRestriction(s,c,o)),i+=3);continue}if(-1!==r.indexOf(u)){i++;continue}r+=u}i++}return 0<r.length&&a.add(new C.LimitedRestriction(o,r)),e.result=!0,e.restriction=a,e}function A(t,n){var e,i,r,o,a;for(t=t.substring(1,t.length-1),i=e=0;e<t.length;)if(-1===(a=(0,M.indexOfAny)(t,[M.markers.groupSeparator,M.markers.group[1],M.markers.escape,M.markers.group[0]],e))){if(0===(r=t.substring(i)).length)return;n.push(r),e=t.length}else if(t.charAt(a)===M.markers.escape){if((o=t.charAt(a+1))!==M.markers.escape&&o!==M.markers.group[0]&&o!==M.markers.groupSeparator&&o!==M.markers.group[1])return;if((e=a+1)===(t=t.substring(0,a)+t.substring(a+1)).length){if(0===(r=t.substring(i)).length)return;n.push(r)}}else{if(t.charAt(a)!==M.markers.groupSeparator)return;if(0===(r=t.substring(i,a)).length)return;n.push(r),i=e=a+1}return 1}function I(t){var n,e,i,r,o,a,n={min:-1,max:-1,result:!1},e=t.indexOf(M.markers.quantifierSeparator,1);if(-1===e)try{return n.min=+t.substring(1,t.length-1),n.max=n.min,n.result=0<n.max,n}catch(t){return n.result=!1,n}try{return i=t.substring(1,e),r=void 0,r=""===i.trim()?0:+i,n.min=r,o=t.substring(e+1,t.length-1),a=void 0,a=""===o.trim()?Math.pow(2,31):+o,n.max=a,n.result=!(n.min<0||n.max<n.min||0===n.max),n}catch(t){return n.result=!1,n}}function k(t,n){var e,i,r,o,a,u,e={keyLen:0};if(e.keyType=x.KeywordType.unknow,n>=t.length)return e;switch(i=t.charAt(n)){case M.markers.escape:return e.keyLen=2,e.keyType=x.KeywordType.promptChar,e.keyword=t.substring(n+1,n+2),e;case M.markers.any:return e.keyLen=1,e.keyType=x.KeywordType.any,e.keyword=t.substring(n,n+1),e;case M.markers.quantifier[0]:return-1===(r=t.indexOf(M.markers.quantifier[1],n+1))?e.keyword="":(e.keyType=x.KeywordType.quantifier,e.keyLen=r+1-n,e.keyword=t.substring(n,n+e.keyLen)),e;case M.markers.optional[0]:r=n,o=0;do{if(-1===(r=t.indexOf(M.markers.optional[1],r+1)))return e.keyword="",e;for(a=r-1;0<a&&t.charAt(a)===M.markers.escape;a--)o++}while(t.charAt(r-1)===M.markers.escape&&o%2!=0);return e.keyType=x.KeywordType.optional,e.keyLen=r+1-n,e.keyword=t.substring(n,n+e.keyLen),e;case M.markers.group[0]:r=n;do{if(-1===(r=t.indexOf(M.markers.group[1],r+1)))return e.keyword="",e}while(t.charAt(r-1)===M.markers.escape);return e.keyType=x.KeywordType.group,e.keyLen=r+1-n,e.keyword=t.substring(n,n+e.keyLen),e;case M.markers.letter:case M.markers.number:case M.markers.upper:case M.markers.lower:return e.keyLen=1,e.keyType=x.KeywordType.range,e.keyword=i,e;case M.markers.year:case M.markers.month:case M.markers.day:case M.markers.hour:case M.markers.hourIn24:case M.markers.minute:case M.markers.second:case M.markers.hourFormat:for(r=n+1;t.charAt(r)===i;)r++;return e.keyLen=r-n,e.keyType=x.KeywordType.date,e.keyword=t.substring(n,n+e.keyLen),e;default:for(r=n+1;r<t.length&&!f(u=t[r]);r++);return e.keyType=x.KeywordType.promptChar,e.keyLen=r-n,e.keyword=t.substring(n,n+e.keyLen),e}}function D(t,n){return!t[n.uit]&&(t[n.uit]=n,!t[x.RestrictionType.hour24]||!t[x.RestrictionType.hour])&&void 0}function l(t,n){var e=0,i=n.length;2===t.pce&&1===i&&(e=1),t.replace(e,t.length(),n)}function _(t,n,e,i,r,o,a){var u,s,c,f,l;if(o<i){for(c=++o,f=0;o<i;o++)t.Use[o].uit!==x.RestrictionType.prompt&&(e=t.Use[o].delete(e,t.Use[o]._text.length,a));for(l=0;l<c;l++)f+=s=(u=t.Use[l]).length();if(n===f&&u.Qse===u.VUt)for(;c<=i&&(t.Use[c].uit===x.RestrictionType.prompt&&c!==t.DU-1);c++)n+=t.Use[c]._text.length;if(0===r)return n;t.Use[i].uit!==x.RestrictionType.prompt&&t.Use[i].delete(e,r,a)}return n}function E(t){this.Rse=!1,this.Bse=!1;var n=this;n.Hc(t),E.Hce(t.pattern,n)}Object.defineProperty(n,"__esModule",{value:!0}),n.InputMask=void 0,x=e("./dist/plugins/inputMask/inputMask/interface.js"),M=e("./dist/plugins/inputMask/inputMask/common.js"),C=e("./dist/plugins/inputMask/inputMask/restrictions.js"),i=e("Common"),e=e("./dist/plugins/inputMask/inputMask/inputMask.ns.js"),e=new i.Common.ResourceManager(e.SR,"InputMask"),S=e.getResource.bind(e),N=void 0,e=i.Common.lt,o=e.ht,r=e._h,a=["\\","^",".","$","|","(",")","[","]","*","+","?","{","}",","],u=[{type:x.RestrictionType.year,func:function(t,n){var t,e=(t=t.getFullYear().toString()).length,t=n.pce<4?t.substring(e-2,e):t.toString();n.replace(0,n.length(),t)}},{type:x.RestrictionType.month,func:function(t,n){var e;l(n,(t.getMonth()+1).toString())}},{type:x.RestrictionType.day,func:function(t,n){var e;l(n,t.getDate().toString())}},{type:x.RestrictionType.hour,func:function(t,n){var e;l(n,(12<t.getHours()?t.getHours()-12:t.getHours()).toString())}},{type:x.RestrictionType.hour24,func:function(t,n){var e;l(n,t.getHours().toString())}},{type:x.RestrictionType.minute,func:function(t,n){var e;l(n,t.getMinutes().toString())}},{type:x.RestrictionType.second,func:function(t,n){var e;l(n,t.getSeconds().toString())}},{type:x.RestrictionType.hourFormat,func:function(t,n){var e,i=n.getText().length,t,t=1===i?12<t.getHours()?S().hourFormatSingleDesignator[1]:S().hourFormatSingleDesignator[0]:12<t.getHours()?S().hourFormatDesignator[1]:S().hourFormatDesignator[0];n.replace(0,i,t)}}],E.prototype.getValue=function(){for(var t,n,e,i,r,t=this,n="",e=t.Rse,i=0;i<t.DU;i++)r=t.Lse(i),!0===e&&r.uit===x.RestrictionType.prompt||(n+=r.getText());return n=!0===t.Bse?n.replace(new RegExp("\\"+t.Fse,"g"),""):n},E.prototype.Hc=function(t){var n=this;n.Pse=0,n.Gse=0,n._text="",n.y4="",n.Fse=t.placeholder&&t.placeholder[0]||"_",n.DU=0,n.Use=[],n.Hse=!0,n.zse={},n.Rse=t.excludeLiteral,n.Nmt=[],n.kmt=[],n.Bse=t.excludePlaceholder},E.prototype.bh=function(){for(var t,n,e,i,t=this,n=0,e=0;e<t.DU;e++)n+=(i=t.Lse(e)).length();return n},E.prototype.Lse=function(t){return this.Use[t]},E.prototype.Yse=function(t){for(var n,e,i,r,o,a,n=this,e={},i=0,r=0;r<n.DU;r++){if(a=(o=n.Use[r]).length(),t===i&&0===a||i<=t&&t<i+a)return e.index=r,e.offset=t-i,e;i+=a}if(i<=t)return o=n.Use[n.DU-1],e.index=n.DU-1,e.offset=o.length(),e},E.prototype.ZP=function(t){var n=this;t!==N&&(n.Use.push(t),n.Hse=!0,n.DU++)},E.prototype.hfe=function(){var t=this;t.Use=[],t.zse={},t.DU=0},E.prototype.Ose=function(){return this.Fse},E.prototype.getText=function(t){for(var n,e,i,r,n=this,e="",i=0;i<n.DU;i++)e+=(r=n.Lse(i)).getText();return e=!0===t?e.substring(n.Pse,Math.min(n.Gse,e.length)):e},E.prototype.getFirstInputPosition=function(){for(var t,n,e,i,t=this,n=0,e=0;e<t.DU;e++){if((i=t.Lse(e)).uit!==x.RestrictionType.prompt&&i.getStatus()!==x.RestrictionStatus.complete)return n+=i.Qse||0;n+=i.length()}return n},E.prototype.clear=function(){var t=this;return t.Zse(),t.Pse=t.Gse=t.getFirstInputPosition(),this},E.prototype.Zse=function(){var t,n,e,t=this;if(0<t.DU)for(n=0;n<t.DU;n++)(e=t.Use[n]).delete(0,e._text.length,!0)},E.prototype.getSelection=function(){var t=this,n=t.getText(),e=t.Gse;return e>n.length&&(e=n.length),{start:t.Pse,end:e}},E.prototype.setSelection=function(t){var n,e,t,n=this,e=Math.min(t.start,t.end),t=Math.abs(t.start-t.end);n.Pse=e,n.Gse=e+t},E.prototype.undo=function(t){var n,e,i,r,o,a,u,n=this,e=n.Nmt,i=t;if(i||(r=e.pop())&&(i=r.oldState),i){for(n.Pse=i.selectionStart,n.Gse=i.selectionEnd,o=n.Use,a=0,u=n.DU;a<u;a++)o[a].undo(i.restrictionsUndoInfo[a]);t||n.kmt.push(r)}},E.prototype.redo=function(){var t,n,e,i,r,o,a,t=this,n,e=t.kmt.pop();if(e&&(i=e.newState)){for(t.Pse=i.selectionStart,t.Gse=i.selectionEnd,r=t.Use,o=0,a=t.DU;o<a;o++)r[o].undo(i.restrictionsUndoInfo[o]);t.Nmt.push(e)}},E.prototype.Afe=function(t,n){var e,i,t,r,o,a,e=this,i=e.DU,t={selectionStart:t=t===N?e.Pse:t,selectionEnd:n=n===N?e.Gse:n,restrictionsUndoInfo:new Array(i)};if(0<i)for(r=t.restrictionsUndoInfo,o=0;o<i;o++)a=e.Use[o],r[o]=a.saveOldState();return t},E.prototype.addUndoInfo=function(t,n){var e,i;this.Nmt.push({oldState:t,newState:n})},E.namedPattern=function(t,n){if(E.namedPatterns||(E.namedPatterns={}),!o(t)){if(t=c(t),n===N)return E.namedPatterns[t];E.namedPatterns[t]=n}},E.replaceNamedPattern=function(n){return E.namedPatterns||(E.namedPatterns={}),Object.keys(E.namedPatterns).forEach(function(t){o(E.namedPatterns[t])||(n=n.replace(t,E.namedPatterns[t]))}),n},E.getNamedPatterns=function(){E.namedPatterns||(E.namedPatterns={});var e=E.namedPatterns,i=[];return Object.keys(e).forEach(function(t){var n=e[t];o(t)||o(n)||i.push({name:t,pattern:n})}),i},E.validatePattern=function(t){return E.Hce(t)},E.Hce=function(t,n){var e,i,r,o,a,u,s,c,f,l,h,d,d,v,m,g,p,b,y,w,e={success:!1};if(t){for(n=n||{DU:0,Use:[],zse:{},Ose:function(){return"_"},Wse:function(t){var n;switch(t.keyword[0]){case M.markers.year:n=x.RestrictionType.year;break;case M.markers.month:n=x.RestrictionType.month;break;case M.markers.day:n=x.RestrictionType.day;break;case M.markers.hour:n=x.RestrictionType.hour;break;case M.markers.hourIn24:n=x.RestrictionType.hour24;break;case M.markers.minute:n=x.RestrictionType.minute;break;case M.markers.second:n=x.RestrictionType.second}if(n)return new C.DateTimeItemRestriction(n,"_",t.keyLen)},ZP:function(t){n.Use.push(t),n.DU++},hfe:function(){n.Use=[],n.DU=0}},o=(r=k(t=E.replaceNamedPattern(t),i=0)).keyword,a=r.keyType,u=r.keyLen,s=x.KeywordType.promptChar,c="",f=x.KeywordType.optional,h=n.Ose();t.length>i;){switch(a){case x.KeywordType.unknow:return n.hfe(),e.message=S().errorMsg.unknownPattern,e;case x.KeywordType.optional:if(!(d=T(o,n)).result)return n.hfe(),e.message=S().errorMsg.invalidOptionalPattern,e;l=d.restriction,s=x.KeywordType.optional;break;case x.KeywordType.group:if(!A(o,d=[]))return n.hfe(),e.message=S().errorMsg.invalidGroupPattern,e;if(1===d.length){s===x.KeywordType.promptChar?c+=d[0]:(c=d[0],s=x.KeywordType.promptChar);break}if(0===d.length)break;(l=new C.EnumRestriction(h)).setItems(d),n.ZP(l),s=x.KeywordType.group,o=(r=k(t,i+=u)).keyword,a=r.keyType,u=r.keyLen;continue;case x.KeywordType.promptChar:s===x.KeywordType.promptChar?c+=o:(c=o,s=x.KeywordType.promptChar);break;case x.KeywordType.quantifier:return n.hfe(),e.message=S().errorMsg.errorQuantifierPattern,e;case x.KeywordType.range:l=new C.OptionalRestriction(h),o===M.markers.letter?(l.add(new C.RangeRestriction("A","Z",h)),l.add(new C.RangeRestriction("a","z",h))):o===M.markers.upper?(l.add(new C.RangeRestriction("A","Z",h,x.CaseType.upperCase)),l.add(new C.RangeRestriction("a","z",h,x.CaseType.upperCase))):o===M.markers.lower?(l.add(new C.RangeRestriction("A","Z",h,x.CaseType.lowerCase)),l.add(new C.RangeRestriction("a","z",h,x.CaseType.lowerCase))):o===M.markers.number&&l.add(new C.RangeRestriction("0","9",h)),s=x.KeywordType.range;break;case x.KeywordType.any:l=new C.AnyCharRestriction(h),s=x.KeywordType.any;break;case x.KeywordType.date:if((l=n.Wse(r))||r.keyword[0]!==M.markers.hourFormat||((l=new C.EnumRestriction(h)).setItems(1===r.keyLen?S().hourFormatSingleDesignator:S().hourFormatDesignator),l.uit=x.RestrictionType.hourFormat),!1===(v=D(n.zse,l)))return n.hfe(),e.message=S().errorMsg.duplicatedDateTimePattern,e;s=x.KeywordType.date}if(g=m=1,(i+=u)<t.length){switch(o=(r=k(t,i)).keyword,a=r.keyType,u=r.keyLen,a){case x.KeywordType.unknow:return n.hfe(),e.message=S().errorMsg.unknownPattern,e;case x.KeywordType.optional:f=x.KeywordType.optional;break;case x.KeywordType.group:for(p=!0,b=0;b<o.length;b++)if(o[b]===M.markers.groupSeparator&&o[b-1]!==M.markers.escape){p=!1;break}f=p?x.KeywordType.promptChar:x.KeywordType.optional;break;case x.KeywordType.quantifier:if(!(y=I(o)).result)return n.hfe(),e.message=S().errorMsg.invalidQuantifierPattern,e;if(g=y.min,m=y.max,isNaN(g)||isNaN(m))return n.hfe(),e.message=S().errorMsg.invalidQuantifierPattern,e;o=(r=k(t,i+=u)).keyword,a=r.keyType,u=r.keyLen,f=x.KeywordType.quantifier;break;case x.KeywordType.promptChar:f=x.KeywordType.promptChar;break;case x.KeywordType.range:f=x.KeywordType.range;break;case x.KeywordType.any:f=x.KeywordType.any;break;case x.KeywordType.date:f=x.KeywordType.date}if(s===x.KeywordType.promptChar){if(f!==x.KeywordType.promptChar){if(f===x.KeywordType.quantifier)return n.hfe(),e.message=S().errorMsg.errorQuantifierPattern,e;n.ZP(new C.PromptRestriction(c,h))}}else l.init(g,m,(0,M.fillString)(l.getPromptChar(),g),[!1,!1,!1]),l.Qse=0,n.ZP(l)}else s===x.KeywordType.promptChar?n.ZP(new C.PromptRestriction(c,h)):(l.init(1,1),n.ZP(l))}for(w=0;w<n.DU&&n.Use[w].uit===x.RestrictionType.prompt;w++);w===n.DU?(n.hfe(),e.message=S().errorMsg.noEntry):e.success=!0}else e.message=S().errorMsg.emptyPattern;return e},E.prototype.Wse=function(t){var n,e=this;switch(t.keyword[0]){case M.markers.year:n=x.RestrictionType.year;break;case M.markers.month:n=x.RestrictionType.month;break;case M.markers.day:n=x.RestrictionType.day;break;case M.markers.hour:n=x.RestrictionType.hour;break;case M.markers.hourIn24:n=x.RestrictionType.hour24;break;case M.markers.minute:n=x.RestrictionType.minute;break;case M.markers.second:n=x.RestrictionType.second}if(n)return new C.DateTimeItemRestriction(n,e.Fse,t.keyLen)},E.prototype.Kse=function(){var t=this.Jse(x.RestrictionType.year);return!(o(t)||3!==t.VUt&&4!==t.VUt)},E.prototype.Xse=function(){var t=this.Jse(x.RestrictionType.year);return!(o(t)||1!==t.VUt&&2!==t.VUt)},E.prototype.qse=function(){var t,n,t,n,e,i,t=this,n=t.Jse(x.RestrictionType.year);return o(n)?x.DateStatus.null:t.Kse()?n.getValue():(t=n.getValue(),n=(new Date).getFullYear(),t!==x.DateStatus.null&&t!==x.DateStatus.inComplete&&(99===t&&(t=100),e=100*parseInt((n/100).toString(),10)+t,i=100*parseInt(((n-99)/100).toString(),10)+t,e<=n&&n-99<=e?t=e:i<=n&&n-99<=i&&(t=i)),t)},E.prototype.setValue=function(t,e){var i,n,i=this;if(i.setSelection({start:0,end:i.bh()}),i.Zse(),void 0===t||""===t||0===t.length)return!0;0!==(t=t&&t.replace(new RegExp("[\r\n]","g"),"")).length&&(!o(e)&&e instanceof Date&&!r(i.zse)?(u.forEach(function(t){var n=i.Jse(t.type);n&&t.func(e,n)}),n=i.bh(),i.setSelection({start:n,end:n})):i.paste(t,!0))},E.prototype.Jse=function(t){var n,e,i,r,n=this;if(!0===n.Hse){for(e=n.zse={},i=0;i<n.DU;i++)(r=n.Use[i]).uit!==x.RestrictionType.prompt&&(e[r.uit]=r);n.Hse=!1}return n.zse[t]},E.prototype.$se=function(){var t,n,e,i,e,t,r,i,t=this,n=t.Jse(x.RestrictionType.day),e=t.Jse(x.RestrictionType.year),i=t.Jse(x.RestrictionType.month);n&&(e=o(e)?x.DateStatus.null:(t.Xse()||t.Kse())&&e.getStatus()===x.RestrictionStatus.inComplete?x.DateStatus.inComplete:t.qse(),t=o(i)?x.DateStatus.null:i.getStatus()===x.RestrictionStatus.inComplete?x.DateStatus.inComplete:i.getValue(),r=1,i=(0,M.daysInMonth)(e,t),n.setRange(1,i))},E.prototype.mfe=function(){var t,n,t,n,e,t=this,n=t.Jse(x.RestrictionType.hour24),t=t.Jse(x.RestrictionType.hourFormat);n&&t&&(n=n.getValue(),e=t.getText().length,12<=n?t.replace(0,e,(1===e?S().hourFormatSingleDesignator:S().hourFormatDesignator)[1]):0<=n&&t.replace(0,e,(1===e?S().hourFormatSingleDesignator:S().hourFormatDesignator)[0]))},E.prototype.gfe=function(t,n,e,i){var r,o,a,u,s,c,f,l,t,h,n,s,u,c,r=this,o;return!(r.DU-1<=t||(a=r.Afe(),u=e-n,c=(s=r.getText()).length,t=(l=(f=r.Lse(t)).getText()).substring(0,n)+i+s.substring(e,s.length),r.setSelection({start:u,end:c}),!1===(h=r.replace(t,!0)).success?(r.undo(a),1):(n=e+i.length,u=(s=r.Yse(n)).index,c=s.offset,u<r.DU-1&&r.Use[u].uit===x.RestrictionType.prompt&&0===c&&(!r.Use[u-1]||r.Use[u-1].satisfy())&&(n+=r.Use[u].length()),r.setSelection({start:n,end:n}),0)))},E.prototype.Eit=function(t,n){var e,i,r,o,a,u,s,e=this,i={};if(i.cursorPos=t,i.text=n,0===e.DU||n===N||""===n||t<0)return i;if(o=(r=e.Yse(t)).index,(a=r.offset)===(u=e.Use)[o].VUt)return i;for(;0!==o&&0===a&&(s=e.Use[o-1]).uit!==x.RestrictionType.prompt&&s._text.length<s.VUt;)if((a=u[--o].Qse)<u[o].pce){if(a=u[o].pce,""===(i=e.bce(o,a,t,n)).text)return i;if(t===a){o++,a=0;break}}return e.bce(o,a,t,n)},E.prototype.bce=function(t,n,e,i){for(var r,o,a,u,s,c,f,l,h,d,v,m,c,m,r=this,o={},a=t,u=r.DU,s=r.Afe();a<u;a++){if(l=n,!1===(d=(f=r.Use[a]).insert(n,i,h=a===u-1)).success&&n>=f.pce&&r.Use[a+1]&&r.Use[a+1].check(i,0).success&&!0===(v=r.gfe(t,n,e,i)))return{success:!0,cursorPos:r.Pse,text:""};if(n!==d.offset&&(f.uit!==x.RestrictionType.year&&f.uit!==x.RestrictionType.month&&f.uit!==x.RestrictionType.day||r.$se(),f.uit===x.RestrictionType.hour24)&&r.mfe(),n=d.offset,i=d.text,o.success=d.success,f.getStatus()!==x.RestrictionStatus.complete&&!1===d.success)break;if(e+=n-l,(n=0)===i.length)break}return u<=a&&""!==i&&0<i.length||(c=(m=r.Yse(e)).index,m=m.offset,a+1<u-1&&r.Use[a+1].uit===x.RestrictionType.prompt&&c===a+1&&0===m&&r.Use[a].satisfy()&&(e+=r.Use[a+1].length())),o.cursorPos=e,o.text=i,!1!==o.success?(c=r.Afe(e,e),r.addUndoInfo(s,c)):r.undo(s),o},E.prototype.backspace=function(){var t,n,n,t=this,n=t.yce(),n=t.wce(n.start,n.end-n.start);return t.setSelection({start:n,end:n}),!0},E.prototype.yce=function(){var t,n,e,i,r,o,a,u,s,t=this,n=t.getSelection(),e=n.start,i=n.end-e;if((0!==e||0!==i)&&(r=(u=t.Yse(e)).index,o=u.offset,-1!==r)){if(0===i){if(a=t.Lse(r),0===r&&0===o)return n;for(;(0===o||a.uit===x.RestrictionType.prompt)&&0<r;)i+=o,o=(a=t.Lse(--r)).length(),a.uit===x.RestrictionType.prompt&&(i+=o,o=0);if(a=t.Lse(r),0===r){if(a.uit===x.RestrictionType.prompt)return n;if(0===a.length())return n}if(a.uit!==x.RestrictionType.prompt)e-=i+=1,i=1;else{if(a.uit!==x.RestrictionType.enum&&a.uit!==x.RestrictionType.hourFormat)return n;e=0<(e-=i+=a.length())?e:0}}else{if(s=void 0,-1===(s=(u=t.Yse(e+i)).index))return n;if(0===o&&0!==r&&r--,a=t.Lse(s),r===s&&a.uit===x.RestrictionType.prompt)return n}n.start=e,n.end=e+i}return n},E.prototype.Mce=function(){var t,n,e,i,r,i,o,a,u,i,t,i,t=this,n=t.getSelection(),e,i=t.getText().length,r=t.DU,i=i,o=n.start,a=n.end-o;if((o!==i||0!==a)&&(u=(i=t.Yse(o)).index,i=i.offset,-1!==u)&&0===a){if(t=t.Lse(u),u===r-1&&i===t.Qse)return n;if(t.uit!==x.RestrictionType.prompt)a+=1;else{if(t.uit!==x.RestrictionType.enum&&t.uit!==x.RestrictionType.hourFormat)return n;a+=t.length(),o=0<o?o:0}n.start=o,n.end=o+a}return n},E.prototype.delete=function(){var t,n,n,t=this,n=t.Mce(),n=t.wce(n.start,n.end-n.start);return t.setSelection({start:n,end:n}),!0},E.prototype.wce=function(t,n){var e,i,r,o,a,u,s,c,f,l,h,n,e=this;if(0!==e.DU){for(i=e.Afe(),o=(r=e.Yse(t)).index,a=r.offset,e.Use[o].uit===x.RestrictionType.prompt&&n>e.Use[o]._text.length-a&&(t+=e.Use[o]._text.length-a,n-=e.Use[o]._text.length-a,o++,a=0),u=(r=e.Yse(t+n)).index,s=r.offset;0!==u&&0===s&&(c=e.Use[u-1]).uit!==x.RestrictionType.prompt;)s=e.Use[--u]._text.length>e.Use[u].pce?e.Use[u]._text.length:e.Use[u].pce;for(f=o;f<=u;f++)c=e.Use[f],l=a,o===u?a<s?a=c.delete(a,s-a):a-=a-s:f===o?0<(h=c._text.length-a)&&(a=c.delete(a,c._text.length-a)):a=f===u?c.delete(a,s):c.delete(a,c._text.length),a!==N&&(c.uit!==x.RestrictionType.year&&c.uit!==x.RestrictionType.month&&c.uit!==x.RestrictionType.day||e.$se(),c.uit===x.RestrictionType.hour24&&e.mfe(),t+=a-l),a=0;n=e.Afe(t,t),e.addUndoInfo(i,n)}return t},E.prototype.replace=function(t,n){var e,i,r,o,a,u,s,c,f,l,h,d,u,v,m,g,p,b,y,y,w,w,M,C,S,T,A,u,I,u,u,e=this,i=e.Pse,r=e.Gse-i,o=e.Rse,a={};for(a.cursorPos=i,a.text=t,s=(u=e.Yse(i)).index,c=u.offset,f=e.Afe();0!==s&&0===c&&e.Use[s].uit===x.RestrictionType.prompt;)(c=(l=e.Use[--s])._text.length)<l.pce&&(c=l.pce);for(h=(u=this.Yse(i+r)).index,d=u.offset;0!==h&&0===d&&(l=e.Use[h-1]).uit!==x.RestrictionType.prompt&&l._text.length<l.VUt;)d=e.Use[--h]._text.length;for(u=t,v=!0,m=i-c,g=s;g<e.DU;g++)if(l=e.Use[g],g+1<e.DU&&e.Use[g+1].uit===x.RestrictionType.prompt&&-1<(b=(p=e.Use[g+1]).included(t))&&(y=t.substring(0,b),""===(y=l.replace(c,y.length,y,N,n)).text)&&!0===y.success&&l.getStatus()===x.RestrictionStatus.complete)i+=(w=p._text.length)+y.offset-c,m+=(l.pce>l._text.length?l.pce:l._text.length)+w,t=t.substring(b+w,t.length),g++;else{if(w=l._text.length>l.pce?l._text.length:l.pce,""===t){i=_(e,i,c,h,d,g,n);break}if(l.uit===x.RestrictionType.prompt){if(o)m+c===i&&(i+=w-c);else{for(w=(M=l._text.substring(c,w)).length,C=Math.min(t.length,w),S=0;S<C&&t[S]===M[S];S++);t=t.substring(S,t.length),i+=S}m+=l._text.length-c}else{if(T=c,A=g===e.DU-1,y=void 0,v=(t=(c=(h<g?y=l.insert(c,t,A,n):s===h?y=l.replace(c,d-c,t,A,n):g===s?y=l.replace(c,w-c,t,A,n):g===h?(0<d-c?y=l.replace(c,d-c,t,A,n):0<r&&(y=l.replace(c,r,t,A,n)),y):y=l.replace(c,w,t,N,n)).offset,y.text),y.success),l.getStatus()!==x.RestrictionStatus.complete&&!1===v)break;l.uit!==x.RestrictionType.year&&l.uit!==x.RestrictionType.month&&l.uit!==x.RestrictionType.day||e.$se(),l.uit===x.RestrictionType.hour24&&e.mfe(),i+=c-T,m+=l.pce>l._text.length?l.pce:l._text.length}if(c=0,""===t){i=_(e,i,c,h,d,g,n);break}}return a.success=u!==t,I=(u=e.Yse(i)).index,u=u.offset,I<e.DU-1&&e.Use[I].uit===x.RestrictionType.prompt&&0===u&&(!e.Use[I-1]||e.Use[I-1].satisfy())&&(i+=e.Use[I].length()),!1!==a.success?(u=e.Afe(i,i),e.addUndoInfo(f,u)):e.undo(f),a.cursorPos=i,a.text=t,a},E.prototype.dispose=function(){for(var t,n,e,i,r,t=this,n=t.DU,e=t.Use,i=0;i<n;i++)(r=e[i]).dispose();t.Use.length=0,t.Nmt.length=0,t.kmt.length=0,t.zse=null},E.prototype.input=function(t){var n,t,n=this,t=n.Pse!==n.Gse?(0===n.Pse&&n.Gse===n.bh()&&(n.Pse=n.getFirstInputPosition()),n.replace(t)):n.Eit(n.Pse,t);return n.Gse=n.Pse=t.cursorPos,t.success},E.prototype.paste=function(t,n){var e,t,e=this,t=e.replace(t,n);return e.setSelection({start:t.cursorPos,end:t.cursorPos}),t.success},E.namedPatterns={},n.InputMask=E},"./dist/plugins/inputMask/inputMask/inputMask.ns.js":function(t,n,e){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.SR=void 0;var e=e("./dist/plugins/inputMask/inputMask/inputMask.res.en.js");n.SR={en:e}},"./dist/plugins/inputMask/inputMask/inputMask.res.en.js":function(t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.hourFormatDesignator=n.hourFormatSingleDesignator=n.errorMsg=void 0,n.errorMsg={invalidPattern:"Invalid Pattern",duplicatedDateTimePattern:"Duplicated Date Time Pattern",emptyPattern:"Empty Pattern",unknownPattern:"Parse Unknown Pattern Failure",invalidOptionalPattern:"Parse Optional Pattern Failure",invalidGroupPattern:"Parse Group Pattern Failure",errorQuantifierPattern:"Error Quantifier Position",invalidQuantifierPattern:"Parse Quantifier Pattern Failure",noEntry:"No Restriction Can Be Entered"},n.hourFormatSingleDesignator=["A","P"],n.hourFormatDesignator=["AM","PM"]},"./dist/plugins/inputMask/inputMask/interface.js":function(t,n){"use strict";var e,i,r,o,a,u,u,u,u,u;Object.defineProperty(n,"__esModule",{value:!0}),n.DateStatus=n.CaseType=n.RestrictionStatus=n.KeywordType=n.RestrictionType=void 0,(u=e=n.RestrictionType||(n.RestrictionType={}))[u.normal=0]="normal",u[u.prompt=1]="prompt",u[u.enum=2]="enum",u[u.year=3]="year",u[u.month=4]="month",u[u.day=5]="day",u[u.hour=6]="hour",u[u.hour24=7]="hour24",u[u.minute=8]="minute",u[u.second=9]="second",u[u.hourFormat=10]="hourFormat",(u=i=n.KeywordType||(n.KeywordType={}))[u.unknow=0]="unknow",u[u.octalAscII=1]="octalAscII",u[u.hexAscII=2]="hexAscII",u[u.hexUnicode=3]="hexUnicode",u[u.optional=4]="optional",u[u.group=5]="group",u[u.quantifier=6]="quantifier",u[u.promptChar=7]="promptChar",u[u.range=8]="range",u[u.any=9]="any",u[u.date=10]="date",(u=r=n.RestrictionStatus||(n.RestrictionStatus={}))[u.null=0]="null",u[u.complete=1]="complete",u[u.inComplete=2]="inComplete",(u=o=n.CaseType||(n.CaseType={}))[u.normal=0]="normal",u[u.upperCase=1]="upperCase",u[u.lowerCase=2]="lowerCase",(u=a=n.DateStatus||(n.DateStatus={}))[u.null=-1]="null",u[u.inComplete=-2]="inComplete"},"./dist/plugins/inputMask/inputMask/restrictions.js":function(t,n,e){"use strict";var i,s,b,r,e,r,o,w,e,a,u,c,f,l,h,d,v,R,m,g,p,y,M,C,S,T;function A(t,n,e,i){for(var r=0;r<e&&t[n+r]&&t[n+r]===i;r++);return r}function I(t,n,e){for(var i=n-1;0<=i&&t[i]===e;i--);return i}function x(t,n){var e=this;e.pce=-1,e.VUt=-1,e.Qse=-1,e._text="",e.uit=t,e.pce=0,e.VUt=0,e.Qse=0,e.Fse=n}function N(t){var t,n,t=g.call(this,s.RestrictionType.enum,t)||this,n=t;return n.Cce=-1,n.Qse=0,n.Sce=-1,n.Tce=-1,n.pce=Number.MAX_VALUE,n.VUt=Number.MIN_VALUE,n.QG=0,t}function k(t,n){var n=p.call(this,s.RestrictionType.prompt,n)||this;return n.init(t.length,t.length,t),n}function D(t){return y.call(this,s.RestrictionType.normal,t)||this}function _(t,n,e,i){var r=M.call(this,s.RestrictionType.normal,e)||this;return r.Ice=t,r.xce=n,r.Nce=i||s.CaseType.normal,r.init(1,1,e,[]),r}function E(t,n){var t=C.call(this,s.RestrictionType.normal,t)||this;return t.kce=n,t.init(0,1,"",[]),t}function j(t){var t=S.call(this,s.RestrictionType.normal,t)||this;return t.Dce=[],t}function O(t,n,e){var n,i,r,o,a,u,n=T.call(this,t,n)||this,i=n,r=e,o=e;switch(i.Qse=0,t){case s.RestrictionType.year:a=1,u=9999,r=o=e=e<=2?2:4;break;case s.RestrictionType.day:u=31,o=(a=1)===e?1:2,r=2;break;case s.RestrictionType.month:u=12,o=(a=1)===e?1:2,r=2;break;case s.RestrictionType.hour:a=0,u=11,o=1===e?1:2,r=2;break;case s.RestrictionType.hour24:a=0,u=23,o=1===e?1:2,r=2;break;case s.RestrictionType.minute:case s.RestrictionType.second:a=0,u=59,o=1===e?1:2,r=2}return i.VUt=r,i.pce=o,i._ce=a,i.Ece=u,n}i=this&&this.__extends||(m=function(t,n){return(m=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(t,n){t.__proto__=n}:function(t,n){for(var e in n)Object.prototype.hasOwnProperty.call(n,e)&&(t[e]=n[e])}))(t,n)},function(t,n){if("function"!=typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function e(){this.constructor=t}m(t,n),t.prototype=null===n?Object.create(n):(e.prototype=n.prototype,new e)}),Object.defineProperty(n,"__esModule",{value:!0}),n.DateTimeItemRestriction=n.OptionalRestriction=n.LimitedRestriction=n.RangeRestriction=n.AnyCharRestriction=n.PromptRestriction=n.EnumRestriction=n.MaskRestriction=void 0,s=e("./dist/plugins/inputMask/inputMask/interface.js"),b=e("./dist/plugins/inputMask/inputMask/common.js"),r=e("Common"),e=e("./dist/plugins/inputMask/inputMask/inputMask.ns.js"),o=(r=new r.Common.ResourceManager(e.SR,"InputMask")).getResource.bind(r),w=void 0,x.prototype.init=function(t,n,e,i){var r,o,a;if(n<t)return!1;if((r=this).pce=t,r.VUt=n,r.Oce=i||[],o=r.Qse=0,r.Oce!==w){for(;r.Oce[o]!==w;)o++;for(a=o;0<=a;a--)if(r.Oce[a]!==w)!1===r.Oce[a]&&r.Qse--;else{if(r.Oce[a]!==w)break;r.Qse--}}return r.clear(),r._text=e||"",!0},x.prototype.getPromptChar=function(){return this.Fse},x.prototype.saveOldState=function(){var t=this;return{bitState:t.Oce&&t.Oce.concat(),text:t._text,realLength:t.Qse}},x.prototype.undo=function(t){var n=this;n.Oce=t.bitState,n.Qse=t.realLength,n._text=t.text},x.prototype.insert=function(t,n,e,i){var r,o,a,u,s,c,f,l,h,d,v,m,g,p,b,y,r=this,o={};if(o.offset=t,o.text=n,t>r.VUt||""===n||0===n.length)o.success=!1;else{for(o.success=!0,a=[],u=t,s="",c=0,f=r.getPromptChar(),l=0;l<t;l++)a[l]=r.Oce[l];for(;c<n.length;){if(d=(h=r.check(n,c,i)).text,c=h.offset,""===d){o.success=!1;break}if(s+=d,a[u]=!0,u++,t+s.length===r.VUt)break;if(t+s.length>r.VUt){s=s.substring(0,s.length-1);break}}if(0===s.length)o.success=!1;else{if(v=A(r._text,t,s.length,f),(m=(m=r._text.substring(0,t)+s+r._text.substring(t+v,r._text.length)).length>r.VUt?m.substring(0,r.VUt):m).length>t+s.length)for(g=0,p=m.length-t-s.length;g<p;g++)r.Oce[t+g]!==w?a[u]=r.Oce[t+g]:a[u]=!1,u++;for(r.Oce=a,g=(r.Qse=u)-1;0<=g&&(!1===r.Oce[g]||i&&m[g]===f);g--)r.Qse--;if(m.length<r.pce)for(g=0,p=r.pce-m.length;g<p;g++)m+=f;for(b=m.length,y=Math.max(r.pce,r.Qse);y<b&&m[b-1]===f;b--);m=m.substring(0,b),r._text=m,n=c===n.length?"":n.substring(c,n.length),t+=s.length,o.offset=t,o.text=n}}return o},x.prototype.clear=function(){var t,n,e,i,t=this,n="",e=[];if((t.Qse=0)<t.pce){for(i=0;i<t.pce;i++)e[i]=!1;if(t.Oce=e,""!==t.getPromptChar())for(i=0;i<t.pce;i++)n+=t.getPromptChar();else for(i=0;i<t.pce;i++)n+=" ";t._text=n}else t._text="",t.Oce=[]},x.prototype.delete=function(t,n,e){var i,r,o,a,u,s,c,f,i=this;if(!(0===n||t>=i._text.length)){for(t+n>i._text.length&&(n=i._text.length-t),r=[],o=t,a=0;a<t;a++)r[a]=i.Oce[a];if(u=i._text.substring(0,t)+i._text.substring(t+n,i._text.length),t+n<i._text.length)for(s=0,c=i._text.substring(t+n,i._text.length).length;s<c;s++)i.Oce[t+n+s]!==w?r[o]=i.Oce[t+n+s]:r[o]=!1,o++;if(o<i.pce)for(s=o;s<i.pce;s++)r[s]=!1;for(i.Oce=r,s=(i.Qse=o)-1;0<=s&&!1===i.Oce[s];s--)i.Qse--;if(u.length<i.pce)for(f=i.pce-u.length,s=0;s<f;s++)u+=i.getPromptChar();i._text=u}return t},x.prototype.replace=function(t,n,e,i,r){var o,a,o={};return o.offset=t,o.text=e,(a=this).delete(t,n),o=a.insert(t,e,i,r)},x.prototype.getText=function(){var t,n,e,i,r,t=this,n=t._text;if(!n||n.length<t.pce){if((e=t.getPromptChar())===w||""===e)return n;for(i=n.length,r=t.pce;i<r;i++)n+=e}return n},x.prototype.getTextExcludeLiterals=function(t,n){var e,i,r,e=this._text,i=e.length;return r=(r=e.substring(t,n=i<n?i:n)).replace(/[^\d]/g,"")},x.prototype.check=function(t,n,e){var i={success:!1,text:""};return i.offset=n,e&&t===this.getPromptChar()&&(i.success=!0,i.text=t,i.offset=n+1),i},x.prototype.length=function(){var t=this,n=t.getText();return n.length>t.pce?n.length:t.pce},x.prototype.getStatus=function(){var t=this;return 0===t.pce?s.RestrictionStatus.complete:t.Qse<=0?s.RestrictionStatus.null:t.Qse<t.pce?s.RestrictionStatus.inComplete:s.RestrictionStatus.complete},x.prototype.dispose=function(){this.Oce&&(this.Oce.length=0)},x.prototype.satisfy=function(){return this._text.length===this.VUt},n.MaskRestriction=e=x,a=-1,u=-2,i(N,g=e),N.prototype.setItems=function(t){for(var n,e,i,r,o,n=this,e=n.pce,i=n.VUt,r=t.length,o=0;o<r;o++)e=Math.min(e,t[o].length),i=Math.max(i,t[o].length);e===Number.MAX_VALUE&&(e=0),i===Number.MIN_VALUE&&(i=0),n.pce=e,n.VUt=i,n.QG=r,n._items=t,n._text=n.getText()},N.prototype.getText=function(){var t,n,e,i,r,t=this,n=t.Cce;if(-2!==n)return-1===n?t._items[0]:t._items[t.Cce];for(e="",i=t.getPromptChar(),r=0;r<t.pce;r++)e+=i;return e},N.prototype.checkItemValid=function(t,n,e,i){var r,o,a,r={};return r.index1=n,r.index2=i,r.isValid=!1,n>=t.length||(o=t.substring(n,n+1).toLowerCase())===(a=e.substring(i,i+1).toLowerCase())&&(i++,r.index1=++n,r.index2=i,r.isValid=!0),r},N.prototype.insert=function(t,n,e,i){var r,o,a,u,s,c,f,l,h,d,v,m,g,p,b,y,w,M,C,S,r={},o=this;for(r.offset=t,r.text=n,r.success=!0,a=t,u="",0!==(a=o.Cce<0?0:a)&&(u=o._items[o.Cce].substring(0,a)),s=o.QG,c=new Array(s),f=new Array(s),l=new Array(s),h=new Array(s),d=0;d<s;d++)c[d]=a,f[d]=0,l[d]=99999,h[d]=[];for(d=0;d<s;d++)if(v=o._items[d],!(0<u.length&&v.substring(0,u.length)!==u))for(;f[d]<n.length&&!(c[d]>=v.length);)m=o.checkItemValid(v,c[d],n,f[d]),c[d]=m.index1,f[d]=m.index2,m.isValid?99999===l[d]&&(l[d]=f[d]):f[d]++;for(b=!1,y=c[g=0],w=p=0;w<o.QG;w++){if(v=o._items[w],c[w]===n.length+a&&n.length===v.length){y=c[g=w],b=!0;break}99999!==l[w]&&l[g]>=l[w]&&(l[g]===l[w]?y<(M=c[w])?(g=w,y=M,p=1):y===M&&p++:(y=c[g=w],p=1))}if(b)0===f[g]?r.success=!1:(n=n.substring(f[g]+1,n.length),t=o._items[g].length,r.success=0===h[g].length,o.Cce=g,o._text=o._items[g].toString(),o.Qse=o._text.length,r.offset=t,r.text=n);else if(y===a)!1===e&&0<=o.Cce&&t===o._items[o.Cce].length?(n=n.substring(f[g],n.length),r.offset=t,r.text=n):r.success=!1;else{for(C=-1,d=0;d<h[g].length;d++)C=0;if(1===p)t=o._items[g].length;else{for(S=o._items[g].length,d=0;d<o.QG;d++)c[d]===y&&S>o._items[d].length&&(S=o._items[d].length,g=d);t=y}-1===C?(n=n.substring(f[g],n.length),r.success=!0):(n=n.substring(f[g],n.length),r.success=!1),o.Cce=g,o._text=o._items[g],o.Qse=o._text.length,r.offset=t,r.text=n}return r},N.prototype.replace=function(t,n,e,i,r){return this.insert(t,e,i,r)},N.prototype.getStatus=function(){return this.Cce<0?s.RestrictionStatus.null:s.RestrictionStatus.complete},N.prototype.delete=function(t,n,e){var i,r,i=this;if(0===n||t>=i._text.length)return t;if(i.Cce=e?-1:-2,i._text="",0<i.pce)for(r=0;r<i.pce;r++)i._text+=i.getPromptChar();return i.Qse=0},N.prototype.saveOldState=function(){var t=g.prototype.saveOldState.call(this);return t.activeItem=this.Cce,t},N.prototype.undo=function(t){g.prototype.undo.call(this,t),this.Cce=t.activeItem},N.prototype.satisfy=function(){return 0<=this.Cce},n.EnumRestriction=N,i(k,p=e),k.prototype.insert=function(t,n,e,i){for(var r,o,a,u,s,c,r=this,o=n.length,a=r._text.length-t,u=0,s=Math.min(o,a);u<s&&n[u]===r._text[t+u];u++);return{text:c=n.substring(u,o),offset:r._text.length,success:0<u}},k.prototype.delete=function(t,n,e){return t},k.prototype.replace=function(t,n,e,i,r){return this.insert(t,e,i,r)},k.prototype.included=function(t){var n,e,n,t;return t?(e=(n=this._text).replace(String.fromCharCode(32),String.fromCharCode(160)),n=t.indexOf(n),t=t.indexOf(e),-1<n?n:-1<t?t:-1):-1},n.PromptRestriction=k,i(D,y=e),D.prototype.insert=function(t,n,e,i){var r,o,o,o,r=this;return t+n.length>r.VUt?(o=n.substring(0,r.VUt-t),r._text=r._text.substring(0,t)+o,r.Cfe(),{text:n.substring(r.VUt-t,n.length),offset:r.VUt,success:!0}):(o=A(r._text,t,n.length,r.getPromptChar()),o=r._text.substring(0,t)+n+r._text.substring(t+o,r._text.length),r._text=o.substring(0,r.VUt),r.Cfe(),{text:"",offset:t+n.length,success:!0})},D.prototype.delete=function(t,n,e){var i=this;return i._text=i._text.substring(0,t)+i._text.substring(t+n,i._text.length),i.Cfe(),t},D.prototype.replace=function(t,n,e,i,r){var o,a,o=this;return t+e.length>o.VUt?(a=e.substring(0,o.VUt-t),o._text=o._text.substring(0,t)+a,o.Cfe(),{text:e.substring(o.VUt-t,e.length),offset:o.VUt,success:!0}):(o._text=o._text.substring(0,t)+e+o._text.substring(t+n,o._text.length),o._text=o._text.substring(0,o.VUt),o.Cfe(),{text:"",offset:t+e.length,success:!0})},D.prototype.Cfe=function(){var t=this,n=t._text;t.Qse=I(n,n.length,t.getPromptChar())+1},n.AnyCharRestriction=D,i(_,M=e),_.prototype.check=function(t,n,e){var i,r,t,n,i=this,r={success:!1,text:""},t=t.substring(r.offset=n,n+1),n=i.Nce;return(t>=i.Ice&&t<=i.xce||e&&t===i.getPromptChar())&&(n===s.CaseType.upperCase?t=t.toUpperCase():n===s.CaseType.lowerCase&&(t=t.toLowerCase()),r.offset++,r.text=t,r.success=!0),r},n.RangeRestriction=_,i(E,C=e),E.prototype.check=function(t,n,e){var i=this,t=t[n],r={success:!0};return r.text=t,r.offset=n+1,""!==i.kce&&-1<i.kce.indexOf(t)||e&&t===i.getPromptChar()||(r.success=!1,r.text="",r.offset=n),r},n.LimitedRestriction=E,i(j,S=e),j.prototype.add=function(t){t!==w&&this.Dce.push(t)},j.prototype.check=function(t,n,e){var i,r,o,a,u,s,c,i,r=this.Dce,o={},a=t[n];if(o.success=!1,o.text="",o.offset=n,0!==r.length)for(u=0,s=r.length;u<s;u++)if(!0===(c=r[u].check(a,0,e)).success&&""!==c.text)return o.offset=n+1,o.success=!0,o.text=c.text,o;return o},j.prototype.dispose=function(){var t,n,e,i;for(S.prototype.dispose.call(this),e=0,i=(n=(t=this).Dce).length;e<i;e++)n[e].dispose();t.Dce.length=0},n.OptionalRestriction=j,i(O,T=e),O.prototype.init=function(t,n,e,i){return!0},O.prototype.getText=function(){var t=this,n=t.getValue();return 0<=n&&n>t.Ece&&(t._text=""+t.Ece),-1===n&&(t._text=(0,b.fillString)(t.getPromptChar(),t.pce)),t._text},O.prototype.getValue=function(){var t=this.getStatus();return t===s.RestrictionStatus.null?s.DateStatus.null:t===s.RestrictionStatus.inComplete?s.DateStatus.inComplete:parseInt(this._text,10)},O.prototype.getStatus=function(){for(var t,n,e,i,r,o,a,t=this,n=t.getPromptChar(),e=t.pce,i=t._text,r=i.length,o=0,a=0;a<r;a++)i[a]!==n&&o++;return 0===o?s.RestrictionStatus.null:o<e?s.RestrictionStatus.inComplete:s.RestrictionStatus.complete},O.prototype.check=function(t,n,e){var e,i,e="0"<=t&&t<="9"||e&&t===this.getPromptChar();return{success:e,text:i=e?t:"",offset:n=e?n+1:n}},O.prototype.rightShiftNumber=function(t,n){for(var e=0;0<t&&e<n;e++)t=parseInt((t/10).toString(),10);return t},O.prototype.Rce=function(t){for(var n,e,i,n=this,e="",i=t;i<n.VUt;i++)e+=n.getPromptChar();n._text=n._text.substring(0,t)+e},O.prototype.delete=function(t,n,e){var i,r,o,a,u,s,c,f,l,h,d,v,m,g,n,i=this,r=i.VUt;if(!(r<t+n)){for(o=i._text,a=i._ce,u=i.Ece,s=(0,b.fillString)(a,i.VUt,"0"),c=o.substring(0,t),f=o.substring(0,t)+o.substring(t+n,o.length),h=l=0;h<t;h++)l=(l*=10)+parseFloat((o[h]===i.getPromptChar()?s:o)[h]);for(g=!1,h=m=t;h<f.length&&f[h]!==i.getPromptChar();h++)l=(l*=10)+parseFloat(f[h]),d=i.rightShiftNumber(a,r-m-1),v=i.rightShiftNumber(u,r-m-1),d<=l&&l<=v?(c+=f[h],m++):(l=(l-parseFloat(f[h]))/10,g=!0);0===t&&0===l&&g?i.Rce(0):(0<(n=i.pce-c.length)&&(c+=(0,b.fillString)(i.getPromptChar(),n)),i._text=c),i.Cfe()}return t},O.prototype.Cfe=function(){var t=this,n=t._text;t.Qse=I(n,n.length,t.getPromptChar())+1},O.prototype.Bce=function(t,n,e,i){var r,o,a,u,s,c,f,l,h,d,v,m,g,p,i,r=this,o=r.VUt,a=r._ce,u=r.getPromptChar(),s=r.Ece,c={};if(c.offset=t,c.success=!1,i&&n===u)r._text=r._text.substring(0,t)+n+r._text.substring(t+1,r._text.length),c.offset=t+1,c.success=!0;else if(r.check(n,t,i).success){for(f=(0,b.fillString)(a,o,"0"),h=r._text,v=d=l=0;v<t;v++)l*=10,h[v]!==u?l+=parseFloat(h[v]):l<r.rightShiftNumber(a,o-v-1)?(h=h.substring(0,v)+f[v]+h.substring(v+1,h.length),l+=parseFloat(f[v])):h=h.substring(0,v)+"0"+h.substring(v+1,h.length);if(l=(l*=10)+parseFloat(n),m=r.rightShiftNumber(a,i=o-t-1),g=r.rightShiftNumber(s,i),m<=l&&l<=g){for(e?t>=h.length?h+=n:h=h.substring(0,t)+n+h.substring(t,h.length-1):h=h.substring(0,t)+n+h.substring(t+1,h.length),v=++t;v<o;v++){if(l*=10,h[v]===u){h=h.substring(0,v)+(0,b.fillString)(u,o-v);break}if(l+=parseFloat(h[v]),m=r.rightShiftNumber(a,o-v-1),(g=r.rightShiftNumber(s,o-v-1))<l||l<m){h=h.substring(0,v)+(0,b.fillString)(u,o-v);break}}if(r.VUt!==r.pce){for(;d<h.length-r.pce&&"0"===h[d];d++)t--;h=h.substring(d,h.length)}r._text=h}else{if(l!==parseFloat(n)||"0"===n)return c;if("0"!==f[t])return 0!==t&&(c.success=!0,c.offset=t),c;for(;(g<l||l<m)&&(e?t>=h.length?h+="0":h=h.substring(0,t)+"0"+h.substring(t,h.length-1):h=h.substring(0,t)+"0"+h.substring(t+1,h.length),m=r.rightShiftNumber(a,o-++t-1),g=r.rightShiftNumber(s,o-t-1),!(t>=h.length-1)););for(l=0,p=t;p<o;p++){if(l=(l*=10)+parseFloat(n),m=r.rightShiftNumber(a,o-p-1),!((g=r.rightShiftNumber(s,o-p-1))<l||l<m)){for(e?p>=h.length?h+=n:h=h.substring(0,p)+n+h.substring(p,h.length-1):h=h.substring(0,p)+n+h.substring(p+1,h.length),v=++p;v<o;v++){if(l*=10,h[v]===u){h=h.substring(0,v)+(0,b.fillString)(u,o-v);break}if(l+=parseFloat(h[v]),m=r.rightShiftNumber(a,o-v-1),(g=r.rightShiftNumber(s,o-v-1))<l||l<m){h=h.substring(0,v)+(0,b.fillString)(u,o-v);break}}if(r.VUt!==r.pce){for(;d<h.length-r.pce&&"0"===h[d];d++)p--;h=h.substring(d,h.length)}r._text=h,t=p;break}if(l-=parseFloat(n),"0"!==h[p])return 0!==t&&(c.success=!0,c.offset=t),c;if(e?p>=h.length?h+="0":h=h.substring(0,p)+"0"+h.substring(p,h.length-1):h=h.substring(0,p)+"0"+h.substring(p+1,h.length),p===h.length-1)return c.success=!1,c}}c.offset=t,c.success=!0}return c},O.prototype.insert=function(t,n,e,i){var r,o,a,u,s,c,r=this,o={success:!0};if(o.offset=t,o.text=n,a=r._text,t!==r.VUt){for(u=t,s=0;s<n.length;s++)if((c=r.Bce(u,n[s],!0,i)).success){if((u=c.offset)===r.VUt)break}else o.success=!1;r.Cfe(),t===u&&a===r._text||(n=s+1<n.length?n.substring(s+1,n.length):"",o.offset=u,o.text=n)}return o},O.prototype.replace=function(t,n,e,i,r){var o,a,u,s,c,f,s,l,o=this,a=t,u={success:!0};if(u.offset=a,u.text=e,s=o._text,a!==o.VUt){for(c=0;c<e.length;c++)if((f=o.Bce(a,e[c],n<=c,r)).success){if((a=f.offset)===o.VUt)break}else u.success=!1;o.Cfe(),t===a&&s===o._text||(s=n+t-a,(l=o._text).length>=t+n&&0<s&&(o._text=l.substring(0,a)+l.substring(t+n,l.length)+(0,b.fillString)(o.getPromptChar(),s)),e=c+1<e.length?e.substring(c+1,e.length):"",u.offset=a,u.text=e)}return u},O.prototype.setRange=function(t,n){this._ce=t,this.Ece=n},O.prototype.satisfy=function(){var t,n,e,i,r,o,a,t=this,n=t._text,e=t.VUt;if(n.length===e)return!0;switch(i=t.getValue(),r=t.pce,o=t.uit){case s.RestrictionType.year:return n.length===e;case s.RestrictionType.day:return a=Math.floor(t.Ece/10),1===r&&a<i;case s.RestrictionType.month:case s.RestrictionType.hour:return 1===r&&1<i;case s.RestrictionType.hour24:return 1===r&&2<i;case s.RestrictionType.minute:case s.RestrictionType.second:return 1===r&&5<i;default:return!1}},n.DateTimeItemRestriction=O},"./dist/plugins/inputMask/integrate.js":function(t,n,e){"use strict";var i,n,r,o,a,u,s,c,f,l;function h(t){return!a(t)&&!a(t.pattern)&&0<t.pattern.length&&o.InputMask.validatePattern(t.pattern).success}function d(t){return t=t&&0<t.length&&0<=(t=t.replace(c,"\n")).indexOf("\xa0")?t.replace(new RegExp("\xa0","g")," "):t}function v(t){return t=t&&0<t.length&&0<=(t=t.replace(/\n/g,"\n\u200b")).indexOf(" ")?t.replace(new RegExp(" ","g"),"\xa0"):t}Object.defineProperty(n,"__esModule",{value:!0}),i=e("Core"),n=e("Common"),r=e("Core"),o=e("./dist/plugins/inputMask/inputMask/inputMask.js"),a=n.Common.lt.ht,u="\xa0",s="\u200b",c=new RegExp("\n\u200b","g"),f=" ",i.CellTypes.Text.ch("inputMask",l={activateEditor:function(t){var n,t,t,n=t.editor,t=t.mask;h(t)&&(t=new o.InputMask(t),n.jse=t)},setEditorValue:function(t){var n,e,i,r,i,n,e=t.editor.jse,i=t.editorValue,r=t.originValue;e&&(t.startEditByKeydown||a(i)||(i=d(i),e.setValue(i,r)),i=e.getFirstInputPosition(),e.setSelection({start:i,end:i}),e.addPercent=t.addPercent,t.editorValue=v(e.getText()+(t.startEditByKeydown&&e.addPercent?"%":"")),t.caret=e.getSelection(),t.cancel=!0)},afterSetEditorFocus:function(t){var n,e=t.editor.jse;e&&(t.caret=e.getSelection(),t.cancel=!0)},deactivateEditor:function(t){var t=t.editor,n=t.jse;n&&(n.dispose(),t.jse=null)},getEditorValue:function(t){var n,e=t.editor.jse;e&&(t.editorValue=e.getValue()+(e.addPercent?"%":""))},editorInput:function(t){var n=t.editor,e=t.value,i=t.caret,n=n.jse;n&&(t.isImeInputting&&(i.start=i.start-e.length,i.end=i.end-e.length),n.setSelection(i),n.input(e),t.value=v(n.getText()+(n.addPercent?"%":"")),t.caret=n.getSelection(),t.cancel=!0)},editorBackspace:function(t){var n=t.editor,e=t.caret,n=n.jse;n&&(n.setSelection(e),n.backspace(),t.value=v(n.getText()+(n.addPercent?"%":"")),t.caret=n.getSelection(),t.cancel=!0)},editorDelete:function(t){var n=t.editor,e=t.caret,n=n.jse;n&&(n.setSelection(e),n.delete(),t.value=v(n.getText()+(n.addPercent?"%":"")),t.caret=n.getSelection(),t.cancel=!0)},editorCut:function(t){var n,e,i,r,n,e,n=t.editor,e=t.caret,i=t.clipboardData,r=t.dataName,n=n.jse;n&&(n.setSelection(e),e=n.getText(!0),i.setData(r,e),n.backspace(),t.value=v(n.getText()+(n.addPercent?"%":"")),t.caret=n.getSelection())},editorPaste:function(t){var n=t.editor,e=t.caret,i=t.pasteValue,n=n.jse;n&&(n.setSelection(e),n.paste(i),t.pasteValue=v(n.getText()+(n.addPercent?"%":"")),t.caret=n.getSelection(),t.cancel=!0)},editorUndo:function(t){var n=t.editor,e=t.caret,n=n.jse;n&&(n.setSelection(e),n.undo(),t.value=v(n.getText()+(n.addPercent?"%":"")),t.caret=n.getSelection(),t.cancel=!0)},editorRedo:function(t){var n=t.editor,e=t.caret,n=n.jse;n&&(n.setSelection(e),n.redo(),t.value=v(n.getText()+(n.addPercent?"%":"")),t.caret=n.getSelection(),t.cancel=!0)},onCreateEventArg:function(t){var n=t.eventArg,e;n.sheet.getActualStyle(n.row,n.col).mask&&t.eventName===i.Events.FormulaTextboxEnterCell&&(n.readonly=!0)}}),r.Workbook.ch("inputMask",{fromJson:function(t,n,e){o.InputMask.namedPatterns=t.namedPatterns||{}},toJson:function(t,n){t.namedPatterns=o.InputMask.namedPatterns},yh:function(t,n,e){t.workbook.lossless&&(o.InputMask.namedPatterns=t.workbook.lossless.namedPatterns||{})},wh:function(t,n,e){t.workbook.lossless||(t.workbook.lossless={}),t.workbook.lossless.namedPatterns=o.InputMask.namedPatterns}})},"./dist/plugins/namebox/namebox-actions.js":function(t,n,e){"use strict";var i,n,r,h,e,o,d,v,n,m,g,p,a,u,s,c,f,l,b;function y(t,n){return l.call(this,t,n)||this}function w(t,n){return b.call(this,t,n)||this}i=this&&this.__extends||(f=function(t,n){return(f=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(t,n){t.__proto__=n}:function(t,n){for(var e in n)Object.prototype.hasOwnProperty.call(n,e)&&(t[e]=n[e])}))(t,n)},function(t,n){if("function"!=typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function e(){this.constructor=t}f(t,n),t.prototype=null===n?Object.create(n):(e.prototype=n.prototype,new e)}),Object.defineProperty(n,"__esModule",{value:!0}),n=e("Common"),r=e("Core"),h=e("SheetsCalc"),e=e("./dist/plugins/namebox/namebox.ns.js"),o=r.Commands.ActionBase,d=n.Common.zf,v=n.Common.lt.ht,n=new n.Common.ResourceManager(e.SR,"NameBox"),m=n.getResource.bind(n),g="print_area",p=void 0,a="addCustomName",u="navigateToRange",i(y,l=o),y.prototype.execute=function(){var t,n,e,i,t,r,t,o,a,u,s,c,f,l,t=this,n=!1;if(t.canExecute()){i=(e=t.Mf).getParent(),r=(t=t.tT).nameBox,t=t.selectorValue;try{if(o=e.getSelections(),v(o)||0===o.length)return;if(t.toLowerCase()===g&&e.printInfo)return a=o[0],(u=e.printInfo()).rowStart(a.row),u.rowEnd(a.row+a.rowCount-1),u.columnStart(a.col),u.columnEnd(a.col+a.colCount-1),!0;for(s=e.name(),d.fJ(s,"'")&&d.dT(s,"'")||(s="'"+s+"'"),c=[],f=void 0,l=0;l<o.length;l++)c.push(s+"!"+(0,h.rangeToFormula)(o[l],e.getActiveRowIndex(),e.getActiveColumnIndex(),p,!!i.options.referenceStyle));f=c.join(","),i.addCustomName(t,f,e.getActiveRowIndex(),e.getActiveColumnIndex(),""),n=!0}catch(t){e.jT(15,m().invalidName),r.updateNameRangeSelectorValue()}}return n},s=y,r.Commands[a]={canUndo:!1,execute:function(t,n){r.Commands.zA(t,s,n)}},i(w,b=o),w.prototype.execute=function(){var t,n,e,i,t,r,o,a,t,u,s,c,t=this,n=!1;if(t.canExecute()){if(i=(e=t.Mf).getParent(),r=(t=t.tT).nameBox,o=t.selectorValue,a=t.selections,t=t.sheetName,i.I2(i.getSheetIndex(t),1,!1,!0),(u=i.getActiveSheet()).clearSelection(),s=a[0],v(s))return;for(u.setSelection(s.row,s.col,s.rowCount,s.colCount),c=1;c<a.length;c++)s=a[c],u.addSelection(s.row,s.col,s.rowCount,s.colCount);r.selector.val(o),r.cpt=r.selector.val(),n=!0}return n},c=w,r.Commands[u]={canUndo:!1,execute:function(t,n){r.Commands.zA(t,c,n)}},r.Commands.fpt=function(t){t.register(a,r.Commands[a]),t.register(u,r.Commands[u])}},"./dist/plugins/namebox/namebox-list.js":function(t,n,e){"use strict";var i,e,r,o,a;function u(t,n){var t=a.call(this,t)||this;return n&&t.setNameList(n),t}i=this&&this.__extends||(o=function(t,n){return(o=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(t,n){t.__proto__=n}:function(t,n){for(var e in n)Object.prototype.hasOwnProperty.call(n,e)&&(t[e]=n[e])}))(t,n)},function(t,n){if("function"!=typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function e(){this.constructor=t}o(t,n),t.prototype=null===n?Object.create(n):(e.prototype=n.prototype,new e)}),Object.defineProperty(n,"__esModule",{value:!0}),n.NameBoxList=void 0,e=e("CellTypes"),a=e.List,i(u,a),u.prototype.setNameList=function(t){var n=this;n.setOptions({items:n.lpt(t),textEllipsis:!0})},u.prototype.lpt=function(t){return t.map(function(t){return{text:t,value:t}})},u.CustomNameChange="CustomNameChange",n.NameBoxList=u},"./dist/plugins/namebox/namebox.entry.js":function(t,n,e){"use strict";var i,r,o,a,u,i=this&&this.__createBinding||(Object.create?function(t,n,e,i){void 0===i&&(i=e);var r=Object.getOwnPropertyDescriptor(n,e);r&&("get"in r?n.__esModule:!r.writable&&!r.configurable)||(r={enumerable:!0,get:function(){return n[e]}}),Object.defineProperty(t,i,r)}:function(t,n,e,i){t[i=void 0===i?e:i]=n[e]}),r=this&&this.__exportStar||function(t,n){for(var e in t)"default"===e||Object.prototype.hasOwnProperty.call(n,e)||i(n,t,e)};Object.defineProperty(n,"__esModule",{value:!0}),n.findControl=n.NameBox=void 0,e("./dist/plugins/namebox/namebox-actions.js"),o=e("Core"),a=e("./dist/plugins/namebox/namebox.js"),Object.defineProperty(n,"NameBox",{enumerable:!0,get:function(){return a.NameBox}}),r(e("./dist/plugins/namebox/namebox.ns.js"),n),n.findControl=u=function(t){return"string"==typeof t&&(t=document.getElementById(t)),(0,o.GC$)(t).data("name-box")}},"./dist/plugins/namebox/namebox.js":function(B,t,n){"use strict";var d,u,f,r,o,a,n,s,e,v,c,i,l,h,m,g,p,b,y,w,M,C,S,T,A,n,I,x,N,L;function k(t,n,e){var i,r;this.addCustomNameCommand="addCustomName",this.navigateToRangeCommand="navigateToRange",this.cpt="",this.hpt=!1,t&&n&&(t instanceof HTMLElement?i=t:"string"==typeof t&&(i=document.getElementById(t)),i)&&((r=this).hpt=!0,r.Ti=i,s(i).data(m,r),r.options=A(N,function(t,n,e){r.Ob(t,n,e)}),r.Zp(e),r.dpt(),r.hpt=!1,r.bind(n))}function D(t,n){var e,i,r,o,n,o,e="",i=n.rowCount,r=n.colCount,o=n.row+1,n=n.col+1;return 1===i&&1===r?e=E(t,o,n):i<0&&0<r?e=r+"C":r<0&&0<i?e=i+"R":i<0&&r<0?(o=t.getActiveSheet())&&(e=o.getRowCount()+"R x "+o.getColumnCount()+"C"):e=i+"R x "+r+"C",e}function _(t,n){var e,i,r,e=!1,i=n.getSpans();if(i)for(r=0;r<i.length;r++)if(i[r].row===t.row&&i[r].col===t.col&&i[r].rowCount===t.rowCount&&i[r].colCount===t.colCount){e=!0;break}return e}function E(t,n,e,i){var r,o,a,u,s,c,f,l,h;if(n<1||e<1)return null;if(r="",a=(o=t.getActiveSheet())&&o.name(),i&&o){if(u=_(i,o),(s=t.getCustomNames())!==v)for(c=0;c<s.length;c++)if((f=s[c].getExpression())&&f.type===d.ExpressionType.reference&&f.source&&f.source.getName&&a===f.source.getName()&&null!==(l=f.getRange(0,0))&&l!==v&&(l.row===i.row&&l.col===i.col&&l.row+l.rowCount===i.row+i.rowCount&&l.col+l.columnCount===i.col+i.colCount||l.row===i.row&&l.col===i.col&&u)){r=s[c].getName();break}if(""===r&&s!==v)for(c=0;c<s.length;c++)(f=s[c].getExpression())&&f.type===d.ExpressionType.reference&&((l=f.getRange(0,0)).row===i.row&&l.column===i.col&&l.row+l.rowCount===i.row+i.rowCount&&l.column+l.columnCount===i.col+i.colCount||l.row===i.row&&l.column===i.col&&u)&&(r=s[c].getName())}if(""===r)switch(t.options.referenceStyle){case 0:for(;0<e;)0==(h=e%26)?(r="Z"+r,e--):r=String.fromCharCode("A".charCodeAt(0)+h-1)+r,e=parseInt((e/26).toString(),10);r+=n.toString();break;case 1:r="R"+n.toString()+"C"+e.toString()}return r}function j(t,n,e){void 0===e&&(e=!1);var t=t.getExpression();return!(!t||e&&!P(t,n))&&(-1<x.indexOf(t.type)||t.type===d.ExpressionType.operator&&16===t.operatorType)}function O(t){var n=t.row,e=t.col,i=t.rowCount,t=t.colCount;return-1!==n&&-1!==i||(i=n=-1),-1!==e&&-1!==t||(t=e=-1),new u.Range(n,e,i,t)}function R(t){if(t)return t.row+"_"+t.col+"_"+t.rowCount+"_"+t.colCount}function F(n,e){var i,t;try{i=(t=a.Common.CultureManager.getCultureInfo()).localeCompare?t.localeCompare(n,e):n.localeCompare(e,"en")}catch(t){i=n.localeCompare(e)}return i}function P(t,n){var e,i,r,o,a,u;try{if(e=n.getActiveSheet(),i=!!n.options.referenceStyle,!(r=(0,f.formulaToRanges)(e,(0,f.expressionToFormula)(n,t,e.getActiveRowIndex(),e.getActiveColumnIndex(),i),v,v,v,i))||r.length<1)return;for(o=0,a=r;o<a.length;o++)if(u=a[o],!n.getSheetFromName(u.sheetName))return}catch(t){return}return 1}function G(t){return new RegExp(/[^A-Za-z0-9_.!?'",:\u0080-\uFFFF\\]+/g).test(t)}Object.defineProperty(t,"__esModule",{value:!0}),t.NameBox=void 0,d=n("CalcEngine"),u=n("Core"),f=n("SheetsCalc"),r=n("CellTypes"),o=n("./dist/plugins/namebox/namebox-list.js"),a=n("Common"),n=n("./dist/plugins/namebox/namebox.ns.js"),s=u.GC$,e=null,v=void 0,c="A1",i=".gc-name-box",l="div",h="input",m="name-box",g="_",p="invalid",b="gc-name-box-",y="container",w="selector",M="dropdown",C=a.Common.lt.ht,S=a.Common.zf,T=u.util.En,A=u.util.b0,n=new a.Common.ResourceManager(n.SR,"NameBox"),I=n.getResource.bind(n),x=[d.ExpressionType.reference,d.ExpressionType.name,d.ExpressionType.structReference],N={enableAddCustomName:!0,enableNavigateToRange:!0,showCustomNameList:!0,dropDownMaxHeight:500},Object.defineProperty(k.prototype,"selector",{get:function(){return s("."+b+w,this.Ti)},enumerable:!1,configurable:!0}),Object.defineProperty(k.prototype,"dropdown",{get:function(){return s("."+b+M,this.Ti)},enumerable:!1,configurable:!0}),k.prototype.getHost=function(){return this.Ti},k.prototype.getCustomNameList=function(t){var n,e,e,i,r,o,a,u,s,c,f,l;if(void 0===t&&(t=!1),!(e=(n=this).vpt))return[];for(e=e.getActiveSheet(),i=[],o=0,a=r=n.mpt(e,t).concat(n.gpt(t));o<a.length;o++)u=a[o],i.push(u.getName());for(c=0,f=s=n.ppt();c<f.length;c++)l=f[c],i.push(l.name);return i},k.prototype.bind=function(t){var n=this;n.unbind(),t&&(n.vpt=t,n._id=t.bpt()),n.rebuild()},k.prototype.unbind=function(){var t=this;t.ypt(),t.wY=e,t.wpt(),t.vpt=e,t._id=e},k.prototype.refresh=function(){this.updateNameRangeSelectorValue()},k.prototype.rebuild=function(){var t=this;t.hpt||(t.wpt(),t.dpt(),t.v7(),t.Mpt(),t.refresh())},k.prototype.executeCommand=function(t,n,e){var i,r,o,i=this,r=i.vpt,o=r.getActiveSheet();r.commandManager().execute({cmd:t,sheetName:e||o.name(),nameBox:i,selectorValue:i.selector.val(),selections:n||o.getSelections()})},k.prototype.dispose=function(){var t=this;t.unbind(),t.wY&&t.wY.dispose(),t.wY=e,t.Cpt&&t.Cpt.close(),t.Cpt=e,s(t.Ti).data(m,e),t.Ti.innerHTML="",t.Ti=e},k.prototype.Ob=function(t,n,e){var i=this;if(n!==e&&(i.options[t]=n,!i.hpt))switch(t){case"dropDownMaxHeight":case"showCustomNameList":i.rebuild();break;case"enableAddCustomName":case"enableNavigateToRange":case"addCustomNameCommand":case"navigateToRangeCommand":i.refresh()}},k.prototype.Zp=function(t){var e,t,e=this.options,t=t||{};t=s.extend(!0,{},N,t),s.each(t,function(t,n){e.hasOwnProperty(t)&&(e[t]=n)})},k.prototype.Mpt=function(){var t=this;t.wY&&t.wY.setNameList(t.Spt())},k.prototype.Spt=function(){var e=this.getCustomNameList(!0),e;return e=e.filter(function(t,n){return e.indexOf(t)===n}).sort(F)},k.prototype.ypt=function(){var t=this;t.Cpt&&(t.Cpt.close(),t.Cpt=e,t.wY=e)},k.prototype.Tpt=function(){var t,n,n,e,i,t=this;t.ypt(),n=T(l),n=new o.NameBoxList(n,t.Spt()),e=new r.PopupControl(n.getContainer(),t.Ti,{align:u.DropDownAlignment.Near,hostElement:t.vpt.getHost(),direction:u.DropDownDirection.Down,jue:t.vpt&&t.vpt.options.enableAccessibility}),i=+t.options.dropDownMaxHeight||N.dropDownMaxHeight,s(n.getContainer()).css(["width","maxHeight"],[s(t.Ti).width(),i+"px"]).addClass("gc-name-box-list"),e.open(),t.wY=n,t.Cpt=e},k.prototype.dpt=function(){var t,n,e,i,r,t=this,n=t.Ti;n.innerHTML="",(e=T(l)).classList.add(b+y),i=T(h),t.vpt&&t.vpt.options.enableAccessibility&&(i.setAttribute("aria-label",I().nameBox),i.setAttribute("role","combobox"),i.setAttribute("aria-expanded","false"),i.setAttribute("aria-autocomplete","list")),i.classList.add(b+w),t.options.showCustomNameList&&(r=T(l)).classList.add(b+M),e.appendChild(i),r&&e.appendChild(r),n.appendChild(e)},k.prototype.jf=function(t){var n;if(t=t||this.vpt)return(n=t.getActiveSheet())||void 0},k.prototype.Apt=function(){return i+(this._id||"")},k.prototype.v7=function(){var i,e,t,n,i=this,e=i.vpt,t=i.Ti,n=i.Apt();e.bind(u.Events.SelectionChanging+n,t,function(){var t,t,t,t,t=i.jf();t&&t.getSelections&&null!==(t=(t=t.getSelections())[t.length-1])&&t!==v&&(t=D(e,t),i.selector.val(t||""),i.cpt=t||"")}),e.bind(u.Events.InternalSelectionChanging+n,t,function(t,n){var n,n,n=n.newSelections;null!==n&&n!==v&&(n=D(e,n),i.selector.val(n||""),i.cpt=n||"")}),e.bind(u.Events.SelectionChanged+n,function(t,n){var e=i.Ipt();i.updateNameRangeSelectorValue(e,n.shiftKey)}),e.bind(u.Events.DragDropBlockCompleted+n,function(){i.updateNameRangeSelectorValue()}),e.bind(u.Events.ActiveSheetChanged+n,function(){i.updateNameRangeSelectorValue()}),e.bind(u.Events.FormulaTextboxActiveSheetChanged+n,function(){i.updateNameRangeSelectorValue()}),e.bind(u.Events.FormulaTextboxEnterCell+n,function(){i.updateNameRangeSelectorValue()}),e.bind(u.Events.ShapeSelectionChanged+n,function(){i.updateNameRangeSelectorValue()}),e.bind(u.Events.FloatingObjectSelectionChanged+n,function(){i.updateNameRangeSelectorValue()}),i.selector.bind("blur"+n,i.xpt.bind(i)),i.selector.bind("keydown"+n,i.Npt.bind(i)),i.selector.bind("focus"+n,function(){i.selector[0].select()}),i.dropdown.bind("mousedown"+n,i.kpt.bind(i))},k.prototype.wpt=function(){var t,n,e,t=this,n=t.vpt,e=t.Apt();n&&n.unbind(e),t.selector.unbind(e),t.dropdown.unbind(e),s(document).unbind(e)},k.prototype.updateNameRangeSelectorValue=function(t,n){var e,i,t,i,t,i,r,o,a,e=this;!C(t)&&e.selector?(e.selector.val(t||""),e.cpt=e.selector.val()):0<(i=(t=e.Dpt()).length)?(i=1===i?t[0].name():"",e.selector&&(e.selector.val(i),e.cpt=e.selector.val())):(t=e.Ipt(),C(t)?(r=(i=e.vpt).getActiveSheet())?null!==(o=r.getSelections()[r.getSelections().length-1])&&o!==v&&(a=void 0,a=n?D(i,o):E(i,r.getActiveRowIndex()+1,r.getActiveColumnIndex()+1,o),e.selector)&&(e.selector.val(a||""),e.cpt=e.selector.val()):e.selector.val(c):(e.selector.val(t),e.cpt=e.selector.val()))},k.prototype.Ipt=function(){var t,n,e,i,r,o,r,a,t=this,n,e=t.vpt.getActiveSheet(),i="";if(e)return r=e.getSelections(),o=e.name(),1===r.length?(i=R(O(r=r[0])),a="",_(r,e)&&(a=R(new u.Range(r.row,r.col,1,1))),t._pt(i)||t.Ept(i,a,o)):void 0},k.prototype.Ept=function(t,n,e){var i,r,o,a,u,s,c,c,r;if(t||n)for(a=0,u=o=(i=this).mpt().concat(i.gpt());a<u.length;a++)if((c=(r=(s=u[a]).WK)&&r.source)&&c instanceof f.SheetSource&&c.getName()===e&&(c=r.getRange(s.FY||0,s.jpt||0))&&(t===(r=R(c))||n===r))return s.getName()},k.prototype._pt=function(t){var n,e,i,r;if(t)for(e=0,i=n=this.ppt();e<i.length;e++)if(t===R((r=i[e]).range))return r.name},k.prototype.mpt=function(t,n){var e,i;return void 0===n&&(n=!1),e=this.vpt,i=[],(i=(t=t||e&&e.getActiveSheet()).getCustomNames()).filter(function(t){return j(t,e,n)})},k.prototype.gpt=function(n){var e,t;return void 0===n&&(n=!1),t=[],(t=(e=this.vpt)&&e.getCustomNames()).filter(function(t){return j(t,e,n)})},k.prototype.ppt=function(){for(var t,n,e,i,r,o,a,u,s,c,t,n,e=[],i=[],r=0,o=this.vpt.sheets;r<o.length;r++)a=o[r],i=i.concat(a.tables&&a.tables.all());for(u=0,s=i;u<s.length;u++)c=s[u],e.push({name:c.name(),range:c.dataRange()});return e},k.prototype.Dpt=function(){var n,t,e,n=[],t,e;return this.Opt().forEach(function(t){t.isSelected()&&n.push(t)}),n},k.prototype.Opt=function(t){var n,t,n,e,i,t,n=this.vpt,t=t||n.getActiveSheet();return t?(n=t.shapes&&t.shapes.all()||[],e=t.floatingObjects&&t.floatingObjects.all()||[],i=t.charts&&t.charts.all()||[],t=t.pictures&&t.pictures.all()||[],n.concat(i).concat(t).concat(e)):[]},k.prototype.Rpt=function(t){for(var n,e,i,r,n,e=this.Opt(),i=0;i<e.length;i++)if((r=e[i]).name()===t)return r},k.prototype.xpt=function(){var t,n,e,i,r,i,t=this,n=t.selector.val();if(!n||0<t.Dpt().length)t.Bpt(),t.updateNameRangeSelectorValue(n);else if(i=t.Rpt(n))t.Bpt(),i.isSelected(!0);else if(t.cpt.toLocaleUpperCase()!==n.toLocaleUpperCase()){i=(r=t.vpt).getActiveSheet();try{e=t.Lpt()}catch(t){if(t.message===p)return void i.jT(15,I().invalidName)}e&&e.sheetName?t.options.enableNavigateToRange&&0<e.ranges.length&&(t.Bpt(e.sheetName),t.executeCommand(t.navigateToRangeCommand,e.ranges,e.sheetName)):t.options.enableAddCustomName&&t.executeCommand(t.addCustomNameCommand)}},k.prototype.Npt=function(t){var n=this,e=n.selector.val();"Enter"===t.key&&(0<this.Dpt().length&&e&&this.Dpt()[0].name(e),t.currentTarget.blur(),n.vpt)&&n.vpt.focus(!0),t&&t.stopPropagation&&t.stopPropagation()},k.prototype.kpt=function(){var e=this;e.Tpt(),e.wY.on("ValueChangedEvent",function(t){var t,n,t=t.value;C(t)&&!t||(n=e.selector.val(),e.updateNameRangeSelectorValue(t),e.cpt=n,e.xpt()),e.ypt()})},k.prototype.Bpt=function(t){for(var n,e,t,i,r,o,a,n=this,e=n.vpt,t=e.getSheetFromName(t)||e.getActiveSheet(),i,r=0,o=n.Opt(t);r<o.length;r++)(a=o[r]).isSelected()&&a.isSelected(!1)},k.prototype.Lpt=function(){var t,n,e,i,r,o,a,u,s,e,e,t=this,n=t.selector.val(),i=t.vpt,r=i.getActiveSheet();if(G(n=n.replace(/, /g,",")))throw new Error(p);for(a={ranges:[],sheetName:""},u=0,s=o=n.split(",");u<s.length;u++)if(e=s[u],e=(0,f.formulaToRanges)(r,e,r.getActiveRowIndex(),r.getActiveColumnIndex()),C(e)||0===e.length){if(1<o.length)throw new Error(p)}else if(1===e.length){if(e=e[0],a.sheetName&&e.sheetName!==a.sheetName)throw new Error(p);if(!i.getSheetFromName(e.sheetName))throw new Error(p);a.ranges=a.ranges.concat(e.ranges),a.sheetName=e.sheetName}return a},t.NameBox=k,u.Workbook.ch("nameBox",{init:function(){u.Commands.fpt(this.commandManager()),this.curNameBoxId=0},onCultureChanged:function(){I()}}),s.extend(u.Workbook.prototype,{bpt:function(){var t=this.curNameBoxId+(new Date).getTime().toString();return this.curNameBoxId+=1,t}})},"./dist/plugins/namebox/namebox.ns.js":function(t,n,e){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.SR=void 0;var e=e("./dist/plugins/namebox/namebox.res.en.js");n.SR={en:e}},"./dist/plugins/namebox/namebox.res.en.js":function(t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.nameBox=n.invalidName=void 0,n.invalidName="You must enter a valid reference you want to go to, or type a valid name for the selection.",n.nameBox="Name Box"},"./dist/plugins/outlineColumn/outlineColumn-actions.js":function(t,n,e){"use strict";var i,s,a,e,d,r,o,u,c,f,l,h,v,m,g,p,b,y,w,M;function C(t,n,e,i){return T(t,n,e,i)}function S(t,n,e,i){t.ki(a.Events.OutlineColumnCheckStatusChanged,{sheet:t,sheetName:t.name(),row:n,col:e,status:i})}function T(t,n,e,i){var i,r,o,a,u,s,c,f,l,h,h,i=d(i)?t.getActiveColumnIndex():i;if(!t.outlineColumn.Un(i))return null;if(r=n?1:-1,o=t.getActiveRowIndex(),a=t.getSelections()[0].rowCount,s=!0,d(e))for(s=!(e={}),u=o;u<a+o;u++)0===u||(c=t.rowOutlines.getLevel(u),n&&(f=t.rowOutlines.getLevel(u-1))<c&&!e[u-1])||(l=c+r,h=t.outlineColumn.options(),(h=(d(h.maxLevel)?t.outlineColumn.Fpt():h).maxLevel)&&h<l+1)||l+1<0||(e[u]={row:u,original:c+1,current:l+1},s=!0);return s?e:null}function A(t,n,e,i){var r,o,a,u,r=T(t,n,e,i);if(r){for(a in o=d(i)?t.getActiveColumnIndex():i,t.outlineColumn.Xst(),t.suspendPaint(),r)s.Common.kh(r,a)&&(u=r[a],t.getCell(u.row,o).textIndent(u.current));t.resumePaint(),t.outlineColumn.$st()}}function I(t,n,e,i){var r,o,a,u,s,c,f,l,r=0,o=0,u=t.rowOutlines.getLevel(n);if(t.outlineColumn.mst.updateCheckStatus(n,i),null!==(s=n<=t.getRowCount()-2?t.rowOutlines.find(n+1,u+1):null)&&null!==i)for(c=s.start;c<s.end+1;c++)t.outlineColumn.mst.updateCheckStatus(c,i);for(s=t.rowOutlines.find(n,u);null!==s&&null!==s.parent;){if(0<s.start){for(r=s.start-1,o=t.rowOutlines.getLevel(r),t.outlineColumn.mst.updateCheckStatus(r,i),c=(a=t.rowOutlines.find(1+r,o+1)).start;c<a.end+1;c++)if((f=t.outlineColumn.mst.vst[c].checkBox.checkStatus)!==i){t.outlineColumn.mst.updateCheckStatus(r,l="number"==typeof f&&"number"==typeof i&&3);break}c===a.end+1&&!0===i&&t.outlineColumn.mst.updateCheckStatus(r,!0)}s=s.parent}}function x(t){var n=t.Mf,e=a.Commands.TI(n.name()),t=t.tT[e];n.Ut.undo(t)}function N(t,n){return b.call(this,t,n)||this}function k(t,n){return y.call(this,t,n)||this}function D(t,n){return w.call(this,t,n)||this}function _(t,n){return M.call(this,t,n)||this}i=this&&this.__extends||(p=function(t,n){return(p=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(t,n){t.__proto__=n}:function(t,n){for(var e in n)Object.prototype.hasOwnProperty.call(n,e)&&(t[e]=n[e])}))(t,n)},function(t,n){if("function"!=typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function e(){this.constructor=t}p(t,n),t.prototype=null===n?Object.create(n):(e.prototype=n.prototype,new e)}),Object.defineProperty(n,"__esModule",{value:!0}),n.setCheckStatus=n.outlineColumnCheckStatus=n.commands=void 0,s=e("Common"),a=e("Core"),Object.defineProperty(n,"commands",{enumerable:!0,get:function(){return a.Commands}}),e=a.Commands.ActionBase,d=s.Common.lt.ht,r="increaseCellIndent",o="decreaseCellIndent",u="updateOutlineColumnCheckStatus",c="updateOutlineColumnOption",n.outlineColumnCheckStatus=f="outlineColumnCheckStatus",l=a.Commands.zA,n.setCheckStatus=I,i(N,b=e),N.prototype.canExecute=function(){return!!C(this.Mf,!0,this.tT.changingRows,this.tT.changingColumns)},N.prototype.canUndo=function(){return!0},N.prototype.execute=function(){var t,n;return!!this.canExecute()&&((t=this.Mf).Ut.startTransaction(),t.outlineColumn.mst.Ppt(),A(this.Mf,!0,this.tT.changingRows,this.tT.changingColumns),n=a.Commands.TI(t.name()),this.tT[n]=t.Ut.endTransaction(),!0)},N.prototype.undo=function(){var t,n,e,t,t=this,n=t.Mf,e=a.Commands.TI(n.name()),t=t.tT[e];return n.Ut.undo(t),!0},h=N,i(k,y=e),k.prototype.canExecute=function(){return!!C(this.Mf,!1,this.tT.changingRows,this.tT.changingColumns)},k.prototype.canUndo=function(){return!0},k.prototype.execute=function(){var t,n;return!!this.canExecute()&&((t=this.Mf).Ut.startTransaction(),t.outlineColumn.mst.Ppt(),A(t,!1,this.tT.changingRows,this.tT.changingColumns),n=a.Commands.TI(t.name()),this.tT[n]=t.Ut.endTransaction(),!0)},k.prototype.undo=function(){return x(this),!0},v=k,i(D,w=e),D.prototype.canExecute=function(){return!0},D.prototype.canUndo=function(){return!0},D.prototype.execute=function(){var t,n,t,e,i,e,t=this,n=t.Mf,t=t.tT,e=t.options,i=JSON.parse(JSON.stringify(n.outlineColumn.NB));return n.Ut.startTransaction(),n.outlineColumn.NB=e,n.outlineColumn.refresh(),t[e=a.Commands.TI(n.name())]=n.Ut.endTransaction(),t[e].oldOptions=i,!0},D.prototype.undo=function(){return x(this),this.Mf.outlineColumn.refresh(),!0},m=D,i(_,M=e),_.prototype.canExecute=function(){return!0},_.prototype.canUndo=function(){return!0},_.prototype.execute=function(){var t,n,t,e,i,r,o,t=this,n=t.Mf,t=t.tT,e=t.row,i=t.col,r=t.status;return n.Ut.startTransaction(),I(n,e,i,r),n.outlineColumn.refresh(),t[o=a.Commands.TI(n.name())]=n.Ut.endTransaction(),S(n,e,i,r),!0},_.prototype.undo=function(){return x(this),this.Mf.outlineColumn.refresh(),!0},g=_,a.Commands[r]={canUndo:!0,execute:function(t,n,e){return n.cmd=r,l(t,h,n,e)}},a.Commands[o]={canUndo:!0,execute:function(t,n,e){return n.cmd=o,l(t,v,n,e)}},a.Commands[c]={canUndo:!0,execute:function(t,n,e){return n.cmd=c,l(t,m,n,e)}},a.Commands[u]={canUndo:!0,execute:function(t,n,e){return n.cmd=u,l(t,g,n,e)}},a.Commands.Gpt=function(t){var n=a.mt.Qf(),e=!n,n=n;t.register(r,a.Commands[r],221,e,!1,!0,n),t.register(o,a.Commands[o],219,e,!1,!0,n),t.register(u,a.Commands[u]),t.register(c,a.Commands[c])}},"./dist/plugins/outlineColumn/outlineColumn.entry.js":function(t,n,e){"use strict";var i,r,i=this&&this.__createBinding||(Object.create?function(t,n,e,i){void 0===i&&(i=e);var r=Object.getOwnPropertyDescriptor(n,e);r&&("get"in r?n.__esModule:!r.writable&&!r.configurable)||(r={enumerable:!0,get:function(){return n[e]}}),Object.defineProperty(t,i,r)}:function(t,n,e,i){t[i=void 0===i?e:i]=n[e]}),r=this&&this.__exportStar||function(t,n){for(var e in t)"default"===e||Object.prototype.hasOwnProperty.call(n,e)||i(n,t,e)};Object.defineProperty(n,"__esModule",{value:!0}),r(e("./dist/plugins/outlineColumn/outlineColumn.js"),n),r(e("./dist/plugins/outlineColumn/outlineColumn-actions.js"),n),r(e("./dist/plugins/outlineColumn/outlineColumn.ns.js"),n)},"./dist/plugins/outlineColumn/outlineColumn.js":function(B,t,n){"use strict";var u,e,i,n,r,o,s,a,f,l,h,m,g,c,p,d,v,b,y,w,M,C,r,S,T,A,I,L,F,P;function G(t){return t.expandIndicator||t.collapseIndicator}function x(t,n){return t&&t.outlineColumn&&t.outlineColumn.options()&&t.outlineColumn.options().columnIndex===n}function U(t,n,e){var i,r,o,a,i=n.x+e.x,r=e.y+e.height/2-n.height/2,o=n.height,a=n.width;e.x+e.width<i+a||(t.save(),t.beginPath(),t.strokeStyle="black",t.strokeRect(i,r,a,o),t.fillStyle="white",t.fillRect(i,r,a,o),3===n.checkStatus?(t.beginPath(),t.fillStyle="black",t.rect(i+a/5,r+o/5,a-.4*a,o-.4*o),t.fill()):!0!==n.checkStatus&&1!==n.checkStatus||(t.beginPath(),t.lineWidth=a/5,t.moveTo(i+a/6,r+o/2),t.lineTo(i+2*a/5,r+5/7*o),t.lineTo(i+5/6*a,r+o/6),t.stroke()),t.restore())}function H(t,n,e,i){var r,o,a,u,s,r=n.collapsed,o=n.x+e.x,a=e.y+e.height/2-n.height/2,u=n.height,s=n.width;e.x+e.width<o+s||(r?n.expandIndicator?N(t,n.expandIndicator,n,e,i):(t.save(),t.fillStyle="black",t.beginPath(),t.moveTo(o,a),t.lineTo(o,a+u),t.lineTo(o+s,a+u/2),t.fill(),t.restore()):n.collapseIndicator?N(t,n.collapseIndicator,n,e,i):(t.save(),t.fillStyle="black",t.beginPath(),t.moveTo(o,a+u),t.lineTo(o+s,a+u),t.lineTo(o+s,a),t.fill(),t.restore()))}function N(t,n,e,i,r){var o,a,u,e,s,o=e.x+i.x,a=i.y+i.height/2-e.height/2,u=e.width,e=e.height;if(!(i.x+i.width<o+u)&&n&&"none"!==n&&r)try{r.jt(n)?(s=r.Ot(n),t.drawImage(s,0,0,s.width,s.height,o,a,u,e)):r.Rt(n)}catch(t){}}function k(t,n,e,i){var t={sheet:t,sheetName:t.name(),isRowGroup:!0,index:n,level:e};return i&&(t.cancel=!1),t}function D(t,n,e){var i,r,i,o,i=t.options,r;i.isProtected&&!i.protectionOptions.allowOutlineRows?t.jT(u.InvalidOperationType.groupProtected,S().Exp_GROUP_PROTECTED):(i=t.rowOutlines.getLevel(n),h(e)&&(e=!t.rowOutlines.getCollapsed(n)),o=k(t,n+1,i+1,!0),t.ki(u.Events.RangeGroupStateChanging,o),o&&!1===o.cancel&&(t.Qy().execute({cmd:"expandRowOutline",sheetName:t.name(),index:n,level:i+1,collapsed:e}),t.ki(u.Events.RangeGroupStateChanged,k(t,n+1,i+1,!1))))}function _(t,n,e,i){var e,n,n={cmd:"updateOutlineColumnCheckStatus",row:n,col:e,status:i=h(i)?typeof(e=t.outlineColumn.getCheckStatus(n))===M?1===e?2:1:!e:i,sheetName:t.name()};t.Qy().execute(n)}function z(t,n,e){var i,r,o,a,i=t.getLevel(n);if(e!==i+1)for(r=e-(i+1),o=0,a=Math.abs(r);o<a;o++)0<r?t.group(n,1):t.ungroupRange(n,1)}function V(t,n,e,i,r,o,a){var u,s,c,f,l,h,d,v,e,u;E(e,"showIndicator")?(s=t.zoom(),c=t.getRowCount(),f=!!t.rowOutlines.isCollapsed(n+1),l=m*s,h=g*s,v=d=null,e.expandIndicator&&(d=e.expandIndicator,f)&&(l=b*s,h=y*s),e.collapseIndicator&&(v=e.collapseIndicator,f||(l=b*s,h=y*s)),n<c-1&&((e=t.getActualStyle(n+1,i))&&e.textIndent>r?a.indicator={x:o.value+p*s,y:-h/2,width:l,height:h,collapsed:f,collapseIndicator:v,expandIndicator:d}:delete a.indicator),o.value+=2*p*s+l):delete a.indicator}function E(t,n){return(h(t[n])?T:t)[n]}function j(t,n,e){for(var i,r,o,a,u,i=-1,r=0,o=t.children,a=t.start;a<=t.end;a++)if(u=void 0,o&&o[r]&&o[r].start-1===a?(u=j(o[r],n,e),a=o[r].end,r++):u=n[a]&&n[a].checkBox&&n[a].checkBox.checkStatus,-1===i)i=u;else if(i!==u){i=typeof u===M&&typeof i===M&&3;break}for(;r<t.children.length;r++)j(o[r],n,e);return e.updateCheckStatus(t.start-1,i),i}function Y(t){var n,e,t,n=t.rowOutlines,e=t.outlineColumn.mst,t=n.find(0,-1);t.children&&t.children.forEach(function(t){j(t,e.vst,e)})}function Z(t,n,e,i,r,o){var a,e,t,a;(h(e.showCheckBox)?T:e).showCheckBox?(e=!h(o.checkBox)&&1!==o.checkBox&&o.checkBox.checkStatus,t=t.zoom(),o.checkBox={x:r.value+p*t,y:-c*t,width:2*c*t,height:2*c*t,checkStatus:e},r.value+=2*p*t+2*c*t):delete o.checkBox}function W(t,n,e,i,r){var o,e,t,e,n,a,o;(h(e.showImage)?T:e).showImage?(e=e.images,t=t.zoom(),e&&e.length&&(e=n>e.length-1?e[e.length-1]:e[n],n=i.value+p*t,r.images={image:e,x:n,y:a=0,width:d*t,height:v*t},i.value+=2*p*t+d*t)):delete r.images}function Q(t,n,e){var i,r,o,a,u,u,i=t.outlineColumn.options(),r=i&&i.columnIndex;h(r)||(o={value:0},a=0,(u=t.getActualStyle(n,r))&&u.textIndent&&(a=u.textIndent),0!==n&&3<=a-(u=t.rowOutlines.getLevel(n-1))&&(a=u+2),o.value+=8*a,z(t.rowOutlines,n,a),V(t,n,i,r,a,o,e),Z(t,n,i,r,o,e),W(t,a,i,o,e),e.cellContent={left:o.value,x:o.value,y:0,width:-o.value,height:0})}function O(t){this.Mf=t,this.NB={},this.Upt=0}function R(t){var n=this;n.Mf=t,n.vst={}}function J(t,n){var e,i,r,o,a,u,s;function c(t,n){var e;return T[t]===n}if(e=t.NB,i=t.mst.vst,!h(e)){if(r={},f(T,function(t){o=e[t],h(o)||c(t,o)||(r[t]=o)}),a={},e.showCheckBox)for(u in i)i.hasOwnProperty(u)&&(s=i[u].checkBox.checkStatus)&&(a[u]={checked:s});l(a)||(r.data=a),n.outlineColumnOptions=r}}function K(t,n){var e,i,r;if(n){if(i=void 0,e=n.data){for(r in i={},n)"data"!==r&&(i[r]=n[r]);t.Hpt(e)}t.options(h(i)?n:i),t.refresh()}}Object.defineProperty(t,"__esModule",{value:!0}),t.OutlineColumn=void 0,u=n("Core"),e=n("Common"),i=n("./dist/plugins/outlineColumn/outlineColumn-actions.js"),n=n("./dist/plugins/outlineColumn/outlineColumn.ns.js"),r=e.Common.Uf,o=r.tR,s=e.Common.J8,a=e.Common.X8,f=u.GC$.each,l=u.GC$.isEmptyObject,h=e.Common.lt.ht,m=5,c=g=6,p=3,y=b=v=d=16,w=void 0,M="number",C=null,r=new e.Common.ResourceManager(n.SR,"OutlineColumn"),S=r.getResource.bind(r),T={columnIndex:w,showCheckBox:!1,showImage:!1,images:w,showIndicator:!0,expandIndicator:w,collapseIndicator:w,maxLevel:10},O.prototype.L0=function(){var t=this;t.Mf=C,t.mst=C,t.NB=C},O.prototype.a7=function(t,n){return this.NB&&this.NB.columnIndex===n?this.mst.vst[t].cellContent.left:null},O.prototype.options=function(t){var n,e,n=this,e=n.NB;return o(arguments)?(n.NB=t,n.refresh(),n):e},O.prototype.refresh=function(){var t=this.Mf;h(this.NB)||h(this.NB.columnIndex)||0===this.Upt&&(t.suspendPaint(),t.outlineColumn.mst.updateModel(),t.resumePaint())},O.prototype.setCheckStatus=function(t,n){var e=this.NB.columnIndex;h(e)||_(this.Mf,t,e,n)},O.prototype.dst=function(t){this.Mf.outlineColumn.mst.setAllTiemCheckStatus(t),this.refresh()},O.prototype.getCheckStatus=function(t){var n,e;if(o(arguments))return this.Mf.outlineColumn.mst.getCheckStatus(t);for(n=[],e=this.Mf.getRowCount(),t=0;t<e;t++)n[t]=this.Mf.outlineColumn.mst.getCheckStatus(t);return n},O.prototype.setCollapsed=function(t,n){D(this.Mf,t,n)},O.prototype.getCollapsed=function(t){var n,e;if(o(arguments))return this.Mf.outlineColumn.mst.getCollapsed(t);for(n=[],e=this.Mf.getRowCount(),t=0;t<e;t++)n[t]=this.Mf.outlineColumn.mst.getCollapsed(t);return n},O.prototype.reset=function(){var t;h(this.NB)||h(this.NB.columnIndex)||(t=this.Mf,this.NB=T,t.suspendPaint(),t.outlineColumn.mst.updateModel(),t.resumePaint())},O.prototype.Un=function(t){return this.NB&&this.NB.columnIndex===t},O.prototype.xB=function(){return this.NB&&!h(this.NB.columnIndex)},O.prototype.Xst=function(){this.Upt++},O.prototype.$st=function(){0<this.Upt&&this.Upt--,0===this.Upt&&this.refresh()},O.prototype.zpt=function(t,n){this.Mf.outlineColumn.mst.insertRows(t,n)},O.prototype.yE=function(t,n){this.Mf.outlineColumn.mst.deleteRows(t,n)},O.prototype.Fpt=function(){return T},O.prototype.Vpt=function(){return{TRIANGLE_HEIGHT:m,TRIANGLE_BASE:g,CHECKBOX_RADIUS:c,GAP:p,IMAGE_WIDTH:d,IMAGE_HEIGHT:v,INDICATOR_IMAGE_WIDTH:b,INDICATOR_IMAGE_HEIGHT:y}},O.prototype.Hpt=function(t){var n,e,i,n=this;for(e in t)t.hasOwnProperty(e)&&((i=n.mst.vst[e]=n.mst.vst[e]||{}).checkBox={checkStatus:t[e].checked})},O.prototype.ect=function(t,n){var e=this.NB.columnIndex;h(e)||(0,i.setCheckStatus)(this.Mf,t,e,n)},O.prototype.ost=function(){return this.mst.vst},A=O,t.OutlineColumn=A,R.prototype.L0=function(){this.Mf=C},R.prototype.updateIndicatorCollapsed=function(t,n){var e=this;h(e.vst[t])||h(e.vst[t].indicator)||(e.vst[t].indicator.collapsed=n)},R.prototype.updateCheckStatus=function(t,n){var e,i,e=this;e.Ppt(t),h(e.vst[t])||((i=e.vst[t].checkBox)&&(i.checkStatus=n),e.Ppt(t,!0))},R.prototype.setAllTiemCheckStatus=function(t){var n,e,i,r,n,e=this.vst;for(i in e)e.hasOwnProperty(i)&&(r=e[i].checkBox)&&(r.checkStatus=t)},R.prototype.getCheckStatus=function(t){var n=this;return h(n.vst[t])||h(n.vst[t].checkBox)?null:n.vst[t].checkBox.checkStatus},R.prototype.getCollapsed=function(t){var n=this;return!h(n.vst[t])&&!h(n.vst[t].indicator)&&n.vst[t].indicator.collapsed},R.prototype.updateModel=function(){var t,n,e,i,r,o,r,a,t=this,n=t.Mf,e=n.getRowCount();for(n.rowOutlines.direction(0),i=0;i<e;i++)t.vst[i]=t.vst[i]||{},Q(n,i,t.vst[i]);r=n.outlineColumn.options(),(o=(h(r.showCheckBox)?T:r).showCheckBox)&&Y(n),(r=n.NMi)&&r.options.allowAddNew&&delete t.vst[a=e-1]},R.prototype.insertRows=function(t,n){var e=this;e.Ypt(t,n),e.Zpt(t,n)},R.prototype.Ypt=function(t,n){var e,i,i,r,o,e=this.Mf,i=e.outlineColumn.options();h(i)||(i=i.columnIndex,h(i))||(o=0,(r=e.getActualStyle(t-1,i))&&r.textIndent&&(o=r.textIndent),e.getRange(t,i,n,1).textIndent(o))},R.prototype.Zpt=function(t,n){var e,i,r,o,r,a,e=this,i=e.vst,r=i[t-1],o=r&&r.checkBox,r=e.Mf.getRowCount();for(s(i,r,t,n),a=0;a<n;a++)i[t+a]={checkBox:{checkStatus:o&&o.checkStatus}}},R.prototype.deleteRows=function(t,n){this.Wpt(t,n)},R.prototype.Wpt=function(t,n){var e,i,e,e=this,i=e.vst,e=e.Mf.getRowCount();a(i,e,t-1,n)},R.prototype.Qpt=function(t,n){var e,e,e=this.vst[n];e&&!t[n]&&(e=e.checkBox,t[n]={checked:e&&e.checkStatus})},R.prototype.Kpt=function(t){var n,e,i,n=this,e=this.vst;for(i in e)e.hasOwnProperty(i)&&n.Qpt(t,i)},R.prototype.Jpt=function(t){var n,e,n=this.vst;for(e in t)h(t[e].checked)||(n[e].checkBox.checkStatus=t[e].checked)},R.prototype.Xpt=function(t){var n=this.Mf.Ut.G8;return n?(n.outlineColumnChanges||(n.outlineColumnChanges={items:{}}),n.currentOutlineColumnChanges||(n.currentOutlineColumnChanges={items:{}}),t?n.currentOutlineColumnChanges:n.outlineColumnChanges):w},R.prototype.Ppt=function(t,n){var e=this,n=e.Xpt(n);n&&!n.all&&(h(t)?(n.all=!0,e.Kpt(n.items)):e.Qpt(n.items,t))},R.prototype.qpt=function(t){this.Jpt(t.items)},I=R,u.GC$.extend(u.Y8.prototype,{qpt:function(t){var n=this,e=n.$pt,i=e.mst;e.xB()&&(i.updateModel(),t&&i.qpt(t),n.Mf.zw())}}),u.Y8.ch("outlineColumn",{init:function(){var t=this,n=t.Mf;t.$pt=new A(n),t.$pt.mst=new I(n)},applyChanges:function(t){var n,t,e,e,n=t.changes,t=t.isUndo;n&&((e=n.outlineColumnOption)&&this.$pt.options(t?e.oldValue:e.value),e=t?n.outlineColumnChanges:n.currentOutlineColumnChanges)&&this.qpt(e)},undo:function(t){var n=t.outlineColumnChanges;n&&!t.oldOptions&&this.qpt(n)},dispose:function(t){var n=this,e;!1!==(t&&t.clearCache)&&n.$pt&&(n.$pt.mst&&(n.$pt.mst.L0(),n.$pt.mst=C),n.$pt.L0(),n.$pt=C)}}),u.Worksheet.ch("outlineColumn",L={init:function(){var t=this;t.outlineColumn=t.Ut.$pt},dispose:function(t){var t,n;!1!==t.clearCache&&(n=(t=this).outlineColumn)&&(n.L0(),t.outlineColumn=C)},toJson:function(t){J(this.outlineColumn,t)},fromJson:function(t){K(this.outlineColumn,t.outlineColumnOptions)},wh:function(t){t.lossless||(t.lossless={}),J(this.outlineColumn,t.lossless)},yh:function(t){K(this.outlineColumn,t&&t.lossless&&t.lossless.outlineColumnOptions)},onLayoutChanged:function(t){var n,e,i,r,o,t,t,a,u,n=this,e=n.outlineColumn,i=t.changeType,r=t.row,o=t.rowCount,t=t.sheetArea,t=h(t)||3===t;if("addRows"===i&&t)e.mst.Ppt(),e.zpt(r,o),e.mst.Ppt(null,!0),e.refresh();else if("deleteRows"===i&&t)e.mst.Ppt(),e.yE(r,o),e.mst.Ppt(null,!0),e.refresh();else if("zoomSheet"===i)e.refresh();else if("invalidateLayout"===i&&e.mst.vst&&!l(e.mst.vst)&&n.rowOutlines.items&&!l(n.rowOutlines.items))for(u in a=n.rowOutlines.items)a.hasOwnProperty(u)&&e.mst.updateIndicatorCollapsed(parseInt(u,10),n.rowOutlines.isCollapsed(parseInt(u,10)+1))},sortRangeChanged:function(t){for(var n,e,i,r,n=this.outlineColumn,e=t.column,i=t.columnCount,r=e;n.Un(r)&&r<=e+i;)n.refresh(),r+=1}}),u.CellTypes.Base.ch("outlineColumn",F={paintCellPadding:function(t){var n,e,i,r,o,a,o,n=t.options.rect,e=t.options.context.sheet,i=t.options.context,r=i.row,o=i.col,a=t.ctx;x(e,o)&&0<n.width&&0<n.height&&(t.options.context.sheetArea!==u.SheetArea.colHeader||!e.NMi)&&(o=e.outlineColumn.mst.vst[r])&&(a.save(),o.indicator&&H(a,o.indicator,n,i.imageLoader),o.checkBox&&U(a,o.checkBox,n),o.images&&N(a,o.images.image,o.images,n,i.imageLoader),a.restore(),o.cellContent)&&(n.x+=o.cellContent.left,n.width-=o.cellContent.left)},getCellPaddingRect:function(t){var n,e,t,i,r,t,n=t.options.rect,e=t.options.context.sheet,t=t.options.context,i=t.row,r;x(e,t.col)&&0<n.width&&0<n.height&&(t=e.outlineColumn.mst.vst[i])&&t.cellContent&&(n.x+=t.cellContent.left,n.width-=t.cellContent.left)},getCellPaddingHitInfo:function(t){var n,e,i,r,o,a,u,s,c,u,f,n=t.context.sheet,e=t.context.col,i=t.context.row,r=t.x,o=t.y,a=t.cellRect,u=n.outlineColumn;if(t.paddingHitInfo=null,u&&u.NB){for(s=u.mst.vst[i],c=u.NB.columnIndex,a=a.clone();c<e;)a.x-=n.getColumnWidth(--e);s&&e===c&&(f=u=void 0,s.indicator&&(u=s.indicator.x,(f=s.indicator.x+a.x)<=r)&&r<f+s.indicator.width&&(t.paddingHitInfo={x:r,y:o,row:i,col:e,outlineColumnHitInfo:{indicator:!0}}),s.checkBox&&(u=u||s.checkBox.x,(f=s.checkBox.x+a.x)<=r)&&r<f+s.checkBox.width&&(t.paddingHitInfo={x:r,y:o,row:i,col:e,outlineColumnHitInfo:{checkBox:!0}}),s.images&&(u=u||s.images.x,(f=s.images.x+a.x)<=r)&&r<f+s.images.width&&(t.paddingHitInfo={x:r,y:o,row:i,col:e,outlineColumnHitInfo:{image:!0}}),u)&&r>=a.x&&r<a.x+u&&(t.paddingHitInfo={x:r,y:o,row:i,col:e,outlineColumnHitInfo:{blank:!0}})}},processMouseDownOnCellPadding:function(t){var n,e,i,t,n=t.sheet,e=t.row,i=t.col,t=t.outlineColumnHitInfo;h(t)||(t.indicator?D(n,e):t.checkBox?_(n,e,i):t.image||t.blank)},getOutlineColumnOffset:function(t){var n,e,n,n=t.context.sheet,e;x(n,t.context.col)&&(E(n=n.outlineColumn.options(),"showIndicator")&&(t.value+=p,G(n)?t.value+=b:t.value+=m,t.value+=p),E(n,"showCheckBox")&&(t.value+=p,t.value+=2*c,t.value+=p),E(n,"showImage"))&&(t.value+=p,t.value+=d,t.value+=p)}}),u.Workbook.ch("outlineColumn",P={init:function(){i.commands.Gpt(this.commandManager())},onCultureChanged:function(){S()}})},"./dist/plugins/outlineColumn/outlineColumn.ns.js":function(t,n,e){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.SR=void 0;var e=e("./dist/plugins/outlineColumn/outlineColumn.res.en.js");n.SR={en:e}},"./dist/plugins/outlineColumn/outlineColumn.res.en.js":function(t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.Exp_GROUP_PROTECTED=void 0,n.Exp_GROUP_PROTECTED="You can not use this command on a protected sheet. To use this command, you must first unprotect sheet."},"./dist/plugins/search/search.entry.js":function(t,n,e){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.SearchFoundFlags=n.SearchOrder=n.SearchFlags=n.SearchCondition=n.SearchResult=void 0;var i=e("./dist/plugins/search/search.js");Object.defineProperty(n,"SearchResult",{enumerable:!0,get:function(){return i.SearchResult}}),Object.defineProperty(n,"SearchCondition",{enumerable:!0,get:function(){return i.SearchCondition}}),Object.defineProperty(n,"SearchFlags",{enumerable:!0,get:function(){return i.SearchFlags}}),Object.defineProperty(n,"SearchOrder",{enumerable:!0,get:function(){return i.SearchOrder}}),Object.defineProperty(n,"SearchFoundFlags",{enumerable:!0,get:function(){return i.SearchFoundFlags}})},"./dist/plugins/search/search.js":function(t,n,e){"use strict";var b,i,e,y,u,w,M,C,r,S,o,a,s,e,i,e;function T(t,n,e){var i,r,o,a;return t&&(t=t.toString(),n=n.toString(),0===e?-1<t.indexOf(n):(i=0<(2&e),r=0<(1&e),0<(4&e)?(n=(a=i?u.tbt(n,!1,!0):u.jJ(n))||n,(a=r?u.OJ(n):u.qT(n)).test(t)):(r&&(n=n.toLowerCase(),t=t.toLowerCase()),i?n===t:0<=t.indexOf(n))))}function A(t,n,e,i,r,o,a,u){var s=w,c=t+1,f=n+1;return 0===e?0<=f&&f<=u?s={r:t,c:f}:0<=c&&c<=o&&(s={r:c,c:i?a:0}):c<=o?s={r:c,c:n}:f<=u&&(s={r:i?r:0,c:f}),s}function c(){this.startSheetIndex=-1,this.endSheetIndex=-1,this.searchString=w,this.searchFlags=0,this.searchOrder=0,this.searchTarget=1,this.sheetArea=3,this.rowStart=-1,this.columnStart=-1,this.rowEnd=-1,this.columnEnd=-1,this.findBeginRow=-1,this.findBeginColumn=-1}function f(){this.foundColumnIndex=-1,this.foundRowIndex=-1,this.searchFoundFlag=0,this.foundSheetIndex=-1,this.foundString=w}Object.defineProperty(n,"__esModule",{value:!0}),n.SearchFoundFlags=n.SearchOrder=n.SearchFlags=n.SearchResult=n.SearchCondition=void 0,b=e("Core"),i=e("Common"),e=e("CalcEngine"),y=!!e,u=i.Common.$T,w=null,M=Math.max,C="string",b.Worksheet.prototype.search=function(t){var n,e,i,r,o,a,u,s,c,f,l,h,d,a,u,v,m,g,p,g;if(!t)return w;if(e=t.sheetArea,i=t.searchString,r=t.searchTarget,o=t.searchFlags,a=(n=this).getRowCount(e),u=n.getColumnCount(e),s=new S,i&&0!==r&&!(a<=0&&u<=0))for(c=M(0,t.rowStart),f=M(0,t.columnStart),d=0<(8&o),((l=t.rowEnd)<0||!d)&&(l=a-1),((h=t.columnEnd)<0||!d)&&(h=u-1),v=(a=t.findBeginRow)<0?c:a,m=(u=t.findBeginColumn)<0?f:u;0<=v&&0<=m;){if(g=n.getCell(v,m,e),p=void 0,0<(1&r)&&""!==(p=t.callback?t.callback(g,n):g.text())&&T(p,i,o)&&(s.searchFoundFlag|=1,s.foundString=p),y&&0<(8&r)&&typeof(p=b.util.f0(n,v,m))==C&&""!==p&&T(p,i,o)&&(s.searchFoundFlag|=8,s.foundString=p),0<(4&r)&&typeof(p=g.tag())==C&&""!==p&&T(p,i,o)&&(s.searchFoundFlag|=4,s.foundString=p),0!==s.searchFoundFlag)return s.foundRowIndex=v,s.foundColumnIndex=m,s;if(!(g=A(v,m,t.searchOrder,d,c,l,f,h)))break;v=g.r,m=g.c}return s},b.Workbook.prototype.search=function(t){var n,e,i,r,o,a,a,u,s;if(!t)return w;if(e=0,i=(n=this).getSheetCount(),r=new S,t.searchString&&0!==t.searchTarget&&!(i<=0)&&(-1===t.startSheetIndex&&(t.startSheetIndex=0),-1===t.endSheetIndex&&(t.endSheetIndex=i-1),(u=t.startSheetIndex)<=(s=t.endSheetIndex))&&0<=u&&u<i&&0<=s&&s<i)for(o=u;o<=s;o++)if((a=n.getSheet(o)).visible()===b.SheetTabVisible.visible&&(a=a.search(t))&&0!==a.searchFoundFlag)return a.foundSheetIndex=o,a;return r},n.SearchCondition=c,S=f,n.SearchResult=S,(e=o=n.SearchFlags||(n.SearchFlags={}))[e.none=0]="none",e[e.ignoreCase=1]="ignoreCase",e[e.exactMatch=2]="exactMatch",e[e.useWildCards=4]="useWildCards",e[e.blockRange=8]="blockRange",(i=a=n.SearchOrder||(n.SearchOrder={}))[i.zOrder=0]="zOrder",i[i.nOrder=1]="nOrder",(e=s=n.SearchFoundFlags||(n.SearchFoundFlags={}))[e.none=0]="none",e[e.cellText=1]="cellText",e[e.cellTag=4]="cellTag",e[e.cellFormula=8]="cellFormula"},"./dist/plugins/sheetsCalc/calc-extra-save.js":function(t,n,e){"use strict";var s,u,r,i,c,f,l,h,d,v,m;function o(t){var n,e,i,r;if(Array.from)return Array.from(t.keys());for(n=[],e=0,i=t.keys();e<i.length;e++)r=i[e],n.push(r);return n}function a(o,a,u){for(var t,n,t=function(t){var n,t,r,e,i,n=a[t];if(n.l)for(t=g(n.k),r=o.oT(t[1],t[2],!0),n.v&&o.nbt(r),n.b,r.aT=n.l.map(function(t){return parseInt(t,10)}),e=function(t){var i=n.l[t];r[i]=(0,s.createMap)(),n[i].map(function(t){var n,e,e,n=g(t),e=n[0];"?"!==e[0]&&"!"!==e[0]||(e=e.slice(1)),e=u[e],r[i].set(t,e.oT(n[1],n[2],!0))})},i=0;i<n.l.length;i++)e(i)},n=0;n<a.length;n++)t(n)}function g(t){return t.split(",").map(function(t,n){return t=0<n?parseInt(t,10):t})}function p(t,n,e){var i,r,o,a,u,s,c,f,l,f,i=t.uT(!0);for(r in n.l)if(n.l.hasOwnProperty(r))for(a in o=n[r])if(o.hasOwnProperty(a))for(u=a.split(",").map(function(t,n){return"?"!==t[0]&&"!"!==t[0]||(t=t.slice(1)),parseInt(t,10)}),s=0;s<o[a].length;s++)f=(l=e[f="?"!==(f=(c=g(o[a][s]))[0])[0]&&"!"!==f[0]?f:f.slice(1)]).oT(c[1],c[2],!0),i.processListener(parseInt(r,10),u[0],u[1],u[2],u[3],f,!0)}function b(t){var n,e,n=null;return(t.isVolatile||t.ebt||t.aT&&0<t.aT.length)&&((n={}).k=t.getKey(),t.isVolatile&&(n.v=!0),t.ebt&&(n.b=!0),t.aT)&&t[0]&&(e="0",n[0]=o(t[0]),n.l=t.aT),n}function y(t){var n,e,i,r,o,a,i,t,n=[],e=t.dataTable;for(o in e)if(e.hasOwnProperty(o)&&(a=e[o]))for(r in a)a.hasOwnProperty(r)&&(i=a[r])&&(i=b(i.calc))&&n.push(i);return(t=w(t))&&n.push(t),n}function w(t){var t,n,e,i,r,t=t.uT();if(t)return n={k:"rangeCalc"},e="0",i=t[0],r={},i&&i.forEach(function(t,n){r[n]=o(t.content)}),n[0]=r,n.l=t.aT,n}function M(t,n){var e,i,r,o,a,u,e={};if(n&&n.idMap){for(o in r={},i=t.rO)i.hasOwnProperty(o)&&(r[i[o].getSource().getName()]=i[o]);for(o in a=n.idMap)a.hasOwnProperty(o)&&(u=a[o],e[o]=r[u])}return e}function C(t){var n,e,i,n=t.rO,e={};for(i in n)n.hasOwnProperty(i)&&(e[i]=n[i].getSource().getName());return e}function S(t,n){return T(t,n)}function T(t,n){var e,i,r,o,a,e,e,i=t.t;if(4===i||2===i||3===i||8===i||100===i)(r=new s.Expression(i)).value=t.v;else{if(5===i)(r=new s.Expression(5)).value=s.CalcError.ibt(t.v);else if(6===i)(r=new s.Expression(6)).value=new s.CalcArray(t.v);else if(9===i)r=(0,s.rbt)(t.o,T(t.v,n),t.w&&T(t.w,n));else if(10===i)(r=new s.Expression(10)).value=T(t.v,n);else if(11===i)r=new s.Expression(11);else if(7===i)for(r=new s.Expression(7),t.f&&(r.function=T(t,n)),t.n&&(r.function=n.getFunction(t.n),r.functionName=t.n),o=r.arguments=[],a=0;a<t.p.length;a++)t.p[a]&&(o[a]=T(t.p[a],n));else 1===i?(r=new s.ReferenceExpression(1),(e=t.v.split("*"))[0]&&(r.source=n.getExternalSource("",e[0])),e[1]&&(r.endSource=n.getExternalSource("",e[1])),e[2]&&(r.row=parseInt(e[2],10)),e[3]&&(r.column=parseInt(e[3],10)),e[4]&&(r.endRow=parseInt(e[4],10)),e[5]&&(r.endColumn=parseInt(e[5],10)),e=parseInt(e[6],10),r.rowRelative=!!(e&c),r.columnRelative=!!(e&f),r.endRowRelative=!!(e&l),r.endColumnRelative=!!(e&h),r.isFullRow=!!(e&d),r.isFullColumn=!!(e&v),r.isArrayReference=!!(e&m),r.isFullRow&&(r.column=r.endColumn=s.BAND_INDEX_CONST),r.isFullColumn&&(r.row=r.endRow=s.BAND_INDEX_CONST)):13===i?(r=new u.obt,e=t.v,r.abt=e[0],r.source=e[1],r.ubt=e[2],r.sbt=e[3],r.cbt=e[4],r.fbt=e[5],r.lbt=e[6],r.hbt=e[7],r.source=n.getExternalSource("",r.source),r.abt=n.getTableByName(r.abt)):r.type;t.es&&(r.ensureSingle=!0)}return r}function A(t){return I(t)}function I(t){var n,e,i,i;if(!t)return t;if(n={t:t.type},t.ensureSingle&&(n.es=1),4===t.type||2===t.type||3===t.type||8===t.type||100===t.type)n.v=t.value;else if(5===t.type)n.v=t.value._code;else if(6===t.type)n.v=t.value.array;else if(9===t.type)n.o=t.operatorType,n.v=I(t.value),n.w=t.value2&&I(t.value2);else if(10===t.type)n.v=I(t.value);else if(7===t.type)for((0,s.isExpression)(t.function)?n.f=I(t.function):t.functionName&&(n.n=t.functionName),n.p=[],e=0;e<t.arguments.length;e++)n.p[e]=I(t.arguments[e]);else 1===t.type?(i=(t.rowRelative&&c)|(t.columnRelative&&f)|(t.endRowRelative&&l)|(t.endColumnRelative&&h)|(t.isFullRow&&d)|(t.isFullColumn&&v)|(t.isArrayReference&&m),i=[t.source&&t.source.getName(),t.endSource&&t.endSource.getName(),t.row,t.column,t.endRow,t.endColumn,i],t.isFullRow&&(i[3]=i[5]=r),t.isFullColumn&&(i[2]=i[4]=r),n.v=i.join("*")):13===t.type?n.v=[t.abt.name(),t.source.getName(),t.ubt,t.sbt,t.cbt,t.fbt,t.lbt,t.hbt]:t.type;return n}Object.defineProperty(n,"__esModule",{value:!0}),n.exprToJSON=n.exprFromJSON=n.dbt=n.vbt=n.mbt=n.gbt=n.pbt=void 0,s=e("CalcEngine"),u=e("./dist/plugins/sheetsCalc/parser-sheets.js"),r=null,i=void 0,c=1,f=2,l=4,h=8,d=16,v=32,m=64,n.pbt=a,n.gbt=p,n.mbt=y,n.vbt=M,n.dbt=C,n.exprFromJSON=S,n.exprToJSON=A},"./dist/plugins/sheetsCalc/calc-spreadjs.js":function(A,t,n){"use strict";var e,B,i,y,b,L,g,Z,R,s,w,F,P,G,U,H,W,M,z,Q,V,J,K,I,C,x,N,k,D,n,n,r,_,u,c,f,E,j,O,o,r,X,a,l,h,q;function $(t){var n="_xlfn.";return t&&"string"==typeof t&&0<=t.toLowerCase().indexOf(n)?t.replace(/_xlfn\.|_xlws\./gi,""):t}function tt(t){if(t)return t.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;")}function d(t,n,e,i,r){var o=this;o.Zc=t,o.FY=e,o.jpt=i,o.WK=n,z(r)||(o.TZ=r)}function v(t,n,e,i,r,o,a){var t,i,t=X.call(this,t,i,r,o,a)||this,i=t;return i.bbt=n,i.ybt=e,t}function nt(t){var n=a.call(this,P)||this;return n.references=t,n}function et(t){var n,e,i,r,o,a;if(!(t<0||(n=c[t]))){for(e=t,r=(i="").length,t+=1;0<t;t=Math.floor((t-1)/26))o=i.substring(0,r),a=i.substring(r),i=o+String.fromCharCode(65+(t-1)%26)+a;n=i.toString(),c[e]=n}}function m(t,n,e,i){var r,n,o,a;for(void 0===i&&(i={}),r=l.call(this,t&&t.Uw(i.sheetArea),n,e,i)||this,t||(t=m.wbt=m.wbt||new B.Worksheet,r.source)||(r.source=t.Uw(i.sheetArea)),r.Mf=t,r.row=e&&e.row||0,r.column=e&&e.col||0,o=(n=t.getCalcService()).getResolvers(),a=0;a<o.length;a++)if(o[a]instanceof b.SheetReferenceResolver)return r;return n.addResolver(new b.SheetReferenceResolver(t)),n.addResolver(new b.StructureReferenceResolver(t)),r}function it(t){t.indexOf("LET(")}function p(t,n){var e=h.call(this,P)||this;return e.getCalcSourceModel=function(){return this.Mbt},e.createSourceModel=function(t){return new L.CalcSourceModel(t,this)},e.getRangeKey=function(t,n){return t.id+","+n.row+","+n.col+","+n.rowCount+","+n.colCount},e.getSheetRangeReference=function(t){var n,n,e,i,r,o,a,n=this.Mf,n=n&&n.parent;if(t.endSource&&n&&n.sheets&&t.endSource instanceof p){for(e=n.sheets,i=!1,r=void 0,o=[],a=0;a<e.length;a++){if((r=e[a].Uw())===this)i=!0;else if(r===t.endSource){o.push(r.getReference(t));break}i&&o.push(r.getReference(t))}return new u(o)}},e.Mf=t,e.nT=n||3,e}function S(t){var n=q.call(this,P)||this;return n.createSourceModel=function(t){return new L.CalcSourceModel(t,this)},n.vpt=t,n.Cbt={},n}function rt(t,n,e,i,r,o){var t,a,t,t=t&&t instanceof B.Worksheet&&t,a=new L.Parser;return e=e===G?0:e,i=i===G?0:i,t=new f(t,!!r,(0,L.eV)(e,i)),o&&(t.culture=!0),a.parse(t,n)}function Y(t,n,e,i,r,o){var t,a,t,t=t&&t instanceof B.Worksheet&&t,a=new L.Parser;return e=e===G?0:e,i=i===G?0:i,(t=new f(t,!!r,(0,L.eV)(e,i))).Sbt=o,a.unparse(t,n)}function ot(t,n,e,i,r){var o;return at(t,rt(t,n,e=e===G?0:e,i=i===G?0:i,r,!0),e,i)}function at(t,n,e,i,r){var o,a,r,o=t.op();return e===G&&(e=t.getActiveRowIndex()),i===G&&(i=t.getActiveColumnIndex()),a=!0,r&&r.convertNullToZero!==G&&(a=r.convertNullToZero),r=t.Uw(),o.BI(r,n,(0,L.eV)(e,i),!1,a)}function ut(t,n,e,i,r){var o,a,r,t,o=t.op();return e===G&&(e=t.getActiveRowIndex()),i===G&&(i=t.getActiveColumnIndex()),a=!0,r&&r.convertNullToZero!==G&&(a=r.convertNullToZero),r=t.Uw(),(t=(0,L.eV)(e,i)).Tbt=Math.random().toString(36).substring(2),o.Abt(r,n,t,a)}function T(t,n,e,i,r){var o,a,u,s,c,f,l,h,d,v,m,o=t.row,a=t.col,u=t.row+t.rowCount-1,s=t.col+t.colCount-1,c=!1,f=!1,l=!1,h=!1;return 4<=arguments.length&&(o-=(c=0!=(1&i))?n:0,u-=(f=0!=(4&i))?n:0,a-=(l=0!=(2&i))?e:0,s-=(h=0!=(8&i))?e:0),r&&(v=ct(t,r,n),m=ft(t,r,n),v)&&m?b.StructureReferenceResolver.create(r,v,m,t.col-r.dataRange().col,t.col+t.colCount-r.dataRange().col-1):1===t.rowCount&&1===t.colCount?(0,L.knt)(P,P,o,a,c,l):(t.row<0&&(o=u=g.BAND_INDEX_CONST),t.col<0&&(a=s=g.BAND_INDEX_CONST),(0,L.lJ)(P,P,o,a,u,s,c,l,f,h,n,e))}function st(t){return 0<=t.indexOf("[")&&1<t.indexOf("]")}function ct(t,n,e){if(1===t.rowCount){if(n.hasHeadersRow()&&t.row===n.startRow())return 2;if(n.hasTotalsRow()&&t.row===n.endRow())return 8;if(e===t.row)return 1}else{if(n.hasHeadersRow()&&t.row===n.startRow()){if(t.rowCount===n.dataRange().rowCount+1)return 6;if(n.hasTotalsRow()&&t.rowCount===n.dataRange().rowCount+1+1)return 14}if(t.row===n.dataRange().row){if(t.rowCount===n.dataRange().rowCount)return 3;if(n.hasTotalsRow()&&t.rowCount===n.dataRange().rowCount+1)return 12}}return G}function ft(t,n,e){return t.col===n.startColumn()&&t.colCount===n.dataRange().colCount?1:1===t.colCount?2:t.col>=n.startColumn()&&t.col+t.colCount-1<=n.endColumn()?4:G}function lt(t,n,e,i,r){var t,i,o,r,t=T(t,n,e,i),i=new f(P,!!r,(0,L.eV)(n,e)),o,r=(new L.Parser).unparse(i,t);return i.L0(),r}function ht(t,n,e,i,r,o,a){var n,r,u,n=T(n,e,i,r,a),r=new f(t,!!o,(0,L.eV)(e,i)),u;return(new L.Parser).unparse(r,n)}function dt(t,n,e,i){var r,n,o,a,u,s,c,f,l,u,s;if(!n)return null;if(e=e||0,i=i||0,a=!1,(n=(r=t.op()).parse(t.Uw(),n,e,i,!0,!0))&&(7===n.type&&"ANCHORARRAY"===n.functionName&&(n=n.arguments[0],a=!0),!(o=n.source)||13!==n.type)&&1===n.type&&n.endSource){for(u=n.source,s=n.endSource,c=u.getSources(s),f=!1,l=0;l<c.length;l++)if(c[l]===t.Uw()){f=!0;break}n=f&&n}return n&&n.getRange&&(!o||o===t.Uw())&&(u=n.getRange(e,i))?(a&&(s=new L.CalcReference(t.qgt,[u]).getSpillRef())&&s.$gt&&(u=s.$gt[0]),new B.Range(u.row,u.col,u.rowCount,u.colCount)):null}function vt(t,n,e,i,r,o){var a,u,s,c,f,l,h,d,v,m,g,p,a=[],u=[];if(n)for(s={},e=e||0,i=i||0,c=new L.Parser,f=b.Vgt(c,n,t,e,i,G,r,o),l=0;l<f.length;l++)if((h=f[l].sheetRanges)&&!F(h))for(d=0;d<h.sheets.length;d++)for((u=s[v=h.sheets[d]])||(s[v]=u=[],a.push({sheetName:v,ranges:u})),m=h[v],g=0;g<m.length;g++)p=m[g],z(p)||u.push(new B.Range(p.row,p.col,p.rowCount,p.colCount));return a}function mt(t,n,e,i,r){var o,r,o,o=new L.Parser,r=new f(P,!!r,(0,L.eV)(n,e)),o=gt(o,r,t,n,e,i);return r.L0(),o}function gt(t,n,e,i,r,o,a){for(var u,s,c,c,f,u="",s=0;s<e.length;s++)c=T(e[s],i,r,o),c=t.unparse(n,c),u+=0<s?(f=a&&y.Common.CultureManager.Fe().NumberFormat.listSeparator||",")+" "+c:c;return u}function pt(t,n,e,i,r,o,a){var u,s,c,f,l,h,d,v,m,g,p,b,u=i.getValue(n,e),d=!1,v=100,m=.001,g=.01,c=(C(u)?+u:0)-a,s=i.getValue(r,o),l=(C(s)?+s:0)-a;if(C(s)&&Math.abs(l)<m)d=!0;else if(M(s))d=!1;else for(f=c+(0===c?.01:.01*c),p=0;!d&&p<100;p++)f=y.Common.st.E8(f,13),t.setValue(n,e,f),s=i.getValue(r,o),h=(C(s)?+s:0)-a,C(s)&&Math.abs(h)<m?d=!0:f=M(s)?(c+f)/2:c-f==0?c+(0===c?.01:.01*c):l-h==0?c+2*(f-c):(b=f-h*(c-f)/(l-h),c=f,l=h,b);return d||t.setValue(n,e,u),d}e=this&&this.__extends||(o=function(t,n){return(o=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(t,n){t.__proto__=n}:function(t,n){for(var e in n)Object.prototype.hasOwnProperty.call(n,e)&&(t[e]=n[e])}))(t,n)},function(t,n){if("function"!=typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function e(){this.constructor=t}o(t,n),t.prototype=null===n?Object.create(n):(e.prototype=n.prototype,new e)}),Object.defineProperty(t,"__esModule",{value:!0}),t.goalSeek=t.RangeReferenceRelative=t.Ibt=t.rangesToFormula=t.formulaToRanges=t.formulaToRange=t.rangeToFormulaWithStructReference=t.rangeToFormula=t.isValidExternalReference=t.rangeToExpression=t.xbt=t.evaluateExpression=t.evaluateFormula=t.expressionToFormula=t.formulaToExpression=t.SpreadSource=t.SheetSource=t.SheetParserContext=t.SheetRangeReference=t.FormatterNameInfo=t.NameInfo=t.ReferenceStyle=t.encodeNameFormula=t.processFunctionPrefix=void 0,B=n("Core"),i=n("Core"),y=n("Common"),b=n("./dist/plugins/sheetsCalc/parser-sheets.js"),L=n("CalcEngine"),g=n("./dist/plugins/sheetsCalc/calc.ns.js"),Z=n("./dist/plugins/sheetsCalc/calc-extra-save.js"),R=y.Common.lt,s=y.Common.zf,w=R.Dh,F=R._h,P=null,G=void 0,U=["v","n","s","b","d","sn"],H=L.Errors.Value,W=y.Formatter&&y.Formatter.GeneralFormatter,M=L.Convert.BJ,z=R.ht,Q=B.mt.xr,V=B.range_parser.jc,J=B.mt.vo,K=B.Util.addXLFNPrefix,I="=",C=function(t){return L.Convert.q8(t,!0)},x=B.Range.prototype.contains,N=s.Gmt,k="number",D=B.UsedRangeUtil.updateUsedRangeByData,t.processFunctionPrefix=$,t.encodeNameFormula=tt,(n=L.CalcSource.prototype).referenceToArray=function(t,n,e,i,r,o,a,u){var s,c,f,l,h,d,v,m,g,p,b,y,w,M,C,S,T,s=this,l=1,h=1,g=[],m=t.getRangeCount();if(0===m)g.isError=!0;else{for(y=s.getRowCount(),w=s.getColumnCount(),e=e===G||e,M=0;M<m;M++){if(e||g.push(b=[]),0===(l=t.getRowCount(M)))return g.isError=!0,g;if(0===(h=t.getColumnCount(M)))return g.isError=!0,g;if(d=t.getRow(M),v=t.getColumn(M),2!==e){if(y<=d||w<=v)return(g=[P]).rowCount=1,g.colCount=1,g.rangeCount=1,g;w<v+h&&(h=w-v)}for(y<d+l&&(l=y-d),C=void 0,S=0;S<l;S++)for(c=d+S,e||b.push(C=[]),T=0;T<h;T++){if(p=s.getValue(c,f=v+T),i&&L.Convert.BJ(p))return(g=[p]).isError=!0,g;if(p=L.Convert.Nbt(p,n,!L.ExcelCompatibleCalcMode,o,u),r&&p===L.Convert.CalcConvertedError)return(g=[H]).isConvertError=!0,g;p===P&&o||(2===e?g[S*h+T]=p:(e?g:C).push(p))}}(g=e||1!==m?g:g[0]).rowCount=l,g.colCount=h,g.rangeCount=m}return g},n.getSheetReference=function(){var t=this;return t.kbt=t.kbt||new L.CalcReference(t),t.kbt},(r=n=t.ReferenceStyle||(t.ReferenceStyle={}))[r.a1=0]="a1",r[r.r1c1=1]="r1c1",i.ReferenceStyle=n,d.prototype.getName=function(){return this.Zc},d.prototype.getRow=function(){return this.FY},d.prototype.getColumn=function(){return this.jpt},d.prototype.getExpression=function(){return this.WK},d.prototype.getComment=function(){return this.TZ},d.prototype.SB=function(t,n){n&&n.push({type:"customName",nameInfo:this,expr:this.WK}),this.WK=t},t.NameInfo=r=d,i.NameInfo=r,e(v,X=r),v.prototype.getFormatter=function(){return this.bbt},v.prototype.getSheetTabName=function(){return this.ybt},t.FormatterNameInfo=v,L.CalcSource.prototype.createSourceModel=function(t){return new L.CalcSourceModel(t,this)},a=L.CalcReference,e(nt,a),nt.prototype.toArray=function(t,n,e,i,r){for(var o,a,u,s,o=this.references,a=[],u=0;u<o.length;u++){if((s=o[u].rT.referenceToArray(o[u],t,n,e,i,r)).isError&&e)return s;n?Array.prototype.push.apply(a,s):a.push(s),u||(a.rowCount=s.rowCount,a.colCount=s.colCount)}return a.rangeCount=o.length,a},u=nt,t.SheetRangeReference=u,c=["A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z"],l=L.ParserContext,e(m,l),m.prototype.getExternalSource=function(t,n){var e,i,r,o,a,u,e=this,i=e.Mf.parent,r=e.Mf.Uw();if(t&&(!i||i.name!==t))return P;if(!i)return s.Dbt(e.Mf.name(),n)?r:P;if(st(n))return i._p.parseSource(n,r.G3);if((o=i.sheets)&&0<o.length)for(a=0;a<o.length;a++)if(u=o[a],s.Dbt(u.name(),n))return u.Uw();return L.ParserContext.prototype.getExternalSource.call(this,t,n)},m.prototype.getExternalSourceToken=function(t){return t.getName(this)},m.prototype.getTableByName=function(t){var n,e,i,r,o,n=this.Mf.tables,e=!0,i=n?n._bt(t,!0):P;if(!i&&(r=this.Mf.parent&&this.Mf.parent.sheets))for(o=0;o<r.length&&(!(n=r[o].tables)||!(i=n._bt(t,!0)));o++);return i||this.Mf.parent&&this.Mf.parent.Efe(t)},m.prototype.getTableByIndex=function(t,n){var e=this.Mf.tables;return e?e.Hq(t,n,!0):P},m.prototype.setSource=function(t){var t=this.source=t;t&&t.getSheet&&(this.Mf=t.getSheet())},m.prototype.L0=function(){this.Mf&&this.Mf!==m.wbt&&this.Mf.L0(),this.Mf=P},f=m,t.SheetParserContext=f,E=new y.Common.ResourceManager(B.SR),h=L.CalcSource,e(p,h),p.prototype.getReferenceSheetNames=function(){return this.Ebt||{}},p.prototype.addReferenceSheetName=function(t){var n=this;n.Ebt||(n.Ebt={}),n.Ebt[t]=1},p.prototype.setReferenceSheetNames=function(t){this.Ebt=t},p.prototype.startCalculation=function(){this.jbt||(this.Obt(),this.K5=[])},p.prototype.endCalculation=function(t){this.jbt=P,this.Rbt=P,!1!==t&&this.Bbt(),this.K5=P;var t=this.Mbt.uT(!1);t&&t.clearListenersCache()},p.prototype._F=function(){var t=this;t.Fbt?t.K5&&(t.Pbt=t.Pbt.concat(t.K5),t.K5=[]):(t.Pbt=t.K5||[],t.Fbt=setTimeout(function(){t.Bbt(t.Pbt),delete t.Pbt,delete t.Fbt},0))},p.prototype.Bbt=function(t){var t,n,e,t=t||this.K5;t&&0<t.length&&(e=(n=this.Mf).Ut.W_(3).B8,n.ki(B.Events.RangeChanged,{isUndo:!z(e&&e.vE),sheet:n,sheetName:n.name(),row:0,col:0,rowCount:n.getRowCount(),colCount:n.getColumnCount(),changedCells:t,action:6},n.QI))},p.prototype.clearValueCache=function(){this.Obt()},p.prototype.Obt=function(){var t=this.getRowCount(),n=this.getColumnCount();this.jbt={rowCount:t,colCount:n},this.Rbt={arrayInfo:[]}},p.prototype.Gw=function(){this.jbt=P,this.Rbt=P,this.K5=P},p.prototype.getValue=function(t,n){for(var e,i,r,o,a,u,t,s,c,f,l,h,d,v,e=[],i=2;i<arguments.length;i++)e[i-2]=arguments[i];if(o=(r=this).Mf,typeof t==k)a=t,u=arguments[1],n=arguments[2];else if(t.row!==G)a=t.row,u=t.col;else if(t.name)return null;return t=r.nT,a<0||u<0?H:o.Gbt&&o.Ubt===a&&o.Hbt===u?o.zbt:(s=r.jbt,c=U[n=n||0],s?(f=s.rowCount,l=s.colCount,v=d=h=void 0,f<=a||l<=u?P:((v=(d=(d=(h=(h=s[a])||(s[a]={}))[u])||(h[u]={v:o.getValue(a,u,t)}))[c])===G&&(v=L.Convert.Nbt(d.v,n,!L.ExcelCompatibleCalcMode),d[c]=v),B.mt.V0(v))):a>=r.getRowCount()||u>=r.getColumnCount()?P:r.Mf.getValue(a,u,t))},p.prototype.getIdentity=function(t,n){var e,i,r,o,n,e=this,i=n.row,r=n.rowCount||1,o=n.column,n=n.columnCount||1;return-1===i&&(i=0,r=e.getRowCount()),-1===o&&(o=0,n=e.getColumnCount()),e.getName()+"."+i+"."+r+"."+o+"."+n},p.prototype.getReference=function(t){var n=this,e=t.row,i=t.col;return-1===e&&(t.row=0,t.rowCount=n.getRowCount(),t.rowUndefine=!0),-1===i&&(t.col=0,t.colCount=n.getColumnCount(),t.colUndefine=!0),new L.CalcReference(n,[t])},p.prototype.getSources=function(t){var n,e,i,r,o;if(this.Mf&&this.Mf.parent&&this.Mf.parent.sheets&&t instanceof p){for(n=this.Mf.parent.sheets,e=!1,i=void 0,r=[],o=0;o<n.length;o++){if((i=n[o].Uw())===this&&(e=!0),i===t){r.push(i);break}e&&r.push(i)}return r}},p.prototype.Vbt=function(i,r){var t,o,a,u,t,o=this.Rbt,a=o&&o.arrayInfo;a&&(u=!1,a.forEach(function(t,n){var e,t;t&&(e=t.reference,t=t.key,x.call(e.$gt[0],i,r))&&(delete o[t],a[n]=G,u=!0)}),u)&&(o.arrayInfo=[],a.forEach(function(t){t&&o.arrayInfo.push(t)}))},p.prototype.referenceToArray=function(t,n,e,i,r,o,a,u){var s,c,f,l,h,d,v,m,g,p,b,y,w,M,C,S,T,A,I,x,N,k,D,_,E,j,O,h=l=1,g=[],y=(s=this).Mf,w=s.jbt,M=s.Rbt,T=U[n=n||0];if(0===(m=t.getRangeCount()))g.isError=!0;else{if(M&&(p=M[S=t.getRangeCount()+"_"+t.getRow(0)+"_"+t.getColumn(0)+"_"+t.getRowCount(0)+"_"+t.getColumnCount(0)+"_"+n+"_"+e]))return p;for(A=this.getRowCount(),I=this.getColumnCount(),e=e===G||e,x=0;x<m;x++){if(e||g.push(b=[]),0===(l=t.getRowCount(x)))return g.isError=!0,g;if(0===(h=t.getColumnCount(x)))return g.isError=!0,g;if(d=t.getRow(x),v=t.getColumn(x),2!==e){if(A<=d||I<=v)return(g=e?[P]:[[P]]).rowCount=1,g.colCount=1,g.rangeCount=1,g;I<v+h&&(h=I-v)}for(A<d+l&&(l=A-d),k=N=void 0,D=y.Gbt,_=0;_<l;_++)for(c=d+_,e||b.push(N=[]),w&&(w[c]||(w[c]={}),C=w[c]),E=0;E<h;E++){if(f=v+E,D&&y.Ubt===c&&y.Hbt===f)p=y.zbt,D=!1;else{if(w?(k=C[f])?p=k.v:(p=y.getValue(c,f,s.nT),k=C[f]={v:p}):p=y.getValue(c,f,s.nT),a&&(O=void 0,"@"===(O=(j=y.getFormatter())instanceof W?j.formatString():j)?p=y.getText(c,f):p instanceof Date&&(p=R.uJ(p)),F(k)||(k=C[f]={v:p})),i&&L.Convert.BJ(p))return(g=[p]).isError=!0,g;if(k&&k[T]!==G)p=k[T];else if(p=L.Convert.Nbt(p,n,!L.ExcelCompatibleCalcMode,o,u),k&&(k[T]=p),r&&k===p)return(g=[H]).isConvertError=!0,g}L.Convert.Ybt(p,o)||(2===e?g[_*h+E]=p:(e?g:N).push(p))}}(g=e||1!==m?g:g[0]).rowCount=l,g.colCount=h,g.rangeCount=m,M&&(t.Zbt&&M.arrayInfo.length<200||!isNaN(m)&&!isNaN(l)&&!isNaN(h)&&100<m*l*h&&m*l*h<1e6&&M.arrayInfo.length<50)&&(M[S]=g,M[S].rowCount=l,M[S].colCount=h,M[S].rangeCount=m,M.arrayInfo.push({reference:t,key:S}))}return g},p.prototype.getColumnCount=function(){var t=this.Mf;return t.xT?0:t.getColumnCount(this.nT)},p.prototype.getRowCount=function(){var t=this.Mf;return t.xT?0:t.getRowCount(this.nT)},p.prototype.isHiddenRow=function(t,n){var e=this.Mf,i;return!!(e.iA&&e.iA()||!n)&&0===e.getRowHeight(t)},p.prototype.getName=function(){var t,n,t=this.nT,n=z(this.Wbt)?this.Mf.name():this.Wbt;return t===B.SheetArea.colHeader?n+"CH":t===B.SheetArea.rowHeader?n+"RH":n},p.prototype.Qbt=function(){var t=this,n,n;return n=(n=t.t8)||(t.t8=t.Mf.Ut.t8)},p.prototype.setArray=function(t,n,e,i,r){return this.Qbt().setArray(this,t,n,e,i,r)},p.prototype.updateItem=function(t,n,e){return this.Qbt().updateItem(this,t,n,e)},p.prototype.HE=function(t,n){this.Qbt().HE(t,n)},p.prototype.zE=function(){this.Qbt().zE()},p.prototype.setValue=function(t){for(var n,e,i,r,o,a,u,s,t,c,i,f,f,f,l,h,d,d,v,m,v,d,m,g,i,i,g,v,p,n=[],e=1;e<arguments.length;e++)n[e-1]=arguments[e];if(r=(i=this).Mf,u=i.nT,t.row!==G)o=t.row,a=t.col,s=1;else{if(t.name)return;o=t,a=arguments[1],s=2}t=arguments[s],c=arguments[s+1],(i=i.jbt)&&(f=i[o])&&(f=f[a])&&(f.v=t,f.b!==G&&(f.b=G),f.d!==G&&(f.d=G),f.n!==G&&(f.n=G),f.s!==G&&(f.s=G),f.sn=G),f=B.mt.Z0(t),l=r.Ut,h=!1,d=(d=r.tables)&&d.find(o,a),3===u&&d&&(v=d.showHeader()&&o===d.headerIndex(),m=d.showFooter()&&o===d.footerIndex(),v||m||(h=d.Kbt(o,a,f))),v=r.H3,3===u&&!h&&v&&v._dataSource&&(m=!1,(d=v.getValue(o,a)).hasBinding&&(g=void 0,g=i?(g=(i=i.bindingRows=i.bindingRows||{})[o])||(i[o]=w({},r.getDataItem(o))):w({},r.getDataItem(o)),l.dE(o,a,{gE:g,d6:d.value}),m=v.setValue(o,a,f,l.G8)),h="dataManagerBindingSource"===v.K$?m:d.hasBinding),i=r.pivotTables,(h=3===u&&!h&&i?i.eJt(o,a,f):h)||(g="__hyperlink__",!z(f)&&f[g]&&(v=f[g],l.setHyperlink&&l.do("setHyperlink",o,a,p={url:v}),f=f.toString()),l.do("setValue",o,a,f,u,!0,!0,arguments[s+2],!0,!0)),r.iL=!0,this.K5?this.K5.push({row:o,col:a,sheetArea:u}):r.ki(B.Events.CellChanged,{sheet:r,sheetName:r.name(),row:o,col:a,sheetArea:u,propertyName:"value",oldValue:c,newValue:t,KO:!0})},p.prototype.getCustomFunction=function(t){return this.Mf?this.Mf.Jbt(t):P},p.prototype.getCustomName=function(t){var t=this.getCustomNameInfo(t);return t?t.getExpression():P},p.prototype.getCustomNameInfo=function(t){return t=N(t),this.Mf?this.Mf.getCustomName(t):P},p.prototype.getSheet=function(){return this.Mf},p.prototype.setFormula=function(t,n,e,i,r){var o,a,u,s,c,a,c,o=this;if(o.Mf.Ut.G8&&(s=o.Mf.Ut.G8.formulas,u=o.getCalcSourceModel(),s=s||(o.Mf.Ut.G8.formulas={}),-1<=t)&&-1<=n){if((c=o.getCalcService()).backupR1C1Formula&&(a=o.Mbt.pB(t,n),e=Y(o.Mf,a,t,n,!0,!1)),!i&&c.allowDynamicArray&&(i=o.Mbt.sT(t,n)),a=(a=s[t])||(s[t]={}),e&&"="===e[0]&&(e=e.substring(1)),c=a[n]&&a[n].formula,r){if(a[n]&&a[n].oldFormula)return;i=w({},i),a[n]=w({},a[n],{oldFormula:e,oldArrayInfo:i}),e||delete a[n].oldArrayInfo}else a[n]=w({},a[n],{formula:e,arrayInfo:i}),e||delete a[n].arrayInfo;u.usedRange&&D(u.usedRange,t,n,c,e)}},p.prototype.setArrayFormula=function(t,n,e,i,r){var o;this.setFormula(t,n,r,{row:t,col:n,rowCount:e,colCount:i})},p.prototype.setFormulaByName=function(t,n,e){var i,r,i,i=this;i.Mf.Ut.G8&&((i=(i=(r=(r=i.Mf.Ut.G8.formulas)||(i.Mf.Ut.G8.formulas={})).names)||(r.names={}))[t]=w({},i[t],{formula:n,oldFormula:e}))},p.prototype.refresh=function(){this.Mf.repaint()},p.prototype.toJSON=function(t,n,e,i,r){var o,a,u,s,c,f,l,h,d,v,m,g,p,b,y,w,M,C,S,T,A,I,x,N,k,D,D,_,a=n,l=this.Mf,h=t.data||{},d=!0,v=this.op(),m=this===l.qgt,b=0;for(m&&(g=(0,L.createMap)(),l.Xbt=p={}),y=v.forceR1C1Formula,w=0;w<=e;w++)if(o=h.dataTable||{},u=a[w]){for(d=!(c=o[w]),c=c||{},M=0;M<=i;M++)if(C=(s=u[M])&&s.WK,s&&(C||s.qbt)){f=c[M]||{};try{T=S=void 0,m&&C&&!s.$bt&&(A=C.tyt=C.tyt||Y(l,C,w,M,!0,!1)).indexOf("!")<0&&(!(I=g.get(A))||I.baseColumn>M?(T=v.unparse(this,s.WK,w,M,!1,!0)).indexOf("[")<0&&(y&&(T=A),g.set(A,{formula:T,baseRow:w,baseColumn:M})):(S=I.obj)?((x=p[S.si]).lastRow=w,x.lastColumn=Math.max(M,x.lastColumn)):(S=I.obj={si:b},p[b]={formula:I.formula,baseRow:I.baseRow,baseColumn:I.baseColumn,lastRow:w,lastColumn:M},o[I.baseRow][I.baseColumn].formula=I.obj,b++)),T=y&&C?S||C.tyt||Y(l,C,w,M,!0,!1):s.qbt||S||T||v.unparse(this,C,w,M,!1,!0),s.$bt?s.$bt.row===w&&s.$bt.col===M&&(f.arrayInfo=s.$bt,f.formula=T):f.formula=T,d=!1,c[M]=f}catch(t){}}if(d){if(o!==h.dataTable)continue}else o[w]=c;h.dataTable=o}if(p&&(p.nextIndex=b),r){for(N=h.columnDataArray||[],k=0;k<r.length;k++)(D=r[k])&&D.WK&&(D=this.op().unparse(this,D.WK,0,k,!1,!0),(_=N[k]||{}).formula=D,N[k]=_);0<N.length&&(h.columnDataArray=N)}F(h)||(t.data=h)},p.prototype.wh=function(t,n,e,i,R,r){var o,a,u,s,c,f,l,h,d,v,m,g,p,b,y,w,M,C,S,T,A,I,x,N,k,D,_,E,j,O,o=Q(t,B.XFileConstants.bo),a=this.op();for(a.nyt=!0,m=0,(h=this===(l=this.Mf).qgt)&&(d=(0,L.createMap)(),l.Xbt=v={}),g=t.lossless.exprs=[],p=0;p<=e;p++)if(u=n[p],c=o[p],u)for(c=c||(o[p]={}),b=0;b<=i;b++)if(s=u[b],f=c[b],y=s&&s.WK,s&&y){f=f||{};try{C=M=w=void 0,S=-1,(T=s.$bt)||(A=l.Ut.t8.anchors)[p]&&A[p][b]&&(T={row:p,rowCount:(I=A[p][b]).rowCount,col:b,colCount:I.colCount,isDynamicArray:!0},I.isValid||(T.isInvalid=!0)),h&&!T&&(x=y.tyt=y.tyt||Y(l,y,p,b,!0,!1),(N=B.Util.ko(r))||x.indexOf("!")<0)&&(!(k=d.get(x))||k.baseColumn>b?(M=a.unparse(this,s.WK,p,b,!1,!0)).indexOf("[")<0&&d.set(x,{formula:M,baseRow:p,baseColumn:b}):((w=k.obj)?((D=v[w.si]).lastRow=p,D.lastColumn=Math.max(b,D.lastColumn)):(w=k.obj={si:m},v[m]={formula:k.formula,baseRow:k.baseRow,baseColumn:k.baseColumn,lastRow:p,lastColumn:b},m++),C=w.si,M=void 0)),z(C)&&(M=s.qbt||M||a.unparse(this,y,p,b,!1,!0),r&&r.includeCalcModelCache&&(_=(0,Z.exprToJSON)(y),s.eyt||(_.nw=1),g.push(_),S=g.length-1),M=J(K(M))),T?(T.row===p&&T.col===b&&(E=V(T),(T.isInvalid||!T.rowCount)&&0<E.indexOf(":")&&(E=E.substring(0,E.indexOf(":"))),f.f=M,f.r=E),T.isDynamicArray&&(f.a="1")):(f.f=M,f.d="shared",f.g=C,f.c=1),-1!==S&&(f.x=S)}catch(t){}c[b]=f}for(j in v)Object.prototype.hasOwnProperty.call(v,j)&&(O=v[j],E=V(new B.Range(O.baseRow,O.baseColumn,O.lastRow-O.baseRow+1,O.lastColumn-O.baseColumn+1)),(f=o[O.baseRow][O.baseColumn]).r=E,f.g=parseInt(j,10));delete a.nyt},(t.SheetSource=j=p).prototype.getParserContext=function(t,n,e){return n=n||(0,L.eV)(0,0),new f(this.Mf,t,n,e)},q=L.CalcSource,e(S,q),S.prototype.addUsedCustomName=function(t){this.Cbt[t]=1},S.prototype.getUsedCustomNames=function(){return this.Cbt||{}},S.prototype.getCustomFunction=function(t){return this.vpt?this.vpt.getCustomFunction(t):P},S.prototype.getCustomName=function(t){var t=this.getCustomNameInfo(t);return t?t.getExpression():P},S.prototype.getCustomNameInfo=function(t){return this.vpt?this.vpt.getCustomName(t)||this.vpt.xO(t):P},t.SpreadSource=S,t.formulaToExpression=rt,t.expressionToFormula=Y,t.evaluateFormula=ot,t.evaluateExpression=at,t.xbt=ut,t.rangeToExpression=T,t.isValidExternalReference=st,t.rangeToFormula=lt,t.rangeToFormulaWithStructReference=ht,t.formulaToRange=dt,t.formulaToRanges=vt,t.rangesToFormula=mt,t.Ibt=gt,t.RangeReferenceRelative={allAbsolute:0,startRowRelative:1,startColRelative:2,endRowRelative:4,endColRelative:8,rowRelative:5,colRelative:10,allRelative:15},t.goalSeek=pt},"./dist/plugins/sheetsCalc/calc.ns.js":function(t,n,e){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.MAX_COLUMN_COUNT=n.MAX_ROW_COUNT=n.BAND_INDEX_CONST=void 0;var e=e("Core");n.BAND_INDEX_CONST=-2147483648,n.MAX_ROW_COUNT=e.XmlConstants.Io,n.MAX_COLUMN_COUNT=e.XmlConstants.xo},"./dist/plugins/sheetsCalc/external-reference.js":function(t,n,e){"use strict";var i,A,r,I,a,e,x,N,k,D,_,f,E,j,o,u,s,c,l;function h(t,n,e,i){var t=t&&t[n];return t&&t[e]&&t[e][i]}function d(t,n,e,i){var t,n,r,t=t.sheets[n]&&t.sheets[n].data.dataTable,n=t&&t[e]&&t[e][i]&&t[e][i].value;return n&&n.richText?(r="",n.richText.forEach(function(t){r+=t.text}),r):n}function v(t,n,e){var i,t,r,e,i=l.call(this,D)||this;return i.getSheetRangeReference=function(t){var n,e,i,r,o,n=this.rT.sheetNames;if(t.endSource&&n&&t.source instanceof v){for(e=!1,i=[],r=0;r<n.length&&((e=n[r]===t.source.oyt?!0:e)&&(o=new v("["+this.rT.i+"]"+n[r],this.ayt,!0),i.push(o.getReference(t))),n[r]!==t.endSource.oyt);r++);return new a.SheetRangeReference(i)}return I.Errors.Name},t=t.split("]"),e&&(r=t[0].substring(1)),n.iyt[r]?i.rT=n.iyt[r]:(e=t[0].indexOf("["),i.rT=n.ryt(t[0].substring(e+1),t[0].substring(0,e),!0)),i.oyt=t[1],i.ayt=n,i}function m(t,n){var e,i,r;if(t)for(e in t)_(t,e)&&(r=(i=t[e]).getExpression())&&r.forEachNodes(function(t){(1===t.type||5===t.type||8===t.type)&&t.source instanceof u&&(n[t.source.rT.i]=!0)})}function g(t,n){var n=t.getRange(n.row,n.column);return n.sheetName=t.source.oyt,n}function p(t){this.iyt=t||{},this.uyt={},this.syt()}i=this&&this.__extends||(c=function(t,n){return(c=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(t,n){t.__proto__=n}:function(t,n){for(var e in n)Object.prototype.hasOwnProperty.call(n,e)&&(t[e]=n[e])}))(t,n)},function(t,n){if("function"!=typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function e(){this.constructor=t}c(t,n),t.prototype=null===n?Object.create(n):(e.prototype=n.prototype,new e)}),Object.defineProperty(n,"__esModule",{value:!0}),n.ExternalReferenceManager=n.ExternalSource=void 0,A=e("Core"),r=e("Common"),I=e("CalcEngine"),a=e("./dist/plugins/sheetsCalc/calc-spreadjs.js"),e=r.Common.lt,x=A.XFileConstants.Rr,N=A.XFileConstants.Lr,k=void 0,D=null,_=r.Common.kh,f=e.ht,E=A.Util.wr,j=A.Util.Mr,o=/^'?\[\d+\]/,l=I.CalcSource,i(v,l),v.prototype.cyt=function(t,n,e){var i,r,i=t.getKey();this.rT=this.ayt.fyt(this.rT),this.S2(),r=this.ayt.uyt[this.rT.i]=this.ayt.uyt[this.rT.i]||{},n?r[i]?r[i][1].push(e):r[i]=[t,[e]]:r[i]&&delete r[i]},v.prototype.S2=function(){this.rT.data=this.rT.data||{};var t=this.rT.data[this.oyt];return t||(this.rT.sheetNames.push(this.oyt),t=this.rT.data[this.oyt]={isNew:!0}),t},v.prototype.getValue=function(t,n){var e,i,t,e=this.S2(),i=e[t];return i=i||(e[t]={}),f(i[n])&&(i[n]=k),e.isNew?I.Errors.Reference:(t=i[n])&&t._code&&(t._error||t._calcError)?new I.CalcError(t._error||t._calcError):t},v.prototype.getRowCount=function(){return I.MAX_ROW_COUNT},v.prototype.getColumnCount=function(){return I.MAX_COLUMN_COUNT},v.prototype.createSourceModel=function(){return D},v.prototype.getCalcSourceModel=function(){return D},v.prototype.setCalcSourceModel=function(){},v.prototype.getPeerSource=function(t){return new v("["+this.rT.i+"]"+t,this.ayt,!0)},v.prototype.getSources=function(t){var n,e,i,r,o,n=this.rT.sheetNames,e=[];if(t&&n&&t.oyt)for(i=!1,r=0;r<n.length&&((i=n[r]===this.oyt?!0:i)&&(o=new v("["+this.rT.i+"]"+n[r],this.ayt,!0),e.push(o)),n[r]!==t.oyt);r++);return e},v.prototype.referenceToArray=function(t,n,e,i,r,o,a,u){var s,c,f,l,h,d,v,m,g,p,b,y,w,M,C,S,T,A,s=this,l=1,h=1,g=[],m=t.getRangeCount();if(0===m)g.isError=!0;else{for(y=s.getRowCount(),w=s.getColumnCount(),e=e===k||e,M=0;M<m;M++){if(e||g.push(b=[]),d=t.getRow(M),v=t.getColumn(M),0===(l=t.getRowCount(M)))return g.isError=!0,g;if(-1===l&&(d=0,l=y),0===(h=t.getColumnCount(M)))return g.isError=!0,g;if(-1===h&&(v=0,h=w),y<=d||w<=v)return(g=e?[D]:[[D]]).rowCount=1,g.colCount=1,g.rangeCount=1,g;for(y<d+l&&(l=y-d),w<v+h&&(h=w-v),C=void 0,S=!1,T=0;T<l;T++)for(c=d+T,e||b.push(C=[]),A=0;A<h;A++)p=s.getValue(c,f=v+A),S||(p=I.Convert.Nbt(p,n,!I.ExcelCompatibleCalcMode,o,u),i&&I.Convert.BJ(p)&&(S=(g=[p]).isError=!0),I.Convert.Ybt(p,o))||(e?g:C).push(p);if(S)return g}(g=e||1!==m?g:g[0]).rowCount=l,g.colCount=h,g.rangeCount=m}return g},v.prototype.getName=function(t){var t,t=this.jfe?"":this.ayt.uyt[this.rT.i]&&(!this.rT||t&&t.lyt)?"[".concat(this.rT.i,"]"):"".concat(this.rT.option.path,"[").concat(this.rT.option.name,"]");return t+this.oyt},v.prototype.getIdentity=function(t,n){var e,i,r,o,n,e=this,i=n.row,r=n.rowCount||1,o=n.column,n=n.columnCount||1;return-1===i&&(i=0,r=e.getRowCount()),-1===o&&(o=0,n=e.getColumnCount()),e.getName(t)+"."+i+"."+r+"."+o+"."+n},u=v,n.ExternalSource=u,p.prototype.parseSource=function(t,n){return new u(t,this,n)},p.prototype.ryt=function(t,n,e,i){var r,o;for(r in this.iyt)if(_(this.iyt,r)&&(o=this.iyt[r])&&o.option.name===t&&o.option.path===n)return o;if(!e)for(r in this.iyt)if(_(this.iyt,r)&&(o=this.iyt[r]).option.name===t&&""===n)return o;return i?k:{option:{name:t,path:n},sheetNames:[],data:{}}},p.prototype.syt=function(){for(var t in this.iyt)this.iyt[t]&&(this.iyt[t].i=t)},p.prototype.fyt=function(t){var n,n,n=this.ryt(t.option.name,t.option.path,!0,!0);return n||(n=Object.keys(this.iyt).length+1,(this.iyt[n]=t).i=n,t)},p.prototype.Ep=function(t){var n,e,i,r,o,a,e={},i={},r=1;for(o in this.iyt)_(this.iyt,o)&&(this.uyt[o]&&!A.GC$.isEmptyObject(this.uyt[o])||(n||(n={},m(t.hyt,n),t.sheets.forEach(function(t){m(t.hyt,n)})),n[o]))&&(e[(a=this.iyt[o]).i=r]=a,i[r]=this.uyt[o],r++);this.iyt=e,this.uyt=i},p.prototype.toJSON=function(){var t,n,e,t={};for(n in this.iyt)_(this.iyt,n)&&(e=this.iyt[n],t[n]={option:{name:e.option.name,path:e.option.path},sheetNames:e.sheetNames,data:e.data});return t},p.prototype.wh=function(t){var w,M,n,C,S,T,e,i,w=this.iyt,M=[],n={n_:"externalReferences",c_:M},C={},S=t.workbook.rels,T=0,e=function(t){var n,e,i,t,r,o,a,u,s,c,f,l,h,d,v,m,g,p,b,y;if(_(w,t)){for(T++,e=(n=w[t]).option.id=x+E(S),S.c_.push({n_:N,Id:e,Type:A.RelationshipConstants.uc,Target:j(A.XFileConstants.nu+"/"+A.XFileConstants.tu+t)}),M.push({n_:"externalReference","r:id":e}),t={n_:"sheetNames",c_:i=[]},r={n_:"sheetDataSet",c_:[]},(o=n.sheetNames)&&o.forEach(function(t){i.push({n_:"sheetName",val:A.mt.xfe(t)})}),a=n.data,u=0,s=o.length;u<s;u++){if(c=a[o[u]],f={n_:A.XFileConstants.bo,sheetId:u},c)if(c.isNew)f.refreshError=1;else{for(h in l=[],c)if(c.hasOwnProperty(h)&&(d=parseInt(h,10)+1,!isNaN(d))){for(p in g={n_:"row",r:d,c_:m=[]},v=c[h])v.hasOwnProperty(p)&&v[p]!==k&&(b=v[p],(y={n_:"cell"}).r=A.IndexHelper.nr(parseInt(p,10))+d,"string"==typeof b?y.t="str":"boolean"==typeof b?(y.t="b",b=b?"1":"0"):b&&b.code&&(y.t="e","#SPILL!"!==(b=b._calcError||b.error)&&"#CALC!"!==b||(b="#VALUE!")),y.c_=[{n_:"v",c_:[b]}],m.push(y));l.push(g)}f.c_=l}r.c_.push(f)}C[e]={n_:"externalLink",r_:[13,14,1,21],c_:[{n_:"externalBook","r:id":"rId1",r_:[8],c_:[t,r]}],option:n.option}}};for(i in w)e(i);return{externalReferencesNode:n,externalLinks:C,count:T}},p.prototype.dyt=function(t,r,n){var e,o,a,e,t,u,i,s,c,e=r&&r.sheets&&Object.keys(r.sheets),o=e&&r.sheets[e[0]].data&&r.sheets[e[0]].data.dataTable,a=o?d:h,e=this.ryt(t,n||"",k,!0);if(!f(e))for(s in t=e.i,(u=this.iyt[t]).sheetNames.forEach(function(t){var n,e,i,n;for(e in(o?r.sheets:r)[t]&&delete u.data[t].isNew,u.data[t])if(_(u.data[t],e))for(i in u.data[t][e])_(u.data[t][e],i)&&(u.data[t][e][i]=a(r,t,e,i))}),i=this.uyt[t]||{})_(i,s)&&(c=i[s][0]).vyt()},p.prototype._6=function(n,t,e){var i,r,i=this;"string"==typeof n?i.dyt(n,t,e):n&&(r=i.myt(!0)).forEach(function(t){n[t.filePath+t.name]&&i.dyt(t.name,n[t.filePath+t.name],t.filePath)})},p.prototype.myt=function(t){var n,e,i,r,o,a,u,n=[];for(e in this.iyt)if(_(this.iyt,e)){if(i=this.iyt[e],r={name:i.option.name,filePath:i.option.path},t)for(u in o=this.uyt[e]||{},r.items=[],a=function(t){var n,e,t,t;_(o,t)&&(e={row:(n=o[t][0]).row,col:n.column,sheetName:n.w3.rT.getName()},t=1===(t=o[t][1]).length?g(t[0],n):t.map(function(t){return g(t,n)}),r.items.push({target:e,source:t}))},o)a(u);n.push(r)}return n},n.ExternalReferenceManager=p},"./dist/plugins/sheetsCalc/formulaOperatorAdjustor.js":function(o,t,n){"use strict";var Q,e,A,C,R,a,B,n,m,J,g,K,L,p,w,D,F,i,u,b,e;function c(t,n){var e,i,r,t,e=g(t.row,(n=n||this).row),i=g(t.column,n.column),r=J(t.row+t.rowCount,n.row+n.rowCount),t=J(t.column+t.columnCount,n.column+n.columnCount);return r<=e||t<=i?L:{row:e,column:i,rowCount:r-e,columnCount:t-i,intersectWith:c}}function r(t,n,e,i,r,o,a,u){var s=this;s.gyt=t,s.pyt=n,s.byt=e,s.yyt=i,s.wyt=r,s.Myt=o,s.Sx=a,s.Cyt=u}function k(t,n,e,i){return(!i||t<n)&&e}function z(t){return[t.row,t.col,t.rowCount,t.colCount].join(",")}function P(t,n,e,i){var r,r;(r=(r=t[n])||(t[n]={}))[e]=i}function G(t,n,e){var t=t[n];return t&&t[e]}function X(){}function y(t,n,e,i,r,o,a,u,s,c,f,l){var h,d,v,t;return 0<=e||!r?(h=i+(r?e:0),d=o+(a?e:0),v=f&&M(u,t,f),t=!f&&M(u,t,f),(v||t)&&(!l&&s+c<=e||l&&s<=e)&&(h-=r?c:0,d-=a?c:0),v=f&&M(u,n,f),t=!f&&M(u,n,f),(v||t)&&(!l&&s<=h||l&&(r&&s<=e+i||!r&&s<=i)?(h+=c,d+=c):(!l&&s<=d||l&&(a&&s<=e+o||!a&&s<=o))&&(d+=c)),h-=r?e:0,d-=a?e:0,l&&s+c<=e&&(h+=r?c:0,d+=a?c:0),{index:h,endIndex:d}):{index:i,endIndex:o}}function j(t,n,e,i,r,o,a,u,s,c,f,l){if(n&&!l){var l=s?r.row:r.column,h=s?r.rowRelative:r.columnRelative,d=void 0;if(s&&0<=e||!s&&0<=i||!h){if(c)d=y(t,n,s?e:i,l,h,-1,!1,o,a,u,s,f).index;else if(d=Z(t,n,s?e:i,l,h,o,a,u,s,f),p(d))return(0,Q.Syt)(d);d!==l&&(r=r.offset(s?d-l:0,s?0:d-l,!0))}}return r}function O(t,n,e,i,r,o,a,u,s,c,f,l){var l,l,h,d,v,m,c,t;if(n&&!l){if(3===(l=r.Tyt())||s&&2===l||!s&&1===l)return r;if(l=s?r.rowRelative:r.columnRelative,h=s?r.endRowRelative:r.endColumnRelative,d=s?r.row:r.column,v=s?r.endRow:r.endColumn,m=void 0,s&&0<=e||!s&&0<=i||!l||!h){if(c)m=y(t,n,s?e:i,d,l,v,h,o,a,u,s,f);else if(m=W(t,n,s?e:i,d,l,v,h,o,a,u,s,f),p(m))return(0,Q.Syt)(m);c=m.index,t=m.endIndex,c===d&&t===v||(r=r.offset2(s?c-d:0,s?0:c-d,s?t-v:0,s?0:t-v,e,i))}}return r}function V(t,n,e,i,r,o,a,u,s,c){if(n){var n=r;if(n&&o===n.source)return n.offsetWhenInsertRemoveColumn(a,u,s,c)}return r}function S(t,n,e,i,r,o,a,u,s,c,f,l){var h,d,v,m,g,p,b,y,w,M,h=S,d=i;if(i){if(1===i.type&&i.hmt())d=j(t,i.source||t,n,e,i,r,o,a,u,s,f,l);else if(1===i.type)d=O(t,i.source||t,n,e,i,r,o,a,u,s,f,l);else if(10===i.type)(v=h(t,n,e,i.value,r,o,a,u,s,K,f,l))!==i.value&&(d=(0,Q.Ayt)(v));else if(9===i.type)m=h(t,n,e,i.value,r,o,a,u,s,K,f,l),g=i.value2&&h(t,n,e,i.value2,r,o,a,u,s,K,f,l),m===i.value&&g===i.value2||(d=(0,Q.rbt)(i.operatorType,m,g));else if(7===i.type){for(p=L,y=b=void 0,M=(w=i).arguments.length,y=0;y<M;y++)if((v=h(t,n,e,b=w.arguments[y],r,o,a,u,s,K,f,l))!==b){(p=[])[y]=v;break}if(p){for(y=0;y<M;y++)b=w.arguments[y],p[y]!==K&&p[y]!==L||(p[y]=h(t,n,e,b,r,o,a,u,s,K,f,l));d=(0,Q.YJ)(w,p)}}else f&&!t.Iyt||u||13!==i.type||(d=V(t,t,n,e,i,r,o,a,s,f));return d}}function f(r,o,a,u,t,n,e,i,s,c,f){var l,h,d,h,l=function(t,n,e,i){return o.call(this,t,e,i,n,r,a,u,s,c,K,f)},h=r.getSheet(),d=h.b8&&(h.parent||h).xyt(),h=h.Ut&&h.Ut.pj();v(d,l,s,h)}function v(t,n,e,i){var r,r,o,a,u,s,c,f,l,h,d,v,m,u,g,p,b,y,w,M;if(t)for(s=0;s<t.length;s++){for(f=c=!0,l=C.maxRowCount-1,h=C.maxColumnCount-1,v=0,m=(d=(r=t[s].validator)._S).length;v<m&&(g=(u=d[v]).rowCount,p=u.colCount,a=u.row,u=u.col,-1!==g&&(f=!1,l=a<l?a:l),-1!==p&&(c=!1,h=u<h?u:h),c||f);v++);if(!(e&&f||!e&&c)&&(b=(o=t[s].sheet).Uw(),(y=(r=r.condition()).getExpressions())&&0<y.length)){for(w=0;w<y.length;w++)M=y[w],y[w]=n(b,M,l,h);r.setExpressions(y,i)}}}function l(t){var e,n,i,e=[],n=t.parent,i;return(n&&n.sheets||[t]).forEach(function(n){var t=n.conditionalFormats,t=t&&t.getRules();t&&t.length&&t.forEach(function(t){t.KK&&e.push({rule:t,sheet:n})})}),e}function h(r,o,a,u,s,c){var t,n,e,i,t=function(t,n,e,i){return o.call(this,t,e,i,n,r,a,u,s,c)},n=r.getSheet(),e,i;d(l(n),t,n.Ut&&n.Ut.pj(),s,c)}function d(t,n,e,i,r){var o,a,u,s,c,f,l,c,h,d,v,s,m,g,p,b,y,w,M,C,S,T,A,I,S,x,N,k;if(t)for(o=0,a=t.length;o<a;o++){if(s=(u=t[o].rule).ranges(),f=(c=D(s)).r,l=c.c,h=(c=t[o].sheet).Uw(),d=u.condition(),(v=c.tables)&&s&&1===s.length&&(m=(s=s[0]).row,g=s.col,p=s.rowCount,b=s.colCount,y=void 0,r&&i?y=v.AJ(m,g,p,b):c.EB&&c.Nyt&&(y=[c.Nyt]),y)&&y.length){for(w=!1,M=0,C=y.length;M<C;M++)if(T=(S=y[M]).row,A=S.col,I=S.rowCount,S=S.colCount,m===T&&p===I&&A<=g&&g+b<=A+S){w=!0;break}if(w)continue}if(d||(u.initCondition(),d=u.condition()),(x=d&&d.getExpressions())&&0<x.length){for(N=0;N<x.length;N++)k=x[N],x[N]=n(h,k,f,l);d.setExpressions(x,e)}}}function Y(t,r,o){var n,t,e,n=function(t,n,e,i){return U.call(this,t,e,i,n,r,o)},t=t.getSheet(),e;d(l(t),n,t.Ut.pj())}function Z(t,n,e,i,r,o,a,u,s,c){var f,l,t,o,n;if(0<=e||!r){if(f=i+(r?e:0),l=s&&M(o,t,s),t=!s&&M(o,t,s),(l||t)&&a<=e&&(f+=r?u:0),l=s&&M(o,n,s),t=!s&&M(o,n,s),l||t)if(o=e+i,n=e+u+i,!c&&a+u<=f||c&&a+u<=o)f-=u;else if(!c&&a<=f||c&&a<=o&&a<=n&&n<=a+u)return w;return f-=r?e:0,c&&a<=e&&(f-=r?u:0),f}return i}function M(t,n,e){var e=e?{2:!0}:{1:!0};return t===n||t.Mf===n.Mf&&(3===t.nT&&e[n.nT]||e[t.nT]&&3===n.nT)}function W(t,n,e,i,r,o,a,u,s,c,f,l){var h,d,v,m,t,u,n;if(0<=e||!r){if(h=i+(r?e:0),d=o+(a?e:0),v=s+c-1,m=f&&M(u,t,f),t=!f&&M(u,t,f),(m||t)&&s<=e&&(h+=r?c:0,d+=a?c:0),m=f&&M(u,n,f),t=!f&&M(u,n,f),m||t)if(u=e+i,n=e+o,!l&&v<h||l&&v<u)h-=c,d-=c;else{if(!l&&s<=h&&d<=v||l&&s<=u&&n<=v)return w;!l&&d<s||l&&n<s||(!l&&v<=d||l&&v<=n?(h=!l&&h<=s||l&&u<=s?h:s,d-=c):d=s-1)}return h-=r?e:0,d-=a?e:0,l&&s<=e&&(h-=r?c:0,d-=r?c:0),{index:h,endIndex:d}}return{index:i,endIndex:o}}function q(t,n,e){var i,r,o,a,u,s,c,f,c,c,f,c,l,h,f,c,d,v,i=q,r=n;if(n)if(n.source)if(s=n.source,(c=n.endSource)&&s!==c){if(!(f=s.Mf&&s.Mf.parent))return Q.kyt;c===e?(c=e.S3,r.endSource=f.getSheet(c-1).Uw()):s===e&&(c=e.S3,r.source=f.getSheet(c).Uw()),delete e.S3,r.source===r.endSource&&delete r.endSource}else(t!==e&&s===e||t===e&&s!==e)&&(r=Q.kyt);else if(10===n.type)(o=i(t,n.value,e))!==n.value&&(r=(0,Q.Ayt)(o));else if(9===n.type)f=i(t,n.value,e),c=n.value2&&i(t,n.value2,e),f===n.value&&c===n.value2||(r=(0,Q.rbt)(n.operatorType,f,c));else if(7===n.type){for(l=L,h=n.arguments.length,u=0;u<h;u++)if((o=i(t,a=n.arguments[u],e))!==a){(l=[])[u]=o;break}if(l){for(u=0;u<h;u++)a=n.arguments[u],l[u]!==K&&l[u]!==L||(l[u]=i(t,a,e));r=(0,Q.YJ)(n,l)}}else 8===n.type&&(f=t||e,c=m(n.value),s=(d=f.getCustomName(c))&&d.source||(d=(v=f.Lbt.getGlobalSourceModel()||f.getCalcSourceModel()).getSource().getCustomName(c))&&d.source?d.source:s)&&(t!==e&&s===e||t===e&&s!==e)&&(r=Q.kyt);return r}function _(t,n,e,i,r){return q(t,i,r)}function $(t,n){return t.yyt===t.gyt&&n!==t.yyt}function tt(t,n,e,i,r,o){var a,u,s,c,f,l,h,d,v,h,m,g,p,g,m,p,v,a=!!i.source,u=i.source||t,s=i.rowRelative,c=i.columnRelative,v=n,h=e,m=r.yyt.Mf;if(o&&o.isCustomName&&(g=i.row,p=i.column,v=r.wyt+(g-r.pyt)+m.lT(r.wyt,g-r.pyt+1,!0),h=r.Myt+(p-r.byt)+m.lT(r.Myt,p-r.byt+1)),g=r.Dyt(v),m=r._yt(h),(0<=n||!s)&&(0<=e||!c)){if(f=i.row+(s?n:0),l=i.column+(c?e:0),o&&o.isNameID||t===r.gyt&&(d=t===r.yyt?r.Eyt(r.yyt,n,e,1,1):(p=n,v=e,o&&o.crossSheetMoved&&(p-=g,v-=m),r.jyt(r.gyt,p,v,1,1))),u===r.yyt&&r.Eyt(u,f,l,1,1)&&!r.jyt(u,f,l,1,1)&&(!s&&!c||!d))return Q.kyt;if(h=(a&&u===r.gyt||!a&&t===r.gyt)&&(!d&&r.jyt(r.gyt,f,l,1,1)||d&&r.Eyt(r.yyt,s?f:f+g,c?l:l+m,1,1)),d&&(f-=s?g:0,l-=c?m:0),h&&(f+=g,l+=m),l-=c?e:0,u=i.source,r.gyt!==r.yyt&&(h&&d?a&&(u=r.yyt):h?u=r.yyt:d&&!a&&(u=r.gyt)),(f-=s?n:0)!==i.row||l!==i.column||u!==i.source)return(0,Q.knt)(u,L,f,l,s,c)}else if((0<=n||!s)&&-1===e){if(f=i.row+(s?n:0),r.Eyt(t,n,e,1,1)&&(f-=s?g:0),r.jyt(u,f,-1,1,-1))f+=g;else if(r.Eyt(u,f,-1,1,-1))return Q.kyt;if((f-=s?n:0)!==i.row)return(0,Q.knt)(i.source,L,f,i.column,s,i.columnRelative)}else if(-1===n&&0<=e&&!c){if(l=i.column+(c?e:0),r.Eyt(t,n,e,1,1)&&(l-=c?m:0),r.jyt(u,f,l,1,1))l+=m;else if(r.Eyt(u,f,l,1,1))return Q.kyt;if(l-=c?e:0,f!==i.row||l!==i.column)return(0,Q.knt)(i.source,i.endSource,i.row,l,i.rowRelative,c)}return i}function T(t,n){var e,i,r,o;return(n=t.getIntersect(n,0,0))?(e=t.row,i=t.col,r=t.rowCount,o=t.colCount,t.rowCount===n.rowCount&&t.colCount===n.colCount||(t.rowCount===n.rowCount?(t.col===n.col&&(i=t.col+n.colCount),o=t.colCount-n.colCount):t.colCount===n.colCount&&(t.row===n.row&&(e=t.row+n.rowCount),r=t.rowCount-n.rowCount)),(0,R.Ec)(e,i,r,o)):L}function nt(t,n,e,i,r){var t,o;return n&&t&&(!(t=n.getIntersect(t,0,0))&&(o=n.getIntersect(e,0,0))||!!(t&&t.rowCount===n.rowCount&&0!==r||t.colCount===n.colCount&&0!==i))}function et(t,n,e){var t=t.getRange(n,e);return(0,R.Ec)(t.row,t.col,t.rowCount,t.colCount)}function I(t,n,e,i){var n,r,n=T(t,n);return n?(r=n.union(e),i?(r.col=t.col,r.colCount=t.colCount):(r.row=t.row,r.rowCount=t.rowCount)):r=e,{startRow:r.row,endRow:r.row+r.rowCount-1,startColumn:r.col,endColumn:r.col+r.colCount-1}}function x(t,n,e,i,r){var o,t,n,o=T(t,n),t=t.getIntersect(n,0,0);return t?(t.row+=i,t.col+=r,{startRow:(n=o?o.union(t):e).row,endRow:n.row+n.rowCount-1,startColumn:n.col,endColumn:n.col+n.colCount-1}):L}function it(t,n){var e,i,r,t,o,a,u,n,e=t.row,i=t.col,r=t.rowCount,t=t.colCount,o=n.row,a=n.col,u=n.rowCount,n=n.colCount;return 1===r&&1!==t?a<i&&i<=a+n-1||a<=i+t-1&&i+t-1<a+n-1:1!==t||1===r||o<e&&e<=o+u-1||o<=e+r-1&&e+r-1<o+u-1}function rt(t,n,e,i,r,o){var i,r,o,a,u,s,c,f,l,h,d,v,t,m,g,p,b,y,i=et(i,r,o),r=i.row,o=i.row+i.rowCount-1,a=i.col,u=i.col+i.colCount-1,s=t.pyt,c=s+t.Sx-1,f=t.byt,l=f+t.Cyt-1,h=t.wyt,d=t.Myt,v=(0,R.Ec)(s,f,t.Sx,t.Cyt),t=(0,R.Ec)(h,d,t.Sx,t.Cyt),m=i.getIntersect(t,0,0);if(nt(v,i,t,n,e))if(y=b=void 0,p=0!==n)if(y=s<=o&&o<=c,(b=s<=r&&r<=c)&&y)r+=n,o+=n;else if(b&&!y){if(n<=0)r+=n;else if(!(o<s+n)){if(!(c+n<o))return x(i,v,t,n,e);if(s===r)return I(i,v,t,p);r+=n}}else if(!b&&y){if(0<=n)o+=n;else if(!(c+n<r)){if(!(r<h))return x(i,v,t,n,e);if(c===o)return I(i,v,t,p);o+=n}}else m&&!m.equals(t)&&it(i,t)&&(r=(g=T(i,m)).row,o=g.row+g.rowCount-1,a=g.col,u=g.col+g.colCount-1);else if(y=f<=u&&u<=l,(b=f<=a&&a<=l)&&y)a+=e,u+=e;else if(b&&!y){if(e<0)a+=e;else if(!(u<f+e)){if(!(l+e<u))return x(i,v,t,n,e);if(f===a)return I(i,v,t,p);a+=e}}else if(!b&&y){if(0<e)u+=e;else if(!(l+e<a)){if(!(a<d))return x(i,v,t,n,e);if(l===u)return I(i,v,t,p);u+=e}}else m&&!m.equals(t)&&it(i,t)&&(r=(g=T(i,m)).row,o=g.row+g.rowCount-1,a=g.col,u=g.col+g.colCount-1);return{startRow:r,endRow:o,startColumn:a,endColumn:u}}function s(t,n,e,i){return n<e||e+i-1<t}function ot(t,n,e,i){return e<=t&&n<=e+i-1}function at(t,n,e,i){return t<e&&e+i-1<n}function ut(t,n,e,i){return e===t&&e+i-1<n||t<e&&e+i-1===n}function st(t,n,e,i){return e<t&&t<=e+i-1&&e+i-1<n||t<e&&e<=n&&n<e+i-1}function N(t,n,e,i,r){return e<=t&&r<=t||n<=e+i-1&&n<=r+i-1}function ct(t,n,e,i,r){for(var o,a,u,o=[s,ot,at,ut,st],u=0;u<o.length;u++)if(o[u](t,n,e,i)){a=u+"_";break}if(e===r)a+="9";else for(u=0;u<o.length;u++)if(e!==r&&o[u](t,n,r,i)){a+=u;break}return a}function ft(t,n,e,i,r){return{row:g(t.startRow,n),col:g(t.startColumn,e),endRow:J(t.endRow,i),endCol:J(t.endColumn,r)}}function lt(t,n,e,i,r){return t===r.yyt&&r.wyt<=n&&n<=r.Sx+r.wyt-1&&r.Myt<=e&&e<=r.Cyt+r.Myt-1&&(n=n+r.pyt-r.wyt,e=e+r.byt-r.Myt),{startRow:i.row+(i.rowRelative?n:0),endRow:i.endRow+(i.endRowRelative?n:0),startColumn:i.column+(i.columnRelative?e:0),endColumn:i.endColumn+(i.endColumnRelative?e:0)}}function E(t,n,e,i,r,o,a,u,s){return B(o)&&(o=n.startRow),B(a)&&(a=n.startColumn),B(u)&&(u=n.endRow),B(s)&&(s=n.endColumn),(0,Q.lJ)(r||t.source,L,t.rowRelative?o-e:o,t.columnRelative?a-i:a,t.endRowRelative?u-e:u,t.endColumnRelative?s-i:s,t.rowRelative,t.columnRelative,t.endRowRelative,t.endColumnRelative,e,i)}function ht(t,n,e,i,r){var o,t,a,u,t,s,c,f,l,h,d,v,o=lt(t,n,e,i,r),t=i.source||t;if(r.gyt===t&&r.yyt===t)switch(t=(a=ct(o.startRow,o.endRow,r.pyt,r.Sx,r.wyt))+"-"+(u=ct(o.startColumn,o.endColumn,r.byt,r.Cyt,r.Myt)),s=r.wyt-r.pyt,c=r.Myt-r.byt,f=ft(o,r.pyt,r.byt,r.pyt+r.Sx-1,r.byt+r.Cyt-1),v=d=h=l=void 0,t){case b.outToCover+"-"+b.outToCover:case b.crossToCover+"-"+b.outToCover:case b.outToCover+"-"+b.crossToCover:case b.crossToCover+"-"+b.crossToCover:case b.coverToCover+"-"+b.outToCover:case b.outToCover+"-"+b.coverToCover:case b.coverNoMove+"-"+b.outToCover:case b.outToCover+"-"+b.coverNoMove:return Q.kyt;case b.outToCross+"-"+b.outToCover:case b.coverToCross+"-"+b.outToCover:case b.insideToCross+"-"+b.outToCover:case b.partToCross+"-"+b.outToCover:case b.crossToCross+"-"+b.outToCover:case b.crossNoMove+"-"+b.outToCover:case b.outToCross+"-"+b.coverNoMove:case b.outToCross+"-"+b.coverToCover:case b.outToCross+"-"+b.crossToCover:case b.insideToCross+"-"+b.coverNoMove:case b.insideToCross+"-"+b.coverToCover:case b.insideToCross+"-"+b.crossToCover:return r.wyt<=o.startRow?E(i,o,n,e,L,r.wyt+r.Sx):E(i,o,n,e,L,L,L,r.wyt-1);case b.outToCover+"-"+b.outToCross:case b.outToCover+"-"+b.coverToCross:case b.outToCover+"-"+b.insideToCross:case b.outToCover+"-"+b.partToCross:case b.outToCover+"-"+b.crossToCross:case b.outToCover+"-"+b.crossNoMove:case b.coverNoMove+"-"+b.outToCross:case b.coverToCover+"-"+b.outToCross:case b.crossToCover+"-"+b.outToCross:case b.coverNoMove+"-"+b.insideToCross:case b.coverToCover+"-"+b.insideToCross:case b.crossToCover+"-"+b.insideToCross:return r.Myt<o.startColumn?E(i,o,n,e,L,L,r.Myt+r.Cyt):E(i,o,n,e,L,L,L,L,r.Myt-1);case b.partToOut+"-"+b.coverNoMove:case b.crossToOut+"-"+b.coverNoMove:if(!N(o.startRow,o.endRow,r.pyt,r.Sx,r.wyt))return E(i,o,n,e);case b.coverNoMove+"-"+b.partToOut:case b.coverNoMove+"-"+b.crossToOut:if(a===b.coverNoMove&&!N(o.startColumn,o.endColumn,r.byt,r.Cyt,r.Myt))return E(i,o,n,e);case b.crossToInside+"-"+b.coverNoMove:case b.coverNoMove+"-"+b.crossToInside:return o.startRow>=r.pyt&&u===b.coverNoMove||o.startColumn>=r.byt&&a===b.coverNoMove?E(i,o,n,e,L,f.row+s,f.col+c):E(i,o,n,e,L,L,L,f.endRow+s,f.endCol+c);case b.partToInside+"-"+b.coverNoMove:return o.startRow>=r.pyt?E(i,o,n,e,L,J(f.row+s,f.endRow+1)):E(i,o,n,e,L,L,L,g(f.endRow+s,f.row-1));case b.coverNoMove+"-"+b.partToInside:return o.startColumn>=r.byt&&a===b.coverNoMove?E(i,o,n,e,L,L,J(f.col+c,f.endCol+1)):E(i,o,n,e,L,L,L,L,g(f.endCol+c,f.col-1));case b.partToCross+"-"+b.coverNoMove:case b.crossToPart+"-"+b.coverNoMove:case b.crossToCross+"-"+b.coverNoMove:if(N(o.startRow,o.endRow,r.pyt,r.Sx,r.wyt))return o.startRow>=r.pyt?E(i,o,n,e,L,f.row+s):E(i,o,n,e,L,L,L,f.endRow+s);case b.crossToCover+"-"+b.coverNoMove:case b.partToPart+"-"+b.coverNoMove:return r.pyt<r.wyt?E(i,o,n,e,L,J(f.row+s,f.endRow+1),L,f.endRow+s):E(i,o,n,e,L,f.row+s,L,g(f.endRow+s,f.row-1));case b.coverNoMove+"-"+b.partToCross:case b.coverNoMove+"-"+b.crossToPart:case b.coverNoMove+"-"+b.crossToCross:if(N(o.startColumn,o.endColumn,r.byt,r.Cyt,r.Myt))return o.startColumn>=r.byt?E(i,o,n,e,L,L,f.col+c):E(i,o,n,e,L,L,L,L,f.endCol+c);case b.coverNoMove+"-"+b.crossToCover:case b.coverNoMove+"-"+b.partToPart:return r.byt<r.Myt?E(i,o,n,e,L,L,J(f.col+c,f.endCol+1),L,f.endCol+c):E(i,o,n,e,L,L,f.col+c,L,g(f.endCol+c,f.col-1));case b.crossToCross+"-"+b.coverToCover:case b.crossToPart+"-"+b.coverToCover:case b.partToCross+"-"+b.coverToCover:if(N(o.startRow,o.endRow,r.pyt,r.Sx,r.wyt))return E(i,o,n,e);case b.coverToCover+"-"+b.crossToCross:case b.coverToCover+"-"+b.crossToPart:case b.coverToCover+"-"+b.partToCross:if(a===b.coverToCover&&N(o.startColumn,o.endColumn,r.byt,r.Cyt,r.Myt))return E(i,o,n,e);case b.coverToCover+"-"+b.partToPart:case b.partToPart+"-"+b.coverToCover:case b.coverToCover+"-"+b.crossToCover:case b.crossToCover+"-"+b.coverToCover:return E(i,o,n,e,L,f.row+s,f.col+c,f.endRow+s,f.endCol+c);case b.partToPart+"-"+b.crossToCover:case b.partToCross+"-"+b.crossToCover:case b.crossToPart+"-"+b.crossToCover:case b.crossToCross+"-"+b.crossToCover:return N(o.startRow,o.endRow,r.pyt,r.Sx,r.wyt)?E(i,o,n,e):(h=f.row===o.startRow?f.col===o.startColumn?(d=o.endColumn,v=f.col+c,l=f.endRow+s,f.row+s):(d=o.startColumn,v=f.endCol+c,l=a===b.partToCross||a===b.crossToCross?r.pyt+s-1:o.endRow,o.startRow):f.col===o.startColumn?(d=o.endColumn,v=f.col+c,l=o.endRow,a===b.partToCross||a===b.crossToCross?r.pyt+r.Sx-1+s+1:o.startRow):(d=o.startColumn,v=f.endCol+c,l=a===b.partToCross||a===b.crossToCross?f.row+s:o.startRow,f.endRow+s),E(i,o,n,e,L,J(l,h),J(d,v),g(l,h),g(d,v)));case b.crossToCover+"-"+b.partToPart:case b.crossToCover+"-"+b.partToCross:case b.crossToCover+"-"+b.crossToPart:case b.crossToCover+"-"+b.crossToCross:return N(o.startColumn,o.endColumn,r.byt,r.Cyt,r.Myt)?E(i,o,n,e):(h=f.row===o.startRow?(l=(v=f.col===o.startColumn?(d=f.endCol+c,f.col+c):(d=o.endColumn,u===b.partToCross||u===b.crossToCross?r.byt+r.Cyt-1+c+1:o.startColumn),o.endRow),f.row+s):f.col===o.startColumn?(d=o.startColumn,v=u===b.partToCross||u===b.crossToCross?r.byt+c-1:o.endColumn,l=f.endRow+s,o.startRow):(d=u===b.partToCross||u===b.crossToCross?f.col+c:o.startColumn,v=f.endCol+c,l=o.startRow,f.endRow+s),E(i,o,n,e,L,J(l,h),J(d,v),g(l,h),g(d,v)));case b.coverToOut+"-"+b.coverToOut:case b.coverToOut+"-"+b.coverToCross:case b.coverToOut+"-"+b.coverToCover:case b.coverToOut+"-"+b.coverNoMove:case b.coverToCross+"-"+b.coverToOut:case b.coverToCross+"-"+b.coverToCross:case b.coverToCross+"-"+b.coverToCover:case b.coverToCross+"-"+b.coverNoMove:case b.coverToCover+"-"+b.coverToOut:case b.coverToCover+"-"+b.coverToCross:case b.coverToCover+"-"+b.coverToCover:case b.coverToCover+"-"+b.coverNoMove:case b.coverNoMove+"-"+b.coverToOut:case b.coverNoMove+"-"+b.coverToCross:case b.coverNoMove+"-"+b.coverToCover:return E(i,o,n,e,L,o.startRow+s,o.startColumn+c,o.endRow+s,o.endColumn+c);default:return E(i,o,n,e)}}function dt(t,n,e,i,r,o,a,u){var s,c,f,l,h,d,v,m,g,p,b,y,w,M,C,S,T,A,I,x,N,w,k,D,w,M,_,E,o,w,M,C,_,E,o,M,C,s=!!i.source,c=s?i.source:t,w=o&&o.isDataValidator,M=$(r,t),C=!1,f=i.rowRelative,l=i.columnRelative,h=i.endRowRelative,d=i.endColumnRelative;if(0<=n||!f||!h||0<=e||!l||!d){if(v=i.row+(f?n:0),m=i.endRow+(h?n:0),g=i.column+(l?e:0),b=m-v+1,y=(p=i.endColumn+(d?e:0))-g+1,!w&&M){if(D=r.jyt(c,v,g,b,y))return i.offset(a,u,!0,n,e);if(r.Eyt(c,v,g,b,y))return Q.kyt;if(c!==r.gyt||c!==r.yyt||0!==a&&0!==u)return i;C=!0}if(o&&o.isNameID||t===r.gyt&&(k=t===r.yyt?r.Eyt(r.yyt,n,e,1,1):(w=n,M=e,o&&o.crossSheetMoved&&(w-=a,M-=u),r.jyt(r.gyt,w,M,1,1))),(C||t===c&&t===r.gyt&&t===r.yyt)&&(_=n,E=e,k&&(_-=a,E-=u),0===a||0===u)){if(!(o=rt(r,a,u,i,_,E)))return Q.kyt;if(0===u&&a&&o.endColumn>=p&&o.startColumn<=g||0===a&&u&&o.endRow>=m&&o.startRow<=v)return w=o.startRow,M=o.startColumn,C=o.endRow,_=o.endColumn,w===v&&C===m&&M===g&&_===p?i:(f&&(w-=n),h&&(C-=n),l&&(M-=e),d&&(_-=e),(0,Q.lJ)(i.source,L,w,M,C,_,f,l,h,d,n,e))}if(k&&(E=r.wyt-r.pyt,o=r.Myt-r.byt,b+=(f?-E:0)+(h?E:0),y+=(l?-o:0)+(d?o:0)),c===r.yyt&&r.Eyt(c,v,g,b,y)&&!y&&(!f&&!l&&!h&&!d||!k))return Q.kyt;if(w=(s&&c===r.gyt||!s&&t===r.gyt)&&(!k&&r.jyt(r.gyt,v,g,b,y)||k&&r.Eyt(r.yyt,f?v:v+a,l?g:g+u,b,y)),k&&(v-=A=f?a:0,m-=I=h?a:0,g-=x=l?u:0,p-=N=d?u:0),M=!1,w)v+=S=a,m+=S,g+=T=u,p+=T;else if(r.Eyt(c,v,g,b,y)){if(!(C=r.intersectWith(c,v,g,b,y))||C.rowCount!==b&&C.colCount!==y)return Q.kyt;v=C.row+a,g=C.col+u,m=v+C.rowCount,p=g+C.colCount,M=!0}return m-=h?n:0,g-=l?e:0,p-=d?e:0,r.gyt===r.yyt?c=s?i.source:K:(c=i.source,w&&k&&s?c=r.yyt:w&&k||(w?c=r.yyt:k&&!s&&(c=r.gyt))),(v-=f?n:0)!==i.row||g!==i.column||m!==i.endRow||p!==i.endColumn||M||c!==i.source?(0,Q.lJ)(c,L,v,g,m,p,f,l,h,d,n,e):void 0}if((0<=n||!f||!h)&&-1===e){if(v=i.row+(f?n:0),(m=i.endRow+(h?n:0))<v)return Q.kyt;if(r.Eyt(t,n,e,1,1)&&(v-=A=f?a:0,m-=I=h?a:0),r.jyt(c,v,-1,b=m-v+1,-1))v+=S=a,m+=S;else if(r.Eyt(c,v,-1,b,-1))return Q.kyt;return m-=h?n:0,(v-=f?n:0)!==i.row||m!==i.endRow?(0,Q.lJ)(i.source,L,v,i.column,m,i.endColumn,f,i.columnRelative,h,i.endColumnRelative,n,e):void 0}if(-1===n&&(0<=e||!l||!d)){if(g=i.column+(l?e:0),(p=i.endColumn+(d?e:0))<g)return Q.kyt;if(r.Eyt(t,n,e,1,1)&&(g-=x=l?u:0,p-=N=d?u:0),r.jyt(c,-1,g,-1,y=p-g+1))g+=T=u,p+=T;else if(r.Eyt(c,-1,g,-1,y))return Q.kyt;return p-=d?e:0,(g-=l?e:0)!==i.column||p!==i.endColumn?(0,Q.lJ)(i.source,L,i.row,g,i.endRow,p,i.rowRelative,l,i.endRowRelative,d,n,e):void 0}}function vt(t,n,e,i,r,o){var a,u,s,c,f,l,h,d,v,m,g,p,d,v,b,y,w,y,b,w,o,w,M,C,g,S,M,C,S,M,w,d,o,v,a,u=!!i.source?i.source:t,s=i.Tyt(),d=n,v=e,b=r.yyt.Mf;if(o&&o.isCustomName&&(y=i.row,w=i.column,d=r.wyt+(y-r.pyt)+b.lT(r.wyt,y-r.pyt+1,!0),v=r.Myt+(w-r.byt)+b.lT(r.Myt,w-r.byt+1)),y=r.Dyt(d),b=r._yt(v),0===s){if(w=!r.Oyt&&ht(t,n,e,i,r))return w;if(w=dt(t,n,e,i,r,o,y,b))return w}else if(1===s){if(c=i.rowRelative,l=i.endRowRelative,0<=n||!c||!l){if(d=i.row+(c?n:0),(v=i.endRow+(l?n:0))<d)return Q.kyt;if(p=t===r.gyt&&t===r.yyt&&r.Eyt(r.yyt,n,e,1,1),u===r.gyt&&u===r.yyt&&0===r.byt&&0===r.Myt&&r.Cyt===u.getColumnCount()){if(o=r.pyt,w=r.wyt,p&&(d-=y,v-=y),C=o+(M=r.Sx),S=o<=v&&v<C,(g=o<=d&&d<C)&&S)return p?i:i.offset(y,b,!0,n,e);if(M=w+M,g&&w<=v?(d+=y,v<M&&w<=v&&(v=M-1,d=C)):S&&d<=M&&(v+=y,w<=d)&&m<M&&(d=w,v=o-1),v-=l?n:0,(d-=c?n:0)!==i.row||v!==i.endRow)return(0,Q.lJ)(i.source,i.endSource,d,A.BAND_INDEX_CONST,v,A.BAND_INDEX_CONST,c,f,l,h,n,e)}if(p)return i.offset(-y,b,!0,n,e)}}else if(2===s){if(f=i.columnRelative,h=i.endColumnRelative,m=i.column+(f?e:0),(g=i.endColumn+(h?e:0))<m)return Q.kyt;if(p=t===r.gyt&&t===r.yyt&&r.Eyt(r.yyt,n,e,1,1),u!==r.gyt||u!==r.yyt)return i.offset(y,-b,!1,n,e);if(0===r.pyt&&0===r.wyt&&r.Sx===u.getRowCount()){if(C=r.byt,S=r.Myt,p&&(m-=f?b:0,g-=h?b:0),w=C+(M=r.Cyt),o=C<=g&&g<w,(d=C<=m&&m<w)&&o)return p&&f&&h?i:i.offset(y,b,!0,n,e);if(v=S+M,d&&S<=g)m+=b,g<v&&S<=g&&(g=v-1,m=w);else if(o&&m<=v)g+=b,S<=m&&m<v&&(m=S,g=C-1);else if(p)return i.offset(-y,-b,!1,n,e);if(g-=h?e:0,(m-=f?e:0)!==i.column||g!==i.endColumn)return(0,Q.lJ)(i.source,i.endSource,A.BAND_INDEX_CONST,m,A.BAND_INDEX_CONST,g,c,f,l,h,n,e)}if(p)return i.offset(y,-b,!0,n,e)}return i}function U(t,n,e,i,r,o,a){var u,s,c,f,l,h,d,v,m,u=U,s=i;if(1===i.type&&i.hmt())s=o?tt(t,n,e,i,r,a):gt(t,n,e,i,r);else if(1===i.type)s=o?vt(t,n,e,i,r,a):pt(t,n,e,i,r);else if(10===i.type)(c=u(t,n,e,i.value,r,o,a))!==i.value&&(s=(0,Q.Ayt)(c));else if(9===i.type)f=u(t,n,e,i.value,r,o,a),l=i.value2&&u(t,n,e,i.value2,r,o,a),f===i.value&&l===i.value2||(s=(0,Q.rbt)(i.operatorType,f,l));else if(7===i.type){for(h=L,v=d=void 0,m=i.arguments.length,v=0;v<m;v++)if((c=u(t,n,e,d=i.arguments[v],r,o,a))!==d){(h=[])[v]=c;break}if(h){for(v=0;v<m;v++)d=i.arguments[v],h[v]!==K&&h[v]!==L||(h[v]=u(t,n,e,d,r,o,a));s=(0,Q.YJ)(i,h)}(0,Q.isExpression)(i.function)&&(s.function=u(t,n,e,i.function,r,o,a))}return s}function mt(t,n,e){var i,r,o,a,u,u,s,c,f,l,u,h,d,v,i=n.gyt.getSheet();if(!0!==i.EB)for(r=i.Ut.pj(),o=0;o<t.length;o++)if(u=(a=t[o].validator)._S,s=(u=D(u)).r,c=u.c,l=(f=t[o].sheet).Uw(),(h=(u=a.condition()).getExpressions())&&0<h.length){for(d=0;d<h.length;d++)v=h[d],h[d]=U(l,s,c,v,n,e,{isDataValidator:!0});u.setExpressions(h,r)}}function gt(t,n,e,i,r){var o,a,u,s,c,f,l,o=i.source||t,a=i.rowRelative,u=i.columnRelative,f=r.Dyt(n),l=r._yt(e);if((0<=n||!a)&&(0<=e||!u)){if(s=i.row+(a?n:0),c=i.column+(u?e:0),r.Eyt(t,n,e,1,1)?(s-=a?f:0,c-=u?l:0):r.jyt(t,s,c,1,1)&&(s+=a?f:0,c+=u?l:0),r.jyt(o,s,c,1,1)?(s+=f,c+=l):r.Eyt(o,s,c,1,1)&&(s-=f,c-=l),c-=u?e:0,(s-=a?n:0)!==i.row||c!==i.column)return(0,Q.knt)(i.source,L,s,c,a,u)}else if((0<=n||!a)&&-1===e){if(s=i.row+(a?n:0),r.Eyt(t,n,-1,1,-1)?s-=a?f:0:r.jyt(t,s,-1,1,-1)&&(s+=a?f:0),r.jyt(o,s,-1,1,-1)?s+=f:r.Eyt(o,s,-1,1,-1)&&(s-=f),(s-=a?n:0)!==i.row||c!==i.column)return(0,Q.knt)(i.source,L,s,i.column,a,i.columnRelative)}else if(-1===n&&0<=e&&!u&&(c=i.column+0,r.Eyt(t,-1,e,-1,1)?c-=0:r.jyt(t,-1,c,-1,1)&&(c+=0),r.jyt(o,-1,c,-1,1)?c+=l:r.Eyt(o,-1,c,-1,1)&&(c-=l),c-=0,s!==i.row||c!==i.column))return(0,Q.knt)(i.source,L,i.row,c,i.rowRelative,u);return i}function pt(t,n,e,i,r){var o,a,u,s,c,f,l,h,d,v,m,g,p,b,y,w,M,C,S,T,o=i.source||t,a=i.Tyt(),S=r.Dyt(n),T=r._yt(e);if(0===a){if(d=i.rowRelative,v=i.columnRelative,m=i.endRowRelative,g=i.endColumnRelative,!(0<=n)&&d&&m||!(0<=e)&&v&&g)if(!(0<=n)&&d&&m||-1!==e){if(-1===n&&(0<=e||!v||!g)){if((c=i.column+(v?e:0))<(f=i.endColumn+(g?e:0)))return Q.kyt;if(r.Eyt(t,-1,e,-1,1)?(c-=w=v?T:0,f-=C=g?T:0):r.jyt(t,-1,e,-1,1)&&(c+=w=v?T:0,f+=C=g?T:0),r.jyt(o,-1,c,-1,h=f-c)?(c+=b=T,f+=b):r.Eyt(o,-1,c,-1,h)&&(c-=b=T,f-=b),f-=g?e:0,(c-=v?e:0)!==i.column||f!==i.endColumn)return(0,Q.lJ)(i.source,L,c,i.endRow,f,i.rowRelative,v,i.endRowRelative,g,n,e)}}else{if((u=i.row+(d?n:0))<(s=i.endRow+(m?n:0)))return Q.kyt;if(r.Eyt(t,n,-1,1,-1)?(u-=y=d?S:0,s-=M=d?S:0):r.jyt(t,n,-1,1,-1)&&(u+=y=d?S:0,s+=M=d?S:0),r.jyt(o,u,-1,l=s-u,-1)?(u+=p=S,s+=p):r.Eyt(o,u,-1,l,-1)&&(u-=p=S,s-=p),s-=m?n:0,(u-=d?n:0)!==i.row||s!==i.endRow)return(0,Q.lJ)(i.source,L,u,i.column,s,i.endColumn,d,i.columnRelative,m,i.endColumnRelative,n,e)}else if(u=i.row+(d?n:0),s=i.endRow+(m?n:0),c=i.column+(v?e:0),l=s-u,h=(f=i.endColumn+(g?e:0))-c,r.Eyt(t,n,e,1,1)?(u-=y=d?S:0,s-=M=m?S:0,c-=w=v?T:0,f-=C=g?T:0):r.jyt(t,u,c,l,h)&&(u+=y=d?S:0,s+=M=m?S:0,c+=w=v?T:0,f+=C=g?T:0),r.jyt(o,u,c,l,h)?(u+=p=S,s+=p,c+=b=T,f+=b):r.Eyt(o,u,c,l,h)&&(u-=p=S,s-=p,c-=b=T,f-=b),s-=m?n:0,c-=v?e:0,f-=g?e:0,(u-=d?n:0)!==i.row||c!==i.column||s!==i.endRow||f!==i.endColumn)return(0,Q.lJ)(i.source,L,u,c,s,f,d,v,m,g,n,e)}else if(1===a){if(d=i.rowRelative,m=i.endRowRelative,0<=n||!d||!m){if((u=i.row+(d?n:0))<(s=i.endRow+(m?n:0)))return Q.kyt;if(r.Eyt(t,n,-1,1,-1)?(u-=y=d?S:0,s-=M=m?S:0):r.jyt(t,n,-1,1,-1)&&(u+=y=d?S:0,s+=M=m?S:0),r.jyt(o,u,-1,l=s-u,-1)?(u+=p=S,s+=p):r.Eyt(o,u,-1,l,-1)&&(u-=p=S,s-=p),s-=m?n:0,(u-=d?n:0)!==i.row||s!==i.endRow)return(0,Q.lJ)(i.source,L,u,A.BAND_INDEX_CONST,s,A.BAND_INDEX_CONST,d,!1,m,!1,n,e)}}else if(2===a){if(v=i.columnRelative,g=i.endColumnRelative,c=i.column+(v?e:0),(f=i.endColumn+(g?e:0))<c)return Q.kyt;if(r.Eyt(t,-1,e,-1,1)?(c-=w=v?T:0,f-=C=g?T:0):r.jyt(t,-1,e,-1,1)&&(c+=w=v?T:0,f+=C=g?T:0),r.jyt(o,-1,c,-1,h=f-c)?(c+=b=T,f+=b):r.Eyt(o,-1,c,-1,h)&&(c-=b=T,f-=b),f-=g?e:0,(c-=v?e:0)!==i.column||f!==i.endColumn)return(0,Q.lJ)(i.source,L,A.BAND_INDEX_CONST,c,A.BAND_INDEX_CONST,f,!1,v,!1,g,n,e)}return i}function H(t,n,e,i,r,o){t.Ryt(n,e,i,r,!0,!1,o)}function bt(t,n,e){var i,r,o,a,u,s,c,f,l,i=bt,r=n;if(8===n.type){if(n.value===e&&(!n.source||n.source===t.getSource()))return(0,Q.Syt)(w,n.source)}else if(10===n.type)(o=i(t,n.value,e))!==n.value&&(r=(0,Q.Ayt)(o));else if(9===n.type)s=i(t,n.value,e),c=n.value2&&i(t,n.value2,e),s===n.value&&c===n.value2||(r=(0,Q.rbt)(n.operatorType,s,c));else if(7===n.type){for(f=L,l=n.arguments.length,u=0;u<l;u++)if((o=i(t,a=n.arguments[u],e))!==a){(f=[])[u]=o;break}if(f){for(u=0;u<l;u++)a=n.arguments[u],f[u]!==K&&f[u]!==L||(f[u]=i(t,a,e));r=(0,Q.YJ)(n,f)}}return r}Object.defineProperty(t,"__esModule",{value:!0}),t.adjustFormulaOnMoveSwap=t.CalcOperatorAdjustor=t.MoveSwapInfo=void 0,Q=n("CalcEngine"),e=n("Common"),A=n("./dist/plugins/sheetsCalc/calc.ns.js"),C=n("./dist/plugins/sheetsCalc/parser-sheets.js"),R=n("Core"),a=e.Common.lt.Dh,B=e.Common.lt.ht,n=e.Common.zf,m=n.Gmt,J=Math.min,g=Math.max,K=void 0,L=null,p=Q.Convert.BJ,w=Q.Errors.Reference,D=R.util.z0,r.prototype.Dyt=function(t){var n,e,t,e,n=this,e=n.yyt.Mf;return n.Oyt=e&&e.o5(),n.Oyt&&0<=t?(t=t-n.wyt+1,e=e.ix(n.wyt,t,!0),n.wyt-n.pyt+e):n.wyt-n.pyt},r.prototype._yt=function(t){var n,e,t,e,n=this,e=n.yyt.Mf;return n.Oyt=e&&e.o5(),n.Oyt&&0<=t?(t=t-n.Myt+1,e=e.ix(n.Myt,t),n.Myt-n.byt+e):n.Myt-n.byt},r.prototype.jyt=function(t,n,e,i,r){var o=this;return o.gyt===t&&(-1===o.pyt||o.pyt<=n&&n+i<=o.pyt+o.Sx)&&(-1===o.byt||o.byt<=e&&e+r<=o.byt+o.Cyt)},r.prototype.Eyt=function(t,n,e,i,r){var o,a,u,s,c,f,l,o=this,a=o.yyt.Mf,u=a&&a.o5(),s=o.wyt,c=o.Myt,f=o.Sx,l=o.Cyt;return u&&(f+=a.lT(s,f,!0),l+=a.lT(c,l)),o.yyt===t&&(-1===s||s<=n&&n+i<=s+f)&&(-1===c||c<=e&&e+r<=c+l)},r.prototype.intersectWith=function(t,n,e,i,r){var o,n,a,o=this;return o.yyt!==t?L:(n=o.Byt(t,n,e,i,r),(a=o.Byt(t,o.pyt,o.byt,i,r)).intersectWith(n))},r.prototype.Byt=function(t,n,e,i,r){var o,a,u,s,o,a,u,s;return{row:-1===n?0:n,column:-1===e?0:e,rowCount:-1===n||-1===i?t.rowCount:i,columnCount:-1===e||-1===r?t.colCount:r,intersectWith:c}},F=r,t.MoveSwapInfo=F,X.gB=function(t,n,e,i,r,o,a,u,s,c,f){var l,h,d,v,m,g,p,b,y,l=e,h=X,d=this.gB;if(e)if(10===(g=e.type))l=(0,Q.Ayt)(d.call(h,t,n,e.value,i,r,o,a,u,s,c,f));else if(1===g&&e.hmt()){if(v=J((e.source||n).getRowCount(),A.MAX_ROW_COUNT),m=J((e.source||n).getColumnCount(),A.MAX_COLUMN_COUNT),e.rowRelative&&(e.row+i<0||e.row+i>=v)||e.columnRelative&&(e.column+r<0||e.column+r>=m))return(0,Q.Syt)(w,e.source);l=e.offset(0,0,!1)}else if(1===g){if(v=J((e.source||n).getRowCount(),A.MAX_ROW_COUNT),m=J((e.source||n).getColumnCount(),A.MAX_COLUMN_COUNT),e.rowRelative&&!e.isFullColumn&&(e.row+i<0||e.row+i>v)||e.columnRelative&&!e.isFullRow&&(e.column+r<0||e.column+r>m)||e.endRowRelative&&!e.isFullColumn&&(e.endRow+i<0||e.endRow+i>v)||e.endColumnRelative&&!e.isFullRow&&(e.endColumn+r<0||e.endColumn+r>m))return(0,Q.Syt)(w,e.source,e.endSource);l=e.offset(0,0,!1,i,r)}else if(9===e.type)l=(0,Q.rbt)(e.operatorType,d.call(h,t,n,e.value,i,r,o,a,u,s,c,f),e.value2&&d.call(h,t,n,e.value2,i,r,o,a,u,s,c,f));else if(7===g){if(b=[],e.arguments&&0<e.arguments.length)for(y=0;y<e.arguments.length;y++)b[y]=d.call(h,t,n,e.arguments[y],i,r,o,a,u,s,c,f);l=(0,Q.YJ)(e,b)}else 13===g&&(l=e.offsetWhenCopy(t,n,i,r,o,a,u,s,c,f));return l},X.copyFormula=function(t,n,e,i,r,o,B,L,F,P){var G,a,U,u,H,s,c,f,l,h,d,v,m,g,p,b,y,w,M,z,C,V,Y,S,T,A,I,x,Z,W,N,k,D,_,_,_,_,E,j,_,O,R,G=t,a=i,U=t.getSource(),u=i.getSource(),H=X;if(G&&a){for(s=u&&u.getSheet().Ut.pj(),f=e,l=r,h=o,d=B,v=L,(c=n)<0&&(c=0,d=J(t.rC(),i.rC())),e<0&&(f=0,v=J(t.cC(),i.cC())),r<0&&(l=0),o<0&&(h=0),m=new Q.CalcSourceModel(t.op(),U),w=u.getSheet(),M=!P&&w.o5(),z=d,C=v,V=w.getRowCount(),Y=w.getColumnCount(),g=0;g<d;g++)for(p=0;p<v;p++)G.Lyt(m,g+c,p+f,g,p);for(S={},T=i.op(),b=g=0;g<d&&g+l<V;g++)if(A=g+l,M&&0===w.getRowHeight(A))d++;else{if(!F||!u.isHiddenRow(A,!0))for(y=p=0,v=C;p<v&&p+h<Y;p++)if(I=p+h,M&&0===w.getColumnWidth(I))v++;else{if(x=m.pB(b,y)){if(x===S)continue;if(x=H.gB(U,u,x,A,I,Z=r+g-n-b,W=o+p-e-y,r,o,z,C),N=m.sT(b,y),u){if(M&&N)continue;if(N&&!N.isDynamicArray){for(k=N.rowCount,D=N.colCount,0<(_=c-N.row)&&(k-=_),(_=d-g)<k&&(k=_),0<(_=f-N.col)&&(D-=_),(_=v-p)<D&&(D=_),E=0;E<k;E++)for(j=0;j<D;j++)m.bB(g+E,p+j,S);i.setArrayFormula(A,I,k,D,T.unparse(u,x,A,I),K,s)}else _=x?T.unparse(u,x,A,I):K,u.setFormula(A,I,_,K),(O=m.Fyt(b,y))&&(R=new Q.EvaluateContext(u,(0,Q.eV)(A,I),!1),O=(O=a.Lbt.allowDynamicArray?(0,Q.h0t)(R,x,!1,0,0,!0,!0):(0,Q.Pyt)(R,x,!1,0,0,!1,!1))===x?K:O),a.Gyt(A,I,x,O,N,s)}else a.bB(A,I,x),a.Uyt(A,I,N)}else a&&a.pB(A,I)&&a.Gyt(A,I,K,K,K,s);y++}b++}}},X.moveFormula=function(t,n,e,i,r,o,a,u){var s,c,f,l,h,d,v,m,g,p,t,b,y,w,M,C,S,T,A,I,x,N,k,D,_,E,j,O,j,p,t,s=t.b3(),c=i.b3(),f=s.op();if(s&&c){for(l=i.getRowCount(),h=i.getColumnCount(),d=s.pj(),v=c.pj(),m=f.Hyt(),n<0&&(n=0,a=J(t.getRowCount(),l)),r<0&&(r=0),e<0&&(e=0,u=J(t.getColumnCount(),h)),o<0&&(o=0),g=!(t===i&&t.name()===i.name()),t=u,b=p=a,(w=i.o5())&&(p+=i.lT(r,a,!0),t+=i.lT(o,u)),s.mF(n,e,a,u),H(s,n,e,a,u),c.mF(r,o,p,t),H(c,r,o,p,t),M=[],C=0;C<a;C++)for(S=0;S<u;S++)T=s.pB(C+n,S+e),A=s.sT(C+n,S+e),I=s.Fyt(C+n,S+e),T&&(M[C*u+S]={WK:T,$bt:A,eyt:I},s.zyt(C+n,S+e,d),A&&(C+n!==A.row||S+e!==A.col)||s.rT.setFormula(C+n,S+e,L,K));for(D=g?{}:null,x=C=0;C<b&&C+r<l;C++)if(_=C+r,w&&0===i.getRowHeight(_))b++;else{for(N=S=0,y=u;S<y&&o+S<h;S++)if(E=S+o,w&&0===i.getColumnWidth(E))y++;else{if(j=M[x*u+N]){if(T=j.WK,A=j.$bt,w&&A){N++;continue}f&&A&&!A.isDynamicArray&&A.row===n+C&&A.col===e+S&&(k=(0,R.Ec)(_,E,A.rowCount,A.colCount)),O=A&&!A.isDynamicArray?k:K,I=j.eyt,c.Vyt(v,_,E),c.bB(_,E,T),c.Uyt(_,E,O),c.Yyt(_,E,I),O&&(O.row!==_||O.col!==E)||(j=c.getFormula(_,E),c.rT.setFormula(_,E,j,O)),g&&(D[_+", "+E]=T)}else B(c.pB(_,E))||(c.Vyt(v,_,E),c.bB(_,E,K),c.Uyt(_,E,K));N++}x++}m.Zyt(s,n,e,a,u),m.Zyt(c,r,o,p,t),t=(p=s.getSource().getSheet()).b8&&(p.parent||p).xyt(),m.Wyt(t,s.getSource(),n,e,c.getSource(),r,o,a,u,!0,D),!0==g&&m.Wyt(t,s.getSource(),n,e,c.getSource(),r,o,a,u,!0,D)}},X.prototype.isAdjustCell=function(t){return t.preAdj||this.y3&&t===this.y3[0]},X.prototype.isAdjust=function(t){return t.preAdj||this.y3&&t===this.y3[0]},X.prototype.Qyt=function(t,n){var e=this,i,r;isNaN(n)||(e.y3||(e.y3={},e.Kyt={}),i=e.y3[n],r=e.Kyt[n],t&&!t.preAdj&&t!==i&&(i?r.nextAdj=t:e.y3[n]=t,t.preAdj=r,t.nextAdj=L,e.Kyt[n]=t))},X.prototype.Jyt=function(t,n){var e,i,i,r,e=this;isNaN(n)||(i=e.y3&&e.y3[n],t&&(t.preAdj||t===i)&&(i=t.preAdj,r=t.nextAdj,i?i.nextAdj=r:e.y3[n]=r,r?r.preAdj=i:e.Kyt[n]=i,t.preAdj=L,t.nextAdj=L))},X.prototype.Xyt=function(t,n,e,i,r,o,a){this.qyt(t,S,n,e,i,r,o,a);var a=0,u=0,s=0,c=0;0===n&&(i&&r?s=e:i?a=e:r?c=e:u=e),f(t,S,n,e,a,u,s,c,i,r,o),h(t,S,n,e,i,r)},X.prototype.qyt=function(t,n,e,i,r,o,a,u){var s,c,f,l,h,d,v,m,g,p,b,y,w,M,C,S,T,A,I,x,N,s=this,c=s.y3;if(c){for(p={};c[0];){if(g=(f=(v=c[0]).w3).pj(),m=f.getSource(),G(p,l=v.row,h=v.column));else{if(!(d=f.pB(l,h))||n===_&&m===t)(f.getRowExpression&&f.getRowExpression(l)||f.getColumnExpression&&f.getColumnExpression(h))&&f.gF(l,h,1,1);else if(d=n.call(s,m,l,h,d,t,e,i,r,o,K,a,u),b=f.sT(l,h)){if(m===t&&(y=o?i:-i,r?e<=b.row&&(b.row+=y):e<=b.col&&(b.col+=y)),l===b.row&&h===b.col)if(b.isDynamicArray)f.SB(l,h,d,b,!0,k(r?l:h,e,g,t.id===m.id));else for(w=l;w<l+b.rowCount;w++)for(p[w]||(p[w]={}),M=h;M<h+b.colCount;M++)f.SB(w,M,d,b,w===l&&M===h,k(r?w:M,e,g,t.id===m.id)),P(p,w,M,!0)}else f.SB(l,h,d,b,!0,k(r?l:h,e,g,t.id===m.id))}s.Jyt(v,0)}for(;c[1];)g=(f=(v=c[1]).w3).pj(),l=v.row,f.getRowExpression&&(d=f.getRowExpression(l))&&f.SB&&(m=f.getSource(),f.SB(l,-1,n.call(s,m,l,-1,d,t,e,i,r,o),K,!0,k(l,e,g,t.id===m.id))),s.Jyt(v,1);for(;c[2];)g=(f=(v=c[2]).w3).pj(),h=v.column,f.getColumnExpression&&(d=f.getColumnExpression(h))&&f.SB&&(m=f.getSource(),f.SB(-1,h,n.call(s,m,-1,h,d,t,e,i,r,o),K,!0,k(h,e,g,t.id===m.id))),s.Jyt(v,2);for(;c[3];)S=(C=c[3]).name,d=(f=C.w3).$yt(S),T=n.call(s,f.getSource(),0,0,d,t,e,i,r,o,{isNameID:!0}),f.twt(S,T),s.Jyt(C,3);for(A in c)if(3<(I=+A)&&c.hasOwnProperty(A))for(;c[A];)N=(x=c[A]).w3,d=n.call(s,N,0,0,x.expression,t,e,i,r,o),N.setExpression(x.id,x.name,d),s.Jyt(x,I)}},X.prototype.nwt=function(t){var n=this,e,i,r;H(t.getCalcSourceModel(),0,0,t.getRowCount(),t.getColumnCount()),n.qyt(t,_),f(t,_,0,0,0,0,0,0,!0,!1),h(t,_,0,0,!0,!1)},X.prototype.Wyt=function(t,n,e,i,r,o,a,u,s,c,f){var l,h,d,v,m,g,p,b,y,w,M,C,S,T,A,T,I,x,N,k,D,_,E,j,O,R,l=this,h=U,d=new F(n,e,i,r,o,a,u,s),y={};if(t&&mt(t,d,c),Y(n,d,c),S={},M=l.y3){for(;M[0];){if(v=(m=M[0]).w3,g=m.row,p=m.column,w=v.pj(),G(y,g,p));else{if(b=v.pB(g,p),C=v.getSource(),b)if(T=K,f&&f[g+", "+p]&&(C=n,T={crossSheetMoved:!0}),b=h.call(l,C,g,p,b,d,c,T),T=void 0,(A=v.sT(g,p))&&!A.isDynamicArray)if(T=z(A),g===A.row&&p===A.col)for(S[T]=!0,I=g;I<g+A.rowCount;I++)for(y[I]||(y[I]={}),x=p;x<p+A.colCount;x++)v.SB(I,x,b,A,I===g&&x===p,w),P(y,I,x,!0);else S[T]||(v.SB(g,p,b,A,!1,w),P(y,g,p,!0));else v.SB(g,p,b,A,!0,w);else(v.getRowExpression&&v.getRowExpression(g)||v.getColumnExpression&&v.getColumnExpression(p))&&v.gF(g,p,1,1)}l.Jyt(m,0)}for(;M[1];)v=(m=M[1]).w3,g=m.row,w=v.pj(),v.getRowExpression&&(b=v.getRowExpression(g))&&v.ewt&&v.ewt(g,h.call(l,C,g,-1,b,d,c),K,w),l.Jyt(m,1);for(;M[2];)v=(m=M[2]).w3,p=m.column,w=v.pj(),v.getColumnExpression&&(b=v.getColumnExpression(p))&&v.iwt&&v.iwt(p,h.call(l,C,-1,p,b,d,c),K,w),l.Jyt(m,2);for(;M[3];)k=(N=M[3]).name,b=(v=N.w3).$yt(k),D=h.call(l,C,0,0,b,d,c),v.twt(k,D),l.Jyt(N,3);for(_ in M)if(3<(E=+_)&&M.hasOwnProperty(_))for(;M[_];)R=(O=(j=M[_]).w3).getSource(),b=h.call(l,R,0,0,j.expression,d,c),O.setExpression(j.id,j.name,b),l.Jyt(j,E)}},X.prototype.Zyt=function(t,n,e,i,r){for(var o,a,u,s,c,f,l,h,o=this,a=n+i,u=e+r,f=n;f<a;f++)for(l=e;l<u;l++)s=t.rwt(f,l),c=t.pB(f,l),(s||c)&&(o.Jyt(s,0),t.owt(f,l,0),h=t.oT(f,l,!0),s&&c&&(s.row!==h.row||s.column!==h.column)&&(h.oldRow=s.row,h.oldColumn=s.column),o.Qyt(h,0))},X.prototype.awt=function(t,n,e){for(var i,r,o,i=this,r=n;-1!==r&&r<n+e;r++)(t.rwt(-1,r)||t.pB(-1,r))&&(t.owt(-1,r,2),o=t.uwt(r,!0),i.Qyt(o,2))},X.prototype.swt=function(t,n,e){for(var i,r,o,i=this,r=n;-1!==r&&r<n+e;r++)(t.rwt(r,-1)||t.pB(r,-1))&&(t.owt(r,-1,1),o=t.cwt(r,!0),i.Qyt(o,1))},X.prototype.fwt=function(t){for(var n,e,i,r,o,a,u,n=this,e=t.op().getAllSourceModels(),o=0;o<e.length;o++)if((a=e[o]).lwt)for(i=a.lwt(),u=0;u<i.length;u++)(r=i[u])&&r.isVolatile&&r instanceof Q.CellCalc&&!n.isAdjustCell(r)&&n.Qyt(r,0)},X.prototype.onBeforeAddRemoveRows=function(t,i,n){[t,n].forEach(function(t){var n,e;t&&(n=t.rC(),e=t.cC(),t.mF(i,0,n-i,e),t.hwt(i,n-i),H(t,i,-1,n-i,-1,!0))})},X.prototype.onAfterAddRemoveRows=function(t,i,r,o,n,e){var a=this;[t,e].forEach(function(t){var n,e;t&&(n=t.rC(),e=t.cC(),o?t.gF(i,0,r,e):n+=r,a.Zyt(t,i,0,n-i,e),a.swt(t,i,n-i),a.fwt(t))}),a.Xyt(t.getSource(),i,r,!0,o,K,n),t.op().autoCalculation&&t.op().recalculateAll(!1)},X.prototype.onAfterAddRemoveColumns=function(t,i,r,o,n,e){var a=this;[t,e].forEach(function(t){var n,e;t&&(n=t.rC(),e=t.cC(),o?t.gF(0,i,n,r):e+=r,a.Zyt(t,0,i,n,e-i),a.awt(t,i,e-i),a.fwt(t))}),a.Xyt(t.getSource(),i,r,!1,o,K,n),t.op().autoCalculation&&t.op().recalculateAll(!1)},X.prototype.onBeforeAddRemoveColumns=function(t,i,n){[t,n].forEach(function(t){var n,e;t&&(n=t.rC(),e=t.cC(),t.mF(0,i,n,e-i),t.dwt(i,e-i),H(t,-1,i,-1,e-i,!0))})},X.prototype.onAfterRemoveName=function(t,n){var t=t.vwt(n,!1);t&&(t.updateListening(!0,!1),t.vyt(),t.updateListeningOnRemoved())},X.prototype.adjustFormulaOnRemoveName=bt,X.prototype.invalidName=function(t,n){var e,t;n&&(t=(e=t.getCalcSourceModel()).vwt(n.toUpperCase(),!0))&&t.mB()},X.prototype.onAfterRemoveTable=function(t,n){for(var e,i,r,o,a,u,s,c,f,l,h,d,v,e=this,u=0;u<t.length;u++)H((s=t[u]).source().getCalcSourceModel(),s.startRow(),s.startColumn(),s.endRow()-s.startRow()+1,s.endColumn()-s.startColumn()+1);if(c=e.y3)for(f={};c[0];){if(i=(l=c[0]).w3,G(f,r=l.row,o=l.column));else{if(a=i.pB(r,o))if(a=X.adjustExpressionOnRemoveTable(a,t,r,o,n),(h=i.sT(r,o))&&!h.isDynamicArray)for(h=(0,R.Ec)(r,o,h.rowCount,h.colCount),d=r;d<r+h.rowCount;d++)for(f[d]||(f[d]={}),v=o;v<o+h.colCount;v++)i.SB(d,v,a,h,d===r&&v===o),P(f,d,v,!0);else i.SB(r,o,a,h,!0);else(i.getRowExpression&&i.getRowExpression(r)||i.getColumnExpression&&i.getColumnExpression(o))&&i.gF(r,o,1,1)}e.Jyt(l,0)}},X.adjustExpressionOnRemoveTable=function(t,n,e,i,r){var o,a,u,s,c,f,l,h,d,v,m,a,u,g,p,b,y,w,o=X.adjustExpressionOnRemoveTable;if(9===t.type){if(a=t.value,u=t.value2,s=o(a,n,e,i,r),c=u&&o(u,n,e,i,r),a!==s||u!==c)return(0,Q.rbt)(t.operatorType,s,c)}else if(7===t.type){for(f=!1,l=[],h=0;h<t.arguments.length;h++)v=o(d=t.arguments[h],n,e,i,r),f=f||d!==v,l.push(v);if(f)return(0,Q.YJ)(t,l)}else if(10===t.type){if((a=t.value)!==(u=o(a,n,e,i,r)))return(0,Q.Ayt)(u)}else if(13===t.type)for(g=t,h=0;h<n.length;h++)if(g.baseTable===n[h])return r?Q.kyt:(p=g.getRange(-1===e?0:e,-1===i?0:i,!0),b=-1===e||1===g.referencePortions(),y=1===p.rowCount&&1===p.columnCount,w=g.source,y?(0,Q.knt)(w,L,p.row,p.col,b,!1):(0,Q.lJ)(w,L,p.row,p.col,p.row+p.rowCount-1,p.col+p.colCount-1,b,!1,b,!1));return t},i=X,t.CalcOperatorAdjustor=i,(u=Q.CalcService.prototype).mwt=function(){return new i},(e=b=b||{}).outToOut="0_0",e.outToCover="0_1",e.outToInside="0_2",e.outToPart="0_3",e.outToCross="0_4",e.outNoMove="0_9",e.coverToOut="1_0",e.coverToCover="1_1",e.coverToCross="1_4",e.coverNoMove="1_9",e.insideToOut="2_0",e.insideToInside="2_2",e.insideToPart="2_3",e.insideToCross="2_4",e.insideNoMove="2_9",e.partToOut="3_0",e.partToInside="3_2",e.partToPart="3_3",e.partToCross="3_4",e.partNoMove="3_9",e.crossToOut="4_0",e.crossToCover="4_1",e.crossToInside="4_2",e.crossToPart="4_3",e.crossToCross="4_4",e.crossNoMove="4_9",t.adjustFormulaOnMoveSwap=U},"./dist/plugins/sheetsCalc/parser-sheets.js":function(k,v,t){"use strict";var n,E,M,j,O,C,S,T,e,t,i,m,R,B,f,o,r,a,u,D,_,P,G,U,c,H,z,s,l,t,t,h,d;function V(t){return e(t+1).split("")}function Y(t,n){var e=n+1;return t<0?t%e+e:n<t?t%e:t}function Z(t){return new j.ErrorSource(t)}function W(t,n,e,i,r,o,a){return 3===a||0<=e&&0<=i||1===a&&0<=e||2===a&&0<=i}function Q(t,n,e,i,r){var o,o,a,a,a,o=C.BAND_INDEX_CONST,o={Ky:o,iw:o,gwt:!0,pwt:!0,bwt:!1,ywt:0,wwt:!0},a=n?q(t,e,i,0):X(t,0,r);if(a.DX?(o.Ky=a.Mwt,o.gwt=a.Cwt):(o.iw=a.Mwt,o.pwt=a.Cwt),o.ywt=a.ywt,o.bwt=a.bwt,a.bwt&&!(a.ywt>=t.length)){if(!n&&a.DX||n&&!a.DX)return{bwt:!1};if(a=t[o.ywt],(n||!(0,j.isNumber)(a)&&"$"!==a)&&(!n||"C"!==a&&"c"!==a))return{bwt:!1};a=n?q(t,e,i,o.ywt):X(t,o.ywt,r),o.ywt=a.ywt,!a.bwt||!n&&!a.DX||n&&a.DX?o.bwt=!1:(o.ywt<t.length&&(o.wwt=!1),n?(o.iw=a.Mwt,o.pwt=a.Cwt):(o.Ky=a.Mwt,o.gwt=a.Cwt),o.bwt=!0)}return o}function J(t){return(0,j.Swt)(t)||95===t.charCodeAt(0)}function K(t,n,e){for(var i=t,r=n[t],t=!1;i<e&&!J(r);)++i<e&&(r=n[i]);if(i<e){for(;i<e&&J(r);)++i<e&&(r=n[i]);i<e&&(t=!0)}return t}function X(t,n,e){var i,r,o,a,u,s,c,f,l,h,d,i={Cwt:!0,bwt:!1},r=t.length;if(!(r<=n||("$"===t[n]&&(i.Cwt=!1,n++),r<=n)))if(u=t[o=n],(a=0,j.isNumber)(u)&&"0"!==u){for(i.DX=!0;o<r&&(0,j.isNumber)(u);)++o<r&&(u=t[o]);if(7<o-n)return i;for(s=o-1,c=0;n<=s;s--,c++)a+=(t[s].charCodeAt(0)-48)*D[c];if(a<=v.maxRowCount)i.Mwt=a-1,i.ywt=o,i.bwt=!0}else if((0,j.Swt)(u)){for(i.DX=!1;o<r&&(0,j.Swt)(u);)++o<r&&(u=t[o]);if(3<(f=o-n)||K(o,t,r))return i;for(h=l=o-1;n<=h;h--){if(!(65<=(d=t[h].charCodeAt(0))&&d<=90||97<=d&&d<=122))return i;a+=((32|d)-96)*m[l-h]}if(a<=v.maxColumnCount)i.Mwt=a-1,i.ywt=o,i.bwt=!0}return i}function q(t,n,e,i){var r,o,a,u,s,c,n,e,r,o={ywt:i,Mwt:C.BAND_INDEX_CONST,DX:!0,Cwt:!1,bwt:!1},a=t.length;if(a<=i)return o;if("R"===(s=t[u=i])||"r"===s)o.DX=!0,c=n;else{if("C"!==s&&"c"!==s)return o;o.DX=!1,c=e}if(u++,a<=++i)return o.ywt=i,o.Mwt=c,o.Cwt=!0,o.bwt=!0,o;if("["===(s=t[u])&&(i++,u++,o.Cwt=!0),a<=i)return o;if(n=!1,s=t[u],o.Cwt&&"-"===s&&(i++,u++,n=!0),a<=i)return o;if(s=t[u],!(0,j.isNumber)(s))return o.Cwt||(o.ywt=i,o.Mwt=c,o.Cwt=!0,o.bwt=!0),o;for(;u<a&&(0,j.isNumber)(s);)++u<a&&(s=t[u]);if(e=parseInt(t.slice(i,u).join(""),10),o.Cwt){if(a<=u||"]"!==t[u])return o;u++}return e<(o.DX?v.maxRowCount:v.maxColumnCount)?(o.Mwt=o.Cwt?(e=n?-e:e)+c:e-1,o.ywt=u,o.bwt=!0,o):void 0}function $(t,n,e,i){var r,o,a,u,r=t.row||0,o=t.column||0;if(e.source===j.BangSource)i.push("!");else if(e.source&&!(a=p(t,i,e.source,e.endSource)))return void i.push("#","R","E","F","!");8===(u=e.type)||5===u||e.value&&e._error?i.push(e.value.toString()):e.hmt()?(!e.source&&t.addSheetName&&t.source&&p(t,i,t.source,R),g(t.useR1C1,r,o,e.row,e.column,e.rowRelative,e.columnRelative,i)):(!e.source&&t.addSheetName&&t.source&&p(t,i,t.source,R),tt(t.source,t.useR1C1,r,o,e.row,e.column,e.endRow,e.endColumn,e.rowRelative,e.columnRelative,e.endRowRelative,e.endColumnRelative,i,e.Tyt()))}function g(t,n,e,i,r,o,a,u,s){var c,c,c=v.maxRowCount-1;(0===(s=s||0)||1===s)&&-c<i&&i<=2*c&&(i=Y(i+=o?n:0,c)),c=v.maxColumnCount-1,W(n,e,i,r=(0===s||2===s)&&-c<r&&r<=2*c?Y(r+=a?e:0,c):r,o,a,s)?t?2!==s&&(u.push("R"),0<=i&&(n!==i||!o)&&(o?u.push("["+(i-n)+"]"):u.push(++i+"")),r<0)||1!==s&&(u.push("C"),e===r&&a||(a?u.push("["+(r-e)+"]"):u.push(++r+""))):(0<=r&&(a||u.push("$"),u.push.apply(u,V(r))),i<0||(i++,o||u.push("$"),u.push(i+""))):u.push(j.Errors.Reference.toString())}function tt(t,n,e,i,r,o,a,u,s,c,f,l,h,d){3===(d=d||0)&&(r=0,a=v.maxRowCount-1,d=1),g(n,e,i,r,o,s,c,h,d);var s=C.BAND_INDEX_CONST;n&&r===a&&o===u&&(a===s||u===s)||a===s&&u===s||(h.push(":"),g(n,e,i,a,u,f,l,h,d))}function p(t,n,e,i){if(t.getExternalSourceToken){if(e!==j.BangSource){var e=nt(t,t.getExternalSourceToken(e).split(""),i&&t.getExternalSourceToken(i).split(""));if(!(0<e.length))return!1;n.push.apply(n,e)}return n.push("!"),!0}return!1}function nt(t,n,e){if(!n||0===n.length)return[];var i=n,r;if(it(n,!1,t.lyt)||e&&it(e,!1,t.lyt)){for(i=["'"],r=0;r<n.length;r++)"'"===n[r]&&i.push("'"),i.push(n[r]);if(e)for(i.push(":"),r=0;r<e.length;r++)"'"===e[r]&&i.push("'"),i.push(e[r]);i.push("'")}else if(e)for(i.push(":"),r=0;r<e.length;r++)i.push(e[r]);return i}function b(t,n,e){var i,r;if(t&&0!==t.length){if(!n){if((0,j.isNumber)(t[0]))return!1;if(ot(t))return!1;if(u.test(t[0]))return!1}for(r=0;r<t.length;r++)if(i=t[r],n){if("*"===i||":"===i||"["===i||"]"===i||"?"===i||"\\"===i||"/"===i)return!1}else if(o[i]||j.operaterTypesMap[i]||"\u3000"===i&&(e||M.Common.CultureManager.Fe().isJCKCulture))return!1}return!0}function et(t){var n,e;if(t&&0!==t.length)for(e=0;e<t.length;e++)if(n=t[e],_[n]||j.operaterTypesMap[n])return;return 1}function it(t,n,e){var i,r,r,o;if((0,j.isDigit)(+t[0]))return 1;if(0<(r=(i=t).lastIndexOf("[")))return 1;if(0===r){if(!(0<(r=t.lastIndexOf("]"))))return 1;if(!et(o=t.slice(1,r)))return 1;i=t.slice(r+1)}return!b(i,n,e)}function rt(t){var n,e,t,n=t.search(/[0-9]/),e=t.substr(0,n),t=parseInt(t.substr(n),10);return(n<=2||3===n&&e<="XFD")&&t<=v.maxRowCount}function ot(t){var t=t.join("").toUpperCase();return!!("RC"===t||"C"===t||"R"===t||r.test(t)||a.test(t)&&rt(t))}function A(t){var n=new j.Expression(8);return n.value=t,n}function at(t){var n=t;return n=t&&3<=t.length&&"["===t[0]&&"0"===t[1]&&"]"===t[2]?3===t.length?"":t.substring(3):n}function ut(t,n,e){var i,t,r,o,a,u,t=t.source;return i=t&&(r=t.G3,o=t.S8,a=t.T8,r)&&(u=0<=n&&n<o&&a<=e||o<=n&&0<=e&&e<a)?t:i}function y(t){var n=l.call(this,8e3)||this;return n.Mf=t,n}function st(t,n,e,i,r){return 0===n.uit&&0===n.Twt||!i&&0===n.uit&&4===n.Twt&&(!r||e<t.length-2&&":"===t[e+1].Awt&&0===t[e+2].uit&&4===t[e+2].Twt)}function ct(t,n,e,i,r){return n<=t.startRow()&&e<=t.startColumn()&&n+i>t.endRow()&&e+r>t.endColumn()}function w(){return h.call(this,13)||this}function ft(t,n){this.abt.Iwt(t,this,n)}function I(t){var n=d.call(this,7900)||this;return n.Mf=t,n}function lt(t,n,e){var i,r,o,e,a,u,a,s,c,f,l,h,d,d,v,i=e,r=0,o=n[r],e=Ct(t,n,r,o),a=e.nM;if(!a){if(u=t.keepUnknownFormulas)return;N()}for(i.baseTable=a,r=e.xwt,o=n[++r],a=r;" "===o;)o=n[++r];for("@"!==o&&"["!==o&&(o=n[r=a]),f=c=!(s=1),l=n.length;0!==s&&r<l;)if("["===o&&(s++,o=n[++r]),"#"===o)c&&s<=1&&N(),d=(h=Mt(n,r,o,s)).Nwt,r=h.xwt,o=h.kwt,s=h.Dwt,c?2===i.hbt&&3===d||2===d&&3===i.hbt?i.hbt=6:3===i.hbt&&8===d||3===d&&8===i.hbt?i.hbt=12:N():i.hbt=d,c=!0;else if("@"===o){for((1<s||c)&&N(),c=!0,i.hbt=1,o=n[++r];" "===o;)o=n[++r];","===o&&N()}else{for(d=r;!T(o)&&"]"!==o&&"["!==o;)if("'"===o&&r++,","===o){for(o=n[++r],v=r;" "===o;)o=n[++r];if("["===o){r=v,o=",";break}}else o=n[++r];if(d<r&&((f||"["===o&&1<s)&&N(),r=(h=dt(i,n,r,o,s,d)).xwt,o=h.kwt,s=h.Dwt,f=!0),"]"===o){if(0===--s)break;r>=n.length&&N(),o=n[++r]}","===o&&(o=n[++r])}c||(i.hbt=t._wt?1:16),f||(i.cbt=0,i.fbt=i.abt.endColumn()-i.abt.startColumn(),i.lbt=1)}function ht(t,n,e){return t.slice(n,e).join("")}function dt(t,n,e,i,r,o){var t,a,u,s,c,f,l,l,o,h,l,t=t,a=[],s=!1,c=!1;if(1<r)s=!0,r--,a=n.slice(o,e),":"===(i=n[++e])&&(c="["===(i=n[++e]),u=(l=yt(n,e,i,r)).sbt,e=l.xwt,i=l.kwt,r=l.Dwt);else if("["===i){for(c=!0,i=n[f=e-1];" "===i;)i=n[--f];":"!==i&&N(),a=vt(a=n.slice(o,f)),u=(l=yt(n,e,i=n[e],r)).sbt,e=l.xwt,i=l.kwt,r=l.Dwt}else t.hbt!==R&&16!==t.hbt||(s=!0),0<(f=(l=n.slice(o,e)).indexOf(":"))?(a=l.slice(0,f),"["!==(u=l.slice(f+1))[0]&&N()):a=l;if(o=gt(t,a,s),t.ubt=a.join(""),t.sbt=t.ubt,u?(h=gt(t,u,c),t.lbt=4,t.sbt=u.join("")):(h=o,t.lbt=2),h<o&&(l=o,o=h,h=l),t.cbt=o,t.fbt=h,++e<n.length)for(i=n[e];" "===i;)i=n[++e];return{xwt:e,kwt:i,Dwt:r}}function vt(t){for(var n=t.length-1;0<=n&&" "===t[n];)n--;for(;0<=n&&" "!==t[n];)n--;return 0<=n?t.slice(n+1,t.length-n-1):t}function mt(t){for(var n=0,e=t.length,i=0;n<e&&" "===t[n];)n++;for(i=n,n=e-1;i<n&&" "===t[n];)n++;return i<=n?t.slice(i,n+1):t}function gt(t,n,e){var i,r,o,e;if(n&&pt(n,e)){for(i=[],r=0,o=n.length;r<o;r++)"'"===n[r]&&r<o-1&&r++,i.push(n[r]);return n=i,(e=t.abt.getColumnIndexInTable(n.join("")))<0&&N(),e}return-1}function pt(t,n){var e,i,r;if(n)return 1;if(e="","#"!==(i=e=t[0])&&"@"!==e&&" "!==e&&","!==e&&":"!==e&&"["!==e&&"]"!==e){for(r=1;r<t.length;r++){if(","===(e=t[r])||":"===e||"["===e&&"'"!==i||"]"===e&&"'"!==i||"@"===e&&"'"!==i||"#"===e&&"'"!==i)return;i=e}return 1}}function x(t){for(var n,e,i,n=[],i=0;i<t.length;i++)"["!==(e=t[i])&&"]"!==e&&"@"!==e&&"#"!==e&&"'"!==e||n.push("'"),n.push(e);return n.join("")}function bt(t){var n,e,n="";if("#"===(n=t[0])||" "===n||"@"===n||" "===n||","===n||":"===n||"["===n||"]"===n)return 1;for(e=1;e<t.length;e++)if(" "===(n=t[e])||","===n||":"===n||"["===n||"]"===n||"@"===n||"#"===n)return 1}function yt(t,n,e,i){var r,o,o,r=!1;if("["===e)for(r=!0,i++,e=t[++n];" "===e;)e=t[++n];for(o=n;"]"!==e&&(","!==e||1<i);)"'"===e&&n++,e=t[++n];return n<=o&&N(),o=t.slice(o,n),1<i&&i--,{sbt:o=r?o:mt(o),xwt:n,kwt:e,Dwt:i}}function wt(t){var n,e,n=(0,j.getMapping)()&&(0,j.getMapping)().tableFunctionsMapping;if(!T(n))for(e in n)if(n[e].toLowerCase()===t)return e.toLowerCase();return t}function Mt(t,n,e,i){for(var r,o,a,u,s,c,r=14,o=n;"]"!==e;)"'"===e&&n++,e=t[++n];for(a=wt(a=ht(t,o,n).toLowerCase().trim()),u=!1,s=0;s<f.length;s++)if(a===(c=f[s])){r=z[a],u=!0;break}if(u||N(),++n>=t.length)i--;else{for(e=t[n];" "===e;)e=t[++n];if(","===e){for(i<=1&&N(),e=t[++n];" "===e;)e=t[++n];"["===e&&(i++,e=t[++n])}1<i&&i--}return{Nwt:r,xwt:n,kwt:e,Dwt:i}}function Ct(t,n,e,i){for(var r,o,a,u,o=0,a=n.length;"["!==i&&e<a;)i=n[++e];return{nM:r=0<e?(u=ht(n,0,e),t.getTableByName(u)):t.getTableByIndex(t.row,t.column),xwt:e,kwt:i}}function N(){throw i().Exp_FormulaInvalid}function St(t,n,e){var i,r,o,a,u,s,c,i=(0,j.getMapping)()&&(0,j.getMapping)().tableFunctionsMapping,r=(0,j.sR)().d2t,o=i?i["#All"]:r.All.name,a=i?i["#This row"]:r.thisRow.name,u=i?i["#Headers"]:r.Headers.name,s=i?i["#Data"]:r.Data.name,c=i?i["#Totals"]:r.Totals.name;switch(t){case 1:return e?"["+a+"]":"@";case 2:return n?"["+u+"]":u;case 3:return n?"["+s+"]":s;case 8:return n?"["+c+"]":c;case 6:return"["+u+"], ["+s+"]";case 12:return"["+s+"], ["+c+"]"}return n?"["+o+"]":o}function Tt(t,n){var e,i,r,o,a,u,s,c,e,f,l;for(t.unshift(new j.FormulaToken("=",1,0,0,0)),o=[],a=0,r=t.length-1;0<r;r--)t[r].lp===t[r-1].lp&&t[r].Awt===t[r-1].Awt||(o[a]=t[r],a++);for(o[a]=t[r],o.reverse(),u=[],c=s=0;c<o.length;c++,s++)i=At(o[c]),u[s]=o[c],(e=c+1<o.length?o[c+1].lp:n.length)>o[c].lp+i&&(e=new j.FormulaToken(n.slice(o[c].lp+i,e),7,o[c].lp+i),o[c].ywt=o[c].lp+i-1,u[++s]=e);for(f=0;f<u.length;f++)l=u[f].Awt.trim(),3===u[f].Twt?u[f].Awt='"'+u[f].Awt+'"':"("===l||"{"===l?(u[f].uit=1,u[f].Twt=1):")"!==l&&"}"!==l||(u[f].uit=1,u[f].Twt=2);return u}function At(t){return 1===t.uit&&"ARRAY"===t.Awt?1:0===t.uit&&3===t.Twt?(t.Ewt||t.Awt).length+2:0===t.uit&&12===t.Twt?t.Awt.length+3:t.Awt.length}function L(t,n,e){var n,i;t&&n&&((i=t[n=n.getName&&n.getName()||"!"])||(i=t[n]=[],t.sheets||(t.sheets=[]),t.sheets.push(n)),i.push(e))}function F(t,n,e,i,r,o){var a,u,a,s;if(t){for(;10===t.type;)t=t.value;if(!(2<=(t=12===t.type?t.value:t).type&&t.type<=6))if(1===t.type)a=t.getRange(r,o),!i.source||t.source&&t.source!==i.source||n.push(a),L(e,t.source||i.source,a);else if(13===t.type)a=t.getRange(r,o),t.source===i.source&&a&&n.push(a),L(e,t.source||i.source,a);else if(8===t.type)t.jwt||(t.jwt=!0,a=B,t.source?t.source.op()&&(a=new j.EvaluateContext(t.source,(0,j.eV)(r,o))):a=i,F(a.getName(t.value),n,e,a,r,o),t.jwt=R);else if(9===t.type)F(t.value,n,e,i,r,o),t.value2&&F(t.value2,n,e,i,r,o);else if(7===t.type)for(s=0;s<t.arguments.length;s++)F(t.arguments[s],n,e,i,r,o)}}function It(t,n,e,i,r,o,a,u,s){var o,n,c,f;t.setParserOption(o),o=[],n=n.split(""),T(s)&&(s=E.SheetArea.viewport);try{c=!!u||e.op().useR1C1,f=e.Uw(s).getParserContext(!a&&c,(0,j.eV)(i,r),{sheetArea:s}),o=t.parseToTokens(f,n,!1)}catch(t){}return xt(t,o=Tt(o,n),n,e,i,r,a,u,s)}function xt(t,n,e,i,r,o,a,u,s){var c,f,l,h,u,d,v,m,g,p,b,y,w,M,C,S,T,A,I,x,N,k,D,_;for(void 0===s&&(s=E.SheetArea.viewport),f=R,l=i.Uw(s),h=i.op(),u=!!u||h.useR1C1,h?(c=new O.SheetParserContext(i,!a&&u,(0,j.eV)(r,o),{sheetArea:s}),f=new j.EvaluateContext(l,(0,j.eV)(r,o),!1)):c=new j.ParserContext(B,!1,(0,j.eV)(0,0)),c.ignoreError=!0,d=[],m=0;m<n.length;m++)try{if("["===(v=n[m]).Awt||"#"===v.y4[0]||3===v.Twt)d.push({text:v.Ewt||v.Awt,type:v.uit,subType:v.Twt,canDrag:!1,ranges:v.ranges,value:v.Awt});else if(m=Nt(t,c,n,m,g=[]),p=void 0,0<g.length){for(b=0;b<g.length;b++)if((y=g[b])instanceof j.FormulaToken)d.push({text:e.slice(y.lp,y.ywt+1).join(""),type:y.uit,subType:y.Twt,canDrag:p,ranges:[],value:y.Awt});else if(y.WK){if(M=(w=y.WK).type,C=w.source,S=e.slice(y.lp,y.ywt+1).join(""),T=[],A={},p=!0,I=w.getRange&&w.getRange(r,o),8===M)p=!1,f&&(x=f,F(N=(x=w.source?new j.EvaluateContext(w.source,(0,j.eV)(r,o),!1):x).getName(w.value),T,A,f,r,o));else if(13===M||22===M)p=!1,C&&l&&C.Mf===l.Mf&&I?T.push(I):T=null,L(A,C,I);else if(1===M)if(w.endSource)for(D=w.endSource,_=C.getSources(D),b=0;b<_.length;b++){if(_[b]===l){T.push(I);break}L(A,_[b],I)}else L(A,C||l,I),(!C||l&&C.Mf===l.Mf)&&T.push(I);else T=null;T&&0<T.length?d.push({text:S,type:0,subType:7,canDrag:p,ranges:T,value:S,sheetRanges:A,sheetArea:C&&C.nT||l.nT}):d.push({text:S,type:v.uit,subType:v.Twt,canDrag:p,ranges:T,value:S,sheetRanges:A})}}else d.push({text:v.Awt,type:v.uit,subType:v.Twt,canDrag:!1,ranges:v.ranges,value:v.Awt})}catch(t){d.push({text:v.Awt,type:v.uit,subType:v.Twt,canDrag:!1,ranges:v.ranges,value:v.Awt})}return d}function Nt(t,n,e,i,r){var o,t,n,t,a,a,e,o=e[i];return o&&"function"!=typeof o&&0===o.uit&&(n=t.resolveToken(n,e,t=[],i)-1,1===(a=(t=t[0]).type)||13===a||8===a||5===a||22===a&&t.source)?(a=e[n],e={lp:o.lp,ywt:a.ywt,WK:t},r.push(e),n):i}n=this&&this.__extends||(s=function(t,n){return(s=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(t,n){t.__proto__=n}:function(t,n){for(var e in n)Object.prototype.hasOwnProperty.call(n,e)&&(t[e]=n[e])}))(t,n)},function(t,n){if("function"!=typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function e(){this.constructor=t}s(t,n),t.prototype=null===n?Object.create(n):(e.prototype=n.prototype,new e)}),Object.defineProperty(v,"__esModule",{value:!0}),v.Vgt=v.getValidaColumnName=v.StructureReferenceResolver=v.obt=v.StructReferenceColumnSpecifier=v.StructReferencePortions=v.SheetReferenceResolver=v.validateSheetName=v.Cmt=v.maxColumnCount=v.maxRowCount=void 0,E=t("Core"),M=t("Common"),j=t("CalcEngine"),O=t("./dist/plugins/sheetsCalc/calc-spreadjs.js"),C=t("./dist/plugins/sheetsCalc/calc.ns.js"),S=t("./dist/plugins/sheetsCalc/external-reference.js"),T=M.Common.lt.ht,e=E.util.Vf,t=new M.Common.ResourceManager(E.SR),i=t.getResource.bind(t),v.maxRowCount=E.XmlConstants.Io,v.maxColumnCount=E.XmlConstants.xo,m=[1,26,676],f=["#all","#data","#headers","#totals","#this row"],o={" ":!(B=null),"'":!(R=void 0),"[":!0,"]":!0,"?":!0,"\\":!0,"%":!0,'"':!0,"(":!0,")":!0,"|":!0,"{":!0,"}":!0,"#":!0,"@":!0,"!":!0,$:!0,"^":!0,"\uff08":!0,"\uff09":!0,".":!0,";":!0,",":!0,"`":!0,"+":!0,"~":!0,"\uff01":!0,"":!0,"\u3001":!0,"\uff5d":!0,"\uff5b":!0,"\u3010":!0,"\u3011":!0,"-":!0,"\uff1b":!0,"\uff1a":!0,"\u2018":!0,"\u201c":!0,"\u201d":!0,"\u2019":!0,"\uff0c":!0,"\u3002":!0,"=":!0},r=/^(R|C|RC)?(0*[1-9]\d*)/,a=/^[A-z]{1,3}0*[1-9]\d{0,6}$/,u=/[\u00A2\u00A3\u00A5\u00A6\u00A9\u00AB\u00AC\u00AE\u09E6-\u09EF\u09F2-\u0A03\u0AE2-\u0AF1\u0BE6-\u0BFA\u0E3F\u17B4-\u17D6\u17D8-\u17DB\u17DD-\u181F\u1878-\u187F\u18A9\u18AB-\u18FF\u191D-\u194F\u196E\u196F\u1975-\u197F\u19AA-\u19C0\u19C8-\u19FF\u2000-\u200F\u2011\u2012\u2017\u201A\u201B\u201E\u201F\u2022-\u2024\u2028-\u202F\u2031\u2034\u2036-\u203A\u203C-\u2070\u2072\u2073\u2075-\u207E\u2080\u2085-\u208F\u2095-\u20CF\u2100\u2101\u2104\u2106\u2108\u2114\u2117\u2118\u211E-\u2120\u2123\u2125\u2127\u2129\u212E\u213A\u213B\u2140-\u2144\u214A-\u214D\u214F-\u2152\u2155-\u215A\u215F\u2189-\u218F\u219A-\u21D1\u21D3\u21D5-\u21FF\u2201\u2204-\u2206\u2209\u220A\u220C-\u220E\u2210\u2212-\u2214\u2216-\u2219\u221B\u221C\u2221\u2222\u2224\u2226\u222D\u222F-\u2233\u2238-\u223B\u223E-\u2247\u2249-\u224B\u224D-\u2251\u2253-\u225F\u2262\u2263\u2268\u2269\u226C\u226D\u2270-\u2281\u2284\u2285\u2288-\u2294\u2296-\u2298\u229A-\u22A4\u22A6-\u22BE\u22C0-\u2311\u2313-\u245F\u24B6-\u24CF\u24EA-\u24FF\u254C-\u254F\u2575-\u2580\u2590\u2591\u2596-\u259F\u25A2\u25AA-\u25B1\u25B4\u25B5\u25B8-\u25BB\u25BE\u25BF\u25C2-\u25C5\u25C9\u25CA\u25CC\u25CD\u25D2-\u25E1\u25E6-\u25EE\u25F0-\u2604\u2607\u2608\u260A-\u260D\u2610-\u261B\u261D\u261F-\u263F\u2641\u2643-\u265F\u2662\u2666\u266B\u266E\u2670-\u2BFF\u3004\u3018-\u301C\u3020\u302A-\u3030\u3036\u3037\u303F\u321D-\u321F\u322A-\u3230\u3233-\u3238\u323A-\u325F\u327C-\u327E\u3280-\u32A2\u32A9-\u3302\u3304-\u330C\u330E-\u3313\u3315-\u3317\u3319-\u3321\u3324\u3325\u3328-\u332A\u332C-\u3335\u3337-\u333A\u333C-\u3348\u334B\u334C\u334E-\u3350\u3352-\u3356\u3358-\u337A\u337F\u3385-\u3387\u33CB\u33CC\u33D4\u33D7\u33D9\u33DA\u33DE-\u33FF\uD80B-\uD83F\uFDFC-\uFE2F\uFE32\uFE45-\uFE48]/,D=[1,10,100,1e3,1e4,1e5,1e6,1e6],v.Cmt=b,v.validateSheetName=b,_={"'":1,"[":1,"]":1,"?":1,"%":1," ":1},l=j.TokenResolver,n(y,l),y.prototype.resolveToken=function(t,n,e,i){var r,o,a,u,s,c,f,l,h,d,v,m,l,g,p,m,p,h,l,g,h,m,l,b,y,w,r=t.useR1C1,o=t.row||0,a=t.column||0,s=e.length,c=e[i],f=c.Awt,l=c.uit,h=c.Twt;if(0!==l&&6!==h)return!1;if(0===l&&0===h&&i<s-2&&":"===e[i+1].Awt&&12===e[i+2].Twt&&e[i+2].Awt.indexOf(":")<0||0===l&&12===h){if(g=l=void 0,p=f.lastIndexOf(":"),m=f.lastIndexOf("]"),(f=M.Common.zf.fJ(f,"'")&&M.Common.zf.dT(f,"'")?f.substring(1,f.length-1):f)&&(m<p?(l=f.substring(0,p-1),g=f.substring(p)):("'"===(l=f).charAt(0)&&(l=l.substring(1,l.length-1)),0===h&&(g=e[i+2].Awt,i+=2,"'"===g.charAt(0))&&(g=g.substring(1,g.length-1)))),i++,m=!!l,(l=at(l))&&(d=(d=f?t.getExternalSource("",l):j.BangSource)||Z(l),g=at(g))&&(d instanceof S.ExternalSource?(v=d.getPeerSource(g)).jfe=!0:v=(v=t.getExternalSource("",g))||Z(g)),(c=e[i])&&"["===c.y4[0])return!1;if(!c)return A(f);f=c.Awt}if(p=i===s-1?B:e[i+1],st(e,c,i,r,!0)){if(h=t&&t.source&&t.source.Lbt&&t.source.Lbt.allowDynamicArray,!(l=Q(c.y4,r,o,a,h)).bwt&&!m)return!1;if(c.Twt=7,l.bwt&&l.wwt){if(g=l.Ky,h=l.iw,m=l.gwt,l=l.pwt,i<s-2&&5===p.uit&&":"===p.Awt&&st(e,p=e[i+2],i+2,r,!1)&&(b=Q(p.y4,r,o,a)).bwt&&g===C.BAND_INDEX_CONST==(b.Ky===C.BAND_INDEX_CONST)&&h===C.BAND_INDEX_CONST==(b.iw===C.BAND_INDEX_CONST))return o=g===C.BAND_INDEX_CONST?0:o,a=h===C.BAND_INDEX_CONST?0:a,{index:i+3,expr:(0,j.lJ)(d,v,g-(m?o:0),h-(l?a:0),b.Ky-(b.gwt?o:0),b.iw-(b.pwt?a:0),m,l,b.gwt,b.pwt,o,a)};if(g===C.BAND_INDEX_CONST||h===C.BAND_INDEX_CONST){if(r)return g-=g!==C.BAND_INDEX_CONST&&m?o:0,h-=h!==C.BAND_INDEX_CONST&&l?a:0,{index:i+1,expr:(0,j.lJ)(d,v,g,h,g,h,m,l,m,l,o,a)};if(!d)return!1;u=A(f)}if(!u)return T(d)&&(d=ut(t,o,a)),{index:i+1,expr:u=(0,j.knt)(d,v,y=g-(m?o:0),w=h-(l?a:0),m,l)}}else u=A(f)}else if(6===c.Twt)(u=new j.Expression(5)).value=j.CalcError.parse(c.Awt);else{if(!d)return!1;u=A(f)}return d&&(u.source=d),v&&(u.endSource=v),{index:i+1,expr:u}},y.prototype.unparse=function(t,n,e,i){var r=e&&e.type;return(1===r||8===r||5===r)&&($(t,n,e,i),!0)},v.SheetReferenceResolver=y,(t=G=v.StructReferencePortions||(v.StructReferencePortions={}))[t.ThisRow=1]="ThisRow",t[t.Headers=2]="Headers",t[t.Data=3]="Data",t[t.Totals=8]="Totals",t[t.HeadersAndData=6]="HeadersAndData",t[t.DataAndTotals=12]="DataAndTotals",t[t.All=14]="All",t[t.NotSpecific=16]="NotSpecific",(t=U=v.StructReferenceColumnSpecifier||(v.StructReferenceColumnSpecifier={}))[t.All=1]="All",t[t.NotSpecific=1]="NotSpecific",t[t.SingleColumn=2]="SingleColumn",t[t.ColumnRange=4]="ColumnRange",h=j.Expression,n(w,h),w.prototype.tableName=function(){return this.abt.tableName()},Object.defineProperty(w.prototype,"baseTable",{get:function(){return this.abt},set:function(t){this.abt=t,this.source=t.source()},enumerable:!1,configurable:!0}),w.prototype._K=function(){this.Owt=this.abt.startColumn()},w.prototype.columnReferenceStart=function(){return this.cbt+this.abt.startColumn()},w.prototype.columnReferenceEnd=function(){return this.fbt+this.abt.startColumn()},w.prototype.referencePortions=function(){return this.hbt},w.prototype.referenceColumnSpecifier=function(){return this.lbt},w.prototype.getRange=function(t,n,e){var i,r,o,a,u,s,c,f,l,h,d,v,r,i=this,r=i.abt;switch(i._K(),l=r.startRow(),h=r.endRow(),d=r.hasTotalsRow(),v=r.hasHeadersRow(),i.hbt){case 3:case 16:o=v?l+1:l,u=d?h-1:h;break;case 2:if(v)u=o=l;else{if(!e)return B;u=o=l-1}break;case 8:if(d)u=o=h;else{if(!e)return B;u=o=h+1}break;case 1:u=o=t;break;case 6:o=l+(e&&!v?-1:0),u=d?h-1:h;break;case 12:o=v?l+1:l,u=h+(e&&!d?1:0);break;default:o=l+(e&&!v?-1:0),u=h+(e&&!d?1:0)}if(22===i.type){if(a=i.abt.getColumnIndexInTable(i.ubt),s=i.abt.getColumnIndexInTable(i.sbt),-1===a||-1===s)return B}else a=i.columnReferenceStart(),s=i.columnReferenceEnd();return r=r.endColumn(),1===i.lbt&&(s=r),r<a||r<s?(i._error=!0,B):u<o||!e&&o<l||!e&&h<u?B:(0,j.Rwt)(o,a,c=u-o+1,f=s-a+1)},w.prototype.offsetWhenInsertRemoveColumn=function(t,n,e,i){var r,o,i,e,r=this,o=r.Owt;return T(o)&&(r._K(),o=r.Owt),T(o)||t<o||t===o&&e&&!i||t>r.fbt+o?r:(n=e?n:-n,i=t-o,(e=new w).baseTable=r.abt,e.fbt=r.fbt+n,e.cbt=r.cbt,t<=o+r.cbt&&(e.cbt+=n,e.cbt<i)&&(e.cbt=i),e.lbt=r.lbt,e.hbt=r.hbt,e.fbt<e.cbt?j.kyt:e)},w.prototype.offsetWhenCopy=function(t,n,e,i,r,o,a,u,s,c){var f,l,h,d,e,i,r,o,v,m,f=this,l=new O.SheetParserContext(n.Mf,n.Lbt.useR1C1,(0,j.eV)(e,i)),h=l.getTableByIndex(e,i),d=f.offset();return h&&(e=e-r,i=i-o,r=a-r,o=u-o,v=void 0,(v=(t===n?l:m=new O.SheetParserContext(t.Mf,t.Lbt.useR1C1,(0,j.eV)(e,i))).getTableByIndex(e,i))!==h)&&v===f.abt&&ct(v,r,o,s,c)&&ct(h,a,u,s,c)&&(d.baseTable=h),d},w.prototype.Bwt=function(t){var n,e,i,n=this,e=new w;return e.baseTable=n.abt,e.fbt=n.fbt,e.cbt=n.cbt,2===n.lbt&&t&&(i=n.abt.endColumn()-n.abt.startColumn()+1,e.cbt+=t%=i,e.cbt<0&&(e.cbt+=i),e.fbt=e.cbt),e.lbt=n.lbt,e.hbt=n.hbt,e},w.prototype.offset=function(t,n,e){var i,r,i=this,r=new w;return r.baseTable=i.baseTable,r.hbt=i.hbt,r.cbt=i.cbt,r.fbt=i.fbt,r.lbt=i.lbt,r},w.prototype.Lwt=function(t,n){var e=this.abt;return t>=e.startRow()&&n>=e.startColumn()&&t<=e.endRow()&&n<=e.endColumn()},w.prototype.Fwt=function(t,n,e){this.abt.Pwt(t,n,e)},c=w,v.obt=c,d=j.TokenResolver,n(I,d),I.prototype.resolveToken=function(t,n,e,i){var r,e,o,a,r,u,s,r,r=e[i],e=e[i+1];if(0===r.uit){if(a=o=void 0,0===r.Twt||7===r.Twt)o=r.Awt;else{if(12!==r.Twt||!e||0!==e.uit||0!==e.Twt||"["!==e.y4[0])return B;o=(r="'"===(r=r.Awt)[0]?r.substr(1,r.length-2):r)+e.Awt,a=!0}if("]"===o.charAt(o.length-1))try{return u=new c,lt(t,o.split(""),u),u.baseTable?(u.abt.Mf.NMi&&((s=u).type=22,s.Iwt=ft),a?{index:i+2,expr:u}:u):new j.Expression(0)}catch(t){}else if(r=t.getTableByName&&t.getTableByName(o))return I.create(r)}return B},I.prototype.unparse=function(t,n,e,i){var r,o,a,u,s,c,n,f,u,a,o,a,u;if(13!==e.type&&22!==e.type)return!1;if(o=(r=e).abt.Gwt,a=T(o)?r.abt.tableName():o,t.Sbt)u=r.getRange(t.row,t.column,!0),$(t,n,s=(0,j.lJ)(r.source,B,u.row,u.col,u.row+u.rowCount-1,u.col+u.colCount-1,!1,!1,!1,!1),i);else{if(n=i.length,22===r.type&&r.baseTable.Mf.xT)c=!0;else if(16===r.hbt&&1===r.lbt)return i.push(a),void(t.lyt&&i.push("[]"));(f=t.source===r.abt.source()&&r.Lwt(t.row,t.column))&&!t.lyt&&!r.abt.Mf.NMi||(u=T(o)?r.abt.tableName():o,(a=r.abt.Mf)&&a.NMi&&!(0,v.validateSheetName)(u.split(""))&&(u=nt(t,u.split(""),null).join("")+"!"),i.push(u)),i.push("["),16!==r.hbt&&(o=St(r.hbt,1!==r.lbt,t.lyt),i.push(o)),1!==r.lbt&&(1===r.hbt&&!t.lyt||16===r.hbt||i.push(", "),(a=22===e.type?r.ubt:r.abt.getColumnName(r.cbt))?a=x(a):c=!0,c||(4===r.lbt?(u=22===e.type?r.sbt:r.abt.getColumnName(r.fbt))?(u=x(u),i.push("[",a,"]:[",u,"]")):c=!0:1===r.hbt&&!t.lyt&&!bt(a)||16===r.hbt?i.push(a):i.push("[",a,"]"))),c?(i.length=n,i.push("#REF!")):i.push("]")}return!0},I.create=function(t,n,e,i,r){void 0===n&&(n=G.NotSpecific),void 0===e&&(e=U.NotSpecific),void 0===i&&(i=0),void 0===r&&(r=t.endColumn()-t.startColumn());var o=new c;return o.baseTable=t,o.hbt=n,o.cbt=i,o.fbt=r,o.lbt=e,o},v.StructureReferenceResolver=I,v.getValidaColumnName=x,z={"#all":14,"#data":3,"#headers":2,"#totals":8,"#this row":1},v.Vgt=It},"./dist/plugins/sheetsCalc/sheetsCalc.entry.js":function(t,n,e){"use strict";var i,r,i=this&&this.__createBinding||(Object.create?function(t,n,e,i){void 0===i&&(i=e);var r=Object.getOwnPropertyDescriptor(n,e);r&&("get"in r?n.__esModule:!r.writable&&!r.configurable)||(r={enumerable:!0,get:function(){return n[e]}}),Object.defineProperty(t,i,r)}:function(t,n,e,i){t[i=void 0===i?e:i]=n[e]}),r=this&&this.__exportStar||function(t,n){for(var e in t)"default"===e||Object.prototype.hasOwnProperty.call(n,e)||i(n,t,e)};Object.defineProperty(n,"__esModule",{value:!0}),r(e("./dist/plugins/sheetsCalc/calc.ns.js"),n),r(e("./dist/plugins/sheetsCalc/parser-sheets.js"),n),r(e("./dist/plugins/sheetsCalc/calc-spreadjs.js"),n),r(e("./dist/plugins/sheetsCalc/formulaOperatorAdjustor.js"),n),r(e("./dist/plugins/sheetsCalc/worksheet-formula.js"),n),e("./dist/plugins/sheetsCalc/workbook-formula.js")},"./dist/plugins/sheetsCalc/workbook-formula.js":function(t,n,e){"use strict";var G,n,i,r,C,U,S,o,f,e,T,A,I,a,x,v,N,H,z,k,V,m,D,u,_,E,Y,r;function j(t){t.forEach(function(t){var t=t.Uw();t.zE(),delete t.G3})}function g(t,c,f,l){G.GC$.each(t,function(t,n){var e,i,r,o,a,u,n,s,e,e=n.getName(),i=n.getRow(),r=n.getColumn(),o=n.getExpression(),a=n.getComment(),u=n.getFormatter&&n.getFormatter(),n=n.getSheetTabName&&n.getSheetTabName();o&&(e={name:e,formula:s=u||c.unparse(f,o,i,r,!1,!0),sheetTabName:n,row:i,col:r},a&&(e.comment=a),l.push(e))})}function Z(t,n){var t,e,i,t=N(t);if("str"===n)e=t;else if("b"===n)e="1"===t;else if("e"===n){switch(i=I,t){case"#DIV/0!":i=7;break;case"#N/A":i=42;break;case"#NAME?":i=29;break;case"#NULL!":i=0;break;case"#NUM!":i=36;break;case"#REF!":i=23;break;case"#VALUE!":i=15}e=i!==I?{error:t,code:i}:I}else e=parseFloat(t);return e}Object.defineProperty(n,"__esModule",{value:!0}),G=e("Core"),n=e("Common"),i=e("CalcEngine"),r=e("./dist/plugins/sheetsCalc/calc-spreadjs.js"),C=e("./dist/plugins/sheetsCalc/calc-spreadjs.js"),U=e("./dist/plugins/sheetsCalc/external-reference.js"),S=e("./dist/plugins/sheetsCalc/calc-extra-save.js"),o=r.SpreadSource,f=n.Common.zf.Gmt,e=new n.Common.ResourceManager(G.SR),T=e.getResource.bind(e),A=void 0,I=null,a=n.Common.kh,x=n.Common.lt.ht,v=G.mt.o1,N=G.mt.c1,H=G.mt.xr,z=G.mt.go,k=G.Util.Sr,V=G.IndexHelper.$i,m=G.Util.addXLFNPrefix,D=G.mt.n1,u=G.mt.vo,_=G.Util.io,E=G.XFileConstants.mo,Y=G.XFileConstants.Ki,(r=G.Workbook.prototype).Qp=function(t){var n,e,n=this,e=n.Lp;n.Lp=new i.CalcService,n.Lp.useR1C1=1===n.options.referenceStyle,n.Lp.allowDynamicArray=n.options.allowDynamicArray,n.Lp.iterativeCalculation=n.options.iterativeCalculation,n.Lp.iterativeCalculationMaximumIterations=n.options.iterativeCalculationMaximumIterations,n.Lp.iterativeCalculationMaximumChange=n.options.iterativeCalculationMaximumChange,t&&e&&n.Lp.cloneFrom(e),n.yC=new o(n),n.wC=n.Lp.getGlobalSourceModel(n.yC)},r.addCustomFunction=function(t){this.Uwt(t)},r.Uwt=function(t){if(!(t&&t instanceof i.Functions.Function))throw new Error(T().Exp_InvalidCustomFunction);t.name=f(t.name),this.Amt[t.name]=t},r.getCustomFunction=function(t){return t?this.Amt[f(t)]:A},r.removeCustomFunction=function(t){t&&(delete this.Amt[f(t)],this.Hwt())},r.clearCustomFunctions=function(){this.Amt={}},r.addCustomName=function(t,n,e,i,r){this.zwt(this.hyt,t,n,e,i,!1,r)},r.Vwt=function(t){return!this.hyt[f(t)]},r.isValidCustomName=function(t){return t&&G.mt.P0(t)&&this.Vwt(t)},r.pp=function(t,n,e,i,r,o,a,u){var s,c,s=this;if(!n||!e)throw new Error(T().Exp_InvalidCustomName);u&&s.Lp?(c=u.Ywt(e,i,r),t[f(n)]=new C.FormatterNameInfo(n,e,u.name(),c,i,r)):s.zwt(t,n,e,i,r,o,a)},r.zwt=function(t,n,e,i,r,o,a){var u,s,s,c,u,u=this;if(!n||!e||!o&&!u.isValidCustomName(n))throw new Error(T().Exp_InvalidCustomName);if(u.Lp){if(s=(s=(0,G.jf)(this))?s.Uw():I,c=void 0,o)try{c=u.Lp.parse(s,e,i,r,!1,!1,!0)}catch(t){}else c=u.Lp.parse(s,e,i,r);t[f(n)]=new C.NameInfo(n,c,i,r,a),o||((u={})[n]=n,this.Zwt(u,!0))}},r.Wwt=function(t,n,e,i,r,o,a,u){var s,e,s=this;if(!n||!e||!a&&!s.isValidCustomName(n))throw new Error(T().Exp_InvalidCustomName);s.Lp&&(t[f(n)]=new C.NameInfo(n,i,r,o,u),a||((e={})[n]=n,this.Zwt(e,!0)))},r.getCustomName=function(t){return t?this.hyt[f(t)]:A},r.xO=function(t){return t?this.bp[f(t)]:A},r.getCustomNames=function(){var e=[];return G.GC$.each(this.hyt,function(t,n){e.push(n)}),e},r.Qwt=function(){var e=[];return G.GC$.each(this.bp,function(t,n){e.push(n)}),e},r.removeCustomName=function(t){var n;t&&(delete this.hyt[f(t)],(n={})[t]=t,this.Zwt(n,!1))},r.o3=function(t){var n;t&&(delete this.bp[f(t)],(n={})[t]=t,this.Zwt(n,!1))},r.clearCustomNames=function(){var t=this.hyt;this.hyt={},this.Zwt(t,!1)},r.Kwt=function(){var t=this.bp;this.bp={},this.Zwt(t,!1)},r.Zwt=function(t,n){var e,i;if(t){for(i in e=this.wC,t)e&&e.updateNameCalc(i,n);this.Hwt()}},r.Hwt=function(){var t;this.Lp&&!this.Lp.IsSuspended()&&(t=this.getActiveSheet())&&(t.suspendPaint(),this.Lp.recalculateAll(),t.resumePaint())},r.getCalcService=function(){return this.Lp},r.op=function(){return this.Lp},r.suspendCalcService=function(t){this.Lp&&this.Lp.suspend(t)},r.resumeCalcService=function(t){this.Lp&&this.Lp.resume(t)},r.getCircularReference=function(){var t,n,e,i,t=this.Jwt(),n=[];for(e in t=this.Xwt(t))a(t,e)&&(i=e.split("\\"),n.push({row:+i[1],col:+i[2],rowCount:1,colCount:1,sheetName:i[0]}));return n},r.updateExternalReference=function(t,n,e){this.suspendPaint(),this.suspendCalcService(),this._p._6(t,n,e),this.resumeCalcService(!1),this.resumePaint()},r.getExternalReferences=function(t){return this._p.myt(t)},r.Jwt=function(){var l={};return this.sheets.forEach(function(t){var n,e,i,r,o,a,u,s,c,f,f,n=t.b3(),e=t.getRowCount(),i=t.getColumnCount(),r=t.name();if(n)for(o=0;o<e;o++)for(a=0;a<i;a++)for(u=r+"\\"+o+"\\"+a,s=t.qwt(o,a),!l[u]&&0<s.length&&(l[u]={from:[],to:[]}),c=0;c<s.length;c++)f=(f=s[c]).sheetName+"\\"+f.row+"\\"+f.col,l[f]||(l[f]={from:[],to:[]}),l[f].from.push(u),l[u].to.push(f)}),l},r.Xwt=function(e){var i,t,n;function r(t,n){t.splice(t.indexOf(n),1)}for(i=!0;0<Object.keys(e).length&&i;)for(n in i=!1,t=function(n){var t;a(e,n)&&(0===(t=e[n]).from.length?(t.to.forEach(function(t){r(e[t].from,n)}),delete e[n],i=!0):0===t.to.length&&(t.from.forEach(function(t){r(e[t].to,n)}),delete e[n],i=!0))},e)t(n);return e},G.Workbook.ch("calc",{priority:1e3,init:function(){this.Amt={},this.hyt={},this.bp={},this._p=new U.ExternalReferenceManager},toJson:function(t){var n,e,e,u,e,i,r,s,n,c,n=this,e=n.Amt;G.GC$.isEmptyObject(e)||(t.customFunctions=e),e=n._p.toJSON(n),G.GC$.isEmptyObject(e)||(t.externalReference=e),u=[],e=[],i=n.getCustomNames(),r=n.Qwt(),s=n.Lp,n=this.getActiveSheet(),c=n?n.Uw():I,i&&s&&(G.GC$.each(i,function(t,n){var e,i,r,o,n,a,e,e=n.getName(),i=n.getRow(),r=n.getColumn(),o=n.getExpression(),n=n.getComment();o&&(e={name:e,formula:a=s.unparse(c,o,i,r,!1,!0),row:i,col:r},n&&(e.comment=n),u.push(e))}),g(r,s,c,e),0<u.length&&(t.names=u),0<e.length)&&(t.formatStringNames=e)},wh:function(t,n,u){var e,i,i,r,o,a,s,i,r,c,o,f,o,l,h,d,o,i,e=this,i=e.Amt;G.GC$.isEmptyObject(i)||(t.workbook.lossless.customFunctions=i),e._p&&(r=(i=e._p.wh(t)).externalReferencesNode,o=i.externalLinks,0<(a=i.count))&&(t.workbook.c_.push(r),t.externalLinks=o),s=[],i=v(t.workbook,"definedNames"),r=e.getCustomNames(),c=e.Lp,o=this.getActiveSheet(),f=o?o.Uw():I,o=e.yC,l=o&&o.getUsedCustomNames()||{},r&&0<r.length&&c&&(i||t.workbook.c_.push(i={n_:"definedNames",c_:[]}),h=i.c_,d=!u||!1!==u.includeUnusedNames,G.GC$.each(r,function(t,n){var e,i,r,o,n,a,e,n,e=n.getName(),i=n.getRow(),r=n.getColumn(),o=n.getExpression(),n=n.getComment();o&&(d||l[e])&&(e={n_:"definedName",name:e,comment:n,c_:[a=m((0,C.encodeNameFormula)(c.unparse(f,o,i,r,!1,!0)))]},u&&u.includeCalcModelCache&&(n=(0,S.exprToJSON)(o),s.push(n),e.e=s.length-1),h.push(e))})),0<s.length&&(t.workbook.lossless.exprs=s),o=[],(i=e.Qwt())&&0<i.length&&c&&(g(i,c,f,o),0<o.length)&&(t.workbook.lossless.formatStringNames=o),t.workbook.lossless.idMap=(0,S.dbt)(c)},preFromSJSFormat:function(t,B,L){var n,e,i,r,o,a,u,s,c,f,l,h,d,u,v,m,g,p,b,y,w,M,C,S,T,A,F,I,x,N,k,D,_,E,E,D,j,O,R,P,n=H(t.workbook,"externalReferences"),e=t.externalLinks;if(n&&e&&n.c_&&0<n.c_.length){for(r in i={},e)if(e.hasOwnProperty(r)){if(o=e[r],a={},u=H(o,"externalBook")){if(c=[],(s=H(u,"sheetNames"))&&s.c_&&s.c_.length){for(f=0,l=s.c_.length;f<l;f++)(h=s.c_[f])&&(d=h.val)&&(d=G.mt.Nfe(d),c.push(d));a.sheetNames=c}if(u=H(u,"sheetDataSet")){if(v={},m=z(u,G.XFileConstants.bo))for(g=0,p=m.length;g<p;g++)if(y=+(b=m[g]).sheetId,w="1"===b.refreshError,M=v[d=c[y]]={},w&&(M.isNew=!0),C=z(b,"row"))for(S=0,T=C.length;S<T;S++)if((A=C[S])&&(I=M[F=A.r-1]={},x=z(A,"cell")))for(N=0,k=x.length;N<k;N++)_=void 0,(D=x[N])&&((E=D.r)&&(_=V(E)),E=D.t,j=void 0,(D=H(D,"v"))&&(j=Z(D,E)),I[_]=j);a.data=v}}a.option=o.option,i[r]=a}for(O={},P=(R=n.c_).length,f=0;f<P;f++)O[f+1]=i[R[f][Y]];this._p=new U.ExternalReferenceManager(O)}},yh:function(r,e,i){var o,n,a,u,t,s,c,f,l,h,d,v,m,g,p,p,b,y,w;function M(){var t,t;return n||(t=(t=(0,G.jf)(o)||o.sheets[0])?t.Uw():I,n=t&&t.getParserContext(!1)),n}if(a=(o=this).Lp,u=i&&!i.fullRecalc,t=G.Util.wo(i,o.v2),a&&(a.suspend(),a.lb=u),o.clearCustomNames(),(s=o.sheets).forEach(function(t){t.Uw().G3=!0}),c=r.workbook.lossless,i&&(i.$wt=(0,S.vbt)(a,c)),(f=e.workbookNames)&&0<f.length&&f.forEach(function(t){var n=t.name,e=N(t),i=t.comment;c&&c.exprs&&c.exprs[t.e]?o.Wwt(o.hyt,n,""+(0,C.processFunctionPrefix)(G.mt.n1(e)),(0,S.exprFromJSON)(c.exprs[t.e],M()),0,0,!0,i,!0):e&&o.zwt(o.hyt,n,""+(0,C.processFunctionPrefix)(G.mt.n1(e)),0,0,!0,i,!0)}),o.Kwt(),l=c&&c.formatStringNames)for(h=0;h<l.length;h++)d=l[h],x(d.sheetTabName)&&o.pp(this.bp,d.name,d.formula,d.row,d.col,!0,d.comment,A,!0);if(o.clearCustomFunctions(),v=c&&c.customFunctions)for(m in v)v.hasOwnProperty(m)&&(g=v[m],p=(0,G.getTypeFromString)(g.typeName))&&((p=new p).fromJSON(g),o.Uwt(p));t||(b=[],y=r.workbook.rels&&r.workbook.rels.c_,(w=H(r.workbook,E).c_).forEach(function(t){var n,n,t,t,t,e,i,n=_(D(t.name)),n=o.getSheetFromName(n),t=t[Y],t=k(y,t),t=t&&t.Target;t&&(e=o.getSheetRelsName(t),i=void 0,i=(-1<t.indexOf("xl/chartsheets")?r.chartsheets:r.sheets)[e],b.push({sheet:n,sheetData:i}))}),b.forEach(function(t){t.sheet&&t.sheet.nameFunctionFromSJSFormat(t.sheetData,e,i)}),b.forEach(function(t,n){t.sheet&&t.sheet.formulaFromSJSFormat(t.sheetData,e,i)})),i.incrementLoadTask.addTask(function(t,n,e){a&&(u?a.resumeWithoutCalc():a.resume(!1),delete a.lb),j(s)},[a,r,i],u?A:T().STEP.startCalc,function(){return u?G.STEP_RATE.end:G.STEP_RATE.loadFileData+G.STEP_RATE.parseFile+G.STEP_RATE.loadSheetDataWithCalc+G.STEP_RATE.loadSheetFormulaWithCalc})},Mb:function(r,n,e){var o,a,u,t,s,i,c,f,l,h,d,v,m,g,g,p,b,y,o=this,a=o.Lp,u=e&&!e.fullRecalc,t=G.Util.wo(e,o.v2);if(a&&(a.suspend(),a.lb=u),o.clearCustomNames(),(s=o.sheets).forEach(function(t){t.Uw().G3=!0}),i=r.workbook.lossless,(c=n.workbookNames)&&0<c.length&&c.forEach(function(t){var n=t.name,e=N(t),t=t.comment;e&&o.zwt(o.hyt,n,""+(0,C.processFunctionPrefix)(G.mt.n1(e)),0,0,!0,t,!0)}),o.Kwt(),f=i&&i.formatStringNames)for(l=0;l<f.length;l++)h=f[l],x(h.sheetTabName)&&o.pp(this.bp,h.name,h.formula,h.row,h.col,!0,h.comment,A,!0);if(o.clearCustomFunctions(),d=i&&i.customFunctions)for(v in d)d.hasOwnProperty(v)&&(m=d[v],g=(0,G.getTypeFromString)(m.typeName))&&((g=new g).fromJSON(m),o.Uwt(g));t||(p=[],b=r.workbook.rels&&r.workbook.rels.c_,(y=H(r.workbook,E).c_).forEach(function(t){var n,n,t,t,t,e,i,n=_(D(t.name)),n=o.getSheetFromName(n),t=t[Y],t=k(b,t),t=t&&t.Target;t&&(e=o.getSheetRelsName(t),i=void 0,i=(-1<t.indexOf("xl/chartsheets")?r.chartsheets:r.sheets)[e],p.push({sheet:n,sheetData:i}))}),p.forEach(function(t){t.sheet&&t.sheet.nameFunctionFromSJSFormat(t.sheetData,n,e)}),p.forEach(function(t){t.sheet&&t.sheet.formulaFromSJSFormat(t.sheetData,n,e)})),e.incrementLoadTask.addTask(function(t,n,e){var i;a&&(u?a.resumeWithoutCalc():(a.resume(!1),delete a.tMt,(i=o.getActiveSheet())&&i.zw()),delete a.lb),j(s)},[a,r,e])},preFromJson:function(t,n,e){this._p=new U.ExternalReferenceManager(t.externalReference)},fromJson:function(t,n,e){var i,r,o,a,u,s,c,f,l,h,d,v,m,g,p,b,y,w,w,M,C,S,i=this,r=i.Lp,o=t.noRecalc||e&&e.doNotRecalculateAfterLoad;if(r&&(r.suspend(),r.lb=o),i.clearCustomNames(),c=[],s=t.sheets)for(l in s)"string"==typeof l&&(h=s[l],u=i.getSheetFromName(h.name||l))&&(u.Uw().G3=!0);if(d=t.names)for(v=0;v<d.length;v++)m=d[v],i.zwt(this.hyt,m.name,m.formula,m.row,m.col,!0,m.comment);if(i.Kwt(),g=t.formatStringNames)for(v=0;v<g.length;v++)m=g[v],x(m.sheetTabName)&&i.pp(this.bp,m.name,m.formula,m.row,m.col,!0,m.comment);if(i.clearCustomFunctions(),p=t.customFunctions)for(b in p)p.hasOwnProperty(b)&&(y=p[b],w=(0,G.getTypeFromString)(y.typeName))&&((w=new w).fromJSON(y,n),i.Uwt(w));if(s){for(l in a=0,s)"string"==typeof l&&(h=s[l],u=i.getSheetFromName(h.name||l))&&(c.push(u),u.nameFunctionsFromJSON(h,n,e),a++);for(f=c.length,a=0;a<f;a++)(u=c[a]).formulaFromJSON(s[u.name()],n,e)}for(r&&(o?r.resumeWithoutCalc():(r.resume(!1),delete r.tMt),delete r.lb),M=0,C=c;M<C.length;M++)(S=(u=C[M]).Uw()).zE(),delete S.G3},Yp:function(t,n,e){var u,s,c,i,f,r,l,o,a,h,d,v,m,g,p,b,y,w,w,u=this,s=u.Lp,c=t.noRecalc||e&&e.doNotRecalculateAfterLoad;if(s&&(s.suspend(),s.lb=c),u.clearCustomNames(),r=t.sheets,l=[],r)for(a in r)"string"==typeof a&&(h=r[a],f=u.getSheetFromName(h.name||a))&&(f.Uw().G3=!0);if(d=t.names)for(v=0;v<d.length;v++)m=d[v],u.zwt(this.hyt,m.name,m.formula,m.row,m.col,!0,m.comment);if(u.Kwt(),g=t.formatStringNames)for(v=0;v<g.length;v++)m=g[v],x(m.sheetTabName)&&u.pp(this.bp,m.name,m.formula,m.row,m.col,!0,m.comment);if(u.clearCustomFunctions(),p=t.customFunctions)for(b in p)p.hasOwnProperty(b)&&(y=p[b],w=(0,G.getTypeFromString)(y.typeName))&&((w=new w).fromJSON(y,n),u.Uwt(w));if(r){for(a in i=0,r)"string"==typeof a&&(h=r[a],f=u.getSheetFromName(h.name||a))&&(l.push(f),f.nameFunctionsFromJSON(h,n,e),i++);for(o=l.length,i=0;i<o;i++)(f=l[i]).formulaFromJSON(r[f.name()],n,e)}e.incrementLoadTask.addTask(function(t,n,e){var i,r,o,a;for(s&&(c?s.resumeWithoutCalc():(s.resume(!1),delete s.tMt,(i=u.getActiveSheet())&&i.zw()),delete s.lb),r=0,o=l;r<o.length;r++)(a=(f=o[r]).Uw()).zE(),delete a.G3},[s,t,e])}})},"./dist/plugins/sheetsCalc/worksheet-formula.js":function(a,t,n){"use strict";var w,e,k,m,M,g,D,C,p,f,y,n,S,T,i,b,r,h,A,u,l,I,x,P,G,U,N,_,n;function o(t){return"="===t.charAt(0)}function H(t){var n,e;return{left:t.indexOf("["),right:t.indexOf("]")}}function z(t){var t=H(t),n=t.left,t=t.right;return 0<=n&&n<t}function V(t){var n=H(t),e=n.left,n=n.right,t=t.indexOf("@");return e<t&&t<n}function Y(t){return o(t)&&V(t)}function Z(t){return o(t)&&z(t)}function W(t,n){var e,i;if(t.NMi){if(Z(n=n.trim()))return 1;if(0<=n.indexOf("{{")&&0<=n.indexOf("}}"))for(e=n.split(/{{|}}/),i=0;i<e.length;i++)if(Z(e[i].trim()))return 1}}function Q(t,n,e,i){return e===C&&(e=t.getActiveRowIndex()),t.NMi.nMt(n,e,i)}function J(t){return t.columnRelative}function K(t){return t.endColumnRelative}function X(t){return t.rowRelative}function q(t){return t.endRowRelative}function E(t){return t.op()}function $(t){t.column}function d(t){return t.toUpperCase()===i?r:t}function tt(){var t=this;t.eMt?t.eMt=!1:(t.Amt={},t.hyt={},t.iMt?t.iMt.clearAll():t.T3=new m.SheetSource(t,w.SheetArea.colHeader),t.rMt?t.rMt.clearAll():t.A3=new m.SheetSource(t,w.SheetArea.rowHeader),t.oMt?t.oMt.clearAll():t.qgt=new m.SheetSource(t,w.SheetArea.viewport))}function nt(t,n){var e,i,r,o,a,e=t.Ut.t8&&t.Ut.t8.anchors;if(e)for(i in n.spillCells={},e)if(Object.prototype.hasOwnProperty.call(e,i))for(o in r=e[i])!Object.prototype.hasOwnProperty.call(r,o)||(a=r[o]).isValid||(n.spillCells[i+","+o]=1)}function s(t,n,e,i,r,o){var t=t.iT(n,e,i,r,o),n=t&&t.formulas;return n&&0<n.length}function et(t,n,e,i,r,o,a){var u=s(t,n,e,i,r,3);return!u&&o&&(r=t.getColumnCount(2),u=s(t,n,0,i,r,2)),!u&&a&&(i=t.getRowCount(1),u=s(t,0,e,i,r,1)),u}function it(t){for(var n,e,i,r,o,n=[],e=[],i=0;i<t.length;i++)o=""+(r=t[i]).row+r.col+r.rowCount+r.colCount+r.sheetName,n.indexOf(o)<0&&(n.push(o),e.push(r));return e}function rt(t,n){var t=t.formulaLoad/t.total;return n?.4*t+.5:.3*t+.4}function ot(t,n,e,i,r,o){var a,u,s,c,f,c,f,a=i.Uw(),u=t&&t.formula;u&&(s=void 0,"object"==typeof u&&(c=i.b3(o),(f=i.Xbt[u.si]).baseRow===n&&f.baseColumn===e?u=f.formula:(s=c.pB(f.baseRow,f.baseColumn))?(s.aMt=u.si,i.Lp.tMt&&i.Lp.tMt[a.id+","+f.baseRow+","+f.baseColumn]&&(i.Lp.tMt[a.id+","+n+","+e]={id:a.id,row:n,col:e})):(u=f.formula,f.baseRow=n,f.baseColumn=e)),(c=t.arrayInfo)&&!c.isDynamicArray?i.uMt(n,e,N(c.rowCount,10),N(c.colCount,10),u,!0,o):(f=a.getCalcSourceModel(),c&&(c.isInvalid&&a.HE(n,e),f.FE=!0,a.Qbt().setArray(a,c.row,c.col,c.rowCount,c.colCount,[],!0),delete f.FE),i.zI(n,e,u,s,!0,o,!0,!c),c&&f.Uyt(n,e,c)))}function j(t,n,e,i,r,o,a){var u,s,c,f,l,h,d,v,u,o,u=r&&r.incrementLoadTask;if(u&&!u.isTerminated){for(s=u.isBusyFunc,c=o=o||0,t.suspendPaint(),f=30,l=new Date;c<e;){if(h=n[c])for(d=0;d<i;d++)ot(h[d],c,d,t,!0,a);if(c++,s&&s())break;if(30<(v=new Date)-l)break}t.resumePaint(),(u=(r=r||{})&&r.incrementalLoading)&&(u.loadStatus.formulaLoad+=c-o,o=rt(u.loadStatus,r.doNotRecalculateAfterLoad),t.parent&&t.parent.ki(w.Events.ProgressChanged,{loadStatus:u.loadStatus,progress:o,sheet:t}),u.loading)&&u.loading(o,{sheet:t}),c<e&&r.incrementLoadTask.pushTask(j,[t,n,e,i,r,c])}}function c(t,n,e,i,r){for(var o,a,u,o=0;o<e;o++)if(a=n[o])for(u=0;u<i;u++)ot(a[u],o,u,t,!0,r)}function at(t,n,e,i,r,o,a){var u,s,c,s,f,l,h,d,v,h,h,u=t.Uw(),s=t.Ut,c=s.ap||0,s=s.fp||0;n===C||(f=I(n.f),l=n.g,(h=n.r)!==C&&(d=A(h)),"shared"===n.d&&0<=l&&(f=(f&&(h={formula:f},d&&(h.lastRow=d.rowCount+d.row-1,h.lastColumn=d.colCount+d.col-1,h.baseRow=d.row,h.baseColumn=d.col,d=D),o[l]||(o[l]=h,o.nextIndex=Math.max(o.nextIndex,l+1))),{si:l}),(h=t.Xbt[f.si]).baseRow===e&&h.baseColumn===i?f=h.formula:(v=r.pB(h.baseRow,h.baseColumn))?(v.aMt=f.si,t.Lp.tMt&&t.Lp.tMt[u.id+","+h.baseRow+","+h.baseColumn]&&(t.Lp.tMt[u.id+","+e+","+i]={id:u.id,row:e,col:i})):(f=h.formula,h.baseRow=e,h.baseColumn=i)),T(f))||(1==+n.a&&d&&(d.isDynamicArray=!0,a)&&a.spillCells&&a.spillCells[e+","+i]&&(d.isInvalid=!0),f=(0,m.processFunctionPrefix)(f),d&&!d.isDynamicArray?c<=e&&i<s?t.uMt(e,i,N(d.rowCount,10),N(d.colCount,10),f,!0,2):e<c&&s<=i?t.uMt(e,i,N(d.rowCount,10),N(d.colCount,10),f,!0,1):c<=e&&s<=i&&t.uMt(e,i,N(d.rowCount,10),N(d.colCount,10),f,!0,3):(d&&(d.isInvalid&&u.HE(e,i),u.Qbt().setArray(u,d.row,d.col,d.rowCount,d.colCount,[],!0)),!v&&a&&a.exprs&&a.exprs[n.x]&&(v=(0,g.exprFromJSON)(a.exprs[n.x],u.getParserContext(!1)),a.exprs[n.x].nw)&&(v.sMt=!0),c<=e&&i<s?t.zI(e,i,f,v,!0,2,!0,!d):e<c&&s<=i?t.zI(e,i,f,v,!0,1,!0,!d):c<=e&&s<=i&&t.zI(e,i,f,v,!0,3,!0,!d),d&&r.Uyt(e,i,d)))}function O(t,n,e,i,r,o,a,u){var s,c,f,l,h,d,v,m,g,p,b,a,a,s,c=(o&&o.incrementLoadTask).isBusyFunc,f=a=a||0;for(t.suspendPaint(),t.suspendCalcService(),h=30,(l=o.openMode===w.OpenMode.incremental)&&(d=new Date),v=t.Xbt=t.Xbt||{nextIndex:0},m=t.b3(3);f<e;){if(g=n[f])for(p=0;p<i;p++)at(t,g[p],f,p,m,v,r);if(f++,!u&&c&&c())break;if(l&&(b=new Date,!u)&&30<b-d)break}t.resumeCalcService(),t.resumePaint(),o.loadStatus.formulaLoad+=f-a,l&&(a=o.loadStatus.formulaLoad/o.loadStatus.total,a=+(o.fullRecalc?.3*a+.5:.4*a+.6).toFixed(5),o.incrementLoadTask.progress)&&o.incrementLoadTask.progress({progress:a,sheetName:t.name(),step:y.I5(S().STEP.loadSheetFormula,[t.name()])}),f<e&&o.incrementLoadTask.pushTask(O,[t,n,e,i,r,o,f])}function ut(e,i,r,o){var t=w.Worksheet.fh;t&&p(t,function(t,n){var n=n.fromJsonAfterFormula;n&&n.call(e,i,r,o)})}function st(e,i,r,o){var t=w.Worksheet.fh;t&&p(t,function(t,n){var n=n.fromJsonAfterSJSFormula;n&&n.call(e,i,r,o)})}function ct(n,e,i,t,r,o){var a,u,s,c,f,l,h,a=w.Worksheet.fh,u=!1,s=[],c=t.getReferenceSheetNames(),f=n&&n.v2,l=function(t){var i;c.hasOwnProperty(t)&&(u=!0,i=(0,w._f)(n,t),f.sheetsState[t]||f.refSheetsState[t]||!i||(f.refSheetsState[t]=1,f.getSheet(t,function(e){var t,t,t=i.NMi;t?(t.yh(e,r,o),t.E0i=e.order,(t=(0,w.Ip)(t,e.lossless.addition,n.dataManager()))&&s.push(t)):(i.yh(e,r,o,!0),i.E0i=e.order),a&&p(a,function(t,n){n.refSheetLazyLoaded&&n.refSheetLazyLoaded.call(i,e,r,o)})})))};for(h in c)l(h);u&&a&&p(a,function(t,n){n.afterRefSheetLazyLoaded&&n.afterRefSheetLazyLoaded.call(e,i,r,o)}),0<s.length&&o&&o.fullRecalc&&Promise.all(s).then(function(){n.suspendPaint(),n.mp[0].Mf.recalcAll(!0),n.resumePaint()})}function ft(t,n,e){var i,r,o,o;if(t)for(i in t)(o=(r=t[i]).WK)!==C&&(o=e.unparse(n,o,0,0),r.WK=e.parse(n,o,0,0))}function lt(i){return function(t){var n,e,n,n=t.w3.rT,e=(n?n.Mf:this).name(),n=(n?n.Mf:this)._id;i[n+" "+t.row+" "+t.column]={row:t.row,col:t.column,rowCount:1,colCount:1,sheetName:e}}}function ht(t){var n,e,n=[];for(e in t)t.hasOwnProperty(e)&&n.push(t[e]);return n}function v(t,r,n,e,o,i,a){var i,n;i&&t.lossless&&[t.lossless.colHeaderData,t.lossless.rowHeaderData].forEach(function(t,n){var n,t,e,i;t&&t.dataTable&&(t=t.dataTable,e=r.getRowCount(n=n+1),i=r.getColumnCount(n),a?j(r,t,e,i,o,0,n):c(r,t,e,i,n))}),i&&n.cMt&&t.lossless.tree&&0<t.lossless.tree.length&&(delete n.cMt,i=null,"rangeCalc"===(n=t.lossless.tree)[n.length-1].k&&(i=n.pop()),(0,g.pbt)(r.b3(),n,o.$wt),i)&&(0,g.gbt)(r.b3(),i,o.$wt),a?o.incrementLoadTask.pushTask(st,[r,t,e,o]):st(r,t,e,o)}function R(t,n){var e,i,r,t;return!n||(e=t.getRow(),i=t.getColumn(),(t=t.getExpression().getRange(e,i))&&!(t=t instanceof w.Range?t:new w.Range(t.row,t.col,t.rowCount,t.colCount)).containsRange(n))}function B(i,r,o,a,u,s){var t,c,f,l,h,d,n,e,v,m,g,l=!a&&i.Ut.pj(),h=!!s;if(i.parent&&i.parent.sheets)for(d=i.parent.sheets,n=i.parent.getCustomNames(),e=i.parent.Qwt(),v=!T(i.parent.fMt)&&i.parent.wJt(),n&&p(n,function(t,n){R(n,s)&&(c=n.getExpression(),(f=L(null,i,r,o,a,u,c,h))!==c)&&n.SB(f,l)}),e&&p(e,function(t,n){R(n,s)&&(c=n.getExpression(),(f=L(null,i,r,o,a,u,c,h))!==c)&&n.SB(f,l)}),v&&p(v,function(t,n){R(n,s)&&(c=n.getExpression(),(f=L(null,i,r,o,a,u,c,h))!==c)&&n.SB(f,l)}),m=function(e){(t=d[e].getCustomNames())&&p(t,function(t,n){R(n,s)&&(c=n.getExpression(),(f=L(d[e],i,r,o,a,u,c,h))!==c)&&n.SB(f,l)})},g=0;g<d.length;g++)m(g);else(t=i.getCustomNames())&&p(t,function(t,n){R(n,s)&&(c=n.getExpression(),(f=L(i,i,r,o,a,u,c,h))!==c)&&n.SB(f,l)})}function L(t,n,e,i,r,o,a,u){var s,c,f,l,h,d,v,m,g,p,b,y,l,d,h,v,h,v,l,d,w,M,C,S,T,A,I,x,c,A,N;if(a){if(s=n.Uw(),c=(0,k.Syt)(k.Errors.Reference,s),9===a.type){if(l=a.value,h=a.value2,d=L(t,n,e,i,r,o,l,u),v=h&&L(t,n,e,i,r,o,h,u),l!==d||h!==v)return(0,k.rbt)(a.operatorType,d,v)}else if(7===a.type){for(m=!1,g=[],p=void 0,b=0;b<a.arguments.length;b++)y=L(t,n,e,i,r,o,p=a.arguments[b],u),m=m||p!==y,g.push(y);if(m)return(0,k.YJ)(a,g)}else if(1===a.type&&a.hmt()){if(f=a.source||t&&t.Uw(),h=l=a.row,v=d=a.column,f&&f===s&&(o&&!a.rowRelative||!o&&!a.columnRelative)){if(o&&r)l+=e<=l?i:0;else if(!o&&r)d+=e<=d?i:0;else if(o){if(e+i<=l)l-=i;else if(e<=l)return c}else if(e+i<=d)d-=i;else if(e<=d)return c;if(l!==h||d!==v)return(0,k.knt)(s,D,l,d,a.rowRelative,a.columnRelative)}}else if(1===a.type){if(f=a.source||t&&t.Uw(),h=a.row,v=a.column,l=a.endRow,d=a.endColumn,w=a.rowRelative,M=a.columnRelative,C=a.endRowRelative,S=a.endColumnRelative,T=h,A=v,I=l,x=d,f&&f===s){if(o&&r)h+=!w&&e<=h?i:0,l+=!C&&e<=l?i:0;else if(!o&&r)v+=!M&&e<=v?i:0,d+=!S&&e<=d?i:0;else if(o&&!r){if(!w&&e<=h&&!C&&l<e+i)return c;if(w&&C||l<e)return a;if(!w)if(e+i<=h)h-=i;else if(!(h<e)){if(C)return c;e<h&&(h=e)}if(!C)if(e+i<=l)l-=i;else{if(w)return c;l<e+i&&(l=e-1)}}else{if(!M&&e<=v&&!S&&d<e+i)return c;if(M&&S||d<e)return a;if(!M)if(e+i<=v)v-=i;else if(!(v<e)){if(S)return c;e<v&&(v=e)}if(!S)if(e+i<=d)d-=i;else{if(M)return c;d<e+i&&(d=e-1)}}if(v!==A||d!==x||h!==T||l!==I)return(0,k.lJ)(s,D,h,v,l,d,w,M,C,S)}}else if(10===a.type){if((c=a.value)!==(A=L(t,n,e,i,r,o,c,u)))return(0,k.Ayt)(A)}else 13===a.type&&(f=a.source||t&&t.Uw())&&f===s&&!o&&(a=a.offsetWhenInsertRemoveColumn(e,i,r,u));return a}}function dt(t,n){var e,i,r,o,a,u,s,c,n,f,i,e=n.w3,i=e.getSource(),a=-1,u=-1;n.name?(o=n.name,c=n.id,T(c)?r=e.getNodeByName(o):(r={WK:n.expression},s=!0)):(a=n.row,u=n.column,r=e.getNode(a=void 0===a?-1:a,u=void 0===u?-1:u)),n=r.WK,f=r.$bt,i=t.unparse(i,n,a<0?0:a,u<0?0:u),f&&(!0!==t.allowDynamicArray||!0===t.allowDynamicArray&&!f.isDynamicArray)?a===f.row&&u===f.col&&e.setArrayFormula(f.row,f.col,f.rowCount,f.colCount,i):o?s?e.setFormula(c,o,i):e.setFormulaByName(o,i):e.setFormula(a,u,i,null,!0,!0),r.WK.lMt=n.lMt}function vt(t){for(var n,e,i,r,o,a,u,s,c,f,l,h,d,v,m,n=E(t),e,i,r,o=[t.b3(w.SheetArea.colHeader),t.b3(w.SheetArea.rowHeader),t.b3(w.SheetArea.viewport)],a=0;a<o.length;a++){if(!(u=o[a]))return;for(s=u.getAllNodes(),c=0;c<s.length;c++)if(l=(f=s[c]).calc)for(h=l.aT,d=void 0,v=0;v<h.length;v++)(m=l[h[v]])&&m.forEach(function(t){t&&t instanceof k.PathCalc&&dt(n,t)})}}function mt(t,n,e,i,r,o,a,u,s,c){M.CalcOperatorAdjustor.copyFormula(t.b3(),n,e,i.b3(),r,o,a,u,s,c)}function gt(t,n){var t=t.offset(0,0,!1,0,0);return t.rowRelative=t.endRowRelative=t.columnRelative=t.endColumnRelative=n,t}function F(t,n,e,i,r,o,a,u,s,c){var f,l,h,d,v,m,g,p,b,f,l,h,d,f,l,y,d,h,f;if(c){if(9===c.type){if(f=c.value,l=c.value2,h=F(t,n,e,i,r,o,a,u,s,f),d=l&&F(t,n,e,i,r,o,a,u,s,l),f!==h||l!==d)return(0,k.rbt)(c.operatorType,h,d)}else if(7===c.type){for(v=!1,m=[],g=void 0,p=0;p<c.arguments.length;p++)b=F(t,n,e,i,r,o,a,u,s,g=c.arguments[p]),v=v||g!==b,m.push(b);if(v)return(0,k.YJ)(c,m)}else if(1===c.type){if(f=!X(c)&&!J(c),l=!q(c)&&!K(c),h=n.Uw(),(!c.source||c.source===h)&&f&&l)return d=r.Uw(),f=new M.MoveSwapInfo(h,e,i,d,o,a,u,s),l=gt(c,!0),(d=(0,M.adjustFormulaOnMoveSwap)(h,0,0,l,f,!0,y={isCustomName:!0}))===l?c:1===d.type&&gt(d,!1)||d}else if(10===c.type&&(h=c.value)!==(f=F(t,n,e,i,r,o,a,u,s,h)))return(0,k.Ayt)(f);return c}}function pt(t,n){var e,i,r,o,a,u,s,c,e=t.printInfo&&t.printInfo();if(e)for(i=n.split(","),r=0;r<i.length;r++)for(o=(0,m.formulaToRanges)(t,i[r],0,0),a=0;a<o.length;a++)for(u=o[a].ranges,s=0;s<u.length;s++)-1===(c=u[s]).col||-1===c.colCount?(e.repeatRowStart(c.row),e.repeatRowEnd(c.row+c.rowCount-1)):-1!==c.row&&-1!==c.rowCount||(e.repeatColumnStart(c.col),e.repeatColumnEnd(c.col+c.colCount-1))}function bt(t,n,e,i,r){var t=t[n];t&&(i=t.rT,T(r)||(i.Wbt=r),t.toJSON({data:e}),delete i.Wbt)}function yt(t,n,e,i,r,o){t&&(n&&!n.fullRecalc?t.resumeWithoutCalc():t.resume(!1),delete t.lb),e.zE(),delete e.G3,o.resumePaint()}Object.defineProperty(t,"__esModule",{value:!0}),t.QB=t.XB=t.hMt=t.dMt=void 0,w=n("Core"),e=n("Common"),k=n("CalcEngine"),m=n("./dist/plugins/sheetsCalc/calc-spreadjs.js"),M=n("./dist/plugins/sheetsCalc/formulaOperatorAdjustor.js"),g=n("./dist/plugins/sheetsCalc/calc-extra-save.js"),D=null,C=void 0,p=w.GC$.each,f=e.Common.zf.Gmt,y=e.Common.zf,n=new e.Common.ResourceManager(w.SR),S=n.getResource.bind(n),T=e.Common.lt.ht,i="_XLNM.PRINT_AREA",b="PRINT_AREA",r="Print_Area",h=w.mt.xr,A=w.range_parser._c,u=w.IndexHelper.nr,l=w.mt.$i,I=w.mt.n1,x=w.Util.addXLFNPrefix,P=/(\$?)([A-Z]+)(\$?)(\d+)/,G=/(\$?)(\d+):(\$?)(\d+)/,U=/(\$?)([A-Z]+):(\$?)([A-Z]+)/,N=parseInt,_=w.UsedRangeUtil.updateUsedRangeByData,t.dMt=c,(n=w.Worksheet.prototype).resetCalc=function(){tt.call(this),this.eMt=!0},n.recalcAll=function(t){var n,e,i,r,o,a,u,s,c,f,l,n=E(this);if(n){if(this.suspendPaint(),n.suspend(!0),t)for(i=void 0,i=(e=this.parent)&&e.sheets||[this],ft(e&&e.hyt,this.Uw(),n),r=0;r<i.length;r++)for(a=(o=i[r]).Uw(),ft(o.hyt,a,n),s=(u=a.getCalcSourceModel()).getAllNodes(),c=0;c<s.length;c++)(l=(f=s[c]).calc)&&f.WK&&dt(n,l);n.resume(t),this.resumePaint()}},n.recalcRange=function(t,n,e,i){var r=E(this);r&&r.recalcRange(this.Uw(),t,n,e,i)},n.recalcRows=function(t){var n,e,n=E(this);if(n&&!n.ignoreDirty()){for(n.suspend(),e=0;e<t.length;e++)n.recalculate(this.qgt,t[e],-1);n.resume(!1)}},n.recalcCols=function(t){var n,e,n=E(this);if(n&&!n.ignoreDirty()){for(n.suspend(),e=0;e<t.length;e++)n.recalculate(this.qgt,-1,t[e]);n.resume(!1)}},n.gL=function(t,n,e){var i,r,i=E(this);i&&!i.ignoreDirty()&&(r=this.qgt,1===e?r=this.T3:2===e&&(r=this.A3),i.recalculate(r,t,n))},n.getCalcService=function(){return this.Lp||(this.Lp=new k.CalcService,this.Uw(w.SheetArea.colHeader).setCalcService(this.Lp),this.Uw(w.SheetArea.rowHeader).setCalcService(this.Lp),this.Uw().setCalcService(this.Lp),this.Lp.initParserContext(this.Uw())),this.Lp},n.op=function(){return this.getCalcService()},n.suspendCalcService=function(t){var n=E(this);n&&n.suspend(t)},n.resumeCalcService=function(t){var n=E(this);n&&n.resume(t)},n.Uw=function(t){return T(t)||3===t?this.qgt:1===t?this.T3:2===t?this.A3:D},n.b3=function(t){var n=this;return 1===t?(!n.iMt&&n.T3&&(n.iMt=n.op().getSourceModel(n.T3)),n.iMt):2===t?(!n.rMt&&n.A3&&(n.rMt=n.op().getSourceModel(n.A3)),n.rMt):(!n.oMt&&n.qgt&&(n.oMt=n.op().getSourceModel(n.qgt)),n.oMt)},n.vMt=function(t,n,e,i,r){var r=this.b3(r);return r&&r.mMt(t,n,e,i,!0,!0)},n.KT=function(t,n,e,i,r,o){var a=this.vMt(t,n,e,i,3);return!a&&r&&(i=this.getColumnCount(2),a=this.vMt(t,0,e,i,2)),!a&&o&&(e=this.getRowCount(1),a=this.vMt(0,n,e,i,1)),a},n.iT=function(t,n,e,i,r){var r=this.b3(r);return r&&r.mMt(t,n,e,i,!1,!0)},n.mT=function(t,n,e,i,r,o,a){var u,r,u=(r=void 0===r?!0:r)&&this.KT(t,n,e,i,o,a),r=!r&&et(this,t,n,e,i,o,a);return!u&&!r||(this.jT(4,S().Exp_ChangePartOfArray),!1)},n.addCustomFunction=function(t){this.Uwt(t),this.recalcAll()},n.Uwt=function(t){if(!(t&&t instanceof k.Functions.Function))throw new Error(S().Exp_InvalidCustomFunction);t.name=f(t.name),this.Amt[t.name]=t},n.getCustomFunction=function(t){return t?this.Amt[f(t)]:D},n.removeCustomFunction=function(t){t&&(delete this.Amt[f(t)],this.recalcAll())},n.clearCustomFunctions=function(){this.Amt={},this.recalcAll()},n.Jbt=function(t){var n,e,n;return t?(e=(n=this).parent,!(n=n.getCustomFunction(t))&&e&&e.getCustomFunction?e.getCustomFunction(t):n):D},n.addCustomName=function(t,n,e,i,r){this.zwt(t,n,e,i,!1,r)},n.getCustomName=function(t){return t?this.hyt[f(t)]:C},n.getCustomNames=function(){var e=[];return p(this.hyt,function(t,n){e.push(n)}),e},n.removeCustomName=function(t){var t,n;t&&(t=f(t),delete this.hyt[t],(n={})[t]=t,this.Zwt(n,!1))},n.clearCustomNames=function(){var t,n,t=this,n=t.hyt;t.hyt={},this.Zwt(n,!1)},n.createNameInfo=function(t,n,e,i,r){var o,a,o,a,o=this,a=E(o),o=o.Uw();return a&&o?(a=a.parse(o,n,i,r),new m.NameInfo(t,a,i,r,e)):D},n.Vwt=function(t){var n,e,n,n=this,e=!n.hyt[f(t)];return e=e&&(n=n.tables)?!n.findByName(t):e},n.isValidCustomName=function(t){return t&&w.mt.P0(t)&&this.Vwt(t)},n.zwt=function(t,n,e,i,r,o){var a,u,s,c,u,a=this;if(!t||!n||!r&&!a.isValidCustomName(t))throw new Error(S().Exp_InvalidCustomName);if(u=E(a),s=a.Uw(),u&&s){if(c=void 0,r)try{c=u.parse(s,n,e,i,!1,!1,!0)}catch(t){}else c=u.parse(s,n,e,i);a.hyt[f(t)]=new m.NameInfo(t,c,e,i,o),r||((u={})[t]=t,this.Zwt(u,!0))}},n.Wwt=function(t,n,e,i,r,o,a,u){var s,n,c,n,s=this;if(!t||!n||!o&&!s.isValidCustomName(t))throw new Error(S().Exp_InvalidCustomName);n=E(s),c=s.Uw(),n&&c&&(s.hyt[f(t)]=new m.NameInfo(t,e,i,r,a),o||((n={})[t]=t,this.Zwt(n,!0)))},n.Zwt=function(t,n){var e,i,e=this.b3();if(e){for(i in t)e.updateNameCalc(i,n);this.recalcAll()}},n.gMt=function(t){var n,e,n;return t?(e=(n=this).parent,!(n=n.getCustomName(t))&&e&&e.getCustomName?e.getCustomName(t):n):D},n.setFormula=function(t,n,e,i){this.zI(t,n,e,D,!1,i)},n.zI=function(t,n,e,i,r,o,a,u,s){var c,f,l,h,d,v,m,m,g,v,h,f,l,u,m,c=this;T(o)&&(o=3),t<0||t>=c.getRowCount(o)||n<0||n>=c.getColumnCount(o)?c.jT(0,S().Exp_IndexOutOfRange):(f=0<=t?t:0,l=0<=n?n:0,h=c.Uw(o),d=c.options.keepUnknownFormulas,(v=c.Lp).forceR1C1Formula?(m=v.useR1C1,v.useR1C1=!0,i=i||(e&&v?v.parse(h,e,f,l,!1,r,!1,d):D),v.useR1C1=m):i=i||(e&&v?v.parse(h,e,f,l,!1,r,r,d):D),i&&u&&(i.ensureSingle=!0),m=c.tables,3===o&&0<=t&&0<=n&&m&&!(g=m.pMt(t,n,1,1,e,i))||(v=d&&e&&!i,h=c.b3(o),f=c.conditionalFormats,h&&(l=h.getFormula(t,n),u=c.Ut,h.FE=!0,h.setFormula(t,n,e,i,r,C,u.pj(),s,d),delete h.FE,h.usedRange&&_(h.usedRange,t,n,l,e),v&&(m=h.getNode(t,n,!0))&&(m.qbt=e),f&&f.dl(),c.hasFormula(t,n,o)&&u.JE(t,n,o),a?c.Lj(c,[{row:t,col:n}],0):(c.Rj("formula",t,n,o,l,e),c.ki(w.Events.WorksheetDataChanged,{type:"formula"}))),c.Q1i&&c.Q1i(t,n,1,1,o),c.zw()))},n.eL=function(t,n,e,i,r,o,a,u){var s,c,f,l,h,d,v,s=this,c=this.op();if(t<0||t>=s.getRowCount()||n<0||n>=s.getColumnCount())s.jT(0,S().Exp_IndexOutOfRange);else if(l=s.b3(a))for(h=t;h<e+t;h++)for(d=n;d<i+n;d++)h===t&&d===n&&(s.zI(t,n,r,D,!1,a),f=l.pB(t,n),s.Xbt=s.Xbt||{nextIndex:0},v=s.Xbt.nextIndex,s.Xbt[v]={formula:c.unparse(this.qgt,f,t,n,!1,!0),baseRow:t,baseColumn:n,lastRow:t+e-1,lastColumn:n+i-1},s.Xbt.nextIndex++,f.aMt=v),s.zI(h,d," ",f,!0,a,!0,!0)},n.setArrayFormula=function(t,n,e,i,r,o){this.uMt(t,n,e,i,r,!1,o)},n.uMt=function(t,n,e,i,r,o,a,u){var s,c,f,l,c,h,d,v,m;if(void 0===a&&(a=3),s=this,t<0||t+e>s.getRowCount()||n<0||n+i>s.getColumnCount())s.jT(0,S().Exp_IndexOutOfRange);else if(s.Ut.eE(t,n,e,i))s.jT(0,S().Exp_ArrayFormulaSpan);else if(c=s.tables,!(3===a&&0<=t&&0<=n&&c)||(f=c.pMt(t,n,e,i,r))){if(l=s.b3(a),c=s.conditionalFormats,l){for(h=[],d=t;d<t+e;d++)for(h[d]=[],v=n;v<n+i;v++)h[d][v]=l.getFormula(d,v);for(l.setArrayFormula(t,n,e,i,r,o,s.Ut.pj(),u,!1),d=t;d<t+e;d++)for(v=n;v<n+i;v++)l.usedRange&&_(l.usedRange,d,v,h[d][v],r);if(c&&c.dl(),s.vf<1){for(m=[],d=t;d<t+e;d++)for(v=n;v<n+i;v++)m.push({row:d,col:v});s.SI(t,n,e,i,m,5,a,r)}}s.zw()}},n.getFormula=function(t,n,e,i){var e=this.b3(e);return e?e.getFormula(t,n,i):D},n.bMt=function(t,n,e){var e=this.b3(e);return e?e.pB(t,n):D},n.getFormulaInformation=function(t,n,e,i){var r,e,o,a,a,u,s,r={},e=this.b3(e);return e&&((o=e.pB(t,n))?(a=e.sT(t,n),r.hasFormula=!0,a&&(r.baseRange=new w.Range(a.row,a.col,a.rowCount,a.colCount)),r.isArrayFormula=a&&!a.isDynamicArray,t=a?a.row:t,n=a?a.col:n,i||(r.formula=this.Lp.unparse(this.qgt,o,t,n),r.formulaWithCulture=this.Lp.unparse(this.qgt,o,t,n,!0)),r.hasFormula=!!r.formula):(a=this.Ut.getDynamicArrayInfo(t,n))&&a.isValid&&(u=a.row,s=a.col,r.baseRange=new w.Range(a.row,a.col,a.rowCount,a.colCount),t===u&&n===s||(o=e.pB(u,s),i||(r.formulaWithCulture=this.Lp.unparse(this.qgt,o,u,s,!0)),r.hasFormula=!0,r.isDynamicArray=!0))),r},n.VI=function(t,n,e,i,r,o){var a,u,s,c,f,l,h,d,v,m,g,p;for(e||(e=this,i=t,r=n,o=[]),a=e.qwt(i,r),u=this.name(),s=0;s<a.length;s++){if(o[f=(c=a[s]).sheetName+"_"+c.row+"_"+c.col+"_"+c.rowCount+"_"+c.colCount])return!1;if(o[f]=!0,(c.row<=t&&t<c.row+c.rowCount||-1===c.rowCount)&&(c.col<=n&&n<c.col+c.colCount||-1===c.colCount)&&u===c.sheetName)return!0;for(l=c.sheetName===u?e:e.parent.getSheetFromName(c.sheetName),h=c.rowCount,d=c.row,v=c.colCount,m=c.col,-1===h&&(h=l.getRowCount(),d=0),-1===v&&(v=l.getColumnCount(),m=0),g=d;g<h+d;g++)for(p=m;p<v+m;p++)if(this.VI(t,n,l,d,m,o))return!0}return!1},n.getPrecedents=function(t,n){var e,i,i,r,o,t,o,e=[],i=this.b3();return i&&(i=i.Fyt(t,n)||i.pB(t,n),t=(o=(r=this.getFormulaInformation(t,n,3,!0)).baseRange)?o.row:t,o=o?o.col:n,this.yMt(i,t,o,e),e=it(e)),e},n.getDependents=function(c,f){var l,t,h,l=[],t=this.parent&&this.parent.sheets||[this],h=this.name();return t.forEach(function(t){for(var n,e,i,r,o,a,u,s,n=t.getRowCount(),e=t.getColumnCount(),i=t.name(),r=0;r<n;r++)for(o=0;o<e;o++)for(a=t.getPrecedents(r,o),u=0;u<a.length;u++)if((s=a[u]).sheetName===h&&(-1===s.row||s.row<=c&&c+1<=s.row+s.rowCount)&&(-1===s.col||s.col<=f&&f+1<=s.col+s.colCount)){l.push({row:r,col:o,rowCount:1,colCount:1,sheetName:i});break}}),l},n.qwt=function(e,i){var r,t,n,t,t,r={},t=this.b3().oT(e,i),n=this.b3().uT();return t&&(t=t[0])&&t.forEach(lt(r)),n&&(t=n[0])&&t.forEach(function(t){var n;(-1===t.row||t.row<=e&&e+1<=t.row+t.rowCount)&&(-1===t.col||t.col<=i&&i+1<=t.col+t.colCount)&&t.content.forEach(lt(r))}),ht(r)},n.yMt=function(t,n,e,i){var r,o,o,a,u,s;if(t)switch(r=t.type){case k.ExpressionType.reference:case k.ExpressionType.structReference:o=t.getRange(n,e),i.push({row:o.row,col:o.col,rowCount:o.rowCount,colCount:o.colCount,sheetName:(t.source&&t.source.Mf?t.source.Mf:this).name()});break;case k.ExpressionType.operator:this.yMt(t.value,n,e,i),this.yMt(t.value2,n,e,i);break;case k.ExpressionType.expand:case k.ExpressionType.parentheses:this.yMt(t.value,n,e,i);break;case k.ExpressionType.name:o=this.gMt(t.value),this.yMt(o.getExpression(),n,e,i);break;case k.ExpressionType.function:for(a=t.arguments,u=0;u<a.length;u++)s=a[u],this.yMt(s,n,e,i)}},n.hasFormula=function(t,n,e){var e=this.b3(e);return!!e&&e.hasFormula(t,n)},n.wMt=function(){var t=this.b3();t&&t.MMt(function(t){t.CMt(),t.yB()})},n.clearFormula=function(t,n,e,i,r){var o,a,u,o=this;for(t<0&&(t=0,e=o.getRowCount()),n<0&&(n=0,i=o.getColumnCount()),a=0;a<e;a++)if(r(o,a+t))for(u=0;u<i;u++)o.setFormula(a+t,u+n,D)},n.nameFunctionsFromJSON=function(t,n,e,i){var r,o,a,u,s,s,c,f,l;if(t){if(r=this,o=t.customFunctions)for(a in o)o.hasOwnProperty(a)&&(u=o[a],s=(0,w.getTypeFromString)(u.typeName))&&((s=new s).fromJSON(u,n),r.Uwt(s));if((c=t.names)&&0<c.length){for(f=0;f<c.length;f++)l=c[f],r.zwt(d(l.name),l.formula,l.row,l.col,!0,l.comment);r.wMt()}i&&i()}},n.formulaFromJSON=function(t,n,r){var o,a,u;t&&((o=this).Xbt=t.sharedFormulas,a=r&&r.ignoreFormula,u=r&&r.incrementalLoading,[t.colHeaderData,t.rowHeaderData,t.data].forEach(function(t,n){var n,t,e,i;t&&!a&&t.dataTable&&(t=t.dataTable,e=o.getRowCount(n=n+1),i=o.getColumnCount(n),u?j(o,t,e,i,r,0,n):c(o,t,e,i,n))}),u?r.incrementLoadTask.pushTask(ut,[o,t,n,r]):ut(o,t,n,r))},n.formulaFromSJSFormat=function(t,n,e,i){var r,o,a,u,s,c,o,f,l,r=this,o=r.Uw(),a=!e||!1!==e.includeFormulas,u=w.Util.Mo(e),s=w.Util.wo(e,r.parent&&r.parent.v2),c=r.b3(3);o.G3=!0,a&&t.lossless&&t.lossless.tree&&e.$wt&&(c.cMt=!0,o.setReferenceSheetNames(t.lossless.referenceSheetNames)),(o=h(t,w.XFileConstants.bo))?(f=o.rowCount,l=o.colCount,i?(a&&O(r,o,f,l,t.lossless,e,0,i),v(t,r,c,n,e,a,u)):(a&&e.incrementLoadTask.addTask(O,[r,o,f,l,t.lossless,e,0],y.I5(S().STEP.loadSheetFormula,[r.name()]),function(){var t=e.loadStatus.formulaLoad/e.loadStatus.total;return e.fullRecalc?s?.5:t*w.STEP_RATE.loadSheetFormulaWithCalc+w.STEP_RATE.loadSheetDataWithCalc+w.STEP_RATE.parseFile+w.STEP_RATE.loadFileData:s?.6:t*w.STEP_RATE.loadSheetFormula+w.STEP_RATE.loadSheetData+w.STEP_RATE.parseFile+w.STEP_RATE.loadFileData},r.name()),e.incrementLoadTask.addTask(v,[t,r,c,n,e,a,u]))):i?v(t,r,c,n,e,a,u):e.incrementLoadTask.addTask(v,[t,r,c,n,e,a,u])},n.nameFunctionFromSJSFormat=function(t,n,e){var i,r,o,a,u,s,s,c,f,i=this,r=i?i.Uw():D,o=t.lossless&&t.lossless.customFunctions;if(o)for(a in o)o.hasOwnProperty(a)&&(u=o[a],s=(0,w.getTypeFromString)(u.typeName))&&((s=new s).fromJSON(u),i.Uwt(s));c=t.lossless&&t.lossless.definedNames,f=t.lossless&&t.lossless.nExpr,c&&0<c.length&&(c.forEach(function(t){var n=""+t.c_[0];"_xlnm.Print_Titles"===t.name?pt(i,n):f&&f[t.e]?i.Wwt(d(t.name),(0,m.processFunctionPrefix)(w.mt.n1(n)),(0,g.exprFromJSON)(f[t.e],r.getParserContext(!1)),0,0,!0,t.comment,"_xlnm.Print_Area"!==t.name):i.zwt(d(t.name),(0,m.processFunctionPrefix)(w.mt.n1(n)),0,0,!0,t.comment,"_xlnm.Print_Area"!==t.name)}),i.wMt())},n.SMt=function(t){var n=this,e=n.Lp;e&&!t||(n.Lp=t||new k.CalcService,n.Uw(w.SheetArea.colHeader).setCalcService(n.Lp),n.Uw(w.SheetArea.rowHeader).setCalcService(n.Lp),n.Uw(w.SheetArea.viewport).setCalcService(n.Lp),n.Lp.initParserContext(n.Uw()),e?(t.setSourceModel(n.T3,e.getSourceModel(n.T3)),t.setSourceModel(n.A3,e.getSourceModel(n.A3)),t.setSourceModel(n.qgt,e.getSourceModel(n.qgt))):(n.iMt=n.Lp.getSourceModel(n.T3),n.rMt=n.Lp.getSourceModel(n.A3),n.oMt=n.Lp.getSourceModel(n.qgt)),n.oMt.usedRange=new w.BaseUsedRange)},n.setCalc=function(t,n){this.Lp=t,this.qgt=n||this.qgt,this.oMt=t.getSourceModel(this.qgt),this.parent&&(this.parent.Lp=t)},n.YA=function(){this.ol(!1,1)},n.TMt=function(t,n){var e,i,r,o,a,u,s,c,f,l,h,d,v,m,g,p,b,y,e=this,i=t.changeType,r=t.row,o=t.rowCount,a=t.col,u=t.colCount,s=t.sheetArea,c=T(s)||s===w.SheetArea.viewport,f=e.b3(s),l=f.usedRange;f&&(d=(h=e.Ut).pj(),v=E(f),m=f.rT,g=v.Hyt(),p=v.MX.asyncManager,"addingRows"===i?e.mT(r,0,0,e.getColumnCount(),void 0,!0,!1)?(b=c?e.b3(2):C,g.onBeforeAddRemoveRows(f,r,b),n||(0,w.clearSpillValuesOnAddRemove)(h,r,o,!0,!0,s),B(e,r,o,!0,!0),[f,b].forEach(function(t){t&&t.addRows(r,o)}),p.addRows(m,r,o)):t.canAdd=!1:"addRows"===i?(v.suspend(),b=c?e.b3(2):C,g.onAfterAddRemoveRows(f,r,o,!0,n,b),v.resume(!1),d&&d.push({type:"addRows",row:r,rowCount:o,sheetArea:s}),l&&l.addHeadInfo(r,o,!0)):"deletingRows"===i?e.mT(r,0,o,e.getColumnCount(),void 0,!0,!1)?(b=c?e.b3(2):C,g.onBeforeAddRemoveRows(f,r,b),n||(0,w.clearSpillValuesOnAddRemove)(h,r,o,!1,!0,s),B(e,r,o,!1,!0),[f,b].forEach(function(t){t&&t.deleteRows(r,o)}),p.deleteRows(m,r,o)):t.canDelete=!1:"setRowCount"===i?(v.suspend(),b=e.b3(2),r<o?(f.gF(r+1,0,o-r,e.getColumnCount()),b.gF(r+1,0,o-r,e.getColumnCount())):(f.gF(o+1,0,r-o,e.getColumnCount()),b.gF(o+1,0,r-o,e.getColumnCount())),v.AMt(i),v.resume(!1)):"setColumnCount"===i?(v.suspend(),y=e.b3(1),a<u?(f.gF(0,a+1,e.getRowCount(),u-a),y.gF(0,a+1,e.getRowCount(),u-a)):(f.gF(0,u+1,e.getRowCount(),a-u),y.gF(0,u+1,e.getRowCount(),a-u)),v.AMt(i),v.resume(!1)):"deleteRows"===i?(v.suspend(),b=c?e.b3(2):C,g.onAfterAddRemoveRows(f,r,o,!1,n,b),v.resume(!1),d&&d.push({type:"deleteRows",row:r,rowCount:o,sheetArea:s}),l&&l.removeHeadInfo(r,o,!0)):"addingColumns"===i?e.mT(0,a,e.getRowCount(),0,void 0,!1,!0)?(y=c?e.b3(1):C,g.onBeforeAddRemoveColumns(f,a,y),n||(0,w.clearSpillValuesOnAddRemove)(h,a,u,!0,!1,s),B(e,a,u,!0,!1),[f,y].forEach(function(t){t&&t.addColumns(a,u)}),p.addColumns(m,r,o)):t.canAdd=!1:"addColumns"===i?(v.suspend(),y=c?e.b3(1):C,g.onAfterAddRemoveColumns(f,a,u,!0,n,y),v.resume(!1),d&&d.push({type:"addColumns",col:a,colCount:u}),l&&l.addHeadInfo(a,u,!1)):"deletingColumns"===i?e.mT(0,a,e.getRowCount(),u,void 0,!1,!0)?(y=c?e.b3(1):C,g.onBeforeAddRemoveColumns(f,a,y),n||(0,w.clearSpillValuesOnAddRemove)(h,a,u,!1,!1,s),B(e,a,u,!1,!1),[f,y].forEach(function(t){t&&t.deleteColumns(a,u)}),p.deleteColumns(m,r,o)):t.canDelete=!1:"deleteColumns"===i&&(v.suspend(),y=c?e.b3(1):C,g.onAfterAddRemoveColumns(f,a,u,!1,n,y),v.resume(!1),d&&d.push({type:"deleteColumns",col:a,colCount:u,sheetArea:s}),l)&&l.removeHeadInfo(a,u,!1))},n.IMt=function(t,n,e,i){var r,o,a,u,s,r=e.type,o=this;if(i){if("addRows"===r)e.changeType="addingRows",o.TMt(e),e.changeType="addRows",o.TMt(e);else if("deleteRows"===r)e.changeType="deletingRows",o.TMt(e),e.changeType="deleteRows",o.TMt(e);else if("addColumns"===r)e.changeType="addingColumns",o.TMt(e),e.changeType="addColumns",o.TMt(e);else if("deleteColumns"===r)e.changeType="deletingColumns",o.TMt(e),e.changeType="deleteColumns",o.TMt(e);else if("customName"===r)a=t.parse(o,e.newFormula,0,0),e.nameInfo.SB(a);else if("condition"===r){for(u=[],s=0;s<e.newFormulas.length;s++)a=t.parse(o,e.newFormulas[s],0,0),u.push(a);e.condition.setExpressions(u)}}else if("addRows"===r)e.changeType="deletingRows",o.TMt(e,!0),e.changeType="deleteRows",o.TMt(e,!0);else if("deleteRows"===r)e.changeType="addingRows",o.TMt(e,!0),e.changeType="addRows",o.TMt(e,!0);else if("addColumns"===r)e.changeType="deletingColumns",o.TMt(e,!0),e.changeType="deleteColumns",o.TMt(e,!0);else if("deleteColumns"===r)e.changeType="addingColumns",o.TMt(e,!0),e.changeType="addColumns",o.TMt(e,!0);else if("customName"===r)a=t.parse(o,e.formula,0,0),e.nameInfo.SB(a);else if("condition"===r){for(u=[],s=0;s<e.formulas.length;s++)a=t.parse(o,e.formulas[s],0,0),u.push(a);e.condition.setExpressions(u)}},n.xMt=function(t,n,e){var i=e.type,r=this;"addRows"===i?(e.changeType="deletingRows",r.TMt(e,!0),e.changeType="deleteRows",r.TMt(e,!0)):"deleteRows"===i?(e.changeType="addingRows",r.TMt(e,!0),e.changeType="addRows",r.TMt(e,!0)):"addColumns"===i?(e.changeType="deletingColumns",r.TMt(e,!0),e.changeType="deleteColumns",r.TMt(e,!0)):"deleteColumns"===i?(e.changeType="addingColumns",r.TMt(e,!0),e.changeType="addColumns",r.TMt(e,!0)):"customName"===i?e.nameInfo.SB(e.expr):"condition"===i&&e.condition.setExpressions(e.expressions)},n.NMt=function(t,n){var e,i,r,o,a,e=this,i=E(e),r=e.b3();if(i.suspend(),n)for(o=0;o<t.length;o++)(a=t[o]).type?e.IMt(i,r,a,n):a.newValue&&e.setFormula(a[0],a[1],a.formula);else for(o=t.length-1;0<=o;o--)(a=t[o]).type?e.IMt(i,r,a,n):a.newValue||e.setFormula(a[0],a[1],a.formula);i.resume(!1)},n.xj=function(t){var n,n,e,i,r,o,a,u,s,c,f,l,h,d,n=t[t.length-1],n=n&&n.sheetArea,e=T(n)||n===w.SheetArea.viewport,i=E(this),r=this.b3(n);for(i.suspend();t.length;){if(a=(o=t.pop())[0],u=o[1],s=r.pB(a,u),f=[],c=e&&this.Ut.getDynamicArrayInfo(a,u))for(l=c.row;l<c.row+c.rowCount;l++)for(f[l]=[],h=c.col;h<c.col+c.colCount;h++)f[l][h]=this.getValue(l,h);if(o.type?this.xMt(i,r,o):r.kMt.apply(r,o),(d=e&&r&&r.usedRange)&&(_(d,o[0],o[1],s,o[2]),c))for(l=c.row;l<c.row+c.rowCount;l++)for(h=c.col;h<c.col+c.colCount;h++)l===o[0]&&h===o[1]||_(d,l,h,f[l][h],o[2])}i.resume(!1)},n.getReferenceRange=function(t){var n,e,i,r,o,a,t,u,n=this.Uw(),e=this.getCalcService(),i=e.parse(n,t,0,0),a=i.baseTable;return i&&a&&t===a.name()?(r=a.range(),o=a.Mf&&a.Mf.name()):(t=e.MX.evaluateExpression(i,n.getEvaluatorContext({row:0,col:0},!1),!1,!0,!0))instanceof k.CalcReference&&(o=t.getSource().getName(),0<t.getRangeCount())&&(r=(0,w.Ec)(t.getRow(u=0),t.getColumn(0),t.getRowCount(0),t.getColumnCount(0))),{sheetName:o,range:r}},n.dL=function(t,n,e){var i,r,r,i=this,r="string"==typeof e&&i.parent&&i.parent.xO(e);return r&&-1!==t&&-1!==n?(r=r.getExpression(),(W(i,e)?Q:(0,m.evaluateExpression))(i,r,t,n)):C},n.TL=function(t,n,e){var i,r,o,a,o,u,s,c,f,i=this,r=!!i.NMi,o=i.getCell(t=-1===t?0:t,n=-1===n?0:n,3),a=(0,m.rangeToFormula)(o,t,n,3);if(0<=(o="="===(o=e.trim()).charAt(0)&&0<=o.indexOf("@")&&!Y(o)?o.replace(/@/g,a):o).indexOf("{{")&&0<=o.indexOf("}}")){for(""===(u=o.split(/{{|}}/))[0]&&u.shift(),""===u[u.length-1]&&u.pop(),s=0;s<u.length;s++)-1===u[s].indexOf("=")?u[s]='"'+u[s]+'"':(!r||!Y(u[s]))&&(0<=u[s].indexOf("@")&&(u[s]=u[s].replace(/@/g,a)),(c=(0,m.evaluateFormula)(i,u[s]))instanceof k.CalcError)?u[s]='"'+c.toString()+'"':u[s]=u[s].replace(/=/g,"");o="=CONCAT("+u.join(",")+")"}(f=i.parent).xO(e)||f.pp(f.bp,e,o,t,n,!0,"",i.NMi)},n.NO=function(t,n,e,i){var r=this;return(W(r,t)?Q:(0,m.evaluateExpression))(r,n,e,i)},t.hMt=B,t.XB=mt,t.QB=F,w.Worksheet.ch("calc",{priority:1e3,init:tt,dispose:function(t){var n,e,e,e,n=this;!1!==t.clearCache&&(n.qgt=D,n.A3=D,n.T3=D,n.Lp=D,(e=n.oMt)&&(!0===t.isSheetDestroy?e.DMt():e._Mt(),n.oMt=D),(e=n.rMt)&&(!0===t.isSheetDestroy?e.DMt():e._Mt(),n.rMt=D),e=n.iMt)&&(!0===t.isSheetDestroy?e.DMt():e._Mt(),n.iMt=D)},attach:function(t){var n=this;t instanceof w.Workbook?n.SMt(t.Lp):n.SMt()},onLayoutChanged:function(t){this.op().isAdjustSuspended()||this.TMt(t)},toJson:function(t,n){var u,e,i,s,e,c,r,o,a,f,u=this,e=u.Amt;w.GC$.isEmptyObject(e)||(t.customFunctions=e),i=n&&n.newWorkSheetName,s=[],e=u.getCustomNames(),c=E(u),r=u.b3(),o=r.rT,e&&c&&(!T(i)&&r&&o&&(o.Wbt=i),p(e,function(t,n){var e,i,r,o,n,a,e,e=n.getName(),i=n.getRow(),r=n.getColumn(),o=n.getExpression(),n=n.getComment();o&&(e={name:e,formula:a=c.unparse(u.Uw(),o,i,r,!1,!0,!0),row:i,col:r},n&&(e.comment=n),s.push(e))}),0<s.length&&(t.names=s),delete o.Wbt),(a=n&&n.ignoreFormula)||(f=[u.oMt,u.iMt,u.rMt],[t.data,t.colHeaderData,t.rowHeaderData].forEach(function(t,n){bt(f,n,t,o,i)}),u.Xbt&&0<u.Xbt.nextIndex&&(t.sharedFormulas=u.Xbt))},fromJson:function(t,n,e,i){var r,o,r=this,o;e&&e.incrementalLoading||(r.clearCustomFunctions(),r.clearCustomNames()),i&&(r.nameFunctionsFromJSON(t,n,e),r.formulaFromJSON(t,n,e))},wh:function(t,n,u){var s,e,i,c,f,e,l,r,o,h,a,d,a,r,v,s=this,e=s.Amt;w.GC$.isEmptyObject(e)||(t.lossless.customFunctions=e),i=u&&u.newWorkSheetName,c=[],f=[],e=s.getCustomNames(),l=E(s),r=s.b3(),o=r.rT,h={},s.parent&&(a=s.parent.yC,h=a&&a.getUsedCustomNames()||{}),e&&l&&!s.NMi&&(!T(i)&&r&&o&&(o.Wbt=i),d=!u||!1!==u.includeUnusedNames,p(e,function(t,n){var e,i,r,o,n,a,e,n,e=n.getName(),i=n.getRow(),r=n.getColumn(),o=n.getExpression(),n=n.getComment();e.toUpperCase()!==b&&o&&(d||h[e])&&(e={name:e,comment:n,formula:a=x((0,m.encodeNameFormula)(l.unparse(s.Uw(),o,i,r,!1,!0,!0)))},u&&u.includeCalcModelCache&&(n=(0,g.exprToJSON)(o),c.push(n),e.e=c.length-1),f.push(e))}),0<f.length&&(t.lossless.definedNames=f),0<c.length&&(t.lossless.nExpr=c),delete o.Wbt),(a=u&&!1===u.includeFormulas)||((r=s.oMt)&&(o=r.rT,T(i)||(o.Wbt=i),r.wh(t,u),delete o.Wbt),v=[s.iMt,s.rMt],t.lossless&&[t.lossless.colHeaderData,t.lossless.rowHeaderData].forEach(function(t,n){bt(v,n,t,o,i)})),!a&&w.Util.ko(u)&&(u&&u.includeCalcModelCache&&(t.lossless.tree=(0,g.mbt)(s.b3())),o=s.Uw(),t.lossless.referenceSheetNames=o&&o.getReferenceSheetNames(),nt(s,t.lossless))},yh:function(t,n,e,i){var r,o,a,u,s,c,f,r=this,o=r.parent,u=w.Util.wo(e,r.parent&&r.parent.v2),s=e&&!e.fullRecalc,c=r.Uw();r.suspendPaint(),o&&o.Lp&&((a=o.Lp).suspend(),a.lb=s),(f=w.Util.Mo(e))||(r.clearCustomFunctions(),r.clearCustomNames()),u&&(c.G3=!0,r.nameFunctionFromSJSFormat(t,n,e),r.formulaFromSJSFormat(t,n,e,i),i?ct(o,r,t,c,n,e):e.incrementLoadTask.addTask(ct,[o,r,t,c,n,e])),i?yt(a,e,c,u,s,r):e.incrementLoadTask.addTask(function(t,n,e,i,r,o){yt(t,n,e,i,r,o)},[a,e,c,u,s,r])},setName:function(t){var n,e,i;vt(this),(i=(e=E(n=this.b3())).MX.asyncManager).changeSourceName(t.oldName,t.newName)},beforeSetName:function(){this.b8&&(this.parent||this).xyt()}}),w.Y8.ch("calc",{isInvalidFormula:function(n){var t,e,t=D,e=C;try{n.allowDynamicArray&&(T(m.SheetParserContext.wbt)&&(m.SheetParserContext.wbt=new w.Worksheet),(t=m.SheetParserContext.wbt).getCalcService())&&(e=t.getCalcService().allowDynamicArray,t.getCalcService().allowDynamicArray=!0),(0,m.formulaToExpression)(t,n.value)}catch(t){n.isInvalid=!0}finally{T(t)||T(e)||!t.getCalcService()||t.getCalcService().allowDynamicArray===e||(t.getCalcService().allowDynamicArray=e)}}})},"./dist/plugins/sparkline/functions-sparkline.js":function(B,t,l){"use strict";var n,T,w,h,b,L,d,F,y,M,r,o,A,P,e,G,e,U,v,I,H,z,s,m,a,i,f,x,C,V,Y,Z,W,Q,J,K,X,q,$,tt,nt,et,it,rt,ot,at,ut,st,ct,ft,lt,ht,g,dt,u,vt,mt,gt,pt,bt,yt,wt,Mt,Ct,St,Tt,At,It,p,xt,Nt,kt,Dt,_t,Et,n,c,jt,u,Ot,Rt,Bt,Lt,Ft,Pt,Gt,Ut,Ht,zt,Vt,Yt,Zt,Wt,Qt,Jt,Kt,Xt,qt,$t,tn;function S(t){return 0===t}function N(t){return 0===t||2===t}function nn(t){return N(t)||8===t}function en(t){return 0===t||1===t}function rn(t){return 0<=t&&t<=2}function on(t){return 2===t||3===t}function an(t){return 1===t||2===t}function k(t,n){var e,i,r,o,a,u,s,c,f,l,h,e=[];if(y(t))for(i=0,r=t.getRangeCount();i<r;i++)for(o=t.getRowCount(i),a=t.getColumnCount(i),u=0;u<o;u++)for(s=0;s<a;s++)e.push(t.getValue(i,u,s));else if(n&&M(t))for(c=t.getRowCount(),f=t.getColumnCount(),l=0;l<c;l++)for(h=0;h<f;h++)e.push(t.getValue(l,h));return e}function D(t,n,e){var i,r,o,a,u,s,c,f,l,h,i=[];if(y(t)){if(n<(r=t.getRangeCount()))for(o=t.getRowCount(n),a=t.getColumnCount(n),u=0;u<o;u++)for(i[u]=[],s=0;s<a;s++)i[u].push(t.getValue(n,u,s))}else if(e&&M(t))for(c=t.getRowCount(),f=t.getColumnCount(),l=0;l<c;l++)for(i[l]=[],h=0;h<f;h++)i[l][h]=t.getValue(l,h);return i}function _(t){var n;return y(t)?n=t.getValue(0,0,0):A(t)||(n=t),n}function un(t,n){this.name=t,this.value=n,this.typeName="SparklineExValue"}function E(){var t,n,e,t=this.createFunction();t&&(n=t.name,e=t.evaluate,t.evaluate=function(){var t=e.call(this,arguments);return t instanceof T.CalcError?t:t?new dt(n,t):i},this.Zc=n)&&!T.Functions.findGlobalFunction(n)&&(T.Functions.Tmt[n]=t),this.typeName=""}function sn(){return Ot.call(this)||this}function cn(){return Rt.call(this)||this}function fn(){return Bt.call(this)||this}function ln(){return Lt.call(this)||this}function hn(){return Ft.call(this)||this}function dn(){return Pt.call(this)||this}function vn(){return Gt.call(this)||this}function mn(){return Ut.call(this)||this}function gn(){return Ht.call(this)||this}function pn(){return zt.call(this)||this}function bn(){return Vt.call(this)||this}function yn(){return Yt.call(this)||this}function wn(){return Zt.call(this)||this}function j(){return Wt.call(this)||this}function Mn(){return Qt.call(this)||this}function Cn(){return Jt.call(this)||this}function Sn(t,v){function m(t){var n,e,i,r,o,a,u,s,c,f,n={},e=!1,i=!0,r="",o="";if(t){for(a=0,u=(t=t.substr(1,t.length-2)).length;a<u;a++)":"===(s=t.charAt(a))?i=!1:","!==s||e?"'"!==s&&'"'!==s&&("("===s?e=!0:")"===s&&(e=!1),i?r+=s:o+=s):(n[r]=o,i=!(o=r=""));for(c in r&&(n[r]=o),n)!n.hasOwnProperty(c)||A(f=n[c])||("TRUE"===f.toUpperCase()?n[c]=!0:"FALSE"===f.toUpperCase()?n[c]=!1:!x(f)&&isFinite(f)&&(n[c]=C(f)))}return n}function g(t){return new w.Range(t.getRow(0),t.getColumn(0),t.getRowCount(0),t.getColumnCount(0))}function p(t){return new w.Range(0,0,t.getRowCount(),t.getColumnCount())}var t=new r(t,2,5);return t.evaluate=function(t){var n,e,i,r,e,o,a,u,s,c,f,l,h,d,f,t,n=t[0],e=M(n);if((y(n)||e)&&0<(i=e?1:n.getRangeCount())){for(d in r=(e?p:g)(n),e=e?"":n.getSource().getSheet().name(),o=t[1],a=t[2],c=s=u=void 0,f=M(a),(y(a)||f)&&(c=f?"":a.getSource().getSheet().name(),0<(i=f?1:a.getRangeCount()))&&(u=(f?p:g)(a),s=t[3]),l=m(t[4]||"{}"),h={ac:"axisColor",fmc:"firstMarkerColor",hmc:"highMarkerColor",lastmc:"lastMarkerColor",lowmc:"lowMarkerColor",mc:"markersColor",nc:"negativeColor",sc:"seriesColor",deca:"displayEmptyCellsAs",rtl:"rightToLeft",dh:"displayHidden",dxa:"displayXAxis",sf:"showFirst",sh:"showHigh",slast:"showLast",slow:"showLow",sn:"showNegative",sm:"showMarkers",mmax:"manualMax",mmin:"manualMin",maxat:"maxAxisType",minat:"minAxisType",lw:"lineWeight"})h.hasOwnProperty(d)&&l.hasOwnProperty(d)&&(l[h[d]]=l[d]);return 1===(t=(f=new b.SparklineSetting(l)).options).maxAxisType&&(t.maxAxisType=0),1===t.minAxisType&&(t.minAxisType=0),{data:r,dataSheetName:e,dataOrientation:o,dateAxisData:u,dateAxisDataSheetName:c,dateAxisOrientation:s,sparklineType:v,displayDateAxis:u&&!A(s),setting:f,values:D(n,0,!0),dateValues:D(a,0,!0)}}},t.acceptsReference=N,t.acceptsArray=N,t}function Tn(t,n,e,i,r,o,a){var u,s,c,f,l,h,a,u=b.Sparkline.EMt,s=a.sheet,c=s.parent.getSheetFromName(n.dataSheetName),f=s.parent.getSheetFromName(n.dateAxisDataSheetName),l=n.setting,h=(l=l&&l.options?l:new b.SparklineSetting(l)).options.displayHidden,a={sparklineType:n.sparklineType,displayDateAxis:n.displayDateAxis,zoomFactor:a.zoomFactor,values:u(n.values,c||s,h,n.data,n.dataOrientation),dateValues:u(n.dateValues,f||s,h,n.dateAxisData,n.dateAxisOrientation,!0),settings:l,getColor:function(t){if(s&&t){var n=w.Pf.vl(s,t);if(n)return n}return t}};(new U).paint(t,a,e,i,r,o)}function An(){return Kt.call(this)||this}function In(){return Xt.call(this)||this}function xn(){return qt.call(this)||this}function Nn(){return $t.call(this)||this}function kn(){return tn.call(this)||this}function Dn(t,n,e,i,r,o,a,u){if(!(A(t)||A(n)||A(e)||A(i))&&!(x(t)||x(n)||x(e)||x(i))&&!(i<=e||n<e||i<n||t<e||i<t)&&(A(a)||0===a||1===a||2===a)){if(0===a||A(a)){if(!A(r)&&!A(o)&&(x(o)||x(r)||o<=r||r<-180||180<o))return;if(!A(u)&&(x(u)||1<u||u<0))return}return 1}}function O(t,n,e){return{value:t,font:n,label:e,normalFontHeight:H(n),normalFontWidth:z(e,n),fontAfterZoom:null}}function R(t){t&&(c[t.name()]=t)}n=this&&this.__extends||(jt=function(t,n){return(jt=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(t,n){t.__proto__=n}:function(t,n){for(var e in n)Object.prototype.hasOwnProperty.call(n,e)&&(t[e]=n[e])}))(t,n)},function(t,n){if("function"!=typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function e(){this.constructor=t}jt(t,n),t.prototype=null===n?Object.create(n):(e.prototype=n.prototype,new e)}),Object.defineProperty(t,"__esModule",{value:!0}),t.jMt=t.GaugeKPISparkline=t.RangeBlockSparkline=t.WinlossSparkline=t.ColumnSparkline=t.LineSparkline=t.ImageSparkline=t.HistogramSparkline=t.YearSparkline=t.MonthSparkline=t.ParetoSparkline=t.CascadeSparkline=t.BoxPlotSparkline=t.VariSparkline=t.VBarSparkline=t.HBarSparkline=t.StackedSparkline=t.SpreadSparkline=t.BulletSparkline=t.ScatterSparkline=t.AreaSparkline=t.PieSparkline=t.SparklineEx=t.SparklineExValue=void 0,T=l("CalcEngine"),w=l("Core"),h=l("Common"),b=l("./dist/plugins/sparkline/sparkline-wrapper.js"),y=T.Convert.LE,M=T.Convert.Nh,r=T.Functions&&T.Functions.Function,o=T.Functions&&T.Functions.Mmt,A=h.Common.lt.ht,P=h.Common.lt.OMt,G=(e=w.GC$).inherit,e=e.extend,U=h.Sparklines.SparklineRender,v=h.Sparklines.SparklineExRenders,I=T.Errors.Value,H=w.util.vt,z=w.q.Wt,s=w.W.V,m=Math.floor,a=Math.min,i=null,f=void 0,x=isNaN,C=parseFloat,V=NaN,Y="12px Calibri",Z="PIESPARKLINE",W="AREASPARKLINE",Q="SCATTERSPARKLINE",J="BULLETSPARKLINE",K="SPREADSPARKLINE",X="STACKEDSPARKLINE",q="HBARSPARKLINE",$="VBARSPARKLINE",tt="VARISPARKLINE",nt="BOXPLOTSPARKLINE",et="CASCADESPARKLINE",it="PARETOSPARKLINE",rt="MONTHSPARKLINE",ot="YEARSPARKLINE",at="LINESPARKLINE",ut="COLUMNSPARKLINE",st="WINLOSSSPARKLINE",ct="RANGEBLOCKSPARKLINE",ft="GAUGEKPISPARKLINE",lt="HISTOGRAMSPARKLINE",ht="IMAGE",(u=g=g||{})[u.fit=1]="fit",u[u.entireFit=2]="entireFit",u[u.originFit=3]="originFit",u[u.custom=4]="custom",un.prototype.toString=function(){return""},dt=un,t.SparklineExValue=dt,E.prototype.name=function(){return this.Zc},E.prototype.createFunction=function(){return i},E.prototype.paint=function(t,n,e,i,r,o,a){},E.prototype.toJSON=function(){var t,n,t={};for(n in this)this.hasOwnProperty(n)&&(t[n]=this[n]);return t},E.prototype.fromJSON=function(t){if(t)for(var n in t)A(t[n])||(this[n]=t[n])},t.SparklineEx=u=E,n(sn,Ot=u),e((t.PieSparkline=vt=sn).prototype,{createFunction:function(){var t=new r(Z,1,255);return t.evaluate=function(t){var n,e,n=t[0],e=k(n,!0);return e.length<=0&&!A(n)&&e.push(n),{values:e,colors:Array.prototype.slice.call(t,1)}},t.acceptsReference=S,t.acceptsArray=S,t},paint:v[Z]}),n(cn,Rt=u),e((t.AreaSparkline=mt=cn).prototype,{createFunction:function(){var t=new r(W,1,7);return t.evaluate=function(t){return{points:k(t[0],!0),mini:t[1],maxi:t[2],line1:t[3],line2:t[4],colorPositive:t[5],colorNegative:t[6]}},t.acceptsReference=S,t.acceptsArray=S,t},paint:v[W]}),n(fn,Bt=u),e((t.ScatterSparkline=gt=fn).prototype,{createFunction:function(){var t=new r(Q,1,18);return t.evaluate=function(t){var n,e;return{points1:D(t[0],0,!0),points2:D(t[1],0,!0),minX:t[2],maxX:t[3],minY:t[4],maxY:t[5],hLine:t[6],vLine:t[7],xMinZone:t[8],xMaxZone:t[9],yMinZone:t[10],yMaxZone:t[11],tags:t[12],drawSymbol:t[13],drawLines:t[14],color1:t[15],color2:t[16],dash:t[17]}},t.acceptsReference=en,t.acceptsArray=en,t},paint:v[Q]}),n(ln,Lt=u),e((t.BulletSparkline=pt=ln).prototype,{createFunction:function(){var t=new r(J,3,17);return t.evaluate=function(t){return{measure:_(t[0]),target:_(t[1]),maxi:_(t[2]),good:_(t[3]),bad:_(t[4]),forecast:_(t[5]),tickUnit:_(t[6]),colorScheme:t[7],vertical:t[8],measureColor:t[9],targetColor:t[10],maxiColor:t[11],goodColor:t[12],badColor:t[13],forecastColor:t[14],allowMeasureOverMaxi:t[15],barSize:t[16]}},t.acceptsReference=function(t){return 0<=t&&t<=6},t},paint:v[J]}),n(hn,Ft=u),e((t.SpreadSparkline=bt=hn).prototype,{createFunction:function(){function l(t){for(var n,e,i,r,o,n=[],i=0,r=0,o=t.length;i<o;i++)e=C(t[i]),!x(e)&&isFinite(e)&&(n[r]=e,r++);return n}function h(t){for(var n,e,i,r,o,a,n={},e=0,i=void 0,r=t.length;e<r;e++)n[i=t[e]]?n[i]++:n[i]=1;for(a in o=[],n)n.hasOwnProperty(a)&&o.push({key:C(a),value:n[a]});return o.sort(function(t,n){return t.key-n.key})}var t=new r(K,1,7);return t.evaluate=function(t){var n,e,i,r,o,a,u,s,c,f,n=k(t[0],!0),i=[];if(!A(n)&&(i=h(n=l(n)),3===(e=t[4])))for(r=0,o=i.length;r<o;r++){for(u=(a=i[r]).value,s=[],c=Math.max(100,10*u),f=0;f<c+u-1;f++)s.push(Math.random());a.randomNumbers=s}return{spreadData:i,showAverage:t[1],scaleStart:t[2],scaleEnd:t[3],style:e,colorScheme:t[5],vertical:t[6]}},t.acceptsReference=S,t.acceptsArray=S,t},paint:v[K]}),n(dn,Pt=u),e((t.StackedSparkline=yt=dn).prototype,{createFunction:function(){var t=new r(X,1,13);return t.evaluate=function(t){return{points:k(t[0],!0),colorRange:k(t[1],!0),labelRange:k(t[2],!0),maximum:t[3],targetRed:t[4],targetGreen:t[5],targetBlue:t[6],targetYellow:t[7],color:t[8],highlightPosition:t[9],vertical:t[10],textOrientation:t[11],textSize:t[12]}},t.acceptsReference=rn,t.acceptsArray=rn,t},paint:v[X]}),n(vn,Gt=u),e((t.HBarSparkline=wt=vn).prototype,{createFunction:function(){var t=new r(q,1,4);return t.evaluate=function(t){return{value:_(t[0]),colorScheme:t[1],axisVisible:t[2],barHeight:t[3]}},t.acceptsReference=S,t},paint:v[q]}),n(mn,Ut=u),e((t.VBarSparkline=Mt=mn).prototype,{createFunction:function(){var t=new r($,1,4);return t.evaluate=function(t){return{value:_(t[0]),colorScheme:t[1],axisVisible:t[2],barWidth:t[3]}},t.acceptsReference=S,t},paint:v[$]}),n(gn,Ht=u),e((t.VariSparkline=Ct=gn).prototype,{createFunction:function(){var t=new r(tt,1,10);return t.evaluate=function(t){return{variance:_(t[0]),reference:_(t[1]),mini:_(t[2]),maxi:_(t[3]),mark:_(t[4]),tickUnit:_(t[5]),legend:t[6],colorPositive:t[7],colorNegative:t[8],vertical:t[9]}},t.acceptsReference=function(t){return 0<=t&&t<=5},t},paint:v[tt]}),n(pn,zt=u),e((t.BoxPlotSparkline=St=pn).prototype,{createFunction:function(){function e(t,n){return y(t)&&!x(n)&&0<=n&&n<=100?o.PERCENTILE.evaluate(t,n/100):NaN}function i(t){return y(t)?o.STDEVP.evaluate(t):NaN}var t=new r(nt,1,10);return t.evaluate=function(t){var n=t[0];return{points:k(n,!0),boxPlotClass:t[1],showAverage:t[2],scaleStart:_(t[3]),scaleEnd:_(t[4]),acceptableStart:_(t[5]),acceptableEnd:_(t[6]),colorScheme:t[7],style:t[8],vertical:t[9],perc02:e(n,2),perc09:e(n,9),perc10:e(n,10),perc90:e(n,90),perc91:e(n,91),perc98:e(n,98),q1:e(n,25),q3:e(n,75),median:e(n,50),stDev:i(n)}},t.acceptsReference=S,t.acceptsArray=S,t},paint:v[nt]}),n(bn,Vt=u),e((t.CascadeSparkline=Tt=bn).prototype,{createFunction:function(){var t=new r(et,1,10);return t.evaluate=function(t){return{points:k(t[0],!0),pointIndex:_(t[1]),labels:k(t[2],!0),minimum:_(t[3]),maximum:_(t[4]),colorPositive:t[5],colorNegative:t[6],vertical:t[7],itemTypeRange:k(t[8],!0),colorTotal:t[9]}},t.acceptsReference=nn,t.acceptsArray=nn,t},paint:v[et]}),n(yn,Yt=u),e((t.ParetoSparkline=At=yn).prototype,{createFunction:function(){var t=new r(it,2,12);return t.evaluate=function(t){return{points:k(t[0],!0),pointIndex:_(t[1]),colorRange:k(t[2],!0),target:_(t[3]),target2:_(t[4]),highlightPosition:_(t[5]),label:t[6],vertical:t[7],targetColor:t[8],target2Color:t[9],labelColor:t[10],barSize:t[11]}},t.acceptsReference=N,t.acceptsArray=N,t},paint:v[it]}),n(wn,Zt=u),e((t.MonthSparkline=It=wn).prototype,{createFunction:function(){var t=new r(rt,3,7);return t.evaluate=function(t){var n,e,i,r,i,o,a,u,s,c,f,l,l,n=t[0],e=t[1],i=t[2],r=i;for((y(i)||M(i))&&(r=D(i,0,!0)),i=t[3],o=[],(y(i)||M(i))&&(o=D(i,0,!0)),a=[],u=[],s=0,c=r.length;s<c;s++)(f=r[s])&&(l="string"==typeof(l=f[0])?new Date(l):l)&&l.getFullYear()===n&&l.getMonth()+1===e&&(a[l=l.getDate()-1]=f[1],0<o.length)&&(u[l]=o[s][0]);return 0<o.length?{year:n,month:e,values:a,colors:u}:{year:n,month:e,values:a,emptyColor:i,startColor:t[4],middleColor:t[5],endColor:t[6]}},t.acceptsReference=on,t.acceptsArray=on,t},paint:v[rt]}),n(j,Wt=u),j.daysOfMonth=function(t,n){switch(n){case 2:var e;return t%4==0&&t%100!=0||t%400==0?29:28;case 4:case 6:case 9:case 11:return 30;default:return 31}},j.dayInYear=function(t){for(var n,e,i,r,n=t.getFullYear(),e=t.getMonth(),i=t.getDate(),r=1;r<e+1;r++)i+=j.daysOfMonth(n,r);return i},p=j,e((t.YearSparkline=p).prototype,{createFunction:function(){var t=new r(ot,2,6);return t.evaluate=function(t){var n,e,i,e,r,o,a,u,s,c,f,f,n=t[0],e=t[1],i=e;for((y(e)||M(e))&&(i=D(e,0,!0)),e=t[2],r=[],(y(e)||M(e))&&(r=D(e,0,!0)),o=[],a=[],u=0,s=i.length;u<s;u++)(c=i[u])&&(f="string"==typeof(f=c[0])?new Date(f):f)&&f.getFullYear()===n&&(o[f=p.dayInYear(f)-1]=c[1],0<r.length)&&(a[f]=r[u][0]);return 0<r.length?{year:n,values:o,colors:a}:{year:n,values:o,emptyColor:e,startColor:t[3],middleColor:t[4],endColor:t[5]}},t.acceptsReference=an,t.acceptsArray=an,t},paint:v[ot]}),n(Mn,Qt=u),e((t.HistogramSparkline=xt=Mn).prototype,{createFunction:function(){var f,t,f=this,t=new r(lt,1,9);return t.acceptsArray=function(){return!0},t.evaluate=function(t){var n,e,n,i,r,o,a,u,s,t,c,n=t[0],e=[];if(!(n instanceof T.CalcArray||n instanceof T.CalcReference))throw T.CalcError;if(e=f.RMt(n),n=t[1],A(n)&&(n=!0),i=!0===t[2],r=t[3],(r=A(r)?1:r)<=0)throw T.CalcError;if(o=t[4],1<(o=A(o)?1:o)||o<=0)throw T.CalcError;return a=t[5]||"#5B9BD5",u=t[6],s=t[7]||"#000000",t=t[8]||"#C0C0C0",{values:c=n?f.BMt(e,r):f.LMt(e),continuous:n,paintLabel:i,barWidth:o,barColor:a,labelFontStyle:u,labelColor:s,edgeColor:t}},t.acceptsReference=function(t){return 0===t},t},RMt:function(t){var n,e,i,n=[];if(t instanceof T.CalcArray)for(e=t.toArray(1),i=0;i<e.length;i++)n.push(e[i]);else(e=D(t,0)).forEach(function(t){t.forEach(function(t){A(t)||"number"!=typeof t||isNaN(t)||n.push(t)})});return n},BMt:function(t,n){var e,i,r,o,a,u,s,t,c,f,e=[],i=0,r=this;for(t.forEach(function(t){e[i]=t,i++}),o=[],a=s=e[0],e.forEach(function(t){a=Math.min(t,a),s=Math.max(t,s)}),u=m(a/n)*n,t=Math.ceil(s/n)*n,c=1!==e.length?Math.round((t-u)/n):1,i=0;i<c;i++)o[i]=h.Common.st.E8(i*n+u,15);for(o[i-1]<=s&&(o[i]=o[i-1]+n),f=[],i=0,c=o.length-1;i<c;i++)f[i]={value:0};for(0<f.length&&(f[0].axis="["+o[0]+","+o[1]+"]"),i=1;i<o.length-1;i++)A(o[i+1])?f[i].axis="("+o[i]+","+(o[i]+n)+"]":f[i].axis="("+o[i]+","+o[i+1]+"]";return e.forEach(function(t){var t=r.FMt(o,t);f[t].value++}),0<f.length&&0===f[0].value&&f.splice(0,1),f},LMt:function(t){for(var n,e,i,r,o,n,n=this,e={},i=0,r=t.length;i<r;++i)o=t[i],void 0===e[o]?e[o]=1:e[o]++;return(n=n.PMt(e)).sort(function(t,n){return t-n}),n.map(function(t){return{axis:t,value:e[t]}})},PMt:function(t){var n,e,n=[];for(e in t)t.hasOwnProperty(e)&&void 0!==t[e]&&null!==t[e]&&n.push(e);return n},FMt:function(t,n){var e,i,r,o,a,e=t.length;if(t[0]===n)return 0;if(0===e)return 0;i=0,o=m((r=e-1)/2);do{if(n>t[a=o]&&n<=t[o+1])return o}while(n<=t[o]?o=m(((r=o)+i)/2):n>t[o+1]&&(o=m(((i=o)+r)/2)),a!==o)},paint:function(t,n,e,i,r,o,a){var u,s,u,s,u=n.labelFontStyle,s=a.zoomFactor;A(u)&&(u=t.font),u=w.W.V(u,s),s=w.W.Ne(u.font),n.afterZoomFontStyle={fontStyle:s.fontStyle,fontFamily:s.fontFamily,fontSize:s.fontSize,fontWeight:s.fontWeight,fontPixelSize:u.fontSize},v[lt](t,n,e,i,r,o,a)}}),n(Cn,Jt=u),e((t.ImageSparkline=Nt=Cn).prototype,{createFunction:function(){var t=new r(ht,1,10);return t.evaluate=function(t){var n,e,i,r,o,a,u,s,c,t,n=t[0],e=t[1]||g.fit,i=t[2],r=t[3],o=t[4]||0,a=t[5]||0,u=t[6],s=t[7],c=t[8],t=t[9];if(-1===[0,1,2].indexOf(c)&&(c=w.VerticalAlign.center),-1===[0,1,2].indexOf(t)&&(t=w.HorizontalAlign.center),e!==g.custom||i!==f&&r!==f)return i=i<0?0:i,r=r<0?0:r,a=a<0?0:a,o=o<0?0:o,u=u<0?0:u,s=s<0?0:s,{url:n,drawType:e=-1===[1,2,3,4].indexOf(e)?1:e,height:i,width:r,clipY:o,clipX:a,clipWidth:s,clipHeight:u,vAlign:c,hAlign:t};throw T.CalcError},t},GMt:function(t,n,e,i,r){var o,a,u,s,t,c,f,l,t,n,h,d,e,v,m,o=t.width,a=t.height,u=t.x,s=t.y,t=n.width,c,f={clipX:0,clipY:0,clipHeight:n.height,clipWidth:t,paintX:0,paintY:0,paintHeight:0,paintWidth:0};if((l=o/a)<(t=(f=this.UMt(f,n,e)).clipWidth/f.clipHeight))switch(n=i.vAlign,f.paintWidth=o,f.paintHeight=h=o/t,f.paintX=u,n){case w.VerticalAlign.top:f.paintY=s;break;case w.VerticalAlign.center:f.paintY=s+(d=a-h)/2;break;case w.VerticalAlign.bottom:f.paintY=s+a-h}else switch(e=i.hAlign,f.paintHeight=a,f.paintWidth=v=a*t,f.paintY=s,e){case w.HorizontalAlign.left:f.paintX=u;break;case w.HorizontalAlign.center:f.paintX=u+(m=o-v)/2;break;case w.HorizontalAlign.right:f.paintX=u+o-v}return f},HMt:function(t,n,e,i,r){var t={cutX:0,cutY:0,cutHeight:n.width,cutWidth:n.height,paintX:t.x,paintY:t.y,paintHeight:t.height,paintWidth:t.width};return this.UMt(t,n,e)},UMt:function(t,n,e){var i,n,r,o,i=n.width,n=n.height,r=e.clipX||0,o=e.clipY||0;return A(e.clipX)||(t.clipX=a(e.clipX,i)),A(e.clipY)||(t.clipY=a(e.clipY,n)),A(e.clipWidth)?t.clipWidth=i-t.clipX:t.clipWidth=e.clipWidth+r>i?i-r:e.clipWidth,A(e.clipHeight)?t.clipHeight=n-t.clipY:t.clipHeight=e.clipHeight+o>n?n-o:e.clipHeight,t},zMt:function(t,n,e,i,r){var o,a,u,s,c,t,n,e,f,r,l,h,d,i,v,m,g,p,o=t.width,a=t.height,u=t.x,s=t.y,c={imgWidth:n.width,imgHeight:n.height,offsetX:0,offsetY:0},t=(c=this.VMt(c,n,e)).imgWidth,n=c.imgHeight,e=c.offsetX,f=c.offsetY,l=n*r,h={clipX:0,clipY:0,clipHeight:0,clipWidth:0,paintX:0,paintY:0,paintHeight:0,paintWidth:0},d=i.hAlign,i=i.vAlign;if(o<(r=t*r)){switch(h.paintWidth=o,h.paintX=u,v=(r-o)/r*t,d){case w.HorizontalAlign.left:h.clipX=c.offsetX;break;case w.HorizontalAlign.center:h.clipX=c.offsetX+v/2;break;case w.HorizontalAlign.right:h.clipX=c.offsetX+v}h.clipWidth=o}else{switch(h.clipWidth=t,h.clipX=0,m=o-(h.paintWidth=r),d){case w.HorizontalAlign.general:case w.HorizontalAlign.left:h.paintX=u;break;case w.HorizontalAlign.center:h.paintX=u+m/2;break;case w.HorizontalAlign.right:h.paintX=u+m}h.clipX+=e}if(a<l){switch(h.paintY=s,g=(l-(h.paintHeight=a))/l*n,i){case w.VerticalAlign.top:h.clipY=c.offsetY;break;case w.VerticalAlign.center:h.clipY=c.offsetY+g/2;break;case w.VerticalAlign.bottom:h.clipY=c.offsetY+g}h.clipHeight=a}else{switch(h.clipHeight=n,h.clipY=0,p=a-(h.paintHeight=l),i){case w.VerticalAlign.top:h.paintY=s;break;case w.VerticalAlign.center:h.paintY=s+p/2;break;case w.VerticalAlign.bottom:h.paintY=s+p}h.clipY+=f}return h},YMt:function(t,n,e,i,r){var o,a,r,u,s,c,f,l,t,n,h,d,v,i,m,g,p,m,b,y,o={clipX:0,clipY:0,clipHeight:0,clipWidth:0,paintX:0,paintY:0,paintHeight:0,paintWidth:0},a=n.customWidth*r,r=n.customHeight*r;if(!(null===a||a<0||null===r||a<0)){if(u=t.width,s=t.height,c=t.x,f=t.y,l={imgWidth:n.width,imgHeight:n.height,offsetX:0,offsetY:0},t=(l=this.VMt(l,n,e)).imgWidth,n=l.imgHeight,h=l.offsetX,d=l.offsetY,v=i.hAlign,i=i.vAlign,u<a){switch(o.paintWidth=u,o.paintX=c,g=(m=(a-u)/a)*t,v){case w.HorizontalAlign.left:o.clipX=l.offsetX;break;case w.HorizontalAlign.center:o.clipX=l.offsetX+g/2;break;case w.HorizontalAlign.right:o.clipX=l.offsetX+g}o.clipWidth=l.imgWidth*(1-m)}else{switch(o.clipWidth=t,o.clipX=0,p=u-(o.paintWidth=a),v){case w.HorizontalAlign.general:case w.HorizontalAlign.left:o.paintX=c;break;case w.HorizontalAlign.center:o.paintX=c+p/2;break;case w.HorizontalAlign.right:o.paintX=c+p}o.clipX+=h}if(s<r){switch(o.paintY=f,b=(m=(r-(o.paintHeight=s))/r)*n,i){case w.VerticalAlign.top:o.clipY=l.offsetY;break;case w.VerticalAlign.center:o.clipY=l.offsetY+b/2;break;case w.VerticalAlign.bottom:o.clipY=l.offsetY+b}o.clipHeight=l.imgHeight*(1-m)}else{switch(o.clipHeight=A(e.clipHeight)?n:l.imgHeight,o.clipY=0,y=s-(o.paintHeight=r),i){case w.VerticalAlign.top:o.paintY=f;break;case w.VerticalAlign.center:o.paintY=f+y/2;break;case w.VerticalAlign.bottom:o.paintY=f+y}o.clipY+=d}}return o},VMt:function(t,n,e){var i=n.width,n=n.height;return A(e.clipX)||(t.offsetX=a(i,e.clipX)),A(e.clipY)||(t.offsetY=a(n,e.clipY)),A(e.clipWidth)?t.imgWidth=i-t.offsetX:t.imgWidth=e.clipWidth+t.offsetX>i?i-t.offsetX:e.clipWidth,A(e.clipHeight)?t.imgHeight=n-t.offsetY:t.imgHeight=e.clipHeight+t.offsetY>n?n-t.offsetY:e.clipHeight,t},paint:function(t,n,e,i,r,o,a){var u,s,e,i,c;if(!A(n)&&!A(n.url)&&P(n.url)&&""!==n.url.trim()){u=this,e={x:e,y:i,width:r,height:o},i=(s=a.sheet).BO();try{c=n.url,i.jt(c)?u.ZMt(t,n,e,a):i.Rt(c)}catch(t){}}},ZMt:function(t,n,e,i){var r,o,a,u,a,a,s,c,f,l,h,d,r=this,o=n.url,a=i.sheet,u=n.drawType,a=a.MC;if(o&&"string"==typeof o&&a.qh(o)){switch(s={width:(a=a.Ot(o)).width,height:a.height},c={clipY:n.clipY,clipX:n.clipX,clipWidth:n.clipWidth,clipHeight:n.clipHeight},f={vAlign:n.vAlign,hAlign:n.hAlign},h=i.zoomFactor,u){case g.fit:l=r.GMt(e,s,c,f,h);break;case g.entireFit:l=r.HMt(e,s,c,f,h);break;case g.originFit:l=r.zMt(e,s,c,f,h);break;case g.custom:s.customWidth=n.width,s.customHeight=n.height,l=r.YMt(e,s,c,f,h)}l.img=a,v[d="IMAGESPARKLINE"](t,l,e.x,e.y,e.width,e.height,i)}}}),n(An,Kt=u),e((t.LineSparkline=kt=An).prototype,{createFunction:function(){return Sn(at,0)},paint:Tn}),n(In,Xt=u),e((t.ColumnSparkline=Dt=In).prototype,{createFunction:function(){return Sn(ut,1)},paint:Tn}),n(xn,qt=u),e((t.WinlossSparkline=_t=xn).prototype,{createFunction:function(){return Sn(st,2)},paint:Tn}),n(Nn,$t=u),e((t.RangeBlockSparkline=Et=Nn).prototype,{createFunction:function(){var t=new r(ct,2,2);return t.evaluate=function(t){var n,e,e,i,r,o,a,u,s,i,n,c,n=t[0],e=n.source,e=e&&e.getSheet(),i=t[1],r=0,o=i.getSource().getSheet(),a=i.getRow(0),u=i.getColumn(0),s=i.getRowCount(0),i=i.getColumnCount(0),n=new w.Range(n.row,n.column,1,1),c=new w.Range(a,u,s,i);if(e&&e.name()===o.name()&&c.containsRange(n))throw T.CalcError;return{templateSheetName:o.name(),templateRange:{row:a,col:u,rowCount:s,colCount:i},bindingObject:t[2]}},t.isContextSensitive=function(){return!0},t.acceptsReference=S,t},paint:function(t,n,e,i,r,o,a){var u,s,c,f,f,u,u,f,u=n.templateSheetName,s=n.templateRange;u&&(f=(f=(c=a.sheet).parent)&&f.getSheetFromName(u))&&(d||(u=l("CellTypes"),d=u.qY,L=u.$Y,F=u.paintRangeTemplate),u=(new d).yN(f,s),f=(new L).yN(f,s),F(t,{x:e,y:i,width:r,height:o},n.bindingObject,a,u,f.tZ))}}),n(kn,tn=u),e((t.GaugeKPISparkline=n=kn).prototype,{createFunction:function(){var t=new r(ft,4,255);return t.evaluate=function(t){var n,e,i,r,o,a,u,s,c,f,l,h,d,v,m,g,p,b,y,w,M,C,u,b,S,i,n=[],e=t.length,f=_(t[0]),l=_(t[1]),h=_(t[2]),d=_(t[3]),v=_(t[5]),m=_(t[6]),g=_(t[7]),p=_(t[8]),b=_(t[10]),y=_(t[11]),w=_(t[12]),M=t[4],C=t[13];if(!Dn(f,l,h,d,b,y,C,w))return I;for(t[9]instanceof T.CalcArray&&(r=(u=t[9].toArray(2))[0],o=u[1],a=u[2],u=u[3]),r=r||"16px Calibri",o=o||"bold 22px Calibri",a=a||Y,u=u||Y,v=A(v)?f:v,m=A(m)?l:m,g=A(g)?h:g,p=A(p)?d:p,b={minAngle:A(b)?-90:b,maxAngle:A(y)?90:y,radiusRatio:A(w)?0:w,targetValueOption:O(f,r,v),currentValueOption:O(l,o,m),minValueOption:O(h,a,g),maxValueOption:O(d,u,p),gaugeType:A(C)?0:C,ranges:void 0,showLabel:!!A(M)||Boolean(M)},S=14;S<e;S++)if((i=t[S])instanceof T.CalcArray){if(s=(i=i.toArray(0))[0],c=i[1],A(s)||A(c)||x(s)||x(c)||c<s||s<h||d<s||d<c||c<h)return I;n.push({start:s,end:c,color:i[2]})}return b.ranges=n,b},t.acceptsArray=function(t){return 9===t||14<=t},t.acceptsReference=function(t){return t<=3&&0<=t||5<=t&&t<=8||10<=t&&t<=12},t},paint:function(t,n,e,i,r,o,a){var u=a.zoomFactor;n.currentValueOption.fontAfterZoom=s(n.currentValueOption.font,u).font,n.targetValueOption.fontAfterZoom=s(n.targetValueOption.font,u).font,n.minValueOption.fontAfterZoom=s(n.minValueOption.font,u).font,n.maxValueOption.fontAfterZoom=s(n.maxValueOption.font,u).font,v[ft](t,n,e,i,r,o,a)}}),c={},t.jMt=c,r&&(R(new vt),R(new mt),R(new gt),R(new pt),R(new bt),R(new yt),R(new wt),R(new Mt),R(new Ct),R(new St),R(new Tt),R(new At),R(new It),R(new p),R(new kt),R(new Dt),R(new _t),R(new Et),R(new n),R(new xt),R(new Nt)),e(w.Workbook.prototype,{addSparklineEx:function(t){this.WMt||(this.WMt={});var n=this.WMt;t&&(n[t.name()]=t)},getSparklineEx:function(t){var n,n,n=c[t];return n||(n=this.WMt)&&n[t]},removeSparklineEx:function(t){var n=this.WMt;n&&(n[t]=void 0)}}),w.Workbook.ch("sparklineEx",{toJson:function(t){var n,e,i,r,o,n=this.WMt,e=[];if(n){for(i in n)n.hasOwnProperty(i)&&(o=(r=n[i]).toJSON())&&o.typeName&&e.push(o);0<e.length&&(t.sparklineExs=e)}},fromJson:function(t){var n,e,i,r,r,n=t.sparklineExs;if(n)for(e=0;e<n.length;e++)i=n[e],(r=(0,w.getTypeFromString)(i.typeName))&&((r=new r).fromJSON(i),this.addSparklineEx(r))},wh:function(t,n,e){var i,r,o,a,u,i=this.WMt,r=[];if(i){for(o in i)i.hasOwnProperty(o)&&(u=(a=i[o]).toJSON())&&u.typeName&&r.push(u);0<r.length&&(t.workbook.lossless.sparklineExs=r)}},yh:function(t,n,e){var t,i,r,o,a,a,t=t.workbook.lossless,i=t&&t.sparklineExs;if(i)for(r=0;r<i.length;r++)o=i[r],(a=(0,w.getTypeFromString)(o.typeName))&&((a=new a).fromJSON(o),this.addSparklineEx(a))}})},"./dist/plugins/sparkline/sparkline-wrapper.entry.js":function(t,n,e){"use strict";var i,r;Object.defineProperty(n,"__esModule",{value:!0}),n.Sparkline=n.DataOrientation=n.SparklineType=n.SparklineSetting=n.SparklineAxisMinMax=n.EmptyValueStyle=n.ImageSparkline=n.HistogramSparkline=n.SparklineExValue=n.SparklineEx=n.GaugeKPISparkline=n.RangeBlockSparkline=n.WinlossSparkline=n.ColumnSparkline=n.LineSparkline=n.YearSparkline=n.MonthSparkline=n.ParetoSparkline=n.CascadeSparkline=n.BoxPlotSparkline=n.VariSparkline=n.VBarSparkline=n.HBarSparkline=n.StackedSparkline=n.SpreadSparkline=n.BulletSparkline=n.ScatterSparkline=n.AreaSparkline=n.PieSparkline=n.jMt=void 0,i=e("./dist/plugins/sparkline/functions-sparkline.js"),Object.defineProperty(n,"jMt",{enumerable:!0,get:function(){return i.jMt}}),Object.defineProperty(n,"PieSparkline",{enumerable:!0,get:function(){return i.PieSparkline}}),Object.defineProperty(n,"AreaSparkline",{enumerable:!0,get:function(){return i.AreaSparkline}}),Object.defineProperty(n,"ScatterSparkline",{enumerable:!0,get:function(){return i.ScatterSparkline}}),Object.defineProperty(n,"BulletSparkline",{enumerable:!0,get:function(){return i.BulletSparkline}}),Object.defineProperty(n,"SpreadSparkline",{enumerable:!0,get:function(){return i.SpreadSparkline}}),Object.defineProperty(n,"StackedSparkline",{enumerable:!0,get:function(){return i.StackedSparkline}}),Object.defineProperty(n,"HBarSparkline",{enumerable:!0,get:function(){return i.HBarSparkline}}),Object.defineProperty(n,"VBarSparkline",{enumerable:!0,get:function(){return i.VBarSparkline}}),Object.defineProperty(n,"VariSparkline",{enumerable:!0,get:function(){return i.VariSparkline}}),Object.defineProperty(n,"BoxPlotSparkline",{enumerable:!0,get:function(){return i.BoxPlotSparkline}}),Object.defineProperty(n,"CascadeSparkline",{enumerable:!0,get:function(){return i.CascadeSparkline}}),Object.defineProperty(n,"ParetoSparkline",{enumerable:!0,get:function(){return i.ParetoSparkline}}),Object.defineProperty(n,"MonthSparkline",{enumerable:!0,get:function(){return i.MonthSparkline}}),Object.defineProperty(n,"YearSparkline",{enumerable:!0,get:function(){return i.YearSparkline}}),Object.defineProperty(n,"LineSparkline",{enumerable:!0,get:function(){return i.LineSparkline}}),Object.defineProperty(n,"ColumnSparkline",{enumerable:!0,get:function(){return i.ColumnSparkline}}),Object.defineProperty(n,"WinlossSparkline",{enumerable:!0,get:function(){return i.WinlossSparkline}}),Object.defineProperty(n,"RangeBlockSparkline",{enumerable:!0,get:function(){return i.RangeBlockSparkline}}),Object.defineProperty(n,"GaugeKPISparkline",{enumerable:!0,get:function(){return i.GaugeKPISparkline}}),Object.defineProperty(n,"SparklineEx",{enumerable:!0,get:function(){return i.SparklineEx}}),Object.defineProperty(n,"SparklineExValue",{enumerable:!0,get:function(){return i.SparklineExValue}}),Object.defineProperty(n,"HistogramSparkline",{enumerable:!0,get:function(){return i.HistogramSparkline}}),Object.defineProperty(n,"ImageSparkline",{enumerable:!0,get:function(){return i.ImageSparkline}}),r=e("./dist/plugins/sparkline/sparkline-wrapper.js"),Object.defineProperty(n,"EmptyValueStyle",{enumerable:!0,get:function(){return r.EmptyValueStyle}}),Object.defineProperty(n,"SparklineAxisMinMax",{enumerable:!0,get:function(){return r.SparklineAxisMinMax}}),Object.defineProperty(n,"SparklineSetting",{enumerable:!0,get:function(){return r.SparklineSetting}}),Object.defineProperty(n,"SparklineType",{enumerable:!0,get:function(){return r.SparklineType}}),Object.defineProperty(n,"DataOrientation",{enumerable:!0,get:function(){return r.DataOrientation}}),Object.defineProperty(n,"Sparkline",{enumerable:!0,get:function(){return r.Sparkline}})},"./dist/plugins/sparkline/sparkline-wrapper.js":function(B,t,n){"use strict";var A,s,L,p,n,a,F,u,e,i,r,o,c,f,x,I,l,g,M,P,G,U,T,C,S,h,H,z,V,d,v,m,Y,Z,W,Q,J,n,l,b,y,K,X,w,N,l,n,l,n,l,n,l;function q(t,n,e,i){var r,t,n,r,t=p.formulaToRanges(t,n,e,i)[0],n=t&&t.ranges&&t.ranges[0];return n?{range:n,sheetName:t.sheetName}:T}function $(t,n,e,i){var r,o,r=this,o=r.RB;o._K(t,n,i),i&&o.add(i.group()),r.Rj("sparkline",t,n,3,e,i),r.ki(A.Events.WorksheetDataChanged,{type:"sparkline"})}function k(t){this.QMt=[],this.Mf=t,this.cE={},this.KMt=[],this.JMt=[]}function tt(t,n){return t+"_"+n}function nt(t,n,e){return e?t>e.row+e.rowCount-1?e:t>e.row?x(e.row,e.col,e.rowCount+n,e.colCount):x(e.row+n,e.col,e.rowCount,e.colCount):T}function et(t,n,e){return e?t>e.col+e.colCount-1?e:t>e.col?x(e.row,e.col,e.rowCount,e.colCount+n):x(e.row,e.col+n,e.rowCount,e.colCount):T}function it(t,n,e,i,r){for(var o,a,u,s,c,f,l,h,d,v,m,g,p,b,y,o=new A.Rf,a=0;a<t.length;a++){if(s=(u=t[a]).XMt,u.displayDateAxis){if(I(u.dateAxisData())&&u.dateAxisData(u.qMt),c=void 0,(f=u.dateAxisData())instanceof A.Range)c=D(n,e,i,f);else for(l=0;l<f.length;l++)c.push.apply(c,D(n,e,i,f[l]));u.dateAxisData(c)}for(l=0;l<s.length;l++)h=s[l],n<=(d=i?h.row:h.column)&&(o.set(a,l,h),r._K(h.row,h.column,T),i?h.row+=e:h.column+=e),I(h.data())&&h.data(h.gI),v=void 0,(m=h.data())instanceof A.Range?(v=D(n,e,i,m),h.data(v)):h.data(h.gI)}for(g=0;g<t.length;g++)for(b=(p=t[g]).XMt,y=0;y<b.length;y++)r.$Mt(o.get(g,y))}function rt(t,n,e,i,r,o){for(var a,u,s,c,f,l,h,d,v,m,g,p,b,y,a=0;a<i.length;a++)if((u=i[a]).displayDateAxis){if(c=(s=u.tCt()).Ut,f=!1,o&&!c.G8&&(c.G8=[],f=!0),I(u.dateAxisData())&&u.dateAxisData(u.qMt),l=void 0,(h=u.dateAxisData())instanceof A.Range)l=D(t,n,e,h);else for(d=0;d<h.length;d++)l.push.apply(l,D(t,n,e,h[d]));u.dateAxisData(l),f&&(o.push({sheetName:s.name(),changes:c.G8}),c.G8=C)}for(d=0;d<r.length;d++)g=(m=(v=r[d]).Tp()).Ut,p=!1,o&&!g.G8&&(g.G8=[],p=!0),I(v.data())&&v.data(v.gI),b=void 0,(y=v.data())instanceof A.Range?(b=D(t,n,e,y),v.data(b)):v.data(v.gI),p&&(o.push({sheetName:m.name(),changes:g.G8}),g.G8=C)}function D(t,n,e,i){var e,e=(e?nt:et)(t,n,i);return e}function ot(t,n,e){var t=ut(e.col,e.col+e.colCount-1,t,t+n-1);return t?x(e.row,t.start,e.rowCount,t.end-t.start+1):T}function at(t,n,e){var t=ut(e.row,e.row+e.rowCount-1,t,t+n-1);return t?x(t.start,e.col,t.end-t.start+1,e.colCount):T}function ut(t,n,e,i){var r,o,a,u,u,s,c,r=-1;if(i<t)return{start:r=t-(u=i-e+1),end:o=n-u};if(n<e)return{start:r=t,end:o=n};if(e<=t){for(u=n-t+1,s=0,a=t;a<=i&&a<=n;a++)s++;return{start:r=e,end:o=r+u-s-1}}for(c=0,a=t;a<=n;a++)-1===r&&(a<e||i<a)&&(r=a),(a<e||i<a)&&c++;return-1!==r&&0<c?{start:r,end:o=r+c-1}:T}function st(t,n,e,i,r){for(var o,a,u,s,c,f,l,h,d,v,m,g,g,p,b,y,w,o=new A.Rf,a=t.length,u=0,s=a-1;-1<s;s--){if((c=t[s]).displayDateAxis){if(I(c.dateAxisData())&&c.dateAxisData(c.qMt),f=void 0,(l=c.dateAxisData())instanceof A.Range)f=_(n,e,i,l);else for(h=0;h<l.length;h++)f.push.apply(f,_(n,e,i,l[h]));if(I(f)){c.clear(),r.remove(c);continue}c.dateAxisData(f)}for(d=(d=[]).concat(c.XMt),v=M(d),u=S(v,u),h=v-1;-1<h;h--)m=d[h],n<=(g=i?m.row:m.column)&&g<n+e&&I(m.gI)?(c.remove(m),r._K(m.row,m.column,T)):(n<=g&&(r._K(m.row,m.column,T),i?m.row-=e:m.column-=e,o.set(s,h,m)),I(m.data())&&m.data(m.gI),g=void 0,g=(p=m.data())instanceof A.Range?_(n,e,i,p):(m.data(m.gI),m.data()),I(g)?c.remove(m):m.data(g));c.count()<=0&&r.remove(c)}for(y=0;y<a;y++)for(w=0;w<u;w++)(b=o.get(y,w))&&r.$Mt(b)}function _(t,n,e,i){var e,e=(e?at:ot)(t,n,i);return e}function ct(t,n,e,i,r,o){for(var a,u,s,c,f,l,h,d,v,m,g,p,b,y,w,M,M,a,u=i.length-1;-1<u;u--)if((s=i[u]).displayDateAxis){if(f=(c=s.tCt()).Ut,l=!1,o&&!f.G8&&(f.G8=[],l=!0),I(s.dateAxisData())&&s.dateAxisData(s.qMt),h=void 0,(d=s.dateAxisData())instanceof A.Range)h=_(t,n,e,d);else for(v=0;v<d.length;v++)h.push.apply(h,_(t,n,e,d[v]));I(h)?(s.clear(),s.RB.remove(s)):s.dateAxisData(h),l&&(o.push({sheetName:c.name(),changes:f.G8}),f.G8=C)}for(v=(m=r.length)-1;-1<v;v--)b=(p=(g=r[v]).Tp()).Ut,y=!1,o&&!b.G8&&(b.G8=[],y=!0),I(g.data())&&g.data(g.gI),w=void 0,w=(M=g.data())instanceof A.Range?_(t,n,e,M):(g.data(g.gI),g.data()),I(w)?((M=g.group()).remove(g),M.count()<=0&&M.RB.remove(M)):g.data(w),y&&(o.push({sheetName:p.name(),changes:b.G8}),b.G8=C)}function E(t){var n,e,n=this;for(e in n.options={},b)b.hasOwnProperty(e)&&(n.options[e]=(t&&t[e]?t:b)[e]);n.eJ=T}function j(t,n){var e=this;e.displayDateAxis=!1,e.RB=T,e.XMt=[],e.nCt=T,e.eCt=1,e.qMt=T,e.setting=n,e.sparklineType=t}function ft(t,n){var e=!1;return"setting"===t||"axisReference"===t?e=n===T:"displayDateAxis"===t?e=!1===n:"axisOrientation"===t?e=1===n:"sparklines"===t&&(e=0===n.length),e}function O(t,n,e,i,r,o,a){var u=this;u.row=t,u.column=n,u.iCt=i,u._data=e,u.rCt=new w(r,o),u.rCt.add(u),u.gI=a}function lt(t,n){var e,n,e=t.parent,n=t.getCustomName(n)||e.getCustomName(n);if(!I(n))return p.formulaToRanges(t,p.expressionToFormula(t,n.getExpression()),0,0,1===e.options.referenceStyle)}function R(t){var e,i,e=[],i=[];return t.forEach(function(t){e=e.concat(t.ranges);for(var n=0;n<t.ranges.length;n++)i.push(t.sheetName)}),{ranges:e,sheetName:i}}Object.defineProperty(t,"__esModule",{value:!0}),t.Sparkline=t.DataOrientation=t.SparklineType=t.SparklineSetting=t.SparklineAxisMinMax=t.EmptyValueStyle=void 0,A=n("Core"),s=n("Common"),L=n("CalcEngine"),p=n("SheetsCalc"),n=A.mt,a=n.xr,F=n.Lue,u=A.range_parser.Dc,e=A.NodeHelper.ar,i=A.NodeHelper.ur,r=n.d1,o=n.h1,c=A.range_parser.Oc,f=A.GC$.isEmptyObject,x=A.Ec,I=s.Common.lt.ht,l=s.Common.Uf,g=l.VP,M=l.tR,P=l.OS,G=s.Sparklines.oCt,U=s.Sparklines.SparklineRender,T=null,C=void 0,S=Math.max,h=Number.MAX_VALUE,H=A.UsedRangeUtil.vh,z=n.vo,V=n.n1,(l=d=d||{})[l.line=0]="line",l[l.column=1]="column",l[l.stacked=2]="stacked",(n=v=v||{})[n.span=2]="span",n[n.gap=0]="gap",n[n.zero=1]="zero",(l=m=m||{})[l.individual=0]="individual",l[l.group=1]="group",l[l.custom=2]="custom",A.GC$.extend(A.Y8.prototype,{aCt:function(t){var n,e,i,r,o,a,n,e=this.G8,i=arguments[1];if(e){switch(e.originalSparklines||(e.originalSparklines=[]),r={type:t},t){case 0:a=void 0,a=i&&i.sparkline?i.sparkline:T,r.changeInfo={row:i.row,col:i.col,sparkline:a};break;case 12:case 1:case 2:case 3:case 4:case 5:case 6:case 7:case 8:case 9:case 10:case 11:case 13:case 14:case 15:case 16:r.changeInfo=i}e.originalSparklines.push(r)}},uCt:function(t){var n,e,i,r,o,a,u,s,c,f,l,h,d,v,m,n=this,e=t.changeInfo;switch(t.type){case 12:e.sparkline?(e.sparkline.row=e.row,e.sparkline.column=e.col,n.RB._K(e.row,e.col,e.sparkline)):n.RB._K(e.row,e.col,T);break;case 0:n.RB._K(e.row,e.col,e.sparkline),e.sparkline&&!n.RB.contains(e.sparkline.group())&&n.RB.add(e.sparkline.group());break;case 1:for(a=o=r=void 0,u=M(e),s=0;s<u;s++)r=e[s].row,o=e[s].col,a=n.RB.sCt(r,o),0===s&&a.rCt.count()===u&&n.RB.remove(a.rCt),this.RB.add(a.group(e[s].group).rCt);break;case 2:for(c=[],f=0;f<M(e);f++)c.push(n.RB.sCt(e[f].row,e[f].col));n.RB.Mf.groupSparkline(c);break;case 3:(i=n.RB.sCt(e.row,e.col)).sparklineType(e.sparklineType);break;case 4:(i=n.RB.sCt(e.row,e.col)).setting(e.setting);break;case 5:e.sparkline.data(e.data);break;case 15:(i=n.RB.sCt(e.row,e.col)).dataSheetName(e.dataSheetName);break;case 6:(i=n.RB.sCt(e.row,e.col)).dataOrientation(e.dataOrientation);break;case 7:(i=n.RB.sCt(e.row,e.col)).displayDateAxis(e.displayDateAxis);break;case 8:l=void 0,l=(h=e.rangeInfo)&&x(h.row,h.col,h.rowCount,h.colCount),e.group.dateAxisData(l);break;case 16:e.group.dateAxisDataSheetName(e.dateAxisDataSheetName);break;case 9:e.group.dateAxisOrientation(e.dateAxisOrientation);break;case 10:for((d=e.group.XMt).forEach(function(t){n.RB.cCt(t)}),e.group.XMt=e.innerList,v=e.group.XMt,m=0;m<M(v);m++)v[m].group(e.group);v.forEach(function(t){n.RB.fCt(t)});break;case 11:(i=n.RB.sCt(e.row,e.col)).group(e.group);break;case 13:g(n.RB.groups(),e),n.RB.lCt(e);break;case 14:n.RB.groups().push(e),n.RB.hCt(e)}},dCt:function(t){for(var n,e,n,e=M(t)-1;0<=e;e--)this.uCt(t[e])},vCt:function(t,n){this.RB.JO(t,n)},mCt:function(t,n){this.RB.xP(t,n)},gCt:function(t,n){this.RB.qO(t,n)},pCt:function(t,n){this.RB.NP(t,n)},bCt:function(t,n,e,i){this.RB.clear(t,n,e,i)},yCt:function(){var t=this.G8;return t?(t.wCt||(t.wCt=[]),t.wCt):T}}),A.Y8.ch("sparkline",{init:function(){var t=this.Mf;this.RB=new W(t)},undo:function(t){var n,e,n,n=t.originalSparklines;n&&this.dCt(n),e=this.Mf,(n=t.wCt)&&n.forEach(function(t){var n;e.parent.getSheetFromName(t.sheetName).Ut.undo(t.changes)})}}),A.Worksheet.ch("sparkline",Y={init:function(){this.RB=this.Ut.RB},getUsedRange:function(t){var n,e,i;t.type&A.UsedRangeType.sparkLine&&(i=(e=(n=this).RB).getUsedRange(),H(t.range,i))},dispose:function(t){var t;!1!==t.clearCache&&((t=this).RB&&(t.RB.Mf=T,t.RB.evaluator=T,t.RB=T),t.Ut)&&(t.Ut.RB=T)},onLayoutChanged:function(t){var n,e,i,r,o,a,n;!I(t.sheetArea)&&3!==t.sheetArea||(n=t.changeType,e=t.row,i=t.rowCount,r=t.col,o=t.colCount,a=this.Ut,"addRows"===n?a.vCt(e,i):"deleteRows"===n?a.mCt(e,i):"addColumns"===n?a.gCt(r,o):"deleteColumns"===n?a.pCt(r,o):"clear"===n&&(n=t.type,3===t.sheetArea)&&16==(16&n)&&a.bCt(e,r,i,o))},toJson:function(t,n){var e;n&&n.ignoreStyle||(t.sparklineGroups=this.RB.toJSON())},wh:function(t,n,e){var i,e,t,i;(!e||!1!==e.includeStyles)&&(e=this.RB.wh(),t=a(t,A.XFileConstants.Au),0<e.c_.length)&&t.c_.push({n_:"ext",c_:[e],r_:[0,1]})},fromJson:function(t,n,e){var e,i,r,o,o,e=e&&e.ignoreStyle,i,r=this.RB,o=t.sparklineGroupManager,o=n?o&&o.groups:t.sparklineGroups;o&&!e&&r.AP(o,n)},yh:function(t,n,e){var i,r,o,t,t,i=e&&!1===e.includeStyles,r,o=this.RB,t=F(a(t,"extLst"),"sparklineGroups"),t=t&&t.c_;t&&!i&&(o.MCt(t,e),o.groups().forEach(function(t){t.XMt.forEach(function(t){o.$Mt(t)})}))},setName:function(t){var n=t.oldName,t=t.newName;this.RB.CCt(n,t)}}),A.GC$.extend(A.Worksheet.prototype,Z={getSparkline:function(t,n){return this.RB?this.RB.sCt(t,n):T},setSparkline:function(t,n,e,i,r,o,a,u){var s,c,f,l,h,d,v,f,m,g,h,e,i,r,o,s=this,c;if(!s.RB)return T;if("string"==typeof e&&(h=q(s,e,t,n),d=s.getCustomName(e)||s.parent.getCustomName(e),v=void 0,(v=I(d)?v:p.formulaToRanges(s,p.expressionToFormula(s,d.getExpression(),t,n,1===s.parent.options.referenceStyle)))?(l=e,e=m=(f=R(v)).ranges,f=g=f.sheetName):h&&(e=h.range,f=h.sheetName),!h)&&!v)return T;if(h=new N(t,n,e,i,r,o,l),f&&f!==s.name()&&h.dataSheetName(f),a&&!I(u)){if(e=void 0,"string"==typeof a&&(i=q(s,a,t,n),d=s.getCustomName(a)||s.parent.getCustomName(a),v=void 0,(v=I(d)?v:p.formulaToRanges(s,p.expressionToFormula(s,d.getExpression(),t,n,1===s.parent.options.referenceStyle)))?(h.group().qMt=a,a=m=(r=R(v)).ranges,e=g=r.sheetName):i&&(a=i.range,e=i.sheetName),!i)&&!v)return T;h.dateAxisData(a),e&&e!==s.name()&&h.dateAxisDataSheetName(e),h.dateAxisOrientation(u),h.group().displayDateAxis=!0}return o=s.getSparkline(t,n),s.removeSparkline(t,n),$.call(s,t,n,o,h),s.zw(),h},SCt:function(t,n,e){var i,r=this.getSparkline(t,n);$.call(this,t,n,r,e)},removeSparkline:function(t,n){var e,i,r,o,a,e=this,i=e.RB;i&&(r=e.getSparkline(t,n),e.Ut.aCt(0,o={row:t,col:n,sparkline:r}),r&&((a=r.group()).remove(r),a.count()<=0&&i.remove(a),$.call(e,t,n,r,T)),e.zw())},groupSparkline:function(t){var n,e,i,r,o,a,u,s,n=this,e=n.RB;if(!e)return T;for(i=T,r=[],o=n.Ut.G8!==C,a=0;a<t.length;a++)(u=t[a])&&(o&&r.push({group:u.group().clone(),row:u.row,col:u.column}),i?((s=u.group()).remove(u),i.add(u),s.count()<=0&&e.remove(s)):i=u.group());return n.zw(),n.Ut.aCt(1,r),i},ungroupSparkline:function(t){var n,e,i,r,o,a,u,s,n=this,e=n.RB;if(e&&t){for(r=[],o=n.Ut.G8!==C,i=(i=[]).concat(t.XMt),a=0;a<i.length;a++)(u=i[a])&&(o&&r.push({row:u.row,col:u.column}),t.remove(u),(s=t.clone()).add(u),e.add(s));e.remove(t),n.Ut.aCt(2,r),n.zw()}}}),k.prototype.getUsedRange=function(){var t,n,e,i,r,o,a,u,s,c,t,n=this.cE,e={};if(n)for(a=o=r=void 0,u=0,s=i=Object.keys(n);u<s.length;u++)o=(r=n[c=s[u]]).row,a=r.column,H(e,{minRow:o,minCol:a,maxRow:o,maxCol:a});return e},k.prototype.AP=function(t,n){var e=this;e.fromJSON(t,n),e.groups().forEach(function(t){t.XMt.forEach(function(t){e.$Mt(t)})})},k.prototype.MCt=function(t,n){var e,i,e=this,i=e.Mf;e.yh(t,n),e.groups().forEach(function(t){t.XMt.forEach(function(t){e.$Mt(t),t.row>=i.getRowCount()&&i.setRowCount(t.row+1),t.column>=i.getColumnCount()&&i.setColumnCount(t.column+1)})})},k.prototype.$Mt=function(t){t&&this._K(t.row,t.column,t)},k.prototype._K=function(t,n,e){var i;this.Mf.Ut.G8&&(i={row:t,col:n,sparkline:this.sCt(t,n),newSparkline:e},this.Mf.Ut.aCt(12,i)),e?this.cE[t+"_"+n]=e:delete this.cE[t+"_"+n]},k.prototype.sCt=function(t,n){return this.cE[t+"_"+n]||T},k.prototype.groups=function(t){if(0===arguments.length)return this.QMt;this.QMt=t},k.prototype.add=function(t){var n=this;n.Mf.Ut.aCt(13,t),n.groups().push(t),t.RB=n,t.TCt(),n.hCt(t)},k.prototype.hCt=function(t){var n=this;n.ACt(t),t.all().forEach(function(t){n.fCt(t)})},k.prototype.remove=function(t){var n=this;n.Mf.Ut.aCt(14,t),g(n.groups(),t),n.lCt(t)},k.prototype.lCt=function(t){var n=this;n.ICt(t),t.all().forEach(function(t){n.cCt(t)})},k.prototype.contains=function(t){return P(this.groups(),t)},k.prototype.count=function(){return this.groups().length},k.prototype.JO=function(t,n){it(this.QMt,t,n,!0,this),rt(t,n,!0,this.JMt,this.KMt,this.Mf.Ut.yCt())},k.prototype.qO=function(t,n){it(this.QMt,t,n,!1,this),rt(t,n,!1,this.JMt,this.KMt,this.Mf.Ut.yCt())},k.prototype.xP=function(t,n){st(this.QMt,t,n,!0,this),ct(t,n,!0,this.JMt,this.KMt,this.Mf.Ut.yCt())},k.prototype.NP=function(t,n){st(this.QMt,t,n,!1,this),ct(t,n,!1,this.JMt,this.KMt,this.Mf.Ut.yCt())},k.prototype.CCt=function(n,e){this.JMt.forEach(function(t){t.dateAxisDataSheetName()===n&&t.dateAxisDataSheetName(e)}),this.KMt.forEach(function(t){t.dataSheetName()===n&&t.dataSheetName(e)})},k.prototype.fCt=function(t){var n,e,n,e,n=this.Mf,e=t.dataSheetName();e&&e!==n.name()&&(n=n.parent.getSheetFromName(e))&&(e=n.RB.KMt).indexOf(t)<0&&e.push(t)},k.prototype.cCt=function(t){var n,n,n,t,n=t.dataSheetName();n&&(n=this.Mf.parent.getSheetFromName(n))&&0<=(t=(n=n.RB.KMt).indexOf(t))&&n.splice(t,1)},k.prototype.ACt=function(t){var n,e,n,e,n=this.Mf,e=t.dateAxisDataSheetName();e&&e!==n.name()&&(n=n.parent.getSheetFromName(e))&&(e=n.RB.JMt).indexOf(t)<0&&e.push(t)},k.prototype.ICt=function(t){var n,n,n,t,n=t.dateAxisDataSheetName();n&&(n=this.Mf.parent.getSheetFromName(n))&&0<=(t=(n=n.RB.JMt).indexOf(t))&&n.splice(t,1)},k.prototype.clear=function(t,n,e,i){var r,o,a,u,s,c,f,l,h,d,r=this;if(0===arguments.length){for(o=r.QMt,a=M(o)-1;-1<a;a--)if(u=o[a]){for(s=u.count()-1;-1<s;s--)c=u.XMt[s],r._K(c.row,c.column,T),u.remove(c);r.remove(u)}}else for(f=t;f<t+e;f++)for(l=n;l<n+i;l++)(h=r.Hq(f,l))&&(r._K(h.row,h.column,T),(d=h.group()).remove(h),0===d.count())&&r.remove(d)},k.prototype.Hq=function(t,n){for(var e,i,r,o,a,e=this.QMt,i=0;i<e.length;i++)for(r=e[i],o=0;o<r.count();o++)if((a=r.XMt[o])&&a.row===t&&a.column===n)return a;return T},k.prototype.tE=function(t,n,e,i,r,o,a,u){var s,c,f,l,h,d,v,m,g,p,b,y,w,M,C,S,S,T,T,s=this,c=s.Mf;if(c){for(f=new A.Rf,l=e-t,h=i-n,m=c.getRowCount(),g=c.getColumnCount(),y=r,w=o,M=c.RB,C=!u&&c.o5(),p=d=0;d<r&&e+d<m;d++)if(C&&0===c.getRowHeight(e+d))r++;else{if(!(a&&c.XT&&c.XT(e+d)))for(b=v=0,o=w;v<o&&i+v<g;v++)C&&0===c.getColumnWidth(i+v)?o++:((S=c.getSparkline(t+p,n+b))&&((S=S.clone()).row=e+d,S.column=i+v,I(S.dateAxisData())&&S.dateAxisData(S.group().qMt),T=S.dateAxisData(),C&&(l=e-t+d-p,h=i-n+v-b),!I(T)&&s.xCt(T,l,h,m,g)&&I(S.group().customName)&&S.dateAxisData(T.offset(h,l)),I(S.data())&&S.data(S.gI),T=S.data(),!I(T)&&s.xCt(T,l,h,m,g)&&I(S.gI)&&S.data(T.offset(h,l)),s.add(S.group()),f.set(d,v,S)),b++);p++}for(d=0,r=y;d<r&&e+d<m;d++)if(C&&0===c.getRowHeight(e+d))r++;else if(!(a&&c.XT&&c.XT(e+d)))for(v=0,o=w;v<o&&i+v<g;v++)C&&0===c.getColumnWidth(i+v)?o++:M._K(e+d,i+v,f.get(d,v))}},k.prototype.xCt=function(t,n,e,i,r){var t,o,a,u,t,t=this.NCt(t);return!(!t||(o=S(t.row,0),a=S(t.col,0),u=t.row<0?i:t.rowCount,t=t.col<0?r:t.colCount,o+n<0)||a+e<0||i<o+u+n||r<a+t+e)},k.prototype.iE=function(t,n,e,i,r,o){var a,u,s,c,f,l,h,d,v,m,g,p,b,a=this.Mf;if(a){for(c=a.o5(),f=o,l=r,this.kCt(t,n,e,i,r,o),h=a.RB,d=new A.Rf,g=a.getRowCount(),p=a.getColumnCount(),u=v=0;v<r&&v+e<g;v++)if(c&&0===a.getRowHeight(e+v))r++;else{for(s=m=0,o=f;m<o&&i+m<p;m++)c&&0===a.getColumnWidth(i+m)?o++:((b=a.getSparkline(t+u,n+s))&&(b.row=e+v,b.column=i+m,d.set(u,s,b)),h._K(t+u,n+s,T),s++);u++}for(u=v=0,r=l;v<r&&v+e<g;v++)if(c&&0===a.getRowHeight(e+v))r++;else{for(s=m=0,o=f;m<o&&i+m<p;m++)c&&0===a.getColumnWidth(i+m)?o++:(a.removeSparkline(e+v,i+m),h._K(e+v,i+m,d.get(u,s)),s++);u++}}},k.prototype.kCt=function(t,n,e,i,r,o,a){var u,s,a,c,f,l,h,d,v,m,g,p,b,y,w,M,C,S,T,A,I,u=this,a=(s=(u=a?a:u).Mf).o5(),c=x(t,n,r,o),h=o,p=s.getRowCount(),b=s.getColumnCount(),y=u.QMt;if(a)for(g=v=0;v<r&&v+e<p;v++)if(0===s.getRowHeight(e+v))r++;else{for(m=d=0,o=h;d<o&&d+i<b;d++)if(0===s.getColumnWidth(i+d))o++;else{if(w=s.getSparkline(t+g,n+m))for(f=e-t+v-g,l=i-n+d-m,C=(M=w.rCt).XMt,S=0;S<C.length;S++)(T=C[S])&&u.DCt(T,f,l,c);m++}g++}else for(f=e-t,l=i-n,S=0;S<y.length;S++)for(C=(A=y[S]).XMt,I=0;I<C.length;I++)(w=C[I])&&u.DCt(w,f,l,c)},k.prototype.DCt=function(t,n,e,i){var r,o,a,a,o,r=this;I(t.dateAxisData())&&t.dateAxisData(t.group().qMt),o=t.dateAxisData(),(a=r.NCt(o))&&i.containsRange(a)&&i.contains(t.row,t.column)&&t.dateAxisData(o.offset(e,n)),I(t.data())&&t.data(t.gI),a=t.data(),(o=r.NCt(a))&&i.containsRange(o)&&i.contains(t.row,t.column)&&t.data(a.offset(e,n))},k.prototype.NCt=function(t){return t},k.prototype.LB=function(t,n,e,i,r,o,a,u,s){var c,f,l,h,d,v,m,g,p,b,y,w,M,C,C,S,S,c=this,f=c.Mf;if(f)if(t===f)c.tE(n,e,i,r,o,a);else for(l=i-n,h=r-e,d=f.RB,v=!s&&f.o5(),m=f.getRowCount(),g=f.getColumnCount(),p=a,w=b=0;b<o&&i+b<m;b++)if(v&&0===f.getRowHeight(i+b))o++;else{if(!(u&&f.XT&&f.XT(i+b)))for(M=y=0,a=p;y<a&&r+y<g;y++)v&&0===f.getColumnWidth(r+y)?a++:((C=t.getSparkline(n+w,e+M))?((C=C.clone()).row=i+b,C.column=r+y,I(C.dateAxisData())&&C.dateAxisData(C.group().qMt),S=C.dateAxisData(),v&&(l=i+b-n-w,h=r-e+y-M),!I(S)&&c.xCt(S,l,h,m,g)&&C.dateAxisData(S.offset(h,l)),I(C.data())&&C.data(C.gI),S=C.data(),!I(S)&&c.xCt(S,l,h,m,g)&&C.data(S.offset(h,l)),c.add(C.group()),d._K(i+b,r+y,C)):d._K(i+b,r+y,T),M++);w++}},k.prototype.BB=function(t,n,e,i,r,o,a){var u,s,c,f,l,h,d,v,m,g,p,b,y,w,M,u=this,s=u.Mf;if(s)if(t===s)u.iE(n,e,i,r,o,a);else for(c=s.o5(),f=a,l=t.RB,h=s.RB,p=s.getRowCount(),b=s.getColumnCount(),u._Ct(t,n,e,i,r,o,a),m=d=0;d<o&&i+d<p;d++)if(c&&0===s.getRowHeight(i+d))o++;else for(g=v=0,a=f;v<a&&r+v<b;v++)c&&0===s.getColumnWidth(r+v)?a++:((y=t.getSparkline(n+0,e+0))?(y.row=i+d,y.column=r+v,M=(w=y.group()).clone(),w.remove(y),w.count()<=0&&l.remove(w),M.add(y),u.add(M),h._K(i+d,r+v,y)):h._K(i+d,r+v,T),l._K(n+0,e+0,T))},k.prototype._Ct=function(t,n,e,i,r,o,a){var u,s,u=this,s=u.Mf;t&&s&&u.kCt(n,e,i,r,o,a,t.RB)},k.prototype.toJSON=function(){for(var t,n,e,t=this.QMt,n=[],e=0;t&&e<t.length;e++)n.push(t[e].toJSON());return 0===n.length?C:n},k.prototype.wh=function(){for(var t,n,e,i,r,t=this.QMt,n={n_:"sparklineGroups",c_:[],r_:[2]},e=0;t&&e<t.length;e++)r=(i=t[e]).wh(),n.c_.push(r);return n},k.prototype.fromJSON=function(t,n){var e,i,r;for(this.QMt.length=0,this.cE={},e=0;t&&e<t.length;e++)i=t[e],(r=new w).fromJSON(i,n),this.add(r)},k.prototype.yh=function(t,n){var e,i,r;for(this.QMt.length=0,this.cE={},e=0;t&&e<t.length;e++)i=t[e],(r=new w).yh(i,n),this.add(r)},W=k,(n=Q=t.EmptyValueStyle||(t.EmptyValueStyle={}))[n.gaps=0]="gaps",n[n.zero=1]="zero",n[n.connect=2]="connect",(l=J=t.SparklineAxisMinMax||(t.SparklineAxisMinMax={}))[l.individual=0]="individual",l[l.group=1]="group",l[l.custom=2]="custom",n=s.Common.ft.j(255,149,179,215),l=s.Common.ft.j(255,36,64,98),b={axisColor:"black",firstMarkerColor:n,highMarkerColor:"Blue",lastMarkerColor:n,lowMarkerColor:"Blue",markersColor:l,negativeColor:"Brown",seriesColor:l,displayEmptyCellsAs:0,rightToLeft:!1,displayHidden:!1,displayXAxis:!1,showFirst:!1,showHigh:!1,showLast:!1,showLow:!1,showNegative:!1,showMarkers:!1,manualMax:0,manualMin:0,maxAxisType:0,minAxisType:0,lineWeight:1},E.prototype.clone=function(){return new E(this.options)},E.prototype.toJSON=function(){var t,n,e,i,t,n=this.options,e={};for(i in n)b[i]!==n[i]&&(e[i]=n[i]);return f(e)?C:e},y=E,t.SparklineSetting=y,(n=K=t.SparklineType||(t.SparklineType={}))[n.line=0]="line",n[n.column=1]="column",n[n.winloss=2]="winloss",(l=X=t.DataOrientation||(t.DataOrientation={}))[l.vertical=0]="vertical",l[l.horizontal=1]="horizontal",j.prototype.tCt=function(){var t=this,n;return n=t.RB?t.RB.Mf:n},j.prototype.ECt=function(){var t,n,t,t=this,n=t.tCt();n&&n.Ut.G8&&(t={group:t,innerList:t.XMt.concat()},n.Ut.aCt(10,t))},j.prototype.add=function(t){var n,e,n=this;t&&(n.ECt(),n.XMt.push(t),t.group(n),n.TCt(),(e=n.RB)&&e.fCt(t),n.onGroupChanged())},j.prototype.clear=function(){this.ECt();var n=this.RB;n&&this.XMt.forEach(function(t){n.cCt(t)}),this.XMt=[]},j.prototype.all=function(){return this.XMt},j.prototype.remove=function(t){var n,e,i,n=this,e=n.XMt;return n.ECt(),g(e,t),t.onSparklineChanged(),t.rCt=n.clone(),n.TCt(),(i=n.RB)&&i.cCt(t),n.onGroupChanged(),e},j.prototype.contains=function(t){return P(this.XMt,t)},j.prototype.onGroupChanged=function(){var t,n,e,t=this.XMt;if(t)for(n=0;n<t.length;n++)(e=t[n])&&e.onSparklineChanged()},j.prototype.clone=function(){var t,n,n,t=this,n=t.setting?t.setting.clone():T,n=new j(t.sparklineType,n);return n.displayDateAxis=t.displayDateAxis,n.qMt=t.qMt,n.nCt=t.nCt,n.jCt=t.jCt,n.eCt=t.eCt,n},j.prototype.dateAxisData=function(t){var n,e,i,i,i,r,i,r,i,o,a,n=this;if(I(n.qMt)||n.OCt(),0===arguments.length)return n.nCt;if((e=n.tCt())&&e.Ut.G8){if("string"==typeof t){if(i=e.getCustomName(t)||e.parent.getCustomName(t),I(i))return n.nCt;i=p.formulaToRanges(e,p.expressionToFormula(e,i.getExpression()),0,0,1===n.tCt().parent.options.referenceStyle),n.qMt=t,r=(i=R(i)).ranges,i=i.sheetName,t=r,n.jCt=i}i=r=void 0,r=n.nCt?{row:n.nCt.row,col:n.nCt.col,rowCount:n.nCt.rowCount,colCount:n.nCt.colCount}:T,i=t?{row:t.row,col:t.col,rowCount:t.rowCount,colCount:t.colCount}:T,e.Ut.aCt(8,o={group:n,rangeInfo:r,newRangeInfo:i})}(a=n.nCt)!==(n.nCt=t)&&n.onGroupChanged()},j.prototype.OCt=function(){var t,n,n,e,n,t=this;I(t.tCt())||(n=lt(t.tCt(),t.qMt),I(n))||(e=(n=R(n)).ranges,n=n.sheetName,t.nCt=e,t.jCt=n)},j.prototype.dateAxisDataSheetName=function(t){var n,e,i,r,n=this;return 0===arguments.length?n.jCt:(e=n.jCt,(i=n.tCt())&&i.Ut.G8&&i.Ut.aCt(16,r={group:n,dateAxisDataSheetName:e,newDateAxisDataSheetName:t}),e!==t&&(e&&i&&i.RB.ICt(n),(n.jCt=t)&&i&&i.RB.ACt(n),n.onGroupChanged()),n)},j.prototype.dateAxisOrientation=function(t){var n,e,i,r,n=this;if(0===arguments.length)return n.eCt;(e=n.tCt())&&e.Ut.G8&&(i={group:n,dateAxisOrientation:n.eCt,newDateAxisOrientation:t},e.Ut.aCt(9,i)),(r=n.eCt)!==(n.eCt=t)&&n.onGroupChanged()},j.prototype.count=function(){return this.XMt.length},j.prototype.TCt=function(){var t,n,e,i,r,o,a,u,u,s,u,t=this,n=t.setting,e=t.XMt;if(n&&((i=n.options).groupMaxValue=-h,i.groupMinValue=h,r=1===i.maxAxisType,o=1===i.minAxisType,r||o))for(a=0;a<e.length;a++)u=e[a],s=(u=t.RCt(u)).min,u=u.max,r&&i.groupMaxValue<u&&(i.groupMaxValue=u),o&&i.groupMinValue>s&&(i.groupMinValue=s)},j.prototype.RCt=function(t){var n,e,i,r,o,a,u,s,c,n=-h,e=h;if(I(t.data())&&t.data(t.gI),i=t.data())for(o=(r=t.Tp())&&r.parent.getSheetFromName(t.dataSheetName()),a=t.BCt(i,t.dataOrientation(),!1,o||r),u=0;u<a.length;u++)"number"==typeof(s=(s=a[u])===G?0:s)&&(n=n<s?s:n,e=s<e?s:e);return{min:e,max:n}},j.prototype.toJSON=function(){var t,n,e,i,r,o,a,t=this,n={setting:t.setting?t.setting.toJSON():T,displayDateAxis:t.displayDateAxis,sparklineType:t.sparklineType,axisOrientation:t.eCt,sparklines:t.XMt.map(function(t){return t.toJSON()})},e=t.nCt,i=t.qMt;for(o in i?n.axisReference=i:e&&(n.axisReference={row:e.row,col:e.col,rowCount:e.rowCount,colCount:e.colCount,sheetName:t.jCt}),r={},n)!n.hasOwnProperty(o)||ft(o,a=n[o])||(r[o]=a);return f(r)?C:r},j.prototype.wh=function(){var t,n,e,i,i,e,t={n_:"sparklineGroup"},n=this,e=n.tCt();return I(n.sparklineType)||(t.type=d[n.sparklineType]),n.displayDateAxis&&(t.dateAxis="1"),i=n.setting.options,!I(i.lineWeight)&&.001<3*i.lineWeight.toString()/4-.75&&(t.lineWeight=3*i.lineWeight.toString()/4),i.displayEmptyCellsAs?t.displayEmptyCellsAs=v[i.displayEmptyCellsAs]:t.displayEmptyCellsAs=v[0],i.showMarkers&&(t.markers="1"),i.showHigh&&(t.high="1"),i.showLow&&(t.low="1"),i.showFirst&&(t.first="1"),i.showLast&&(t.last="1"),i.showNegative&&(t.negative="1"),i.displayXAxis&&(t.displayXAxis="1"),i.displayHidden&&(t.displayHidden="1"),i.rightToLeft&&(t.rightToLeft="1"),i.minAxisType&&(t.minAxisType=m[i.minAxisType]),i.maxAxisType&&(t.maxAxisType=m[i.maxAxisType]),i.manualMin&&(t.manualMin=i.manualMin),i.manualMax&&(t.manualMax=i.manualMax),t.c_=[o(i.seriesColor||"rgba(36,64,98,1.0)",!1,"colorSeries"),o(i.negativeColor||"brown",!1,"colorNegative"),o(i.axisColor||"black",!1,"colorAxis"),o(i.markersColor||"rgba(36,64,98,1.0)",!1,"colorMarkers"),o(i.firstMarkerColor||"rgba(149,179,215,1.0)",!1,"colorFirst"),o(i.lastMarkerColor||"rgba(149,179,215,1.0)",!1,"colorLast"),o(i.highMarkerColor||"blue",!1,"colorHigh"),o(i.lowMarkerColor||"blue",!1,"colorLow")],(i=n.nCt)&&t.c_.push({n_:"f",c_:[(n.jCt?A.IndexHelper.ir(n.jCt):e.name())+"!"+c([x(i.row,i.col,i.rowCount,i.colCount)])]}),e={n_:"sparklines",c_:n.XMt.map(function(t){return t.wh()})},t.c_.push(e),t},j.prototype.fromJSON=function(t,n){var e,i,r,o,a,u,s,c,f;if(t&&(i=t.displayDateAxis,r=t.sparklineType,o=t.axisReference,a=t.axisOrientation,u=t.sparklines,(e=this).setting=new y(t.setting),I(i)||(e.displayDateAxis=i),I(r)||(e.sparklineType=r),I(o)||("string"==typeof o?e.qMt=o:(e.nCt=x(o.row,o.col,o.rowCount,o.colCount),e.jCt=o.sheetName)),I(a)||(e.eCt=a),u))for(e.XMt=[],s=0,c=u.length;s<c;s++)(f=new N).fromJSON(u[s]),e.add(f)},j.prototype.yh=function(t,e){var i,n,n,r,n,r,n,r,n,r,i=this,n=i.LCt(t);i.setting=new y(n),n="1"===t.dateAxis,r=d[t.type]||0,I(n)||(i.displayDateAxis=n),I(r)||(i.sparklineType=r),(n=a(t,"f"))&&(n=(r=n.c_&&n.c_[0])&&r.split("!"))&&(r=u(n[1])[0]||T,I(r)||(i.nCt=x(r.row,r.col,r.rowCount,r.colCount)),n=1===r.rowCount?1:0,I(n)||(i.eCt=n)),(r=a(t,"sparklines"))&&(i.XMt=[],r.c_.forEach(function(t){var n=new N;n.yh(t,e),i.add(n)}))},j.prototype.LCt=function(t){var n={};return I(t.manualMax)||(n.manualMax=e(t.manualMax,0)),I(t.manualMin)||(n.manualMin=e(t.manualMin,0)),I(t.lineWeight)||(n.lineWeight=4*e(t.lineWeight,1)/3),I(t.displayEmptyCellsAs)||(n.displayEmptyCellsAs=v[t.displayEmptyCellsAs]||0),I(t.markers)||(n.showMarkers=i(t.markers,!1)),I(t.high)||(n.showHigh=i(t.high,!1)),I(t.low)||(n.showLow=i(t.low,!1)),I(t.first)||(n.showFirst=i(t.first,!1)),I(t.last)||(n.showLast=i(t.last,!1)),I(t.negative)||(n.showNegative=i(t.negative,!1)),I(t.displayXAxis)||(n.displayXAxis=i(t.displayXAxis,!1)),I(t.displayHidden)||(n.displayHidden=i(t.displayHidden,!1)),I(t.rightToLeft)||(n.rightToLeft=i(t.rightToLeft,!1)),I(t.minAxisType)||(n.minAxisType=m[t.minAxisType]||0),I(t.maxAxisType)||(n.maxAxisType=m[t.maxAxisType]||0),t.c_.forEach(function(t){"colorSeries"===t.n_&&(n.seriesColor=r(t)||"rgba(36,64,98,255)"),"colorNegative"===t.n_&&(n.negativeColor=r(t)||"Brown"),"colorAxis"===t.n_&&(n.axisColor=r(t)||"Black"),"colorMarkers"===t.n_&&(n.markersColor=r(t)||"rgba(36,64,98,255)"),"colorFirst"===t.n_&&(n.firstMarkerColor=r(t)||"rgba(149,179,215,255)"),"colorLast"===t.n_&&(n.lastMarkerColor=r(t)||"rgba(149,179,215,255)"),"colorHigh"===t.n_&&(n.highMarkerColor=r(t)||"Blue"),"colorLow"===t.n_&&(n.lowMarkerColor=r(t)||"Blue")}),n},w=j,O.prototype.group=function(t){var n,e,e,i,r,n=this;return 0===arguments.length?((e=n.rCt)||((e=new w).add(n),n.rCt=e),e):(e=n.rCt,(i=n.Tp())&&i.Ut.G8&&(r={row:n.row,col:n.column,group:e,newGroup:t},i.Ut.aCt(11,r)),t!==e&&(e&&e.remove(n),(n.rCt=t)&&!t.contains(n)&&t.add(n),n.onSparklineChanged()),i&&i.zw(),n)},O.prototype.sparklineType=function(t){var n,e,i,e,i,n=this;return 0===arguments.length?n.group().sparklineType:((i=(e=n.group()).sparklineType)!==t&&(e.sparklineType=t,(e=n.Tp())&&e.Ut.G8&&(i={row:n.row,col:n.column,sparklineType:i,newSparklineType:t},e.Ut.aCt(3,i)),n.onSparklineChanged(),e)&&e.zw(),n)},O.prototype.onSparklineChanged=function(){var t,n,t=this,n=t.Tp();n&&n.ki(A.Events.SparklineChanged,{sheet:n,sheetName:n.name(),sparkline:t})},O.prototype.setting=function(t){var n,e,i,r,o,r,n=this,e=n.group(),i=n.Tp(),r=i&&i.Ut.G8;return 0===arguments.length?(o=void 0,r?A.GC$.extend(!0,{},e.setting):e.setting):(r&&(r={row:n.row,col:n.column,setting:A.GC$.extend(!0,{},e.setting),newSetting:A.GC$.extend(!0,{},t)},i.Ut.aCt(4,r)),e.setting=t,i&&i.zw(),n)},O.prototype.data=function(t){var n,e,i,r,i,r,i,r,n=this;if(I(n.gI)||n.FCt(),e=n.Tp(),0===arguments.length)return I(n.gI)?n._data:I(e)||(i=e.getCustomName(n.gI)||e.parent.getCustomName(n.gI),I(i))?[]:((r=p.formulaToRanges(e,p.expressionToFormula(e,i.getExpression()),n.row,n.column,1===e.parent.options.referenceStyle))[0]&&n._data!==r[0].ranges&&(n._data=r[0].ranges,n.onSparklineChanged()),n._data);if("string"==typeof t){if(n.gI=t,!e)return n;if(i=e.getCustomName(t)||e.parent.getCustomName(t),r=void 0,I(i))return n;r=(i=R(r=p.formulaToRanges(e,p.expressionToFormula(e,i.getExpression()),n.row,n.column,1===e.parent.options.referenceStyle))).ranges,i=i.sheetName,t=r,n.ZY=i}return e&&e.Ut.G8&&(r={row:n.row,col:n.column,sparkline:n,data:A.GC$.extend(!0,{},n._data),newData:A.GC$.extend(!0,{},t)},e.Ut.aCt(5,r)),n._data!==t&&(n._data=t,n.onSparklineChanged()),e&&e.zw(),n},O.prototype.dataSheetName=function(t){var n,e,i,r,n=this;return 0===arguments.length?n.ZY:(e=n.ZY,(i=n.Tp())&&i.Ut.G8&&(r={row:n.row,col:n.column,dataSheetName:e,newDataSheetName:t},i.Ut.aCt(15,r)),e!==t&&(e&&i&&i.RB.cCt(n),(n.ZY=t)&&i&&i.RB.fCt(n),n.onSparklineChanged()),n)},O.prototype.dataOrientation=function(t){var n,e,i,n=this;return 0===arguments.length?n.iCt:((e=n.Tp())&&e.Ut.G8&&(i={row:n.row,col:n.column,dataOrientation:n.iCt,newDataOrientation:t},e.Ut.aCt(6,i)),n.iCt!==t&&(n.iCt=t,n.onSparklineChanged()),e&&e.zw(),n)},O.prototype.dateAxisData=function(t){var n=this,e=n.group();return 0===arguments.length?(I(e.dateAxisData())&&e.dateAxisData(e.qMt),e.dateAxisData()):(e.dateAxisData(t),n)},O.prototype.dateAxisDataSheetName=function(t){var n=this,e=n.group();return 0===arguments.length?e.dateAxisDataSheetName():(e.dateAxisDataSheetName(t),n)},O.prototype.dateAxisOrientation=function(t){var n=this,e=n.group();return 0===arguments.length?e.dateAxisOrientation():(e.dateAxisOrientation(t),n)},O.prototype.displayDateAxis=function(t){var n,e,i,r,n=this,e=n.group();return 0===arguments.length?e.displayDateAxis:((i=n.Tp())&&i.Ut.G8&&(r={row:n.row,col:n.column,displayDateAxis:e.displayDateAxis,newDisplayDateAxis:t},i.Ut.aCt(7,r)),e.displayDateAxis=t,n)},O.prototype.clone=function(){var t,n,t=this,n=new O;return n.row=t.row,n.column=t.column,I(t.gI)?n.data(t.data()):n.gI=t.gI,n.dataSheetName(t.dataSheetName()),n.dataOrientation(t.dataOrientation()),n.group(t.group().clone()),n},O.prototype.paintSparkline=function(t,n,e,i,r){var o,a,u,s,c,f,c,o=this,a=o.Tp();this.XY&&(a=this.XY),I(o.data())&&o.data(o.gI),I(o.dateAxisData())&&o.dateAxisData(o.group().qMt),c=o.PCt(!0),f=o.PCt(!1),c={sparklineType:o.sparklineType(),displayDateAxis:o.displayDateAxis(),zoomFactor:a.zoom(),values:c,dateValues:f,settings:o.setting(),getColor:function(t){if(a&&t){var n=A.Pf.vl(a,t);if(n)return n}return t}},(new U).paint(t,c,n,e,i,r)},O.prototype.PCt=function(t){var n,e,i,r,o,a,u,s,c,f,l,h,n=this,e=[],i=t?n.dataSheetName():n.dateAxisDataSheetName(),r=t?n.WY:n.KY,o=t?n.dataOrientation():n.dateAxisOrientation(),a=t?n.data():n.dateAxisData(),s=n.Tp();if(this.XY&&(s=this.XY),r)e=r;else if("string"==typeof i)c=n.GCt(s,i),e=n.BCt(a,o,!t,c||s);else if("object"==typeof i)for(f=i,l=0;l<f.length;l++)c=n.GCt(s,f[l]),h=n.BCt(a[l],o,!t,c||s),e=e.concat(h);else I(i)&&(e=n.BCt(a,o,!t,s));return e},O.prototype.GCt=function(t,n){var e,t,i=/^\[\d+\].+/g,e=t.parent.getSheetFromName(n),t=t.parent._p;return e=i.test(n)&&t?t.parseSource(n,!0):e},O.prototype.QY=function(t){var n=this;return I(n.data())&&n.data(n.gI),n.BCt(n.data(),n.dataOrientation(),!1,t)},O.prototype.JY=function(t){var n=this;return I(n.dateAxisData())&&n.dateAxisData(n.group().qMt),n.BCt(n.dateAxisData(),n.dateAxisOrientation(),!0,t)},O.prototype.BCt=function(t,n,e,i){var r,o=this.setting().options.displayHidden;return O.EMt(C,i,o,t,n,e)},O.prototype.Tp=function(){var t=this.group(),t=t&&t.RB;return t?t.Mf:T},O.prototype.toJSON=function(){var t,n,t=this,n=I(t.gI)?{row:t._data.row,rowCount:t._data.rowCount,col:t._data.col,colCount:t._data.colCount,sheetName:t.ZY}:t.gI;return{row:t.row,col:t.column,orientation:t.iCt,data:n}},O.prototype.wh=function(){var t,n,e,n,i,t=this,n=t.Tp(),e=t._data,n=I(t.gI)?(i=A.IndexHelper.ir(t.ZY||n.name()))+"!"+c([x(e.row,e.col,e.rowCount,e.colCount)]):t.gI;return{n_:"sparkline",c_:[{n_:"f",c_:[z(n)]},{n_:"sqref",c_:[c([x(t.row,t.column,1,1)])]}],lossless:{iCt:t.iCt}}},O.prototype.fromJSON=function(t){var n,e,i,r,t,e;t&&(n=this,e=t.row,i=t.col,r=t.orientation,t=t.data,I(e)||(n.row=e),I(i)||(n.column=i),I(r)||(n.iCt=r),t)&&("string"==typeof t?n.gI=t:(n._data=x((e=t).row,e.col,e.rowCount,e.colCount),n.ZY=e.sheetName))},O.prototype.yh=function(t,n){var e,i,r,o,n,e=this,n=A.Util.ko(n)?void 0:1;t.c_.forEach(function(t){"f"===t.n_&&(1===(o=V(t.c_[0]).split("!")).length?e.gI=o[0]:i=u(o[1])[0]||T),"sqref"===t.n_&&(r=u(t.c_[0])[0]||T)}),I(r)||(I(r.row)||(e.row=r.row),I(r.col)||(e.column=r.col),i&&(n=1===i.rowCount?1:0,e._data=x(i.row,i.col,i.rowCount,i.colCount),e.ZY=o[0])),I(n)||(e.iCt=n),t.lossless&&(e.iCt=t.lossless.iCt)},O.prototype.FCt=function(){var t,n,n,e,n,t=this;I(t.Tp())||(n=lt(t.Tp(),t.gI),I(n))||(e=(n=R(n)).ranges,n=n.sheetName,t._data=e,t.ZY=n)},O.EMt=function(t,n,e,i,r,o){var a,u,a=[];if(!I(i)){if(!(i instanceof Array))return O.UCt(t,n,e,i,r,o);for(u=0;u<i.length;u++)a.push.apply(a,O.UCt(t,n,e,i[u],r,o,!0))}return a},O.UCt=function(t,n,e,i,r,o,a){var u,s,c,f,l,h,d,v,m,u=[],s=1===r;if(n&&i)for(c=0,f=a?s?i.rowCount:i.colCount:1;c<f;c++)for(l=0,h=s?i.colCount:i.rowCount;l<h;l++)d=s?c:l,v=s?l:c,m=t?t[d][v]:n.getValue(i.row+d,i.col+v),m=O.HCt(n,m,i,d,v,e,o),u.push(m);return u},O.HCt=function(t,n,e,i,r,o,a){var u="number";return n instanceof L.CalcError?C:(!o&&t.getRowHeight&&(t.getRowHeight(e.row+i)<=0||t.getColumnWidth(e.col+r)<=0)?n=NaN:I(n)||(a?n=typeof n==u?s.Common.ct.Y0(n):Date.parse(n):typeof n!=u&&(n=G)),n)},N=O,t.Sparkline=N},"./dist/plugins/statusBar/baseStatusBar.js":function(t,n,e){"use strict";var i,r,o,a,l,u,h,s;function c(t){this.zCt=[],this.VCt=[],this.YCt=[],this.lp=0,this.Ti=l,this.TW=t,this.ZCt()}Object.defineProperty(n,"__esModule",{value:!0}),n.BaseStatusBar=void 0,i=e("Core"),r=e("./dist/plugins/statusBar/statusItem.js"),o=i.GC$,a="statusItem",l=null,u="left",h="right",c.prototype.ZCt=function(){var t=this.Ti,n=this.WCt;t||(t=this.Ti=document.createElement("div"),n=this.WCt=document.createElement("div")),this.TW.appendChild(t),this.TW.appendChild(n)},c.prototype.QCt=function(t){t.name||(t.name=a+this.lp,this.lp++)},c.prototype.dU=function(t,n){return t instanceof r.StatusItem&&!this.q_(t.name)&&(this.QCt(t),0<=n&&n<this.zCt.length?this.zCt.splice(n,0,t):this.zCt.push(t),t.align=t.align||u,t.KCt(this.TW),!0)},c.prototype.JCt=function(n,t){var e,i,r,o,a,r,u,s,c,f,e=!1,i=this.zCt,r=0<=t&&t<i.length,o=l,a=l;if(r&&(a=(o=i[t]).XCt()),this.dU(n,t)){r=n.align===h;try{(r?(s=(u=this.YCt).indexOf(o),f=(c=u.length)-1,a&&0<=s&&s<f?a=u[s+1].XCt():a===l?a=u[0].XCt():(a&&s<0||s===f)&&(a=l),this.YCt):this.VCt).push(n),this.Ti.insertBefore(n.XCt(),a),this.DJ&&n.onBind(this.DJ),e=!0}catch(t){r?this.YCt.splice(this.YCt.indexOf(n),1):this.VCt.splice(this.VCt.indexOf(n),1),this.zCt.splice(this.zCt.indexOf(n),1)}}return e},c.prototype.qCt=function(t){for(var n=this.zCt,e=!1,i,r,i=0;i<n.length;i++)if(t===(r=n[i]).name){e=!0;break}return!!e&&(r.onUnbind(),r.align===h?this.YCt.splice(this.YCt.indexOf(r),1):this.VCt.splice(this.VCt.indexOf(r),1),this.zCt.splice(i,1),this.Ti.removeChild(r.XCt()),!0)},c.prototype.q_=function(t){for(var n=this.zCt,e,i,e=0;e<n.length;e++)if(t===(i=n[e]).name)return i;return l},c.prototype.$Ct=function(n){this.DJ=n,this.zCt.forEach(function(t){t.onBind(n),t.onUpdate()})},c.prototype.Yoe=function(){this.zCt.forEach(function(t){t.Zoe()})},c.prototype.c5=function(){this.VCt=[],this.YCt=[],o(this.Ti).empty()},c.prototype.t3t=function(){var n=this,e=this.Ti,i=u,r;this.c5(),this.zCt.forEach(function(t){i=t.align,((r=t.XCt()).style.float=i)===h?n.YCt.unshift(t):(n.VCt.unshift(t),e.appendChild(r))}),this.YCt.forEach(function(t){e.appendChild(t.XCt())})},c.prototype.n3t=function(){this.zCt.forEach(function(t){t.onUpdate()}),this.t3t()},c.prototype.e3t=function(){var n=[];return this.zCt.forEach(function(t){n.push(t.i3t())}),n},c.prototype.r3t=function(t){for(var n=this.zCt,e=t.name,i,r,i=0;i<n.length;i++)if((r=n[i]).name===e){r.r3t(t);break}},c.prototype.o3t=function(){return this.zCt},c.prototype.a3t=function(){var t,n=this.zCt,e,i;for(this.DJ=l,e=0;e<n.length;e++)(i=n[e]).onUnbind()},c.prototype.L0=function(){var t=this,n=t.zCt,e,i;if(this.Ti){for(e=0;e<n.length;e++)i=n[e],t.Ti.removeChild(i.u3t),i.onDispose();this.Ti.parentElement&&this.Ti.parentElement.removeChild(this.Ti),this.WCt.parentElement&&this.WCt.parentElement.removeChild(this.WCt),this.Ti=l,this.WCt=l}this.lp=l,this.zCt=l,this.VCt=l,this.YCt=l},n.BaseStatusBar=c},"./dist/plugins/statusBar/statusBar.entry.js":function(t,n,e){"use strict";var i,r,o,a,u,s,i=this&&this.__createBinding||(Object.create?function(t,n,e,i){void 0===i&&(i=e);var r=Object.getOwnPropertyDescriptor(n,e);r&&("get"in r?n.__esModule:!r.writable&&!r.configurable)||(r={enumerable:!0,get:function(){return n[e]}}),Object.defineProperty(t,i,r)}:function(t,n,e,i){t[i=void 0===i?e:i]=n[e]}),r=this&&this.__exportStar||function(t,n){for(var e in t)"default"===e||Object.prototype.hasOwnProperty.call(n,e)||i(n,t,e)};Object.defineProperty(n,"__esModule",{value:!0}),n.findControl=n.StatusItem=n.StatusBar=void 0,o=e("Core"),a=e("./dist/plugins/statusBar/statusBar.js"),Object.defineProperty(n,"StatusBar",{enumerable:!0,get:function(){return a.StatusBar}}),u=e("./dist/plugins/statusBar/statusItem.js"),Object.defineProperty(n,"StatusItem",{enumerable:!0,get:function(){return u.StatusItem}}),r(e("./dist/plugins/statusBar/statusBar.ns.js"),n),n.findControl=s=function(t){return"string"==typeof t&&(t=document.getElementById(t)),(0,o.GC$)(t).data("statusbar")}},"./dist/plugins/statusBar/statusBar.js":function(B,L,t){"use strict";var n,f,i,u,p,e,F,r,P,h,t,d,G,t,U,b,t,y,w,H,o,a,z,V,Y,Z,W,Q,J,K,X,q,$,tt,nt,et,v,it,rt,ot,at,ut,st,ct,ft,lt,m,ht,g,dt,vt,mt,gt,pt,bt,yt,wt,Mt,Ct,St,Tt,At,It,xt,Nt,kt,Dt,_t,M,C,s,Et,S,jt,Ot,Rt,Bt,c,Lt,Ft,Pt,Gt,Ut,Ht,zt,Vt,Yt,Zt,Wt,Qt,T,l,Jt,Kt,a,A,Xt,I,qt,$t,tn,nn,en,rn,on,x,an,un,sn,cn;function N(t,n){var e=i.Common.CultureManager.Fe().NumberFormat.listSeparator;return Qt+Vt+t+e+n+Yt}function fn(t,n){t.splice(n,1)}function ln(t,n){var e,i,r,o,e=n,i=n.length,r=[];if(1<i){for(r.push(n[0]),o=1;o<i;o++)r=hn(t,n[o],r);return r}return e}function hn(t,n,e){var i,r,o,a,u,s,c,f,l,h,i=t.getRowCount(3),r=t.getColumnCount(3),o=[],a=[];for(o.push(n),f=e.length,l=0;l<f;l++)for(u=e[l],h=0;h<o.length;)(c=(s=o[h]).getIntersect(u,i,r))?(a=t.BR(s,c,i,r),fn(o,h),o=a.concat(o),h+=a.length):h++;return o.concat(e)}function dn(t){var n,e,i,r,o,a,u,s,c,f,l,h,d,v,n=t.getActiveRowIndex(),e=t.getActiveColumnIndex(),i=t.getValue(n,e);if("number"!=typeof i)for(s=0,c=r=t.getSelections();s<c.length;s++)for(f=c[s],l=0,h=(f=t.JS(f)).rowCount;l<h;l++)for(d=0,v=f.colCount;d<v;d++)if(o=f.row+l,a=f.col+d,"number"==typeof(u=t.getValue(o,a)))return{row:o,col:a};return{row:n,col:e}}function vn(t,n,e){var i,i;return i=(i=t.l0(n,e,Zt))||t.l0(n,e,Wt)}function mn(t){var n=t;return n=0<t&&t<=4?Math.floor(+parseFloat((100*t).toPrecision(12))):n}function gn(t,n,e){var i;t&&t.parent&&t.parent.options.allowUserZoom&&(i={sheet:t,sheetName:t.name(),newZoomFactor:n,oldZoomFactor:e,cancel:!1},t.ki(f.Events.ViewZooming,i),!0!==i.cancel)&&(n=i.newZoomFactor)!==e&&(t.Qy().execute({cmd:s,sheetName:t.name(),newZoomFactor:n,oldZoomFactor:e}),yn(t,n,e))}function pn(t){for(var n,e,t,i,t,n={top:t.offsetTop,left:t.offsetLeft},e=t.offsetParent;e;)n.top+=e.offsetTop,n.left+=e.offsetLeft,e=e.offsetParent;return i=(t=document.body).clientTop,t=t.clientLeft,isNaN(i)||(n.top+=i),isNaN(t)||(n.left+=t),n}function bn(t){return""!==t}function k(t,n){var t=on.call(this,t,n)||this;return t.s3t=c+t.name,t}function D(t,n){var t=x.call(this,t,n)||this;return t.c3t=": ",t.FJ=!1,t.vit=n.prefix,t.s3t=c+t.name,t.f3t=Number.MAX_VALUE,t}function _(t,n,e){var a=an.call(this,n,e)||this;return a.min=25,a.max=400,a.middle=100,a.step=10,a.h3t=1,a.d3t=4,a.v3t=120,a.m3t=Math.round((a.v3t+a.h3t)/2),a.g3t=Math.round((a.v3t+a.d3t)/2),a.p3t=!1,a.Sfe=function(t){a.p3t=!1},a.Tfe=function(t){var n,e,t,i,e,r,o,n=a;n.p3t&&(e=a.P3t,t=t.pageX,i=pn(e).left,e=e.offsetWidth,r=n.d3t,n.H3t(o=i+e+r-t))},a.b3t=t,a.s3t=c+a.name,a}function E(t,n){var t=un.call(this,t,n)||this;return t.s3t=c+t.name,t}function j(t,n){var t=sn.call(this,t,n)||this;return t.s3t=c+t.name,t.YC=120,t.y4=0,t}function yn(t,n,e){t.ki(f.Events.UserZooming,{sheet:t,sheetName:t.name(),oldZoomFactor:e,newZoomFactor:n}),t.ki(f.Events.ViewZoomed,{sheet:t,sheetName:t.name(),oldZoomFactor:e,newZoomFactor:n})}function wn(t,n){(t.DJ=n).bind(f.Events.ActiveSheetChanged+t.s3t,function(){t.onUpdate()})}function Mn(t){var n,n;r.StatusItem.prototype.onUpdate.call(t),n=(n=(0,f.jf)(t.DJ))?n.zoom():1,t.Xe(n)}function Cn(t){t.DJ&&(t.DJ.unbind(f.Events.ActiveSheetChanged+t.s3t),t.DJ=w)}function O(t,n){var e,i;t&&(i=(e=this).y3t=new P.BaseStatusBar(t),e.w3t(i,n),e.Ti=i.Ti,this.WCt=i.WCt,e.M3t={},e.C3t(t),e.maxCalcCells=5e4,h(t).data("statusbar",e))}function Sn(){l&&Jt.call(this)}function R(t,n){var e=cn.call(this)||this;return e.Mf=t,e.S3t=n,e}function Tn(t){var t=t.b3t;t&&t.Yoe()}n=this&&this.__extends||(rn=function(t,n){return(rn=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(t,n){t.__proto__=n}:function(t,n){for(var e in n)Object.prototype.hasOwnProperty.call(n,e)&&(t[e]=n[e])}))(t,n)},function(t,n){if("function"!=typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function e(){this.constructor=t}rn(t,n),t.prototype=null===n?Object.create(n):(e.prototype=n.prototype,new e)}),Object.defineProperty(L,"__esModule",{value:!0}),L.StatusBar=void 0,f=t("Core"),i=t("Common"),u=t("CalcEngine"),p=t("SheetsCalc"),e=t("ContextMenu"),F=t("./dist/plugins/statusBar/statusBar.ns.js"),r=t("./dist/plugins/statusBar/statusItem.js"),P=t("./dist/plugins/statusBar/baseStatusBar.js"),h=f.GC$,t=f.mt,d=t.En,G=t.vi,t=i.Common.lt,U=i.Common.zf.I5,b=t.ht,t=f.Commands.ActionBase,y=u.Convert.BJ,w=null,H=h.inherit,z=(o="gc-statusbar-")+(a="slider-")+"btn",V=o+a+"add-btn",Y=o+a+"back-progress",Z=o+a+"back",W=o+a+"middle-line",Q=o+a+"drag-bar",J=o+"zoom-panel",K=o+a+"btn-container",X=o+a+"add-btn-container",q="gc-statusbar",$=o+"menu-host",tt="gc.spread.",nt="100",et="%",v="px",it="cellMode",ft="zoomSlider",lt="zoomPanel",m="div",ht="span",g="none",dt="inline",vt="inline-block",mt=15,gt=25,pt=400,yt=bt=100,Mt=1,Ct=4,St=120,Tt=.7,At=8,It=wt=10,xt=o+"progress-item-item-container",Nt=o+"progress-item-wrapper",kt=o+"progress-item-bar",Dt=o+"progress-item-status",_t=o+"progress-item-sheet-name",M="progress",C="right",s="statusbarZoom",Et="statusBar",S="click",jt="mousedown",Ot="mouseup",Rt="mousemove",Bt="contextmenu",c=".statusbar",Lt="invalidateLayout",Ft=101,Pt=103,Gt=102,Ut=105,Ht=104,zt=109,Vt="(",Yt=")",Zt="formatter",Wt="_autoFormatter",Qt="_SUBTOTALFORSTATUSBAR",T=[rt="average",ot="count",at="numericalCount",ut="min",st="max",ct="sum"],l=!!e,e&&(Jt=e.MenuView,Kt=e.XX),a=new i.Common.ResourceManager(F.SR,"StatusBar"),A=a.getResource.bind(a),on=r.StatusItem,n(k,on),k.prototype.onBind=function(t){var e=this,i;(e.DJ=t).bind(f.Events.EditorStatusChanged+e.s3t,function(t,n){i=e.T3t(n.newStatus),e.A3t(i)}),t.bind(f.Events.ActiveSheetChanged+e.s3t,function(){e.onUpdate()})},k.prototype.onUpdate=function(){var t,t,t;on.prototype.onUpdate.call(this),(t=(0,f.jf)(this.DJ))&&(t=t.editorStatus(),t=this.T3t(t),this.A3t(t))},k.prototype.T3t=function(t){var n;switch(t){case 0:n=A().cellModeReady;break;case 1:n=A().cellModeEnter;break;case 2:n=A().cellModeEdit}return n},k.prototype.A3t=function(t){var t;t!==this.value&&(this.value=t,this.tipText=U(A().toolTipCellMode,[t]),t=this.I3t)&&(t.parentElement.title=this.tipText,b(this.value)||(t.innerText=this.value+""))},k.prototype.onUnbind=function(){this.DJ&&(this.DJ.unbind(f.Events.EditorStatusChanged+this.s3t),this.DJ.unbind(f.Events.ActiveSheetChanged+this.s3t),this.DJ=w)},Xt=k,x=r.StatusItem,n(D,x),D.prototype.Zoe=function(){this.l3t={}},D.prototype.onBind=function(t){var r=this;r.DJ=t,r.Zoe(),t.bind(f.Events.SelectionChanging+r.s3t,function(t,n){r.x9=n.newSelections,r.x3t(n)}),t.bind(f.Events.SelectionChanged+r.s3t,function(t,n){var e=r.x9||[],i=n.newSelections;JSON.stringify(e)!==JSON.stringify(i)&&r.x3t(n),r.x9=w}),t.bind(f.Events.ValueChanged+r.s3t,function(t,n){var e=n.sheet,i=n.row,n=n.col;e.ni(i,n)&&r.onUpdate()}),t.bind(f.Events.RangeChanged+r.s3t,function(){r.onUpdate()}),t.bind(f.Events.DragFillBlockCompleted+r.s3t,function(){r.onUpdate()}),t.bind(f.Events.ActiveSheetChanged+r.s3t,function(){r.onUpdate()}),t.bind(f.Events.EditEnded+r.s3t,function(){r.Zoe()}),t.bind(f.Events.TopRowChanged+r.s3t,function(){r.N3t(!0)}),t.bind(f.Events.ColumnWidthChanged+r.s3t,function(){r.N3t(!0)}),t.bind(f.Events.RowHeightChanged+r.s3t,function(){r.N3t(!0)}),t.bind(f.Events.RowChanged+r.s3t,function(){r.N3t(!1)}),t.bind(f.Events.ColumnChanged+r.s3t,function(){r.N3t(!1)}),t.bind(f.Events.RangeFiltered+r.s3t,function(){r.N3t(!1)}),t.bind(f.Events.TableFiltered+r.s3t,function(){r.N3t(!1)}),t.bind(f.Events.TableFilterCleared+r.s3t,function(){r.N3t(!1)}),t.bind(f.Events.RangeFilterCleared+r.s3t,function(){r.N3t(!1)})},D.prototype.N3t=function(t){this.FJ=t},D.prototype.k3t=function(t){var n,e,n=(0,f.jf)(this.DJ),e=0;return t.forEach(function(t){var t=n.JS(t);e+=t.rowCount*t.colCount}),e<this.f3t},D.prototype.x3t=function(t){var n,e,t,i,t,n=this,e=t.sheet,t=t.newSelections;n.k3t(t)?1===t.length&&1===t[0].rowCount&&1===t[0].colCount?(i=n.D3t(e,w),n.A3t(i[n.name])):""!==(t=n._3t(ln(e,t)))?(i=n.D3t(e,t),n.A3t(i[n.name])):b(n.value)&&n.E3t(!1):n.A3t(w)},D.prototype.D3t=function(t,n){var e,i,r,o,a,u,s,c,f,l,e,h,d,i,v,m,v,g,t,m,v,e=this,i=p.evaluateFormula,r=0,o=w,a=w,u=w,s=w,c=w;return n&&(l=(f=e.l3t)[n],!e.FJ||b(l)?(e.N3t(!1),1<(r=i(t,N(103,n)))&&0<(o=i(t,N(102,n)))&&(e=i(t,N(101,n)),h=i(t,N(105,n)),d=i(t,N(104,n)),i=i(t,N(109,n)),y(e)||y(h)||y(d)||y(i)||(m=(v=dn(t)).row,v=v.col,g=t.getCellType(m,v),t=vn(t,m,v),u=g.format(e,t,m={}),s=g.format(h,t,m),c=g.format(d,t,m),a=g.format(i,t,m))),f[n]={average:u,numericalCount:o,minimum:s,maximum:c,sum:a,count:r}):(u=l.average,o=l.numericalCount,s=l.minimum,c=l.maximum,a=l.sum,r=l.count)),(v={}).average=u,v.numericalCount=0<o?o:w,v.min=s,v.max=c,v.sum=a,v.count=1<r?r:w,v},D.prototype.E3t=function(t){this.u3t&&(this.u3t.style.display=t?vt:g)},D.prototype.A3t=function(t){var n=this.c3t,e=this.I3t,i=this.vit,r=this.visible,o=!1;this.value=t,e.innerText=i+n+t,!b(t)&&r&&(o=!0),this.E3t(o)},D.prototype.FM=function(t){var n,t;t&&(n=t.menuContent,t=t.tipText,this.menuContent=n,this.vit=n,this.tipText=t,this.u3t.title=t)},D.prototype.onUpdate=function(){var t,n,e,i,e,n;x.prototype.onUpdate.call(this),(n=(0,f.jf)((t=this).DJ))&&(e=n.getSelections(),t.k3t(e))?1===e.length&&1===e[0].rowCount&&1===e[0].colCount?(i=t.D3t(n,w),t.A3t(i[t.name])):""!==(e=t._3t(ln(n,e)))?(n=(i=t.D3t(n,e))[t.name],!b(n)&&n===t.value||(t.value=n,t.A3t(n))):b(t.value)&&t.E3t(!1):t.A3t(w)},D.prototype.onUnbind=function(){var t=this.DJ,n=this.s3t;t&&(t.unbind(f.Events.SelectionChanging+n),t.unbind(f.Events.SelectionChanged+n),t.unbind(f.Events.ValueChanged+n),t.unbind(f.Events.RangeChanged+n),t.unbind(f.Events.DragFillBlockCompleted+n),t.unbind(f.Events.ActiveSheetChanged+n),t.unbind(f.Events.EditEnded+n),t.unbind(f.Events.TopRowChanged+n),t.unbind(f.Events.ColumnWidthChanged+n),t.unbind(f.Events.RowHeightChanged+n),t.unbind(f.Events.RowChanged+n),t.unbind(f.Events.ColumnChanged+n),t.unbind(f.Events.RangeFiltered+n),t.unbind(f.Events.TableFiltered+n),t.unbind(f.Events.TableFilterCleared+n),t.unbind(f.Events.RangeFilterCleared+n),this.DJ=w)},D.prototype._3t=function(t,n,e,i,r){var o,a,o=this.j3t;return o=o||(this.j3t=new u.Parser),a=(a=this.x3)||(this.x3=new p.SheetParserContext(w,!!r,(0,u.eV)(n,e))),p.Ibt(o,a,t,n,e,i,!0)},D.prototype.onDispose=function(){x.prototype.onDispose.call(this),this.j3t=w,this.l3t=w,this.x3&&(this.x3.L0(),this.x3=w)},I=D,an=r.StatusItem,n(_,an),_.prototype.onCreateItemView=function(t){var i,n,e,r,o,a,u,s,c,f,l,i=this,n=i.ZC,e=n+v;t.style.display=this.visible?dt:g,r=(r=this.O3t)||(this.O3t=d(m)),h(r).addClass(K),r.style.height=e,r.style.lineHeight=e,(o=(o=this.R3t)||(this.R3t=d(m))).title=A().toolTipZoomOut,h(o).addClass(z),o.style.height=e,h(o).bind(S,function(){i.B3t(!1)}),a=(a=this.L3t)||(this.L3t=d(m)),h(a).addClass(X),a.style.height=e,a.style.lineHeight=e,(u=(u=this.F3t)||(this.F3t=d(m))).title=A().toolTipZoomIn,h(u).addClass(V),u.style.height=e,h(u).bind(S,function(){i.B3t(!0)}),s=(s=this.P3t)||(this.P3t=d(m)),h(s).addClass(Y),s.style.marginTop=Math.floor(n/2+1)+v,h(s).bind(S,function(){return!1}),c=(c=this.G3t)||(this.G3t=d(m)),h(c).addClass(W),c.style.top=Math.floor((n-8)/2+1)+v,c.style.left=i.m3t+v,(f=(f=this.U3t)||(this.U3t=d(m))).title=A().toolTipSlider,h(f).addClass(Q),f.style.top=Math.floor((n-10)/2+1)+v,f.style.right=i.g3t+v,h(f).bind(jt,function(){i.p3t=!0}),document.addEventListener(Ot,i.Sfe),document.addEventListener(Rt,i.Tfe),(l=(l=this.z3t)||(this.z3t=d(m))).title=A().toolTipSlider,h(l).addClass(Z),l.style.height=e,l.style.lineHeight=e,h(l).bind(S,function(t){var n,t,n,e,n=t.target;n!==f&&(t=n===c?i.g3t:(n=t.offsetX,(e=l.offsetWidth)-n),i.H3t(t))}),r.appendChild(o),t.appendChild(r),l.appendChild(c),l.appendChild(s),l.appendChild(f),t.appendChild(l),a.appendChild(u),t.appendChild(a)},_.prototype.ZS=function(){this.DJ&&this.DJ.focus()},_.prototype.onBind=function(t){wn(this,t)},_.prototype.onUpdate=function(){Mn(this)},_.prototype.B3t=function(t){var n,e,i,n=this,e=this.value;e%10==0?e=t?e+this.step:e-this.step:(i=e/10,e=t?Math.ceil(i):Math.floor(i),e*=10),e=(e=e>this.max?this.max:e)<this.min?this.min:e,n.V3t(e)},_.prototype.H3t=function(t){var n,t,e,i,r,o,a,u,s,r,c,n=this;(t=t<0?0:t)>n.v3t&&(t=n.v3t+n.d3t),e=n.value/100,i=n.g3t,r=n.v3t,o=3*n.d3t/2,a=n.min,u=n.middle,s=n.max,(r=t<=i?(i-t)/i*(s-u)+u:(r-t+o)/i*(u-a)+a)<=a+5?r=a:s-5<=r&&(r=s),t=r/100,gn(c=(0,f.jf)(this.DJ),t,e),n.ZS()},_.prototype.V3t=function(t){var n;t&&(t=mn(t),gn((0,f.jf)(this.DJ),t/100,this.value/100),this.ZS())},_.prototype.Y3t=function(t){var n=this,e=n.min,i=n.middle,r=n.max,o=n.d3t,a=n.g3t,n=n.v3t,e,e=t<=i?(t-e)/(i-e)*a-o/2:(t-i)/(r-i)*a+a-o/2;this.Z3t(e=n-e)},_.prototype.Z3t=function(t){var n,e,i,r,n=this,e=n.d3t/2,i=n.d3t;t<=i?t+=i:t<n.v3t&&(t+=e),(r=n.U3t).style.right=t+v},_.prototype.Xe=function(t){(t=t&&mn(t))!==this.value&&(this.value=parseInt(t+"",10),this.Y3t(this.value))},_.prototype.W3t=function(t){return t===this.P3t||t===this.G3t||t===this.U3t||t===this.z3t},_.prototype.Q3t=function(t){var t=t.target;this.W3t(t)&&this.K3t(.7)},_.prototype.J3t=function(t){var t=t.target;this.W3t(t)&&this.K3t(1)},_.prototype.K3t=function(t){this.U3t.style.opacity=t+""},_.prototype.FM=function(t){var n;t&&(n=t.tipText,this.menuContent=t.menuContent,this.tipText=n,this.R3t.title=n[0],this.F3t.title=n[1],this.U3t.title=n[2],this.z3t.title=n[2])},_.prototype.onUnbind=function(){Cn(this)},_.prototype.onDispose=function(){this.b3t=w,h(this.F3t).unbind(S),h(this.R3t).unbind(S),h(this.U3t).unbind(jt),h(this.P3t).unbind(S),h(this.z3t).unbind(S),document.removeEventListener(Ot,this.Sfe),document.removeEventListener(Rt,this.Tfe),r.StatusItem.prototype.onDispose.call(this)},qt=_,un=r.StatusItem,n(E,un),E.prototype.onCreateItemView=function(t){t.style.display=this.visible?dt:g;var n,n=(n=this.X3t)||(this.X3t=d(ht));h(n).addClass(J),n.innerText="100%",t.appendChild(n)},E.prototype.onBind=function(t){wn(this,t)},E.prototype.onUpdate=function(){Mn(this)},E.prototype.Xe=function(t){var n;(n=t?mn(t):n)!==parseInt(this.value+"",10)&&(n=parseInt(n,10),this.value=n+"%",this.q3t(n))},E.prototype.q3t=function(t){var n=this.X3t;n&&(n.innerText=t+"%")},E.prototype.onUnbind=function(){Cn(this)},$t=E,sn=r.StatusItem,n(j,sn),j.prototype.onBind=function(t){var e=this;(e.DJ=t).bind(f.Events.ProgressChanged+e.s3t,function(t,n){e.oyt=n.sheetName,e.onUpdate(n.progress)})},j.prototype.onUpdate=function(t){var n,e,i,r,o,a,u;void 0!==t&&(e=(n=this).$3t,i=n.t4t,r=n.y4,o=n.visible,a=n.n4t,u=n.oyt,t&&1!==t&&r!==t&&o?(n.u3t.style.display=vt,h(e).width(n.YC*t),i.innerHTML=(100*t).toFixed(2)+"%",a.innerText=u?"("+u+")":""):(t<=0||1<=t||!1===o)&&(n.u3t.style.display=g,h(i).empty(),h(a).empty()),n.y4=t)},j.prototype.onCreateItemView=function(t){var n,e,i,r,o,a,n=this,e=d(m);h(e).addClass(xt),i=d(m),h(i).addClass(Nt),h(i).width(n.YC),e.appendChild(i),r=this.$3t=d(m),h(r).addClass(kt),o=this.t4t=d(m),h(o).addClass(Dt),a=this.n4t=d(m),h(a).addClass(_t),i.appendChild(r),e.appendChild(o),e.appendChild(a),t.appendChild(e),n.u3t.style.display=g},j.prototype.onUnbind=function(){this.DJ&&(this.DJ.unbind(f.Events.ProgressChanged+this.s3t),this.DJ=w)},tn=j,Object.defineProperty(O.prototype,"maxCalcCells",{get:function(){return this.f3t},set:function(n){var t;this.f3t=n,this.y3t.o3t().forEach(function(t){t instanceof I&&(t.f3t=n)})},enumerable:!1,configurable:!0}),O.prototype.w3t=function(t,n){var i,r,e,o,a,u,e,s,c,f,l,h,d,i=["formulaAverage","formulaCount","formulaNumericalCount","formulaMin","formulaMax","formulaSum"],r=["toolTipFormulaAverage","toolTipFormulaCount","toolTipFormulaNumericalCount","toolTipFormulaMin","toolTipFormulaMax","toolTipFormulaSum"],e=[A().formulaAverage,A().formulaCount,A().formulaNumericalCount,A().formulaMin,A().formulaMax,A().formulaSum],o=[A().toolTipFormulaAverage,A().toolTipFormulaCount,A().toolTipFormulaNumericalCount,A().toolTipFormulaMin,A().toolTipFormulaMax,A().toolTipFormulaSum],a=[!0,!0,!1,!1,!1,!0],u=[];for(e.forEach(function(t,n){var e={};e.menuContent=t,e.prefix=t,e.align=C,e.tipText=o[n],e.visible=a[n],e.e4t=i[n],e.i4t=r[n],u.push(e)}),e={menuContent:A().cellMode,value:A().cellModeReady,tipText:U(A().toolTipCellMode,[A().cellModeReady]),e4t:"cellMode",i4t:"toolTipCellMode"},s={value:100,menuContent:A().zoomSlider,showStatusInContexMenu:!1,align:C,e4t:"zoomSlider",i4t:["toolTipZoomOut","toolTipZoomIn","toolTipSlider"]},c={value:"100%",tipText:A().toolTipZoomPanel,menuContent:A().zoom,align:C,e4t:"zoom",i4t:"toolTipZoomPanel"},f={value:0,menuContent:A().progressItem,showStatusInContexMenu:!1,e4t:M,i4t:M},l=[new Xt(it,e),new tn(M,f),new I(T[0],u[0]),new I(T[1],u[1]),new I(T[2],u[2]),new I(T[3],u[3]),new I(T[4],u[4]),new I(T[5],u[5]),new qt(this,ft,s),new $t(lt,c)],n&&n.items instanceof Array&&(l=l.concat(n.items)),d=0;d<l.length;d++)h=l[d],t.dU(h);t.t3t()},O.prototype.C3t=function(t){var n,e,i,n,n=this.Ti,e=this.WCt,i=t.clientHeight;n&&(h(n).addClass(q),h(e).addClass($),(n=i)<15&&(t.style.minHeight="15px",n=15),e.style.top="-"+n+v)},O.prototype.r4t=function(){var t=this.Ti;t&&(this.o4t=this.a4t.bind(this),t.addEventListener(Bt,this.o4t))},O.prototype.a4t=function(t){var n,e,i,r,o,a;G(t),e=(n=this).M3t,i=n.DJ,l&&i&&(n.rq||(n.rq=new Kt(n.WCt,h(n.DJ.oM))),r=e.menuView,a=pn(o=n.Ti).left,r.hostInfo={top:o.getBoundingClientRect().top,left:o.getBoundingClientRect().left,width:o.clientWidth,height:o.clientHeight},e.menuData=n.y3t.e3t(),n.rq.rQ(r,e.menuData,t.clientX-a,t.offsetY,i))},O.prototype.u4t=function(t){var n;l&&(n=new Sn,this.M3t.menuView=n,this.oq(t))},O.prototype.oq=function(t){var e,n,i,e=this,n,i;t.commandManager().register(tt+Et,{canUndo:!1,execute:function(t,n){var n=n.commandOptions;e.y3t.r3t(n)}})},O.prototype.Yoe=function(){this.y3t.Yoe()},O.prototype.bind=function(t){this.unbind(),t&&(((this.DJ=t).b3t=this).y3t.$Ct(t),this.u4t(t),this.r4t())},O.prototype.unbind=function(){this.y3t&&this.y3t.a3t(),this.DJ&&(this.DJ.b3t=w,this.DJ=w),this.Ti&&(this.Ti.removeEventListener(Bt,this.o4t),this.o4t=w),this.rq&&(this.rq.close(),this.rq=w)},O.prototype.add=function(t,n){return this.y3t.JCt(t,n)},O.prototype.remove=function(t){return this.y3t.qCt(t)},O.prototype.get=function(t){return this.y3t.q_(t)},O.prototype.all=function(){return this.y3t.o3t()},O.prototype.update=function(){this.y3t.n3t()},O.prototype.dispose=function(){this.unbind(),this.M3t=w,this.rq=w,this.y3t&&(h(this.y3t.TW).data("statusbar",w),this.y3t.L0(),this.y3t=w),this.Ti&&(this.Ti=w)},L.StatusBar=O,l&&H(Sn,Jt),Sn.prototype.getCommandOptions=function(t){return t},n(R,cn=t),R.prototype.canExecute=function(){return!0},R.prototype.execute=function(){var t,n,t,e,i,t=this,n=t.Mf,t=t.S3t,e=t.newZoomFactor;if(this.canExecute()){n.Ut.startTransaction();try{n.zoom(e)}finally{t[i=f.Commands.TI(n.name())]=n.Ut.endTransaction()}return!0}return!1},R.prototype.canUndo=function(){return!0},R.prototype.undo=function(){var t=this,n=t.Mf,e,i,t=t.S3t[f.Commands.TI(n.name())][0].value,r=n.zoom();return t!==r&&(n.zoom(t),yn(n,t,r)),!0},en=R,f.Commands[s]={canUndo:!0,execute:function(t,n,e){return f.Commands.zA(t,en,n,e)}},f.Worksheet.ch(s,{setHost:function(t){var t;!t||(t=this.Qy())[s]||t.register(s,f.Commands[s])},onLayoutChanged:function(t){var n,t,t;t.changeType===Lt&&(t=this.parent)&&!t.isPaintSuspended()&&(t=t.b3t)&&t.update()}}),f.Workbook.ch(Et,{onCultureChanged:function(){var t=this.b3t,n=A(),e=[],i,r;t&&t.y3t&&t.y3t.o3t().forEach(function(t){i=t.i4t,r=n[i],i instanceof Array&&(i.forEach(function(t){e.push(n[t])}),r=e),t.FM({menuContent:n[t.e4t],tipText:r})})},preFromJson:function(){Tn(this)},preFromSJSFormat:function(){Tn(this)}})},"./dist/plugins/statusBar/statusBar.ns.js":function(t,n,e){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.SR=void 0;var e=e("./dist/plugins/statusBar/statusBar.res.en.js");n.SR={en:e}},"./dist/plugins/statusBar/statusBar.res.en.js":function(t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.progressItem=n.toolTipZoomPanel=n.toolTipSlider=n.toolTipZoomIn=n.toolTipZoomOut=n.toolTipFormulaSum=n.toolTipFormulaMax=n.toolTipFormulaMin=n.toolTipFormulaNumericalCount=n.toolTipFormulaCount=n.toolTipFormulaAverage=n.toolTipCellMode=n.zoom=n.zoomSlider=n.formulaSum=n.formulaMax=n.formulaMin=n.formulaNumericalCount=n.formulaCount=n.formulaAverage=n.cellModeEdit=n.cellModeEnter=n.cellModeReady=n.cellMode=void 0,n.cellMode="Cell Mode",n.cellModeReady="Ready",n.cellModeEnter="Enter",n.cellModeEdit="Edit",n.formulaAverage="Average",n.formulaCount="Count",n.formulaNumericalCount="Numerical Count",n.formulaMin="Min",n.formulaMax="Max",n.formulaSum="Sum",n.zoomSlider="Zoom Slider",n.zoom="Zoom",n.toolTipCellMode="In {0} mode",n.toolTipFormulaAverage="Average of selected cells",n.toolTipFormulaCount="Number of selected cells that contain data",n.toolTipFormulaNumericalCount="Number of selected cells that contain numerical data",n.toolTipFormulaMin="Minimum value in selection",n.toolTipFormulaMax="Maximum value in selection",n.toolTipFormulaSum="Sum of selected cells",n.toolTipZoomOut="Zoom Out",n.toolTipZoomIn="Zoom In",n.toolTipSlider="Zoom",n.toolTipZoomPanel="Zoom level",n.progressItem="Progress"},"./dist/plugins/statusBar/statusItem.js":function(t,n,e){"use strict";var i,e,r,o,i,s,a,u,c,f,l,h,d,v,m,g,p,b,y,w,M,C;function S(t,n,e,i){return{name:t,menuContent:n,visible:e,status:i,command:p+b}}function T(t,n){var t,e,i,r,o,a,u,n;this._marginLeft=0,this._marginRight=0,this.YC=g,this.u3t=v,this.I3t=v,this.name=t,n&&(t=n.align,e=n.menuContent,i=n.tipText,r=n.visible,o=n.showStatusInContexMenu,a=n.value,u=n.e4t,n=n.i4t,this.align=s(t)?m:t,this.menuContent=s(e)?v:e,this.tipText=s(i)?"":i,this.visible=!!s(r)||r,this.showStatusInContexMenu=!!s(o)||o,this.value=s(a)?v:a,this.e4t=s(u)?v:u,this.i4t=s(n)?v:n)}Object.defineProperty(n,"__esModule",{value:!0}),n.StatusItem=void 0,i=e("Core"),e=e("Common"),r=i.mt.En,o=i.GC$,i=e.Common.lt,s=i.ht,a="gc-statusbar-statusitem-container",u="div",c="span",f="none",l="inline-block",h="mousemove",d="mouseout",v=null,m="left",g="auto",p="gc.spread.",b="statusBar",y="10px",w="px",M=15,T.prototype.KCt=function(t){var n,n,t,n=this.align===m;this._marginLeft=n?y:0,this._marginRight=n?0:y,n=t.clientHeight,this.ZC=15<n?n:15,t=this.s4t(),this.u3t=t,this.onCreateItemView(t),this.aY(t)},T.prototype.s4t=function(){var t=this.u3t,n=this.ZC&&this.ZC+w;return t||((t=this.u3t=r(u)).title=this.tipText,o(t).addClass(a),o(t).css({height:n,lineHeight:n,float:this.align,marginLeft:this._marginLeft+"",marginRight:this._marginRight+""}),!1===this.visible&&(t.style.display=f)),t},T.prototype.onCreateItemView=function(t){var n=this.I3t;n||((n=this.I3t=r(c)).innerText=this.value+""),t.appendChild(n)},T.prototype.Zoe=function(){},T.prototype.onBind=function(t){},T.prototype.aY=function(t){t.addEventListener(h,this.Q3t.bind(this)),t.addEventListener(d,this.J3t.bind(this))},T.prototype.XCt=function(){return this.u3t},T.prototype.Q3t=function(t){},T.prototype.J3t=function(t){},T.prototype.i3t=function(){var t=this.c4t();return t.type=b,t.workArea=b,t},T.prototype.r3t=function(t){this.visible=!t.visible,this.onUpdate()},T.prototype.c4t=function(){var t=this.showStatusInContexMenu?this.f4t():null;return S(this.name,this.menuContent,this.visible,t)},T.prototype.f4t=function(){return this.value},T.prototype.Yct=function(){this.u3t&&(this.u3t.style.display=this.visible?l:f)},T.prototype.FM=function(t){t&&(this.menuContent=t.menuContent,this.tipText=t.tipText,this.u3t.title=this.tipText)},T.prototype.onUpdate=function(t){t&&this.I3t&&(this.I3t.innerHTML=t),this.Yct()},T.prototype.onUnbind=function(){},T.prototype.onDispose=function(){this.onUnbind(),this.I3t=v,this.u3t&&(this.u3t.removeEventListener(h,this.Q3t),this.u3t.removeEventListener(d,this.J3t),o(this.u3t).empty(),this.u3t=v)},n.StatusItem=T},"./dist/plugins/table/table-action.js":function(B,t,n){"use strict";var e,m,t,n,f,g,l,d,L,n,v,i,h,p,b,y,r,o,a,u,c,w,M,C,S,T,F,P,A,G,U,I,x,H,z,V,Y,Z,W,Q,J,K,X,q,$,tt;function s(t,n){var t=Z.call(this,t)||this;return t.l4t=n,t.h4t=n.tableName,t.d4t=n.resizeToRange,t}function N(t,n){var t=W.call(this,t)||this;return t.v4t=n,t.h4t=n.tableName,t.Ky=n.row,t.DU=n.count,t.m4t=n.isAfter,t}function k(t,n){var t=Q.call(this,t)||this;return t.v4t=n,t.h4t=n.tableName,t.Ky=n.row,t.DU=n.count,t.m4t=n.isAfter,t}function D(t,n){var t=J.call(this,t)||this;return t.g4t=n,t.h4t=n.tableName,t.p4t=n.changeRows,t}function _(t,n){var t=K.call(this,t)||this;return t.b4t=n,t.h4t=n.tableName,t.iw=n.col,t.DU=n.count,t.m4t=n.isAfter,t}function E(t,n){var t=X.call(this,t)||this;return t.y4t=n,t.h4t=n.tableName,t.iw=n.col,t.DU=n.count,t}function j(t,n){var t=q.call(this,t)||this;return t.w4t=n,t.h4t=n.tableName,t}function O(t,n){var t,e,t=$.call(this,t)||this,e=t;return e.M4t=n,e.Ky=n.row,e.iw=n.col,e.D5=n.newValue,t}function R(t,n){var t,e,t=tt.call(this,t)||this,e;return t.C4t=n,t.h4t=n.tableName,t}e=this&&this.__extends||(Y=function(t,n){return(Y=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(t,n){t.__proto__=n}:function(t,n){for(var e in n)Object.prototype.hasOwnProperty.call(n,e)&&(t[e]=n[e])}))(t,n)},function(t,n){if("function"!=typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function e(){this.constructor=t}Y(t,n),t.prototype=null===n?Object.create(n):(e.prototype=n.prototype,new e)}),Object.defineProperty(t,"__esModule",{value:!0}),m=n("Core"),t=n("Common"),n=n("./dist/plugins/table/table-util.js"),f=n.Util.S4t,g=n.Util.jj,l=n.Util.Ej,d=n.Util._getTable,L=n.Util.T4t,n=m.Commands.ActionBase,v=t.Common.lt.ht,i="tableResize",h="tableInsertRows",p="tableDeleteRows",b="tableInsertColumns",y="tableDeleteColumns",r="tableToRange",o="tableTotalRowFormula",a="DoInsertRows",u="tableShowFooter",c="tableInsertRowsAboveForContextMenu",w="tableInsertRowsBelowForContextMenu",M="tableDeleteRowsForContextMenu",C="tableInsertColumnsLeftForContextMenu",S="tableInsertColumnsRightForContextMenu",T="tableDeleteColumnsForContextMenu",F=void 0,e(s,Z=n),s.prototype.execute=function(){var t,n,e,i,r,o,a,u,s,c,t=this,n=!1;if(t.canExecute()){i=(e=t.Mf).Ut,r=t.h4t,o=t.l4t,i.startTransaction(),t.X5(e,!0);try{(a=e.tables.findByName(r))&&(u=a.range(),s=t.d4t,e.tables.resize(a,s),f(e,a,u,s),n=!0)}finally{t.q5(e,!0),o[c=m.Commands.TI(e.name())]=i.endTransaction()}}return n},s.prototype.undo=function(){var t,n,e,i,r,o,a,u,s,t=this,n=t.Mf,e=t.h4t,i=!1;if(t.canUndo()){t.X5(n,!0);try{r=t.l4t,o=n.Ut,a=n.tables.findByName(e),(s=r[u=m.Commands.TI(n.name())])&&(o.undo(s),f(n,a,r.resizeToRange,a.range()),i=!0)}finally{t.q5(n,!0)}}return i},P=s,m.Commands[i]={canUndo:!0,execute:function(t,n,e){return m.Commands.zA(t,P,n,e)}},e(N,W=n),N.prototype.execute=function(){var t,n,e,i,r,o,a,u,s,c,f,r,t=this,n=!1;if(t.canExecute()){i=(e=t.Mf).Ut,r=t.h4t,o=t.Ky,a=t.DU,u=t.m4t,i.startTransaction(),t.X5(e,!0);try{(s=e.tables.findByName(r))&&(c=s.Sx,s.zpt(o,a,u),n=!0,(f=s.Sx)-c===a)&&g(e,s,h,o,a,u)}finally{t.q5(e,!0),r=m.Commands.TI(e.name()),t.v4t[r]=i.endTransaction()}}return n},N.prototype.undo=function(){var t,n,e,i,r,o,a,u,s,c,f,l,t=this,n=t.Mf,e=!1;if(t.canUndo()){t.X5(n,!0);try{i=t.v4t,r=n.Ut,a=i[o=m.Commands.TI(n.name())],u=i.row,s=i.count,c=i.isAfter,a&&(r.undo(a),(f=n.tables.findByName(t.h4t))&&(l=c?u+1:u,f.A4t(l,s),f.I4t(),f.x4t(l,s,L(!0)),g(n,f,p,u,s,F,f.tq())),e=!0)}finally{t.q5(n,!0)}}return e},A=N,m.Commands[h]={canUndo:!0,execute:function(t,n,e){return m.Commands.zA(t,A,n,e)}},e(k,Q=n),k.prototype.execute=function(){var t,n,e,i,r,o,a,u,s,r,t=this,n=!1;if(t.canExecute()){i=(e=t.Mf).Ut,r=t.h4t,o=t.Ky,a=t.DU,u=t.m4t,i.startTransaction(),t.X5(e,!0);try{(s=e.tables.findByName(r))&&(s.N4t(o,a,u,!1),g(e,s,h,o,a,u),t.v4t.row=o,t.v4t.count=a,n=!0)}finally{t.q5(e,!0),r=m.Commands.TI(e.name()),t.v4t[r]=i.endTransaction()}}return n},k.prototype.undo=function(){var t,n,e,i,r,o,a,u,s,c,f,l,h,d,v,t=this,n=t.Mf,e=!1;if(t.canUndo()){t.X5(n,!0);try{i=t.v4t,r=n.Ut,a=i[o=m.Commands.TI(n.name())],u=i.row,s=i.count,c=i.isAfter,a&&(l=(f=n.tables.findByName(t.h4t))&&f.z3(),h=void 0,d=c?u+1:u,l&&(v=f.dataRange(),h=l.slice(d-v.row,d-v.row+s)),r.undo(a),f&&(f.A4t(d,s),f.I4t(),f.x4t(d,s,L(!0)),g(n,f,p,u,s,c,h||f.tq())),e=!0)}finally{t.q5(n,!0)}}return e},G=k,m.Commands[a]={canUndo:!0,execute:function(t,n,e){return m.Commands.zA(t,G,n,e)}},e(D,J=n),D.prototype.execute=function(){var t,n,e,i,r,o,a,u,s,c,f,l,r,t=this,n=!1;if(t.canExecute()){i=(e=t.Mf).Ut,r=t.h4t,o=t.p4t,i.startTransaction(),t.X5(e,!0);try{if(a=e.tables.findByName(r))for(u=o.length-1;0<=u;u--)s=o[u].row,c=o[u].count,f=a.Sx,a.yE(s,c),n=!0,f-(l=a.Sx)===c&&g(e,a,p,s,c,F,a.tq())}finally{t.q5(e,!0),r=m.Commands.TI(e.name()),t.g4t[r]=i.endTransaction()}}return n},D.prototype.undo=function(){var t,n,e,i,r,o,a,u,s,c,f,l,t=this,n=t.Mf,e=!1;if(t.canUndo()){t.X5(n,!0);try{if(i=t.g4t,r=n.Ut,a=i[o=m.Commands.TI(n.name())],u=t.p4t,a)for(r.undo(a),(s=n.tables.findByName(t.h4t))&&s.I4t(),e=!0,c=u.length-1;0<=c;c--)f=u[c].row,l=u[c].count,g(n,s,h,f,l,!1)}finally{t.q5(n,!0)}}return e},U=D,m.Commands[p]={canUndo:!0,execute:function(t,n,e){return m.Commands.zA(t,U,n,e)}},e(_,K=n),_.prototype.execute=function(){var t,n,e,i,r,o,a,u,s,c,f,r,t=this,n=!1;if(t.canExecute()){i=(e=t.Mf).Ut,r=t.h4t,o=t.iw,a=t.DU,u=t.m4t,i.startTransaction(),t.X5(e,!0);try{(s=e.tables.findByName(r))&&(c=s.Tx,s.k4t(o,a,u),n=!0,(f=s.Tx)-c===a)&&l(e,s,b,o,a,u)}finally{t.q5(e,!0),r=m.Commands.TI(e.name()),t.b4t[r]=i.endTransaction()}}return n},_.prototype.undo=function(){var t,n,e,i,r,o,a,u,s,c,t=this,n=t.Mf,e=!1;if(t.canUndo()){t.X5(n,!0);try{i=t.b4t,r=n.Ut,a=i[o=m.Commands.TI(n.name())],u=i.col,s=i.count,a&&(r.undo(a),(c=n.tables.findByName(t.h4t))&&c.I4t(),e=!0,l(n,c,y,u,s))}finally{t.q5(n,!0)}}return e},I=_,m.Commands[b]={canUndo:!0,execute:function(t,n,e){return m.Commands.zA(t,I,n,e)}},e(E,X=n),E.prototype.execute=function(){var t,n,e,i,r,o,a,u,s,c,r,t=this,n=!1;if(t.canExecute()){i=(e=t.Mf).Ut,r=t.h4t,o=t.iw,a=t.DU,i.startTransaction(),t.X5(e,!0);try{(u=e.tables.findByName(r))&&(s=u.Tx,u.wE(o,a),n=!0,s-(c=u.Tx)===a)&&l(e,u,y,o,a)}finally{t.q5(e,!0),r=m.Commands.TI(e.name()),t.y4t[r]=i.endTransaction()}}return n},E.prototype.undo=function(){var t,n,e,i,r,o,a,u,s,c,t=this,n=t.Mf,e=!1;if(t.canUndo()){t.X5(n,!0);try{i=t.y4t,r=n.Ut,a=i[o=m.Commands.TI(n.name())],u=i.col,s=i.count,a&&(r.undo(a),(c=n.tables.findByName(t.h4t))&&c.I4t(),l(n,c,b,u,s,!(e=!0)))}finally{t.q5(n,!0)}}return e},x=E,m.Commands[y]={canUndo:!0,execute:function(t,n,e){return m.Commands.zA(t,x,n,e)}},e(j,q=n),j.prototype.execute=function(){var t,n,e,i,r,o,r,t=this,n=!1;if(t.canExecute()){i=(e=t.Mf).Ut,r=t.h4t,i.startTransaction(),t.X5(e,!0);try{(o=e.tables.findByName(r))&&(e.tables.remove(o,3),n=!0)}finally{t.q5(e,!0),r=m.Commands.TI(e.name()),t.w4t[r]=i.endTransaction()}}return n},j.prototype.undo=function(){var t,n,e,i,r,o,a,u,t=this,n=t.Mf,e=!1;if(t.canUndo()){t.X5(n,!0);try{i=t.w4t,r=n.Ut,(a=i[o=m.Commands.TI(n.name())])&&(r.undo(a),(u=n.tables.findByName(t.h4t))&&u.I4t(),e=!0)}finally{t.q5(n,!0)}}return e},H=j,m.Commands[r]={canUndo:!0,execute:function(t,n,e){return m.Commands.zA(t,H,n,e)}},e(O,$=n),O.prototype.execute=function(){var t,n,e,i,r,o,a,u,s,c,f,a,t=this,n=!1;if(t.canExecute()){(i=(e=t.Mf).Ut).startTransaction(),t.X5(e,!0);try{r=t.Ky,o=t.iw,a=t.D5,e.setFormula(r,o,a),a?a.startsWith("=SUBTOTAL(103")||a.startsWith("=SUBTOTAL(102")||(u=e.getFormatter(r,o))&&"GENERAL"!==u.toUpperCase()||(f=(c=(s=e.tables.find(r,o))&&s.BSt[o-s.startColumn()])&&c.formatter(),(0,m.Lfe)(e,r,o,f)):e.setValue(r,o,null),n=!0}finally{t.q5(e,!0),a=m.Commands.TI(e.name()),t.M4t[a]=i.endTransaction()}}return n},O.prototype.undo=function(){var t,n,e,i,r,o,a,t=this,n=t.Mf,e=!1;if(t.canUndo()){t.X5(n,!0);try{i=t.M4t,r=n.Ut,(a=i[o=m.Commands.TI(n.name())])&&(r.undo(a),e=!0)}finally{t.q5(n,!0)}}return e},z=O,m.Commands[o]={canUndo:!0,execute:function(t,n,e){return m.Commands.zA(t,z,n,e)}},e(R,tt=n),R.prototype.execute=function(){var t,n,e,i,r,o,r,t=this,n=!1;if(t.canExecute()){i=(e=t.Mf).Ut,r=t.h4t,i.startTransaction(),t.X5(e,!0);try{(o=e.tables.findByName(r))&&(o.showFooter(!0),n=!0)}finally{t.q5(e,!0),r=m.Commands.TI(e.name()),t.C4t[r]=i.endTransaction()}}return n},R.prototype.undo=function(){var t,n,e,i,r,o,a,t=this,n=t.Mf,e=!1;if(t.canUndo()){t.X5(n,!0);try{i=t.C4t,r=n.Ut,(a=i[o=m.Commands.TI(n.name())])&&(r.undo(a),e=!0)}finally{t.q5(n,!0)}}return e},V=R,m.Commands[u]={canUndo:!0,execute:function(t,n,e){return m.Commands.zA(t,V,n,e)}},m.Commands[c]={canUndo:!0,execute:function(t,n,e){var i,r,o,a,u,s,r;return n.cmd=c,v(n.row)&&v(n.count)?(i=m.Commands.Tp(t,n),s=u=a=o=void 0,1===(r=n.selections).length&&(o=r[0],(a=d(i,o))&&(u=o.row,s=o.rowCount,r=a.footerIndex()===u,n.row=r?u-1:u,n.count=s,n.tableName=a.name(),n.isAfter=r),m.Commands.zA(t,A,n,e))):m.Commands.zA(t,A,n,e)}},m.Commands[w]={canUndo:!0,execute:function(t,n,e){var i,r,o,a,u,s;return n.cmd=w,v(n.row)&&v(n.count)?(i=m.Commands.Tp(t,n),s=u=a=o=void 0,1===(r=n.selections).length&&(o=r[0],(a=d(i,o))&&(u=o.row,s=o.rowCount,n.row=u,n.count=s,n.tableName=a.name(),n.isAfter=!0),m.Commands.zA(t,A,n,e))):m.Commands.zA(t,A,n,e)}},m.Commands[M]={canUndo:!0,execute:function(t,n,e){var i,r,o,a,u,s,c,f,l,h;if(n.cmd=M,v(n.changeRows)){for(i=m.Commands.Tp(t,n),r=n.selections,u=a=o=void 0,n.changeRows=[],s=0;s<r.length;s++){if(c=r[s],!(f=d(i,c)))return!1;if(o){if(o!==f)return!1}else o=f}for(s=0;s<r.length;s++)for(l=s+1;l<r.length;l++){if(c=r[s],h=r[l],c.row>=h.row&&c.row<=h.row+h.rowCount-1)return!1;if(c.row+c.rowCount-1>=h.row&&c.row+c.rowCount-1<=h.row+h.rowCount-1)return!1;if(c.row<=o.Ky||c.row+c.rowCount>o.Ky+o.Sx)return!1;if(h.row<=o.Ky||h.row+h.rowCount>o.Ky+o.Sx)return!1}for(r.sort(function(t,n){return t.row-n.row}),s=0;s<r.length;s++)a=(c=r[s]).row,u=c.rowCount,n.changeRows.push({row:a,count:u});n.tableName=o.name()}return m.Commands.zA(t,U,n,e)}},m.Commands[C]={canUndo:!0,execute:function(t,n,e){var i,r,o,a,u,s;return n.cmd=C,v(n.col)&&v(n.count)?(i=m.Commands.Tp(t,n),s=u=a=o=void 0,1===(r=n.selections).length&&(o=r[0],(a=d(i,o))&&(u=o.col,s=o.colCount,n.col=u,n.count=s,n.tableName=a.name(),n.isAfter=!1),m.Commands.zA(t,I,n,e))):m.Commands.zA(t,I,n,e)}},m.Commands[S]={canUndo:!0,execute:function(t,n,e){var i,r,o,a,u,s;return n.cmd=S,v(n.col)&&v(n.count)?(i=m.Commands.Tp(t,n),s=u=a=o=void 0,1===(r=n.selections).length&&(o=r[0],(a=d(i,o))&&(u=o.col,s=o.colCount,n.col=u,n.count=s,n.tableName=a.name(),n.isAfter=!0),m.Commands.zA(t,I,n,e))):m.Commands.zA(t,I,n,e)}},m.Commands[T]={canUndo:!0,execute:function(t,n,e){var i,r,o,a,u,s;return n.cmd=T,v(n.col)&&v(n.count)?(i=m.Commands.Tp(t,n),s=u=a=o=void 0,1===(r=n.selections).length&&(o=r[0],(a=d(i,o))&&(u=o.col,s=o.colCount,n.col=u,n.count=s,n.tableName=a.name()),m.Commands.zA(t,x,n,e))):m.Commands.zA(t,x,n,e)}},m.Commands.D4t=function(t){t.register(i,m.Commands[i]),t.register(h,m.Commands[h]),t.register(a,m.Commands[a]),t.register(p,m.Commands[p]),t.register(b,m.Commands[b]),t.register(y,m.Commands[y]),t.register(r,m.Commands[r]),t.register(o,m.Commands[o]),t.register(u,m.Commands[u]),t.register(c,m.Commands[c]),t.register(w,m.Commands[w]),t.register(M,m.Commands[M]),t.register(C,m.Commands[C]),t.register(S,m.Commands[S]),t.register(T,m.Commands[T])}},"./dist/plugins/table/table-event.js":function(t,n,e){"use strict";var g,n,p,i,e,f,h,s,r,o,n,b,y,w,a;Object.defineProperty(n,"__esModule",{value:!0}),g=e("Core"),n=e("Common"),p=e("./dist/plugins/table/table.js"),i=e("./dist/plugins/table/table.ns.js"),e=e("./dist/plugins/table/table-util.js"),f=n.Common.lt.ht,h=null,s=Math.abs,r=10,o="tableResize",n=new n.Common.ResourceManager(i.SR,"Tables"),b=n.getResource.bind(n),y=e.Util._4t,w=e.Util.E4t,a=e.Util.j4t,g.GC$.extend(g.nk.prototype,{mk:function(t,n){var t,e,t=this.Tk(t,n);t&&((e=this).I9=e.x9=n.Ut.getSelections(),n.setSelection(t.row,t.col,t.rowCount,t.colCount))},Tk:function(t,n){var e,i,r,o,a,u,i,n,s,c,n,e=n.getSelections(),i=t.tableSelectInfo,r=i.table,o=0,a=0;if(r.oL&&(o=1),r.jO&&(a=1),u=h,i=i.action,n=n.il&&n.il.Ymt(),!f(n)&&0<n.length&&(e=n),i===p.TableSelectionType.TABLE_ROW_SELECT)u=(0,g.Ec)(t.row,r.iw,1,r.Tx);else if(i===p.TableSelectionType.TABLE_COL_SELECT){for(s=0;s<e.length;s++)if((c=e[s]).col===t.col&&c.row===r.Ky+a&&1===c.colCount&&c.rowCount===r.Sx-a-o){u=(0,g.Ec)(r.Ky,t.col,r.Sx,1);break}n=!u&&-1===t.rowViewportIndex&&e&&e[0]&&e[0].col===t.col&&e[0].rowCount===r.Sx,f(u)&&!n&&(u=(0,g.Ec)(r.Ky+a,t.col,r.Sx-a-o,1))}else if(i===p.TableSelectionType.TABLE_CORNER_SELECT){for(s=0;s<e.length;s++)if((c=e[s]).col===r.iw&&c.row===r.Ky+a&&c.colCount===r.Tx&&c.rowCount===r.Sx-a-o){u=(0,g.Ec)(r.Ky,r.iw,r.Sx,r.Tx);break}f(u)&&(u=(0,g.Ec)(r.Ky+a,r.iw,r.Sx-a-o,r.Tx))}else i===p.TableSelectionType.TABLE_SELECT&&(u=(0,g.Ec)(r.Ky,r.iw,r.Sx,r.Tx));return u},KL:function(t,n){var e,i,r,o,a,u,s,t,c,f,c,f,e,r,l,s,o,e=this.Mf,i=h;return i=e&&!e.options.isProtected&&!e.isEditing()&&n&&n.showResizeHandle()&&(r=t.row,o=t.col,a=t.x,u=t.y,s=t.rowViewportIndex,t=t.colViewportIndex,c=y(e,n),f=w(e,n),r===c)&&o===f&&(f=(c=e.getCellRect(r,o,s,t)).x,e=c.y,r=c.width,o=e+(l=c.height),(s=f+r)-10<=a)&&a<=s&&o-10<=u&&u<=o?{x:a,y:u,table:n}:i},Sk:function(t){var n,e,i,i,r,o,n=this;!0!==n.$k&&!0!==n.rb&&(e=n.Mf,i=(i=t.resizeTableHitInfo)&&i.table)&&!i.QL()&&(n.$k=!0,n.rb=!0,n.O4t=i,n.R4t=i.Ky,n.B4t=i.iw,n.L4t=i.Sx,n.F4t=i.Tx,r=n.R4t+n.L4t-1,o=n.B4t+n.F4t-1,n.P4t=e.getCellRect(r,o),n.G4t=i.range(),n.Rk={e9:t.rowViewportIndex,r9:t.colViewportIndex,Bk:t.hitTestType},n.Ok())},t9:function(){var t,n,e,t=this,n=t.Mf;t.Rk&&t.$k&&t.rb&&t.O4t&&(t.U4t(),t.H4t()&&(t.z4t=t.V4t(),t.Y4t(),t.Z4t(),(e=(e=t.W4t)||t.Q4t()).equals(t.K4t)||(t.W4t=(0,g.Ec)(t.K4t.row,t.K4t.col,t.K4t.rowCount,t.K4t.colCount),a(n,t.O4t,t.Q4t(),t.K4t))),t.a9())},OD:function(){var t,n,e,t=this,n=t.Mf;t.l9(),t.$k&&t.rb&&t.K4t&&t.O4t?(t.$k=!1,t.rb=!1,t.J4t()?(e=t.Q4t(),t.X4t(),e.equals(t.K4t)?n.Dn.q4t():n.Qy().execute({cmd:o,sheetName:n.name(),tableName:t.O4t.name(),resizeToRange:t.K4t}),t.$4t()):(t.$4t(),n.Dn.q4t())):t.$4t()},Q4t:function(){var t=this.O4t;return(0,g.Ec)(t.Ky,t.iw,t.Sx,t.Tx)},U4t:function(){var t=this,n=t.Q9(),e=t.K9();t.tSt=n,t.nSt=e},H4t:function(){var t,n,e,i,r,o,a,u,s,t=this,n=t.R4t,e=t.B4t,i=t.tSt,r=t.nSt,o,a,u,s;return(t.O4t.jO?n+1:n)<=i&&e<=r},V4t:function(){var t,n,e,t,i,t,r,e,n,o,t=this,e=t.fk,t=t.P4t,i=t.x+t.width,t=t.y+t.height,r=e.x,e=e.y,n=s(t-e),o,n=s(i-r)<=n?e<t?2:3:r<i?0:1;return n},Y4t:function(){var t,n,e,i,r,o,a,u,t=this,n=t.R4t,e=t.B4t,i=t.tSt,r=t.nSt,o=t.z4t,a=t.L4t,u=t.F4t;switch(o){case 0:case 1:u=s(r-e)+1;break;case 2:case 3:a=s(i-n)+1}t.K4t?(t.K4t.rowCount=a,t.K4t.colCount=u):t.K4t=(0,g.Ec)(n,e,a,u)},Z4t:function(){var t=this,n;t.Mf.Dn.q4t(),t.G4t=t.eSt()},eSt:function(){var t,n,e,i,r,n,t,n=this.K4t,e=n.row,i=n.col,r=n.rowCount,n=n.colCount;return(0,g.Ec)(e,i,r,n)},X4t:function(){var t=this,n=t.O4t,e;2===t.z4t&&n.oL&&(t.K4t.rowCount+=1)},J4t:function(){var t,n,e,i,r,o,a,u,s,c,a,f,l,h,d,v,m,t=this,n=t.Mf,e=!1,i=n.Ut,r=n.tables,o=t.O4t,a=t.K4t,u=a.row,s=a.col,c=a.rowCount,a=a.colCount,f=t.tSt,l=t.nSt,h=y(n,o),d=w(n,o),v=t.z4t,m=o.IB;return h&&d&&((0,p.hasRowFilter)(n,new g.Range(u,s,c,a))||(i.eE(u,s,c,a)||i.GT(u,s,c,a)?n.jT(6,b().Exp_TableResizeToSpan):m&&m.isFiltered()?2===v?n.jT(6,b().Exp_TableResizeWithHidden):3===v&&o.oL?n.jT(6,b().Exp_TableResizeWithFilter):e=!0:2===v&&t.iSt(h,f)||0===v&&t.rSt(d,l)?n.jT(6,b().Exp_TableResizeWithHidden):1===v&&(r.Pl(u,d+1,c,l-d)||r.oSt(u,d+1,c,l-d))||3===v&&(r.Pl(h+1,s,f-h,a)||r.oSt(h+1,s,f-h,a))?n.jT(6,b().Exp_TableResizeToTable):e=!0)),e},iSt:function(t,n){for(var e,i=this.Mf,r,o=!1,r=t;n<r;r--)if(i.getRowHeight(r)<=0){o=!0;break}return o},rSt:function(t,n){var e,i=this.Mf,r,o=!1;if(!o)for(r=t;n<r;r--)if(i.getColumnWidth(r)<=0){o=!0;break}return o},$4t:function(){var t=this;t.$k=!1,t.rb=!1,t.Rk=h,t.K4t=h,t.W4t=h}})},"./dist/plugins/table/table-render.js":function(t,n,e){"use strict";var e,i,n;function r(t,n,e,i){var r,o,e,r,o=t.rt.K4t,e=t.getRangeRect(e,i,o);n.strokeStyle=t.getSelectionBorderColor(),n.strokeRect(e.x,e.y,e.width,e.height)}Object.defineProperty(n,"__esModule",{value:!0}),n="tableRender",(i=(e=e("Core")).GC$.extend)(e.g7.prototype,{q4t:function(){var t,n,t=this,n;0<t.Mf.My||t.E1()}}),e.Worksheet.ch(n,{paintAdornment:function(t){var n,t,e,n=this,t=t.ctx,e=n.rt;e&&e.Rk&&e.$k&&r(n,t,e.nD(),e.eD())}})},"./dist/plugins/table/table-theme.js":function(B,t,L){"use strict";var s,h,F,u,P,G,e,U,H,z,c,V,f,l,d,v,m,g,Y,p,Z,W,Q,J,K,b,X,q,$,tt,y,L,nt,et,a,w,M,C,S,T,A,it,I,x,N,k,D,n,rt,i,r,o,o,i;function ot(){for(var t,n,t={},n=1;n<=28;n++)n<=21&&(t["TABLESTYLELIGHT"+n]=!0),n<=11&&(t["TABLESTYLEDARK"+n]=!0),t["TABLESTYLEMEDIUM"+n]=!0;return t}function _(t,n,e,i,r,o,a,u,s,c){var f=this,l=arguments;h(A,function(t,n){f[n]=l[t]})}function at(i,r){i.name(r.name()),h(y,function(t,n){i[n](r[n]())}),h(b,function(t,n){var e=r[n]();i[n](e?e.Gf():V)}),i.builtInName(r.builtInName(),!1)}function E(){}function j(t,n){return isNaN(n)?n:new s.LineBorder(t,n)}function O(t,n,e,i,r,o,a,u,s,c){var f=new I;return n&&(f.backColor=n),e&&(f.foreColor=e),i&&(f.font=nt),r&&(f.borderLeft=j(t,r)),o&&(f.borderTop=j(t,o)),a&&(f.borderRight=j(t,a)),u&&(f.borderBottom=j(t,u)),s&&(f.borderHorizontal=j(t,s)),c&&(f.borderVertical=j(t,c)),f}function R(t){return 0===t?"Text 1":"Accent "+t}function ut(t){var t,n,e,t=R(t),n=t+" 80",e=new x;return e[f](O(t,0,t,1,0,0,0,1)),e[d](O(t,0,t,0,0,1,0,1)),e[g](O(t,n)),e[m](O(t,0,t,1)),e[v](O(t,0,t,1)),e[p](O(t,n)),e[l](O(t,0,t,1,0,1)),e}function st(t){var t,n,t=R(t),n=new x;return n[f](O(t,t,N,1)),n[d](O(t,0,0,0,1,1,1,1)),n[g](O(t,0,0,0,0,1)),n[Y](O(t,0,0,0,0,1)),n[p](O(t,0,0,0,1)),n[Z](O(t,0,0,0,1)),n[m](O(t,0,0,1)),n[v](O(t,0,0,1)),n[l](O(t,0,0,1,0,6)),n}function ct(t){var t,n,e,t=R(t),n=t+" 80",e=new x;return e[f](O(t,0,0,1,0,0,0,2)),e[d](O(t,0,0,0,1,1,1,1,1,1)),e[g](O(t,n)),e[p](O(t,n)),e[m](O(t,0,0,1)),e[v](O(t,0,0,1)),e[l](O(t,0,0,1,0,6)),e}function ft(t){var t,n,e,t,i,t=R(t),n=t+" 20",e=t,t=t+" 80",i=new x;return i[f](O(n,e,N,1)),i[d](O(n,0,0,0,1,1,1,1,1)),i[g](O(n,t)),i[p](O(n,t)),i[m](O(n,0,0,1)),i[v](O(n,0,0,1)),i[l](O(n,0,k,1,0,6)),i}function lt(t){var t,n,e,i,t,r,t=R(t),n=N,e=t,i=t+" 60",t=t+" 80",r=new x;return r[f](O(n,e,N,1,0,0,0,2,0,1)),r[d](O(n,t,0,0,0,0,0,0,1,1)),r[g](O(n,i)),r[p](O(n,i)),r[m](O(n,e,N,1)),r[v](O(n,e,N,1)),r[l](O(n,e,N,1,0,2,0,0,0,1)),r}function ht(t){var n,e,i,r,e,o,n,e="#D3D3D3",i=R(t),r=e,e=0===t?k:e,o=new x;return o[f](O(k,i,N,1,0,2,0,2)),o[d](O(e,0,0,0,1,new s.LineBorder(k,2),1,new s.LineBorder(k,2),0===t?1:0,1)),o[g](O(e,r)),o[p](O(e,r)),o[m](O(e,i,N)),o[v](O(e,i,N)),o[J](O(e,i,N,1)),o[K](O(e,i,N,1)),o[l](O(k,0,k,0,0,6)),o}function dt(t){var t,n,e,i,r,t,o,t=R(t),n=t,e=t+" 40",i=t+" 80",r=t+" 60",t=t+" 80",o=new x;return o[f](O(e,i,k,1,1,1,1,1,0,1)),o[d](O(e,i,0,0,1,1,1,1,1,1)),o[g](O(e,r)),o[p](O(e,r)),o[m](O(e,0,0,1)),o[v](O(e,0,0,1)),o[l](O(e,t,k,1,1,new s.LineBorder(n,2),1,1,0,1)),o}function vt(t){var n,e,i,r,t,o,n=R(t),e=k,i=0===t?n+" 25":n+" -25",r=0===t?n+" 50":n,t=0===t?n:n+" -50",o=new x;return o[f](O(N,e,N,1,0,0,0,2)),o[d](O(n,r,N)),o[g](O(n,i)),o[p](O(n,i)),o[m](O(N,i,N,1,0,0,2)),o[v](O(N,i,N,1,2)),o[l](O(N,t,N,1,0,2)),o}function mt(t){var n,e,i,t,r,o;function a(t,n){var e;return t<0||3<t?"":{tableBackground:["Background 1 -15","Accent 1 80","Accent 3 80","Accent 5 80"],stripColor:["Background 1 -35","Accent 1 60","Accent 3 60","Accent 5 60"],headerColor:["Text 1","Accent 2","Accent 4","Accent 6"]}[n][t]}return n=R(t),e=a(t,"headerColor"),i=a(t,"stripColor"),r=t=a(t,"tableBackground"),(o=new x)[f](O(n,e,N)),o[d](O(n,t)),o[g](O(n,i)),o[p](O(n,i)),o[m](O(n,0,0,1)),o[v](O(n,0,0,1)),o[l](O(k,r,0,1,0,6)),o}function gt(){}for(Object.defineProperty(t,"__esModule",{value:!0}),t.TableThemes=t.TableTheme=t.TableStyle=void 0,s=L("Core"),h=s.GC$.each,F=s.GC$.isEmptyObject,u=s.mt.T1,P=JSON.stringify,G=JSON.parse,e=s.mt.p0,U=s.mt.go,H=s.NodeHelper.sr,z=Math.floor,c=void 0,V=null,b=[f="headerRowStyle",l="footerRowStyle",d="wholeTableStyle",v="highlightLastColumnStyle",m="highlightFirstColumnStyle",g="firstRowStripStyle",Y="secondRowStripStyle",p="firstColumnStripStyle",Z="secondColumnStripStyle",W="firstHeaderCellStyle",Q="lastHeaderCellStyle",J="firstFooterCellStyle",K="lastFooterCellStyle"],y=[X="firstRowStripSize",q="secondRowStripSize",$="firstColumnStripSize",tt="secondColumnStripSize"],L="name",nt="bold 11pt calibri",et={wholeTable:"wholeTableStyle",headerRow:"headerRowStyle",totalRow:"footerRowStyle",firstColumn:"highlightFirstColumnStyle",lastColumn:"highlightLastColumnStyle",firstRowStripe:"firstRowStripStyle",secondRowStripe:"secondRowStripStyle",firstColumnStripe:"firstColumnStripStyle",secondColumnStripe:"secondColumnStripStyle",firstHeaderCell:"firstHeaderCellStyle",lastHeaderCell:"lastHeaderCellStyle",firstTotalCell:"firstFooterCellStyle",lastTotalCell:"lastFooterCellStyle"},A=["backColor","foreColor","font",a="borderLeft",w="borderTop",M="borderRight",C="borderBottom",S="borderHorizontal",T="borderVertical","textDecoration"],it=ot(),_.prototype.h5=function(e,t,n,i,r){var o=this;n&&u(o[a])&&!u(e[a])&&(e[a]=o[a],e[a].level=20),t&&u(o[w])&&!u(e[w])&&(e[w]=o[w],e[w].level=20),r&&u(o[M])&&!u(e[M])&&(e[M]=o[M],e[M].level=20),i&&u(o[C])&&!u(e[C])&&(e[C]=o[C],e[C].level=20),t||!u(o[S])||u(e[w])||(e[w]=o[S],e[w].level=20),i||!u(o[S])||u(e[C])||(e[C]=o[S],e[C].level=20),n||!u(o[T])||u(e[a])||(e[a]=o[T],e[a].level=20),r||!u(o[T])||u(e[M])||(e[M]=o[T],e[M].level=20),h(A,function(t,n){0<=n.indexOf("border")||u(o[n])&&!u(e[n])&&(e[n]=o[n])})},_.prototype.Gf=function(){var t,n,t=new _,n=P(this.toJSON());return t.fromJSON(G(n)),t},_.prototype.toJSON=function(){var i,r,i=this,r={};return h(A,function(t,n){var e,e,e=i[n],e=e&&e.toJSON?e.toJSON():e;r[n]=F(e)?c:e}),r},_.prototype.fromJSON=function(r,o){var a;r&&(a=this,h(A,function(t,n){var e,i,e=r[n];u(e)&&(0<=n.indexOf("border")?((i=new s.LineBorder).fromJSON(e,o),a[n]=i):a[n]=e)}))},I=_,t.TableStyle=I,s.GC$.extend(s.StyleManager.prototype,{addTableTheme:function(t){var n=this,e,e;(e=(e=n.aSt)||(n.aSt={}))[t.name()]=t},getTableTheme:function(t){var n,e,i,r,n=this,e=n.aSt;return e=e||(n.aSt={}),it[t.toUpperCase()]?e[i=t.substr(10).toLowerCase()]?e[i]:(at(r=new x,D[i]),n.addTableTheme(r),r):e[t]}}),E.prototype.toJSON=function(){var e,t,i,r,e=this,t=e.builtInName();return t?{buildInName:t}:(i={name:e.name()},h(b,function(t,n){(r=e[n]())&&(i[n]=r.toJSON())}),h(y,function(t,n){1!==(r=e[n]())&&(i[n]=r)}),F(i)?c:i)},E.prototype.fromJSON=function(r,o){var a,t,t,t;r&&(a=this,(t=r.buildInName)?at(a,D[t.toLowerCase()]):(t=r.name,t=u(t)?t:r.Zc,u(t)&&a.name(t,!1),h(y,function(t,n){var e=r[n]!==c?r[n]:r["_"+n];e&&a[n](e,!1)}),h(b,function(t,n){var e,i,e=r[n]!==c?r[n]:r["_"+n];e&&((i=new I).fromJSON(e,o),a[n](i,!1))})))},E.prototype.yh=function(t,a){var u,n,e,i,r,o,u=this;for(u.name(t.name),e=function(t){var n,e,i,r,o,n=H(t.dxfId,0),e=t.type,i=H(t.size,1),r=new I,o=et[e||"wholeTable"];"function"==typeof u[o]&&void 0!==t.dxfId&&(a.getDxf(n,r,!0),h(A,function(t,n){0<=n.indexOf("border")&&r[n]===V&&(r[n]=new s.LineBorder)}),u[o](r,!1)),"firstRowStripe"!==e&&"secondRowStripe"!==e&&"firstColumnStripe"!==e&&"secondColumnStripe"!==e||u[e.substr(0,e.length-1)+"Size"](i,!1)},i=0,r=n=U(t,"tableStyleElement");i<r.length;i++)e(o=r[i]);a.addTableTheme(u)},E.prototype.wh=function(i){var r,o,t,n,a,u,r=this,o=[],t={n_:"tableStyle",c_:o},n=r.builtInName();return n!==V&&n!==c?t.name="TableStyle"+n:(t.name=r.name(),a=0,h(b,function(t,n){var e;(u=r[n]())&&(e=i.getDxfIndex(u))!==c&&(a++,o.push({n_:"tableStyleElement",type:s.SJSStylePropsToStyleProps[n],dxfId:e}))}),h(y,function(t,n){(u=r[n]())&&(a++,o.push({n_:"tableStyleElement",type:n.replace("Size","e"),size:u}))}),t.count=a,t.pivot="0"),t},x=E,(t.TableTheme=x).prototype.name=e(L),x.prototype.builtInName=e("builtInName"),h(b,function(t,n){x.prototype[n]=e(n)}),h(y,function(t,n){x.prototype[n]=e(n,1)}),N="white",k="black",D=gt,t.TableThemes=D,n=1;n<=28;n++)i=z((rt=n-1)/7),n<=21&&0<=i&&i<3&&(o="Light"+n,(r=[ut,st,ct][i](rt%7)).name&&r.name(o),r.builtInName&&r.builtInName(o),D["light"+n]=r),n<=11&&0<=i&&i<2&&((r=[vt,mt][i](rt%7)).name(o="Dark"+n),r.builtInName(o),D["dark"+n]=r),0<=i&&i<4&&((r=[ft,lt,ht,dt][i](rt%7)).name(i="Medium"+n),r.builtInName(i),D["medium"+n]=r)},"./dist/plugins/table/table-util.js":function(B,t,n){"use strict";var f,o,a,e,i,p,u,b,l,h,d,r,n,v;function m(t){throw new Error(t)}function s(t,n,e,i,r){!i&&r&&(i=k(t,r,n,e)),a&&t.zI(n,e,i,r)}function c(t,n,e,i){t.setValue(n,e,i)}function g(t){t.suspendPaint()}function y(t){t.resumePaint()}function w(t){return t.op().Hyt()}function M(t){a&&t.suspendCalcService()}function C(t,n){a&&t.resumeCalcService(n)}function S(t){t&&(g(t),t.suspendEvent(),M(t))}function T(t){t&&(C(t),t.resumeEvent(),y(t))}function A(t){return t.rowCount}function I(t){return t.colCount}function x(t){return t&&!(/\d/.test(t[0])||/[\s\+\-\*\\:%!\[\]]/.test(t)||-1!==["C","c","R","r"].indexOf(t)||/^[A-Za-z]{1,3}(\$)?\d+$/.test(t)||/^[Rr]\d*[Cc]\d*$/.test(t)||255<=t.length)}function N(t,n,e,i,r){var o,r,o=t.Uw();return o._wt=r,r=t.Lp.parse(o,n,e,i,!1,!1,!1),delete o._wt,r}function k(t,n,e,i,r){return r=r===l||r,t.Lp.unparse(t.Uw(),n,e,i,!1,r)}function D(t){var n,e,i,e;return!(!t||(x(t)||m(v().Exp_TableNameInvalid),e=(n=this).name(),i=n.jS,t===e)||i&&(e=i.findByName(t))&&n!==e)}function _(t,n,e,i,r){for(var o,a,u,s,o=e;n<=o;o--)for(u=i;u<=r;u++){if(j(a=t.Z_(o,u)))return o;if(E(t,o,u))return o;if(s=t.Ut.findSpan(o,u))return s.row+s.rowCount-1}return-1}function L(t,n,e,i,r){for(var o,a,u,s,a=r;i<=a;a--)for(o=n;o<=e;o++){if(j(u=t.Z_(o,a)))return a;if(E(t,o,a))return a;if(s=t.Ut.findSpan(o,a))return s.col+s.colCount-1}return-1}function E(t,n,e){var i=t.getValue(n,e),r,o;return i!==b&&u(i)||(r=t.getSparkline&&t.getSparkline(n,e))||j(o=t.Z_(n,e))}function j(t){return!(!t||!(t.backColor||t.backgroundImage||t.borderBottom||t.borderLeft||t.borderRight||t.borderTop||t.cellType||t.diagonalDown||t.diagonalUp))}function F(t,n,e,i,r,o,a,u){return r<=t&&!(n===a&&n+i-1===u)&&(n<a&&a<n+i||a<=n&&n<=u&&u<n+i-1)}function P(t,n,e,i,r,o,a,u){return a<=n&&!(t===r&&t+e-1===o)&&(t<r&&r<t+e||r<=t&&t<=o&&o<t+e-1)}function G(t,n,e){return{col:n,leadingCellRow:e,row:t}}function U(t,n,e){var i,r,o,i=b,r=n.Ky,o=n.endRow();for(e&&(o-=n.oL?1:0);r<=o&&t.getRowHeight(o)<=0;)o--;return i=r<=o?o:i}function H(t,n){for(var e,i,r,e=b,i=n.iw,r=n.endColumn();i<=r&&t.getColumnWidth(r)<=0;)r--;return e=i<=r?r:e}function z(t){for(var n,e,i,n,r,o,a,u,s,c,n=t.Ut,e=n.W_(3).dataTable,i=n.getLastNonNullRow(3,!0),n=t.getRowCount(),r=t.getColumnCount(),o=-1,s=n-1;-1<s;s--)if(a=e[s])for(c=0;c<r;c++)if((u=a[c])&&!d(u.value))return h(s,i);return h(-1,i)}function V(t,n){var e,i,r,o,a,n,u,s,c,s,o,e=n.jS,i,r,o=n.Ky+n.Sx-1,a=n.iw,n=a+n.Tx-1,u=z(t),s=e?e.uSt():-1;return(c=o)<(u=h(u,s))&&(o=new f.Range(s=1+o,a,u-o,n-a+1),c=h(_(t,s,u,a,n),e.uSt(o))),c}function Y(t){for(var n,e,i,r,o,a,u,u,s,c,n=t.Ut,e=n.W_(3).dataTable,i=n.getLastNonNullCol(3,!0),r=t.getRowCount(),o,a=-1,s=t.getColumnCount()-1;-1<s;s--)for(c=0;c<r;c++)if((u=(u=e[c])&&u[s])&&!d(u.value))return h(s,i);return h(-1,i)}function Z(t,n){var e,i,r,o,a,n,u,s,c,s,n,e=n.jS,i=n.Ky,r=i+n.Sx-1,o,a,n=n.iw+n.Tx-1,u=Y(t),s=e?e.sSt():-1;return(c=n)<(u=h(u,s))&&(n=new f.Range(i,s=1+n,r-i+1,u-n),c=h(L(t,i,r,s,u),e.sSt(n))),c}function W(t,n,r,o,a,u,e,i,s,c){var f,l,t,n,h,i,f=t.getRowCount()-1,l=t.getColumnCount()-1,t=t.Ut.getSpans(),n=n.jS&&n.jS.U3;return!i&&(!s&&f-o<e||s&&l-u<e)?(c||m(v().Exp_TableAddRowNoEnoughRoom),!0):(h=s?P:F,(i=t.some(function(t){var n=t.row,e=t.col,i=t.rowCount,t=t.colCount;return h(n,e,i,t,r,o,a,u)}))?c||m(v().Exp_TableAddRowIntersectSpan):n&&(i=n.some(function(t){var n=t.Ky,e=t.iw,i=t.Sx,t=t.Tx;return h(n,e,i,t,r,o,a,u)}))&&!c&&m(v().Exp_TableAddRowIntersectTable),i)}function Q(t,n,e){for(var i,r,o,a,u,s,c,i=n.row,r=n.col,o=i+n.rowCount,a=r+n.colCount,u=i;u<o;u++)for(s=r;s<a;s++)if(((c=t.getCell(u,s)).value()||t.Ut.findSpan(u,s))&&(!e||!e.equals(new f.Range(c.row,c.col,1,1))))return new f.Range(u,s,1,1);return l}function O(t,n,e,i,r,o,a){for(var u,s,c,u=n;u<=e;u++)for(s=i;s<=r;s++)if(c=t.l0(u,s,"locked"),o&&!c||a&&c)return;return 1}function J(t,n,e,i,r,o,a){var u,s,c,f,l,h,d,v,m,g;if(r){if(!o&&!a)return b;if(u=t.Mf,c=s=0,t.oL&&(s=1),t.jO&&(c=1),n===p.TableSelectionType.TABLE_ROW_SELECT){if(!O(u,e,e,t.iw,t.endColumn(),o,a))return b}else if(n===p.TableSelectionType.TABLE_COL_SELECT){for(l=!0,h=0,d=f=u.getSelections();h<d.length;h++)if((v=d[h]).col===i&&v.row===t.Ky+c&&1===v.colCount&&v.rowCount===t.Sx-c-s){if(!O(u,t.Ky,t.endRow(),i,i,o,a))return b;l=!1}if(l&&!O(u,t.Ky+c,t.endRow()-s,i,i,o,a))return b}else if(n===p.TableSelectionType.TABLE_CORNER_SELECT){for(l=!0,m=0,g=f=u.getSelections();m<g.length;m++)if((v=g[m]).col===t.iw&&v.row===t.Ky+c&&v.colCount===t.Tx&&v.rowCount===t.Sx-c-s){if(!O(u,t.Ky,t.endRow(),t.iw,t.endColumn(),o,a))return b;l=!1}if(l&&!O(u,t.Ky+c,t.endRow()-s,t.iw,t.endColumn(),o,a))return b}else if(n===p.TableSelectionType.TABLE_SELECT&&!O(u,t.Ky,t.endRow(),t.iw,t.endColumn(),o,a))return b}return{action:n,table:t}}function R(t,n){var e=t.Ky;return n-(t.jO?e+1:e)}function K(t,n){var e;return n-t.iw}function X(t){var n=r;return t&&r++,n}function q(t){return"string"==typeof t}function $(t,n,e,i){var r;t.ki(f.Events.TableResizing,{sheet:t,table:n,oldRange:e,newRange:i})}function tt(t,n,e,i){var r;t.ki(f.Events.TableResized,{sheet:t,table:n,oldRange:e,newRange:i})}function nt(t,n,e,i,r,o,a){var e={sheet:t,table:n,propertyName:e,row:R(n,i),count:r};d(o)||(e.isAfter=o),a&&(e.deletedItem=a),t.ki(f.Events.TableRowsChanged,e)}function et(t,n,e,i,r,o){var e={sheet:t,table:n,propertyName:e,col:i-n.iw,count:r};d(o)||(e.isAfter=o),t.ki(f.Events.TableColumnsChanged,e)}function it(t,n,e){var i=0;if(t.cSt(n,e))for(i=2;t.cSt(n+i,i);)i++;return 0<i&&(n+=i),n}function rt(t){return t&&"="===t[0]}function ot(t){var n,e,i,r,n=-1;if(t)for(e=t.arguments,i=void 0,r=0;r<e.length;r++)if((i=e[r])instanceof o.obt){n=r;break}return n}function at(t,n,e){var t,i,t,r,t=t.dataRange(),i=t.row,t=t.col,r;return(e?i:t)+n}function ut(t){var n=t;return n=t&&"="===t[0]?t.slice(1):n}function st(t,n){for(var e,i,i=0;i<t.length;i++)if((e=t[i])&&n===e.col)return e;return b}function ct(t,n){var e,i,r;if(n)for(e=n.row;e<n.row+n.rowCount;e++)for(i=n.col;i<n.col+n.colCount;i++)if(t.tables&&(r=t.tables.find(e,i)))return r;return null}function ft(t,n){return n?t.tables.AB(n.row,n.col,n.rowCount,n.colCount):null}function lt(t){return d(t)||("string"!=typeof t&&(t+=""),t=t.replace(/\r\n?/g,"\n")),t}function ht(t){return t===l}Object.defineProperty(t,"__esModule",{value:!0}),t.Util=void 0,f=n("Core"),o=n("SheetsCalc"),a=n("CalcEngine"),e=n("Common"),i=n("./dist/plugins/table/table.ns.js"),p=n("./dist/plugins/table/table.js"),u=f.mt.T1,b=null,l=void 0,h=Math.max,d=e.Common.lt.ht,r=0,n=new e.Common.ResourceManager(i.SR,"Tables"),v=n.getResource.bind(n),t.Util={throwError:m,setFormulaToSheet:s,setValue:c,suspendPaint:g,resumePaint:y,Hyt:w,suspendCalcService:M,resumeCalcService:C,fSt:S,lSt:T,getRowCount:A,getColCount:I,isValidTableName:x,formulaToExpression:N,expressionToFormula:k,checkTableName:D,hSt:G,_4t:U,E4t:H,dSt:V,vSt:Z,mSt:W,gSt:Q,pSt:J,bSt:R,ySt:K,T4t:X,wSt:q,j4t:$,S4t:tt,jj:nt,Ej:et,MSt:it,kf:rt,CSt:ot,SSt:at,TSt:ut,ASt:st,_getTable:ct,ISt:ft,xSt:lt,NSt:ht}},"./dist/plugins/table/table.entry.js":function(t,n,e){"use strict";var i,r,i=this&&this.__createBinding||(Object.create?function(t,n,e,i){void 0===i&&(i=e);var r=Object.getOwnPropertyDescriptor(n,e);r&&("get"in r?n.__esModule:!r.writable&&!r.configurable)||(r={enumerable:!0,get:function(){return n[e]}}),Object.defineProperty(t,i,r)}:function(t,n,e,i){t[i=void 0===i?e:i]=n[e]}),r=this&&this.__exportStar||function(t,n){for(var e in t)"default"===e||Object.prototype.hasOwnProperty.call(n,e)||i(n,t,e)};Object.defineProperty(n,"__esModule",{value:!0}),e("./dist/plugins/table/table.interface.js"),e("./dist/plugins/table/table-event.js"),e("./dist/plugins/table/table-render.js"),e("./dist/plugins/table/table-action.js"),e("./dist/plugins/table/table-util.js"),r(e("./dist/plugins/table/table-theme.js"),n),r(e("./dist/plugins/table/table.js"),n),r(e("./dist/plugins/table/table.ns.js"),n)},"./dist/plugins/table/table.interface.js":function(t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0})},"./dist/plugins/table/table.js":function(f,S,t){"use strict";var l,h,_,z,n,y,d,T,e,b,t,i,A,u,g,p,m,I,V,Y,Z,x,W,Q,J,K,X,q,$,tt,nt,et,it,rt,ot,at,ut,N,k,w,st,ct,ft,lt,ht,D,E,r,dt,j,M,v,vt,mt,gt,pt,bt,O,R,C,yt,wt,Mt,Ct,St,Tt,At,It,xt,Nt,kt,Dt,_t,Et,jt,Ot,Rt,Bt,Lt,B,L,F,Ft,Pt,Gt,Ut,Ht,zt,Vt,Yt,Zt,Wt,Qt,Jt,Kt,Xt,qt,$t,tn,nn,en,rn,on,an,un,sn,cn,fn,ln,hn,dn,vn,o,mn,gn,pn,bn,t,yn,wn,Mn,Cn,Sn,Tn,An,In,xn,Nn,kn,Dn,_n,En,jn,On,Rn,Bn,Ln,Fn,Pn,Gn,P,Un,Hn,zn,Vn,Yn,Zn,Wn,Qn,e,G,Jn,Kn,Xn,qn,$n,te,U,ne,e,ee,H,ie,re,oe,e,e,ae,r;function ue(t,n){return t&&n&&t.color===n.color&&t.type===n.type||!t&&!n}function se(t,n){var e,i,r,e=!1;if(I(t[n]))e=!0;else for(r=t.length-1;n<r;r--)if(I(t[i=r-1])){e=!0;break}return e}function ce(o,e,a){var t=o.parent,u=ft(o);function i(t,r){p(t,function(t,n){var e,i,e=n.getExpression(),i=z.CalcOperatorAdjustor.adjustExpressionOnRemoveTable(e,r,-1,-1,a);i!==e&&(n.SB(i),u.invalidName(o.Uw(),n.getName()))})}t?(i(t.getCustomNames(),e),p(t.sheets,function(t,n){i(n.getCustomNames(),e)})):i(o.getCustomNames(),e),u.onAfterRemoveTable(e,a)}function fe(t,n){var e,i,n,r,e={position:_.ButtonPosition.right,imageType:_.ButtonImageType.dropdown,visibility:_.ButtonVisibility.onSelected,useButtonStyle:!1,command:"openList"},i,n={items:[{text:G().Table_None,value:null},{text:G().Table_Average,value:"=SUBTOTAL(101,[".concat(n,"])")},{text:G().Table_Count,value:"=SUBTOTAL(103,[".concat(n,"])")},{text:G().Table_Count_Numbers,value:"=SUBTOTAL(102,[".concat(n,"])")},{text:G().Table_Max,value:"=SUBTOTAL(104,[".concat(n,"])")},{text:G().Table_Min,value:"=SUBTOTAL(105,[".concat(n,"])")},{text:G().Table_Sum,value:"=SUBTOTAL(109,[".concat(n,"])")},{text:G().Table_StdDev,value:"=SUBTOTAL(107,[".concat(n,"])")},{text:G().Table_Var,value:"=SUBTOTAL(110,[".concat(n,"])")}]},r=new _.Style;return r.cellButtons=[e],r.dropDowns=[{type:_.DropDownType.list,option:n,submitCommand:"tableTotalRowFormula"}],r}function le(t){var n;t.tables.all().forEach(function(t){t.formulaFromJSON()})}function he(t,n,e){var t,n,t,e;if(t&&0<t.length&&(t=t[n]))return n=t.cellType(),t=t.formatter(),e=e,n&&((e=e||new _.Style).cellType=n),t&&((e=e||new _.Style).formatter=t),e}function de(t){var t,n,n,e,t,t=t.c_[0],n=t&&t.c_&&t.c_[0];if(n)return n={kSt:{altText:n.altText,altTextSummary:n.altTextSummary}},e=t["xmlns:x14"],(t={kSt:{uri:t.uri}})["x14:table"]=n,t.kSt["xmlns:x14"]=e,{ext:t,attr:{}}}function ve(t){if(t&&t.c_)return de(t)}function me(t,n,e,i,r,o,a){var t,n,u,s,c,e;if(t.Ut&&(n=(t=t.Ut.sheetModels[3].J_(n,e))&&t.style)&&o&&"string"==typeof n)if(r[n])t.style=r[n];else if(u=o.i3(n)){for(s in u=u.clone(!0),Xn)!Xn.hasOwnProperty(s)||I(u[s])||(0===(c=Xn[s])?u[s]===i[s]&&(u[s]=L):1===c?ue(u[s],i[s])&&(u[s]=L):2===c&&_.util.Uce(u[s],i[s])&&(u[s]=L));e=a.Xd+a.$d+n,a.$d++,u.name=e,o.$p(u),t.style=e,r[n]=e}}function ge(t,n,e,i,r,o){n&&(n.table(t),(e=e||{lossless:{}})&&(e.lossless||(e.lossless={}),!1===t.showHeader()&&(e.lossless.showTableHeader=!1),e.ref||(e.lossless.showFilterButton=!1),e.lossless.range={row:t.Ky+1,col:t.iw,rowCount:t.Sx-1-(t.showFooter()?1:0),colCount:t.Tx},n.yh(e,i,r)),t.IB!==n&&(t.IB=n),o?t.IB.reFilter():(t.DSt=!0,t._St()))}function pe(){var t=0;return function(){return++t}}function be(t,n){var e=t;return typeof n[t]===Vn?(n[t]++,e+="_".concat(n[e])):n[t]=0,e}function a(t,n,e,i,r,o,a){var u,s,u=this;for(u.jO=!a||a.showHeader===L||a.showHeader,u.oL=!(!a||a.showFooter===L)&&a.showFooter,u.ESt=!(!a||a.useFooterDropDownList===L)&&a.useFooterDropDownList,u.jSt=!(!a||a.showResizeHandle===L)&&a.showResizeHandle,u.OSt=[],u.H3=B,u.IB=B,u.jS=B,u.RSt=!1,A(t)&&u.name(t),u.Ky=A(n)?n:-1,u.iw=A(e)?e:-1,u.Sx=A(i)?i:-1,u.Tx=A(r)?r:-1,A(o)&&u.style(o),u.BSt=[],s=0;s<u.Tx;s++)u.BSt.push(new H(s+1));u.LSt=B,u.FSt={},u.PSt=[],u.aj=[],u.GSt=[],u.USt=[],u.HSt=[],u.zSt=[],u.VSt=!0}function ye(t,n){var t,e,t=t&&t.rowFilter&&t.rowFilter();return!I(t)&&(e=t.range).intersect(n.row,n.col,n.rowCount,n.colCount)}function we(r){return function(t,n){var e=this,i=e.Mf;i&&t!==n&&(U.et(i,"tableNameChanged",{oldName:n,newName:t}),i.Ut.YSt(e,r,n,t))}}function Me(t,n){var e=this;e.dl(),we("style").call(e,t,n)}function Ce(t,n,e,i,r){t.Qy().execute({cmd:kn,sheetName:t.name(),tableName:n.name(),row:e,count:i,isAfter:r})}function Se(t,n,e,i,r){t.Qy().execute({cmd:Dn,sheetName:t.name(),tableName:n.name(),row:e,count:i,isAfter:r})}function Te(t,n){t.Qy().execute({cmd:_n,sheetName:t.name(),tableName:n.name()})}function Ae(t){var n,n;if(!I(t))return n=/\[\S[\S\s]*\S\]/,"SUBTOTAL("!==(t=t.trim()).substr(0,9)||!n.test(t)||t.indexOf("[[")?"custom":(n=t.substring(9,12),ne[n]||Zn)}function Ie(t){return-1<t.indexOf("LET(")}function s(t){var n,e,n=ae.call(this)||this,e=n;return e.table(t),e.act=!1,n}function xe(t,n,e,i,r,o){var a=this;a.id(t),a.dataField(n),a.name(e||n||mn+a.id()),a.formatter(i),a.cellType(r),a.value(o)}function Ne(t,n){for(var e,i,e=n.row;e<n.row+n.rowCount;e++)for(i=n.col;i<n.col+n.colCount;i++)if(!I(t.getValue(e,i)))return;return 1}function c(t){this.Mf=t,this.U3=[],this.xl=[],this.Nl=[]}function ke(t,n){var t,e;return"Object"===n.constructor.name&&(t=t.findByName(n.tableName))&&(t.H3?n=t.H3:((e=new T.$$).fromJSON(n),t.H3=n=e)),n}function De(t,n,e,i,r){for(var r,o,a,u,s,r=0===r,o=r?t.aj:t.GSt,a=-1,s=0;s<o.length;s++)if((u=o[s])&&u.key===i){a=s;break}-1<a&&o.splice(a,I(e)?1:e),r&&t.ZSt()}function _e(t,n){var n,e,i,t,n;n.refresh(),t&&(n=t.table,e=t.row,i=t.count,t=t.stateType,n=n.getSlicerData())&&(0===t?n.onRowsAdded(e,i):n.onRowsRemoved(e,i))}function Ee(t,n,e){var i,r,o;if(n)for(i=n.length-1;0<=i;i--)o=ke(t,(r=n[i]).bindingManager),e?o.wtt(r):o.Mtt(r)}function je(t,n){var e=new U;return e.Sg(t),e.fromJSON(n),e}function Oe(t,n){var e,i;if(n)for(e=0;e<n.length;e++)(i=n[e])&&"Object"===i.constructor.name&&(n[e]=t.findByName(i.name),n[e]||(n[e]=je(t,i)))}function Re(t,n){for(var e,i,e=0;e<n.length;e++)(i=n[e]).table&&"Object"===i.table.constructor.name&&(i.table=t.findByName(i.table.name)),Oe(t,i.tableList),Oe(t,i.changedTables)}l=this&&this.__extends||(oe=function(t,n){return(oe=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(t,n){t.__proto__=n}:function(t,n){for(var e in n)Object.prototype.hasOwnProperty.call(n,e)&&(t[e]=n[e])}))(t,n)},function(t,n){if("function"!=typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function e(){this.constructor=t}oe(t,n),t.prototype=null===n?Object.create(n):(e.prototype=n.prototype,new e)}),h=this&&this.__assign||function(){return(h=Object.assign||function(t){for(var n,e,i,r,e=1,i=arguments.length;e<i;e++)for(r in n=arguments[e])Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r]);return t}).apply(this,arguments)},Object.defineProperty(S,"__esModule",{value:!0}),S.TableRemoveOptions=S.TableManager=S.TableColumn=S.WSt=S.hasRowFilter=S.Table=S.TableSelectionType=void 0,_=t("Core"),z=t("SheetsCalc"),n=t("Common"),y=t("CalcEngine"),d=t("Filters"),T=t("Bindings"),e=t("./dist/plugins/table/table.ns.js"),b=t("./dist/plugins/table/table-theme.js"),t=t("./dist/plugins/table/table-util.js"),i=_.mt.p0,A=_.mt.T1,u=_.mt.j,g=_.GC$.inArray,p=_.GC$.each,m=_.GC$.isEmptyObject,I=n.Common.lt.ht,V=n.Common.ct,Y=n.Common.Uf.OS,Z=n.Common.kh,x=_.mt.xr,W=_.mt.go,Q=_.mt.c1,J=_.mt.St,K=_.NodeHelper.sr,X=_.NodeHelper.ur,q=_.mt.n1,$=_.mt.vo,tt=_.Util.gr,nt=_.Util.pr,et=_.Util.mr,it=_.Util.addXLFNPrefix,rt=_.Util.wr,ot=_.Util.Sr,at=_.Util.po,ut=_.Util.yo,N=t.Util.throwError,k=t.Util.setFormulaToSheet,w=t.Util.setValue,st=t.Util.suspendPaint,ct=t.Util.resumePaint,ft=t.Util.Hyt,lt=t.Util.suspendCalcService,ht=t.Util.resumeCalcService,D=t.Util.getRowCount,E=t.Util.getColCount,r=t.Util.checkTableName,dt=t.Util.isValidTableName,j=t.Util.formulaToExpression,M=t.Util.expressionToFormula,v=t.Util.hSt,vt=t.Util._4t,mt=t.Util.E4t,gt=t.Util.dSt,pt=t.Util.vSt,bt=t.Util.mSt,O=t.Util.gSt,R=t.Util.pSt,C=t.Util.bSt,yt=t.Util.ySt,wt=t.Util.T4t,Mt=t.Util.wSt,Ct=t.Util.fSt,St=t.Util.lSt,Tt=t.Util.jj,At=t.Util.Ej,It=t.Util.MSt,xt=t.Util.kf,Nt=t.Util.CSt,kt=t.Util.SSt,Dt=t.Util.TSt,_t=t.Util.ASt,Et=t.Util.ISt,jt=t.Util.xSt,Ot=t.Util.NSt,Rt=_.range_parser.getRangeString,Bt=_.range_parser.Dc,Lt=_.range_parser.jc,B=null,L=void 0,F=Math.min,Ft=Math.ceil,Pt=Math.max,Gt=JSON.stringify,Ut=JSON.parse,Zt="highlightFirstColumn",Wt="highlightLastColumn",Qt="bandRows",Jt="bandColumns",Kt="autoGenerateColumns",Xt="headerRowStyle",qt="footerRowStyle",$t="wholeTableStyle",tn="highlightLastColumnStyle",nn="highlightFirstColumnStyle",en="firstRowStripStyle",rn="secondRowStripStyle",on="firstColumnStripStyle",an="secondColumnStripStyle",un="firstHeaderCellStyle",sn="lastHeaderCellStyle",cn="firstFooterCellStyle",fn="lastFooterCellStyle",ln="firstRowStripSize",hn="secondRowStripSize",dn="firstColumnStripSize",vn="secondColumnStripSize",o=".table",mn="Column",t="dataAreaFormulaStr",yn="isArrayFormula",Cn="footerRowStyles",Sn=[gn="id",Ht="name",zt="cellType",Vt="value",Yt="formatter",pn="dataField",bn="footerFormula",wn="dataAreaFormula",Mn="footerValue"],Tn=4,An=2,In="table",xn="tableResize",Nn="#485DB1",kn="tableInsertRows",Dn="DoInsertRows",_n="tableShowFooter",En="tableDeleteRows",jn="tableInsertColumns",On="tableDeleteColumns",Rn="collection",Bn="tableColumn",Ln="property",Fn="dataSource",Pn="rowsChange",Gn="showFooter",P="range",Un="columns",Hn="tableExpression",zn="sheetExpression",Vn="number",Yn="string",Zn="custom",Wn=_.XFileConstants.Ki,Qn=_.XFileConstants.Bu,e=new n.Common.ResourceManager(e.SR,"Tables"),G=e.getResource.bind(e),Jn=_.UsedRangeUtil.hh,Kn=_.UsedRangeUtil.vh,Xn={backColor:2,foreColor:0,borderBottom:1,borderLeft:1,borderRight:1,borderTop:1,font:0,textDecoration:0},(e=qn=S.TableSelectionType||(S.TableSelectionType={})).TABLE_ROW_SELECT="tableRowSelect",e.TABLE_COL_SELECT="tableColSelect",e.TABLE_CORNER_SELECT="tableCornerSelect",e.TABLE_SELECT="tableSelect",(e=$n=$n||{})[e.deleted=0]="deleted",e[e.dirty=1]="dirty",_.Worksheet.ch(In,{priority:2e3,getUsedRange:function(t){var n,e,i;t.type&_.UsedRangeType.table&&(i=(e=(n=this).tables).getUsedRange(),Kn(t.range,i))},init:function(){var d=this;d.tables=d.Ut.QSt,d.unbind(o),d.bind(_.Events.BeforeDragDrop+o,function(t,n){var e,i,r,o,a,u,s,e,c,e,f,l,h,f,e=d,i=d.tables,r=G().Exp_DragDropChangePartOfTable,o=n.fromRow,a=n.fromColumn,u=D(n),s=n.columnCount,e=e.rt.q6,c=e.row,e=e.col,f=n.isDragInsert,l=n.isDragCopy,h=B;!f||-1!==o&&-1!==a||(0<=a?(d.isDragCopy&&(e<=a||a+s<=e)||!l&&(e<a||a+s<e))&&(f=!1,i.oSt(-1,e,-1,1)&&(f=!0,h=G().Exp_DragDropShiftTableCell),f||l||!i.oSt(-1,a,-1,s)||(h=r)):0<=o&&a<0&&(l&&(c<=o||o+u<=c)||!l&&(c<o||o+u<c))&&!l&&i.oSt(o,-1,u,-1)&&(h=r)),n.invalidMessage=h}),d.bind(_.Events.RowChanged+o,function(t,n){var e,i,r,e=d.tables,i=e.xl,r=n.propertyName;"isVisible"===r?(!1===n.newValue?i[n.row]=0:i[n.row]=L,e.KSt(n.row)):"height"===r&&(i[n.row]=L,e.KSt(n.row))}),d.bind(_.Events.RowHeightChanged+o,function(t,n){for(var e,i,r,o,a,u,s,e=d.tables,i=e.xl,r=0,o=n.rowList;r<o.length;r++)i[a=o[r]]=L,s=(u=n.sheet).getRowHeight(a),e.KSt(a,0<s)}),d.bind(_.Events.ColumnChanged+o,function(t,n){var e,i,e=d.tables,i=e.Nl;"isVisible"===n.propertyName?(!1===n.newValue?i[n.col]=0:i[n.col]=L,e.JSt(n.col)):"width"===n.propertyName&&(i[n.col]=L,e.JSt(n.col))}),d.bind(_.Events.ColumnWidthChanged+o,function(t,n){for(var e,i,r,o,a,e=d.tables,i=e.Nl,r=0,o=n.colList;r<o.length;r++)i[a=o[r]]=L,e.JSt(a)}),d.bind(_.Events.RangeFiltered+o,function(t,n){for(var e,i,r,o,e=d.tables,i=e.xl,r=n.sheet.IB.range,o=0;o<r.rowCount;o++)i[r.row+o]=L,e.KSt(r.row+o)}),d.bind(_.Events.TableFiltered+o,function(t,n){for(var e,i,r,o,e=d.tables,i=e.xl,r=n.table.range(),o=0;o<r.rowCount;o++)i[r.row+o]=L,e.KSt(r.row+o)}),d.bind(_.Events.TableFilterCleared+o,function(t,n){var e;d.tables.dl()}),d.Q1i&&d.bind(_.Events.RangeChanged+o,function(t,n){var e,i,r,e=n.changedCells;if(e){for(d.pmi(),i=0;i<e.length;i++)r=e[i],d.Q1i(r.row,r.col,1,1,r.sheetArea);d.Smi()}})},resetBinding:function(t){this.tables.XSt()},initBinding:function(t){var n,e,i,r,o,a,n=this,e=n.tables;for(e.XSt(),lt(n),r=0,o=(i=e.all()).length;r<o;r++)(a=i[r])&&a.qSt();ht(n)},dispose:function(t){!1!==t.clearCache&&(this.unbind(o),this.tables)&&(this.tables.L0(),this.tables=null)},clearPendingChanges:function(){var t=this.tables;t&&t.$St()},onGroupChanged:function(t){var n,e,i,r,n,e=this.tables;if(t.fromSetCollapsed)for(i=t.isRow?e.xl:e.Nl,r=t.start;r<=t.end;r++)i[r]=L,t.isRow?e.KSt(r):e.JSt(r)},onLayoutChanged:function(t){var n,e,i,r,o,a,u,s,n=t.changeType,e=t.row,i=t.rowCount,r=t.col,o=t.colCount,a=t.sheetArea,u,s=this.tables;"setRowCount"===n||"setColumnCount"===n?s.dl():!I(a)&&3!==a||("addRows"===n?(s.JO(e,i),s.dl()):"addRows2"===n?s.t5t(e,i):"deleteRows"===n?(s.xP(e,i),s.dl()):"addColumns"===n?(s.qO(r,o),s.dl()):"deleteColumns"===n?(s.NP(r,o),s.dl()):"addColumns2"===n||"deleteColumns2"===n?s.n5t(r):"clear"!==n||t.ignoreTable||s.d5(e,r,i,o,t.type))},toJson:function(t,n){var e,i,r,o,r;function a(t,n){for(var e,i,r,o,a,u,s,c,f,l,h,d,v,m,g,p,b,y,y,e=t.tables.all(),i=0,r=e.length;i<r;i++)if(a=(o=e[i]).z3(),s=(u=o.dataRange()).row,c=u.col,f=s+D(u)-1,l=c+E(u)-1,a){if(h=[],(d=o.BSt)&&0<d.length)for(v=0;v<d.length;v++)g=(m=d[v]).formatter(),I(g)||J(g)||((p=new _.Style).formatter=g,h[v]=p);for(b=s;b<=f;b++)for(v=c;v<=l;v++)(y=o.Sl(b,v)).e5t&&(y=y.y4,V.W0(y)&&(y=V.Q0(y)),t.s8(n,b,v,y,L,h[v-c]))}}i=(e=this).tables,r=n&&n.ignoreStyle,o=n&&n.newWorkSheetName,r||(i&&(t.tables=i.toJSON(o,n)),n&&n.includeBindingSource&&((r=t.data).dataTable=r.dataTable||{},a(e,r.dataTable)))},wh:function(t,n,e){var i,r,o,a,u,s,c,f,l,h,d,v,m,g,p,b,y,w,M,C,S,T,T,A,i=this,r=i.tables,o=e&&!1===e.includeStyles,a=n.styleManager;if(r&&!o&&(r.wh(t),e)&&e.includeBindingSource)for(s=0,c=(u=r.all()).length;s<c;s++)if(l=(f=u[s]).z3(),d=(h=f.dataRange()).row,v=h.col,m=d+D(h)-1,g=v+E(h)-1,l){if(p=[],(b=f.BSt)&&0<b.length)for(y=0;y<b.length;y++)M=(w=b[y]).formatter(),I(M)||J(M)||((C=new _.Style).formatter=M,p[y]=a.getStyleIndex(C));for(S=d;S<=m;S++)for(y=v;y<=g;y++)(T=f.Sl(S,y)).e5t&&(T=T.y4,V.W0(T)&&(T=V.Q0(T)),i.c8(t,S,y,T,n.sharedStrings,A=p[y-v]))}},fromJson:function(t,n,e){var i,r,o,o,e,i,r=this.tables,o=t.tableManager,o=n?o&&o.tables:t.tables,e=e&&e.ignoreStyle;A(o)&&!e&&r&&r.fromJSON(o,n,t.isApplyRefilter)},fromJsonAfterFormula:function(t,n,e){le(this)},fromJsonAfterSJSFormula:function(t){le(this)},yh:function(t,n,e){var i,r=e&&!1===e.includeStyles,o=this.tables,a=x(t,Qn),t=t.rels;A(a)&&A(t)&&!r&&o&&o.yh(a,t,n,e)},lastNonNullRowAndCol:function(){var t,n,e,i,r,o,a,u,u,s,s,t,n,e=0,i=0,r=this.tables.all();if(r)for(o=0,a=r.length;o<a;o++)(u=r[o])&&(e<(s=(u=u.range()).row+D(u)-1)&&(e=s),i<(s=u.col+E(u)-1))&&(i=s);return{lastNonNullRow:e,lastNonNullCol:i}},paintCell:function(t){var n,e,i,t,r,o,e,a,e,r,a,o,e,t,n,t,u,s,n=this;t.isPrinting||t.sheetArea!==_.SheetArea.viewport||n.options.isProtected||(e=n.tables,i=t.ctx,r=(t=t.cell).row,o=t.col,(e=e.find(r,o))&&e.showResizeHandle()&&!e.QL()&&(a=vt(n,e),e=mt(n,e),r===a)&&o===e&&(r=t.x,a=t.y,o=t.width,e=t.height,t=n.zoom(),n=Ft(4*t),t=Ft(2*t),u=r+o,s=a+e,i)&&0<o&&0<e&&(i.save(),i.rect(r,a,o,e),i.clip(),i.fillStyle=Nn,i.beginPath(),i.moveTo(u-n,s),i.lineTo(u,s),i.lineTo(u,s-t),i.lineTo(u-n,s-t),i.fill(),i.beginPath(),i.moveTo(u,s-t),i.lineTo(u-t,s-t),i.lineTo(u-t,s-n),i.lineTo(u,s-n),i.fill(),i.restore()))},composeTableFooterList:function(t){var n=t.table,e=t.row,i=t.col,t=t.style;n.i5t(e,i,t)},refSheetLazyLoaded:function(t,o,a){var n,e,t,i,u,n,e=this.tables.all();0<e.length&&S.WSt&&(t=t.rels.c_.filter(function(t){return t.Type===_.RelationshipConstants.lc}).map(function(t){return _.Util.vr(t.Target)}),i=o.tables,u={},_.GC$.each(t,function(t,n){var n=i[n];n&&(u[n.name]=n)}),_.GC$.each(e,function(t,n){var e,i,e,r,e=u[n.name()];e&&(i=x(e,"autoFilter"),e=x(e,"sortState"),ge(n,r=n.IB||new S.WSt,i,e,o.styleManager),a.isApplyRefilter)&&n.IB.reFilter()}))}}),_.Worksheet.prototype.jj=function(t,n,e,i,r,o){var o=o?L:t.tq();Tt(this,t,n,e,i,r,o)},_.Worksheet.prototype.Ej=function(t,n,e,i,r){At(this,t,n,e,i,r)},_.Workbook.prototype.r5t=function(t){var n,e,e,i,n=this.sheets;if(n)for(i=0;i<n.length;i++)if((e=n[i].tables)&&(e=e.findByName(t)))return e;return B},te=pe(),a.prototype.L0=function(){var t=this;t.BSt=[],t.OSt=[],t.aj=[],t.GSt=[],t.USt=[],t.FSt={},t.PSt=[],t.Mf=B,t.jS=B,t.IB&&(t.IB.L0(),t.IB=B),t.dl()},a.prototype.dl=function(){this.HSt=[],this.zSt=[]},a.prototype.range=function(){var t=this;return(0,_.Ec)(t.Ky,t.iw,t.Sx,t.Tx)},a.prototype.dataRange=function(){var t,n,e,t=this,n=t.jO?t.Ky+1:t.Ky,e=t.jO?t.Sx-1:t.Sx;return t.oL&&e--,(0,_.Ec)(n,t.iw,e,t.Tx)},a.prototype.headerIndex=function(){return this.jO?this.Ky:-1},a.prototype.footerIndex=function(){return this.oL?this.Ky+this.Sx-1:-1},a.prototype.showHeader=function(t){var n,e,n=this;return 0===arguments.length?n.jO:(n.jO!==t&&((e=n.Mf)&&e.suspendPaint(),n.o5t(t),e)&&e.resumePaint(),n)},a.prototype.o5t=function(t){var n,e,i,r,n=this,e=n.Mf;e&&e.Ut.YSt(n,"showHeader",n.jO,t),(i=n.jO=t)?(0<n.Ky&&(n.Ky=n.Ky-1,n.Sx+=1),n.a5t()):(r=n.Ky,n.Ky=n.Ky+1,--n.Sx,n.u5t(r),n.s5t()),e&&y&&e.recalcRange(n.Ky+(t?0:-1),n.iw,1,n.Tx)},a.prototype.showFooter=function(t,n){var e,i,e=this;if(0===arguments.length)return e.oL;if(e.oL!==t){(i=e.Mf)&&i.suspendPaint();try{e.c5t(t,n||!1)}finally{i&&i.resumePaint()}}return e},a.prototype.expandBoundRows=function(t){var n=this;return 0===arguments.length?n.RSt:(n.RSt!==t&&(n.RSt=t),n)},a.prototype.c5t=function(t,n){var e,i,r,o,a,u,s,c,f,l,h,d,v,e=this,i=e.Mf;if(i&&i.Ut.YSt(e,Gn,e.oL,t),r=e.Sx,t){if((!i||e.Ky+r<i.getRowCount())&&(!n||e.f5t(!0,r)))for(e.oL=t,e.Sx+=1,a=(o=e.BSt).length,u=e.footerIndex(),s=e.iw,c=0;c<a;c++)h=s+c,(l=(f=o[c])&&f.footerFormula())&&(d=M(i,l,u,h))&&(l=j(i,d,u,h),f.footerFormula(l));e.l5t()}else e.oL=t,v=e.Ky+r-1,--e.Sx,e.u5t(v),e.I4t(),e.cL(0),n&&e.f5t(!1,r);i&&y&&i.recalcRange(e.Ky+e.Sx+(t?-1:0),e.iw,1,e.Tx)},a.prototype.f5t=function(t,n){var e,i,n,r,o,a,u,s,c,f,c,l,e=this,i=e.Mf,n=e.Ky+n,r=e.iw,o=e.Tx,a=r+o-1,u=gt(i,e),s=n<=u,c=O(i,new _.Range(n,r,u-n+1,a-r+1)),f,c=(c&&c.row)===n;return!(c&&bt(i,e,n,u,r,a,1)||(c&&s&&i.moveTo(n,r,l=t?n+1:n-1,r,u-n+1,o,2047),0))},a.prototype.h5t=function(t){for(var n,e,i,r,o,a,u,s,c,f,n=this,e=n.BSt,i=e.length,r=n.iw,o=[],a=n.name(),u=0;u<i;u++)s=r+u,c=n.getColumnName(u),o.push(fe(a,c)),t||(0===u?n.d5t(s,G().Table_Total,!0):u!==i-1||(f=e[u].footerFormula())||(n.v5t(s)?n.m5t(u,"=SUBTOTAL(109,".concat(a,"[").concat(c,"])")):n.m5t(u,"=SUBTOTAL(103,".concat(a,"[").concat(c,"])"))));n.OSt=o},a.prototype.v5t=function(t){for(var n,e,n,i,r,o,a,u,n=this,e=n.Mf,n=n.dataRange(),i=!0,r=n.rowCount,o=n.row,a=0;a<r;a++)if(u=e.getValue(o+a,t),!I(u)&&typeof u!==Vn){i=!1;break}return i},a.prototype.g5t=function(){return this.OSt&&0<this.OSt.length},a.prototype.p5t=function(t,n,e){var i=this,r=this.Mf;i.g5t()&&(r&&r.Ut.YSt(i,Cn,i.b5t(),e),0<=n)&&(e?i.OSt.splice(t,n,e):i.OSt.splice(t,n))},a.prototype.b5t=function(){var t,n=this.OSt,e=[];return n.forEach(function(t){t&&e.push(t.clone())}),e},a.prototype.y5t=function(t,n,e){var i=this,e=A(e)?fe(i.name(),e):B;i.g5t()&&i.p5t(t,n,e)},a.prototype.useFooterDropDownList=function(t){var n=this,e=n.Mf;return 0===arguments.length?n.ESt:(e&&(e.suspendPaint(),n.ESt!==t&&(e.Ut.YSt(n,"useFooterDropDownList",n.ESt,t),n.ESt=t,n.ESt)&&!n.g5t()&&(n.h5t(),n.w5t()),e.resumePaint()),n)},a.prototype.showResizeHandle=function(t){var n=this,e=n.Mf;return 0===arguments.length?n.jSt:(e&&(e.suspendPaint(),n.jSt!==t&&(e.Ut.YSt(n,"showResizeHandle",n.jSt,t),n.jSt=t),e.resumePaint()),n)},a.prototype.rowFilter=function(){var t=this;return!t.IB&&S.WSt&&(t.IB=new S.WSt(t),t.IB.Uct(t.dataRange())),t.IB},a.prototype.bindColumns=function(t){var n,e,i,r,o,a,u,s,c,f,s,l,n=this,e=[];if(t){for(i=t.length,n.autoGenerateColumns||(i=F(n.Tx,t.length)),n.jO&&n.Mf.KI(n.Ky,n.iw,1,i,3,17,L,!0),r=0;r<i;r++)(o=n.BSt[r])||(o=new H(n.M5t()),n.BSt[r]=o),u=(a=t[r]).id(),s=a.name(),c=a.dataField(),f=a.value(),s=It(n,s,r),o.id(u),o.name(s),o.dataField(c),o.value(f),o.cellType(a.cellType()),o.formatter(a.formatter()),c&&e.push(l={name:s,value:f,dataField:c}),n.y5t(r,1,s);n.vTt()}n.C5t=e,n.H3&&(n.H3.J$=e)},a.prototype.bindingPath=function(t){var n=this;return 0===arguments.length?n.S5t:(n.S5t=t,n.qSt(),n)},a.prototype.bind=function(t,n,e){var i,r,i=this,r=e;return I(t)||i.bindColumns(t),I(e)&&(r=i.z3()),n&&(i.S5t=n,r=(0,T.q$)(r,n)),T.$$&&r&&i.T5t(r),i},a.prototype.getColumnName=function(t){var n,n,t,n=this.BSt;return n&&0<=t&&t<n.length&&(n=n[t])?(t=n.name())!==B?u(t):t:B},a.prototype.setColumnName=function(t,n){var e,i,i,r,o,e=this;return e.cSt(n)||(i=e.BSt)&&0<=t&&t<i.length&&(r=(i=(i=i[t])||(e.BSt[t]=new H(e.M5t()))).name(),o=e.Mf,r!==n&&o&&(o.Ut.A5t(e,i,"name",r,n),i.name(n)),e.jO&&o&&o.setText(e.headerIndex(),e.iw+t,n),e.I5t(r,i.name(),t)),e},a.prototype.I5t=function(t,n,e){var i,r,o,i,i=this,r,o=i.BSt[e];i.y5t(e,1,o.name()),(i=this.LSt)&&i.onColumnNameChanged(t,n)},a.prototype.setColumnDataField=function(t,n){var e,i,i,t,r,e=this,i=e.BSt;return i&&0<=t&&t<i.length&&(i=(i=i[t])||(e.BSt[t]=new H(e.M5t())),t=e.Mf,r=i.dataField(),t&&n!==r&&t.Ut.A5t(e,i,"dataField",r,n),i.dataField(n)),e},a.prototype.getColumnDataField=function(t){var n,n,t,n=this.BSt;return n&&0<=t&&t<n.length&&(n=n[t])?(t=n.dataField())!==B?u(t):t:B},a.prototype.getColumnFormula=function(t){var n,e,n,i,t,n,n=this.BSt,e=this.Mf;return n&&e&&0<=t&&t<n.length&&(n=n[t])?(i=this.footerIndex(),t=this.iw+t,(n=n.footerFormula())&&M(e,n,i,t,!1)):B},a.prototype.setColumnFormula=function(t,n){return this.m5t(t,n),this},a.prototype.setColumnDataFormula=function(t,n){var e,i,i,r,o,a,u,s,t,c;if(y){if((i=(e=this).BSt)&&0<=t&&t<i.length&&(i=i[t])){for(r=e.Mf,lt(r),o=t+e.iw,a=e.Ky,u=e.Sx,e.showHeader()&&(a++,u--),e.showFooter()&&u--,s=j(r,n,a,o,!0),t=i.dataAreaFormula(),r&&s!==t&&r.Ut.A5t(e,i,"dataAreaFormula",t,n),i.x5t(n),i.dataAreaFormula(s),c=a;c<a+u;c++)k(r,c,o,n,s);ht(r,!1)}return e}},a.prototype.getColumnValue=function(t){var n,e,e,i,n=this,e=n.BSt;return e&&0<=t&&t<e.length&&(e=e[t])?n.oL&&e.footerFormula()&&(i=n.Mf)?i.getValue(n.footerIndex(),n.iw+t):e.footerValue():B},a.prototype.setColumnValue=function(t,n){var e,i,r,i,o,e=this,i=e.BSt,r=e.Mf;return i&&0<=t&&t<i.length&&((i=i[t])&&(o=i.footerValue(),r&&n!==o&&r.Ut.A5t(e,i,"footerValue",o,n),i.footerValue(n)),e.oL)&&r&&w(r,e.footerIndex(),e.iw+t,n),e},a.prototype.filterButtonVisible=function(t,n){var e,i,r,o,a,u,s,e=this,i=e.Mf,r=e.rowFilter();if(!(t<0||t>=e.Tx))switch((o=arguments).length){case 0:return r&&r.filterButtonVisible();case 1:if("number"==(u=typeof(a=o[0])))return r&&r.filterButtonVisible(a);if("boolean"==u&&r){for(st(i),s=0;s<e.Tx;s++)r.filterButtonVisible(s,a);ct(i)}return e;case 2:return r&&r.filterButtonVisible(t,n),e}},a.prototype.allowAutoExpand=function(t){var n=this,e=n.Mf;return 0===arguments.length?n.VSt:(n.VSt!==t&&(e.Ut.YSt(n,"allowAutoExpand",n.VSt,t),n.VSt=t),n)},a.prototype.N5t=function(){return!!this.LSt},a.prototype.Sg=function(t){var n=this,e=n.jS;n.k5t(t),n.Mf&&n.Mf.Ut&&n.Mf.Ut.D5t(n,e)},a.prototype.k5t=function(t){var n,e,n=this;n.jS=t,n.Mf=t&&t.Mf,e=n.IB,t&&e&&e.Mf!==t.Mf&&e.table(n)},a.prototype._5t=function(t){for(var n,e,i,r,o,a,u,s,c,f,l,h,d,v,n=this,e=n.Mf,i=e.getDefaultStyle(),r=n.Ky,o=n.iw,a=n.Sx,u=n.Tx,s={},c=e.parent,f=n.jO?1:0,l=f+(n.oL?1:0),h=0;h<u;h++)for(d=h+o,n.jO&&me(e,r,d,i,s,c,t),n.oL&&me(e,n.footerIndex(),d,i,s,c,t),v=0;v<a-l;v++)me(e,v+r+f,d,i,s,c,t)},a.prototype.E5t=function(t){var n=this,i=[];p(n.BSt,function(t,n){var e=n.dataField();e&&i.push({name:n.name(),value:n.value(),dataField:e})}),0<i.length&&(n.C5t=i,t.J$=n.C5t)},a.prototype.Woe=function(t){var n,e,i,r,i,t,o,n=this,e=n.Mf,i=n.dataRange(),r=i.row,i=D(i),t=t.getRowCount();i<t?n.RSt?(n.cue=!0,e.addRows(r+i,t-i),delete n.cue):((o=e.H3)&&o.Ctt&&(o.Stt=!0),n.mTt=!0,0===i?n.zpt(r,t,L,!0,!0):n.zpt(r+i-1,t-i,!0,!0,!0),delete n.mTt):t<i&&(n.RSt?e.deleteRows(r+t,i-t):(n.mTt=!0,n.yE(r+t,i-t,!0),delete n.mTt))},a.prototype.D3=function(t){var n,e,i,r,o,o,a,u,s,c,n=this,e=n.autoGenerateColumns(),i=n.IB&&n.IB.srt;if(n.s5t(),r=n.Mf,e&&(o=n.range(),n.d5(o.row,o.col,D(o),E(o)),n.l5t(o.col,E(o),!0)),n.E5t(t),t){if(o={row:n.Ky,col:n.iw,rowCount:n.Sx,colCount:n.Tx},n.Woe(t),n.H3=t,e){for(n.Tx=t.getColumnCount(),n.BSt=[],a=t.ltt(),u=0;u<n.Tx;u++)s=new H(u+1),n.BSt[u]=s,a&&(s.name(a[u]),s.dataField(a[u]));n.ESt&&(n.OSt=[],n.j5t(n.iw))}else c=[],n.BSt.forEach(function(t){var t=t.dataField();t&&c.push(t)}),t.htt(c);r&&r.Ut.YSt(n,P,o,{row:n.Ky,col:n.iw,rowCount:n.Sx,colCount:n.Tx})}else n.H3=t;n.IB&&(n.IB.Uct(n.dataRange()),n.IB.srt=i)},a.prototype.O5t=function(t){var n,e,i,e,r,o,a,n=this,e=n.H3;if(e&&(i=e.ltt()))for(r=(e=n.BSt[t-n.startColumn()])&&e.dataField(),o=0,a=i.length;o<a;o++)if(i[o]===r)return o;return-1},a.prototype.Sl=function(t,n){var e,i,r,o,t,r,e=!1,i=L,r=this,o=r.H3,t=t-r.dataRange().row;return o&&t<o.getRowCount()&&0<=(r=r.O5t(n))&&(e=!0,i=o.getValue(t,r).value),{e5t:e,y4:i}},a.prototype.Kbt=function(t,n,e,i){var r,o,a,u,s,c,u,i,f,f,i,r=this,o=r.H3,a=C(r,t),u=r.IB,c=!1;return o&&0<=(s=r.O5t(n))&&(i&&u&&u.isRowFilteredOut(t)||(u=(i=o.getValue(a,s)).value,(f=(f=r.Mf)&&f.Ut)&&i.hasBinding&&u!==e&&(i=wt(!0),r.R5t(t,a,i),f.B5t(r,t,B,i,$n.dirty),f.dE(t,n,{d6:u})),o.setValue(a,s,e,f&&f.G8)),c=!0),r.DSt=!0,c},a.prototype.ML=function(t,n,e){var i=new _.Style;return this.h5(t,n,i,e),i},a.prototype.L5t=function(t){var n,e,i,n=this.jS.xl,e=n[t];return e===L&&(i=this.Mf,e=n[t]=i.getRowHeight(t)),e},a.prototype.F5t=function(t){var n;return this.Mf.getColumnWidth(t)},a.prototype.h5=function(t,n,e,i){var r,o,a,u,s,i,c,f,l,h,d,v,m,g,p,b,l,y,w,M,C,C,C,C,C,C,C,h,y,d,w,f,S,T,A,i,I,x,N,k,D,C,r=this,o=r.style(),a=r.BSt,u=r.headerIndex(),s=r.footerIndex();if(o){if(c=r.Mf,f=r.jO,l=r.oL,h=r.highlightLastColumn(),d=r.highlightFirstColumn(),v=f?t===r.Ky+1:t===r.Ky,m=l?t===r.Ky+r.Sx-2:t===r.Ky+r.Sx-1,g=n===r.iw,p=n===r.iw+r.Tx-1,b=f?t===u:t===r.Ky,l=l?t===s:t===r.Ky+r.Sx-1,y=o[tn](),w=o[nn](),M=new _.Style,u===t)C=o[sn](),p&&h&&C&&C.h5(M,!0,!0,!0,!0),C=o[un](),g&&d&&C&&C.h5(M,!0,!0,!0,!0),(C=o[Xt]())&&C.h5(M,!0,g,!0,p),p&&h&&y&&y.h5(M,!0,!0,!1,!0),g&&d&&w&&w.h5(M,!0,!0,!1,!0);else if(s===t)C=o[fn](),p&&h&&C&&C.h5(M,!0,!0,!0,!0),C=o[cn](),g&&d&&C&&C.h5(M,!0,!0,!0,!0),(C=o[qt]())&&C.h5(M,!0,g,!0,p),p&&h&&y&&y.h5(M,!1,!0,!0,!0),g&&d&&w&&w.h5(M,!1,!0,!0,!0);else{if(p&&h&&y&&y.h5(M,b,!0,l,!0),g&&d&&w&&w.h5(M,b,!0,l,!0),C=f?t-r.Ky-1:t-r.Ky,h=n-r.iw,A=T=S=f=w=d=y=void 0,i=!i||"cellType"!==i&&"formatter"!==i,r.bandRows()&&i&&0<(d=(y=o[ln]())+o[hn]())){if(void 0===(w=r.HSt[t])){if(_.Be.Fl&&_.Be.Gl){for(I=_.Be.Gl,x=r.dataRange().row;-1===I[x];)x++;if(t<x)return;C=I[t]-I[x]}else if(c){for(N=0,x=r.dataRange().row;x<t;x++)0<r.L5t(x)&&N++;C=N}w=r.HSt[t]=C%d}f=o[en](),S=o[rn](),w<y&&f?f.h5(M,T=0===w,g,A=m||w===y-1,p):y<=w&&S&&S.h5(M,T=w===y,g,A=m||w===d-1,p)}if(r.bandColumns()&&i&&0<(d=(y=o[dn]())+o[vn]())){if(void 0===(w=r.zSt[n])){if(k=0,c)for(D=r.iw;D<n;D++)0<r.F5t(D)&&k++;w=r.zSt[n]=k%d}f=o[on](),S=o[an](),w<y&&f?f.h5(M,v,T=0===w,m,A=p||w===y-1):y<=w&&S&&S.h5(M,v,T=w===y,m,A=p||w===d-1)}he(a,h,M)}(C=o[$t]())&&C.h5(M,b,g,l,p),r.P5t(e,M)}else u!==t&&s!==t&&(i=he(a,n-r.iw))&&r.P5t(e,i)},a.prototype.i5t=function(t,n,e){var i,r,o,a,u,t,r,n,i=this,r=i.oL,o=i.ESt,a,u;i.footerIndex()===t&&r&&i.g5t()&&(t=i.OSt[n-i.iw])&&o&&(r=e.cellButtons,n=e.dropDowns,I(r)&&(r=[]),e.cellButtons=r.concat(t.cellButtons),I(n)&&(n=[]),e.dropDowns=n.concat(t.dropDowns))},a.prototype.P5t=function(t,n){var t=t,e=20,i,i,i,i;I(t.backColor)&&(t.backColor=n.backColor),Ot(t.foreColor)&&(t.foreColor=n.foreColor),I(t.themeFont)&&I(t.font)?(t.themeFont=n.themeFont,t.font=n.font):!I(t.themeFont)&&I(t.font)&&(t.font=n.font),I(t.borderLeft)&&(i=n.borderLeft,t.borderLeft=i&&i.Gf()||i,t.borderLeft)&&(t.borderLeft.level=20),I(t.borderTop)&&(i=n.borderTop,t.borderTop=i&&i.Gf()||i,t.borderTop)&&(t.borderTop.level=20),I(t.borderRight)&&(i=n.borderRight,t.borderRight=i&&i.Gf()||i,t.borderRight)&&(t.borderRight.level=20),I(t.borderBottom)&&(i=n.borderBottom,t.borderBottom=i&&i.Gf()||i,t.borderBottom)&&(t.borderBottom.level=20),I(t.textDecoration)&&(t.textDecoration=n.textDecoration),I(t.cellType)&&(t.cellType=n.cellType),I(t.formatter)&&(t.formatter=n.formatter)},a.prototype.G5t=function(t,n){var e,i,r,o,a,u,e=this;if((t!==e.Ky||n!==e.iw)&&(i=e.Mf)){if((t<0||i.getRowCount()<t+e.Sx||n<0||i.getColumnCount()<n+e.Tx)&&N(G().Exp_TableMoveOutOfRange),a=o=void 0,r=e.jS)for(a=0,u=(o=r.U3).length;a<u;a++)if(o[a]===e){o.splice(a,1),e.U5t();break}i.moveTo(e.Ky,e.iw,t,n,e.Sx,e.Tx,3),o&&a<=u&&(e.H5t(t,n),o.splice(a,0,e),e.z5t()),this.cL(1)}},a.prototype.H5t=function(t,n){var e,i,e=this,i=e.Mf;i&&i.Ut.YSt(e,P,{row:e.Ky,col:e.iw,rowCount:e.Sx,colCount:e.Tx},{row:t,col:n,rowCount:e.Sx,colCount:e.Tx}),e.Ky=t,e.iw=n,e.V5t(),e.dl()},a.prototype.U5t=function(t,n,e){var i,r,o,a,u,s,c,f,l,h,d,v,m,g,p,b,i=this,r=i.Mf;if(r&&y){for(o=i.BSt,a=i.footerIndex(),u=i.range(),c=(s=i.dataRange()).row,f=D(s),I(t)&&(t=0,n=o.length);t<n;t++)if(l=o[t],h=u.col+t,l){for(l.footerFormula()&&0<=a&&(k(r,a,h,B),w(r,a,h,B)),d=l.x5t(),v=Dt(d),g=m=void 0,p=0;p<f;p++)m=r.getFormula(g=c+p,h),I(m)||(I(i.Y5t)&&(i.Y5t=[]),k(r,g,h,B),i.Y5t.push({row:g,col:h,formula:m})),I(m)||!I(v)&&M(r,j(r,v,i.Ky,h),g,h)===m||(I(i.Z5t)&&(i.Z5t=[]),b=_t(i.Z5t,h),I(b)?((b={}).col=h,b.rowIndexes=[],b.rowIndexes.push(g),i.Z5t.push(b)):b.rowIndexes.push(g));if(l.x5t(L),l.dataAreaFormula())for(p=0;p<f;p++)k(r,g=c+p,h,B),w(r,g,h,B)}!0===e&&(i.Y5t=[])}},a.prototype.W5t=function(t,n,e){var i,r,o,a,u,s,c,f,u,i=this,r=i.Mf,o=i.Y5t;if(o&&0<o.length){for(s=0;s<o.length;s++)a=!0,(u=o[s])&&(c=u.row,f=u.col,u=u.formula,t<=c&&(!0===e&&(c+=n),!1===e)&&(c<t+n?a=!1:c-=n),a)&&k(r,c,f,u);i.Y5t=[]}i.Xyt(t,n,!0,e)},a.prototype.Q5t=function(t,n,e){var i,r,o,a,u,s,c,f,u,l,h,d,v,m,g,p,b,y,w,M,C,S,T,A,g,i=this,r=i.Mf,o=i.Y5t;if(o&&0<o.length){for(s=0;s<o.length;s++)a=!0,(u=o[s])&&(c=u.row,f=u.col,u=u.formula,t<=f&&(!0===e&&(f+=n),!1===e)&&(f<t+n?a=!1:f-=n),a)&&k(r,c,f,u);for(l=i.Z5t||[],h=void 0,s=0;s<l.length;s++)(h=l[s])&&t<=(d=h.col)&&(!0===e&&(h.col+=n),!1===e)&&t+n<=d&&(h.col-=n);for(i.Xyt(t,n,!1,e),m=(v=i.BSt).length,p=(g=i.dataRange()).row,b=g.col,y=g.rowCount,T=S=C=M=w=void 0,s=0;s<m;s++)if(T=b+s,(M=v[s])&&(C=M.dataAreaFormula())){for(w=p,A=0;A<l.length;A++)if((h=l[A])&&h.col===T){for(;-1<h.rowIndexes.indexOf(w)&&w<p+y;)w++;break}w<p+y&&(S=r.getFormula(w,T))&&M.dataAreaFormula(j(r,S,p,T))}i.Y5t=[],i.Z5t=[]}else(g=r.b8&&(r.parent||r).xyt())&&0<g.length&&i.Xyt(t,n,!1,e,L,!0)},a.prototype.Xyt=function(t,n,e,i,r,o){var a,u,s,c,f,l,h,d,v,f,m,m,g,p,b,y,w,M,a=this,u=a.Mf,s=a.BSt,c=a.footerIndex(),f=a.dataRange(),l=f.row,h=f.col,d=f.rowCount,v=f.colCount,f=u.b3(),m=u.Lp;if(m&&f&&(m=m.Hyt()))if(w=f.rT,o)w.Iyt=!0,m.Xyt(w,t,n,e,i,!0),delete w.Iyt;else if(r||(m.Zyt(f,l,h,d,v),m.Xyt(w,t,n,e,i,!0)),a.oL)for(r||(m.Zyt(f,c,h,1,v),m.Xyt(f.rT,t,n,e,i,!1)),M=0;M<v;M++)(g=s[M])&&(y=h+M,p=g.footerFormula())&&(b=u.getFormula(c,y))&&(u&&u.Ut.A5t(a,g,"footerFormula",p,b),g.footerFormula(j(u,b,c,y)))},a.prototype.z5t=function(){var t,u,s,c,f,t=this,u=t.Mf;u&&y&&(s=t.footerIndex(),c=t.range(),f=t.dataRange(),p(t.BSt,function(t,n){var e,t,i,r,o,a,e=c.col+t,t=n.footerFormula(),i=n.dataAreaFormula();if(t&&0<=s&&k(u,s,e,B,t),i)for(r=0,o=D(f);r<o;r++)a=f.row+r,k(u,a,e,B,i)}))},a.prototype.K5t=function(t){var n,e,i,r,o,a,u,s,c,f,l,h,d,v,m,f,g,p,i,t,b,y,w,r,a,u,c,t,i,a,r,f,r,n=this,e=n.dataRange();if(!t.equals(n.range())){if(i=t.row,r=t.col,o=D(t),a=E(t),u=n.jO,s=n.oL,c=n.ESt,f=0,l=1,u&&(f+=1),s&&(f+=1),(v=n.Mf)&&((o<f||a<1||i+o>v.getRowCount()||r+a>v.getColumnCount())&&N(G().Exp_TableResizeOutOfRange),i===n.Ky&&t.intersect(n.Ky,n.iw,n.Sx,n.Tx)||N(G().Exp_TableResizeInvalidRange),d={row:n.Ky,col:n.iw,rowCount:n.Sx,colCount:n.Tx},h=n.BSt.slice()),m=n.BSt,g=(f=r)+a-1,p=n.iw,i=n.iw+n.Tx-1,t=n.Tx,n.iw=r,n.Tx=a,f<p){for(b=0,y=f;y<p;y++)w=new H(n.M5t()),m.splice(b,0,w),b++;u&&n.a5t(0,p-f),s&&n.l5t(0,p-f)}else f<=i&&(n.U5t(p,f),m.splice(0,f-p));if(i<g){for(y=1+i;y<=g;y++)w=new H(n.M5t()),m.push(w);u&&n.a5t(t,g-i),s&&n.l5t(t,g-i),c&&n.j5t(t)}else p<=g&&(n.U5t(g,i),m.splice(m.length-(i-g),i-g));o!==n.Sx&&(r=n.H3,u=(a=n.dataRange()).row,c=D(a),r?o>n.Sx?(t=u+c-1,i=o-n.Sx,!v||(r=O(v,new _.Range(a=t+i+1,f,v.getRowCount()-a,g)))&&r.row<a||n.N4t(t,i,!0,!1)):v&&(f=n.Sx-o,n.yE(u+c-f,f)):(r=void 0,s&&(n.l5t(),r=n.footerIndex()),n.Sx=o,n.J5t(),s&&(n.w5t(),n.u5t(r)))),v&&(v.Ut.YSt(n,P,d,{row:n.Ky,col:n.iw,rowCount:n.Sx,colCount:n.Tx}),v.Ut.YSt(n,Un,h,n.BSt.slice())),n.dl(),n.V5t(!1),n.X5t(e,n.dataRange()),n.I4t(),n.cL(0)}},a.prototype.X5t=function(t,n){var e,i,r,o,a,u,s,c,t,f,n,l,e,i=this.LSt;i&&(r=t.col,o=D(t),a=E(t),u=n.col,s=D(n),c=E(n),t=t.row+o,f=r+a,l=u+c,(n=n.row+s)<t&&i.onRowsRemoved(s,t-n),t<n&&i.onRowsAdded(o,n-t),r<u&&i.onColumnsRemoved(0,u-r),l<f&&i.onColumnsRemoved(c,f-l),u<r&&i.onColumnsAdded(0,r-u),f<l)&&i.onColumnsAdded(r+a-u,l-f)},a.prototype.V5t=function(t){var n=this,e=n.IB;e&&(e.Uct(n.dataRange()),!1!==t)&&e.reFilter()},a.prototype.s5t=function(){var t=this.IB;t&&(t.unfilter(),t.reset())},a.prototype.cSt=function(t,n){var e,i;for(t!==B&&(t=u(t)),e=0;e<this.Tx;e++)if(e!==n&&t===(i=this.getColumnName(e)))return!0;return!1},a.prototype.q5t=function(t){var n,e,t,n,e,n=this,e=n.BSt;return n.jO&&e&&0<=(t=t-n.iw)&&t<e.length&&(n=e[t])?(e=n.name(),I(e)?e:u(e)):B},a.prototype.$5t=function(t,n){var e,i,r,t,r,i,o,e=this,i=e.BSt;e.jO&&i&&(r=i.length,0<=(t=t-e.iw))&&t<r&&(r=i[t])&&(i=r.name(),(o=e.Mf)&&n!==i&&o.Ut.A5t(e,r,"name",i,n),r.name(n),e.I5t(i,r.name(),t))},a.prototype.m5t=function(t,n,e){var i,r,o,a,u,r,t,i=this,r=i.BSt,o=i.footerIndex(),a=i.iw+t,u=i.Mf;y&&0<=t&&t<r.length&&(r=r[t],n&&!e&&u&&(e=j(u,n,o,a),i.oL)&&k(u,o,a,n,e),r)&&(t=r.footerFormula(),u&&e!==t&&u.Ut.A5t(i,r,"footerFormula",t,n),r.footerFormula(e))},a.prototype.d5t=function(t,n,e){var i,r,e,r,e,o,i=this,r=i.BSt;(e||i.oL)&&r&&0<=(e=t-i.iw)&&e<r.length&&(r=r[e])&&(n!==(e=r.footerValue())&&(o=i.Mf)&&(o.Ut.A5t(i,r,"footerValue",e,n),o.Ut.dE(i.Ky+i.Sx-1,t,{d6:r.footerValue()})),r.footerValue(n))},a.prototype.M5t=function(){for(var t,n,e,i,r,t=this.BSt,n=t&&t.length,e=[],r=0;r<n;r++)(i=t[r])&&i.tTt()&&e.push(i.id());if(e.sort(function(t,n){return t-n}),0<(n=e.length)){for(r=0;r<n;r++)if(e[r]!==r+1)return r+1;return n+1}return 1},a.prototype.nTt=function(t,n){var e,i,r,n;if(!I(t)&&!this.cSt(t,n))return t;if(i=mn,r=0,t)i=t,r=1;else if(0<n&&(t=this.BSt[n-1].name(),n=/[0-9]+$/.exec(t))){if(i=t.substr(0,n.index),r=parseInt(t.substr(n.index),10),!this.cSt(e=i+(r+1)))return e;i=t,r=1}for(;;)if(!this.cSt(e=i+ ++r))return e},a.prototype.a5t=function(t,n,e,i){var r,o,a,u,s,c,f,l,h,d,v,m,v,r=this,o=r.BSt,a=r.Mf;if(r.jO&&o&&a)for(u=o.length,s=r.headerIndex(),c=r.iw,I(t)&&(t=0),I(n)&&(n=u),l=F(u,t+n),d=t;d<l;d++)(f=o[d])&&(v=r.jS.U3,-1<(m=g(r,v))&&v.splice(m,1),h=jt(a.getValue(s,c+d)),-1<m&&v.splice(m,0,r),k(a,s,c+d,B),h)&&(e?(r.eTt=e,a.setText(s,c+d,f.name()),delete r.eTt):(y&&a.gL(s,c+d),(v=i?h:r.nTt(h,d))===h?(a.Ut.A5t(r,f,"name",f.name(),h),f.name(h)):a.setText(s,c+d,v)))},a.prototype.j5t=function(t){for(var n,e,i,n=this.BSt,e=t;e<n.length;e++)i=fe(this.name(),n[e].name()),this.OSt.push(i)},a.prototype.l5t=function(t,n,e){var i,r,o,a,u,s,c,f,l,h,d,l,h,v,i=this,r=i.BSt,o=i.Mf;if(i.oL&&r&&o)for(i.useFooterDropDownList()&&!i.g5t()&&i.h5t(),a=r.length,u=i.footerIndex(),s=i.iw,I(t)&&(t=0),I(n)&&(n=a),I(e)&&(e=i.iTt),f=F(a,t+n),d=t;d<f;d++)(c=r[d])&&(h=o.getValue(u,s+d),I(h)||e?(i.eTt=e,w(o,u,s+d,c.footerValue()),delete i.eTt):(h!==(l=c.footerValue())&&o.Ut.A5t(i,c,"footerValue",l,h),c.footerValue(h)),(l=o.bMt&&o.bMt(u,s+d))&&!e?(l!==(h=c.dataAreaFormula())&&(v=M(o,l,u,s+d),o.Ut.A5t(i,c,"dataAreaFormula",h,v)),c.footerFormula(l)):i.rTt||(i.eTt=e,k(o,u,s+d,B,c.footerFormula()),delete i.eTt))},a.prototype.oTt=function(t,n){var e,i,r,o,a,u,s,c,e=this,i=e.BSt;if(e.jO&&i)for(r=i.length,I(t)&&(t=0),I(n)&&(n=r),a=F(r,t+n),u=t;u<a;u++)(o=i[u])&&(s=o.name(),(c=e.Mf)&&s!==B&&c.Ut.A5t(e,o,"name",s),o.name(B),e.I5t(s,o.name(),u))},a.prototype.aTt=function(t){var n,e,i,r,o,a,u,s,c,t,n=this,e=n.dataRange();if(e.containsRange(t)){for(i=t.row,r=t.col,o=D(t),a=E(t),u=[],s=0;s<o;s++)for(c=0;c<a;c++)n.Kbt(i+s,r+c,B,!0),u.push({columnName:n.getColumnName(r+c-e.col),row:i+s-e.row,data:""});(t=n.LSt)&&t.onDataChanged(u)}},a.prototype.uTt=function(t,n){var e,i,r,o,a,u,s,s,e=this,i=e.BSt;if(e.oL&&i)for(I(t)&&(t=0),I(n)&&(n=i.length),o=F(i.length,t+n),a=t;a<o;a++)(r=i[a])&&(u=e.Mf,s=r.footerFormula(),u&&B!==s&&u.Ut.A5t(e,r,"footerFormula",s),r.footerFormula(B),s=r.footerValue(),u&&B!==s&&u.Ut.A5t(e,r,"footerValue",s),r.footerValue(B))},a.prototype.w5t=function(){var t,n,e,i,r,o,a,u,s,t=this,n=t.BSt;if(t.oL&&n&&(e=t.Mf))for(i=n.length,o=t.iw,u=t.footerIndex(),s=0;s<i;s++)(r=n[s])&&(w(e,u,a=o+s,r.footerValue()),k(e,u,a,B,r.footerFormula()))},a.prototype.u5t=function(t){var n,e,i,r,o,a,n=this,e=n.Mf;if(e&&!(t<0||e.getRowCount()<=t))for(i=n.iw,r=n.Tx,a=0;a<r;a++)k(e,t,o=i+a,B),w(e,t,o,B)},a.prototype.JO=function(t,n,e,i,r,o){var a,u,e,s,c,f,l,o,e,a=this,u=!1,e=e?1:0,s=a.jO&&1===a.Sx;return!s&&t>=a.Ky+a.Sx+e||((c=a.Mf)&&(f=c.Ut,l={row:a.Ky,col:a.iw,rowCount:a.Sx,colCount:a.Tx}),o||a.sTt(t,n,!1),o=a.Ky,e=a.Ky+a.Sx-1+e,t<=o&&!r?a.Ky+=n:(t<=e||s)&&(i||(u=a.cTt(t,n)),a.Sx+=n),c&&f.YSt(a,P,l,{row:a.Ky,col:a.iw,rowCount:a.Sx,colCount:a.Tx})),u},a.prototype.t5t=function(t,n,e){var i,r,r,o,e,a,a,i=this,r=i.Ky+i.Sx-1;!e&&t>=i.Ky&&t<=r&&i.J5t(t,n),e||(i.Xyt(t,n,!0,!0,!0),i.fTt()),r=i.LSt,e=(o=i.dataRange()).row,a=i.endRow(),e<=t&&t<=a&&r&&r.onRowsAdded(t-e,n),(a=i.IB)&&(i.DSt=!0,a.JO(t,n),i.lTt)&&i.Mf.filterRowsVisibleInfo.rE(t,n)},a.prototype.cTt=function(t,n){var e,i,r,r,o,e=this,i=e.H3;return!!i&&(o=void 0,(r=(r=this.Mf)&&r.Ut.G8)&&!(o=r.tableChanges)&&(r.tableChanges=o=[]),i.kE(C(e,t),n,o),!0)},a.prototype.J5t=function(o,a){var u,s,t;y&&(s=(u=this).Mf,t=u.dataRange(),I(o)&&(o=t.row),I(a)&&(a=t.rowCount),lt(s),p(u.BSt,function(t,n){var e,i,r,e=n.dataAreaFormula();if(e)for(i=t+u.iw,r=o;r<o+a;r++)k(s,r,i,B,e)}),ht(s,!1))},a.prototype.fTt=function(){var a,t,u,n,s,c;y&&(t=(a=this).Mf,u=t.b3(),n=a.dataRange(),I(s)&&(s=n.row),I(c)&&(c=n.rowCount),lt(t),p(a.BSt,function(t,n){var n,e,i,r,o,n=n.hTt();if(n&&n.isArrayFormula)for(e=n.isDynamicArray,i=t+a.iw,r=s;r<s+c;r++)I(u.sT(r,i))&&u.Uyt(r,i,o={row:r,col:i,rowCount:1,colCount:1,isDynamicArray:e})}),ht(t,!1))},a.prototype.qO=function(t,n,e,i,r){var o,e,a,u,s,c,f,l,h,d,v,m,v,v,r,o=this,e=e?1:0;if(!(t>=o.iw+o.Tx+e)){if(u=o.iw,(f=o.Mf)&&(c={row:o.Ky,col:o.iw,rowCount:o.Sx,colCount:o.Tx},s=o.BSt.slice()),t<=o.iw&&!r)o.iw+=n;else if(t<o.iw+o.Tx+e&&(a=!0,o.Tx+=n,l=o.BSt)){for(h=t-o.iw,d=0;d<n;d++)v=o.M5t(),m=h+d,(v=new H(v)).name(o.nTt(B,m)),l.splice(m,0,v),v=o.getColumnName(m),o.y5t(m,0,v);i&&o.a5t(h,L,!0)}o.IB&&o.IB.qO(t,n,a),u<=t&&(r=o.LSt)&&r.onColumnsAdded(t-u,n),f&&(f.Ut.YSt(o,P,c,{row:o.Ky,col:o.iw,rowCount:o.Sx,colCount:o.Tx}),f.Ut.YSt(o,Un,s,o.BSt.slice()))}},a.prototype.n5t=function(){var t,n,e,i,r,o,a,t=this,n,e=t.Mf.b3();e&&t.oL&&(i=t.BSt,r=t.footerIndex(),o=t.iw,i.forEach(function(t,n){a=e.pB(r,o+n),I(a)||t.footerFormula(a)}))},a.prototype.xP=function(t,n,e,i,r){var o,a,u,s,u,c,f,l,h,l,d,v,m,g,p,l,b,y,w,o=this,a=!1;if(!(t>=o.Ky+o.Sx)&&(s=(u=o.dataRange()).row,u=D(u),c=o.Ky,f=o.Ky+o.Sx-1,l=o.Mf,h=o.H3,m=[],p="_backupRowsChange",l&&(d=l.Ut)&&(g={row:o.Ky,col:o.iw,rowCount:o.Sx,colCount:o.Tx},m.push(P),l=d.G8)&&!(v=l.tableChanges)&&(l.tableChanges=v=[]),r||o.sTt(t,n,!0),t<c?t+n<=c&&(o.Ky-=n):t===c?o.jO||(o.Sx-=F(f-t+1,n),!e&&h&&(m.push(p),h.btt(C(o,t),F(f-t+1,n),v),a=!0)):t<=f&&(o.Sx-=F(f-t+1,n),!e&&h&&(m.push(p),h.btt(C(o,t),F(f-t+1,n),v),a=!0),t===f)&&o.oL&&(m.push(Gn),o.oL=!1),o.IB&&(o.DSt=!0,o.IB.xP(t,n)),s<=t&&t<s+u&&(l=o.LSt)&&l.onRowsRemoved(t-s,n),d)&&m&&0<m.length)for(b=0,y=m;b<y.length;b++)switch(w=y[b]){case P:d.YSt(o,P,g,{row:o.Ky,col:o.iw,rowCount:o.Sx,colCount:o.Tx});break;case Gn:d.YSt(o,Gn,o.oL);break;case p:d.B5t(o,t,n,i,$n.deleted)}return a},a.prototype.NP=function(t,n){var e,i,r,o,a,u,s,c,i,e=this,i=e.BSt;t>=e.iw+e.Tx||((r=e.Mf)&&(o={row:e.Ky,col:e.iw,rowCount:e.Sx,colCount:e.Tx},a=e.BSt.slice()),u=e.iw,s=e.iw,c=e.iw+e.Tx-1,t<s?t+n<=s?e.iw-=n:(e.iw=t,e.Tx-=t+n-s,i&&(i.splice(0,t+n-s),e.y5t(0,t+n-s))):(e.Tx-=F(c-t+1,n),i&&(i.splice(t-s,F(c-t+1,n)),e.y5t(t-s,F(c-t+1,n)))),e.IB&&e.IB.NP(t,n),u<=t&&(i=e.LSt)&&i.onColumnsRemoved(t-u,n),r&&(r.Ut.YSt(e,P,o,{row:e.Ky,col:e.iw,rowCount:e.Sx,colCount:e.Tx}),r.Ut.YSt(e,Un,a,e.BSt.slice())))},a.prototype.d5=function(t,n,e,i){var r,o,a,u,u,s,c,f,l,h,h,d,h,h,h,u,r=this,o=e,a=i,u=r.Mf;u&&(o=u.getRowCount(),a=u.getColumnCount()),l=(0,_.Ec)(u=t<0?0:t,s=n<0?0:n,c=t<0?o:e,f=n<0?a:i),h=r.headerIndex(),r.jO&&u<=h&&h<u+c&&(h=(0,_.Ec)(h,r.iw,1,r.Tx),d=l.getIntersect(h,o,a))&&r.oTt(d.col-r.iw,E(d)),h=r.dataRange(),(h=l.getIntersect(h,o,a))&&r.aTt(h),h=r.footerIndex(),r.oL&&u<=h&&h<u+c&&(u=(0,_.Ec)(h,r.iw,1,r.Tx),d=l.getIntersect(u,o,a))&&r.uTt(d.col-r.iw,E(d)),r.IB&&r.IB.d5(t,n,e,i)},a.prototype.toJSON=function(t,n){var e,i,r,o,a,u,s,c,f,l,h,d,v,e=this,i=e.style(),r=e.rowFilter(),o="columns";for(I(t)?a=e.name():e.Gwt=a=t,u={name:[a,B],row:[e.Ky,-1],col:[e.iw,-1],rowCount:[e.Sx,-1],colCount:[e.Tx,-1],showHeader:[e.jO,!0],showFooter:[e.oL,!1],useFooterDropDownList:[e.ESt,!1],showResizeHandle:[e.jSt,!1],highlightFirstColumn:[e.highlightFirstColumn(),!1],highlightLastColumn:[e.highlightLastColumn(),!1],bandRows:[e.bandRows(),!0],expandBoundRows:[e.expandBoundRows(),!1],bandColumns:[e.bandColumns(),!1],style:[i?i.toJSON():B,B],autoGenerateColumns:[e.autoGenerateColumns(),!0],bindingPath:[e.bindingPath(),L],rowFilter:[r?r.toJSON():B,B],reservedElement:[ve(e.dTt),B],allowAutoExpand:[e.VSt,!0],columns:[[]]},s=0;s<e.BSt.length;s++)f=(c=e.BSt[s].toJSON())[bn],l=c[wn],f&&(n&&n.ignoreFormula?(delete c[bn],c[Mn]=e.Mf.getValue(e.Ky+e.Sx-1,e.iw+s)):c[bn]=M(e.Mf,f,e.footerIndex(),s+e.iw)),l&&(c[wn]=M(e.Mf,l,e.dataRange().row,s+e.iw)),u[o][0][s]=c;for(d in u[o][1]=B,h={},u)(v=u[d])[0]!==v[1]&&(h[d]=v[0]);return m(h)?L:h},a.prototype.wh=function(t,n,e,i,r){var o,a,u,s,c,f,l,h,e,d,v,m,g,p,b,y,w,M,M,y,e,C,r,S,T,o=this,a=o.Mf,u=a.name(),s=o.style(),c=o.rowFilter(),f=o.BSt,l=e.styleManager,h=e.sharedStrings;if(t.xmlns=_.XFileConstants.Qu,t.id=o._id,t.c_=[],t.n_=_.XFileConstants.du,(e=o.name()||B)&&(e=e.split(" ").join("_"),t.name=e,t.displayName=be(e.split("-").join("_"),r)),t.ref=Rt([o.range()]),!0!==o.jO&&(t.headerRowCount=0),!1!==o.oL&&(t.totalsRowCount=1),c&&!a.NMi&&c.wh(t,l,i),f&&0<f.length){for(d=[],v=o.footerIndex(),m=o.dataRange().row,g=o.iw,p=void 0,b=0;b<f.length;b++)y=f[b],w=b+o.iw,M=y.name(),o.jO&&!I(M)&&(I(p)&&(p=at(n,u)),ut(p,o.Ky,w,""+M,h)),d.push(y.wh(a,m,v,b+g,i,M={})),y=M.v,o.oL&&!I(y)&&(I(p)&&(p=at(n,u)),ut(p,o.Ky+o.Sx-1,w,""+y,h));e={n_:"tableColumns",count:f.length,c_:d},t.c_.push(e)}s&&(s.builtInName()?C="TableStyle"+s.builtInName():(C=s.name(),I(C)&&(C="CustomTableStyle_"+te(),s.name(C)))),(r={n_:"tableStyleInfo",name:C}).showFirstColumn=!1!==o.highlightFirstColumn()?"1":"0",r.showLastColumn=!1!==o.highlightLastColumn()?"1":"0",r.showRowStripes=!0!==o.bandRows()?"0":"1",r.showColumnStripes=!1!==o.bandColumns()?"1":"0",t.c_.push(r),S={useFooterDropDownList:[o.ESt,!1],showResizeHandle:[o.jSt,!1],expandBoundRows:[o.expandBoundRows(),!1],autoGenerateColumns:[o.autoGenerateColumns(),!0],bindingPath:[o.bindingPath(),L],extLst:[o.dTt,B],allowAutoExpand:[o.VSt,!0]},T=t.lossless={},Object.keys(S).forEach(function(t){var n=S[t];n[0]!==n[1]&&(T[t]=n[0])})},a.prototype.fromJSON=function(e,t,n){var i,r,o,a,u,s,o,a,u,s,o,a,u,s,o,a,u,s,o,c,f,l,h,d,v,m,g,r,u,a,s;if(e){if(r=(i=this).Mf,p([Ht,Zt,Wt,Qt,Jt,Kt],function(t,n){A(e[n])&&i[n](e[n],!1)}),o=e.row,A(o)&&(i.Ky=o),a=e.col,A(a)&&(i.iw=a),u=e.rowCount,A(u)&&(i.Sx=u),s=e.colCount,A(s)&&(i.Tx=s),ye(r,new _.Range(o,a,u,s))&&(r.rowFilter().reset(),r.rowFilter(void 0)),o=e.showHeader,A(o)&&(i.jO=o),a=e.showFooter,A(a)&&(i.oL=a),u=e.expandBoundRows,A(u)&&(i.RSt=u),s=e.useFooterDropDownList,A(s)&&(i.ESt=s),o=e.showResizeHandle,A(o)&&(i.jSt=o),(a=e.style)&&((u=new b.TableTheme).fromJSON(a,t),i.style(u)),s=e.dataSource,o=e.dataBinding,a=e.bindingPath,t?(s&&T.$$&&(i.H3=new T.$$,i.H3.bind(s)),o&&T.$$&&(i.H3=new T.$$,i.H3.fromJSON(o))):a&&(i.S5t=a,u=r&&r.getDataSource&&r.getDataSource(),T.CellBindingSource)&&u instanceof T.CellBindingSource&&(s=(0,T.q$)(u.getSource(),a))&&(i.H3=new T.$$,i.H3.bind(s)),o=e.columns){for(f=(c=o).length,l=i.BSt=[],d=h=void 0,v=0;v<f;v++)d=c[v],(h=new H(i.M5t())).fromJSON(d),m=h.name(),g=i.nTt(m,v),l.push(h),g!==m&&i.setColumnName(v,g);i.vTt()}i.ESt&&i.h5t(!0),(r=e.rowFilter)&&(u=S.WSt&&new S.WSt)&&(u.table(i),u.fromJSON(r,t),i.IB=u,n?i.IB.reFilter():(i.DSt=!0,i._St())),(a=e.reservedElement)&&(i.dTt=a),s=e.allowAutoExpand,A(s)&&(i.VSt=s)}},a.prototype.yh=function(t,n,e){var i,r,o,e,r,r,a,u,s,c,f,f,f,s,t,l,h,d,f,v,v,v,m,g,p,b,y,w,y,M,C;if(t){if(r=t.ref,o=e&&e.onlyTableData,e=e&&e.isApplyRefilter,(i=this).name(t.name),I(r)||(r=Bt(r,!0)[0],i.Ky=r.row,i.iw=r.col,i.Sx=r.rowCount,i.Tx=r.colCount),i.jO=1<=K(t.headerRowCount,1),i.oL=1<=K(t.totalsRowCount,-1),r=x(t,"tableColumns"),a=x(t,"autoFilter"),u=x(t,"sortState"),s=x(t,"tableStyleInfo"),c=x(t,"extLst"),!o&&s&&(f=s.name,I(f)||(f=n.getTableTheme(f),i.style(f)),I(s.showFirstColumn)||i.highlightFirstColumn(X(s.showFirstColumn,!1)),I(s.showLastColumn)||i.highlightLastColumn(X(s.showLastColumn,!1)),I(s.showRowStripes)||i.bandRows(X(s.showRowStripes,!1)),I(s.showColumnStripes)||i.bandColumns(X(s.showColumnStripes,!1))),f=t.lossless,o||I(f)||(s=f.bindingPath,t=f.autoGenerateColumns,l=f.expandBoundRows,h=f.useFooterDropDownList,d=f.showResizeHandle,f=f.allowAutoExpand,s&&(i.S5t=s,v=(v=i.Mf)&&v.getDataSource&&v.getDataSource(),T.CellBindingSource)&&v instanceof T.CellBindingSource&&(v=(0,T.q$)(v.getSource(),s))&&(i.H3=new T.$$,i.H3.bind(v)),A(t)&&i.autoGenerateColumns(t),A(l)&&(i.RSt=l),A(h)&&(i.ESt=h),A(d)&&(i.jSt=d),A(f)&&(i.VSt=f)),r&&(m=W(r,"tableColumn"),!I(m))){for(g=i.BSt=[],p=0,b=m.length;p<b;p++)y=m[p],(w=new H).yh(y,o),y=w.name(),(M=i.nTt(y,p))!==y&&w.name(M),g.push(w);i.vTt()}o||(i.ESt&&i.h5t(!0),ge(i,C=S.WSt&&new S.WSt,a,u,n,e),c&&(i.dTt=c))}},a.prototype._St=function(){var t,n,e,i,r,o,t=this,n=t.IB,e=t.Mf.filterRowsVisibleInfo.rowsVisibleInfo,i=n.range;if(!I(i))for(r=0;r<i.rowCount;r++)if(!1!==e[i.row+r])for(o=0;o<i.colCount;o++)n.jct(i.row+r,i.col+o)},a.prototype.formulaFromJSON=function(){for(var t,n,e,i,r,o,a,u,s,c,f,f,l,t=this,n=t.Mf,e=n.b3(),i=t.BSt,o=t.footerIndex(),a=t.dataRange().row,u=t.iw,c=0;c<i.length;c++)s=c+u,(f=(r=i[c]).footerFormula())&&typeof f==Yn&&r.footerFormula(j(n,f,o,s)),(f=r.dataAreaFormula())&&e&&(l=e.sT(a,s),I(l)||r.hTt({isArrayFormula:!0,isDynamicArray:l.isDynamicArray})),f&&typeof f==Yn&&r.dataAreaFormula(j(n,f,a,s))},a.prototype.vTt=function(){for(var t,n,e,i,r,o,t=this,n=t.BSt,e=n.length,o=0;o<e;o++)(r=(i=n[o]).id())<1&&i.id(t.M5t())},a.prototype.startRow=function(){return this.Ky},a.prototype.startColumn=function(){return this.iw},a.prototype.endRow=function(){return this.Ky+this.Sx-1},a.prototype.endColumn=function(){return this.iw+this.Tx-1},a.prototype.hasHeadersRow=function(){return this.jO},a.prototype.hasTotalsRow=function(){return this.oL},a.prototype.tableName=function(){return this.name()},a.prototype.getColumnIndexInTable=function(e){e=e.toLowerCase().replace(/\u00A0/g," ");var i=-1,r=n.Common.zf.Vi(e,"\r\n","\n");return I(e)||p(this.BSt,function(t,n){var n=n.name().toString().toLowerCase().replace(/\u00A0/g," ");if(n===e||n===r)return i=t,!1}),i},a.prototype.source=function(){var t=this.Mf;return t&&t.Uw&&t.Uw()},a.prototype.qSt=function(){var t,n,e,n,n,t=this,n=t.Mf;n&&(e=t.bindingPath())&&(n=n.getDataSource&&n.getDataSource(),T.CellBindingSource)&&n instanceof T.CellBindingSource&&(n=(0,T.q$)(n.getSource(),e),t.T5t(n))},a.prototype.T5t=function(t){var n,e,i,r,n=this,e=n.Mf;if(t){(i=new T.$$).bind(t,e.Ut.G8);try{st(e),n.H3=B,n.D3(i),(r=y&&e.op())&&!r.IsSuspended()&&e.recalcAll()}finally{ct(e)}}},a.prototype.clone=function(){var t,n,e,t=this,n=new a,e=Gt(t.toJSON());return n.Sg(t.jS),n.fromJSON(Ut(e)),n},a.prototype.V3=function(t){var n=new T.$$;n.bind(t),this.H3=n},a.prototype.gTt=function(t){var t;t&&!t.bindingPath()&&(t=t.H3)&&this.V3(t.getSource())},a.prototype.z3=function(){var t=this.H3;return t?t.getSource():B},a.prototype.pTt=function(){var t=this.H3;return t?t.getRowCount():0},a.prototype.bTt=function(t,n){var e,n,e=this.PSt;n?e.push(t):-1!==(n=e.indexOf(t))&&e.splice(n,1)},a.prototype.cL=function(n){var e=this;e.PSt.forEach(function(t){t.Pen(e,n)}),2===n&&(e.PSt=[])},a.prototype.Pwt=function(t,n,e){var i,i,r,o,i=this;i.yTt||((r=(r=(i=i.FSt)[e])||(i[e]={}))[o=[t,n].join(",")]=!0)},a.prototype.I4t=function(t,n,e){var i,r,o,a,u,s,c,f,l,h,d,h,v,i=this,r=i.Mf,o=r&&r.getCalcService&&r.getCalcService();if(i.yTt=!0,o)for(u in u=void 0,a=i.FSt)if(s=o.rO[u])for(l in c=s.pj(),f=a[u])d=+(h=l.split(","))[0],h=+h[1],(v=s.pB(d,h))?(i.wTt(d,h)||i.MTt(v,t,n,e,!1,d,h),s.SB(d,h,v,void 0,!1,c)):delete f[l];else delete a[u];delete i.yTt},a.prototype.CTt=function(t,n,e){var i,r,o,a,u,s,c,f,l,h,l,d,h,i=this,r=i.Mf,o=r&&r.getCalcService();if(i.yTt=!0,o)for(u in u=void 0,a=i.FSt)for(f in s=o.rO[u],c=a[u])h=+(l=f.split(","))[0],l=+l[1],(d=s.pB(h,l))&&t===h&&n===l&&-1<(h=Nt(d))&&(d.arguments[h]=e);delete i.yTt},a.prototype.wTt=function(t,n){var e,i,r,t,i,e=this,i=e.footerIndex(),r=!1;return-1<i&&t===i&&(i=(t=e.iw)+e.Tx,r=t<=n&&n<i),r},a.prototype.sort=function(t,n){var e=this,i=e.Mf,r=e.dataRange(),e=e.rowFilter();i&&0<=t&&t<r.colCount&&(i.suspendPaint(),i.sortRange(r.row,r.col,r.rowCount,r.colCount,!0,[{index:t+r.col,ascending:n}]),e&&(e.nrt={index:t+r.col,ascending:n}),i.resumePaint())},a.prototype.QL=function(){return!!this.H3},a.prototype.N4t=function(t,n,e,i,r,o,a){var u,s,c,f,l,h,d,f,h,v,m,g,p,b,y,w,M,C,S,u=this,s=u.Mf,c=u.jS,f=u.Ky,l=u.iw,h=u.Sx,d=u.Tx,f=f+h-1,h=e?t+1:t,v=h+n,m=u.dataRange();Ct(s);try{g=u.QL(),u.lTt=!0,u.sL(!1),u.STt(),(c.zB=u).JO(h,n,e,!!a,!0,o),u.I4t(),p=_.CopyToOptions.value|_.CopyToOptions.formula|_.CopyToOptions.comment|_.CopyToOptions.outline|_.CopyToOptions.sparkline|_.CopyToOptions.span|_.CopyToOptions.style|_.CopyToOptions.tag|_.CopyToOptions.bindingPath|_.CopyToOptions.hyperlink,i&&!u.TTt&&(y=(b=1+f)+n,w=r-b+1,s.moveTo(b,l,y,l,w,d,p)),M=f-h+1,(!e||t!==f)&&0<M&&(g&&!u.oL&&(p=_.CopyToOptions.style),s.EB=!0,s.Nyt=m,s.moveTo(h,l,v,l,M,d,p),delete s.Nyt,delete s.EB),C=s.Ut,S=u.dataRange(),C.bJ&&C.bJ(h,n,[S],!0),C.ATt&&C.ATt(h,n,[S],!0),c.zB=L,u.ITt(),u.t5t(h,n,!0),u.J5t(),u.W5t(h,n,!0),u.fTt(),u.jS.dl()}finally{u.lTt=L,u.sL(!0),St(s),u.cL(0),s.recalcAll(!0)}},a.prototype.sL=function(t){this.Mf.sL(t)},a.prototype.insertRows=function(t,n,e){var i;I(t)||I(n)||n<=0||(t=kt(i=this,t,!0),i.zpt(t,n,e))},a.prototype.zpt=function(t,n,e,i,r){var o,a,u,s,u,c,s,u,f,l,s,h,f,d;I(t)||I(n)||n<=0||(a=(o=this).Mf,s=(u=o.dataRange()).row,0===(u=u.rowCount)&&t===s||!(t<s||(c=s+u)<=t)||N(G().Exp_RowParamOutOfRange),s=o.Ky,u=o.iw,f=o.Sx,h=u+(l=o.Tx)-1,d=(s=s+f-1)<(f=gt(a,o)),bt(a,o,1+s,f,u,h,n))||o.N4t(t,n,e,d,f,i,r)},a.prototype.deleteRows=function(t,n){var e;I(t)||I(n)||n<=0||(t=kt(e=this,t,!0),e.yE(t,n))},a.prototype.yE=function(t,n,e){var i,r,o,a,o,u,s,u,c,f,l,u,a,h,d,v,m,g,p,b,y,w,M,C;if(!(I(t)||I(n)||n<=0||(r=(i=this).Mf,a=(o=i.dataRange()).row,o=o.rowCount,(t<a||a+o<=t)&&N(G().Exp_RowParamOutOfRange),u=i.Ky,s=i.iw,f=u+(u=i.Sx)-1,l=s+(c=i.Tx)-1,(u<=1||t===a&&!i.jO&&!i.oL&&o<=n)&&N(G().Exp_TableDeleteCountInvalid),a=f<(u=gt(r,i)),bt(r,i,1+f,u,s,l,n,!0)))){Ct(r);try{i.sL(!1),h=i.QL(),d=void 0,h&&(d=wt(!0),i.x4t(t,n,d)),i.STt(),((v=i.jS).zB=i).xP(t,n,L,d,e),i.I4t(),m=F(n,f-t+1),r.clear(t,s,m,c,3,383),g=_.CopyToOptions.value|_.CopyToOptions.formula|_.CopyToOptions.comment|_.CopyToOptions.outline|_.CopyToOptions.sparkline|_.CopyToOptions.span|_.CopyToOptions.style|_.CopyToOptions.tag|_.CopyToOptions.bindingPath|_.CopyToOptions.hyperlink,t+n<=f&&(p=g,h&&!i.oL&&(p=_.CopyToOptions.style),r.moveTo(t+n,s,t,s,f-n-t+1,c,p)),a&&(y=(b=1+f)-m,w=u-b+1,r.moveTo(b,s,y,s,w,c,g)),M=r.Ut,C=i.dataRange(),M.yJ&&M.yJ(t,n,[C],!0),v.zB=L,i.ITt(),i.J5t(),i.W5t(t,n,!1),i.jS.dl()}finally{i.sL(!0),St(r),i.cL(0),r.recalcAll(!0)}}},a.prototype.insertColumns=function(t,n,e){var i;I(t)||I(n)||n<=0||(t=kt(i=this,t,!1),i.k4t(t,n,e))},a.prototype.k4t=function(t,n,e){var i,r,o,a,u,s,c,u,c,f,l,h,c,d,v,h,m,g,p,b,y,w,M,C,S,T,A;if(!(I(t)||I(n)||n<=0||(r=(i=this).Mf,a=(o=i.dataRange()).row,u=o.col,s=o.rowCount,c=o.colCount,(t<u||u+c<=t)&&N(G().Exp_ColParamOutOfRange),u=i.Ky,c=i.iw,h=u+(f=i.Sx)-1,v=(c=c+(l=i.Tx)-1)<(d=pt(r,i)),bt(r,i,u,h,1+c,d,n,!1,!0)))){m=(h=e?t+1:t)+n,Ct(r);try{i.sL(!1),i.STt(),b=!(p=((g=i.jS).zB=i).QL()),w=(y=1+c)+n,M=d-y+1,C=_.CopyToOptions.value|_.CopyToOptions.formula|_.CopyToOptions.comment|_.CopyToOptions.outline|_.CopyToOptions.sparkline|_.CopyToOptions.span|_.CopyToOptions.style|_.CopyToOptions.tag|_.CopyToOptions.bindingPath|_.CopyToOptions.hyperlink,v&&r.moveTo(u,y,u,w,f,M,C),i.qO(h,n,e,b,!0),i.xTt(h,n,!0),i.I4t(h,n,!0),e&&t===c||(p&&!i.oL&&(C=_.CopyToOptions.style),r.EB=!0,S=i.oL?1:0,r.moveTo(a,h,a,m,s+S,c-h+1,C),delete r.EB),T=r.Ut,A=i.dataRange(),T.wJ&&T.wJ(h,n,[A],!0),T.NTt&&T.NTt(h,n,[A]),g.zB=L,i.ITt(L,!0),i.J5t(),i.Q5t(h,n,!0),(0,z.hMt)(r,h,n,!0,!1,o),i.jS.dl()}finally{i.sL(!0),St(r),i.cL(0),r.recalcAll(!0)}}},a.prototype.deleteColumns=function(t,n){var e;I(t)||I(n)||n<=0||(t=kt(e=this,t,!1),e.wE(t,n))},a.prototype.wE=function(t,n){var e,i,r,o,a,o,a,u,s,c,f,l,h,d,v,m,g,p,b,y,w,M,C,S;if(!(I(t)||I(n)||n<=0||(i=(e=this).Mf,o=(r=e.dataRange()).col,a=r.colCount,(t<o||o+a<=t)&&N(G().Exp_ColParamOutOfRange),o=e.Ky,a=e.iw,c=o+(u=e.Sx)-1,f=a+(s=e.Tx)-1,l=e.oL?1:0,(s<=1||t===a&&s<=n)&&N(G().Exp_TableDeleteCountInvalid),d=f<(h=pt(i,e)),bt(i,e,o,c,1+f,h,n,!0,!0)))){Ct(i);try{e.sL(!1),e.STt(),v=e.jS,m=e.QL(),v.zB=e,v.zB.VB=new _.Range(o,a,u,s),e.NP(t,n),e.xTt(t,n,!1),e.I4t(t,n,!1),g=F(n,f-t+1),i.clear(o,t,u,g,3,383),p=_.CopyToOptions.value|_.CopyToOptions.formula|_.CopyToOptions.comment|_.CopyToOptions.outline|_.CopyToOptions.sparkline|_.CopyToOptions.span|_.CopyToOptions.style|_.CopyToOptions.tag|_.CopyToOptions.bindingPath|_.CopyToOptions.hyperlink,t+n<=f&&(b=p,m&&!e.oL&&(b=_.CopyToOptions.style),i.EB=!0,i.moveTo(o,t+n,o,t,u-l,f-n-t+1,b),delete i.EB),d&&(w=(y=1+f)-g,M=h-y+1,i.moveTo(o,y,o,w,u,M,p)),C=i.Ut,S=e.dataRange(),C.MJ&&C.MJ(t,n,[S],!0),C.kTt&&C.kTt(t,n),delete v.zB.VB,v.zB=L,e.ITt(!0),e.J5t(),e.Q5t(t,n,!1),(0,z.hMt)(i,t,n,!1,!1,r),e.jS.dl()}finally{e.sL(!0),St(i),e.cL(0),i.recalcAll(!0)}}},a.prototype.STt=function(){var t=this,n=t.Mf,e,i=t.jS.U3;n&&n.Ut.DTt([t],[],2),i.splice(i.indexOf(t),1),t.U5t()},a.prototype.ITt=function(t,n){var e=this;e.mTt=!0,e.iTt=t,e.jS.WB(e,L,n),delete e.iTt,delete e.mTt},a.prototype.xTt=function(t,n,e){for(var i,r,o,a,u,s,c,f,i=this,r=i.BSt,o=r.length,a=yt(i,t),c=a;c<o;c++)f=void 0,e?a+n-1<c&&(f=c-n):a<=c&&(f=c+n),(s=(u=r[c]).footerFormula())&&i.MTt(s,t,n,e,!0,f)},a.prototype.MTt=function(t,n,e,i,r,o,a){var u,s,c,f,l,h,d,v,m,u=this,s=u.Mf;if(0<e&&t&&t.arguments)for(c=t.arguments,l=f=void 0,h=0;h<c.length;h++)(f=c[h])instanceof z.obt&&(s&&(r?s.Ut._Tt(this,f,o):s.Ut.ETt(u,f,o,a)),f._K(),l=f.offsetWhenInsertRemoveColumn(n,e,i,r),c[h]=l)},a.prototype.ftt=function(t){var n,e,i,r,o,a,u,s,c,f,l,h,d,n=this,e=n.H3,i=n.Mf,r=n.jO?1:0,o=n.Ky+r+t,a=n.iw;if(!e||0===e.getRowCount())return B;if(u=n.Tx,s={},c=e.ftt(t))for(f in c)Z(c,f)&&"function"!=typeof f&&(s[f]=c[f]);for(l=0;l<u;l++)d=(h=n.BSt[l])&&h.dataField(),h&&d&&0<d.length&&I(s[d])&&(s[d]=i.getValue(o,a+l));return s},a.prototype.x4t=function(t,n,e){var i,r,o,a,u,s,c,f,i=this,r=[],o=i.H3;if(o)for(s=o.getRowCount(),c=0;c<n;c++)f=B,(u=C(i,a=t+c))<s&&(f=i.ftt(u)),r.push({key:e,data:f});i.aj=r},a.prototype.tq=function(){var e=[],t=this.aj;return t&&p(t,function(t,n){n&&!_.GC$.isFunction(n)&&e.push(n.data)}),e},a.prototype.R5t=function(t,n,e){var i,r,o,a,u,s,i=this;0<i.Mf.lE||(r=i.GSt,(o=i.H3)&&(a=B,n<(u=o.getRowCount())&&(a=i.ftt(n)),r[t]=s={key:e,data:a}))},a.prototype.sTt=function(t,n,e){var i,r,e,o,i=this;if(!(0<i.Mf.lE))if(r=i.GSt,e)e=r.splice(t,n),i.USt.push({rowIndex:t,count:n,deletedDirtyItems:e});else for(o=0;o<n;o++)r.splice(t,0,B)},a.prototype.A4t=function(t,n){this.GSt.splice(t,n)},a.prototype.ZSt=function(){var t,n,n,e,i,r,o,a,t=this,n=t.USt;if(n&&0<n.length)for(e=(n=n.pop()).rowIndex,i=n.count,r=n.deletedDirtyItems,o=0;o<i;o++)a=r[o],t.GSt[e+o]=h({},a)},a.prototype.getDirtyRows=function(){for(var t,n,e,i,r,o,t=this,n=t.GSt,e=[],o=0;o<n.length;o++)i=n[o],I(i)||(r=C(t,o),e.push({row:r,originalItem:i.data,item:t.ftt(r)}));return e},a.prototype.clearPendingChanges=function(){this.GSt=[]},a.prototype.footerRowDropDowns=function(t,n){var e,t,t,i,r,n,e=this,t=e.OSt[t];if(t)return 1===arguments.length?t.dropDowns&&t.dropDowns.slice():(t=t.dropDowns[0],n?(i=n.listOption,r=n.submitCommand,n=n.type,i&&(t.option=i),r&&(t.submitCommand=r),A(n)&&(t.type=n),e):void 0)},a.prototype.checkTableLastRow=function(t){var n=this,e=n.dataRange();return n.headerIndex()===t||e.row+e.rowCount-1!==t},a.prototype.checkTableLastCol=function(t){var n,e=this.dataRange();return e.col+e.colCount-1!==t},a.prototype.jj=function(t,n,e,i,r){var o,a,i,r,a,o=this,a=o.Mf;Tt(a,o,e?En:kn,t,n,i,r),i=a.Ut,r=e?kn:En,a=!e&&L,i&&i.ZI(["tableRowsChanged",o,r,t,n,a,e])},a.prototype.Ej=function(t,n,e,i){var r,o,i,a,o,r=this,o=r.Mf;At(o,r,e?On:jn,t,n,i),i=o.Ut,o=!e&&L,i&&i.ZI(["tableColumnsChanged",r,a=e?jn:On,t,n,o])},U=a,S.Table=U,S.hasRowFilter=ye,(0,_.$e)(U),ne={101:"average",102:"countNums",103:"count",104:"max",105:"min",107:"stdDev",109:"sum",110:"let"},U.prototype.name=i(Ht,"",we(Ht),r),U.prototype.bandRows=i(Qt,!0,we(Qt)),U.prototype.bandColumns=i(Jt,!1,we(Jt)),U.prototype.highlightFirstColumn=i(Zt,!1,we(Zt)),U.prototype.highlightLastColumn=i(Wt,!1,we(Wt)),U.prototype.style=i("style",L,Me),U.prototype.autoGenerateColumns=i(Kt,!0,we(Kt)),d&&d.HideRowFilter&&(e=d.HideRowFilter,l(s,ae=e),s.prototype.pct=function(){return 0},s.prototype.bct=function(){return this.range.colCount},s.prototype.table=function(t){var n=this;if(0===arguments.length)return n.nM;(n.nM=t)&&(n.Mf=t.Mf)},s.prototype.unfilter=function(t,n){var e,i,t,e=this,i=e.Mf;i&&i.suspendPaint(),ae.prototype.unfilter.call(this,t,n),(t=e.nM)&&t.jS&&t.jS.dl(),i&&i.resumePaint()},s.prototype.JO=function(t,n){var e=this,i=e.nM;ae.prototype.JO.call(this,t,n),i&&e.Fct(i.dataRange())},s.prototype.xP=function(t,n){var e=this,i=e.nM;ae.prototype.xP.call(this,t,n),i&&e.Fct(i.dataRange())},s.prototype.ert=function(t,n,e,i,r){var o,a,u,o,a=this.nM;ae.prototype.ert.call(this,t,n,e,i,r),a&&a.N5t()&&(u=a.getSlicerData()).refresh()},s.prototype.toJSON=function(){var t,n,t,t=this,n=ae.prototype.toJSON.call(t),t=t.nM;return t&&(n.tableName=t.name()),n},s.prototype.L0=function(){this.nM=B,this.Mf=B},S.WSt=s),xe.prototype.tTt=function(){return 0<this.id()},xe.prototype.toJSON=function(){var i,r,i=this,r={};return p(Sn,function(t,n){var e=i[n]();I(e)||(n===zt&&e.toJSON&&"function"==typeof e.toJSON?r[n]=e.toJSON():r[n]=e)}),m(r)?L:r},xe.prototype.wh=function(t,n,e,i,r,o){var a,u,u,s,c,f,l,r,e,s,l,o,a=this,u=a.name();return u=tt(u,"\r",""),u={n_:"tableColumn",id:a.id(),name:$(tt(u,"\n","_x000a_"))},s=a.footerFormula(),c=a.footerValue(),s&&(r&&!1===r.includeFormulas?(s=L,c=t.getValue(e,i)):l=Ae(f=M(t,s,e,i))),(r=l===Zn)?u.totalsRowFunction=Zn:s?u.totalsRowFunction=l:I(c)||(u.totalsRowLabel=$(nt(c.toString(),!0)),o.v=c),e=a.dataAreaFormula(),I(e)||Ie(e=M(t,e,n,i))||(I(u.c_)&&(u.c_=[]),s={n_:"calculatedColumnFormula",c_:[$(it(e))]},u.c_.push(s)),r&&!I(f)&&(l={n_:"totalsRowFormula",c_:[$(f)]},I(u.c_)&&(u.c_=[]),u.c_.push(l)),o=u.lossless,I(a.cellType())||((o=I(o)?u.lossless={}:o)[zt]=a.cellType().toJSON()),I(a.value())||((o=I(o)?u.lossless={}:o)[Vt]=a.value()),I(a.formatter())||((o=I(o)?u.lossless={}:o)[Yt]=a.formatter()),I(a.dataField())||((o=I(o)?u.lossless={}:o)[pn]=a.dataField()),u},xe.prototype.fromJSON=function(o){var a;o&&(a=this,p(Sn,function(t,n){var e,i,r,r,i,e=o[n]!==L?o[n]:o["_"+n];I(e)||n===zt&&(i=e.typeName,r=(r=_.CellTypes&&_.CellTypes.ti)&&r[i]||r[e.type]||(0,_.getTypeFromString)(i))&&((i=new r).fromJSON(e,!1),e=i),I(e)||a[n](e,!1)}))},xe.prototype.yh=function(t,n){var e,i,i,i,i,n,i,n,i,n,t,r,r,t,r,t,n;t&&((e=this).id(K(t.id,0)),i=t.name,I(i)||(i=tt(i,"_x000d__x000a_","\n"),e.name(q(tt(i,"_x000a_","\n")))),i=t.totalsRowLabel,I(i)||e.footerValue(q(i)),n||(i=t.totalsRowFunction,I(i)||((n=i)===Zn&&(n=q(Q(x(t,"totalsRowFormula")))),e.footerFormula(n)),i=x(t,"calculatedColumnFormula"),I(i)||(n=""+Q(i),e.dataAreaFormula(q(et(n)))),i=t.lossless,I(i))||(n=i[zt],I(n)||(t=n.typeName,(r=(r=_.CellTypes&&_.CellTypes.ti)&&r[t]||r[n.type]||(0,_.getTypeFromString)(t))&&((t=new r).fromJSON(n),n=t),I(n))||e.cellType(n),r=i[Vt],I(r)||e.value(r),t=i[Yt],I(t)||e.formatter(t),n=i[pn],I(n))||e.dataField(n))},H=xe,(S.TableColumn=H).prototype.id=function(t){var n=i(gn,L,function(t){var n=this;n.name()||n.name(mn+t)});return 0===arguments.length?n.call(this):I(t)?this:n.call(this,t)},H.prototype.name=i(Ht,L,function(t){var t;t||(t=this).name(mn+t.id())}),H.prototype.formatter=i(Yt),H.prototype.cellType=i(zt),H.prototype.value=i(Vt),H.prototype.dataField=i(pn),H.prototype.footerValue=i(Mn),H.prototype.dataAreaFormula=i(wn),H.prototype.footerFormula=i(bn),H.prototype.x5t=i(t),H.prototype.hTt=i(yn),c.prototype.getUsedRange=function(){var t,n,e,i,r,o,a,t,n=this.all(),e={};if(n)for(i=void 0,r=0,o=n;r<o.length;r++)a=o[r],Kn(e,Jn(a.range()));return e},c.prototype.L0=function(){for(var t,n,e,i,r,t=this,n=t.U3,e=n.length,r=0;r<e;r++)(i=n[r])&&i.L0();t.U3=[],t.zB=L,t.dl(),t.Mf=B},c.prototype.dl=function(){var t,n,e,i,r,t=this;for(t.xl=[],t.Nl=[],e=(n=t.U3).length,r=0;r<e;r++)(i=n[r]).dl()},c.prototype.KSt=function(t,n){for(var e,i,r,o,a,e,i=this.U3,r=i.length,a=0;a<r;a++)o=i[a],!n&&se(o.HSt,t)?o.HSt=[]:I(o.HSt[t])||(o.HSt[t]=L)},c.prototype.JSt=function(t){for(var n,e,i,r,o,n,e=this.U3,i=e.length,o=0;o<i;o++)se((r=e[o]).zSt,t)?r.zSt=[]:I(r.zSt[t])||(r.zSt[t]=L)},c.prototype.add=function(t,n,e,i,r,o,a){return this._Qt(t,n,e,i,r,o,a)},c.prototype._Qt=function(t,n,e,i,r,o,a,u){var s=this;return s.jTt(s.Mf,t,n,e,i,r,!0),s.WB(new U(t,n,e,i,r,o||b.TableThemes.medium2,a),L,L,u)},c.prototype.addFromDataSource=function(t,n,e,i,r,o){var a,u,s,i,c,a;if(i||N(G().Exp_TableDataSourceNullError),T.$$)return(u=(a=this).Mf).suspendPaint(),lt(u),(s=new T.$$).bind(i),i=s.getRowCount()+1,c=s.getColumnCount(),(a=a.add(t,n,e,i,c,r,o)).D3(s),u.clearPendingChanges(),ht(u),u.resumePaint(),a},c.prototype.find=function(t,n){return this.Hq(t,n)},c.prototype.Hq=function(t,n,e){for(var i,r,o,a,u,s,i=this,r=i.U3,o=(r=!0===e&&i.zB?r.concat([i.zB]):r).length,u=0;u<o;u++)if((s=(a=r[u]).range()).row<=t&&t<s.row+D(s)&&s.col<=n&&n<s.col+E(s))return a;return B},c.prototype.findByName=function(t){return this._bt(t)},c.prototype._bt=function(t,n){for(var e,i,r,o,a,e=this,i=e.U3,r=(i=!0===n&&e.zB?i.concat([e.zB]):i).length,a=0;a<r;a++)if((o=i[a]).name().toLowerCase()===t.toLowerCase())return o;return B},c.prototype.pP=function(t,n,e,i){for(var r,o,a,u,s,c,r=this.U3,o=r.length,a=(0,_.Ec)(t,e,n,i),u=[],c=0;c<o;c++)s=r[c],a.containsRange(s.range())&&u.push(s);return u},c.prototype.AB=function(t,n,e,i){for(var r,o,a,u,s,r=this.U3,o=r.length,a=[],s=0;s<o;s++)(u=r[s]).range().intersect(t,n,e,i)&&a.push(u);return a},c.prototype.Fue=function(t){for(var n,e,i,r,o,a,u,s,n=this.U3,e=n.length,i=t.row,r=t.col,o=t.rowCount,a=t.colCount,s=0;s<e;s++)if((u=n[s]).range().intersect(i,r,o,a))return u},c.prototype.Dy=function(){var t,n,t,t=this,n=t.Mf,t=t.find(n.ui,n.ci);if(t)return n.j1(new _.Range(-1,t.iw,-1,t.Tx))},c.prototype.WB=function(t,n,e,i){var r,o;if(t)return(r=this).findByName(t.name())&&N(G().Exp_TableHasSameNameError),(o=r.Mf).suspendPaint(),t.Sg(r),o.Ut.DTt([],[t],1),r.U3.push(t),t.mTt||t.qSt(),t.showHeader()&&t.a5t(L,L,e,i),!n&&t.showFooter()&&t.l5t(),r.OTt(t),o.resumePaint(),t},c.prototype.DK=function(t){var n,e,i,n=this,e=g(t,n.U3);return-1<e?((i=n.Mf)&&i.Ut.DTt([t],[],2),n.U3.splice(e,1),n.RTt([t],!1),t):B},c.prototype.remove=function(t,n){var e,i,r,o,a,u,s,c,f,l,h,d,v,m,g,p,b,y,e=this;if((t=Mt(t)?e.findByName(t):t)&&(n=n||0,t.s5t(),t=e.DK(t))){i=t.range(),r=e.Mf;try{if(st(r),o=i.row,a=i.row+D(i),u=i.col,s=i.col+E(i),f=c=void 0,l=t.showHeader(),h=t.headerIndex(),1!=(1&n))for(c=o;c<a;c++)for(f=u;f<s;f++)k(r,c,f,B),w(r,c,f,B);else if(t.QL()){if(l)for(c=h,f=u;f<s;f++)r.setValue(c,f,t.getColumnName(f-i.col));for(m=(v=(d=t.dataRange()).row)+D(d),b=p=g=void 0,c=v;c<m;c++)for(f=u;f<s;f++)(p=t.BSt[yt(t,f)])&&(b=(g=t.ftt(C(t,c)))[p.dataField()],I(b)||r.setValue(c,f,b))}else if(l)for(c=h,f=u;f<s;f++)r.setValue(c,f,t.getColumnName(f-i.col));if(2==(2&n))for(c=o;c<a;c++)for(f=u;f<s;f++)y=r.Z_(c,f)||new _.Style,t.h5(c,f,y),r.setStyle(c,f,y)}finally{ct(r)}t.cL(2)}return t},c.prototype.move=function(t,n,e){var i,r,o,i,o,i=this,r=i.Mf;if((t=Mt(t)?i.findByName(t):t)&&0<=n&&0<=e&&(o=t.range(),0===(o=(i=i.AB(n,e,D(o),E(o))).length)||1===o&&i[0]===t)){st(r);try{t.G5t(n,e)}finally{ct(r)}}},c.prototype.resize=function(t,n){var e,i,r,o,a,n,a,u,s,c,f,l,e=this,i=e.Mf;if((t=Mt(t)?e.findByName(t):t)&&(r=t.range(),o=t.dataRange(),n=n,n=3===(a=arguments).length?(0,_.Ec)(r.row,r.col,a[1],a[2]):n)&&(a=D(n),u=E(n),0<=a)&&0<=u&&(s=e.AB(n.row,n.col,a,u)).length<=1){Ct(i);try{t.K5t(n),t.QL()||(c=i.conditionalFormats,f=i.b8,l=n.rowCount-r.rowCount,c&&c.qJ(r,o,l),f&&f.qJ(r,o,l))}finally{St(i)}}},c.prototype.all=function(){var e=[];return p(this.U3,function(t,n){e.push(n)}),e},c.prototype.$St=function(t){for(var n,e,i,n=t||this.U3,e=n.length,i=0;i<e;i++)n[i].clearPendingChanges()},c.prototype.Yj=function(t,n,e,i){for(var r,o,a,u,s,r=[],o=this.U3,a=o.length,u=0;u<a;u++)(s=o[u]).Ky>=t&&s.iw>=n&&s.Ky+s.Sx<=t+e&&s.iw+s.Tx<=n+i&&r.push(s);return r},c.prototype.Zj=function(t,n,e,i){var r,o,a,u,r=this,o=r.AB(t,n,e,i),a=r.Yj(t,n,e,i),u=[];return 0<a.length?o.forEach(function(t){-1===a.indexOf(t)&&u.push(t)}):u=o,u},c.prototype.Wj=function(t,n,e){for(var i,r,o,a,i=t.length,o=0;o<i;o++)if((a=(r=t[o]).range()).row<=n&&n<a.row+D(a)&&(e<0||a.col<=e&&e<a.col+E(a)))return!0;return!1},c.prototype.jTt=function(t,n,e,i,r,o,a){var u,u,n,s;return n?dt(n)?e<0||r<1||e+r>t.getRowCount()?(a&&N(G().Exp_TableInvalidRow),!1):i<0||o<1||i+o>t.getColumnCount()?(a&&N(G().Exp_TableInvalidColumn),!1):(u=t.tables).Pl(e,i,r,o)?(a&&N(G().Exp_TableIntersectError),!1):u.findByName(n)?(a&&N(G().Exp_TableHasSameNameError),!1):ye(t,new _.Range(e,i,r,o))?(a&&N(G().Exp_TableRangeHasFilterError),!1):(n=(u=y&&t.iT(e,i,r,o))&&u.ranges,s=!0,n&&p(u,function(t,n){if(1<D(n)||1<E(n))return a&&N(G().Exp_ArrayFormulaTable),s=!1}),s):(a&&N(G().Exp_TableNameInvalid),!1):(a&&N(G().Exp_TableEmptyNameError),!1)},c.prototype.WI=function(t,n,e,i){for(var r,o,a,u,r=[],o=this.U3,a=0;a<o.length;a++)(u=o[a]).Ky>=t&&u.iw>=n&&u.Ky+u.Sx<=t+e&&u.iw+u.Tx<=n+i&&r.push(u.name());return r},c.prototype.oSt=function(t,n,e,i){var r,o,a,u,s,r=this.all();if(r)for(o=(0,_.Ec)(t,n,e,i),a=r.length,u=void 0,s=0;s<a;s++)if(u=r[s].range(),o.intersect(u.row,u.col,D(u),E(u))&&!o.containsRange(u))return!0;return!1},c.prototype.Pl=function(t,n,e,i){for(var r,o,a,u,r=this.U3,o=r.length,u=0;u<o;u++)if((a=r[u]).range().intersect(t,n,e,i))return!0;return!1},c.prototype._getTable=function(t,n,e,i,r){for(var o,a,u,s,c,f,o=t.tables.all(),a=o.length,s=[],c=0;c<a;c++)(f=(u=o[c]).range()).row>=n&&f.col>=e&&f.row+f.rowCount<=n+i&&f.colCount+f.col<=e+r&&s.push({table:u,index:c});return s},c.prototype.mx=function(t,n,e,i,r){var o,a,u,s,c,f,l,h,d,d,o=e.tables.all(),a=o.length;if(!I(n)&&(s=i.row-n.row,c=i.col-n.col,0!==(f=this._getTable(t,n.row,n.col,n.rowCount,n.colCount)).length))for(l=0;l<a;l++)for(u=o[l],h=0;h<f.length;h++)if(d=f[h],(!r||l!==d.index)&&(d=d.table.range(),u.range().intersect(d.row+s,d.col+c,d.rowCount,d.colCount)))return e.jT(6,G().Exp_TableIntersectError),!0;return!1},c.prototype.t5t=function(t,n){for(var e,i,r,o,e=this,i=e.U3,r=0,o=i.length;r<o;r++)i[r].t5t(t,n);e.Mf.filterRowsVisibleInfo.rE(t,n)},c.prototype.JO=function(t,n){for(var e,i,r,o,a,u,s,c,f,l,e,h,d,v,m,g,e=this,i=e.U3,r=[],o=0,a=i.length;o<a;o++)s=(u=i[o]).z3(),f=(c=u.cue&&!(u.jO&&1===u.Sx))?t-1:t,Y(r,s)?u.JO(f,n,!0):(l=u.JO(f,n,c))&&r.push(s);e=e.Mf;try{for(st(e),d=h=void 0,o=0,a=i.length;o<a;o++)h=(u=i[o]).pTt(),d=u.dataRange(),0<h&&h!==D(d)&&(v=h,u.showHeader()&&(v+=1),u.showFooter()&&(v+=1),m=u.range(),g=(0,_.Ec)(m.row,m.col,v,E(d)),u.K5t(g))}finally{ct(e)}},c.prototype.qO=function(t,n){for(var e,i,r,o,e=this.U3,i=e.length,o=0;o<i;o++)(r=e[o]).qO(t,n)},c.prototype.n5t=function(t){for(var n,e,i,r,o,a,n=this.U3,e=n.length,a=0;a<e;a++)r=(i=n[a]).iw,o=i.endColumn(),r<=t&&t<=o&&i.n5t()},c.prototype.xP=function(t,n){for(var e,i,r,o,a,u,s,c,f,l,h,d,v,m,g,p,b,y,e=this,i=e.U3,r=[],o=[],a=[],u=0,s=i.length;u<s;u++)f=(c=i[u]).z3(),((h=t<=(l=c.range()).row&&l.row+D(l)<=t+n)?a:(Y(r,f)?c.xP(t,n,!0):(c.QL()&&c.x4t(t,n,wt(!0)),(d=c.xP(t,n))&&r.push(f)),o)).push(c);e.Mf.filterRowsVisibleInfo.aE(t,n),e.Mf.Ut.DTt(a,[],2),e.U3=o,e.RTt(a,!0),v=e.Mf;try{for(st(v),i=e.U3,g=m=void 0,u=0,s=i.length;u<s;u++)m=(c=i[u]).pTt(),g=c.dataRange(),0<m&&m!==D(g)&&(p=m,c.showHeader()&&(p+=1),c.showFooter()&&(p+=1),b=c.range(),y=(0,_.Ec)(b.row,b.col,p,E(g)),c.K5t(y))}finally{ct(v)}},c.prototype.NP=function(t,n){for(var e,i,r,o,a,u,s,c,f,e=this,i=e.U3,r=[],o=[],a=i.length,s=0;s<a;s++)((f=t<=(c=(u=i[s]).range()).col&&c.col+E(c)<=t+n)?o:(u.NP(t,n),r)).push(u);e.Mf.Ut.DTt(o,[],2),e.U3=r,e.RTt(o,!0)},c.prototype.d5=function(t,n,e,i,r){var o,a,u,s,c,f,l,h,d,o=this,a=(0,_.Ec)(t,n,e,i),f=[],l=o.Mf;if(1==(1&r)){for(h=[],s=(u=o.U3).length,d=0;d<s;d++)c=u[d],(a.containsRange(c.range())?f:h).push(c);for(s=h.length,d=0;d<s;d++)(c=h[d]).d5(t,n,e,i);l&&l.Ut.DTt(f,[],2),o.U3=h}if(2==(2&r))for(s=(u=o.U3).length,d=0;d<s;d++)c=u[d],a.containsRange(c.range())&&(l&&l.Ut.YSt(c,"style",c.style()),c.style(B));return o.RTt(f,!0),f},c.prototype.RTt=function(t,n){var e;t&&0!==t.length&&(e=this.Mf,_.GC$.each(t,function(t,n){n.N5t()&&n.getSlicerData().onTableRemoved(n),n.g5t()&&(e&&e.Ut.YSt(n,Cn,n.b5t()),n.OSt=[])}),y)&&ce(this.Mf,t,n)},c.prototype.OTt=function(t){t&&t.N5t()&&t.getSlicerData().onTableAdded(t)},c.prototype.BTt=function(t){for(var n,e,i,r,n=1,e,i=t,r=this.LTt();!this.FTt(i,r);)i=t+n,n++;return i},c.prototype.LTt=function(){for(var t,n,e,i,r,o,a,u,s,c,t=[],n,e,r=0,o=this.Mf.parent.sheets;r<o.length;r++)for(u=0,s=i=(a=o[r]).tables.all();u<s.length;u++)c=s[u],t.push(c);return t},c.prototype.FTt=function(t,n){for(var e,i,r,e=0,i=n;e<i.length;e++)if((r=i[e]).name().toLowerCase()===t.toLowerCase())return!1;return!0},c.prototype.Sl=function(t,n){var e,i,r,o,e,i=!1,r=B,o=this.find(t,n);return o&&(o.showHeader()&&t===o.headerIndex()?(r=o.q5t(n),I(r)||(r=u(r)),i=!0):(i=(r=o.Sl(t,n)).e5t,r=r.y4)),{e5t:i,y4:r}},c.prototype.Kbt=function(t,n,e){var i,r,o,a,i,r=!1,o=!0,a=this.find(t,n);return a&&!0!==a.eTt&&(a.showHeader()&&t===a.headerIndex()?(I(e)||(e=a.nTt(u(e),n-a.iw)),a.$5t(n,e)):a.showFooter()&&t===a.footerIndex()?a.d5t(n,e):r=a.Kbt(t,n,e)),r||!1},c.prototype.pMt=function(t,n,e,i,r,o){var a=this.find(t,n);if(y&&a){if(1<e||1<i)return this.Mf.jT(0,G().Exp_ArrayFormulaTable),!1;if(a.showHeader()&&t===a.headerIndex()&&r)return!1;!a.eTt&&a.showFooter()&&t===a.footerIndex()&&(I(r)||a.d5t(n,B),a.m5t(n-a.iw,r,o))}return!0},c.prototype.XSt=function(){for(var t,n,e,i,t=this.all(),n=0,e=t.length;n<e;n++)(i=t[n]).bindingPath()&&(i.H3=B)},c.prototype.KB=function(t,n){var e,i,r,o,a,e=[],i=this;if(i&&(r=i.all()))for(a=r.length-1;0<=a;a--)o=r[a],t.containsRange(o.range())&&(n&&(this.Mf&&this.Mf.Ut.DTt([o],[],2),i.U3.splice(a,1),o.U5t(L,L,n)),e.push(o));return e},c.prototype.JB=function(t,n,e,i,r,o){for(var a,u,s,c,f,l,h,f,f,a=this,u=[],s=0,c=t.length;s<c;s++)f=t[s],h=l=void 0,o?h=f:(l=f.bindingPath()?L:f.z3(),(h=new U).Sg(a),h.fromJSON(Ut(Gt(f.toJSON()))),h.name(a.BTt(h.name())),u.push(h)),f=h.range(),h.rTt=!0,h.H5t(i+f.row-n,r+f.col-e),a.WB(h,o),o?(f=h.LSt)&&(f.Mf=a.Mf,f.refresh()):l&&h.V3(l),h.rTt=!1;for(s=0;s<u.length;s++)u[s].formulaFromJSON()},c.prototype.qB=function(t){for(var n=0,e=t.length;n<e;n++)t[n].z5t()},c.prototype.toJSON=function(t,n){var e,i,r,o,e=this.U3,i=[];if(e)for(r=0;r<e.length;r++)o=t?this.BTt(e[r].name()):L,i.push(e[r].toJSON(o,n));return 0===i.length?L:i},c.prototype.wh=function(t){var n,e,i,r,o,a,u,u,a;if(t&&(n=t.rels,i=(e=this.U3).length,n)&&0<i){for(r=[],o=0;o<i;o++)a=e[o],u=rt(n),u=_.XFileConstants.Rr+u,a=a._id,n.c_.push({n_:_.XFileConstants.Lr,Id:u,Type:_.RelationshipConstants.lc,Target:"../tables/"+_.XFileConstants.du+a+"."+_.XFileConstants.Cr}),r.push({n_:"tablePart","r:id":u});t.c_||(t.c_=[]),t.c_.push({n_:Qn,count:i,c_:r})}},c.prototype.fromJSON=function(t,n,e){var i,r,o,a;if(t)for(this.U3=[],this.dl(),i=0,r=t.length;i<r;i++)o=t[i],(a=new U).Sg(this),this.U3.push(a),a.fromJSON(o,n,e)},c.prototype.yh=function(t,n,e,i){var r,o,a,u,s,c,f,l,h,d,d,d,d,v,m,r=t&&t.c_,o=!_.Util.ko(i);if(r&&n){for((u=_.Util.wo(i,(a=this).Mf.parent&&a.Mf.parent.v2))||(a.U3=[]),a.dl(),s=e.tables,c=e.styleManager,f=[],l=0,h=r.length;l<h;l++)d=r[l][Wn],(d=(d=ot(n.c_,d))&&d.Target)&&(v=(d=s[d=d.split("/").pop().slice(0,-4)]).name,m=void 0,(m=u?a.findByName(v):m)||((m=new U(v)).Sg(a),a.U3.push(m)),m.yh(d,c,i),f.push(m.range()),o)&&m._5t(c);_.Util.Co(i)&&_.Util.Ao(a.Mf,f,L,e)}},c.prototype.containTableHeaderTotalRowForSheet=function(){var t,n,t,e,i,r,o,a,u,s,c,f,l,t=this.Mf;if(t&&(n=t.getSelections(),r=i=e=void 0,t=t.tables)&&n)for(o=t.U3,c=s=u=a=void 0,f=0;f<n.length;f++)for(r=(i=(e=n[f]).row)+e.rowCount-1,l=0;l<o.length;l++)if(u=(a=o[l]).range(),s=a.headerIndex(),c=a.footerIndex(),!e.containsRange(u)&&(i<=s&&s<=r||i<=c&&c<=r))return!0;return!1},c.prototype.containTableHeaderTotalRow=function(){var t,n,e,i,r,o,e,t,a,u,s,t=this.Mf,n=!1;if(t&&(e=t.getSelections(),o=r=void 0,i=t.tables)&&e){if(1<e.length)return n;e=e[0],s=u=a=void 0,(t=Et(t,e))&&1===t.length&&(o=(r=e.row)+e.rowCount-1,u=(a=t[0]).headerIndex(),s=a.footerIndex(),r<=u&&u<=o||r<=s&&s<=o)&&(n=!0)}return n},c.prototype.noRoomToInsertColumn=function(){var t,n,e,n,i,r,n,e,i,t=this.Mf;return!!(t&&(n=t.getSelections(),e=t.tables)&&n&&1===n.length&&(i=(n=n[0]).row,r=n.col,n=n.colCount,e=e.find(i,r),i=t.getColumnCount(3),e)&&e.endColumn()+n>=i)},c.prototype.noRoomToInsertRow=function(){var t,n,e,n,i,r,n,e,i,t=this.Mf;return!!(t&&(n=t.getSelections(),e=t.tables)&&n&&1===n.length&&(i=(n=n[0]).row,r=n.col,n=n.rowCount,e=e.find(i,r),i=t.getRowCount(3),e)&&e.endRow()+n>=i)},c.prototype.checkTableRow=function(){var t,n,t,n,e,n,t,e,t=this.Mf;return!(!(t&&(n=t.getSelections(),t=t.tables)&&n&&1===n.length&&(e=(n=n[0]).row,n=n.col,e=(t=t.find(e,n))&&t.range(),t)&&e)||t.jO||t.oL||1!==e.rowCount)},c.prototype.checkTableCol=function(){var t,n,t,n,e,n,t,e,t=this.Mf;return!!(t&&(n=t.getSelections(),t=t.tables)&&n&&1===n.length&&(e=(n=n[0]).row,n=n.col,e=(t=t.find(e,n))&&t.range())&&1===e.colCount)},c.prototype.isAcrossTables=function(){var t,n,e,i,e,t,t=this.Mf,n=!1;if(t&&(e=t.getSelections(),i=t.tables)&&e){if(1<e.length)return n;e=e[0],(t=Et(t,e))&&(n=1<t.length)}return n},c.prototype.isWholeTableCol=function(){var t,n,e,i,e,t,t,r,t,o,e,t=this.Mf,n=!1;return t&&(e=t.getSelections(),i=t.tables)&&e&&(1<e.length?n=!0:(e=e[0],1===(t=Et(t,e)).length&&(r=(t=t[0]).iw,t=t.Tx,o=e.col,e=e.colCount,n=r===o&&t===e))),n},c.prototype.containTableHeader=function(){var t,n,e,i,r,o,e,t,a,t,t=this.Mf,n=!1;if(t&&(e=t.getSelections(),o=r=void 0,i=t.tables)&&e){if(1<e.length)return n;e=e[0],(t=Et(t,e))&&1===t.length&&(t=(a=t[0]).headerIndex(),o=(r=e.row)+e.rowCount-1,r<=t)&&t<=o&&(n=!0)}return n},c.prototype.eq=function(){var t,n,e,i,r,t,o,a,u,s,t=this.Mf,n=!1;if(t&&(e=t.getSelections(),i=t.tables)&&e){if(r=t.getActiveRowIndex(),t=t.getActiveColumnIndex(),1<e.length||!i.find(r,t))return n;for(o=i.U3,a=e[0],u=void 0,s=0;s<o.length;s++)u=o[s],a&&a.intersect(u.Ky,u.iw,u.Sx,u.Tx)&&(n=!0)}return n},c.prototype.uSt=function(t){var n,e,i,r,o,a,u,s,c,n=-1,e,i=this.U3;if(i)for(r=i.length,s=u=a=o=void 0,c=0;c<r;c++)o=i[c].range(),t&&!o.intersect(t.row,t.col,t.rowCount,t.colCount)||n<(s=(a=o.row)+(u=o.rowCount)-1)&&(n=s);return n},c.prototype.sSt=function(t){var n,e,i,r,o,a,u,s,c,n=-1,e,i=this.U3;if(i)for(r=i.length,s=u=a=o=void 0,c=0;c<r;c++)o=i[c].range(),t&&!o.intersect(t.row,t.col,t.rowCount,t.colCount)||n<(s=(a=o.col)+(u=o.colCount)-1)&&(n=s);return n},c.prototype.yx=function(t,n,e,i,r,o,a){var u,s,c,f,l,h,d,v,a,m,g,n,p,b,y,w,M,C,S,u=this;if(!(u.Mf.options.isProtected||t&&e&&Ne(t,e))&&0!==(s=u.all()).length)for(a&&(d=a.shiftInfo,v=a.applyDragFillAfterTableExpand,d)&&(c=d.shiftCells,f=d.isCopy,l=d.isFirst,h=d.isHeaderPaste),a=n.row,m=n.col,g=n.rowCount,n=n.colCount,h&&(-1===a&&(a=0),-1===m&&(m=0),-1===g&&(g=t.getRowCount()),-1===n)&&(n=t.getColumnCount()),p=new _.Range(a,m,g,n),w=0,M=s;w<M.length;w++)(b=M[w]).VSt&&(y=b.range(),C=e&&e.equals(y),S=e&&0!==u.Mf.Ut.getSpans(e,3).length,c?f&&l&&p.col===y.col&&p.colCount===y.colCount&&p.row>y.row&&e.col===y.col&&e.colCount===y.colCount&&e.row>y.row&&p&&y.contains(p.row,p.col,1,p.colCount)&&e&&y.containsRange(e)&&(u.PTt(b,y,p),d.ignoreFooterShiftIndex=b.footerIndex()):e&&(C||S)||(b.TTt=r,u.GTt(b,y,p,i,o,v),delete b.TTt))},c.prototype.GTt=function(t,n,e,i,r,o){var a,u,s,c,f,l,h,d,v,m,g,g,r,g,p,b,y,w,M,C,S,v,T,m,A,h,I,x,w,a=this,u=a.Mf,s=null,c=!1,f=n.row,l=n.col,h=n.rowCount,d=n.colCount,v=f+h-1,m=new _.Range(f,l,h,d);if(t.showFooter()){if(g=new _.Range(f+h-1,l,1,d),e.row===g.row&&e.col>=l&&e.col+e.colCount<=l+d)return;c=!0,m.rowCount--}if(r&&(g=t.showHeader()?h-1:h,r.push(new _.Range(f,l,g,d))),r=e.row,g=e.col,p=e.row+e.rowCount-1,b=e.col+e.colCount-1,y=f+h-1-(c?1:0),w=l+d-1,M=L,C=u.getRowCount(),S=m.contains(r-1,g)&&!m.contains(r,g),c||(S=S&&b<=w&&l<=g),v=m.contains(r,g-1)&&!m.contains(r,g)&&p<=v&&r>=n.row,T=m.contains(r,g)&&!m.contains(p,b)){if(m=Pt(y,p)-f+1,A=Pt(w,b)-l+1,w<b&&(h=O(u,new _.Range(f,1+w,h,b-w)))&&b>h.col&&(A=d),s=new _.Range(f,l,m,A),c&&(s.rowCount++,p++,y++),(M=y<p?O(u,new _.Range(y+1,l,s.row+s.rowCount-1,d)):M)&&0<(I=p-M.row+1)){if(O(u,new _.Range(C-Math.abs(I),l,Math.abs(I),d)))return void u.jT(6,G().Exp_TableAddRowNoEnoughRoom);!0!==o&&u.moveTo(M.row,l,s.row+s.rowCount,l,C-s.row-s.rowCount,d,2047)}}else if(S&&!c){if(s=new _.Range(r,l,e.rowCount,d),(x=O(u,s,e))&&!e.containsRange(x))return}else if(v&&(s=new _.Range(f,g,n.rowCount,e.colCount),x=O(u,s,e))&&!e.containsRange(x))return;S&&!c&&xt(i)&&(t.useFooterDropDownList(!0),Te(u,t)),s&&!n.containsRange(s)&&(w=n.union(s),a.UTt(t,w))},c.prototype.PTt=function(t,n,e){var i,r,o,a,n,u,r,i=this,r=n.row,o=n.col,a=n.rowCount,n=n.colCount,u;new _.Range(r+(t.showHeader()?1:0),o,a-(t.showHeader()?1:0),n).contains(e.row,e.col,1,e.colCount)&&(r=new _.Range(r,o,a+e.rowCount,n),i.UTt(t,r))},c.prototype.UTt=function(t,n){var e=this.Mf,i=e.getParent();i&&i.commandManager().execute({cmd:xn,sheetName:e.name(),tableName:t.name(),resizeToRange:n})},c.prototype.HL=function(t,n,e){var i,r,o,a,o,u,s,c,f,l,h,d,v,m,g,o,p,b,y,w,M,C,S,T,A,I,x,T,C,i,w,M,M,i,p,y,i=this,r=this.Mf,o=r.options,a=o.isProtected,o=o.protectionOptions,u=!1!==o.allowSelectLockedCells,s=!1!==o.allowSelectUnlockedCells;if(!a||u||s){if(c=e.col,f=e.row,l=2,d=h=18,v=5,m=10,g=6,o=qn.TABLE_SELECT,p=qn.TABLE_CORNER_SELECT,b=qn.TABLE_COL_SELECT,y=qn.TABLE_ROW_SELECT,w=r.getActiveRowIndex(),M=r.getActiveColumnIndex(),-1===e.rowViewportIndex&&-1!==e.colViewportIndex&&(C=r.getCellRect(f,c,e.rowViewportIndex,e.colViewportIndex),(S=i.find(w,M))instanceof U)&&(T=r.Tb-r.frozenRowCount(),S.showHeader())&&w>=S.Ky&&w<S.Ky+S.Sx&&M>=S.iw&&M<S.iw+S.Tx&&S.Ky<T&&S.Ky+S.Sx>T&&e.col<S.iw+S.Tx&&e.col>=S.iw)if(t>C.x+5&&t<C.x+C.width-18&&n<C.height-5){for(A=r.getSelections(),I=0;I<A.length;I++)if(!((x=A[I]).col===e.col&&1===x.colCount&&x.row===S.Ky&&x.rowCount===S.Sx||x.col===e.col&&1===x.colCount&&-1===x.row&&x.rowCount===r.getRowCount()))return R(S,b,f,c,a,u,s)}else if(t>C.x+18)return R(S,"default",f,c,a,u,s);if(T=r.getCellRect(f,c),i.find(f,c)instanceof U&&-1!==e.colViewportIndex&&-1!==e.rowViewportIndex){if(C=!1,S=i.find(f,c),i=i.find(w,M),w=!0,1===(A=r.getSelections()).length&&(M=A[0]).row<=f&&M.row+M.rowCount>f&&M.col<=c&&M.col+M.colCount>c&&(w=!1),S===i&&(C=!0),c===S.iw&&f===S.Ky){if(w&&C&&(t<=T.x+2||n<=T.y+2))return R(S,o,f,c,a,u,s);if(t>T.x+2&&t<T.x+18&&n>T.y+2&&n<T.y+6)return R(S,p,f,c,a,u,s);if(t>T.x+18&&n>T.y+2&&n<T.y+6)return R(S,b,f,c,a,u,s);if(t>T.x+2&&t<T.x+18&&n>T.y+6)return R(S,y,f,c,a,u,s)}if(c===S.iw+S.Tx-1&&f===S.Ky){if(w&&C&&(t>=T.x+r.getColumnWidth(c)-2||n<=T.y+2))return R(S,o,f,c,a,u,s);if(t<T.x+r.getColumnWidth(c)-2&&n>T.y+2&&n<T.y+6)return R(S,b,f,c,a,u,s)}if(c===S.iw&&f===S.Ky+S.Sx-1){if(w&&C&&(t<=T.x+2||n>=T.y+r.getRowHeight(f)-2))return R(S,o,f,c,a,u,s);if(t>T.x+2&&t<T.x+18&&n<T.y+r.getRowHeight(f)-2)return R(S,y,f,c,a,u,s)}if(w&&C&&c>S.iw&&c<S.iw+S.Tx&&f===S.Ky&&n<=T.y+2)return R(S,o,f,c,a,u,s);if(c>S.iw&&c<S.iw+S.Tx&&f===S.Ky&&n>T.y+2&&n<T.y+6)return R(S,b,f,c,a,u,s);if(w&&C&&f>S.Ky&&f<S.Ky+S.Sx&&c===S.iw&&t<=T.x+2)return R(S,o,f,c,a,u,s);if(f>S.Ky&&f<S.Ky+S.Sx&&c===S.iw&&t>T.x+2&&t<T.x+18)return R(S,y,f,c,a,u,s);if(M=r.getColumnWidth(S.iw+S.Tx-1),i=r.getRowHeight(S.Ky+S.Sx-1),p=T.x+M,y=T.y+i,C&&(f>S.Ky&&f<S.Ky+S.Sx&&c===S.iw+S.Tx-1&&p-2<=t&&t<=p||c>S.iw&&c<S.iw+S.Tx&&f===S.Ky+S.Sx-1&&y-2<=n&&n<=y)){if(c===S.iw+S.Tx-1&&f===S.Ky+S.Sx-1&&y-10<=n&&p-10<=t)return B;if(w)return R(S,o,f,c,a,u,s)}}}return B},c.prototype.wR=function(t,n){var e,i,e,r,o,a,e=this,i=e.Mf;if(e.find(t,n)instanceof U){for(r=0,(e=e.find(t,n)).oL&&(r=1),o=0,e.jO&&(o=1);0<t&&0===i.getRowHeight(t-1);)t--;if(1===o&&n===e.iw&&t===e.Ky)return a=vt(i,e,!0),v(a,e.iw+e.Tx-1,a);if(n===e.iw&&t===e.Ky)return a=vt(i,e,!0),v(a,e.iw+e.Tx-1,a);if(t>e.Ky&&t<e.Ky+e.Sx-r&&n===e.iw)return t===e.Ky+o?(t=vt(i,e,!0),v(t,e.iw+e.Tx-1,t)):v(t-1,e.iw+e.Tx-1,t-1)}return null},c.prototype.xR=function(t,n){var e,i,e,r,o,a,a,u,s,c,f,l,l,h,u,d,e=this,i=e.Mf;if(e.find(t,n)instanceof U){for(r=0,(e=e.find(t,n)).oL&&(r=1),o=0,e.jO&&(o=1),a=i.getRowCount()-1;t+1<i.getRowCount()&&0===i.getRowHeight(t+1);)t++;if(a!==t&&n===e.iw+e.Tx-1&&t<e.Ky+e.Sx-r)return a=e.Ky+e.Sx,c=(u=e.iw)+(s=e.Tx)-1,f=v(t+1,e.iw,t+1),t===a-r-1&&(e.VSt?(l=gt(i,e),1===r&&bt(i,e,a,l,u,c,1,!0,!1,!0)||(u=(h=(l=O(i,new _.Range(a,u,l-a+1,c-u+1)))&&l.row)===a,a!==i.getRowCount()&&(u?Ce:Se)(i,e,t,1,!0))):f=v(t,1+c,t)),f;if(i.getRowCount()-1===t&&n===e.iw+e.Tx-1&&0===r){for(d=e.Ky+o;d+1<i.getRowCount()&&0===i.getRowHeight(d);)d++;return d+1===i.getRowCount()&&0===i.getRowHeight(d)?v(e.Ky,e.iw,e.Ky):v(d,e.iw,d)}}return null},c.prototype.fR=function(t,n){var e,i,e,r,o,a,e=this,i=e.Mf;if(e.find(t,n)instanceof U){for(r=0,(e=e.find(t,n)).oL&&(r=1),o=0,e.jO&&(o=1);0<n&&0===i.getColumnWidth(n-1);)n--;if(n===e.iw&&(t===e.Ky||t===e.Ky+o))return{col:a=mt(i,e),leadingCellCol:a,row:e.Ky+e.Sx-1-r};if(n===e.iw&&(t===e.Ky||t===e.Ky+o))return{col:a=mt(i,e),leadingCellCol:a,row:e.Ky+e.Sx-1-r};if(n>e.iw&&n<e.iw+e.Tx&&(t===e.Ky||t===e.Ky+o))return n===e.iw?{col:n=mt(i,e),leadingCellCol:n+1,row:e.Ky+e.Sx-1-r}:{col:n-1,leadingCellCol:n-1,row:e.Ky+e.Sx-1-r}}return null},c.prototype.SB=function(){for(var t,n,e,i,r,t,n=this.U3,e=n.length,r=0;r<e;r++)(i=n[r]).w5t()},c.prototype.cL=function(t,n){for(var e,i,r,o,a,u,s,u,s,e,i=this.U3,r=i.length,o=0;o<r;o++)a=i[o],t?(u=a.Ky,s=a.Ky+a.Sx-1,u<=n&&n<=s&&a.cL(0)):(u=a.iw,s=a.iw+a.Tx-1,u<=n&&n<=s&&a.cL(0))},c.prototype.AJ=function(t,n,e,i,r){for(var o,a,u,s,c,o=this.AB(t,n,e,i),a=[],u=0,s=o.length;u<s;u++)c=o[u].dataRange(),r?c.rowCount+=e:c.colCount+=i,a.push(c);return a},ie=c,S.TableManager=ie,(r=re=S.TableRemoveOptions||(S.TableRemoveOptions={}))[r.none=0]="none",r[r.keepData=1]="keepData",r[r.keepStyle=2]="keepStyle",_.GC$.extend(_.Y8.prototype,{D5t:function(t,n){var e,i,i,e,i=this.G8;i&&(i.tableChanges||(i.tableChanges=[]),delete(i=i.tableChanges).isRestored,i.push({type:"changeTableManager",table:t,oldTableManager:n}))},YSt:function(t,n,e,i){var r,o,o,r,o=this.G8;o&&(o.tableChanges||(o.tableChanges=[]),delete(o=o.tableChanges).isRestored,o.push({type:Ln,table:t,name:n,value:e,newValue:i}))},DTt:function(t,n,e){var i,r,r,i,i=this,r=i.G8;r&&(r.tableChanges||(r.tableChanges=[]),r=r.tableChanges,i=i.QSt,delete r.isRestored,r.push({type:Rn,tableList:i.U3.slice(),changedTables:t,addedTables:n,changeType:e}))},A5t:function(t,n,e,i,r){var o,a,a,o,a=this.G8;a&&(a.tableChanges||(a.tableChanges=[]),delete(a=a.tableChanges).isRestored,a.push({tableName:t.name(),type:Bn,tableColumn:n,name:e,value:i,newValue:r}))},HTt:function(t,n,e){var i,r,o,i,i,i=this,r,o=t.getValue(n,e).value,i=i.G8;i&&(i.tableChanges||(i.tableChanges=[]),delete(i=i.tableChanges).isRestored,i.push({type:Fn,bindingManager:t,row:n,col:e,oldValue:o}))},B5t:function(t,n,e,i,r){var o,a,a,o,a=this.G8;a&&(a.tableChanges||(a.tableChanges=[]),delete(a=a.tableChanges).isRestored,a.push({type:Pn,table:t,key:i,row:n,count:e,stateType:r}))},_Tt:function(t,n,e){var i,r,o,i,r=this.G8;r&&(r.tableExpressionChanges||(r.tableExpressionChanges=[]),(o=r.tableExpressionChanges).push({type:Hn,table:t,expression:n,col:e}))},ETt:function(t,n,e,i){var r,o,a,r,o=this.G8;o&&(o.sheetExpressionChanges||(o.sheetExpressionChanges=[]),(a=o.sheetExpressionChanges).push({type:zn,table:t,expression:n,row:e,col:i}))},zTt:function(h){var d,v,t,n,e,i,r;if(h){for(d=null,Ee(v=this.QSt,h._bindingChanges,!0),t=function(t){var e,n,i,r,o,a,u,s,c,s,f,l,e=h[t],n=void 0;switch(e.type){case Rn:if(2===e.changeType)for(i=function(t){var n,t,n=e.changedTables[t],t=v.U3.findIndex(function(t){return t.name===n.name});0<=t&&v.U3.splice(t,1)},r=0;r<e.changedTables.length;r++)i(r);else if(1===e.changeType&&e.addedTables)for(o=e.addedTables,r=0;r<o.length;r++)(a=o[r])&&"Object"===a.constructor.name&&(a=je(v,a),v.U3.push(a));break;case Bn:n=v.findByName(e.tableName),u=e.tableColumn,"name"===e.name&&(u=e.value),0<=(s=n.BSt.findIndex(function(t){return t.name()===u}))&&((c=n.BSt[s])[e.name](e.newValue),"name"===e.name)&&n.I5t(u,e.newValue,s);break;case Ln:(n=e.table)?(s=e.name,f=e.newValue,s===P?(n.Ky=f.row,n.iw=f.col,n.Sx=f.rowCount,n.Tx=f.colCount):s===Un?(f=f&&f.map(function(t){var n;return t&&"Object"===t.constructor.name?((n=new H).fromJSON(t),n):t}),n.BSt=f):s===Cn?(f=f&&f.map(function(t){var n;return t&&"Object"===t.constructor.name?((n=new _.Style).fromJSON(t,!1,null),n):t}),n.OSt=f):("style"===s&&f&&f.buildInName&&(f=b.TableThemes[f.buildInName.toLowerCase()]),n[s](f))):"name"===e.name&&(n=v.findByName(e.value))&&n.name(e.newValue);break;case"changeTableManager":break;case Fn:(l=ke(v,e.bindingManager)).setValue(e.row,e.col,e.oldValue);break;case Pn:d=n=e.table,De(n="Object"===n.constructor.name?v.findByName(n.name):n,e.row,e.count,e.key,e.stateType)}},n=0;n<h.length;n++)t(n);if(d)for(d.LSt&&d.LSt.refresh(),e=this.Mf.slicers&&this.Mf.slicers.all(),n=0;n<e.length;n++)if((i=e[n]).LSt===d.LSt&&i.gmi)for(r=0;r<i.gmi.length;r++)i.gmi[r].onDataChanged()}},VTt:function(t){var n,e,i,r,o,a,u,u,s,c,c;if(t)for(n=this.QSt,e=void 0,i=!1,Ee(n,t.bindingChanges),r=t.length-1;0<=r;r--)switch(a=void 0,(o=t[r]).type){case Rn:u=o.changedTables,n.U3=o.tableList,u&&0<u.length&&u.forEach(function(t){t&&(i=!0,t.w5t(),t.qSt())});break;case Bn:o.tableColumn[o.name](o.value);break;case Ln:a=o.table,u=o.name,s=o.value,u===P?(c=a.footerIndex(),a.Ky=s.row,a.iw=s.col,a.Sx=s.rowCount,a.Tx=s.colCount,a.LSt&&_e(e,a.LSt),i&&-1!==c&&a.u5t(c)):u===Un?a.BSt=s:u===Cn?a.OSt=s:a[u](s),a.cL(0);break;case"changeTableManager":a=o.table,c=o.oldTableManager,a.k5t(c);break;case Fn:o.bindingManager.setValue(o.row,o.col,o.oldValue);break;case Pn:De(o.table,o.row,o.count,o.key,o.stateType),e=o}},YTt:function(t){var n,e,i,r,i,o,i;if(t){for(n=void 0,e=t.length-1;0<=e;e--)(i=t[e]).type===Hn&&(n=i.table,r=i.expression,i=i.col,o=void 0,o=n.BSt[i].footerFormula())&&-1<(i=Nt(o))&&(o.arguments[i]=r);n&&n.w5t()}},ZTt:function(t){var n,e,i,r,o;if(t)for(n=t.length-1;0<=n;n--)(e=t[n]).type===zn&&(i=e.expression,r=e.row,o=e.col,e.table.CTt(r,o,i))}}),_.Y8.ch(In,{priority:7e3,init:function(){this.QSt=new ie(this.Mf)},clearPendingChanges:function(t){var n=this.tables;n&&n.$St(t.tableList)},undoAddRows:function(t){var n,e,n,i,r,o,n=t.sheetArea;!I(n)&&n!==_.SheetArea.viewport||(n=(e=this).Mf,i=t.row,r=t.rowCount,(o=n.tables.AB(i,-1,r,-1)).forEach(function(t){t.x4t(i,r,wt(!0))}))},getValue:function(t){var n,e,i,r,o,i,n=t.row,e=t.col,i=t.sheetArea,r=this.Mf.tables;3===i&&r&&(o=r.find(n,e))&&(i=r.Sl(n,e),t.isValueGet=i.e5t,t.value=i.y4)},setValue:function(t){var n,e,i,r,o,a,r,u,n=t.row,e=t.col,i=t.value,r=t.sheetArea,o=this.Mf.tables;3===r&&o&&(a=o.find(n,e))&&(u=void 0,(r=t.changes)&&!(u=r.tableChanges)&&(r.tableChanges=[]),t.isValueSet=o.Kbt(n,e,i))},applyChanges:function(t){var n,e,t,i,r,e,n=this,e=t.changes,t=t.isUndo;e&&(i=e.tableChanges,r=e.tableExpressionChanges,e=e.sheetExpressionChanges,i&&(Re(n.QSt,i),t?n.VTt(i):n.zTt(i)),t)&&(r&&n.YTt(r),e)&&n.ZTt(e),n.QSt.dl()},undo:function(t){var n=t.tableChanges,e=t.tableExpressionChanges,t=t.sheetExpressionChanges;n&&!n.isRestored&&this.VTt(n),e&&this.YTt(e),t&&this.ZTt(t),this.QSt.dl()}}),_.Workbook.ch(In,{init:function(){_.Commands.D4t(this.commandManager())},onCultureChanged:function(){G()},preFromSJSFormat:function(t,n,e){var e,e,t,i,r,o,a,u,s,c,e=e&&!1===e.includeStyles;if(!e&&(t=(e=t.styles)&&e.tableStyles,i=n.styleManager,t)&&(i.addDefaultStyleName("defaultTableStyle",t.defaultTableStyle||"TableStyleMedium2"),0<(r=K(t.count,0)))&&(o=W(t,"tableStyle")))for(a=0,u=o;a<u.length;a++)(s=u[a])&&0==+s.pivot&&0<s.count&&(c=new b.TableTheme).yh(s,i)},preToSJSFormat:function(t,n,e){var i,e,r,o,a,u,s,c,f,i=e&&e.fileType===_.OpenSaveFileType.excel,e=e&&!1===e.includeStyles;if(i&&!e)for(o=0,a=r=this.mp;o<a.length;o++)c=(s=(u=a[o]).Mf).getRowCount(),f=s.getColumnCount(),u._gi===_.SheetType.tableSheet&&0<c&&0<f&&s.tables.WB(new U(s.name().replace(/ /g,"")+"Table",0,0,c,f,u.hl,{showHeader:!1}))},wh:function(t,n,e){var i,r,o,a,u,s,c,f,l,h,d,v,m,g,p,p,i=this,r=t.tables,o=n&&n.styleManager,a=e&&e.fileType===_.OpenSaveFileType.excel,u=e&&!1===e.includeStyles;if(!u)for(s={},f=(c=0,_.Ap)(i);c<f;c++)if((l=(0,_.Tp)(i,c))&&(d=(h=l.tables)&&h.all())&&0<d.length)for(v=0,m=d;v<m.length;v++)g=m[v],p=(r=r||(t.tables={}))[_.XFileConstants.du+g._id]={},g.wh(p,t,n,e,s),(p=g.style())&&!p.builtInName()&&o.addTableStyle(p.wh(o)),a&&!u&&l.NMi&&h.DK(g)}})},"./dist/plugins/table/table.ns.js":function(t,n,e){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.SR=void 0;var e=e("./dist/plugins/table/table.res.en.js");n.SR={en:e}},"./dist/plugins/table/table.res.en.js":function(t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.Table_Var=n.Table_StdDev=n.Table_Sum=n.Table_Min=n.Table_Max=n.Table_Count_Numbers=n.Table_Count=n.Table_Average=n.Table_None=n.Table_Total=n.Exp_TableAddRowNoEnoughRoom=n.Exp_TableAddRowIntersectTable=n.Exp_TableAddRowIntersectSpan=n.Exp_TableDeleteCountInvalid=n.Exp_ColParamOutOfRange=n.Exp_RowParamOutOfRange=n.Exp_TableResizeToTable=n.Exp_TableResizeWithHidden=n.Exp_TableResizeWithFilter=n.Exp_TableResizeToSpan=n.Exp_TableResizeInvalidRange=n.Exp_ArrayFormulaTable=n.Exp_TableResizeOutOfRange=n.Exp_TableMoveOutOfRange=n.Exp_TableDataSourceNullError=n.Exp_TableRangeHasFilterError=n.Exp_TableHasSameNameError=n.Exp_TableIntersectError=n.Exp_TableInvalidColumn=n.Exp_TableInvalidRow=n.Exp_TableNameInvalid=n.Exp_TableEmptyNameError=n.Exp_DragDropChangePartOfTable=n.Exp_DragDropShiftTableCell=void 0,n.Exp_DragDropShiftTableCell="This operation is not allowed. The operation is attempting to shift cells in a table on your worksheet.",n.Exp_DragDropChangePartOfTable="Cannot complete operation: You are attempting to change a portion of a table row or column in a way that is not allowed.",n.Exp_TableEmptyNameError="The table name cannot be empty.",n.Exp_TableNameInvalid="The table name is not valid.",n.Exp_TableInvalidRow="Invalid row index or row count.",n.Exp_TableInvalidColumn="Invalid column index or column count.",n.Exp_TableIntersectError="The tables cannot be intersected.",n.Exp_TableHasSameNameError="The current worksheet already exists in a table with the same name.",n.Exp_TableRangeHasFilterError="The current table range contains a filter range.",n.Exp_TableDataSourceNullError="Table datasource cannot be null.",n.Exp_TableMoveOutOfRange="The table cannot be moved out of the sheet.",n.Exp_TableResizeOutOfRange="The invalid row count, column count, and table cannot be resized out of the sheet.",n.Exp_ArrayFormulaTable="multi-cell array formulas are not allowed in tables.",n.Exp_TableResizeInvalidRange="The headers must remain in the same row, and the resulting table range must overlap the original table range.",n.Exp_TableResizeToSpan="Cannot complete operation: A table cannot overlap with a table or merged cells.",n.Exp_TableResizeWithFilter="Cannot shift cells in a filtered range or table.",n.Exp_TableResizeWithHidden="Cannot resize a table that's adjacent to a hidden row or column.",n.Exp_TableResizeToTable="Cannot complete operation: Operations that include cells both inside and outside a table range, and operation that affect cells that overlap multiple tables are not allowed.",n.Exp_RowParamOutOfRange="The param row out of data range of table.",n.Exp_ColParamOutOfRange="The param col out of data range of table.",n.Exp_TableDeleteCountInvalid="The param count to delete will cause empty table.",n.Exp_TableAddRowIntersectSpan="This won't work because it would move cells in a span on your worksheet.",n.Exp_TableAddRowIntersectTable="This won't work because it would move cells in a table on your worksheet.",n.Exp_TableAddRowNoEnoughRoom="Cannot insert new cells because it would push non-empty cells of the end of worksheet. These cells might appear empty but have blank values, some formatting, or a formula. Delete enough rows or columns to make room for what you want to insert and then try again.",n.Table_Total="Total",n.Table_None="None",n.Table_Average="Average",n.Table_Count="Count",n.Table_Count_Numbers="Count Numbers",n.Table_Max="Max",n.Table_Min="Min",n.Table_Sum="Sum",n.Table_StdDev="StdDev",n.Table_Var="Var"},"./dist/plugins/touch/touch.entry.js":function(t,n,e){"use strict";var i,r,i=this&&this.__createBinding||(Object.create?function(t,n,e,i){void 0===i&&(i=e);var r=Object.getOwnPropertyDescriptor(n,e);r&&("get"in r?n.__esModule:!r.writable&&!r.configurable)||(r={enumerable:!0,get:function(){return n[e]}}),Object.defineProperty(t,i,r)}:function(t,n,e,i){t[i=void 0===i?e:i]=n[e]}),r=this&&this.__exportStar||function(t,n){for(var e in t)"default"===e||Object.prototype.hasOwnProperty.call(n,e)||i(n,t,e)};Object.defineProperty(n,"__esModule",{value:!0}),r(e("./dist/plugins/touch/touch.js"),n)},"./dist/plugins/touch/touch.js":function(x,t,L){"use strict";var F,P,N,L,k,L,D,G,U,c,f,H,z,V,Y,i,M,p,_,E,Z,W,Q,o,J,K,X,q,$,tt,l,nt,et,it,rt,ot,at,ut,st,ct,ft,h,a,lt,ht,dt,j,vt,v,mt,O,V,u,gt,pt,bt,yt,wt,Mt,C,Ct,St,Tt,At,It,xt,Nt,kt,Dt,_t,Et,jt,Ot,Rt,Bt,Lt,Ft,Pt,Gt,Ut,Ht,zt,Vt,Yt,Zt,Wt,Qt,Jt,Kt,d,Xt,qt,$t,tn,nn,en,rn,on,an,un,sn,cn,fn,ln,hn;function R(t){return t.height}function B(t){return t.width}function dn(t){clearInterval(t)}function m(){return(new Date).valueOf()}function vn(t,n){var e,i,r,o,a,u,s,t;return t&&n&&(o=r=e=13,u=a=i=15,s=t.X-n.X,t=t.Y-n.Y,_(s)<13)&&_(t)<13&&K(s*s+t*t)<E(15,15)}function g(t){var t=t.jg();return t instanceof N.Worksheet?t:t&&t.Mf}function y(t){return t.getSelections()}function mn(t){return t.frozenTrailingColumnCount()}function gn(t){return t.frozenTrailingRowCount()}function pn(t,n){return t.getColumnCount(n)}function bn(t,n){return t.getRowCount(n)}function yn(t){var t=D(t).offset(),n=j.body,e=0,i=0;return t&&(e=t.top+n.clientTop||0,i=t.left+n.clientLeft||0),{A0:e,I0:i}}function n(){var t=this;t.j0t=[],t.WTt={length:0},t.QTt=new wt,t.KTt=new Mt}function wn(t,n){var n=Q(n.Y,n.X)-Q(t.Y,t.X);return o<n?n-=2*o:n<-o&&(n+=2*o),n}function Mn(t,n){return K((n.X-t.X)*(n.X-t.X)+(n.Y-t.Y)*(n.Y-t.Y))}function Cn(t,n,e){var i,r,t,n,i,i=new C(e._Center.X,e._Center.Y),r=new C(n.X-i.X,n.Y-i.Y),t=new C(t.X-i.X,t.Y-i.Y),n=E(1,W(Mn(n,i)/e._Radius,4)),i=wn(r,t);return a(i)?0:i*n}function Sn(t){return _(t)<=2220446049250313e-31}function Tn(t,n){var e=!1,i=!1,r;return{JTt:e=0!==t&&(r=X(n/t)/o*180)<20?!0:e,XTt:i=0===t||75<(r=X(n/t)/o*180)&&r<105?!0:i}}function e(){var t=this;t.qTt=0,t.$Tt=0,t.tAt=1,t.nAt=0,t.eAt=0,t._process=0,t.rAt=511,t.oAt=new Nt,t.aAt=20,t.uAt=new Ct}function r(){}function An(t,n){this.X=t,this.Y=n}function In(t){return new C(t?J(t.X):-1,t?J(t.Y):-1)}function s(){var t=this;t.DU=0,t.ak=0,t.sAt=10,t.cAt=[]}function xn(t,n,e,i,r){var o=this;t?o.cAt=t:(o.fAt=new C(n,e),o.lAt=i,o.hAt=r)}function Nn(t){this.dAt=t,this.vAt=0}function kn(t){this.dAt=t,this.vAt=0}function Dn(t,n){var e=this;e.mAt=t,e.gAt=n,e.pAt=0,e.bAt=0,e.vAt=0,e.yAt=K(t*t+n*n)}function _n(){var t=this;t.wAt=new C(0,0),t.tW=0,t.MAt=0,t.CAt=0}function En(){this.wY=[]}function jn(t,n,e){var i=this;i.nW=t,i.SAt=n,i.TAt=e}function On(t,n,e,i,r){var o=this;o.qZ=t,o.nW=n,o.AAt=e,o.JZ=i,o.TAt=r}function Rn(t,n,e,i,r,o){var a=this;a.qZ=t,a.nW=n,a.SAt=e,a.AAt=i,a.JZ=r,a.TAt=o}function Bn(t,n,e,i,r,o,a){var u=this;u.qZ=t,u.nW=n,u.SAt=e,u.TAt=i,u.IAt=r,u.xAt=o,u.NAt=a}function Ln(t,n,e,i){var r=this;r.qZ=t,r.kAt=n,r.nW=e,r.JZ=i}function Fn(t,n,e,i){var r=this;r.qZ=t,r.KZ=n,r.DAt=e,r.JZ=i}function Pn(t){this.JZ=t}function Gn(t){this.JZ=t}function Un(t){this.JZ=t}function Hn(t,n){var t=t*n;return 4<t?t=4:t<.5&&(t=.5),t}function zn(t){this.Mf=t}function Vn(t,n,e,i){var r,o,e,a,u,s,c,f,l,h,h,d,v,m,g,c,r=e,o=0,e=0,a=t.Jt,c=t.Fi(),f=c.Cy,l=t.dw(1).findRow(r),h=t.parent,h=h&&h.options.scrollByPixel&&h.options.scrollbarMaxAlign;if(l)if(0<n){for(u=t.vw(-1),o=f-l.y;u<r&&o<n;)o+=a.Gt(--r);e=n-o}else if(n<0){if(d=0,v=i,h){if(m=t.frozenRowCount(),g=t.getRowCount()-t.frozenTrailingRowCount()-1,s=(c=t.gw(t.Sy(c),m,g)).Ky,d=c.Xy,v=i+n,s<r||r===s&&v<d)return M}else s=t.mw();for(o=-(l.y+R(l)-f);r<s&&n<o;)o-=a.Gt(++r);e=n-o,h&&r===s&&v<d&&(n=(e=d+a.Gt(r))+o)}return{Ky:r,Xy:e,_At:n}}function Yn(t,n,e,i){var r,o,e,a,u,s,c,f,l,h,h,d,v,m,g,c,r=e,o=0,e=0,s=t.Jt,c=t.Fi(),f=c.Py,l=t.yw(1).findCol(r),h=t.parent,h=h&&h.options.scrollByPixel&&h.options.scrollbarMaxAlign;if(l)if(0<n){for(a=t.ww(-1),o=f-l.x;a<r&&o<n;)o+=s.Kt(--r);e=n-o}else if(n<0){if(d=0,v=i,h){if(m=t.frozenColumnCount(),g=t.getColumnCount()-t.frozenTrailingColumnCount()-1,u=(c=t.Cw(t.Gy(c),m,g)).iw,d=c.Xy,v=i+n,u<r||r===u&&v<d)return M}else u=t.Mw();for(o=-(l.x+B(l)-f);r<u&&n<o;)o-=s.Kt(++r);e=n-o,h&&r===u&&v<d&&(n=(e=d+s.Kt(r))+o)}return{iw:r,Xy:e,EAt:n}}function Zn(t,n){return lt(-n/(t/n+1)+n+"")}function Wn(t,n){return lt(n*(-n/(t-n)-1)+"")}function w(t,n,e,i,r,o){t.fillStyle=n,t.fillRect(e,i,r,o)}function Qn(t,n,e,i,r){var o,a,u,a,s,c,f,l,a=N.I.He(0,"gc-columnHeader-normal"),u=a&&a.backgroundImage,a=a&&a.backgroundColor;if(u&&-1!==u.indexOf("linear-gradient"))for(s=N.mt.ri(u),o=t.createLinearGradient(n+i/2,e,n+i/2,e+r),c=0,f=s.length;c<f;c++)l=s[c],o.addColorStop(l.point,l.color);else a&&(o=a);return o}function Jn(){var t=N.I.He(0,"gc-rowHeader-normal");return t&&t.backgroundColor}function Kn(t,n){var e,i,r,o,a,o,u,s,i,c,f,l,h,d,v,m,g,p,b,a,o,y,d,y,d,d,y,b,o,p,e=t.Fi(),i=t.Dn,r,o=t.options.sheetAreaOffset,a=o.left,o=o.top,u=i.R7(!1),s=i.J(),i=i._7(),d=t.dw(1),v=qn(t),m=e.J7,g=e.Uy,p=e.X7,b=e.Ty,c=e.BA,a=1<=a?1:0,o=1<=o?1:0,l=B(e);s.save(),i.save(),y=t.vw(-1),(d=d.findRow(y))&&(f=e.Cy,0<(h=d.y-f-1-o))&&(n?(y=e.XC,w(s,d=Jn(),c,f,y-1,h+1),w(i,d,c,f,y-1,h+1),w(s,u,c+y,f,l-y-v.width,h),w(i,u,c+y,f,l-y-v.width,h)):(w(s,u,c,f,l,h),w(i,u,c,f,l,h))),O<b&&(w(s,u,c,p,l,h=b-O-o),w(i,u,c,p,l,h)),d=t.yw(1),f=e.LA,h=R(e),y=t.ww(-1),(b=d.findCol(y))&&(c=e.Py,0<(l=b.x-c-1-a))&&(n?(w(s,p=Qn(s,c,f,l+1,(o=e.qC)-1),c,f,l+1,o-1),w(i,p,c,f,l+1,o-1),w(s,u,c,f+o,l,h-o-v.height),w(i,u,c,f+o,l,h-o-v.height)):(w(s,u,c,f,l,h),w(i,u,c,f,l,h))),O<g&&(w(s,u,m,f,l=g-O-a,h),w(i,u,m,f,l,h)),i.restore(),s.restore()}function Xn(t,n,e,i,r,o){t.beginPath(),t.strokeStyle=n,t.moveTo(e,i),t.lineTo(r,o),t.stroke()}function qn(t){var n,e=t.options.sheetAreaOffset;return t.gj&&t.gj()||{x:e.left,y:e.top,width:0,height:0}}function $n(t,n){var e,i,r,o,a,u,o,u,s,c,s,o,t,s,f,e=t.Fi(),i,r=t.Dn.J(),o=t.dw(1),a=qn(t),u=t.vw(-1),o=o.findRow(u),u=z("gc-group").color;o&&(s=e.Cy,0<(c=o.y-s))&&n&&0<a.width&&0===e.XC&&Xn(r,u,e.b6-.5,s,e.b6-.5,o.y),s=t.yw(1),o=t.ww(-1),(t=s.findCol(o))&&(s=e.Py,0<(f=t.x-s))&&n&&0<a.height&&0===e.qC&&Xn(r,u,s,e.T6-.5,t.x,e.T6-.5)}function te(t,n){var e,i,r,o,o,i,a,u,s,c,f,l,h,f,h,f,t,e=t.Fi(),i=t.Dn,r=t.options.gridline.color,o=N.I.He(0,"gc-columnHeader-normal"),o=o&&o.borderBottomColor,i=i.J(),f=t.dw(1),l=qn(t),a=e.BA,s=B(e),h=t.vw(-1),f=f.findRow(h);f&&(u=e.Cy,0<(c=f.y-u))&&(Xn(i,r,a,f.y-.5,a+s-l.width,f.y-.5),n)&&(0===l.width&&Xn(i,r,e.BA-.5,u,e.BA-.5,f.y),Xn(i,o,e.b6-.5,u,e.b6-.5,f.y)),h=t.yw(1),u=e.LA,c=R(e),f=t.ww(-1),(t=h.findCol(f))&&(a=e.Py,0<(s=t.x-a))&&(Xn(i,r,t.x-.5,u,t.x-.5,u+c-l.height),n)&&(0===l.height&&Xn(i,r,a,e.LA-.5,t.x,e.LA-.5),Xn(i,o,a,e.T6-.5,t.x,e.T6-.5))}function ne(t,n){var e=0;return t||(e|=1),n||(e|=2),e}function ee(t,n){var e=0;return e=e|(0!==t?1:0)|(0!==n?2:0)}function b(t){this.Mf=t}function ie(t,n,e,i,r){var o,a,u,s,c,f,l,f,h,d,v,f,o=t.parent,a=t.rt,u=t.options,s=n.rowViewportIndex,c=n.colViewportIndex,f=y(t),l=M;return t.Oi&&0<f.length&&(h=(f=f[f.length-1]).row,d=f.row+f.rowCount-1,v=f.col,f=f.col+f.colCount-1,o&&!o.options.allowUserResize||(-1!==h&&-1===v&&0<=s&&c<0&&u.rowHeaderVisible?!(l=a.cD(t,n,r,2,i))||"sizeRow"!==l.action&&"sizeHiddenRow"!==l.action||2!==l.sheetArea||l.index===d||(l=M):-1===h&&-1!==v&&s<0&&0<=c&&u.colHeaderVisible&&(!(l=a.dD(t,n,r,1,e))||"sizeCol"!==l.action&&"sizeHiddenCol"!==l.action||1!==l.sheetArea||l.index===f||(l=M)))),l}function re(t,n,e,i){var r,o,a,u,a,s,c,c,c;if(0===t.selectionPolicy())return M;for(r=n.hitTestType,o=Se(t),a=y(t),u=3,t.Oi&&0<a.length&&(-1!==(a=a[a.length-1]).row&&-1===a.col?u=2:-1!==a.col&&-1===a.row&&(u=1)),s=0;s<o.length;s++)if((c=o[s])&&(c.x-=B(c),c.y-=R(c),c.width*=3,c.height*=3,c.contains(e,i)))return k(n.row)&&(c=t.dw(1))&&0<c.length&&(n.row=c[c.length-1].row),k(n.col)&&(c=t.yw(1))&&0<c.length&&(n.col=c[c.length-1].col),{x:e,y:i,type:u,isHeader:!1,isFirstIndicator:0===s};return 1===r&&t.JA(-1,n.col)?{x:e,y:i,type:1,isHeader:!0}:2===r&&t.JA(n.row,-1)?{x:e,y:i,type:2,isHeader:!0}:M}function oe(t,n,e,i){var r,o,n,a,u,u,s,c,f,l,s,f,n,s,f,r=M,o=n.rowViewportIndex,n=n.colViewportIndex;if(!k(o)&&!k(n)){if(a=t.parent,u=t.U5(),0<=o&&0<=n&&1===t.Ut.getSelections().length){if(u=t.JS(u),s=mn(t),c=gn(t),f=pn(t)-s,l=bn(t)-c,1===n&&0<s&&u.col<f&&u.col+u.colCount>f&&(s=t.Yy(n))&&0<s.length&&e>(f=s[s.length-1]).x+B(f))return r;if(1===o&&0<c&&u.row<l&&u.row+u.rowCount>l&&(n=t._y(o))&&0<n.length&&i>(s=n[n.length-1]).y+R(s))return r}(f=we(t))&&(r||(f.x-=B(f),f.y-=R(f),f.width*=3,f.height*=3,f.contains(e,i)&&(r={action:"drag",side:"corner"})),a&&a.options.allowUserDragFill||r&&"corner"===r.side&&(r.side=M))}return r}function ae(t,n,e,i){for(var r,o,a,u,s,c,f,l,h,s,r=!1,o=t.Ut.getSelections(),a=0,u=o.length;a<u;a++){if(s=o[a],f=(s=(c=3===i||k(i))?t.JS(s):s).row,l=s.col,h=s.rowCount,s=s.colCount,c)r=f<=n&&n<f+h&&l<=e&&e<l+s;else if(2===i)r=-1===l&&f<=n&&n<f+h;else if(1===i)r=-1===f&&l<=e&&e<l+s;else if(0===i)return r;if(r)break}return r}function ue(t,n,e,i,r){n===i&&e===r||(t.Ut.setCellState(n,e,N.CellStatesType.active,!1,N.SheetArea.viewport),t.k_&&t.k_(N.CellStatesType.active,n,e,N.SheetArea.viewport),t.Ut.setCellState(i,r,N.CellStatesType.active,!0,N.SheetArea.viewport),t.k_&&t.k_(N.CellStatesType.active,i,r,N.SheetArea.viewport))}function se(t,n,e,i){var n,n,r,o;n||(n=(n=y(t))[n.length-1],r=t.ui,o=t.ci,e?3===i?(t.ui=n.row+n.rowCount-1,t.ci=n.col+n.colCount-1):2===i?(t.ui=n.row+n.rowCount-1,t.ci=0):1===i&&(t.ui=0,t.ci=n.col+n.colCount-1):3===i?(t.ui=n.row,t.ci=n.col):2===i?(t.ui=n.row,t.ci=0):1===i&&(t.ui=0,t.ci=n.col),ue(t,r,o,t.ui,t.ci))}function ce(t,n,e,i){var n,n,r,o;n||(n=(n=y(t))[n.length-1],r=t.ui,o=t.ci,e&&(3===i?(t.ui=n.row,t.ci=n.col):2===i?(t.ui=n.row,t.ci=0):1===i&&(t.ui=0,t.ci=n.col)),ue(t,r,o,t.ui,t.ci))}function S(t){var n=this;n.jAt=!1,n.YZ=new Ft(t),n.OAt=new Ut(t),n.Mf=t}function fe(t,n,e){var i=this;i.kZ=e,i.AZ=new nn(n),i.DZ=new Ht(n),i.xZ=new en(t,"sheet",i.AZ,100,10),i.kZ.aW(i.xZ,!0)}function T(t,n){var n,e,t,n=hn.call(this,n,N.mt.gi(t.Ti))||this,e=n;return e.RAt=32,e.BAt=45,e.f$={},e.Jet=!1,e.Vv=t,t=e.Xc(),(e.LAt=t).addClass("gc-toolstrip-default ui-state-default well"),t.appendTo(e.qc()),t.hide(),e.FAt(),e.PAt(),e.aY(),n}function le(t){var t=t.WL,n=!1;return t&&t.QP().forEach(function(t){t&&t.isSelected()&&(n=!0)}),n}function he(t,n,e){var i,r,e,i=c("span"),r=j.body;return i.className=e,i.style.font=t,i.style.cssFloat="left",i.textContent=n,r.insertBefore(i,M),e=D(i).width(),r.removeChild(i),e}function de(t,n,e,i,r){this._font="normal 12px Arial";var o=this;o.Zc=t,o._text=n,o.GAt=e,i&&(o.tT=i),r&&(o.UAt=r)}function ve(t){function n(){for(var t,n,e,t="separator",n=0,e=t+n.toString();j.getElementById(e);)e=t+(++n).toString();return e}this.Zc=n(),t&&(this.UAt=t)}function A(t){this.jS=t}function me(t,n,e,i,r){var o=this;o.RS=t,o.HAt=e,o.zAt=n,o.VAt=i,o.YAt=r}function ge(){}function I(t){this.w2=t}function pe(t,n,e){var i,r,t,i=this;i.AZ=new nn(i),i.xZ=new en(t,"tabStrip",i.AZ,1,-1),i.kZ=e,i.DZ=new sn(n),r=i.DZ,(t=i.xZ).RZ=function(t){return r.BZ(t)},t.LZ=function(t){return r.FZ(t)},t.PZ=function(t){return r.GZ(t)},t.UZ=function(t){return r.HZ(t)},t.ZAt=function(t){return r.WAt(t)}}function be(t,n,e,i){var t=t.BO();t.jt(n)?e.drawImage(t.Ot(n),i.x,i.y,B(i),R(i)):t.Rt(n)}function ye(t,n){var e,i,r,o,a,u,s,s,c,f,l,s,h,d,h,f,e=t.Fi(),r=16,s=y(t);t.Oi&&0<s.length&&(c=(s=s[s.length-1]).row,f=s.row+s.rowCount-1,l=s.col,s=s.col+s.colCount-1,d="AAAAAQCAYAAAAf8/9hAAAAIGNIUk0AAHolAACAgwAA+f8AAIDpAAB1MAAA6mAAADqYAAAXb5JfxUYAAAAJcEhZcwAADs",(h=t.parent)&&!h.options.allowUserResize||(-1!==c&&-1===l&&t.getRowResizable(f)?(h=t.C0(f),i=v+d+"MAAA7DAcdvqGQAAABaSURBVDhPY/z//z8DLsDIyAiWBKphBAtgAUxQGgPANIMAMhsdYDUAmwZchtDOC8SCgTcA5DfcgUAEoNwFo7GAPQxwJVtsYYHVBdgU4gpInF5A1oBLMwMDAwMApuAtD6Z7YxQAAAAASUVORK5CYII=",o=t.getCellRect(f,pn(t,2)-1,h,-1),(u=e.B1(h)).y<=o.y&&o.y+R(o)<=u.y+R(u)&&(a=new N.Rect(e.b6-16,o.y+R(o)-8,16,16))):-1===c&&-1!==l&&t.getColumnResizable(s)&&(f=t.S0(s),i=v+d+"IAAA7CARUoSoAAAAAadEVYdFNvZnR3YXJlAFBhaW50Lk5FVCB2My41LjEwMPRyoQAAAE1JREFUOE/ljtEKACAIA/v/nzZ9mFhsJPRocLEuGS4zk/iJyyP/D6gE0wrYoCqoLoUafPl8fEBln3ulSscfErk65TMjMFRBhUowosDWBoHpba8+C7w0"+mt,o=t.getCellRect(bn(t,1)-1,s,-1,f),(u=e.L1(f)).x<=o.x)&&o.x+B(o)<=u.x+B(u)&&(a=new N.Rect(o.x+B(o)-8,e.T6-16,16,16)),i&&a&&be(t,i,n,a)))}function we(t){var n,e,i,e,i,r,o,n=M,e=y(t),i=e.length;return t.Oi&&0<i&&(e=e[i-1],i=t.j1(e),n=new N.Rect(i.x+B(i)-(r=17),i.y+R(i),17,o=20)),n}function Me(t,n,e){var n,e,n,t,e,i,r,o,n=t.C0(n),e=t.S0(e),n=t.dw(n),t=t.yw(e),e=0,i=0,r=0,o=0;return 0<n.length&&(e=n[0].row,i=n[n.length-1].row),0<t.length&&(r=t[0].col,o=t[t.length-1].col),(0,N.Ec)(e,r,i-e+1,o-r+1)}function Ce(t,n,e,i,r,o){var a,u,s,a,u,t,n,a=t.C0(n),u=t.S0(e),s,a=t.Fi().c9(a,u),u=Me(t,n,e),t=u.row<=n&&n<=u.row+u.rowCount-1&&a.y<=r&&r<=a.y+R(a),n=u.col<=e&&e<=u.col+u.colCount-1&&a.x<=i&&i<=a.x+B(a);return o&&o.colCheck?n:(o&&o.rowCheck||n)&&t}function Se(t){var n,e,n,i,r,o,a,u,s,c,f,l,h,d,v,d,m,v,d,v,h,n,g,o,p,b,n=y(t),e=[];if(t.Oi&&0<n.length)for(n=n[n.length-1],i=t.j1(n),r=8,o=t.Fi(),a=n.row,u=n.row+n.rowCount-1,s=n.col,c=n.col+n.colCount-1,-1!==n.row&&-1!==n.col?(Ce(t,a,s,i.x,i.y)&&(e[0]=new N.Rect(i.x-8,i.y-8,16,16)),Ce(t,u,c,i.x+B(i),i.y+R(i))&&(e[1]=new N.Rect(i.x+B(i)-8,i.y+R(i)-8,16,16))):-1!==n.row?(f=o.c9(1,0),l=o.c9(1,1),h=f.x+(B(f)+B(l))/2-8,d=pn(t)-1-mn(t),(d=(v=t.yw(1)).findCol(d))&&(v=(m=t.yw(0))[0]||v[0])&&(h=v.x+(d.x+B(d)-v.x)/2-8),Ce(t,a,s,h+8,i.y,{rowCheck:!0})&&(e[0]=new N.Rect(h,i.y-8,16,16)),Ce(t,u,c,h+8,i.y+R(i),{rowCheck:!0})&&(e[1]=new N.Rect(h,i.y+R(i)-8,16,16))):-1!==n.col&&(f=o.c9(0,1),l=o.c9(1,1),d=f.y+(R(f)+R(l))/2-8,v=bn(t)-1-gn(t),(n=(h=t.dw(1)).findRow(v))&&(o=(g=t.dw(0))[0]||h[0])&&(d=o.y+(n.y+R(n)-o.y)/2-8),Ce(t,a,s,i.x,d+8,{colCheck:!0})&&(e[0]=new N.Rect(i.x-8,d,16,16)),Ce(t,u,c,i.x+B(i),d+8,{colCheck:!0}))&&(e[1]=new N.Rect(i.x+B(i)-8,d,16,16)),p=void 0,b=e.length-1;0<=b;b--)(!(p=e[b])||p.x<0||p.y<0)&&(e[b]=M);return e}function Te(t,n,e){var i,r,o,a;if((0,N.needPaintSelection)(t)&&!t.isEditing()&&n&&0!==t.selectionPolicy()&&(o=void 0,0<(r=(i=Se(t)).length))){for(e.save(),e.fillStyle=t.aR()||"white",e.strokeStyle=t.getSelectionBorderColor(),a=0;a<r;a++)(o=i[a])&&(e.beginPath(),e.arc(o.x+B(o)/2,o.y+R(o)/2,B(o)/2,0,2*Math.PI,!1),e.fill(),e.stroke());e.restore()}}function Ae(t,n){var e,i,e=we(t);e&&be(t,i=v+"EAAAATCAIAAAD5x3GmAAAABGdBTUEAALGPC/xhBQAAAAlwSFlzAAAOwwAADsMBx2 + oZAAAAGhJREFUOE / djkEOwCAIBHk6P98u1lKo1diEU + dggOyAAkC + YPl / Onx3WDmiytm4aulQoKba + 4uiO77YhHDH5SqnRa0If / Nhq0fnjPob2h5oVXJI0rJA3h1ya1kgU4f4nQfVzozk7APgAIEqATZbalz1"+mt,n,e)}F=this&&this.__extends||(ln=function(t,n){return(ln=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(t,n){t.__proto__=n}:function(t,n){for(var e in n)Object.prototype.hasOwnProperty.call(n,e)&&(t[e]=n[e])}))(t,n)},function(t,n){if("function"!=typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function e(){this.constructor=t}ln(t,n),t.prototype=null===n?Object.create(n):(e.prototype=n.prototype,new e)}),Object.defineProperty(t,"__esModule",{value:!0}),t.QAt=t.NZ=t.IZ=t.TouchToolStripSeparator=t.TouchToolStripItem=t.TouchToolStrip=t.TouchEventHandler=t.ZZ=t.ManipulationStartingEventArgs=t.ManipulationStartedEventArgs=t.ManipulationDeltaEventArgs=t.ManipulationCompletedEventArgs=t.QZ=t.TouchEventProvider=t.SR=void 0,P=L("Common"),N=L("Core"),L=L("./dist/plugins/touch/touch.res.en.js"),t.SR={en:L},k=P.Common.lt.ht,L=N.zc,G=(D=N.GC$).extend,U=D.isEmptyObject,c=N.mt.En,f=N.mt.vi,H=N.mt.Tt.mozilla,z=N.I.fl,V=N.mt.pi(),Y=V.ipad,i=Y||V.iphone,M=null,p=void 0,_=Math.abs,E=Math.min,Z=Math.max,W=Math.pow,Q=Math.atan2,o=Math.PI,J=Math.round,K=Math.sqrt,X=Math.atan,q=Math.log,$=Math.floor,tt=100,l="touch",nt="none",et="MSPointerDown",it="MSPointerMove",rt="MSPointerUp",ot="pointerdown",at="pointermove",ut="pointerup",st="touchstart",ct="touchmove",ft="touchend",h="MSPOINTER_TYPE_TOUCH",a=isNaN,lt=parseInt,ht=parseFloat,dt=window,j=document,vt=dt.Vc,v="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAB",mt="AAAAAElFTkSuQmCC",O=1,N.Of.touch=!0,V=new P.Common.ResourceManager(t.SR,"Touch"),u=V.getResource.bind(V),gt=400,pt=1e3,bt=20,n.prototype.KAt=function(t){this.QTt.KAt=t},n.prototype.JAt=function(t){this.QTt.JAt=t},n.prototype.XAt=function(n){var e=this;e.QTt.XAt=function(t){var t;n&&(n(t),t=e.AZ)&&t.qAt()}},n.prototype.$At=function(t){this.QTt.$At=t},n.prototype.tIt=function(t){this.QTt.tIt=t},n.prototype.nIt=function(t){this.KTt.nIt=t},n.prototype.eIt=function(t){this.KTt.eIt=t},n.prototype.iIt=function(t){this.KTt.iIt=t},n.prototype.rIt=function(t){this.oIt=t},n.prototype.aIt=function(t){this.uIt=t},n.prototype.sIt=function(t,n){var n=(n||this.cIt).RS;return N.mt.T0(t,n)},n.prototype.fIt=function(t,n){var e,i,r,o,a,i,u,i,s,t,r,e=this,i=n.pointerType,r=n.target,o=n.offsetX,a=n.offsetY;i!==n[h]&&i!==l||(u=(i=e.sIt(r,t)).I0,i=i.A0,(s=e.lIt(t,r,n.pointerId,new C(o+u,a+i),n.timeStamp))&&f(n),"sheet"===e.cIt.zAt&&(t=n.pageX-(o+u),r=n.pageY-(a+i),e.cIt.RS.canvasOffset={top:r,left:t}))},n.prototype.hIt=function(t){var n,e,i,e,r,n=this,e=t.pointerType,i=t.pointerId;if(e===t[h]||e===l){if(n.WTt[i]===p)return!1;e=n.sIt(t.target),(r=n.iE(i,new C(t.offsetX+e.I0,t.offsetY+e.A0),t.timeStamp))&&f(t)}},n.prototype.dIt=function(t){var n,e,i,e,r,n=this,e=t.pointerType,i=t.pointerId;if(e===t[h]||e===l){if(n.WTt[i]===p)return!1;e=n.sIt(t.target),(r=n.vIt(i,new C(t.offsetX+e.I0,t.offsetY+e.A0)))&&f(t)}},n.prototype.mIt=function(t){var n,e,i,e,r,n=this,e=t.pointerType,i=t.pointerId;if(e===t[h]||e===l){if(n.WTt[i]===p)return!1;e=n.sIt(t.target),(r=n.gIt(i,new C(t.offsetX+e.I0,t.offsetY+e.A0)))&&f(t)}},n.prototype.pIt=function(t,n){for(var e,i,r,o,a,u,e=yn(t.RS),i=n.changedTouches,r=!1,o=0;o<i.length;o++)a=i[o],u=H?m():n.timeStamp,r=this.lIt(t,n.target,a.identifier,new C(a.pageX-e.I0,a.pageY-e.A0),u)||r;r&&f(n)},n.prototype.bIt=function(t){for(var n,e,i,r,o,a,u,n=this,e=yn(n.cIt.RS),i=t.changedTouches,r=!1,o=0;o<i.length;o++)a=i[o],u=H?m():t.timeStamp,r=n.iE(a.identifier,new C(a.pageX-e.I0,a.pageY-e.A0),u)||r;r&&f(t)},n.prototype.yIt=function(t){for(var n,e,i,r,o,a,n=this,e=yn(n.cIt.RS),i=t.changedTouches,r=!1,o=0;o<i.length;o++)a=i[o],r=n.vIt(a.identifier,new C(a.pageX-e.I0,a.pageY-e.A0))||r;r&&f(t)},n.prototype.wIt=function(t){for(var n,e,i,r,o,a,n=this,e=yn(n.cIt.RS),i=t.changedTouches,r=!1,o=0;o<i.length;o++)a=i[o],r=n.gIt(a.identifier,new C(a.pageX-e.I0,a.pageY-e.A0))||r;r&&f(t)},n.prototype.MIt=function(t){var n,e,n,e,n,n=this,e=n.cIt,n=n.CIt;e!==n&&(e=D(e.RS).offset(),n=D(n.RS).offset(),t.X+=e.left-n.left,t.Y+=e.top-n.top)},n.prototype.SIt=function(t,n){var e,i,r,o,a,u,s,e=this,i=e.j0t;for(e.CIt=M,e.AZ=M,o=0;o<i.length;o++)if(i[o]===t){if(a=i[o],s=u=M,a._Z&&!a._Z()){for(o=0;o<i.length;o++)if((r=i[o])!==a&&0<=r.YAt&&r.YAt<a.YAt&&(!r._Z||r._Z())){u=r;break}if(u===M)return!1}if(a.EZ&&!a.EZ()){for(o=0;o<i.length;o++)if((r=i[o])!==a&&0<=r.YAt&&r.YAt<a.YAt&&(!r.EZ||r.EZ())){s=r;break}if(s===M)return!1}u===M&&(u=a),s===M&&(s=a),e.cIt=a,e.CIt=u,e.TIt=s,e.KAt(s.jZ||M),e.JAt(u.RZ||M),e.tIt(u.LZ||M),e.$At(u.AIt||M),e.XAt(u.PZ||M),e.nIt(s.UZ||M),e.eIt(s.ZAt||M),e.iIt(s.IIt||M),e.rIt(u.oIt||M),e.aIt(u.uIt||M),u.HAt&&(e.AZ=a.HAt);break}return!0},n.prototype.lIt=function(t,n,e,i,r){var o=this;if(o.WTt[e]!==p)return!1;if(0===o.WTt.length&&!o.SIt(t,n))return!1;if(!o.CIt)return!1;if(!(o.WTt.length>=o.CIt.VAt)){if(o.AZ&&o.AZ.xIt())return!1;o.MIt(i),o.AZ&&0===o.WTt.length&&o.AZ.NIt(),o.WTt[e]={id:e,time:m(),position:i},o.WTt.length++,o.QTt.kIt(n,e,i,r),o.QTt.DIt(e,i,o.WTt.length,r),1===o.WTt.length&&o.KTt.DIt(i),1===o.WTt.length&&o.oIt&&o.oIt({JZ:i})}return!0},n.prototype.iE=function(t,n,e){var i=this;return i.WTt[t]!==p&&!(i.AZ&&i.AZ._It()||(i.MIt(n),i.WTt[t]={id:t,time:m(),position:n},i.QTt.EIt(t,n,e),0))},n.prototype.vIt=function(t,n){var e=this;return e.WTt[t]!==p&&(delete e.WTt[t],e.WTt.length--,!(e.AZ&&e.AZ.jIt()||(e.MIt(n),e.QTt.OIt(t),e.QTt.RIt(),0===e.WTt.length&&(e.KTt.OIt(n),e.KTt.RIt()),0===e.WTt.length&&e.uIt&&e.uIt({JZ:n}),e.AZ&&0===e.WTt.length&&0===e.QTt._process&&e.AZ.qAt(),0)))},n.prototype.gIt=function(t,n){return this.vIt(t,n)},n.prototype.aW=function(n,t){var e,i,r,o,a,u,s,c,f,l,h,d,v,i,m,g,r,p,b,y,w,M;function C(){D(j).bind(a,A).bind(u,I).bind(l,A).bind(h,I).bind(s,x).bind(c,x).bind(d,x).bind(v,x)}function S(){D(j).unbind(a).unbind(l).unbind(u).unbind(h).unbind(s).unbind(v).unbind(c).unbind(d)}function T(t){C(),e.fIt(n,t)}function A(t){e.hIt(t)}function I(t){e.dIt(t),0===e.WTt.length&&S()}function x(t){e.mIt(t),0===e.WTt.length&&S()}e=this,i="."+n.zAt,o=et+(r=".gcSheet"),a=it+r+i,u=rt+r+i,s="MSPointerCancel"+r+i,c="MSLostPointerCapture"+r+i,f=ot+r,l=at+r+i,h=ut+r+i,d="LostPointerCapture"+r+i,v="pointercancel"+r+i,i=st+r,m=ct+r,g=ft+r,r="touchcancel"+r,p=n.RS,b=e.j0t,0<=(y=P.Common.Uf.hD(b,n))&&t||y<0&&!t||(w=N.mt.m0(),t?w?(M=p.style,k(M.msTouchAction)||(M.msTouchAction=nt),k(M.touchAction)||(M.touchAction=nt),D(p).bind(o,T).bind(f,T)):(D(p).bind(i,function(t){e.pIt(n,t)}),D(p).bind(m,function(t){e.bIt(t)}).bind(g,function(t){e.yIt(t)}).bind(r,function(t){e.wIt(t)})):w?D(p).unbind(o).unbind(f):D(p).unbind(i).unbind(m).unbind(g).unbind(r),t?b.push(n):b.splice(y,1))},n.prototype.L0=function(){for(var t,n,e,t=this,n=t.j0t,e=n.length-1;0<=e;e--)t.aW(n[e],!1)},yt=n,t.TouchEventProvider=yt,e.prototype.kIt=function(t,n,e,i){var r,t,r=this;3===r._process&&r.BIt(!0),r.jAt=2===r._process&&1===r.oAt.LIt(),r.FIt=t,(t={}).rL=n,t.PIt=e,t.GIt=e,r.oAt.UIt(t),r.HIt=i,1<r.oAt.LIt()&&(r.zIt=!1,r.VIt=!1,1===r._process)&&r.YIt()},e.prototype.DIt=function(t,n,e,i){0===this._process&&1===e&&this.ZIt(this.oAt.WIt(0).GIt)},e.prototype.EIt=function(t,n,e){var i,r,r,o,r,a,u,s,i=this;if(0!==i.rAt&&i.oAt.QIt(t)){if(1===i._process&&1===i.oAt.LIt()){if(r=i.KIt(),!i.JIt(1)&&!i.JIt(2)&&!r)return;if(vn(n,r=i.oAt.XIt(t).GIt))return;o=_(n.X-r.X),r=_(n.Y-r.Y),i.qIt(o,r)}if(!(e-i.HIt<20)){if(i.oAt.XIt(t).$It=n,1<(a=i.oAt.LIt()))for(u=0;u<a;u++)if(!(s=i.oAt.WIt(u)).$It)return;for(i.txt(e),i.HIt=e,a=i.oAt.LIt(),u=0;u<a;u++)(s=i.oAt.WIt(u)).PIt=s.$It,s.$It=M}}},e.prototype.RIt=function(){var t=this;t.nxt&&(t.ixt(t.nxt),t.nxt=M)},e.prototype.OIt=function(t){var n=this;n.oAt.QIt(t)&&(n.oAt.rxt(t),2===n._process?0===n.oAt.LIt()&&(n.JIt(64)||n.JIt(256)||n.JIt(128)?n.oxt():n.BIt(!0)):3===n._process?n.BIt(!0):1===n._process&&n.BIt(!1))},e.prototype.txt=function(t){var n,e,i,r,o,a,u,u,r,s,c,t,s,r,n=this,u=n.axt(),e=u.uxt,i=u.sxt,u=u.u_,r=n.cxt(),a=r.L0t,o=r.fxt,r=r.hAt;n.qTt+=e,n.$Tt+=i,n.tAt*=o,n.nAt+=a,n.eAt+=r,(s={}).hAt=r,s.L0t=a,s.lxt=t-n.HIt,s.uxt=e,s.sxt=i,n.uAt.hxt(s),n.dxt=u,1!==n._process&&2!==n._process||1===n._process&&(c=n.YIt())||((t=new xt).CAt=r,t.MAt=a,t.tW=o,t.wAt=new C(e,i),s=new St(n.uAt),r=new _t(n.FIt,n.vxt(),t,!1,u,s),n.mxt(r),r.gxt&&n.BIt(!0))},e.prototype.YIt=function(){var t,n,t=this;return t._process=2,n=new jt(t.FIt,t.oAt.LIt(),t.vxt(),t.oAt.WIt(0).GIt),t.pxt(n),!!n.gxt&&(t.BIt(!0),!0)},e.prototype.qIt=function(t,n){var t=Tn(t,n);this.zIt=t.JTt,this.VIt=t.XTt},e.prototype.axt=function(){var t,n,e,i,e,r,t=0,n=0,e=this.bxt(),i=e.yxt,e=e.wxt,r=new C(i.X,i.Y);return{uxt:t=i.X-e.X,sxt:n=i.Y-e.Y,u_:r}},e.prototype.cxt=function(){var t,n,e,i,t,t=this,n=0,e=1,i=0;return t.JIt(16)&&1===t.oAt.LIt()&&t.KIt()&&(n=Cn(t.oAt.WIt(0).$It,t.oAt.WIt(0).PIt,t.fMt)),1<t.oAt.LIt()&&(n=(t=t.Mxt()).L0t,e=t.fxt,i=t.hAt),{L0t:n=n/o*180,fxt:e,hAt:i}},e.prototype.Mxt=function(){for(var t,n,e,i,r,o,a,n,u,s,c,f,l,h,d,v,m,v,g,p,b,y,v,m,w,t=this,n=t.bxt(),e=n.yxt,i=n.wxt,r=t.KIt(),o=r?t.fMt._Center:new C(0,0),a=0,n=1,u=0,s=0,c=0,f=0,l=0,h=t.oAt.LIt(),d=0;d<h;d++)m=(v=t.oAt.WIt(d)).$It,v=v.PIt,g=Mn(m,e),p=Mn(v,i),b=r?new C(v.X-o.X,v.Y-o.Y):new C(v.X-i.X,v.Y-i.Y),y=r?new C(m.X-o.X,m.Y-o.Y):new C(m.X-e.X,m.Y-e.Y),v=Mn(v,o),m=Mn(m,o),p>=t.aAt&&g>=t.aAt&&(c++,f+=g,l+=p,!r||v>=t.aAt)&&m>=t.aAt&&(a+=w=wn(b,y),s++);return 0<s&&t.JIt(16)?a/=s:a=0,0<c&&t.JIt(32)?(t.jAt||(n=f/l),u=(f-l)/c,t.Cxt=f/c):t.Cxt=0,{L0t:a,fxt:n,hAt:u}},e.prototype.JIt=function(t){return 0!=(this.rAt&t)},e.prototype.bxt=function(){for(var t,n,e,i,r,o,a,u,s,u,c,f,t=0,n=0,e=0,i=0,r=this.oAt,o=r.LIt(),a=0;a<o;a++)s=(u=r.WIt(a)).PIt,u=u.$It,t+=s.X,n+=s.Y,e+=u.X,i+=u.Y;return c=new C(t/o,n/o),{yxt:f=new C(e/o,i/o),wxt:c}},e.prototype.KIt=function(){var t=this.fMt;return t&&!a(t._Radius)},e.prototype.ZIt=function(t){var n,t,n=this,t=new Ot(n.FIt,n.rAt,M,t);return t.KZ=511,n.Sxt(t),n.Txt=t.KZ,0===t.KZ?(n.BIt(!1),!1):(n.rAt=t.KZ,n.fMt=t.DAt,n._process=1,!0)},e.prototype.BIt=function(t){var n,e,t,n=this,e=3===n._process;n._process=0,n.Axt&&(dn(n.Axt),n.Axt=M),t&&(t=new Dt(n.FIt,n.vxt(),e,In(n.dxt),new St(n.uAt)),3===n._process?n.nxt=t:n.ixt(t)),n.uAt.Ixt(),n.oAt.Ixt(),n.fMt=M,n.qTt=0,n.$Tt=0,n.tAt=1,n.nAt=0,n.eAt=0,n.zIt=!1,n.VIt=!1,n.rAt=0},e.prototype.oxt=function(){var t,n,e,e,e,t=this,n={},e=new St(t.uAt);n.xxt=t.JIt(64)?e.Nxt().X:0,n.kxt=t.JIt(64)?e.Nxt().Y:0,n.Dxt=t.JIt(256)?e.CAt():0,n._xt=t.JIt(128)?e.Ext():0,0===n.xxt&&0===n.kxt&&0===n.Dxt&&0===n._xt?t.BIt(!0):(n.jxt=new It(n.xxt,n.kxt),n.IAt=new Tt(n.Dxt),n.xAt=new At(n._xt),e=new St(M,n.xxt,n.kxt,n._xt,n.Dxt),e=new Et(t.FIt,t.vxt(),new xt,e,n.IAt,n.xAt,n.jxt),t.Oxt(e),n.jxt=e.NAt,n.IAt=e.IAt,n.xAt=e.xAt,n.jxt.pAt<=0&&n.jxt.bAt<=0&&n.jxt.Rxt(.003),n.IAt.Bxt()<=0&&n.IAt.Rxt(.002),n.xAt.Bxt()<=0&&n.xAt.Rxt(.003),e=m(),n.Lxt=e,n.Fxt=e,n.Pxt=0,n.Gxt=0,t._process=3,t.Axt=dt.setInterval(function(){try{t.Uxt(n)}catch(t){}},20))},e.prototype.Uxt=function(t){var n,e,i,r,o,a,u,e,r,o,a,i,u,s,r,o,n=this,e=m(),i=e-t.Fxt;if(0!=i){if(r=t.xxt,o=t.kxt,a=t.Dxt,u=t._xt,t.xxt=n.Hxt(i,t.jxt.pAt,t.xxt),t.kxt=n.Hxt(i,t.jxt.bAt,t.kxt),t.Dxt=n.Hxt(i,t.IAt.Bxt(),t.Dxt),t._xt=n.Hxt(i,t.xAt.Bxt(),t._xt),r=(r+t.xxt)/2,o=(o+t.kxt)/2,a=(a+t.Dxt)/2,u=(u+t._xt)/2,t.Fxt=e,e=!1,Sn(r)&&Sn(o)&&Sn(a)&&Sn(u)&&(e=!0),r=i*r,o=i*o,a=i*a,i=i*u,u=1,0<n.Cxt&&(n.Cxt+2*a<0&&(a=-n.Cxt/2+1),0!==n.Cxt)&&(u=(n.Cxt+2*a)/n.Cxt),n.eAt+=a,n.nAt+=i,n.qTt+=r,n.$Tt+=o,n.tAt*=u,n.Cxt+=a,n.dxt=new C(n.dxt.X+r,n.dxt.Y+o),t.Pxt+=r,t.Gxt+=o,e){if(r=J(t.Pxt),o=J(t.Gxt),Sn(r)&&Sn(o))return void n.BIt(!0)}else 1<=_(t.Pxt)&&(r=t.Pxt,t.Pxt-=r),1<=_(t.Gxt)&&(o=t.Gxt,t.Gxt-=o);(s=new xt).wAt=new C(r,o),s.tW=u,s.CAt=a,s.MAt=i,r=new St(M,t.xxt,t.kxt,t._xt,t.Dxt),o=new _t(n.FIt,n.vxt(),s,!0,In(n.dxt),r),n.mxt(o),(o.gxt||e)&&n.BIt(!0)}},e.prototype.Hxt=function(t,n,e){var n,n;return Sn(e)||(n=e<0?e+n*t:e-n*t)<0&&0<e||0<n&&e<0?0:n},e.prototype.vxt=function(){var t,n,t=this,n=new xt;return n.CAt=t.eAt,n.MAt=t.nAt,n.tW=t.tAt,n.wAt=new C(t.qTt,t.$Tt),n},e.prototype.zxt=function(t,n,e,i){var r,o,a,u,s,c,f,l,h,h,r=this,o=new xt,a=new xt,u=0,s=0,c=0,f=0,l=r.JIt(4)&&r.zIt,h=r.JIt(8)&&r.VIt;return!r.JIt(1)||h||t&&!r.JIt(64)||(o.wAt.X=n.wAt.X,a.wAt.X=e.wAt.X,u=i.Nxt().X),!r.JIt(2)||l||t&&!r.JIt(64)||(o.wAt.Y=n.wAt.Y,a.wAt.Y=e.wAt.Y,s=i.Nxt().Y),!r.JIt(32)||t&&!r.JIt(256)?(o.tW=n.tW,a.tW=1):(o.tW=n.tW,o.CAt=n.CAt,a.tW=e.tW,a.CAt=e.CAt,f=i.CAt()),!r.JIt(16)||t&&!r.JIt(128)||(o.MAt=n.MAt,a.MAt=e.MAt,c=i.Ext()),h=new St(M,u,s,c,f),new kt(o,a,h)},e.prototype.Sxt=function(t){this.KAt&&t&&this.KAt(t)},e.prototype.pxt=function(t){this.JAt&&t&&this.JAt(t)},e.prototype.ixt=function(t){var n,e,n=this;n.XAt&&t&&(e=n.zxt(!1,t.nW,t.nW,t.TAt),t.nW=e.nW,t.TAt=e.TAt,n.XAt(t))},e.prototype.Oxt=function(t){var n,e,n=this;n.$At&&t&&(e=n.zxt(!1,t.nW,t.SAt,t.TAt),t.nW=e.nW,t.SAt=e.SAt,t.TAt=e.TAt,n.$At(t))},e.prototype.mxt=function(t){var n,e,n=this;n.tIt&&t&&(e=n.zxt(t.AAt,t.nW,t.SAt,t.TAt),t.nW=e.nW,t.SAt=e.SAt,t.TAt=e.TAt,n.tIt(t))},wt=e,r.prototype.DIt=function(t){var n,e,n=this;n.Vxt++,1<n.Vxt||(e=m(),n.Yxt&&vn(t,n.Yxt)&&e-n.Zxt<400?n.DU++:(n.Yxt=t,n.DU=1),n.Wxt=t,n.Zxt=e)},r.prototype.RIt=function(){var t=this;t.nxt&&(t.nxt instanceof Rt?t.Qxt(t.nxt):t.nxt instanceof Bt&&t.Kxt(t.nxt),t.nxt=M)},r.prototype.OIt=function(t){var n,e,n=this;n.Vxt--,0<n.Vxt||(e=m(),vn(t,n.Wxt)?1e3<e-n.Zxt?n.nxt=new Bt(n.Wxt):1<n.DU?(n.DU=0,n.Jxt(new Lt(n.Yxt)),n.Yxt=M):n.nxt=new Rt(n.Wxt):n.Yxt=M)},r.prototype.Xxt=function(){this.Yxt=M},r.prototype.Qxt=function(t){this.nIt&&t&&this.nIt(t)},r.prototype.Jxt=function(t){this.eIt&&t&&this.eIt(t)},r.prototype.Kxt=function(t){this.iIt&&t&&this.iIt(t)},Mt=r,C=An,t.QZ=C,s.prototype.qxt=function(t){var n,e,i,r,o,a,o,n=this;if(0===n.DU)return 0;for(e=0,i=(1+n.DU)*n.DU/2,r=n.DU-1;0<=r;r--)o=0,a=n.$xt(r),0===t?o=a.uxt:1===t?o=a.sxt:2===t?o=a.hAt:3===t&&(o=a.L0t),o=n.tNt(o,a.lxt),e+=o*=r+1;return e/i},s.prototype.tNt=function(t,n){return t/n},s.prototype.$xt=function(t){return this.cAt[this.nNt(t)]},s.prototype.eNt=function(){return this.cAt[this.DU-1]},s.prototype.hxt=function(t){var n,e,i,n=this;for(10===n.DU&&n.iNt(),n.DU++,n.cAt[n.nNt(n.DU-1)]=t,e=20*n.sAt,i=0;i<n.DU;i++)t.lxt-n.cAt[i].lxt>e&&(n.iNt(),i--)},s.prototype.iNt=function(){var t=this;t.ak++,t.ak===t.sAt&&(t.ak=0),t.DU--},s.prototype.Ixt=function(){this.DU=0},s.prototype.nNt=function(t){return(this.ak+t)%this.sAt},Ct=s,xn.prototype.Nxt=function(){var t=this;return t.fAt||(t.fAt=new C(t.cAt.qxt(0),t.cAt.qxt(1))),t.fAt},xn.prototype.Ext=function(){var t=this;return k(t.lAt)&&(t.lAt=t.cAt.qxt(3)),t.lAt},xn.prototype.CAt=function(){var t=this;return k(t.hAt)&&(t.hAt=t.cAt.qxt(2)),t.hAt},St=xn,Nn.prototype.Bxt=function(){var t=this,n=t._DesiredExpansion,e=t._DesiredDeceleration,i=t.dAt;return a(n)||0===n?a(e)?t.vAt:e:.5*i*i/n},Nn.prototype.Rxt=function(t){this.vAt=t},Tt=Nn,kn.prototype.Bxt=function(){var t=this,n=t._DesiredRotation,e=t._DesiredDeceleration,i=t.dAt;return a(n)||0===n?a(e)?t.vAt:e:.5*i*i/n},kn.prototype.Rxt=function(t){this.vAt=t},At=kn,Dn.prototype.rNt=function(){var t=this,n=t._DesiredDisplacement,e=t.yAt,i=t.mAt,r=t.gAt,o=t.Bxt();a(n)||0===n?a(o)||0===o?(t.pAt=0,t.bAt=0):(t.pAt=o*_(i)/e,t.bAt=o*_(r)/e):(t.pAt=.5*e*_(i)/n,t.bAt=.5*e*_(r)/n)},Dn.prototype.Bxt=function(){var t=this,n=t._DesiredDeceleration;return a(n)&&a(t._DesiredDisplacement)?t.vAt:n},Dn.prototype.Rxt=function(t){this.vAt=t,this.rNt()},It=Dn,xt=_n,En.prototype.QIt=function(t){for(var n,e,i,n=this.wY,e=0;e<n.length;e++)if((i=n[e]).rL===t)return!0;return!1},En.prototype.UIt=function(t){this.wY.push(t)},En.prototype.rxt=function(t){for(var n,e,n=this.wY,e=0;e<n.length;e++)if(n[e].rL===t){n.splice(e,1);break}},En.prototype.LIt=function(){return this.wY.length},En.prototype.WIt=function(t){return this.wY[t]},En.prototype.XIt=function(t){for(var n,e,i,n=this.wY,e=0;e<n.length;e++)if((i=n[e]).rL===t)return i;return M},En.prototype.Ixt=function(){var t=this.wY;t.splice(0,t.length)},Nt=En,kt=jn,Dt=On,t.ManipulationCompletedEventArgs=Dt,_t=Rn,t.ManipulationDeltaEventArgs=_t,Et=Bn,jt=Ln,t.ManipulationStartedEventArgs=jt,Ot=Fn,t.ManipulationStartingEventArgs=Ot,Rt=Pn,Bt=Gn,Lt=Un,zn.prototype.oNt=function(t,n){var e=this.fg;return e?t===N.Bf.Xl(e)&&n===N.Bf.ql(e)||N.Bf.$l(e,t,n):(e=c("canvas"),N.Bf.Wl(e,M,this.Mf),N.Bf.$l(e,t,n)),e},zn.prototype.aNt=function(t,n,e,i){var r,o,a,o,a,u,s,r=this,o=N.Bf.Xl(t),a=N.Bf.ql(t),o=r.oNt(o,a),a=o.getContext("2d"),u=N.Bf.Kl(o),s=N.Bf.Jl(o);N.Lf.Vl(a,1,1),a.drawImage(t,0,0,B(o),R(o),0,0,B(o),R(o)),N.Lf.Vl(a,u,s),r.fg=o,r.uNt=n,r.sNt=e,r.cNt=i},zn.prototype.fNt=function(t,n,e){var i,r,o,e,a,r,u,s,c,f,a,o,l,h,d,v,m,g,p,b,n,y,w,t,i,e,a,i=this,r=i.Mf,a=N.Bf.Xl(t),o=N.Bf.ql(t),l=mn(r),h=gn(r),d=0<l?1:0,v=0<h?1:0,m=i.sNt,g=qn(r),p=i.uNt,b=r.Fi(),n=n/i.cNt,y=t.getContext("2d"),w=N.Bf.Kl(t),t=N.Bf.Jl(t),i=i.fg;y.save(),y.fillStyle=e,y.fillRect(0,0,a,o),e=r.rowOutlines,a=r.columnOutlines,e&&e._e(r,y,M,!0),a&&a._e(r,y,M,!1),o=m.x+B(m),e=m.y+R(m),a=p.Hy-o-d,r=p.Ay-e-v,u=g.x+B(g),s=g.y+R(g),c=a*n,f=r*n,o*=w,e*=t,a*=w,r*=t,u*=w,s*=t,c*=w,f*=t,N.Lf.Vl(y,1,1),y.drawImage(i,o,e,a,r,u,s,c,f),0<l&&(o=p.Hy-d,e=m.y+R(m),a=p.zy+d,r=p.Ay-e-v,u=b.Hy-d,s=g.y+R(g),c=b.zy+d,f=r*n,y.drawImage(i,o*=w,e*=t,a*=w,r*=t,u*=w,s*=t,c*=w,f*=t)),0<h&&(o=m.x+B(m),e=p.Ay-v,a=p.Hy-o-d,r=p.Iy+v,u=g.x+B(g),s=b.Ay-v,c=a*n,f=b.Iy+v,y.drawImage(i,o*=w,e*=t,a*=w,r*=t,u*=w,s*=t,c*=w,f*=t)),0<l&&0<h&&(o=p.Hy-d,e=p.Ay-v,a=p.zy+d,r=p.Iy+v,u=b.Hy-d,s=b.Ay-v,c=b.zy+d,f=b.Iy+v,y.drawImage(i,o*=w,e*=t,a*=w,r*=t,u*=w,s*=t,c*=w,f*=t)),N.Lf.Vl(y,w,t),y.restore()},zn.prototype.$Z=function(){var t,n,e,i,t=this,n=t.Mf,e=n.zoom(),i=n.Dn._7();i&&t.aNt(i.canvas,n.Fi(),qn(n),e)},zn.prototype.iW=function(t){var n,e,t,i,r,o,o,r,n=this,e=n.Mf;e.endEdit()&&(t=Hn(t,n.cNt),i=e.zoom(),r=e.name(),i!==t)&&(e.ki(N.Events.ViewZooming,o={sheet:e,sheetName:r,oldZoomFactor:i,newZoomFactor:t,cancel:!1}),!0!==o.cancel)&&(e.g8(t=o.newZoomFactor),e.ki(N.Events.UserZooming,{sheet:e,sheetName:r,oldZoomFactor:i,newZoomFactor:t}),e.ki(N.Events.ViewZoomed,{sheet:e,sheetName:r,oldZoomFactor:i,newZoomFactor:t}),e.invalidateLayout(),(r=(o=e.Dn).J())&&n.fNt(r.canvas,t,o.R7(!1)),e.oht&&e.oht(M,t),e.CW)&&e.CW(M)},zn.prototype.rW=function(t){var n,e,i,t,n,r,n=this,e=n.Mf,i=e.name(),t=Hn(t,n.cNt),n=e.zoom();if(t!==n){if(e.ki(N.Events.ViewZooming,r={sheet:e,sheetName:i,oldZoomFactor:n,newZoomFactor:t,cancel:!1}),!0===r.cancel)return;e.g8(t=r.newZoomFactor),e.ki(N.Events.UserZooming,{sheet:e,sheetName:i,oldZoomFactor:n,newZoomFactor:t}),e.ki(N.Events.ViewZoomed,{sheet:e,sheetName:i,oldZoomFactor:n,newZoomFactor:t})}e.Zw=!0,e.Ww=!0,e.zw()},Ft=zn,t.ZZ=Ft,Pt=200,Gt=20,b.prototype.lNt=function(t){var n;this.Mf.my=t},b.prototype.hNt=function(t){var n;this.Mf.ly=t},b.prototype.dNt=function(){var t;this.Mf.invalidateLayout()},b.prototype.yy=function(t,n,e,i,r){var o,a,u,s,c,f,l,h,f,d,v,m,g,p,b,y,d,w,M,C,u,S,T,A,I,I,A,T,I,x,N,l,o=this,a=o.Mf,u=a.options,s,c,f=Vn(a,t,a.Tb,a.ly);if(f&&(l=f.Ky,h=f.Xy,t=f._At,a.Tb=l,!(0<a.My)))if(f=a.ot(),v=(d=a.Fi()).Cy,m=a.Sy(d),g=d.Iy,p=d.Ay,b=d.Ty,y=(f||d).x,d=B(d),u=u.sheetAreaOffset,S=a.Ny,d+=u.left,t<0)o.vNt=0,A=T=void(o.mNt=0),(T=(I=a.dw(1))&&0<I.length?I.findRow(l):T)&&(A=I[I.length-1]).row>=l&&(w=2+u.top,M=v+_(t),0<=(C=E(v+m,A.y+R(A))-M))&&(C-=w,o.hNt(h-R(T)),e.x=y,e.y=M,e.width=d,e.height=C,e.tx=y,e.ty=v,I=S?m:m+g+b,i.x=y,i.y=v+C,i.width=d,i.height=I-C);else if(0<t){if(A=a.vw(-1),I=T=void 0,(x=a.parent&&a.parent.options.scrollByPixel)&&0<h&&(t-=h,h=0),l===A&&0<h){if(0<o.vNt&&0<o.mNt){if(h=I=Zn(T=o.vNt+t,200),(t=I-o.mNt)<=0)return n;if(n&&20<=I)return!0}else{if(200<=h&&(t-=h-199,h=199,t<=0))return n;if(T=Wn(h,200),I=h,n&&20<=I)return!0}o.vNt=T,o.mNt=I}else o.vNt=0,o.mNt=0;t<(N=S?m:m+g)&&(w=2+u.top,M=v,C=m-t,0<gn(a)&&(C-=O),o.hNt(h),!S&&0<b&&(l=E(f.height-g-O,p-O+t),r.x=y,r.y=p-O,r.width=d,r.height=g+O,r.tx=y,r.ty=l),e.x=y,e.y=M,e.width=d,e.height=C+(S?0:E(t,b)-O),e.tx=y,e.ty=M+t,i.x=y,i.y=M,i.width=d,i.height=t+w)}return!1},b.prototype.wy=function(t,n,e,i,r){var o,a,u,s,c,f,l,c,h,d,v,m,g,p,b,h,y,w,M,C,S,T,A,I,x,N,N,x,k,D,I,N,o=this,a=o.Mf,u,s,c=Yn(a,t,a.Ab,a.my);if(c&&(f=c.iw,l=c.Xy,t=c.EAt,a.Ab=f,!(0<a.My)))if(c=a.ot(),d=(h=a.Fi()).Py,v=a.Gy(h),m=h.zy,g=h.Hy,p=h.Uy,b=(c||h).y,h=R(h),T=a.options.sheetAreaOffset,A=a.Vy,h+=T.top,t<0)o.gNt=0,x=I=void(o.pNt=0),(I=(N=a.yw(1))&&0<N.length?N.findCol(f):I)&&(x=N[N.length-1]).col>=f&&(y=2+T.left,w=d+_(t),0<=(M=E(d+v,x.x+B(x))-w))&&(M-=y,o.lNt(l-B(I)),e.x=w,e.y=b,e.width=M,e.height=h,e.tx=d,e.ty=b,N=A?v:v+m+p,i.x=d+M,i.y=b,i.width=N-M,i.height=h);else if(0<t){if(x=a.ww(-1),(k=a.parent&&a.parent.options.scrollByPixel)&&0<l&&(t-=l,l=0),f===x&&0<l){if(0<o.gNt&&0<o.pNt){if(l=S=Zn(C=o.gNt+t,200),(t=S-o.pNt)<=0)return n;if(n&&20<=S)return!0}else{if(200<=l&&(t-=l-199,l=199,t<=0))return n;if(C=Wn(l,200),S=l,n&&20<=S)return!0}o.gNt=C,o.pNt=S}else o.gNt=0,o.pNt=0;t<(D=A?v:v+m)&&(y=2+T.left,w=d,M=v-t,0<mn(a)&&(M-=O),o.lNt(l),I=0,!A&&0<p&&(N=E(c.width-(I=m)-O,g-O+t),r.x=g-O,r.y=b,r.width=I+O,r.height=h,r.tx=N,r.ty=b),e.x=w,e.y=b,e.width=M+(A?0:E(t,p)-O),e.height=h,e.tx=w+t,e.ty=b,i.x=w,i.y=b,i.width=t+y,i.height=h)}return!1},b.prototype.bNt=function(t,n,e,i){var r,o,a,u,s,c,n,f,l,h,d,e,l,v,m,g,p,b,m,g,l,y,w,M,C,S,n,y,w,M,C,S,t,i,v,n,y,w,M,C,S,r=this,o=r.Mf,a=!0,u=!0,s=o.Dn,c=s.J(),d=0!=(2&e),e=0!=(1&e);if(e||d)return l={},v={},m=o.ot(),g=o.Fi(),p=(m||g).y,b=R(g),m=(m||g).x,g=B(g),d&&(a=r.yy(n,i,n={},f={},l),y=l.y,w=B(l),M=R(l),C=l.tx,S=l.ty,k(l=l.x)||s.Ey(l,y,w,M,C,S),s.Ey(n.x,n.y,B(n),R(n),n.tx,n.ty)),e&&(u=r.wy(t,i,l={},h={},v),y=v.y,w=B(v),M=R(v),C=v.tx,S=v.ty,k(n=v.x)||s.Ey(n,y,w,M,C,S),s.Ey(l.x,l.y,B(l),R(l),l.tx,l.ty),d||(f=h)),(t=o.parent)&&!t.options.scrollbarShowMax&&(e&&(o.Zw=!0),d)&&(o.Ww=!0),r.dNt(),i=o.rowOutlines&&!o.rowOutlines.Oy()?1:0,v=o.columnOutlines&&!o.columnOutlines.Oy()?1:0,e&&d?s.D1(c,new N.Rect(f.x,f.y,B(f),R(f)+i),new N.Rect(h.x,h.y,B(h)+v,R(h))):s.D1(c,new N.Rect(f.x,f.y,B(f)+v,R(f)+i)),n=new N.Rect(m,p,g,b),(y=o.getSelections())&&0<y.length&&(w=o.getRangeRect(1,1,y[0]),M=Z(n.x+n.width,w.x+w.width),C=Z(n.y+n.height,w.y+w.height),n.x=E(n.x,w.x),n.y=E(n.y,w.y),n.width=M-n.x+1,n.height=C-n.y+1),s.O1(n),s.jy(c,n),te(o,!0),Kn(o,!0),r.yNt(e,d),$n(o,!0),S=o.options.sheetAreaOffset,o.options.rowHeaderVisible||s.q7(c,new N.Rect(m,p,2,b+S.top)),o.options.colHeaderVisible||s.q7(c,new N.Rect(m,p,g+S.left,2)),a&&u},b.prototype.yNt=function(t,n){var e=this.Mf;n&&e.tw(),t&&e.ow(),e.rt.By()},b.prototype.wNt=function(r,o,a){function u(t,n,e,i){return W(.75,t/=e)*i*(n?1:-1)}function t(t,n,e){return t=_(t),q(t/=e)/q(.75)*n}var s=this,c=s.Mf,n=200,e=10,i=20,f=100,l=t(r,10,200),h=t(o,10,200),d=r,v=o,m=0,g=0,p=!1,b=!1;s.H6=dt.setInterval(function(){var t,t,n,e,i;p&&b?(c.Jt.Rl(),(t=c.parent)&&!t.options.scrollbarShowMax&&(c.Zw=!0,c.Ww=!0),c.Jt.Bl(),c.ly=0,c.my=0,c.zw(),c.ow(),c.tw(),dn(s.H6),s.H6=M):(h+=20,100<(l+=20)&&100<h?(s.bNt(r-m,o-g,ne(p,b),a),b=p=!0):(100<l&&!p&&(s.bNt(r-m,0,1,a),p=!0),100<h&&!b&&(s.bNt(0,o-g,2,a),b=!0),t=u(l,0<r,10,200),n=u(h,0<o,10,200),e=$(d-t),i=$(v-n),s.bNt(e,i,ne(p,b),a),d=t,v=n,m+=e,g+=i))},20)},b.prototype.Ok=function(t){var n=this,e=n.Mf,i=e.Jt;n.H6&&(i.Bl(),dn(n.H6),n.H6=M),n.gNt=0,n.pNt=0,n.vNt=0,n.mNt=0,n.MNt=e.Tb,n.CNt=e.Ab,t&&i.jl()},b.prototype.a9=function(t,n){var e,i,r,o,a,u,r,s,t,c,e,i,r=this.Mf.parent,o=r.options.scrollbarAppearance===N.ScrollbarAppearance.mobile,a=r.Xb,u=r.zb,r=r.ib,s=lt(t.X+""),t=lt(t.Y+""),c=ee(s,t);return o&&(0!==t&&(a.qy(N.ScrollbarState.show),r.$y(!0)),0!==s)&&(u.qy(N.ScrollbarState.show),r.$y(!1)),this.bNt(s,t,c,n)},b.prototype.SNt=function(t){var n,e,i,r,o,a,u,s,c,s,f,l,h,d,h,v,m,g,m,p,n=this,e=n.Mf,i=n.MNt,r=e.Tb,o=n.CNt,a=e.Ab,u;e.parent&&e.parent.options.scrollByPixel?(e.Jt.Bl(),e.zw(),n.TNt()):(c=(s=e.Fi()).Py,s=s.Cy,f=e.yw(1),h=e.Mw(),d=1,f&&0<f.length&&(l=f.findCol(a),a<h&&l&&l.x+B(l)-c<B(l)/2?a++:d=-1),h=e.dw(1),m=e.mw(),g=1,h&&0<h.length&&(v=h.findRow(r),r<m&&v&&v.y+R(v)-s<R(v)/2?r++:g=-1),p=m=0,f&&0<f.length&&(m=c-(l=f.findCol(a)).x),h&&0<h.length&&(p=s-(v=h.findRow(r)).y),r!==i&&e.$A(r,0,i),a!==o&&e.o9(a,0,o),n.wNt(m*=d,p*=g,t))},b.prototype.TNt=function(){var t,n,e,i,t,r,t=this,n=t.Mf,e=t.MNt,i=n.Tb,t=t.CNt,r=n.Ab;e!==i&&n.ki(N.Events.TopRowChanged,{sheet:n,sheetName:n.name(),oldTopRow:e,newTopRow:i}),t!==r&&n.ki(N.Events.LeftColumnChanged,{sheet:n,sheetName:n.name(),oldLeftCol:t,newLeftCol:r})},Ut=b,S.prototype.OZ=function(t){var n,e,i,r,o,a,u,s,i,c,f,l,h,n,c,d,v,n=this,e=n.Mf,i=e.Fi(),r=i.Py,o=i.Cy,a=i.J7,u=i.X7,s=i.Hy,i=i.Ay,c=t.JZ,f=e.Ny,l=e.Vy,h=0,n=n.ANt(c.X,c.Y),c=n.dragInfo,d=n.x,v=n.y;n&&(n.resizeInfo||c&&"corner"===c.side||n.selectionHitInfo)?h|=3:(o<=v&&(f&&v<i||!f&&v<u)&&(h|=2),r<=d&&(l&&d<s||!l&&d<a)&&(h|=1),h|=96,e.parent&&(h|=12)),t.KZ=h},S.prototype.BZ=function(t){var n,e,e,i,r,o,a,e,u,s,u,c,s,f,n=this,e={e:t,r:M};S.et(n,"preProcessManipulationStarted",e),e.r||(e=t.JZ,r=(i=n.Mf).parent,o=i.rt,a=i.Dn,u=(e=n.ANt(e.X,e.Y)).dragInfo,s=e.selectionHitInfo,(i.sw=e).resizeInfo?i.endEdit()&&o.gk(e):u&&"corner"===u.side?o.wk&&o.wk(e):s?i.endEdit()&&(u=s.isHeader,c=s.isFirstIndicator,s=s.type,u&&o.A9(e,!0),f=e.hitTestType,e.hitTestType=s,o.F9(e),e.hitTestType=f,se(i,u,c,s),i.INt=!1,a.PD()):(i.pW&&(i.pW().VW=!1),i.INt=!1,a.PD(),1<t.kAt&&r&&r.options.allowUserZoom?(n.jAt=!1,n.YZ.$Z()):(n.jAt=!0,n.OAt.Ok(1===t.kAt))))},S.prototype.FZ=function(t){var n,e,e,i,r,i,o,e,a,u,i,a,n=this,e={e:t,r:M};S.et(n,"preProcessManipulationDelta",e),e.r||(e=t.JZ,r=(i=n.Mf).rt,i=i.sw,o=e.X,e=e.Y,i&&(a=i.dragInfo,u=i.selectionHitInfo,i.resizeInfo?(r.fk={e:t,x:o,y:e},r.y9()):a&&"corner"===a.side?(r.fk={e:t,x:o,y:e},r.Zk&&r.Zk()):u||r.ob?u&&r.Rk&&r.rb&&!0!==r.FI&&(i=u.type,r.fk={e:t,x:o,y:e},3===i?r.Y9():2===i?r.Z9():1===i&&r.W9()):n.jAt?t.gxt=n.OAt.a9(t.SAt.wAt,t.AAt):(a=t.nW.tW,n.YZ.iW(a))))},S.prototype.GZ=function(t){var n,e,e,i,r,o,r,n=this,e={e:t,r:M};S.et(n,"preProcessManipulationCompleted",e),e.r||(i=(e=n.Mf).rt,e.INt=!0,o=(r=e.sw).selectionHitInfo,r.resizeInfo?i.C9():r.dragInfo&&i.Yk?(i.DD&&i.DD(),e.parent.touchToolStrip.xNt()):o||i.ob?(i.X9(),o&&ce(e,o.isHeader,o.isFirstIndicator,o.type),e.Dn.E1()):(e.pW&&(e.pW().VW=!0),n.jAt?n.OAt.SNt(t.AAt):(r=t.nW.tW,n.YZ.rW(r))))},S.prototype.HZ=function(t){var e,n,n,i,r,t,o,o,a,n,u,s,c,f,l,h,d,h,l,d,f,h,n,n,n,v,v,v,v,m,g,v,n,e=this,n={e:t,r:M};if(S.et(e,"preProcessTapped",n),n.r)e.Mf.repaint();else if(n=t.JZ,i=e.Mf,r=i.parent,t=!1,i.Nk=p,e.NNt(),i.Olt&&i.Olt(),(o=i.Ut.pI)&&o.CZ(),o=i.rt,n=(a=e.ANt(n.X,n.Y,!0)).filterButtonHitInfo,u=a.hitTestType,s=a.row,c=a.col,f=a.outlineHitInfo)i.isEditing()||(l=f.what,h=i.rowOutlines,d=i.columnOutlines,"rg"===l||"rgh"===l?h&&h.rpt(i,f):"cg"!==l&&"cgh"!==l||d&&d.rpt(i,f));else if(i.sw=a,n)i.endEdit()&&(h=n.rowFilter)&&h.openFilterDialog(n);else if(!a.resizeInfo&&i.JA(a.rowViewportIndex<0?-1:s,a.colViewportIndex<0?-1:c)){if(i.kNt&&!o.Yk&&r.touchToolStrip.xNt(),l=i.getActiveRowIndex(),d=i.getActiveColumnIndex(),f=a.cellTypeHitInfo){if(h=i.getCellType(f.row,f.col,u),f.sheet||(f.sheet=i),e.xk(h,f))if(n=f.sheetArea,!k(n)&&3!==n||s===l&&c===d)i.Dn.PD();else{if(i.suspendPaint(),!i.endEdit())return;if(n={sheet:i,sheetName:i.name(),row:l,col:d,cancel:!1},i.ki(N.Events.LeaveCell,n),!0===n.cancel)return;n=i.Ut.getSelections(),v=i.Ut.getSpan(s,c),v=[(0,N.Ec)(v.row,v.col,v.rowCount,v.colCount)],i.EA(n,v),i.ki(N.Events.FloatingElementSelected,{type:"worksheet"}),v=f.isReservedLocation&&f.isFocusAware,i.t4(s,c,p,p,v?0:1),v={sheet:i,sheetName:i.name(),row:s,col:c},i.ki(N.Events.EnterCell,v),i.ki(N.Events.FormulaTextboxEnterCell,v),i.jA(n),i.Nk=!0,o.PA&&o.PA(s,c),i.resumePaint(),t=!0}h.processCellAndPaddingMouseDown(f),h.Ve(f)}if(f&&f.isReservedLocation)return!0;f&&(f.cellButtonHitInfo||f.outlineColumnHitInfo)&&(t=!0),i.ki(N.Events.CellClick,{sheet:i,sheetName:i.name(),sheetArea:u,row:a.row,col:a.col});try{if(o.Dk=a,m=i.isEditing(),g=i.endEdit(),i.Oi&&Y&&m&&g&&(o.shift=!1),m&&l===i.getActiveRowIndex()&&d===i.getActiveColumnIndex()&&!g)return}finally{o.Dk=M}k(s)||k(c)||(3===u&&o.PA&&o.PA(s,c),ae(i,s,c,u)&&!t?e.DNt=dt.setTimeout(function(){var t,n,t={x:a.x,y:a.y,handled:!1},n=r.touchToolStrip;i.ki(N.Events.TouchToolStripOpening,t),t.handled||n.open(a.x,a.y-100),e.NNt()},420):(i.ki(N.Events.FloatingElementSelected,{type:"worksheet"}),v=i.Ut.getSelections(),o.A9(a),n=i.Ut.getSelections(),i.EA(v,n),o.X9()))}},S.prototype.xk=function(t,n){return!(t&&t.activeOnClick&&!t.activeOnClick()&&n.isReservedLocation)},S.prototype._Nt=function(t,n){var e,i,e,t,n,r,o,e=this,i=e.Mf,e=e.ANt(t,n,!0);e&&0<=e.row&&0<=e.col&&0<=e.rowViewportIndex&&0<=e.colViewportIndex&&!e.resizeInfo&&i.JA(e.row,e.col)&&((t=i.isCtrlPressed(e.hitTestType))||i.IA(),n=i.C0(e.row),r=i.S0(e.col),o=!0,i.ui===e.row&&i.ci===e.col||(o=!1),i.O6(e.row,e.col,n,r,o),t?i.zw():i.n4(e.row,e.col,1,1),i.rt.S_(!1,!0),i.f6(i.Dg(),e.row,e.col))},S.prototype.WAt=function(t){var n,e,e,t,i,r,n=this,e={e:t,r:M};S.et(n,"preProcessDoubleTapped",e),!e.r&&(e=n.Mf,t=t.JZ,n.NNt(),i=e.sw)&&(r=!1,3===i.hitTestType?n._Nt(t.X,t.Y):r=e.rt.j_(i),r||e.ki(N.Events.CellDoubleClick,{sheet:e,sheetName:e.name(),sheetArea:i.hitTestType,row:i.row,col:i.col}))},S.prototype.ENt=function(t){var n,e,t,i,i,n=this,e=n.Mf,t=t.JZ,i=n.ANt(t.X,t.Y);e.isEditing()?i.row===e.ui&&i.col===e.ci||e.rt.C_(i):(n._target=i,(i=n.ANt(t.X,t.Y,!0))&&i.cellTypeHitInfo&&i.cellTypeHitInfo.isEditing||e.rt.C_(i))},S.prototype.jNt=function(t){var n,e,n,i,r,r,n=this,e=n.Mf;!e.isEditing()&&(i=!0,i=(!(n=n._target)||!((r=n.cellTypeHitInfo)&&r.isReservedLocation||(r=e.getCellType(n.row,n.col))&&r.isEditing()))&&i)&&e.rt.S_(!0)},S.prototype.ANt=function(t,n,e){var i,r,o,a,u,s,a,u,s,s,a,u,c,f,u,u,u,i,r=this.Mf;return r.Fi(),o={x:t,y:n,rowViewportIndex:M,colViewportIndex:M,row:-1,col:-1,resizeInfo:M,hitTestType:M,outlineHitInfo:M,filterButtonHitInfo:M,dragInfo:M,cellTypeHitInfo:M,selectionHitInfo:M},a=r.rowOutlines,u=r.columnOutlines,(s=!(s=a?a.hitTest(r,t,n):s)&&u?u.hitTest(r,t,n):s)?o.outlineHitInfo=s:(u=a=void 0,a=r.FL(n),u=r.PL(t),o.rowViewportIndex=a,o.colViewportIndex=u,o.row=r.GL(n,a),o.col=r.UL(t,u,n,a,o.row),0<=a&&a<=2&&0<=u&&(s=r.O_(a,u,p,o.row,o.col))&&(o.row=s.row,o.col=s.col),o.hitTestType=r.C6(a,u),f=c=u=a=s=void 0,s=ie(r,o,t,n,10),c=(c=(u=r.IB)&&u.hitTest(o,t,n))||(u=(u=(u=r.tables)&&u.find(o.row,o.col))&&u.IB)&&u.hitTest(o,t,n),r.kNt?(a=oe(r,o,t,n),o.dragInfo=a):s?o.resizeInfo=s:c?o.filterButtonHitInfo=c:e?o.cellTypeHitInfo=r.JL(o,t,n):(f=re(r,o,t,n),o.selectionHitInfo=f)),o},S.prototype.NNt=function(){var t=this,n=t.DNt;n&&(clearTimeout(n),t.DNt=M)},Ht=S,t.TouchEventHandler=Ht,(0,N.$e)(Ht),fe.prototype.oW=function(){var t,n,t,t=this,n=t.DZ,t=t.xZ;t.jZ=function(t){return n.OZ(t)},t.RZ=function(t){return n.BZ(t)},t.LZ=function(t){return n.FZ(t)},t.PZ=function(t){return n.GZ(t)},t.UZ=function(t){return n.HZ(t)},t.ZAt=function(t){return n.WAt(t)},t.oIt=function(t){return n.ENt(t)},t.uIt=function(t){return n.jNt(t)}},fe.prototype.uW=function(){var t=this,n=t.xZ;n&&(t.kZ.aW(n,!1),n.jZ=M,n.RZ=M,n.LZ=M,n.AIt=M,n.PZ=M,n.UZ=M,n.ZAt=M,n.IIt=M,n.oIt=M,n.uIt=M,t.xZ=M)},fe.prototype.sW=function(t){return this.AZ.sW()},fe.prototype.cW=function(t){return this.AZ.cW()},fe.prototype.fW=function(t){return this.AZ.fW()},zt=fe,Vt="gc-toolstrip-button",Yt="gc-toolstrip-text",Zt="gc-toolstrip-image",Wt="gc-toolstrip-item",Qt="gc-touch-sperate-line",Jt="height",Kt="width",d="px",Xt="button",F(T,hn=L),T.prototype.open=function(t,n){var e,i,r,o,a,u,e=this,i=g(e.Vv);if(i&&(N.hi.F1(M,!0),e.LAt.css({left:t,top:n}),e.$c(),e.Jet=!0,e.if(),!U(e.f$)))for(o in r=e.f$)r.hasOwnProperty(o)&&((u=!(a=r[o]).UAt||a.UAt.call(e))?D("#"+o).show():D("#"+o).hide())},T.prototype.add=function(t){var n,e,i,i;t&&(e=(n=this).f$,t instanceof tn?(i=t.name())&&(e[i]=t,n.ONt(t.RNt(Qt,n.BAt+d))):t instanceof $t&&(i=t.name(),n.getItem(i)||(e[i]=t,n.ONt(t.RNt(Zt,n.RAt+d,Yt,Vt)))))},T.prototype.getItem=function(t){return this.f$[t]},T.prototype.getItems=function(){var t,n,e,i,t,n=[],e=this.f$;if(U(e))return M;for(i in e)e.hasOwnProperty(i)&&n.push(e[i]);return n},T.prototype.remove=function(t){var n,e,n=this;return n.getItem(t)?(D("#"+t).parent().remove(),e=n.f$[t],delete n.f$[t],e):M},T.prototype.clear=function(){var t=this;t.LAt&&(t.LAt.find("td."+Wt).remove(),t.f$={})},T.prototype.close=function(){var t,t,n,t=this;vt.cf(),t.LAt&&t.LAt.hide(),t.Jet=!1,t.uf(),(t=g(t.Vv))&&(t.Zg(),0<(n=y(t)).length)&&!t.kNt&&-1===n[0].row&&-1===n[0].col&&t.IA()},T.prototype.imageAreaHeight=function(t){var n=this;return 0===arguments.length?n.RAt:(0<t&&(n.RAt=t,n.LAt.find("span."+Zt).css(Jt,t+d)),n)},T.prototype.itemHeight=function(t){var n=this,e=n.LAt.find("button."+Vt);return 0===arguments.length?ht(e.css(Jt)):(0<t&&e.css(Jt,t+d),n)},T.prototype.itemWidth=function(t){var n,e,i,r,n=this,e=n.LAt.find("button."+Vt);return 0===arguments.length?ht(e.css(Kt)):(0<t&&(t<(r=ht(e.css(i="min-width")))&&e.css(i,t+d),e.css(Kt,t+d)),n)},T.prototype.separatorHeight=function(t){var n=this;return 0===arguments.length?n.BAt:(0<t&&(n.BAt=t,n.LAt.find("div."+Qt).css(Jt,t+d)),n)},T.prototype.FAt=function(){var t,n,t,t="table",n=this,t=D(c(t)).css({padding:0,display:t}).attr({cellspacing:0,cellpadding:0});n.BNt=D(c("tr")).appendTo(t),t.appendTo(n.LAt)},T.prototype.L0=function(){var t=this,n=t.LAt;n&&(t.Jet&&(vt.cf(),t.uf()),n.unbind("click"),n.remove(),t.LAt=M)},T.prototype.aY=function(){var i=this;i.LAt.bind("click",function(t){var t,n,e,t,t,t=t.target,n;t.tagName.toLowerCase()===Xt?e=t.id:(t=t.parentElement)&&t.tagName.toLowerCase()===Xt&&(e=t.id),t=i.f$[e],e&&t&&t.tT.call(i)})},T.prototype.ONt=function(t){this.LAt&&t&&D(c("td")).append(t).appendTo(this.BNt).addClass(Wt)},T.prototype.PAt=function(){var t,t,n,e,i,r,t;function o(t){for(var n,e,n=0,e=t+n;j.getElementById(e);)e=t+ ++n;return e}e=(t={0:v+(t="gAAAAYCAYAAADgdz34AAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAZdEVYdFNvZnR3YXJlAEFkb2JlIEltYWdlUmVhZHlxyWU8AAA")+"A8ElEQVRIS92VwQ3CMAxFe+qZERiHY8dgDI4cYYNOhDhwY4ayQviW4q/Eddu0KRe+9CQ72P8rEpAmhPBT3ENLd76EiPv5HO5hSmK+KYTFsz+04A4G9NZ0hAizn7jTos2MFRYYugFZQlscoFzRZsYKCwwNulAqnZddtJmxwiIZ3oT6WFh4S2tQHwsLb2kN6mNh4S2tQX0sLLwly4IyY4WFZ2gReV/ZhBOQH2ddgKcYwBAc7R/weL0ZgqO6gGPXE1E0JlBdwJx2CUhvkCL63xvw33QKUc0N+B5MIaq5gb5o8kotBszJDShFlkvQ+ZHBvoTmC+fiVfoq/m86"+mt,1:v+t+"BkklEQVRIS7WTUXECQRBEcYCFOIiESAAH/OYPCcQBEogDJCABCUhAwqXf1QzVM0cojko+Xt3ObG/33t7eYhiGf6UU68+vneD5Mu4HpZDgKja+YCYH94NSSHAUg3glZC9k8zgAYwLmhuS6o/tBKUJ8CTGsoveIsin3g1LEAkxzAd/kXbihwxwatGys+EEpEAT5LR6FuDmMb+t+UAoEwVL44h7CvB8lGxrn3A9KkaLAj8pDMD9HL/v0ZgfAQfSAk/WgXAT3g1K4MPCj2AoPhNvRJO4HpejigF1jxtjNy9Ek7gel6GIjfzoP+Ihewf2gFPcWNNL817/c/aAUKXpbfy/FXlzFIM6gOYy3Gp+iz/xBPHeLQGLAMI2PNmYOw1uojZfdCyYNCXexiGcGpiljdp9hsBGjvnvBpCHhRbgBZChjAgj0eXrX7gWThoR992lAMGOOLMfJuIHuBZMGQuE75KN66Cpq14xH2L1g0kixyLNm3I8sNbwJulHfvWDSkJArmou4hlxXeh4AvBEBuZnnbtHfMix+AHqkr6wgQ4Q7"+mt,2:v+t+"A3UlEQVRIS72PwQ3CMAxFOwrjcOyZCTgyAjfWYCJO3JiCCVL/iFSO9W0MDTzpqYob+ztTKeWn0uJIadE6H8/ljXsR96q6tzt4YogH/olPcQ2R8mp3CHRBwO3+6EKkvNodcDkSgyyoAx0iRz/AA/8Op0sdtJuv1Va3Ct8FYHgL8dgUAGxIe41+kRAH6CbdaGW86nFAhnaXLSLEAbqJCbxlUgEZ2DIgFaCbmMBbJhWQgS0DUgG6iQm8ZVIBGTYFsK21oN3F1yrEARnsIM/u8JeAT9S9nrQ4UlocKS2Os0wLtkPMdu9POt0AAAAASUVORK5CYII=",3:v+"UAAAAXCAIAAABrvZPKAAAABGdBTUEAALGPC/xhBQAAAAlwSFlzAAAOwwAADsMBx2+oZAAAAIdJREFUOE/tzEEKgCAQheEOWLdx351adYc8Qgs3rbuAUC9nkkF0BKNN9CMy0Xx25llf8Edr7d57j/tlP4wTHf4W/b7gsT0vLs7Sz9bFWfM9nrDXE9ITphlVPO512wkkM++FNF86vBfKeKR43rjLe5QwOvxPVPSoipHmkY5RxSMFo7rXY9+eMSdet07b6c/bnwAAAABJRU5ErkJggg=="})[0],i=t[1],r=t[2],t=t[3],(n=this).LNt=new $t(o("wijspread_toolstrip_paste"),u().ToolStrip_PasteText,e,n.FNt),n.PNt=new $t(o("wijspread_toolstrip_cut"),u().ToolStrip_CutText,i,n.GNt),n.UNt=new $t(o("wijspread_toolstrip_copy"),u().ToolStrip_CopyText,r,n.HNt),n.zNt=new $t(o("wijspread_toolstrip_autofill"),u().ToolStrip_AutoFillText,t,n.VNt,n.YNt),n.add(n.LNt),n.add(n.PNt),n.add(n.UNt),n.add(new tn(n.YNt)),n.add(n.zNt)},T.prototype.YNt=function(){var t,n,e,i,t=g(this.Vv);if(!t)return!1;if(0===(n=y(t)).length)return!1;for(e=0;e<n.length;e++)if(-1===(i=n[e]).row&&-1===i.col)return!1;return!0},T.prototype.VNt=function(){var t,n;this.close(),(t=g(this.Vv))&&(n=y(t).length)<=1&&(t.kNt=!0,t.Dn.E1())},T.prototype.xNt=function(){var t=g(this.Vv);t&&(t.kNt=!1,t.Dn.E1())},T.prototype.HNt=function(){var t,n,t=g(this.Vv);t&&(n=le(t),this.ZNt=n?t.Qy().execute({cmd:"copyFloatingObjects",sheetName:t.name()}):t.eA(!0)),this.close()},T.prototype.GNt=function(){var t,n,t=g(this.Vv);t&&(n=le(t),this.ZNt=n?t.Qy().execute({cmd:"cutFloatingObjects",sheetName:t.name()}):t.tA(!0)),this.close()},T.prototype.FNt=function(){var t,n,e,t=this,n=t.ZNt,e=g(t.Vv);e&&!k(n)&&(e.isPasteFloatingObject&&e.isPasteFloatingObject()?e.Qy().execute({cmd:"pasteFloatingObjects",sheetName:e.name()}):e.rA({pasteHtml:n.copyHtml,pasteText:n.copyText})),t.close()},T.prototype.WNt=function(){var t=this,n="span."+Yt;D("#"+t.LNt.Zc).find(n).text(u().ToolStrip_PasteText),D("#"+t.PNt.Zc).find(n).text(u().ToolStrip_CutText),D("#"+t.UNt.Zc).find(n).text(u().ToolStrip_CopyText),D("#"+t.zNt.Zc).find(n).text(u().ToolStrip_AutoFillText)},qt=T,t.TouchToolStrip=qt,de.prototype.name=function(t){var n=this;return 0===arguments.length?n.Zc:(D("#"+n.Zc).attr("id",t),D("#"+n.Zc+"Text").attr("id",t+"Text"),D("#"+n.Zc+"Image").attr("id",t+"Image"),n.Zc=t,n)},de.prototype.text=function(t){var n=this;return 0===arguments.length?n._text:(n._text=t,D("#"+n.name()+"Text").text(t),n)},de.prototype.font=function(t){var n,e,n=this,e=D("#"+n.name()+"Text");return 0===arguments.length?n._font:(n._font=t,e.css("font",t),n)},de.prototype.foreColor=function(t){var n,e,n=this,e=D("#"+n.name()+"Text");return 0===arguments.length?n.Oft||e.css("color"):(e.css("color",t),n)},de.prototype.image=function(t){var n=this;return 0===arguments.length?n.GAt:(n.GAt=t,D("#"+n.name()+"Image").css("background-image","url("+t+")"),n)},de.prototype.RNt=function(t,n,e,i){var r,o,a,u,s,t,n,r,a,r=this,o=r.name(),a=r.font(),u=r.text(),s=D(c("span"));return s.attr("id",o+"Image"),s.addClass(t),s.css({"background-image":"url("+r.image()+")","background-repeat":"no-repeat",display:"block",height:n,"background-position-x":"50%"}),(t=D(c("span"))).attr("id",o+"Text"),t.addClass(e),t.css("font",a),t.text(u),(r=60)<(n=he(a,u,e))&&(r=n),(a=D(c(Xt))).attr("type",Xt),a.attr("id",o),a.addClass(i+" gc-toolstrip-button-style ui-state-default ui-widget btn btn-default"),a.css({"box-sizing":"content-box",border:"0px",padding:"4px",margin:"3px",width:r+d}),a.append(s),a.append(t),a[0]},$t=de,t.TouchToolStripItem=$t,ve.prototype.name=function(){return this.Zc},ve.prototype.RNt=function(t,n){var e=D(c("div"));return e.attr("id",this.name()),e.addClass(t),e.css({width:"1px",height:n,display:"inline-block;","background-color":"#CCC","margin-left":"5px","margin-right":"5px",opacity:.6}),e[0]},tn=ve,t.TouchToolStripSeparator=tn,A.prototype.NIt=function(){this.QNt=2,this.jS.Oi=!0},A.prototype.qAt=function(){this.QNt=0,this.KNt=m()},A.prototype.xIt=function(){return 1===this.QNt},A.prototype.jIt=function(){return 1===this.QNt},A.prototype._It=function(){return 1===this.QNt},A.prototype.sW=function(){var t=this;if(2===t.QNt)return!0;if(t.KNt){if(m()-t.KNt<=200)return t.JNt++,!0;t.KNt=0,t.JNt=0}return t.QNt=1,t.jS.Oi=!1},A.prototype.cW=function(){var t=this;return t.JNt?(t.JNt--,!0):2===t.QNt||(t.QNt=0,!1)},A.prototype.fW=function(){return 2===this.QNt},nn=A,t.IZ=nn,en=me,t.NZ=en,ge.prototype.XNt=function(t,n){var e,i,r,o,i,r,e=t,i=e.touches,r=e.targetTouches,o=e.changedTouches;!1===e.isPrimary||i&&1<=i.length&&r&&1<=r.length&&(i[0].clientX!==r[0].clientX||i[0].clientY!==r[0].clientY)||(f(t),i=k(o)?e:o[0],(r=j.createEvent("MouseEvents")).initMouseEvent(n,!0,!0,dt,1,i.screenX,i.screenY,i.clientX,i.clientY,!1,!1,!1,!1,0,M),t.target.dispatchEvent(r))},ge.prototype.lIt=function(t){var n,n,n=t.pointerType;n&&n!==t[h]&&n!==l||(n=t.data).Vb||(n.Vb=!0,n.qNt=!1,n.XNt(t,"mouseover"),n.XNt(t,"mousemove"),n.XNt(t,"mousedown"))},ge.prototype.iE=function(t){var n,n,n=t.pointerType;n&&n!==t[h]&&n!==l||(n=t.data).Vb&&(n.qNt=!0,n.XNt(t,"mousemove"))},ge.prototype.vIt=function(t){var n,n,n=t.pointerType;n&&n!==t[h]&&n!==l||(n=t.data).Vb&&(n.XNt(t,"mouseup"),n.XNt(t,"mouseout"),n.qNt||n.XNt(t,"click"),n.Vb=!1)},ge.prototype.$Nt=function(t,n,e){var i,r,r,o,a,u,s,c,f,l,e,h,n,i=this,r=e.charAt(0),r=et+(e="."!==r?"."+e:e),o=it+e,a=rt+e,u=ot+e,s=at+e,c=ut+e,f=st+e,l=ct+e,e=ft+e,h=N.mt.m0();n?h?(n=t.style,k(n.msTouchAction)||(n.msTouchAction=nt),k(n.touchAction)||(n.touchAction=nt),D(t).bind(r,i,i.lIt).bind(u,i,i.lIt),D(j).bind(o,i,i.iE).bind(s,i,i.iE).bind(a,i,i.vIt).bind(c,i,i.vIt)):D(t).bind(f,i,i.lIt).bind(l,i,i.iE).bind(e,i,i.vIt):h?(D(t).unbind(r).unbind(u),D(j).unbind(o).unbind(s).unbind(a).unbind(c)):D(t).unbind(f).unbind(l).unbind(e)},rn=ge,t.QAt=rn,on="newSheet",an="tab",un="allSheets",I.prototype.BZ=function(t){var n,t,e,i,r,r,o,a,r,t,a,t,a,u,s,n=this,t=t.JZ,e=n.w2,i=e.im(),r=g(e.Vv);e.Og&&e.Rg(r,!1),r="resize",(a=(o=e.hitTest(t.X,t.Y)).element)===r?(e.Bg=!0,e.Lg=t.X):a!==an&&a!==on&&""!==a||(r=e.fg,t=N.Bf.Xl(r),a=N.Bf.ql(r),a=(t=n.oNt(t,a)).getContext("2d"),u=N.Bf.Kl(t),s=N.Bf.Jl(t),N.Lf.Vl(a,1,1),a.drawImage(r,0,0,B(t),R(t),0,0,B(t),R(t)),N.Lf.Vl(a,u,s),n.fg=t,n.t6t=e.om,n.n6t=e.tm(),n.e6t=e.Xv(),n.Rv=e.Jv(),e.Kv=i),n.i6t=e.N2(-1),n.r6t=e.Ym(e.Zm())},I.prototype.FZ=function(t){var n,e,i,r,o,a,u,s,o,c,o,a,u,s,e,f,l,t,n,n,u,a,s,e,u,h,d,v,m,r,g,g,p,r,b,n=this,e=t.JZ.X,i=n.w2,r=i.im();i.Bg?(o=e-i.Lg,u=(a=i.Vv).options,s=a.Kg.clientWidth,u.tabStripRatio=a.Jg()+o/s,o=i.rm()/s,c=1,a.Jg()<o?(u.tabStripRatio=o,i.Lg=i.rm()):1<=a.Jg()?(u.tabStripRatio=1,i.Lg=s):i.Lg=e):(o=n.fg,a=n.t6t,o&&!k(a)&&(u=n.i6t,s=n.r6t,e=n.Rv,f=n.n6t,l=n.e6t,t=r?t.nW.wAt.X:t.nW.wAt.Y,n=n.o6t(t,a),i.om=n.om,n=n.Eft,(0<t&&a===u&&i.om===u||t<0&&a===s&&i.om===s)&&(n=0),0<t&&n+e<t?t=n+e:t<0&&t<n-e&&(t=n-e),0!==t)&&(a=(u=i.fg).getContext("2d"),s=N.Bf.Kl(u),e=N.Bf.Jl(u),a.save(),a.clearRect(0,0,N.Bf.Xl(u),N.Bf.ql(u)),u=i.ot(),i.wm(a,u),r?(h=void 0,m=R(u),g=r=v=void(d=0),0<t?(0<(v=l-(r=(h=f)+t))&&(N.Lf.Vl(a,1,1),a.drawImage(o,h*s,d,v*s,m*e,r*s,d,v*s,m*e),N.Lf.Vl(a,s,e)),g=l-f<=t?0:t-n,h=f,0<(v=n)&&(N.Lf.Yl(a,g,0),i.Z2(a,new N.Rect(h,d,v,m)),N.Lf.Yl(a,-g,0))):t<0&&(0<(v=l-(h=(r=f)+_(t)))&&(N.Lf.Vl(a,1,1),a.drawImage(o,h*s,d,v*s,m*e,r*s,d,v*s,m*e),N.Lf.Vl(a,s,e)),g=t-n,l-f<=_(t)&&(g=0),h=l-(v=_(n)),0<v)&&(N.Lf.Yl(a,g,0),i.Z2(a,new N.Rect(h,d,v,m)),N.Lf.Yl(a,-g,0)),N.Lf.Vl(a,1,1),a.drawImage(o,(h=0)*s,d,(v=f)*s,m*e,h*s,d,v*s,m*e),g=N.I.fl(""),2007<(p=lt(g.zIndex))&&(h=l,v=u.x+B(u)-i.rm()-h,a.drawImage(o,h*s,d,v*s,m*e,h*s,d,v*s,m*e)),h=B(u)-i.rm(),v=i.rm(),a.drawImage(o,h*s,d,v*s,m*e,h*s,d,v*s,m*e)):(v=B(u),b=r=m=d=void(h=0),0<t?(0<(m=l-(r=(d=f)+t))&&(N.Lf.Vl(a,1,1),a.drawImage(o,h*s,d*e,v*s,m*e,h*s,r*e,v*s,m*e),N.Lf.Vl(a,s,e)),b=l-f<=t?0:t-n,d=f,0<(m=n)&&(N.Lf.Yl(a,0,b),i.Z2(a,new N.Rect(h,d,v,m)),N.Lf.Yl(a,0,-b))):t<0&&(0<(m=l-(d=(r=f)+_(t)))&&(N.Lf.Vl(a,1,1),a.drawImage(o,h*s,d*e,v*s,m*e,h*s,r*e,v*s,m*e),N.Lf.Vl(a,s,e)),b=t-n,l-f<=_(t)&&(b=0),d=l-(m=_(n)),0<m)&&(N.Lf.Yl(a,0,b),i.Z2(a,new N.Rect(h,d,v,m)),N.Lf.Yl(a,0,-b)),N.Lf.Vl(a,1,1),a.drawImage(o,h*s,(d=0)*e,v*s,(m=f)*e,h*s,d*e,v*s,m*e),g=N.I.fl(""),2007<(p=lt(g.zIndex))&&(d=l,m=u.y+R(u)-i.rm()-d,a.drawImage(o,h*s,d*e,v*s,m*e,h*s,d*e,v*s,m*e)),d=R(u)-i.rm(),m=i.rm(),a.drawImage(o,h*s,d*e,v*s,m*e,h*s,d*e,v*s,m*e)),N.Lf.Vl(a,s,e),a.restore()))},I.prototype.GZ=function(t){var n=this.w2;n.Bg?(n.Bg=!1,n.Vv.Xg()):(n.Kv=p,n.repaint())},I.prototype.HZ=function(t){var n,e,i,r,o,i,a,o,n=this.w2,e=n.Vv,i=t.JZ,r=g(e);n.Og&&n.Rg(r,!1),o=["first","prevArrow","nextArrow","last","","prevButton","nextButton"],a=(i=n.hitTest(i.X,i.Y)).element,e.Bp=!0;try{0<=o.indexOf(a)?n.Pg(i.index,!0):a===an?n.Gg(i.index,i.position):a===on?n.Hg(i.position):a===un&&this.zg(t)}finally{e.Bp=!1,(o=g(e))!==r&&(o.Oi=!0,o.Zg())}},I.prototype.WAt=function(t){return this.w2.E2(t.JZ.X,t.JZ.Y)},I.prototype.oNt=function(t,n){var e=this.fg;return e?t===N.Bf.Xl(e)&&n===N.Bf.ql(e)||N.Bf.$l(e,t,n):(e=c("canvas"),N.Bf.Wl(e,this.w2.Vv),N.Bf.$l(e,t,n)),e},I.prototype.o6t=function(t,n){var e,i,r,o,a,u,s,c,f,e=this,i=e.w2,r=i.$v,o=i.am,a=e.i6t,u=e.r6t,s=i.im(),c=n,f=0;if(0<t){for(;a<=c&&!(t<f);)f+=s?r[c]:o,c--;c<a&&(c=a)}else if(t<0&&-1!==u){for(;c<=u&&!(f<t);)f-=s?r[c]:o,c++;u<c&&(c=u)}return{om:c,Eft:f}},I.prototype.zg=function(t){var n;this.w2.zg({pageX:1,pageY:1})},sn=I,pe.prototype.oW=function(){var t=this,n=t.kZ;n&&n.aW(t.xZ,!0)},pe.prototype.uW=function(){var t=this,n=t.kZ;n&&n.aW(t.xZ,!1)},pe.prototype.sW=function(t){return this.AZ.sW()},pe.prototype.cW=function(t){return this.AZ.cW()},pe.prototype.fW=function(t){return this.AZ.fW()},cn=pe,N.g7.prototype.PD=function(){var t,n,e,i,t=this,n=t.Mf,e=y(n),i=e.length;n.My<=0&&0<i&&t.E1(e[i-1],p,p,!0)},N.Worksheet.ch(l,{init:function(){this.kNt=!1,this.INt=!0},setHost:function(t){var n,e,e,t,n=this,e=n.parent,e=e&&e.kZ||new yt,t=new zt(t[0],n,e);t.oW(),n.dW=t},dispose:function(t){var n=this;n.dW&&n.dW.uW(),!1!==t.clearCache&&(n.dW=M)},startEdit:function(){this.Oi&&this.Dn.PD()},paintAdornment:function(t){var n,t,n=this,t=t.ctx;n.Oi&&(n.options.isProtected||ye(n,t),n.kNt?Ae(n,t):Te(n,n.INt,t))},preProcessMouseDown:function(t){var n,e,n=t.e,e=this.dW;(i||e.sW(n))&&(f(n),t.r=!0)},preProcessMouseMove:function(t){var n,e,n=t.e,e=this.dW;(i||e.fW(n))&&(f(n),t.r=!0)},preProcessMouseUp:function(t){var n,e,n=t.e,e=this.dW;(i||e.cW(n))&&(f(n),t.r=!0)},preProcessMouseDbClick:function(t){(i||this.Oi)&&(t.r=!0)},preProcessMouseOut:function(t){i&&(t.r=!0)},preProcessMouseWheel:function(t){i&&(t.r=!0)}}),N.Workbook.ch(l,{init:function(){this.kZ=new yt},setHost:function(){var t=this;t.touchToolStrip=new qt(t,t.j2())},dispose:function(){var t=this,n=t.kZ,e=t.touchToolStrip;n&&n.L0(),e&&(e.L0(),t.touchToolStrip=M)},onCultureChanged:function(){var t=this.touchToolStrip;t&&t.WNt()}}),N.Hv.ch(l,{setHost:function(){var t,n,t=this,n=new cn(t.fg,t,t.Vv.kZ);n.oW(),t.dW=n},dispose:function(){var t=this,n=t.dW;n&&(n.uW(),t.dW=M)},preProcessMouseDown:function(t){var n=this.dW,e=t.e;(i||n.sW(e))&&(f(e),t.r=!1)},preProcessMouseMove:function(t){var n=this.dW,e=t.e;(i||n.fW(e))&&(f(e),t.r=!1)},preProcessMouseUp:function(t){var n=this.dW,e=t.e;(i||n.cW(e))&&(f(e),t.r=!1)},preProcessMouseDbClick:function(t){var n=g(this.Vv);(i||n&&n.Oi)&&(t.r=!1)},preProcessMouseOut:function(t){i&&(t.r=!1)}}),fn=".gcScrollbar",N.YM.ch(l,{initEvents:function(t){var n;(this.Hb=new rn).$Nt(t,!0,fn)},dispose:function(t){var n=this.Hb;n&&n.$Nt(t,!1,fn)}})},"./dist/plugins/touch/touch.res.en.js":function(t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.ToolStrip_AutoFillText=n.ToolStrip_CopyText=n.ToolStrip_CutText=n.ToolStrip_PasteText=void 0,n.ToolStrip_PasteText="Paste",n.ToolStrip_CutText="Cut",n.ToolStrip_CopyText="Copy",n.ToolStrip_AutoFillText="AutoFill"},"./dist/plugins/validation/datavalidation-event.js":function(i,t,n){"use strict";var t,e,B,L,F,P,G,U,H,z,V,Y,Z,W,Q,J,K,X,q,$,tt,nt,et,it,rt,ot,at,ut,st,ct,ft,lt,ht,dt;Object.defineProperty(t,"__esModule",{value:!0}),t=n("Core"),e=n("Common"),B=n("CalcEngine"),L=n("./dist/plugins/validation/datavalidation.js"),F=e.Common.lt.ht,P=e.Common.ct,G=e.Common.zf,U=t.mt,H=t.Ec,z=U.pi(),V=U.Tt,Y=t.GC$,Z=U.En,W=U.yt,Q=U.vi,J=document,K=Math.max,X=Math.min,q="position",$="absolute",tt="border",nt="padding",et="box-shadow",it="font",rt="background-color",ot="top",at="left",ut="z-index",st="outline",ct="auto",ft="white",lt="none",ht="size",dt="gcUIElement",Y.extend(t.nk.prototype,{PA:function(n,e){var i,r,t,o,a,u,s,c,f,l,h,u,a,t,u,a,d,v,m,g,p,b,y,w,M,C,S,T,t,u,a,t,s,u,t,s,R,A,I,s,x,N,k,D,_,_,a,D,E,j,s,k;function O(t,n){if(t&&t[n])return"function"==typeof t[n]?t[n]():t[n]}if((t=(r=(i=this).Mf)&&r.parent)&&(o=r.G1())&&((a=t.getActiveSheet())||(u=t.getActiveSheetTab())&&(a=u.Mf),a)&&r.name()===a.name()&&(s=r.getDataValidator(n,e))&&(c=r.getCellRect(n,e),!i.Ek(c))&&(f=t.j2(),l=t.getHost(),h=U.gi(l),O(s,"showInputMessage")&&O(s,"inputMessage")&&(t=(u=G.Vi)((a=G.j0)(O(s,"inputTitle")),"\n","<br/>"),u=u(a(O(s,"inputMessage")),"\n","<br/>"),a=Z("span"),Y(a).css(q,$).css(tt,"1px #C0C0C0 solid").css(nt,"3px 8px 3px 8px").css(rt,"#FFFFFF").css(et,"1px 2px 5px rgba(0,0,0,0.4)").css(it,"normal normal normal 12px/normal Arial").width(ct).height(ct).css(ot,c.y+c.height+5).css(at,c.x+c.width/2).css(ut,h).html("<b>"+t+"</b><br/>"+u).attr(dt,"gcValidationInputMessage").appendTo(f),r.KD=a),s)&&3===O(s,"type")&&O(s,"inCellDropdown")&&O(s,"condition")){for(d=O(s,"condition").getValidListImp(r,n,e),v=O(s,"condition").KJ(),m=d.length,g=Z("select"),p=r.getText(n,e),b=-1,y=J.createDocumentFragment(),w=new RegExp(String.fromCharCode(32),"g"),M=String.fromCharCode(160),C=0;C<m;C++)S=d[C].text,F(S)||B&&S instanceof B.CalcError||(b<0&&S===p&&(b=C),S instanceof Date&&(S=P.Pe(S,"M/d/yyyy h:mm:ss")),(T=Z("option")).value=S,T.text=S.replace(w,M),y.appendChild(T));g.appendChild(y),g.selectedIndex=0<b?b:0,t=r.getActualStyle(n,e),u=r.Dn,a=t&&t.font?t.font:u.Nn(),1<r.zoom()&&(a=u._n(a)),(t=r.Ut.getSpans(H(n,e,s=1,1)))&&0<t.length&&t[0]&&(s=t[0].colCount),u=e+s-1==r.getColumnCount()-1,t=r.Gt(n),s=r.parent&&r.parent.options.useTouchLayout,t=X(s?50:15,t),A=V.safari&&(z.ipad||z.iphone),I=z.android,D=k=N=x=s=void 0,D=A?(s=c.width+3,x=c.height+3,N=c.y-1.5,k=c.x-1.5,ft):(s=K(c.width+(u?0:t),r.defaults.colWidth),x=8<m?140:ct,N=c.y+c.height,k=(_=c.x+c.width+(u?0:t)-s)<r.uw().left?c.x:_,""),_=Y(g).css(st,lt).css(q,$).css(it,W(a)).css(ut,h).css(rt,D).width(s).height(x).css(at,k).attr(dt,"gcValidationSelect").appendTo(f).attr(ht,2<m?m:2).hide().bind("click",function(){I||(i.jk(g,n,e,d,v),A&&Y(r.a6t).show())}).bind("keydown",function(t){13!==t.keyCode||t.ctrlKey||t.shiftKey||t.altKey?27!==t.keyCode||t.ctrlKey||t.shiftKey||t.altKey||Y(g).hide():i.jk(g,n,e,d,v),A&&Y(r.a6t).show()}).bind("change",function(){I&&i.jk(g,n,e,d,v)}),a=Y(l).height(),x=_.outerHeight()+1,A||(a<x+N&&x<N?N=c.y-x:(D=l.getBoundingClientRect(),(s=(E=window.innerHeight)-((j=D.y)+N))<x&&_.height(s))),_.css(ot,N),A&&_.bind("blur",function(){i.jk(g,n,e,d,v),Y(r.a6t).show()}),r.gf=g,(k=Z("input")).type="image",k.src=(0,L.Hrt)(),k.alt="v",Y(k).css(q,$).width(t).height(t).css(ot,c.y+c.height-(t+3)).css(at,c.x+c.width-(u?t:0)).css(ut,h).css(rt,ft).css(tt,"1px solid gray").attr(dt,"gcValidationButton").appendTo(f).bind("click",function(t){r.isEditing()&&!r.endEdit()||(Y(r.gf).toggle().focus(),A&&Y(r.a6t).toggle(),Q(t))}),r.a6t=k}}})},"./dist/plugins/validation/datavalidation.entry.js":function(t,n,e){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.createListValidator=n.createFormulaListValidator=n.createFormulaValidator=n.createTextLengthValidator=n.createTimeValidator=n.createDateValidator=n.createNumberValidator=n.kf=n.Hrt=n.HighlightPosition=n.HighlightType=n.DefaultDataValidator=n.ErrorStyle=n.DataValidationResult=n.CriteriaType=void 0,e("./dist/plugins/validation/datavalidation-event.js");var i=e("./dist/plugins/validation/datavalidation.js");Object.defineProperty(n,"CriteriaType",{enumerable:!0,get:function(){return i.CriteriaType}}),Object.defineProperty(n,"DataValidationResult",{enumerable:!0,get:function(){return i.DataValidationResult}}),Object.defineProperty(n,"ErrorStyle",{enumerable:!0,get:function(){return i.ErrorStyle}}),Object.defineProperty(n,"DefaultDataValidator",{enumerable:!0,get:function(){return i.DefaultDataValidator}}),Object.defineProperty(n,"HighlightType",{enumerable:!0,get:function(){return i.HighlightType}}),Object.defineProperty(n,"HighlightPosition",{enumerable:!0,get:function(){return i.HighlightPosition}}),Object.defineProperty(n,"Hrt",{enumerable:!0,get:function(){return i.Hrt}}),Object.defineProperty(n,"kf",{enumerable:!0,get:function(){return i.kf}}),Object.defineProperty(n,"createNumberValidator",{enumerable:!0,get:function(){return i.createNumberValidator}}),Object.defineProperty(n,"createDateValidator",{enumerable:!0,get:function(){return i.createDateValidator}}),Object.defineProperty(n,"createTimeValidator",{enumerable:!0,get:function(){return i.createTimeValidator}}),Object.defineProperty(n,"createTextLengthValidator",{enumerable:!0,get:function(){return i.createTextLengthValidator}}),Object.defineProperty(n,"createFormulaValidator",{enumerable:!0,get:function(){return i.createFormulaValidator}}),Object.defineProperty(n,"createFormulaListValidator",{enumerable:!0,get:function(){return i.createFormulaListValidator}}),Object.defineProperty(n,"createListValidator",{enumerable:!0,get:function(){return i.createListValidator}})},"./dist/plugins/validation/datavalidation.js":function(I,t,n){"use strict";var a,x,e,v,n,i,f,L,N,k,D,F,r,h,d,_,o,P,s,m,E,n,i,G,U,H,j,z,O,l,V,Y,Z,W,R,Q,B,J,K,X,q,$,g,p,b,tt,u,n,nt,et,it,rt,ot,at,ut,st,ct,n,c,ft,lt,ht,dt,vt,y,w,mt,n,n,w,w,w,w,w;function gt(t){if(_(t))return 0;if("number"==typeof t)return t;if("string"==typeof t){var n=parseFloat(t);if(!isNaN(n)&&n.toString()===t)return n}return m}function pt(t){var n,e,i,r,o;if(t instanceof Date)return t;if("string"!=typeof t)return"number"==typeof t&&!isNaN(t)&&(n=a.Common.ct.Y0(t))||m;if(!(n=a.Common.ct.yU(t)))if(isNaN(t)){if(a.Common.ct.u6t(t))return m;if(n=new Date(t),isNaN(n.valueOf()))return m;try{if(e=/^[-+=\s]*(\d+)\W+(\d+)\W+(\d+)$/,r=(i=a.Common.zf).s6t(a.Common.zf.cJ(t.replace(/[ \n]/g,"")," ")," "),(o=e.exec(r))&&4===o.length&&(-1===o.indexOf(n.getFullYear().toString())||-1===o.indexOf(n.getMonth().toString())||-1===o.indexOf(n.getDate().toString())))return m}catch(t){return m}}else if(!(n=a.Common.ct.Y0(parseFloat(t))))return m;return n}function bt(t){return!_(t)&&t instanceof Date?P(t):t}function yt(t,n){var e,i,r;if(!_(t))return 1===t||2===t?e=Ct(n.operator,n.value1,n.value2,1===t):3===t?n.value?e=kt(n.value):n.formula&&(e=Nt(n.formula)):4===t||5===t?(i=n.value1,r=n.value2,i&&"/OADate("===i.substr(0,8)&&(i=tt.dJ(i)),r&&"/OADate("===r.substr(0,8)&&(r=tt.dJ(r)),e=(5===t?At:Tt)(n.operator,i,r)):6===t?e=It(n.operator,n.value1,n.value2):7===t&&void 0!==n.formula&&(e=xt(n.formula)),e?e.condition():void 0}function wt(t,n,e,i,r,o){var a,u,s,c,f,l,h,d,o,o,s,c,u,v,d,n,i,e,r,r,l,a;return t.intersect(n,e,i,r)?(a=t.rowCount,u=t.colCount,s=b(0,t.row),c=b(0,t.col),h=l=f=!1,n=b(0,n),e=b(0,e),d=(o=o||[-1,-1])[0],o=o[1],-1===a&&(a=d-s,l=!0),-1===u&&(u=o-c,f=!0),-1===r&&(r=o-e,h=!0),s=(o=s)+a-1,u=(c=c)+u-1,d=(v=n)+(i=-1===i?d-n:i)-1,i=(n=e)+r-1,e=[],-1!==o&&-1!==c&&-1!==v&&-1!==n&&(0<n-c&&(r=g(o,c,l?-1:a,n-c),e.push(r)),0<u-i&&(r=g(o,1+i,l?-1:a,u-i),e.push(r)),0<v-o&&(l=g(o,b(n,c),v-o,f&&h?-1:p(i,u)-b(n,c)+1),e.push(l)),0<s-d)&&(a=g(1+d,b(n,c),s-d,f&&h?-1:p(i,u)-b(n,c)+1),e.push(a)),e.c6t=!0,e):[t]}function M(t,n){var n;if(!_(t))return"string"==typeof t&&(t=W(t)),t=3===n||!(t=4!==n&&5!==n||(n=parseFloat(t),isNaN(n))?t:pt(t))||t instanceof Date?t:V(t)}function C(t){var n=this;n.id=C.f6t,C.f6t++,n.l6t=o(it),t&&(n.condition(t),n.condition().ignoreBlank(n.ignoreBlank())),n._S=[]}function Mt(){return"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAACXBIWXMAAA7DAAAOwwHHb6hkAAAKTWlDQ1BQaG90b3Nob3AgSUNDIHByb2ZpbGUAAHjanVN3WJP3Fj7f92UPVkLY8LGXbIEAIiOsCMgQWaIQkgBhhBASQMWFiApWFBURnEhVxILVCkidiOKgKLhnQYqIWotVXDjuH9yntX167+3t+9f7vOec5/zOec8PgBESJpHmomoAOVKFPDrYH49PSMTJvYACFUjgBCAQ5svCZwXFAADwA3l4fnSwP/wBr28AAgBw1S4kEsfh/4O6UCZXACCRAOAiEucLAZBSAMguVMgUAMgYALBTs2QKAJQAAGx5fEIiAKoNAOz0ST4FANipk9wXANiiHKkIAI0BAJkoRyQCQLsAYFWBUiwCwMIAoKxAIi4EwK4BgFm2MkcCgL0FAHaOWJAPQGAAgJlCLMwAIDgCAEMeE80DIEwDoDDSv+CpX3CFuEgBAMDLlc2XS9IzFLiV0Bp38vDg4iHiwmyxQmEXKRBmCeQinJebIxNI5wNMzgwAABr50cH+OD+Q5+bk4eZm52zv9MWi/mvwbyI+IfHf/ryMAgQAEE7P79pf5eXWA3DHAbB1v2upWwDaVgBo3/ldM9sJoFoK0Hr5i3k4/EAenqFQyDwdHAoLC+0lYqG9MOOLPv8z4W/gi372/EAe/tt68ABxmkCZrcCjg/1xYW52rlKO58sEQjFu9+cj/seFf/2OKdHiNLFcLBWK8ViJuFAiTcd5uVKRRCHJleIS6X8y8R+W/QmTdw0ArIZPwE62B7XLbMB+7gECiw5Y0nYAQH7zLYwaC5EAEGc0Mnn3AACTv/mPQCsBAM2XpOMAALzoGFyolBdMxggAAESggSqwQQcMwRSswA6cwR28wBcCYQZEQAwkwDwQQgbkgBwKoRiWQRlUwDrYBLWwAxqgEZrhELTBMTgN5+ASXIHrcBcGYBiewhi8hgkEQcgIE2EhOogRYo7YIs4IF5mOBCJhSDSSgKQg6YgUUSLFyHKkAqlCapFdSCPyLXIUOY1cQPqQ28ggMor8irxHMZSBslED1AJ1QLmoHxqKxqBz0XQ0D12AlqJr0Rq0Hj2AtqKn0UvodXQAfYqOY4DRMQ5mjNlhXIyHRWCJWBomxxZj5Vg1Vo81Yx1YN3YVG8CeYe8IJAKLgBPsCF6EEMJsgpCQR1hMWEOoJewjtBK6CFcJg4Qxwicik6hPtCV6EvnEeGI6sZBYRqwm7iEeIZ4lXicOE1+TSCQOyZLkTgohJZAySQtJa0jbSC2kU6Q+0hBpnEwm65Btyd7kCLKArCCXkbeQD5BPkvvJw+S3FDrFiOJMCaIkUqSUEko1ZT/lBKWfMkKZoKpRzame1AiqiDqfWkltoHZQL1OHqRM0dZolzZsWQ8ukLaPV0JppZ2n3aC/pdLoJ3YMeRZfQl9Jr6Afp5+mD9HcMDYYNg8dIYigZaxl7GacYtxkvmUymBdOXmchUMNcyG5lnmA+Yb1VYKvYqfBWRyhKVOpVWlX6V56pUVXNVP9V5qgtUq1UPq15WfaZGVbNQ46kJ1Bar1akdVbupNq7OUndSj1DPUV+jvl/9gvpjDbKGhUaghkijVGO3xhmNIRbGMmXxWELWclYD6yxrmE1iW7L57Ex2Bfsbdi97TFNDc6pmrGaRZp3mcc0BDsax4PA52ZxKziHODc57LQMtPy2x1mqtZq1+rTfaetq+2mLtcu0W7eva73VwnUCdLJ31Om0693UJuja6UbqFutt1z+o+02PreekJ9cr1Dund0Uf1bfSj9Rfq79bv0R83MDQINpAZbDE4Y/DMkGPoa5hpuNHwhOGoEctoupHEaKPRSaMnuCbuh2fjNXgXPmasbxxirDTeZdxrPGFiaTLbpMSkxeS+Kc2Ua5pmutG003TMzMgs3KzYrMnsjjnVnGueYb7ZvNv8jYWlRZzFSos2i8eW2pZ8ywWWTZb3rJhWPlZ5VvVW16xJ1lzrLOtt1ldsUBtXmwybOpvLtqitm63Edptt3xTiFI8p0in1U27aMez87ArsmuwG7Tn2YfYl9m32zx3MHBId1jt0O3xydHXMdmxwvOuk4TTDqcSpw+lXZxtnoXOd8zUXpkuQyxKXdpcXU22niqdun3rLleUa7rrStdP1o5u7m9yt2W3U3cw9xX2r+00umxvJXcM970H08PdY4nHM452nm6fC85DnL152Xlle+70eT7OcJp7WMG3I28Rb4L3Le2A6Pj1l+s7pAz7GPgKfep+Hvqa+It89viN+1n6Zfgf8nvs7+sv9j/i/4XnyFvFOBWABwQHlAb2BGoGzA2sDHwSZBKUHNQWNBbsGLww+FUIMCQ1ZH3KTb8AX8hv5YzPcZyya0RXKCJ0VWhv6MMwmTB7WEY6GzwjfEH5vpvlM6cy2CIjgR2yIuB9pGZkX+X0UKSoyqi7qUbRTdHF09yzWrORZ+2e9jvGPqYy5O9tqtnJ2Z6xqbFJsY+ybuIC4qriBeIf4RfGXEnQTJAntieTE2MQ9ieNzAudsmjOc5JpUlnRjruXcorkX5unOy553PFk1WZB8OIWYEpeyP+WDIEJQLxhP5aduTR0T8oSbhU9FvqKNolGxt7hKPJLmnVaV9jjdO31D+miGT0Z1xjMJT1IreZEZkrkj801WRNberM/ZcdktOZSclJyjUg1plrQr1zC3KLdPZisrkw3keeZtyhuTh8r35CP5c/PbFWyFTNGjtFKuUA4WTC+oK3hbGFt4uEi9SFrUM99m/ur5IwuCFny9kLBQuLCz2Lh4WfHgIr9FuxYji1MXdy4xXVK6ZHhp8NJ9y2jLspb9UOJYUlXyannc8o5Sg9KlpUMrglc0lamUycturvRauWMVYZVkVe9ql9VbVn8qF5VfrHCsqK74sEa45uJXTl/VfPV5bdra3kq3yu3rSOuk626s91m/r0q9akHV0IbwDa0b8Y3lG19tSt50oXpq9Y7NtM3KzQM1YTXtW8y2rNvyoTaj9nqdf13LVv2tq7e+2Sba1r/dd3vzDoMdFTve75TsvLUreFdrvUV99W7S7oLdjxpiG7q/5n7duEd3T8Wej3ulewf2Re/ranRvbNyvv7+yCW1SNo0eSDpw5ZuAb9qb7Zp3tXBaKg7CQeXBJ9+mfHvjUOihzsPcw83fmX+39QjrSHkr0jq/dawto22gPaG97+iMo50dXh1Hvrf/fu8x42N1xzWPV56gnSg98fnkgpPjp2Snnp1OPz3Umdx590z8mWtdUV29Z0PPnj8XdO5Mt1/3yfPe549d8Lxw9CL3Ytslt0utPa49R35w/eFIr1tv62X3y+1XPK509E3rO9Hv03/6asDVc9f41y5dn3m978bsG7duJt0cuCW69fh29u0XdwruTNxdeo94r/y+2v3qB/oP6n+0/rFlwG3g+GDAYM/DWQ/vDgmHnv6U/9OH4dJHzEfVI0YjjY+dHx8bDRq98mTOk+GnsqcTz8p+Vv9563Or59/94vtLz1j82PAL+YvPv655qfNy76uprzrHI8cfvM55PfGm/K3O233vuO+638e9H5ko/ED+UPPR+mPHp9BP9z7nfP78L/eE8/sl0p8zAAAAIGNIUk0AAHolAACAgwAA+f8AAIDpAAB1MAAA6mAAADqYAAAXb5JfxUYAAAMOSURBVHjaXJNdaJRHFIbfM7PfGremUTfkpxgpiheiBOmFtYUgRXNRqNnd75sEhBoIKhrwQpFUUSsihhIQ41+FNrUGqYhRY43STZqgARNRTIzRaFqz6xJTtals3K8xRQ3x7UV215+LB2bOxTNn3jMDs+mEIgmS+LwQiqSQ9JG03FHX54666pn7TLmJEZVIjCCRGMkYGxvNiI9FvaENZzLw/PmqtCDFV/4WkERw8TI03K6XqqrNWLBgPoafDmNwMCbd3TestpMDHpJAuIcWSZjSUrnS0SFOWamXJLpuDYAkAiYAkioYDCIej0+Lx12QrervFxOemjWfCvIyIcmTVeLVC1986OkUklhRtlgutLYrkpnOKlt1dl0BSfTHmnCnm5oTm0AS6I0xLaDLrK1PusTp/cb7/rUAyH8kSL+Vqt0ebpuGP699LCRROAdqf/suGforCpLi4DMpAOQQLAEgfE2sRDZIv5cknGxi74HDFnZ/32olk9f//vOTPIj05ZnKZpp14QlnfZgpTOXvNGsvjrvuH9MnOwAOYlhQ/UPYmxRkJVvzPHw8JF8EdrKoZEeapSt2cHDo4Sxn7R0hiV8/hEQe3Ad21jZNJQnbDklSBBas0ddvRj2Fi4qZIhaL+Q3ni8N0ZohGe4Dv6sKZfFP0kvkSWLZdGvLpiUTuTS9cVMxI5H5+fz+UfXyOto/Ns5bUL7dyjsBjTsKDbbVnM0iqYNHXYi9ZLiSlaRbFn089zlzvwN1IzkDlmDhfdiin5KgOBY5qO9iojX1K9+VRcOCXnlySsFkOkjj/WGschtR0Kt/Ga9D2aYj5DWKaIeYSxTlFMS2T66udBDbXHS94Z97ZUB8Ayt7+iVVddlkzl5LCvrklvQ9dr1fnF0IQbng5O/VQsmAJSfnxSLuqCG3Rxxpfz3xbXv0IEkzm5YR7lXOCGs6+PVNJYjaQnoKwSgBIDSqkjjPUuv3QLP9ImW+hG1/lKJtzp5jaCmW2nrNAUpOUkqrWrJUb23T5rhZf0eoWhbeEKX7O4eTPHe8DSTjF59T/AwCfnhbaDaIICgAAAABJRU5ErkJggg=="}function S(t){return r&&t&&"="===t[0]}function Ct(t,n,e,i){var r,o,a,u,n,s,c,e,r=m,o=m,a=m,u=m;return S(n)?r=d(n,"="):o=n,S(e)?a=d(e,"="):u=e,n=m,6===t&&((s=h(1,3,o,r)).integerValue(i),(c=h(1,5,u,a)).integerValue(i),n=h(0,1,m,m,m,m,m,s,c)),7===t&&((s=h(1,4,o,r)).integerValue(i),(c=h(1,2,u,a)).integerValue(i),n=h(0,0,m,m,m,m,m,s,c)),0<=t&&t<=5&&(n=h(1,t,o,r)).integerValue(i),(e=new y(n)).type(i?1:2),e.comparisonOperator(t),e}function St(t,n,e,i,r){var o,a,u,s,n,c,f,l,e,o=m,a=m,u=m,s=m;if(S(n)?o=d(n,"="):a=n,S(e)?u=d(e,"="):s=e,n=m,6===t&&(c=h(i,5,a,o),f=h(i,3,s,u),n=h(0,1,m,m,m,m,m,c,f)),7===t&&(c=h(i,2,a,o),f=h(i,4,s,u),n=h(0,0,m,m,m,m,m,c,f)),0<=t&&t<=5){switch(t){case 0:l=0;break;case 1:l=1;break;case 2:l=4;break;case 3:l=5;break;case 4:l=2;break;case 5:l=3}n=h(i,l,a,o)}return(e=new y(n)).type(r),e.comparisonOperator(t),e}function Tt(t,n,e){return St(t,n,e,5,4)}function At(t,n,e){return St(t,n,e,13,5)}function It(t,n,e){var i,r,o,a,n,u,s,e,i=m,r=m,o=m,a=m;return S(n)?i=d(n,"="):r=n,S(e)?o=d(e,"="):a=e,n=m,6===t&&(u=h(7,3,r,i),s=h(7,5,a,o),n=h(0,1,m,m,m,m,m,u,s)),7===t&&(u=h(7,4,r,i),s=h(7,2,a,o),n=h(0,0,m,m,m,m,m,u,s)),0<=t&&t<=5&&(n=h(7,t,r,i)),(e=new y(n)).type(6),e.comparisonOperator(t),e}function xt(t){var t;return r?((t=new y(h(4,m,m,d(t,"="),4))).type(7),t):m}function Nt(t){var t;return r?((t=new y(e.Condition.fromFormula(t))).type(3),t):m}function kt(t){var t=new y(e.Condition.fromSource(t));return t.type(3),t}function Dt(t){return this.JS(t)}function _t(t,n){if(t&&n&&n.length)return n.map(Dt.bind(t))}function Et(t,n,e){var i,r,o,i=t.rowCount,r=t.colCount,o=g(t.row,t.col,i,r);return 0===t.row&&i===n&&(o.row=-1),0===t.col&&r===e&&(o.col=-1),o}function jt(t,n){var e=t.getRowCount(),i=t.getColumnCount();return n.map(function(t){return Et(t,e,i)})}function Ot(t,n){var e,t,e=t.cellCache;return e||(t.cellCache=e={}),(t=e[n])||(e[n]=t={}),t}function Rt(r,t,n,o,a,u,s){var c,f,l,h,d,e,i,v,m,g,p,b,y,w,M,c=o.h6t,f=r.row,l=r.col,h=r.rowCount,d=r.colCount,e=f+h,i=l+d;if(t<=e-1&&(h=t-f),n<=i-1&&(d=n-l),e===t)for(v=function(t,n){var e,i,e,e=c.colCache;e||(c.colCache=e={}),(i=e[n])||(e[n]=i={}),(e=i.dv)&&e!==a&&e.FX(r,o),i.dv=a,i.cacheStartRowIndex=f,(_(i.cacheRowCount)||!0===s&&a.smt().some(function(t){return t.intersect(u,n,1,1)}))&&(i.cacheRowCount=h)},m=0,g=l;m<d;m++,g++)v(m,g);else if(i===n)for(p=function(t,n){var e,i,e,e=c.rowCache;e||(c.rowCache=e={}),(i=e[n])||(e[n]=i={}),(e=i.dv)&&e!==a&&e.FX(r,o),i.dv=a,i.cacheStartColIndex=l,(_(i.cacheColCount)||!1===s&&a.smt().some(function(t){return t.intersect(n,u,1,1)}))&&(i.cacheColCount=d)},b=0,y=f;b<h;b++,y++)p(b,y);else for(b=0,y=f;b<h;b++,y++)for(w=Ot(c,y),m=0,g=l;m<d;m++,g++)(M=w[g])&&M!==a&&M.FX(r,o),w[g]=a}function Bt(t,n){var e,i,r,o,a,u,s,c,f,l,h,d,v,m,g,p,b,y,m,g,w,M,C,S,T,A,C,S,I,x,N,k,e=n.h6t,i=t.row,r=t.col,o=t.rowCount,a=t.colCount,u=n.eJ,s=u.getRowCount(),c=u.getColumnCount(),f=e.colCache,l=e.rowCache,h=e.cellCache;if(f)for(d=r;d<r+a;d++)if(m=(v=f[d])&&v.cacheStartRowIndex,g=v&&v.cacheRowCount,v&&m<=i&&i<m+g){if(p=!1,i<s){for(b=m;b<=i;b++)y=Ot(e,b),b<i&&(y[d]=v.dv);(g=i+o)-(m=v.cacheStartRowIndex)===v.cacheRowCount?f[d]=E:(v.cacheStartRowIndex=g,v.cacheRowCount-=g-m),p=!0}else i+o===s&&(p=!(f[d]=E));p&&(w=v.dv)&&w.FX(t,n)}if(l)for(M=i;M<i+o;M++)if(C=(y=l[M])&&y.cacheStartColIndex,S=y&&y.cacheColCount,y&&C<=r&&r<C+S){if(p=!1,r<c){for(T=C;T<=r;T++)A=Ot(e,M),T<r&&(A[T]=y.dv);(S=r+a)-(C=y.cacheStartColIndex)===y.cacheColCount?l[M]=E:(y.cacheStartColIndex=S,y.cacheColCount-=S-C),p=!0}else r+a===c&&(p=!(l[M]=E));p&&(w=y.dv)&&w.FX(t,n)}if(h)for(M=0,I=i,x=o;M<x;M++,I++)if(y=h[I])for(d=0,N=r,k=a;d<k;d++,N++)(w=y[N])&&w.FX(t,n),y[N]=E}function Lt(t){switch(t){case"none":return c.anyValue;case"whole":return c.wholeNumber;case"decimal":return c.decimalValues;case"list":return c.list;case"date":return c.date;case"time":return c.time;case"textLength":return c.textLength;case"custom":return c.custom}}function Ft(t){var n,e,i,n=[];if(t)for(e in t)(i=t[e])&&n.push(i);return n}function T(t){this.eJ=t,this.YB={},this.h6t={},this.d6t=[]}function Pt(t){return t="string"==typeof t?'"'+t+'"':t}function Gt(t){var n=t.D5;return _(n)?(n=t.expected(),Pt(z(n))):n}function Ut(t){var n,e,i;return _(t)?m:0===(n=t.conType())?Ht(t):1===n||7===n?(i=t.formula(),{firstFormula:i=_(i)?t.expected():i}):4===n?{firstFormula:_(t.formula())?t.expected():t.formula()}:12===n||5===n||13===n?{firstFormula:Gt(t)}:{firstFormula:m}}function Ht(t){var n,e;return _(t)?m:(e=n=m,{firstFormula:n=t.item1()?(0===t.item1().conType()?Ht:Ut)(t.item1()).firstFormula:n,secondFormula:e=t.item2()?(0===t.item2.conType?Ht:Ut)(t.item2()).firstFormula:e})}function zt(t){var n,n,n=typeof t;return"string"==n||"number"==n?H(t.toString()):_(t)||_((n=t).item1)?"":zt(n.item1)}function A(t,n){var e,n;if(!_(t))return e=t,n=+(e=n&&S(t)?t.substr(1):e),isNaN(n)?t:n}function Vt(t){var n=t.row,e=t.col,i=t.rowCount,t=t.colCount;return-1===n&&-1===e?e=0:(-1!==n&&-1!==i&&n+i>x.MAX_ROW_COUNT&&(i=x.MAX_ROW_COUNT-n),-1!==e&&-1!==t&&e+t>x.MAX_COLUMN_COUNT&&(t=x.MAX_COLUMN_COUNT-e)),g(n,e,i,t)}function Yt(t){var t=t.map(Vt);return v.rangesToFormula(t,0,0,15,!1).split(", ").join(" ")}Object.defineProperty(t,"__esModule",{value:!0}),t.createListValidator=t.createFormulaListValidator=t.createFormulaValidator=t.createTextLengthValidator=t.createTimeValidator=t.createDateValidator=t.createNumberValidator=t.kf=t.Hrt=t.DefaultDataValidator=t.HighlightPosition=t.HighlightType=t.ErrorStyle=t.DataValidationResult=t.CriteriaType=void 0,a=n("Common"),x=n("Core"),e=n("ConditionalFormatting"),v=n("SheetsCalc"),n=n("CalcEngine"),i=a.Common.ct,f=x.UsedRangeUtil.vh,L=x.UsedRangeUtil.hh,N=x.XFileConstants.Au,k=x.XFileConstants.Ou,D=x.XFileConstants.Ru,F="1",r=!!n,h=e.aJ,d=a.Common.zf.cJ,_=a.Common.lt.ht,o=a.Common.lt.tv,P=i.o0,s=x.GC$,m=null,E=void 0,i=(n=x.mt).p0,G=n.T1,U=n.G0,H=n.t1,j=n.e1,z=n.i1,O=n.vo,l=n.n1,V=n.g1,Y=n.b1,Z=n.p1,W=x.Util.mr,R=x.Util.addXLFNPrefix,Q=x.Util.pr,B=n.xr,J=n.C1,K=n.Lue,X=n.c1,q=x.range_parser.Dc,$=x.range_parser.Oc,g=x.Ec,p=Math.min,b=Math.max,tt=a.Common.ct,u=".validator",it={type:0,color:n="red"},rt={type:nt=1,color:n,position:1},ot={type:2,color:n,position:et=5,image:null},(n=at=at||{})[n.none=0]="none",n[n.whole=1]="whole",n[n.decimal=2]="decimal",n[n.list=3]="list",n[n.date=4]="date",n[n.time=5]="time",n[n.textLength=6]="textLength",n[n.custom=7]="custom",(n=ut=ut||{})[n.stop=0]="stop",n[n.warning=1]="warning",n[n.information=2]="information",st={0:"equal",1:"notEqual",2:"greaterThan",4:"lessThan",3:"greaterThanOrEqual",5:"lessThanOrEqual",6:"between",7:"notBetween"},ct={equal:0,notEqual:1,greaterThan:2,greaterThanOrEqual:3,lessThan:4,lessThanOrEqual:5,between:6,notBetween:7},n=window,(w=c=t.CriteriaType||(t.CriteriaType={}))[w.anyValue=0]="anyValue",w[w.wholeNumber=1]="wholeNumber",w[w.decimalValues=2]="decimalValues",w[w.list=3]="list",w[w.date=4]="date",w[w.time=5]="time",w[w.textLength=6]="textLength",w[w.custom=7]="custom",(w=ft=t.DataValidationResult||(t.DataValidationResult={}))[w.forceApply=0]="forceApply",w[w.discard=1]="discard",w[w.retry=2]="retry",(w=lt=t.ErrorStyle||(t.ErrorStyle={}))[w.stop=0]="stop",w[w.warning=1]="warning",w[w.information=2]="information",(w=ht=t.HighlightType||(t.HighlightType={}))[w.circle=0]="circle",w[w.dogEar=1]="dogEar",w[w.icon=2]="icon",(w=dt=t.HighlightPosition||(t.HighlightPosition={}))[w.topLeft=0]="topLeft",w[w.topRight=1]="topRight",w[w.bottomRight=2]="bottomRight",w[w.bottomLeft=3]="bottomLeft",w[w.outsideLeft=4]="outsideLeft",w[w.outsideRight=5]="outsideRight",vt=["errorStyle","ignoreBlank","preciseCompareDate","inCellDropdown","showInputMessage","showErrorMessage","inputTitle","errorTitle","inputMessage","errorMessage","comparisonOperator","type","condition"],C.prototype.value1=function(t,n){var e,e,t,e=this.condition(),e=e&&e.item1()?e.item1():e;return e?(t=e.formula(t,n))&&0<t.length?"="+d(s.trim(t.toString()),"="):e.expected():m},C.prototype.value2=function(t,n){var e,e,t,e=this.condition(),e=e&&e.item2()?e.item2():e;return e?(t=e.formula(t,n))&&0<t.length?"="+d(s.trim(t.toString()),"="):e.expected():m},C.prototype.isValid=function(t,n,e,i,r){var o,a,u,s,c,r,o=this,a=o.condition(),u=_(r)||!0===r;if(a){if(o.ignoreBlank()&&(_(i)||""===i))return!0;if(c=void 0,!_(s=i))switch(o.type()){case 0:return!0;case 2:case 1:c=u?gt(i):i,_(c)||(s=c);break;case 4:case 5:c=u?pt(i):i,_(c)||(s=c)}t&&(t.EJ=!0),r=void 0;try{r=a.evaluate(t,n,e,s,s)}catch(t){r=!0}finally{t&&(t.EJ=!1)}return r}return!0},C.prototype.reset=function(){var t=this;t.errorStyle(0),t.ignoreBlank(!0),t.preciseCompareDate(!1),t.inCellDropdown(!0),t.showInputMessage(!0),t.showErrorMessage(!0),t.inputTitle(""),t.errorTitle(""),t.inputMessage(""),t.errorMessage(""),t.comparisonOperator(6),t.type(0),t.condition(m),t._S.length=0},C.prototype.getValidList=function(t,n,e){var i=this.condition();return i!==m&&3===this.type()&&12===i.conType()?i.getValidList(t,n,e):m},C.prototype.highlightStyle=function(t){var n,e,i,r,n=this;if(0===arguments.length)return n.l6t;if(!_(t)){if(n.l6t.type!==t.type)switch(e=t.type){case 1:n.l6t=o(rt);break;case 2:n.l6t=o(ot);break;default:n.l6t=o(it)}for(r in i=n.l6t)i.hasOwnProperty(r)&&t.hasOwnProperty(r)&&(i[r]=t[r]);return n.Mf&&n.Mf.repaint(),n}},C.prototype.toJSON=function(e){var i,r,t,i=this,r={};return vt.forEach(function(t){var n=i[t]();i[t].isDefault(n)||(r[t]=n&&n.toJSON?n.toJSON(e):n)}),t=i._S.map(Vt),r.ranges=v.rangesToFormula(t,0,0,15,!1),r.highlightStyle=JSON.stringify(i.l6t),s.isEmptyObject(r)?E:r},C.prototype.fromJSON=function(r,o,a){var u,t,n,e,t;r&&!s.isEmptyObject(r)&&(u=this,r.ranges&&(u._S=v.formulaToRanges(a,r.ranges,0,0,!0)[0].ranges),r.highlightStyle&&(u.l6t=JSON.parse(r.highlightStyle)),vt.forEach(function(t){var n,e,i,n=r[t];G(n)&&("condition"===t?((e=h()).fromJSON(r.condition,a,o),u.condition(e,!1),(i=e.ranges())&&i.length?u._S=i:e.ranges(u._S),e.context(a)):u[t](n,!1))}),t=r.validatorInfo)&&(n=a.Lp.useR1C1,e=yt(r.type,t),t=t.operator,e&&(e.ranges(u._S),e.ignoreBlank(u.ignoreBlank()),e.context(a),n&&U(e),u.condition(e)),_(t)||u.comparisonOperator(t))},C.prototype.clone=function(t){var n,n;return this.ZB?((n=this.condition())&&n.initExpression(),this):((n=new C).fromJSON(this.toJSON(t),!1,t||this.Mf),n._S=[],n)},C.prototype.context=function(t){var n;return t&&(this.DJ=t,n=this.condition())&&(n.ranges(this._S),n.context(t)),this.DJ},C.prototype.v6t=function(t){var n,e;if(t){for(n=this._S,e=0;e<n.length;e++)if(n[e].containsRange(t))return;n.push(t)}},C.prototype.FX=function(t,n){var e,i,r,o,a,u,s,c,t,f,e=this,i=e._S;t&&i.length&&(r=t.row,o=t.col,a=t.rowCount,u=t.colCount,c=!(s=[]),t=e.Mf,f=t&&[t.getRowCount(),t.getColumnCount()],i.forEach(function(t){var t=wt(t,r,o,a,u,f);t.c6t&&(c=!0),s.push(t)}),e._S=[].concat.apply([],s),c)&&n.m6t(e)},C.prototype.smt=function(){return this._S},C.prototype.XJ=function(){var t=this;t.condition()&&t.condition().initExpression()},C.prototype.g6t=function(t){this.condition()&&this.condition().ranges(t)},C.prototype.qJ=function(t,n,e){var i,r,o,a,u,s,c,f,l,s,h,d,v,i=this,r=!1;for(i.XJ(),a=0,u=(o=i._S).length;a<u;a++)c=(s=o[a]).row,f=s.rowCount,l=s.col,s=s.colCount,h=c===t.row&&f===t.rowCount&&t.col<=l&&s<=t.colCount,d=c===n.row&&f===n.rowCount&&n.col<=l&&s<=n.colCount,(v=h||d)&&(o[a]=g(c,l,f+e,s),r=!0);return r&&i.g6t(o),r},C.prototype.JO=function(t,n,e,i){var r,o,a,u,s,c,f;if(!(t<0||n<=0)){for(this.condition()&&this.condition().initExpression(),r=0;r<this._S.length;r++)if(a=(o=this._S[r]).row,e&&0<e.length){for(u=!1,s=0,c=e.length;s<c;s++)if((f=e[s])&&(!0!==i||f.containsRange(o))){if(f.row===a&&f.row+f.rowCount-n===a+o.rowCount&&a===t){o.rowCount+=n,u=!0;break}t<=a&&(o.row+=n)}if(u)break}else t<=a?o.row+=n:t<=a+o.rowCount&&(o.rowCount+=n);this.condition()&&this.condition().ranges(this._S)}},C.prototype.xP=function(r,o){var a;r<0||o<=0||(this.condition()&&this.condition().initExpression(),a=[],this._S.forEach(function(t){var n,e,i,n=t.row,e=t.rowCount;r<n?((i=r+o-n)<=0?n-=o:(n-=i,t.rowCount-=i),n<0&&(t.rowCount+=n,n=0),t.row=n):n<=r&&r<n+e&&(t.rowCount-=p(o,n+e-r)),(0<t.rowCount||-1===t.row&&-1===t.rowCount)&&a.push(t)}),this._S=a,this.condition()&&this.condition().ranges(this._S))},C.prototype.qO=function(t,n,e){var i,r,o,a,u,s,c,f;if(!(t<0||n<=0)){for(this.condition()&&this.condition().initExpression(),i=0;i<this._S.length;i++){if(r=this._S[i],e&&0<e.length){for(a=o=!1,u=0,s=e.length;u<s;u++)if((c=e[u])&&!c.containsRange(r))o=!0;else if(c&&c.col===r.col&&c.col+c.colCount-n===r.col+r.colCount&&c.col===t){r.colCount+=n,a=!0;break}if(o)continue;if(a)break}t<=(f=r.col)?r.col+=n:t<=f+r.colCount&&(r.colCount+=n)}this.condition()&&this.condition().ranges(this._S)}},C.prototype.NP=function(r,o){var a;r<0||o<=0||(this.condition()&&this.condition().initExpression(),a=[],this._S.forEach(function(t){var n,e,i,n=t.col,e=t.colCount;r<n?((i=r+o-n)<=0?n-=o:(n-=i,t.colCount-=i),n<0&&(t.colCount+=n,n=0),t.col=n):n<=r&&r<n+e&&(t.colCount-=p(o,n+e-r)),(0<t.colCount||-1===t.col&&-1===t.colCount)&&a.push(t)}),this._S=a,this.condition()&&this.condition().ranges(this._S))},C.prototype.rv=function(t,n,e,i){var r,o,a,u,o,a,s,c,f,e,a,r=this;e?((o=B(t,"sqref"))&&(a=v.formulaToRanges(n,o.c_[0],0,0,!0)[0].ranges),r._S=a):r._S=v.formulaToRanges(n,t.sqref,0,0,!0)[0].ranges,u=Lt(t.type),o=ct[t.operator],_(u)||r.type(u),_(o)&&(o=6),r.comparisonOperator(o),"1"===t.allowBlank?r.ignoreBlank(!0):r.ignoreBlank(!1),_(t.error)||r.errorMessage(l(t.error)),_(t.errorTitle)||r.errorTitle(l(t.errorTitle)),_(t.errorStyle)||r.errorStyle(lt[t.errorStyle]),_(t.prompt)||r.inputMessage(l(t.prompt)),"1"===t.showDropDown&&r.inCellDropdown(!1),_(t.promptTitle)||r.inputTitle(l(t.promptTitle)),"1"!==t.showErrorMessage&&r.showErrorMessage(!1),"1"!==t.showInputMessage&&r.showInputMessage(!1),(a=t.c_)&&0<a.length&&(e?a.forEach(function(t){var n;t&&(n=B(t,"f"),f=l(n&&n.c_[0]),"formula1"===t.n_&&(s=M(f,u)),"formula2"===t.n_)&&(c=M(f,u))}):a.forEach(function(t){t&&(f=l(X(t)),"formula1"===t.n_&&(s=M(f,u)),"formula2"===t.n_)&&(c=M(f,u))})),_(u)||(e=void 0,1===u||2===u?e=Ct(o,A(s,i),A(c,i),1===u):3===u?(f=s||c)&&(e='"'===f[0]&&'"'===f[f.length-1]?kt(Z(f)):Nt(V(f))):4===u||5===u?e=(5===u?At:Tt)(o,s,c):6===u?e=It(o,A(s,i),A(c,i)):7===u&&void 0!==s&&(e=xt(s)),e&&(a=e.condition())&&(a.ranges(r._S),a.ignoreBlank(r.ignoreBlank()),a.context(n),r.condition(a))),r.Mf=n,t.lossless&&t.lossless.highlightStyle&&(r.l6t=JSON.parse(t.lossless.highlightStyle))},C.f6t=1,y=C,t.DefaultDataValidator=y,w={errorStyle:i("errorStyle",0),ignoreBlank:i("ignoreBlank",!0,function(t){this.condition()&&this.condition().ignoreBlank(t)}),preciseCompareDate:i("preciseCompareDate",!1,function(t){this.condition()&&this.condition().preciseCompareDate(t)}),inCellDropdown:i("inCellDropdown",!0),showInputMessage:i("showInputMessage",!0),showErrorMessage:i("showErrorMessage",!0),inputTitle:i("inputTitle",""),errorTitle:i("errorTitle",""),inputMessage:i("inputMessage",""),errorMessage:i("errorMessage",""),comparisonOperator:i("comparisonOperator",6),condition:i("condition",m),type:i("type",0)},s.extend(y.prototype,w),t.Hrt=Mt,t.kf=S,t.createNumberValidator=Ct,t.createDateValidator=Tt,t.createTimeValidator=At,t.createTextLengthValidator=It,t.createFormulaValidator=xt,t.createFormulaListValidator=Nt,t.createListValidator=kt,s.extend(x.Worksheet.prototype,{getDataValidator:function(t,n,e){var t=this.hG(t,n,e);return t?t[0]:E},hG:function(t,n,e){return 3===(e=_(e)?3:e)?this.b8.p6t(t,n):E},setDataValidator:function(t,n,e,i,r,o){var a,u,s,c,e,i,a=this,u=a.b8;arguments.length<5&&(r=e,o=i,e=-1===t?-1:1,i=-1===n?-1:1),3===(o=_(o)?3:o)&&(s=a.getDataValidator(t,n,o),(c=1===e&&1===i)&&s===r||(a.Ut.b6t(),e=g(t,n,e,i),u.y6t(e),r&&u.w6t(r,e),a.Ut.b6t(!0),i="validator",c&&(a.Rj(i,t,n,o,s,r),a.ki(x.Events.WorksheetDataChanged,{type:"dataValidation"}),-1!==t&&-1===n?a.dj(t,o,i,r,s):-1===t&&-1!==n&&a.vj(n,o,i,r,s)),a.zw()))},isValid:function(t,n,e,i){var r,o,r=this;try{if(r.Ubt=t,r.Hbt=n,r.zbt=e,r.Gbt=!0,o=r.getDataValidator(t,n))return o.isValid(r,t,n,e,i)}finally{r.Ubt=-1,r.Hbt=-1,r.zbt=m,r.Gbt=!1}return!0},G1:function(){var t,n,e,n,n,t=this;return!(t.M6t||(t.M6t=!0,(n=t.KD)&&((e=n.parentNode)&&e.removeChild(n),t.KD=m),(n=t.a6t)&&(s(n).unbind("click"),(e=n.parentNode)&&e.removeChild(n),t.a6t=m),(n=t.gf)&&(s(n).unbind("keydown").unbind("blur").unbind("click").unbind("change"),(e=n.parentNode)&&e.removeChild(n),t.gf=m),t.M6t=!1))},xyt:function(){var t,n,e,i,r,o,a,t=this,n=[],e=t.b8,i=e&&e.YB;if(i)for(r in i)(a=(o=i[r])&&o.condition())&&a.getExpressions&&0<a.getExpressions().length&&n.push({validator:o,sheet:t});return n}}),s.extend(x.Workbook.prototype,{xyt:function(){var n,t,e,n=[],t,e;return this.sheets.forEach(function(t){var t=t.xyt();t&&t.length&&t.forEach(function(t){n.push(t)})}),n}}),s.extend(x.CellRange.prototype,{validator:function(t){var n,e,i,r,o,a,u,n=this,e=n.sheet,i=n.sheetArea,r=n.row,o=n.col,a=n.rowCount,u=n.colCount;return 0===arguments.length?e.getDataValidator(r,o,i):(e.setDataValidator(r,o,a,u,t,i),n)}}),T.prototype.getUsedRange=function(){var t,n,e,i,r,o,a,u,s,c,t,n=this.p6t(),e={};if(n)for(i=void 0,r=0,o=n;r<o.length;r++)for(u=0,s=i=(a=o[r]).smt();u<s.length;u++)c=s[u],f(e,L(c));return e},T.prototype.L0=function(){this.eJ=m},T.prototype.GJ=function(t){return _t(this.eJ,t)},T.prototype.OX=function(t){return jt(this.eJ,t)},T.prototype.C8=function(t,n,e){var i,r,o,a,i=this,r=i.YB;if(_(n)?i.h6t={}:i.h6t.cellCache={},r)for(o in r)(a=r[o])&&(t&&delete a.C6t,i.fE(a,!0,n,e));i.S6t()},T.prototype.m6t=function(t){var n=this.d6t;-1===n.indexOf(t)&&n.push(t)},T.prototype.fE=function(n,t,e,i){var r=this,o=r.GJ(n.smt()),a=r.eJ,u=a.getRowCount(),s=a.getColumnCount();o&&(r.d6t.length=0,o.forEach(function(t){Rt(t,u,s,r,n,e,i)}),t||r.S6t())},T.prototype.RX=function(t){var n=this,t=n.GJ(t.smt());n.d6t.length=0,t.forEach(function(t){Bt(t,n)}),n.S6t()},T.prototype.BX=function(t){var n=this;t&&Bt(n.eJ.JS(t),n),n.S6t()},T.prototype.S6t=function(){var t,n,t=this.d6t;t.length&&(n=this.YB,t.forEach(function(t){t.smt().length?t.condition()&&t.condition().ranges(t.smt()):(delete n[t.id],delete t.Mf)}),t.length=0)},T.prototype.w6t=function(t,n){var e=this,i=e.eJ;if(n&&((t=t.Mf&&i!==t.Mf?t.clone(i):t).Mf=i,t.v6t(n)),i)return t.context(i),e.YB[t.id]=t,e.fE(t),t},T.prototype.y6t=function(t){var n,e;t&&(e=(n=this).eJ,n.BX(t),e.zw())},T.prototype.d5=function(){var t=this,n;t.eJ&&(t.YB={},t.C8())},T.prototype.p6t=function(t,e){var n,i,r,n,o,i,i,i,i,i,n=this,i=n.YB;return 0===arguments.length||(r=[],n=n.h6t,e===E&&(e=-1),-1===(t=t===E?-1:t)&&-1===e)?Ft(i):((i=(i=n.colCache)&&i[e])&&(t>=i.cacheStartRowIndex&&t<i.cacheStartRowIndex+i.cacheRowCount||-1===t&&0===i.cacheStartRowIndex)?r.push(i.dv):(i=(i=n.rowCache)&&i[t])&&(e>=i.cacheStartColIndex&&e<i.cacheStartColIndex+i.cacheColCount||-1===e&&0===i.cacheStartColIndex)?r.push(i.dv):(i=n.cellCache)&&(-1!==t&&-1!==e?(o=i[t])&&o[e]&&r.push(o[e]):-1===t?s.each(i,function(t,n){var n=n[e];n&&-1===r.indexOf(n)&&r.push(n)}):(o=i[t])&&s.each(o,function(t,n){n&&-1===r.indexOf(n)&&r.push(n)})),r)},T.prototype.qJ=function(t,n,e){var i,r,o,a,u,s,c,i=this,r,o=i.eJ.Ut,a=i.YB,u=!1;if(!_(a)){for(s in o.b6t(),a)(c=a[s])&&c.qJ(t,n,e)&&(u=!0);u&&i.C8()}},T.prototype.$J=function(t,n,e,i,r){var o,a,u,s,o=this,a=o.YB;if(a)for(u in a)(s=a[u])&&(e?s.JO(t,n,i,r):s.qO(t,n,i));o.C8(E,t,e)},T.prototype.JO=function(t,n,e,i){this.$J(t,n,!0,e,i)},T.prototype.qO=function(t,n,e){this.$J(t,n,!1,e)},T.prototype.tX=function(t,n,e){var i,r,o,a,i=this,r=i.YB;if(r)for(o in r)(a=r[o])&&(e?a.xP(t,n):a.NP(t,n),0===a._S.length)&&(r[o]=E);i.C8()},T.prototype.xP=function(t,n){this.tX(t,n,!0)},T.prototype.NP=function(t,n){this.tX(t,n,!1)},T.prototype.toJSON=function(t){var n,e,i,r,n=this.YB,e=[];for(i in n)(r=n[i])&&e.push(r.toJSON(t));return e},T.prototype.fromJSON=function(t,e,i){var r=this,o=r.eJ;r.YB={},t&&t.length&&(t.forEach(function(t){var n=new y;n.fromJSON(t,e,i),n.Mf=o,r.YB[n.id]=n}),r.C8())},T.prototype.y8=function(t,n,e){this.eJ.setDataValidator(t,n,e)},mt=T,s.extend(x.Y8.prototype,{b6t:function(t){var n,e,i,r,o,a,u,n=this,e=n.G8;if(e&&(t||!e.originalValidators)){for(o in r=[],i=n.b8.YB)(a=i[o])&&(u=a._S.map(function(t){return g(t.row,t.col,t.rowCount,t.colCount)}),r.push({validator:a,ranges:u}));t?e.currentValidators=r:e.originalValidators=r}},T6t:function(t){var i,n,r;t&&(i=this.Mf,n=this.b8,r={},t.forEach(function(t){var n,e,n=t.validator;"Object"===n.constructor.name&&((e=new y).fromJSON(n,!1,i),n=e),n._S=t.ranges,n.condition()&&n.condition().ranges(n._S),r[n.id]=n}),n.YB=r,n.C8(!1))},ATt:function(t,n,e,i){this.b6t(),this.b8.JO(t,n,e,i),this.b6t(!0)},A6t:function(t,n){this.b6t(),this.b8.xP(t,n),this.b6t(!0)},NTt:function(t,n,e){this.b6t(),this.b8.qO(t,n,e),this.b6t(!0)},kTt:function(t,n){this.b6t(),this.b8.NP(t,n),this.b6t(!0)},I6t:function(t){this.b6t(),this.b8.BX(t),this.b6t(!0)},x6t:function(){this.b6t(),this.b8.C8(),this.b6t(!0)}}),x.Y8.ch("validator",{init:function(){this.b8=new mt(this.Mf)},applyChanges:function(t){var n,t,t,n=t.changes,t=t.isUndo;n&&(t=t?n.originalValidators:n.currentValidators)&&this.T6t(t)},undo:function(t){var t=t.originalValidators;t&&this.T6t(t)},dispose:function(t){var n;!1!==(t&&t.clearCache)&&this.b8&&(this.b8.L0(),this.b8=m)}}),x.Worksheet.ch("validator",{getUsedRange:function(t){var n,e,i;t.type&x.UsedRangeType.dataValidation&&(i=(e=(n=this).b8).getUsedRange(),f(t.range,i))},init:function(){var e=this;e.b8=e.Ut.b8,e._3(x.Events.FloatingElementSelected+u),e.D3(x.Events.FloatingElementSelected+u,function(t,n){"worksheet"!==n.type&&e.G1()})},dispose:function(t){var n=this;n.G1(),t.clearCache&&n.b8.d5(),!1!==t.clearCache&&n._3(x.Events.FloatingElementSelected+u)},onLayoutChanged:function(t){var n,e,i,r,o,a,u,s,c,n=t.changeType,e=t.row,i=t.rowCount,r=t.col,o=t.colCount,a=t.sheetArea,u=_(a)||3===a,s=this.Ut,c=this.tables;"addRows"===n&&u?s.ATt(e,i,c&&c.AJ(e,-1,i,-1,!0)):"deleteRows"===n&&u?s.A6t(e,i):"addColumns"===n&&u?s.NTt(r,o,c&&c.AJ(-1,r,-1,o,!1)):"deleteColumns"===n&&u?s.kTt(r,o):"clear"===n?3===a&&2==(2&t.type)&&s.I6t(g(e,r,i,o)):"setColumnCount"!==n&&"setRowCount"!==n||3!==a&&1!==a||s.x6t()},toJson:function(t,n){var e,n,n,e=this.b8,n=n&&n.ignoreStyle;e&&!n&&(n=e.toJSON(this))&&n.length&&(t.validations=n)},fromJson:function(t,n,e){var e,e,e=e&&e.ignoreStyle;t&&t.validations&&!e&&(e=t.validations,this.b8.fromJSON(e,n,this))},wh:function(t,n,e){var i,r,o,a,u,e,s,c,f,l,h,d,v,m,g,p,b,y,w,M,C,S,T,m,g,p,b,y,w,M,C,A,I,i=this,r=i.b8,o=e&&!1===e.includeStyles,a=e&&e.fileType===x.OpenSaveFileType.excel;if(!o&&r&&!i.NMi){for(l in u=r.YB,s=(e={n_:k,c_:[]}).c_,c=0,f=[],u)if((h=u[l])&&h._S&&0<h._S.length){if(c++,v=!(d={n_:D}),m=h.comparisonOperator(),g=h.ignoreBlank(),p=h.errorMessage(),b=h.errorTitle(),y=h.errorStyle(),w=h.inputMessage(),M=h.inCellDropdown(),C=h.inputTitle(),S=h.showErrorMessage(),T=h.showInputMessage(),6!==m&&(d.operator=st[m]),!1!==g&&(d.allowBlank="1"),p&&(d.error=O(Q(p))),b&&(d.errorTitle=O(b)),0!==y&&(d.errorStyle=ut[y]),w&&(d.prompt=O(Q(w))),!1===M&&(d.showDropDown="1"),C&&(d.promptTitle=O(C)),!1!==S&&(d.showErrorMessage="1"),!1!==T&&(d.showInputMessage="1"),m=h.condition(),g=h._S,d.sqref=Yt(g),m){if(p=h.type(),d.type=at[p],y=(b=Ut(m)).firstFormula,w=b.secondFormula,a&&(J(y)||J(w)))return;d.c_=[],M=i.name(),C=i.parent&&i.parent.r4(),j(y,M,C)||j(w,M,C)?(d.n_=D,_(y)||d.c_.push({n_:"formula1",c_:[{n_:"f",c_:[O(R(y))]}]}),_(w)||d.c_.push({n_:"formula2",c_:[{n_:"f",c_:[O(R(w))]}]}),d.c_.push({n_:"sqref",c_:[$(g)]}),v=!0):(_(y)||(4===p||5===p?d.c_.push({n_:"formula1",c_:[bt(y)+""]}):d.c_.push({n_:"formula1",c_:[O(R(y))]})),_(w)||(4===p||5===p?d.c_.push({n_:"formula2",c_:[bt(w)+""]}):d.c_.push({n_:"formula2",c_:[O(R(w))]})))}h.l6t&&(d.lossless={highlightStyle:JSON.stringify(h.l6t)}),(v?f:s).push(d)}0<s.length&&(e.count=c,t.c_.push(e)),0<f.length&&(A=B(t,N)).c_.push(I={n_:"ext",r_:[1,9],c_:[{n_:k,c_:f,r_:[2],count:f.length}]})}},yh:function(t,n,e){var i,r,o,a,u,e,s,c,f,l,e,t,h,d,i=this,r=i.b8,o=r.YB,a;if(!(e&&!1===e.includeStyles)&&r&&v){if(u=x.Util.ko(e),(s=(e=B(t,k))&&e.c_)&&0<s.length)for(c=s.length-1;0<=c;c--)f=s[c],(l=new y).rv(f,i,E,u),o[l.id]=l;if(e=B(t,N),(t=K(e,"dataValidations"))&&t.c_&&0<t.c_.length)for(c=(h=t.c_).length-1;0<=c;c--)d=h[c],(l=new y).rv(d,i,!0,u),o[l.id]=l;r.C8()}}}),x.Style.ch("validator",{fromJson:function(t){var n;"validator"===t.p&&((n=new y).fromJSON(t.v,t.noSchema,t.context),this.validator=n,t.r=!0)}}),n.Vc.wf.push(function(t,n){!n&&t.G1&&t.G1()})},"./node_modules_local/@grapecity/js-calc-advancedfunctions/dist/gc.spread.calcengine.advancedfunctions.js":function(t,n,a){var u;!function(){"use strict";var e,i,t,n,r;function o(t){var n,n,n=i[t];return void 0!==n||(n=i[t]={exports:{}},e[t].call(n.exports,n,n.exports,o)),n.exports}e={"./src/functions-db.ts":function(B,t,n){var a,s,p,u,d,v,m,g,b,y,t,w,M,n,C,r,c,S,e,n,i,n;function o(t,n,e){this.N6t=t,this.k6t=n,this.D6t=e}function f(t,n){return[t,n].join(",")}function l(t,n,e){var i=this;if(i.Ky=0,i._6t=t,i.E6t=e,i.j6t={},3===arguments.length){if(i.yft=i.mvt(t,n),t.rowCount<2||t.colCount<1||e.rowCount<2||e.colCount<1||i.yft<0||i._6t.colCount<=i.yft)throw r}else if(2===arguments.length&&(i.yft=-1,t.rowCount<2||t.colCount<1||e.rowCount<2||e.colCount<1))throw r}function h(t,n,e,i){for(var r,o,a,r=0,o=new S(t,n,e);o.O6t();)a=o.R6t(),(a=i?v(a):a)&&r++;return g(r)}function T(t,n,e,i,r,o,a){for(var u,s,c,f,l,h,t,n,u=a?1:0,s=0,c=0,f=new S(t,n,e);f.O6t();)if(l=f.R6t(),v(l)){if(h=d(l),M(h))return y;u=a?u*h:u+h,s+=h*h,c++}else if(m(l))return l;return o||a?g(u):(t=Math.max(0,(c*s-u*u)/(c*(c-r))),n=i?Math.sqrt(t):t,c<=1?b:g(n))}function A(t,n,e){for(var i,r,o,a,a,i=0,r=0,o=new S(t,n,e);o.O6t();){if(a=o.R6t(),m(a))return a;if(v(a)){if(!s.Convert.sJ(a,a={value:0}))return y;i+=a.value,r++}}return 0===r?b:g(i/r)}function I(t,n,e){return h(t,n,e,!0)}function x(t,n,e){return h(t,n,e,!1)}function N(t,n,e){var n,t=new S(t,n,e);return t.O6t()?(n=t.R6t(),t.O6t()?s.Errors.Number:n):y}function k(t,n,e){for(var i,r,o,a,a,i=!1,r=-s.Functions.B6t,o=new S(t,n,e);o.O6t();){if(a=o.R6t(),m(a))return a;if(v(a)){if(a=d(a),M(a))return y;(!i||r<a)&&(r=a),i=!0}}return i?g(r):0}function D(t,n,e){for(var i,r,o,a,u,i=!1,r=s.Functions.B6t,o=new S(t,n,e);o.O6t();){if(a=o.R6t(),m(a))return a;if(v(a)){if(u=d(a),M(u))return y;(!i||a<r)&&(r=a),i=!0}}return i?g(r):0}function _(t,n,e){return T(t,n,e,!1,0,!1,!0)}function E(t,n,e){return T(t,n,e,!0,1)}function j(t,n,e){return T(t,n,e,!0,0)}function O(t,n,e){return T(t,n,e,!1,0,!0)}function R(t,n,e){return T(t,n,e,!1,1)}function L(t,n,e){return T(t,n,e,!1,0)}Object.defineProperty(t,"__esModule",{value:!0}),a=n("Common"),s=n("CalcEngine"),p=a.Common.$T,u=null,d=s.Convert.uJ,v=s.Convert.q8,m=s.Convert.BJ,g=s.Convert.L6t,b=s.Errors.DivideByZero,y=s.Errors.Value,t=s.Functions.F6t,w=s.Functions.OMt,M=isNaN,n=a.Common.zf,C=n.fJ,r=(0,s.sR)().Exp_InvalidCast,o.prototype.P6t=function(t){var n,t,n,t=(0,s.evaluateOperator)({"=":9,"<>":10,"<":11,"<=":12,">":13,">=":14}[this.N6t],t,this.k6t);return!!s.Functions.G6t(t)&&s.Convert.U6t(t)},c=o,l.prototype.mvt=function(t,n){var e,i;if(w(n)){for(e=0;e<t.colCount;e++)if((i=s.Convert.j(t[0][e]))&&this.H6t(i,n))return e;return-1}return s.Convert.z6t(n)-1},l.prototype.R6t=function(){var t=this;if(t.Ky<=0||t._6t.rowCount<=t.Ky)throw(0,s.sR)().Exp_InvalidOperation;return t._6t[t.Ky][t.yft]},l.prototype.O6t=function(){for(var t=this,n=!1,e=t._6t.rowCount;!n&&t.Ky<e;)t.Ky++,t.Ky<e&&(n=t.V6t());return n},l.prototype.Y6t=function(t){var n,e,i,r,o;if(w(t)){for(n=["=","<>","<=",">=","<",">"],e=s.Convert.j(t),r=i=void 0,i=0;i<n.length;i++)if(a.Common.zf.fJ(e,n[i]))return e=e.substring(n[i].length),o=a.Common.st.Z6t(e),M(o)?this.H6t("true",e)?t=!0:this.H6t("false",e)?t=!1:(t=e,r=0===i):t=o,new c(n[i],t,r);return new c("=",t)}return t?new c("=",t):u},l.prototype.W6t=function(t,n){var e,i,r,o,a,e=this,i=e.j6t,r=f(t,n),o=i[r];return o||i[a="_"+r]||(o=i[r]=e.Y6t(e.E6t[t][n]),i[a]=!0),o},l.prototype.V6t=function(){var t,n,e,i,r,o,a,u,s,c,f,l,h,d,v,m,g,t=this,n=!1,e=t.E6t,i=t.Ky,u=e.rowCount,s=e.colCount,c=t._6t,f=t.Q6t;if(!f){for(l=e[0],f=[],o=0;o<s;o++){if((a=t.mvt(c,l[o]))<0)return!1;f[o]=a}t.Q6t=f}for(r=1;!n&&r<u;r++)for(n=!0,o=0;n&&o<s;o++)(h=t.W6t(r,o))&&(d=c[i][f[o]],n="="===h.N6t&&(v=h.k6t,w(v))&&w(d)?(m=p.jJ(v,!0),g=h.D6t,m?p.OJ("^"+m+(g?"$":"")).test(d):g?d.toLowerCase()===v.toLowerCase():C(d,v,!0)):h.P6t(d));return n},l.prototype.H6t=function(t,n){return t.toLowerCase()===n.toLowerCase()},S=l,t("DAVERAGE",A,3,3,n=[n={K6t:!0,J6t:4,X6t:0},i={K6t:!0},n],e="!= 1",e),t("DCOUNT",I,3,3,n,e,e),t("DCOUNTA",x,3,3,n,e,e),t("DGET",N,3,3,n,e,e),t("DMAX",k,3,3,n,e,e),t("DMIN",D,3,3,n,e,e),t("DPRODUCT",_,3,3,n,e,e),t("DSTDEV",E,3,3,n,e,e),t("DSTDEVP",j,3,3,n,e,e),t("DSUM",O,3,3,n,e,e),t("DVAR",R,3,3,n,e,e),t("DVARP",L,3,3,n,e,e)},"./src/functions-eng.ts":function(D,t,n){var t,d,h,n,y,O,R,B,L,v,_,E,r,F,j,G,m,U,t,H,P,z,V,e,g,Y,Z,i,o,W,a,a,Q,a,J,o,a,u,K,X,q,$,tt,a,nt,u,et,o,a,s,it,rt,ot,at,u,ut,a,o,u,c,o,st,ct,a,o,ft,u,c,o,u,c,o,u,c,o,lt,ht,dt,u,c,o,vt,mt,a,c,u,o,gt,pt,f,l,bt,p,b,yt,w,wt,Mt,M,a,Ct,St,o,c,u,o,Tt,At,C;function S(t,n){return new d.Functions.q6t(t,n)}function It(t,n){return{$6t:t,_c:n}}function T(t,n){for(var e=[],i,i=0;i<h(t);i++)e.push(It(t[i],n[i]));return e.push(It(null,0)),e}function xt(t,n,e){var i,r,o,a,u,s,c,f,l,h,i=100,r=.5*t,o=r*r;for(r=v(r,F(n)),a=d.Functions.nkt(n),u=1,s=0,c=F(n),l=.9*(f=r/a),h=!1;f!==l&&0!==i;)r*=o,a*=++s,u*=++c,l=f,f=e||h?f+r/a/u:f-r/a/u,i--,h=!h;return f}function Nt(t,n){var e=v(n,10),t=parseInt(t,n);return j(t)?m:e/2<=t?t-e:t}function kt(t,n,e){t<0&&(t+=v(n,10));for(var i=t.toString(n),r=e-h(i),o,o=0;o<r;o++)i="0"+i;return i.toUpperCase()}function Dt(t,n){var t;return t<0||(t=Nt(t,n),z(t))?m:t}function _t(t,n,e){var t=kt(t,e,n.y4);return 0<=t&&n.y4<h(t)&&n.ekt?m:t}function A(t,n,e,i,r){var t,e;return t<0||(t=Nt(t,e),z(t))||r&&(t<-r||r-1<t)||(e=kt(t,i,n.y4),0<=t&&n.y4<h(e)&&n.ekt)?m:e}function I(t,n){var e=Number.POSITIVE_INFINITY,i=t.ikt(),r=t.rkt();return j(i)||i===e||j(r)||r===e?m:t.j(n)}function Et(t,n,e,i){var r=t,o=n,a=e.ikt(),e=e.rkt();return{okt:t=i?r*a-o*e:r+a,akt:n=i?r*e+o*a:o+e}}function jt(t,n){for(var e,i,r,o,a,u,s,c,f,l,e=n?1:0,i=0,o=0;o<h(t);o++)if(d.Convert.Nh(t[o]))for(f=t[o],a=0;a<f.rowCount;a++)for(u=0;u<f.columnCount;u++){if(!(r=g(f.getValue(a,u))))return m;e=(c=Et(e,i,r,n)).okt,i=c.akt}else if(d.Convert.LE(t[o]))for(l=t[o],s=0;s<l.getRangeCount();s++)for(a=0;a<l.getRowCount(s);a++)for(u=0;u<l.getColumnCount(s);u++){if(!(r=g(l.getValue(s,a,u))))return m;e=(c=Et(e,i,r,n)).okt,i=c.akt}else{if(!(r=g(t[o])))return m;e=(c=Et(e,i,r,n)).okt,i=c.akt}return I(S(e,i))}function Ot(t,n){return P(xt(t,n,!0))}function Rt(t,n){return P(xt(t,n,!1))}function Bt(t,n){var e,i,r,o,a,u,s,c,f,l,h,d,v,m,g,p,b,e=17976931348623157e292,i=.5772156649015329,r=0,o=.25*t*t,a=1,u=0,s=1,c=2/t;if(0<n){for(u=-i,d=1;d<n;d++)u+=1/d,a*=d+1;if(s=c,1===n)r=1/t;else{for(f=v=a/n,d=g=m=1;d<n;d++){if(f+=l=(v/=n-d)*(g*=-o)/(m*=d),e-y(l)<y(f)||1<c&&e/c<s)return e;s*=c}if(l=y(f*=.5),1<s&&e/s<l||1<l&&e/l<s)return e;r=f*s}}for(b=-i,l=0===n?(u=b,1):(u+=1/n,1/a),f=(b+u-(p=2*L(t/2)))*l,h=1;f+=((b+=1/h)+(u+=1/(h+n))-p)*(l*=o/(h*(h+n))),h++,11102230246251565e-32<y(l/f););return f=.5*f/s,P(r+=f=0!=(1&n)?-f:f)}function Lt(t,n){var d,v,m,g,p,b,y,w,M,C,S,T,A,I,x,N,k,D,_;function E(t,n,e,i){var r=0,o=F(n[r]),a=e;for(r++,i&&(o+=t,a--);o=o*t+F(n[r]),r++,0!==--a;);return o}function j(t,n){var e,i,r,o,a,u,s,c,f,l,h,u,e,e=n?d:v,i=n?m:g,r=n?p:b,o=n?y:w,a,u=n?x:N,s,c;return t<=5?(l=t*t,n&&t<1e-5?1-l/4:(h=(l-(n?5.783185962946784:14.681970642123893))*(l-(n?30.471262343662087:49.2184563216946)),h*=f=E(l,n?A:I,3)/E(l,u,8,!0),n?h:h*t)):(f=5/t,h=E(l=n?25/(t*t):f*f,e,6)/E(l,i,6),u=E(l,r,7)/E(l,o,7,!0),(h=h*R(e=t-(n?_:D))-f*u*O(e))*k/B(t))}function u(t,n){var e,i,r,o,a,u,s,c,f,l,h,c,h,r,r=n?d:v,o=n?m:g,a=n?p:b,u=n?y:w,s,c=n?S:T,f,l,h=n?7:8;return t<=5?(e=(n?1:t)*E(i=t*t,n?M:C,n?7:5)/E(i,c,h,!0),e+.6366197723675814*(n?L(t)*j(t,!0):j(t,!1)*L(t)-1/t)):(e=5/t,c=E(i=n?25/(t*t):e*e,r,6)/E(i,o,6),h=E(i,a,7)/E(i,u,7,!0),(c=c*O(r=t-(n?_:D))+e*h*R(r))*k/B(t))}function e(t,n){var e=u(t,!0),i=u(t,!1),r=1,o=2*r,a;if(0===n)return e;if(1===n)return i;for(;a=o*i/t-e,e=i,i=a,o+=2,++r<n;);return a}return d=[.0007969367292973471,.08283523921074408,1.239533716464143,5.447250030587687,8.74716500199817,5.303240382353949,1],v=[.0007621256162081731,.07313970569409176,1.1271960812968493,5.112079511468076,8.424045901417724,5.214515986823615,1],m=[.0009244088105588637,.08562884743544745,1.2535274390105895,5.470977403304171,8.761908832370695,5.306052882353947,1],g=[.0005713231280725487,.06884559087544954,1.105142326340617,5.073863861286015,8.399855543276042,5.209828486823619,1],p=[-.011366383889846916,-1.2825271867050931,-19.553954425773597,-93.20601521237683,-177.68116798048806,-147.07750515495118,-51.41053267665993,-6.050143506007285],b=[.05108625947501766,4.982138729512334,75.82382841325453,366.7796093601508,710.8563049989261,597.4896124006136,211.68875710057213,25.207020585802372],y=[64.3178256118178,856.4300259769806,3882.4018360540163,7240.467741956525,5930.727011873169,2062.0933166032783,242.0057402402914],w=[74.23732770356752,1056.4488603826283,4986.410583376536,9562.318924047562,7997.041604473507,2826.1927851763908,336.0936078106983],M=[15592.436785523574,-14663929.59039716,5435264770.518765,-982136065717.9115,87590639439536.7,-0xc5090e8ec6601,0x9d4a5b305a0018,-0x41b52d6418d9ec],C=[1263204747.9017804,-647355876379.1603,114509511541823.73,-8127702555013251,0x2cf35a16e6cd620,-0xacf20aeef158b80],S=[1041.2835366425984,626107.330137135,268919633.39381415,86400248710.3935,20297961275010.555,3171577528429750.5,0x37a4bf79f36ba00],T=[594.3015923461282,235564.09294306856,73481194.44597217,18760131610.870617,3882312774962.3857,620557727146953.8,0xf41f1e2a3d2440,0x3721e321ece8fe00],A=[-4794432209.782018,1956174919465.5657,-249248344360967.72,9708622510473064],I=[-899971225.7055594,452228297998.19403,-72749424522181.83,0xd15a1534be241],x=[499.563147152651,173785.4016763747,48440965.83399621,11185553704.535683,2112775201154.892,310518229857422.56,0x710505f9ecba70,0x17be34c7b662cc00],N=[620.8364781180543,256987.25675774884,83514679.14319493,22151159547.97925,4749141220799.914,784369607876235.9,89522233618462740,0x49de55d9c0a4e400],k=.7978845608028654,D=2.356194490192345,_=.7853981633974483,P(e(t,n))}function Ft(t){return Dt(t,2)}function Pt(t){return Dt(t,16)}function Gt(t){return Dt(t,8)}function Ut(t,n){return A(t,n,2,16)}function Ht(t,n){return A(t,n,2,8)}function zt(t,n){return _t(t,n,2)}function Vt(t,n){return _t(t,n,16)}function Yt(t,n){return _t(t,n,8)}function Zt(t,n){return A(t,n,16,2,512)}function Wt(t,n){return A(t,n,8,2,512)}function Qt(t,n){return A(t,n,16,8,536870912)}function Jt(t,n){return A(t,n,8,16,549755813888)}function Kt(t,n){var t,e,i,t=H(t*B(2)),e=2*t-1;return e=n.ekt?(i=2*(t=H(n.y4*B(2)))-1)-e:e}function Xt(t){return Kt(t,{ekt:!1})}function qt(t){return 1-Kt(t,{ekt:!1})}function $t(t,n){return d.skt.ukt(t,n)?1:0}function tn(t,n){return n<=t?1:0}function nn(t,n,e){return"i"!==e&&"j"!==e?d.Errors.Value:I(S(t,n),e)}function en(t){return P(B(t.okt*t.okt+t.akt*t.akt))}function rn(t){return P(t.akt)}function on(t){return 0===t.okt&&0===t.akt?d.Errors.DivideByZero:P(r(t.akt,t.okt))}function an(t){return I(S(t.okt,-t.akt))}function un(t){return I(S(R(t.okt)*e(t.akt,!1),-O(t.okt)*e(t.akt,!0)))}function sn(t,n){var e,t,i,n,e=t.okt,t=t.akt,i=n.okt,n=n.akt;return I(S((e*i+t*n)/(i*i+n*n),(t*i-e*n)/(i*i+n*n)))}function cn(t){return I(S(_(t.okt)*R(t.akt),_(t.okt)*O(t.akt)))}function fn(t){var n,t,n=t.okt,t=t.akt;return I(S(L(B(n*n+t*t)),r(t,n)))}function ln(t){var n,t,e,n=t.okt,t=t.akt,e=V.ckt(E,10);return I(S(e*L(B(n*n+t*t)),e*r(t,n)))}function hn(t){var n,t,e,n=t.okt,t=t.akt,e=V.ckt(E,2);return I(S(e*L(B(n*n+t*t)),e*r(t,n)))}function dn(t,n){var e,t,i,t,e=t.okt,t=t.akt;return 0===e&&0===t?0<n?"0":m:(i=B(e*e+t*t),t=r(t,e),I(S(v(i,n)*R(n*t),v(i,n)*O(n*t))))}function vn(t){return P(t.okt)}function mn(t){return I(S(O(t.okt)*e(t.akt,!1),R(t.okt)*e(t.akt,!0)))}function gn(t){var n,t,e,t,n=t.okt,t=t.akt;return 0===n&&0===t?"0":(e=B(n*n+t*t),t=r(t,n),I(S(B(e)*R(t/2),B(e)*O(t/2))))}function pn(t,n){return I(S(t.okt-n.okt,t.akt-n.akt))}function bn(){return jt(arguments,!0)}function yn(){return jt(arguments,!1)}function wn(t){for(var n,e,n=["cup","mmHg","J","sec","cel","kel","hh","Wh","wh","flb","BTU"],e=0;n[e];e++)if(0===t.localeCompare(n[e]))return;return 1}function Mn(t,n,e){for(var i,r,o,a,u,s,c,f,r=0,o=1,i=0;t[i].$6t;i++)if(0===e.localeCompare(t[i].$6t))return{fkt:!0,vit:o,lkt:r=t[i]._c};if(n)for(i=0;n[i].$6t;i++)(a=e.substr(0,1))===(u=n[i].$6t.substr(0,1))&&wn(e)&&(o=n[i]._c);for(i=0;t[i].$6t;i++)if(s=h(t[i].$6t),(c=e.substr(1,s))===(f=t[i].$6t.substr(0,s))&&wn(e))return{fkt:!0,vit:o,lkt:r=t[i]._c};return{fkt:!1,vit:o,lkt:r}}function Cn(t,n,e){var i,r,o,a,u,s,c,f,a,l,u;if(x(n).unit&&x(e).unit)return kn(t,n,e);if(1!==(i=In(n,e))){if(2===i)return xn(t,n,e);if(Tn(n)&&Tn(e))return An(t,n,e);if(!Sn(n)&&!Sn(e))for(r=[J,nt,rt,at,st,ut,ct,ht,ct,dt,gt],o=0;o<h(r);o++)if(s=(u=Mn(a=r[o],w,n)).fkt,c=u.lkt,f=u.vit,a=(u=Mn(a,w,e)).fkt,l=u.vit,u=u.lkt,s&&a&&0!==c&&0!==l)return t*f/c*u/l}return G}function Sn(t){var t,n,e;if(!(0<=Mt.indexOf(t)))return e=(t=[t.slice(0,1),t.slice(1)])[1],0<=yt.indexOf(t[0])&&0<=Mt.indexOf(e)}function Tn(t){for(var n=0;n<s.length;n++)if(t===s[n].$6t)return 1;return"sec"===t.slice(1)||"s"===t.slice(1)}function An(t,n,e){var n,e,n=Mn(s,w,n),e=Mn(s,w,e);return t*n.vit/n.lkt*e.lkt/e.vit}function In(t,n){var t,n,t=-1<t.indexOf("bit")||-1<t.indexOf("byte"),n=-1<n.indexOf("bit")||-1<n.indexOf("byte");return t&&n?2:n||t?1:0}function xn(t,n,e){var n,e,n=Nn(n),e=Nn(e);return t*n.vit/n.lkt*e.lkt/e.vit}function Nn(t){var n,t,e,i,n,r,o;if(-1<t.indexOf(f.bit)?(e=(n=[t.slice(0,-3),t.slice(-3)])[0],n=n[1]):-1<t.indexOf(f.byte)&&(e=(t=[t.slice(0,-4),t.slice(-4)])[0],n=t[1]),e)for(o=0;wt[o].$6t;o++)e===wt[o].$6t&&(i=wt[o]._c);else i=1;return n===f.bit?r=pt[0]._c:n===f.byte&&(r=pt[1]._c),{vit:i,lkt:r}}function kn(t,n,e){var i,r,r=x(n);switch(r.unit){case l.Rank:i=jn(t,e);break;case l.Reau:i=On(t,e);break;case l.C:case l.cel:i=Dn(t,e);break;case l.F:case l.fah:i=_n(t,e);break;case l.K:case l.kel:i=En(t*r.prefixNumber,e)}return i}function Dn(t,n){var e,i,i=x(n);switch(i.unit){case l.Rank:return 9*t/5+32+b;case l.Reau:return.8*t;case l.cel:case l.C:return t;case l.F:case l.fah:return 9*t/5+32;case l.K:case l.kel:return e=i.prefixNumber,(t+p)/e}}function _n(t,n){var e,i,i=x(n);switch(i.unit){case l.Rank:return t+b;case l.Reau:return 4*(t-32)/9;case l.F:case l.fah:return t;case l.C:case l.cel:return 5*(t-32)/9;case l.K:case l.kel:return e=i.prefixNumber,(5*(t-32)/9+p)/e}}function En(t,n){var e,i,i=x(n);switch(i.unit){case l.Rank:return 9*t/5;case l.Reau:return.8*(t-p);case l.C:case l.cel:return t-p;case l.F:case l.fah:return 9*(t-p)/5+32;case l.K:case l.kel:return t/(e=i.prefixNumber)}}function jn(t,n){var e,i,i=x(n);switch(i.unit){case l.Rank:return t;case l.Reau:return.8*(t-b-32)*5/9;case l.C:case l.cel:return 5*(t-b-32)/9;case l.F:case l.fah:return t-b;case l.K:case l.kel:return e=i.prefixNumber,(p+5*(t-b-32)/9)/e}}function On(t,n){var e,i,i=x(n);switch(i.unit){case l.Rank:return 1.25*t*9/5+32+b;case l.Reau:return t;case l.C:case l.cel:return 1.25*t;case l.F:case l.fah:return 1.25*t*9/5+32;case l.K:case l.kel:return e=i.prefixNumber,(1.25*t+p)/e}}function x(t){var n,e,i,n=1;if(!l[t]){if("K"!==l[t.slice(1)]&&"kel"!==l[t.slice(1)])return{unit:void 0,prefixNumber:n};for(e=t.slice(0,1),t=t.slice(1),i=0;w[i].$6t;i++)e===w[i].$6t&&(n=w[i]._c)}return{unit:t,prefixNumber:n}}function Rn(t,n,e,i){var r,o;if(""===t&&""===n)return U;if(o={value:0},!0!==Z(t,r={value:0})||!0!==Z(n,o))return U;if(n=o.value,(t=r.value)<0||Y<t||t%1!=0)return m;if("bitOperator"===e){if(n<0||Y<n||n%1!=0)return m}else if("shiftOperator"===e&&0===t)return 0;return i(t,n)}function Bn(t,n){return Rn(t,n,"bitOperator",function(t,n){return t&n})}function Ln(t,n){return Rn(t,n,"bitOperator",function(t,n){return t|n})}function Fn(t,n){return Rn(t,n,"bitOperator",function(t,n){return t^n})}function Pn(t,n){return Rn(t,n,"shiftOperator",function(t,n){var t;return 48<=n?m:n<0&&t<1<<-n?0:Y<(t=t<<n)?m:t})}function Gn(e,i){return Rn(e,i,"shiftOperator",function(t,n){return 53<n?m:0<=i?e>>i:e<<-i})}function N(t,n){var t;return""===t?m:!0===t||!1===t?U:(t=g(t))?n(t):m}function Un(t){return N(t,function(t){return I(qn(t),t.hkt())})}function Hn(t){return N(t,function(t){return re(Jn(t),S(0,0))?m:I(k(Kn(t),Jn(t)),t.hkt())})}function zn(t){return N(t,function(t){return re(t,S(0,0))?m:I(te(t),t.hkt())})}function Vn(t){return N(t,function(t){return re(Xn(t),S(0,0))?m:I(ne(t),t.hkt())})}function Yn(t){return N(t,function(t){return re(Kn(t),S(0,0))?m:I(ee(t),t.hkt())})}function Zn(t){return N(t,function(t){return re(qn(t),S(0,0))?m:I(ie(t),t.hkt())})}function Wn(t){return N(t,function(t){return I(Xn(t),t.hkt())})}function Qn(t){return N(t,function(t){return I($n(t),t.hkt())})}function Jn(t){var n,t,n=t.ikt(),t=t.rkt();return S(O(n)*e(t,!1),R(n)*e(t,!0))}function Kn(t){var n,t,n=t.ikt(),t=t.rkt();return S(R(n)*e(t,!1),-(O(n)*e(t,!0)))}function Xn(t){var n,t,n=t.ikt(),t=t.rkt();return S(e(n,!0)*R(t),e(n,!1)*O(t))}function qn(t){var n,t,n=t.ikt(),t=t.rkt();return S(e(n,!1)*R(t),e(n,!0)*O(t))}function $n(t){return k(Jn(t),Kn(t))}function te(t){return k(i,Jn(t))}function ne(t){return k(i,Xn(t))}function ee(t){return k(i,Kn(t))}function ie(t){return k(i,qn(t))}function k(t,n){var e,t,i,n,r,r,e=t.ikt(),t=t.rkt(),i=n.ikt(),n=n.rkt();return Math.abs(n)<Math.abs(i)?S((e+t*(r=n/i))/(i+n*r),(t-e*r)/(i+n*r)):S((t+e*(r=i/n))/(n+i*r),(t*r-e)/(n+i*r))}function re(t,n){return t.ikt()===n.ikt()&&t.rkt()===n.rkt()}Object.defineProperty(t,"__esModule",{value:!0}),t=n("Common"),d=n("CalcEngine"),h=t.Common.Uf.tR,n=void 0,y=Math.abs,O=Math.sin,R=Math.cos,B=Math.sqrt,L=Math.log,v=Math.pow,_=Math.exp,E=Math.E,r=Math.atan2,F=parseFloat,j=isNaN,G=d.Errors.NotAvailable,m=d.Errors.Number,U=d.Errors.Value,t=d.Functions.F6t,H=d.Functions.dkt,P=d.Convert.L6t,z=d.Convert.BJ,V=d.Functions.MathHelper,e=V.vkt,g=d.Functions.mkt,Y=0xffffffffffff,Z=d.Convert.sJ,i=S(1,0),J=T(["g","sg","lbm","u","ozm","grain","cwt","shweight","uk_cwt","lcwt","hweight","stone","ton","uk_ton","LTON","brton"],[1,685217658567918e-19,o=.00220462262184878,602214179421676e9,.0352739619495804,W=7e3*o,a=o/100,a,a=o/112,a,a,Q=o/14,110231131092439e-20,a=o/2240,a,a]),nt=T(["m","mi","Nmi","in","ft","yd","ang","Pica","ell","ly","pc","pica","survey_mi","parsec","Picapt"],[1,K=(u=(a=(o=1e4/254)/12)/3)/1760,1/1852,o,a,u,1e10,2834.64566929134,X=o/45,tt=105700083402462e-30,a=324077928966473e-31,q=6*o,$=.00062136994949495,a,2834.64566929134]),s=T(["yr","day","hr","mn","sec","d","min","s"],[1,u=365.25,et=8766,o=525960,a=60*o,u,o,a]),rt=T(["Pa","atm","mmHg","p","at","psi","Torr"],[1,986923266716013e-20,it=.007500637554192,1,986923266716013e-20,.000145037737730209,.0075006168270417]),at=T(["N","dyn","lbf","dy","pond"],[1,ot=1e5,.22480894309971,1e5,101.971621297793]),ut=T(["HP","W","h","w","PS"],[1,u=745.69987158227,1,u,1.013869665424]),st=T(["J","e","c","cal","eV","HPh","Wh","flb","BTU","ev","hh","wh","btu"],[1,1e-7,o=.239005736137667,o,a=624150964712042e4,o=1/(3600*u),u=1/3600,.737562149277265,c=.000947817120313317,a,o,u,c]),ct=T(["T","ga"],[1,1e4]),ht=T(["tsp","tspm","tbs","oz","cup","pt","qt","uk_qt","gal","uk_gal","l","uk_pt","us_pt","lt","ang3","ang^3","barrel","bushel","ft3","ft^3","in3","in^3","ly3","ly^3","m3","m^3","mi3","mi^3","yd3","yd^3","Nmi3","Nmi^3","Pica3","Pica^3","Picapt3","Picapt^3","GRT","regton","MTON","L"],[1,.98578431875,1/3,1/6,1/48,1/96,1/192,.00433684471160932,1/768,.00108421117790233,a=.00492892159375,.00867368942321863,1/96,a,o=1e27*a,o,1/32256,ft=.000139870932189991,u=.00017406322338,u,c=.30078125,c,o=82073596535e-54,o,u=492892159375e-17,u,c=118251117638e-26,c,o=64467860511e-16,o,u=775941468987e-27,u,c=112266,c,c,c,o=1740632233796e-18,o,lt=4351580584491e-18,a]),dt=T(["admkn","kn","m/h","m/hr","m/s","m/sec","mph"],[1,1.00063930885529,1853.184,1853.184,.514773333333333,.514773333333333,1.15151515151515]),gt=T(["m2","m^2","ft2","ft^2","in2","in^2","yd2","yd^2","uk_acre","us_acre","ang2","ang^2","ar","ha","Morgen","mi2","mi2","Nmi2","Nmi^2","Pica2","Picapt2","Pica^2","Picapt^2","ly2","ly^2"],[1,1,u=10.7639104167097,u,c=144*u,c,o=u/9,o,vt=.000247105381467165,mt=.000247104393046628,1e20,1e20,.01,1e-4,4e-4,a=o/3097600,a,c=2.91553349598123e-7,c,u=8035216.07043214,u,u,u,o=111725076312873e-46,o]),pt=T(["bit","byte"],[1,.125]),f={bit:"bit",byte:"byte"},l={K:"K",kel:"kel",cel:"cel",C:"C",F:"F",fah:"fah",Rank:"Rank",Reau:"Reau"},bt={day:"day",d:"d",yr:"yr",hr:"hr",mn:"mn",min:"min",sec:"sec",s:"s"},p=273.15,b=459.67,w=T(yt=["Y","Z","E","P","T","G","M","k","h","e","d","c","m","u","n","p","f","a","z","y"],[1e24,1e21,1e18,1e15,1e12,1e9,1e6,1e3,100,10,.1,.01,.001,1e-6,1e-9,1e-12,1e-15,1e-18,1e-21,1e-24]),wt=T(["Y","Z","E","P","T","G","M","k","h","e","d","c","m","u","n","p","f","a","z","y","Yi","Zi","Ei","Pi","Ti","Gi","Mi","ki"],[1e24,1e21,1e18,1e15,1e12,1e9,1e6,1e3,100,10,.1,.01,.001,1e-6,1e-9,1e-12,1e-15,1e-18,1e-21,1e-24,Math.pow(2,80),Math.pow(2,70),Math.pow(2,60),Math.pow(2,50),Math.pow(2,40),Math.pow(2,30),Math.pow(2,20),Math.pow(2,10)]),Mt=["sg","lbm","ozm","grain","cwt","shweight","uk_cwt","lcwt","hweight","stone","uk_ton","lcwt","hweight","stone","uk_ton","LTON","brton","ton","mi","Nmi","in","ft","yd","ell","Pica","survey_mi","Picapt","psi","Torr","lbf","HP","h","PS","HPh","flb","BTU","hh","btu","tsp","tspm","tbs","oz","cup","pt","us_pt","uk_pt","qt","UK_qt","gal","uk_gal","barrel","bushel","ft3","ft^3","in3","in^3","mi3","mi^3","yd3","yd^3","Nmi3","Nmi^3","Picapt3","Picapt^3","Pica3","Pica^3","GRT","regton","MTON","kn","admkn","uk_acre","us_acre","ft2","ft^2","in2","in^2","ly2","ly^2","Morgen","mi2","mi^2","Nmi2","Nmi^2","Pica2","Picapt^2","Pica^2","Picapt^2","yd2","yd^2"],a={J6t:5},c={J6t:8},u={J6t:8,gkt:!0},Tt=[{J6t:0,pkt:"<= 0"},o={J6t:2,pkt:"< 0"}],At=[M={J6t:0},{J6t:0,bkt:0}],C=[Ct={J6t:5,pkt:["checkLength 10"]},St={ykt:!0,J6t:2,bkt:1,pkt:["< 1","> 10"]}],t("BESSELI",Ot,2,2,o=[M,o]),t("BESSELJ",Rt,2,2,o),t("BESSELK",Bt,2,2,Tt),t("BESSELY",Lt,2,2,Tt),t("BIN2DEC",Ft,1,1,Ct),t("BIN2HEX",Ut,1,2,C,n,n,{wkt:1}),t("BIN2OCT",Ht,1,2,C,n,n,{wkt:1}),t("DEC2BIN",zt,1,2,[{J6t:0,pkt:["< -512","> 511"]},St],n,n,{wkt:1}),t("DEC2HEX",Vt,1,2,[{J6t:0,pkt:["< -549755813888","> 549755813887"]},St],n,n,{wkt:1}),t("DEC2OCT",Yt,1,2,[{J6t:0,pkt:["< -536870912","> 536870911"]},St],n,n,{wkt:1}),t("HEX2BIN",Zt,1,2,C,n,n,{wkt:1}),t("HEX2DEC",Pt,1,1,Ct),t("HEX2OCT",Qt,1,2,C,n,n,{wkt:1}),t("OCT2BIN",Wt,1,2,C,n,n,{wkt:1}),t("OCT2DEC",Gt,1,1,Ct),t("OCT2HEX",Jt,1,2,C,n,n,{wkt:1}),t("ERF",Kt,1,2,[M,{ykt:!0,J6t:0}],n,n,{wkt:1}),t("ERF.PRECISE",Xt,1,1,M),t("ERFC",qt,1,1,M),t("ERFC.PRECISE",qt,1,1,M),t("DELTA",$t,1,2,At,n,n,{wkt:1}),t("GESTEP",tn,1,2,At,n,n,{wkt:1}),t("COMPLEX",nn,2,3,[M,M,{J6t:5,bkt:"i"}],n,n,{wkt:2}),t("IMABS",en,1,1,c),t("IMAGINARY",rn,1,1,c),t("IMARGUMENT",on,1,1,c),t("IMCONJUGATE",an,1,1,c),t("IMCOS",un,1,1,c),t("IMDIV",sn,2,2,[c,u]),t("IMEXP",cn,1,1,c),t("IMLN",fn,1,1,u),t("IMLOG10",ln,1,1,u),t("IMLOG2",hn,1,1,u),t("IMREAL",vn,1,1,c),t("IMSIN",mn,1,1,c),t("IMSQRT",gn,1,1,c),t("IMSUB",pn,2,2,[c,c]),t("IMPOWER",dn,2,2,[c,{J6t:2}]),t("IMPRODUCT",bn,1,255,n,-1,-1),t("IMSUM",yn,1,255,n,-1,-1),t("CONVERT",Cn,3,3,[{J6t:1},a,a]),t("BITAND",Bn,0,2),t("BITLSHIFT",Pn,0,2),t("BITOR",Ln,0,2),t("BITRSHIFT",Gn,0,2),t("BITXOR",Fn,0,2),t("IMCOSH",Un,1,1),t("IMCOT",Hn,1,1),t("IMCSC",zn,1,1),t("IMCSCH",Vn,1,1),t("IMSEC",Yn,1,1),t("IMSECH",Zn,1,1),t("IMSINH",Wn,1,1),t("IMTAN",Qn,1,1)},"./src/functions-fin.ts":function(B,t,n){var L,a,F,P,G,t,I,A,U,v,H,h,u,z,V,m,T,b,w,x,M,Y,Z,W,Q,J,g,K,N,n,X,q,$,s,d,k,C,tt,nt,et,it,e,i,r,t,o,rt,ot,at,c,ut,st,f,ct,ft,lt,l,ht,dt,vt,mt,gt,pt,bt,yt,wt,Mt,Ct,St,Tt,At,It,xt,Nt;function S(t){return t.getMonth()}function D(t){return t.getDate()}function _(t){return t.getFullYear()}function kt(t,n){var e,e,e,e=_(t),e=new Date(e,n,1),e=d(_(e),S(e));D(t)>e&&t.setDate(e),t.setMonth(n)}function E(t){return t instanceof Date?L.Common.ct.o0(t):t}function p(t,n,e){var i,i,r,o,i=_(n)-_(t),i=S(n)-S(t)+12*i,r=D(n)-D(t),o=-1;return 0===e?o=a.Functions.Mkt(t,n):0<=I(e,[1,2,3])?o=E(n)-E(t):4===e&&(o=30*i+r),o}function Dt(t,n,e,i,r){var o,a,n,o=w(1+t,n),a=P(o)?o:N;return 0===t?n:!h(a)&&(n=P(o=(o-1)/t)?o:N,!h(n))&&P(o=(-e*a-i)/((1+t*r)*n))?o:N}function y(t,n,e,i){var r,o,a,u,s,c,f,l,r=_(n),o=S(n),a=D(n),u=new Date(1,0,1),s=0,c=a===d(r,o),f=12/e,l=r-_(t);for(u.setFullYear(1),0<l&&(l=(l-1)*e);kt(u=new Date(r,o,a),o-++l*f),c&&(s=d(_(u),S(u)),u=new Date(_(u),S(u),s)),k(t,u)<0;);return i&&(kt(u=new Date(r,o,a),o- --l*f),c)&&(s=d(_(u),S(u)),u=new Date(_(u),S(u),s)),u}function _t(t,n,e,i){return C(y(t,n,e,!1),t,i)}function j(t,n,e,i){var i,i=0<=I(i,[0,2,4,5])?360/e:3===i?365/e:C(y(t,n,e,!1),y(t,n,e,!0),1);return i}function Et(t,n,e,i){return C(t,y(t,n,e,!0),i)}function jt(t,n,e){var i,r,n,o,a,i=_(n),r=S(n),n=D(n),o=new Date(i,r,n),a=r-S(t)+12*(i-_(t));if(kt(o,S(o)-a),n===d(i,r))for(;D(o)!==d(_(o),S(o));)o.setDate(D(o)+1);return D(t)>=D(o)&&a--,G((1+a/(12/e)).toString())}function O(t,n,e){return 0<n?(e.Ckt?e.Skt?x(t-e.Tkt)<x(e.Akt-e.Tkt)&&(e.Akt=t,e.Ikt=n):n<e.Ikt&&(e.Akt=t,e.Ikt=n):(e.Akt=t,e.Ikt=n,e.Ckt=!0),[!1,e]):n<0?(e.Skt?e.Ckt?x(t-e.Akt)<x(e.Akt-e.Tkt)&&(e.Tkt=t,e.xkt=n):-n<-e.xkt&&(e.Tkt=t,e.xkt=n):(e.Tkt=t,e.xkt=n,e.Skt=!0),[!1,e]):isNaN(n)?[!1,e]:(e.Nkt=t,[!0,e])}function Ot(t,n,e,i,r){var o,a,u,o=y(t,e,i,!0),a=y(t,e,i,!1);if(0<=k(o,n))return C(t,n,r)/j(a,o,i,r);for(u=C(t,o,r)/j(a,o,i,r);;){if(a=new Date(_(o),S(o),D(o)),kt(o,S(o)+12/i),0<=k(o,n))return u+=C(a,n,r)/j(a,o,i,r);u+=1}}function Rt(t,n,e,i,r,o,a){for(var u,s,a,c,f,l,h,d,v,m,g,u=_t(t,n,o,a),s=Et(t,n,o,a),a=j(t,n,o,a),c=G(jt(t,n,o).toString()),f=0,l=100*e/o,h=1+i/o,d=s/a,v=0;v<c;v++)f+=l/w(h,d+v);return(m=r/w(h,c-1+s/a))+f-(g=u/a*l)}function Bt(t,n,e,i,r,o,a,u,s){var c,f,l,h,d,e,i,v,m,g,p,b,y,c=C(u,t,a),f=C(t,s,a),l=C(u,s,a),h=j(t,n,o,a),d=G(jt(t,n,o).toString()),e=100*e/o,i=1+i/o;if(h<f)switch(a){case 0:case 4:v=C(s,n,a),d=1+G(M(v/h).toString());break;default:for(m=new Date(_(s),S(s),D(s)),d=0;d<32767;d++)if(g=new Date(_(m),S(m),D(m)),kt(m,S(m)+12/o),0<=k(m,n)){d+=G((M(C(g,n,a))/j(g,m,o,a)).toString())+1;break}c=h*Ot(u,t,s,o,a),f=h*Ot(t,s,s,o,a),l=h*Ot(u,s,s,o,a)}return(p=r/w(i,d-1+f/h))+e*((b=l/h/w(i,f/h))+(y=w(i,-f/h)*(w(i,-d)-1/i)/(1/i-1))-c/h)}function Lt(t,n){var t,e,t=t.substr(0,3),e={ATS:13.7603,BEF:40.3399,DEM:1.95583,ESP:166.386,EUR:1,FIM:5.94573,FRF:6.55957,GRD:340.75,IEP:.787564,ITL:1936.27,LUX:40.3399,LUF:40.3399,NLG:2.20371,PTE:200.482,SIT:245.18};return e[t]?q(e[t],n):-1}function Ft(t,n,e,i,r){var o,a=w(1+t,n);return 0===t?o=(e+i)/n:(o=i*t/(a-1)+e*t/(1-1/a),0<r&&(o/=1+t)),-o}function Pt(t,n,e,i,r){var o=w(1+t,n),a;return-(0===t?i+e*n:i*o+e*(0<r?1+t:1)*(o-1)/t)}function Gt(t,n,e,i,r,o,a){if(o<r||e<o||0!==a&&1!==a)return N;var u=Ft(n,e,i,0,a),s=0,c,f;for(1===r&&(t&&(s=u),a<=0&&(s+=t?i*n:-i),r++),c=r;c<=o;c++)f=0<a?Pt(n,c-2,u,i,1)-u:Pt(n,c-1,u,i,0),s+=t?u-f*n:f;return t?s:s*n}function Ut(t,n,e,i){var i,t,i=w(1+e,i),t=-(t*i*e+n*(i-1));return P(t)?t:N}function Ht(t,n,e,i,r){return I(i,[1,2,4])<0||0<=k(n,e)?N:t(n,e,i,r)}function zt(t,n,e,i,r,o){function a(t,n,e,i){var r=0,o,a=0,u=100;for(t*=100/V(e),n/=e,n++,o=1;o<i;o++)r+=o*t/w(n,o);for(r+=i*(t+100)/w(n,i),o=1;o<i;o++)a+=t/w(n,o);return r=(r/=a+=(t+100)/w(n,i))/V(e)}var i;return I(o,[1,2,4])<0||0<k(n,e)?N:(i=a(i,r,o,jt(n,e,o)),t?i/(1+r/o):i)}function Vt(t,n,e,i,r,o,a,u,s){var c,f,i,n;if(I(a,[1,2,4])<0||0<k(n,e)||0<k(i,n))return N;for(c=new Date(_(i),S(i),D(i));kt(c,S(c)+12/a),k(c,e)<0;);return f=Ot(i,n,c,a,u),i=Ot(i,e,c,a,u),n=Ot(n,e,c,a,u),t?(o*a+100*r*(i-f*(1+s*n/a)))/(s*n+a):(a*(o-s)+100*r*(i-f))/(n*s+100*r*f*n/a)}function Yt(t,n,e){var i,r,n,o;return 0===e?g:(i=(n<0?M:W)(n),r=w(10,M(X.ckt(e,10))),n=n-i,u(i+(o=t?n*r/e:n*e/r)))}function Zt(t,n,e,i){var r,o,a,u,s,c,r=v(n),o=0,u=1+t,s=.75<=u&&u<=1.25&&12<r&&i?2.5:0;if(e)for(a=0;a<r;a++){if(c=-(a-s)*n[a]*Math.pow(u,-(a-s)-1),isNaN(c))return o;o+=c}else for(a=0;a<r;a++){if(c=n[a]*Math.pow(u,-(a-s)),isNaN(c))return o;o+=c}return o}function R(t,n,e,i){var r,o,a,u,r=0,o=v(n);for(t<=-1&&(t=1e-10-1),a=0;a<o;a++){if((u=E(i[a])-E(i[0]))<0)return[!1,e];r+=n[a]/X.kkt(t,u/365)}return P(r)?e=isNaN(r)?5e-324:r:r===Number.POSITIVE_INFINITY?e=$:r===Number.NEGATIVE_INFINITY&&(e=-$),[!0,e]}function Wt(t,n,e,i){var r,o,a;return-1<t&&0!==t?(o=w(1+t,(r=e).Dkt-(i?1:0)),a=(w(1+t,r.Dkt)-1)/t,[!0,n=i?-r._kt*a/t+o*r.Dkt*(r.Ekt+r._kt*(r.uit+1/t)):r.Ekt*o+r._kt*(1+t*r.uit)*a+r.jkt,e]):[!1,n,e]}function Qt(t,n,e,i,r,o,a,u,s,c,f,l,h,d,v){var m,g,p,r,b,y,e,w,M,m=0,g=0,p=e-r,r=e+r,b=2===t;if((p=p<o.Okt?e:p)===(r=r>o.Rkt?e:r))return b?[!1,i,o,a]:[!1,i,o];if(e=0===t?(y=n(a,u,s,p,f,l,h,d,v)-c,n(a,u,s,r,f,l,h,d,v)-c):1===t?(y=n(p,a,m,u),n(r,a,g,u)):(y=Wt(p,m,a),Wt(r,g,a)),A(y)){if(M=y[2],m=y[1],!(w=y[0]))return b?[w,i,o,M]:[w,i,o]}else m=y;if(A(e)){if(M=e[2],g=e[1],!(w=e[0]))return b?[w,i,o,M]:[w,i,o]}else g=e;return i=(g-m)/(r-p),b?[!0,i,o,M]:[!0,i,o]}function Jt(t,n,e,i,r,o,a,u,s,c,f,l,h){var d,t;return i<e.Okt||i>e.Rkt?[!1,e]:(e=(t=O(i,d=t?Zt(i,r):n(r,o,a,i,s,c,f,l,h)-u,e))[1],[!!t[0],e])}function Kt(t,n,e,i,r){if(!(n>t.Rkt)){var i=R(n,i,e,r);if(e=i[1],!i[0])return i[0];t=(i=O(n,e,t))[1],i[0]}}function Xt(t,n,e){var i,r,n,i=0;return n<t.Okt||n>t.Rkt?[!1,t,e]:(e=(r=Wt(n,0,e))[2],i=r[1],r[0]?(t=(n=O(n,i,t))[1],[!!n[0],t,e]):[r[0],t,e])}function qt(t,n,e,i,r,o,a,u,s,c){var f,l,h,d,v,m,g,p,l=0,h=t?15:2;if(e.Ckt&&e.Skt)for(d=x(e.Akt-e.Tkt)/(x(e.Akt)+x(e.Tkt)),f=0;f<100+4*h;f++)if(g=void(m=v=0),g=f%4==0?1:f%4==2?2:3,p=void 0,e=(p=t?an(e,i,d,l,0,g):n?un(!0,e,l,0,0,g,R,d,r,i,Qt):un(!1,e,l,0,0,g,Rt,d,o,a,u,i,r,s,c))[1],t&&(i=p[2]),l=t?p[3]:p[2],p[0])return t?[!0,e,i]:[!0,e];return t?[!1,e,i]:[!1,e]}function $t(t,n,e,i,r,o,a,u,s,c,f){var l,h,d,v,m,g,p,p,p,d=0,v=t?15:2;if(n.Ckt&&n.Skt)for(h=x(n.Akt-n.Tkt)/(x(n.Akt)+x(n.Tkt)),l=0;l<100+4*v;l++)if(p=void(g=m=0),p=l%4==0?1:l%4==2?2:3,n=(p=t?un(!0,n,d,m,g,p,Zt,h,b,e,Qt):un(!1,n,d,m,g,p,Bt,h,a,u,s,e,i,c,f,r,o))[1],d=p[2],m=p[3],!(t&&p[0]===T||!t&&U(p[0]))){if(p[0])return[!0,n];if(n=(p=O(m,g=t?Zt(m,e):Bt(e,i,a,m,s,c,f,r,o)-u,n))[1],p[0])return[!0,n];if((h=x(n.Akt-n.Tkt)/(x(n.Akt)+x(n.Tkt)))<n.Bkt)return n.xkt<g&&(g=n.xkt,m=n.Tkt),n.Ikt<g&&(m=n.Akt),n.Nkt=m,[!0,n]}return[!1,n]}function tn(t,n,e,i,r,o,a,u,s,c,f,l,h){for(var d,v,m,g,p,b,y,y,w,w,M,w,y,M,y,C,d,S,T,C,g=e.Bkt/2,b=!1,v=0;v<20;v++){if(i<e.Okt||i>e.Rkt){if(!t||e.Skt&&e.Ckt||!(i<=-1))return[!1,e];i=-1,b=!0}if(y=t?R(i,r,0,o):n(r,o,a,i,s,c,f,l,h)-u,A(y)){if(p=y[1],!(m=y[0]))return[m,e]}else p=y;if(e=(y=O(i,p,e))[1],y[0])return[!0,e];if(b)return[!1,e];if(w=e.Skt&&e.Ckt?x(e.Akt-e.Tkt):e.Rkt-e.Okt,w=(x(i)<1e-10?w:x(i))/1e6,M=0,e=(y=t?Qt(1,R,i,0,w,e,r,o):Qt(0,n,i,0,w,e,r,o,a,u,s,c,f,l,h))[2],M=y[1]<0?y[1]:-y[1],!(m=y[0]))return[m,e];if(0===M)return[!1,e];if((w=i-1.000001*p/M)===i)return e.Nkt=i,[!0,e];if(t&&e.Skt&&e.Ckt&&w<(M=(y=[e.Akt,e.Tkt])[0])==w<(y=y[1])&&(C=!0,y<M&&(M=(d=[y,M])[0],y=d[1],C=!1),S=(d=[e.Ikt,e.xkt])[0],T=d[1],w=M+x((C?S:T)/(T-S))*(y-M)),C=x(w-i)/(x(i)+x(w)),i=w,C<g)return e.Nkt=i,[!0,e]}return[!1,e]}function nn(t,n,e){for(var i,r,o,e,a,u,s,c,f,i=t.Bkt/2,r=0;0===n[r];)r++;for(o=n.slice(r),a=[!1,null],u=[e],.1!==e&&u.push(.1),u.push(-.1,.99*t.Rkt,t.Okt+.01),s=0;!a[0]&&s<u.length;s++)en(a=rn(F(t),o,u[s],i),o);if(!a[0]){for(c=0,s=1,f=o.length;s<f;s++)c+=o[s];e=-c/o[0]-1,a=rn(F(t),o,e,i)}return a}function en(t,n){var e,i,r,r;t[0]&&(i=15,"number"==typeof(e=t[1].Nkt)&&-10<e&&e<10&&(1<(r=e.toString()).indexOf("000000000000")||1<r.indexOf("999999999999"))&&(i=14),.001<(r=fn(e=L.Common.st.E8(e,i),n))||r<-.001)&&(t[0]=!1)}function rn(t,n,e,i){for(var r,o,a,a,o,a,r=0;r<32;r++){if(e<t.Okt||e>t.Rkt)return[!1,t];if(t=(a=O(e,o=Zt(e,n,!1,!0),t))[1],a[0])return[!0,t];if(0===(a=Zt(e,n,!0,!0)))return[!1,t];if((o=e-1.0000001*o/a)===e)return t.Nkt=e,[!0,t];if(a=x(o-e)/(x(e)+x(o)),e=o,a<i)return t.Nkt=e,[!0,t]}return[!1,t]}function on(t,n,e){for(var i,r,o,a,u,s,c,f,l,r=t.Bkt/2,i=0;i<100;i++){if(u=a=o=void 0,e<t.Okt||e>t.Rkt)return[!1,t,n];if(n=(f=Wt(e,c=s=0,n))[2],s=f[1],!(u=f[0]))return[u,t,n];if(t=(l=O(e,s,t))[1],l[0])return[!0,t,n];if(n=(f=Wt(e,0,n,!0))[2],c=f[1],!(u=f[0]))return[u,t,n];if(0===c)return[!1,t,n];if((o=e-1.000001*s/c)===e)return t.Nkt=e,[!0,t,n];if(a=x(o-e)/(x(e)+x(o)),e=o,a<r)return t.Nkt=e,[!0,t,n]}return[!1,t,n]}function an(t,n,e,i,r,o){var a,u,s,c,f,l,h,d,e,r;if(1===o){if(s=void 0,n=(c=Wt(a=(t.Akt+t.Tkt)/2,r,n))[2],r=c[1],!(u=c[0]))return[T,t,n,i];if(0===r)return[!0,t=O(a,r,t)[1],n,i];if(0===(s=Z(r*r-t.Ikt*t.xkt)))return[T,t,n,i]}else if(2===o){if(l=f=void 0,d=h=0,.1<e)return an(t,n,e,i,r,o=3);if(e=i%4,i++,0==e)f=t.Akt,h=t.Ikt;else if(2==e)f=t.Tkt,h=t.xkt;else if(n=(c=Wt(f=(t.Akt+t.Tkt)/2,h,n))[2],h=c[1],!(u=c[0]))return[T,t,n,i];if(n=(r=Qt(2,void 0,f,0,l=x(t.Akt-t.Tkt)/1e6,t,n))[3],t=r[2],d=r[1],!(u=r[0])||0===d)return[T,t,n,i];if((a=f-1.01*h/d)<t.Akt&&a<t.Tkt||a>t.Akt&&a>t.Tkt)return[T,t,n,i]}return[!1,t,n,i]}function un(t,n,e,i,r,o,a,u,s,c,f,l,h,d,v,m,g){var p,b,b,y,w,M,C,C,S;switch(o){case 0:i=n.Akt-n.Ikt*((n.Tkt-n.Akt)/(n.xkt-n.Ikt));break;case 1:if(i=(n.Akt+n.Tkt)/2,p=t?a(i,c,r,s):a(l,h,s,i,f,d,v,m,g)-c,A(p)){if(r=p[1],!p[0])return[T,n,e,i,r,o]}else r=p;if(0===r)return[!0,n=O(i,r,n)[1],e,i,r,o];if(0===(b=Z(r*r-n.Ikt*n.xkt)))return[T,n,e,i,r,o];i+=(i-n.Akt)*r/b;break;case 3:i=(n.Akt+n.Tkt)/2;break;case 2:if(b=void 0,w=void(y=0),M=0,.1<u)return un(t,n,e,i,r,o=3,a,u,s,c,f,l,h,d,v);if(C=e%4,e++,0==C)b=n.Akt,y=n.Ikt;else if(2==C)b=n.Tkt,y=n.xkt;else if(b=(n.Akt+n.Tkt)/2,p=t?a(b,c,y,s):a(l,h,s,b,f,d,v,m,g)-c,A(p)){if(y=p[1],!p[0])return[T,n,e,i,r,o]}else y=p;if(w=x(n.Akt-n.Tkt)/1e6,n=(C=t?f(1,a,b,0,w,n,c,s):Qt(0,a,b,0,w,n,l,h,s,c,f,d,v,m,g))[2],M=C[1],!C[0]||0===M)return[T,n,e,i,r,o];if((i=b-1.01*y/M)<n.Akt&&i<n.Tkt||i>n.Akt&&i>n.Tkt)return[T,n,e,i,r,o]}return p=t?a(i,c,r,s):a(l,h,s,i,f,d,v,m,g)-c,A(p)&&(r=p[1],!p[0])?[T,n,e,i,r,o]:(S=O(i,r,n))[0]?[!0,n,e,i,r,o]:(u=x(n.Akt-n.Tkt)/(x(n.Akt)+x(n.Tkt)))<n.Bkt?(n.xkt<r&&(r=n.xkt,i=n.Tkt),n.Ikt<r&&(r=n.Ikt,i=n.Akt),n.Nkt=i,[!0,n,e,i,r,o]):[!1,n,e,i,r,o]}function sn(t,n,e,i,r){r=r?1:0;var o=w(1+t,n),o;return u(-(o=0===t?e*n+i:i*o+e*(1+t*r)*(o-1)/t))}function cn(t,n){for(var e=0;e<v(n);e++)n[e]!==m&&(t*=1+n[e]);return t}function fn(t,n){for(var e,i,r,o,a,u,e=arguments,i=0,r=1,a=1;a<v(e);a++){if((u=z(e[a],1,!0,!0,!1,!0)).isError)return u[0];for(o=0;o<v(u);o++)u[o]!==m&&(i+=u[o]/w(1+t,r),r++)}return i}function ln(t,n,e,i,r){var n;return r=r?1:0,0===t?u(-(e*n+i)):(n=w(1+t,n),-1===t?g:u(-(i+e*(1+t*r)*(n-1)/t)/n))}function hn(t,n,e,i,r){var n,t,r;return 0<=k(t,n)||(n=p(t,n,r),t=s(t,r),n<=0)||t<=0||(r=1-i*n/t)<=0?N:e/r}function dn(t,n,e){var i=v(n),r,o=0,a;if(i!==v(e))return N;if(n.some(function(t){return t===m}))return K;for(a=0;a<i;a++)o+=n[a]/w(1+t,(e[a]-e[0])/365);return o}function vn(t,n,e,i,r,o){return Gt(!1,t,n,e,i,r,o)}function mn(t,n,e,i,r,o){return Gt(!0,t,n,e,i,r,o)}function gn(t,n,e,i,r,o){var a;return e+1<=n||0!==o&&1!==o?N:Ut(i,Dt(t,e,i,r,o),t,n-1)}function pn(t,n,e,i){return u(i*t*(n/e-1))}function bn(t,n,e,i,r){r=r?1:0;var o=w(1+t,n),o;return u(-(o=0===t?(e+i)/n:(e*o+i)/((1+t*r)*(o-1)/t)))}function yn(t,n,e,i,r,o){var e,r;return o=o?1:0,e+1<=n||(e=Dt(t,e,i,r,o),h(e))||(r=Ut(i,e,t,n-1),h(r))?N:e-r}function wn(t,n,e,i){return Ht(_t,t,n,e,i)}function Mn(t,n,e,i){return Ht(j,t,n,e,i)}function Cn(t,n,e,i){return Ht(Et,t,n,e,i)}function Sn(t,n,e){return E(y(t,n,e,!0))}function Tn(t,n,e){return Ht(Sn,t,n,e)}function An(t,n,e){return Ht(jt,t,n,e)}function In(t,n,e){return E(y(t,n,e,!1))}function xn(t,n,e){return Ht(In,t,n,e)}function Nn(t){var n;return d(t.getFullYear(),t.getMonth())===t.getDate()}function kn(t,n,e,i,r,o){var a,u,n,s,c,f,l,h,d,v,m,g;if(I(r,[1,2,4])<0||0<k(t,n))return N;for(a=jt(t,n,r),u=j(t,n,r,o),n=y(t,n,r,!1),s=C(n,t,o),0===o&&31===t.getDate()&&1===n.getMonth()&&Nn(n)&&s++,d=(h=100/(l=w(1+i/r,a-1+(f=(c=u-s)/u))))*(a-1+f),v=0;v<a;v++)h+=g=100*e/(r*w(1+i/r,m=v+f)),d+=g*m;return d/h/r}function Dn(t,n,e,i,r){return i<0||e<0?N:zt(!0,t,n,e,i,r)}function _n(t,n,e,i,r){return r=r?1:0,0===t?0===n?g:u(-(e+i)/n):u(Y((n*(1+t*r)-i*t)/(e*t+n*(1+t*r)))/Y(1+t))}function En(t,n,e,i,r,o,a){var u,s,c,f,l,h,d,f,v,m,s;if(I(o,[1,2,4])<0||0<k(t,n))return N;if((u=jt(t,n,o))<=1)return s=_t(t,n,o,a),c=Et(t,n,o,a),(h=r/100+e/o-(i/100+s/(f=j(t,n,o,a))*e/o))/(d=i/100+s/f*e/o)*(l=o*f/c);if(m=(s=tn(!(m={Okt:0,Rkt:1e3,Bkt:1e-10,Ckt:!(v=.1),Akt:0,Ikt:0,Skt:!1,Tkt:0,xkt:0,Nkt:0}),Rt,m,v,t,n,e,i,r,o,a))[1],!(f=s[0])){for(v=1e-10;v<m.Rkt;v*=2)m=Jt(!1,Rt,m,v,t,n,e,i,r,o,a)[1];m=(s=qt(!1,!1,m,t,n,e,i,r,o,a))[1],f=s[0]}return f?m.Nkt:N}function jn(t,n,e,i,r){return 0<=k(t,n)?N:(i/e-1)/tt(t,n,r)}function On(t,n,e,i,r,o){var a,u,s,c;return 0<=k(t,n)?N:(c=1+(a=tt(e,n,o))*i,c/=r/100+(u=tt(e,t,o))*i,c--,c/tt(t,n,o))}function Rn(t,n,e,i,r,o,a){function u(t,n,e,i,r,o,a){var u,s,c,f,s,s,l,s=1/o,s=s<3?1:s<5?1.5:s<=6?2:2.5;if(o*=s,s=tt(n,e,a),h(s))return 0;for(f=(t-=c=W(s*o*t+.5))-i,u=0;u<r;u++){if((f-=c=W(o*t+.5))<0)return 0==(l=r-u)||1==l?W(.5*t+.5):0;t-=c}return c}var s=1/o;return 0<s&&s<1||1<s&&s<2||2<s&&s<3||4<s&&s<5||0<k(n,e)?N:u(t,n,e,i,r,o,a)}function Bn(t,n,e,i,r,o,a){function u(t,n,e,i,r,o,a){var u,s,n,e,a,i,c,u=t*o,s=t-i,n=tt(n,e,a);return h(n)?0:(i=H(a=(t-i-(e=n*o*t))/u),0===r?e:r<=i?u*(a<1?a:1):r===i+1?s-u*i-e:0)}return 0<k(n,e)?N:u(t,n,e,i,r,o,a)}function Ln(t,n,e,i,r,o,a,u,s){var c,f,l,h,c=.1;if(I(u,[1,2,4])<0||0<k(e,t)||0<k(t,i)||0<k(i,n))return N;if(f=(l=tn(!(f={Okt:0,Rkt:1e3,Bkt:1e-10,Ckt:!1,Akt:0,Ikt:0,Skt:!1,Tkt:0,xkt:0,Nkt:0}),Bt,f,c,t,n,r,o,a,u,s,e,i))[1],h=l[0]){for(c=1e-10;c<f.Rkt;c*=2)f=Jt(!1,Bt,f,c,t,n,r,o,a,u,s,e,i)[1];f=(l=$t(!1,f,t,n,e,i,r,o,a,u,s))[1],h=l[0]}return h?f.Nkt:N}function Fn(t,n,e,i,r,o,a,u){return Vt(!1,t,n,e,i,o,a,u,r)}function Pn(t,n,e,i,r,o,a,u){return Vt(!0,t,n,e,i,o,a,u,r)}function Gn(t,n,e){var i,r,t,i=E(n)-E(t);return 0<=k(t,n)||365<i?N:0==(t=360-e*i)?g:t<0?N:u((r=365*e)/t)}function Un(t,n,e){var i=E(n)-E(t);return 0<=k(t,n)||365<i?N:(100-e)/e*(360/i)}function Hn(t,n){var e,i,r,o,a,u,s,c,f,n,e=v(t),i=[],r=!1,o=!1,a={Okt:-1,Rkt:9999999,Bkt:1e-10,Ckt:!1,Akt:0,Ikt:0,Skt:!1,Tkt:0,xkt:0,Nkt:0};for(1<x(n)&&(n=.1),u=-1,c=s=0;c<e;c++)(f=t[c])!==m&&(0!==f&&(s=i.length+1,-1===u)&&(u=i.length),i.push(f),0<f&&(r=!0),f<0)&&(o=!0);return i=i.slice(u,s+1),r&&o&&!(v(i)<2)&&(a=(n=nn(a,i,n))[1],n[0])?a.Nkt:N}function zn(t,n,e){var i,r,o,a,u,s,c,f,l,h,d,i=0,r=0,o=0,a=0,u=0,s=[],c=v(t);if(c<2)return g;for(f=0;f<c;f++)(l=t[f])!==m&&(s.push(l),o++,0!==l)&&(0<l?i++:r++);if(r<1||i<1)return g;for(h=0;h<o;h++)0!==(d=s[h])&&(0<d?a+=d/w(1+e,h):u+=d/w(1+n,h));return 0===u||0===a||e<=-1?g:w(-a*w(1+e,o)/(u*(1+e)),1/(o-1))-1}function Vn(t,n,e,i){for(var r,o,a,u,s,r=.5,o=e-.5,a=e+.5,u=0,s=0;0<R(o,t,0,n)[1]*R(a,t,0,n)[1]&&u<i;)u++,o-=.5,a+=.5;return i<=u?[0,0]:[o,a]}function Yn(t,n,e,i){for(var r,o,i,a,u,s,c,f,l,h,r=100,o=i.Bkt,i=i.Skt&&i.Ckt?[i.Akt,i.Tkt]:Vn(t,n,e,100),a=i[0],u=i[1],s=R(a,t,0,n)[1],c=R(u,t,0,n)[1],f=0,l=0;l<100&&!(0<s*c);l++)if((h=R(f=(a+u)/2,t,0,n)[1])*s<0?(u=f,c=h):(a=f,s=h),x(a-u)<o)return[!0,f];return[!1,f]}function Zn(t,n,e){var i,r,o,a,u,s,i,c,c,c,i=v(t),r;if(i!==v(n))return N;for(u=i-1;0<=u;u--)o=0<t[u]||o,a=t[u]<0||a,n[u]===m&&(0!==t[u]?n[u]=0:(t.splice(u,1),n.splice(u,1)));return o&&a?0===(s=t[0])?0===e?it:et:(i=(c=tn(!0,Qt,i={Okt:-1,Rkt:1e10,Bkt:1e-10,Ckt:!1,Akt:0,Ikt:0,Skt:!1,Tkt:0,xkt:0,Nkt:0},e,t,n))[1],c[0]?(c=i.Nkt,Math.abs(c)<i.Bkt?et:c):(c=Yn(t,n,e,i))[0]?c[1]:N):N}function Wn(t,n,e,i,r,o){var a,u,s,c,a,f;if(r=r?1:0,a=w(17976931348623157e282,1/t),s=(c=on(u={Bkt:1e-10,Ckt:!1,Akt:0,Ikt:0,Skt:!1,Tkt:0,xkt:0,Nkt:0,Okt:Q(-1e10,1-a),Rkt:J(1e10,a-1)},s={Dkt:t,_kt:n,Ekt:e,jkt:i,uit:r},o))[2],u=c[1],!(a=c[0])){for(f=2;(!u.Skt||!u.Ckt)&&f<100;f*=2)s=(c=Xt(u,o*f,s))[2],s=(c=Xt(u=c[1],o/f,s))[2],u=c[1];u=(c=qt(!0,!1,u,s))[1],a=c[0]}return a?u.Nkt:N}function Qn(t,n,e,i,r){var r,e,t,r=r/e,e=1<=r?(r=1)===i?t:0:t*w(1-r,i-1),t=t*w(1-r,i),r=e-(t<n?n:t);return r<0?0:r}function Jn(t,n,e,i,r,o){for(var a,u,s,c,f,l,h,d,v,a=0,u=0,s=M(r),c=s,f=t-n,l=!1,v=1;v<=c;v++)l?d=u:(h=Qn(t,n,e,v,o))<(u=f/(i-(v-1)))?(d=u,l=!0):f-=d=h,v===c&&(d*=r+1-s),a+=d;return a}function Kn(t,n,e,i,r,o,a){var u,s,c,f,l,h,d,a,v,u=W(i),s=u,c=M(r),f=c,l=0;if(a)for(h=s+1;h<=f;h++)d=Qn(t,n,e,h,o),h===s+1?d*=J(r,u+1)-i:h===f&&(d*=r+1-c),l+=d;else a=e,v=void 0,i!==W(i)&&1<o&&e/2<=i&&(v=i-e/2,i=e/2,r-=v,a+=1),t-=Jn(t,n,e,a,i,o),l=Jn(t,n,e,e-i,r-i,o);return l}function Xn(t,n,e,i,r,o,a){return r<i?N:t<n&&0===i&&1===r?t-n:Kn(t,n,e,i,r,o,a)}function qn(t,n,e,i,r,o,a){var u,s,c,f,l,h,d,v,m,g,p,b,y,w,M,C,S,T,A;if(I(o,[1,2,4])<0||0<=k(t,e))return N;if(1===o||0===a||4===a)return $n(t,n,e,i,r,o,a);for(u=t.getFullYear(),s=t.getMonth(),c=t.getDate(),f=e.getFullYear(),l=e.getMonth(),h=e.getDate(),d=n.getMonth(),v=n.getDate(),m=[],g=[],p=[],b=[31,28,31,30,31,30,31,31,30,31,30,31],y=0;y<o;y++)m[y]=(d+12*y/o)%12,g[y]=v<=b[m[y]]?v:b[m[y]],2===a?p[y]=360/o:3===a&&(p[y]=365/o);for(y=0;y<o;y++)M=m[y]<m[w=y===o-1?0:y+1]?2001:2002,p[y]=E(new Date(M,m[w],g[w]))-E(new Date(2001,m[y],g[y]));for(C=0,S=E(e);u<f||u===f&&s<l||u===f&&s===l&&c<h;){for(y=0;y<o&&(s<m[y]||s===m[y]&&c<g[y])&&(0===y||m[y-1]<m[y]);)y++;for(;y<o&&(m[y]<s||s===m[y]&&g[y]<=c)&&(s!==m[++y-1]||c!==g[y-1]););w=--y===o-1?0:y+1,M=12<=s+12/o?u+1:u,T=E(new Date(u,s,c)),C+=r*i/o*((A=Math.min(E(new Date(M,m[w],g[w])),S))-T)/p[y],u=M,s=m[w],c=g[w]}return C}function $n(t,n,e,i,r,o,a){var e=p(t,e,a),t=s(t,a);return e<0||t<=0?N:r*i*(e/t)}function te(t,n,e,i,r){var n,t;return 0<k(t,n)||(n=p(t,n,r),t=s(t,r),n<0)||t<=0?N:i*e*n/t}function ne(t,n,e,i,r){var o,t;return 0<=k(t,n)||(o=s(t,r),(t=p(t,n,r))<=0)||o<=0?N:(i-e)/i*(o/t)}function ee(t,n){return w(1+t/n,n)-1}function ie(t,n,e,i,r){var n,t;return 0<=k(t,n)||(n=p(t,n,r),t=s(t,r),n<=0)||t<=0?N:(i-e)/e*(t/n)}function re(t,n){return n*(w(1+t,1/n)-1)}function oe(t,n,e,i,r){var o,a,u,s,c,o;if(e+(r<12?1:0)<i)return N;if(0===t)return 0;for(a=q(1-w(n/t,1/e),3),s=u=0,c=1;c<=i;c++)u+=s=1===c?t*a*r/12:c===e+1?(t-u)*a*(12-r)/12:(t-u)*a;return s}function ae(t,n,e,i,r){var o,a,u,o=0,a=0;if(e<i)return N;if(t<=n)return 0;for(u=1;u<=i;u++)o+=a=J(a=r/e*(t-o),t-o-n);return a}function ue(t,n,e){return(t-n)/e}function se(t,n,e,i){return e<i?N:(t-n)*(e-i+1)*2/(e*(e+1))}function ce(t,n){return n<1?g:Yt(!0,t,n)}function fe(t,n){return 0===n?g:Yt(!1,t,n)}function le(t,n,e,i,r,o,a){return I(o,[1,2,4])<0||0<k(t,n)?N:Rt(t,n,e,i,r,o,a)}function he(t,n,e,i,r){var n,t;return 0<=k(t,n)||(n=p(t,n,r),t=s(t,r),n<=0)||t<=0?N:i-e*i*n/t}function de(t,n,e,i,r,o){var a,n,e,t,o;return 0<=k(t,n)||(a=p(t,n,o),n=p(e,n,o),e=p(e,t,o),t=s(t,o),e<=0)||t<=0||a<=0||n<=0||0==(o=1+a/t*r)?N:(100+n/t*i*100)/o-e/t*i*100}function ve(t,n,e,i,r,o,a,u,s){return I(u,[1,2,4])<0||0<k(e,t)||0<k(t,i)||0<k(i,n)?N:Bt(t,n,r,o,a,u,s,e,i)}function me(t,n,e){var i=E(n)-E(t);return 0<=k(t,n)||365<i?N:100*(1-e*i/360)}function ge(t){var t=Lt(t,2);return 0<=t?t:N}function pe(t,n,e,i,r){var o,r,n,e;function a(t){var t,n,t=t.substr(0,3),n;return 0<=I(t,["BEF","LUF","ESP","ITL","PTE","GRD","LUX"])?0:2}function u(t){var t,n,t=t.substr(0,3),n;return 0<=I(t,["BEF","LUF","ESP","ITL","LUX"])?0:2}return o=0,i||(o=u(e)),r.ekt||(r.y4=a(n)),n=Lt(n,r.y4),e=Lt(e,r.y4),0<=n&&0<=e?(r=t*e/n,i?r:q(r,o)):K}function be(t,n,e,i){var r,o,a;return(""!==t||""!==n||""!==e)&&(t=nt(t,r={value:0}),n=nt(n,o={value:0}),e=nt(e,a={value:0}),!0===t)&&!0===n&&!0===e?i(r,o,a):K}function ye(t,n,e){return be(t,n,e,function(t,n,e){var e,n;return 0<n.value&&0<t.value&&0<e.value?(e=(Math.log(e.value)-Math.log(n.value))/Math.log(1+t.value),(n=Math.abs(e))<=179769e303?22250738585072014e-324<=n?e:0:g):N})}function we(i,t,n){return be(i,t,n,function(t,n,e){if(0<n.value&&0<t.value&&0<=e.value){i=Math.pow(e.value/n.value,1/t.value)-1;var e=Math.abs(i);if(e<=179769e303)return 22250738585072014e-324<=e?i:0}return N})}Object.defineProperty(t,"__esModule",{value:!0}),L=n("Common"),a=n("CalcEngine"),F=L.Common.lt.tv,P=isFinite,G=parseInt,t=L.Common.lt,I=t.Rh,A=t.Nh,U=t.ht,v=L.Common.Uf.tR,H=a.Convert.z6t,h=a.Convert.BJ,u=a.Convert.L6t,z=a.Convert.iV,V=a.Convert.uJ,m=a.Convert.CalcConvertedError,T=null,b=void 0,w=Math.pow,x=Math.abs,M=Math.ceil,Y=Math.log,Z=Math.sqrt,W=Math.floor,Q=Math.max,J=Math.min,g=a.Errors.DivideByZero,K=a.Errors.Value,N=a.Errors.Number,n=a.Functions.F6t,X=a.Functions.MathHelper,q=X.Lkt,$=a.Functions.B6t,s=a.Functions.Fkt,d=a.Functions.Pkt,k=a.Functions.Gkt,C=a.Functions.Ukt,tt=a.Functions.Hkt,nt=a.Convert.sJ,et=2.98023e-9,it=4.88281e-9,t={J6t:0,pkt:"< 1"},o={J6t:0,pkt:"< 0"},rt={bkt:.1,J6t:0},ot={bkt:2,J6t:0},at={bkt:1e3,J6t:0,pkt:"<= 0"},st={bkt:!(ut={J6t:5}),J6t:7},lt={bkt:0,J6t:2},dt={J6t:2,pkt:"= 0",zkt:g},mt={J6t:4,X6t:1,Vkt:!0,Ykt:!0},gt={J6t:4,X6t:1,Vkt:!0,Zkt:!0,Ykt:!0},pt={J6t:4,X6t:4,Vkt:!0,Ykt:!0,Zkt:!0,breakOnConvertError:!0},bt={J6t:4,X6t:1,Vkt:!0,Ykt:!0,breakOnConvertError:!0},yt={J6t:4,X6t:11,Vkt:!0,Ykt:!0,breakOnConvertError:!0},wt=[c={J6t:6},c,f={J6t:2},l={bkt:0,J6t:2,pkt:["< 0","> 4"]}],Mt=[c,c,e={J6t:0},e,f,l],Ct=[c,c,r={J6t:0,pkt:"<= 0"}],St=[e,c,c,e,f,r,ht={bkt:0,J6t:2,pkt:["< 0","> 4","= 2"]}],At=[c,c,r,r,l],It=[r,ct={J6t:2,pkt:"<= 0"},r,ft={J6t:2,pkt:"< 1"},f,f],xt=[r,ft],Nt=[e,vt={J6t:2,pkt:"< 0"}],n("FV",sn,3,5,Tt=[e,e,e,i={bkt:0,J6t:0},i],b,b,{wkt:[3,4]}),n("FVSCHEDULE",cn,2,2,[e,mt],1,1),n("NPV",fn,2,b,e,"> 0","> 0"),n("PV",ln,3,5,Tt,b,b,{wkt:[3,4]}),n("RECEIVED",hn,4,5,At,b,b,{wkt:3}),n("XNPV",dn,3,3,[e,bt,bt],"!= 0","!= 0"),n("CUMIPMT",vn,6,6,It),n("CUMPRINC",mn,6,6,It),n("IPMT",gn,4,6,[e,t,t,e,i,lt],b,b,{wkt:[4,5]}),n("ISPMT",pn,4,4,[e,f,dt,e]),n("PMT",bn,3,5,[e,{J6t:0,pkt:"= 0",zkt:g},e,i,i],b,b,{wkt:[3,4]}),n("PPMT",yn,4,6,[e,t,e,e,i,i],b,b,{wkt:[4,5]}),n("COUPDAYBS",wn,3,4,wt,b,b,{wkt:3}),n("COUPDAYS",Mn,3,4,wt,b,b,{wkt:3}),n("COUPDAYSNC",Cn,3,4,wt,b,b,{wkt:3}),n("COUPNCD",Tn,3,4,wt,b,b,{wkt:3}),n("COUPNUM",An,3,4,wt,b,b,{wkt:3}),n("COUPPCD",xn,3,4,wt,b,b,{wkt:3}),n("DURATION",kn,5,6,Mt,b,b,{wkt:5}),n("MDURATION",Dn,5,6,Mt,b,b,{wkt:5}),n("NPER",_n,3,5,[{J6t:0,pkt:"<= -1"},e,e,i,i],b,b,{wkt:[3,4]}),n("YIELD",En,6,7,[c,c,o,r,r,f,l],b,b,{wkt:6}),n("YIELDDISC",jn,4,5,[c,c,r,r,l],b,b,{wkt:3}),n("YIELDMAT",On,5,6,[c,c,c,o,r,l],b,b,{wkt:5}),n("AMORDEGRC",Rn,6,7,St,b,b,{wkt:6}),n("AMORLINC",Bn,6,7,St,b,b,{wkt:6}),n("ODDFYIELD",Ln,8,9,[c,c,c,c,o,r,r,f,l],b,b,{wkt:8}),n("ODDLYIELD",Fn,7,8,[c,c,c,o,r,r,e,l],b,b,{wkt:7}),n("ODDLPRICE",Pn,7,8,[c,c,c,o,o,r,f,l],b,b,{wkt:7}),n("TBILLEQ",Gn,3,3,Ct),n("TBILLYIELD",Un,3,3,Ct),n("IRR",Hn,1,2,[gt,rt],0,0,{wkt:1}),n("MIRR",zn,3,3,[gt,e,e],0,0),n("XIRR",Zn,2,3,[yt,pt,rt],"!= 2","!= 2",{wkt:2}),n("RATE",Wn,3,6,[r,e,e,i,{bkt:0,J6t:2,pkt:"< 0",zkt:K},rt],b,b,{wkt:[3,4,5]}),n("VDB",Xn,5,7,[o,o,vt,o,o,ot,st],b,b,{wkt:[5,6]}),n("ACCRINT",qn,6,8,[c,c,c,r,at,f,l],b,b,{wkt:[4,6,7]}),n("ACCRINTM",te,3,5,[c,c,r,at,l],b,b,{wkt:[3,4]}),n("DISC",ne,4,5,[c,c,r,r,l],b,b,{wkt:3}),n("EFFECT",ee,2,2,xt),n("INTRATE",ie,4,5,At,b,b,{wkt:3}),n("NOMINAL",re,2,2,xt),n("DB",oe,4,5,[o,e,ft,ft,{bkt:12,J6t:2,pkt:["< 1","> 12"]}],b,b,{wkt:3}),n("DDB",ae,4,5,[o,e,ct,ct,{bkt:2,J6t:0,pkt:"<= 0"}],b,b,{wkt:3}),n("SLN",ue,3,3,[e,e,dt]),n("SYD",se,4,4,[e,o,ft,ct]),n("DOLLARDE",ce,2,2,Nt),n("DOLLARFR",fe,2,2,Nt),n("PRICE",le,6,7,[c,c,o,o,r,f,l],b,b,{wkt:6}),n("PRICEDISC",he,4,5,At,b,b,{wkt:3}),n("PRICEMAT",de,5,6,[c,c,c,o,o,l],b,b,{wkt:5}),n("ODDFPRICE",ve,8,9,[c,c,c,c,o,o,r,f,l],b,b,{wkt:8}),n("TBILLPRICE",me,3,3,[c,c,r]),n("EURO",ge,1,1,ut),n("EUROCONVERT",pe,3,5,[e,ut,ut,st,{ykt:!0,J6t:2,bkt:3,pkt:"< 3",zkt:K}],b,b,{wkt:[3,4]}),n("PDURATION",ye,3,3),n("RRI",we,3,3)},"./src/functions-lookup.ts":function(b,t,n){var e,r,I,y,w,M,L,t,v,F,C,P,S,G,m,x,T,A,o,U,N,k,H,D,_,z,p,V,Y,n,a,E,Z,W,Q,J,u,K,s,X,q,$,tt,nt,t,i,e,et,c,it,rt,ot,f,l,at,ut,st;function ct(t,n,e){return t&&1===n&&1===e&&null===t[0][0]}function ft(t){return N(t)||k(t)||Array.isArray(t)}function lt(t,n,e,i){return{row:t,col:n,rowCount:e,colCount:i}}function j(t,n,e){var i,r;return C(t)?y:t.isArray||t.isReference?((i=t.colCount)<n&&(r=n,n=e,e=r),t[e*i+n]):t[0]}function O(t,n,e,i){return e&&(null===t||null===n)||!C(n)&&((C(t)||o(t,!0))&&o(n,!0)||a(t)&&a(n)||i&&(E(t)&&o(n)||E(n)&&o(t))||E(t)&&E(n))}function ht(t,n,e,i,r){if(t<0||n<0||n<t||e<t||n<e)return-1;if(r)Q=t,J=n,K=u=e,X=s=i;else if(s){if(J<++u){if(s!==X)return-1;u=K-1,s=!1}}else if(--u<Q){if(s!==X)return-1;u=K+1,s=!0}return u}function dt(t,n,e){var t=F(t),e=e;return t===n?e=0:n<t?e=1:t<n&&(e=2),e}function R(t,n,e){var e,e,t;return t===n?0:E(t)?n||0!==S(t)?o(n)&&!o(t)?1:a(n)?2:E(n)?((e=(0,I.Wkt)(t,n,e))<0?e=2:0<e&&(e=1),e):n instanceof Date?dt(t,n,1):-1:0:E(n)?t||0!==S(n)?o(t)?2:a(t)?1:t instanceof Date?dt(t,n,2):-1:0:a(t)&&o(n)?1:a(n)&&o(t)?2:(e=U(t),t=U(n),(e=v(e,15))===(t=v(t,15))?0:e<t?2:1)}function d(t,n,e){var t=j(t,n,e);return C(t)?0:t}function h(t,n,e,i){var r,o,a,u,s,c,f,l,h,r=-1,a=0,u=-1,s=-1,o=i?n.rowCount:n.colCount;if(--o<a)return-1;for(;a<=o;){for(c=y,f=void 0,l=t[0],1<=e!=(2===r)&&(u=s),f=s=ht(a,o,s=T((a+o)/2),0<=e,!0);!O(l,c)&&-1!==s&&!O(l,c=i?j(n,0,s):j(n,s,0));)s=ht(0,0,0,!1,!1),0<=e&&s<f?o=s:e<0&&f<s&&(a=s);if(-1===s&&1<=e!=(2===r))return u;if(-1===s)return-1;if(r=R(l,c,!1),1<=e&&1===r)a=s+1;else if(1<=e&&2===r)o=s-1;else if(e<=-1&&1===r)o=s-1;else if(e<=-1&&2===r)a=s+1;else if(0===r){for(;e<=-1&&a<s||0<=e&&s<o;){if(h=(h=0)<=e?s+1:s-1,null===(c=i?d(n,0,h):d(n,h,0)))return-1;if(!O(l,c))break;if(0!==(r=R(l,c,!1)))break;s=h}return s}}return 1<=e!=(2===r)?s:u}function vt(t,n,e){var i,r,n,t,o,a,u,s,c,f,l,h,d,i=n,r=t[0],n=E(r);if(r===y&&(r=0),(t=i.Qkt=i.Qkt||{})[o=(e?n?"0":"1":n?"2":"3")+r])return t[o];if(a=M.tbt(r),s=-1,n&&a&&(u=M.OJ(a)),c=e?i.rowCount:i.colCount,f=e?i.colCount:1,a){for(l=0;l<c;l++)if(u.lastIndex=0,u.test(i[l*f])){s=l;break}}else if(n){for(r=r.toLowerCase(),l=0;l<c;l++)if((h=i[l*f])&&h.toLowerCase&&h.toLowerCase()===r){s=l;break}}else for(r instanceof Date&&(r=m(r)),d=v(r,15),l=0;l<c;l++)if((h=(h=i[l*f])instanceof Date?m(h):h)===r||v(h,15)===d){s=l;break}return t[o]=s}function mt(t,n,e,i,r,o,a,u){var s,c,f,l,h,d,v,m,g,p,b,c,s=y,h=-1,m=t[0],g=E(m),p=!u&&M.tbt(m),f=i?n.rowCount:n.colCount;for(g&&p&&(d=M.OJ(p)),l=0;l<f;l++)if(b=r?f-1-l:l,O(m,v=i?j(n,0,b):j(n,b,0),o,a))if(c=E(v),c=g&&c&&p?(d.lastIndex=0,d.test(v)?0:1):R(m,v,!1),1<=e&&1===c)c=-1,0<=h&&(c=R(v,s,!1)),(h<0||0<=h&&1===c)&&(h=b,s=v);else if(e<=-1&&2===c)c=-1,0<=h&&(c=R(v,s,!1)),(h<0||0<=h&&2===c)&&(h=b,s=v);else if(0===c)return b;return h}function gt(t,n){var e,i,r,o,a;if(!n)for(e=S(t),i=void 0,i=1;i<e;i++)if(2===(a=R(r=t[i-1],o=t[i],!1)))return;return 1}function pt(t,n,e,i,r,o){var t,a,t=ut.call(this,t,[lt(n,e,i,r)])||this;return t.getValue=function(t,n,e){var i=this,r=i.uit,r,r=0===r?i.getRow(0)+1+n:1===r?i.getColumn(0)+1+e:q.getValue.call(i,t,n,e);return r},(a=t).Ky=n,a.yft=e,a.Sx=i,a.Cyt=r,a.uit=o,t}function g(t){var n=st.call(this,w)||this;return n.Kkt=t,n}function bt(t,n,e){var i,r,o,a,u,s;if(!t)return D;if(!(n=(i=n!==w)?n:t.getReference(t.source,lt(t.row,t.column,t.rowCount,t.columnCount)))||1!==n.getRangeCount())return D;if(a=[],e){if(u=n.getRow(0)+1,1<(o=n.getRowCount(0))){for(r=0;r<o;r++)a.push([u+r]);return new I.CalcArray(a)}return u}if(s=n.getColumn(0)+1,1<(o=n.getColumnCount(0))){for(r=0;r<o;r++)a.push(s+r);return new I.CalcArray([a])}return s}function yt(t,n,e,i,r,o){var a,u,s,a,c,s,u,r;return t&&e instanceof I.CalcReference?(c=t.source&&t.source.Lbt.dynamicReferences,s=e.getRowCount(0),a=e.getColumnCount(0),u=e.create([{row:e.getRow(0),col:e.getColumn(0),rowCount:o?s:1,colCount:o?1:a}]),c&&Lt(t,e,u.getRow(0),u.getColumn(0),u.getRowCount(0),u.getColumnCount(0),o&&e.$gt[0].rowUndefine,!o&&e.$gt[0].colUndefine)):(e instanceof I.CalcArray?(s=e.getRowCount(),a=e.getColumnCount()):Array.isArray(e)&&(s=e.rowCount,a=e.colCount),u=e),o&&a<i||!o&&s<i||(u.Zbt=!0,(a=I.Convert.iV(u,0,!0,!1,!1)).isError)||a.isConvertError?_:0<=(s=r||r===w?h(n,a,1,o):vt(n,a,o))?t&&e instanceof I.CalcReference?(u=o?s:i-1,r=o?i-1:s,c&&Lt(t,e,e.getRow(0)+u,e.getColumn(0)+r,1,1),e.getValue(0,u,r)):o?d(a,i-1,s):d(a,s,i-1):p}function wt(t,n){return bt(t,n,!0)}function Mt(t,n){return bt(t,n,!1)}function Ct(t){return ft(t)?I.CalcArrayHelper.getRowCount(t):1}function St(t){return ft(t)?I.CalcArrayHelper.getColumnCount(t):1}function Tt(t){return new tt(t)}function At(t,n,e,i,r){return yt(t,n,e,i,r,!1)}function It(t,n,e,i,r){return yt(t,n,e,i,r,!0)}function xt(t,n,e,i,r,o){var a,u,s,c,f,l,h,d,u,v,m,g,a,t,n,r,o,i,a=n.getRowCount(),u=n.getColumnCount(),s=1===a&&1===u,c=e.getRowCount(),f=e.getColumnCount(),l=1===a&&1<=u,h=1===c&&1<=f;if(s){if(1<c&&1<f)return D}else if(l&&u!==f||!l&&a!==c)return D;if((d=_t(t,I.Convert.iV(n,0,!0),r,o))===p)return u="string"==typeof i?i:p,s?u:new I.CalcArray([[u]]);if(d===D)return D;if(0<d){if(s)return e;if(d-=1,v=[],I.Convert.Nh(e)){if(l)for(m=0;m<c;m++)g=e.getValue(0,d),v.push([g]);else a=h?[e.getValue(0,d)]:[e.getValue(d,0)],v.push(a);return new I.CalcArray(v)}return e instanceof I.CalcReference?(n=(t=e).getRow(),r=t.getColumn(),o=c,i=f,l?(r=t.getColumn()+d,i=1):(n=t.getRow()+d,o=1),t.create([{row:n,col:r,rowCount:o,colCount:i}])):void 0}}function Nt(t,n,e){var i,r,o,a,u,s,t,a,i=[];if(n)for(r=0;r<n.length;r++)i.push(n[r]);if(n.colCount<=n.rowCount?(i.colCount=n.colCount,i.rowCount=Math.ceil(i.length/i.colCount)):(i.rowCount=n.rowCount,i.colCount=Math.ceil(i.length/i.rowCount)),C(n.isReference)||(i.isReference=n.isReference),C(n.isArray)||(i.isArray=n.isArray),i.rangeCount=n.rangeCount,o=-1,u=i.colCount,s=i.rowCount,t=t,e===w)return a=s<u?At(w,t,i,s,!0):It(w,t,i,u,!0),x(a)?p:a;if(a=I.Convert.iV(e,0,!0,!1,!1)){if(1<a.colCount&&1<a.rowCount)return p}else a=i;return 0<=(o=h(t,i,1,u<=s))?(u=a.colCount,(s=a.rowCount)<u?d(a,o,s-1):d(a,u-1,o)):p}function kt(t){var n=arguments;return t<1||S(n)<=t?D:C(n[t])?0:n[t]}function Dt(t,n,e){var t,n,i,r,o,t=t,n=n;return!n.isArray&&!n.isReference||(i=n.colCount,r=n.rowCount,o=-1,1<i&&1<r)||1===e&&!gt(n,!0)||-1===e&&!gt(n,!1)||(e===w?e=1:e===y&&(e=0),1===e?o=h(t,n,1,1<r):0===e?o=vt(t,n,1<r):-1===e&&(o=h(t,n,-1,1<r)),-1===o)?p:o+1}function _t(t,n,e,i){var n,r,o,a,u,a,u,t,s,c,f,s,r,n=n;if(!n.isArray&&!n.isReference)return p;if(r=n.colCount,o=n.rowCount,1<r&&1<o)return D;if(2===e&&(2===i||-2===i))return D;if(a=2===i&&!gt(n,!0),u=-2===i&&!gt(n,!1),a||u)return p;if(u=(a=t)&&t[0],t=-1,C(e)&&(e=0),-1===(i=!C(i)&&0!==i?i:1)&&(s=!0),0!==e&&2!==e||(c=0),1===i||-1===i){if(1===e)c=-1;else if(-1===e){if(M.jJ(u))return p;c=1}t=mt(a,n,c,1<o,s,!0,!0,0===e)}else if(2===i||-2===i){if(1===r&&1===o){if(!O(u,s=n[f=0]))return p;if(0===(r=R(u,s,!1)))return 1;if(0===e)return 0===r?1:p;if(1===e)return 2===r?1:p;if(-1===e)return 1===r?1:p}t=h(a,n,c=2===i?1:-1,1<o)}return-1!==t&&(0!==e||qt(u,n[t]))?!qt(u,n[t])&&(2===i&&1===e||-2===i&&-1===e)?t+2:t+1:p}function Et(t,n,e,i){return t+=n,i?0!==e&&(t=(t+="[")+e.toString()+"]"):t+=e,t}function jt(t,n,e){return e||(t+="$"),t+=n}function Ot(t,n,e){e||(t+="$");for(var i=t.length;.1<n;n=parseInt(((n-1)/26).toString(),10))t=r.Common.zf.Eit(t,i,String.fromCharCode("A".charCodeAt(0)+(n-1)%26));return t}function Rt(t,n){if(n&&0<S(n)){for(var e=void 0,i=!(0,I.Swt)(n[0])&&"_"!==n[0],e=1;!i&&e<S(n);e++)i=!(0,I.Jkt)(n[e])&&"_"!==n[e];i?t=(t+="'")+n.replace("'","''")+"'":t+=n,t+="!"}return t}function Bt(t,n,e,i,r){var o,a,u,o=3===e||4===e||7===e||8===e,a=2===e||4===e||6===e||8===e,u="";return t<1&&(i||!o)||Z<t||n<1&&(i||!a)||W<n||e<1||8<e?D:(u=Rt(u,r),i?jt(u=Ot(u,n,a),t,o):(u=Et(u,"R",t,o),Et(u,"C",n,a)))}function Lt(t,n,e,i,r,o,a,u){var t,n,s,c,f,l,s;t&&t.identity&&(t=t.Xkt,n=n.getSource(),t)&&n.getRangeKey&&(s=e,c=i,f=r,l=o,a&&(s=f=-1),u&&(c=l=-1),s=n.getRangeKey(n,{id:n.id,row:s,col:c,rowCount:f,colCount:l}),t.qkt||(t.qkt={}),t.qkt[s]={id:n.id,row:e,col:i,rowCount:r,colCount:o,rowUndefine:a,colUndefine:u})}function Ft(t,n,e,i,r){var o,a,u,s,c,f,l,h,d,v,m,g,p,c,u;function b(t){return!C(t)&&!t._error}if(u=(a=t)!==(o=y)&&a.acceptsReference,s=a!==y&&a.arrayFormulaMode,!ft(n))return e=e!==w?T(e):0,i=i!==w?T(i):0,e<0||i<0?D:1<e||1<i?_:n;if(n instanceof I.CalcReference){if(c={value:-1},f=n,(r=b(r=r===w?1:r)&&A(r,c)?c.value-1:o)>=f.getRangeCount())return _;if(r===o||r<0)return D;if(l=f.getRowCount(r),h=f.getColumnCount(r),d=f.getRow(r),v=f.getColumn(r),g=m=void 0,3===S(arguments)){if(1!==l&&1!==h)return _;1!==h?(i=e,e=1):1!==l&&(i=1)}if(-1===(e=b(e=C(e)?0:e)&&A(e,c)?c.value-1:o)){if(1!==l&&!u&&!s&&(d>a.row||a.row>=d+l))return D}else{if(e<-1||e===o)return D;if(l<=e&&!n.$gt[0].rowUndefine)return _;m=e+d}if(-1===(i=b(i=C(i)?0:i)&&A(i,c)?c.value-1:o)){if(1!==h&&!u&&!s&&(v>a.column||a.column>=v+h))return D}else{if(i<-1||i===o)return D;if(h<=i&&!n.$gt[0].colUndefine)return _;g=i+v}return-1===e&&-1===i?(m=d,g=v):-1===e?(m=d,h=1):l=-1===i?(g=v,1):h=1,(p=t.source&&t.source.Lbt.dynamicReferences)&&Lt(t,f,m,g,l,h,-1===e&&n.$gt[0].rowUndefine,-1===i&&n.$gt[0].colUndefine),(c=t.WK)&&c.Uue&&c.Uue(m,g,f.rT),f.create([lt(m,g,l,h)])}return I.Convert.Nh(n)?(l=(u=n).getRowCount(),e=e!==w?T(e):-1,i=i!==w?T(i):-1,1!==(r=r!==w?T(r)-1:1)?_:(-1===e&&-1===i?e=i=0:-1===i&&1===l&&(i=e,e=1),e=-1===e?0:e,i=-1===i?0:i,l=u.getRowCount(),h=u.getColumnCount(),e<0||i<0||r<0?D:(l<e&&1===l&&i===w&&(i=e,e=0),l<e||h<i?_:0===e&&0===i?u.slice(0,0,l,h):0===e?u.slice(0,i-1,l,1):0===i?u.slice(e-1,0,1,h):u.getValue(e-1,i-1)))):void 0}function Pt(t,n,e,i,r,o){var a,u,e,i,r;return t?n&&n instanceof I.CalcReference&&1===n.getRangeCount()?(a=r!==w?T(r):n.getRowCount(0),u=o!==w?T(o):n.getColumnCount(0),e=n.getRow(0)+e,i=n.getColumn(0)+i,a<0&&(e+=a+1,a=Math.abs(a)),u<0&&(i+=u+1,u=Math.abs(u)),Lt(t,n,e,i,a,u,C(r)&&n.$gt[0].rowUndefine,C(o)&&n.$gt[0].colUndefine),e<0||i<0?_:((r=t.WK)&&r.Uue&&r.Uue(e,i,n.rT),n.create([{row:e,col:i,rowCount:a,colCount:u}]))):D:p}function Gt(t,n,e){var i,r,o,a,u,s,c,f,o,e,u,a,s;return t?!n||"!"===n[0]||(o={row:i=t.row,col:r=t.column},a=(a=t.parser)||(t.parser=new I.Parser),(s=(u=t.source).parserContext)?(s.useR1C1=!e,s.row=o.row||0,s.column=o.col||0,s.baseIdentity=o,s.source=t.source):(u.parserContext=s=t.source?t.source.getParserContext(!e,o):new I.ParserContext(t.source,!e,o),s.onlyValidateSourceNameWithSpecial=!0),e?c=a.parse(s,n):(c=(o=(o=u.expressions)||(u.expressions={}))[n])||(c=a.parse(s,n),o[n]=c),!c)||(e=!1,7===c.type&&"ANCHORARRAY"===c.functionName&&(c=c.arguments[0],e=!0),!(c=8===c.type?c.source?(f=c.source).getCustomName(c.value):t.getName(c.value):c))||L.Rh(c.type,[1,13])<0?_:(f=c.source||t.source,25===c.type||26===c.type?f.getValueByName(c.nameIdentity):(u=c.getRange(i,r),a=null,a=(f=13===c.type?c.source:f).getReference(u),Lt(t,a=e?a.getSpillRef():a,a.getRow(0),a.getColumn(0),a.getRowCount(0),a.getColumnCount(0),a.$gt[0].rowUndefine,a.$gt[0].colUndefine),(s=t.WK)&&s.Uue&&s.Uue(c),a)):p}function Ut(t,n){var n,e="__hyperlink__",n=2===arguments.length?new String(H(n)):new String(H(t));return n[e]=H(t),n}function Ht(){for(var t,n=0,t=0;t<S(arguments);t++){if(0===arguments[t].length)return V;arguments[t].isReference&&(n+=arguments[t].rangeCount)}return n}function zt(t,n){var e,i,n,e=n.getRow(0),i=n.getColumn(0),n=n.getSource().getCalcSourceModel().getFormula(e,i);return n?"="+n:p}function Vt(t,n){var e,i,r,e=n.getRow(0),i=n.getColumn(0),r;return!!n.getSource().getCalcSourceModel().getFormula(e,i)}function B(t,n){var e;return void 0===n&&(n=!1),(e=N(t)||k(t)?t.toArray(0,!1):t.length&&t[0].length?t:[[t]])?Yt(e,n):x(t)?t:D}function Yt(t,n){var n,e,i,r,o,a,u,e=t.rowCount,i=t.colCount;if(e||i||(e=t.length,i=t[0].length),r=t,n=void 0===n?!1:n){for(r=[],o=0;o<i;o++)for(r.push(a=[]),u=0;u<e;u++)a.push(t[u][o]);e=(n=[i,e])[0],i=n[1]}return r.rowCount=e,r.colCount=i,r}function Zt(t){return 1===t||-1===t}function Wt(t,o){var a=o.length;t.sort(function(t,n){for(var e,i,r,r,e=0;e<a;e++)if(r=(i=o[e])[0],0!==(r=(0,I.$kt)(t[r],n[r])))return i[1]?r:-r;return 0})}function Qt(t,e,n){var i;n?t.forEach(function(t,n){t.push(e[n][0])}):(i=e[0],t.forEach(function(t,n){t.push(i[n])}))}function Jt(t){if(t&&t.length&&0<=t.length){for(var n=0;n<t.length;n++)if("number"!=typeof t[n])return;return 1}}function Kt(t,n,e,i){var r,o,a,u,s,c,f,l,h,d,v,m,g,p,b,y,w,M,C,S,C;if(void 0===n&&(n=1),void 0===e&&(e=1),r=[].concat(B(t,i=void 0===i?!1:i)),x(r))return r;if(o=r,a=[],N(n)||k(n)){if(l=(f=n.toArray(0,!1)).rowCount,h=f.colCount,d=0,N(e)||k(e)){if(d=(s=e.toArray(0,!1)).rowCount,1!==h){if(h<1||1!==s.colCount&&s.colCount!==h||1!==l||!Jt(f[0]))return D;if((v=[]).push(t),i)for(o=Yt(o,i),m=0;m<h;m++){for(g=[],p=0;p<o[0].length;p++)g.push(o[f[0][m]-1][p]);v.push(new I.CalcArray([g])),v.push((1===d?s[0]:s[m])[0])}else for(m=0;m<h;m++){for(g=[],p=0;p<o.length;p++)g.push([o[p][f[0][m]-1]]);v.push(new I.CalcArray(g)),v.push((1===d?s[0]:s[m])[0])}return Xt.apply(Xt,v)}if(1!==s.colCount||1!==d&&d!==l)return D;1===d&&(c=s[d=0][0])}else c=e;for(u=0;u<l;u++)a.push([f[u][0],u<d?s[u][0]:c])}else if(N(e)||k(e)){if(1!==(s=e.toArray(0,!1)).colCount||1!==s.rowCount)return D;a.push([n,s[0][0]])}else a.push([n,e]);for(b=o.colCount,y=[],w=0,M=a;w<M.length;w++){if(S=(C=M[w])[0],C=C[1],S<1||b<S||!Zt(C))return D;y.push([S-1,1===C])}return Wt(o,y),new I.CalcArray(i?Yt(o,i):o)}function Xt(t,n,e){var i,r,o,a,u,s,c,e,f,l,h,d,v,m,g,p,b,y,w,M,C,S,S,C,T,A,w;for(void 0===e&&(e=1),i=[],r=3;r<arguments.length;r++)i[r-3]=arguments[r];if(s=u=0,c=D,k(t)?o=t:N(t)&&(u=(a=t).getRow(),s=a.getColumn()),e=o||a){if(f=e.getColumnCount(),l=e.getRowCount(),x(t))return c;for(h=[],d=void 0,p=g=void(m=v=0),b=1,y=arguments.length;b<y;b+=2){if(M=[].concat(B(w=arguments[b])),x(M))return c;if(C=w.getRowCount(),S=w.getColumnCount(),v||(v=(d=1===S)?2:1,p=[].concat(B(t,!d))),!(!d&&1===C&&S===f||d&&1===S&&C===l))return c;if(S=k(w),N(w)&&(C=void 0,d?0<=(C=s-(T=w.getColumn()))&&C<f?g=C:S=!0:0<=(C=u-(A=w.getRow()))&&C<l?g=C:S=!0),S&&(m+=1,d?(g=f,f++):(g=l,l++),Qt(p,M,d)),!Zt(w=arguments[b+1]||1))return c;h.push([g,1===w])}return Wt(p,h),m&&p.forEach(function(t){t.length-=m}),new I.CalcArray(d?p:Yt(p,!0))}return c}function qt(t,n){return!!(t===n||G(t)&&G(n)&&m(t)===m(n)||x(t)&&x(n)&&t._code===n._code)}function $t(t,n){for(var e,i,r,o,e=0,i=t.length;e<i;e++)if(!qt(r=t[e],o=n[e]))return;return 1}function tn(t,n,o){var t,a,u,s;return void 0===o&&(o=!1),t=B(t,n=void 0===n?!1:n),x(t)?t:(u=[],s=(a=t).rowCount,a.forEach(function(t,n){var e,i,r;if(!t.duplicated){for(e=0,i=n+1;i<s;i++)$t(t,r=a[i])&&(r.duplicated=!0,e++);o&&0!==e||u.push(t)}}),new I.CalcArray(n?Yt(u,n):u))}function nn(t,n,e){var t,t,i,r,t=B(t);return x(t)?t:(t=t,i=[].concat(B(n)),r=[],1===i.length&&i[0].length===t[0].length?t.forEach(function(t,n){var e=[];t.forEach(function(t,n){i[0][n]&&e.push(t)}),r.push(e)}):t.forEach(function(t,n){i[n][0]&&r.push(t)}),0===r.length?C(e)?Y:e:new I.CalcArray(r))}function en(t,n){var e,i,r,o,a,u,s,c,f,l,h,t;if(k(n))return n.getValue(0,0);if(N(n)){if(i=(e=n).getColumn(),r=e.getRow(),o=e.getColumnCount(),a=e.getRowCount(),c=(u=t.row)-r,f=(s=t.column)-i,h=l=void 0,t=t.source===e.getSource(),1===a&&(!t||r!==u)&&0<=f&&f<o)h=s,l=r;else if(1===o&&(!t||i!==s)&&0<=c&&c<a)h=i,l=u;else{if(1!==a||1!==o)return D;h=i,l=r}return e.create([{row:l,col:h,rowCount:1,colCount:1}])}return n}function rn(t,n){return n instanceof I.CalcReference?n.getSpillRef():_}function on(){var t,n,e,i,r,o,a,u,s,c,t=arguments,n=t.length;if(1===n)return new I.CalcArray(t[0]);for(i=e=0;i<n;i++)e=Math.max(e,t[i].colCount);for(r=[],o=0;o<n;o++)for(a=t[o],u=0;u<a.rowCount;u++){for(s=[],c=a.colCount,i=0;i<c;i++)s.push(a[u][i]);for(i=c;i<e;i++)s.push(p);r.push(s)}return new I.CalcArray(r)}function an(){var t,n,e,i,r,o,a,u,s,c,t=arguments,n=t.length;if(1===n)return new I.CalcArray(t[0]);for(i=e=0;i<n;i++)e=Math.max(e,t[i].rowCount);for(r=[],o=0;o<e;o++){for(a=[],u=0;u<n;u++)for(c=o<(s=t[u]).rowCount,i=0;i<s.colCount;i++)a.push(c?s[o][i]:p);r.push(a)}return new I.CalcArray(r)}function un(t,n,e,i){var r,o,a,u,s,c,f,r=t.rowCount,o=t.colCount,a=1===e||3===e,u=2===e||3===e,s=function(t){a&&t===y||u&&x(t)||i(t)};if(n)for(c=0;c<o;c++)for(f=0;f<r;f++)s(t[f][c]);else for(f=0;f<r;f++)for(c=0;c<o;c++)s(t[f][c])}function sn(t){for(var n,e,n=new Array(t),e=0;e<t;e++)n[e]=[];return n}function cn(t,n,e){var i=[];return un(t,e,n,function(t){i.push(t===y?0:t)}),new I.CalcArray([i])}function fn(t,n,e){var i=[];return un(t,e,n,function(t){i.push([t===y?0:t])}),new I.CalcArray(i)}function ln(t,n,e){var i,r,o,a,u,s,i=t.rowCount,r=t.colCount;if(1!==i&&1!==r)return D;if(C(n)||n<=0)return z;if((o=Math.max(i,r))<=n)return new I.CalcArray(t);if(a=[],un(t,!(u=[]),0,function(t){u.push(t),u.length===n&&(a.push(u),u=[])}),0<u.length){for(e=C(e)?p:e,s=u.length;s<n;s++)u.push(e);a.push(u)}return new I.CalcArray(a)}function hn(t,n,e){var i,r,o,a,u,s,i=t.rowCount,r=t.colCount;if(1!==i&&1!==r)return D;if(C(n)||n<=0)return z;if((o=Math.max(i,r))<=n)return new I.CalcArray(t);if(a=sn(n),un(t,!1,u=0,function(t){a[u].push(t),++u===n&&(u=0)}),0<u)for(e=C(e)?p:e,s=u;s<n;s++)a[s].push(e);return new I.CalcArray(a)}function dn(t,n,e,i,r){var o,a,u,s,c,o=0===n&&e===t.rowCount,a=0===i&&r===t.colCount;if(o&&a)return new I.CalcArray(t);for(u=[],s=n;s<e;s++)c=t[s],u[s-n]=a?c:c.slice(i,r);return new I.CalcArray(u)}function vn(t,n,e){var i,r,o,a,u,s,i=t.rowCount,r=t.colCount;return ct(t,i,r)?D:dn(t,o=0<(n=i<(n=C(n)?i:n)||n<-i?i:n)?0:i+n,a=0<n?n:i,u=0<(e=r<(e=C(e)?r:e)||e<-r?r:e)?0:r+e,s=0<e?e:r)}function mn(t,n,e){var i,r,o,a,u,s,i=t.rowCount,r=t.colCount;return n=C(n)?0:n,e=C(e)?0:e,i<=n||n<=-i||r<=e||e<=-r?Y:dn(t,o=0<=n?n:0,a=0<=n?i:i+n,u=0<=e?e:0,s=0<=e?r:r+e)}function gn(t,n){var e,i,e=new Array(n);if("function"==typeof e.fill)e.fill(t,0,n);else for(i=0;i<n;i++)e[i]=t;return e}function pn(t,n,e,i){var r,o,a,u,s,c,f,r=t.rowCount,o=t.colCount;if(n=C(n)?r:n,e=C(e)?o:e,ct(t,r,o)||n<r||e<o)return D;if(u=o<e,!(a=r<n)&&!u)return new I.CalcArray(t);for(s=gn(i=C(i)?p:i,e-o),c=[],f=0;f<r;f++)c.push(u?t[f].concat(s):t[f]);for(f=r;f<n;f++)c.push(gn(i,e));return new I.CalcArray(c)}function bn(t){var n,e,n,i,r,e,e;if(x(t))return t;if(k(t)||N(t)){if(e=t.getRowCount(),n=t.getColumnCount(),1!==e&&1!==n)return D;if((e=I.Convert.iV(t,r=(i=1===e&&1===n)?1:5,!0,!0,!0)).isConvertError)return D;if(e.isError)return e[0];if(e.some(function(t){return t===I.Convert.CalcConvertedError}))return D;n=e}else{if(!A(t,e={}))return D;n=[e.value]}return n}function yn(t,n){for(var e,i,r,o,a,u,s,e=[],i=I.Convert.iV(t[0],0,!1,!1,!1,!1),r=n?i.rowCount:i.colCount,o=1;o<t.length;o++){if(a=bn(t[o]),x(a))return a;for(u=0;u<a.length;u++){if(0===(s=a[u])||r<s||s<-r)return D;e.push(s)}}return 0===e.length?D:{array:i,indexNumbers:e}}function wn(){var t,n,e,i,r,o,a,t=yn(arguments,!0);if(x(t))return t;for(n=t.array,e=t.indexNumbers,i=n.rowCount,r=[],o=0;o<e.length;o++)a=e[o],r.push(n[a=0<a?a-1:i+a]);return new I.CalcArray(r)}function Mn(){var t,n,e,i,r,o,a,u,s,t=yn(arguments,!1);if(x(t))return t;for(n=t.array,e=t.indexNumbers,i=n.rowCount,r=n.colCount,o=sn(i),a=0;a<e.length;a++)for(u=0<(u=e[a])?u-1:r+u,s=0;s<i;s++)o[s].push(n[s][u]);return new I.CalcArray(o)}e=this&&this.__extends||(at=function(t,n){return(at=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(t,n){t.__proto__=n}:function(t,n){for(var e in n)Object.prototype.hasOwnProperty.call(n,e)&&(t[e]=n[e])}))(t,n)},function(t,n){if("function"!=typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function e(){this.constructor=t}at(t,n),t.prototype=null===n?Object.create(n):(e.prototype=n.prototype,new e)}),Object.defineProperty(t,"__esModule",{value:!0}),r=n("Common"),I=n("CalcEngine"),y=null,w=void 0,M=r.Common.$T,L=r.Common.lt,t=r.Common.ct,v=r.Common.st.E8,F=t.Z6t,C=L.ht,P=L.Fh,S=r.Common.Uf.tR,G=t.W0,m=t.o0,x=I.Convert.BJ,T=I.Convert.z6t,A=I.Convert.t9t,o=I.Convert.q8,U=I.Convert.uJ,N=I.Convert.LE,k=I.Convert.Nh,H=I.Convert.j,D=I.Errors.Value,_=I.Errors.Reference,z=I.Errors.Number,p=I.Errors.NotAvailable,V=I.Errors.Null,Y=I.Errors.Calc,n=I.Functions.F6t,a=I.Functions.G6t,E=I.Functions.OMt,Z=1048576,W=16384,q=I.CalcReference.prototype,ut=I.CalcReference,e(pt,ut),pt.prototype.type=function(){return this.uit},pt.prototype.toArray=function(t,n){for(var e=this,i=[],r=e.Ky,o=e.yft,a=e.uit,u=e.getRangeCount(),s=e.Sx,c=e.Cyt,f,l,h,d,v,m,f=0;f<u;f++)for(n||i.push(h=[]),v=0;v<s;v++)for(n||h.push(d=[]),m=0;m<c;m++)l=0===a?r+1+v:1===a?o+1+m:q.getValue.call(e,f,r+v,o+m),(n?i:d).push(l);return(i=n||1!==u?i:i[0]).rowCount=s,i.colCount=c,i.rangeCount=u,i},$=pt,st=I.CalcArray,e(g,st),g.prototype.getRowCount=function(){return I.CalcArrayHelper.getColumnCount(this.Kkt)},g.prototype.getColumnCount=function(){return I.CalcArrayHelper.getRowCount(this.Kkt)},g.prototype.getValue=function(t,n){return I.CalcArrayHelper.getValue(this.Kkt,n,t)},tt=g,t={J6t:7},e={J6t:2},c={J6t:2,pkt:"<= 0",zkt:D},it={J6t:2,pkt:["< 0","> 3"],zkt:D},rt={J6t:2,pkt:["= 0"],zkt:Y},ot={bkt:0,J6t:2},f={J6t:4,X6t:0,Vkt:!0},l={J6t:4,X6t:0,n9t:!0},n("ADDRESS",Bt,2,5,[i={J6t:2},i,et={bkt:1,J6t:2},nt={bkt:!0,J6t:7},{bkt:"",J6t:5}],w,w,{wkt:[2,3,4]}),n("INDEX",Ft,2,4,w,0,0,{wkt:[1,2,3],e9t:[0],i9t:!0,r9t:!0,o9t:3}),n("OFFSET",Pt,3,5,[{},i,i],0,0,{wkt:[3,4],e9t:[0],a9t:!0,r9t:!0,o9t:2,returnReference:!0}),n("ROW",wt,0,1,w,-1,w,{r9t:!0,e9t:-1,expandColumns:!1}),n("COLUMN",Mt,0,1,w,-1,w,{wkt:0,r9t:!0,e9t:-1,expandRows:!1}),n("ROWS",Ct,1,1,w,-1,-1,{e9t:-1,expandColumns:!1,u9t:"setRowCount"}),n("COLUMNS",St,1,1,w,-1,-1,{e9t:-1,expandRows:!1,u9t:"setColumnCount"}),n("TRANSPOSE",Tt,1,1,w,-1,-1),n("LOOKUP",Nt,2,3,[f,{J6t:4,X6t:0,Vkt:!0,s9t:!0}],"!= 0","!= 0",{o9t:1}),n("HLOOKUP",At,3,4,[f,{},c,t],1,1,{r9t:!0,i9t:!0,e9t:[1]}),n("VLOOKUP",It,3,4,[f,{},c,t],1,1,{r9t:!0,i9t:!0,e9t:[1],c9t:!0}),n("XLOOKUP",xt,3,6,[f,{},{},{J6t:5},{J6t:2,bkt:0},{J6t:2,bkt:1}],[1,2],[1,2],{wkt:[3,4,5]}),n("VSTACK",on,1,255,l,-1,-1,w,!0),n("HSTACK",an,1,255,l,-1,-1,w,!0),n("TOROW",cn,1,3,[l,it,t],0,0,{wkt:[1,2]},!0),n("TOCOL",fn,1,3,[l,it,t],0,0,{wkt:[1,2]},!0),n("WRAPROWS",ln,2,3,[l,i],0,0,{wkt:[2],f9t:-1},!0),n("WRAPCOLS",hn,2,3,[l,i],0,0,{wkt:[2],f9t:-1},!0),n("TAKE",vn,2,3,[l,rt,rt],0,0,{wkt:[1,2]},!0),n("DROP",mn,2,3,[l,ot,ot],0,0,{wkt:[1,2]},!0),n("EXPAND",pn,2,4,[l,c,c],0,0,{wkt:[1,2,3]},!0),n("CHOOSEROWS",wn,2,255,w,-1,-1,w,!0),n("CHOOSECOLS",Mn,2,255,w,-1,-1,w,!0),n("CHOOSE",kt,2,255,i,">= 1",">= 1",{f9t:">= 1",isBranch:!0,findTestArgument:0,findBranchArgument:function(t){var n={value:-1};return x(t)?-1:(A(t,n),n.value)}}),n("MATCH",Dt,2,3,[f,{J6t:4,X6t:0,Vkt:!0,Zbt:!0},e],1,1,{}),n("XMATCH",_t,2,4,[f,f,e,e],1,1,{}),n("INDIRECT",Gt,1,2,[{J6t:5},nt],w,w,{wkt:2,a9t:!0,r9t:!0}),n("HYPERLINK",Ut,1,2),n("AREAS",Ht,1,w,{J6t:4,Vkt:!0,Ykt:!0,n9t:!0},-1,-1),n("FORMULATEXT",zt,1,1,w,-1,w,{r9t:!0}),n("ISFORMULA",Vt,1,1,w,-1,w,{r9t:!0}),n("SORT",Kt,1,4,w,[0,1,2],[0,1,2],{wkt:[1,2,3]},!0),n("SORTBY",Xt,2,w,w,[0,"%= 1"],[0,"%= 1"],w,!0),n("UNIQUE",tn,1,3,w,[0],[0],{wkt:[1,2]},!0),n("FILTER",nn,2,3,w,[0,1,2],[0,1,2],w,!0),n("@",en,1,1,w,[0],[0],{r9t:!0},!0),n("ANCHORARRAY",rn,1,1,w,[0],[0],{r9t:!0},!0)},"./src/functions-stat.ts":function(l,t,v){var m,F,M,z,P,I,N,g,ot,j,k,T,b,A,h,D,at,ut,st,ct,_,x,y,G,U,E,O,H,C,ft,R,B,L,V,p,lt,Y,Z,e,d,W,Q,J,ht,w,t,K,X,n,q,$,tt,i,nt,r,v,et,o,it,rt,a,u,dt,vt,s,mt,c,gt,pt,bt,yt,wt,Mt,Ct,St,Tt,At,It,xt,Nt,kt,Dt,_t,Et,jt,Ot,Rt,vt,Bt,Lt,Ft,Pt,Gt,Ut,Ht,zt,Vt,Yt,Zt,Wt,Qt,Jt;function Kt(t){for(var n,e,n=0,e=0;e<t.length;e++)t[e]!==w&&n++;return n}function Xt(t){var n,e,i,e,n=6,e=0===t?0:3<=(i=.5*Math.abs(t))?1:i<1?((((((((.000124818987*(e=i*i)-.001075204047)*e+.005198775019)*e-.019198292004)*e+.059054035642)*e-.151968751364)*e+.319152932694)*e-.5319230073)*e+.797884560593)*i*2:(((((((((((((-45255659e-12*(i-=2)+.00015252929)*i-19538132e-12)*i-.000676904986)*i+.001390604284)*i-.00079462082)*i-.002034254874)*i+.006549791214)*i-.010557625006)*i+.011630447319)*i-.009279453341)*i+.005353579108)*i-.002141268741)*i+.000535310849)*i+.999936657524;return 0<t?.5*(e+1):.5*(1-e)}function qt(t,n,e){var i,r,o,a,u,r,i=M(t);if(n!==t[0]){for(u=t[a=0],o=1;o<i&&t[o]<n;o++)t[o]!==u&&(u=t[a=o]);t[o]!==u&&(a=o),r=n===t[o]?e?a/(i-1):(o+1)/(i+1):0===a?0:(r=(n-t[a-1])/(t[a]-t[a-1]),e?(a-1+r)/(i-1):(a+r)/(i+1))}else r=e?0:1/(i+1);return r}function $t(t,n,e,i){var r,t,t,r=[];return pn(t,r),0===(t=M(r))||n<r[0]||r[t-1]<n?G:0!==(t=1===t?1:qt(r,n,i))?_(t*ot(10,e))/ot(10,e):t}function tn(t,n,e){for(var i,r,o,a,u,s,c,f,l,h,d,v,d,i=300,r=1e-50,o=1e-20,a=t+n,u=t+1,s=t-1,c=1,f=1-a*e/u,l=f=1/(f=ut(f)<r?r:f),h=1;h<=300&&(l=(l*=(f=1/(f=ut(f=1+(v=(n-h)*h*e/((s+(d=h+h))*(t+d)))*f)<r?r:f))*(c=ut(c=1+v/c)<r?r:c))*(d=(f=1/(f=ut(f=1+(v=0-(t+h)*(a+h)*e/((t+d)*(u+d)))*f)<r?r:f))*(c=ut(c=1+v/c)<r?r:c)),!(ut(d-1)<o));h++);return l}function S(t){var n;return[22250738585072014e-324,17976931348623157e292,ot(2,-53),ot(2,-52),B.ckt(2,10)][t-1]||0}function nn(t,n,e){var i,r,o,i=0,r=0;if(n<1)return 0;for(o=1;o<=n;o++)if(e<(r+=ut(ft(t[i=n-o]))))return i;return i}function en(t,n,e){var i,r,o,a,u;if(e<1||1e3<e||t<-1.1||1.1<t)return NaN;for(i=2*t,a=o=r=0,u=1;u<=e;u++)o=r,a=i*(r=a)-o+ft(n[e-u]);return.5*(a-o)}function rn(t){var n,e,i,r,r,n=[.16663894804518634,-1384948176067564e-20,9.81082564692473e-9,-1809129475572494e-26,6221098041892606e-29,-3399615005417722e-31,2683181998482699e-33,-2.868042435334643e-20,39628370610464347e-38,-6831888753985767e-39,14292273559424982e-41,-35475981581010704e-43,1025680058010471e-43,-3.401102254316749e-30,1276642195630063e-46],e=nn(n,15,S(3)),i=1/st(S(3)),r=at(k(ct(S(2)/12),-ct(12*S(1))));return t<10?NaN:r<=t?4930380657631324e-47:t<i?en((r=10/t)*r*2-1,n,e)/t:1/(12*t)}function on(t){var n,e,n=[1.037869356274377,-.13364301504908918,.019408249135520562,-.0030107551127535777,.0004869461479715485,-8105488189317536e-20,13778847799559525e-21,-2380221089435897e-21,4.1640416213865184e-7,-7.359582837807599e-8,1.3117611876241675e-8,-2.3546709317742423e-9,4.2522773276035e-10,-771908941348408e-25,1407574648135907e-26,-25769072058024682e-28,4734240666629442e-28,-8724901267474264e-29,1612461490274055e-29,-29875652015665774e-31,5548070120908289e-31,-10324619158271569e-32,19250239203049852e-33,-3595507346526515e-33,6726454253787686e-34,-1260262416873522e-34,2.364488440860621e-20,-44419377050807936e-37,8354659446403425e-37,-15731559416479563e-38,29653128740247425e-39,-5594958348181595e-39,1056635426883568e-39,-19972483680670205e-41,3778297781883936e-41,-7153158688908174e-42,13552488463674214e-43,-25694673048487566e-44,48747756066216946e-45,-9.254211253084972e-30,1.757859784176024e-30,-3341002667773101e-46,6353393618023618e-47],e=nn(n,43,.1*S(3));return t<=-1?NaN:ut(t)<=.375?t*(1-t*en(t/.375,n,e)):ct(t+1)}function an(t){var n,e,i,r,o,a,u,s,r=1,o=[1,.5772156649015329,-.6558780715202538,-.0420026350340952,.1665386113822915,-.0421977345555443,-.009621971527877,.007218943246663,-.0011651675918591,-.0002152416741149,.0001280502823882,-201348547807e-16,-12504934821e-16,1133027232e-15,-2.056338417e-7,6.116095e-9,5.0020075e-9,-1.1812746e-9,1.043427e-10,77823e-16,-36968e-16,51e-14,-206e-16,-54e-16,14e-16];if(171<t)return 1e308;if(t===C(t))if(0<t)for(n=1,a=2;a<t;a++)n*=a;else n=1e308;else{if(1<ut(t)){for(i=ut(t),u=C(i),e=1;e<=u;e++)r*=i-e;i-=u}else i=t;for(s=o[24],e=23;0<=e;e--)s=s*i+o[e];n=1/(s*i),1<ut(t)&&(n*=r,t<0)&&(n=-h/(t*n*b(h*t)))}return n}function un(t){var n,e,i,r,o,a,u,s,e=0,i=[.08333333333333333,-.002777777777777778,.0007936507936507937,-.0005952380952380952,.0008417508417508418,-.001917526917526918,.00641025641025641,-.02955065359477124,.1796443723688307,-1.3924322169059],r=t;if(t<=0)return 1e308;if(1===t||2===t)return 0;for(o=1/((r=t<=7?t+(e=C(7-t)):r)*r),a=2*h,u=i[9],n=8;0<=n;n--)u=u*o+i[n];if(s=u/r+.5*ct(a)+(r-.5)*ct(r)-r,t<=7)for(n=1;n<=e;n++)s-=ct(r-1),--r;return s}function sn(t,n){var e,i,t,n,i=t=t;return t<n&&(t=n),(i=n<i?n:i)<0?NaN:0===i?ht:10<=i?(e=rn(i)+rn(t)-rn(i+t),-.5*ct(t)+.9189385332046728+e+(i-.5)*ct(i/(i+t))+t*on(-i/(i+t))):10<=t?(e=rn(t)-rn(i+t),n=di(i),lt(n)?NaN:ft(n)+e+i-i*ct(i+t)+(t-.5)*on(-i/(i+t))):ct(an(i)*(an(t)/an(i+t)))}function cn(t,n,e){var i,r,o,a,u,s,c,f,l,h,d,v,m,g,p,b,y,w,s=S(3),c=ct(s),f=S(1),l=ct(f),h=t,d=n,v=e;if(d/(d+v)<t&&(h=1-h,d=e,v=n),(d+v)*h/(d+1)<s)i=0,l<(o=d*ct(j(h,f))-ct(d)-sn(d,v))&&0!==h&&(i=at(o)),h===t&&d===n||(i=1-i);else{if(0===(m=v-T(v))&&(m=1),i=0,l<=(o=d*ct(h)-sn(m,d)-ct(d))&&(r=(i=at(o))*d,1!==m))for(u=C(j(c/ct(h),4)),g=1;g<=u;g++)i+=(r=r*((a=g)-m)*h/a)/(d+a);if(1<v){for(o=d*ct(h)+v*ct(1-h)-sn(d,v)-ct(v),p=C(j(o/l,0)),r=at(o-p*l),y=v*(b=1/(1-h))/(d+v-1),w=0,v===(u=C(v))&&(u-=1),g=1;g<=u&&!(y<=1&&r/s<=w);g++)1<(r=(v-(a=g)+1)*b*r/(d+v-a))&&(p-=1,r*=f),0===p&&(w+=r);i+=w}i=j(k(i=h===t&&d===n?i:1-i,1),0)}return i}function fn(t){var t,t;return t=ft(t=.7071067811865475*-t),I(t)?y:(t=d(t*st(2)),lt(t)?NaN:.5*(2-2*t))}function ln(t,n,e,i){var r,o,a,u,s,c,f,l,h,d,v,m,g,p;function b(t,n){return t<0&&0<n||0<t&&n<0}for(r=1e-307,o=222045e-21,a=t.Sl(n),u=t.Sl(e),c=0;c<1e3&&!b(a,u);c++)ut(a)<=ut(u)?((n+=2*((s=n)-e))<0&&(n=0),e=s,u=a,a=t.Sl(n)):(e+=2*((s=e)-n),n=s,a=u,u=t.Sl(e));if(0===a)return n;if(0===u)return e;if(!b(a,u))return i.l9t=!0,0;for(d=u,m=l=a,g=.5*((v=f=n)+(h=e)),p=!0,c=0;c<500&&ut(m)>r&&e-n>j(ut(n),ut(e))*o;)(p=p&&l!==d&&d!==m&&m!==l&&n<(g=f*m*d/(m-l)/(d-l)+v*d*l/(d-m)/(l-m)+h*l*m/(l-d)/(m-d))&&g<e)||(g=.5*(n+e),h=e,d=u,p=!0),f=h,h=v,v=g,l=d,d=m,b(a,m=t.Sl(g))?(e=v,u=m):(n=v,a=m),p=p&&2*ut(m)<=ut(d),++c;return v}function hn(t,n){for(var e,i,r,o,a,e=M(n),i=0;i<e;i++)a=(o=(r=ft(n[i]))-t.M)/(t.N+1),t.M+=a,t.Q+=t.N*o*a,t.N++,t.h9t+=r}function dn(t){var n,e,i,r,o,n=[76.18009172947146,-86.50532032941678,24.01409824083091,-1.231739572450155,.001208650973866179,-5395239384953e-18],e=1.000000000190015,r=t,o=t+5.5;for(o-=(t+.5)*ct(o),i=0;i<=5;i++)e+=n[i]/++r;return-o+ct(2.5066282746310007*e/t)}function vn(t,n,e){var i,r,o,a,u,s,c,f,l,h,d,v,m,g,g,g,i=0===e||1===e?0:at(dn(t+n)-dn(t)-dn(n)+t*ct(e)+n*ct(1-e)),r=(t+1)/(t+n+2)<=e;for(r&&(o=t,t=n,n=o,e=1-e),a=4450147717014403e-323,u=100,f=t-1,d=h=(l=1)/(h=ut(h=1-(s=t+n)*e/(c=t+1))<a?a:h),v=1,m=2;v<=100;v++,m+=2)if(d=(d*=(h=1/(h=ut(h=1+(g=v*(n-v)*e/((f+m)*(t+m)))*h)<a?a:h))*(l=ut(l=1+g/l)<a?a:l))*(g=(h=1/(h=ut(h=1+(g=-(t+v)*(s+v)*e/((t+m)*(c+m)))*h)<a?a:h))*(l=ut(l=1+g/l)<a?a:l)),ut(ft(g-1))<5e-324)return g=i*d/t,r?1-g:g;return U}function mn(t,n){for(var e,i,r,o,a,e=M(n),i=0;i<e;i++)(r=n[i])!==w&&(a=(o=r-t.M)/(t.N+1),t.M+=a,t.Q+=t.N*o*a,t.N++,t.h9t+=r)}function gn(t){t.sort(function(t,n){return t-n})}function pn(t,n){for(var e,i,e=0;e<M(t);e++)(i=t[e])!==w&&n.push(i);gn(n)}function bn(t){for(var n,e,n=[],e=0;e<M(t);e++)pn(t[e],n);return n}function yn(t,n,e){var i,r,e,i,r,o,a,u,s,c,f,l,h,i=Math.expm1||function(t){return at(t)-1},r=Math.log1p||function(t){return ct(1+t)};return t<=0?0:1<=t?1:1===e?ot(t,n):1===n?-i(e*r(-t)):(i=.5-t+.5,r=r(-t),a=ct(o=t),(c=(u=n)/(n+(s=e))<t)&&(u=e,s=n,o=i,a=r,r=ct(i=t)),e=wn(o,u,s),e=(e/=u)*(h=1<u&&1<s&&(f=u/(u+s))<.97&&(l=s/(u+s))<.97?Mn(o,u,s)*o*i:at(u*a+s*r-Cn(!1,u,s))),(e=1<(e=c?.5-e+.5:e)?1:e)<0?0:e)}function wn(t,n,e){for(var i,r,o,a,u,s,c,f,l,h,d,v,m,v,u=222045e-21,s=1,c=1,f=1-(n+e)/(n+1)*t,a=0===f?(i=0,r=1):(i=1)*(r=1/f),o=1,l=1,h=5e4,d=!1;i=(s=(i+(m=l*(e-l)*t/(((v=n+2*l)-1)*v))*s)*r)+(v=-(n+l)*(n+e+l)*t/(v*(v+1)))*i*r,0!==(f=(c=(f+m*c)*r)+v*f*r)&&(d=ut(a-(o=i*(r=1/f)))<ut(a)*u),a=o,(l+=1)<5e4&&!d;);return a}function Mn(t,n,e){var i,r,o,a,u,o,s;return 1===n?1===e?1:2===e?-2*t+2:t<=.01?e+e*at((e-1)*ct(1-t))-1:e*ot(.5-t+.5,e-1):1===e?2===n?n*t:n*ot(t,n-1):t<=0&&!(n<1&&0===t)||1<=t&&!(e<1&&1===t)?0:(i=ct(S(2)),r=ct(S(1)),o=ct(t<.1?1+t:1-t),u=(n-1)*(a=ct(t)),o=(e-1)*o,s=Cn(!1,n,e),u<i&&r<u&&o<i&&r<o&&s<i&&r<s&&u+o<i&&r<u+o?ot(t,n-1)*ot(.5-t+.5,e-1)/Cn(!0,n,e):at(u+o-s))}function Cn(t,n,e){var i,r,o,e,a,n,e,u,e,s,u,i,i=e,r=n,o;return e<n&&(e=i,i=r,r=e),t&&i+r<171.624376956302?Sn(i)/Sn(i+r)*Sn(r):(n=(a=6.02468004077673)-.5,e=An(i),e=(e/=An(i+r))*An(r),u=i+r+n,e=t?e*st(u/(i+n)/(r+n)):ct(e)+.5*(ct(u)-ct(i+n)-ct(r+n)),u=i/(r+n),i=-i*ct(1+(s=r/(i+n)))-r*ct(1+u)-n,t?at(i)*e:i+e)}function f(t){var n,e,i,r,n=An(t),e,i=t+6.02468004077673-.5,r=ot(i,t/2-.25);return n=(n*=r)/at(i)*r,n=t<=20&&t===B.d9t(t)?_(n):n}function Sn(t){var n,e,i,r,o,n=ct(h),e=ct(S(2)),i;return 171.624376956302<t?U:1<=t?f(t):.5<=t?f(t+1)/t:-.5<=t?e<=(r=f(t+2)-ct(t+1)-ct(ut(t)))?U:f(t+2)/(t+1)/t:e<=(o=f(1-t)+ct(ut(b(h*t))))-n?0:o<0&&e<n-o?U:at(n-o)*(b(h*t)<0?-1:1)}function Tn(t){var n;return 171.624376956302<=t?f(t):1<=t?ct(f(t)):.5<=t?ct(f(t+1)/t):f(t+2)-ct(t+1)-ct(t)}function An(t){var n,e,i,r,o,a,n=[23531376880.41076,42919803642.6491,35711959237.35567,17921034426.03721,6039542586.352028,1439720407.3117216,248874557.86205417,31426415.585400194,2876370.6289353725,186056.26539522348,8071.672002365816,210.82427775157936,2.5066282746310002],e=[0,39916800,120543840,150917976,105258076,45995730,13339535,2637558,357423,32670,1925,66,1];if(t<=1)for(i=n[12],r=e[12],o=11;0<=o;--o)i=i*t+n[o],r=r*t+e[o];else for(a=1/t,i=n[0],r=e[0],o=1;o<=12;++o)i=i*a+n[o],r=r*a+e[o];return i/r}function In(t,n){return t<=0?0:xn(n/2,t/2)}function xn(t,n){var e,e,e=t*ct(n)-n-Tn(t),e=at(e);return t+1<n?1-e*kn(t,n):e*Nn(t,n)}function Nn(t,n){for(var e,i,r,o,a,e=.5*S(3),i=t,r=1/t,o=r,a=1;o+=r=r*n/(i+=1),a+=1,e<r/o&&a<=1e4;);return 1e4<a?y:o}function kn(t,n){for(var e,i,r,o,a,u,s,c,f,l,a,h,d,v,m,g,e=S(3),i=.5*e,r=1/e,o=0,u=1-t,s=n+2-t,f=n+1,l=1,h=s*n,d=n,v=f/h,m=!1;c=f*(s+=2)-l*(a=(u+=1)*(o+=1)),0!=(a=h*s-d*a)&&(m=ut((v-(g=c/a))/g)<=i,v=g),l=f,d=h,h=a,ut(f=c)>r&&(l*=e,f*=e,d*=e,h*=e),!m&&o<1e4;);return m?v:y}function Dn(t,n){var e,i;if(t<=0)return 0;if(1391e3<n*t)e=at((.5*n-1)*ct(.5*t)-.5*t-ct(2)-Tn(.5*n));else{for(i=n%2<.5?(e=.5,2):(e=1/st(2*t*h),1);i<n;)e*=t/i,i+=2;e=1425<=t?at(ct(e)-t/2):e*at(-t/2)}return e}function _n(t,n,e,i){var r,o,e,t,r=L(e,t);return lt(r)||(o=ft(r),r=L(i-e,n-t),lt(r))||(e=ft(r),r=L(i,n),lt(r))?r:(t=ft(r),O(o*e/t))}function En(t,n,e){var i,r,o,i=yn(n/(n+t*t),n/2,.5);switch(e){case 1:return.5*i;case 2:return i;case 3:return ot(1+t*t/n,-(n+1)/2)/(st(n)*Cn(!0,.5,n/2));case 4:return o=.5*yn(r=n/(t*t+n),.5*n,.5),t<0?o:1-o}return y}function jn(n,e,i){return{Sl:function(t){return n-En(t,e,i)}}}function On(t,n,e){var i,r,t,i={l9t:!1},r,t=ln(jn(t,n,e),.5*n,n,i);return i.l9t?G:t}function Rn(t,n){for(var e=!1,i=0,r,o,a,u,s,o=0;o<M(n);o++)for(s=n[o],a=0;a<M(s);a++)if(u=s[a],p(u)||W(u)||Q(u))r=Q(u)?0:ft(u),(!e||t&&i<r||!t&&r<i)&&(i=r),e=!0;else if(lt(u))return u;return i}function Bn(t,n,e,i){for(var r,o,a,u,s,i,r=0,o=0,a=0,u=0;u<M(n);u++)(s=n[u])!==w&&(s<e?r++:e<s?a++:o++);return 0===o?G:(i=(0===i?a:r)+1,t?i:i+(o-1)/2)}function Ln(t,n,e){for(var i,r,o,a,u,s,c,f,o=0;o<M(t);o++)for(s=!!(u=t[o]).isArray,c=!!u.isReference,a=0;a<M(u);a++)if((r=u[a])!==z)if(Q(r)){if(F.ExcelCompatibleCalcMode){if(s)continue;if(c){n.n++;continue}}if(F.Convert.sJ(r,f={value:0}))n.v9t+=i=f.value,n.m9t+=i*i;else if(!u.isArray&&!u.isReference)return y;n.n++}else{if(lt(r))return r;!p(r)||e&&"boolean"==typeof r&&u.isArray||(i=ft(r),n.v9t+=i,n.m9t+=i*i,n.n++)}}function Fn(t,n,e,i){var r,t,i,r={v9t:0,m9t:0,n:0},t=Ln(t,r,i);return lt(t)?t:r.n<=n?x:(i=j(0,(r.n*r.m9t-r.v9t*r.v9t)/(r.n*(r.n-n))),i=e?st(i):i,O(i))}function Pn(t,n,e){var i,r,o,a,u,s,c,f,l,h,o=0,a=0,u=0,s=0,f=M(n);if(f!==M(e))return G;for(c=0;c<f;c++)i=n[c],r=e[c],i!==w&&r!==w&&(o+=i,a+=r,s++);if(s<=1)return x;for(l=o/s,h=a/s,c=0;c<f;c++)i=n[c],r=e[c],i!==w&&r!==w&&(u+=(i-l)*(r-h));return O(t?u/s:u/(s-1))}function Gn(t,n){for(var e,i,r,o,a,u,e=t?1:0,i=0,a=0;a<M(n);a++)for(r=n[a],u=0;u<M(r);u++)if((o=r[u])!==w){if(o<=0)return U;e=t?e*o:e+1/o,i++}return t?i<=0?x:O(ot(e,1/i)):0===e?x:O(i/e)}function Un(t,n,e,i,r){var o,a,u,s,c,f,l,h,d,v,m,g,p,b,y,w,M,C,B,S,T,A,I,x,u,N,L,k,u,D,_,E,j,O,R,k,N,o=n.rowCount,a=n.colCount,f=(e=t?e!==P?H(e,1,!1,!0,!0):n:(u=e!==P?e:function(t,n){var e=[];for(s=0;s<t;s++)for(e[s]=[],c=0;c<n;c++)e[s][c]=s*n+c+1;return new F.CalcArray(e)}(o,a),H(u,1,!1,!0,!0))).rowCount,l=e.colCount;if(o===f&&a===l&&(i||!r)){for(v=t?f*l:ft(f*l),u=void(x=I=A=T=S=0),s=0;s<f;s++)for(c=0;c<l;c++)m=e[s][c],g=n[s][c],S+=m,T+=m*m,A+=g=t?ct(g):g,I+=g*g,x+=m*g;return M=v*T-S*S,d=i?(v*x-S*A)/M:x/T,u=i?(A*T-S*x)/M:0,t&&(d=at(d),u=at(u)),y=[[d,u]],r&&(y[1]=[],y[2]=[],y[3]=[],y[4]=[],u=I-u*A-d*x,D=(k=v*x-S*A)*k/((N=v*T-S*S)*(L=v*I-A*A)),v<3?(y[1][0]=U,y[1][1]=U,y[2][1]=U,y[3][0]=U):(y[1][0]=st(u*v/(N*(v-2))),y[1][1]=st(u*T/(N*(v-2))),y[2][1]=st((L-k*k/N)/(v*(v-2))),y[3][0]=1==D?U:D*(v-2)/(1-D)),y[2][0]=D,y[3][1]=v-2,y[4][0]=L/v-u,y[4][1]=u),new F.CalcArray(y)}if(1===a&&o===f||1===o&&a===l){if(g=[],m=[],v=f,d=l,1===a){for(s=0;s<v;s++)g[s]=n[s][0],t&&(g[s]=ct(g[s]));m=e}else{for(s=0;s<d;s++)g[s]=n[0][s],t&&(g[s]=ct(g[s]));for(s=0;s<d;s++)for(m[s]=[],c=0;c<v;c++)m[s][c]=e[c][s]}for(_=[],h=0;h<d+1;h++)_[h]=[];for(p=0;p<d+1;p++)for(b=0;b<d+2;b++)_[p][b]=0;for(E=[],p=0;p<d+2;p++)E[p]=0;for(j=r?[]:z,h=0;h<v;h++)for(E[d+1]+=g[h]*g[h],_[0][d+1]+=g[h],E[0]=_[0][d+1],s=0;s<d;s++)for(_[0][s+1]+=m[h][s],_[s+1][0]=_[0][s+1],_[s+1][d+1]+=m[h][s]*g[h],E[s+1]=_[s+1][d+1],c=s;c<d;c++)_[c+1][s+1]+=m[h][s]*m[h][c],_[s+1][c+1]=_[c+1][s+1];if(_[0][0]=v,r){for(p=0;p<d+1;p++)for(j[p]=[],b=0;b<d+1;b++)j[p][b]=0;for(s=0;s<d+1;s++)j[s][s]=1}for(s=O=i?0:1;s<d+1;s++){if(0===_[s][s]){for(w=!1,c=s+1;!w&&c<d+1;c++)if(0!==_[c][s]){for(h=0;h<d+2;h++)M=_[s][h],_[s][h]=_[c][h],_[c][h]=M;if(r)for(h=0;h<d+1;h++)M=j[s][h],j[s][h]=j[c][h],j[c][h]=M;w=!0}if(!w)return U}for(C=1/_[s][s],h=O;h<d+2;h++)_[s][h]*=C;if(r)for(h=O;h<d+1;h++)j[s][h]*=C;for(c=O;c<d+1;c++)if(c!==s){for(C=-_[c][s],h=O;h<d+2;h++)_[c][h]+=C*_[s][h];if(r)for(h=O;h<d+1;h++)j[c][h]+=C*j[s][h]}i||(_[0][d+1]=0)}for(y=t?[[],d+1]:[[]],s=0;s<d+1;s++)y[0][s]=t?at(_[d-s][d+1]):_[d-s][d+1];if(r){if(t)y[1]=[],y[2]=[],y[3]=[],y[4]=[];else for(p=1;p<5;p++)for(y[p]=[],b=0;b<d+1;b++)y[p][b]=0;for(N=k=R=void 0,k=E[d+1]-E[0]*E[0]/v,R=E[d+1],s=0;s<d+1;s++)R-=_[s][d+1]*E[s];if(N=k-R,y[2][0]=0==k?U:N/k,y[4][0]=N,y[4][1]=R,0===(M=i?v-d-1:v-d)){for(s=0;s<d+1;s++)y[1][s]=U;y[2][1]=U}else{for(B=R/ft(M),i||(y[1][d]=G),s=O;s<d+1;s++)y[1][d-s]=st(B*j[s][s]);y[2][1]=st(B)}for(y[3][0]=0===R?U:ft(M)*N/(R*ft(d)),y[3][1]=ft(M),s=2;s<5;s++)for(c=2;c<d+1;c++)y[s][c]=G}return new F.CalcArray(y)}return U}function Hn(t,n){for(var e,i,r,o,a,u,s,c,f,r=0,o=0,a=0,f=[],u=0;u<M(n);u++)for(c=n[u],f.push(c),s=0;s<M(c);s++)(e=c[s])!==w&&(r+=e,a++);for(i=r/a,u=0;u<M(n);u++)for(c=f[u],s=0;s<M(c);s++)(e=c[s])!==w&&(o+=t?(e-i)*(e-i):ut(e-i));return t?O(o):0===a?x:O(o/a)}function zn(t,n,e,i){var r,o;for(n=n!==P?H(n,0,!1,!0,!1):t,e=e!==P?H(e,0,!1,!0,!1):n,r=0;r<t.rowCount;r++)for(o=0;o<t.colCount;o++)if(!p(t[r][o]))return y;for(r=0;r<n.rowCount;r++)for(o=0;o<n.colCount;o++)if(!p(n[r][o]))return y;for(r=0;r<e.rowCount;r++)for(o=0;o<e.colCount;o++)if(!p(e[r][o]))return y;return m.Common.eit(t,n,e,i,ft,F.CalcArray,y,G)}function Vn(t,n,e,i){return n=n!==P?H(n,1,!1,!0,!0):t,e=e!==P?H(e,1,!1,!0,!0):n,m.Common.iit(t,n,e,i,F.CalcArray,U,G)}function Yn(t,n,e){var i,r,o,a,u,s,c,f,l,h,d,i=0,r=0,o=0,a=0,u=M(n),s=0;if(u!==M(e))return G;for(c=0;c<u;c++)f=n[c],l=e[c],f!==w&&l!==w&&(i+=f,r+=l,o+=l*l,a+=l*f,s++);return 0===s||s*o-r*r==0?x:O((d=i/s-r/s*(h=(s*a-r*i)/(s*o-r*r)))+h*t)}function Zn(){return Y(arguments,2,1)}function Wn(){return Z(arguments,2,7)}function Qn(t,n){return e([t,n],16)}function Jn(){return Y(arguments,2,4)}function Kn(){return Rn(!0,arguments)}function Xn(){return Y(arguments,2,5)}function qn(){return Rn(!1,arguments)}function $n(t,n){return e([t,n],14)}function te(t,n){return e([t,n],15)}function ne(){for(var t,n,e,i,r,o,a,t=arguments,n=0,e=0,i=0;i<M(t);i++)for(a=t[i],r=0;r<M(a);r++)o=a[r],p(o,!0)||W(o)?(n+=ft(o),e++):o!==z&&!Q(o)||e++;return 0===e?x:O(n/e)}function ee(t,n,e,i){var r,o,a,u,s,c,f,l,h,d,v,m,g,p,g,b,r=e,o,a=i.source&&i.source.Lbt.dynamicReferences&&e!==P&&R(e);if(e!==P){if(t=H(t,0,!0,!1,!1),(e=H(e,1,!0,!1,!1,!0,P,!0)).isError)return e[0]}else{if((t=H(t,1,!0,!1,!1,!0,P,!0)).isError)return t[0];e=t}if(s=u=0,c=V(n),t.rowCount!==e.rowCount||t.colCount!==e.colCount)return y;for(v=t.rowCount,a&&(f=r.getRow(0),l=r.getColumn(0),h=i.Xkt,d=r.getSource(),a=h&&d.getRangeKey),m=0;m<M(t);m++)if(g=t[m],c&&c(g,!0)&&(p=e[m],a&&(g={id:d.id,row:f+m%v,col:l+T(m/v),rowCount:1,colCount:1},b=d.getRangeKey(d,g),h.qkt||(h.qkt={}),h.qkt[b]=g),p!==w)){if(lt(p))return p;u+=p,s++}return 0===s?x:O(u/s)}function ie(t,n,e,i,r){for(var o,a,u,s,c,f,l,h,o=n,a=n,u=t?o.getRowCount():a.getRowCount(0),s=t?o.getColumnCount():a.getColumnCount(0),c=[],f=0;f<u;f++)for(c[f]=[],l=0;l<s;l++)h=t?o.getValue(f,l):a.getValue(0,f,l),c[f][l]=ee(e,h,i,r);return new F.CalcArray(c)}function re(t,n,e,i){return F.Convert.LE(e)?ie(!1,e,n,i,t):F.Convert.Nh(e)?ie(!0,e,n,i,t):ee(n,e,i,t)}function oe(){return e(arguments,12)}function ae(){return e(arguments,13)}function ue(){return Gn(!0,arguments)}function se(){return Gn(!1,arguments)}function ce(t,n){var e,i,r,o,a,e=0,i=[];for(pn(t,i),r=Kt(i),a=o=g((r*n/2).toString());a<r-o;a++)e+=ft(i[a]);return e/(r-2*o)}function fe(t,n){for(var e,i,r,o,a,u,s,c,f,l,h,d,v,m,g,e=0,a=n.rowCount,u=n.colCount,i=0;i<a;i++)for(r=0;r<u;r++)n[i][r]!==w&&e++;for(s=t.rowCount,c=t.colCount,f=[],l=[],h=e+1,i=e=0;i<a;i++)for(r=0;r<u;r++)(o=n[i][r])!==w&&(f[e]=ft(o),e++);for(d=f.slice(0),gn(f),i=0;i<h;i++)l[i]=[0];for(i=0;i<s;i++)for(r=0;r<c;r++)if(o=t[i][r],p(o)){for(v=ft(o),m=!1,g=0;!m&&g<e;g++)v<=f[g]&&(l[d.indexOf(f[g])][0]++,m=!0);m||l[e][0]++}return new F.CalcArray(l)}function le(t,n,e){var i=F.CalcArrayHelper;if(F.Convert.LE(t)){if(1!==i.getLength(t))return y;t=i.getValueByIndex(t,0)}return t=ft(t),I(t)?y:Bn(!0,n,t,e)}function he(){var t,n,e,i,r,o,a,u,s,c,f,l,h,t=arguments,e=0,i=0,r=0,o=0,a=M(t),h=[];if(0<a){for(h.push(l=t[0]),c=0;c<M(l);c++)(n=l[c])!==w&&(e+=n,i+=n*n,o++);if(o<=3)return x;if(u=e/o,0===(s=st((o*i-e*e)/(o*(o-1)))))return x;for(f=0;f<a;f++)for(l=h[f],c=0;c<M(l);c++)(n=l[c])!==w&&(r+=ot((n-u)/s,4));return O(o*(o+1)*r/((o-1)*(o-2)*(o-3))-3*(o-1)*(o-1)/((o-2)*(o-3)))}}function de(t,n,e){return $t(t,n,e,!0)}function ve(t,n,e){return $t(t,n,e,!1)}function me(t,n){return e([t,n],17)}function ge(){return Y(arguments,2,2)}function pe(){return Y(arguments,2,3)}function be(t){for(var n,e,n=0,e=0;e<M(t);e++)t[e]!==z&&""!==t[e]||n++;return n}function ye(t,n){for(var e,i,r,o,a,e=0,i=0===n||"*"===n,r=V(n),o=0;o<M(t);o++)a=t[o],i&&a===z||!r||!r(a,!1,!0)||e++;return O(e)}function we(t,n){var e,i,r,o,a,u,s,c,f;if(n.isArray||n.isReference){for(i=e=void 0,o=[],a=n.rowCount,u=n.colCount,s=r=0;s<a;s++){for(c=[],f=0;f<u;f++,r++)i=ye(t,n[r]),lt(i)?c.push(i):(e=ft(i),I(e)?c.push(y):c.push(e));o.push(c)}return new F.CalcArray(o)}return ye(t,n[0])}function Me(){return Hn(!1,arguments)}function Ce(){return Fn(arguments,1,!0,!0)}function Se(){return Z(arguments,2,8)}function Te(){return Fn(arguments,0,!0,!1)}function Ae(){return Z(arguments,2,10)}function Ie(){return Fn(arguments,1,!1,!1)}function xe(){return Z(arguments,2,11)}function Ne(){return Fn(arguments,0,!1,!1)}function ke(t,n){return Pn(!0,t,n)}function De(){return Hn(!0,arguments)}function _e(t,n,e){var t=Mi(t/2);return lt(t)?t:-ft(t)*(n/st(e))}function Ee(t,n,e){return 1===e?x:n*On(t,e-1,2)/st(e)}function je(t,n){var e,i,r,o,a,u,s,c,f,l,r=0,o=0,a=0,u=0,f=0,l=M(t);if(l!==M(n))return G;for(c=0;c<l;c++)e=t[c],(i=n[c])!==w&&e!==w&&(r+=e,o+=i,a+=i*i,u+=i*e,f++);return 0===f||f*a-o*o==0?x:O(r/f-o/f*(s=(f*u-o*r)/(f*a-o*o)))}function Oe(t,n,e,i){return Un(!1,t,n,e,i)}function Re(t,n){var e,i,r,o,a,u,s,c,f,c,f,e=0,i=0,r=0,o=0,a=0,u=M(n);if(u!==M(t))return G;for(s=0;s<u;s++)c=t[s],(f=n[s])===w||c===w||lt(f)||lt(c)||(e+=c=ft(c),i+=f=ft(f),r+=f*f,o+=f*c,a++);return a*r-i*i==0?x:O((a*o-i*e)/(a*r-i*i))}function Be(t,n,e,i){return Un(!0,t,n,e,i)}function Le(t,n){var e,i,r,o,a,u,s,c,f,l,h,d,r=0,o=0,a=0,u=0,s=0,c=0,f=M(t);if(f!==M(n))return G;for(l=0;l<f;l++)h=t[l],d=n[l],h!==w&&d!==w&&(r+=h,o+=h*h,a+=d,u+=d*d,s+=d*h,c++);return c*(c-2)==0||c*u-a*a==0?x:st((c*o-r*r-(c*s-a*r)*(c*s-a*r)/(c*u-a*a))/(c*(c-2)))}function Fe(t){var n,e,i,e=t,i=e+5.5;return i-=(e+.5)*ct(i),n=1.000000000190015+76.18009172947146/(t+1),ct(2.506628274631001*(n=(n=(n-=86.50532032941678/(t+2))+24.01409824083091/(t+3)-1.231739572450155/(t+4))+.001208650973866179/(t+5)-5395239384953e-18/(t+6))/e)-i}function Pe(t,n,e,i,r){var t,r,i,o,a,u,r,i;return t<i||r<t||i===r?U:(t=(t-i)/(r-i),r=Fe(n+e),i=Fe(n),o=Fe(e),a=ct(t),u=ct(1-t),r=at(r-i-o+n*a+e*u),i=t<(n+1)/(n+e+2)?r*tn(n,e,t)/n:1-r*tn(e,n,1-t)/e,O(i))}function Ge(t,n,e,i,r,o){var t;return t<r||o<t||r===o?U:(t=(t-r)/(o-r),i?yn(t,n,e):Mn(t,n,e)/(o-r))}function Ue(t,n,e,i,r){var o,a,u,s,c,f,l,h,d,v,m,g,p,b,y,w,M,C,e,S,T,A,I,t,x,N,n,k,D,_,E,o=2.30753,a=.27061,u=.99229,s=.04481,c=3e-308,f=1e-300,l=c,h=1-222e-18,d=5,v=6,m=2,M=sn(n,e),g=t<=.5?(y=t,S=n,A=e,0):(y=1-t,S=e,A=n,1),I=st(-ct(y*y)),k=I-(o+a*I)/(1+(u+s*I)*I),E=1<S&&1<A?(n=k*st((e=2/((t=1/(S+S-1))+(x=1/(A+A-1))))+(I=(k*k-3)/6))/e-(x-t)*(I+5/6-2/(3*e)),S/(S+A*at(n+n))):(x=(I=A+A)*ot(1-(x=1/(9*A))+k*st(x),3))<=0?1-at((ct((1-y)*A)+M)/A):(x=(4*S+I-2)/x)<=1?at((ct(y*S)+M)/S):1-2/(x+1);for(I=1-S,x=1-A,D=0,w=1,E<l?E=l:h<E&&(E=h),_=j(f,ot(10,-13-2.5/(S*S)-.5/(y*y))),p=N=T=0;p<1e3;p++){for((k=((k=cn(E,S,A))-y)*at(M+I*ct(E)+x*ct(1-E)))*D<=0&&(T=j(ut(w),c)),C=1,b=0;b<1e3;b++){if(ut(w=C*k)<T&&0<=(N=E-w)&&N<=1){if(T<=_)return O((r-i)*(E=0!==g?1-E:E)+i);if(ut(k)<=_)return O((r-i)*(E=0!==g?1-E:E)+i);if(0!==N&&1!==N)break}C/=3}if(N===E)return O((r-i)*(E=0!==g?1-E:E)+i);E=N,D=k}return O((r-i)*(E=0!==g?1-E:E)+i)}function He(t,n,e){var i,r,o,a;if(n<2*t)return He(n-t,n,1-e);for(o=r=i=0,a=1;i<t||r<t||o<n-t;)i<t&&a<1?a*=(n-t+ ++i)/i:r<t?(r++,a*=e):(o++,a*=1-e);return a}function ze(t,n,e,i){return i*(n-t)/(t+1)*e/(1-e)}function Ve(t,n,e,i){return i*t/(n-t+1)*(1-e)/e}function Ye(t,n,e,i){var r,o,r,r,a,u,s,c;if(0===e&&i===t)return 1;if(0===n)return 0===e?1:0;if(1===n)return i===t?1:0;if(e===i)return He(e,t,n);if(0===(r=e<=(r=Math.floor(t*n))&&r<=i?He(o=r,t,n):(r=He(e,t,n),(a=He(i,t,n))<r?(o=e,r):(o=i,a))))return 0;for(s=u=r,c=o;c<i&&0!==(s=ze(c,t,n,s));c++)u+=s;for(s=r,c=o;e<c&&0!==(s=Ve(c,t,n,s));c--)u+=s;return u}function Ze(t,n,e,i){return n<t?U:i?Ye(n,e,0,t):He(t,n,e)}function We(t,n,e){var i;return t+n-1<=0?U:(i=L(t+n-1,n-1),lt(i)?i:O(ft(i)*ot(e,n)*ot(1-e,t)))}function Qe(t,n,e,i){if(t+n-1<=0)return U;if(i)return 1-yn(1-e,t+1,n);for(var r=ot(e,n),o,o=0;o<t;o++)r*=(o+n)/(o+1)*(1-e);return r}function Je(t,n,e){for(var i,r,o,a,i=0,r=t;i+1<r;)e<=(a=Ye(t,n,0,o=T((i+r)/2)))?r=o:i=o;return r}function Ke(t,n){var e,i,r,o,a,u,s,c,f,t,l,l,e=ct(st(h)),i=1/st(h),s=0,c=t,f=.5*c,t=n%2==0;if(1<n&&(s=at(-f)),l=d(-st(c)),lt(l))return l;if(l=ft(l),o=t?s:2*l,2<n){if(c=.5*(n-1),a=t?1:.5,20<f){for(r=t?0:e,u=ct(f);a<=c;)r=ct(a)+r,o+=at(u*a-f-r),a+=1;return o}for(r=t?1:i/st(f),u=0;a<=c;)u+=r*=f/a,a+=1;return u*s+o}return o}function Xe(t,n,e){return(e?In:Dn)(t,n)}function qe(t,n){var t=hi(1-t,.5*n,2);return ft(t)}function $e(n,e){return{Sl:function(t){return n-In(t,e)}}}function ti(t,n){var e,i,t,e,i={l9t:!1},t=ln($e(t,n),.5*n,n,i);return i.l9t?G:t}function ni(t,n){var e,i,r,o,a,u,s,e=0,r=t.rowCount,o=t.colCount;if(r!==n.rowCount||o!==n.colCount)return G;if(1<r&&1<o)i=(r-1)*(o-1);else if(1<r&&1===o)i=r-1;else{if(!(1===r&&1<o))return G;i=o-1}for(a=0;a<M(t);a++)if(u=t[a],s=n[a],u!==w&&s!==w){if(0===s)return x;e+=(u-s)*(u-s)/s}return e<0?U:Ke(e,i)}function ei(t,n){var e,i,r,o,a,u,s,c,f,l,t,n,h,d,v,m,g,e=F.ExcelCompatibleCalcMode?5:1,i=H(t,e,!0,!1,!1,!0),r=H(n,e,!0,!1,!1,!0),o=0,a=0,u=0,s=0,c=0,h=M(r);if(h!==M(i))return G;for(v=d=0;v<h;v++){if(m=i[v],g=r[v],lt(m))return m;if(lt(g))return g;m!==w&&g!==w&&(o+=m,a+=g,u+=m*m,s+=g*g,d++)}if(d<=1)return x;if(f=o/d,l=a/d,t=st((d*u-o*o)/(d*(d-1))),n=st((d*s-a*a)/(d*(d-1))),0===t||0===n)return x;for(v=0;v<h;v++)m=i[v],g=r[v],m!==w&&g!==w&&(c+=(m-f)*(g-l));return O(c/ft((d-1)*t*n))}function ii(t,n,e){var t=at(-n*t);return O(e?1-t:n*t)}function ri(t,n,e){var i,r,o,t,i,r,o,t=Pe(n*t/(n*t+e),.5*n,.5*e,0,1);return lt(t)?t:1-ft(t)}function oi(t,n,e,i){var r;return i?1-yn(e/(e+n*t),e/2,n/2):ot(n/e,n/2)*ot(t,n/2-1)/(ot(1+t*n/e,(n+e)/2)*Cn(!0,n/2,e/2))}function ai(t,n,e){var i,t,i,t=Ue(1-(1-t),e/2,n/2,0,1);return lt(t)?t:(1/ft(t)-1)*(e/n)}function ui(t,n,e){var i,t,i,t=Ue(1-t,e/2,n/2,0,1);return lt(t)?t:(1/ft(t)-1)*(e/n)}function si(t){return ct((1+t)/(1-t))/2}function ci(t){var n,t,n=at(2*t)-1,t=at(2*t)+1;return!N(n)&&0<n&&!N(t)&&0<t?1:n/t}function fi(t,n){var e,i,e,e,t,n,i,e={N:0,M:0,Q:0,h9t:0};return mn(e,t),t=e.N-1,1===e.N||0==(i=e.Q/(e.N-1))||(e.N=0,e.M=0,e.Q=0,e.h9t=0,mn(e,n),n=e.N-1,1===e.N)||0==(e=e.Q/(e.N-1))?x:(i=ri(i/e,t,n),lt(i)?i:1<(e=2*(1-ft(i)))?2-e:e)}function li(t,n,e,i){var i,r,o,a,u,s,c,f,l,h,d,v,m,g,p,b,d,y,w,M,C,S,T,A;if(!1===i)return i=ot(e,n),I(i)||!N(i)?x:(r=1/(i*an(n)))*(u=(o=ot(t,n-1))*(a=at(-t/e)));if(M=1/3,C=1e8,S=1e37,A=-88,(t/=e)<=0)return U;if((T=1e3)<n)return w=yi(s=3*st(n)*(ot(t/n,1/3)+1/(9*n)-1),0,1,!0),lt(w)?w:ft(w);if(1e8<t)return 1;if(t<=1||t<n){if(w=di(n+1),lt(w))return w;for(v=n*ct(t)-t-ft(w),y=m=1,p=n;y+=m=m*t/(p+=1),2220446049250313e-31<m;);v+=ct(y),y=0,-88<=v&&(y=at(v))}else{if(w=di(n),lt(w))return w;for(v=n*ct(t)-t-ft(w),m=0,y=(f=(c=t)+(s=1))/(l=t*(b=(p=1-n)+t+1));;){if(h=(b+=2)*f-(d=(p+=1)*(m+=1))*s,0<ut(d=b*l-d*c)){if(ut(y-(g=h/d))<=k(2220446049250313e-31,2220446049250313e-31*g))break;y=g}s=f,c=l,l=d,ut(f=h)>=S&&(s/=S,c/=S,f/=S,l/=S)}v+=ct(y),y=1,-88<=v&&(y=1-at(v))}return y}function hi(t,n,e){var i,r,o,a,R,B,L,F,P,G,U,u,H,z,s,V,Y,Z,W,Q,J,K,X,q,$,tt,c,f,l,h,d,v,m,nt,g,et,it,rt,p,b,y,w,M,C,S,T,A,I,x,N,k,D,_,E,m,j,O,i=4.67,r=6.66,o=6.73,a=13.32,R=60,B=70,L=84,F=105,P=120,G=127,U=140,u=1175,H=210,z=252,s=2264,V=294,Y=346,Z=420,W=462,Q=606,J=672,K=707,X=735,q=889,$=932,tt=966,c=1141,f=1182,l=1278,h=1740,d=2520,v=5040,m=5e-7,nt=.01,g=5e-7,et=20,it,rt;if(t<2e-6)return 0;if(.999998<t)return ht;if(S=2*n,y=n-1,O=di(n),lt(O))return O;if(M=ft(O),S<-1.24*ct(t)){if((w=ot(t*n*at(M+.6931471805599453*n),1/n))<m)return NaN}else if(.32<S){if(O=wi(t,0,1),lt(O))return O;m=ft(O),2.2*S+6<(w=S*ot(m*st(C=.222222/S)+1-C,3))&&(w=-2*(ct(1-t)-y*ct(.5*w)+M))}else for(w=.4,p=ct(1-t)+M+.6931471805599453*y;E=(i+2*(A=w))/(C=1+w*(i+w))-.5-(o+w*(a+3*w))/(T=w*(o+w*(r+w))),w-=(1-at(p+.5*w)*T/C)/E,.01<ut(A/w-1););for(j=1;j<=20;j++){if(O=li(C=.5*(A=w),n,1,!0),lt(O))return O;if(E=(T=t-ft(O))*at(.6931471805599453*n+M+C-y*ct(w)),ut(A/(w+=E*(1+.5*E*(I=(210+(p=.5*E-(b=E/w)*y)*(140+p*(105+p*(84+p*(70+60*p)))))/420)-b*y*(I-b*((x=(420+p*(735+p*(966+p*(c+l*p))))/d)-b*((N=(210+p*(462+p*(707+932*p)))/d)-b*((k=(252+p*(672+f*p)+y*(294+p*(889+h*p)))/v)-b*((D=(84+s*p+y*(u+606*p))/d)-b*(_=(120+y*(346+127*y))/v))))))))-1)>g)return.5*e*w}return.5*e*w}function di(t){return un(t)}function vi(t,n,e,i){return t>k(n,e)||t<j(0,n-i+e)||i<n||i<e?U:_n(t,n,e,i)}function mi(t,n,e,i,r){var o,a;if(t>k(n,e)||t<j(0,n-i+e)||i<n||i<e)return U;if(r){for(a=o=0;a<=t;a++)o+=_n(a,n,e,i);return o}return _n(t,n,e,i)}function gi(t,n,e){return d((ct(t)-n)/e)}function pi(t,n,e,i){var i;return i?d((ct(t)-n)/e):(i=(ct(t)-n)/e,.3989422804014327*at(-i*i/2)/e/t)}function bi(t,n,e){var t,t,t=Mi(t);return lt(t)?t:(t=ft(t),O(at(n+e*t)))}function yi(t,n,e,i){return i?d((t-n)/e):O(at(-(t-n)*(t-n)/(2*e*e))/(st(2*h)*e))}function wi(t,n,e){var i,r,o,i,o,i,o=t-.5;if(ut(o)<=.42)r=o*(((-25.44106049637*(i=o*o)+41.39119773534)*i-18.61500062529)*i+2.50662823884)/((((3.13082909833*i-21.06224101826)*i+23.08336743743)*i-8.4735109309)*i+1);else{if(i=t,!(2220446049250313e-31<(i=0<o?1-t:i)))return 1e-300<i?(r=-2*ct(t),i=ct(6.283185307179586*r),r=st(r*(1-(i=i/r+(2-i)/(r*r)+(6*i-14-i*i)/(2*r*r*r)))),o<0?-r:r):o<0?-ht:ht;r=(((2.32121276858*(i=st(-ct(i)))+4.85014127135)*i-2.29796479134)*i-2.78718931138)/((1.63706781897*i+3.54388924762)*i+1),o<0&&(r=-r)}return o=.3989422804014327*at(-.5*(i=+r)*i),i=yi(r,0,1,!0),lt(i)?i:n+e*(r-=(i-t)/o)}function Mi(t){return wi(t,0,1)}function Ci(t,n){return n?fn(t):at(-ot(t,2)/2)/st(2*h)}function Si(t,n){var e,i,r,o,a,u,s,c,f,l,e=0,i=0,r=0,o=0,a=0,u=M(t);if(u!==M(n))return G;for(c=s=0;c<u;c++)f=t[c],l=n[c],J(f)&&J(l)&&(e+=f,i+=l,r+=f*f,o+=l*l,a+=f*l,s++);return s*r-e*e==0||s*o-i*i==0?x:(s*a-e*i)/st((s*r-e*e)*(s*o-i*i))}function Ti(t,n){var e,i,r,o,a,u,s,c,f,l,h,h,e=0,i=0,r=0,o=0,a=0,u=0,s=M(n);if(s!==M(t))return G;for(c=0;c<s;c++)f=n[c],l=t[c],J(f)&&J(l)&&(e+=f,i+=l,r+=f*f,o+=l*l,a+=f*l,u++);return 0===(h=st((u*r-e*e)*(u*o-i*i)))?x:O((h=(u*a-e*i)/h)*h)}function Ai(t,n,e){var i,r,i=0;if(e)for(r=0;r<=t;r++)i+=at(-n)*ot(n,r)/F.Functions.nkt(r);else i=at(-n)*ot(n,t)/F.Functions.nkt(t);return O(i)}function Ii(t,n,e,i){var r,o,a,u,s,c,f,r=e;if(i!==P&&(r=ft(i),I(r)))return y;if(a=o=0,(u=M(t))!==M(n))return G;for(s=0;s<u;s++)if(c=t[s],f=n[s],c!==w&&f!==w){if(f<=0||1<f)return U;e<=c&&c<=r&&(o+=f),a+=f}return 1!==a?U:o}function xi(){for(var t,n,e,i,r,o,a,u,s,c,f,l,t=arguments,n=0,e=0,i=0,a=0,f=[],u=0;u<M(t);u++)for(f.push(l=t[u]),s=0;s<M(l);s++)(c=l[s])!==w&&(n+=c,e+=c*c,a++);if(a<=2)return x;if(r=n/a,0===(o=st((a*e-n*n)/(a*(a-1)))))return x;for(u=0;u<M(f);u++)for(l=f[u],s=0;s<M(l);s++)(c=l[s])!==w&&(i+=ot((c-r)/o,3));return O(a*i/((a-1)*(a-2)))}function Ni(){for(var t,n,e,i,r,o,a,u,s,c,f,l,h,d,t=arguments,n=0,r=0,c=[],o=0;o<M(t);o++){if(s=t[o],1===M(t)&&0===M(s))return E;for(a=0;a<M(s);a++)f={value:0},(u=s[a])!==w&&"boolean"!=typeof u&&K(u,f)&&(n+=f.value,r++,c.push(f.value))}if(r<=2)return x;for(e=n/r,o=d=h=l=0;o<c.length;o++)h+=ot(d=c[o]-e,2),l+=ot(d,3);return 0===(i=st(h/r))?x:O(l/r/i/i/i)}function ki(t,n,e){return(t-n)/e}function Di(t,n,e){var i,r,o,a,t,u,s,c,f,l;if(1!==e&&2!==e)return U;if(r=t/st(i=n),o=i/(i+t*t),a=i-2,t=i%2,i=s=u=1,f=c=2+t,2<=a)for(l=C(c);l<=a&&(u+=s=s*o*(f-1)/f)!==i;l+=2)i=u,f+=2;return 1!=t?e*(1-(.5+.5*r*st(o)*u)):e*(1-(.5+.3183098862*(r*o*(u=1===n?0:u)+D(r))))}function _i(t,n,e){return En(t,n,e?4:3)}function Ei(t,n){return Di(t,n,1)}function ji(t,n){return Di(t,n,2)}function Oi(t,n){var e,i,e,r,o,a,t,u,t,s,c,t,i,t,e=1e-12,t=t/2,i=t;if(1e20<n)return Mi(t);if(t=i<.5?(c=0,2*i):2*((c=1)-i),ut(n-2)<e)u=0<t?st(2/(t*(2-t))-2):ht;else if(ft(n)<1+e)u=0<t?-A(a=1.5707963267948966*(t+1)):ht;else{if(o=((94.5/((e=48/((i=1/(n-.5))*i))+(r=((20700*i/e-98)*i-16)*i+96.36))-3)/e+1)*st(1.5707963267948966*i)*n,.05+i<(s=ot(o*t,2/n))){if(t=Mi(.5*t),lt(t))return t;t=ft(t),n<5&&(r+=.3*(n-4.5)*(t+.6)),s=(((((.4*(s=t*t)+6.3)*s+36)*s+94.5)/(r=(((.05*o*t-5)*t-7)*t-2)*t+e+r)-s-3)/e+1)*t,s=.002<(s*=i*s)?at(s)-1:.5*s*s+s}else s=((1/(((n+6)/(n*s)-.089*o-.822)*(n+2)*3)+.5/(n+4))*s-1)*(n+1)/(n+2)+1/s;u=st(n*s)}return O(u=0!==c?-u:u)}function Ri(t,n){return t<.5?-On(1-t,n,4):On(t,n,4)}function Bi(t,n,e,i){var r,o,a,a,u,s,c,f,l,f,h,d,v,m,g,p,b,y,w,i,i,f={N:0,M:0,Q:0,h9t:0};if(1!==e&&2!==e)return U;if(1===i){if(b=p=g=m=v=d=h=void 0,M(t)!==M(n))return G;for(y=M(t),b=0;b<y;b++)t[b]=t[b]-n[b];for(b=m=g=p=h=0;b<y;b++)m+=v=(d=(w=t[b])-m)/(p+1),g+=p*d*v,p++,h+=w;if(p-1==0||0===p)return x;if(a=st(g/(p-1)),I(a)||!N(a))return U;a=(r=h/p)/(a/st(p)),c=p-1}else f.N=0,f.M=0,f.Q=0,f.h9t=0,hn(f,t),u=f.Q/(f.N-1),r=f.h9t/f.N,l=f.N,f.N=0,f.M=0,f.Q=0,f.h9t=0,hn(f,n),s=f.Q/(f.N-1),o=f.h9t/f.N,f=f.N,c=2!==i?1/((i=u/l/(u/l+s/f))*i/ft(l-1)+(1-i)*(1-i)/ft(f-1)):ft(l+f-2),a=(r-o)/st(u/ft(l)+s/ft(f));return i=vn(.5*c,.5,c/(c+(a=ut(a))*a)),lt(i)?i:.5*e*ft(i)}function Li(t,n,e,i){var r=at(-ot(t/e,n));return O(i?1-r:n/ot(e,n)*ot(t,n-1)*r)}function Fi(t,n,e){var i,r,o,a,e,u,s,c,s,i,i=0,r=0,o=0,u=0;if(e!==P&&(i=ft(e),I(i)))return y;for(c=0;c<M(t);c++)(s=t[c])!==w&&(r+=s=ft(s),o+=s*s,u++);return 0===u?G:1===u||(a=r/u,0===(e=e!==P?i:st((u*o-r*r)/(u*(u-1)))))?x:(i=d((a-n)/(e/st(u))),lt(i)?i:O(1-ft(i)))}function Pi(t,n){t=ft(C(t)),n=ft(C(n));var e=1,i;if(t<0||n<0||t<n)return U;for(i=t-n+1;i<=t;i++)e*=i;return O(e)}function Gi(t,n){return Pn(!1,t,n)}function Ui(){for(var t,n,e,i,r,o,a,t=0,n=[],e=bn(arguments),i=M(e),r=0;r<i;r++){for(o=0,a=r+1;a<i;a++)e[r]===e[a]&&o++;t<o?(t=o,(n=[]).push([e[r]])):o===t&&n.push([e[r]])}return 0===t?G:new F.CalcArray(n)}function Hi(t,n){return e([t,n],18)}function zi(t,n){return e([t,n],19)}function Vi(t,n,e){return 1<t.rowCount||1<t.colCount?y:Bn(!1,n,t[0],e)}function Yi(t,n){var n,n,n=n;return 0<=t&&t<2147483647&&0<=n&&n<2147483647&&(t=Math.pow(g(t),g(n)),(n=Math.abs(t))<=179769e303)?22250738585072014e-324<=n?t:0:U}function Zi(t){var n,n;return""!==t&&!0===K(t,n={value:0})?(t=.3989422804014327*Math.exp(-n.value*n.value*.5),(n=Math.abs(t))<=179769e303?22250738585072014e-324<=n?t:0:U):y}function Wi(t,n,e,i){var r,o,a,u,r={value:0};return t=X(t,r),n=K(n,o={value:0}),e=X(e,a={value:0}),4===arguments.length&&i?i=X(i,u={value:0}):(i=e,u=a),!0===t&&!0===n&&!0===e&&!0===i?(n=o.value,e=a.value,i=u.value,0<=(t=r.value)&&t<=2147483646&&0<=n&&n<=1&&0<=e&&e<=t&&e<=i&&i<=t?Ye(t,n,e,i):U):y}function Qi(t){var n,e,n;if(0<t)t=Math.exp(un(t));else{if(0===(e=t+(n=Math.abs(g(t)))))return U;t=Math.pow(-1,n-1)*Math.exp(un(-e))*Math.exp(un(1+e))/Math.exp(un(n+1-e))}return(n=Math.abs(t))<=179769e303?22250738585072014e-324<=n?t:0:U}function Ji(t){t=Xt(t)-.5;var n=Math.abs(t);return n<=179769e303?22250738585072014e-324<=n?t:0:U}Object.defineProperty(t,"__esModule",{value:!0}),m=v("Common"),F=v("CalcEngine"),M=m.Common.Uf.tR,z=null,P=void 0,I=isNaN,N=isFinite,g=parseInt,ot=Math.pow,j=Math.max,k=Math.min,T=Math.floor,b=Math.sin,A=Math.tan,h=Math.PI,D=Math.atan,at=Math.exp,ut=Math.abs,st=Math.sqrt,ct=Math.log,_=Math.round,x=F.Errors.DivideByZero,y=F.Errors.Value,G=F.Errors.NotAvailable,U=F.Errors.Number,E=F.Errors.Null,O=F.Convert.L6t,H=F.Convert.iV,C=F.Convert.z6t,ft=F.Convert.uJ,R=F.Convert.LE,B=F.Functions.MathHelper,L=B.g9t,V=B.p9t,p=F.Convert.q8,lt=F.Convert.BJ,Y=F.Functions.b9t,Z=F.Functions.y9t,e=F.Functions.w9t,d=F.Functions.dkt,W=F.Functions.G6t,Q=F.Functions.OMt,J=F.Functions.q8,ht=F.Functions.B6t,w=F.Convert.CalcConvertedError,t=F.Functions.F6t,K=F.Convert.sJ,X=F.Convert.t9t,v={J6t:0,pkt:["< 0",">= 1"]},c={J6t:4,X6t:1,Vkt:!0,Ykt:!0,Zkt:!0,n9t:!0},gt={J6t:4,X6t:1,Vkt:!0,Ykt:!0,n9t:!0},pt={J6t:4,X6t:1,Ykt:!0,Zkt:!0},bt={J6t:4,X6t:0,Vkt:!0},Mt={J6t:4,X6t:0,Vkt:!0,Ykt:!0,n9t:!0},Ct={J6t:4,X6t:0,Vkt:!0,Ykt:!0,Zkt:!0,n9t:!0},At=[s={J6t:4,X6t:1,Vkt:!0,Ykt:!0,Zkt:!0},{J6t:2}],It=[s,r={J6t:0},{bkt:3,J6t:2,pkt:"< 1"}],xt=[et={J6t:0,pkt:["<= 0",">= 1"]},o={J6t:0,pkt:"<= 0"},tt={J6t:2,pkt:"< 1"}],Nt=[et,o,o,it={bkt:0,J6t:0},rt={bkt:1,J6t:0}],kt=[i={J6t:2,pkt:"< 0"},i,a={J6t:0,pkt:["< 0","> 1"]},n={J6t:7}],Dt=[i,a,et],_t=[u={J6t:0,pkt:"< 0"},dt={J6t:0,pkt:["< 1","> 10000000000"]}],Et=[a,nt={J6t:2,pkt:["< 1","> 10000000000"]}],jt=[mt={J6t:4,X6t:1,Vkt:!0,Ykt:!0},mt],Ot=[u,o,n],Rt=[u,vt={J6t:0,pkt:["< 1",">= 10000000000"]},vt],vt=[a,vt,vt],Bt=[s,s],Lt=[u,o,o,n],Ft=[a,o,o],Pt=[a,r,o],Gt=[r,r,o,n],Ut=[yt={J6t:4,X6t:1,Vkt:!0},yt],Ht=[i,u,n],zt=[u,tt],Vt=[wt={J6t:4,X6t:1,Vkt:!0,Ykt:!0,M9t:!0},wt,$={J6t:2},{J6t:2,pkt:["< 1","> 3"]}],Yt=[u,o,o,n],Wt=[St={J6t:4,X6t:1,Ykt:!0,M9t:!0},{},q={bkt:!0,J6t:7},{bkt:!(Zt=[s,r]),J6t:7}],Qt=[{},s,it],Jt=[Tt={J6t:4,X6t:1,Vkt:!0,Ykt:!0,C9t:!0,Zkt:!0},r],t("TREND",zn,1,4,[{J6t:4,X6t:0,Ykt:!0},{},{},q],[0,1,2],[0,1,2],{wkt:[1,2,3]}),t("GROWTH",Vn,1,4,[St,{},{},q],"!= 3","!= 3",{wkt:[1,2,3]}),t("FORECAST",Yn,3,3,[r,s,s],"> 0","> 0"),t("AVERAGE",Zn,1,P,P,-1,-1),t("STDEV",Wn,1,P,P,-1,-1),t("STDEV.S",Wn,1,P,P,-1,-1),t("PERCENTILE",Qn,2,2,P,0,0),t("PERCENTILE.INC",Qn,2,2,P,0,0),t("MAX",Jn,1,P,P,-1,-1),t("MAXA",Kn,1,P,Mt,-1,-1),t("MIN",Xn,1,P,P,-1,-1),t("MINA",qn,1,P,Mt,-1,-1),t("LARGE",$n,2,2,Jt,0,0),t("SMALL",te,2,2,Jt,0,0),t("AVERAGEA",ne,1,P,Ct,-1,-1),t("AVERAGEIF",re,2,3,P,[0,1,2],[0,1,2],{wkt:2,e9t:[2],i9t:!0,r9t:!0}),t("MEDIAN",oe,1,P,c,-1,-1),t("MODE",ae,1,P,c,-1,-1),t("MODE.SNGL",ae,1,P,c,-1,-1),t("GEOMEAN",ue,1,P,gt,-1,-1),t("HARMEAN",se,1,P,c,-1,-1),t("TRIMMEAN",ce,2,2,[s,v],0,0),t("FREQUENCY",fe,2,2,[pt,pt],-1,-1),t("RANK",le,2,3,Qt,[0,1],[0,1],{wkt:2}),t("RANK.EQ",le,2,3,Qt,[0,1],1,{wkt:2}),t("KURT",he,1,P,c,-1,-1),t("PERCENTRANK",de,2,3,It,0,0,{wkt:2}),t("PERCENTRANK.INC",de,2,3,It,0,0,{wkt:2}),t("PERCENTRANK.EXC",ve,2,3,It,0,0,{wkt:2}),t("QUARTILE",me,2,2,At,0,0),t("QUARTILE.INC",me,2,2,At,0,0),t("COUNT",ge,1,P,P,-1,-1,{f9t:-1}),t("COUNTA",pe,1,P,P,-1,-1,{f9t:-1}),t("COUNTBLANK",be,1,1,bt,-1,-1),t("COUNTIF",we,2,2,[bt,bt],[0,1],[0,1],{f9t:[1]}),t("AVEDEV",Me,1,P,c,-1,-1),t("STDEVA",Ce,1,P,Ct,-1,-1),t("STDEVP",Se,1,P,P,-1,-1),t("STDEV.P",Se,1,P,P,-1,-1),t("STDEVPA",Te,1,P,Ct,-1,-1),t("VAR",Ae,1,P,P,-1,-1),t("VAR.S",Ae,1,P,P,-1,-1),t("VARA",Ie,1,P,Ct,-1,-1),t("VARP",xe,1,P,P,-1,-1),t("VAR.P",xe,1,P,P,-1,-1),t("VARPA",Ne,1,P,Ct,-1,-1),t("COVAR",ke,2,2,jt,-1,-1),t("COVARIANCE.P",ke,2,2,jt,-1,-1),t("DEVSQ",De,1,P,c,-1,-1),t("CONFIDENCE",_e,3,3,xt),t("CONFIDENCE.NORM",_e,3,3,xt),t("CONFIDENCE.T",Ee,3,3,xt),t("INTERCEPT",je,2,2,[c,c],-1,-1),t("LINEST",Oe,1,4,Wt,[0,1],[0,1],{wkt:[1,2,3],o9t:1}),t("SLOPE",Re,2,2,[c,c],-1,-1,{o9t:1}),t("LOGEST",Be,1,4,Wt,[0,1],[0,1],{wkt:[1,2,3]}),t("STEYX",Le,2,2,jt,-1,-1),t("BETADIST",Pe,3,5,[r,o,o,it,rt],P,P,{wkt:[3,4]}),t("BETA.DIST",Ge,4,6,[r,o,o,n,it,rt],P,P,{wkt:[5,6]}),t("BETAINV",Ue,3,5,Nt,P,P,{wkt:[3,4]}),t("BETA.INV",Ue,3,5,Nt,P,P,{wkt:[3,4]}),t("BINOMDIST",Ze,4,4,kt),t("BINOM.DIST",Ze,4,4,kt),t("NEGBINOMDIST",We,3,3,[$,$,v]),t("NEGBINOM.DIST",Qe,4,4,[i,tt,v,n]),t("CRITBINOM",Je,3,3,Dt),t("BINOM.INV",Je,3,3,Dt),t("CHIDIST",Ke,2,2,_t),t("CHISQ.DIST.RT",Ke,2,2,_t),t("CHISQ.DIST",Xe,3,3,[u,nt,n]),t("CHIINV",qe,2,2,Et),t("CHISQ.INV.RT",qe,2,2,[a,tt]),t("CHISQ.INV",ti,2,2,Et),t("CHITEST",ni,2,2,jt,-1,-1),t("CHISQ.TEST",ni,2,2,jt,-1,-1),t("CORREL",ei,2,2,P,-1,-1),t("EXPONDIST",ii,3,3,Ot),t("EXPON.DIST",ii,3,3,Ot),t("FDIST",ri,3,3,Rt),t("F.DIST",oi,4,4,[u,dt,dt,n]),t("F.DIST.RT",ri,3,3,Rt),t("FINV",ai,3,3,vt),t("F.INV.RT",ai,3,3,vt),t("F.INV",ui,3,3,[a,nt,nt]),t("FISHER",si,1,1,{J6t:0,pkt:["<= -1",">= 1"]}),t("FISHERINV",ci,1,1,r),t("FTEST",fi,2,2,Bt,-1,-1),t("F.TEST",fi,2,2,Bt,-1,-1),t("GAMMADIST",li,4,4,Lt),t("GAMMA.DIST",li,4,4,Lt),t("GAMMAINV",hi,3,3,Ft),t("GAMMA.INV",hi,3,3,Ft),t("GAMMALN",di,1,1,o),t("GAMMALN.PRECISE",di,1,1,o),t("HYPGEOMDIST",vi,4,4,[i,i,i,i]),t("HYPGEOM.DIST",mi,5,5,[i,i,i,i,n]),t("LOGNORMDIST",gi,3,3,[o,r,o]),t("LOGNORM.DIST",pi,4,4,[o,r,o,n]),t("LOGINV",bi,3,3,Pt),t("LOGNORM.INV",bi,3,3,Pt),t("NORMDIST",yi,4,4,Gt),t("NORM.DIST",yi,4,4,Gt),t("NORMINV",wi,3,3,Pt),t("NORM.INV",wi,3,3,Pt),t("NORMSDIST",d,1,1,r,P,P),t("NORMSINV",Mi,1,1,a),t("NORM.S.INV",Mi,1,1,a),t("NORM.S.DIST",Ci,2,2,[r,n]),t("PEARSON",Si,2,2,Ut,-1,-1),t("RSQ",Ti,2,2,Ut,[0,1],[0,1]),t("POISSON",Ai,3,3,Ht),t("POISSON.DIST",Ai,3,3,Ht),t("PROB",Ii,3,4,[wt,mt,r],[0,1],[0,1],{wkt:3}),t("SKEW",xi,1,P,c,-1,-1),t("STANDARDIZE",ki,3,3,[r,r,o]),t("TDIST",Di,3,3,[u,tt,$]),t("T.DIST",_i,3,3,[r,tt,n]),t("T.DIST.RT",Ei,2,2,zt),t("T.DIST.2T",ji,2,2,zt),t("TINV",Oi,2,2,Et),t("T.INV.2T",Oi,2,2,Et),t("T.INV",Ri,2,2,[{J6t:0,pkt:["<= 0","> 1"]},nt]),t("TTEST",Bi,4,4,Vt,[0,1],[0,1]),t("T.TEST",Bi,4,4,Vt,[0,1],[0,1]),t("WEIBULL",Li,4,4,Yt),t("WEIBULL.DIST",Li,4,4,Yt),t("ZTEST",Fi,2,3,Zt,0,0,{wkt:2}),t("Z.TEST",Fi,2,3,Zt,0,0,{wkt:2}),t("PERMUT",Pi,2,2),t("COVARIANCE.S",Gi,2,2,jt,-1,-1),t("MODE.MULT",Ui,1,P,gt,-1,-1),t("PERCENTILE.EXC",Hi,2,2,[s,et],0,0),t("QUARTILE.EXC",zi,2,2,[Mt,$],0,0),t("RANK.AVG",Vi,2,3,[wt,yt,it],[0,1],1,{wkt:2}),t("PERMUTATIONA",Yi,2,2,[r,r]),t("PHI",Zi,1,1),t("BINOM.DIST.RANGE",Wi,3,4,[{bkt:0},{bkt:0},{bkt:0}]),t("GAMMA",Qi,1,1,o),t("GAUSS",Ji,1,1,r),t("SKEW.P",Ni,1,P,Ct,-1,-1)},CalcEngine:function(t){t.exports=a("CalcEngine")},Common:function(t){t.exports=a("Common")}},i={},n=t={},Object.defineProperty(n,"__esModule",{value:!0}),n.Functions=void 0,r=o("CalcEngine"),Object.defineProperty(n,"Functions",{enumerable:!0,get:function(){return r.Functions}}),o("./src/functions-db.ts"),o("./src/functions-eng.ts"),o("./src/functions-fin.ts"),o("./src/functions-lookup.ts"),o("./src/functions-stat.ts"),(((u={}).Spread=u.Spread||{}).CalcEngine=u.Spread.CalcEngine||{}).AdvancedFunctions=t}(),t.exports=u.Spread.CalcEngine.AdvancedFunctions},"./node_modules_local/@grapecity/js-calc-advancedfunctions/index.js":function(t,n,e){t.exports=e("./node_modules_local/@grapecity/js-calc-advancedfunctions/dist/gc.spread.calcengine.advancedfunctions.js")},"./node_modules_local/@grapecity/js-calc-basicfunctions/dist/gc.spread.calcengine.basicfunctions.js":function(t,n,a){var u;!function(){"use strict";var e,i,t,n,r;function o(t){var n,n,n=i[t];return void 0!==n||(n=i[t]={exports:{}},e[t](n,n.exports,o)),n.exports}e={"./src/functions-basic.ts":function(B,t,L){var c,I,o,F,a,P,G,f,U,H,z,M,t,V,b,h,w,Y,Z,l,W,s,Q,J,K,C,X,q,$,tt,nt,et,u,S,it,rt,g,y,T,A,x,N,k,ot,d,at,ut,st,D,_,ct,ft,lt,ht,v,dt,vt,mt,gt,pt,bt,yt,wt,Mt,m,Ct,p,t,St,Tt,At,It,xt,Nt,kt,Dt,_t,Et,jt,Ot,n,Rt,e,Bt,Lt,Ft,Pt,i,Gt,r,Ut,Ht,E,j,zt,Vt,Yt,Zt,Wt,Qt,Jt,Kt,Xt,qt;function $t(t,n){for(;0!==n;){var e=t%n;t=n,n=e}return t}function tn(t,n,e,i){return 0===n||0===t?0:0!==e&&t<0?!0===i?p(t/Math.abs(n))*Math.abs(n):Ct(t/Math.abs(n))*Math.abs(n):!0===i?Ct(t/Math.abs(n))*Math.abs(n):p(t/Math.abs(n))*Math.abs(n)}function nn(e,t,n){var i,r,o,a,u,s,c,f,l,h,d,v,m,g,p,b;function y(t){return t.getRowCount?t.getRowCount()!==e[1].getRowCount()||t.getColumnCount()!==e[1].getColumnCount():t.rowCount!==o||t.colCount!==a}function w(n){var e=n.getSource();return function(t){return{id:e.id,source:e,row:n.getRow(0)+C(t/a),col:n.getColumn(0)+t%a,rowCount:1,colCount:1}}}if(i=e[0],e[1].Zbt=!0,r=D(e[1],1,2,!1,!1,!0),o=r.rowCount,a=r.colCount,u=[],l=(f=i.source&&i.source.Lbt).dynamicReferences,(h=l&&i.Xkt)&&N(e[1])&&!n&&(r.getRef=w(e[1])),v=0,m=t?(s=[],n?function(t){c=r[t],s.push(c)}:function(t){(c=r[t])!==A&&s.push(c)}):function(t){if((c=r[t])!==A){if(x(c))return v=c,!0;v+=c}},g=r.getRef?function(t){return Qn(h,r.getRef(t)),m(t)}:m,p=f.S9t,y(e[2]))return S;if(e.length<=3)d=g;else{for(b=4;b<M(e);b+=2){if(y(e[b]))return S;u.push(p.T9t(e[b],e[b+1],!1)),h&&N(e[b])&&(e[b].getRef=w(e[b]))}d=function(t){for(var n=0;n<u.length;n++)if(e[2*n+4].getRef&&Qn(h,e[2*n+4].getRef(t)),!u[n].A9t(t))return;return g(t)}}return p.I9t(e[2],e[3],d),t?t(s):v}function en(t,n){return n=n<0?C(n):Math.ceil(n),(t&&n%2==0||!t&&n%2!=0)&&(n+=n<0?-1:1),n}function rn(t,n,e){return 0<n&&e<0?T:n<0&&0<e?(e=-e,t?p(n/e)*e:Ct(n/e)*e):t?Ct(n/e)*e:p(n/e)*e}function on(t,n,e){var i,r,o,t,i=m.x9t(s(e)),r=Ct(n=e<0?n/i:n*i),o=p(n);return t&&(t=r,r=o,o=t),n=n<0?r:o,_(n=e<0?n*i:n/i)}function an(t,n,e,i){var r=n?-1:1,o=0,a,u,s;if(M(e)!==M(i))return y;for(s=0;s<M(e);s++)a=e[s],u=i[s],a!==A&&u!==A&&(o+=t?(a-u)*(a-u):a*a+r*u*u);return _(o)}function un(t){return _(s(t))}function sn(t){return t=at(t),isNaN(t)?S:p(t)}function cn(t,n){var e=1,i;if(t<n)return T;for(n=K(t-n,n),i=1;i<=n;i++)e=e*(t-i+1)/i;return _(e)}function fn(t,n){for(var e=1,i,i=1;i<=n;i++)e*=t+i-1;for(i=2;i<=n;i++)e/=i;return _(e)}function ln(t,n){var e,i,r,o,a,u,u;if(!t||255<t.length)return 0;if(0===(e=t.length))return 0;if("-"===t[0])return T;for(i=0;i<e&&" "===t[i];)i++;if(r=0,i===e)return 0;for(a=e-(o=1);i<=a;a--){if((u=0<=(u=t.charCodeAt(a)|" ".charCodeAt(0))-"a".charCodeAt(0)?u-87:u-48)<0||n<=u)return T;r+=u*o,o*=n}return r}function hn(t){return 180*t/$}function dn(t){return en(!0,t)}function vn(t){return en(!1,t)}function mn(t){return bt(t)}function gn(t){for(var n=1,e,e=t;1<e;e-=2)n*=e;return n}function pn(t){return _(q(t))}function bn(t,n){return t-n*C(t/n)}function yn(){return $}function wn(t,n){var t;return 0===t&&n<0?u:0===t&&0===n||(t=I.Functions.MathHelper.N9t(t,n))===Number.POSITIVE_INFINITY||t===Number.NEGATIVE_INFINITY||isNaN(t)?T:t}function Mn(){for(var t,n,e,i,r,o,t=arguments,n=0,e=0;e<M(t);e++){if(o=r=void 0,x(i=t[e]))return i;if(N(i)||k(i)){if((r=D(i,1,!0,!0,!1)).isError)return r[0]}else r=D(i,1,!0,!0,!0);for(o=0;o<M(r);o++)r[o]!==A&&(n+=r[o])}return n}function Cn(){var t,n,e,i,r,o;if(!I.ExcelCompatibleCalcMode)return Mn.apply(null,arguments);for(t=arguments,e=n=0;e<M(t);e++){if(o=r=void 0,x(i=t[e]))return i;if(N(i)||k(i)){if((r=D(i,5,!0,!0,!1,!0)).isError)return r[0]}else r=D(i,1,!0,!0,!1,!0);for(o=0;o<M(r);o++)r[o]!==A&&(n+=r[o])}return n}function Sn(t){return 0===t?0:-1}function Tn(){for(var t,n,e,i,r,o,t=arguments,n=0,e=0;e<M(t);e++)for(r=t[e],i=0;i<M(r);i++){if((o=r[i])===A)return S;if(o<0)return T;n=$t(n,d(o))}return n}function An(){for(var t,n,e,i,r,o,a,t=arguments,n=1,e=[],i=0;i<M(t);i++)for(o=t[i],r=0;r<M(o);r++)if((a=o[r])!==A){if((a=d(a))<0)return T;if(0===a)return 0;e.push(a)}for(r=0;r<M(e);r++)n=n/$t(n,a=e[r])*a;return n}function In(){return yt(arguments,2,6)}function xn(t){return Q(t)}function Nn(t,n){return l((t/n).toString())}function kn(t){for(var n,e,i,n=arguments,e=[],i=1;i<M(n);i++)e[i-1]=n[i];return _n(t,0,e)}function Dn(t){for(var n,e,i,n=arguments,e=[],i=1;i<M(n);i++)e[i-1]=n[i];return _n(t,1,e)}function _n(t,n,e){var i=S;return 0<=V(t,[1,101,2,102,3,103,4,104,5,105,6,106,9,109])?i=yt(e,n,t):0<=V(t,[7,107,8,108,10,110,11,111])&&(i=Mt(e,n,t)),i}function En(t,n,e){for(var i,r,o,i=arguments,r=[],o=3;o<M(i);o++)r[o-3]=i[o];return wt(r,e,n,t)}function jn(t,n){return rn(!0,t,n)}function On(t,n){return rn(!1,t,n)}function Rn(t,n,e){return tn(t,n,e,!0)}function Bn(t,n,e){return tn(t,n,e,!1)}function Ln(t,n,e){var t=""+t.toString(n);return e&&t.length<e?Array.apply(null,{length:e-t.length+1}).join(0)+t:t}function Fn(t,n){return t<0&&0<n||n<0&&0<t?T:p(t/n+.5)*n}function Pn(t,n){return m.Lkt(t,n)}function Gn(t,n){return on(!1,t,n)}function Un(t,n){return on(!0,t,n)}function Hn(t){return _(X(t))}function zn(t,n){return Ct(t/s(n))*s(n)}function Vn(t,n){return p(t/s(n))*s(n)}function Yn(t,n){return 1===n?u:_(m.ckt(t,n))}function Zn(t){return _(m.ckt(t,10))}function Wn(t,n,e,i){var r,o,a,u,s,c,f,l,h,d,c,s,v,m,g,p,b,y,r=t.source&&t.source.Lbt,o=r&&r.dynamicReferences,a=i!==w&&N(i);return i=i!==w?i:n,u=0,s=k(n),c=k(i),(s?1:n.getRangeCount())!==(c?1:i.getRangeCount())?S:((f=i)===n||c||(h=s?n.getRowCount():n.getRowCount(0),d=s?n.getColumnCount():n.getColumnCount(0),h===i.getRowCount(0)&&d===i.getColumnCount(0))||(c=i.getRow(0),s=i.getColumn(0),f=i.create([{row:c,col:s,rowCount:h,colCount:d}]),l=!0),f.Zbt=!0,(v=f.toArray(1,2,!1)).isError?v[0]:(a&&(m=f.getRow(0),g=f.getColumn(0),p=t.Xkt,b=i.getSource(),a=p&&b.getRangeKey,l)&&!o&&a&&Qn(p,{id:b.id,source:b,row:m,col:g,rowCount:h,colCount:d}),(y=r.S9t).I9t(n,e,function(t){var n=v[t];n&&n!==A&&(u+=n),o&&a&&Qn(p,{id:b.id,source:b,row:m+C(t/d),col:g+t%d,rowCount:1,colCount:1})}),_(u)))}function Qn(t,n){var e,e,e=n&&n.source;e&&e.getRangeKey&&(e=e.getRangeKey(e,n),t.qkt||(t.qkt={}),t.qkt[e]=n)}function Jn(){return nn(arguments)}function Kn(){return nn(arguments,function(t){var n=null;return n=0<t.length?Math.max.apply(null,t):n})}function Xn(){return nn(arguments,function(t){var n=null;return n=0<t.length?Math.min.apply(null,t):n})}function qn(){for(var t,n,e,i,t=arguments,n=M(t),e=[t[0],t[1]],i=1;i<n;i++)e[i+1]=t[i];return nn(e,function(t){return t.length},!0)}function $n(t){return nn(arguments,function(t){for(var n,e,i,r,n=0,e=0,i=0;i<t.length;i++){if(r=t[i],x(r))return r;n+=r,e++}return 0===e?u:_(n/e)})}function te(t){for(var n,e,i,n=[],e=0,i=[];e<t;e++)i[e]=0;for(e=0;e<t;e++)n[e]=i.slice(0),n[e][e]=1;return new I.CalcArray(n)}function ne(){for(var t,n,e,i,r,o,a,u,s,c,f,t=arguments,n=0,i=[],f=0,e=0;e<M(t);e++){if((a=D(t[e],1,!0,!0,!1,!0)).isError)return a[0];if(a.isConvertError)return S;if(0===e)r=a.rowCount,o=a.colCount,f=M(a);else if(a.rowCount!==r||a.colCount!==o)return S;i.push(a)}for(e=0;e<f;e++){for(u=1,s=0;s<M(t);s++){if((c=i[s][e])===A){if(1===f)return S;u=0;break}u*=c}n+=u}return _(n)}function ee(){for(var t,n,e,i,r,o,t=arguments,o=0,e=0;e<M(t);e++)for(r=t[e],i=0;i<M(r);i++)(n=r[i])!==A&&(o+=n*n);return _(o)}function ie(t,n){return an(!1,!0,t,n)}function re(t,n){return an(!1,!1,t,n)}function oe(t,n){return an(!0,!1,t,n)}function ae(t,n,e,i){for(var r,o,a=0,r=0;r<M(i);r++){if(o=at(i[r]),Y(o))return S;a+=o*nt(t,n+r*e)}return _(a)}function ue(t){return _(Q(t*$))}function se(t){return $*t/180}function ce(t){return _(Math.sin(t))}function fe(t){var t=ce(t);return 0===t?u:1/t}function le(t){return _(Math.cos(t))}function he(t){var t=le(t);return 0===t?u:1/t}function de(t){return _(Math.tan(t))}function ve(t){return 0===t?u:_(1/Math.tan(t))}function me(t){return _(Math.asin(t))}function ge(t){return _(Math.acos(t))}function pe(t){return _(m.vkt(t,!0))}function be(t){var t;return 709<t||t<-709?0:0===(t=pe(t))?u:1/t}function ye(t){return _(m.vkt(t,!1))}function we(t){var t;return 709<t||t<-709?0:0===(t=ye(t))?u:1/t}function Me(t){return _(q(t+Q(t*t+1)))}function Ce(t){return _(q(t+Q(t*t-1)))}function Se(t){return _(Math.atan(t))}function Te(t){return _(t<0?Math.PI+Math.atan(1/t):Math.atan(1/t))}function Ae(t,n){return 0===t&&0===n?u:_(Math.atan2(n,t))}function Ie(t){var n=X(t),t=X(-t);return _(n-t)/(n+t)}function xe(t){var n;return 0===t?u:10<t?1:t<-10?-1:1/Ie(t)}function Ne(t){return _(q((1+t)/(1-t))/2)}function ke(t){return Ne(1/t)}function De(t){var n=t.rowCount,e=1,i,r,o,a,u,s,c,f;if(1<t.rangeCount||n!==t.colCount)return S;for(i=0;i<n-1;i++){if(0===t[i][i]){for(s=!1,r=i+1;!s&&r<n;r++)if(0!==t[r][i]){for(a=i;a<n;a++)c=t[i][a],t[i][a]=t[r][a],t[r][a]=c;e*=-1,s=!0}if(!s)return 0}for(o=i+1;o<n;o++)if(0!==t[o][i])for(f=t[o][i]/t[i][i],u=i;u<n;u++)t[o][u]-=f*t[i][u]}for(i=0;i<n;i++)e*=t[i][i];return e}function _e(t){var n=t.rowCount,e=[],i,r,o,a,u,s,c,f,l,h,d,v,m,g,p,b;if(1<t.rangeCount||n!==t.colCount)return S;for(i=0;i<n;i++)for(e[i]=[n],a=0;a<n;a++)e[i][a]=i===a?1:0;for(r=0;r<n;r++){if(0===t[r][r]){for(b=!1,u=r+1;!b&&u<n;u++)if(0!==t[u][r]){for(c=r;c<n;c++)g=t[r][c],t[r][c]=t[u][c],t[u][c]=g;for(f=1;f<n;f++)p=e[r][f],e[r][f]=e[u][f],e[u][f]=p;b=!0}if(!b)return T}for(s=0;s<n;s++)if(s!==r&&0!==t[s][r]){for(v=t[s][r]/t[r][r],l=r;l<n;l++)t[s][l]-=v*t[r][l];for(h=0;h<n;h++)e[s][h]-=v*e[r][h]}}for(o=0;o<n;o++)for(m=t[o][o],d=0;d<n;d++)e[o][d]/=m;return new I.CalcArray(e)}function Ee(t,n){var e,i,r,o,a,u,s,c,f,l,h,e=t.rowCount,i=t.colCount,r=n.rowCount,o=n.colCount,a=[];if(i!==r)return S;for(c=0;c<e;c++)for(a[c]=u=[],s=t[c],f=0;f<o;f++){for(l=h=0;l<r;l++)h+=s[l]*n[l][f];u[f]=h}return new I.CalcArray(a)}function je(){for(var t,n,e,i,r,o,a,t=arguments,n=0,e=1,r=0;r<M(t);r++)for(i=t[r],o=0;o<M(i);o++){if((a=d(i[o]))<0||170<a)return T;n+=a,e*=bt(a)}return n<0||170<n?T:bt(n)/e}function Oe(){return s(2*tt()-1)}function Re(t,n){return n<t?T:d(t+tt()*(n-t+1))}function Be(t,n){var e,i,r,o,a,u,s,c,f,l,h,d,e=["M","D","C","L","X","V","I"],i=[1e3,500,100,50,10,5,1],o=7,a=[],r=ft(n)?n?0:4:n;if(4<r||r<0)return S;for(u=0;u<7;u+=2){if(2<=u&&i[u-2]-i[u]<=t){for(c=(s=u)-2,f=void 0,f=0;f<r&&s+1<7&&i[c]-i[s+1]<=t;f++)s++;a.push(e[s]),a.push(e[c]),t=t+i[s]-i[c]}if(1<=u&&i[u-1]<=t&&(a.push(e[u-1]),t-=i[u-1]),1<=u&&i[u-1]-i[u]<=t){for(h=(l=u)-1,d=void 0,d=0;d<r&&l+1<7&&i[h]-i[l+1]<=t;d++)l++;a.push(e[l]),a.push(e[h]),t=t+i[l]-i[h]}for(;i[u]<=t;)a.push(e[u]),t-=i[u]}return a.join("")}function Le(t){var n,e,i,r,o,a,u,s,c,f;if(!t.length)return 0;if(255<t.length)return S;for(e=(t=t.toLowerCase()).length-1,r=n=0,u=-1;0<=e&&" "===t[e];)e--;for(s=0;s<=e&&" "===t[s];)s++;c=!1,s<=e&&"-"===t[s]&&(c=!0,s++);do{for(f=t[i=e],--e;s<=e&&(t[e].charCodeAt(0)|" ".charCodeAt(0))===f.charCodeAt(0);)--e;switch(f){case"i":o=i-e,a=1;break;case"v":o=5*(i-e),a=5;break;case"x":o=10*(i-e),a=10;break;case"l":o=50*(i-e),a=50;break;case"c":o=100*(i-e),a=100;break;case"d":o=500*(i-e),a=500;break;case"m":o=1e3*(i-e),a=1e3;break;default:return S}}while(u<=a?(n+=o-r,u=a,r=0):r+=o,s<=e);return 0!==r&&(n-=r),n=c?-n:n}function Fe(t,n,e,i){var r,e,o,a,u,s,c;if(void 0===n&&(n=1),void 0===i&&(i=1),0===(t=void 0===t?1:t)||0===n)return g;if(t<0||n<0)return S;if("string"==typeof(r=e=void 0===e?1:e)||e instanceof Date){if(!I.Convert.sJ(e,e={}))return S;r=e.value}for(o=[],a=0,u=r;a<t;a++)for(o.push(s=[]),c=0;c<n;c++)s.push(u),u+=i;return new I.CalcArray(o)}function Pe(t,n,e,i,r){var o,a,u,s,c,f;if(void 0===n&&(n=1),0===(t=void 0===t?1:t)||0===n)return g;if(t<0||n<0)return S;if((i=void 0===i?1:i)<(e=void 0===e?0:e))return S;if((r=void 0===r?!1:r)&&(e!==C(e)||i!==C(i)))return S;for(o=i-e,r&&o++,a=[],u=0;u<t;u++)for(a.push(s=[]),c=0;c<n;c++)f=e+tt()*o,r&&(f=l(f)),s.push(f);return new I.CalcArray(a)}function Ge(t,n){for(var e,i,r,o,a,o=!0,e=0;e<M(n);e++)for(r=n[e],i=0;i<M(r);i++){if(I.ExcelCompatibleCalcMode){if("string"==typeof r[i]||b(r[i]))continue;o=!1}if(a={value:h},r[i]=St(r[i],a)?a.value:A,t){if(!r[i])return!1}else if(r[i]&&r[i]!==A)return!0}return I.ExcelCompatibleCalcMode&&o?S:!!t}function Ue(){return Ge(!0,arguments)}function He(){return Ge(!1,arguments)}function ze(t){var t,n;return(!I.ExcelCompatibleCalcMode||"string"!=typeof t)&&(n=I.Convert.YK(t,t={}))?!t.value:S}function Ve(t,n,e){var i,n,r,t,e,i,n=n,r=ct(t);return!x(t)&&(t=e!==w?e:2!==M(arguments)&&null,ot(r.value,e={}),e.value)?n:t}function Ye(t,n){return x(t)?b(n)?0:n:t}function Ze(t,n){var e,i,r,r;if(!x(t)&&N(t)){if(1<t.getRangeCount())return S;if(i=e=0,r=this.k9t)if(e=r.row,i=r.col,(r=t.$gt&&t.$gt[0])&&1===r.rowCount&&1===r.colCount)i=e=0;else if(r&&(e+1>r.rowCount||i+1>r.colCount))return n;t=t.getValue(0,e,i)}return Ye(t,n)}function We(){return!0}function Qe(){return!1}function Je(t,n){return At(t)?n:t}function Ke(){for(var t,n,e,t=0,n=arguments.length;t<n;t+=2){if(e={value:!1},x(arguments[t]))return arguments[t];if(!ot(arguments[t],e))return S;if(e.value)return arguments[t+1]}return y}function Xe(){var t,n,e,i,r,t=arguments;if(t.length<3)return S;if(x(n=t[0]))return n;for(n===h&&(n=0),i=t.length-(e=1);e<i;e++){if(r=t[e],e++,x(r))return r;if(r===h&&(r=0),v(n)&&v(r)){if(n.toUpperCase()===r.toUpperCase())return t[e]}else if(n===r)return t[e]}return t.length%2==0?t[t.length-1]:y}function qe(){for(var t,n,e,i=0,t=0;t<M(arguments);t++)for(e=arguments[t],n=0;n<M(e);n++)e[n]&&i++;return!!(i%2)}function $e(t,n,e){var i,r,o,a,u,i=t.source&&t.source.Lbt&&t.source.Lbt.MX;if(!i)return g;r=t.localScopes;try{if(t.lambdaFunctionCallDepth++,r.enterScope(),r.saveThenSwitchClosure(n.closure),(a=n.parameters).length!==e.length)return S;for(u=0;u<a.length;u++)t.localScopes.setVariable(a[u].value,e[u]);o=i.evaluate(n.calculation,t,!1,!1)}finally{t.lambdaFunctionCallDepth--,r.exitScope(),r.restoreClosure()}return o}function ti(t){return!k(t)||1===t.getColumnCount()&&1===t.getRowCount()}function ni(t){return k(t)?t.getValue(0,0):t}function ei(t,n,e){return t[n*t.colCount+e]}function ii(){var t,n,e,i,r,o,a,u,s,c,f,l,h,d,v,m,t=arguments,n=M(t),e=t[0],i=t[n-1];if(!(0,I.isLambdaFunction)(i))return S;for(r=[],a=o=0,u=1;u<n-1;u++){if(s=so(t[u],0),x(s))return s;o=Math.max(o,s.rowCount),a=Math.max(a,s.colCount),r.push(s)}if(i.parameters.length!==r.length)return S;for(c=[],f=0;f<o;f++){for(l=[],h=0;h<a;h++){for(v=!(d=[]),u=0;u<r.length;u++){if(!(f<r[u].rowCount&&h<r[u].colCount)){v=!0;break}d.push(ei(r[u],f,h))}if(v)l.push(y);else{if((m=$e(e,i,d))&&m.pause)return m;if(!ti(m))return g;m=ni(m),l.push(m)}}c.push(l)}return new I.CalcArray(c)}function ri(t,n,e,i){var r,o,a,u,s,c;if(e=so(e,0,!1),x(e))return e;if(!(0,I.isLambdaFunction)(i)||2!==i.parameters.length)return S;for(r=e.rowCount,o=e.colCount,a=n,u=0;u<r;u++)for(s=0;s<o;s++)if(c=ei(e,u,s),(a=n===h&&0===u&&0===s?c:$e(t,i,[a,c]))&&a.pause)return a;return a}function oi(t,n,e,i){var r,o,a,u,s,c,f,l;if(e=so(e,0,!1),x(e))return e;if(!(0,I.isLambdaFunction)(i)||2!==i.parameters.length)return S;for(r=e.rowCount,o=e.colCount,a=[],u=n,s=0;s<r;s++){for(c=[],f=0;f<o;f++){if(l=ei(e,s,f),(u=n===h&&0===s&&0===f?l:$e(t,i,[u,l]))&&u.pause)return u;if(!ti(u))return g;u=ni(u),c.push(u)}a.push(c)}return new I.CalcArray(a)}function ai(t,n,e,i){var r,o,a,u,s;if(!(0,I.isLambdaFunction)(i)||2!==i.parameters.length)return S;if(n<=0||e<=0)return S;for(r=[],o=0;o<n;o++){for(a=[],u=0;u<e;u++){if((s=$e(t,i,[o+1,u+1]))&&s.pause)return s;if(!ti(s))return g;s=ni(s),a.push(s)}r.push(a)}return new I.CalcArray(r)}function ui(t,n,e){var i,r,o,a,u,s,c;if(!(0,I.isLambdaFunction)(e)||1!==e.parameters.length)return 2===arguments.length?y:S;if(n=so(n,0,!1),x(n))return n;for(i=n.rowCount,r=n.colCount,o=[],a=0;a<i;a++){for(u=[],s=0;s<r;s++)u.push(ei(n,a,s));if((c=$e(t,e,[new I.CalcArray([u])]))&&c.pause)return c;if(!ti(c))return g;c=ni(c),o.push([c])}return new I.CalcArray(o)}function si(t,n,e){var i,r,o,a,u,s,c;if(!(0,I.isLambdaFunction)(e)||1!==e.parameters.length)return 2===arguments.length?y:S;if(n=so(n,0,!1),x(n))return n;for(i=n.rowCount,r=n.colCount,o=[],a=0;a<r;a++){for(u=[],s=0;s<i;s++)u.push(ei(n,s,a));if((c=$e(t,e,[new I.CalcArray([u])]))&&c.pause)return c;if(!ti(c))return g;c=ni(c),o.push(c)}return new I.CalcArray([o])}function ci(t){for(var n,e,i,r,o,n=t.getFullYear(),e=t.getMonth(),i,r=t.getDate(),o=0;o<e;o++)r+=pt(n,o);return r}function fi(t){if(v(t)){if(7!==M(t)||Y(l(t)))return S}else if(!Y(t)){if(C(t)<1||17<C(t))return T;t=t.toString()}var n=["1","2","3","4","5","6","7"],e=[0,0,0,0,0,0,0],i;switch(M(t)){case 1:if(0<=V(t,n)){e[((i=l(t))+4)%7]=1,e[(i+5)%7]=1;break}return T;case 2:if("1"===t[0]&&0<=V(t[1],n)){e[((i=l(t[1]))+5)%7]=1;break}return T;case 7:for(i=0;i<7;i++)e[i]=l(t[i]);break;default:return S}return e}function li(t,n,e,i,r){var o,a,o=R(n,3);if(x(o))return o;for(a=d(o);e<0;++e)n.setDate(n.getDate()-1),a=0===a?6:a-1,(t&&(5===a||6===a)||!t&&r[a]||0<=i.indexOf(f(n)))&&e--;for(;0<e;--e)n.setDate(n.getDate()+1),a=6===a?0:a+1,(t&&(5===a||6===a)||!t&&r[a]||0<=i.indexOf(f(n)))&&e++;return f(n)}function hi(t,n,e,i,r,o){var a,u,s,c,f,l,h,d,h;if(o&&(u=fi(t=t!==w?t:"0000011"),x(u)))return u;if(a=n!==w?D(n,4,!0,!0,!1):a){if(a.isError)return a[0];for(s=M(a),c=[],f=0;f<s;f++)l=a[f],d=(h=U(l)).getDay(),h=M(u)?u[R(h,3)]:6===d||0===d,-1===c.indexOf(l)&&!h&&e<=l&&l<=i&&c.push(l);r-=M(c)}return r}function di(t,n,e,i,r,o){var a,u,s,c,c,c,a=d(f(n)),u=d(f(e)),s=!1;if(u<a&&(c=n,n=e,e=c,c=a,a=u,u=c,s=!0),c=o(n,e,c=u-a+1,i),!t||!x(c)){if(c<=0)return 0;c=hi(i,r,a,u,c,t),c=s?-c:c}return c}function vi(t,n,e){var i,e;return n=I.Convert.r0(n),(i=new Date(n.getFullYear(),n.getMonth(),1)).setMonth(i.getMonth()+e),e=pt(i.getFullYear(),i.getMonth()),i.setDate(t?e:K(n.getDate(),e)),i}function mi(t,n,e){t<=1899&&(t+=1900);var t=new Date(t,n-1,e);return t<new Date(1899,11,30)?T:t}function gi(t,n,e){var i=U(0);return i.setHours(t),i.setMinutes(n),i.setSeconds(e),i.setMilliseconds(0),i.getHours()<0&&i.getMinutes()<0&&i.getSeconds()<0?T:i}function pi(t){var n,e,i,r;if(!(n=!v(t)||(n=H(t))||(n=new Date(t))&&!Y(n.valueOf())?n:null))return S;if(i=n.getFullYear(),r=ci(n),i<1900)return S;for(e=1900;e<i;e++)r+=365,dt(e)&&r++;return r}function bi(t){var n;return(n=v(t)?H(t):n)?(60*(60*n.getHours()+n.getMinutes())+n.getSeconds())/86400:S}function yi(){return new Date}function wi(){var t=new Date;return t.setHours(0,0,0,0),t}function O(t){if(I.ExcelCompatibleCalcMode){var n=t.getMilliseconds();if(500<n)return new Date(t.getTime()+1e3-n)}return t}function Mi(t){return(t=O(t)).getHours()}function Ci(t){return(t=O(t)).getMinutes()}function Si(t){return(t=O(t)).getSeconds()}function Ti(t){return(t=O(t)).getDate()}function Ai(t){return(t=O(t)).getMonth()+1}function Ii(t){return(t=O(t)).getFullYear()}function xi(t,n){var e,i,e;return t=O(t),1===n||17===n||b(n)||2===n||11===n||12===n||13===n||14===n||15===n||16===n?(e=ci(t),i=new Date(t.getFullYear(),0,1).getDay(),2===n?--i:11===n||12===n||13===n||14===n||15===n?i=i-n+10:16===n&&(i+=1),(e=e-1-(6-(i=i<0?7+i:i)))<0&&(e=0),7===i&&16===n?d(e/7)+(e%7!=0?1:0):1+d(e/7)+(e%7!=0?1:0)):21===n?Li(t):T}function R(t,n){var e=(t=O(t)).getDay();switch(n){case 1:return e+1;case 2:return 0===e?7:e;case 3:return 0===e?6:e-1;default:return T}}function Ni(t,n){return vi(!1,t,n)}function ki(t,n){return vi(!0,t,n)}function Di(t,n,e){return li(!0,t,n,e)}function _i(t,n,e,i){var e=fi(e=b(e)&&0===n?1:e);return x(e)?e:"1111111"===e.join("")?S:li(!1,t,n,i,e)}function Ei(t,n,e){function i(t,n,e){var n,i,t,n=d(f(n)-f(t))%7,i=d(R(t,2)+n),t=0===t.getDay()?1:2;return e=(e-=n=t<(n=5<i?i-5:0)?t:n)-2*C(e/7)}return di(!1,t,n,w,e,i)}function ji(t,n,e,i){var r,o,a,u,s,c,f,r=fi(i=i!==w?i:"0000011"),a=o=0;if(x(r))return r;for(u=0;u<M(r);u++)1===r[u]&&o++;if(e<30){for(u=0;u<e;u++)r[(d(R(t,3))+u)%7]&&a++;return e-=a}for(s=e,u=f=c=0;u<s&&d(R(t,3)+u)%7!=0;u++)c++;for(u=0;u<c;u++)r[(d(R(t,3))+u)%7]&&a++;for(u=0;u<s&&(d(R(n,3))+7-u)%7!=6;u++)f++;for(u=0;u<f;u++)r[(d(R(n,3))+7-u)%7]&&a++;return e=e-d((s=s-c-f)/7)*o-a}function Oi(t,n,e,i){return di(!0,t,n,e,i,ji)}function Ri(t,n,e){var i,e,r;function o(){var t=[];return t[0]=function(t,n){return n.getFullYear()-t.getFullYear()+(n.getMonth()<t.getMonth()||n.getMonth()===t.getMonth()&&n.getDate()<t.getDate()?-1:0)},t[1]=function(t,n){return 12*(n.getFullYear()-t.getFullYear())+(n.getMonth()-t.getMonth())+(n.getDate()<t.getDate()?-1:0)},t[2]=function(t,n){return(n.getTime()-t.getTime())/864e5},t[3]=function(t,n){var t=new Date(n.getFullYear(),n.getMonth()+(n.getDate()<t.getDate()?-1:0),t.getDate());return(n.getTime()-t.getTime())/864e5},t[4]=function(t,n){return n.getMonth()-t.getMonth()+(n.getMonth()<t.getMonth()||n.getMonth()===t.getMonth()&&n.getDate()<t.getDate()?12:0)+(n.getDate()<t.getDate()?-1:0)},t[5]=function(t,n){var e,i,r,t,o,e=n.getFullYear()+(n.getMonth()<t.getMonth()||n.getMonth()===t.getMonth()&&n.getDate()<t.getDate()?-1:0),i=t.getMonth(),r=t.getDate(),t=dt(t.getFullYear());return 1!==i||29!==r||dt(e)||r--,!t&&1===i&&28===r&&dt(e)&&r++,(n-(o=new Date(e,i,r)))/864e5},t}if(t.setHours(0,0,0,0),n.setHours(0,0,0,0),I.ExcelCompatibleCalcMode&&(t<jt||Ot<n))return T;if(e=e.toLocaleUpperCase(),i=o(),e=V(e,["Y","M","D","MD","YM","YD"]),n<t)return T;if(e<0)throw(0,I.sR)().Exp_NotSupported;return(r=i[e])(t,n)}function Bi(t,n){var e,t,i,e={value:0};return St(t,e)&&St(n,t={value:0})?(i=2958465,r(e.value)&&r(t.value)?e.value-t.value:T):S;function r(t){return 0<=t&&t<1+i}}function Li(t){var n,n,e;return isNaN(t)?T:(n=new Date(1900,1,28),t.getTime()<=n.getTime()&&t.setDate(t.getDate()-1),1900===(n=t.getFullYear())?n+=400:9999===n&&(n-=400),t.setYear(n),t.getTime()<new Date(n,11,29).getTime()&&n--,e=i(n+1),t.getTime()<e.getTime()&&(e=i(n)),l(((t.getTime()-e.getTime())/864e5/7).toString())+1);function i(t){var t,n,t=new Date(t,0,4),n=t.getDay();return 0===n&&(n=7),t.setDate(t.getDate()+1-n),t}}function Fi(t){var n,e,i,r,t,o,n=t.toString(),e="",r=[];if(t<0&&(n=n.substr(1),e="-"),t=n.split("."),(o=M(t))<1||2<o)return S;for(2===o&&(r.push(t[1]),r.push(".")),n=t[0],i=M(n)-3;0<=i;i-=3)r.push(n.substr(i,3)),0<i&&r.push(",");return r.push(n.substring(0,i+3)),r.reverse(),e+r.join("")}function Pi(t,n){for(var e,i,r,o,a,u,e=[],o=M(t),i=0;i<o;i++){if(a=t[i],0===(u=M(a))&&"concat"===n)return et;for(r=0;r<u;r++)b(a[r])||e.push(ut(a[r]))}return e.join("")}function Gi(t,n,e){for(var i,r,o,a,i=[],r=0,o=0;o<n.length;o++)"fourByte"===(a=vt(n[o]))?0===r?r++:(r=0,i.push(n[o-1]+n[o])):i.push(n[o]);return i.length<=e?n:i.splice(t?0:i.length-e,e).join("")}function Ui(t){for(var n=[],e,i,e=0;e<M(t);e++)0<=(i=t.charCodeAt(e))&&i<=31||127===i||128<=i&&i<=159||n.push(t[e]);return n.join("")}function Hi(t){var n,e,i,r,o;for(t=t.trim(),n=[],e=!0,i=0;i<M(t);i++)(o=" "===(r=t.charAt(i))||"\t"===r||"\n"===r)&&!e||n.push(r),e=!o;return n.join("")}function zi(t,n){function e(t){var n=Fi(t),e=[];return t<0&&(n=n.substr(1)),e.push("$"),e.push(n),t<0&&(e.push(")"),e.unshift("(")),e.join("")}return e(t=at(Pn(t,n)))}function Vi(t,n,e){var i,r,i,o,a,u,i=0;if(n<0&&(t/=i=d(nt(10,s(n)))),t=at(Pn(t,J(0,n))),n<0&&(t*=i),r=e?t.toString():Fi(t),0<n)if(-1===(i=r.indexOf(".")))for(r+=".",o=0;o<n;o++)r+="0";else for(u=a=r.length-(i+1);u<n;u++)r+="0";return r}function Yi(t,n){var e,i;if(""===n)return ut(t);"string"==typeof(t=b(t)?0:t)&&(t=t.trim());try{return(e=c.Formatter&&c.Formatter.GeneralFormatter)?(i=new e(n)).format(t):t.toString()}catch(t){return S}}function Zi(t){var n,t;return t?"boolean"==typeof t?S:"string"!=typeof(t=t instanceof Date?a.o0(t).toString():t)?t:(n=H(t),b(n)?Wi(t):(t=f(n),x(t)?bi(n):t)):0}function Wi(t){var n,e,i,r,o,a,u,s,n=c.Common.CultureManager.Fe().NumberFormat;if("$"!==(t=t.trim())[0]&&t[0]!==n.currencySymbol||(t=t.substring(1)),e=Z(t),Y(e))return S;for(i=(t="."===(t="-"===t[0]&&"."===t[1]?t.replace(t[1],"0."):t)[0]?"0"+t:t).length,u=a=r=0,s=[];r<i;r++){for(o=t[r];r<i&&(0,I.isDigit)(o.charCodeAt(0));)s.push(o),o=t[++r];if(r===i){if(a&&r-a<=3)return S;break}if(o===n.numberGroupSeparator){if(u||a&&r-a<=3)return S;a=r}else if(o===n.numberDecimalSeparator){if(u||a&&r-a<=3)return S;s.push("."),u=r}else s.push(o)}return at(s.join(""))}function Qi(t){return t.toLowerCase()}function Ji(t){return t.toUpperCase()}function Ki(t){var n,e,i,r,o,n=M(t),e=[];if(0<n)for(i=t.toUpperCase(),r=t.toLowerCase(),o=1,e[0]=i[0];o<n;)e[o]=((0,I.Swt)(t[o-1])?r:i)[o],o++;return e.join("")}function Xi(t){return String.fromCharCode(t)}function qi(t){return t[0].charCodeAt(0)}function $i(t,n,e,i){var r,r,t,r=M(t);return n=K(n,r+1),e=K(e||0,r-n+1),r=t.substring(0,n-1),t=t.substr(n-1+e),r.concat(i).concat(t)}function tr(t,n,e,i){var r,o,a,u,s,c,c,f;if(gr()||I.usedbcs){for(r=[],o=void 0,u=a=0;u<t.length;u++)o=t[u],"doubleByte"===(s=vt(t[u]))&&(a++,o=t[u]),r[u+a]=o;return n=K(n,(c=r.length)+1),e=K(e||0,c-n+1),b(r[n-1])?(r[n-1]=" ",r[n]=" "):b(r[n-2])&&2<=n&&(r[n-2]=" ",r[n-1]=" "),c=r.slice(0,n-1).join(""),f=r.slice(n-1+e).join(""),c.concat(i).concat(f)}return $i(t,n,e,i)}function nr(t,n,e,i){var r,o,a,u,s,i,r,o=M(n);if(3<M(arguments)){if(s=void(u=0),(a=d(i))<1)return S;for(s=0;s<a;s++){if(-1===(u=t.indexOf(n,u)))return t;u+=o}i=t.substring(0,u-o),r=t.substr(u),r=i.concat(e).concat(r)}else r=F.qS(t,n,e);return r}function er(){return Pi(arguments,"concatenate")}function ir(){return Pi(arguments,"concat")}function rr(t,n){var t,e,i,r,n,o,a;if(t.isReference&&0===t.length)return et;if(t={value:!1},e=!!b(n[0])||n[0],!Tt(e,t))return S;for(e=t.value,r=[],n=[],o=M(i=arguments),a=2;a<o;a++)or(r,i[a],e);return or(n,i[0],!1),ar(r,n)}function or(t,n,e){var i,r,i=M(n);if(0!==i)for(r=0;r<i;r++)b(n[r])||""===n[r]?e||t.push(""):t.push(ut(n[r]))}function ar(t,n){if(0===t.length)return"";if(1===n.length)return t.join(n[0]);for(var e=t[0],i=1,r=0;i<t.length;i++,r++)e+=n[r=r===n.length?0:r]+t[i];return e}function ur(t,n){return Gi(!0,t,n)}function sr(t,n){return Gi(!1,t,n)}function cr(t,n,e){var i,r,o,a,u,s,c,f,l;if(gr()||I.usedbcs){for(i=[],r=void 0,a=void(o=0),a=u=0;a<n.length;a++)r=n[a],"fourByte"===(s=vt(n[a]))?o%2==0?o++:(o++,r=n[a-1]+n[a],i[i.length]=r):("doubleByte"===s&&(u++,r=n[a]),i[a-(c=0<o?o/2:0)+u]=r);return(f=(i=t?i:gt(i)).length)<=e?n:(l=void 0,t?0<(l=i.slice(0,e-1<0?0:e)).length&&b(l[l.length-1])&&(l[l.length-1]="\u200b"):0<(l=i.slice(f-e)).length&&b(l[0])&&(l[0]="\u200b"),l.join(""))}return Gi(t,n,e)}function fr(t,n){return cr(!0,t,n)}function lr(t,n){return cr(!1,t,n)}function hr(t,n,e){n--;var i=M(t);return i<=n?"":i<n+e?t.substr(n):t.substr(n,e)}function dr(t,n,e){var i,r,r;return gr()||I.usedbcs?(r=(i=mt(t)).length,--n<0?S:r<=n?"":(r<n+e?i.slice(n):(r=i.slice(n,n+e),"singleByte"!==vt(r[r.length-1])&&(r[r.length-1]="\u200b",b(r[0]))&&(r[r.length]="\u200b"),r)).join("")):hr(t,n,e)}function vr(t,n){var e=[],i;if(n<0||32767<n*M(t))return S;for(i=0;i<n;i++)e.push(t);return e.join("")}function mr(t){return t?t.length:0}function gr(){var t;return!!c.Common.CultureManager.Fe().isJCKCulture}function pr(t){var n,e,i,r;if(!t)return 0;if(gr()||I.usedbcs){for(e=n=0;e<t.length;e++)8203!==t[e].charCodeAt(0)&&(i=vt(t[e]),r=c.Common.CultureManager.Fe(),"doubleByte"===i)&&9390!==t[e].charCodeAt(0)&&("ja-jp"!==(r&&r.name().toLocaleLowerCase())||711!==t[e].charCodeAt(0)&&9356!==t[e].charCodeAt(0)&&8212!==t[e].charCodeAt(0))&&n++;return t.length+n}return t.length}function br(t,n,e){var n;return e<1||M(n)<e||-1===(n=n.indexOf(t,e-1))?S:n+1}function yr(t,n,e){var i,r,o,o,i,r;return gr()||I.usedbcs?(i=mt(n),r=mt(t),o=i.length,e<1||o<e||(o=Mr(i),i=Mr(r),-1===(r=o.indexOf(i,e-1)))?S:r+1):br(t,n,e)}function wr(t,n,e){var i=-1,r,r,r=o.jJ(t),i;return-1===(i=r?(r=o.OJ(r).exec(n),b(r)?-1:r.index):n.toLowerCase().indexOf(t.toLowerCase(),e-1))?S:i+1}function Mr(t){for(var n=0;n<t.length;n++)b(t[n])&&t[n-1]&&2!==t[n-1].length&&(t[n]="\u200b");return t.join("")}function Cr(t){for(var n=0;n<t.length;n++)b(t[n])&&(t[n]="\u200b")}function Sr(t,n,e){var i,r,o,o;return gr()||I.usedbcs?(i=mt(n),r=mt(t),o=i.length,e<1||o<e||(o=wr(Mr(r),Mr(i),e))===S?S:o):wr(t,n,e)}function Tr(t,n){return t===n}function Ar(t){return v(t)?t:""}function Ir(t){var t;return!t||(t=t)<=0||1114111<t?S:55296<=t&&t<=57343?y:t<1048576?String.fromCharCode(t):(t-=1048576,String.fromCharCode(55296+(t>>10),56320+(1023&t)))}function xr(t){var t,n,t,t=ut(t);return""===t||null===t?S:55296<=(n=t.charCodeAt(0))&&n<=56319?1===t.length?S:56320<=(t=t.charCodeAt(1))&&t<=57343?n|t<<8:1:56320<=n&&n<=57343?n-53248+53248:n}function Nr(t){var n,e;function i(t){for(var n,e,i,r,o,a,u,s,c,f,n=["\u0e25\u0e49\u0e32\u0e19","\u0e2a\u0e34\u0e1a","\u0e23\u0e49\u0e2d\u0e22","\u0e1e\u0e31\u0e19","\u0e2b\u0e21\u0e37\u0e48\u0e19","\u0e41\u0e2a\u0e19",""],e=["\u0e28\u0e39\u0e19\u0e22\u0e4c","\u0e2b\u0e19\u0e36\u0e48\u0e07","\u0e2a\u0e2d\u0e07","\u0e2a\u0e32\u0e21","\u0e2a\u0e35\u0e48","\u0e2b\u0e49\u0e32","\u0e2b\u0e01","\u0e40\u0e08\u0e47\u0e14","\u0e41\u0e1b\u0e14","\u0e40\u0e01\u0e49\u0e32"],i=["\u0e25\u0e1a","\u0e1a\u0e32\u0e17","\u0e16\u0e49\u0e27\u0e19","\u0e2a\u0e15\u0e32\u0e07\u0e04\u0e4c","\u0e22\u0e35\u0e48","\u0e40\u0e2d\u0e47\u0e14",","," ","\u0e3f"],r="",o=t+"",a=o.length,u=a;0<u;--u){if(c=e[s=l(o[a-u])],1==(f=1<u?(u-1)%6:6)&&2===s&&(c=i[4]),1===s)switch(f){case 0:case 6:r+=u<a?i[5]:c;break;case 1:break;default:r+=c}else{if(0===s){0==f&&(r+=n[f]);continue}r+=c}r+=n[f]}return r}return t?(n=Math.abs(l(t)),e=parseFloat((Math.abs(t)-n).toFixed(2)),0!==n?0===e?(t<0?"\u0e25\u0e1a":"")+i(n)+"\u0e1a\u0e32\u0e17\u0e16\u0e49\u0e27\u0e19":(t<0?"\u0e25\u0e1a":"")+i(n)+"\u0e1a\u0e32\u0e17"+i(100*e)+"\u0e2a\u0e15\u0e32\u0e07\u0e04\u0e4c":0!==e?(t<0?"\u0e25\u0e1a":"")+i(100*e)+"\u0e2a\u0e15\u0e32\u0e07\u0e04\u0e4c":"\u0e28\u0e39\u0e19\u0e22\u0e4c\u0e1a\u0e32\u0e17\u0e16\u0e49\u0e27\u0e19"):S}function kr(a,u,t,n,e){var i,r,i=function(t,n){for(var e,i,r,o,e=-1,i=-1,r=0;r<u.length;r++)-1===(o=t?a.indexOf(u[r],n):a.lastIndexOf(u[r],n))||-1!==e&&!(t?o<e:e<o)||(e=o,i=r);return{index:e,delimiterIndex:i}};if(1===n&&(a=a.toLocaleLowerCase(),u=u.map(function(t){return t.toLocaleLowerCase()})),0<t){for(r=i(!0),t--;-1!==r.index&&0<t;)r=i(!0,r.index+1),t--;if(1===e&&-1===r.index&&0===t)return{index:a.length,delimiterIndex:-1,isMatchEnd:!0}}else{for(r=i(!1),t++;-1!==r.index&&t<0;)r=i(!1,r.index-1),t++;if(1===e&&-1===r.index&&0===t)return{index:-1,delimiterIndex:-1,isMatchEnd:!0}}return{isMatchEnd:!1,index:r.index,delimiterIndex:r.delimiterIndex}}function Dr(t,n,e,i,r,o){var a,e,i,r,u,a=t.length;return b(n)||0===n.length||n.some(function(t){return t.length>a})?y:n.some(function(t){return 0===t.length})?0<e?t:"":a<e?S:(i=(e=kr(t,n,e,i,r)).index,r=e.delimiterIndex,(u=e.isMatchEnd)?-1===i?t:"":-1!==i?t.substring(i+n[r].length):b(o)?y:o)}function _r(t,n,e,i,r,o){var a,n,e,u,a=t.length;return b(n)||0===n.length||n.some(function(t){return t.length>a})?y:n.some(function(t){return 0===t.length})?0<e?"":t:a<e?S:(e=(n=kr(t,n,e,i,r)).index,(u=n.isMatchEnd)?-1===e?"":t:-1!==e?t.substring(0,e):b(o)?y:o)}function Er(t,n,e){return"function"==typeof t.replaceAll?t.replaceAll(n,e):t.replace(new RegExp(o.D9t(n),"g"),e)}function jr(t,n,e){var i,r,o;if(b(n))return[t];if(i=n[0],1<n.length)for(r=1;r<n.length;r++)t=Er(t,n[r],i);return o=t.split(i),o=e?o.filter(function(t){return 0<t.length}):o}function Or(t,n,e,i,r,o){var a,r,u;return 0===t.length||b(n)&&b(e)||n&&(0===n.length||n.some(function(t){return 0===t.length}))||e&&(0===e.length||e.some(function(t){return 0===t.length}))?S:(1===r&&(t=t.toLowerCase(),e=e&&e.map(function(t){return t.toLowerCase()}),n=n&&n.map(function(t){return t.toLowerCase()})),r=(r=(a=jr(t,e,i)).map(function(t){return jr(t,n,i)})).filter(function(t){return 0<t.length}),u=J.apply(null,r.map(function(t){return t.length})),o=b(o)?y:o,r.forEach(function(t){for(var n=u-t.length;0<n;)t.push(o),n--}),new I.CalcArray(r))}function Rr(t){return x(t)}function Br(t){return!!x(t)&&t._code!==y._code}function Lr(t){return!!x(t)&&t._code===y._code}function Fr(t){if(!b(t)&&x(t)){var t=V(t._code,[et._code,u._code,S._code,it._code,rt._code,T._code,y._code]);if(0<=t)return t+1}return y}function Pr(t){return st(t,I.ExcelCompatibleCalcMode)}function Gr(t){return p(s(t))%2==0}function Ur(t){return p(s(t))%2!=0}function Hr(t){return lt(t)||ht(t)?at(t):ft(t)?t?1:0:x(t)?t:0}function zr(t){return b(t)}function Vr(t){return ft(t)}function Yr(t){return v(t)}function Zr(t){return!v(t)}function Wr(t){return N(t)}function Qr(t){return ft(t)?4:lt(t)||ht(t)?1:v(t)?2:x(t)?16:k(t)?64:(0,I.isLambdaFunction)(t)?128:S}function Jr(){return y}function Kr(t,n){var e,i,r,t,e=0,i=t.source.Mf;if(!k(n)){if(n instanceof I.CalcReference||b(n))return t=n&&(n.rT||n.references[0].rT)||t.source,i.parent.getSheetIndex(t.Mf.name())+1;if(st(n)||v(n))for(;e<i.parent.sheets.length;e++)if(n.toUpperCase()===i.parent.sheets[e].name().toUpperCase())return e+1}return y}function Xr(t,n){var e,i,r,r,e=t.source.Mf;return b(n)?e.parent.sheets.length:k(n)||st(n)?y:v(n)?S:n instanceof I.CalcReference?(r=n.references)?r.length:(r=n.rT||t.source,e.parent.getSheetIndex(r.Mf.name())+1):y}function qr(){var t=new I.Functions.AsyncFunction("REFRESH",1,3);t.evaluate=$r,I.Functions.Mmt.REFRESH=t}function $r(t,n){return n}function to(t){return 55296<=t&&t<=57343}function no(t,n){return!(t<55296||56319<t)&&56320<=n&&n<=57343}function eo(){if("undefined"!=typeof self)return self;if("undefined"!=typeof window)return window;if(void 0!==L.g)return L.g;try{return new Function("return this")}catch(t){}}function io(t){var n,e,i,r,o,a,u,n=eo();if(n&&n.encodeURIComponent)return encodeURIComponent(t).replace(/[!~'()*]/g,function(t){return"%"+t.charCodeAt(0).toString(16).toUpperCase()});if(e="",(i=t.length-1)<0)return"";for(r=0;r<=i;r++)if((o=t.charCodeAt(r))>="A".charCodeAt(0)&&o<="Z".charCodeAt(0)||o>="0".charCodeAt(0)&&o<="9".charCodeAt(0)||o>="a".charCodeAt(0)&&o<="z".charCodeAt(0)||o==="-".charCodeAt(0)||o==="_".charCodeAt(0)||o===".".charCodeAt(0))e+=t[r];else{if(a=void 0,to(o)){if(i===r||!no(o,t.charCodeAt(r+1)))return null;a=[o,t.charCodeAt(r+1)],r++}else a=[o];for(u=0;u<a.length;u++)e=(e+="%")+a[u].toString(16).toUpperCase()}return e}function ro(t){for(var n,e,n=t,e=0;e<n.length;e++)if(!b(n[e])&&"string"!=typeof n[e])return;return 1}function oo(t,n,e){var n,e,t;return ro(arguments)?wo(n)?y:(n=o.bue(n,e))?(e=t.match(n))?1===(t=e.length)?e[0]:1<t?e[0]===e.input?new I.CalcArray([e.slice(1)]):new I.CalcArray([e]):void 0:y:S:S}function ao(t,n,e){var n;return ro(arguments)?wo(n)?y:(n=o.bue(n,e))?n.test(t):S:S}function uo(t,n,e,i){var n;return ro(arguments)?wo(n)||wo(e)?y:(n=o.bue(n,i))?t.replace(n,e):S:S}function so(t,n,e){var i;return void 0===e&&(e=!0),t!==h||e?x(t)?y:k(t)?D(t,n,!0,!0,!1):D(t,n,!0,!0,!0):S}function co(t){for(var n,e,i,r,o,a,t,t,u,s,c,s,n=[],e=1;e<arguments.length;e++)n[e-1]=arguments[e];if(i=n[0],o=[],a=[],t=(t=(r=n[1])&&r.getSource()&&r.getSource().getSheet()||t.source&&t.source.Mf)&&t.pivotTables&&r&&t.pivotTables.findPivotTable(r.getRow(),r.getColumn()),b(t))return it;for(u=2;u<n.length;u+=2)c=n[u+1],s={fieldName:s=N(s=n[u])?s.getValueByIndex(0):s,itemName:c},(N(c)||k(c)?a:o).push(s);return N(i)&&(i=i.getValueByIndex(0)),0<a.length?fo(i,t,o,a):t.evaluateGetPivotDataFunction(i,o)}function fo(t,n,e,i){for(var r,o,a,u,s,c,f,l,h,d,v,d,h,m,g,p,b,y,w,M,C,S,T,A,r=1,o=1,a=[],u=[],s=[],c=0,f=i;c<f.length;c++){if(h=(l=f[c]).fieldName,d=l.itemName,x(d))return d;if((N(d)||k(d))&&(l.itemName=D(d,0,!1,!1,!1),l.itemName.isError))return l.itemName[0];d=(v=n.getField(h)).pivotArea,r=(h=l.itemName.rowCount)<r?r:h,o=(m=l.itemName.colCount)<o?o:m,m<h||h===m&&1===d?a.push(l):(h<m||h===m&&2===d)&&u.push(l)}for(g=0;g<r;g++){for(p=[],b=0;b<o;b++){for(y=[],w=0,M=a;w<M.length;w++)1<(C=M[w]).itemName.colCount?1<C.itemName.rowCount?y.push({fieldName:C.fieldName,itemName:C.itemName[g]&&C.itemName[g][b]}):y.push({fieldName:C.fieldName,itemName:C.itemName[0]&&C.itemName[0][b]}):1<C.itemName.rowCount?y.push({fieldName:C.fieldName,itemName:C.itemName[g]&&C.itemName[g][0]}):y.push({fieldName:C.fieldName,itemName:C.itemName[0]&&C.itemName[0][0]});for(S=0,T=u;S<T.length;S++)1<(A=T[S]).itemName.rowCount?1<A.itemName.colCount?y.push({fieldName:A.fieldName,itemName:A.itemName[g]&&A.itemName[g][b]}):y.push({fieldName:A.fieldName,itemName:A.itemName[g]&&A.itemName[g][0]}):1<A.itemName.colCount?y.push({fieldName:A.fieldName,itemName:A.itemName[0]&&A.itemName[0][b]}):y.push({fieldName:A.fieldName,itemName:A.itemName[0]&&A.itemName[0][0]});p.push(n.evaluateGetPivotDataFunction(t,e.concat(y)))}s.push(p)}return new I.CalcArray(s)}function lo(){var t,n,e,i,r,o,a,u,s,c,u,f,l,h,d,v,m,g,p,t=arguments,n=M(t);if(n<2||n%2!=0)return y;for(i=0;i<n;i+=2){if(u=t[i+1],s=so(a=t[i],2),c=so(u,0),x(s))return s;if(x(c))return c;if(s.isError||c.isError)return y;if(u=s.length,f=c.length,b(o))o=f;else if(o!==f)return y;if(f<u)return y;if(u<f){if(!1===r||1<u)return y;for(b(e)&&(e=[]),l=c.rowCount,h=c.colCount,d=s[0],v=0;v<l;v++){for(m=e[v],b(m)&&(m=e[v]=[]),g=0;g<h;g++)b(m[g])&&(m[g]={}),m[g][d]=c[g+v*h];e[v]=m}r=!0}else{if(!0===r)return y;for(b(e)&&(e={}),p=0;p<f;p++)e[s[p]]=c[p];r=!1}}return r?new I.CalcArray(e):e}function ho(){var t,n,i,t;function e(t){for(var n,e,n=i.length,e=0;e<n;e++)if(t=t[i[e]],b(t))return y;return t}return n=(t=arguments)[0],i=t[1].split("."),b(t=n)||"object"!=typeof n?y:(k(n)?t.array=t.array.map(function(t){return Array.isArray(t)?t.map(e):e(t)}):t=e(t),t)}function vo(t){var n,e,i,r,o;try{if(n=t&&JSON.parse(t),Array.isArray(n)&&0<n.length){for(e=!0,i=0;i<n.length;i++)if(!Array.isArray(n[i])){e=!1;break}if(e)n=new I.CalcArray(n);else{for(r=[],o=0;o<n.length;o++)r.push([n[o]]);n=new I.CalcArray(r)}}return n}catch(t){return S}}function mo(t){return po(t,"AaK9#@BXHN\uff27S")}function go(t){return po(t,"\uff21\uff41\uff2b\uff19\uff03\uff20\uff22\uff38\uff3a\uff2e\uff33")}function po(t,n){var e,i,r,o,e="";if("number"===(i=t?typeof t:i)||"boolean"===i)e=t+"";else if(t instanceof Date)e=a.o0(t).toString();else{if("object"===i)return S;"string"===i&&(e=t)}return(o=(r=new I._9t(!0,n)).checkText(e)).CheckedText}function bo(){var t=new I.Functions.AsyncFunction("WEBSERVICE",1,1);t.defaultValue=function(){return""},t.evaluate=yo,I.Functions.Mmt.WEBSERVICE=t}function yo(n,t){var t,i,r,o,t=t;if(!t||t.length>It)return S;if(i=null,XMLHttpRequest&&(i=new XMLHttpRequest),r=function(t){n.setAsyncResult(t)},o=["application/json","application/xml","application/x-java-applet","application/java-archive","application/javascript","video/vnd.dlna.mpeg-tts"],null===i)return S;try{i.open("GET",t,!0),i.onreadystatechange=function(){var t,n,e;4===i.readyState&&(200!==i.status||!(n=(t=i.response)&&t.type)||-1===n.indexOf("text")&&-1===o.indexOf(n)?r(S):((e=new FileReader).onloadend=function(){r(e.result)},e.onerror=function(){r(S)},e.readAsText(t)))},i.onerror=function(){r(S)},i.timeout=xt,i.ontimeout=function(){r(S)},i.responseType="blob",i.send(null)}catch(t){return S}}function wo(t){return""===t||b(t)}function Mo(t){return Nt.a0(t)||Nt.a0(t,_t)}function Co(t){for(var n,e,i,r,o,n="",e=!1,i=0,r=t.length;i<r;i++)'"'===(o=t[i])?e=!e:e||"Y"!==o||(o=Dt),n+=o;return n}function So(t){return t.split(Dt).join("y")}function To(t){return t.formatters[0].E9t}function Ao(t){return t.j9t&&t.j9t.cultureInfo()||P.Fe(t.cultureName)||P.Fe()}function Io(t,n,e,i){return jo(t,n,e,Ao(i=To(i)),i.O9t)}function xo(){return/qqqq|qqq|qq|q|QQQQ|QQQ|QQ|Q|yyyy|yyy|yy|y|ww|w/g}function No(t,n,e){var i,r,t;return t?(t=(i=t.index)+t[0].length,e<i?[n.slice(e,i),t]:e===i?["",t]:["",e]):[n.slice(e),e]}function ko(t){return Un(Ai(t)/3,0)}function Do(t,n){return xi(t,b(n)?n:d(n))}function _o(t){var t=new Date(t.getTime()),n=(t.getDay()+6)%7,n=t.getDate()-n,e;return t.setDate(3+n),t.getFullYear()}function Eo(t,n,e,i){var r=_o(n),o=n.getFullYear();return z(r===o?n:new Date(r,0,1),t,i,e)}function jo(t,n,e,i,r){for(var o,a,u,s,c,f,l,h,o="",a=0,u=i.DateTimeFormat.eras,s=xo(),l=0;o+=(f=No(c=s.exec(n),n,a))[0],a=f[1],c;l++)switch(c[0]){case"QQQQ":case"qqqq":o+=Et[ko(t)];break;case"QQQ":case"qqq":o+="Q".concat(ko(t));break;case"QQ":case"qq":o+=G(ko(t),2);break;case"Q":case"q":o+=ko(t);break;case"yyyy":case"yyy":o+=u?Eo("ee",t,r,i):G(_o(t),4);break;case"yy":o+=u?Eo("ee",t,r,i):G(_o(t)%100,2);break;case"y":o+=u?Eo("e",t,r,i):(_o(t)%100).toString();break;case"ww":h=Do(t,e),x(h)?o+=h:o+=G(h,2);break;case"w":o+=Do(t,e)}return o.toString()}function Oo(){function t(){this.R9t=[{J6t:6},{J6t:5},{J6t:2}],this.Ul={}}(t.prototype=new I.Functions.Function("DATEPART",2,3)).evaluate=function(t,n,e){var i,r,o,o,i;return wo(n)||!Mo(n)?"":((i=this.Ul)[n=(r=21===e&&/Y/g.test(n)&&/w/g.test(n))?Co(n):n]||(o=c.Formatter&&c.Formatter.GeneralFormatter,i[n]=o?new o(n):h),i=(o=i[n]).format(t),r&&(i=So(i)),/q|Q|w|y/g.test(i)?Io(t,i,e,o):i)},I.Functions.Mmt.DATEPART=new t}function Ro(t,n){if(!t||8!==t.type)throw(0,I.sR)().Exp_FormulaInvalid;if(-1!==n.indexOf(t.value))throw(0,I.sR)().Exp_FormulaInvalid;if(-1<t.value.indexOf("."))throw(0,I.sR)().Exp_FormulaInvalid}Object.defineProperty(t,"__esModule",{value:!0}),c=L("Common"),I=L("CalcEngine"),o=c.Common.$T,F=c.Common.zf,a=c.Common.ct,P=c.Common.CultureManager,G=c.Common.zf.B9t,f=a.o0,U=a.Y0,H=a.yU,z=a.L9t,M=c.Common.Uf.tR,t=c.Common.lt,V=t.Rh,b=t.ht,h=null,w=void 0,Y=isNaN,Z=parseFloat,l=parseInt,W=Math.round,s=Math.abs,Q=Math.sqrt,J=Math.max,K=Math.min,C=Math.floor,X=Math.exp,q=Math.log,$=Math.PI,tt=Math.random,nt=Math.pow,et=I.Errors.Null,u=I.Errors.DivideByZero,S=I.Errors.Value,it=I.Errors.Reference,rt=I.Errors.Name,g=I.Errors.Calc,y=I.Errors.NotAvailable,T=I.Errors.Number,A=I.Convert.CalcConvertedError,x=I.Convert.BJ,N=I.Convert.LE,k=I.Convert.Nh,ot=I.Convert.YK,d=I.Convert.z6t,at=I.Convert.uJ,ut=I.Convert.j,st=I.Convert.q8,D=I.Convert.iV,_=I.Convert.L6t,ct=I.skt.tryExtractToSingleValue,ft=I.Functions.G6t,lt=I.Functions.q8,ht=a.W0,v=I.Functions.OMt,dt=I.Functions.F9t,vt=I.Functions.P9t,mt=I.Functions.G9t,gt=I.Functions.U9t,pt=I.Functions.Pkt,bt=I.Functions.nkt,yt=I.Functions.b9t,wt=I.Functions.H9t,Mt=I.Functions.y9t,m=I.Functions.MathHelper,Ct=m.z9t,p=m.d9t,t=I.Functions.F6t,St=I.Convert.sJ,Tt=I.Convert.YK,At=I.Convert.Sft,It=2048,xt=1e4,Nt=c.Formatter.Hf,kt=21,Dt="(&}",_t=["qqqq","qqq","qq","q","QQQQ","QQQ","QQ","Q","YYYY","YYY","YY","Y","ww","w"],Et={1:"1st quarter",2:"2nd quarter",3:"3rd quarter",4:"4th quarter"},jt=new Date(1899,11,30),Ot=new Date(9999,11,31),Rt={J6t:0,pkt:"= 0",zkt:u},e={J6t:0,pkt:"= 0",zkt:0},Bt={bkt:1,J6t:0,pkt:"= 0",zkt:0},Lt={J6t:2,pkt:"< 0"},Ft={J6t:0,pkt:["> 134217728","< -134217728"]},Pt={J6t:1},i={J6t:2},Gt={bkt:1,J6t:2},r={bkt:1,J6t:2,pkt:"< 0",zkt:S},Ut={bkt:1,J6t:2,pkt:["= 0"],zkt:S},Ht={bkt:0,J6t:2,pkt:["< 0","> 1"],zkt:S},E={J6t:5},j={J6t:6},zt={J6t:2,pkt:"< 0",zkt:S},Yt={bkt:!(Vt={J6t:5,zkt:S}),J6t:7},Zt={bkt:[],J6t:4,X6t:4,Vkt:!0,Ykt:!0,M9t:!0},Wt={J6t:4,X6t:1,Ykt:!0,M9t:!0},Qt={J6t:4,X6t:1,Vkt:!0,Ykt:!0,n9t:!0},Jt={J6t:4,X6t:3,Vkt:!0,Ykt:!0,n9t:!0},Kt={J6t:4,X6t:0,Vkt:!0,Ykt:!0,n9t:!0},Xt={J6t:4,X6t:2,Vkt:!0,Ykt:!0,n9t:!0},qt=[0,"%= 1 && >= 3"],t("ABS",un,1,1,n={J6t:0}),t("ACOS",ge,1,1,{J6t:0,pkt:["> 1","< -1"]}),t("ACOT",Te,1,1,n),t("ASIN",me,1,1,{J6t:0,pkt:["> 1","< -1"]}),t("ATAN",Se,1,1,n),t("ATAN2",Ae,2,2,[n,n]),t("COS",le,1,1,n),t("SEC",he,1,1,Ft),t("CEILING",jn,2,2,[e,e]),t("ODD",dn,1,1,Pt),t("EVEN",vn,1,1,Pt),t("FLOOR",On,2,2,[e,e]),t("LN",pn,1,1,{J6t:1,pkt:"<= 0"}),t("SQRT",xn,1,1,{J6t:0,pkt:"< 0"}),t("SIN",ce,1,1,n),t("CSC",fe,1,1,Ft),t("TAN",de,1,1,n),t("COT",ve,1,1,Ft),t("SIGN",Sn,1,1,{J6t:1,pkt:"> 0",zkt:1}),t("GCD",Tn,1,w,Qt,-1,-1),t("LCM",An,1,w,Qt,-1,-1),t("PRODUCT",In,1,w,w,-1,-1),t("POWER",wn,2,2,[n,n]),t("MOD",bn,2,2,[n,{J6t:0,pkt:"= 0",zkt:u}]),t("QUOTIENT",Nn,2,2,[n,Rt],w,w),t("SUBTOTAL",kn,2,w,i,"!= 0",w,{u9t:"filter"}),t("_SUBTOTALFORSTATUSBAR",Dn,2,5e3,i,"!= 0",w,{u9t:"filter"}),t("INT",sn,1,1,w,w,w),t("MROUND",Fn,2,2,[e,e]),t("ROUND",Pn,2,2,[n,i]),t("ROUNDDOWN",Gn,2,2,[n,i]),t("ROUNDUP",Un,2,2,[n,i]),t("TRUNC",Gn,1,2,[n,{bkt:0,J6t:2}],w,w,{wkt:1}),t("EXP",Hn,1,1,n),t("LOG",Yn,1,2,[{J6t:0,pkt:"<= 0"},{bkt:10,J6t:0,pkt:"<= 0"}],w,w,{wkt:1}),t("LOG10",Zn,1,1,{J6t:0,pkt:"<= 0"}),t("SUM",Cn,1,w,w,-1,-1),t("SUMIF",Wn,2,3,w,[0,2],w,{wkt:2,e9t:[2],i9t:!0,o9t:4,f9t:1,r9t:!0}),t("SUMIFS",Jn,3,w,w,[0,"%= 1"],w,{e9t:qt,i9t:!0,o9t:4,r9t:!0}),t("SUMPRODUCT",ne,1,w,w,-1,-1,{o9t:1}),t("SUMSQ",ee,1,w,Qt,-1,-1),t("SUMX2MY2",ie,2,2,Qt,-1,-1),t("SUMX2PY2",re,2,2,Qt,-1,-1),t("SUMXMY2",oe,2,2,Qt,-1,-1),t("SERIESSUM",ae,4,4,[n,i,i,{J6t:4,X6t:1,Vkt:!0,Ykt:!0,M9t:!0}],3,3),t("PI",yn,0,0),t("SQRTPI",ue,1,1,{J6t:0,pkt:"< 0"}),t("DEGREES",hn,1,1,Pt),t("RADIANS",se,1,1,n),t("COSH",ye,1,1,n),t("SECH",we,1,1,n),t("ACOSH",Ce,1,1,{J6t:0,pkt:"< 1"}),t("SINH",pe,1,1,n),t("CSCH",be,1,1,n),t("ASINH",Me,1,1,n),t("TANH",Ie,1,1,n),t("COTH",xe,1,1,{J6t:0}),t("ATANH",Ne,1,1,{J6t:0,pkt:["<= -1",">= 1"]}),t("ACOTH",ke,1,1,{J6t:0}),t("MDETERM",De,1,1,Wt,-1,-1),t("MINVERSE",_e,1,1,Wt,-1,-1),t("MMULT",Ee,2,2,[Wt,Wt],-1,-1),t("FACT",mn,1,1,{J6t:3,pkt:["< 0","> 170"]}),t("FACTDOUBLE",gn,1,1,{J6t:3,pkt:["< 0","> 300"]}),t("MULTINOMIAL",je,1,w,{J6t:4,X6t:0,Vkt:!0,Ykt:!0,n9t:!0},-1,-1),t("RAND",Oe,0,0,w,w,w,{V9t:!0}),t("RANDBETWEEN",Re,2,2,[i,i],w,w,{V9t:!0}),t("COMBIN",cn,2,2,[Lt,Lt]),t("COMBINA",fn,2,2,[Lt,Lt]),t("DECIMAL",ln,2,2,[{bkt:"0",J6t:5},{J6t:0,pkt:["> 36","< 2"]}]),t("CEILING.MATH",Rn,1,3,[n,{J6t:0,bkt:1},{J6t:0,bkt:0}]),t("FLOOR.MATH",Bn,1,3,[n,{J6t:0,bkt:1},{J6t:0,bkt:0}]),t("BASE",Ln,2,3,[{J6t:0,pkt:["< 0",">= 9007199254740992"]},{J6t:3,pkt:["> 36","< 2"]},{J6t:3,bkt:0,pkt:["< 0",">= 256"]}]),t("ROMAN",Be,1,2,[{J6t:2,pkt:["< 0","> 3999"],zkt:S},{bkt:0}],w,w,{wkt:1}),t("ARABIC",Le,1,1,E),t("CEILING.PRECISE",zn,1,2,[e,Bt]),t("ISO.CEILING",zn,1,2,[e,Bt]),t("FLOOR.PRECISE",Vn,1,2,[e,Bt]),t("MAXIFS",Kn,3,w,w,[0,"%= 1"],[0,"%= 1"],{e9t:qt,i9t:!0,r9t:!0}),t("MINIFS",Xn,3,w,w,[0,"%= 1"],[0,"%= 1"],{e9t:qt,i9t:!0,r9t:!0}),t("AVERAGEIFS",$n,3,w,w,[0,"%= 1"],[0,"%= 1"],{e9t:qt,i9t:!0,r9t:!0}),t("COUNTIFS",qn,2,w,w,"%= 0","%= 0",{e9t:["%= 0 && >= 2"],i9t:!0,r9t:!0}),t("MUNIT",te,1,1,{J6t:2,pkt:"<= 0",zkt:S}),t("SEQUENCE",Fe,1,4,[i,i,n,n],w,w,{wkt:[0,1,2,3]},!0),t("RANDARRAY",Pe,0,5,[i,i,n,n],w,w,{V9t:!0,wkt:[0,1,2,3,4]},!0),t("AGGREGATE",En,3,w,w,"> 1","> 1",{o9t:1,r9t:!0,u9t:"filter"}),t("AND",Ue,1,w,Kt,-1,-1),t("OR",He,1,w,Kt,-1,-1),t("NOT",ze,1,1),t("IF",Ve,2,3,w,[1,2],[1,2],{f9t:[1,2],wkt:2,isBranch:!0,findTestArgument:0,findBranchArgument:function(t){var t;return I.Convert.BJ(t)?-1:(ot(t,t={value:!1}),t.value?1:2)}}),t("IFERROR",Ze,2,2,w,w,w,{f9t:-1}),t("TRUE",We,0,0),t("FALSE",Qe,0,0),t("IFNA",Je,2,2,w,w,w,{f9t:-1}),t("IFS",Ke,2,254,w,0,w,{f9t:-1}),t("SWITCH",Xe,3,253,w,w,w,{f9t:-1}),t("XOR",qe,1,w,Jt,-1,-1),t("LET",w,3,253,w,w,w,{argsValidator:function(t,n,e,i){var r,o;if(e%2==0)throw(0,I.sR)().Exp_FormulaInvalid;for(r=[],o=0;o<i.length-1;o+=2)Ro(i[o],r),r.push(i[o].value)}}),t("LAMBDA",w,1,253,w,w,w,{argsValidator:function(t,n,e,i){for(var r,o,r=[],o=0;o<i.length-1;o++)Ro(i[o],r),r.push(i[o].value)}}),t("MAP",ii,2,w,w,-1,-1,{isContextSensitive:!0},!0),t("REDUCE",ri,3,3,w,-1,-1,{isContextSensitive:!0},!0),t("SCAN",oi,3,3,w,-1,-1,{isContextSensitive:!0},!0),t("BYROW",ui,1,2,w,-1,-1,{isContextSensitive:!0},!0),t("BYCOL",si,1,2,w,-1,-1,{isContextSensitive:!0},!0),t("MAKEARRAY",ai,3,3,[r,r],w,w,{isContextSensitive:!0},!0),t("DATE",mi,3,3,[{J6t:2,pkt:["< 0","> 9999"]},i,i]),t("TIME",gi,3,3,[i,i,i]),t("DATEVALUE",pi,1,1,{Y9t:!0}),t("TIMEVALUE",bi,1,1,{Y9t:!0}),t("NOW",yi,0,0,w,w,w,{V9t:!0}),t("TODAY",wi,0,0,w,w,w,{V9t:!0}),t("HOUR",Mi,1,1,j),t("MINUTE",Ci,1,1,j),t("SECOND",Si,1,1,j),t("DAY",Ti,1,1,j),t("MONTH",Ai,1,1,j),t("YEAR",Ii,1,1,j),t("WEEKNUM",xi,1,2,[j,Gt],w,w,{wkt:1}),t("WEEKDAY",R,1,2,[j,Gt],w,w,{wkt:1}),t("EDATE",Ni,2,2,[j,i]),t("EOMONTH",ki,2,2,[j,i]),t("WORKDAY",Di,2,3,[j,i,Zt],2,2,{wkt:2}),t("WORKDAY.INTL",_i,2,4,[j,i,{bkt:"0000011"},Zt],[3],[2,3],{wkt:[2,3]}),t("DAYS360",I.Functions.Mkt,2,3,[j,j,{bkt:!1,J6t:7}],w,w,{wkt:2}),t("NETWORKDAYS",Ei,2,3,[j,j],2,2,{wkt:2}),t("NETWORKDAYS.INTL",Oi,2,4,[j,j],[2,3],[2,3],{wkt:[2,3]}),t("YEARFRAC",I.Functions.Hkt,2,3,[j,j,{bkt:0,J6t:2}],w,w,{wkt:2}),t("DATEDIF",Ri,3,3,[j,j,E]),t("DAYS",Bi,2,2),t("ISOWEEKNUM",Li,1,1,j),t("CLEAN",Ui,1,1,E),t("TRIM",Hi,1,1,E),t("DOLLAR",zi,1,2,[n,{bkt:2,J6t:2,pkt:"> 99",zkt:S}],w,w,{wkt:1}),t("FIXED",Vi,1,3,[n,{bkt:2,J6t:2},{bkt:!1,J6t:7}],w,w,{wkt:[1,2]}),t("TEXT",Yi,2,2,[{},E]),t("VALUE",Zi,1,1,w,w,w),t("LOWER",Qi,1,1,E),t("UPPER",Ji,1,1,E),t("PROPER",Ki,1,1,E),t("CHAR",Xi,1,1,{J6t:2,pkt:["> 255","< 1"],zkt:S}),t("CODE",qi,1,1,{J6t:5,Y9t:!0}),t("REPLACE",$i,4,4,[E,{J6t:2,pkt:"< 1",zkt:S},zt,E],w,w,{wkt:2}),t("SUBSTITUTE",nr,3,4,[E,{J6t:5,Y9t:!0},E],w,w,{wkt:3}),t("CONCATENATE",er,1,w,{J6t:4,X6t:0,Vkt:!0,n9t:!0},w,-1),t("LEFT",ur,1,2,[E,r],w,w,{wkt:1}),t("MID",hr,3,3,[E,{J6t:2,pkt:"<= 0",zkt:S},zt]),t("RIGHT",sr,1,2,[E,r],w,w,{wkt:1}),t("REPT",vr,2,2,[E,i]),t("LEN",mr,1,1,E),t("FIND",br,2,3,[E,E,Gt],w,w,{wkt:2}),t("SEARCH",wr,2,3,[E,E,r],w,w,{wkt:2}),t("EXACT",Tr,2,2,[E,E]),t("T",Ar,1,1),t("UNICHAR",Ir,1,1,[{J6t:2,zkt:S}]),t("UNICODE",xr,1,1),t("BAHTTEXT",Nr,1,1,[{J6t:0,zkt:S}]),t("CONCAT",ir,1,w,{J6t:4,Vkt:!0,Ykt:!0,n9t:!0},-1,-1),t("TEXTJOIN",rr,3,w,{J6t:4,Vkt:!0,Ykt:!0,n9t:!0},-1,-1),t("FINDB",yr,2,3,[E,E,Gt],w,w,{wkt:2}),t("LEFTB",fr,1,2,[E,r],w,w,{wkt:1}),t("RIGHTB",lr,1,2,[E,r],w,w,{wkt:1}),t("MIDB",dr,3,3,[E,zt,zt]),t("LENB",pr,1,1,E),t("REPLACEB",tr,4,4,[E,{J6t:2,pkt:"< 1",zkt:S},zt,E],w,w,{wkt:2}),t("SEARCHB",Sr,2,3,[E,E,r],w,w,{wkt:2}),t("TEXTAFTER",Dr,2,6,[E,Xt,Ut,Ht,Ht,E],[1],[1],{wkt:[2,3,4,5]}),t("TEXTBEFORE",_r,2,6,[E,Xt,Ut,Ht,Ht,E],[1],[1],{wkt:[2,3,4,5]}),t("TEXTSPLIT",Or,2,6,[E,Xt,Xt,Yt,Ht,E],[1,2],[1,2],{wkt:[1,2,3,4,5]},!0),t("ENCODEURL",io,0,1,E),t("ISERROR",Rr,1,1,w,w,w,{f9t:-1}),t("ISERR",Br,1,1,w,w,w,{f9t:-1}),t("ISNA",Lr,1,1,w,w,w,{f9t:-1}),t("ERROR.TYPE",Fr,1,1,w,w,w,{f9t:-1}),t("ISNUMBER",Pr,1,1,w,w,w,{f9t:-1}),t("ISEVEN",Gr,1,1,n,w,w),t("ISODD",Ur,1,1,n,w,w),t("N",Hr,1,1,w,w,w),t("ISBLANK",zr,1,1,w,w,w,{f9t:-1}),t("ISLOGICAL",Vr,1,1,w,w,w,{f9t:-1}),t("ISTEXT",Yr,1,1,w,w,w,{f9t:-1}),t("ISNONTEXT",Zr,1,1,w,w,w,{f9t:-1}),t("ISREF",Wr,1,1,w,-1,w,{f9t:-1}),t("TYPE",Qr,1,1,w,w,-1,{f9t:-1}),t("NA",Jr,0,0),t("SHEET",Kr,0,1,w,-1,w,{r9t:!0}),t("SHEETS",Xr,0,1,w,-1,w,{r9t:!0}),t("GETPIVOTDATA",co,2,253,w,-1,-1,{r9t:!0}),t("OBJECT",lo,2,w,w,-1,-1),t("PROPERTY",ho,2,2,w),t("FILTERJSON",vo,1,1,w),t("ASC",mo,1,1),t("DBCS",go,1,1),t("ISOMITTED",w,1,1,w,-1,-1),t("GC.REGEXEXTRACT",oo,2,3),t("GC.REGEXMATCH",ao,2,3,w),t("GC.REGEXREPLACE",uo,3,4,w),Oo(),bo(),qr()},CalcEngine:function(t){t.exports=a("CalcEngine")},Common:function(t){t.exports=a("Common")}},i={},o.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(t){if("object"==typeof window)return window}}(),n=t={},Object.defineProperty(n,"__esModule",{value:!0}),n.Functions=void 0,r=o("CalcEngine"),Object.defineProperty(n,"Functions",{enumerable:!0,get:function(){return r.Functions}}),o("./src/functions-basic.ts"),(((u={}).Spread=u.Spread||{}).CalcEngine=u.Spread.CalcEngine||{}).BasicFunctions=t}(),t.exports=u.Spread.CalcEngine.BasicFunctions},"./node_modules_local/@grapecity/js-calc-basicfunctions/index.js":function(t,n,e){t.exports=e("./node_modules_local/@grapecity/js-calc-basicfunctions/dist/gc.spread.calcengine.basicfunctions.js")},"./node_modules_local/@grapecity/js-calc/dist/gc.spread.calcengine.js":function(t,n,o){var a;!function(){"use strict";var e,i,t;function r(t){var n,n,n=i[t];return void 0!==n||(n=i[t]={exports:{}},e[t].call(n.exports,n,n.exports,r)),n.exports}e={"./src/Parser.ts":function(y,M,t){var n,i,w,C,h,d,v,e,L,S,T,t,g,F,P,G,f,A,I,x,N,r,k,D,t,o,a,U,u,s;function _(){throw(0,w.sR)()[P]}function E(t,n,e){throw T.I5((0,w.sR)()[e||F],[t,n])}function H(t){return t<=255}function z(t){return t<=127}function j(t){return t===(0,w.getBoolean)().boolean_true||t===e}function V(t){return t===(0,w.getBoolean)().boolean_false||t===L}function O(t){return 48<=t&&t<=57}function Y(t){var t=t.charCodeAt(0);return!(t<=255)||(t<=127?96<=(t|=32)&&t<=122:0===r[t]||1===r[t])}function Z(t){var t=t.charCodeAt(0);return!(t<=255)||(t<=127?t<=57?48<=t:96<=(t|=32)&&t<=122:0===r[t]||1===r[t])}function W(t){var t=t.charCodeAt(0);return t<=127?48<=t&&t<=57:8===r[t]||10===r[t]}function R(t,n,e,i,r,o){for(var a,u,s,c,f,l,a=t.length,u=e===i?0:1,s=[],c=0,f=n+1;f<a;f++)if((l=t[f])===r&&(s.push(l),c++,l=t[++f]),l===e&&u++,l===i)if(u--,e===i&&f+2<a&&t[f+1]===e)s.push(e),f++,c++;else{if(0===u)return{result:s,endIndex:f,skipCount:c};s.push(l)}else s.push(l);o&&E(i,e,G)}function Q(t,n,e){for(var i,r,o,a,u,s,i=t.length,r=i-n,o=0;o<w.ErrorList.length;o++)if(n+(u=(a=w.ErrorList[o]).length)<=i&&(s=t.slice(n,n+u),u<=r)&&a===s.join("").toUpperCase())return{result:s,endIndex:n+u-1};e&&E([t[n],n])}function J(t){return 0!==t.type&&(7!==t.type||"ANCHORARRAY"===t.functionName)&&t.type<9}function K(t,n,e){for(var i,r,o,a,u,i=t.length,r=0,o=[],a=n;a<i;a++)if(O((u=t[a]).charCodeAt(0)))0===r?r=2:3===r?r=4:1===r?r=2:5!==r&&6!==r||(r=7),o.push(u);else if(u===e){if(2===r)r=4;else{if(0!==r&&1!==r)return{};r=3}o.push(".")}else if("+"===u||"-"===u){if(0===r)r=1;else{if(5!==r)return{num:o,endIndex:a-1};r=6}o.push(u)}else if("E"===u||"e"===u){if(2!==r&&4!==r)return{};r=5,o.push(u)}else if(2===r||4===r||7===r)return{num:o,endIndex:a-1};return 2===r||4===r||7===r?{num:o,endIndex:i-1}:{}}function B(t,n){k.apply(t,n)}function c(t,n,e,i,r){var o,a,i;this.R1t=[],r=r||0,(o=this).y4=t,a=Array.isArray(t)?t.join(""):t,o.uit=n,o.lp=e,o.ywt=i||e+t.length-1,0===n&&0===r&&t&&(j(i=a.toUpperCase())||V(i))&&(r=5,a=i),o.Awt=a,o.Twt=r}function l(t){this.priority=t=void 0===t?5e3:t}function X(t){var n,e,i,n=[];if(-1<t.indexOf(":")&&-1===t.indexOf("["))for(e=t.split(":"),i=0;i<e.length;i++)n.push("'"+e[i].replace(/'/g,"''")+"'");return n}function q(t){for(var n,e,i,n=0,e=t;n<e.length;n++)if(0===(i=e[n]).type||i.arguments&&q(i.arguments))return 1}function m(){}function p(t,n,e,i){this.lyt=!1,this.ignoreError=!1;var r=this;r.useR1C1=n,r.baseIdentity=e,r.option=i,r.source=t}function $(t,n,e){var i,r;if(!n||0===n.length||tt(t,n)||tt(t,e))return[];if(i=n,e)for(i.push(":"),r=0;r<e.length;r++)i.push(e[r]);return i}function tt(t,n){var t;if(n&&0!==n.length&&t.lyt)return"["===n[t="'"===n[0]?1:0]&&n.indexOf("]")>t}function b(){return null!==s&&s.apply(this,arguments)||this}n=this&&this.__extends||(u=function(t,n){return(u=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(t,n){t.__proto__=n}:function(t,n){for(var e in n)Object.prototype.hasOwnProperty.call(n,e)&&(t[e]=n[e])}))(t,n)},function(t,n){if("function"!=typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function e(){this.constructor=t}u(t,n),t.prototype=null===n?Object.create(n):(e.prototype=n.prototype,new e)}),Object.defineProperty(M,"__esModule",{value:!0}),M.DefaultTokenResolver=M.ParserContext=M.Parser=M.TokenResolver=M.FormulaToken=M.isNumber=M.Jkt=M.Swt=M.isDigit=M.operaterTypesMap=M.preOperaterTypesMap=M.Z9t=void 0,i=t("Common"),w=t("./src/calc.common.ts"),C=void 0,h=null,d="string",v="boolean",e="TRUE",L="FALSE",S="ARRAY",T=i.Common.zf,t=i.Common.lt,g=t.ht,F="Exp_FormulaInvalidChar",P="Exp_FormulaInvalid",G="Exp_NoSyntax",M.Z9t=["+","-","%","+","-","*","/","^","&","=","<>","<","<=",">",">=",":",","," ","."],M.preOperaterTypesMap={"+":0,"-":1},M.operaterTypesMap={":":15,",":16,"+":3,"-":4,"*":5,"/":6,"^":7,"%":2,"&":8,"=":9,"<":11,"<>":10,"<=":12,">":13,">=":14},f={":":0," ":1,".":2,"^":3,"*":4,"/":4,",":5,"+":6,"-":6,"&":7,"<":8,"=":8,">":8,">=":8,"<=":8,"<>":8},A=".",x=";",N=I=",",r=[14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,11,24,24,24,26,24,24,24,20,21,24,25,24,19,24,24,8,8,8,8,8,8,8,8,8,8,24,24,25,25,25,24,24,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,20,24,21,27,18,27,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,20,25,21,25,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,11,24,26,26,26,26,28,28,27,28,1,22,25,19,28,27,28,25,10,10,27,1,28,24,27,10,1,23,10,10,10,24,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,25,0,0,0,0,0,0,0,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,25,1,1,1,1,1,1,1,1],M.isDigit=O,M.Swt=Y,M.Jkt=Z,M.isNumber=W,k=[].push,c.prototype.type=function(){return this.uit},c.prototype.subType=function(){return this.Twt},c.prototype.stringValue=function(){return this.Awt},D=c,M.FormulaToken=D,l.prototype.resolveToken=function(t,n,e,i,r){return 0},l.prototype.unparse=function(t,n,e,i){return!0},M.TokenResolver=t=l,m.prototype.setParserOption=function(t){var n,e;t!==C&&i.Common.CultureManager.Fe()?(e=("object"==typeof t&&t.NumberFormat?t:i.Common.CultureManager.Fe()).NumberFormat,n=t?e:{}):e=n={},I=m.listSeparator=n.listSeparator||",",A=n.numberDecimalSeparator||".",!t&&m.numberDecimalSeparator||(m.numberGroupSeparator=e.numberGroupSeparator||",",m.numberDecimalSeparator=e.numberDecimalSeparator||"."),x=m.arrayGroupSeparator=n.arrayGroupSeparator||";",N=m.arrayListSeparator=n.arrayListSeparator||","},m.prototype.parseDotOperator=function(t,n,e){var i,r,o,a,u,o,i=n[e];if(!(n[e-1]&&"#"===n[e-1].y4&&"."!==i.Awt[0]||n[e+1]&&":"===n[e+1].y4||0!==i.uit||0!==i.Twt||(0,w.W9t)(t.source,i.Awt)||!(0<=(r=i.Awt.lastIndexOf("."))))){if(0<=(o=i.Awt.substring(r+1)).indexOf("]"))return 0;if(a=new D(i.Awt.substring(0,r).split(""),0,i.lp,i.lp+r-1),u=new D(["."],5,i.lp+r,i.lp+r),(o=new D(o.split(""),0,i.lp+r+1,i.ywt)).Q9t=!0,r===i.Awt.length-1)return 0===r?n.splice(e,1,u):n.splice(e,1,a,u),1+this.parseDotOperator(t,n,e);if(0<r)return n.splice(e,1,a,u,o),2+this.parseDotOperator(t,n,e);if(0===r)return n.splice(e,1,u,o),1}return 0},m.prototype.parse=function(t,n){var n,e,i;if(n=(0,w.K9t)(n),this.setParserOption(t.culture),n=n.split(""),this.J9t=n,t.X9t=!1,e=this.parseToTokens(t,n,!t.ignoreError),t.source&&t.X9t)for(i=0;i<e.length;i++)i+=this.parseDotOperator(t,e,i);return this.buildExpressionTree(t,e,!t.ignoreError)},m.prototype.unparse=function(t,n,e){return this.q9t(t,n,e=void 0===e?[]:e),e.join("")},m.prototype.q9t=function(t,n,e){var i,r;if(n)for(n.$9t&&!t.lyt&&e.push("@"),this.setParserOption(t.culture),i=t.getResolvers(),r=0;r<i.length&&!i[r].unparse(t,this,n,e);r++);},m.prototype.parseToTokens=function(a,u,s){var c,f,l,h,d,v,m,g,p,t,b,y,n,w,e;for(void 0===s&&(s=!0),c=this,f=function(t,n,e){return 0<n.length&&(0<=n.indexOf(".")&&(a.X9t=!0),t.push(new D(n,0,e))),[]},l=u.length,h=[],d=[],v=-1,m=[],t=0;t<l&&" "===u[t];)t++;for("="===u[t]&&t++,n=function(n){var t,e,i,r,o,r,o,o,r,i,o,r,i,t=u[n],e=t.charCodeAt(0),i=void 0;if(64===e)m=f(h,m,p),h.push(new D(u[n],4,n,n)),p=n+1;else if(97<=e&&e<=122||65<=e&&e<=90)m.push(t);else if(34===e)0<m.length&&(m=f(h,m,p)),(i=R(u,n,'"','"',"",s))?(r=new D(i.result,0,n,n+i.result.length+2,3),i.skipCount&&(r.Ewt=u.slice(n,i.endIndex+1).join(""),r.ywt+=i.skipCount),h.push(r),n=i.endIndex,p=n+1):(B(m,u.slice(n,l)),n=l-1);else if(39===e)i=R(u,n,"'","'","",s),n=i?(r=[],1<(o=X(i.result.join(""))).length&&(o=o.join(":").split(""),r=c.parseToTokens(a,o,s)),r&&0<r.length?(r.forEach(function(t){t.lp+=n,t.ywt+=n}),B(h,r)):(m.push("'"),B(m,i.result),m.push("'")),i.endIndex):(m.push("'"),l-1);else if(91===e)if(i=R(u,n,"[","]","'",s))m.push("["),B(m,i.result),m.push("]"),n=i.endIndex;else{if(c._isR1C1&&0===m.length&&("R"===m[0]||"r"===m[0]||"C"===m[0]||"c"===m[0]))return w=n,"continue";B(m,u.slice(n,l)),n=l-1}else{if(13===e||10===e)return w=n,"continue";if(35===e)(o=Q(u,n))?(h.push(new D(o.result,0,n,n+o.result.length-1,6)),p=n+1,n=o.endIndex):(m=f(h,m,p),h.push(new D(u[n],6,n,n)),p=n+1);else if(33===e)m.length,0<(r=h.length)&&0===h[r-1].uit?(i=h[r-1],k.apply(i.y4,m),h[r-1]=new D(i.y4,0,i.lp,n,12)):h.push(new D(m,0,p,n,12)),m=[],p=n+1;else if(43===e||45===e)o=0===h.length?null:h[h.length-1],p=(0!==m.length?(m=f(h,m,p),h.push(new D(t,5,n))):(o&&7===o.uit&&h.pop(),!o||2!==o.Twt&&6!==o.uit&&0!==o.uit?h.push(new D(t,4,n)):h.push(new D(t,5,n))),n+1);else if(t===A||O(e))!(0<m.length)&&(r=K(u,n,A)).num?(b=r.endIndex,i=r.num,p=b<=l-2&&"!"===u[b+1]?(B(m,i),b):(h.push(new D(i,0,n,b,4)),b+1),n=b):m.push(t);else if(123===e)0<m.length&&(s?E(t,n):m=f(h,m,p)),g=new D(S,1,n,n,1),h.push(g),d[++v]=g,p=n+1;else if(t===x&&0<=v&&d[v].value===S)m=f(h,m,p),v<0&&s&&E(t,n),h.push(new D(x,3,n,n)),p=n+1;else if(125===e)m=f(h,m,p),b<0&&s&&E(t,n),y=d[v],v--,y=new D(t,y.uit,n,n,2),h.push(y),p=n+1;else if(32===e)m=f(h,m,p),p=n+1;else if(t===I||t===N||t===x)m=f(h,m,p),v<0||1!==d[v].uit?h.push(new D(I,5,n,n,10)):h.push(new D(t,3,n,n)),p=n+1;else if(37===e)m=f(h,m,p),h.push(new D(u[n],6,n,n)),p=n+1;else if(n+2<=l&&M.operaterTypesMap[t+u[n+1]])m=f(h,m,p),h.push(new D(u.slice(n,n+2),5,n,n+1,5)),p=++n+1;else if(M.operaterTypesMap[t])m=f(h,m,p),h.push(new D(t,5,n,n)),p=n+1;else if("("===t)0<m.length?(g=new D(m,1,p,n,1),m=[]):g=new D(t,2,n,n,1),h.push(g),d[++v]=g,p=n+1;else if(")"===t){if(m=f(h,m,p),v<0)return s&&E(t,n),f(h,t,n),p=n+1,w=n,"continue";y=d[v],v--,y=new D(t,y.uit,n,n,2),h.push(y),p=n+1}else if(":"===t)m=f(h,m,p),h.push(new D(t,5,n,n,11)),p=n+1;else if("\r"!==t&&"\n"!==t){if("\\"===t){if(l<=++n)return s&&E(t,n),w=n,"continue";m.push(t),t=u[n]}m.push(t)}}w=n},e=p=t;e<l;e++)n(e),e=w;return f(h,m,p),h},m.prototype.buildExpressionTree=function(t,n,e){var i,n,i,n,r;return this.tDt(n),i=t.keepUnknownFormulas,t.nDt=!1,n=this.eDt(t,n,e),i&&(0===n.length||q(n))?h:(i=this.iDt(t,n,e),e&&(i||_(),this.rDt(i)),t.nDt&&this.oDt(i,new w.LocalScopes,!1,!1,t,e),!(r=(n=t.source)&&n.G3)&&i&&(i.lMt=!0),i)},m.prototype.rDt=function(t){for(var n,e,i,r,o,a;10===t.type;)t=t.value;if(n=this,9===t.type)t.value||_(),n.rDt(t.value),t.value2&&n.rDt(t.value2);else if(7===t.type)if(i=(e=t.arguments).length,r=t.function,(0,w.isExpression)(r))this.rDt(r);else for(r&&r.aDt(r.minArgs,r.maxArgs,i,e),o=0;o<i;o++)a=e[o],r?r.uDt(a,o):(0,w.sDt)(a,o),n.rDt(a)},m.prototype.iDt=function(t,n,e){for(var i,r,o,a,u,s,c,i=this.cDt(t,n,e),u=3;u<i.length;)if(s=i[u],9!==(c=i[u-2]).type&&e&&_(),s&&9===s.type){for(;3<=u&&f[s.value]>=f[c.value];)o=i[u-3],a=i[u-1],r=(0,w.rbt)(c.operatorType,o,a),i.splice(u-3,3,r),3<=(u-=2)&&(c=i[u-2]);u+=2}else u++;if(1===i.length)return i[0];for(u=i.length-2;0<u;u-=2)o=i[u-1],a=i[u+1],9!==i[u].type&&e&&_(),r=(0,w.rbt)(i[u].operatorType,o,a),i.splice(u-1,3,r);return r},m.prototype.fDt=function(t,n,e){var i,r,o,a,u,s;if(!t||t.length<=0)return t;for(i=t,o=[],a=[],u=r=0;u<=i.length;u++)s=i[u],u===i.length||e(s)?(o.push(r===u?new w.Expression(11):this.iDt(n,a)),r=u+1,a=[]):a.push(s);return o},m.prototype.cDt=function(t,n,e){for(var i,r,o,a,u,s,c,f,l,h,d,v,m,i=[],r=(n=Array.isArray(n)?n:[n]).length,o=0;o<r;o++){if(10===(u=a=n[o]).type){if((s=0<i.length?i[i.length-1]:C)&&7===s.type){c=this.fDt(a.value,t,function(t){return t.value===I}),i[i.length-1]=(0,w.lDt)(s,c);continue}a.value=this.iDt(t,a.value),u=a}else 7===a.type&&(a.arguments=this.fDt(a.arguments,t,f=function(t){return 0===t.type&&t.value===I}));i.push(u)}for(n=i,i=[],r=n.length,o=0;o<r;o++){if(9===(u=a=n[o]).type)if(0===a.operatorType||1===a.operatorType)if(o===r-1)e&&_();else{for(l=o;!g(n[l])&&9===n[l].type&&n[l].operatorType<=1;)l++;if(g(n[l])){if(!e)return;_()}for(h=n[l],d=l-1;o<=d;d--)h=u=(0,w.rbt)(n[d].operatorType,h);u=h,o=l}else if(2===a.operatorType){if(0!==o){u=(0,w.rbt)(a.operatorType,i[i.length-1]),i[i.length-1]=u;continue}e&&_()}else if("#"===a.value){if(0!==o){if(n[o+1]&&8===n[o+1].type&&8===i[i.length-1].type){i[i.length-1].value+="#"+n[o+1].value,o++;continue}v=t.getFunction("ANCHORARRAY"),u=(0,w.YJ)(v,[i[i.length-1]]),i[i.length-1]=u;continue}e&&_()}else if("@"===a.value){if(n[o+1]&&9!==n[o+1].type){v=t.getFunction("@"),u=(0,w.YJ)(v,[n[o+1]]),!1===(m=t.source&&t.source.Lbt&&t.source.Lbt.allowDynamicArray)&&(7===n[o+1].type?u=n[o+1]:u.function=C),i[i.length]=u,o++;continue}u.type=8}i.push(u)}return i},m.prototype.eDt=function(t,n,e){for(var i,r,o,i=[],r=0,o=n.length;r<o;)r=this.resolveToken(t,n,i,r,e);return i},m.prototype.addDynamicCell=function(t){var n,e,n=t.source&&t.source.getCalcService&&t.source.getCalcService();n&&(n.tMt||(n.tMt={}),e=t.source.id+","+t.row+","+t.column,n.tMt[e]={id:t.source.id,row:t.row,col:t.column})},m.prototype.resolveToken=function(t,n,e,i,r){for(var o,a,u,s,c,f,s,l,o=n[i],a=t.getResolvers(),u=0;u<a.length;u++)if(s=a[u].resolveToken(t,this,n,i,r)){f=i-1,(c=s.expr)&&s.index!==C?i=s.index-1:c=s,o.Q9t&&(c.hDt=o.Awt),(s=0<e.length?e[e.length-1]:h)&&J(c)&&(J(s)||"#"===s.value)&&(l=n[f].ywt)<o.lp-1&&e.push((0,w.rbt)(17," ")),(15===c.operatorType||c.function&&c.function.haveDynamicListener)&&this.addDynamicCell(t),e.push(c);break}return i+1},m.prototype.resolveSubTokens=function(t,n,e,i,r){for(var o=[];e<n.length&&2!==n[e].Twt;)if(e=this.resolveToken(t,n,o,e,i),r){e--;break}return{exprs:o,index:e+1}},m.prototype.tDt=function(t){t.forEach(function(t){1===t.uit&&t.Awt!==S&&(t.Awt=t.Awt.toUpperCase())})},m.prototype.dDt=function(t,n,e){9===t.type&&18===t.operatorType&&(t.value=e||this.unparse(n,t),t.type=8,delete t.operatorType)},m.prototype.oDt=function(t,n,e,i,r,o){var a,u,u,s,c,f,l;if(t)if(Array.isArray(t))for(a=0;a<t.length;a++)this.oDt(t[a],n,e,i,r,o);else if(9===t.type&&18===t.operatorType&&(u=this.unparse(r,t),n.hasVariable(u))&&this.dDt(t,r,u),8===t.type)n.hasVariable(t.value)&&(t.type=100,t.vDt=e,t.mDt=i,t.value=n.getVariable(t.value),o||(t.value=t.value.replace(/\./g,"_")));else if(7===t.type){if(u=t.functionName,s=t.function,c=t.arguments,"LET"===u){for(n.enterScope(),f=c.length-1,a=0;a<f;a+=2){if(l=c[a],this.dDt(l,r),8!==l.type)return;this.oDt(c[a+1],n,e,i,r,o),n.setVariable(l.value,l.value),this.oDt(l,n,e,i,r,o)}this.oDt(c[f],n,e,i,r,o),n.exitScope()}else if("LAMBDA"===u){for(n.enterScope(),f=c.length-1,a=0;a<f;a++){if(8!==(l=c[a]).type)return;n.setVariable(l.value,l.value),this.oDt(l,n,e,i,r,o)}this.oDt(c[f],n,e,i,r,o),n.exitScope()}else for(a=0;a<c.length;a++)e=(0,w.getFunctionAcceptsArray)(s,a),i=(0,w.getFunctionAcceptsReference)(s,a),this.oDt(c[a],n,e,i,r,o);(0,w.isExpression)(s)&&this.oDt(s,n,e,i,r,o),u&&n.hasVariable(u)&&(t.isLocalFunctionName=!0,t.functionName=n.getVariable(u))}else 9===t.type&&(e=i=(0,w.gDt)(t.operatorType)),this.oDt(t.value,n,e,i,r,o),this.oDt(t.value2,n,e,i,r,o)},o=m,M.Parser=o,p.prototype.getExternalSource=function(t,n){for(var e,i,r,e,i=this.source.getCalcService().getAllSourceModels(),r=0;r<i.length;r++)if(T.Dbt(i[r].getSource().getName(),n))return i[r].getSource();return h},p.prototype.getExternalSourceToken=function(t){return t.getName()},p.prototype.setSource=function(t){this.source=t},p.prototype.getResolvers=function(){var t=(this.source||this.Mf).getCalcService();return t&&t.getResolvers()},p.prototype.addResolver=function(t){var n=(this.source||this.Mf).getCalcService();n&&n.addResolver(t)},p.prototype.getFunction=function(t){var n,e,i,n=t,e=(0,w.getMapping)()&&(0,w.getMapping)().builtInFunctionsMapping;if(!g(e))for(i in e)e[i].alias===t&&(n=i);return this.source&&this.source.getCustomFunction(n)||w.Functions.findGlobalFunction(t)},a=p,M.ParserContext=a,w.CalcSource.prototype.getParserContext=function(t,n,e){return new a(this,t,n,e)},n(b,s=t),b.prototype.resolveToken=function(t,n,e,i,r){var o,a,u,s,c,f,l,h,d,v,m,v,g,p,b,y,v,v,v,o=e[i],a=o.Awt,u=o.y4,f=o.uit,l=null,v=o.Twt,m=t.source&&t.source.Lbt&&t.source.Lbt.allowDynamicArray;if(0===f&&12===v){if(v=void 0,i++,(v=a&&"'"===(v=a).charAt(0)?v.substring(1,v.length-1):v)&&(l=t.getExternalSource("",v)),!(o=e[i]))return(s=new w.Expression(8)).value=a,s;a=o.Awt}if(0===f)0===o.Twt?j(h=a.toUpperCase())||V(h)?(o.Twt=5,o.Awt=h,(s=new w.Expression(4)).value=j(h)):(s=new w.Expression(8)).value=a:4===o.Twt?((s=new w.Expression(2)).value=parseFloat(a),s.originalValue=a):3===o.Twt?(s=new w.Expression(3)).value=a:5===o.Twt?(s=new w.Expression(4)).value=j(a):6===o.Twt?(s=new w.Expression(5)).value=w.CalcError.parse(a):7===o.Twt&&((s=new w.Expression(8)).value=a);else if(1===f){if(a===S){for(s=new w.Expression(6),i++,h=[[]],p=g=c=0;i<e.length&&2!==e[i].Twt;){if(o=e[i],i<e.length-1&&4===o.uit&&"-"===o.Awt&&4===e[i+1].Twt&&((o=e[++i]).y4.unshift("-"),o.Awt="-"+o.Awt),3===o.uit){if(o.Awt===x){if(g!==p)throw T.I5((0,w.sR)().Exp_InvalidArrayColumns,[o.lp]);h.push([]),c++,p=0}}else{if(0!==o.uit||4!==o.Twt&&3!==o.Twt&&5!==o.Twt&&6!==o.Twt)throw(0,w.sR)().Exp_InvalidArray;y=b=o.Awt,4===o.Twt?y=parseFloat(b):5===o.Twt?y="TRUE"===b.toUpperCase():6===o.Twt&&(y=w.CalcError.parse(b)),h[c].push(y),0===c&&g++,p++}i++}if(g!==p)throw T.I5((0,w.sR)().Exp_InvalidArrayColumns,[o.lp]);return i++,s.value=new w.CalcArray(h),{expr:s,index:i}}if(0<u.length)return"SINGLE"===a&&(v=t.source)&&v.G3&&(a="@"),"LET"!==((s=new w.Expression(7)).functionName=a)&&"LAMBDA"!==a||(t.nDt=!0),v=t.getFunction(s.functionName)||w.Functions.findGlobalFunction(s.functionName),!1===m&&v&&!0===v.isDynamicArrayFunction&&(v=C),s.function=v,(d=n.resolveSubTokens(t,e,i+1,void 0,"@"===u[0]&&m))?(s.arguments=d.exprs,{expr:s,index:d.index}):(s.arguments=[],s)}else if(4===f)s=(0,w.rbt)(M.preOperaterTypesMap[a],a);else if(6===f||5===f)v=M.operaterTypesMap[a],s=(0,w.rbt)(v="."===a?18:v,a);else if(2===f){if(s=new w.Expression(10),d=n.resolveSubTokens(t,e,i+1))return s.value=d.exprs,{expr:s,index:d.index};r&&_()}else 3===f&&((s=new w.Expression(0)).value=a);return l&&s&&(s.source=l,s={expr:s,index:i+1}),s},b.prototype.unparse=function(t,n,e,i){var r,o,a,a,u,r=this;if(6===e.type||4===e.type||2===e.type||5===e.type||3===e.type)r.pDt(t,e,i);else if(9===e.type)r.bDt(t,n,e,i);else if(10===e.type)i.push("("),n.q9t(t,e.value,i),i.push(")");else if(7===e.type)"ANCHORARRAY"!==(o=(0,w.isFunction)(e.function)&&e.function.name||e.functionName)||t.lyt?"@"!==o||t.lyt?(!e.functionName&&(0,w.isExpression)(e.function)?r.unparse(t,n,e.function,i):("@"===(o=e.isLocalFunctionName&&t.lyt?w.XLPMPrefix+o:o)&&(o="SINGLE"),B(i,(o=(a=(a=(0,w.getMapping)()&&(0,w.getMapping)().builtInFunctionsMapping)&&a[o])&&a.alias?a.alias:o).split(""))),i.push("("),r.unparseArguments(t,n,e,i),i.push(")")):(i.push("@"),n.q9t(t,e.arguments[0],i)):(n.q9t(t,e.arguments[0],i),i.push("#"));else{if(1===e.type||8===e.type)return r.unparseRefenceExpressions(t,n,e,i),!0;if(100!==e.type)return!1;B(i,(u=t.lyt?w.XLPMPrefix+e.value:e.value).split(""))}return!0},b.prototype.unparseArguments=function(t,n,e,i){for(var r=0;r<e.arguments.length;r++)0!==r&&i.push(I),n.q9t(t,e.arguments[r],i)},b.prototype.unparseSource=function(t,n,e,i){if(t.getExternalSourceToken){if(e!==w.BangSource){var e=$(t,t.getExternalSourceToken(e).split(""),i&&t.getExternalSourceToken(i).split(""));if(!(0<e.length))return!1;k.apply(n,e)}return n.push("!"),!0}return!1},b.prototype.unparseRefenceExpressions=function(t,n,e,i){if(e.source===w.BangSource)i.push("!");else if(e.source){var r;if(!this.unparseSource(t,i,e.source,e.endSource))return void i.push("#","R","E","F","!")}8===e.type&&i.push(e.value)},b.prototype.bDt=function(t,n,e,i){var r=e.operatorType;2===r?(n.q9t(t,e.value,i),i.push("%")):0===r||1===r?(i.push(M.Z9t[r]),n.q9t(t,e.value,i)):18===r?(n.q9t(t,e.value,i),i.push(M.Z9t[r]),e.value2&&e.value2.yDt?i.push(e.value2.value):n.q9t(t,e.value2,i)):(n.q9t(t,e.value,i),i.push(M.Z9t[r]),n.q9t(t,e.value2,i))},b.prototype.pDt=function(t,n,e){var i,r,o,a,u,s,c,f,l,i=(0,w.sR)().Exp_InvalidArray;if(3===n.type)e.push('"'),e.push(T.Vi(n.value,'"','""')),e.push('"');else if(2===n.type)r=n.originalValue||n.value.toString(),"."!==A&&(r=r.replace(".",A)),e.push(r);else if(4===n.type)e.push(n.value?(0,w.getBoolean)().boolean_true:(0,w.getBoolean)().boolean_false);else if(6===n.type){if(e.push("{"),(o=n.value).getRowCount()<=0)throw i;for(a=0,u=o.getRowCount();a<u;a++)for(1<=a&&e.push(x),s=0,c=o.getColumnCount();s<c;s++){if(0!==s&&e.push(N),(f=o.getValue(a,s))===C||f===h)throw i;(l=typeof f)==d?(e.push('"'),e.push(T.Vi(f,'"','""')),e.push('"')):l==v?e.push(f?(0,w.getBoolean)().boolean_true:(0,w.getBoolean)().boolean_false):"number"==l&&"."!==A?e.push(f.toString().replace(".",A)):e.push(f.toString())}e.push("}")}else 5===n.type?e.push(n.value.toString()):n.type},M.DefaultTokenResolver=b,w.ParserWrapper.wDt=function(){var t;return o.numberDecimalSeparator===C&&(new o).setParserOption(!0),o.numberDecimalSeparator},w.ParserWrapper.MDt=function(){var t;return o.numberGroupSeparator===C&&(new o).setParserOption(!0),o.numberGroupSeparator}},"./src/calc.common.ts":function(B,D,t){var L,y,F,P,G,w,U,M,H,z,V,t,F,Y,Z,W,Q,J,K,X,q,$,tt,nt,et,_,a,E,C,it,rt,S,h,ot,at,n,ut,st,T,g,s,ct,ft,lt,ht,dt,vt,mt,gt,pt,f,u,j,bt,A,yt,wt,Mt,Ct,St,Tt,At,O,It,r,xt,gt,W,Nt,kt,Dt,_t,Et,jt,n,d,Ot,Rt,Bt,Lt,Ft,Pt,Gt,Ut,I,Ht,zt,Vt,Yt,Zt,Wt,Qt,Jt,Kt,Xt,qt,$t,t,tn,nn,en;function rn(t){return t&&t.toUpperCase()}function on(t){var n,e;if(t){if(7===t.type&&("SUBTOTAL"===t.functionName||"AGGREGATE"===t.functionName))return!0;for(n=t.arguments&&t.arguments.length,e=0;e<n;e++)if(on(t.arguments[e]))return!0;if(on(t.value)||on(t.value2))return!0}return!1}function an(t,n){var e,t,e=t&&t.getCustomNameInfo&&t.getCustomNameInfo(n);return e=!e&&t?(t=t.op().getGlobalSourceModel())&&t.getSource().getCustomNameInfo(n):e}function un(t){return 15===t||16===t||17===t}function sn(t){return-1<t.indexOf(D.XLPMPrefix)?t.replace(/_xlpm\./g,""):t}function cn(t){var t=String(t&&t.message),t;return"maximum call stack size exceeded"===(t=t.toLowerCase())||"too much recursion"===t||"out of stack space"===t}function i(t,n){if(_(n)){var e=i.CDt(t);if(!e)throw(0,D.sR)().Exp_NotSupported;this._error=e.error,this._code=e.code}else this._error=t,this._code=n}function fn(){}function ln(t){return isNaN(t)||!isFinite(t)}function p(t,n){var e,i,r,o,a,u,s,c,f,l,h,d,v,m,g,p,b;if(!t)return!(n.value=0);i=typeof t;try{if(i===w)e=t;else if(i===U){if(/[\f\n\r\t\v]/.test(t))return!1;if(0===(t=(r=t).trim()).length)return!(n.value=0);if(o=St.wDt(),a=St.MDt(),"."!==o&&"."!==a&&0<=t.indexOf(".")||","!==o&&","!==a&&0<=t.indexOf(","))return!1;if(s=u=!1,c=t[0],f=t[t.length-1],"("===t[0]&&")"===f){if(s=!0,"+"===(c=(t=t.substring(1,t.length-1).trim())[0])||"-"===c)return!1;f=t[t.length-1]}if("%"===c?(u=!0,t=t.substring(1)):"%"===f?(u=!0,t=t.substring(0,t.length-1)):"$"===c&&(t=t.substring(1)),""===t)return!1;if(0<=t.indexOf(a)&&(l=C.qT("^\\ *[\\+|\\-]?\\ *\\d+(\\"+a+"\\d{3,})+(\\"+o+"\\d*)?([E|e][\\+|\\-]?\\d+)?\\ *$"),h=C.qT("^0+\\"+a),l.test(t))&&!h.test(t)&&(t=t.replace(C.qT("[ \\"+a+"]"),"")),(d=C.qT("^\\d+(\\-\\d+)+$")).test(t)&&!(v=C.qT("^(((0?[1-9]|10|11|12)-(\\d{1,2}|[2-9]\\d{3}|19\\d{2}))|((0?[1-9]|10|11|12)-((0|1|2)?[\\d]|30|31)-(\\d{1,2}|[2-9]\\d{3}|19\\d{2}))|(([2-9]\\d{3}|19\\d{2})-(0?[1-9]|10|11|12)-((0|1|2)?[\\d]|30|31)))$")).test(t))return!1;if(" "===(t=t.trim())[1]&&("+"===t[0]?t=t.replace(/^\+ +/,"+"):"-"===t[0]&&(t=t.replace(/^\- +/,"-"))),(t="."!==o?t.replace(o,"."):t).indexOf(o)!==t.lastIndexOf(o))return!1;if(2<=t.length&&"0"===t[0]&&"x"===t[1])return!1;if(e=Number(t).valueOf(),u&&(e/=100),ln(e=s?-e:e)){if(m=(t=r.trim()).charCodeAt(0),m|=32,4<t.length&&97<=m&&m<=122&&(g=(g=t[0]+t[1]+t[2]).toUpperCase(),!Ct[g]))return!1;if(c=t[0],f=t[t.length-1],"/"===c||"-"===c||":"===c||"/"===f||"-"===f)return!1;if((l=C.qT("[\\'\\$\\#\\*\\%\\!\\@\\&\\(\\)\\=\\;\\\"\\<\\>\\?\\,\\z\\Z]")).test(t))return!1;if((l=C.qT("^\\d+\\s+\\d+$")).test(t))return!1;if((b=(p=y.Common.CultureManager.getCultureInfo())&&p.DateTimeFormat&&p.DateTimeFormat.shortDatePattern)&&b.indexOf("d")<b.indexOf("M")?e=y.Common.ct.yU(t):ln((e=new Date(t+" 00:00:00")).valueOf())&&(e=new Date(t)),ln(e.valueOf()))return!1;e=S.o0(e)}}else if(i===M)e=t?1:0;else{if(!(t instanceof Date))return!1;e=S.o0(t)}}catch(t){return!1}return n.value=e,!0}function hn(t){var n={value:0};if(p(t,n))return n.value;throw(0,D.sR)().Exp_InvalidCast}function dn(t,n){return n&&(t===T||t===g||typeof t===U&&""===t.trim())}function vn(t,n){try{if(t){if(typeof t!==M)if(t instanceof Date)t=0!==S.o0(t);else{if(!gn(t))return!1;t=0!==t}}else t=!1}catch(t){return!1}return n.value=t,!0}function mn(t,n,e,i,r){var o,a,u;if(!b(t)){if(o={value:T},a=pt,0!==n&&dn(t,i))return a;switch(n){case 1:case 5:if(e&&5!==n){if(typeof t===M&&r)return a;t=p(t,o)?o.value:a}else typeof t!==w&&(t=t instanceof Date?S.o0(t):a);break;case 11:t=p(t,o)?o.value:a;break;case 4:typeof t===U?t=(u=y.Common.ct.yU(t))!==g&&u!==T?S.o0(u):a:e?t=p(t,o)?o.value:a:typeof t===w||t instanceof Date||(t=a);break;case 3:e?t=p(t,o)?o.value:a:typeof t!==M&&(t=a);break;case 2:t=t===T||t===g?"":t.toString()}}return t}function l(t,n){this.array=t,this.referenceInTwoDimension=n}function gn(t,n){var e=typeof t;return e===w||e===V&&t instanceof Date||!n&&(e===M||!isNaN(t)&&!isNaN(parseFloat(t))&&!nt.Nh(t))}function b(t){return t instanceof f}function pn(t){return t instanceof Tt}function bn(t){return t instanceof xt}function x(){}function yn(t){this.type=t}function c(t,n){var e=this;e.rT=t,n?(e.$gt=n,e.SDt=n.length):e.SDt=1}function e(t){this.id=e.sourceId,e.sourceId++,this.Lbt=t,this.Mbt=null}function wn(t,n,e){var i=new r(5);return n&&(i.source=n),e&&(i.endSource=e),i.value=t,i}function Mn(t,n){var e=new r(7);return e.arguments=n,t instanceof r?(e.function=t.function,e.functionName=t.functionName):(e.function=t.name&&t,e.functionName=t.name||t),e}function Cn(t,n){var e=new r(7);return e.arguments=n,e.function=t,e}function Sn(t,n){var e=new r(12);return e.value=t,e.needExpendIndexs=n,e}function Tn(t,n,e){var i=new r(9);return i.operatorType=t,i.value=n,18===t&&e&&e.hDt&&((e=In(e.hDt)).yDt=!0),i.value2=e,i}function An(t){var n=new r(10);return n.value=t,n}function In(t){var n=new r(3);return n.value=t,n}function xn(t){var n=new r(2);return n.value=t,n}function Nn(t){var n=new r(4);return n.value=t,n}function kn(){}function v(t,n){return t.charAt(n)}function Dn(t,n){for(var e=t.length,i=!1;n<e&&!isNaN(+v(t,n));)n++,i=!0;for(n<e&&"."===v(t,n)&&n++;n<e&&!isNaN(+v(t,n));)n++,i=!0;if(n<e&&("E"===v(t,n)||"e"===v(t,n)))for(i=!1,++n<e&&("+"===v(t,n)||"-"===v(t,n))&&n++;n<e&&!isNaN(+v(t,n));)n++,i=!0;return{TDt:i,lp:n}}function _n(t){return"string"==typeof t}function En(t){this.ADt=t}function jn(t,n){if(!t||8===t.type&&0<=t.value.indexOf("'"))throw(0,D.sR)().Exp_FormulaInvalid}function o(){this.context=[{}],this.closure={},this.backupClosure=[]}function m(t,n,e,i){void 0===n&&(n=0),void 0===e&&(e=0),this.name=t,this.minArgs=n,this.maxArgs=e;var t=this;t.IDt=i,t.typeName=""}function N(t,n,e,i){return tn.call(this,t,n,e,i)||this}function On(t,n){var e,t,i,t,e=this,t=t.arguments,i=t.slice(0,t.length-1),t=t[t.length-1];return(e=nn.call(this,"LAMBDA",i.length,i.length)||this).parameters=i,e.calculation=t,e.closure=n,e}function Rn(t,n){return n.name=rn(n.name),d.Tmt[rn(t)]=n}function Bn(t){var n,e,i;return t?(t=rn(t),n=d.Mmt,e=d.Tmt,i=(0,D.getMapping)()&&(0,D.getMapping)().builtInFunctionsMapping,n&&(Gn(i,t)||n[t])||e&&e[t]):Pn()}function Ln(){return Pn()}function Fn(t){var n,e;t?(t=rn(t),n=d.Mmt,e=d.Tmt,n[t]?delete n[t]:e[t]&&delete e[t]):(d.Mmt={},d.Tmt={})}function Pn(){var t,n,e,i,r,t=d.Mmt,n=d.Tmt,e=[];for(i in t)e.push(t[i]);for(r in n)e.push(n[r]);return e}function Gn(t,n){var e,i,e=d.Mmt;if(!_(t))for(i in t)if(t[i].alias===n)return e[i];return g}function Un(t,n,e){this.okt=t,this.akt=n,this.mit=e||"i"}function Hn(t){function n(t){var n,e,i,r,o,a,u,s,c,f,l,n=0,e=0,i=!1,u=0,s=0,c=0,f=t.length;if(!t)throw(0,D.sR)().Exp_ArgumentNull;if(0===f)throw Ft;if(c<f&&("+"===v(t,c)||"-"===v(t,c))&&c++,c=(l=Dn(t,c)).lp,r=l.TDt,c<f&&("+"===v(t,c)||"-"===v(t,c))?(u=c,c=(l=Dn(t,++c)).lp,o=l.TDt,c<f&&("i"===v(t,c)||"j"===v(t,c))&&(a=v(t,c),c++,i=!0),s=c-u):c<f&&("i"===v(t,c)||"j"===v(t,c))?(a=v(t,c),s=++c,o=r,r=!(i=!0)):u=c,c<f)throw Ft;if(0<u){if(!r)throw Ft;n=parseInt(t.substr(0,u),10)}if(0<s){if(!i)throw Ft;if(1===s||2===s&&"+"===v(t,u))e=1;else if(2===s&&"-"===v(t,u))e=-1;else{if(!o)throw Ft;e=parseInt(t.substr(u,s-1),10)}}return new Pt(n,e,a)}try{return t?"number"==typeof t?new Pt(t,0):"string"==typeof t?n(t):null:new Pt(0,0)}catch(t){return null}}function zn(t,n,r){var i,o,e;if(_(t))throw(0,D.sR)().Exp_InvalidFunctionName;if(t=t.toUpperCase(),d.Mmt[t])throw(0,D.sR)().Exp_InvalidOverrideFunction;if(i=d.Mmt[t]){if(!r||!r.override)throw(0,D.sR)().Exp_OverrideNotAllowed}else d.Mmt[t]=i=new Rt(t,0,255);return n&&"function"==typeof n&&(i.evaluate=n),"function"==typeof r.argsValidator&&(o=i.aDt,i.aDt=function(t,n,e,i){o(t,n,e,i),r.argsValidator(t,n,e,i)}),"function"==typeof r.subExpressionValidator&&(e=i.uDt,i.uDt=function(t,n){e(t,n),r.subExpressionValidator(t,n)}),nt.y0(r,function(t,n){var e;0<=a(t,["acceptsReference","acceptsArray","acceptsError","acceptsMissingArgument","skipPrecedent"])?(e=new Nt(n),i[t]=function(t){return e.xDt(t)}):0<=a(t,["isVolatile","isBranch","findTestArgument","returnReference","isContextSensitive","expandColumns","expandRows"])?(e=new Nt(n),i[t]=function(){return e.NDt()}):r.hasOwnProperty(t)&&(i[t]=n)}),i}function Vn(t,n,e,i,r,o,a,u,s){return u=u||{},e!==g&&(u.minArgs=e),i!==g&&(u.maxArgs=i),o!==g&&(u.acceptsReference=o),a!==g&&(u.acceptsArray=a),r!==g&&(u.R9t=r),u.wkt!==g&&(u.acceptsMissingArgument=u.wkt),u.V9t!==g&&(u.isVolatile=u.V9t),u.r9t!==g&&(u.isContextSensitive=u.r9t),u.a9t!==g&&(u.haveDynamicListener=u.a9t),u.e9t!==g&&(u.skipPrecedent=u.e9t),u.o9t!==g&&(u.arrayArgumentEvaluateMode=u.o9t),u.f9t!==g&&(u.acceptsError=u.f9t),s!==g&&(u.isDynamicArrayFunction=s),zn(t,n,u)}function Yn(t){return"boolean"==typeof t}function Zn(t){return"number"==typeof t}function Wn(t){return t%400==0||t%4==0&&t%100!=0||1900===t}function Qn(t,n){switch(n){case 0:case 2:case 4:return 360;case 1:return Wt(t.getFullYear())?366:365;case 3:return 365;default:return-1}}function Jn(t,n){return t-n}function Kn(t,n){return 0<=a(n,[0,2,4,6,7,9,11])?31:0<=a(n,[3,5,8,10])?30:1===n?Wt(t)?29:28:void 0}function Xn(t,n,e,i){var r,o,e,a,u,i,t,s,r=e.getFullYear(),o=e.getMonth(),e=e.getDate(),a=i.getFullYear(),u=i.getMonth(),i=i.getDate();return t?(t=1===o&&Qt(r,o)===e,s=1===u&&Qt(a,u)===i,n?(t&&(e=30),s&&(i=30)):(t&&s&&(i=30),t&&(e=30)),31===i&&30<=e&&(i=30)):31===i&&(n?(i=1,u++):i=30),360*(a-r)+30*(u-o)+i-(e=31===e?30:e)}function qn(t,n,e){var i,r,o,i=1;return 0<t-n&&(o=t,t=n,n=o,i=-1),r=0<=a(e,[1,2,3])?i*Ut(h(n)-h(t)):0<=a(e,[4,5])?i*Xn(!1,5===e,t,n):i*Xn(!0,6===e,t,n)}function $n(t){var n,n,e,n=0===t?0:3<=(e=.5*s(t))?1:e<1?((((((((.000124818987*(n=e*e)-.001075204047)*n+.005198775019)*n-.019198292004)*n+.059054035642)*n-.151968751364)*n+.319152932694)*n-.5319230073)*n+.797884560593)*e*2:(((((((((((((-45255659e-12*(e-=2)+.00015252929)*e-19538132e-12)*e-.000676904986)*e+.001390604284)*e-.00079462082)*e-.002034254874)*e+.006549791214)*e-.010557625006)*e+.011630447319)*e-.009279453341)*e+.005353579108)*e-.002141268741)*e+.000535310849)*e+.999936657524;return 0<t?.5*(n+1):.5*(1-n)}function te(t,n,e,i,r){for(var o,a,u,s,c,f,l,h,d,v,m,g,p,b,y,w,M,C,S,T,A,I,x,N,k,o=e<100,a=2===e||102===e,u=a||3===e||103===e,s=5===e||105===e,c=4===e||104===e||s,f=9===e||109===e,l=1===e||101===e||f||i,h=6===e||106===e,d=h?1:0,v=!1,m=0,g=0;g<E(t);g++){if(A=t[g],I=void 0,(I=u?zt(A,0,!1,!1,!1,a):(x=1,D.ExcelCompatibleCalcMode&&!pn(A)&&!bn(A)||(x=5),zt(A,x,!1,!1,!1,!0))).isError)return I[0];if(I.isConvertError)return j;for(N=I.rangeCount,k=I.isReference,p=0;p<N;p++)for(b=1<N?I[p]:I,k&&(y=A.getRow(p),w=A.getColumn(p)),M=0;M<E(b);M++)if(2===n||!k||!A.isHiddenRow(p,M,o))for(S=b[M],C=0;C<E(S);C++)if(!(1!==n&&2!==n&&k&&A.isSubtotal(p,M+y,C+w)||null===(T=S[C])||T===pt)){if(T&&T._error&&!u)return r&&(r.sumx=0,r.sumx2=0,r.n=0),T;u&&!_(T)&&(!a||""!==T&&O.q8(T,!0))?d++:c&&(!v||s&&T<d||!s&&d<T)?d=T:l?i?(r.sumx+=T,r.sumx2+=T*T,r.n++,r.values.push(T),r.values[0]!==T&&(r.allSame=!1)):(d+=T,m++):h&&(d*=T,m++),v=!0}}return l?f?d:i?void 0:0===m?yt:Vt(d/m):h?Vt(0<m?d:0):d}function ne(t,n,e){var i,r,i,o,a,u,s,i=e%100,r=7==i||8==i,i=7==i||10==i?1:0,o={sumx:0,sumx2:0,n:0,values:[],allSame:!1},a=te(t,n,e,!0,o);if(a&&a._error)return a;if(o.n<=i)return yt;if(o.allSame)a=0;else if(Zt(o.n*o.sumx2,o.sumx*o.sumx))for(u=o.sumx/o.n,s=a=0;s<o.n;s++)a+=lt(o.values[s]-u,2);else a=o.sumx2-o.sumx*o.sumx/o.n;return a/=o.n-i,Vt(r?Math.sqrt(a):a)}function ee(t,n,d,a){var v,m,g,p,b,n,e,i,r,o,u,s,c,f,l,h,f,y,w,M;if(null===d)return j;if((d=parseInt(d,10))<=0||19<d)return j;function C(t){var n,e,i,r,o,a,u,s,c,f,l,h,n=[],e=zt(t,b?0:5,!1,!1,!1,!1);if(e.isConvertError)return j;for(l=e.rangeCount,h=e.isReference,i=0;i<l;i++)for(r=1<l?e[i]:e,h&&(o=t.getRow(i),a=t.getColumn(i)),u=0;u<E(r);u++)if(!(h&&t.isHiddenRow(i,u,!1)&&v))for(c=r[u],s=0;s<E(c);s++)if(!(h&&m&&t.isSubtotal(i,u+o,s+a)||null===(f=c[s])||g&&Yt(f)||Yt(f)&&p)){if(!g&&Yt(f)&&3!==d)return f;typeof f===V&&0===Object.keys(f).length||n.push(f)}return n}function S(t){var n,e,i,r,o,n=t.getRow(0),e=t.getColumn(0),i=t.getRowCount(0),r=t.getColumnCount(0);if(1===i&&1===r)o=t.getValue(0,0,0);else if(1!==i&&1===r&&n<=a.row&&a.row<n+i)o=t.getValue(0,a.row-n,0);else{if(!(1===i&&1!==r&&e<=a.column&&a.column<e+r))return j;o=t.getValue(0,0,a.column-e)}return o===T||""===o?A:isNaN(parseInt(o,10))?j:parseFloat(o)}if(v=1===(n=n||0)||3===n||5===n||7===n,m=1===n||2===n||3===n||0===n,g=2===n||3===n||6===n||7===n,b=(p=2===d)||3===d,n=12===d,e=13===d,f=(i=14===d)||(r=15===d)||(o=16===d)||(u=17===d)||(s=18===d)||(c=19===d),l=[],h=E(t),f){if(2!==h)return j;if((l=C(t[0]))._error)return l;if(f=void 0,t[1]===T)return A;if(t[1]instanceof xt)f=S(t[1]);else if(t[1]instanceof Tt)f=t[1].array[0][0];else{if(isNaN(parseInt(t[1],10)))return j;f=I(t[1])}return f._error?f:be([l,f=17!==d&&19!==d?f:Ut(f)],d)}for(y=0;y<h;y++)if(!(t[y]instanceof xt))return j;for(y=0;y<h;y++){if(!((w=C(t[y]))instanceof Array))return w;l.push.apply(l,w)}return n||e?be([l],d):7===d||8===d||10===d||11===d?ne(l,M=m?1:0,d):te(l,1,d)}function ie(t){var t=t.charCodeAt(0);return 0<=t&&t<129||63728===t||65377<=t&&t<65440||63729<=t&&t<63732?"singleByte":55296<=t&&t<=57343?"fourByte":"doubleByte"}function re(t){for(var n,e,n=[],e=0;e<t.length;e++)_(t[e])?(n[e]=t[e+1],e++):n[e]=t[e];return n.length===t.length-1&&(n[n.length]=g),n}function oe(t){for(var n,e,i,r,o,a,u,n=[],i=0,o=0,r=0;r<t.length;r++){if(e=t[r],"doubleByte"===(a=ie(t[r]))||"fourByte"===a)if("fourByte"===a){if(i%2==0){i++;continue}o++,i++,e=t[r-1]+t[r]}else o++,e=t[r];n[r-(u=0<i?i/2:0)+o]=e}return re(n)}function ae(t,n){var e,i;for(void 0===n&&(n=!0),e=[],i=0;i<E(t);i++)se(t[i],e,n);return e}function ue(t){t.sort(function(t,n){return t-n})}function se(t,n,e){var i,r;for(void 0===e&&(e=!0),i=0;i<E(t);i++)(r=t[i])!==pt&&n.push(r);e&&ue(n)}function ce(t){for(var n,e,t,i,n=[],e=0;e<arguments.length;e++)n[e]=arguments[e];return t=ae(t),0===(i=E(t))?A:i%2==0?(I(t[i/2-1])+I(t[i/2]))/2:t[it((i/2).toString())]}function fe(t){for(var n,e,i,r,o,a,u,s,c,n=[],e=0;e<arguments.length;e++)n[e]=arguments[e];for(i=T,r=0,o=ae(t,!1),a=E(o),u=0;u<a;u++){for(s=c=0;s<a;s++)s!==u&&o[s]===o[u]&&c++;r<c&&(r=c,i=o[u])}return 0===r?wt:i}function le(t,n){return de(!0,t,n)}function he(t,n){return de(!1,t,n)}function de(t,n,e){var i,n,i=[];return se(n,i),n=E(i),e<1||n<e?A:(e=(t?dt:ht)(e),t?i[n-e]:i[e-1])}function ve(t,n){var t,n,e;return t=zt(t,1,!0,!0,!1,!0),n=I(n),t.isError?t[0]:t.isConvertError||rt(n)?j:(se(t,t=[]),!E(t)||n<0||1<n?A:(e=(n=n*(E(t)-1))%1,n=it(n.toString()),0==e?t[n]:I(t[n])+e*(I(t[n+1])-I(t[n]))))}function me(t,n){var n=a(n,[0,1,2,3,4]);return n<0?A:ve(t,.25*n)}function ge(t,n){for(var e,i,r,o,n,a,o,n,e=E(t),i=[],r=0;r<e;r++)Ht(t[r],!0)&&i.push(t[r]);return!i.length||(o=i.length,ue(i),a=(n=n*(o+1)-1)%1,n<0)||o-1<n?A:(n=i[o=ht(n)],0==a?n:n+a*(i[o+1]-n))}function pe(t,n){var n=a(n,[1,2,3]);return n<0?A:ge(t,.25*(n+1))}function be(t,n){var e,i,r,o,a,u,s,c,e,i=13===n,r=14===n,o=15===n,a=16===n,u=17===n,s=18===n,c=19===n;return 12===n?ce(t):i?fe(t):r?le(t[0],t[1]):o?he(t[0],t[1]):a?ve(t[0],t[1]):u?me(t[0],t[1]):s?ge(t[0],t[1]):c?pe(t[0],t[1]):Mt}function ye(t){for(var n=1,e,e=t;1<e;e--)n*=e;return n}function we(t,n,e){var i=t.getDate(),r=n.getDate(),o=t.getMonth(),a=n.getMonth(),t=t.getFullYear(),n=n.getFullYear(),i=31===i?30:i;return e?r=31===r?30:r:31===r&&(i<30?(r=1,12<++a&&(a=1,n++)):r=30),30*(12*(n-t)+a-o)+r-i}function Me(t,n,e){var i,r,o,o,i,a,u,s,c,f,i=qn(t,n,e);return i<0&&(i=-i,o=t,t=n,n=o),i/(r=1===e?(o=t.getFullYear(),i=n.getFullYear(),c=s=u=a=void 0,(a=new Date(t.valueOf())).setFullYear(a.getFullYear()+1),s=0<n-a?(c=i+1-o,a=new Date(o,0,1),u=new Date(i+1,0,1),Ut(h(u)-h(a))-365*(i+1-o)):(c=1,Wt(o)&&t.getMonth()<$||Wt(i)&&256*n.getMonth()+n.getDate()>=256*q+29?1:0),365+(f=I(s)/I(c))):Qn(new Date,e))}function Ce(t,n,e){return e<0||4<e?A:Me(t,n,e)}function Se(t,n,e){var i;return 0===t?i=n<=e:1===t?i=e<=n:2===t?i=n!==e:3===t?i=n<e:4===t?i=n===e:5===t&&(i=e<n),i}function Te(r,o){var a,u,t,s,c,n,n,a=-1,u=!0,t={value:0},s=C.tbt(o);return 4!==r&&2!==r||!s||((n=o.replace(/\*+/g,"*"))!==o&&(s=C.tbt(n)),c=function(t){var n;return""===t?2===r:((n=C.OJ(s)).lastIndex=0,4===r?n.test(t):!n.test(t))}),4===r&&y.Common.ut(o,Date)?function(t,n){var e={value:null};return!(!t||!O.kDt(t,e))&&e.value.getTime()===o.getTime()}:(_n(o)&&(n=f.parse(o))&&(o=n),_(o)?a=0:s||e(o)||rt(parseFloat(o))||!Gt(o,t)?u=!1:a=t.value,function(t,n,e){var i,e;return(""!==o||4===r||2===r)&&(e&&(Yt(t)||Yt(o))?!Yt(t)||!Yt(o)||t._code!==o._code?2===r:0===r||1===r||4===r:!(!n&&t instanceof f||(_(t)&&(t=""),i={value:0},D.ExcelCompatibleCalcMode&&u&&!Ht(t,!0)&&4!==r&&2!==r))&&(D.ExcelCompatibleCalcMode&&u&&"boolean"==typeof t?2===r:u&&Gt(t,i)?""===t||t.trim&&""===t.trim()?2===r:Se(r,i.value,a):s&&Ht(t,!0)?2===r:(e=_(o)?"":o.toString().toUpperCase(),s&&c?c(t.toString()):Se(r,t.toString().toUpperCase(),e))))});function e(t){return 0===t.toString().trim().length}}function Ae(n,t,e,i){var r,o,a;if(this.criteria=n,"function"==typeof t&&(r=t,t=null),e&&(e.Zbt=!0),t=t||zt(e,0,2,!1,!1),r){for(o=[],a=0;a<E(t);a++)o[a]=r(t[a]);t=o}this.array=t,n!==T&&"function"!=typeof n&&(i&&t.DDt?this.useMap=!0:this.criteria=function(t){return t===n})}function k(){this.referenceCache={}}function R(){}function Ie(n,e,i){var r,t;try{r=(t=y.Common.CultureManager.getCultureInfo()).localeCompare?i?t.localeCompare(n,e):t.localeCompare(n.toLowerCase(),e.toLowerCase()):i?_t(n,e):_t(n.toLowerCase(),e.toLowerCase())}catch(t){r=i?_t(n,e):_t(n.toLowerCase(),e.toLowerCase())}return r}function xe(t,n,e){var i,r,o,a,u,o,r,r,s,o;if(void 0===e&&(e=!0),b(t))return t;if(b(n))return n;if(o=typeof n===M,(r=typeof t===M)||o)i=r&&o?t===n?0:n<t?1:-1:r?1:-1;else{if(u=typeof n===U,r=(o=(a=typeof t===U)||u)?"":0,t=t===T||t===g?r:t,n=n===T||n===g?r:n,r=function(){return t===n?0:a&&u?Ie(t,n,e):a?1:u?-1:(t=at.E8(t,15),n=at.E8(n,15),t-n)},!o){if(o={value:0},!p(t,s={value:0})||!p(n,o))return j;t=s.value,n=o.value}i=r()}return i}function Ne(t){return t instanceof Dt.Function}function ke(t){return t instanceof Dt.LambdaFunction}function De(t){return t instanceof r}function _e(t,n){return!Ne(t)||t.acceptsArray(n)}function Ee(t,n){return!Ne(t)||t.acceptsReference(n)}function je(t){return t&&t.arrayArgumentEvaluateMode}function Oe(t){var n=en.call(this,T)||this;return n.oyt=t,n}function Re(t,n){return{row:t,col:n}}L=this&&this.__extends||(jt=function(t,n){return(jt=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(t,n){t.__proto__=n}:function(t,n){for(var e in n)Object.prototype.hasOwnProperty.call(n,e)&&(t[e]=n[e])}))(t,n)},function(t,n){if("function"!=typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function e(){this.constructor=t}jt(t,n),t.prototype=null===n?Object.create(n):(e.prototype=n.prototype,new e)}),Object.defineProperty(D,"__esModule",{value:!0}),D.RefErrorSource=D.BangSource=D.ErrorList=D.Functions=D.ErrorSource=D.getFunctionArrayArgumentEvaluateMode=D.getFunctionAcceptsReference=D.getFunctionAcceptsArray=D.isExpression=D.isLambdaFunction=D.isFunction=D.$kt=D.Wkt=D.LocalScopes=D.sDt=D.charAtFunc=D.skt=D.createBooleanExpression=D.createNumberExpression=D.createStringExpression=D.Ayt=D.rbt=D.createExpandExpression=D.lDt=D.YJ=D.kyt=D.Syt=D.CalcSource=D.CalcReference=D.Expression=D.ExpressionType=D.Convert=D.CalcArray=D.ParserWrapper=D.CalcError=D.usedbcs=D.getBoolean=D.getMapping=D.sR=D.isStackOverflowError=D.K9t=D.gDt=D.W9t=D.MAX_COLUMN_COUNT=D.MAX_ROW_COUNT=D.BAND_INDEX_CONST=D.XLPMPrefix=D.ErrorCodeList=D.SR=D.ExcelCompatibleCalcMode=void 0,D._9t=D.missingArgument=D.Errors=void 0,y=t("Common"),F=t("./src/calcEngine.res.en.ts"),P=t("./src/text_Filter/text_Filter.ts"),Object.defineProperty(D,"_9t",{enumerable:!0,get:function(){return P._9t}}),G=t("./src/map.ts"),D.ExcelCompatibleCalcMode=!1,D.SR={en:F.resource},D.ErrorCodeList=[0,7,15,23,29,42,36,99,100],D.XLPMPrefix="_xlpm.",w="number",U="string",M="boolean",H="TRUE",z="FALSE",V="object",q=1,$=2,D.ErrorList=tt=[t="#NULL!",F="#DIV/0!",Y="#VALUE!",Z="#REF!",W="#NAME?",Q="#N/A",J="#NUM!",K="#SPILL!",X="#CALC!"],D.BAND_INDEX_CONST=-2147483648,D.MAX_ROW_COUNT=1048576,D.MAX_COLUMN_COUNT=16384,nt=y.Common.lt,et=nt.Nh,_=nt.ht,a=nt.Rh,E=y.Common.Uf.tR,C=y.Common.$T,it=parseInt,rt=isNaN,S=y.Common.ct,h=S.o0,ot=y.Common.zf,at=y.Common.st,D.W9t=an,D.gDt=un,D.K9t=sn,D.isStackOverflowError=cn,n=new y.Common.ResourceManager(D.SR,"CalcEngine"),D.sR=n.getResource.bind(n),D.getMapping=ut=function(){return Dt&&Dt.resourceMapping},D.getBoolean=st=function(){var t=(0,D.getMapping)()&&(0,D.getMapping)().booleanMapping;return{boolean_true:t&&t.boolean_true||H,boolean_false:t&&t.boolean_false||z}},T=null,g=void 0,s=Math.abs,ct=Math.exp,ft=Math.log,lt=Math.pow,ht=Math.floor,dt=Math.ceil,D.BangSource=vt={},D.RefErrorSource=mt={},D.missingArgument=gt,pt={},i.prototype.toString=function(){var t,n,t=(0,D.getMapping)()&&(0,D.getMapping)().clacErrorMapping,n;return t&&t[this._error]||this._error},i.prototype.clone=function(){return new i(this._error)},i.prototype.toJSON=function(){return{_calcError:this._error,_code:this._code}},i.parse=function(t){try{return new i(t)}catch(t){return g}},i.ibt=function(t){for(var n=0;n<D.ErrorCodeList.length;n++)if(t===D.ErrorCodeList[n])return new i(tt[n],t);return g},i.CDt=function(t){var n,e;if(t)for(n=0;n<tt.length;n++)if((e=tt[n])===t||e===rn(t))return{error:e,code:D.ErrorCodeList[n]};return g},f=i,D.CalcError=f,u={Name:new f(W),Null:new f(t),DivideByZero:new f(F),NotAvailable:new f(Q),Value:new f(Y),Reference:new f(Z),Number:new f(J),Spill:new f(K),Calc:new f(X)},D.Errors=u,j=u.Value,bt=u.Reference,A=u.Number,yt=u.DivideByZero,wt=u.NotAvailable,Mt=u.Null,Ct={JAN:1,FEB:2,MAR:3,APR:4,MAY:5,JUN:6,JUL:7,AUG:8,SEP:9,OCT:10,NOV:11,DEC:12},St=fn,D.ParserWrapper=St,l.prototype.getRowCount=function(){return this.array.length},l.prototype.getColumnCount=function(){var t=this.array[0];return t&&t.length||0},l.prototype.getValue=function(t,n){var e,i,r,e=this.array,i=t;return"number"!=typeof n&&(i=t.row,n=t.column),i<0||n<0||i>=e.length||n>=e[0].length?j:this.array[i][n]},l.prototype.getValueByIndex=function(t){var n=this.getColumnCount(),e=ht(t/n),i;return this.getValue(e,t%n)},l.prototype._Dt=function(){var t,n,e,i,r,o,t=this,n=0,e=0;if(n=t.getRowCount())for(e=t.getColumnCount(),i=0;i<n;i++)for(r=0;r<e;r++)bn(o=this.array[i][r])&&(this.array[i][r]=o.getValueByIndex(0))},l.prototype.toArray=function(t,n,e,i,r,o,a){var u,s,c,f,l,h,d,v,m;if(void 0===n&&(n=!0),c=s=0,f=[],d=pt,s=(u=this).getRowCount())for(c=u.getColumnCount(),v=0;v<s;v++)for(n||f.push(h=[]),m=0;m<c;m++){if(l=u.getValue(v,m),u.referenceInTwoDimension&&bn(l)&&(l=l.getValueByIndex(0)),e&&b(l))return(f=[l]).isError=!0,f;if(l=mn(l,t,!1,o),i&&l===d)return(f=[l]).isConvertError=!0,f;(n?f:h).push(l)}return f.rowCount=s,f.colCount=c,f.rangeCount=1,f},l.prototype.slice=function(t,n,e,i){var r,o,a,u,s,c,r=this,o=r.array,a=[];for(n=n<0?0:n,e=(t=t<0?0:t)+e>r.getRowCount()?r.getRowCount()-t:e,i=n+i>r.getColumnCount()?r.getColumnCount()-n:i,s=0;s<e;s++)for(a.push(u=[]),c=0;c<i;c++)u.push(o[s+t][c+n]);return new l(a)},Tt=l,D.CalcArray=Tt,At=["o","n","s","b","d"],x.Sft=function(t){return b(t)&&t._code===D.ErrorCodeList[5]},x.L6t=function(t){return isNaN(t)||!isFinite(t)?A:t},x.iV=function(t,n,e,i,r,o,a,u){var s,c,f;if(t&&t.length&&t.rowCount&&t.colCount)return t;if(pn(t))(s=t.toArray(n,e,i,r,o)).isArray=!0;else if(bn(t))(s=t.toArray(n,e,i,r,o,a,u)).isReference=!0;else{if(et(t)){if(s=[],0===t.length)return s;if(et(t[0]))return x.EDt(t,n,!0);for(c=0;c<t.length;c++)(f=mn(t[c],n,!1))===x.CalcConvertedError&&(s.isConvertError=!0),s.push(f);s.rowCount=1,s.colCount=t.length}else t=mn(t,n,!0,o),i&&x.BJ(t)?(s=[j]).isError=!0:t===x.CalcConvertedError?(s=[x.CalcConvertedError]).isConvertError=!0:(e?s=[]:(s=[[]])[0]).push(t),s.rowCount=1,s.colCount=1;s.rangeCount=1}return s},x.EDt=function(t,n,e){var i,r,o,a,u,s,c,f,l,h,d,v,m;if(!t||!t.length||!t[0].length)return(i=[]).isError=!0,[[j]];if(0===n)return t;if(o=t.length,a=t[0].length,h=l=!(f={value:T}),d=x.CalcConvertedError,!(i=t[r=At[n]]))for(t[r]=i=[],v=0;v<o;v++)for(u=t[v],s=i[v]=[],m=0;m<a;m++){if(b(c=u[m])){l=l||(i.isError=!0)}else{switch(n){case 1:case 5:e&&5!==n?c=p(c,f)?f.value:(h||(i.isConvertError=h=!0),0):typeof c===w||c instanceof Date||(h||(i.isConvertError=h=!0),c=d);break;case 3:e?c=vn(c,f)?f.value:(h||(i.isConvertError=h=!0),!1):typeof c!==M&&(h||(i.isConvertError=h=!0),c=d);break;case 2:c=c===T||c===g?"":c.toString()}}s.push(c)}return i},x.z6t=function(t){var t=hn(t);if(s(t)<1e21)return parseInt(t.toString(),10);throw(0,D.sR)().Exp_InvalidCast},x.t9t=function(t,n){var e;return""!==t&&!!p(t,n)&&s(n.value)<1e21&&(n.value=parseInt(n.value.toString(),10),!0)},x.U6t=function(t){if(!t)return!1;if(typeof t===M)return t;if(t instanceof Date)return 0!==S.o0(t);if(x.q8(t))return 0!==t;if(x.BJ(t))return!1;throw(0,D.sR)().Exp_InvalidCast},x.j=function(t){var n,e,i,r,o,a;try{if(t===g||t===T)return"";if(typeof t===M)return t?H:z;if(typeof t===U)return t;if(t instanceof Date)return S.o0(t).toString();if(pn(t))throw(0,D.sR)().Exp_InvalidCast;if(typeof t!==w)return t.toString();if(n="",t<0&&(n="-",t=-t),-1!==(r=(i=-1===(i=(e=at.E8(t,Dt.CALC_PRECISION||15)).toString()).indexOf("e")&&20<i.length?e.toExponential():i).indexOf("e-"))){if(o=+i.substring(r+2),(a=-1===i.indexOf(".")?1:r-1)+o<20)return n+t.toFixed(a+o-1);o<10&&(i=i.replace("e-","e-0"))}return n+i.toUpperCase()}catch(t){throw(0,D.sR)().Exp_InvalidCast}},x.r0=function(t){var n={value:T};if(x.kDt(t,n))return n.value;throw(0,D.sR)().Exp_InvalidCast},x.kDt=function(t,n){var e,i,r,o;if(t)if(!0===t)n.value=y.Common.ct.Y0(1);else if(t instanceof Date)n.value=new Date(t.valueOf());else if(typeof t===U){if(!(e=y.Common.ct.yU(t)))if(isNaN(t)){if(e=new Date(t),isNaN(e.valueOf()))return!1;try{if(i=/^[-+=\s]*(\d+)\W+(\d+)\W+(\d+)$/,r=ot.s6t(ot.cJ(t.replace(/ |\n/g,"")," ")," "),(o=i.exec(r))&&4===o.length&&(-1===o.indexOf(e.getFullYear().toString())||-1===o.indexOf(e.getMonth().toString())||-1===o.indexOf(e.getDate().toString())))return!1}catch(t){return!1}}else if(!(e=y.Common.ct.Y0(parseFloat(t))))return!1;n.value=e}else{if(typeof t!==w)return!1;n.value=y.Common.ct.Y0(t)}else n.value=y.Common.ct.Y0(0);return!0},x.CalcConvertedError=pt,x.Nh=pn,x.q8=gn,x.BJ=b,x.LE=bn,x.Nbt=mn,x.Ybt=dn,x.jDt=ln,x.uJ=hn,x.sJ=p,x.YK=vn,O=x,D.Convert=O,(n=It=D.ExpressionType||(D.ExpressionType={}))[n.unknow=0]="unknow",n[n.reference=1]="reference",n[n.number=2]="number",n[n.string=3]="string",n[n.boolean=4]="boolean",n[n.error=5]="error",n[n.array=6]="array",n[n.function=7]="function",n[n.name=8]="name",n[n.operator=9]="operator",n[n.parentheses=10]="parentheses",n[n.missingArgument=11]="missingArgument",n[n.expand=12]="expand",n[n.structReference=13]="structReference",n[n.field=14]="field",n[n.fieldItem=15]="fieldItem",n[n.tableSheetReference=22]="tableSheetReference",n[n.nameIdentity=25]="nameIdentity",n[n.externalNameIdentity=26]="externalNameIdentity",n[n.LocalName=100]="LocalName",yn.prototype.hmt=function(){return T},yn.prototype.offset=function(t,n,e,i,r){return T},yn.prototype.offsetWhenCopy=function(t,n,e,i,r,o,a,u,s,c){return T},yn.prototype.getRange=function(t,n){for(var e,i,e=[],i=2;i<arguments.length;i++)e[i-2]=arguments[i];return T},yn.prototype.forEachNodes=function(n){n(this),this.value&&this.value.forEachNodes&&this.value.forEachNodes(n),this.value2&&this.value2.forEachNodes&&this.value2.forEachNodes(n),this.arguments&&this.arguments.forEach&&this.arguments.forEach(function(t){t.forEachNodes&&t.forEachNodes(n)})},r=yn,D.Expression=r,c.prototype.getRangeCount=function(){return this.SDt},c.prototype.getSource=function(){return this.rT},c.prototype.create=function(t){return new c(this.rT,t)},c.prototype.getKey=function(){var n,e,n=[],e=this.rT;return this.$gt.forEach(function(t){n.push(e.getRangeKey(e,t))}),1===n.length?n[0]:0===n.length?T:n.join(",")},c.prototype.toArray=function(t,n,e,i,r,o,a){var u=this.rT,s=u.referenceToArray;return s&&s.call(u,this,t,n,e,i,r,o,a)},c.prototype.getRow=function(t){return this.$gt?this.$gt[t||0].row:0},c.prototype.getColumn=function(t){return this.$gt?this.$gt[t||0].col:0},c.prototype.getRowCount=function(t){return this.$gt?this.$gt[t||0].rowCount:this.rT.getRowCount()},c.prototype.getColumnCount=function(t){return this.$gt?this.$gt[t||0].colCount:this.rT.getColumnCount()},c.prototype.getValue=function(t,n,e){var i,r,e;if(typeof t===w?(i=arguments[1],r=e,n=t):(i=t.row,r=t.col),n=n||0,0<=i||0<=r){if(!(e=this.$gt))return this.rT.getValue(i,r);if(n<e.length)return this.rT.getValue(i+e[n].row,r+e[n].col)}return bt},c.prototype.getValueByIndex=function(t){var n=this.getColumnCount(),e=ht(t/n),i;return this.getValue(0,e,t%n)},c.prototype.isHiddenRow=function(t,n,e){return this.rT.isHiddenRow(n+this.getRow(t),e)},c.prototype.isSubtotal=function(t,n,e){var i,r,i=this.rT;return 0===t&&n<i.getRowCount()&&e<i.getColumnCount()&&on(r=i.getCalcSourceModel().ODt(n,e))},c.prototype.getSpillRef=function(){var t,n,e,t,i,r,o,o,a,a,t=this;if(1===t.getRowCount()&&1===t.getColumnCount()&&(r=new c(n=t.getSource(),[i=Re(e=t.getRow(),t=t.getColumn())]),n)&&n.Qbt){if(o=n.Qbt().getAnchorCell(e,t))return o.isValid?(i.rowCount=o.rowCount,i.colCount=o.colCount,r):u.Spill;if(a=(o=n.getCalcSourceModel()).sT(e,t))return a.row===e&&a.col===t?(i.rowCount=a.rowCount,i.colCount=a.colCount,new c(n,[i])):void 0;if(!(a=o.pB(e,t))||33!==a.type)return a&&("@"===a.functionName||a)?(i.rowCount=1,i.colCount=1,new c(n,[i])):bt;r.isSpillError=!0,i.rowCount=1,i.colCount=1}return bt},xt=c,D.CalcReference=xt,e.prototype.getCalcService=function(){return this.Lbt},e.prototype.op=function(){return this.Lbt},e.prototype.setCalcService=function(t){this.Lbt=t},e.prototype.getCalcSourceModel=function(){return this.Mbt},e.prototype.setCalcSourceModel=function(t){this.Mbt=t},e.prototype.getValue=function(){for(var t,n,t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];return T},e.prototype.getName=function(t){return""},e.prototype.getField=function(t){return T},e.prototype.getFieldItem=function(t){return T},e.prototype.setValue=function(){for(var t,n,t=[],n=0;n<arguments.length;n++)t[n]=arguments[n]},e.prototype.getReference=function(t){return new xt(this,t&&[t])},e.prototype.getSources=function(t){return[this]},e.prototype.referenceToArray=function(t,n,e,i,r,o,a,u){return t.toArray(n,e,i,r,o,a,u)},e.prototype.setFormula=function(){for(var t,n,t=[],n=0;n<arguments.length;n++)t[n]=arguments[n]},e.prototype.setArrayFormula=function(){for(var t,n,t=[],n=0;n<arguments.length;n++)t[n]=arguments[n]},e.prototype.getRowCount=function(){return 1e3},e.prototype.getColumnCount=function(){return 100},e.prototype.isHiddenRow=function(t,n){return!1},e.prototype.startCalculation=function(){},e.prototype.endCalculation=function(t){},e.prototype.getCustomFunction=function(t){return T},e.prototype.getCustomName=function(t){return T},e.prototype.getCustomNameInfo=function(t){return T},e.prototype.refresh=function(){},e.prototype.toJSON=function(t,n){for(var e,i,e=[],i=2;i<arguments.length;i++)e[i-2]=arguments[i]},e.prototype.wh=function(t,n){for(var e,i,e=[],i=2;i<arguments.length;i++)e[i-2]=arguments[i]},e.sourceId=1,gt=e,D.CalcSource=gt,D.Syt=wn,D.kyt=wn(bt),D.YJ=Mn,D.lDt=Cn,D.createExpandExpression=Sn,D.rbt=Tn,D.Ayt=An,D.createStringExpression=In,D.createNumberExpression=xn,D.createBooleanExpression=Nn,kn.ukt=function(t,n){var e,i,e=16777216,i;return t===n||s(t-n)<s(t)/(e*e)||(t=at.E8(t,15),n=at.E8(n,15),s(t-n)<s(t)/(e*e))},kn.getArrayValue=function(t,n,e){return t?n<t.getRowCount()&&e<t.getColumnCount()?t.getValue(n,e):e>=t.getColumnCount()&&1===t.getColumnCount()&&n<t.getRowCount()?t.getValue(n,0):n>=t.getRowCount()&&1===t.getColumnCount()&&e<t.getColumnCount()?t.getValue(0,e):j:j},kn.tryExtractToSingleValue=function(t){var n,e,n=!0;return(bn(t)||pn(t))&&((e=O.iV(t,0,!1,!0)).isError?t=e[0]:1===e.rowCount&&1===e.colCount?t=e[0][0]:(t=e,n=!1)),{value:t,success:n}},D.skt=W=kn,D.charAtFunc=v,En.prototype.xDt=function(t){var n,e,i,r,o,a,u,s,c,n=this.ADt;if(-1===(n=nt.Nh(n)?n:[n])[0])return!0;for(e=0;e<n.length;e++)if(o=r=void 0,_n(i=n[e])){for(a=i.split(" && "),u=!0,s=0;s<a.length;s++)r=(c=a[s].split(" "))[0],o=it(c[1]),"!="===r&&t!==o||">"===r&&o<t||">="===r&&o<=t||"%="===r&&t%2===o||(u=!1);if(u)return!0}else if(t===i)return!0;return!1},En.prototype.NDt=function(){return this.ADt},Nt=En,D.sDt=jn,o.prototype.getVariable=function(t){var n,e;for(t=rn(t),e=this.context.length-1;0<=e&&(n=this.context[e][t])===g;e--);return n=n===g&&this.closure?this.closure[t]:n},o.prototype.setVariable=function(t,n){t=rn(t),this.context[this.context.length-1][t]=n},o.prototype.hasVariable=function(t){return t=rn(t),this.getVariable(t)!==g},o.prototype.enterScope=function(){this.context.push({})},o.prototype.exitScope=function(){this.context.pop()},o.prototype.saveThenSwitchClosure=function(t){this.backupClosure.push(this.closure),this.closure=t},o.prototype.restoreClosure=function(){0<this.backupClosure.length?this.closure=this.backupClosure.pop():this.closure={}},o.prototype.createClosure=function(){var t,n,t={};for(this.copyTo(this.closure,t),n=0;n<this.context.length;n++)this.copyTo(this.context[n],t);return t},o.prototype.copyTo=function(t,n){for(var e,i,r,e=Object.keys(t),i=0;i<e.length;i++)n[r=e[i]]=t[r]},D.LocalScopes=o,d=Dt=Dt||{},(t=Ot=d.ArrayArgumentEvaluateMode||(d.ArrayArgumentEvaluateMode={}))[t.normal=0]="normal",t[t.allwaysExpand=1]="allwaysExpand",t[t.neverExpand=2]="neverExpand",m.prototype.description=function(){var t=this,n=(0,D.sR)().wmt;return t.IDt||n&&n[t.name]},m.prototype.acceptsArray=function(t){return!1},m.prototype.acceptsReference=function(t){return!1},m.prototype.acceptsError=function(t){return!1},m.prototype.acceptsMissingArgument=function(t){return!1},m.prototype.isVolatile=function(){return!1},m.prototype.isContextSensitive=function(){return!1},m.prototype.isBranch=function(){return!1},m.prototype.findTestArgument=function(){return-1},m.prototype.findBranchArgument=function(t){return-1},m.prototype.expandRows=function(){return!0},m.prototype.expandColumns=function(){return!0},m.prototype.skipPrecedent=function(t){return!1},m.prototype.returnReference=function(){return!1},m.prototype.evaluate=function(){for(var t,n,t=[],n=0;n<arguments.length;n++)t[n]=arguments[n]},m.prototype.evaluateWithContext=function(t,n){var e=this,n=n;return e.isContextSensitive()&&(n=[t].concat(n)),e.evaluate.apply(e,n)},m.prototype.toJSON=function(){var t,n,t={};for(n in this)this.hasOwnProperty(n)&&(t[n]=this[n]);return t},m.prototype.fromJSON=function(t){if(t)for(var n in t)t[n]!==g&&(this[n]=t[n])},m.prototype.aDt=function(t,n,e,i){if(e<t||n<e)throw(0,D.sR)().Exp_FormulaInvalid},m.prototype.uDt=function(t,n){jn(t,n)},m.ZX=function(t,n,e){var i,r,i=new m(t,0,255);if(n&&"function"==typeof n&&(i.evaluate=n),e)for(r in e)e.hasOwnProperty(r)&&"override"!==r&&(i[r]=e[r]);return i},Rt=m,d.Function=Rt,L(N,tn=Rt),N.prototype.isContextSensitive=function(){return!0},N.prototype.evaluate=function(t,n){return this.evaluateAsync.apply(this,arguments)},N.prototype.evaluateAsync=function(t,n){this.evaluate.apply(this,arguments)},N.prototype.defaultValue=function(){return 0},N.prototype.evaluateMode=function(){return 0},N.prototype.evaluateWhenArgumentsIsSame=function(){return!0},N.prototype.interval=function(){return 1e4},d.AsyncFunction=N,L(On,nn=Rt),On.prototype.acceptsArray=function(t){return!0},On.prototype.acceptsReference=function(t){return!0},On.prototype.acceptsError=function(t){return!0},d.LambdaFunction=On,d.AsyncFunctionEvaluateMode={onRecalculation:0,calculateOnce:1,onInterval:2},d.Mmt={},d.Tmt={},d.defineGlobalCustomFunction=Rn,d.findGlobalFunction=Bn,d.findGlobalFunctions=Ln,d.removeGlobalFunction=Fn,Ft=(0,D.sR)().Exp_Format,Un.prototype.ikt=function(){return this.okt},Un.prototype.rkt=function(){return this.akt},Un.prototype.hkt=function(){return this.mit},Un.prototype.j=function(t){t=t||"i";var n=this,e=n.okt,n=n.akt,i="",r=d.CALC_PRECISION;return r&&(e=at.E8(e,r),n=at.E8(n,r)),0===e&&0!==n||(i+=e.toString()),-1===n?i+="-":0!==e&&0<n&&(i+="+"),-1!==n&&0!==n&&1!==n&&(i+=n.toString()),0!==n&&(i+=t),i},Pt=Un,d.q6t=Pt,d.mkt=Hn,Gt=O.sJ,Ut=O.z6t,I=O.uJ,Ht=O.q8,zt=O.iV,Vt=O.L6t,Yt=O.BJ,Zt=W.ukt,d.F6t=Vn,d.B6t=179769e303,d.G6t=Yn,d.OMt=_n,d.q8=Zn,d.F9t=Wn,Wt=Wn,d.Fkt=Qn,d.Gkt=Jn,d.Pkt=Kn,Qt=Kn,d.Ukt=qn,d.dkt=$n,d.b9t=te,d.y9t=ne,d.H9t=ee,d.P9t=ie,d.U9t=re,d.G9t=oe,d.w9t=be,d.nkt=ye,d.Mkt=we,d.Hkt=Ce,Ae.prototype.RDt=function(t){var n,e,i,r,n=this.criteria,e=this.array;if(!_(n))if(this.useMap){if(i=e.DDt.has(n)&&e.DDt.get(n))for(r=0;r<i.length;r++)if(t(i[r]))return}else for(r=0;r<E(e);r++)if(n(e[r])&&t(r))return},Ae.prototype.A9t=function(t){return this.criteria&&this.criteria(this.array[t])},Ae.prototype.dispose=function(){delete this.criteria,delete this.array},Jt=Ae,d.RangeCriteria=Jt,(t=Kt=Kt||{})[t.unCompatibleDoubleEqual=0]="unCompatibleDoubleEqual",t[t.compatibleDoubleEqual=1]="compatibleDoubleEqual",t[t.stringEqual=2]="stringEqual",k.prototype.dispose=function(){delete this.referenceCache},k.prototype.p9t=function(t){var n,e,i;if(_(t))return[4,0];if(Ht(t)||!_n(t))return[4,t];switch((e=(n=_(t)?"":t.toUpperCase())[0])+(i=n[1])){case"<>":return[2,2===n.length?null:n.substring(2)];case"<=":return[0,2===n.length?null:n.substring(2)];case">=":return[1,2===n.length?null:n.substring(2)]}switch(e){case"=":return[4,1===n.length?null:n.substring(1)];case"<":return[3,1===n.length?null:n.substring(1)];case">":return[5,1===n.length?null:n.substring(1)]}return[4,t.toUpperCase()]},k.BDt=function(t){return 0===t.toString().trim().length},k.LDt=function(t){return Yn(t)||d.OMt(t)&&("TRUE"===t.toUpperCase()||"FALSE"===t.toUpperCase())},k.FDt=function(t){return Yn(t)?t:"TRUE"===t.toUpperCase()},k.getCompareFunction=function(t){return 0===t?function(t,n){return t<=n}:1===t?function(t,n){return n<=t}:2===t?function(t,n){return t!==n}:3===t?function(t,n){return t<n}:4===t?function(t,n){return t===n}:5===t?function(t,n){return n<t}:void 0},k.prototype.PDt=function(t,n,e,i){var r,o,a,u,s,c,r=null,a=C.tbt(n);return a&&(u=n.replace(/\*+/g,"*"))!==n&&(a=C.tbt(u)),r=4===e||2===e?a?"^[\\s\\S]*$"===a?D.ExcelCompatibleCalcMode?4===e?function(t){return d.OMt(t)}:function(t){return!d.OMt(t)}:4===e?function(t){return""!==t&&d.OMt(t)}:function(t){return!(b(t)||""!==t&&d.OMt(t))}:(s=C.OJ(a),4===e?function(t){return s.lastIndex=0,d.OMt(t)&&s.test(t)}:function(t){return!b(t)&&(s.lastIndex=0,!d.OMt(t)||!s.test(t))}):""===n?4===e?function(t){return""===t||_(t)}:function(t){return""!==t&&!_(t)}:4===e?(o=this.GDt(t,Kt.stringEqual,i,function(t){return t&&t.toUpperCase&&t.toUpperCase()}),n):D.ExcelCompatibleCalcMode?function(t){return n!==(t&&t.toUpperCase&&t.toUpperCase())}:function(t){return!b(t)&&n!==(t&&t.toUpperCase&&t.toUpperCase())}:(c=k.getCompareFunction(e),D.ExcelCompatibleCalcMode?function(t){return _n(t)&&c(t.toUpperCase(),n)}:a?function(t){return!b(t)&&!Zn(t=_(t)?"":t)&&!S.W0(t)&&c(t.toString().toUpperCase(),n)}:function(t){return!b(t)&&(_(t)&&(t=""),c(t.toString().toUpperCase(),n))}),new Jt(r,o,t,i)},k.prototype.GDt=function(t,n,e,i){var n,r,o,a,u;if(bn(t)&&this.referenceCache){if(n=t.getKey()+","+n,!(r=this.referenceCache[n]))for(this.referenceCache[n]=r=[],o=t.toArray(0,2,!1,!1),a=0;a<E(o);a++)r[a]=i(o[a]);return e&&!r.DDt&&(r.DDt=u=(0,G.createMap)(),r.forEach(function(t,n){var e=u.get(t);e||u.set(t,e=[]),e.push(n)})),r}return i},k.prototype.T9t=function(t,n,e){var i,r,o,i,a,u,s,c,f,l,i=this.p9t(n),r=i[0],o=i[1],i=null,u={value:o},s={value:0},c=k.getCompareFunction(r);if(D.ExcelCompatibleCalcMode)if(null===o)4===r?i=function(t){return _(t)}:2===r&&(i=function(t){return!_(t)});else if(k.LDt(o))f=k.FDt(o),i=4===r?f:2===r?function(t){return t!==f}:function(t){return Yn(t)&&c(t,f)};else if(!k.BDt(o)&&Gt(o,u))i=4===r?0===u.value?function(t){return 0===t||"0"===t}:(a=this.GDt(t,Kt.compatibleDoubleEqual,e,function(t){return!k.LDt(t)&&p(t,s)?s.value:g}),u.value):2===r?function(t){return!Zn(t=S.W0(t)?h(t):t)||t!==u.value}:function(t){return Zn(t=S.W0(t)?h(t):t)&&c(t,u.value)};else{if(d.OMt(o))return this.PDt(t,o,r,e);b(o)&&(i=o)}else if(null===o)i=4===r?function(t){return _(t)}:2===r?function(t){return!b(t)&&!_(t)&&!k.BDt(t)}:n;else if(!k.LDt(o)||4!==r&&2!==r)if(4===r&&y.Common.ut(o,Date))o=o.getTime(),i=function(t){if(t&&O.kDt(t,s))return s.value.getTime()===o};else if(!k.BDt(o)&&Gt(o,u))i=4===r?(a=this.GDt(t,Kt.unCompatibleDoubleEqual,e,function(t){return _(t)||k.BDt(t)||!p(t,s)?g:s.value}),u.value):2===r?function(t){return!(b(t)||(t=S.W0(t)?h(t):t,!_(t)&&!k.BDt(t)&&p(t,s)&&s.value===u.value))}:function(t){if(t=S.W0(t)?h(t):t,!_(t)&&!k.BDt(t)){if(p(t,s))return c(s.value,u.value);if(d.OMt(t))return c(t.toString().toUpperCase(),o.toString().toUpperCase())}return!1};else{if(d.OMt(o))return this.PDt(t,o,r,e);b(o)&&(i=null)}else l=o.toString().toUpperCase(),i=4===r?function(t){return k.LDt(t)&&t.toString().toUpperCase()===l}:2===r?function(t){return!(b(t)||k.LDt(t)&&t.toString().toUpperCase()===l)}:function(t){return Yn(t)&&c(t,l)};return new Jt(i,a,t,e)},k.prototype.I9t=function(t,n,e){var i;this.T9t(t,n,!0).RDt(e)},d.RangeCriteriaManager=k,qt={},R.d9t=function(t){var n=ht(t);return Zt(t,n+1)?n+1:n},R.UDt=function(t){var n,e,i;if(!Ht(t)){switch((e=(n=_(t)?"":t.toString().toUpperCase())[0])+(i=n[1])){case"<>":return[2,n.substring(2)];case"<=":return[0,n.substring(2)];case">=":return[1,n.substring(2)]}switch(e){case"=":return[4,n.substring(1)];case"<":return[3,n.substring(1)];case">":return[5,n.substring(1)]}}return[4,t]},R.p9t=function(t){var n,e;return(n=(qt=qt||{})[t])||(e=R.UDt(t),n=qt[t]=Te(e[0],e[1])),n},R.x9t=function(t){var n=[1,10,100,1e3,1e4,1e5,1e6,1e7,1e8,1e9,1e10,1e11,1e12,1e13,1e14,1e15,1e16][t];return 308<t&&(t=308),_(n)?lt(10,parseFloat(t)):n},R.z9t=function(t){var n=dt(t);return Zt(t,n-1)?n-1:n},R.Lkt=function(t,n){for(var e,i,r,o,a,u,u,e=R.x9t(s(n)),i=dt,r=ht,o=n,a=o<0?t/e:t*e;2<s(o)&&a===1/0;)o=Math.round(o/2),e=R.x9t(s(o)),a=o<0?t/e:t*e;return u=(t=a).toExponential(),t=(t=(u=it(u.split("e")[1])+1)<=15&&-85<=u?parseFloat(t.toFixed(15-u)):t)<0?i(t-.5):r(t+.5),Vt(t=n<0?t*e:t/e)},R.g9t=function(t,n){var e,i;if(t<0||n<0||t<n)return A;for(e=1,n=Math.min(t-n,n),i=1;i<=n;i++)e=e*(t-i+1)/i;return Vt(e)},R.N9t=function(t,n){if(t<0&&s(n)<1){var e=(1/n).toPrecision(15);if(parseFloat(e)===parseInt(e,10)&&parseInt(e,10)%2!=0)return-lt(-t,n)}return lt(t,n)},R.kkt=function(t,n){var n=.5<s(t)?lt(1+t,n):ct(n*ft(1+t));return isFinite(n)?rt(n)&&(n=5e-324):n===Number.POSITIVE_INFINITY?n=d.B6t:n===Number.NEGATIVE_INFINITY&&(n=-d.B6t),n},R.vkt=function(t,n){return(ct(t)+(n?-1:1)*ct(-t))/2},R.ckt=function(t,n){return rt(t)?t:rt(n)?n:1!==n&&1===t||0!==n&&n!==Number.POSITIVE_INFINITY?ft(t)/ft(n):NaN},d.MathHelper=R,D.Functions=Dt,_t=function(t,n){return t.localeCompare(n)},navigator&&"th"===navigator.language&&(_t=function(t,n){var e=t.localeCompare(n);return 0===e&&t!==n?n<t?1:-1:e}),D.Wkt=Ie,D.$kt=xe,D.isFunction=Ne,D.isLambdaFunction=ke,D.isExpression=De,D.getFunctionAcceptsArray=_e,D.getFunctionAcceptsReference=Ee,D.getFunctionArrayArgumentEvaluateMode=je,L(Oe,en=gt),Oe.prototype.startCalculation=function(){},Oe.prototype.endCalculation=function(t){},Oe.prototype.getValue=function(){return u.Reference},Oe.prototype.getReference=function(){var t=new xt(this,[Re(0,0)]);return t.getValue=function(){return u.Reference},t},Oe.prototype.referenceToArray=function(){var t=[u.Reference];return t.isError=!0,t},Oe.prototype.getName=function(){return this.oyt},Oe.prototype.setValue=function(){},D.ErrorSource=Oe},"./src/calc.entry.ts":function(t,n,e){var i,r,o,a,i=this&&this.__createBinding||(Object.create?function(t,n,e,i){void 0===i&&(i=e);var r=Object.getOwnPropertyDescriptor(n,e);r&&("get"in r?n.__esModule:!r.writable&&!r.configurable)||(r={enumerable:!0,get:function(){return n[e]}}),Object.defineProperty(t,i,r)}:function(t,n,e,i){t[i=void 0===i?e:i]=n[e]}),r=this&&this.__exportStar||function(t,n){for(var e in t)"default"===e||Object.prototype.hasOwnProperty.call(n,e)||i(n,t,e)};Object.defineProperty(n,"__esModule",{value:!0}),r(e("./src/Parser.ts"),n),r(e("./src/evaluator.ts"),n),r(e("./src/referenceExpression.ts"),n),r(e("./src/map.ts"),n),o=e("./src/calc.ts"),Object.defineProperty(n,"supportRowColumnFormula",{set:function(t){o.supportRowColumnFormula=t},get:function(){return o.supportRowColumnFormula}}),Object.defineProperty(n,"approximatelyEqual",{set:function(t){o.approximatelyEqual=t},get:function(){return o.approximatelyEqual}}),r(e("./src/calc.ts"),n),a=e("./src/calc.common.ts"),Object.defineProperty(n,"ExcelCompatibleCalcMode",{set:function(t){a.ExcelCompatibleCalcMode=t},get:function(){return a.ExcelCompatibleCalcMode}}),Object.defineProperty(n,"usedbcs",{set:function(t){a.usedbcs=t},get:function(){return a.usedbcs}}),r(e("./src/calc.common.ts"),n)},"./src/calc.ts":function(w,v,t){var n,i,Q,J,K,X,m,r,M,C,S,A,q,$,T,at,ut,tt,nt,x,o,a,U,t,et,l,g,N,k,D,it,st,ct,_,t,E,j,O,R,B,H,L,F,P,G,z,V,Y,Z,W,ft,lt,ht;function dt(t,n){var e,i,t,r,e=t.w3&&t.w3.getSource();e&&(i=t.row,t=t.column,r=e.getValue(i,t),e.setValue(i,t,n,r))}function e(t){this.aT=[],this.w3=t}function u(t,n){var t=V.call(this,t)||this;return t.name=n,t.delay=0,t}function s(t,n,e){var t=Y.call(this,t)||this;return t.id=n,t.name=e,t.delay=0,t}function c(){this.autoCalculation=!0,this.rO={},this.useR1C1=!1,this.allowDynamicArray=!1,this.iterativeCalculation=!0,this.iterativeCalculationMaximumIterations=1e3,this.iterativeCalculationMaximumChange=.01,this.dynamicReferences=!0,this.HDt=0,this.zDt=0,this.VDt=[];var t=this;t.j3t=new K.Parser,t.MX=new X.Evaluator(t),t.YDt=t.mwt&&t.mwt(),t.addResolver(new K.DefaultTokenResolver),t.ZDt={WDt:!0}}function vt(t,n){return t.getSourceModel(n)}function mt(t,n){var e,i,r,o,a,u;if(t)for(e in t)if(i=+e,r=t[e])for(o in r)(u=r[o])&&n.setValue(i,a=+o,u.value,u.oldValue,!0!==u.isAnchorCell)}function gt(t,n){return[t,n].join(",")}function pt(t,n){var n,e,n,t,n=n.split(",").map(function(t){return+t}),e=n[0],n=n[1],t=t[e];return t&&t[n]}function bt(t,h,d){var v,m;t&&(v=d.anchors,m={},t.forEach(function(t){var n,e,i,r,o,a,u,s,c,f,l,n=t.row,e=t.col,i=gt(n,e);for(h.gF(n,e,1,1),m[i]=!0,r=t.rowCount,o=t.colCount,a=1,u=0;u<r;u++){for(;a<o;a++)if(s=d.getAnchorItem(u+n,a+e))for(f in c=s.anchorRefs)i!==f&&c[f]&&(l=pt(v,f))&&!m[f]&&(h.gF(l.row,l.col,1,1),m[f]=!0);a=0}}))}function f(){}function yt(t,n,e,i,r,o){wt(t.QDt,t.qkt)&&(t.QDt&&(Ct(e,t,t.QDt,!1),delete t.QDt),t.qkt)&&(t.delay+=Ct(e,t,t.qkt,!0,o),t.QDt=t.qkt,delete t.qkt)}function wt(t,n){return(!et(t)||!et(n))&&(et(t)||et(n)||Object.keys(t).join()!==Object.keys(n).join())}function Mt(t,n,e,i,r,o,a,u,s){for(var c,f,l,h,c=0,f=0;f<r;f++)for(l=0;l<o;l++)h=n.oT(f+e,l+i,!0),a&&h&&h.KDt(0,t,u),s&&h&&h.k1&&c++;return c}function Ct(t,n,e,i,r){var o,a,u,s,c,f,o=0;for(a in e)e.hasOwnProperty(a)&&(u=!1,s=e[a],c=t.rO[s.id])&&(c&&Dt(s)&&((f=c.uT(!0)).JDt(s.rowUndefine?-1:s.row,s.colUndefine?-1:s.col,s.rowUndefine?-1:s.rowCount,s.colUndefine?-1:s.colCount,n,i,!0),u=!0),!c||u&&!r||(o+=Mt(n,c,s.row,s.col,s.rowCount,s.colCount,!u,i,r)));return o}function h(t,n){this.I8=0,this.x8=0,this.XDt=[],this.qDt=[],this.$Dt=[],this.dataTable={},this.dataTableByName={},this.AE=[],this.IE=[],this.t_t=0;var e=this;e.rT=n,e.Lbt=t}function d(t,n,e){var t=Z.call(this,t)||this;return t.row=n,t.column=e,t.delay=0,t}function St(t,n,e){t[n]||(t[n]=[]),t[n].push(e)}function Tt(t,n,e){var i,r,i=t[n];if(i)for(r=0;r<i.length;r++)if(i[r]===e)return void i.splice(r,1)}function p(t,n){var t=W.call(this,t)||this;return t.row=n,t}function b(t,n){var t=ft.call(this,t)||this;return t.column=n,t}function At(t,n){var t=lt.call(this,t)||this;return t.name=n,t}function y(t){return ht.call(this,t)||this}function It(t,n){var e,i,i;for(e in t)(i=t[e])&&(n?It(i):(i=i.calc)&&i.CMt())}function xt(t,n){var n;t.function||(n=n.getNameInfo(t.functionName))&&(t.functionName=n.Zc)}function Nt(t,n,e,B,L,F,P){for(var i,r,o,a,G,U,u,H,s,z,c,f,l,h,d,v,m,g,p,b,y,w,M,C,S,T,A,I,x,N,V,k,A,I,x,D,_,E,j,O,O,_,D,E,j,R,Y,i=t.row,r=t.column,o=[],a=0,G=t.arrayIdentity?t.arrayIdentity.row:i,U=t.arrayIdentity?t.arrayIdentity.col:r,H=u=0,c=B,f=L,l=s=!(o[a]={expr:n,acceptsArray:F||!1,acceptsRef:P||!1,index:-1});0<=a;){if(h=o[a],a--,d=h.acceptsArray,v=h.acceptsRef,n=h.expr,m=q,n)if(7===n.type){if(A=(T=n).arguments.length,!T.function){if(!t){m=(0,Q.Syt)(at);continue}T.function=t.getFunction(T.functionName),xt(T,t)}if(I=T.function,x=h.index,S=h.neeedExpendindexs,x<0?(h.arrayArgumentEvaluateMode=l,h.arrayFormulaCatchValue=e,(0,Q.getFunctionArrayArgumentEvaluateMode)(I)&&(l=(0,Q.getFunctionArrayArgumentEvaluateMode)(I)),h.args=[]):((0,Q.getFunctionAcceptsArray)(I,x)?u--:s&&(S||(h.neeedExpendindexs=S=[]),T.arguments[x],S.push(x)),h.args.push(g)),x===A-1){if(l=h.arrayArgumentEvaluateMode,e=h.arrayFormulaCatchValue,V=!1,(N=h.args)&&0<N.length)for(k=0;k<N.length;k++)if(N[k]!==T.arguments[k]){V=!0;break}m=V?(0,Q.YJ)(T,N):n,S&&0<S.length&&(m=(0,Q.createExpandExpression)(m,S),s=!0)}else 0===x&&I&&3===(0,Q.getFunctionArrayArgumentEvaluateMode)(I)&&3===l&&(l=0),s=!1,x++,h.index=x,(0,Q.getFunctionAcceptsArray)(I,x)&&u++,o[++a]=h,o[++a]={expr:T.arguments[x],acceptsArray:(0,Q.getFunctionAcceptsArray)(I,x),acceptsRef:(0,Q.getFunctionAcceptsReference)(I,x),index:-1}}else if(1===n.type&&n.hmt())H&&(y=(b=n.source!==Q.BangSource&&n.source||t.source).getRowCount(),w=b.getColumnCount(),M=n.rowRelative?(n.row+G)%Q.MAX_ROW_COUNT%y:n.row,C=n.columnRelative?(n.column+U)%Q.MAX_COLUMN_COUNT%w:n.column,n=(0,J.knt)(n.source&&b,q,M=M<0?M+y:M,C=C<0?C+w:C,!1,!1));else if(1===n.type||13===n.type){if(13===n.type){if(p=(A=n).getRange(i,r),A.Fwt(i,r,t.source.id),!p){A._error?(delete A._error,m=g=ut,t.n_t=1):g=m=n;continue}n=(0,J.lJ)(A.source===t.source?q:A.source,q,p.row,p.col,p.row+p.rowCount-1,p.col+p.colCount-1)}I=n.source!==Q.BangSource&&n.source,x=n,H&&(b=I||t.source,y=Q.MAX_ROW_COUNT,w=Q.MAX_COLUMN_COUNT,D=x.rowRelative?(x.row+G)%y:x.row,_=x.columnRelative?(x.column+U)%w:x.column,O=void 0,(E=(E=x.endRowRelative?(x.endRow+G)%y:x.endRow)<0?E+y:E)<(D=D<0?D+y:D)&&(O=D,D=E,E=O),(j=(j=x.endColumnRelative?(x.endColumn+U)%w:x.endColumn)<0?j+w:j)<(_=_<0?_+w:_)&&(O=_,_=j,j=O),(y=b.getRowCount())<=D?(D%=y,E%=y):y<=E&&(E=y-1),(w=b.getColumnCount())<=_?(_%=w,j%=w):w<=j&&(j=w-1),n.row===Q.BAND_INDEX_CONST&&(D=E=Q.BAND_INDEX_CONST),n.column===Q.BAND_INDEX_CONST&&(_=j=Q.BAND_INDEX_CONST),n=(0,J.lJ)(I,n.endSource,D,_,E,j,!1,!1,!1,!1)),v&&(d||!e&&1!==l&&3!==l)||i<0||r<0||4===l||x.source&&x.source.ayt||(0<u&&!e&&1!==l&&3!==l||0===u||2===l?(p=x.getRange(i,r),m=e||(v||d)&&1===l?!x.isFullColumn&&1!==p.rowCount&&c>=p.rowCount||!x.isFullRow&&1!==p.colCount&&f>=p.colCount?(0,Q.Syt)(nt):(M=(x.isFullColumn?0:p.row)+(1===p.rowCount?0:c),C=(x.isFullRow?0:p.col)+(1===p.colCount?0:f),(0,J.knt)(I,n.endSource,M,C,!1,!1)):1<p.rowCount&&1<p.colCount||1<p.rowCount&&!x.isFullColumn&&(i<p.row||i>=p.row+p.rowCount)||1<p.colCount&&!x.isFullRow&&(r<p.col||r>=p.col+p.colCount)?(0,Q.Syt)(tt):(M=x.isFullColumn||1<p.rowCount?i:p.row,C=x.isFullRow||1<p.colCount?r:p.col,(0,J.knt)(I,n.endSource,M,C,!1,!1))):s=!0)}else if(9===n.type)O=(0,Q.gDt)(n.operatorType),e&&et(n.value2)&&(O=!1),-1===h.index?(h.index=n.value2?0:1,o[++a]=h,o[++a]=rt(n.value,O,O,-1)):0===h.index?(g!==n.value&&(m=(0,Q.rbt)(n.operatorType,g,n.value2),h.expr=m),s&&((S=[]).push(0),h.neeedExpendindexs=S,s=!1),h.index=1,o[++a]=h,o[++a]=rt(n.value2,O,O,-1)):(m=n.value2&&g!==n.value2?(0,Q.rbt)(n.operatorType,n.value,g):et(n.value2)&&g!==n.value?(0,Q.rbt)(n.operatorType,g,$):n,S=h.neeedExpendindexs,s&&(S?S.push(1):S=[n.value2&&n.value2===z?1:0]),S&&(m=(0,Q.createExpandExpression)(m,S),s=!0));else if(10===n.type)-1===h.index?(h.index=0,o[++a]=h,o[++a]=rt(n.value,d,v,-1)):n.value!==g&&(m=(0,Q.Ayt)(g));else if(8===n.type)1===h.index?(H--,m=g,h.context&&(t=h.context)):(H++,o[++a]=rt(n,d,v,1,t),D=t,E=_=void 0,n.source?(E=(n.source===Q.BangSource?t:n).source,(D=new X.EvaluateContext(E)).cloneFrom(t),_=E.getCustomName(n.value)):(_=t.getName(n.value),t.source.getCustomName(n.value)||(D=new X.GloableEvaluateContext(t.source)).cloneFrom(t)),_=_||(0,Q.Syt)(at),o[++a]=rt(_,d,v,-1,t=D||t));else if(6===n.type)if(j=n,!d&&(0<u||e||1===l||3===l))s=!0,z=n;else if(!d&&0===u)if(c>=j.value.RowCount&&1<j.value.RowCount||f>=j.value.colCount&&1<j.value.colCount)m=(0,Q.Syt)(nt);else try{1===j.value.RowCount&&(c=0),1===j.value.colCount&&(f=0),m=typeof(R=j.value.getValue(c,f))===st?(0,Q.createStringExpression)(R):typeof R===it?(0,Q.createNumberExpression)(R):typeof R===ct?(0,Q.createBooleanExpression)(R):R._error?(0,Q.Syt)(R):(Y=new K.Parser).parse(t.source.getParserContext(t.useR1C1,ot(0,0)),R.toString())}catch(t){m=(0,Q.Syt)(nt)}g=m=m===q?n:m}return m}function kt(t,n,e,B,L,F,P){for(var i,r,o,a,G,U,u,H,s,z,c,f,l,h,d,v,m,g,p,b,y,w,M,C,S,T,V,A,I,I,x,N,Y,Z,A,x,k,D,_,E,j,O,O,D,E,_,j,k,h,v,d,R,W,i=t.row,r=t.column,o=[],a=0,G=t.arrayIdentity?t.arrayIdentity.row:i,U=t.arrayIdentity?t.arrayIdentity.col:r,H=u=0,c=B,f=L,l=s=!(o[a]={expr:n,acceptsArray:F||!1,acceptsRef:P||!1,index:-1});0<=a;){if(h=o[a],a--,d=h.acceptsArray,v=h.acceptsRef,n=h.expr,m=q,n)if(7===n.type){if(A=(V=(T=n).arguments).length,!T.function){if(!t){m=(0,Q.Syt)(at);continue}I=T.functionName,T.function=t.getFunction(I),xt(T,t)}if(I=T.function,x=h.index,S=h.neeedExpendindexs,x<0?(h.arrayArgumentEvaluateMode=l,h.arrayFormulaCatchValue=e,(0,Q.getFunctionArrayArgumentEvaluateMode)(I)&&(l=(0,Q.getFunctionArrayArgumentEvaluateMode)(I)),h.args=[]):((0,Q.getFunctionAcceptsArray)(I,x)?u--:s&&(S||(h.neeedExpendindexs=S=[]),T.arguments[x],S.push(x)),h.args.push(g)),x===A-1){if(l=h.arrayArgumentEvaluateMode,e=h.arrayFormulaCatchValue,Y=!1,(N=h.args)&&0<N.length)for(Z=0;Z<N.length;Z++)if(N[Z]!==T.arguments[Z]){Y=!0;break}m=Y?(0,Q.YJ)(T,N):n,S&&0<S.length&&(m=(0,Q.createExpandExpression)(m,S),s=!0)}else 0===x&&I&&3===(0,Q.getFunctionArrayArgumentEvaluateMode)(I)&&3===l&&(l=0),s=!1,x++,h.index=x,(0,Q.getFunctionAcceptsArray)(I,x)&&u++,o[++a]=h,o[++a]={expr:T.arguments[x],acceptsArray:(0,Q.getFunctionAcceptsArray)(I,x),acceptsRef:(0,Q.getFunctionAcceptsReference)(I,x),index:-1}}else if(1===n.type&&n.hmt())H&&(y=(b=n.source!==Q.BangSource&&n.source||t.source).getRowCount(),w=b.getColumnCount(),M=n.rowRelative?(n.row+G)%Q.MAX_ROW_COUNT%y:n.row,C=n.columnRelative?(n.column+U)%Q.MAX_COLUMN_COUNT%w:n.column,n=(0,J.knt)(n.source&&b,q,M=M<0?M+y:M,C=C<0?C+w:C,!1,!1));else if(1===n.type||13===n.type){if(13===n.type){if(p=(A=n).getRange(i,r),A.Fwt(i,r,t.source.id),!p){A._error?(delete A._error,m=g=ut,t.n_t=1):g=m=n;continue}n=(0,J.lJ)(A.source===t.source?q:A.source,q,p.row,p.col,p.row+p.rowCount-1,p.col+p.colCount-1)}x=n.source!==Q.BangSource&&n.source,k=n,H&&(b=x||t.source,y=Q.MAX_ROW_COUNT,w=Q.MAX_COLUMN_COUNT,D=k.rowRelative?(k.row+G)%y:k.row,_=k.columnRelative?(k.column+U)%w:k.column,O=void 0,(E=(E=k.endRowRelative?(k.endRow+G)%y:k.endRow)<0?E+y:E)<(D=D<0?D+y:D)&&(O=D,D=E,E=O),(j=(j=k.endColumnRelative?(k.endColumn+U)%w:k.endColumn)<0?j+w:j)<(_=_<0?_+w:_)&&(O=_,_=j,j=O),(y=b.getRowCount())<=D?(D%=y,E%=y):y<=E&&(E=y-1),(w=b.getColumnCount())<=_?(_%=w,j%=w):w<=j&&(j=w-1),n.row===Q.BAND_INDEX_CONST&&(D=E=Q.BAND_INDEX_CONST),n.column===Q.BAND_INDEX_CONST&&(_=j=Q.BAND_INDEX_CONST),n=(0,J.lJ)(x,n.endSource,D,_,E,j,!1,!1,!1,!1)),P||v&&(d||!e&&1!==l&&3!==l)||i<0||r<0||(0<u&&!e&&1!==l&&3!==l||0===u||2===l?(p=k.getRange(i,r),m=e||(v||d)&&1===l?!k.isFullColumn&&1!==p.rowCount&&c>=p.rowCount||!k.isFullRow&&1!==p.colCount&&f>=p.colCount?(0,Q.Syt)(nt):(M=(k.isFullColumn?0:p.row)+(1===p.rowCount?0:c),C=(k.isFullRow?0:p.col)+(1===p.colCount?0:f),(0,J.knt)(x,n.endSource,M,C,!1,!1)):1<p.rowCount&&1<p.colCount||1<p.rowCount&&!k.isFullColumn&&(i<p.row||i>=p.row+p.rowCount)||1<p.colCount&&!k.isFullRow&&(r<p.col||r>=p.col+p.colCount)?(0,Q.Syt)(tt):(M=k.isFullColumn||1<p.rowCount?i:p.row,C=k.isFullRow||1<p.colCount?r:p.col,(0,J.knt)(x,n.endSource,M,C,!1,!1))):s=!0)}else if(9===n.type)O=(0,Q.gDt)(n.operatorType),D=v&&t.source&&t.source.Lbt&&t.source.Lbt.allowDynamicArray,-1===h.index?(e&&et(n.value2)&&(O=d=!1),h.index=n.value2?0:1,o[++a]=h,o[++a]=rt(n.value,O||d,O||D,-1)):0===h.index?(g!==n.value&&(m=(0,Q.rbt)(n.operatorType,g,n.value2),h.expr=m),s&&((S=[]).push(0),h.neeedExpendindexs=S,s=!1),h.index=1,o[++a]=h,o[++a]=rt(n.value2,O||d,O||D,-1)):(m=n.value2&&g!==n.value2?(0,Q.rbt)(n.operatorType,n.value,g):et(n.value2)&&g!==n.value?(0,Q.rbt)(n.operatorType,g,$):n,S=h.neeedExpendindexs,s&&(S?S.push(1):S=[n.value2&&n.value2===z?1:0]),S&&(m=(0,Q.createExpandExpression)(m,S),s=!0));else if(10===n.type)-1===h.index?(h.index=0,o[++a]=h,o[++a]=rt(n.value,d,v,-1)):n.value!==g&&(m=(0,Q.Ayt)(g));else if(8===n.type)1===h.index?(n.jwt=$,H--,m=g,h.context&&(t=h.context)):n.jwt||(n.jwt=!0,H++,o[++a]=rt(n,d,v,1,t),_=t,j=E=void 0,n.source?(j=(n.source===Q.BangSource?t:n).source,(_=new X.EvaluateContext(j)).cloneFrom(t),E=j.getCustomName(n.value)):(E=t.getName(n.value),t.source.getCustomName(n.value)||(_=new X.GloableEvaluateContext(t.source)).cloneFrom(t)),E=E||(0,Q.Syt)(at),o[++a]=rt(E,d,v,-1,t=_||t));else if(6===n.type)if(h=(k=n).value,!d&&(0<u||e||1===l||3===l))s=!0,z=n;else if(!d&&0===u)if(v=h.getRowCount(),d=h.getColumnCount(),v<=c&&1<v||d<=f&&1<d)m=(0,Q.Syt)(nt);else if(e||!(t.source&&t.source.Lbt&&t.source.Lbt.allowDynamicArray))try{1===v&&(c=0),1===d&&(f=0),m=typeof(R=k.value.getValue(c,f))===st?(0,Q.createStringExpression)(R):typeof R===it?(0,Q.createNumberExpression)(R):typeof R===ct?(0,Q.createBooleanExpression)(R):R._error?(0,Q.Syt)(R):(W=new K.Parser).parse(t.source.getParserContext(t.useR1C1,ot(0,0)),R.toString())}catch(t){m=(0,Q.Syt)(nt)}g=m=m===q?n:m}return m}function rt(t,n,e,i,r){return{expr:t,acceptsArray:n,acceptsRef:e,index:i,context:r}}function ot(t,n){return{row:t,col:n}}function I(t,n,e,i){return{row:t,col:n,rowCount:e,colCount:i}}function Dt(t){return-1===t.row||-1===t.col||t.rowUndefine||t.colUndefine||1<t.rowCount*t.colCount}function _t(t,n,e,i,r){i===r||!et(i)&&!et(r)||et(t)||(!et(i)&&et(r)&&t.removeRowAndColInfo(n,e),et(i)&&!et(r)&&t.addRowAndColInfo(n,e))}n=this&&this.__extends||(z=function(t,n){return(z=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(t,n){t.__proto__=n}:function(t,n){for(var e in n)Object.prototype.hasOwnProperty.call(n,e)&&(t[e]=n[e])}))(t,n)},function(t,n){if("function"!=typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function e(){this.constructor=t}z(t,n),t.prototype=null===n?Object.create(n):(e.prototype=n.prototype,new e)}),Object.defineProperty(v,"__esModule",{value:!0}),v.Rwt=v.eV=v.h0t=v.Pyt=v.RangeCalc=v.NameCalc=v.ColumnCalc=v.RowCalc=v.CellCalc=v.CalcSourceModel=v.CalcArrayHelper=v.markAnchorCellDirty=v.setSpillValues=v.CalcService=v.PathCalc=v.NameIDCalc=v.BaseCalc=v.supportRowColumnFormula=v.approximatelyEqual=void 0,i=t("Common"),Q=t("./src/calc.common.ts"),J=t("./src/referenceExpression.ts"),K=t("./src/Parser.ts"),X=t("./src/evaluator.ts"),m=t("./src/map.ts"),r=i.Common.ut,M=i.Common.J8,C=i.Common.X8,S=i.Common.zf,A=i.Common.ct,q=null,$=void 0,T=Math.abs,at=Q.Errors.Name,ut=Q.Errors.Reference,tt=Q.Errors.Value,nt=Q.Errors.NotAvailable,x=Q.Errors.Calc,o=Q.Convert.Nh,a=Q.Convert.LE,U=S.Gmt,t=i.Common.lt,et=t.ht,l=Math.min,g={},N="cellListeners",k="rowSliceListeners",D="nameIDListeners",it="number",st="string",ct="boolean",v.approximatelyEqual=_=function(t,n,e){var i;return!!((t=void 0===t?0:t)===(n=void 0===n?0:n)||r(t,Q.CalcError)&&r(n,Q.CalcError)&&t._code===n._code)||(i=1,r(t,Date)&&r(n,Date)?i=864e5:r(t,Date)?t=A.o0(t):r(n,Date)&&(n=A.o0(n)),T(n-t)/i<e)},v.supportRowColumnFormula=!1,e.prototype.getKey=function(){return""},e.prototype.hasListeners=function(){for(var t,n,e,i,r,o,t,n,e=0,i=this.aT;e<i.length;e++)if((o=this[r=i[e]])&&0<o.size)return!0;return!1},e.prototype.Iwt=function(t,n,e){var t,i,r,o,t=n.e_t?(this.i_t||(this.i_t=(0,m.createMap)()),this.i_t):(this[t]||(this.aT.push(t),this[t]=(0,m.createMap)()),this[t]),i=n.getKey();n.ebt&&1<=n.ebt.length&&((o=(r=n.ebt)[r.length-1]).push(this),i="?"+i),e?t.set(i,n):t.delete(i)},e.prototype.KDt=function(t,n,e){var i,r,i=this[t],r=n.getKey();r="!"+r,i||(this.aT.push(t),i=this[t]=(0,m.createMap)()),e?i.set(r,n):i.delete(r)},e.prototype.mB=function(){for(var t,n,e,i,r,t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];for(e=this.aT,i=0;i<e.length;i++)(r=this[e[i]])&&r.forEach(function(t){t&&t.r_t()});this.i_t&&this.i_t.forEach(function(t){t&&t.r_t()})},e.prototype.o_t=function(){for(var t,n,e,i,r,t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];for(e=this.aT,i=0;i<e.length;i++)(r=this[e[i]])&&r.forEach(function(t){!t||t.DF||t.C3||t.vyt()})},e.prototype.a_t=function(){for(var t,n,e,i,r,o,a,u,s,c,f,l,t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];for(r=(i=this).aT,o=(e=t[0])?1:-1,a=0;a<r.length;a++)(u=this[r[a]])&&u.forEach(function(t,n){if("?"===n[0]){if(!e&&i.u_t)for(;0<=i.u_t.indexOf(t);)i.u_t.splice(i.u_t.indexOf(t),1),t.delay--}else t&&(t.delay+=o,e)&&t.s_t&&t.s_t()});if((s=i.node&&i.node.$bt)&&s.isDynamicArray)for(c=0;c<s.rowCount;c++)for(f=0;f<s.colCount;f++)0===c&&0===f||(l=i.w3.getNode(c+s.row,f+s.col))&&l.calc&&l.calc.a_t(e)},e.prototype.r_t=function(){},e.prototype.vyt=function(){},e.prototype.CMt=function(){},e.prototype.yB=function(){},e.prototype.c_t=function(){return this.w3.op()},v.BaseCalc=t=e,n(u,V=t),u.prototype.getKey=function(){var t,n,e,t=this,n=t.w3,e;return(null===n?"":n.rT.id+",")+t.name},u.prototype.yB=function(){var t=this;t.w3.f_t(t.name,!0)},u.prototype.CMt=function(){var t=this;t.w3.f_t(t.name,!1)},u.prototype.r_t=function(){this.c_t().onAddAdjust(this,3)},u.prototype.vyt=function(){this.c_t().I3(this,3)},E=u,v.NameIDCalc=E,n(s,Y=t),s.prototype.getKey=function(){var t=this;return t.w3.getName()+","+t.id+"#"+t.name},s.prototype.yB=function(){var t=this;t.w3.cyt(t.id,t.name,!0)},s.prototype.CMt=function(){var t=this;t.w3.cyt(t.id,t.name,!1)},s.prototype.c_t=function(){return this.w3.Lbt},s.prototype.r_t=function(){this.c_t().onAddAdjust(this,6)},s.prototype.vyt=function(){this.c_t().I3(this,6)},v.PathCalc=s,c.prototype.l_t=function(t,n,e){var i,r,o,i=this;if(i.h_t=i.h_t||{},r=i.h_t[n]=i.h_t[n]||[],e)r.push(t);else for(o=0;o<r.length;o++)r[o]===t&&(r.splice(o,1),o--)},c.prototype.AMt=function(t){var n,n,n=this,n=n.h_t&&n.h_t[t];n&&n.forEach(function(t){t.vyt()})},c.prototype.recalcAfterOperate=function(t){this.AMt(t),this.IsSuspended()||this.recalculateAll(!1)},c.prototype.getResolvers=function(){return this.VDt},c.prototype.addResolver=function(t){for(var n,e,n=this.VDt,e=0;;e++)if(!n[e]||t.priority>n[e].priority){n.splice(e,0,t);break}},c.prototype.dispose=function(){var t=this;t.rO={},t.d_t=q},c.prototype.cloneFrom=function(t){var n=this;n.useR1C1=t.useR1C1,n.HDt=t.HDt,n.v_t=t.v_t,n.calcOnDemand=t.calcOnDemand,n.dynamicReferences=t.dynamicReferences},c.prototype.Hyt=function(){return this.YDt},c.prototype.getExternalSource=function(t,n){for(var e,i,r,o,e,i=this.getAllSourceModels(),r=0,o=i.length;r<o;r++)if(S.Dbt(i[r].getSource().getName(),n))return i[r].getSource();return q},c.prototype.getSourceModel=function(t){var n=this.rO[t.id];return n||(n=t.createSourceModel?t.createSourceModel(this):this.createSourceModel(this,t),this.rO[t.id]=n,t.setCalcSourceModel(n),t.setCalcService(this)),n},c.prototype.getGlobalSourceModel=function(t){return this.d_t||((t=t||new Q.CalcSource).createSourceModel?this.d_t=t.createSourceModel(this):this.d_t=this.createSourceModel(this,t),t.setCalcSourceModel(this.d_t)),this.d_t},c.prototype.setSourceModel=function(t,n){(this.rO[t.id]=n).setCalcService(this)},c.prototype.getAllSourceModels=function(){var t,n,e,t=[],n=this.rO;for(e in n)t.push(n[e]);return t},c.prototype.removeSource=function(t){var n,e,i,r,o,t;for(r in this.suspend(),(n=this.rO[t.id])&&(""!==t.getName()&&this.onRemoveSource(t),delete this.rO[t.id]),this.clearDirties(),e=this.rO)(i=e[r]).addDirtyNodesForCalc(!1);o=this.x3&&this.x3.Mf,t=t&&t.Mf,o&&t&&t===o&&(this.x3=null),this.resume(!1)},c.prototype.clearSource=function(){this.rO={},this.x3=null,this.clearDirties()},c.prototype.ignoreDirty=function(){return this.v_t},c.prototype.suspend=function(t){this.HDt++,this.v_t=!!t},c.prototype.resume=function(t){var n=this;n.HDt--,n.HDt<0&&(n.HDt=0),n.IsSuspended()||(n.m_t=q,n.v_t=!1,n.recalculateAll(t))},c.prototype.suspendAdjust=function(){this.zDt++},c.prototype.resumeAdjust=function(){var t=this;t.zDt--,t.zDt<0&&(t.zDt=0)},c.prototype.isAdjustSuspended=function(){return 0<this.zDt},c.prototype.clearDirties=function(t){var n,e,i,r,o,a,u,n=this,e=n.y3,i=n.Kyt;if(e){for(o in r=!1,e)if(e.hasOwnProperty(o))if(t&&t[o])r=!0;else{for(a=e[o];a;)u=a.C3,a.k1=!1,a=u?(a.C3=u.DF=$,u):q;delete e[o],i&&!et(i[o])&&delete i[o]}r||(n.y3=n.Kyt=q)}},c.prototype.Zct=function(){this.ZDt.WDt=!1,this.ZDt={WDt:!0}},c.prototype.resumeWithoutCalc=function(){this.HDt--,this.HDt<0&&(this.HDt=0),this.clearDirties({3:!0,6:!0}),this.v_t=!1,this.y3&&this.recalculateAll(!1),this.Zct()},c.prototype.IsSuspended=function(){return 0<this.HDt},c.prototype.recalculateAll=function(t,n,e){var i=this;i.IsSuspended()||(i.PE=!0,i.g_t(t,n,e),delete i.PE,i.p_t&&(i.p_t.forEach(function(t){t[0].gF(t[1].row,t[1].col,t[1].rowCount,t[1].colCount)}),i.g_t(!1,!0),delete i.p_t))},c.prototype.processDynamicRef=function(){var n,t,e,i,r,o,a,u,s,c,n=this;if(n.tMt){if(e=null,t=n.y3)for(e=[],i=void 0,r=t[0];r;r=i)e.push(r),i=r.C3;for(a in o=n.rO)(u=o[a]).addDirtyNodesForCalc(!0,!1);if(t=n.y3)for(i=void 0,r=t[0];r;r=i)i=r.C3,n.b_t(r,0);for(s in n.tMt)n.tMt.hasOwnProperty(s)&&(c=n.tMt[s],u=n.rO[c.id])&&u.processDynamicListenerForCell(c.row,c.col);delete n.tMt,e&&0<e.length&&e.forEach(function(t){n.I3(t,0)}),this.Zct()}},c.prototype.g_t=function(t,n,e){var i,r,o,a,i=this;for(a in i.RE=Date.now(),t&&i.y3&&delete i.tMt,i.S9t=new Q.Functions.RangeCriteriaManager,n||i.MX.startCache(),o=i.rO)(r=o[a]).getSource().startCalculation(),r.addDirtyNodesForCalc(t,n);for(a in i.y_t(!0,t),o)(r=o[a]).getSource().endCalculation(e);n||i.MX.endCache(),i.S9t.dispose(),this.Zct(),delete i.RE},c.prototype.w_t=function(){for(var t,n,e,i,r,o,a,u,s,c,f,l,h,d,v,m,o,i,g,p,t=this,n,e=t.y3[0];e;e=e.C3)e.isVolatile&&(i=e.row,r=e.column,a=(o=e.w3).rT,s=!0,(u=o.M_t(i,r)||o.ODt(i,r))&&(c=ot(i,r),f=a.getValue(i,r),l=!1,m=v=d=h=$,(o=o.sT(i,r))&&!0!==o.isDynamicArray&&(l=!0,h=o.row,d=o.col,v=o.rowCount,m=o.colCount),i=t.BI(a,u,c,l,!0,o&&!0!==o.isDynamicArray&&I(h,d,v,m),t.allowDynamicArray),e.QDt||e.qkt||(f!==i||"string"==typeof i&&i[g="hyperlink"]?f instanceof Date?(i instanceof Date&&f.valueOf()===i.valueOf()||typeof i===it&&(p=A.o0(f))===i)&&(s=!1):typeof f===it&&typeof i===it&&(s=f!==i):s=!1)),u)&&!s&&t.b_t(e,0)},c.prototype.y_t=function(t,n){var e,i,r,o,a,u,s,c,e=this,i=e.y3;if(i){if(!e.calcOnDemand&&t&&!1===n&&e.w_t(),t){for(r in a=i[1]||i[2],i)i.hasOwnProperty(r)&&(u=parseInt(r,10),a&&1!==u&&2!==u||(o=i[r])&&(o.w3.addListenersToDirty(e,u),o.processed=!0));for(r in i)i.hasOwnProperty(r)&&(o=i[r])&&(o.processed?delete o.processed:o.w3.addListenersToDirty(e,parseInt(r,10)))}for(r in i)i.hasOwnProperty(r)&&i[r].w3.initDelay(e,parseInt(r,10));for(r in i)i.hasOwnProperty(r)&&i[r].w3.adjustDelayOfListeners(e,parseInt(r,10),!0);do{for(r in s=!1,i)i.hasOwnProperty(r)&&(c=i[r].w3.calculateDirtyNodes(e,parseInt(r,10)))&&(s=!0)}while(s);for(r in i)i.hasOwnProperty(r)&&i[r].w3.calculateIterations(e,parseInt(r,10));e.y3=e.Kyt=$}},c.prototype.initParserContext=function(t){var n;this.x3||(this.x3=t.getParserContext(this.useR1C1))},c.prototype.getParserContext=function(t){var n,e,n=this,e=n.x3;return e||(t?n.x3=e=t.getParserContext(n.useR1C1):e=new K.ParserContext(q,n.useR1C1)),e.setSource(t),e},c.prototype.parseWithContext=function(t,n){return this.j3t.parse(t,n)},c.prototype.unparseWithContext=function(t,n){return this.j3t.unparse(t,n)},c.prototype.I3=function(t,n){var e,e,i,r,r,o,e=this;isNaN(n)||(!e.Vct||0!==n||(r=e.h_t&&e.h_t[e.Vct])&&0<=r.indexOf(t))&&(r=e.y3,o=e.Kyt,r||(r=e.y3={},o=e.Kyt={}),e=r[n],i=o[n],t.k1=!0,t)&&!t.DF&&t!==e&&(e?i.C3=t:r[n]=t,t.DF=i,t.C3=q,o[n]=t)},c.prototype.b_t=function(t,n){var e,i,r,o,e,i,e=this;isNaN(n)||(t.k1=!1,r=e.y3,o=e.Kyt,r&&(i=e.y3[n]),t&&(t.DF||t===i)&&(e=t.DF,i=t.C3,e?e.C3=i:r&&(i?r[n]=i:delete r[n]),i?i.DF=e:o&&(e?o[n]=e:delete o[n]),t.DF=q,t.C3=q))},c.prototype.evaluateExpression=function(t,n,e){var i;return this.MX.evaluateExpression(n,t.getEvaluatorContext(e,!1),!1)},c.prototype.onClearExpr=function(t,n){this.MX&&this.MX.asyncManager.clearCell(t,n)},c.prototype.parse=function(t,n,e,i,r,o,a,u){var s,c,t,f,a,s=this,c=s.m_t,t=s.getParserContext(t);return t.useR1C1=!a&&s.useR1C1,t.ignoreError=o,t.keepUnknownFormulas=u,t.row=e,t.column=i,t.culture=r,c?(f=c[n])||(a=s.j3t.parse(t,n),c[n]=a):s.j3t.parse(t,n)},c.prototype.unparse=function(t,n,e,i,r,o,a){var t,e,t=this.getParserContext(t);return t.useR1C1=this.useR1C1,t.row=e,t.column=i,t.culture=r,t.addSheetName=a,o&&(t.lyt=!0,t.useR1C1=!1),e=this.j3t.unparse(t,n),t.lyt=!1,e},c.prototype.recalculate=function(t,n,e,i){var t=this.getSourceModel(t);-1===e?t.gF(n,0,1,t.cC()):-1===n?t.gF(0,e,t.rC(),1):t.gF(n,e,1,1),this.IsSuspended()||this.recalculateAll(!1,i)},c.prototype.recalculateByName=function(t,n){var e,t;n&&(t=(e=vt(this,t)).C_t(U(n),!0),this.I3(t,3),this.IsSuspended()||this.recalculateAll(!1))},c.prototype.recalcRange=function(t,n,e,i,r){var t=this.getSourceModel(t);-1===e?t.gF(n,0,i,t.cC()):-1===n?t.gF(0,e,t.rC(),r):t.gF(n,e,i,r),this.IsSuspended()||this.recalculateAll(!1)},c.prototype.evaluate=function(t,n,e,i,r){var o,n,o=this,n=n instanceof Q.Expression?n:o.parse(t,n,e,i);return o.MX.evaluateExpression(n,t.getEvaluatorContext(ot(e,i),!1),!1,r,r)},c.prototype.Abt=function(t,n,e,i,r){var o,a,u;if(!et(n)){if(o=this.MX,(a=r)||((a=t.getEvaluatorContext(e,!1,q,n)).S_t=i),o.asyncManager.startCalcCell(t,e),u=this.MX.evaluateExpression(n,a,i,!0,!0),o.asyncManager.endCalcCell(),!r)return new Promise(function(t,n){o.asyncManager.T_t(e.Tbt)?a.A_t=t:t(u)}).then(function(t){return o.asyncManager.I_t(e.Tbt),t});o.asyncManager.x_t(e.Tbt)&&a.A_t(u)}},c.prototype.BI=function(t,n,e,i,r,o,a,u,s){var c,f,l,h,t,o,e,s,u,d,v,m,t,e,n;if(!et(n)){if(c=e.row||0,f=e.col||0,l=o?o.row:c,h=o?o.col:f,(t=t.getEvaluatorContext(e,i,o,n,s)).N_t=u,e=4===arguments.length&&i||a,this.allowDynamicArray&&!i&&(t.k_t=!n.ensureSingle),(o=this.MX.evaluateExpression(n,t,r,e&&!n.ensureSingle,e&&!n.ensureSingle))&&o.pause)return o;if(i&&arguments.length<=5)return o;if(!i&&a&&(Q.Convert.LE(o)||Q.Convert.Nh(o)))return o;if(Q.Convert.LE(o)){if(s=o.getRowCount(0),u=o.getColumnCount(0),1!==o.getRangeCount())return tt;try{if(d=i?c-l:c-o.getRow(0),v=i?f-h:f-o.getColumn(0),m=ot(0,0),1!==s||1!==u)if(1===s&&1<u&&0<=v&&v<u)m.col=v;else if(1<s&&1===u&&0<=d&&d<s)m.row=d;else{if(!(i&&d<s&&v<u))return i?nt:tt;m.row=d,m.col=v}o=o.getValue(m,0)}catch(t){return tt}}else if(Q.Convert.Nh(o))if(i){if(e=(t=o).getRowCount(),n=t.getColumnCount(),1!==e&&e<=c-l||1!==n&&n<=f-h)return nt;o=o.getValue(1===e?0:c-l,1===n?0:f-h)}else o=o.getValueByIndex(0);return o!==$&&o!==q||!1===r?o:0}},c.prototype.onAddAdjust=function(t,n){this.YDt.Qyt(t,n)},c.prototype.onRemoveSource=function(t){this.YDt.nwt(t)},c.prototype.createSourceModel=function(t,n){return new B(t,n)},c.prototype.Pw=function(){var t,n,e,i,t=this.rO;for(n in t)(e=t[n])instanceof B&&(i=e.getAllNodes()).forEach(function(t){var t=t.calc;t&&(t.k1=!1,t.C3||t.DF)&&(t.DF=t.C3=q)})},v.CalcService=c,v.setSpillValues=mt,v.markAnchorCellDirty=bt,f.getLength=function(t,n){return o(t)?t.getRowCount()*t.getColumnCount():a(t)?t.getRowCount(n=n||0)*t.getColumnCount(n):void 0},f.getRowCount=function(t,n){return o(t)?t.getRowCount():a(t)?t.getRowCount(n=n||0):void 0},f.getColumnCount=function(t,n){return o(t)?t.getColumnCount():a(t)?t.getColumnCount(n=n||0):void 0},f.getValueByIndex=function(t,n,e){var i;return o(t)?t.getValueByIndex(n):a(t)?(i=t.getColumnCount(e=e||0),t.getValue(e,parseInt((n/i).toString(),10),n%i)):void 0},f.getValue=function(t,n,e,i){return o(t)?t.getValue(n,e):a(t)?t.getValue(i=i||0,n,e):void 0},v.CalcArrayHelper=f,h.prototype.getNode=function(t,n,e){var i,r,o,i=this,r=q;return 0<=t&&0<=n?(o=i.dataTable[t],e&&!o&&(o=i.dataTable[t]={},t>i.I8)&&(i.I8=t),o&&(r=o[n],e)&&!r&&(r=o[n]={},n>i.x8)&&(i.x8=n)):-1===t&&0<=n?(r=i.IE[n],e&&!r&&(r=i.IE[n]={},n>i.x8)&&(i.x8=n)):0<=t&&-1===n?(r=i.AE[t],e&&!r&&(r=i.AE[t]={},n>i.x8)&&(i.x8=n)):-1===t&&-1===n&&(r=i.xE,e)&&!r&&(r=i.xE={}),r},h.prototype.getNodeByName=function(t,n){var e,i,e=this,i=e.dataTableByName[t];return i=n&&!i?e.dataTableByName[t]={}:i},h.prototype.pB=function(t,n){var t=this.getNode(t,n);return t&&t.WK},h.prototype.Fyt=function(t,n){var t=this.getNode(t,n);return t&&t.eyt},h.prototype.sT=function(t,n){return this.getWorkingNodeInfo(t,n,2)},h.prototype.M_t=function(t,n){return this.getWorkingNodeInfo(t,n,1)},h.prototype.ODt=function(t,n){return this.getWorkingNodeInfo(t,n,0)},h.prototype.D_t=function(t){var t=this.getNodeByName(t);return t&&t.eyt},h.prototype.$yt=function(t){var t=this.getNodeByName(t);return t&&t.WK},h.prototype.clearAll=function(){var t=this;t.clear(-1,-1,-1,-1),t.dataTable={},t.dataTableByName={},t.AE=[],t.IE=[],t.xE=q},h.prototype.clear=function(t,n,e,i,r){this.d5(t,n,e,i,r)},h.prototype._Mt=function(){var t=this;It(t.AE),It(t.IE),It(t.dataTable,!0),It(t.dataTableByName),t.DMt()},h.prototype.DMt=function(){var t=this;t.dataTable={},t.dataTableByName={},t.AE=[],t.IE=[],t.xE=q,t.XDt=[],t.qDt=[],t.__t=q,t.E_t=q},h.prototype.addRows=function(t,n){var e,i,r,e=this,i=e.rC();if(!(t<0||i<t||n<0))for(M(e.dataTable,i,t,n),M(e.AE,i,t,n),r=0;r<n;r++)e.dataTable[t+r]&&(e.dataTable[t+r]={rs:"n"})},h.prototype.deleteRows=function(t,n){var e,i,e=this,i=e.rC();t<0||i<=t||n<=0||(C(e.dataTable,i,t,n=i<t+n?i-t:n),C(e.AE,i,t,n))},h.prototype.addColumns=function(t,n){var e,i,r,o,a,e=this,i=e.rC(),r=e.cC();if(!(t<0||r<t||n<0)){for(o=0;o<i;o++)(a=e.dataTable[o])&&t<r&&M(a,r,t,n);M(this.IE,r,t,n)}},h.prototype.deleteColumns=function(t,n){var e,i,r,o,a,e=this,i=e.rC(),r=e.cC();if(!(t<0||r<=t||n<0)){for(o=0;o<i;o++)(a=this.dataTable[o])&&C(a,r,t,n);C(this.IE,r,t,n)}},h.prototype.j_t=function(t,n,e){var i,e,r,i=[t,n];return e&&(i.newValue=e),(e=this.getNode(t,n))&&(e.WK&&(!(r=e.$bt)||r.row===t&&r.col===n)&&this.getSource().setFormula(t,n,this.getFormula(t,n),r,!0),i.push(e.WK,e.eyt,e.$bt)),i},h.prototype.Vyt=function(t,n,e,i){t&&t.push(this.j_t(n,e,i))},h.prototype.pj=function(){var t=this.getSource(),t=t&&t.getSheet(),t=t&&t.Ut;return t&&t.pj()},h.prototype.kMt=function(t,n,e,i,r){var o=this;-1===t?o.iwt(n,e,i):-1===n?o.ewt(t,e,i):o.Gyt(t,n,e,i,r)},h.prototype.bB=function(t,n,e,i){var r=this.getNode(t,n,!!e);r&&(i&&i.push([t,n,r.WK]),r.WK=e)},h.prototype.O_t=function(t,n,e,i,r,o,a){var u=this.getNode(t,n,!!e);u&&(this.Vyt(a,t,n),u.WK=e,(u.eyt||i)&&(u.eyt=i),(u.$bt||r)&&(u.$bt=r),u.isVolatile&&!e?this.R_t(u):(o||u.isVolatile)&&(u.isVolatile=o))},h.prototype.zyt=function(t,n,e){this.O_t(t,n,$,$,$,!1,e)},h.prototype.Lyt=function(t,n,e,i,r,o){var n=this.getNode(n,e);n&&n.WK&&t.O_t(i,r,n.WK,n.eyt,n.$bt,n.isVolatile,o)},h.prototype.B_t=function(t,n){var t=this.dataTable[t];return t&&t[n]},h.prototype.Yyt=function(t,n,e){var t=this.getNode(t,n,!!e);t&&(t.eyt=e)},h.prototype.Uyt=function(t,n,e){var t=this.getNode(t,n,!!e);t&&(t.$bt=e)},h.prototype.rwt=function(t,n){var t=this.getNode(t,n);return t&&t.calc},h.prototype.L_t=function(t,n,e){var t=this.getNode(t,n,!0);t&&(t.calc&&t.calc.isVolatile&&this.R_t(t),t.calc&&t.calc.isPivotData&&this.F_t(t),t.calc=e)&&(e.node=t)},h.prototype.owt=function(t,n,e){var t=this.getNode(t,n,!0);t&&t.calc&&(t.calc.isVolatile&&this.R_t(t),t.calc.isPivotData&&this.F_t(t),this.Lbt.b_t(t.calc,e),t.calc=$)},h.prototype.P_t=function(t,n,e,i,r){var o,a,u,s,o=this,a=o.usedRange;0<=e&&0<=i?(s=(u=(u=o.dataTable[e])||(o.dataTable[e]={}))[i],(u[i]=r)&&r.calc&&delete r.calc,a&&_t(a,e,i,s,r)):0<=e&&-1===i&&0<=t&&-1===n?o.AE[e]=r:0<=i&&-1===e&&0<=n&&-1===t&&(o.IE[i]=r)},h.prototype.SE=function(t,n,e,i){var r,o,a,r=this,o=r.getNode(t,n),a=r.getNode(e,i);o&&o.WK?r.P_t(t,n,e,i,o):a&&a.WK&&r.P_t(t,n,e,i,q),a&&a.WK?r.P_t(e,i,t,n,a):o&&o.WK&&r.P_t(e,i,t,n,q)},h.prototype.G_t=function(t,n,e){t.isIterativeCalc||(t.isIterativeCalc=!0,this.$Dt.push(t),n)||dt(t,e)},h.prototype.U_t=function(t){delete t.isIterativeCalc},h.prototype.H_t=function(){for(var t,n,e,i,r,t=this,n=[],e=t.$Dt,i=t.$Dt.length,r=0;r<i;r++)e[r].isIterativeCalc&&n.push(e[r]);return t.$Dt=n,t.$Dt},h.prototype.lwt=function(){return this.XDt},h.prototype.z_t=function(){return this.qDt},h.prototype.nbt=function(t){t.isVolatile||(t.isVolatile=!0,this.XDt.push(t))},h.prototype.V_t=function(t){t.isPivotData||(t.isPivotData=!0,this.qDt.push(t))},h.prototype.R_t=function(t){var t,n,e,i,r;if(t.isVolatile=$,(t=this).t_t++,100<t.t_t){for(t.t_t=0,n=[],e=t.XDt,i=t.XDt.length,r=0;r<i;r++)e[r].isVolatile&&n.push(e[r]);t.XDt=n}},h.prototype.F_t=function(t){var t,n,e,i,r;for(t.isPivotData=$,n=[],e=(t=this).qDt,i=t.qDt.length,r=0;r<i;r++)e[r].isPivotData&&n.push(e[r]);t.qDt=n},h.prototype.getCalcService=function(){return this.Lbt},h.prototype.setCalcService=function(t){this.Lbt=t},h.prototype.op=function(){return this.Lbt},h.prototype.getSource=function(){return this.rT},h.prototype.hasFormula=function(t,n){return t=t!==$?t:-1,n=n!==$?n:-1,!!this.ODt(t,n)},h.prototype.setFormula=function(t,n,e,i,r,o,a,u,s){var c,f,l,h,o,l,d,v,c=this;if(e&&0===e.length&&(e=q),f=s&&e&&!i,r||f||!c.EF(t,n,1,1)||c.Y_t(),l=c.getFormula(t,n),h=c.sT(t,n),o||l!==e&&(""!==l||e)&&(l||""!==e)||l===e&&h){if(o=c.op(),l=q,o)try{d=0<=t?t:0,v=0<=n?n:0,l=i||(e?o.parse(c.rT,e,d,v,!1,r,$,s):q),c.SB(t,n,l,$,!1,a,u)}catch(t){if(!r&&!f)throw t}0<=t&&0<=n&&c.rT.setFormula(t,n,e,$)}},h.prototype.getFormula=function(t,n,e){var i,r,o,i=this.op();return i&&(r=this.ODt(t,n))?(t=(o=this.sT(t,n))&&!0!==o.isDynamicArray?o.row:t,n=o&&!0!==o.isDynamicArray?o.col:n,i.unparse(this.rT,r,t,n,e)):q},h.prototype.setFormulaByName=function(t,n,e,i,r){var o,a,a,u;if(t&&(t=U(t),n&&0===n.length&&(n=q),(a=(o=this).getFormulaByName(t))!==n)&&(""!==a||n)&&(a||""!==n)){if(a=o.op(),u=q,a)try{u=n?a.parse(o.rT,n,0,0,!1,e):q,o.twt(t,u,$,!1,i,r)}catch(t){if(!e)throw t}o.rT.setFormula({name:t},n)}},h.prototype.getFormulaByName=function(t){var n,t,n=this.op();return n&&t&&(t=this.$yt(U(t)))?n.unparse(this.rT,t,0,0):q},h.prototype.Y_t=function(){throw(0,Q.sR)().Exp_ArrayFormulaPart},h.prototype.rC=function(){return l(this.rT.getRowCount())},h.prototype.cC=function(){return l(this.rT.getColumnCount())},h.prototype.setArrayFormula=function(t,n,e,i,r,o,a,u,s){var c,f,l,h,d,v,c=this;if(r&&0===r.length&&(r=q),!c.rT.G3&&c.EF(t,n,e,i)&&c.Y_t(),t=t<0?0:t,n=n<0?0:n,l=c.op()){if(c.d5(t,n,e,i,a),r){try{l.forceR1C1Formula?(h=l.useR1C1,l.useR1C1=!0,f=r?l.parse(c.rT,r,t,n,!1,o,!1):q,l.useR1C1=h):f=r?l.parse(c.rT,r,t,n,!1,o,o):q}catch(t){if(o)return;throw t}for(d=t;d<t+e;d++)for(v=n;v<n+i;v++)c.SB(d,v,f,I(t,n,e,i),!1,a,u,s)}0<=t&&0<=n&&c.rT.setArrayFormula(t,n,e,i,l.unparse(c.rT,f,t,n))}},h.prototype.getWorkingNodeInfo=function(t,n,e){var i,r,o,i=this,o=i.rT;return t>=o.getRowCount()||n>=o.getColumnCount()?r:(0<=t&&0<=n?(!(r=!(r=i.getNode(t,n))||0===e&&!r.WK||1===e&&!r.eyt||2===e&&!r.$bt?i.getNode(t,-1):r)||0===e&&!r.WK||1===e&&!r.eyt||2===e&&!r.$bt)&&(r=i.getNode(-1,n)):r=0<=t&&-1===n?i.getNode(t,-1):-1===t&&0<=n?i.getNode(-1,n):i.getNode(-1,-1),r&&(0===e&&r.WK||1===e&&r.eyt||2===e&&r.$bt))},h.prototype.SB=function(t,n,e,i,r,o,a,u){var s,c,f,l,h,d,v,m,f,v,g,f,s=this,c=s.op();c.Z_t&&c.MX.asyncManager.endCalcCell(),l=(f=i!==$&&null!==i)?i.row:t,h=f?i.col:n,d=s.rT,v=new X.EvaluateContext(d,ot(l,h),f),e&&e.sMt||(m=c.allowDynamicArray?kt(v,e,f,f?t-i.row:0,f?n-i.col:0,!0,!0):Nt(v,e,f,f?t-i.row:0,f?n-i.col:0),(f=v.n_t)&&(delete v.n_t,1===f)&&(v=c.unparse(d,e,l,h),e=c.parse(d,v,l,h)),(m=m===e?$:m)&&(m.ensureSingle=e.ensureSingle),et(m)&&!et(e&&e.aMt)&&(e.sMt=!0)),i!==$&&(g=i),0<=t&&0<=n?(r!==$&&!r||(f=e?c.unparse(d,e,t,n):$,s.rT.setFormula(t,n,f,g)),s.Gyt(t,n,e,m,g,o,a)):0<=t&&-1===n?s.ewt(t,e,m,o,a):-1===t&&0<=n&&s.iwt(n,e,m,o,a),c.autoCalculation&&!c.IsSuspended()&&c.recalculateAll(!1,void 0,u)},h.prototype.twt=function(t,n,e,i,r,o){var a,u,s,c,i,f,a=this,u=a.op(),s,c=kt(new X.EvaluateContext(a.rT,ot(0,0),!1),n,!1,0,0);c=c===n?$:c,i!==$&&!i||r||(i=a.getFormulaByName(t),f=n?u.unparse(a.rT,n,0,0):$,a.rT.setFormulaByName&&a.rT.setFormulaByName(t,f,i)),a.W_t(t,n,c,null,o),!u.autoCalculation||u.IsSuspended()||r||u.recalculateAll(!1)},h.prototype.getRowExpression=function(t){return this.pB(t,-1)},h.prototype.getColumnExpression=function(t){return this.pB(-1,t)},h.prototype.W_t=function(t,n,e,i,r){var o,a,u,o,a=this.C_t(t,!0);a&&(r||a.CMt(),(u=this.getNodeByName(t,!0)).WK=n,i&&(i[0].push("dataTable",t),i[1]=u.WK),e=n&&e?e:$,u.eyt=e,r||a.yB(),a.vyt())},h.prototype.Gyt=function(t,n,e,i,r,o,a){var u,s,o,u=this,s=u.oT(t,n,!0);s&&(u.Vyt(o,t,n),(o=u.Lbt).onClearExpr(u.rT,ot(t,n)),Ct(o,s,s.QDt,!1),delete s.QDt,delete s.qkt,s.CMt(),u.bB(t,n,e),e?((i||u.Fyt(t,n))&&u.Yyt(t,n,i),r&&!0===r.isDynamicArray||u.Uyt(t,n,r)):(u.Yyt(t,n,$),u.Uyt(t,n,$)),u.cMt||s.yB(),s.vyt())},h.prototype.ewt=function(t,n,e,i,r){var o,a,o=this,a=o.cwt(t,!0);a&&(o.Vyt(i,t,-1),r||a.CMt(),o.bB(t,-1,n),(e||o.Fyt(t,-1))&&o.Yyt(t,-1,e),r||a.yB(),a.vyt())},h.prototype.iwt=function(t,n,e,i,r){var o,a,o=this,a=o.uwt(t,!0);a&&(o.Vyt(i,-1,t),r||a.CMt(),o.bB(-1,t,n),(e||o.Fyt(-1,t))&&o.Yyt(-1,t,e),r||a.yB(),a.vyt())},h.prototype.d5=function(t,n,e,i,r){for(var o,a,u,s,c,f,l,h,d,h,v,m,g,p,o=this,a=t<0?0:t,u=n<0?0:n,s,c,f=a+(t<0?o.rC():e)-1,l=u+(n<0?o.cC():i)-1,v=function(t,n){var e;h=o.Fyt(t,n),d=o.pB(t,n),(h||d)&&(e=(h=o.sT(t,n))&&!0!==h.isDynamicArray?I(h.row,h.col,h.rowCount,h.colCount):$,o.SB(t,n,q,e,!0,r))},m=o.usedRange,g=a;g<=f&&0<=g;g++)for(n<0&&(v(g,-1),m)&&m.removeRowAndColInfo(g,-1),p=u;p<=l&&0<=p;p++)g===a&&t<0&&(v(-1,p),m)&&m.removeRowAndColInfo(-1,p),v(g,p),m&&m.removeRowAndColInfo(g,p);t<0&&n<0&&v(t,n)},h.prototype.EF=function(t,n,e,i){return this.mMt(t,n,e,i,!0,!0)},h.prototype.mMt=function(t,n,e,i,r,o){for(var a,u,s,c,f,l,h,d,v,m,g,p,b,y,w,M,C,S,T,a=this,u=t<0?0:t,s=n<0?0:n,c=t<0?a.rC():e,f=n<0?a.cC():i,l=u+(0===c?1:c)-1,h=s+(0===f?1:f)-1,d=!1,v=[],m=[],b=a.dataTable,y=u;y<=l&&0<=y&&!(y>a.I8);y++)if(p=b[y])for(w=s;w<=h&&0<=w&&!(w>a.x8);w++)if(g=p[w])if(C=void 0,(M=g.$bt)&&!M.isDynamicArray){if(M.row<u||M.row+M.rowCount-1>l||M.col<s||M.col+M.colCount-1>h){if(r)return S=M.row===t&&0===e,T=M.col===n&&0===i,!S&&!T;d=!0}y!==M.row&&y!==u||(v.push(I(M.row,M.col,M.rowCount,M.colCount)),C=g.WK,m.push(C),w=M.col+M.colCount-1)}else o||(C=g.WK)&&(v.push({row:y,col:w}),m.push(C));return!r&&{hasPart:d,ranges:v,formulas:m}},h.prototype.getCalcObj=function(){for(var t,n,e,i,r,o,a,u,s,c,f,l,t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];if(i=t[1],r=this,o=(e=t[0]).row,a=e.column,u=null,isNaN(o)||isNaN(a))e.name&&(u=r.C_t(e.name,i));else if(0<=o&&0<=a)if(e.hmt())u=r.oT(o,a,i);else for(s=e.endRow,c=e.endColumn,u=[],f=o;f<=s;f++)for(l=a;l<=c;l++)u.push(r.oT(f,l,i));else 0<=o?u=r.cwt(o,i):0<=a&&(u=r.uwt(a,i));return u},h.prototype.C_t=function(t,n){var e,i,r,e=this,i=q,r=e.getNodeByName(t,n);return r&&!(i=r.calc)&&n&&(i=new E(e,t),(r.calc=i).node=r),i},h.prototype.MMt=function(t){var n,e,i,r,n=this.dataTable;for(e in n)for(i in n[e])(r=n[e][i])&&r.calc&&t(r.calc)},h.prototype.oT=function(t,n,e){var i,r,o,a,o,i=this,r=q;if(0<=t&&0<=n){if(!(a=(o=i.dataTable)[t])){if(!e)return r;a=o[t]={},t>i.I8&&(i.I8=t)}if(!(o=a[n]))return e&&(o=a[n]={},r=new H(i,t,n),(o.calc=r).node=o,n>i.x8)&&(i.x8=n),r;!(r=o.calc)&&e&&(r=new H(i,t,n),(o.calc=r).node=o,t>i.I8&&(i.I8=t),n>i.x8)&&(i.x8=n)}return r},h.prototype.cwt=function(t,n){var e,i,e=this,i=q;return 0<=t&&!(i=e.rwt(t,-1))&&n&&(i=new L(e,t),e.L_t(t,-1,i),t>e.I8)&&(e.I8=t),i},h.prototype.uwt=function(t,n){var e,i,e=this,i=q;return 0<=t&&!(i=e.rwt(-1,t))&&n&&(i=new F(e,t),e.L_t(-1,t,i),t>e.x8)&&(e.x8=t),i},h.prototype.uT=function(t){var n=this;return!n.__t&&t&&(n.__t=new G(n)),n.__t},h.prototype.vwt=function(t,n){var e,i,e=this;return t=U(t),e.E_t||(e.E_t={}),i=!(i=e.E_t[t])&&n?e.E_t[t]=new P(e,t):i},h.prototype.updateNameCalc=function(t,n){var t=this.vwt(U(t));t&&(t.updateListening(!0,n),t.vyt())},h.prototype.Q_t=function(t,n){for(var e,i,r,o,e=this,i=l(e.x8,t+n-1),r=t;-1!==r&&r<=i;r++)e.isDirty(-1,r)&&(o=e.uwt(r,!0),e.Lbt.I3(o,2))},h.prototype.K_t=function(t,n){for(var e,i,r,o,e=this,i=l(e.I8,t+n-1),r=t;-1!==r&&r<=i;r++)e.isDirty(r,-1)&&(o=e.cwt(r,!0),e.Lbt.I3(o,1))},h.prototype.gF=function(t,n,e,i){for(var r,o,a,u,s,c,f,r=this,o=null,a=l(r.I8,t+e-1),u=l(r.x8,n+i-1),s=t;s<=a;s++)for(c=n;c<=u;c++)r.B_t(s,c)&&(r.Lbt.calcOnDemand?(o=r.oT(s,c,!1))&&(o.o_t(),o.k1=!0):(o=r.oT(s,c,!0),r.Lbt.I3(o,0)));r.K_t(t,e),r.Q_t(n,i),(f=r.uT(!1))&&f.o_t(t,n,e,i)},h.prototype.p3=function(){var n,t,n=this;n.MMt(function(t){t.J_t(n)}),(t=n.uT(!1))&&t.J_t(n)},h.prototype.X_t=function(){for(var t,n,e,e,i,r,e,t=this,n=t.lwt().concat(t.H_t()).concat(t.z_t()),i=0;i<n.length;i++)r=n[i],t.Lbt.calcOnDemand&&r&&(r.isVolatile||r.isIterativeCalc)&&(r.k1=!0,r.o_t()),r&&(r.isVolatile||r.isIterativeCalc||r.isPivotData)&&r instanceof H&&!t.q_t(r)&&(e=t.oT(r.row,r.column,!0),t.Lbt.I3(e,0),(e=t.cwt(r.row,!1))&&!t.$_t(e)&&t.K_t(r.row,1),e=t.uwt(r.column,!1))&&!t.$_t(e)&&t.Q_t(r.column,1)},h.prototype.q_t=function(t){var n=this.getCalcService().y3;return!!t.DF||t===(n&&n[0])},h.prototype.$_t=function(t){var n=this.getCalcService().y3;return t.DF||t===(n&&n[1])},h.prototype.isDirtyColumn=function(t){var n=this.getCalcService().y3;return t.DF||t===(n&&n[2])},h.prototype.isDirty=function(t,n){return!(!this.rwt(t,n)&&!this.pB(t,n))},h.prototype.recalculateForContext=function(t,n,e){var i,t,r,n,i=this.Lbt,t=i.getSourceModel(t),r=n.row,n=n.col;-1===n?t.gF(r,0,1,t.cC()):-1===r?t.gF(0,n,t.rC(),1):t.gF(r,n,1,1),i.IsSuspended()||i.recalculateAll(!1,e)},h.prototype.processDynamicListenerForCell=function(t,n){var e,i,r,o,a,u,s,c,f,l,h,d,e=this,i=e.rT,r=e.M_t(t,n)||e.ODt(t,n);r&&(o=ot(t,n),a=!1,f=c=s=u=void 0,(l=e.sT(t,n))&&!0!==l.isDynamicArray&&(a=!0,u=l.row,s=l.col,c=l.rowCount,f=l.colCount),h=e.Lbt,d=e.rT.getCalcSourceModel().oT(t,n),h.BI(e.rT,r,o,a,!0,l&&!0!==l.isDynamicArray&&I(u,s,c,f),h.allowDynamicArray,!1,d),yt(d,i,h,t,n,!1))},h.prototype.recalculateCell=function(t,n){var e,i,r,o,a,u,s,c,f,l,h,d,v,m,g,p,b,y,w,M,d,g,p,n,t,m,w,C,S,T,e=this,i=e.rT,r=t.row,o=t.column,a=e.M_t(r,o)||e.ODt(r,o),s=i,c=s.G3,f=s&&s.Mf&&s.Mf.Ut;if(f&&(l=f.Bj,f.Bj=!0),h=!1,a){if(d=ot(r,o),v=i.getValue(r,o,!0),m=!1,y=b=p=g=void 0,(w=e.sT(r,o))&&!0!==w.isDynamicArray&&(m=!0,g=w.row,p=w.col,b=w.rowCount,y=w.colCount),(M=e.Lbt).Z_t&&M.MX.asyncManager.startCalcCell(e.rT,d),d=M.BI(e.rT,a,d,m,!0,w&&!0!==w.isDynamicArray&&I(g,p,b,y),M.allowDynamicArray,n,t),n&&d&&d.pause)return d;if(yt(t,i,M,r,o,n),n&&0<t.delay)return{pause:"newDetectedRefs"};if(g=Q.Convert.LE(d)||Q.Convert.Nh(d),p=!1,!m&&M.allowDynamicArray&&!a.ensureSingle&&(a.t8t||g)&&(b=d.getRowCount?d.getRowCount():1,y=d.getColumnCount?d.getColumnCount():1,e.Uyt(r,o,n={row:r,col:o,rowCount:b,colCount:y,isDynamicArray:p=!0}),t=w&&w.rowCount||1,m=w&&w.colCount||1,t<b||m<y)&&(M.p_t=M.p_t||[],M.p_t.push([e,n])),h=!0,w=void 0,g&&((w=Q.Convert.iV(d,0,!1,!1,!1)).isError||w.isConvertError?(d=tt,g=!1):(b=w.rowCount,y=w.colCount,0===b||0===y?(d=x,g=!1):1===b&&1===y?(d=w[0][0],et(d)&&(d=0),g=!1):p||(a.$9t=!0,d=Q.Functions.findGlobalFunction("@").evaluate({row:r,column:o},d),g=!1))),g)(C=s.setArray(r,o,b,y,w))&&mt(C[1],s);else if((C=s.updateItem&&s.updateItem(r,o,d))&&(mt(C[0],s),u=C[1]),v!==d||"string"==typeof d&&d[S="hyperlink"]){if(v instanceof Date){if(d instanceof Date&&v.valueOf()===d.valueOf())return!1;if(typeof d===it){if((T=A.o0(v))===d)return!1;d=A.Y0(d)}}i.setValue(r,o,d,v)}else h=!1;M.Z_t&&M.MX.asyncManager.endCalcCell(),s.Vbt&&s.Vbt(r,o)}else c||(C=s.updateItem&&s.updateItem(r,o,q))&&(mt(C[0],s),u=C[1]);return f&&(u&&bt(u,e,f.t8),f.Bj=l),h},h.prototype.recalculateNameID=function(t){var n,e,i,r,n,n=this,e=n.rT,i=n.D_t(t)||n.$yt(t);!i||(r=e.getValueByName?e.getValueByName(t):e.getValue({name:t}))===(n=n.Lbt.BI(n.rT,i,{name:t},!1,!0))||r instanceof Date&&n instanceof Date&&r.valueOf()===n.valueOf()||(e.setValueByName?e.setValueByName(t,n):e.setValue({name:t},n))},h.prototype.addDirtyNodesForCalc=function(t,n){var e,t,i,e=this;!1!==t?(t=e.cC(),i=e.rC(),e.Q_t(0,t),e.K_t(0,i),e.gF(0,0,i,t)):n||e.X_t()},h.prototype.addListenersToDirtyForRow=function(t){for(var n,e,i,r;t.y3[1];){for(i=(e=(n=t.y3[1]).w3).cC(),r=0;r<i;r++)t.I3(e.oT(n.row,r,!0),0);t.b_t(n,1)}},h.prototype.addListenersToDirtyForCol=function(t){for(var n,e,i,r;t.y3[2];){if(0<(i=(e=(n=t.y3[2]).w3).rC()))for(r=0;r<i;r++)t.I3(e.oT(r,n.column,!0),0);else n.o_t();t.b_t(n,2)}},h.prototype.n8t=function(t,n){for(var e,i,e=t.length,i=n;i;)t[e]=i,e++,i=i.C3},h.prototype.addListenersToDirty=function(t,n){var e,i,r,o,a,u,s,c,u,f,l,h,d,v,m;if(1===n)this.addListenersToDirtyForRow(t);else if(2===n)this.addListenersToDirtyForCol(t);else if(0===n)for(e=[],t.y3[2]&&this.n8t(e,t.y3[2]),i=t.y3[0];i;i=i.C3)for(r=i.w3,o=i.row,a=i.column,u=r.cwt(o,!1),s=r.uwt(a,!1),c=r.uT(!1),i.o_t(),u&&u.o_t(),s&&s.o_t(),c&&((u=i.node&&i.node.$bt)&&u.isDynamicArray?c.o_t(o,a,u.rowCount,u.colCount):c.o_t(o,a,1,1)),this.addListenersToDirtyForRow(t);t.y3[2];){for(f=t.y3[2],l=!1,h=0;h<e.length;h++)if(e[h]===f){l=!0;break}if(l);else{for(d=(r=(e[e.length]=f).w3).rC(),v=0;v<d;v++)t.I3(r.oT(v,f.column,!0),0)}t.b_t(f,2)}else if(3===n)for(m=t.y3[3];m;m=m.C3)m.o_t()},h.prototype.initDelay=function(t,n){var e,i,r,o,a,o,u;if(!t.calcOnDemand)if(0===n)for(e=null,i=t.y3[0];i;i=e)i.QDt&&(Ct(t,i,i.QDt,!1),delete i.QDt),e=i.C3,o=(r=i.w3).rC(),a=r.cC(),i.row<o&&i.column<a?(v.supportRowColumnFormula&&(o=r.uwt(i.column,!1))&&(o.delay=0),i.delay=0,delete i.u_t):t.b_t(i,0);else if(3===n)for(u=t.y3[3];u;u=u.C3)u.delay=0},h.prototype.adjustDelayOfListeners=function(t,n,e){var i,r,o,a,u,s,r,c;if(!t.calcOnDemand)if(0===n)for(i=t.y3[n];i;i=i.C3)r=i.w3,o=i.row,a=i.column,u=r.cwt(o,!1),s=r.uwt(a,!1),r=r.uT(!1),i.a_t(e),u&&u.a_t(e),s&&s.a_t(e),r&&r.a_t(o,a,e);else if(3===n)for(c=t.y3[3];c;c=c.C3)c.a_t(e)},h.prototype.calculateDirtyNodes=function(t,n){var e,i,r,o,a,u,s,c,f,a,l,h,d,a,v;if(t.calcOnDemand)return!1;if(e=!1,i=null,0===n){for(o=t.y3[n];o;o=r)if(r=o.C3,a=!1,o.i9t&&(a=!0,delete o.i9t),(o.delay<=0||a)&&(this.U_t(o),i=o.w3,u=o.row,s=o.column,c=i.cwt(u,!1),!(f=i.uwt(s,!1))||!f.delay)){if(a=i.uT(!1),(l=i.recalculateCell(o,!o.e8t||o.e8t<32))&&l.pause){if(o.e8t=o.e8t?o.e8t+1:1,l.branch)for(r=o,h=0;h<l.branch.length;h++)(l.branch[h].DF||l.branch[h].C3||l.branch[h]===o)&&(o.delay++,(d=l.branch[h]).u_t=d.u_t||[],d.u_t.push(o))}else delete o.e8t,t.b_t(o,0),o.a_t(!1),c&&c.a_t(!1),f&&f.a_t(!1),a&&a.a_t(u,s,!1),(a=o.node&&o.node.WK)&&a.lMt&&delete a.lMt;e=!0}}else if(3===n)for(v=t.y3[n];v;v=r)r=v.C3,0===v.delay&&(v.P6t?v.P6t():(i=v.w3).recalculateNameID(v.name),t.b_t(v,3),v.a_t(!1),e=!0);return e},h.prototype.calculateIterations=function(t,n){var e,i,r,o,a,u,s,c,f,l,h,c,d;if(!t.calcOnDemand&&0===n&&(e=t.y3[n])){if(r=!(i=null),t.iterativeCalculation){for(a in t.rO)t.rO.hasOwnProperty(a)&&(u=t.rO[a].getSource()).clearValueCache&&u.clearValueCache();for(s=0;r&&s<t.iterativeCalculationMaximumIterations;s++)for(r=!1,i=e;i;i=i.C3)delete i.e8t,o=i.node&&i.node.WK&&i.node.WK.lMt,this.G_t(i,!o,q),o&&(i.node.WK.lMt=$),c=i.w3,f=i.row,l=i.column,h=c.getSource().getValue(f,l),c.recalculateCell(i),r||(c=c.getSource().getValue(f,l),(0,v.approximatelyEqual)(h,c,t.iterativeCalculationMaximumChange))||(r=!0)}else for(i=e;i;i=i.C3)o=i.node&&i.node.WK&&i.node.WK.lMt,this.G_t(i,!o,0),o&&(i.node.WK.lMt=$),delete i.e8t;for(d=null,i=e;i;i=d)d=i.C3,i.C3=$,d&&(d.DF=$)}},h.prototype.cyt=function(t,n,e,i,r,o,B){var a,u,s,c,f,l,h,L,F,d,v,m,g,p,b,y,w,M,C,S,T,A,h,f,I,h,x,N,P,k,D,_,h,E,E,j,p,O,d,G,R,b,h,l,a=this;if(o&&a.U_t(t),i){for(;12===i.type;)i=i.value;for(;10===i.type;)i=i.value;for(;12===i.type;)i=i.value;if(r){for(;12===r.type;)r=r.value;for(;10===r.type;)r=r.value;for(;12===r.type;)r=r.value}if(13===i.type){if((h=i.getRange(n,e,!0))===q)return;i=1===h.rowCount&&1===h.colCount?(0,J.knt)(i.source,q,h.row,h.col,!1,!1):(0,J.lJ)(i.source,q,h.row,h.col,h.row+h.rowCount-1,h.col+h.colCount-1,!1,!1,!1,!1)}if(r&&r!==i&&8===r.type){if(r.source instanceof Q.ErrorSource)return;s=r.value,T=i.source||r.source||B||a.rT,(f=(h=a.Lbt.getGlobalSourceModel()||T.getCalcSourceModel()).getSource()).addUsedCustomName&&f.addUsedCustomName(s),(c=T.getCustomName(s))?A=T.getCalcSourceModel():(A=h,(c=f.getCustomName(s))||(h=(I=T.getCalcSourceModel())&&I.vwt(s,!0))&&h.Iwt(0,t,o)),(f=A.vwt(s,!0)).Iwt(0,t,o),r=null,c&&a.cyt(t,n,e,c,q,o,A.getSource())}if(1===i.type&&i.endSource){if(N=(x=i).source.getSources(x.endSource))for(u=0;u<N.length;u++)(P=(0,J.lJ)(N[u],q,x.row,x.column,x.endRow,x.endColumn,x.rowRelative,x.columnRelative,x.endRowRelative,x.endColumnRelative,n,e)).isFullRow=x.isFullRow,P.isFullColumn=x.isFullColumn,a.cyt(t,n,e,P,q,o)}else if(1===i.type){if(k=a.rT,A=(T=i.source!==Q.BangSource&&i.source||k).getCalcSourceModel(),k&&k.G3&&T&&k.id!==T.id&&T.getSheet&&T.getSheet()&&k.addReferenceSheetName(T.getSheet().name()),!A&&T.ayt&&T.cyt&&T.cyt(t,o,i),A)if(D=i,_=t.row===$||t.column===$,h=D.Tyt(),d=(E=(0,J.getRangeForReference)(D,n,e)).row,m=E.col,v=d+(p=E.rowCount)-1,g=m+(b=E.colCount)-1,0===h){if(0<=n&&0<=e)if(Dt(E))l=A.uT(!0),_?l.i8t(d,m,p,b,t,o):l.JDt(d,m,p,b,t,o);else for(C=d;C<=v;C++)for(S=m;S<=g;S++)y=A.oT(C,S,!0),_?y&&y.Iwt(3,t,o):y&&y.Iwt(0,t,o);else if(0<=n&&-1===e)for(C=d;C<=v;C++)for(S=m;S<=g;S++)D.columnRelative||D.endColumnRelative?(w=A.cwt(C,!0))&&w.r8t(t.row,-S,o):(y=A.oT(C,S,!0))&&y.Iwt(1,t,o);else if(0<=e&&-1===n)for(C=d;C<=v;C++)for(S=m;S<=g;S++)D.rowRelative||D.endRowRelative?(M=A.uwt(S,!0))&&M.o8t(t,-C,o):(y=A.oT(C,S,!0))&&y.Iwt(2,t,o)}else if(1===h){if(0<=n&&0<=e)l=A.uT(!0),_?l.i8t(d,m,p,b,t,o):l.JDt(d,m,p,b,t,o);else if(!(0<=n&&-1===e)&&-1===n&&0<=e&&!D.rowRelative&&!D.endRowRelative)for(d=D.row,v=D.endRow,C=d;C<=v;C++)(w=A.cwt(C,!0))&&w.Iwt(2,t,o)}else if(2===h){if(0<=n&&0<=e)l=A.uT(!0),_?l.i8t(d,m,p,b,t,o):l.JDt(d,m,p,b,t,o);else if(!(0<=n&&-1===e)&&-1===n&&0<=e)for(S=m;S<=g;S++)(M=A.uwt(S,!0))&&M.Iwt(2,t,o)}else 3===h&&(l=A.uT(!0),_?l.i8t(0,0,Q.MAX_ROW_COUNT,Q.MAX_COLUMN_COUNT,t,o):l.JDt(0,0,Q.MAX_ROW_COUNT,Q.MAX_COLUMN_COUNT,t,o))}else if(9===i.type)a.cyt(t,n,e,i.value,r&&9===r.type&&r.value,o),i.value2&&a.cyt(t,n,e,i.value2,r&&9===r.type&&r.value2,o);else if(8===i.type)!i.jwt&&(i.jwt=!0,T=i.source||B||a.rT,s=U(i.value),(c=T.getCustomName(s))?A=T.getCalcSourceModel():(c=(A=a.Lbt.getGlobalSourceModel()||T.getCalcSourceModel()).getSource().getCustomName(s))||(E=(I=T.getCalcSourceModel())&&I.vwt(s,!0))&&E.Iwt(0,t,o),f=A.vwt(s,!0))&&(f.Iwt(0,t,o),c&&a.cyt(t,n,e,c,q,o,A.getSource()),i.jwt=$);else if(7===i.type){if(!i.jwt){if(i.jwt=!0,j=i.function)if((0,Q.isExpression)(j))for(a.cyt(t,n,e,j,r&&7===r.type&&r.function instanceof Q.Expression&&r.function,o),O=i.arguments.length,u=0;u<O;u++)a.cyt(t,n,e,i.arguments[u],r&&7===r.type&&r.arguments[u],o);else for(j&&((d=j.u9t)&&a.Lbt.l_t(t,d,o),j.isVolatile()&&(o?a.nbt(t):a.R_t(t)),"GETPIVOTDATA"===j.name&&(o?a.V_t(t):a.F_t(t)),j instanceof Q.Functions.AsyncFunction)&&(a.Lbt.Z_t=!0),O=i.arguments.length,u=0;u<O;u++)j&&j.skipPrecedent(u)&&a.a8t(t,i,u,j,n,e)&&(t.e_t=!0),G=!1,this.Lbt.dynamicReferences&&j&&j.isBranch()&&j.findTestArgument()!==u&&t instanceof H&&(i.u8t=!0,R=n+","+e,i.s8t=i.s8t||{},i.s8t[R]=i.s8t[R]||[],i.s8t[R][u]=[],G=!0,t.ebt=t.ebt||[],t.ebt.push(i.s8t[R][u])),a.cyt(t,n,e,i.arguments[u],r&&7===r.type&&r.arguments[u],o),G&&t.ebt.pop(),delete t.e_t;else for(!i.isLocalFunctionName&&i.functionName&&((p=new Q.Expression(8)).value=i.functionName,a.cyt(t,n,e,p,i,o)),O=i.arguments.length,u=0;u<O;u++)a.cyt(t,n,e,i.arguments[u],r&&7===r.type&&r.arguments[u],o);i.jwt=$}}else 25===i.type||26===i.type?(h=(A=(T=(b=i).source||a.rT).getCalcSourceModel()).C_t(b.value,!0))&&h.Iwt(0,t,o):22!==i.type&&14!==i.type||(22===i.type&&(k=a.rT,T=i.source!==Q.BangSource&&i.source||k,k)&&k.G3&&T&&k.id!==T.id&&T.getSheet&&T.getSheet()&&k.addReferenceSheetName(T.getSheet().name()),(l=i).Iwt&&l.Iwt(t,o))}},h.prototype.a8t=function(t,n,e,i,r,o){var n,e,i,r,n=n.arguments[e];return!((n=12===n.type?n.value:n)&&n.function&&n.function.name||(i.i9t?!this.Lbt.dynamicReferences||!n||1!==n.type&&13!==n.type&&22!==n.type||(e=n.source||this.rT,this.Lbt.lb&&e&&e.getRangeKey&&((i=n.getRange(r,o)).rowUndefine&&(i.row=i.rowCount=-1),i.colUndefine&&(i.col=i.colCount=-1),i.id=e.id,r=e.getRangeKey(e,i),t.qkt||(t.qkt={}),t.qkt[r]=i,t.i9t=!0),0):!n||1!==n.type&&13!==n.type&&22!==n.type))},h.prototype.f_t=function(t,n){var e=this.getNodeByName(t);e&&(e.eyt||e.WK)&&this.cyt(this.C_t(t),0,0,e.eyt||e.WK,e.WK,n)},h.prototype.c8t=function(t,n,e,i,r){for(var o,a,u,s,c,f,l,h,d,o=this,a=t+e,u=n+i,l=t;l<a;l++)for(h=n;h<u;h++)s=o.Fyt(l,h),c=o.pB(l,h),(s||c)&&(f=o.sT(l,h),d=o.oT(l,h),f&&!0!==f.isDynamicArray?o.cyt(d,f.row,f.col,s||c,c,r):o.cyt(d,l,h,s||c,c,r),r&&d.qkt&&(Ct(d.c_t(),d,d.qkt,!0,!1),d.QDt=d.qkt,delete d.qkt),r||d.QDt&&Ct(d.c_t(),d,d.QDt,!1,!1))},h.prototype.f8t=function(t,n,e){for(var i,r,o,i=t+n,r=t;-1!==r&&r<i;r++)(o=this.getColumnExpression(r))&&this.cyt(this.uwt(r,!1),-1,r,o,o,e)},h.prototype.l8t=function(t,n,e,i){this.c8t(t,n,e,i,!0)},h.prototype.mF=function(t,n,e,i){this.c8t(t,n,e,i,!1)},h.prototype.h8t=function(t,n){},h.prototype.hwt=function(t,n){},h.prototype.d8t=function(t,n){this.f8t(t,n,!0)},h.prototype.dwt=function(t,n){this.f8t(t,n,!1)},h.prototype.v8t=function(t,n,e,i,r,o,a){for(var u,s,c,f,l,h,u=t+e,s=n+i,c=this,f=t;f<u;f++)for(l=n;l<s;l++)(h=this.oT(f,l,!1))&&(c.Vyt(a,f,l),r&&h.mB(),o)&&h.o_t()},h.prototype.m8t=function(t,n,e,i,r){var o,a,u,s,c,c,o=this,a=o.AE;if(-1!==t&&a)for(u=l(t+n,a.length),s=t;s<u;s++)(c=a[s])&&c.calc&&(o.Vyt(r,s,-1),c=c.calc,e&&c.mB(),i)&&c.o_t()},h.prototype.g8t=function(t,n,e,i,r){var o,a,u,s,c,c,o=this,a=o.IE;if(-1!==t&&a)for(u=l(t+n,a.length),s=t;s<u;s++)(c=a[s])&&c.calc&&(o.Vyt(r,-1,s),c=c.calc,e&&c.mB(),i)&&c.o_t()},h.prototype.Ryt=function(t,n,e,i,r,o,a){var u,s,a,c;(r||o)&&(u=this,s=void 0,a&&(s=u.pj()),0<=t&&0<=n?(u.v8t(t,n,e,i,r,o,s),u.m8t(t,e,r,o,s),u.g8t(n,i,r,o,s),u.__t&&(r&&u.__t.mB(t,n,e,i),o)&&u.__t.o_t(t,n,e,i)):0<=t&&-1===n?(u.v8t(t,0,e,u.cC(),r,o,s),u.m8t(t,e,r,o,s),u.__t&&(r&&u.__t.mB(t,n,e,i),o)&&u.__t.o_t(t,n,e,i)):-1===t&&0<=n?(u.v8t(0,n,u.rC(),i,r,o,s),u.g8t(n,i,r,o,s),u.__t&&(r&&u.__t.mB(t,n,e,i),o)&&u.__t.o_t(t,n,e,i)):-1===t&&-1===n&&(a=u.rC(),c=u.cC(),u.v8t(0,0,a,c,r,o,s),u.m8t(0,a,r,o,s),u.g8t(0,c,r,o,s),u.__t)&&(r&&u.__t.mB(t,n,e,i),o)&&u.__t.o_t(t,n,e,i))},h.prototype.getAllNodes=function(){var t,n,e,i,r,o,a,u,s,t=[],n=this.dataTable,e=this.AE,i=this.IE,r=this.xE;for(a in r&&t.push(r),e)e.hasOwnProperty(a)&&(o=e[a])&&t.push(o);for(a in i)i.hasOwnProperty(a)&&(o=i[a])&&t.push(o);for(u in n)if(n.hasOwnProperty(u)&&(s=n[u]))for(a in s)s.hasOwnProperty(a)&&(o=s[a])&&t.push(o);return t},h.prototype.toJSON=function(t){v.supportRowColumnFormula?this.rT.toJSON(t,this.dataTable,this.I8,this.x8,this.IE):this.rT.toJSON(t,this.dataTable,this.I8,this.x8)},h.prototype.wh=function(t,n){v.supportRowColumnFormula?this.rT.wh(t,this.dataTable,this.I8,this.x8,this.IE):this.rT.wh(t,this.dataTable,this.I8,this.x8,void 0,n)},B=h,v.CalcSourceModel=B,n(d,Z=t),d.prototype.getKey=function(){var t,n,e,t=this,n=t.w3,e;return(null===n?"":n.rT.id+",")+t.row+","+t.column},d.prototype.yB=function(){var t=this;t.w3.l8t(t.row,t.column,1,1)},d.prototype.CMt=function(){var t=this;t.w3.mF(t.row,t.column,1,1)},d.prototype.r_t=function(){this.w3.op().onAddAdjust(this,0)},d.prototype.vyt=function(){this.w3.op().I3(this,0)},d.prototype.J_t=function(n){for(var e,t,i,r,e=this.w3.op(),t=this.aT,i=0;i<t.length;i++)(r=this[t[i]])&&r.forEach(function(t){t&&t.w3&&t.w3!==n&&(t.DF||t.C3||t.vyt&&t.vyt(),e.calcOnDemand)&&!t.k1&&(t.k1=!0,t.J_t(n))})},d.prototype.o_t=function(){for(var n,t,e,i,r,o,a,u,n=this.w3.op(),t=this.aT,e=0;e<t.length;e++)(i=this[t[e]])&&i.forEach(function(t){!t||t.DF||t.C3||t.vyt(),n.calcOnDemand&&t&&!t.k1&&(t.k1=!0,t.o_t())});if((r=this.node&&this.node.$bt)&&r.isDynamicArray)for(o=0;o<r.rowCount;o++)for(a=0;a<r.colCount;a++)0===o&&0===a||(u=this.w3.getNode(o+r.row,a+r.col))&&u.calc&&u.calc.o_t()},d.prototype.s_t=function(){var t,n,e,i,r,i,n,o,i,e,n,t=this,n=t.w3,e=n.getCalcService();e&&e.Z_t&&(!(r=(i=t.Z_t)&&t.p8t)&&et(i)&&(i=n.getSource())&&(n=i.getName(),i=(o=e.MX.asyncManager).b8t[n])&&(e=i[t.row])&&(n=e[t.column])&&((r=n[0])?(t.Z_t=!0,(t.p8t=r).y8t=t):t.Z_t=!1),r)&&0===r.evaluateMode&&(r.yL=!1)},H=d,v.CellCalc=H,n(p,W=t),p.prototype.getKey=function(){var t,n,e,t=this,n=t.w3,e;return(null===n?"":n.rT.id+",")+t.row+",-1"},p.prototype.yB=function(){this.w3.h8t(this.row,1)},p.prototype.CMt=function(){this.w3.hwt(this.row,1)},p.prototype.r8t=function(t,n,e){(e?St:Tt)(this,k,{row:t,columnOffset:n,columnCount:1})},p.prototype.r_t=function(){this.w3.op().onAddAdjust(this,1)},p.prototype.vyt=function(){this.w3.op().I3(this,1)},L=p,v.RowCalc=L,n(b,ft=t),b.prototype.getKey=function(){var t,n,e,t=this,n=t.w3,e;return(null===n?"":n.rT.id+",")+"-1,"+t.column},b.prototype.yB=function(){this.w3.d8t(this.column,1)},b.prototype.CMt=function(){this.w3.dwt(this.column,1)},b.prototype.o8t=function(t,n,e){this.Iwt(2,t,e)},b.prototype.r_t=function(){this.w3.op().onAddAdjust(this,2)},b.prototype.vyt=function(){this.w3.op().I3(this,2)},F=b,v.ColumnCalc=F,n(At,lt=t),At.prototype.getKey=function(){var t,n,e,t=this,n=t.w3,e;return(null===n?"":n.rT.id+",")+t.name},At.prototype.updateListening=function(t,n){for(var r,o,a,u,e,i,r=this,o=r.aT,e=function(t){var t,n,e,i,t=r[o[t]];if(t)for(n=[],t.forEach(function(t){t&&n.push(t)}),e=n.length,i=0;i<e;i++)u=(a=n[i]).node,a.CMt(),u&&(!u.$bt||u.$bt.row===a.row&&u.$bt.col===a.column)&&a.w3.SB(a.row,a.column,u.WK,u.$bt,!0)},i=0;i<o.length;i++)e(i)},At.prototype.updateListeningOnRemoved=function(){for(var e,t,i,r,o,a,u,s,n,c,e=this,t=e.aT,u=e.w3,s=u.op(),n=0;n<t.length;n++)(c=e[t[n]])&&c.forEach(function(t){var t,n;t&&(i=t.w3,r=t.row,o=t.col,r=r===$?-1:r,o=o===$?-1:o,a=i.pB(r,o),t=i.sT(r,o),a)&&(n=s.Hyt().adjustFormulaOnRemoveName(u,a,e.name))!==a&&i.SB(r,o,n,t,!0)})},At.prototype.vyt=function(){for(var t,n,e,t=this.aT,n=0;n<t.length;n++)(e=this[t[n]])&&e.forEach(function(t){t&&t.vyt()})},P=At,v.NameCalc=P,n(y,ht=t),y.prototype.processListener=function(t,n,e,i,r,o,a,u){var s,c,f,l,h,l,d,u,s=this,c=s[t],f=n+","+e+","+i+","+r;if(3!==t||o instanceof E)if(o.e_t)ht.prototype.Iwt.call(this,t,o,a);else{if(o.ebt&&1<=o.ebt.length&&((d=(l=o.ebt)[l.length-1]).push(this),f="?"+f),u&&(f="!"+f),c||(s.aT.push(t),s[t]=c=(0,m.createMap)()),!(l=c.get(f))){if(!a)return;c.set(f,l={}),l.content=(0,m.createMap)(),l.row=n,l.col=e,l.rowCount=i,l.colCount=r}if(u=o.getKey(),a){if(l.content.has(u))return;l.content.set(u,o)}else l.content.has(u)&&(l.content.delete(u),l.content.size<1)&&(delete l.content,c.delete(f));s.clearListenersCache()}},y.prototype.JDt=function(t,n,e,i,r,o,a){this.processListener(0,t,n,e,i,r,o,a)},y.prototype.i8t=function(t,n,e,i,r,o){this.processListener(3,t,n,e,i,r,o)},y.prototype.mB=function(t,n,e,i){this.visit(0,t,n,e,i)},y.prototype.clearListenersCache=function(){for(var t,n,t=this.aT,n=0;n<t.length;n++)delete this[t[n]+"cached"]},y.prototype.getListeners=function(t,n){var t,n,e,t,t=t[n],n=this[t];return n&&!(e=this[t=t+"cached"])&&(e=this[t]=new i.Common.rbush(16),n.forEach(function(t){t&&e.insert({minX:t.col,minY:t.row,maxX:t.col+t.colCount-1,maxY:t.row+t.rowCount-1,item:t})})),e},y.prototype.visit=function(t,n,e,i,r){var o,a,u,s,c,f,l,h,d,o=this.aT,a=this.c_t();if(g.minX=e,g.minY=n,g.maxX=e+r-1,g.maxY=n+i-1,0===t){for(u=0;u<o.length;u++)if(s=this[o[u]])for(f=(c=this.getListeners(o,u)).search(g),l=0;l<f.length;l++)(h=f[l].item.content).forEach(function(t){t.r_t()});this.i_t&&this.i_t.forEach(function(t){t&&t.r_t()})}else for(u=0;u<o.length;u++)if(s=this[o[u]])for(f=(c=this.getListeners(o,u)).search(g),l=0;l<f.length;l++)(d=f[l].item).w8t&&d.w8t.WDt||(d.w8t=a.ZDt,(h=f[l].item.content).forEach(function(t){t.vyt()}))},y.prototype.o_t=function(t,n,e,i){this.visit(1,t,n,e,i)},y.prototype.J_t=function(n){for(var t,e,i,t=this.aT,e=0;e<t.length;e++)(i=this[t[e]])&&i.forEach(function(t){t&&t.content.forEach(function(t){t&&t.w3&&t.w3!==n&&t.vyt&&t.vyt()})})},y.prototype.a_t=function(t,n,e){var i,r,o,a,u,s,c,f,i=this.aT,r=e?1:-1;for(g.minX=n,g.minY=t,g.maxX=n,g.maxY=t,o=0;o<i.length;o++)if(a=this[i[o]])for(s=(u=this.getListeners(i,o)).search(g),c=0;c<s.length;c++)(f=s[c].item.content)&&f.forEach(function(t){t.delay+=r})},y.prototype.yB=function(){},y.prototype.CMt=function(){},G=y,v.RangeCalc=G,v.Pyt=Nt,v.h0t=kt,v.eV=ot,v.Rwt=I},"./src/calcEngine.res.en.ts":function(t,n){var n,e,i,r,e;function o(t,n){return{description:t,parameters:n}}function a(t,n){return{name:t,repeatable:n}}Object.defineProperty(n,"__esModule",{value:!0}),n.resource=void 0,n.resource={Exp_InvalidCast:"Invalid Cast Exception",Exp_FormulaInvalidChar:"The formula contains an invalid character: '{0}' at index on {1}",Exp_FormulaInvalid:"Invalid Formula",Exp_InvalidFunctionName:"Invalid function name",Exp_InvalidOverrideFunction:"Cannot override built-in function",Exp_InvalidArray:"Invalid array",Exp_OverrideNotAllowed:"Attempt to override function while override is not allowed",Exp_NoSyntax:"No syntax '{0}' to match the syntax '{1}'.",Exp_IsValid:"'{0}' is invalid.",Exp_InvalidParameters:"Invalid function parameter at {0}.",Exp_InvalidArrayColumns:"The length of array columns are not equal at {0}.",Exp_ExprIsNull:"The argument 'expr' is null",Exp_InvalidOperation:"Invalid Operation Exception",Exp_ArgumentNull:"Argument Null Exception",Exp_CriteriaIsNull:"Criteria is null",Exp_Format:"Format",Exp_ArrayFormulaPart:"Cannot change part of an array.",Exp_NotSupported:"Not Supported Exception",Exp_DuplicatedChar:"Duplicated Character",Exp_ArgumentOutOfRangeException:"Argument Out Of Range Exception",Exp_ArgumentException:"Argument Exception",wmt:{ABS:o("This function calculates the absolute value of the specified value.",[a("number")]),ACCRINT:o("This function calculates the accrued interest for a security that pays periodic interest.",[a("issue"),a("first_interest"),a("settlement"),a("rate"),a("par"),a("frequency"),a("basis")]),ACCRINTM:o("This function calculates the accrued interest at maturity for a security that pays periodic interest.",[a("issue"),a("settlement"),a("rate"),a("par"),a("basis")]),ACOS:o("This function calculates the arccosine, that is, the angle whose cosine is the specified value.",[a("number")]),ACOSH:o("This function calculates the inverse hyperbolic cosine of the specified value.",[a("number")]),ADDRESS:o("This function uses the row and column numbers to create a cell address in text.",[a("row_num"),a("column_num"),a("abs_num"),a("a1style"),a("sheet_text")]),AGGREGATE:o("This function aggregate a list of numbers using a specified built-in function.",[a("function_num"),a("options"),a("ref1"),a("ref2",!0)]),AMORDEGRC:o("This function returns the depreciation for an accounting period, taking into consideration prorated depreciation, and applies a depreciation coefficient in the calculation based on the life of the assets.",[a("cost"),a("date_purchased"),a("first_period"),a("salvage"),a("period"),a("rate"),a("basis")]),AMORLINC:o("This function calculates the depreciation for an accounting period, taking into account prorated depreciation.",[a("cost"),a("date_purchased"),a("first_period"),a("salvage"),a("period"),a("rate"),a("basis")]),AND:o("Check whether all arguments are True, and returns True if all arguments are True.",[a("logical1"),a("logical2")]),ASIN:o("This function calculates the arcsine, that is, the angle whose sine is the specified value.",[a("number")]),ASINH:o("This function calculates the inverse hyperbolic sine of a number.",[a("number")]),ATAN:o("This function calculates the arctangent, that is, the angle whose tangent is the specified value.",[a("number")]),ATAN2:o("This function calculates the arctangent of the specified x- and y-coordinates.",[a("x_num"),a("y_num")]),ATANH:o("This function calculates the inverse hyperbolic tangent of a number.",[a("number")]),AVEDEV:o("This function calculates the average of the absolute deviations of the specified values from their mean.",[a("number1"),a("number2",!0)]),AVERAGE:o("This function calculates the average of the specified numeric values.",[a("number1"),a("number2",!0)]),AVERAGEA:o("This function calculates the average of the specified values, including text or logical values as well as numeric values.",[a("value1"),a("value2",!0)]),AVERAGEIF:o("This function calculates the average of the specified numeric values provided that they meet the specified criteria.",[a("range"),a("criteria"),a("[average_range]")]),AVERAGEIFS:o("This function calculates the average of all cells that meet multiple specified criteria.",[a("average_range"),a("criteria_range1",!0),a("criteria1",!0)]),BESSELI:o("This function calculates the modified Bessel function of the first kind evaluated for purely imaginary arguments.",[a("value"),a("order")]),BESSELJ:o("This function calculates the Bessel function of the first kind.",[a("value"),a("order")]),BESSELK:o("This function calculates the modified Bessel function of the second kind evaluated for purely imaginary arguments.",[a("value"),a("order")]),BESSELY:o("This function calculates the Bessel function of the second kind.",[a("value"),a("order")]),BETADIST:o("This function calculates the cumulative beta distribution function.",[a("x"),a("alpha"),a("beta"),a("lower"),a("upper")]),BETAINV:o("This function calculates the inverse of the cumulative beta distribution function.",[a("probability"),a("alpha"),a("beta"),a("lower"),a("upper")]),BIN2DEC:o("This function converts a binary number to a decimal number",[a("number")]),BIN2HEX:o("This function converts a binary number to a hexadecimal number.",[a("number"),a("places")]),BIN2OCT:o("This function converts a binary number to an octal number.",[a("number"),a("places")]),BINOMDIST:o("This function calculates the individual term binomial distribution probability.",[a("number_s"),a("trials"),a("probability_s"),a("cumulative")]),CEILING:o("This function rounds a number up to the nearest multiple of a specified value.",[a("number"),a("significance")]),CHAR:o("This function returns the character specified by a number.",[a("number")]),CHIDIST:o("This function calculates the one-tailed probability of the chi-squared distribution.",[a("value"),a("deg_freedom")]),CHIINV:o("This function calculates the inverse of the one-tailed probability of the chi-squared distribution",[a("probability"),a("deg_freedom")]),CHITEST:o("This function calculates the test for independence from the chi-squared distribution.",[a("actual_range"),a("expected_range")]),CHOOSE:o("This function returns a value from a list of values.",[a("index_num"),a("value1"),a("value2",!0)]),CLEAN:o("This function removes all non-printable characters from text.",[a("text")]),CODE:o("This function returns a numeric code to represent the first character in a text string. The returned code corresponds to the Windows character set (ANSI).",[a("text")]),COLUMN:o("This function returns the column number of a reference.",[a("reference")]),COLUMNS:o("This function returns the number of columns in an array.",[a("array")]),COMBIN:o("This function calculates the number of possible combinations for a specified number of items.",[a("number"),a("number_chosen")]),COMPLEX:o("This function converts real and imaginary coefficients into a complex number.",[a("real_num"),a("image_num"),a("suffix")]),CONCATENATE:o("This function combines multiple text strings or numbers into one text string.",[a("text1"),a("text2",!0)]),CONFIDENCE:o("This function returns confidence interval for a population mean.",[a("alpha"),a("standard_dev"),a("size")]),CONVERT:o("This function converts a number from one measurement system to its equivalent in another measurement system.",[a("number"),a("from_unit"),a("to_unit")]),CORREL:o("This function returns the correlation coefficient of the two sets of data.",[a("array1"),a("array2")]),COS:o("This function returns the cosine of the specified angle.",[a("number")]),COSH:o("This function returns the hyperbolic cosine of the specified value.",[a("number")]),COUNT:o("This function returns the number of cells that contain numbers.",[a("value1"),a("value2",!0)]),COUNTA:o("This function returns the number of number of cells that contain numbers, text, or logical values.",[a("value1"),a("value2",!0)]),COUNTBLANK:o("This function returns the number of empty (or blank) cells in a range of cells on a sheet.",[a("cellrange")]),COUNTIF:o("This function returns the number of cells that meet a certain condition",[a("cellrange"),a("criteria")]),COUNTIFS:o("This function returns the number of cells that meet multiple conditions.",[a("criteria_range1",!0),a("criteria1",!0)]),COUPDAYBS:o("This function calculates the number of days from the beginning of the coupon period to the settlement date.",[a("settlement"),a("maturity"),a("frequency"),a("basis")]),COUPDAYS:o("This function returns the number of days in the coupon period that contains the settlement date.",[a("settlement"),a("maturity"),a("frequency"),a("basis")]),COUPDAYSNC:o("This function calculates the number of days from the settlement date to the next coupon date.",[a("settlement"),a("maturity"),a("frequency"),a("basis")]),COUPNCD:o("This function returns a date number of the next coupon date after the settlement date.",[a("settlement"),a("maturity"),a("frequency"),a("basis")]),COUPNUM:o("This function returns the number of coupons due between the settlement date and maturity date.",[a("settlement"),a("maturity"),a("frequency"),a("basis")]),COUPPCD:o("This function returns a date number of the previous coupon date before the settlement date.",[a("settlement"),a("maturity"),a("frequency"),a("basis")]),COVAR:o("This function returns the covariance, which is the average of the products of deviations for each data point pair in two sets of numbers.",[a("array1"),a("array2")]),CRITBINOM:o("This function returns the criterion binomial, the smallest value for which the cumulative binomial distribution is greater than or equal to a criterion value.",[a("trials"),a("probability_s"),a("alpha")]),CUMIPMT:o("This function returns the cumulative interest paid on a loan between the starting and ending periods.",[a("rate"),a("nper"),a("pval"),a("start_period"),a("end_period"),a("paytype")]),CUMPRINC:o("This function returns the cumulative principal paid on a loan between the start and end periods.",[a("rate"),a("nper"),a("pval"),a("start_period"),a("end_period"),a("paytype")]),DATE:o("This function returns the DateTime object for a particular date, specified by the year, month, and day.",[a("year"),a("month"),a("day")]),DATEDIF:o("This function returns the number of days, months, or years between two dates.",[a("start_date"),a("end_date"),a("unit")]),DATEVALUE:o("This function returns a DateTime object of the specified date.",[a("date_text")]),DAVERAGE:o("This function calculates the average of values in a column of a list or database that match the specified conditions.",[a("database"),a("field"),a("criteria")]),DAY:o("This function returns the day number of the month (integer 1 to 31) that corresponds to the specified date.",[a("date")]),DAYS360:o("This function returns the number of days between two dates based on a 360-day year.",[a("start_date"),a("end_date"),a("method")]),DB:o("This function calculates the depreciation of an asset for a specified period using the fixed\u2011declining balance method",[a("cost"),a("salvage"),a("life"),a("period"),a("month")]),DCOUNT:o("This function counts the cells that contain numbers in a column of a list or database that match the specified conditions",[a("database"),a("field"),a("criteria")]),DCOUNTA:o("This function counts the non-blank cells in a column of a list or database that match the specified conditions",[a("database"),a("field"),a("criteria")]),DDB:o("This function calculates the depreciation of an asset for a specified period using the double-declining balance method or another method you specify.",[a("cost"),a("salvage"),a("life"),a("period"),a("factor")]),DEC2BIN:o("This function converts a decimal number to a binary number.",[a("number"),a("places")]),DEC2HEX:o("This function converts a decimal number to a hexadecimal number",[a("number"),a("places")]),DEC2OCT:o("This function converts a decimal number to an octal number",[a("number"),a("places")]),DEGREES:o("This function converts the specified value from radians to degrees",[a("angle")]),DELTA:o("This function identifies whether two values are equal. Returns 1 if they are equal; returns 0 otherwise.",[a("number1"),a("number2")]),DEVSQ:o("This function calculates the sum of the squares of deviations of data points (or of an array of data points) from their sample mean.",[a("number1"),a("number2",!0)]),DGET:o("This function extracts a single value from a column of a list or database that matches the specified conditions.",[a("database"),a("field"),a("criteria")]),DISC:o("This function calculates the discount rate for a security.",[a("settlement"),a("maturity"),a("price"),a("redemption"),a("basis")]),DMAX:o("This function returns the largest number in a column of a list or database that matches the specified conditions.",[a("database"),a("field"),a("criteria")]),DMIN:o("This function returns the smallest number in a column of a list or database that matches the specified conditions.",[a("database"),a("field"),a("criteria")]),DOLLAR:o("This function converts a number to text using currency format, with the decimals rounded to the specified place.",[a("number"),a("decimals")]),DOLLARDE:o("This function converts a fraction dollar price to a decimal dollar price.",[a("fractional_dollar"),a("fraction")]),DOLLARFR:o("This function converts a decimal number dollar price to a fraction dollar price.",[a("decimal_dollar"),a("fraction")]),DPRODUCT:o("This function multiplies the values in a column of a list or database that match the specified conditions.",[a("database"),a("field"),a("criteria")]),DSTDEV:o("This function estimates the standard deviation of a population based on a sample by using the numbers in a column of a list or database that match the specified conditions.",[a("database"),a("field"),a("criteria")]),DSTDEVP:o("This function calculates the standard deviation of a population based on the entire population using the numbers in a column of a list or database that match the specified conditions.",[a("database"),a("field"),a("criteria")]),DSUM:o("This function adds the numbers in a column of a list or database that match the specified conditions.",[a("database"),a("field"),a("criteria")]),DURATION:o("This function returns the Macaulay duration for an assumed par value of $100.",[a("settlement"),a("maturity"),a("coupon"),a("yield"),a("frequency"),a("basis")]),DVAR:o("This function estimates the variance of a population based on a sample by using the numbers in a column of a list or database that match the specified conditions.",[a("database"),a("field"),a("criteria")]),DVARP:o("This function calculates the variance of a population based on the entire population by using the numbers in a column of a list or database that match the specified conditions.",[a("database"),a("field"),a("criteria")]),EDATE:o("This function calculates the date that is the indicated number of months before or after a specified date.",[a("start_date"),a("months")]),EFFECT:o("This function calculates the effective annual interest rate for a given nominal annual interest rate and the number of compounding periods per year.",[a("nominal_rate"),a("npery")]),EOMONTH:o("This function calculates the date for the last day of the month (end of month) that is the indicated number of months before or after the starting date.",[a("start_date"),a("months")]),ERF:o("This function calculates the error function integrated between a lower and an upper limit.",[a("lower_limit"),a("upper_limit")]),ERFC:o("This function calculates the complementary error function integrated between a lower limit and infinity.",[a("lowerlimit")]),"ERROR.TYPE":o("This function returns a number corresponding to one of the error values.",[a("error_val")]),EURO:o("This function returns the equivalent of one Euro based on the ISO currency code.",[a("code")]),EUROCONVERT:o("This function converts currency from a Euro member currency (including Euros) to another Euro member currency (including Euros).",[a("number"),a("source"),a("target"),a("full_precision"),a("triangulation_precision")]),EVEN:o("This function rounds the specified value up to the nearest even integer.",[a("number")]),EXACT:o("This function returns true if two strings are the same; otherwise, false.",[a("text1"),a("text2")]),EXP:o("This function returns e raised to the power of the specified value.",[a("number")]),EXPONDIST:o("This function returns the exponential distribution or the probability density.",[a("value"),a("lambda"),a("cumulative")]),FACT:o("This function calculates the factorial of the specified number.",[a("number")]),FACTDOUBLE:o("This function calculates the double factorial of the specified number.",[a("number")]),FALSE:o("This function returns the value for logical FALSE.",[]),FDIST:o("This function calculates the F probability distribution, to see degrees of diversity between two sets of data.",[a("value"),a("deg_freedom1"),a("deg_freedom2")]),FIND:o("This function finds one text value within another and returns the text value\u2019s position in the text you searched.",[a("find_text"),a("within_text"),a(n="[start_num]")]),FINV:o("This function returns the inverse of the F probability distribution.",[a("probability"),a("deg_freedom1"),a("deg_freedom2")]),FISHER:o("This function returns the Fisher transformation for a specified value.",[a("value")]),FISHERINV:o("This function returns the inverse of the Fisher transformation for a specified value.",[a("value")]),FIXED:o("This function rounds a number to the specified number of decimal places, formats the number in decimal format using a period and commas (if so specified), and returns the result as text.",[a("number"),a("decimals"),a("no_commas")]),FLOOR:o("This function rounds a number down to the nearest multiple of a specified value.",[a("number"),a("significance")]),FORECAST:o("This function calculates a future value using existing values.",[a("value"),a("Yarray"),a("Xarray")]),FREQUENCY:o("This function calculates how often values occur within a range of values. This function returns a vertical array of numbers.",[a("data_array"),a("bins_array")]),FTEST:o("This function returns the result of an F-test, which returns the one-tailed probability that the variances in two arrays are not significantly different.",[a("array1"),a("array2")]),FV:o("This function returns the future value of an investment based on a present value, periodic payments, and a specified interest rate.",[a("rate"),a("numper"),a("paymt"),a("pval"),a("type")]),FVSCHEDULE:o("This function returns the future value of an initial principal after applying a series of compound interest rates. Calculate future value of an investment with a variable or adjustable rate.",[a("principal"),a("schedule")]),GAMMADIST:o("This function returns the gamma distribution.",[a("x"),a("alpha"),a("beta"),a("cumulative")]),GAMMAINV:o("This function returns the inverse of the gamma cumulative distribution.",[a("probability"),a("alpha"),a("beta")]),GAMMALN:o("This function returns the natural logarithm of the Gamma function, G(x).",[a("value")]),GCD:o("This function returns the greatest common divisor of two numbers.",[a("number1"),a("number2")]),GEOMEAN:o("This function returns the geometric mean of a set of positive data.",[a("number1"),a("number2",!0)]),GESTEP:o("This function, greater than or equal to step, returns an indication of whether a number is equal to a threshold.",[a("number"),a("step")]),GROWTH:o("This function calculates predicted exponential growth. This function returns the y values for a series of new x values that are specified by using existing x and y values.",[a("y"),a("x"),a("newx"),a("constant")]),HARMEAN:o("This function returns the harmonic mean of a data set.",[a("number1"),a("number2",!0)]),HEX2BIN:o("This function converts a hexadecimal number to a binary number.",[a("number"),a("places")]),HEX2DEC:o("This function converts a hexadecimal number to a decimal number.",[a("number")]),HEX2OCT:o("This function converts a hexadecimal number to an octal number.",[a("number"),a("places")]),HLOOKUP:o("This function searches for a value in the top row and then returns a value in the same column from a specified row.",[a("lookup_value"),a("table_array"),a("row_index_num"),a("range_lookup")]),HOUR:o("This function returns the hour that corresponds to a specified time.",[a("time")]),HYPGEOMDIST:o("This function returns the hypergeometric distribution.",[a("sample_s"),a("number_sample"),a("population_s"),a("number_pop")]),IF:o("This function performs a comparison and returns one of two provided values based on that comparison.",[a("logical_test"),a("value_if_true"),a("value_if_false")]),IFERROR:o("This function evaluates a formula and returns a value you provide if there is an error or the formula result.",[a("value"),a("value_if_error")]),IMABS:o("This function returns the absolute value or modulus of a complex number.",[a("complexnum")]),IMAGINARY:o("This function returns the imaginary coefficient of a complex number.",[a("complexnum")]),IMARGUMENT:o("This function returns the argument theta, which is an angle expressed in radians.",[a("complexnum")]),IMCONJUGATE:o("This function returns the complex conjugate of a complex number.",[a("complexnum")]),IMCOS:o("This function returns the cosine of a complex number.",[a("complexnum")]),IMDIV:o("This function returns the quotient of two complex numbers.",[a("complexnum"),a("complexdenom")]),IMEXP:o("This function returns the exponential of a complex number.",[a("complexnum")]),IMLN:o("This function returns the natural logarithm of a complex number.",[a("complexnum")]),IMLOG2:o("This function returns the base-2 logarithm of a complex number.",[a("complexnum")]),IMLOG10:o("This function returns the common logarithm of a complex number.",[a("complexnum")]),IMPOWER:o("This function returns a complex number raised to a power.",[a("complexnum"),a("powernum")]),IMPRODUCT:o("This function returns the product of up to 29 complex numbers in the x+yi or x+yj text format.",[a("complexnum1"),a("complexnum2",!0)]),IMREAL:o("This function returns the real coefficient of a complex number in the x+yi or x+yj text format.",[a("complexnum")]),IMSIN:o("This function returns the sine of a complex number in the x+yi or x+yj text format.",[a("complexnum")]),IMSQRT:o("This function returns the square root of a complex number in the x+yi or x+yj text format.",[a("complexnum")]),IMSUB:o("This function returns the difference of two complex numbers in the x+yi or x+yj text format.",[a("complexnum1"),a("complexnum2")]),IMSUM:o("This function returns the sum of two or more complex numbers in the x+yi or x+yj text format.",[a("complexnum1"),a("complexnum2",!0)]),INDEX:o("This function returns a value or the reference to a value from within an array or range.",[a("array"),a("row_num"),a("column_num"),a("area_num")]),INDIRECT:o("This function returns the reference specified by a text string. References are immediately evaluated to display their contents.",[a("ref_text"),a("[a1_style]")]),INT:o("This function rounds a specified number down to the nearest integer.",[a("number")]),INTERCEPT:o("This function returns the coordinates of a point at which a line intersects the y-axis, by using existing x values and y values.",[a("dependent"),a("independent")]),INTRATE:o("This function calculates the interest rate for a fully invested security.",[a("settlement"),a("maturity"),a("investment"),a("redemption"),a("basis")]),IPMT:o("This function calculates the payment of interest on a loan.",[a("rate"),a("per"),a("nper"),a("pval"),a("fval"),a("type")]),IRR:o("This function returns the internal rate of return for a series of cash flows represented by the numbers in an array.",[a("arrayvals"),a("estimate")]),ISBLANK:o("This function tests whether a value, an expression, or contents of a referenced cell is empty.",[a("cellreference")]),ISERR:o("This function, Is Error Other Than Not Available, tests whether a value, an expression, or contents of a referenced cell has an error other than not available (#N/A).",[a("cellreference")]),ISERROR:o("This function, Is Error of Any Kind, tests whether a value, an expression, or contents of a referenced cell has an error of any kind.",[a("cellreference")]),ISEVEN:o("This function, Is Number Even, tests whether a value, an expression, or contents of a referenced cell is even.",[a("cellreference")]),ISLOGICAL:o("This function tests whether a value, an expression, or contents of a referenced cell is a logical (Boolean) value.",[a("cellreference")]),ISNA:o("This function, Is Not Available, tests whether a value, an expression, or contents of a referenced cell has the not available (#N/A) error value.",[a("cellreference")]),ISNONTEXT:o("This function tests whether a value, an expression, or contents of a referenced cell has any data type other than text.",[a("cellreference")]),ISNUMBER:o("This function tests whether a value, an expression, or contents of a referenced cell has numeric data.",[a("cellreference")]),ISODD:o("This function, Is Number Odd, tests whether a value, an expression, or contents of a referenced cell has numeric data.",[a("cellreference")]),ISPMT:o("This function calculates the interest paid during a specific period of an investment.",[a("rate"),a("per"),a("nper"),a("pv")]),ISREF:o("This function, Is Reference, tests whether a value, an expression, or contents of a referenced cell is a reference to another cell.",[a("cellreference")]),ISTEXT:o("This function tests whether a value, an expression, or contents of a referenced cell has text data.",[a("cellreference")]),KURT:o("This function returns the kurtosis of a data set.",[a("number1"),a("number2"),a("number3"),a("number4",!0)]),LARGE:o("This function returns the nth largest value in a data set, where n is specified.",[a("array"),a("n")]),LCM:o("This function returns the least common multiple of two numbers.",[a("number1"),a("number2")]),LEFT:o("This function returns the specified leftmost characters from a text value, and based on the number of characters you specify.",[a("text"),a("num_chars")]),LEN:o("This function returns the length of the number of characters in a text string.",[a("text")]),LINEST:o("This function calculates the statistics for a line.",[a("y"),a("x"),a("constant"),a("stats")]),LN:o("This function returns the natural logarithm of the specified number.",[a("value")]),LOG:o("This function returns the logarithm base Y of a number X.",[a("number"),a("base")]),LOG10:o("This function returns the logarithm base 10 of the number given.",[a("number")]),LOGEST:o("This function calculates an exponential curve that fits the data and returns an array of values that describes the curve.",[a("y"),a("x"),a("constant"),a("stats")]),LOGINV:o("This function returns the inverse of the lognormal cumulative distribution function of x, where LN(x) is normally distributed with the specified mean and standard deviation.",[a("probability"),a("mean"),a("standard_dev")]),LOGNORMDIST:o("This function returns the cumulative natural log normal distribution of x, where LN(x) is normally distributed with the specified mean and standard deviation. Analyze data that has been logarithmically transformed with this function.",[a("x"),a("mean"),a("standard_dev")]),LOOKUP:o("This function searches for a value and returns a value from the same location in a second area.",[a("lookup_value"),a("lookup_vector"),a("result_vector")]),LOWER:o("This function converts text to lower case letters.",[a("text")]),MATCH:o("This function returns the relative position of a specified item in a range.",[a("lookup_value"),a("lookup_array"),a("match_type")]),XMATCH:o("This function returns the relative position of an item in an array. By default, an exact match is required.",[a("lookup_value"),a("lookup_array"),a(i="[match_mode]"),a("[search_mode]")]),XLOOKUP:o("This function searches a range or an array for a match and returns the corresponding item from a second range or array. By default, an exact match is used.",[a("lookup_value"),a("lookup_array"),a("return_array"),a(r="[if_not_found]"),a(i),a("[search_mode]")]),MAX:o("This function returns the maximum value, the greatest value, of all the values in the arguments.",[a("number1"),a("number2",!0)]),MAXA:o("This function returns the largest value in a list of arguments, including text and logical values.",[a("value1"),a("value2",!0)]),MDETERM:o("This function returns the matrix determinant of an array.",[a("array")]),MDURATION:o("This function calculates the modified Macaulay duration of a security with an assumed par value of $100.",[a("settlement"),a("maturity"),a("coupon"),a("yield"),a("frequency"),a("basis")]),MEDIAN:o("This function returns the median, the number in the middle of the provided set of numbers; that is, half the numbers have values that are greater than the median, and half have values that are less than the median.",[a("number1"),a("number2",!0)]),MID:o("This function returns the requested number of characters from a text string starting at the position you specify, and based on the number of characters you specify.",[a("text"),a("start_num"),a("num_chars")]),MIN:o("This function returns the minimum value, the least value, of all the values in the arguments.",[a("number1"),a("number2",!0)]),MINA:o("This function returns the minimum value in a list of arguments, including text and logical values.",[a("value1"),a("value2",!0)]),MINUTE:o("This function returns the minute corresponding to a specified time.",[a("time")]),MINVERSE:o("This function returns the inverse matrix for the matrix stored in an array.",[a("array")]),MIRR:o("This function returns the modified internal rate of return for a series of periodic cash flows.",[a("values"),a("finance_rate"),a("reinvest_rate")]),MMULT:o("This function returns the matrix product for two arrays.",[a("array1"),a("array2")]),MOD:o("This function returns the remainder of a division operation.",[a("dividend"),a("divisor")]),MODE:o("This function returns the most frequently occurring value in a set of data.",[a("number1"),a("number2",!0)]),MONTH:o("This function returns the month corresponding to the specified date value.",[a("date")]),MROUND:o("This function returns a number rounded to the desired multiple.",[a("number"),a("multiple")]),MULTINOMIAL:o("This function calculates the ratio of the factorial of a sum of values to the product of factorials.",[a("number1"),a("number2",!0)]),MUNIT:o("The function returns the unit matrix for the specified dimension.",[a("dimension")]),N:o("This function returns a value converted to a number.",[a("value")]),NA:o("This function returns the error value #N/A that means not available.",[]),SHEET:o("Returns the sheet number of reference sheet.",[a("[value]")]),SHEETS:o("Returns the number of sheets in a reference.",[a("[reference]")]),NEGBINOMDIST:o("This function returns the negative binomial distribution.",[a("number_f"),a("number_s"),a("probability_s")]),NETWORKDAYS:o("This function returns the total number of complete working days between the start and end dates.",[a("start_date"),a("end_date"),a("holidays")]),NOMINAL:o("This function returns the nominal annual interest rate for a given effective rate and number of compounding periods per year.",[a("effect_rate"),a("npery")]),NORMDIST:o("This function returns the normal cumulative distribution for the specified mean and standard deviation.",[a("x"),a("mean"),a("standard_dev"),a("cumulative")]),NORMINV:o("This function returns the inverse of the normal cumulative distribution for the given mean and standard deviation.",[a("probability"),a("mean"),a("standard_dev")]),NORMSDIST:o("This function returns the standard normal cumulative distribution function.",[a("value")]),NORMSINV:o("This function returns the inverse of the standard normal cumulative distribution. The distribution has a mean of zero and a standard deviation of one.",[a("probability")]),NOT:o("This function reverses the logical value of its argument.",[a("logical")]),NOW:o("This function returns the current date and time.",[]),NPER:o("This function returns the number of periods for an investment based on a present value, future value, periodic payments, and a specified interest rate.",[a("rate"),a("paymt"),a("pval"),a("fval"),a("type")]),NPV:o("This function calculates the net present value of an investment by using a discount rate and a series of future payments and income.",[a("rate"),a("value1"),a("value2",!0)]),OBJECT:o("This function converts the property/expression sequence to an object.",[a("property1",!0),a("expression1",!0)]),OCT2BIN:o("This function converts an octal number to a binary number.",[a("number"),a("places")]),OCT2DEC:o("This function converts an octal number to a decimal number.",[a("number")]),OCT2HEX:o("This function converts an octal number to a hexadecimal number.",[a("number"),a("places")]),ODD:o("This function rounds the specified value up to the nearest odd integer.",[a("number")]),ODDFPRICE:o("This function calculates the price per $100 face value of a security with an odd first period.",[a("settlement"),a("maturity"),a("issue"),a("first_coupon"),a("rate"),a("yield"),a("redemption"),a("frequency"),a("basis")]),ODDFYIELD:o("This function calculates the yield of a security with an odd first period.",[a("settlement"),a("maturity"),a("issue"),a("first_coupon"),a("rate"),a("price"),a("redemption"),a("frequency"),a("basis")]),ODDLPRICE:o("This function calculates the price per $100 face value of a security with an odd last coupon period.",[a("settlement"),a("maturity"),a("last_interest"),a("rate"),a("yield"),a("redemption"),a("frequency"),a("basis")]),ODDLYIELD:o("This function calculates the yield of a security with an odd last period.",[a("settlement"),a("maturity"),a("last_interest"),a("rate"),a("price"),a("redemption"),a("frequency"),a("basis")]),OFFSET:o("This function returns a reference to a range. The range is a specified number of rows and columns from a cell or range of cells. The function returns a single cell or a range of cells.",[a("reference"),a("rows"),a("cols"),a("height"),a("width")]),OR:o("This function calculates logical OR. It returns TRUE if any of its arguments are true; otherwise, returns FALSE if all arguments are false.",[a("logical1"),a("logical2",!0)]),PEARSON:o("This function returns the Pearson product moment correlation coefficient, a dimensionless index between -1.0 to 1.0 inclusive indicative of the linear relationship of two data sets.",[a("array_ind"),a("array_dep")]),PERCENTILE:o("This function returns the nth percentile of values in a range.",[a("array"),a("n")]),PERCENTRANK:o("This function returns the rank of a value in a data set as a percentage of the data set.",[a("array"),a("x"),a("significance")]),PERMUT:o("This function returns the number of possible permutations for a specified number of items.",[a("number"),a("number_chosen")]),PI:o("This function returns PI as 3.1415926536.",[]),PMT:o("This function returns the payment amount for a loan given the present value, specified interest rate, and number of terms.",[a("rate"),a("nper"),a("pval"),a("fval"),a("type")]),POISSON:o("This function returns the Poisson distribution.",[a("nevents"),a("mean"),a("cumulative")]),POWER:o("This function raises the specified number to the specified power.",[a("number"),a("power")]),PPMT:o("This function returns the amount of payment of principal for a loan given the present value, specified interest rate, and number of terms.",[a("rate"),a("per"),a("nper"),a("pval"),a("fval"),a("type")]),PRICE:o("This function calculates the price per $100 face value of a periodic interest security",[a("settlement"),a("maturity"),a("rate"),a("yield"),a("redemption"),a("frequency"),a("basis")]),PRICEDISC:o("This function returns the price per $100 face value of a discounted security.",[a("settlement"),a("maturity"),a("discount"),a("redemption"),a("basis")]),PRICEMAT:o("This function returns the price at maturity per $100 face value of a security that pays interest.",[a("settlement"),a("maturity"),a("issue"),a("rate"),a("yield"),a("basis")]),PROB:o("This function returns the probability that values in a range are between two limits.",[a("x_range"),a("prob_range"),a("lower_limit"),a("upper_limit")]),PRODUCT:o("This function multiplies all the arguments and returns the product.",[a("number1"),a("number2",!0)]),PROPER:o("This function capitalizes the first letter in each word of a text string.",[a("text")]),PROPERTY:o("This function returns the value of property path in object.",[a("data_expression"),a("property_path")]),PV:o("This function returns the present value of an investment based on the interest rate, number and amount of periodic payments, and future value. The present value is the total amount that a series of future payments is worth now.",[a("rate"),a("numper"),a("paymt"),a("fval"),a("type")]),QUARTILE:o("This function returns which quartile (which quarter or 25 percent) of a data set a value is.",[a("array"),a("quart")]),QUOTIENT:o("This function returns the integer portion of a division. Use this to ignore the remainder of a division.",[a("numerator"),a("denominator")]),RADIANS:o("This function converts the specified number from degrees to radians.",[a("angle")]),RAND:o("This function returns an evenly distributed random number between 0 and 1.",[]),RANDBETWEEN:o("This function returns a random number between the numbers you specify.",[a("bottom"),a("top")]),RANGEBLOCKSPARKLINE:o("This function returns a rangetemplate.",[a("template_range"),a("data_expression")]),RANK:o("This function returns the rank of a number in a set of numbers. If you were to sort the set, the rank of the number would be its position in the list.",[a("number"),a("ref"),a("order")]),RATE:o("This function returns the interest rate per period of an annuity.",[a("nper"),a("pmt"),a("pval"),a("fval"),a("type"),a("guess")]),RECEIVED:o("This function returns the amount received at maturity for a fully invested security.",[a("settlement"),a("maturity"),a("investment"),a("discount"),a("basis")]),REPLACE:o("This function replaces part of a text string with a different text string, based on the number of characters you specify.",[a("old_text"),a("start_num"),a("num_chars"),a("new_text")]),REPT:o("This function repeats text a specified number of times.",[a("text"),a("number_times")]),RIGHT:o("This function returns the specified rightmost characters from a text value, and based on the number of characters you specify.",[a("text"),a("num_chars")]),ROMAN:o("This function converts an Arabic numeral to a Roman numeral text equivalent.",[a("number"),a("form")]),ROUND:o("This function rounds the specified value to the nearest number, using the specified number of decimal places.",[a("number"),a("num_digits")]),ROUNDDOWN:o("This function rounds the specified number down to the nearest number, using the specified number of decimal places.",[a("number"),a("num_digits")]),ROUNDUP:o("This function rounds the specified number up to the nearest number, using the specified number of decimal places.",[a("number"),a("num_digits")]),ROW:o("This function returns the number of a row from a reference.",[a("reference")]),ROWS:o("This function returns the number of rows in an array.",[a("array")]),RSQ:o("This function returns the square of the Pearson product moment correlation coefficient (R-squared) through data points in known y's and known x's.",[a("array_dep"),a("array_ind")]),SEARCH:o("This function finds one text string in another text string and returns the index of the starting position of the found text.",[a("find_text"),a("within_text"),a(n)]),SECOND:o("This function returns the seconds (0 to 59) value for a specified time.",[a("time")]),SERIESSUM:o("This function returns the sum of a power series.",[a("x"),a("n"),a("m"),a("coefficients")]),SIGN:o("This function returns the sign of a number or expression.",[a("cellreference")]),SIN:o("This function returns the sine of the specified angle.",[a("angle")]),SINH:o("This function returns the hyperbolic sine of the specified number.",[a("number")]),SKEW:o("This function returns the skewness of a distribution.",[a("number1"),a("number2",!0)]),SLN:o("This function returns the straight-line depreciation of an asset for one period.",[a("cost"),a("salvage"),a("life")]),SLOPE:o("This function calculates the slope of a linear regression.",[a("array_dep"),a("array_ind")]),SMALL:o("This function returns the nth smallest value in a data set, where n is specified.",[a("array"),a("n")]),SQRT:o("This function returns the positive square root of the specified number.",[a("value")]),SQRTPI:o("This function returns the positive square root of a multiple of pi (p).",[a("multiple")]),STANDARDIZE:o("This function returns a normalized value from a distribution characterized by mean and standard deviation.",[a("x"),a("mean"),a("standard_dev")]),STDEVA:o("This function returns the standard deviation for a set of numbers, text, or logical values.",[a("value1"),a("value2",!0)]),STDEVP:o("This function returns the standard deviation for an entire specified population (of numeric values).",[a("number1"),a("number2",!0)]),STDEVPA:o("This function returns the standard deviation for an entire specified population, including text or logical values as well as numeric values.",[a("value1"),a("value2",!0)]),STEYX:o("This function returns the standard error of the predicted y value for each x. The standard error is a measure of the amount of error in the prediction of y for a value of x.",[a("array_dep"),a("array_ind")]),SUBSTITUTE:o("This function substitutes a new string for specified characters in an existing string.",[a("text"),a("old_text"),a("new_text"),a("instance_num")]),SUBTOTAL:o("This function calculates a subtotal of a list of numbers using a specified built-in function.",[a("function_num"),a("ref1"),a("ref2",!0)]),SUM:o("This function returns the sum of cells or range of cells.",[a("number1"),a("number2",!0)]),SUMIF:o("This function adds the cells using a given criteria.",[a("range"),a("criteria"),a("sum_range")]),SUMIFS:o("This function adds the cells in a range using multiple criteria.",[a("sum_range"),a("criteria_range1",!0),a("criteria1",!0)]),SUMPRODUCT:o("This function returns the sum of products of cells. Multiplies corresponding components in the given arrays, and returns the sum of those products.",[a("array1"),a("array2",!0)]),SUMSQ:o("This function returns the sum of the squares of the arguments.",[a("number1"),a("number2",!0)]),SUMX2MY2:o("This function returns the sum of the difference of the squares of corresponding values in two arrays.",[a("array_x"),a("array_y")]),SUMX2PY2:o("This function returns the sum of the sum of squares of corresponding values in two arrays.",[a("array_x"),a("array_y")]),SUMXMY2:o("This function returns the sum of the square of the differences of corresponding values in two arrays.",[a("array_x"),a("array_y")]),SYD:o("This function returns the sum-of-years' digits depreciation of an asset for a specified period.",[a("cost"),a("salvage"),a("life"),a("period")]),T:o("This function returns the text in a specified cell.",[a("value")]),TAN:o("This function returns the tangent of the specified angle.",[a("angle")]),TANH:o("This function returns the hyperbolic tangent of the specified number.",[a("number")]),TBILLEQ:o("This function returns the equivalent yield for a Treasury bill (or T-bill)",[a("settlement"),a("maturity"),a("discount")]),TBILLPRICE:o("This function returns the price per $100 face value for a Treasury bill (or T-bill).",[a("settlement"),a("maturity"),a("discount")]),TBILLYIELD:o("This function returns the yield for a Treasury bill (or T-bill).",[a("settlement"),a("maturity"),a("priceper")]),TDIST:o("This function returns the probability for the t-distribution.",[a("x"),a("deg_freedom"),a("tails")]),TEXT:o("This function formats a number and converts it to text.",[a("value"),a("format_text")]),TIME:o("This function returns the TimeSpan object for a specified time.",[a("hour"),a("minute"),a("second")]),TIMEVALUE:o("This function returns the TimeSpan object of the time represented by a text string.",[a("time_text")]),TINV:o("This function returns the t-value of the student's t-distribution as a function of the probability and the degrees of freedom.",[a("probability"),a("deg_freedom")]),TODAY:o("This function returns the date and time of the current date.",[]),TRANSPOSE:o("This function returns a vertical range of cells as a horizontal range or a horizontal range of cells as a vertical range.",[a("array")]),TREND:o("This function returns values along a linear trend. This function fits a straight line to the arrays known x and y values. Trend returns the y values along that line for the array of specified new x values.",[a("y"),a("x"),a("newx"),a("constant")]),TRIM:o("This function removes extra spaces from a string and leaves single spaces between words.",[a("text")]),TRIMMEAN:o("This function returns the mean of a subset of data excluding the top and bottom data.",[a("array"),a("percent")]),TRUE:o("This function returns the value for logical TRUE.",[]),TRUNC:o("This function removes the specified fractional part of the specified number.",[a("number"),a("num_digits")]),TTEST:o("This function returns the probability associated with a t-test.",[a("array1"),a("array2"),a("tails"),a("type")]),TYPE:o("This function returns the type of value.",[a("value")]),UPPER:o("This function converts text to uppercase letters.",[a("text")]),VALUE:o("This function converts a text string that is a number to a numeric value.",[a("text")]),VAR:o("This function returns the variance based on a sample of a population, which uses only numeric values.",[a("number1"),a("number2",!0)]),VARA:o("This function returns the variance based on a sample of a population, which includes numeric, logical, or text values.",[a("value1"),a("value2",!0)]),VARP:o("This function returns variance based on the entire population, which uses only numeric values.",[a("number1"),a("number2",!0)]),VARPA:o("This function returns variance based on the entire population, which includes numeric, logical, or text values.",[a("value1"),a("value2",!0)]),VDB:o("This function returns the depreciation of an asset for any period you specify using the variable declining balance method.",[a("cost"),a("salvage"),a("life"),a("start_period"),a("end_period"),a("factor"),a("no_switch")]),VLOOKUP:o("This function searches for a value in the leftmost column and returns a value in the same row from a column you specify.",[a("lookup_value"),a("table_array"),a("col_index_num"),a("range_lookup")]),WEEKDAY:o("This function returns the number corresponding to the day of the week for a specified date.",[a("date"),a("type")]),WEEKNUM:o("This function returns a number that indicates the week of the year numerically.",[a("date"),a("weektype")]),DATEPART:o("This function formats a date and converts it to text.",[a("date"),a("format_text"),a("weektype")]),WEIBULL:o("This function returns the two-parameter Weibull distribution, often used in reliability analysis.",[a("x"),a("alpha"),a("beta"),a("cumulative")]),WORKDAY:o("This function returns the number of working days before or after the starting date.",[a("start_date"),a("days"),a("holidays")]),XIRR:o("This function calculates the internal rate of return for a schedule of cash flows that may not be periodic.",[a("values"),a("dates"),a("guess")]),XNPV:o("This function calculates the net present value for a schedule of cash flows that may not be periodic.",[a("rate"),a("values"),a("dates")]),YEAR:o("This function returns the year as an integer for a specified date.",[a("date")]),YEARFRAC:o("This function returns the fraction of the year represented by the number of whole days between the start and end dates.",[a("start_date"),a("end_date"),a("basis")]),YIELD:o("This function calculates the yield on a security that pays periodic interest.",[a("settlement"),a("maturity"),a("rate"),a("price"),a("redemption"),a("frequency"),a("basis")]),YIELDDISC:o("This function calculates the annual yield for a discounted security.",[a("settlement"),a("maturity"),a("price"),a("redemption"),a("basis")]),YIELDMAT:o("This function calculates the annual yield of a security that pays interest at maturity.",[a("settlement"),a("maturity"),a("issue"),a("rate"),a("price"),a("basis")]),ZTEST:o("This function returns the significance value of a z-test. The z-test generates a standard score for x with respect to the set of data and returns the two-tailed probability for the normal distribution.",[a("array"),a("x"),a("sigma")]),HBARSPARKLINE:o("This function returns a data set used for representing a Hbar sparkline",[a("value"),a("colorScheme"),a("axisVisible"),a("barHeight")]),VBARSPARKLINE:o("This function returns a data set used for representing a Vbar sparkline",[a("value"),a("colorScheme"),a("axisVisible"),a("barWidth")]),VARISPARKLINE:o("This function returns a data set used for representing a variance sparkline",[a("variance"),a("reference"),a("mini"),a("maxi"),a("mark"),a("tickunit"),a("legend"),a("colorPositive"),a("colorNegative"),a("vertical")]),PIESPARKLINE:o("This function returns a data set used for representing a pie sparkline",[a("range|percentage"),a("color",!0)]),AREASPARKLINE:o("This function returns a data set used for representing a area sparkline",[a("points"),a("mini"),a("maxi"),a("line1"),a("line2"),a("colorPositive"),a("colorNegative")]),SCATTERSPARKLINE:o("This function returns a data set used for representing a scatter sparkline",[a("points1"),a("points2"),a("minX"),a("maxX"),a("minY"),a("maxY"),a("hLine"),a("vLine"),a("xMinZone"),a("xMaxZone"),a("yMinZone"),a("yMaxZone"),a("tags"),a("drawSymbol"),a("drawLines"),a("color1"),a("color2"),a("dash")]),LINESPARKLINE:o("This function returns a data set used for representing a line sparkline",[a("data"),a("dataOrientation"),a("dateAxisData"),a("dateAxisOrientation"),a("setting")]),COLUMNSPARKLINE:o("This function returns a data set used for representing a column sparkline",[a("data"),a("dataOrientation"),a("dateAxisData"),a("dateAxisOrientation"),a("setting")]),WINLOSSSPARKLINE:o("This function returns a data set used for representing a win/loss sparkline",[a("data"),a("dataOrientation"),a("dateAxisData"),a("dateAxisOrientation"),a("setting")]),BULLETSPARKLINE:o("This function returns a data set used for representing a bullet sparkline",[a("measure"),a("target"),a("maxi"),a("good"),a("bad"),a("forecast"),a("tickunit"),a("colorScheme"),a("vertical"),a("measureColor"),a("targetColor"),a("maxiColor"),a("goodColor"),a("badColor"),a("forecastColor"),a("allowMeasureOverMaxi"),a("barSize")]),SPREADSPARKLINE:o("This function returns a data set used for representing a spread sparkline",[a("points"),a("showAverage"),a("scaleStart"),a("scaleEnd"),a("style"),a("colorScheme"),a("vertical")]),STACKEDSPARKLINE:o("This function returns a data set used for representing a stacked sparkline",[a("points"),a("colorRange"),a("labelRange"),a("maximum"),a("targetRed"),a("targetGreen"),a("targetBlue"),a("tragetYellow"),a("color"),a("highlightPosition"),a("vertical"),a("textOrientation"),a("textSize")]),BOXPLOTSPARKLINE:o("This function returns a data set used for representing a boxplot sparkline",[a("points"),a("boxPlotClass"),a("showAverage"),a("scaleStart"),a("scaleEnd"),a("acceptableStart"),a("acceptableEnd"),a("colorScheme"),a("style"),a("vertical")]),CASCADESPARKLINE:o("This function returns a data set used for representing a cascade sparkline",[a("pointsRange"),a("pointIndex"),a("labelsRange"),a("minimum"),a("maximum"),a("colorPositive"),a("colorNegative"),a("vertical"),a("itemTypeRange"),a("colorTotal")]),PARETOSPARKLINE:o("This function returns a data set used for representing a pareto sparkline",[a("points"),a("pointIndex"),a("colorRange"),a("target"),a("target2"),a("highlightPosition"),a("label"),a("vertical"),a("targetColor"),a("target2Color"),a("labelColor"),a("barSize")]),MONTHSPARKLINE:o("This function returns a data set used for representing a month sparkline",[a("year"),a("month"),a("dataRange"),a("emptyColor"),a("startColor"),a("middleColor"),a("endColor")]),YEARSPARKLINE:o("This function returns a data set used for representing a year sparkline",[a("year"),a("dataRange"),a("emptyColor"),a("startColor"),a("middleColor"),a("endColor")]),GAUGEKPISPARKLINE:o("This function returns a data set used for representing a gauge KPI sparkline",[a("targetValue"),a("currentValue"),a("minValue"),a("maxValue"),a("showLabel"),a("targetValueLabel"),a("currentValueLabel"),a("minValueLabel"),a("maxValueLabel"),a("fontArray"),a("minAngle"),a("maxAngle"),a("radiusRatio"),a("gaugeType"),a("colorRange"),a("...")]),HISTOGRAMSPARKLINE:o("This function returns a data set used for representing a histogram sparkline",[a("dateRange"),a("continuous"),a("paintLabel"),a("scale"),a("barWidth"),a("barColor"),a("labelFontStyle"),a("labelColor"),a("edgeColor")]),"CEILING.PRECISE":o("This function rounds a number up to the nearest integer or to the nearest multiple of a specified value.",[a("number"),a(e="[significance]")]),"COVARIANCE.S":o("This function returns the sample covariance, which is the average of the products of deviations for each data point pair in two sets of numbers.",[a("array1"),a("array2")]),"FLOOR.PRECISE":o("This function rounds a number down to the nearest integer or to the nearest multiple of a specified value.",[a("number"),a(e)]),"PERCENTILE.EXC":o("This function returns the nth percentile of values in a range.",[a("array"),a("k")]),"QUARTILE.EXC":o("This function returns which quartile (which quarter or 25 percent) of a data set a value is.",[a("array"),a("quart")]),"RANK.AVG":o("This function returns the rank of a number in a set of numbers. If some values have the same rank, it will return the average rank.",[a("number"),a("ref"),a("[order]")]),"MODE.MULT":o("This function returns the most frequently occurring vertical array or the most frequently occurring value in a set of data.",[a("number1"),a("number2",!0)]),"STDEV.P":o("This function returns the standard deviation for an entire specified population (of numeric values).",[a("number1"),a("number2",!0)]),"VAR.P":o("This function returns variance based on the entire population, which uses only numeric values.",[a("number1"),a("number2",!0)]),"COVARIANCE.P":o("This function returns the covariance, which is the average of the products of deviations for each data point pair in two sets of numbers.",[a("array1"),a("array2")]),"MODE.SNGL":o("This function returns the most frequently occurring value in a set of data.",[a("number1"),a("number2",!0)]),"PERCENTILE.INC":o("This function returns the nth percentile of values in a range.",[a("array"),a("k")]),"QUARTILE.INC":o("This function returns which quartile (which quarter or 25 percent) of a data set a value is.",[a("array"),a("quart")]),"RANK.EQ":o("This function returns the rank of a number in a set of numbers. If you were to sort the set, the rank of the number would be its position in the list.",[a("number"),a("ref"),a("[order]")]),STDEV:o("This function returns standard deviation is estimated based on a sample.",[a("number1"),a("number2",!0)]),"STDEV.S":o("This function returns standard deviation is estimated based on a sample.",[a("number1"),a("number2",!0)]),"VAR.S":o("This function returns the variance based on a sample of a population, which uses only numeric values.",[a("number1"),a("number2",!0)]),"BETA.INV":o("This function calculates the inverse of the cumulative beta distribution function.",[a("probability"),a("alpha"),a("beta"),a("[lower]"),a("[upper]")]),"BINOM.DIST":o("This function calculates the individual term binomial distribution probability.",[a("number_s"),a("trials"),a("probability_s"),a("cumulative")]),"BINOM.INV":o("This function returns the criterion binomial, the smallest value for which the cumulative binomial distribution is greater than or equal to a criterion value.",[a("trials"),a("probability_s"),a("alpha")]),"CHISQ.DIST.RT":o("This function calculates the one-tailed probability of the chi-squared distribution.",[a("value"),a("deg_freedom")]),"CHISQ.INV.RT":o("This function calculates the inverse of the one-tailed probability of the chi-squared distribution.",[a("probability"),a("deg_freedom")]),"CHISQ.TEST":o("This function calculates the test for independence from the chi-squared distribution.",[a("actual_range"),a("expected_range")]),"CONFIDENCE.NORM":o("This function returns confidence interval for a population mean.",[a("alpha"),a("standard_dev"),a("size")]),"EXPON.DIST":o("This function returns the exponential distribution or the probability density.",[a("value"),a("lambda"),a("cumulative")]),"F.DIST.RT":o("This function calculates the F probability distribution, to see degrees of diversity between two sets of data.",[a("value"),a("deg_freedom1"),a("deg_freedom2")]),"F.INV.RT":o("This function returns the inverse of the F probability distribution.",[a("probability"),a("deg_freedom1"),a("deg_freedom2")]),"F.TEST":o("This function returns the result of an F-test, which returns the one-tailed probability that the variances in two arrays are not significantly different.",[a("array1"),a("array2")]),"GAMMA.DIST":o("This function returns the gamma distribution.",[a("x"),a("alpha"),a("beta"),a("cumulative")]),"GAMMA.INV":o("This function returns the inverse of the gamma cumulative distribution.",[a("probability"),a("alpha"),a("beta")]),"LOGNORM.INV":o("This function returns the inverse of the lognormal cumulative distribution function of x, where LN(x) is normally distributed with the specified mean and standard deviation.",[a("probability"),a("mean"),a("standard_dev")]),"NORM.DIST":o("This function returns the normal cumulative distribution for the specified mean and standard deviation.",[a("x"),a("mean"),a("standard_dev"),a("cumulative")]),"NORM.INV":o("This function returns the inverse of the normal cumulative distribution for the given mean and standard deviation.",[a("probability"),a("mean"),a("standard_dev")]),"NORM.S.INV":o("This function returns the inverse of the standard normal cumulative distribution. The distribution has a mean of zero and a standard deviation of one.",[a("probability")]),"PERCENTRANK.INC":o("This function returns the rank of a value in a data set as a percentage of the data set.",[a("array"),a("n"),a(e)]),"POISSON.DIST":o("This function returns the Poisson distribution.",[a("nevents"),a("mean"),a("cumulative")]),"T.INV.2T":o("This function returns the t-value of the student's t-distribution as a function of the probability and the degrees of freedom.",[a("probability"),a("deg_freedom")]),"T.TEST":o("This function returns the probability associated with a t-test.",[a("array1"),a("array2"),a("tails"),a("type")]),"WEIBULL.DIST":o("This function returns the two-parameter Weibull distribution, often used in reliability analysis.",[a("x"),a("alpha"),a("beta"),a("cumulative")]),"Z.TEST":o("This function returns the significance value of a z-test. The z-test generates a standard score for x with respect to the set of data and returns the two-tailed probability for the normal distribution.",[a("array"),a("x"),a("[sigma]")]),"T.DIST.RT":o("This function returns the right-tailed t-distribution.",[a("x"),a("deg_freedom")]),"T.DIST.2T":o("This function returns the two-tailed t-distribution.",[a("x"),a("deg_freedom")]),"ISO.CEILING":o("This function returns a number up to the nearest integer or to the nearest multiple of significance, regardless of sign of significance.",[a("number"),a(e)]),"BETA.DIST":o("This function returns the beta distribution.",[a("x"),a("alpha"),a("beta"),a("cumulative"),a("lower"),a("upper")]),"GAMMALN.PRECISE":o("This function returns the natural logarithm of the gamma function.",[a("value")]),"ERF.PRECISE":o("This function returns the error function.",[a("lowerlimit")]),"ERFC.PRECISE":o("This function returns the complementary ERF function.",[a("lowerlimit")]),"PERCENTRANK.EXC":o("This function returns the percentage rank(0..1, exclusive) of a value in a data set.",[a("array"),a("x"),a(e)]),"HYPGEOM.DIST":o("This function returns the hypergeometric distribution.",[a("sample_s"),a("number_sample"),a("population_s"),a("number_pop"),a("cumulative")]),"LOGNORM.DIST":o("This function returns the log normal distribution of x.",[a("x"),a("mean"),a("stdev"),a("cumulative")]),"NEGBINOM.DIST":o("This function returns the negative binomial distribution.",[a("number_f"),a("number_s"),a("probability_s"),a("cumulative")]),"NORM.S.DIST":o("This function returns the standard normal distribution.",[a("z"),a("cumulative")]),"T.DIST":o("This function returns the t-distribution.",[a("x"),a("deg_freedom"),a("cumulative")]),"F.DIST":o("This function returns the F probability distribution.",[a("x"),a("deg_freedom1"),a("deg_freedom2"),a("cumulative")]),"CHISQ.DIST":o("This function returns the chi-squared distribution.",[a("x"),a("deg_freedom"),a("cumulative")]),"F.INV":o("This function returns the inverse of the F probability distribution.",[a("probability"),a("deg_freedom1"),a("deg_freedom2")]),"T.INV":o("This function returns the left-tailed inverse of the t-distribution.",[a("probability"),a("deg_freedom")]),"CHISQ.INV":o("This function returns the inverse of left-tailed probability of the chi-squared distribution.",[a("probability"),a("deg_freedom")]),"CONFIDENCE.T":o("This function returns the confidence interval for a Student's t distribution.",[a("alpha"),a("standard_dev"),a("size")]),"NETWORKDAYS.INTL":o("This function returns the number of workdays between two dates using arguments to indicate holidays and weekend days.",[a("start_date"),a("end_date"),a("[weekend]"),a("[holidays]")]),"WORKDAY.INTL":o("This function returns the serial number of the date before or after a number of workdays with custom weekend parameters. These parameters indicate weekend days and holidays.",[a("start_date"),a("days"),a("[weekend]"),a("[holidays]")]),REFRESH:o("This function decides how to re-calculate the formula. Can use the evaluateMode argument to specific the formula re-calculate on the reference value changed, evaluate once , re-calculate or interval.",[a("formula"),a("evaluateMode"),a("interval")]),DAYS:o("This function returns the number of days between two dates.",[a("end_date"),a("start_date")]),ISOWEEKNUM:o("This function returns the number of the ISO week number of the year for a given date.",[a("date")]),BITAND:o('This function returns a bitwise "AND" of two numbers.',[a("number1"),a("number2")]),BITLSHIFT:o('This function returns a bitwise "OR" of two numbers.',[a("number"),a("shift_amount")]),BITOR:o('This function returns a bitwise "OR" of two numbers.',[a("number1"),a("number2")]),BITRSHIFT:o('This function returns a bitwise "OR" of two numbers.',[a("number"),a("shift_amount")]),BITXOR:o('This function returns a bitwise "XOR" of two numbers.',[a("number1"),a("number2")]),IMCOSH:o("This function returns the hyperbolic cosine of a complex number in x+yi or x+yj text format.",[a("complexnum")]),IMCOT:o("This function returns the cotangent of a complex number in x+yi or x+yj text format.",[a("complexnum")]),IMCSC:o("This function returns the cosecant of a complex number in x+yi or x+yj text format.",[a("complexnum")]),IMCSCH:o("This function returns the hyperbolic cosecant of a complex number in x+yi or x+yj text format.",[a("complexnum")]),IMSEC:o("This function returns the secant of a complex number in x+yi of x+yj text format.",[a("complexnum")]),IMSECH:o("This function returns the hyperbolic secant of a complex number in x+yi or x+yj text format.",[a("complexnum")]),IMSINH:o("This function returns the hyperbolic sine of a complex number in x+yi of x+yj text format.",[a("complexnum")]),IMTAN:o("This function returns the tangent of a complex number in x+yi or x+yj text format.",[a("complexnum")]),PDURATION:o("This function returns the number of periods required by an investment to reach a specified value.",[a("rate"),a("pval"),a("fval")]),RRI:o("This function returns an equivalent interest rate for the growth of an investment.",[a("nper"),a("pval"),a("fval")]),ISFORMULA:o("This function tests whether contains a formula of a referenced cell.",[a("cellreference")]),IFNA:o("This function returns the value you specify if the formula returns the #N/A error value, otherwise returns the result of the formula.",[a("value"),a("value_if_na")]),IFS:o("This function checks whether one or more conditions are met and returns a value that corresponds to the first TRUE condition.",[a("logical_test1"),a("value_if_true1",!0)]),SWITCH:o("This function evaluates one value (called the expression) against a list of values, and returns the result corresponding to the first matching value. If there is no match, an optional default value may be returned.",[a("expression"),a("value1"),a("result1"),a("[default_or_value2]",!0),a("[result2]",!0)]),XOR:o("This function returns a logical exclusive or of all arguments.",[a("logical",!0)]),AREAS:o("This function returns the number of areas in a reference.",[a("reference")]),FORMULATEXT:o("This function returns a formula as a string.",[a("reference")]),HYPERLINK:o("This function creates a shortcut or jump that opens a document stored on a network server, an intranet, or the Internet.",[a("link_location"),a("friendly_name")]),ACOT:o("This function calculates the inverse arccotangent of a number.",[a("number")]),ACOTH:o("This function calculates the inverse hyperbolic arccotangent of a number.",[a("number")]),ARABIC:o("This function converts a Roman numeral text to an Arabic numeral equivalent.",[a("text")]),BASE:o("This function converts a number into a text representation with the given radix (base).",[a("number"),a("radix"),a("[min_length]")]),"CEILING.MATH":o("This function round  a number up to the nearest integer or to the nearest multiple of significance.",[a("number"),a(e),a("[mode]")]),COMBINA:o("This function calculates the number of possible combinations with repetitions for a specified number of items.",[a("number"),a("number_chosen")]),COT:o("This function returns the cotangent of the specified angle.",[a("angle")]),COTH:o("This function returns the hyperbolic cotangent of the specified number.",[a("value")]),CSC:o("This function returns the cosecant of the specified angle.",[a("angle")]),CSCH:o("This function returns the hyperbolic cosecant of the specified number.",[a("value")]),DECIMAL:o("This function converts a text representation of a number in a given base into a decimal number.",[a("text"),a("radix")]),"FLOOR.MATH":o("This function round a number down to the nearest integer or to the nearest multiple of significance.",[a("number"),a(e),a("[mode]")]),SEC:o("This function returns the secant of the specified angle.",[a("angle")]),SECH:o("This function returns the hyperbolic secant of the specified value.",[a("value")]),"BINOM.DIST.RANGE":o("This function calculates the probability of a trial result using a binomial distribution.",[a("trials"),a("probability_s"),a("number_s"),a("[number_s2]")]),GAMMA:o("This function returns the gamma function value.",[a("number")]),MAXIFS:o("This function returns the maximum value among cells specified by a given set of conditions or criteria.",[a("max_range"),a("criteria_range",!0),a("criteria",!0)]),GAUSS:o("This function calculates the probability that a member of a standard normal population will fall between the mean and z standard deviations from the mean.",[a("number")]),MINIFS:o("This function returns the minimum value among cells specified by a given set of conditions or criteria.",[a("min_range"),a("criteria_range",!0),a("criteria",!0)]),PERMUTATIONA:o("This function returns the number of permutations for a given number of object that can be selected from the total objects.",[a("number"),a("number_chosen")]),PHI:o("This function returns the value of the density function for a standard normal distribution.",[a("value")]),"SKEW.P":o("This function returns the skewness of a distribution base on a poopulation: a characterization of the degree of asymmetry of a distribution around its mean.",[a("number1"),a("number2",!0)]),BAHTTEXT:o('This function converts a number to Thai text and adds a suffix of "Baht"',[a("number")]),CONCAT:o('This function combines multiple text strings or numbers into one text string, the function will stay available for compatibility with "CONCATENATE" function.',[a("text1"),a("text2",!0)]),FINDB:o("This function finds one text value within another and returns the text value's position in the text you searched, and counts each double-byte characte as 2 when set DBCS as the default language.",[a("find_text"),a("within_text"),a(n)]),LEFTB:o("This function returns the specified leftmost characters from a text value, and based on the number of bytes you specify.",[a("text"),a("num_bytes")]),LENB:o("This function returns the length of the number of bytes in a text string.",[a("text")]),MIDB:o("This function returns the requested number of characters from a text string starting at the position you specify, and based on the number of bytes you specify.",[a("text"),a("start_num"),a("num_bytes")]),REPLACEB:o("This function replaces part of a text string with a different text string, based on the number of bytes you specify.",[a("old_text"),a("start_byte"),a("num_bytes"),a("new_text")]),RIGHTB:o("This function returns the specified rightmost characters from a text value, and based on the number of bytes you specify.",[a("text"),a("num_bytes")]),SEARCHB:o("This function finds one text string in another text string and returns the index of the starting position of the found text, and counts each double-byte characte as 2 when set DBCS as the default language.",[a("find_text"),a("within_text"),a(n)]),TEXTJOIN:o("This function combines multiple ranges and/or strings into one text, and the text includes a delimiter you specify between each text value.",[a("delimiter"),a("ignore_empty"),a("text1"),a("text2",!0)]),UNICHAR:o("This function returns the Unicode character of a given numeric reference.",[a("number")]),UNICODE:o("This function returns the number corresponding to the first character of the text.",[a("text")]),ENCODEURL:o("This function returns a URL-encoded string.",[a("text")]),BC_QRCODE:o("This function returns a data set for representing a QRCode",[a("value"),a("color"),a("backgroundColor"),a("errorCorrectionLevel"),a("model"),a("version"),a("mask"),a("connection"),a("connectionNo"),a("charCode"),a("charset"),a("quietZoneLeft"),a("quietZoneRight"),a("quietZoneTop"),a("quietZoneBottom")]),BC_EAN13:o("This function returns a data set for representing a EAN13.",[a("value"),a("color"),a("backgroundColor"),a("showLabel"),a("labelPosition"),a("addOn"),a("addOnLabelPosition"),a("fontFamily"),a("fontStyle"),a("fontWeight"),a("textDecoration"),a("textAlign"),a("fontSize"),a("quietZoneLeft"),a("quietZoneRight"),a("quietZoneTop"),a("quietZoneBottom")]),BC_EAN8:o("This function returns a data set for representing a EAN8.",[a("value"),a("color"),a("backgroundColor"),a("showLabel"),a("labelPosition"),a("fontFamily"),a("fontStyle"),a("fontWeight"),a("textDecoration"),a("textAlign"),a("fontSize"),a("quietZoneLeft"),a("quietZoneRight"),a("quietZoneTop"),a("quietZoneBottom")]),BC_CODABAR:o("This function returns a data set for representing a CODABAR.",[a("value"),a("color"),a("backgroundColor"),a("showLabel"),a("labelPosition"),a("checkDigit"),a("nwRatio"),a("fontFamily"),a("fontStyle"),a("fontWeight"),a("textDecoration"),a("textAlign"),a("fontSize"),a("quietZoneLeft"),a("quietZoneRight"),a("quietZoneTop"),a("quietZoneBottom")]),BC_CODE39:o("This function returns a data set for representing a CODE39.",[a("value"),a("color"),a("backgroundColor"),a("showLabel"),a("labelPosition"),a("labelWithStartAndStopCharacter"),a("checkDigit"),a("nwRatio"),a("fullASCII"),a("fontFamily"),a("fontStyle"),a("fontWeight"),a("textDecoration"),a("textAlign"),a("fontSize"),a("quietZoneLeft"),a("quietZoneRight"),a("quietZoneTop"),a("quietZoneBottom")]),BC_CODE93:o("This function returns a data set for representing a CODE93.",[a("value"),a("color"),a("backgroundColor"),a("showLabel"),a("labelPosition"),a("checkDigit"),a("fullASCII"),a("fontFamily"),a("fontStyle"),a("fontWeight"),a("textDecoration"),a("textAlign"),a("fontSize"),a("quietZoneLeft"),a("quietZoneRight"),a("quietZoneTop"),a("quietZoneBottom")]),BC_CODE128:o("This function returns a data set for representing a CODE128.",[a("value"),a("color"),a("backgroundColor"),a("showLabel"),a("labelPosition"),a("codeSet"),a("fontFamily"),a("fontStyle"),a("fontWeight"),a("textDecoration"),a("textAlign"),a("fontSize"),a("quietZoneLeft"),a("quietZoneRight"),a("quietZoneTop"),a("quietZoneBottom")]),BC_GS1_128:o("This function returns a data set for representing a GS1_128.",[a("value"),a("color"),a("backgroundColor"),a("showLabel"),a("labelPosition"),a("fontFamily"),a("fontStyle"),a("fontWeight"),a("textDecoration"),a("textAlign"),a("fontSize"),a("quietZoneLeft"),a("quietZoneRight"),a("quietZoneTop"),a("quietZoneBottom")]),BC_CODE49:o("This function returns a data set for representing a CODE49.",[a("value"),a("color"),a("backgroundColor"),a("showLabel"),a("labelPosition"),a("grouping"),a("groupNo"),a("fontFamily"),a("fontStyle"),a("fontWeight"),a("textDecoration"),a("textAlign"),a("fontSize"),a("quietZoneLeft"),a("quietZoneRight"),a("quietZoneTop"),a("quietZoneBottom")]),BC_PDF417:o("This function returns a data set for representing a PDF417.",[a("value"),a("color"),a("backgroundColor"),a("errorCorrectionLevel"),a("rows"),a("columns"),a("compact"),a("quietZoneLeft"),a("quietZoneRight"),a("quietZoneTop"),a("quietZoneBottom")]),BC_DATAMATRIX:o("This function returns a data set for representing a DATAMATRIX.",[a("value"),a("color"),a("backgroundColor"),a("eccMode"),a("ecc200SymbolSize"),a("ecc200EncodingMode"),a("ecc00_140SymbolSize"),a("structuredAppend"),a("structureNumber"),a("fileIdentifier"),a("quietZoneLeft"),a("quietZoneRight"),a("quietZoneTop"),a("quietZoneBottom")]),FILTER:o("This function filter a range or array.",[a("array"),a("include"),a("if_empty")]),RANDARRAY:o("This function returns an array of random numbers.",[a("rows"),a("columns"),a("min"),a("max"),a("whole_number")]),SEQUENCE:o("This function returns a sequence of numbers.",[a("rows"),a("columns"),a("start"),a("step")]),SINGLE:o("This function returns a single value when given a value, range or array.",[a("value")]),SORT:o("This function sorts a range or array.",[a("array"),a("sort_index"),a("sort_order"),a("by_col")]),SORTBY:o("This function sorts a range or array based on the values in a corresponding range or array.",[a("array"),a("by_array1"),a("sort_order1"),a("by_array2",!0),a("sort_order2",!0)]),UNIQUE:o("This function returns the unique values from a range or array.",[a("array"),a("by_col"),a("exactly_once")]),QUERY:o("This function returns data from data manager tables in a worksheet.",[a("tableAndRows"),a("columns"),a("returnObject")]),LET:o("This function assigns calculation results to names. Useful for storing intermediate calculations and values by defining names inside a formula. These names only apply within the scope of the LET function.",[a("name1"),a("name_value1"),a("calculation_or_name2"),a("[name_value2, ...")]),IMAGE:o("This function input an URL or a base64 string to show an image in cell",[a("URL"),a("[mode]"),a("[height]"),a("[width]"),a("[clipY]"),a("[clipX]"),a("[clipHeight]"),a("[clipWidth]"),a("[vAlign]"),a("[hAlign]")]),GETPIVOTDATA:o("This function extracts data stored in a PivotTable",[a("data_field"),a("pivot_table"),a("[field1, item1]"),a("...")]),WEBSERVICE:o("This function returns data from a web service",[a("url")]),FILTERJSON:o("This function parses json string to a scalar value, an object or an array of objects.",[a("json_string")]),ASC:o("The ASC function changes full-width(double-byte) characters to half-width(single-byte) characters, Use with double-byte character sets (DBCS).",[a("text")]),DBCS:o("The DBCS function converts half-width(single-byte) letters within a character string to full-width(double-byte) characters.",[a("text")]),LAMBDA:o("Creates a function value, which can be called within formulas.",[a("parameter_or_calculation"),a("[parameter_or_calculation]",!0)]),MAP:o("Returns an array formed by mapping each value in the array(s) to a new value by applying a LAMBDA to create a new value.",[a("array"),a("lambda_or_array",!0)]),REDUCE:o("Reduces an array to an accumulated value by applying a LAMBDA to each value and returning the total value in the accumulator.",[a("init_value"),a("array"),a("function")]),SCAN:o("Scans an array by applying a LAMBDA to each value and returns an array that has each intermediate value.",[a("init_value"),a("array"),a("function")]),MAKEARRAY:o("Returns a calculated array of a specified row and column size, by applying a LAMBDA.",[a("rows"),a("cols"),a("function")]),BYCOL:o("Applies a LAMBDA to each column and returns an array of the results. For example, if the original array is 3 columns by 2 rows, the returned array is 3 columns by 1 row.",[a("array"),a("function")]),BYROW:o("Applies a LAMBDA to each row and returns an array of the results. For example, if the original array is 3 columns by 2 rows, the returned array is 1 column by 2 rows.",[a("array"),a("function")]),ISOMITTED:o("Checks whether the value in a LAMBDA is missing and returns TRUE or FALSE.",[a("argument")]),TEXTBEFORE:o("Returns text that occurs before a given character or string.",[a("text"),a("delimiter"),a("[instance_num]"),a(i),a("[match_end]"),a(r)]),TEXTAFTER:o("Returns text that occurs after given character or string.",[a("text"),a("delimiter"),a("[instance_num]"),a(i),a("[match_end]"),a(r)]),TEXTSPLIT:o("Splits text strings by using column and row delimiters.",[a("text"),a("col_delimiter"),a("[row_delimiter]"),a("[ignore_empty]"),a(i),a(e="[pad_with]")]),"GC.REGEXEXTRACT":o("Extracts matching substrings according to a regular expression.",[a("text"),a("regular_expression"),a("[modifiers]")]),"GC.REGEXMATCH":o("Whether a piece of text matches a regular expression.",[a("text"),a("regular_expression"),a("[modifiers]")]),"GC.REGEXREPLACE":o("Replaces part of a text string with a different text string using regular expressions.",[a("text"),a("regular_expression"),a("replacement"),a("[modifiers]")]),VSTACK:o("Appends arrays vertically and in sequence to return a larger array.",[a("array1"),a("[array2]",!0)]),HSTACK:o("Appends arrays horizontally and in sequence to return a larger array.",[a("array1"),a("[array2]",!0)]),TOROW:o("Returns the array in a single row.",[a("array"),a("[ignore]"),a("[scan_by_column]")]),TOCOL:o("Returns the array in a single column.",[a("array"),a("[ignore]"),a("[scan_by_column]")]),WRAPROWS:o("Wraps the provided row or column of values by rows after a specified number of elements to form a new array.",[a("vector"),a("wrap_count"),a(e)]),WRAPCOLS:o("Wraps the provided row or column of values by columns after a specified number of elements to form a new array.",[a("vector"),a("wrap_count"),a(e)]),TAKE:o("Returns a specified number of contiguous rows or columns from the start or end of an array.",[a("array"),a("rows"),a("[columns]")]),DROP:o("Excludes a specified number of rows or columns from the start or end of an array.",[a("array"),a("rows"),a("[columns]")]),EXPAND:o("Expands or pads an array to specified row and column dimensions.",[a("array"),a("rows"),a("[columns]"),a(e)]),CHOOSEROWS:o("Returns the specified rows from an array.",[a("array"),a("row_num1"),a("[row_num2]",!0)]),CHOOSECOLS:o("Returns the specified columns from an array.",[a("array"),a("col_num1"),a("[col_num2]",!0)])},Fbx_Summary:"Summary",Fbx_TableName_Description:"Table name for ",Fbx_TableSheetName_Description:"TableSheet name for ",Fbx_CustomName_Description:"Custom name for ",d2t:{All:{name:"#All",description:"Returns the entire contents of the table, or specified table columns including column headers, data and total rows."},Data:{name:"#Data",description:"Returns the data cells of the table or specified table columns."},Headers:{name:"#Headers",description:"Returns the columns headers for the table, or specified table columns."},Totals:{name:"#Totals",description:"Returns the total rows for the table or specified table columns."},thisRow:{name:"#This Row",description:"This row."}}}},"./src/evaluator.ts":function(k,t,n){var e,j,O,o,i,R,B,D,l,h,_,E,a,f,u,L,F,p,S,A,P,s,c,d,v,m,G,U,g,H,z,V,Y,Z,W,r,Q;function J(t,n,e,i){return{row:t,col:n,rowCount:e,colCount:i}}function K(t,n){for(var e,i,r,o,a,u,e=t.getRangeCount(),i=t.rT,r=n.Xkt,o=0;o<e;o++)(a=t.$gt[o]).id=i.id,i.getRangeKey&&(u=i.getRangeKey(i,a),r)&&(r.qkt||(r.qkt={}),r.qkt[u]=a)}function X(t){return t&&t.getRowCount&&(1<t.getRowCount()||1<t.getColumnCount())}function b(t,n,e,i,r,o){this.M8t=0,this.C8t=0,this.S8t=0,this.localScopes=new O.LocalScopes,this.lambdaFunctionCallDepth=0;var a=this;a.source=t,a.arrayFormulaMode=!!e,a.identity=n||a.T8t(0,0),a.arrayIdentity=i,a.row=i?i.row:a.identity.row||0,a.column=i?i.col:a.identity.col||0,a.rowOffset=i?a.identity.row-i.row:a.row,a.columnOffset=i?a.identity.col-i.col:a.column,a.WK=r,a.Xkt=o}function y(t,n){this.id=t.M8t,t.M8t++,this.ctx=t,this.row=t.row+(t.arrayFormulaMode&&t.rowOffset||0),this.col=t.column+(t.arrayFormulaMode&&t.columnOffset||0),this.node=n}function w(t,n,e,i,r,o,a,u){var a,u,a=Q.call(this,t,isNaN(u)?R:{row:a,col:u},n,isNaN(o)?R:{row:e,col:i,rowCount:r,colCount:o})||this,u=t.op().getGlobalSourceModel(t);return a.A8t=u&&u.getSource(),a}function q(t,n){return t&&n?t.row===n.row&&t.col===n.col:t===n}function M(t){this.service=t,this.asyncManager=new H(this)}function $(t,n){this.id=t,this.Y6=B,this.yL=!1,this.R1t=[],this.I8t=!1,n!==B&&(this.evaluateMode=n)}function C(t){var n=this;n.x8t=[],n.N8t=-1,n.b8t={},n.MX=t,n.k8t=0}function tt(t){for(var n,e,e=0;e<t.R1t.length;e++)(n=t.R1t[e]).yL=!1,0<n.R1t.length&&tt(n)}function T(t){var n,e,t,n=!0,e=t;return t&&t.getValue&&((t=u(t,0,!1,!1)).isError?e=t[0]:1===t.rowCount&&1===t.colCount?e=t[0][0]:(e=t,n=!1)),{value:e,success:n}}function nt(t,n,e){var i,r,o,i=P,r=1===t.rowCount,o=1===t.colCount;return r&&o?t[0][0]:(r&&e<t.colCount?i=t[0][e]:o&&n<t.rowCount?i=t[n][0]:n<t.rowCount&&e<t.colCount&&(i=t[n][e]),i)}function I(t,n,e){return f(n)?n:f(e)?e:(0,O.isLambdaFunction)(n)||(0,O.isLambdaFunction)(e)?S:t<=2?et(t,n,e):t<=14?it(t,n,e):18===t?O.Functions.Mmt.PROPERTY.evaluate(n,e):at(t,n,e)}function x(t,n,e){var i=t.row,t=t.column;return(e=e||n).$9t=!0,O.Functions.findGlobalFunction("@").evaluate({row:i,column:t},n)}function et(t,n,e){var n,i,r,o,a,u,s,c;if(0===t)return n;if(""===n&&1===t)return S;if(!n)return 0;if((n=T(n)).success)return N(t,n.value);if(e){for(i=[],o=(r=n.value).rowCount,a=r.colCount,u=0;u<o;u++)for(s=i[u]=[],c=0;c<a;c++)s[c]=N(t,r[u][c]);return new O.CalcArray(i)}}function it(t,n,e){var i,r,o,a,u,s,c,f,l,h,d,v,m,g,p,i=t<=7?N:8===t?rt:ot,r=T(n),o=T(e);if(r.success&&o.success)return i(t,r.value,o.value);for(n=r.value,e=o.value,a=r.success?1:n.rowCount,u=r.success?1:n.colCount,s=o.success?1:e.rowCount,c=o.success?1:e.colCount,f=Math.max(a,s),l=Math.max(u,c),h=[],d=0;d<f;d++){for(v=[],m=0;m<l;m++)g=r.success?n:nt(n,d,m),p=o.success?e:nt(e,d,m),v.push(g===P||p===P?P:i(t,g,p));h.push(v)}return new O.CalcArray(h)}function N(t,n,e){var i,n,r,e;function o(t){return"string"==typeof t&&0===t.trim().length}if(o(n)||o(e))return S;if(!a(n,i={value:0}))return n instanceof O.CalcError?n:S;if(n=i.value,e!==B){if(!a(e,i))return e instanceof O.CalcError?e:S;r=i.value}else r=0;return 1===t?-n:2===t?n/100:3===t?O.skt.ukt(n,-r)?0:n+r:4===t?O.skt.ukt(n,r)?0:n-r:5===t?j.Common.st.E8(n*r,O.Functions.CALC_PRECISION||15):6===t?r?n/r:s:7===t?!n&&r<0?s:0===n&&0===r||(e=O.Functions.MathHelper.N9t(n,r))===Number.POSITIVE_INFINITY||e===Number.NEGATIVE_INFINITY||isNaN(e)?c:e:void 0}function rt(t,n,e){if(8===t)return f(n)?n:f(e)?e:O.Convert.j(n)+O.Convert.j(e)}function ot(t,n,e){var n=(0,O.$kt)(n,e,!1);return f(n)?n:9===t&&0===n||10===t&&0!==n||11===t&&n<0||12===t&&n<=0||13===t&&0<n||14===t&&0<=n}function at(t,n,e){var i,r,o,t,a,u,s,c,f,o,a,s,t;if(!n||!e||(1!==n.getRangeCount()||1!==e.getRangeCount())&&16!==t||n.endSource||e.endSource)return S;if(!(i=n.getSource())||i!==e.getSource())return S;if(16===t)r=n.$gt.concat(e.$gt);else{if(o=15===t?l:h,t=15===t?h:l,a=n.getRow(0),u=n.getColumn(0),s=e.getRow(0),c=e.getColumn(0),f=o(a,s),o=o(u,c),a=t(a+n.getRowCount(0),s+e.getRowCount(0))-f,s=t(u+n.getColumnCount(0),c+e.getColumnCount(0))-o,a<1||s<1)return O.Errors.Null;r=[J(f,o,a,s)]}return(t=new O.CalcReference(i,r)).V9t=!0,t}function ut(t,n){var e,i,r,o,e=!0;switch(n.J6t){case 0:i=z(t),r=!0;break;case 1:i=parseFloat(t),r=!0;break;case 2:i=V(t),r=!0;break;case 3:i=parseInt(t,10),r=!0;break;case 4:(i=u(t,n.X6t,n.Vkt||!1,n.Ykt||!1,n.M9t||!1,n.Zkt,n.s9t,n.C9t)).isError&&(i=i[0],e=!1),i.isConvertError&&(i=S,e=!1);break;case 5:i=Y(t),n.Y9t&&""===i&&(i=S,e=!1);break;case 6:Z(t,o={value:R})?i=o.value:(i=S,e=!1);break;case 7:i=W(t);break;case 8:!(i=O.Functions.mkt(t))||n.gkt&&0===i.ikt()&&0===i.rkt()?(i=O.Errors.Number,e=!1):i={okt:i.ikt(),akt:i.rkt()};break;default:i=t}return r&&isNaN(i)&&(i=S,e=!1),{D8t:i,_8t:e}}function st(t,n,e){var i,r,o,a,o;for(Array.isArray(n)||(n=[n]),i=t.D8t,r=0;r<n.length;r++)if(a=(o=n[r].split(" "))[0],o=parseInt(o[1],10),"<"===a&&i<o||">"===a&&o<i||"<="===a&&i<=o||">="===a&&o<=i||"="===a&&i===o||"!="===a&&i!==o||"checkLength"===a&&i.length>o)return t.D8t=e===B?O.Errors.Number:e,void(t._8t=!1)}function ct(t,n){var e,i,r,o,a,u,e=[];if(!n)return{ADt:t,_8t:!0};if(n.n9t)for(o=0;o<t.length;o++)e.push(n);else e=Array.isArray(n)?n:[n];for(r=0;r<e.length;r++){if((a=e[r]).K6t&&!t[r])throw(0,O.sR)().Exp_ArgumentNull;if(u=t[r]!==B){if(i=ut(t[r],a),a.pkt&&st(i,a.pkt,a.zkt),!i._8t)break;t[r]=a.ykt?{ekt:u,y4:i.D8t}:i.D8t}else t[r]=a.ykt?{ekt:u,y4:a.bkt}:a.bkt}return i?{ADt:t,_8t:i._8t,Y6:i.D8t}:void 0}e=this&&this.__extends||(r=function(t,n){return(r=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(t,n){t.__proto__=n}:function(t,n){for(var e in n)Object.prototype.hasOwnProperty.call(n,e)&&(t[e]=n[e])}))(t,n)},function(t,n){if("function"!=typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function e(){this.constructor=t}r(t,n),t.prototype=null===n?Object.create(n):(e.prototype=n.prototype,new e)}),Object.defineProperty(t,"__esModule",{value:!0}),t.evaluateOperator=t.AsyncFunctionNode=t.Evaluator=t.GloableEvaluateContext=t.AsyncEvaluateContext=t.EvaluateContext=void 0,j=n("Common"),O=n("./src/calc.common.ts"),o=n("./src/calc.ts"),i=j.Common.lt.ht,R=null,B=void 0,D=Math.pow,l=Math.min,h=Math.max,_="string",E="boolean",a=O.Convert.sJ,f=O.Convert.BJ,u=O.Convert.iV,L=O.Convert.Nh,F=O.Convert.LE,p=O.Errors.Reference,S=O.Errors.Value,A=O.Errors.Name,P=O.Errors.NotAvailable,s=O.Errors.DivideByZero,c=O.Errors.Number,d=O.Errors.Calc,b.prototype.T8t=function(t,n){return{row:t,col:n}},b.prototype.E8t=function(t){return t===O.BangSource?this.source:t},b.prototype.getValue=function(t,n){return t?this.E8t(t).getValue(n):p},b.prototype.getReference=function(t,n){return t?this.E8t(t).getReference(n):p},b.prototype.getSheetRangeReference=function(t){return!t||!t.source||!t.endSource||t.source instanceof O.ErrorSource?p:this.E8t(t.source).getSheetRangeReference(t)},b.prototype.getFunction=function(t){var n=this;return n.source?n.source.getCustomFunction(t):R},b.prototype.getName=function(t){var n,e,n,n,n=this,e=n.source?n.source.getCustomName(t):R;return e=!e&&n.source?(n=(n=n.source.op())&&n.getGlobalSourceModel())&&n.getSource().getCustomName(t):e},b.prototype.getNameInfo=function(t){return(0,O.W9t)(this.source,t)},b.prototype.getField=function(t){var n=this;return n.source?n.source.getField(t):R},b.prototype.getFieldItem=function(t){var n=this;return n.source?n.source.getFieldItem(t):R},b.prototype.j8t=function(){return 0<this.S8t},b.prototype.O8t=function(){this.S8t++},b.prototype.R8t=function(){this.S8t--},b.prototype.SetAsyncResult=function(t,n){this.source.op().MX.SetAsyncResult(t,n)},b.prototype.cloneFrom=function(t){var n=this;n.acceptsReference=t.acceptsReference,n.arrayFormulaMode=t.arrayFormulaMode},v=b,t.EvaluateContext=v,O.CalcSource.prototype.getEvaluatorContext=function(t,n,e,i,r){return new v(this,t,n,e,i,r)},y.prototype.setAsyncResult=function(t){this.node.Y6=t,this.node.yL=!0,this.ctx.SetAsyncResult(this,t);var n=this.ctx.source;n.B8t||(n.B8t=!0,setTimeout(function(){n.refresh(),delete n.B8t},200))},y.prototype.getFormula=function(){return this.ctx.source.getCalcService().unparse(this.ctx.source,this.expression,this.row,this.col)},y.prototype.L8t=function(){for(var t,n,t=this.node&&this.node.parent&&this.node.parent.R1t||[],n=0;n<t.length;n++)if(!t[n].yL)return!1;return!0},m=y,t.AsyncEvaluateContext=m,e(w,Q=v),w.prototype.getName=function(t){var n=this;return n.A8t?n.A8t.getCustomName(t):R},t.GloableEvaluateContext=w,M.prototype.evaluateExpression=function(t,n,e,i,r){var t,t,e,i,t=void 0===t.type&&t.WK?t.WK:t,t=this.evaluate(t,n,!!i,!!r);return t&&t.pause?t:(0,O.isLambdaFunction)(t)?d:t===B||t===R?!1===e?t:0:(e=15,"number"==typeof(t=L(t)&&!i||F(t)&&!r?this.getOneValue(n,t):t)&&-10<t&&t<10&&(1<(i=t.toString()).indexOf("000000000000")||1<i.indexOf("999999999999"))&&(e=14),j.Common.st.E8(t,O.Functions.CALC_PRECISION||e))},M.prototype.evaluate=function(t,n,e,i){var r,o,a,u;if(!t)throw(0,O.sR)().Exp_ExprIsNull;if(void 0===t.type){if(t._error)return t;t.WK&&(t=t.WK)}for(;10===t.type;)t=t.value;if(r=this,a=R,12===t.type?(a=t.needExpendIndexs,t=t.value):n.k_t&&(e=!0,a=[]),2<=(u=t.type)&&u<=6)o=r.evaluateConst(t,n,e);else if(1===u||13===u||22===u)o=r.evaluateReference(t,n,i,e);else if(8===u)o=r.evaluateName(t,n,e,i);else if(100===u)o=r.evaluateLocalName(t,n,e,i);else if(9!==u||t.value2){if(9===u)o=r.evaluateBinaryOperation(t,n,e,i,a);else if(7===u){if(t.u8t&&n.N_t&&(o=r.evaluateBranchFunction(t,n,e,i,a))&&o.pause)return o;o=r.evaluateFunction(t,n,e,i,a)}else if(11===u)o=B;else if(14===u)o=r.evaluateField(t,n);else if(15===u)o=r.evaluateFieldItem(t,n);else if(n.evaluate)return n.evaluate(t,e,i)}else o=r.evaluateUnaryOperation(t,n,e,i,a);return o},M.prototype.evaluateConst=function(t,n,e){var t=t.value;return!L(t)||e||n&&(n.arrayFormulaMode||n.j8t())?t:t.getValue(0,0)},M.prototype.evaluateReference=function(t,n,e,i){var r,o,a,u,s,c,f,l,h,s,d,v,m,g,s,d;if(!n)return S;if(r=t.source||n.source,o=isNaN(n.row)?0:n.row,a=isNaN(n.column)?0:n.column,u=t.getRange&&t.getRange(o,a),s=t.type,!u)return 13===s?S:p;if(c=u.row<0?0:u.row,f=u.col<0?0:u.col,l=u.rowCount,h=u.colCount,u.row<0&&(u.rowUndefine=!0),u.col<0&&(u.colUndefine=!0),i&&(s=r.getRowCount(),d=r.getColumnCount(),(-1===l||s<l)&&(l=s),-1===h||d<h)&&(h=d),e||n.arrayFormulaMode)return t.endSource?n.getSheetRangeReference({source:t.source,endSource:t.endSource,row:c,col:f,rowCount:l,colCount:h}):n.getReference(r,u);if(i&&(1<l||1<h)){for(v=[],m=0;m<l;m++)for(v[m]=[],g=0;g<h;g++)v[m][g]=r.getValue(m+c,g+f);return new O.CalcArray(v)}if(1<l||1<h){if(s=o>=u.row&&o<u.row+l,d=a>=u.col&&a<u.col+h,s&&d)c=o,f=a;else{if(!s&&!d)return S;if(s&&1===h)c=o;else{if(!d||1!==l)return S;f=a}}n.WK&&n.WK.ensureSingle&&(t.$9t=!0)}else if(-1===u.row&&-1===l){if(1!==h)return S;c=o}else if(-1===u.col&&-1===h){if(1!==l)return S;f=a}return r.getValue(c,f)},M.prototype.evaluateName=function(t,n,e,i){var r,t,t;return n&&(t=(n=t.source?(r=t.source).getEvaluatorContext(n.identity,n.arrayFormulaMode,n.arrayIdentity):n).getName(t.value))?(t=(0,o.h0t)(n,t,!1,0,0,e,i),this.evaluate(t,n,e,i)):A},M.prototype.evaluateLocalName=function(t,n,e,i){var r,o,a,u,s,c;if(!t.value||!n||!n.localScopes.hasVariable(t.value))return A;if(r=n.localScopes.getVariable(t.value),(o=n.source&&n.source.Lbt&&n.source.Lbt.allowDynamicArray)||(e=t.vDt,i=t.mDt),n.arrayFormulaMode&&n.j8t())return r;if(!L(r)||e){if(!F(r)||i)return r;if(a=r,e&&1===a.getRangeCount()){for(u=[],s=0;s<a.getRowCount(0);s++)for(u[s]=[],c=0;c<a.getColumnCount(0);c++)u[s][c]=a.getValue(0,s,c);return new O.CalcArray(u)}}return this.getOneValue(n,r)},M.prototype.evaluateUnaryOperation=function(n,e,i,t,r){var o,a,o,o=!1;return r&&0<r.length&&(o=i=!0),(a=e.k_t)&&(i=!0),(o=this.evaluate(n.value,e,i,o))&&o.pause||O.Convert.BJ(o)?o:o===O.missingArgument?P:this.evaluateWithArgs(n,function(t){var t=t[0];return t&&t.getRowCount&&i&&e.WK&&(e.WK.ensureSingle&&!i?t=x(e,t):e.WK.t8t=!0),I(n.operatorType,t,i)},e,r,[o],i,t)},M.prototype.evaluateBinaryOperation=function(e,i,r,t,n){var o,a,o,u,s,c,f,l,h,h,o=i.k_t,a=[r=o?!0:r,r],u=[o=(0,O.gDt)(e.operatorType),o];if(n&&0<n.length)for(s=0;s<n.length;s++)a[n[s]]=!0,u[n[s]]=!0;for(c=function(t,n){if(0===n){for(;10===t.type;)t=t.value;if(7===t.type&&t.function&&(0,O.isFunction)(t.function)&&t.function.c9t)return null}return n},f=[e.value,e.value2],l=[],s=0;s<2;s++){if((h=this.evaluate(f[s],i,a[s],u[s]))&&h.pause)return h;if(h=c(f[s],h),O.Convert.BJ(h))return h;if(h===O.missingArgument&&f[s].value&&!f[s].value.table)return P;l[s]=h}return this.evaluateWithArgs(e,function(t){var n=t[0],t=t[1];return e.operatorType<=14&&i.WK&&(X(n)||X(t))&&(i.WK&&i.WK.ensureSingle&&!r?(n=x(i,n,f[0]),t=x(i,t,f[1])):i.WK.t8t=!0),I(e.operatorType,n,t)},i,n,l,r,t)},M.prototype.evaluateField=function(t,n){var e,n;return n?(n=(n=t.source?(e=t.source).getEvaluatorContext(n.identity,n.arrayFormulaMode,n.arrayIdentity):n).getField(t.value),i(n)&&t.value&&!t.value.table?P:n):A},M.prototype.evaluateFieldItem=function(t,n){var e,n;return n?(n=(n=t.source?(e=t.source).getEvaluatorContext(n.identity,n.arrayFormulaMode,n.arrayIdentity):n).getFieldItem(t.value),i(n)?P:n):A},M.prototype.startCache=function(){this.F8t={},this.service.Z_t&&this.asyncManager.startCalc()},M.prototype.endCache=function(){this.F8t=R},M.prototype.evaluateBranchFunction=function(t,n,e,i,r){var o,a,u,s,u,r,e,u,o=n.row+","+n.column;if(!(t.P8t&&t.P8t[o]&&t.P8t[o].WDt)&&(0,O.isFunction)(t.function))return a=t.function,u=t.arguments.length,s=a.findTestArgument(),r=(u=this.preprocessFunction(n,a,u,r,e)).acceptsArrays,e=u.keepArrayValuesFlagSet,(u=this.testArgGetBranch(n,a,t,r[s],!1,s))&&u.pause?u:(e&&delete n.k_t,0<=u.branchArgument&&"number"==typeof u.branchArgument?(t.P8t=t.P8t||{},t.P8t[o]=n.source.getCalcService().ZDt,{pause:"Branch",branch:t.s8t[o][u.branchArgument]}):void(u.testArgValue._error||delete t.u8t))},M.prototype.evaluateLetFunction=function(t,n,e,i){var r,o,a,u,s,a,s,c,r=t.arguments.length,o=this;for(n.localScopes.enterScope(),u=1;u<r-1;u+=2){if(s=t.arguments[u-1],a=t.arguments[u],s=s.value,(a=o.evaluate(a,n,e,i))&&a.pause)return a;n.localScopes.setVariable(s,a)}return(c=o.evaluate(t.arguments[r-1],n,e,i))&&c.pause||n.localScopes.exitScope(),c},M.prototype.evaluateLambdaFunction=function(t,n,e,i){return n.source&&n.source.Lbt&&n.source.Lbt.allowDynamicArray&&(n.WK.t8t=!0),new O.Functions.LambdaFunction(t,n.localScopes.createClosure())},M.prototype.evaluateISOMITTEDFunction=function(t,n,e,i){var t=t.arguments[0];return t&&100===t.type&&null===n.localScopes.getVariable(t.value)},M.prototype.preprocessFunction=function(t,n,e,i,r){var o,a,u,s,c,f,l,h,d,o=[],a=[],u=t.k_t,s=!1,c=R;for(!u&&(1===n.arrayArgumentEvaluateMode||4===n.arrayArgumentEvaluateMode&&r)&&(s=u=t.k_t=!0),f=0;f<e;f++)o[f]=n.acceptsArray(f),a[f]=n.acceptsReference(f),n.isBranch()&&t.WK&&t.WK.ensureSingle&&!r&&(a[f]=o[f]=!1);if(i&&0<i.length||u){for(c=[],f=0;f<e;f++)c[f]=!0;for(l=u?e:i.length,f=0;f<l;f++)a[h=u?f:i[f]]=o[h]=!0,(d=!(n.acceptsReference(h)&&!n.acceptsArray(h)))&&u&&n.acceptsReference(h)&&(d=!1),c[h]=d}return n.isBranch()&&(t.arrayFormulaMode||t.j8t())&&(o[n.findTestArgument()]=!0,a[n.findTestArgument()]=!0),{acceptsArrays:o,acceptsReferences:a,getReferenceValues:c,keepArrayValuesFlagSet:s}},M.prototype.testArgGetBranch=function(t,n,e,i,r,o){var e,a,u,a=-1,u=t.k_t;return t.arrayFormulaMode&&(t.k_t=!0),n.acceptsArray(o)&&t.O8t(),(e=this.evaluate(e.arguments[o],t,i,r))&&e.pause?e:(n.acceptsArray(o)&&t.R8t(),t.k_t=u,{testArgValue:e,branchArgument:a=F(e)||L(e)?a:n.findBranchArgument(e)})},M.prototype.evaluateFunction=function(t,n,e,i,r){var o;try{o=!t.function||(0,O.isExpression)(t.function)?this.evaluateLambdaFunctionCall(t,n,e,i,r):this.evaluateBuildInFunction(t,n,e,i,r)}catch(t){if((0,O.isStackOverflowError)(t)){if(2<=n.lambdaFunctionCallDepth)throw t;o=c}else o=S}return o},M.prototype.evaluateBuildInFunction=function(t,u,n,s,e){var c,i,f,l;return t&&t.function&&(0,O.isFunction)(t.function)?(c=t.function,i=t.functionName,f=this,l=u.C8t,"LET"===i?f.evaluateLetFunction(t,u,n,s):"LAMBDA"===i?f.evaluateLambdaFunction(t,u,n,s):"ISOMITTED"===i?f.evaluateISOMITTEDFunction(t,u,n,s):f.evaluateFunctionCore(t,function(t,n,e){var i,r,i,o,a,o,r=ct(t,c.R9t);return t=r.ADt,r._8t?c.isContextSensitive()?(u.acceptsReference=s||u.j8t(),c instanceof O.Functions.AsyncFunction?(f.G8t=f.G8t||{},c.evaluateWhenArgumentsIsSame()?f.evaluateAsyncFunction(u,n,c,l,t,e):f.evaluateWithCache(c,t,function(){return f.evaluateAsyncFunction(u,n,c,l,t,e)},f.G8t)):c.evaluateWithContext(u,t)):((i=u.arrayFormulaMode)&&(c.k9t={row:u.rowOffset,col:u.columnOffset}),o=(0,O.getMapping)()&&(0,O.getMapping)().builtInFunctionsMapping,a=o&&o[c.name]&&o[c.name].specialFun,o=function(){return a&&a.apply(c,t)||c.evaluate.apply(c,t)},i=i?f.evaluateWithCache(c,t,o,f.F8t):o(),delete c.k9t,i):r.Y6},u,n,s,e)):A},M.prototype.tryGetLambdaFunction=function(t,n,e,i){var r,t;if((0,O.isExpression)(t.function))r=this.evaluate(t.function,n,e,i);else if(t.isLocalFunctionName?r=n.localScopes.getVariable(t.functionName):(t=n.getName(t.functionName))&&(r=this.evaluate(t,n,e,i)),!r)return A;return r&&r.pause||f(r)||(0,O.isLambdaFunction)(r)?r:S},M.prototype.evaluateLambdaFunctionCall=function(t,o,a,u,n){var s,e,c,e,s=this,e=this.tryGetLambdaFunction(t,o,a,u);return e&&e.pause||f(e)?e:(e=(0,O.YJ)(c=e,t.arguments),this.evaluateFunctionCore(e,function(t){var n,e,i,r,n=o.localScopes;try{if(o.lambdaFunctionCallDepth++,n.enterScope(),n.saveThenSwitchClosure(c.closure),(i=c.parameters).length!==t.length)return S;for(r=0;r<i.length;r++)o.localScopes.setVariable(i[r].value,t[r]);e=s.evaluate(c.calculation,o,a,u)}finally{o.lambdaFunctionCallDepth--,n.exitScope(),n.restoreClosure()}return e},o,a,u,n))},M.prototype.evaluateFunctionCore=function(t,n,e,i,r,o){var a,u,s,c,f,l,h,h,d,v,m,g,p,b,y,w,M,C,S,T;if(!t||!t.function||!(0,O.isFunction)(t.function))return A;if(a=t.arguments.length,u=this,s=t.function,c=[],l=R,s instanceof O.Functions.AsyncFunction&&this.asyncManager.startCalcFunction(s,t,e),0!==a){if(d=(h=u.preprocessFunction(e,s,a,o,i)).acceptsArrays,v=h.acceptsReferences,l=h.getReferenceValues,h=h.keepArrayValuesFlagSet,p=g=m=void 0,s.isBranch()){if(g=s.findTestArgument(),(b=u.testArgGetBranch(e,s,t,d[g],v[g],g))&&b.pause)return b;m=b.testArgValue,p=b.branchArgument}for(y=0;y<a;y++){if(g===y)f=m;else{if(0<=p&&y!==p){c[y]=null;continue}if(s.acceptsArray(y)&&e.O8t(),(f=u.evaluate(t.arguments[y],e,d[y],v[y]))&&f.pause)return f;s.acceptsArray(y)&&e.R8t()}if(!s.acceptsArray(y)&&L(f)||!s.acceptsReference(y)&&F(f))if(w=L(f)?f:R,M=F(f)?f:R,w&&1===w.getRowCount()&&1===w.getColumnCount())f=w.getValue(0,0);else if(M&&1===M.getRowCount(0)&&1===M.getColumnCount(0))f=M.getValue(0,0,0);else{if(S=!(C=[]),o)for(T=0;T<o.length;T++)C.push(o[T]),o[T]===y&&(S=!0);S||(C.push(y),o=C),!s.acceptsReference(y)&&f.referenceInTwoDimension&&f._Dt()}if(O.Convert.BJ(f)&&!s.acceptsError(y))return s instanceof O.Functions.AsyncFunction&&this.asyncManager.endCalcFunction(),f;f!==O.missingArgument||s.acceptsMissingArgument(y)||(f=R),(c[y]=f)&&"INDIRECT"!==t.functionName&&f.V9t&&f.rT&&K(f,e)}}return h&&delete e.k_t,u.evaluateWithArgs(t,n,e,o,c,i,r,l)},M.prototype.evaluateAsyncFunction=function(t,n,e,i,r,o){var a,u,t,a=this.asyncManager.getNode();if(a.yL)u=a.Y6;else if(a.canEvaluate()){if(t=new m(t,a),u=e.evaluateWithContext(t,r),t.notAsync)return u;u===B?u=a.Y6!==B?a.Y6:e.defaultValue():1===a.evaluateMode&&(a.yL=!0)}else u=a.Y6!==B?a.Y6:e.defaultValue();return a.Y6=u,o||this.asyncManager.endCalcFunction(),u},M.prototype.evaluateWithCache=function(t,n,e,i){var r,o,a,u,s,c,f,l,h,e,d,v;if(i)if(o=!1,r=i[t.name+n.length])for(a=0;a<r.length;a++){if(o=!1,(u=r[a]).args.length===n.length){for(o=!0,s=0;s<n.length;s++)if((c=u.args[s])!==(f=n[s])){if(!(c instanceof O.CalcReference&&f instanceof O.CalcReference)){o=!1;break}if(l=c.SDt,c.rT!==f.rT||l!==f.SDt){o=!1;break}for(h=0;h<l;h++)if(c.getRow(h)!==f.getRow(h)||c.getColumn(h)!==f.getColumn(h)||c.getRowCount(h)!==f.getRowCount(h)||c.getColumnCount(h)!==f.getColumnCount(h)){o=!1;break}}o&&!q(u.k9t,t.k9t)&&(o=!1)}if(o)return u.flag++,u.value}else r=i[t.name+n.length]=[];if(e=e(),i&&e!==B){if(100<=(d=r.length)){for(v=[],a=0;a<d;a++)0<r[a].flag&&v.push(r[a]);v.sort(function(t,n){return n.flag-t.flag}),d=Math.min(50,v.length),r=v.slice(0,d),i[t.name+n.length]=r}r.push({args:n,value:e,flag:0,k9t:t.k9t})}return e},M.prototype.SetAsyncResult=function(t){var n;t.L8t()&&((n=t.ctx).identity&&n.identity.Tbt?this.service.Abt(n.source,n.WK,n.identity,n.S_t,n):n.source.op().recalculate(n.source,t.row,t.col,!0))},M.prototype.evaluateWithArgs=function(t,n,e,i,r,o,a,u){var s,c,f,l,h,d,v,m,g,p,b,y,w,M,C,f=e.k_t;if(f&&!(i&&0<i.length)&&(i=[],s=7===t.type&&t.function)&&r.forEach(function(t,n){(!s.acceptsArray(n)&&L(t)||!s.acceptsReference(n)&&F(t))&&i.push(n)}),i&&0<i.length){if(!(l=this.U8t(e,t,r,i,u)))return P;for(h=[],d=l[0].length,v=l[0][0].length,m=0;m<d;m++)for(h[m]=[],g=0;g<v;g++)try{for(p=[],b=0;b<r.length;b++)p[b]=l[b][m][g];if(c=n(p,t,m+1!==d||g+1!==v),F(c)&&!f){if(7===t.type&&(s=t.function).returnReference&&s.returnReference())return c;c=this.getOneValue(e,c)}h[m][g]=c,e.WK.t8t=!0}catch(t){if((0,O.isStackOverflowError)(t))throw t;h[m][g]=S}return new O.CalcArray(h,f)}try{if(c=n(r,t),15===t.operatorType&&c&&c.V9t&&K(c,e),e.arrayFormulaMode&&e.j8t())return c;if(!L(c)||o){if(!F(c)||a)return c;if(y=c,o&&1===y.getRangeCount()){for(w=[],M=0;M<y.getRowCount(0);M++)for(w[M]=[],C=0;C<y.getColumnCount(0);C++)w[M][C]=y.getValue(0,M,C);return new O.CalcArray(w)}!o&&e.WK&&e.WK.ensureSingle&&(1<c.getColumnCount()||1<c.getRowCount())&&(t.$9t=!0)}return this.getOneValue(e,c)}catch(t){if((0,O.isStackOverflowError)(t))throw t;return S}},M.prototype.getOneValue=function(t,n){var e,i,r,o,a,o;return F(n)?(o=(r=n).getRowCount(0),a=r.getColumnCount(0),n=1<r.getRangeCount()||!t.arrayFormulaMode&&1<o&&1<a?S:(i=-1!==t.rowOffset||-1!==t.columnOffset?(e=1===o?0:t.arrayFormulaMode?t.rowOffset:t.rowOffset-r.getRow(0),1===a?0:t.arrayFormulaMode?t.columnOffset:t.columnOffset-r.getColumn(0)):(e=1===o?0:t.row-r.getRow(0),1===a?0:t.column-r.getColumn(0)),o<=e||a<=i?P:r.getValue(0,e,i))):L(n)&&(o=n,n=!t.arrayFormulaMode||-1===t.rowOffset&&-1===t.columnOffset?o.getValue(0,0):(e=1===o.getRowCount()?0:t.rowOffset,i=1===o.getColumnCount()?0:t.columnOffset,e>=o.getRowCount()||i>=o.getColumnCount()?P:o.getValue(e,i))),F(n)||L(n)?this.getOneValue(t,n):n},M.prototype.U8t=function(t,n,e,i,r){var o,a,u,s,c,f,l,h,d,v,n,m,g,p,b,y,w,M,C,S,T,A,I,x,N,k,D,_,E,o=1,a=1,u=-1,s=!0,c=!0,h=1,d=1,v=7===n.type?n:R,n=v&&v.function,m=t.arrayFormulaMode||t.source&&t.source.Lbt&&t.source.Lbt.allowDynamicArray;if(n&&(0,O.isFunction)(n)&&!n.expandRows()&&(s=!1),n&&(0,O.isFunction)(n)&&!n.expandColumns()&&(c=!1),n&&(0,O.isFunction)(n)&&n.isBranch()&&(m||t.j8t())){if(u=n.findTestArgument(),p=!(g=[]),i)for(b=0;b<i.length;b++)g.push(i[b]),i[b]===u&&(p=!0);if(p||L(e[u])||F(e[u])){for(y=0;y<v.arguments.length;y++)y!==u&&j.Common.Uf.hD(g,y)<0&&(L(e[y])||F(e[y]))&&g.push(y);i=g}}for(w=[],C=i[M=0],S=e.length,I=[],T=0;T<S;T++)A=e[T],l=f=R,h=d=1,T===C?(f=L(A)?A:R,l=F(A)?A:R,(f||l)&&(h=f&&f.getRowCount()||(s&&l?l.getRowCount(0):1),d=f&&f.getColumnCount()||(c&&l?l.getColumnCount(0):1)),C=++M<i.length?i[M]:-1):r===B&&(f=L(A)?A:R,l=F(A)?A:R,f||l)&&(h=f&&f.getRowCount()||(s&&l?l.getRowCount(0):1),d=f&&f.getColumnCount()||(c&&l?l.getColumnCount(0):1)),I[T]=[f,l,A,h,d],o=o<h?h:o,a=a<d?d:a;for(T=0;T<S;T++){if(x=w[T]=[],f=(N=I[T])[0],l=N[1],A=N[2],h=N[3],d=N[4],(f||l)&&(1!==h&&h!==o||1!==d&&d!==a)&&(-1===u||T===u)&&!m)return;for(k=0;k<o;k++)for(D=x[k]=[],_=0;_<a;_++)1!==h&&h<=k||1!==d&&d<=_?D[_]=P:f?(E=f.getValue(1===h?0:k,1===d?0:_),L(E)&&(E=E.getValue(0,0)),D[_]=E):l?!r||r[T]?D[_]=l.getValue(0,1===h?0:k,1===d?0:_):D[_]=l.create([J(l.getRow(0)+(1===h?0:k),l.getColumn(0)+(1===d?0:_),1,1)]):D[_]=A}return w},t.Evaluator=M,$.prototype.canEvaluate=function(){for(var t,n,t=this.R1t,n=0;n<t.length;n++)if(!t[n].yL)return!1;return!0},g=$,t.AsyncFunctionNode=g,C.prototype.startCalc=function(){var t,n,e,i,r,o,a,u,s;if(this.k8t)for(n in this.b8t)if(e=this.b8t[n])for(i in e)if(r=e[i])for(o in r)if((a=r[o])&&(a.root.R1t=[],0<(t=a.length)))for(u=0;u<t;u++)0===(s=a[u]).evaluateMode&&(s.yL=!1)},C.prototype.startCalcCell=function(t,n){var e,i,r,o,a,t,u,t,n,e=this,i=t.getName(),r=n.row,o=n.col;e.source=t,n.Tbt?(a=(t=(t=e.b8t["-"])||(e.b8t["-"]={}))[n.Tbt])?a=a[0]:(u=new g(-1),t[n.Tbt]=[],(a=t[n.Tbt][0]=[]).root=u):(a=(n=(n=(t=(t=e.b8t[i])||(e.b8t[i]={}))[r])||(t[r]={}))[o])||(u=new g(-1),(a=n[o]=[]).root=u),e.k8t++,e.N8t=0,e.cellNodes=a,e.row=r,e.col=o,e.x8t[0]=a.root,e.evaluateMode=-1},C.prototype.x_t=function(t){for(var n,e,n=this.b8t["-"][t][0].root.R1t,e=0;e<n.length;e++)if(!n[e].yL)return!1;return!0},C.prototype.T_t=function(t){return 0<this.b8t["-"][t][0].length},C.prototype.I_t=function(t){delete this.b8t["-"][t]},C.prototype.startCalcFunction=function(t,n,e){var i,r,o,a,u,s,c,f,n,l,h,d,v,m,i=this,r=n.arguments,o=!1;if(0!==i.x8t.length&&i.cellNodes||(o=!0,i.startCalcCell(e.source,e.identity)),a=i.evaluateMode,u=t.evaluateMode(),"REFRESH"===t.name?(u=r[1]?i.MX.evaluate(r[1],e,!1,!1):0,i.evaluateMode=u):-1!==a&&(u=a),c=e.identity?e.identity.Tbt||e.identity.row+"|"+e.identity.col:"0",n.H8t&&n.H8t[c]?(s=n.H8t[c]).I8t&&(s.I8t=!1,i.cellNodes.push(s)):(n.H8t=n.H8t||{},s=n.H8t[c]=new g(i.cellNodes.length,u),i.cellNodes.push(s)),i.currentNode=s,i.x8t[i.N8t].R1t.indexOf(s)<0&&(i.x8t[i.N8t].R1t.push(s),s.parent=i.x8t[i.N8t],s.R1t=[]),i.x8t.push(s),i.N8t++,2===u&&-1===a){for(f=6e4,n=i.intervals,l=t.interval()||6e4,"REFRESH"===t.name&&(s.isRefresh=!0,l=r[2]?i.MX.evaluate(r[2],e,!1,!1):6e4),n||(i.intervals=n={}),(h=n[l])||"object"!=typeof window||((h=n[l]=[]).intervalObj=window.setInterval(function(){var t,n,e,t=i.intervals[l];for(d=0;d<t.length;d++)(e=(n=t[d]).node).yL=!1,e.isRefresh&&tt(e),i.MX.service.recalculate(n.source,n.row,n.col,!0),i.source.refresh()},l)),v=!1,d=0;d<h.length;d++)if((m=h[d]).source===i.source&&m.node===s&&m.row===i.row&&m.col===i.col){v=!0;break}v||h.push({source:i.source,node:s,row:i.row,col:i.col})}return o&&i.endCalcCell(),s},C.prototype.getNode=function(){return this.currentNode},C.prototype.endCalcFunction=function(){this.x8t.pop(),this.N8t--,this.currentNode=this.currentNode.parent},C.prototype.endCalcCell=function(){var t=this;t.N8t=-1,t.x8t=[]},C.prototype.clearCell=function(t,n){var e,i,r,o,i,i,r,r,a,u,s,c,f,l,h,e=this;if(e.k8t&&(i=t.getName(),r=n.row,o=n.col,e.source=t,(i=e.b8t[i])&&(i=i[r])&&(r=i[o])&&((a=(r=r[0])&&r.y8t)&&(delete a.Z_t,delete a.p8t),r&&(r.yL=!1,r.I8t=!0),i[o]=B,e.k8t--),"object"==typeof window))for(s in u=e.intervals)if(c=u[s]){for(f=[],l=0;l<c.length;l++)(h=c[l]).source===t&&h.row===n.row&&h.col===n.col||f.push(h);f.length?f.length!==c.length&&(f.intervalObj=c.intervalObj,u[s]=f):(u[s]=B,window.clearInterval(c.intervalObj))}},C.prototype.setAsyncResult=function(t,n){t.Y6=n},C.prototype.addRows=function(t,n,e){this.z8t(t,n,e,!0)},C.prototype.deleteRows=function(t,n,e){this.z8t(t,n,e,!1)},C.prototype.z8t=function(t,n,e,i){var r,o,a,u,s,c,f,l,h,d,v,m,g,p,r=this;if(r.k8t){if(o=t.getName(),a=r.b8t[o]){for(s in u={},a)(c=a[s])&&(f=parseInt(s,10),i?u[l=n<=f?f+e:f]=c:f<n?u[f]=c:n+e<=f&&(u[f-e]=c));r.b8t[o]=u}for(d in h=r.intervals)if(v=h[d]){for(m=[],g=0;g<v.length;g++)(p=v[g]).source===t&&i&&p.row>=n?p.row+=e:p.source===t&&!i&&(p.row<n||p.row>=n+e)&&(p.row=p.row<n?p.row:p.row-e,m.push(p));i||m.length===v.length||(m.intervalObj=v.intervalObj,h[d]=m)}}},C.prototype.addColumns=function(t,n,e){this.V8t(t,n,e,!0)},C.prototype.deleteColumns=function(t,n,e){this.V8t(t,n,e,!1)},C.prototype.V8t=function(t,n,e,i){var r,o,a,u,s,c,f,l,h,d,v,m,g,p,b,y,r=this;if(r.k8t){if(o=t.getName(),a=r.b8t[o])for(u in a)if(s=a[u]){for(f in c={},s)(l=s[f])&&l.length&&(h=parseInt(f,10),i?c[d=n<=h?h+e:h]=l:h<n?c[h]=l:n+e<=h&&(c[h-e]=l));a[u]=c}for(m in v=r.intervals)if(g=v[m]){for(p=[],b=0;b<g.length;b++)(y=g[b]).source===t&&i&&y.col>=n?y.col+=e:y.source===t&&!i&&(y.col<n||y.col>=n+e)&&(y.col=y.col<n?y.col:y.col-e,p.push(y));i||p.length===g.length||(p.intervalObj=g.intervalObj,v[m]=p)}}},C.prototype.changeSourceName=function(t,n){var e,i,e=this;e.k8t&&(i=e.b8t[t])&&(e.b8t[n]=i,delete e.b8t[t])},H=C,t.evaluateOperator=I,z=O.Convert.uJ,V=O.Convert.z6t,Y=O.Convert.j,Z=O.Convert.kDt,W=O.Convert.U6t},"./src/map.ts":function(t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.createMap=void 0;var e=(i.prototype.has=function(t){return!!this.Y8t[this.Z8t(t)]},i.prototype.get=function(t){var t=this.Y8t[this.Z8t(t)];return t&&t.value},i.prototype.delete=function(t){var t,n,e,i,t=this.Z8t(t),n=this.Y8t[t];if(!n)return!1;if(this.size--,this.size){if(e=void 0,n!==this.W8t)for(e=this.W8t;e&&e.next!==n;)e=e.next;i=n.next,e?e.next=i:this.W8t=i,i&&(i.prev=e)}else this.W8t=null;return delete this.Y8t[t],delete this.Q8t[t],!0},i.prototype.set=function(t,n){var e,i,e,e=this.Y8t,i=this.Z8t(t);return e[i]?e[i].value=n:(this.size++,e=e[i]={key:t,keyStamp:i,value:n,next:this.W8t},this.W8t=e),this},i.prototype.clear=function(){var t,n,t=this.Y8t;for(n in t)Object.prototype.hasOwnProperty.call(t,n)&&delete t[n];this.Q8t={},this.W8t=null,this.size=0},i.prototype.forEach=function(t,n){for(var e=this.W8t;e;)for(t.call(n,e.value,e.key,this);(e=e.next)&&!this.Y8t[e.keyStamp];);},i.prototype.toString=function(){return"[object Map]"},i.prototype.Z8t=function(t){switch(typeof t){case"undefined":return"undefined";case"object":if(null===t)return"null";break;case"boolean":return"?"+t;case"number":return"+"+t;case"string":return","+t}return""},i);function i(t){if(this.Y8t=Object.create(null),this.Q8t={},this.W8t=null,this.size=0,t)for(var n=0,e=t.length;n<e;n++)this.set(t[n][0],t[n][1])}function r(){return new(Map&&-1!==Map.toString().indexOf("[native code]")&&new Map([[1,1]]).size?Map:e)}n.createMap=r},"./src/referenceExpression.ts":function(t,n,e){var i,r,b,o,e,y,s,w,M,a,u;function c(t){return u.call(this,t)||this}function f(t,n,e,i,r,o){var a=new M(1);return a.row=e,a.column=i,a.rowRelative=r,a.columnRelative=o,t&&(a.source=t),n&&(a.endSource=n),a}function l(t,n,e,i,r,o,a,u,s,c,f,l,h){var d,v,m,g,p,l,d=new M(1);return y(r)||(r=s?w(r+f,b.MAX_ROW_COUNT-1)-f:w(r,b.MAX_ROW_COUNT-1)),y(o)||(o=c?w(o+l,b.MAX_COLUMN_COUNT-1)-l:w(o,b.MAX_COLUMN_COUNT-1)),0===(u?i+l:i)&&(c?o+l:o)===b.MAX_COLUMN_COUNT-1&&(i=o=b.BAND_INDEX_CONST),d.isFullRow=i===b.BAND_INDEX_CONST,f=f||0,l=l||0,m=e-(a?0:f),g=i-(u?0:l),p=r-(s?0:f),l=o-(c?0:l),0===(a?e+f:e)&&(s?r+f:r)===b.MAX_ROW_COUNT-1&&(e=r=b.BAND_INDEX_CONST),d.isFullColumn=e===b.BAND_INDEX_CONST,p<m&&(v=e,e=r,r=v,v=a,a=s,s=v),l<g&&(v=i,i=o,o=v,v=u,u=c,c=v),d.row=e,d.column=i,d.endRow=r,d.endColumn=o,d.rowRelative=a,d.columnRelative=u,d.endRowRelative=s,d.endColumnRelative=c,d.isArrayReference=h,d.isFullColumn&&d.isFullRow&&(d.rowRelative=!1,d.endRowRelative=!1),t&&(d.source=t),n&&(d.endSource=n),d}function h(t,n,e){var i={row:-1,col:-1,rowCount:-1,colCount:-1},r,o,a,u;return t.isFullRow?(i.col=-1,i.colCount=-1):(a=t.columnRelative?(a=t.column+e)>=b.MAX_COLUMN_COUNT?a%b.MAX_COLUMN_COUNT:a:t.column,t.hmt()?(i.col=a,i.colCount=1):(u=t.endColumnRelative?(u=t.endColumn+e)>=b.MAX_COLUMN_COUNT?u%b.MAX_COLUMN_COUNT:u:t.endColumn,i.col=a<=u?a:u,i.colCount=s(u-a)+1)),t.isFullColumn?(i.row=-1,i.rowCount=-1):(r=t.rowRelative?(r=t.row+n)>=b.MAX_ROW_COUNT?r%b.MAX_ROW_COUNT:r:t.row,t.hmt()?(i.row=r,i.rowCount=1):(o=t.endRowRelative?(o=t.endRow+n)>=b.MAX_ROW_COUNT?o%b.MAX_ROW_COUNT:o:t.endRow,i.row=r<=o?r:o,i.rowCount=s(o-r)+1)),i}i=this&&this.__extends||(a=function(t,n){return(a=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(t,n){t.__proto__=n}:function(t,n){for(var e in n)Object.prototype.hasOwnProperty.call(n,e)&&(t[e]=n[e])}))(t,n)},function(t,n){if("function"!=typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function e(){this.constructor=t}a(t,n),t.prototype=null===n?Object.create(n):(e.prototype=n.prototype,new e)}),Object.defineProperty(n,"__esModule",{value:!0}),n.getRangeForReference=n.lJ=n.knt=n.ReferenceExpression=void 0,r=e("Common"),b=e("./src/calc.common.ts"),o=void 0,e=r.Common.lt,y=e.ht,s=Math.abs,w=Math.min,u=b.Expression,i(c,u),c.prototype.hmt=function(){var t=this;return t.endRow===o||t.endColumn===o},c.prototype.Tyt=function(){var t=this;return t.isFullRow&&t.isFullColumn?3:t.isFullRow?1:t.isFullColumn?2:0},c.prototype.getRange=function(t,n){return h(this,t,n)},c.prototype.offset=function(t,n,e,i,r){var o,a,u,a,o=this,a=o.source,u=o.endSource;return o.hmt()?f(a,u,o.row+(o.rowRelative||e?t:0),o.column+(o.columnRelative||e?n:0),o.rowRelative,o.columnRelative):((a=l(a,u,o.row+(o.rowRelative||e?t:0),o.column+(o.columnRelative||e?n:0),o.endRow+(o.isFullColumn||!o.endRowRelative&&!e?0:t),o.endColumn+(o.isFullRow||!o.endColumnRelative&&!e?0:n),o.rowRelative,o.columnRelative,o.endRowRelative,o.endColumnRelative,i,r)).isFullRow=o.isFullRow,a.isFullColumn=o.isFullColumn,a)},c.prototype.offset2=function(t,n,e,i,r,o){var a,u,s,a=this,u;return(a.endRowRelative?a.endRow+r:a.endRow)>=b.MAX_ROW_COUNT-1&&(e=0),(s=a.endColumnRelative?a.endColumn+o:a.endColumn)>=b.MAX_COLUMN_COUNT-1&&(i=0),l(a.source,a.endSource,a.row+(a.isFullColumn?0:t),a.column+(a.isFullRow?0:n),a.endRow+(a.isFullColumn?0:e),a.endColumn+(a.isFullRow?0:i),a.rowRelative,a.columnRelative,a.endRowRelative,a.endColumnRelative,r,o)},M=c,n.ReferenceExpression=M,n.knt=f,n.lJ=l,n.getRangeForReference=h},"./src/text_Filter/charProcess.ts":function(t,n){var e,i,r;function o(){this.otherChar=0,this.control=1,this.numeric=2,this.mathSymbol=3,this.symbol=4,this.punctuation=5,this.space=6,this.upperCase=7,this.lowerCase=8,this.katakana=9,this.hiragana=10,this.farEastPunctuation=11,this.hangul=12,this.fullWidth=32768}function a(){this.minValue="\0",this.maxValue="\uffff",this.ANSI_START=0,this.ANSI_END=255,this.BOTH_WIDTH_START=65280,this.BOTH_WIDTH_END=65519,this.FULL_ALPHA_START=65281,this.FULL_UPPER_START=65313,this.FULL_UPPER_END=65338,this.FULL_ALPHA_END=65374,this.CJK_HALF_SYMBOL_START=65377,this.CJK_HALF_SYMBOL_END=65380,this.KANA_HALF_START=65381,this.KANA_HALF_END=65439,this.HANGUL_HALF_START=65440,this.HANGUL_HALF_END=65500,this.FULL_SYMBOL_START=65504,this.FULL_SYMBOL_END=65510,this.HALF_VARIANTS_START=65512,this.HALF_VARIANTS_END=65518,this.KATAKANA_VOICED="\uff9e",this.KATAKANA_SEMI_VOICED="\uff9f",this.tab="\t",this.space=" ",this.K8t=new Array("\0","\x80","\u0100","\u0180","\u0250","\u02b0","\u0300","\u0370","\u0400","\u0530","\u0590","\u0600","\u0700","\u0780","\u0900","\u0980","\u0a00","\u0a80","\u0b00","\u0b80","\u0c00","\u0c80","\u0d00","\u0d80","\u0e00","\u0e80","\u0f00","\u1000","\u10a0","\u1100","\u1200","\u13a0","\u1400","\u1680","\u16a0","\u1780","\u1800","\u1e00","\u1f00","\u2000","\u2070","\u20a0","\u20d0","\u2100","\u2150","\u2190","\u2200","\u2300","\u2400","\u2440","\u2460","\u2500","\u2580","\u25a0","\u2600","\u2700","\u2800","\u2e80","\u2f00","\u2ff0","\u3000","\u3040","\u30a0","\u3100","\u3130","\u3190","\u31a0","\u3200","\u3300","\u3400","\u4e00","\ua000","\ua490","\uac00","\uf900","\ufb00","\ufb50","\ufe20","\ufe30","\ufe50","\ufe70","\uff00","\ufff0"),this.blocks=new Array("BASIC_LATIN","LATIN_1_SUPPLEMENT","LATIN_EXTENDED_A","LATIN_EXTENDED_B","IPA_EXTENSIONS","SPACING_MODIFIER_LETTERS","COMBINING_DIACRITICAL_MARKS","GREEK","CYRILLIC","ARMENIAN","HEBREW","ARABIC","SYRIAC","THAANA","DEVANAGARI","BENGALI","GURMUKHI","GUJARATI","ORIYA","TAMIL","TELUGU","KANNADA","MALAYALAM","SINHALA","THAI","LAO","TIBETAN","MYANMAR","GEORGIAN","HANGUL_JAMO","ETHIOPIC","CHEROKEE","UNIFIED_CANADIAN_ABORIGINAL_SYLLABIC","OGHAM","RUNIC","KUMER","MONGOLIAN","LATIN_EXTENDED_ADDITIONAL","GREEK_EXTENDED","GENERAL_PUNCTUATION","SUPERSCRIPTS_AND_SUBSCRIPTS","CURRENCY_SYMBOLS","COMBINING_MARKS_FOR_SYMBOLS","LETTERLIKE_SYMBOLS","NUMBER_FORMS","ARROWS","MATHEMATICAL_OPERATORS","MISCELLANEOUS_TECHNICAL","CONTROL_PICTURES","OPTICAL_CHARACTER_RECOGNITION","ENCLOSED_ALPHANUMERICS","BOX_DRAWING","BLOCK_ELEMENTS","GEOMETRIC_SHAPES","MISCELLANEOUS_SYMBOLS","DINGBATS","BRAILLE_PATTERNS","CJK_RADICALS_SUPPLEMENT","KANGXI_RADICALS","IDEOGRAPHIC_DESCRIPTION_CHARACTERS","CJK_SYMBOLS_AND_PUNCTUATION","HIRAGANA","KATAKANA","BOPOMOFO","HANGUL_COMPATIBILITY_JAMO","KANBUN","BOPOMOFO_EXTENDED","ENCLOSED_CJK_LETTERS_AND_MONTHS","CJK_COMPATIBILITY","CJK_UNIFIED_IDEOGRAPHS_EXTENSION","CJK_UNIFIED_IDEOGRAPHS","YI_SYLLABLES","YI_RADICALS","HANGUL_SYLLABLES","CJK_COMPATIBILITY_IDEOGRAPHS","ALPHABETIC_PRESENTATION_FORMS","ARABIC_PRESENTATION_FORMS_A","COMBINING_HALF_MARKS","CJK_COMPATIBILITY_FORMS","SMALL_FORM_VARIANTS","ARABIC_PRESENTATION_FORMS_B","HALFWIDTH_AND_FULLWIDTH_FORMS","SPECIALS"),this.J8t=["\uff01","\uff10","\uff1a","\uff21","\uff3b","\uff41","\uff5b","\uff61","\uff65","\uffa0","\uffe0","\uffe8"],this.X8t=new e,this.q8t=[this.X8t.symbol|this.X8t.fullWidth,this.X8t.numeric|this.X8t.fullWidth,this.X8t.symbol|this.X8t.fullWidth,this.X8t.upperCase|this.X8t.fullWidth,this.X8t.symbol|this.X8t.fullWidth,this.X8t.lowerCase|this.X8t.fullWidth,this.X8t.symbol|this.X8t.fullWidth,this.X8t.farEastPunctuation,this.X8t.katakana,this.X8t.hangul,this.X8t.symbol|this.X8t.fullWidth,this.X8t.symbol],this.$8t=new Array("\u30fb","\u30f2","\u30a1","\u30a3","\u30a5","\u30a7","\u30a9","\u30e3","\u30e5","\u30e7","\u30c3","\u30fc","\u30a2","\u30a4","\u30a6","\u30a8","\u30aa","\u30ab","\u30ad","\u30af","\u30b1","\u30b3","\u30b5","\u30b7","\u30b9","\u30bb","\u30bd","\u30bf","\u30c1","\u30c4","\u30c6","\u30c8","\u30ca","\u30cb","\u30cc","\u30cd","\u30ce","\u30cf","\u30d2","\u30d5","\u30d8","\u30db","\u30de","\u30df","\u30e0","\u30e1","\u30e2","\u30e4","\u30e6","\u30e8","\u30e9","\u30ea","\u30eb","\u30ec","\u30ed","\u30ef","\u30f3","\u3099","\u309a"),this.tEt=new Array("\uff67","\uff71","\uff68","\uff72","\uff69","\uff73","\uff6a","\uff74","\uff6b","\uff75","\uff76","\uff76","\uff77","\uff77","\uff78","\uff78","\uff79","\uff79","\uff7a","\uff7a","\uff7b","\uff7b","\uff7c","\uff7c","\uff7d","\uff7d","\uff7e","\uff7e","\uff7f","\uff7f","\uff80","\uff80","\uff81","\uff81","\uff6f","\uff82","\uff82","\uff83","\uff83","\uff84","\uff84","\uff85","\uff86","\uff87","\uff88","\uff89","\uff8a","\uff8a","\uff8a","\uff8b","\uff8b","\uff8b","\uff8c","\uff8c","\uff8c","\uff8d","\uff8d","\uff8d","\uff8e","\uff8e","\uff8e","\uff8f","\uff90","\uff91","\uff92","\uff93","\uff6c","\uff94","\uff6d","\uff95","\uff6e","\uff96","\uff97","\uff98","\uff99","\uff9a","\uff9b","\uff9c","\uff9c","\uff68","\uff6a","\uff66","\uff9d","\uff73","\uff76","\uff79","\uff9c","\uff68","\uff6a","\uff66","\uff65","\uff70"),this.nEt=["\uff67","\uff68","\uff69","\uff6a","\uff6b","\uff6c","\uff6d","\uff6e","\uff6f"],this.eEt=new Array(0,0,0,0,0,0,0,0,0,0,-1,1,-1,1,-1,1,-1,1,-1,1,-1,1,-1,1,-1,1,-1,1,-1,1,-1,1,-1,1,0,-1,1,-1,1,-1,1,0,0,0,0,0,-3,1,2,-3,1,2,-3,1,2,-3,1,2,-3,1,2,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,1,1,1,1,0,0),this.iEt=["\u2018","\u2019","\u201c","\u201d"],this.rEt=["\u30fc"],this.oEt=new Array("\u3000","\u3001","\u3002","\u300c","\u300d","\u201c","\u201d","\u2018","\u2019","\u309b","\u309c","\uffe5"),this.aEt=new Array(" ","\uff64","\uff61","\uff62","\uff63",'"','"',"'","'","\uff9e","\uff9f","\xa5")}function u(){this.charCategory=new i,this.charType=new e}Object.defineProperty(n,"__esModule",{value:!0}),n.uEt=n.sEt=n.CharType=void 0,e=o,n.CharType=e,i=a,n.sEt=i,u.prototype.isAlphabet=function(t){var n=this;return n.isUpper(t)||n.isLower(t)},u.prototype.isHiragana=function(t){var n=this;return(n.getCharType(t)&~n.charType.fullWidth)===n.charType.hiragana||n.charCategory.rEt[0]===t},u.prototype.getCharType=function(t){var n,e,i,n=this,e=n.charType.otherChar,i=n.belongTo(t);if("\x7f"===t||"\0"<=t&&t<="\x1f"||"\x80"<=t&&t<="\x9f")return n.charType.control;if("A"<=t&&t<="Z")return n.charType.upperCase;if("a"<=t&&t<="z")return n.charType.lowerCase;if("0"<=t&&t<="9")return n.charType.numeric;switch((n.isFullWidthSymbol(t)||n.isHalfWidthSymbol(t))&&(e=n.charType.symbol),8216!==t.charCodeAt(0)&&8217!==t.charCodeAt(0)&&8220!==t.charCodeAt(0)&&8221!==t.charCodeAt(0)||(e=n.charType.punctuation),12288===t.charCodeAt(0)&&(e=n.charType.space),n.charCategory.blocks[i]){case"HALFWIDTH_AND_FULLWIDTH_FORMS":return n.multiWidthDetails(t);case"KATAKANA":return n.charType.katakana|n.charType.fullWidth;case"HIRAGANA":return n.charType.hiragana|n.charType.fullWidth}return n.isFarEastBlock(i,t)&&(e|=n.charType.fullWidth),e},u.prototype.isLower=function(t){var n=this;return(n.getCharType(t)&~n.charType.fullWidth)===n.charType.lowerCase},u.prototype.isUpper=function(t){var n=this;return(n.getCharType(t)&~n.charType.fullWidth)===n.charType.upperCase},u.prototype.belongTo=function(t){for(var n,e,i,r,n=this,e=0,i=83,r=i>>1;1<i-e;)t>=n.charCategory.K8t[r]?e=r:i=r,r=i+e>>1;return r},u.prototype.isFullWidthSymbol=function(t){for(var n=0;n<u.fullWidthSymbolArray.length;n++)if(t===u.fullWidthSymbolArray[n])return!0;return!1},u.prototype.isHalfWidthSymbol=function(t){for(var n=0;n<u.halfWidthSymbolArray.length;n++)if(t===u.halfWidthSymbolArray[n])return!0;return!1},u.prototype.multiWidthDetails=function(t){for(var n,e,i,r,n=this,e=0,i=n.charCategory.J8t.length,r=i>>1;1<i-e;)t>=n.charCategory.J8t[r]?e=r:i=r,r=i+e>>1;return n.charCategory.q8t[r]},u.prototype.isFarEastBlock=function(t,n){var e,i,e=this;switch(e.charCategory.blocks[t]){case"CJK_COMPATIBILITY":case"CJK_COMPATIBILITY_FORMS":case"CJK_COMPATIBILITY_IDEOGRAPHS":case"CJK_RADICALS_SUPPLEMENT":case"CJK_SYMBOLS_AND_PUNCTUATION":case"CJK_UNIFIED_IDEOGRAPHS":case"CJK_UNIFIED_IDEOGRAPHS_EXTENSION":case"HALFWIDTH_AND_FULLWIDTH_FORMS":case"BOPOMOFO":case"BOPOMOFO_EXTENDED":case"HIRAGANA":case"KATAKANA":case"KANBUN":case"HANGUL_COMPATIBILITY_JAMO":case"HANGUL_JAMO":case"HANGUL_SYLLABLES":return!0;default:for(i=0;i<e.charCategory.iEt.length;i++)if(n===e.charCategory.iEt[i])return!0;if(255<n.charCodeAt(0))return!0;if(8216===n.charCodeAt(0)||8217===n.charCodeAt(0)||8220===n.charCodeAt(0)||8221===n.charCodeAt(0))return!0}return!1},u.prototype.isFullWidth=function(t){var n,e,i,n=this;return!!n.isFullWidthSymbol(t)||!n.isHalfWidthSymbol(t)&&(e=n.belongTo(t),i=n.isFarEastBlock(e,t),"HALFWIDTH_AND_FULLWIDTH_FORMS"===n.charCategory.blocks[e]?(n.multiWidthDetails(t)&n.charType.fullWidth)===n.charType.fullWidth:i)},u.prototype.toHalfWidth=function(t){return this.toHalfWidthEx(t)},u.prototype.toHalfWidthEx=function(t){var n,e,i,r,o,r,r,n=this,e=n.getCharType(t),i=n.isMultiWidth(t);if((e&n.charType.fullWidth)===n.charType.fullWidth)switch(e&~n.charType.fullWidth){case n.charType.punctuation:case n.charType.upperCase:case n.charType.lowerCase:case n.charType.symbol:case n.charType.numeric:case n.charType.mathSymbol:!1!==(r=n.getFullHalfWidthSpecialChar(t,!1))?t=r:i&&(o="!",t=String.fromCharCode(t.charCodeAt(0)-(n.charCategory.K8t[81].charCodeAt(0)+1)+"!".charCodeAt(0)));break;case n.charType.katakana:if((r=t.charCodeAt(0)-(n.charCategory.K8t[62].charCodeAt(0)+1))<0||91<r)return t;if(t=n.charCategory.tEt[r],0<(r=n.charCategory.eEt[r]))return t+=String.fromCharCode((1===r?n.charCategory.KATAKANA_VOICED:n.charCategory.KATAKANA_SEMI_VOICED).charCodeAt(0));break;case n.charType.space:t=" ";break;case n.charType.hangul:}return t},u.prototype.isMultiWidth=function(t){var n,e,n,n=this,e=n.belongTo(t),n=n.charCategory.blocks[e];return"KATAKANA"===n||"CJK_SYMBOLS_AND_PUNCTUATION"===n||"HALFWIDTH_AND_FULLWIDTH_FORMS"===n||"BASIC_LATIN"===n&&" "<=t},u.prototype.getFullHalfWidthSpecialChar=function(t,n){for(var e,n,i,r,o,i=this,n=!0===n?(e=i.charCategory.aEt,i.charCategory.oEt):(e=i.charCategory.oEt,i.charCategory.aEt),r=-1,o=0;o<e.length;){if(e[o]===t){r=o;break}o++}return-1!==r&&o<n.length&&n[o]},u.prototype.toFullWidth=function(t){var n,e,i,r,o,o,t,n={},e=this;if(n.text=t,n.processedAll=!1,0!==t.length){if(i=t.substring(0,1),e.isMultiWidth(i)){if(i<e.charCategory.K8t[1])return" "===i?n.text="\u3000":(r="!",n.text=String.fromCharCode(i.charCodeAt(0)-"!".charCodeAt(0)+(e.charCategory.K8t[81].charCodeAt(0)+1))),n;if((e.multiWidthDetails(i)&e.charType.katakana)===e.charType.katakana){if(i.charCodeAt(0)<e.charCategory.KANA_HALF_START)return o=e.getFullHalfWidthSpecialChar(i,!0),n.text=!1!==o?o:i,n;if(i=e.charCategory.$8t[i.charCodeAt(0)-e.charCategory.KANA_HALF_START],t.length<2)return n.text=i,n;1!=(o=t.charCodeAt(1)-(e.charCategory.KATAKANA_VOICED.charCodeAt(0)-1))&&2!=o||(n.processedAll=!0,0!==(t=e.charCategory.eEt[i.charCodeAt(0)-(e.charCategory.K8t[62].charCodeAt(0)+1)])&&((2&Math.abs(t))==o&&(i=String.fromCharCode(i.charCodeAt(0)+1)),i=String.fromCharCode(i.charCodeAt(0)+1))),1==o&&"\u30a6"===i&&(i="\u30f4")}}n.text=i}return n},u.prototype.isUpperKana=function(t){return!this.isLowerKana(t)},u.prototype.isLowerKana=function(t){return-1!==u.lowerKana.search(t)},u.prototype.hasLowerKana=function(t){return-1!==u.upperKana.search(t)||this.isLowerKana(t)},u.prototype.toUpperKana=function(t){var n=u.lowerKana.search(t);return-1===n?t:u.upperKana.substr(n,1)},u.prototype.toLowerKana=function(t){var n=u.upperKana.search(t);return n>=u.upperKana.length-4&&n<u.upperKana.length||-1===n?t:u.lowerKana.substr(n,1)},u.prototype.toKatakana=function(t){var n,e,n=this;return n.isCharOfType(t,n.charType.hiragana|n.charType.fullWidth)?!1!==(e=n.getFullHalfWidthSpecialChar(t,!1))?e:String.fromCharCode(t.charCodeAt(0)-n.charCategory.K8t[61].charCodeAt(0)+n.charCategory.K8t[62].charCodeAt(0)):t},u.prototype.isCharOfType=function(t,n){return this.getCharType(t)===n},u.prototype.isKatakana=function(t){var n=this;return(n.getCharType(t)&~n.charType.fullWidth)===n.charType.katakana},u.prototype.toHiragana=function(t){var n=this;return!n.isKatakana(t)||(n.isFullWidth(t)||(t=n.toFullWidth(t).text),!n.isCharOfType(t,n.charType.katakana|n.charType.fullWidth))||"\u30f7"<=t&&t<="\u30ff"?t:"\u30f5"===t?"\u304b":"\u30f6"===t?"\u3051":String.fromCharCode(t.charCodeAt(0)+n.charCategory.K8t[61].charCodeAt(0)-n.charCategory.K8t[62].charCodeAt(0))},u.prototype.isDigit=function(t){var n=this;return(n.getCharType(t)&~n.charType.fullWidth)===n.charType.numeric},u.prototype.isSurrogate=function(t){return null!==t&&t.charCodeAt(0)>="\ud800".charCodeAt(0)&&t.charCodeAt(0)<="\udfff".charCodeAt(0)},u.lowerKana="\u3041\u3043\u3045\u3047\u3049\u3063\u3083\u3085\u3087\u308e\u30a1\u30a3\u30a5\u30a7\u30a9\u30c3\u30e3\u30e5\u30e7\u30ee\uff67\uff68\uff69\uff6a\uff6b\uff6c\uff6d\uff6e\uff6f\u30f5\u30f6\u3095\u3096",u.upperKana="\u3042\u3044\u3046\u3048\u304a\u3064\u3084\u3086\u3088\u308f\u30a2\u30a4\u30a6\u30a8\u30aa\u30c4\u30e4\u30e6\u30e8\u30ef\uff71\uff72\uff73\uff74\uff75\uff94\uff95\uff96\uff82\u30ab\u30b1\u304b\u3051",u.fullWidthSymbolArray=new Array("\u3001","\u3002","\uff0c","\uff0e","\u30fb","\uff1a","\uff1b","\uff1f","\uff01","\u309b","\u309c","\xb4","\uff40","\xa8","\uff3e","\uffe3","\uff3f","\u30fd","\u30fe","\u309d","\u309e","\u3003","\u4edd","\u3005","\u3006","\u3007","\u30fc","\u2014","\u2010","\uff0f","\u301c","\u2016","\uff5c","\u2026","\u2025","\u2018","\u2019","\u201c","\u201d","\uff08","\uff09","\u3014","\u3015","\uff3b","\uff3d","\uff5b","\uff5d","\u3008","\u3009","\u300a","\u300b","\u300c","\u300d","\u300e","\u300f","\u3010","\u3011","\uff0b","\u2212","\xb1","\xd7","\xf7","\uff1d","\u2260","\uff1c","\uff1e","\u2266","\u2267","\u221e","\u2234","\u2642","\u2640","\xb0","\u2032","\u2033","\u2103","\uffe5","\uff04","\xa2","\xa3","\uff05","\uff03","\uff06","\uff0a","\uff20","\xa7","\u2606","\u2605","\u25cb","\u25cf","\u25ce","\u25c7","\u25c6","\u25a1","\u25a0","\u25b3","\u25b2","\u25bd","\u25bc","\u203b","\u3012","\u2192","\u2190","\u2191","\u2193","\u3013","\uff07","\uff02","\uff0d","\u3033","\u3034","\u3035","\u303b","\u303c","\u30ff","\u309f","\u2208","\u220b","\u2286","\u2287","\u2282","\u2283","\u222a","\u2229","\u2284","\u2285","\u228a","\u228b","\u2209","\u2205","\u2305","\u2306","\u2227","\u2228","\xac","\u21d2","\u21d4","\u2200","\u2203","\u2295","\u2296","\u2297","\u2225","\u2226","\u2985","\u2986","\u3018","\u3019","\u3016","\u3017","\u2220","\u22a5","\u2312","\u2202","\u2207","\u2261","\u2252","\u226a","\u226b","\u221a","\u223d","\u221d","\u2235","\u222b","\u222c","\u2262","\u2243","\u2245","\u2248","\u2276","\u2277","\u2194","\u212b","\u2030","\u266f","\u266d","\u266a","\u2020","\u2021","\xb6","\u266e","\u266b","\u266c","\u2669","\u25ef","\uff3c","\uff5e","\uffe0","\uffe1","\uffe2","\u2015"),u.halfWidthSymbolArray=new Array("\\","~","!",'"',"#","$","%","&","'","(",")","*","+",",","-",".","/",":",";","<","=",">","?","@","[","]","^","_","`","{","|","}","\uff61","\uff62","\uff63","\uff64","\uff65","\xa1","\xa4","\xa5"),n.uEt=u},"./src/text_Filter/emoji_helper.ts":function(t,n,e){var i,r;function o(){}Object.defineProperty(n,"__esModule",{value:!0}),n.cEt=void 0,i=e("./src/calc.common.ts"),o.isEmoji=function(t,n,e){e.emojiCharLength=0;try{if(o.isEmojiEnclosedAlphanumericSymbol(t,n))return e.emojiCharLength=2,!0;if(o.isEmojiInSpecificRange(t,n)||o.isEmojiInUnicodeStandardSymbol(t,n))return o.isHighSurrogate(t,n)?e.emojiCharLength=2:e.emojiCharLength=1,!0}catch(t){}return!1},o.isEmojiEnclosedAlphanumericSymbol=function(t,n){return!(n>=t.length-1||o.isHighSurrogate(t,n)||!o.contains(o.fEt,o.convertToUtf32(t,n))||o.lEt!==o.convertToUtf32(t,n+1))},o.isEmojiInSpecificRange=function(t,n){for(var e,i,r,e=o.convertToUtf32(t,n),i=Math.floor(o.hEt.length/2),r=0;r<i;r++)if(o.hEt[2*r]<=e&&e<=o.hEt[2*r+1])return!0;return!1},o.isEmojiInUnicodeStandardSymbol=function(t,n){var t=o.convertToUtf32(t,n);return o.contains(o.dEt,t)},o.contains=function(t,n){for(var e,i,r,e=0,i=t.length-1;e<=i;){if(t[r=Math.floor((e+i)/2)]===n)return!0;t[r]>n?i=r-1:e=r+1}return!1},o.convertFromUtf32=function(t){if(t<0||1114111<t||55296<=t&&t<=57343)throw new Error((0,i.sR)().Exp_ArgumentOutOfRangeException);return t<65536?String.fromCharCode(t):(t-=65536,String.fromCharCode(Math.floor(t/1024)+55296,t%1024+56320))},o.convertToUtf32=function(t,n){var e,t;if(n<0||n>=t.length)throw new Error((0,i.sR)().Exp_ArgumentOutOfRangeException);if((e=t.charCodeAt(n)-55296)<0||2047<e)return t.charCodeAt(n);if(1023<e)throw new Error((0,i.sR)().Exp_ArgumentException);if(n>=t.length-1)throw new Error((0,i.sR)().Exp_ArgumentException);if((t=t.charCodeAt(n+1)-56320)<0||1023<t)throw new Error((0,i.sR)().Exp_ArgumentException);return 1024*e+t+65536},o.isHighSurrogate=function(t,n){var t=t.charCodeAt(n);return 55296<=t&&t<=56319},o.isLowSurrogate=function(t,n){var t=t.charCodeAt(n);return 56320<=t&&t<=57343},o.lEt=8419,o.fEt=[35,48,49,50,51,52,53,54,55,56,57],o.hEt=[9728,9983,9984,10175,10240,10495,11008,11263,19904,19967,65936,65999,118784,119039,119040,119295,119296,119375,119552,119647,126976,127023,127024,127135,127136,127231,127232,127487,127488,127743,127744,128511,128512,128591,128640,128767,128768,128895],o.dEt=[169,174,8194,8195,8197,8252,8265,8482,8505,8596,8597,8598,8599,8600,8601,8617,8618,8986,8987,9193,9194,9195,9196,9200,9203,9410,9642,9643,9654,9664,9723,9724,9725,9726,10548,10549,12336,12349,12951,12953],n.cEt=o},"./src/text_Filter/text_Filter.ts":function(t,n,e){var r,o,a,u,s,i,e;function c(t,n,e){void 0===e&&(e=!0);var i=this;i.format=n,i.includeFormat="",i.excludeFormat="",i.includeNormalChar="",i.excludeNormalChar="",i.allowTypes=u.All,i.excludeTypes=u.All,i.include=!0,i.autoConvert=t,i.charExInstance=new r.uEt,i.keepInvalidChar=e,i.parseFormat(i.format)}Object.defineProperty(n,"__esModule",{value:!0}),n._9t=n.CharacterType=void 0,r=e("./src/text_Filter/charProcess.ts"),o=e("./src/text_Filter/emoji_helper.ts"),a=e("./src/calc.common.ts"),(e=u=n.CharacterType||(n.CharacterType={}))[e.DBCS_UpperAlphabet=2147483650]="DBCS_UpperAlphabet",e[e.SBCS_UpperAlphabet=1073741825]="SBCS_UpperAlphabet",e[e.DBCS_LowerAlphabet=2147483656]="DBCS_LowerAlphabet",e[e.SBCS_LowerAlphabet=1073741828]="SBCS_LowerAlphabet",e[e.DBCS_Number=2147483680]="DBCS_Number",e[e.SBCS_Number=1073741840]="SBCS_Number",e[e.DBCS_Binary=2147483776]="DBCS_Binary",e[e.SBCS_Binary=1073741888]="SBCS_Binary",e[e.DBCS_Hexadecimal=2147484160]="DBCS_Hexadecimal",e[e.SBCS_Hexadecimal=1073742080]="SBCS_Hexadecimal",e[e.DBCS_Symbol=2147485696]="DBCS_Symbol",e[e.SBCS_Symbol=1073742848]="SBCS_Symbol",e[e.DBCS_NumberSymbol=2147491840]="DBCS_NumberSymbol",e[e.SBCS_NumberSymbol=1073745920]="SBCS_NumberSymbol",e[e.DBCS_Katakana=2147516416]="DBCS_Katakana",e[e.SBCS_Katakana=1073758208]="SBCS_Katakana",e[e.DBCS_Space=2147614720]="DBCS_Space",e[e.SBCS_Space=1073807360]="SBCS_Space",e[e.TwoBytes=2148007936]="TwoBytes",e[e.FourBytes=2147745792]="FourBytes",e[e.DBCS_ShiftJIS=2148532224]="DBCS_ShiftJIS",e[e.DBCS_JISX0208=2149580800]="DBCS_JISX0208",e[e.Emoji=4194304]="Emoji",e[e.IVS=8388608]="IVS",e[e.DBCS_Hiragana=2164260864]="DBCS_Hiragana",e[e.Upper_SBCS_Katakana=1207959552]="Upper_SBCS_Katakana",e[e.Upper_DBCS_Katakana=2415919104]="Upper_DBCS_Katakana",e[e.Upper_DBCS_Hiragana=2684354560]="Upper_DBCS_Hiragana",e[e.All=3321888768]="All",e[e.DBCS_All=2214592512]="DBCS_All",e[e.SBCS_All=1107296256]="SBCS_All",e[e.DBCS=2147483648]="DBCS",e[e.SBCS=1073741824]="SBCS",s={"\uff21":u.DBCS_UpperAlphabet,A:u.SBCS_UpperAlphabet,"\uff41":u.DBCS_LowerAlphabet,a:u.SBCS_LowerAlphabet,"\uff2b":u.DBCS_Katakana,K:u.SBCS_Katakana,"\uff19":u.DBCS_Number,9:u.SBCS_Number,"\uff03":u.DBCS_NumberSymbol,"#":u.SBCS_NumberSymbol,"\uff20":u.DBCS_Symbol,"@":u.SBCS_Symbol,"\uff22":u.DBCS_Binary,B:u.SBCS_Binary,"\uff38":u.DBCS_Hexadecimal,X:u.SBCS_Hexadecimal,"\uff2a":u.DBCS_Hiragana,"\uff3a":u.DBCS_All,"\uff2d":u.DBCS_ShiftJIS,"\uff29":u.DBCS_JISX0208,H:u.SBCS_All,N:u.Upper_SBCS_Katakana,"\uff2e":u.Upper_DBCS_Katakana,"\uff27":u.Upper_DBCS_Hiragana,"\uff33":u.DBCS_Space,S:u.SBCS_Space,"\uff34":u.FourBytes,"\uff24":u.TwoBytes,"\uff25":u.Emoji,"\uff36":u.IVS},c.prototype.parseFormat=function(t){var n=this;n.includeFormat=n.getIncludeFormat(t),n.excludeFormat=n.getExcludeFormat(t),n.parseIncludeFormat(n.includeFormat),n.parseExcludeFormat(n.excludeFormat)},c.prototype.getIncludeFormat=function(t){var n,e,i;if(null===t||0===t.length)return"";for(n="",e=0;e<t.length;e++)if("\\"===(i=t.substring(e,e+1))){if(e===t.length-1)throw(0,a.sR)().Exp_FormulaInvalid;n=n+i+t.substring(e+1,e+2),e++}else{if("^"===i)return n;n+=i}return n},c.prototype.getExcludeFormat=function(t){var n,e,i,r;if(null===t||0===t.length)return"";for(e="",i=n=0;i<t.length;i++)if("\\"===(r=t.substring(i,i+1))){if(i===t.length-1)throw(0,a.sR)().Exp_FormulaInvalid;0!==n&&(e=e+r+t.substring(i+1,i+2)),i++}else if("^"===r){if(1<++n)throw(0,a.sR)().Exp_DuplicatedChar}else 0!==n&&(e+=r);return e=1===n?"^"+e:e},c.prototype.parseIncludeFormat=function(t){var n,e,i,i,n=this;if(null===t||0===t.length)n.allowTypes=u.All,n.includeNormalChar="",n.includeFormat="";else for(n.allowTypes=0,n.includeNormalChar="",e=0;e<t.length;e++)switch(t.charCodeAt(e)){case 94:break;case 92:if(e===t.length-1)throw(0,a.sR)().Exp_FormulaInvalid;n.includeNormalChar=n.includeNormalChar+t.substring(e+1,e+2),e++;break;default:i=t[e],(i=s[i])?n.allowTypes|=i:n.includeNormalChar=n.includeNormalChar+t.substring(e,e+1)}},c.prototype.parseExcludeFormat=function(t){var n,e,i,i,n=this;if(null===t||0===t.length)n.excludeTypes=u.All,n.excludeNormalChar="",n.excludeFormat="";else if("^"===t)n.excludeTypes=u.All,n.excludeNormalChar="",n.excludeFormat="^";else for(n.excludeTypes=0,n.excludeNormalChar="",e=0;e<t.length;e++)switch(t.charCodeAt(e)){case 94:0===e&&(n.include=!1);break;case 92:if(e===t.length-1)throw(0,a.sR)().Exp_FormulaInvalid;n.excludeNormalChar=n.excludeNormalChar+t.substring(e+1,e+2),e++;break;default:i=t[e],(i=s[i])?n.excludeTypes|=i:n.excludeNormalChar=n.excludeNormalChar+t.substring(e,e+1)}},c.prototype.checkText=function(t){for(var n,e,i,r,o,a,n=this,e=t.length,i={IsInputValid:!0,CheckedText:""},r=0;r<e;)"\t"!==(o=t.substring(r,r+1))&&"\r"!==o&&"\n"!==o?(a=n.check(t,r),n.isNullOrUndefined(a.index)?(o=a,r++):(r=a.index,o=a.strValue),""===o&&(i.IsInputValid=!1)):r++,i.CheckedText+=o;return i},c.prototype.check=function(t,n){var e,i,r,e=this,i=null!==n?t.substring(n,n+1):t,r;return e.IsValid(i)?i:e.autoConvert?null!==n?e.Convert(t,n):e.Convert(i):""},c.prototype.IsValid=function(t){var n=this;return(""===n.excludeFormat||!n.IsValidProcess(t,n.excludeTypes,n.excludeNormalChar))&&(""===n.includeFormat||n.IsIncludeValid(t))},c.prototype.Convert=function(t,n){var e,i,r,o,a,u,s,s,c,c,f,e=this,i=null===n?t:t.substring(n,n+1),r=!1;if(e.charExInstance.isAlphabet(i))return o=e.charExInstance.isLower(i)?i.toUpperCase():i.toLowerCase(),(r=e.IsValid(o))?o:(i=e.charExInstance.isFullWidth(i)?e.charExInstance.toHalfWidth(i):e.charExInstance.toFullWidth(i).text,(r=e.IsValid(i))?i:(o=e.charExInstance.isFullWidth(o)?e.charExInstance.toHalfWidth(o):e.charExInstance.toFullWidth(o).text,(r=e.IsValid(o))?o:e.keepInvalidChar?i:""));if(e.charExInstance.isHiragana(i)){if(e.charExInstance.isLowerKana(i)){if(a=e.charExInstance.toUpperKana(i),r=e.IsValid(a))return a}else if(e.charExInstance.hasLowerKana(i)&&(u=e.charExInstance.toLowerKana(i),r=e.IsValid(u)))return u;if(o=e.charExInstance.toKatakana(i),r=e.IsValid(o))return o;if(e.charExInstance.isLowerKana(o)){if(a=e.charExInstance.toUpperKana(o),r=e.IsValid(a))return a}else if(e.charExInstance.hasLowerKana(o)&&(u=e.charExInstance.toLowerKana(o),r=e.IsValid(u)))return u;if(s=e.charExInstance.toHalfWidthEx(o),r=e.IsValid(s))return s;if(e.charExInstance.isLowerKana(s)){if(s=e.charExInstance.toUpperKana(s),r=e.IsValid(s))return s}else if(e.charExInstance.hasLowerKana(s)&&(s=e.charExInstance.toLowerKana(s),r=e.IsValid(s)))return s;return e.keepInvalidChar?i:""}if(e.charExInstance.isKatakana(i)){if(e.charExInstance.isLowerKana(i)){if(a=e.charExInstance.toUpperKana(i),r=e.IsValid(a))return a}else if(e.charExInstance.hasLowerKana(i)&&(u=e.charExInstance.toLowerKana(i),r=e.IsValid(u)))return u;if(s=!1,o=i,e.charExInstance.isFullWidth(i)){if(0<(c=e.charExInstance.toHalfWidthEx(i)).length&&(r=e.IsValid(c)))return c;if(e.charExInstance.isLowerKana(c)){if(c=e.charExInstance.toUpperKana(c),r=e.IsValid(c))return c}else if(e.charExInstance.hasLowerKana(c)&&(c=e.charExInstance.toLowerKana(c),r=e.IsValid(c)))return c}else{if(null===n){if(o=e.charExInstance.toFullWidth(i).text,!e.charExInstance.isKatakana(o))return e.keepInvalidChar?i:"";if(r=e.IsValid(o))return o}else{if(n+1<t.length?(o=(c=e.charExInstance.toFullWidth(t.substring(n,n+2))).text,s=c.processedAll):o=e.charExInstance.toFullWidth(i).text,!e.charExInstance.isKatakana(o))return e.keepInvalidChar?i:"";if(r=e.IsValid(o))return n++,s&&n++,(f={}).index=n,f.strValue=o,f}if(e.charExInstance.isLowerKana(o)){if(a=e.charExInstance.toUpperKana(o),r=e.IsValid(a))return a}else if(e.charExInstance.hasLowerKana(o)&&(u=e.charExInstance.toLowerKana(o),r=e.IsValid(u)))return u}if(o=e.charExInstance.toHiragana(o),r=e.IsValid(o))return null!==n?(n++,s&&n++,(f={}).index=n,"\u3094"===(f.strValue=o)&&(f.strValue=s?"\u3046\u309b":""),f):"\u3094"===o?e.keepInvalidChar?i:"":o;if(e.charExInstance.isLowerKana(o)){if(a=e.charExInstance.toUpperKana(o),r=e.IsValid(a))return a}else if(e.charExInstance.hasLowerKana(o)&&(u=e.charExInstance.toLowerKana(o),r=e.IsValid(u)))return u}return i=e.charExInstance.isFullWidth(i)?e.charExInstance.toHalfWidth(i):e.charExInstance.toFullWidth(i).text,(r=e.IsValid(i))||e.keepInvalidChar?i:""},c.prototype.IsIncludeValid=function(t){var n=this;return n.IsValidProcess(t,n.allowTypes,n.includeNormalChar)},c.prototype.IsValidProcess=function(t,n,e){var i,e,r,i=this;if(-1!==e.indexOf(t))return!0;if("\t"===t||"\r"===t||"\n"===t)return!0;if(0===n)return!1;if(e=!1,n===u.All||(n&u.Emoji)==(0|u.Emoji)&&o.cEt.isEmoji(t,0,{})||(n&u.FourBytes)==(0|u.FourBytes)&&i.IsFourBytes(t))return!0;if(1===t.length&&1<t.length)return!1;if(i.charExInstance.isFullWidth(t)){if((n&u.DBCS)!=(0|u.DBCS))return!1;(n&u.DBCS_All)==(0|u.DBCS_All)&&"\u3000"!==t||(n&u.DBCS_LowerAlphabet)==(0|u.DBCS_LowerAlphabet)&&i.IsLower(t)||(n&u.DBCS_UpperAlphabet)==(0|u.DBCS_UpperAlphabet)&&i.IsUpper(t)||(n&u.DBCS_Number)==(0|u.DBCS_Number)&&i.IsNumber(t)||(n&u.DBCS_Binary)==(0|u.DBCS_Binary)&&i.IsBinary(t)||(n&u.DBCS_Hexadecimal)==(0|u.DBCS_Hexadecimal)&&i.IsHex(t)||(n&u.DBCS_Symbol)==(0|u.DBCS_Symbol)&&i.IsSymbol(t)||(n&u.DBCS_NumberSymbol)==(0|u.DBCS_NumberSymbol)&&i.IsNumberSymbol(t)||(n&u.Upper_DBCS_Katakana)==(0|u.Upper_DBCS_Katakana)&&i.IsKatakana(t)&&i.IsUpperKana(t)||(n&u.Upper_DBCS_Hiragana)==(0|u.Upper_DBCS_Hiragana)&&i.IsHiragana(t)&&i.IsUpperKana(t)||(n&u.DBCS_Space)==(0|u.DBCS_Space)&&i.IsFormatSpace(t)||(n&u.FourBytes)==(0|u.FourBytes)&&i.IsFourBytes(t)||(n&u.TwoBytes)==(0|u.TwoBytes)&&!i.IsFourBytes(t)&&"\u3000"!==t?e=!0:(n&u.DBCS_Katakana)==(0|u.DBCS_Katakana)&&i.IsKatakana(t)?e=!(r=i.IsHiragana(t))||!!i.include||(n&u.DBCS_Hiragana)==(0|u.DBCS_Hiragana):(n&u.DBCS_Hiragana)==(0|u.DBCS_Hiragana)&&i.IsHiragana(t)&&(e=!(r=i.IsKatakana(t))||!!i.include||(n&u.DBCS_Katakana)==(0|u.DBCS_Katakana))}else{if((n&u.SBCS)!==u.SBCS)return!1;((n&u.SBCS_All)===u.SBCS_All&&" "!==t||(n&u.SBCS_LowerAlphabet)===u.SBCS_LowerAlphabet&&i.IsLower(t)||(n&u.SBCS_UpperAlphabet)===u.SBCS_UpperAlphabet&&i.IsUpper(t)||(n&u.SBCS_Number)===u.SBCS_Number&&i.IsNumber(t)||(n&u.SBCS_Binary)===u.SBCS_Binary&&i.IsBinary(t)||(n&u.SBCS_Hexadecimal)===u.SBCS_Hexadecimal&&i.IsHex(t)||(n&u.SBCS_Symbol)===u.SBCS_Symbol&&i.IsSymbol(t)||(n&u.SBCS_NumberSymbol)===u.SBCS_NumberSymbol&&i.IsNumberSymbol(t)||(n&u.SBCS_Katakana)===u.SBCS_Katakana&&i.IsKatakana(t)||(n&u.Upper_SBCS_Katakana)===u.Upper_SBCS_Katakana&&i.IsKatakana(t)&&i.IsUpperKana(t)||(n&u.SBCS_Space)===u.SBCS_Space&&i.IsFormatSpace(t))&&(e=!0)}return e},c.prototype.IsUpper=function(t){return this.charExInstance.isUpper(t)},c.prototype.IsLower=function(t){return this.charExInstance.isLower(t)},c.prototype.IsNumber=function(t){return this.charExInstance.isDigit(t)},c.prototype.IsBinary=function(t){return"0"===(t=this.IsFullWidth(t)?this.ToHalfWidth(t):t)||"1"===t},c.prototype.IsHex=function(t){var n=this;return"A"===(t=n.IsFullWidth(t)?n.ToHalfWidth(t):t)||"B"===t||"C"===t||"D"===t||"E"===t||"F"===t||"a"===t||"b"===t||"c"===t||"d"===t||"e"===t||"f"===t||n.IsDigit(t)},c.prototype.IsNumberSymbol=function(t){var n=this;return t=n.IsFullWidth(t)?n.ToHalfWidth(t):t,n.IsDigit(t)||"+"===t||"-"===t||"$"===t||"%"===t||"\\"===t||","===t||"."===t},c.prototype.IsKatakana=function(t){return this.charExInstance.isKatakana(t)},c.prototype.IsHiragana=function(t){return this.charExInstance.isHiragana(t)},c.prototype.IsFullWidth=function(t){return this.charExInstance.isFullWidth(t)},c.prototype.ToHalfWidth=function(t){return this.charExInstance.toHalfWidth(t)},c.prototype.IsDigit=function(t){return this.charExInstance.isDigit(t)},c.prototype.IsFourBytes=function(t){var n,e,i,n=this.charExInstance,e=t.substring(0,1);if(2===e.length)for(i=0;i<e.length;i++)if(n.isSurrogate(e[i]))return!0;return!1},c.prototype.IsFormatSpace=function(t){return" "===t||"\u3000"===t},c.prototype.IsSymbol=function(t){var n=this;return n.charExInstance.isHalfWidthSymbol(t)||n.charExInstance.isFullWidthSymbol(t)},c.prototype.IsUpperKana=function(t){return this.charExInstance.isUpperKana(t)},c.prototype.isNullOrUndefined=function(t){return null==t},n._9t=c},Common:function(t){t.exports=o("Common")}},i={},t=r("./src/calc.entry.ts"),((a={}).Spread=a.Spread||{}).CalcEngine=t}(),t.exports=a.Spread.CalcEngine},"./node_modules_local/@grapecity/js-calc/index.js":function(t,n,e){t.exports=e("./node_modules_local/@grapecity/js-calc/dist/gc.spread.calcengine.js")},"./node_modules_local/@grapecity/js-data-manager/dist/gc.data.js":function(t,n,e){var i,r,o,a;function u(t){var n,n,n=o[t];return void 0!==n||(n=o[t]={exports:{}},r[t].call(n.exports,n,n.exports,u)),n.exports}r={"./dist/src/calculation/calcSource.js":function(t,n,e){"use strict";var i,c,r,o,a,u;function s(){this.row=[],this.field=[]}function f(t,n){var t=u.call(this,t)||this;return t.nM=n,t}i=this&&this.__extends||(a=function(t,n){return(a=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(t,n){t.__proto__=n}:function(t,n){for(var e in n)Object.prototype.hasOwnProperty.call(n,e)&&(t[e]=n[e])}))(t,n)},function(t,n){if("function"!=typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function e(){this.constructor=t}a(t,n),t.prototype=null===n?Object.create(n):(e.prototype=n.prototype,new e)}),Object.defineProperty(n,"__esModule",{value:!0}),n.DataManagerCalcSource=n.DataManagerReference=void 0,c=e("CalcEngine"),s.prototype.parseRowIndex=function(t,n,e){var i=n.num;return n.relative||(-1===n.num?i=t-1:i--),e*n.relative+i},s.prototype.getValueImp=function(t){var n,e,i,r,o,a,u,s,n=this.table.length();if(this.field.vEt&&this.field.vEt[this.rowString])return this.field.vEt[this.rowString];if(e=[],0===this.row.length)for(i=0;i<n;i++)e.push(this.field.getValue(i));for(r=0;r<this.row.length;r++)if(2===(o=this.row[r]).length)for(a=this.parseRowIndex(n,o[0],t),u=this.parseRowIndex(n,o[1],t),s=a;s<=u;s++)e.push(this.field.getValue(s));else if(o.type)if("key"===o.type)i=this.table.mEt(o.value),e=e.concat(this.field.getValues(i));else for(s="odd"===o.type?1:0;s<n;s+=2)e.push(this.field.getValue(s));else i=this.parseRowIndex(n,o,t),e.push(this.field.getValue(i));if(1===e.length)e=e[0];else if(0===e.length)return null;return e instanceof Array&&(e=e[0]instanceof Array?new c.CalcArray(e):new c.CalcArray([e])),this.gEt||(this.field.vEt=this.field.vEt||{},this.field.vEt[this.rowString]=e),e},s.prototype.getValuesImp=function(t,n){var t=this.field.getValues(t,n);return t[0]instanceof Array?new c.CalcArray(t):new c.CalcArray([t])},s.prototype.getValue=function(t,n){return this.pEt(),t instanceof Array?this.getValuesImp(t,n):this.getValueImp(t)},s.prototype.pEt=function(){this.field=this.table.bEt(this.Pq)},n.DataManagerReference=s,u=c.CalcSource,i(f,u),f.prototype.yEt=function(){return this._allFieldNames},f.prototype.wEt=function(t){this.MEt=t},f.prototype.pe=function(t,n,e){this.DJ=t,this.ak=n,this.GOt=e},f.prototype.getField=function(t){var n=this.DJ,e=this.ak;return t.getValue(n,e)},f.prototype.getValue=function(){var t=this.GOt;return t&&"number"==typeof this.DJ?this.nM._getValueByField(t,this.DJ):null},n.DataManagerCalcSource=f},"./dist/src/calculation/functions/functions.entry.js":function(t,n,e){"use strict";var i,r,o,a,u,s,c;function f(){(0,i.addScopeCustomFunctions)(),(0,r.addParentCustomFunctions)(),(0,o.addChildrenCustomFunctions)(),(0,a.addOnlyChildrenCustomFunctions)(),(0,u.addLevelCustomFunctions)(),(0,s.addLevelRowNumberCustomFunctions)(),(0,c.addQueryFunction)()}Object.defineProperty(n,"__esModule",{value:!0}),n.addCustomFunctions=void 0,i=e("./dist/src/calculation/functions/scope.js"),r=e("./dist/src/calculation/functions/hierarchyParent.js"),o=e("./dist/src/calculation/functions/hierarchyChildren.js"),a=e("./dist/src/calculation/functions/hierarchyOnlyChildren.js"),u=e("./dist/src/calculation/functions/hierarchyLevel.js"),s=e("./dist/src/calculation/functions/hierarchyLevelRowNumber.js"),c=e("./dist/src/calculation/functions/query.js"),n.addCustomFunctions=f},"./dist/src/calculation/functions/hierarchyChildren.js":function(t,n,e){"use strict";var u,s,i;function r(){function t(){this.R9t=[{J6t:3,pkt:["< 1","> 999"]},{J6t:5}]}(t.prototype=new u.Functions.Function(i,2,2)).isContextSensitive=function(){return!0},t.prototype.evaluate=function(t,e,i){var r,o,n,a,r=[],o=t.source.nM,n=t.source.DJ;return o.CEt()&&(a=o.SEt(n),!(0,s.isNullOrUndefined)(a))&&0<e&&!(0,s.isNullOrEmpty)(i)&&((0,s.traversalTree)(a,{invoking:function(t){var n,n,n;return 0===--e?(n=t.lp,n=o._dataSource.TEt(n),n=o._getValueByField(i,n),r.push(n),{cancelDeepRecursion:!0}):0===t.children.length?{cancelDeepRecursion:!0}:void 0},invoked:function(){e++}}),t.source.DJ=n),new u.CalcArray([r])},u.Functions.defineGlobalCustomFunction(i,new t)}Object.defineProperty(n,"__esModule",{value:!0}),n.addChildrenCustomFunctions=void 0,u=e("CalcEngine"),s=e("./dist/src/dataSource/utils.js"),i="CHILDREN",n.addChildrenCustomFunctions=r},"./dist/src/calculation/functions/hierarchyLevel.js":function(t,n,e){"use strict";var i,r,o;function a(){function t(){}(t.prototype=new i.Functions.Function(o)).isContextSensitive=function(){return!0},t.prototype.evaluate=function(t){var n,t,n,n=t.source.nM,t=t.source.DJ;if(n.CEt()&&(n=n.SEt(t),!(0,r.isNullOrUndefined)(n)))return n.level},i.Functions.defineGlobalCustomFunction(o,new t)}Object.defineProperty(n,"__esModule",{value:!0}),n.addLevelCustomFunctions=void 0,i=e("CalcEngine"),r=e("./dist/src/dataSource/utils.js"),o="LEVEL",n.addLevelCustomFunctions=a},"./dist/src/calculation/functions/hierarchyLevelRowNumber.js":function(t,n,e){"use strict";var i,r,o;function a(){function t(){}(t.prototype=new i.Functions.Function(o)).isContextSensitive=function(){return!0},t.prototype.evaluate=function(t){var n,t,n,n=t.source.nM,t=t.source.DJ;if(n.CEt()&&(n=n.SEt(t),!(0,r.isNullOrUndefined)(n)))return n.getCurrentIndex()+1},i.Functions.defineGlobalCustomFunction(o,new t)}Object.defineProperty(n,"__esModule",{value:!0}),n.addLevelRowNumberCustomFunctions=void 0,i=e("CalcEngine"),r=e("./dist/src/dataSource/utils.js"),o="LEVELROWNUMBER",n.addLevelRowNumberCustomFunctions=a},"./dist/src/calculation/functions/hierarchyOnlyChildren.js":function(t,n,e){"use strict";var a,u,i;function r(){function t(){this.R9t=[{J6t:5}]}(t.prototype=new a.Functions.Function(i,1,1)).isContextSensitive=function(){return!0},t.prototype.evaluate=function(t,n){var e,i,r,o,e=[],i=t.source.nM,r=t.source.DJ;return i.CEt()&&(o=i.SEt(r),(0,u.isNullOrUndefined)(o)||(0,u.isNullOrEmpty)(n)||((0,u.traversalTree)(o,function(t){var t,t,t;0===t.children.length&&(t=t.lp,t=i._dataSource.TEt(t),t=i._getValueByField(n,t),e.push(t))}),t.source.DJ=r)),new a.CalcArray([e])},a.Functions.defineGlobalCustomFunction(i,new t)}Object.defineProperty(n,"__esModule",{value:!0}),n.addOnlyChildrenCustomFunctions=void 0,a=e("CalcEngine"),u=e("./dist/src/dataSource/utils.js"),i="ONLYCHILDREN",n.addOnlyChildrenCustomFunctions=r},"./dist/src/calculation/functions/hierarchyParent.js":function(t,n,e){"use strict";var i,a,r;function o(){function t(){this.R9t=[{J6t:3,pkt:["< 1","> 999"]},{J6t:5}]}(t.prototype=new i.Functions.Function(r,2,2)).isContextSensitive=function(){return!0},t.prototype.evaluate=function(t,n,e){var i,r,o,o,n,o,n,i=t.source.nM,r=t.source.DJ;if(i.CEt()&&(o=i.SEt(r),!(0,a.isNullOrUndefined)(o))&&0<n&&!(0,a.isNullOrEmpty)(e)&&!(o=u(o,n)).isRoot)return n=o.lp,o=i._dataSource.TEt(n),n=i._getValueByField(e,o),t.source.DJ=r,n},i.Functions.defineGlobalCustomFunction(r,new t)}function u(t,n){return 0===n||t.isRoot?t:u(t.parent,n-1)}Object.defineProperty(n,"__esModule",{value:!0}),n.addParentCustomFunctions=void 0,i=e("CalcEngine"),a=e("./dist/src/dataSource/utils.js"),r="PARENT",n.addParentCustomFunctions=o},"./dist/src/calculation/functions/query.js":function(t,n,e){"use strict";var s,i;function r(){var t;s.Functions.findGlobalFunction(i)||((t=new s.Functions.AsyncFunction(i,1,3)).isContextSensitive=function(){return!0},t.evaluateAsync=function(n,e,i,r){var o,t;function a(){var t,t,t,t;null!=(t=null==(t=null==(t=n.ctx)?void 0:t.Xkt)?void 0:t.node)&&t.WK?(t=o.IEt(e,i,r))&&(r?n.setAsyncResult(t[0]):n.setAsyncResult(new s.CalcArray(t))):o.IEt(e,i,r,!0)}function u(){var t=o.IEt(e,i,r,a);t&&(r?n.setAsyncResult(t[0]):n.setAsyncResult(new s.CalcArray(t)))}(t=(o=n.ctx.source.Mf.parent.dataManager()).xEt(e,i,r)).table&&t.table.NEt().then(function(){u()})},t.acceptsReference=function(t){return!0},t.acceptsArray=function(t){return!0},s.Functions.defineGlobalCustomFunction(i,t))}Object.defineProperty(n,"__esModule",{value:!0}),n.addQueryFunction=void 0,s=e("CalcEngine"),i="QUERY",n.addQueryFunction=r},"./dist/src/calculation/functions/scope.js":function(t,n,e){"use strict";var i,r,o,a;function u(){function t(){}function n(){}(t.prototype=new i.Functions.Function(o,2,2)).isContextSensitive=function(){return!0},t.prototype.isReverseArgs=function(){return!0},t.prototype.evaluate=function(t,n,e){return t.source.ak=n.start,t.source.DJ=n.context,e},i.Functions.defineGlobalCustomFunction(o,new t),(n.prototype=new i.Functions.Function(a,0,255)).isContextSensitive=function(){return!0},n.prototype.evaluate=function(t){for(var n,e,i,r,n=[],e=1;e<arguments.length;e++)n[e-1]=arguments[e];return i={start:t.source.ak,context:t.source.DJ},r=t.source.MEt,t.source.ak=0,t.source.DJ=s(r,n),i},i.Functions.defineGlobalCustomFunction(a,new n)}function s(t,n){var n=c(t.groupOptions.slice(0,t.path.length),n);return f(t.path,n)?t.entireScope:l(t.path,n)}function c(t,n){var e,i;if(n&&0<n.length){for(e=-1,t.reverse(),i=0;i<t.length;i++)if(t[i].field!==n[i]){(0,r.isNullOrUndefined)(n[i])&&n.length<=i&&(e=t.length-i-1);break}return e}return-1}function f(t,n){return-1===n||t.length-1<=n}function l(t,n){var e,i=[];return h(t[n],i),i}function h(t,n){var e,i,r,o,a,u,s,c,e=n.length,i=t.recordIndexes;if(i)for(r=0,o=i.length;r<o;r++)n[e+r]=i[r];else for(u=0,s=a=t.children;u<s.length;u++)h(c=s[u],n)}Object.defineProperty(n,"__esModule",{value:!0}),n.addScopeCustomFunctions=void 0,i=e("CalcEngine"),r=e("./dist/src/dataSource/utils.js"),o="CALCULATE",a="REMOVEFILTERS",n.addScopeCustomFunctions=u},"./dist/src/calculation/queryFunctionResolver.js":function(t,n,e){"use strict";var e,f,l,i;function h(e,i,r){return function(t){var n=[];return n.push(t.kEt(t.mEt(e),i||t._dataSource.DEt,r)),n}}function d(){}Object.defineProperty(n,"__esModule",{value:!0}),n.QueryFunctionSolver=void 0,e=e("Common"),f=null,l=e.Common.zf.fJ,d.parseParam=function(r,o,a,u){for(var s,c,t,n,s=Object.keys(u.tables),c=new d,t=function(t){var t,n,t,e,i,t=s[t];r===t?(c.getValue=function(t){return t.ASt(f,f,o,a)},c.table=u.tables[t]):l(r,t)&&(c.table=u.tables[t],n=r[t.length],t=r.substr(t.length+1),"#"===n?(e=parseInt(t,10),c.getValue=function(t){var n=[];return n.push(t.kEt(e,o||t._dataSource.DEt,a)),n}):"/"===n?c.getValue=h(t,o,a):"?"===n?1===(i=t.split("=",2)).length?c.getValue=h(t,o,a):c.getValue=function(t){return t.ASt(i[1],i[0],o,a)}:delete c.table)},n=0;n<s.length;n++)t(n);return c},n.QueryFunctionSolver=d},"./dist/src/calculation/tokenResolver.js":function(t,n,e){"use strict";var i,r,s,l,c,o,a,u,f;function h(t){var n=u.call(this,14)||this;return n.value=t,n}function d(t){return f.call(this,t)||this}i=this&&this.__extends||(a=function(t,n){return(a=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(t,n){t.__proto__=n}:function(t,n){for(var e in n)Object.prototype.hasOwnProperty.call(n,e)&&(t[e]=n[e])}))(t,n)},function(t,n){if("function"!=typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function e(){this.constructor=t}a(t,n),t.prototype=null===n?Object.create(n):(e.prototype=n.prototype,new e)}),Object.defineProperty(n,"__esModule",{value:!0}),n.DataManagerTokenResolver=void 0,r=e("CalcEngine"),s=e("./dist/src/calculation/calcSource.js"),l=e("./dist/src/dataSource/utils.js"),u=r.Expression,i(h,u),h.prototype.Iwt=function(t,n){var e;this.value instanceof s.DataManagerReference&&this.value.table._Et(t,this.value.Pq[0],n)},c=h,f=r.TokenResolver,i(d,f),d.prototype.resolveToken=function(t,n,e,i,r){var e,o,t,t,e,a,u,e=e[i],o=e.Awt,t=t.source,t=t&&t.nM;if(t&&0===e.uit&&"["===o[0]&&"]"===o[o.length-1]&&(e=new s.DataManagerReference,-1!==(a=this.EEt(e,o,1)))&&(e.rowString=o.substring(1,a),-1!==(a=this.jEt(e,o,a))))return e.table=t,e.Pq=e.field,e.field=t.bEt(e.field),{expr:u=new c(e),index:i+1}},d.prototype.EEt=function(t,r,n){var o,e,i,a,u;function s(t,n){for(var e=n?t+1:t;"0"<=r[e]&&r[e]<="9";)e++;for(;" "===r[e];)e++;return{value:parseInt(r.substring(t,e),10),end:e}}function c(t){for(var n=t;n<r.length&&"["!==r[n]&&"]"!==r[n]&&","!==r[n];)n++;return{type:"key",value:r.substring(t,n).trim(),end:n}}function f(t){var n,e,i,e,n=r[t],e=r[t+1];return"@"===n?(o=!0,"+"===e||"-"===e?(i=s(t+1,!0)).end<=t+1?-1:{num:i.value,end:i.end,relative:!0}:{num:0,end:t+1,relative:!0}):"#"===n?(i=s(t+1)).end>t+1?{num:i.value,end:i.end,relative:!1}:"last"===r.substr(t+1,4)?{num:-1,end:t+5,relative:!1}:"odd"===r.substr(t+1,3)?{type:"odd",end:t+4}:"even"===r.substr(t+1,4)?{type:"even",end:t+5}:-1:"$"!==n||(e=c(t+1)).end>=r.length?-1:e}for(o=!1,e=null;n<r.length&&"["!==(i=r[n])&&"]"!==i;)if(e||"@"!==i&&"#"!==i&&"$"!==i){if(","===i&&e)e=!1;else if(" "!==i)break;n++}else{if(-1===(a=f(n)))return-1;if(":"!==r[a.end]||(0,l.isNullOrUndefined)(a.num))t.row.push(a),n=a.end;else{for(n=a.end+1;" "===r[n];)n++;if(-1===(u=f(n))||(0,l.isNullOrUndefined)(u.num))return-1;t.row.push([a,u]),n=u.end}e=!0}return t.gEt=o,!1===e?-1:n},d.prototype.jEt=function(t,e,n){var i,r,o;function a(t){for(var n=t;"]"!==e[n];)n++;return{str:e.substring(t,n),end:n}}function u(t){for(var n=t;"."!==e[n]&&"]"!==e[n];)n++;return{str:e.substring(t,n),end:n}}for(i=null;n<e.length;)if("["!==(r=e[n])||i){if("]"===r)break;if(" "===r)n++;else if("."===r&&i)n++,i=!1;else{if("."===r||i)return-1;o=u(n),t.field.push(o.str),n=o.end,i=!0}}else{if((o=a(n+1)).end<=n+1)return-1;t.field.push(o.str),n=o.end+1,i=!0}return n===e.length-1?n:-1},d.prototype.unparse=function(){return!1},n.DataManagerTokenResolver=d},"./dist/src/dataManager.entry.js":function(t,n,e){"use strict";var i,r,i=this&&this.__createBinding||(Object.create?function(t,n,e,i){void 0===i&&(i=e);var r=Object.getOwnPropertyDescriptor(n,e);r&&("get"in r?n.__esModule:!r.writable&&!r.configurable)||(r={enumerable:!0,get:function(){return n[e]}}),Object.defineProperty(t,i,r)}:function(t,n,e,i){t[i=void 0===i?e:i]=n[e]}),r=this&&this.__exportStar||function(t,n){for(var e in t)"default"===e||Object.prototype.hasOwnProperty.call(n,e)||i(n,t,e)};Object.defineProperty(n,"__esModule",{value:!0}),r(e("./dist/src/dataSource/dataSource.entry.js"),n),r(e("./dist/src/table/table.entry.js"),n),r(e("./dist/src/viewField/viewField.entry.js"),n),r(e("./dist/src/view/view.entry.js"),n),r(e("./dist/src/interfaces/interface.js"),n),r(e("./dist/src/interfaces/styleOptions.js"),n),r(e("./dist/src/interfaces/validatorOptions.js"),n),r(e("./dist/src/interfaces/conditionalFormatOptions.js"),n),r(e("./dist/src/dataManager.js"),n),r(e("./dist/src/query.js"),n)},"./dist/src/dataManager.js":function(t,n,e){"use strict";var i,r,o,a,u,s,c,f,l,h,d,v;function m(t){this.rV={},this.tables={},this.relationships=[],this.OEt={},t=t||new i.CalcService,this.updateCalcService(t),(0,s.addCustomFunctions)()}function g(t){return t instanceof o.View}Object.defineProperty(n,"__esModule",{value:!0}),n.isView=n.DataManager=void 0,i=e("CalcEngine"),r=e("./dist/src/table/table.js"),o=e("./dist/src/view/view.js"),a=e("./dist/src/dataSource/utils.js"),u=e("./dist/src/dataSource/dataSource.js"),s=e("./dist/src/calculation/functions/functions.entry.js"),c=e("./dist/src/calculation/tokenResolver.js"),f=e("./dist/src/calculation/queryFunctionResolver.js"),l=e("./dist/src/relationship.js"),h=null,d=i.Convert.LE,m.prototype.addTable=function(t,n){var n=new r.Table(t,n);return(this.tables[t]=n).REt(this),n},m.prototype.removeTable=function(t){for(var n,e,i,n=this.tables[t],e=this.relationships,i=e.length-1;0<=i;i--)e[i].sourceTable!==n&&e[i].targetTable!==n||(e[i].VP(),e.splice(i,1));n.REt(h),delete this.tables[t]},m.prototype.addRelationship=function(t,n,e,i,r,o){var t=new l.Relationship(t,n,e,i,r,o);return this.relationships.push(t),t},m.prototype.removeRelationship=function(t){for(var n,e,n=this.relationships,e=0;e<n.length;e++)if(n[e].sourceRelationshipName===t){n[e].VP(),n.splice(e,1);break}},m.prototype.updateCalcService=function(t){for(var n,e,i,r,o,n,e=!0,i=0,r=t.getResolvers();i<r.length;i++)if((o=r[i])instanceof c.DataManagerTokenResolver){e=!1;break}e&&t.addResolver(new c.DataManagerTokenResolver(8e3)),this.Lp=t},m.prototype.xEt=function(t,n,e){var i,r;return d(t)?t=t.getValueByIndex(0):(0,a.isString)(t)||(t=""+t),(0,a.isString)(n)?n=[n]:d(n)?n=n.toArray(0,!0):n&&n.array&&(n=n.array[0]),i=t+"-"+(n&&n.join(",")),r=(r=this.OEt[i])||(this.OEt[i]=f.QueryFunctionSolver.parseParam(t,n,e,this))},m.prototype.IEt=function(t,n,e,i){var t,n;function r(){i()}return t=this.xEt(t,n,e),!0===i&&t.table._dataSource.unbind(u.ONCHANGE,r),i&&t.table&&t.table._dataSource.bind(u.ONCHANGE,r),n=0===(n=t.getValue?t.getValue(t.table):[[]]).length?[[]]:n},m.prototype.toJSON=function(){var t,n,e,i,t=this.tables,n=[];for(e in t)t.hasOwnProperty(e)&&n.push(t[e].toJSON());return{tables:n,relationships:i=this.relationships.map(function(t){return{sourceTableName:t.sourceTable.name,sourceFieldName:t.sourceFieldName,sourceRelationshipName:t.sourceRelationshipName,targetTableName:t.targetTable.name,targetFieldName:t.targetFieldName,targetRelationshipName:t.targetRelationshipName}})}},m.prototype.fromJSON=function(t){for(var n,e,i,r,o,a,u,s,c,a,f,l,h,d,v,m,n=this.tables={},e,i=0,r=t.tables;i<r.length;i++){if(u=(a=(o=r[i]).dataSourceOption.schema)&&a.columns)for(s in u)u.hasOwnProperty(s)&&(c=u[s])&&"date"===c.dataType&&Array.isArray(c.lookup)&&(c.lookup=c.lookup.map(function(t){return new Date(t)}));(a=this.addTable(o.name,o.dataSourceOption)).BEt=!0,a.fromJSON(o)}for(this.relationships=[],l=0,h=f=t.relationships;l<h.length;l++)v=n[(d=h[l]).sourceTableName],m=n[d.targetTableName],this.addRelationship(v,d.sourceFieldName,d.sourceRelationshipName,m,d.targetFieldName,d.targetRelationshipName)},n.DataManager=m,n.isView=g},"./dist/src/dataSource/dataReader/BasicReader.js":function(t,n,e){"use strict";var r,o,i;function a(t){var n,e,i,t,n=this;n.LEt=t,(0,r.isNullOrUndefined)(t)||(n.Pq=t.Pq,e=t.dataPath,i=t.countPath,t=t.parse,(0,r.isFunction)(e)?n.FEt=e:n.FEt=function(t){return(0,r.isString)(e)&&e?(0,r.q$)(t,e):t},(0,r.isFunction)(i)?n.PEt=i:n.PEt=function(t){return(0,r.isString)(i)&&i?parseInt((0,r.q$)(t,i),10):o},(0,r.isFunction)(t)&&(n.parse=t))}Object.defineProperty(n,"__esModule",{value:!0}),n.BasicReader=void 0,r=e("./dist/src/dataSource/utils.js"),o=void 0,a.prototype.parse=function(t){return this.GEt=t,Promise.resolve(t)},a.prototype.read=function(t){return Promise.resolve(this.FEt(t))},a.prototype.readSync=function(t){return this.FEt(t)},a.prototype.total=function(t){return this.PEt(t)},n.BasicReader=a},"./dist/src/dataSource/dataReader/ColumnJsonReader.js":function(t,n,e){"use strict";var i,r,l,o,a,u;function s(t){var n,c,f,n=u.call(this,t)||this,c=n,f=t.dataPath;return(0,l.isFunction)(f)?c.FEt=f:c.FEt=function(t){var n,e,i,r,o,a,u,s;for(t=(0,l.isString)(f)?(0,l.q$)(t,f):t,n=c.Pq=c.Pq||(0,l.keys)(t),e=c.GEt=[],i=t[n[0]].length,r=0;r<i;r++){for(o={},a=0,u=n;a<u.length;a++)o[s=u[a]]=t[s][r];e.push(o)}return e},n}i=this&&this.__extends||(a=function(t,n){return(a=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(t,n){t.__proto__=n}:function(t,n){for(var e in n)Object.prototype.hasOwnProperty.call(n,e)&&(t[e]=n[e])}))(t,n)},function(t,n){if("function"!=typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function e(){this.constructor=t}a(t,n),t.prototype=null===n?Object.create(n):(e.prototype=n.prototype,new e)}),Object.defineProperty(n,"__esModule",{value:!0}),n.ColumnJsonReader=void 0,r=e("./dist/src/dataSource/dataReader/BasicReader.js"),l=e("./dist/src/dataSource/utils.js"),u=r.BasicReader,i(s,u),s.prototype.parse=function(r){var o=this;return new Promise(function(t,n){var e,i;(0,l.isNullOrUndefined)(r)&&n("value cannot be null or empty"),e=o.Pq=o.Pq||(0,l.keys)(r),(i=(0,l.reduce)(e,function(t,n){return t&&(0,l.isArray)(r[n])},!0))||n("The value of each property in column JSON should be an array"),t(r)})},n.ColumnJsonReader=s},"./dist/src/dataSource/dataReader/CsvReader.js":function(t,n,e){"use strict";var i,r,h,o,a,u;function s(t){var n=u.call(this,t)||this;return n.UEt=t.delimiter||['"'],n.HEt=t.separator||",",n}i=this&&this.__extends||(a=function(t,n){return(a=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(t,n){t.__proto__=n}:function(t,n){for(var e in n)Object.prototype.hasOwnProperty.call(n,e)&&(t[e]=n[e])}))(t,n)},function(t,n){if("function"!=typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function e(){this.constructor=t}a(t,n),t.prototype=null===n?Object.create(n):(e.prototype=n.prototype,new e)}),Object.defineProperty(n,"__esModule",{value:!0}),n.CsvReader=void 0,r=e("./dist/src/dataSource/dataReader/BasicReader.js"),h=e("./dist/src/dataSource/utils.js"),u=r.BasicReader,i(s,u),s.prototype.parse=function(t){for(var n,e,i,r,o,a,u,s,c,f,l,n=this,e=n.UEt,i=n.HEt,r=t.split(""),o=0,a=r.length,u=[];o<a;){for(f=[];o<a&&"\r"!==r[o]&&"\n"!==r[o];){if(s=c=o,-1<(0,h.indexOf)(e,r[o])){for(s=c=++o;o<a;){if(-1<(0,h.indexOf)(e,r[o])){if(-1===(0,h.indexOf)(e,r[o+1]))break;r[++o]=""}c=++o}for(-1<(0,h.indexOf)(e,r[o])&&++o;o<a&&"\r"!==r[o]&&"\n"!==r[o]&&i!==r[o];)++o}else for(;o<a&&"\r"!==r[o]&&"\n"!==r[o]&&i!==r[o];)c=++o;f.push(r.slice(s,c).join("")),i===r[o]&&++o}"\r"!==r[o]&&"\n"!==r[o]||++o,0<f.length&&u.push(f)}return l=u.shift(),n.GEt=(0,h.isNullOrUndefined)(n.Pq)?(0,h.map)(u,function(t){return(0,h.zipObject)(l,t)}):(0,h.map)(u,function(t){return(0,h.pick)((0,h.zipObject)(l,t),n.Pq)}),n.Pq=n.Pq||l,Promise.resolve(n.GEt)},n.CsvReader=s},"./dist/src/dataSource/dataReader/JsonReader.js":function(t,n,e){"use strict";var i,e,r,o,a;function u(t){return a.call(this,t)||this}i=this&&this.__extends||(o=function(t,n){return(o=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(t,n){t.__proto__=n}:function(t,n){for(var e in n)Object.prototype.hasOwnProperty.call(n,e)&&(t[e]=n[e])}))(t,n)},function(t,n){if("function"!=typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function e(){this.constructor=t}o(t,n),t.prototype=null===n?Object.create(n):(e.prototype=n.prototype,new e)}),Object.defineProperty(n,"__esModule",{value:!0}),n.JsonReader=void 0,e=e("./dist/src/dataSource/dataReader/BasicReader.js"),a=e.BasicReader,i(u,a),n.JsonReader=u},"./dist/src/dataSource/dataReader/XmlReader.js":function(t,n,e){"use strict";var i,r,o,a,u,s;function c(t){var e,i,r,e=s.call(this,t)||this,i=e,r=t.dataPath;return(0,o.isFunction)(r)?i.FEt=r:i.FEt=function(t){var n;return t=(0,o.isString)(r)?(0,o.q$)(t,r):t,(0,o.isNullOrUndefined)(t)||((n=i.Pq)?t=t.map(function(t){return(0,o.pick)(t,n)}):e.Pq=(0,o.keys)(t[0])),t},e}i=this&&this.__extends||(u=function(t,n){return(u=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(t,n){t.__proto__=n}:function(t,n){for(var e in n)Object.prototype.hasOwnProperty.call(n,e)&&(t[e]=n[e])}))(t,n)},function(t,n){if("function"!=typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function e(){this.constructor=t}u(t,n),t.prototype=null===n?Object.create(n):(e.prototype=n.prototype,new e)}),Object.defineProperty(n,"__esModule",{value:!0}),n.XmlReader=void 0,r=e("./dist/src/dataSource/dataReader/BasicReader.js"),o=e("./dist/src/dataSource/utils.js"),s=r.BasicReader,i(c,s),c.prototype.parse=function(t){var n,t,t,n,t=(new DOMParser).parseFromString(t.trim(),"text/xml"),t=this.documentToJSObject(t);return Promise.resolve(t)},c.prototype.documentToJSObject=function(t){for(var n,e,i,r,n={},e=t.children,i=0,r=e.length;i<r;i++)this.elementToJSObject(e[i],n);return n},c.prototype.elementToJSObject=function(t,n){var e,i,r,o,a,u,s,c,e=t.children,i=e.length,r=t.nodeName;if(0===i)n[r]=t.textContent;else{for(o={},void 0!==(a=n[r])?Array.isArray(a)?n[r].push(o):n[r]=[a,o]:n[r]=o,u=t.attributes,s=0;s<u.length;s++)o[(c=u[s]).nodeName]=c.nodeValue;for(s=0;s<i;s++)this.elementToJSObject(e[s],o)}},n.XmlReader=c},"./dist/src/dataSource/dataSource.entry.js":function(t,n,e){"use strict";var i,r,i=this&&this.__createBinding||(Object.create?function(t,n,e,i){void 0===i&&(i=e);var r=Object.getOwnPropertyDescriptor(n,e);r&&("get"in r?n.__esModule:!r.writable&&!r.configurable)||(r={enumerable:!0,get:function(){return n[e]}}),Object.defineProperty(t,i,r)}:function(t,n,e,i){t[i=void 0===i?e:i]=n[e]}),r=this&&this.__exportStar||function(t,n){for(var e in t)"default"===e||Object.prototype.hasOwnProperty.call(n,e)||i(n,t,e)};Object.defineProperty(n,"__esModule",{value:!0}),r(e("./dist/src/dataSource/dataSource.js"),n),r(e("./dist/src/dataSource/dataSource.interface.js"),n),r(e("./dist/src/dataSource/utils.js"),n)},"./dist/src/dataSource/dataSource.interface.js":function(t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0})},"./dist/src/dataSource/dataSource.js":function(B,d,t){"use strict";var n,h,e,i,c,r,o,a,u,b,s,v,y,m,g,p,w,M,f,l,L,C,F,S,T;function A(t){return"".concat(l).concat(t)}function I(t){return"string"==typeof t&&-1<t.indexOf(l)}function x(t){return I(t)?y:t}function N(t,n){var e=n;return"odata"!==t&&"odata4"!==t||!n.value?"graphql"!==t&&"rest"!==t||!n.data||(e=n.data):e=n.value,e}function k(t,n){var e,i,r,e={};for(i in t)t.hasOwnProperty(i)&&(r=n[i],e[i]=(0,b.isNullOrUndefined)(r)?t[i]:r);return e}function D(t,n,e,i,r){var o,a,u,s,c,f,l;for("string"==typeof e?o=a=e:(o=e.childrenField1||"children",a=e.childrenField2||"children"),u=t[o]||[],s=n[a]||[],c=0;c<u.length;c++)f=u[c],l=s[c],i&&i(f,l,t,n),D(f,l,e,i,r),r&&r(f,l,t,n)}function _(t,n){var e,i,r,o,a;if((0,b.isNullOrUndefined)(t)||(0,b.isNullOrUndefined)(n))return t===n;if(e=(0,b.keys)(t),i=(0,b.keys)(n),e.length===i.length){for(r=0,o=e;r<o.length;r++)if(t[a=o[r]]!==n[a])return;return 1}}function E(t,n){for(var e,i,r,o,e=[],i=0;i<n;i++){for(o in r={},t)t.hasOwnProperty(o)&&(r[o]=t[o].data[i]);e[i]=r}return e}function j(t){return"xml"===t?"xml":"csv"===t?"text":"json"}function P(t){var n,n,t,e,e,e,e,e,n=null==(n=t.schema)?void 0:n.type,t=t.remote;n&&t&&((e=t.read)&&"object"==typeof e&&(e.dataType=j(n)),(e=t.update)&&"object"==typeof e&&(e.dataType=j(n)),(e=t.delete)&&"object"==typeof e&&(e.dataType=j(n)),(e=t.create)&&"object"==typeof e&&(e.dataType=j(n)),e=t.batch)&&"object"==typeof e&&(e.dataType=j(n))}function G(){}function O(t){var n,e,n=T.call(this)||this;return n.R1t=[],(e=n)._data=t.data,e.zEt=t.isRoot,e.VEt=t.getData,e.YEt=t.getFieldData,e.ZEt=t.idField,e.WEt=!(0,b.isNullOrUndefined)(t.idField),e.QEt=t.sequenceField,e.KEt=!(0,b.isNullOrUndefined)(t.sequenceField),Object.defineProperty(e,"data",{get:function(){return e.VEt(e.lp)}}),Object.defineProperty(e,"isRoot",{get:function(){return e.zEt}}),Object.defineProperty(e,"id",{get:function(){var t;return e.WEt?(t=e.YEt(e.ZEt,e.lp),(0,b.isNullOrUndefined)(t)?t=e._id:e._id!==t&&(e._id=t),t):e._id},set:function(t){e._id=t,(0,b.isNullOrUndefined)(e.JEt)&&(e.JEt=t)}}),Object.defineProperty(e,"parentId",{get:function(){return(0,b.isNullOrUndefined)(e.parent)?y:e.parent.id}}),Object.defineProperty(e,"parent",{get:function(){return e.sft},set:function(t){e.setParent(t),(0,b.isNullOrUndefined)(e.XEt)&&!(0,b.isNullOrUndefined)(t)&&(e.XEt=t.id)}}),Object.defineProperty(e,"level",{get:function(){return e.YAt},set:function(t){e.YAt=t}}),Object.defineProperty(e,"children",{get:function(){return e.R1t},set:function(t){e.R1t=t}}),Object.defineProperty(e,"sequence",{get:function(){return e.KEt?e.YEt(e.QEt,e.lp):e.qEt},set:function(t){e.qEt=t,(0,b.isNullOrUndefined)(e.$Et)&&(e.$Et=t)}}),n}function R(t){this.tjt={},this.njt=[],this.ejt=!0,this.wue=!1;var u=this;Object.defineProperty(this,"options",{get:function(){return u.LEt},set:function(t){var n,e,i,r,n,o,n,a;P(t),n=u.LEt,u.LEt=t,r=(e=n&&n.remote&&n.remote.read&&n.remote.read.url)!==(i=t&&t.remote&&t.remote.read&&t.remote.read.url),u.ijt(t.remote,t.data),n=n&&n.schema,o=t&&t.schema,(n=n&&o&&(n.type!==o.type||n.dataPath!==o.dataPath||n.countPath!==o.countPath))&&u.rjt(t.schema),(a=u.ojt)&&(r||n)&&(u.ajt(),u.load())}}),u._events={},u.options=h({data:v,batch:!1},t),this.ijt(t.remote,t.data),u.bind([m,p,w,d.ONCHANGE,g],t),this.rjt(t.schema),u.ajt()}n=this&&this.__extends||(S=function(t,n){return(S=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(t,n){t.__proto__=n}:function(t,n){for(var e in n)Object.prototype.hasOwnProperty.call(n,e)&&(t[e]=n[e])}))(t,n)},function(t,n){if("function"!=typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function e(){this.constructor=t}S(t,n),t.prototype=null===n?Object.create(n):(e.prototype=n.prototype,new e)}),h=this&&this.__assign||function(){return(h=Object.assign||function(t){for(var n,e,i,r,e=1,i=arguments.length;e<i;e++)for(r in n=arguments[e])Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r]);return t}).apply(this,arguments)},Object.defineProperty(d,"__esModule",{value:!0}),d.DataSource=d.HierarchyNode=d.ONCHANGE=d.DELETE=d.UPDATE=d.INSERT=d.CREATE=void 0,e=t("./dist/src/dataSource/dataTransport/localDataTransport.js"),i=t("./dist/src/dataSource/dataTransport/remoteDataTransport.js"),c=t("./dist/src/dataSource/event.js"),r=t("./dist/src/dataSource/dataReader/JsonReader.js"),o=t("./dist/src/dataSource/dataReader/ColumnJsonReader.js"),a=t("./dist/src/dataSource/dataReader/CsvReader.js"),u=t("./dist/src/dataSource/dataReader/XmlReader.js"),b=t("./dist/src/dataSource/utils.js"),s=t("Common"),v=null,y=void 0,d.CREATE="create",d.INSERT="insert",d.UPDATE="update",d.DELETE="delete",m="onBeforeSend",g="onFailed",p="onBeforeEnd",w="onReady",M="user cancel the request at step ",d.ONCHANGE="onChange",f=Number.NaN,l="__HIERARCHY__",n(O,T=G),O.prototype.sjt=function(){return this.qEt},O.prototype.setParent=function(t,n){var e=!(0,b.isNullOrUndefined)(this.parent);e&&this.parent.cjt(this),this.sft=t,(0,b.isNullOrUndefined)(t)?e&&(this.level=f):(this.level=t.level+1,(0,b.isNullOrUndefined)(n)?t.fjt(this):t.ljt(this,n))},O.prototype.updateChildrenLevel=function(){var n=this.level;this.children.forEach(function(t){t.level=n+1,t.updateChildrenLevel()})},O.prototype.promote=function(t){this.setParent(t,this.parent.getCurrentIndex()+1),this.updateChildrenLevel()},O.prototype.demote=function(n,t){this.parent=n,(t=!1!==t)?this.updateChildrenLevel():this.children.forEach(function(t){t.parent=n})},O.prototype.getCurrentIndex=function(){return this.parent.children.indexOf(this)},O.prototype.getPrevSibling=function(){return this.parent.children[this.getCurrentIndex()-1]},O.prototype.getNextSibling=function(){return this.parent.children[this.getCurrentIndex()+1]},O.prototype.ljt=function(t,n){this.children.splice(n,0,t)},O.prototype.fjt=function(t){this.children.push(t)},O.prototype.cjt=function(t){var t=this.children.indexOf(t);this.children.splice(t,1)},O.prototype.getChildrenIndexes=function(t){var n=[];return(0,b.traversalTree)(this,{invoked:function(t){n.push(t.lp)}},t?function(t){return-t.sequence}:y),n},O.prototype.getFieldValue=function(t){return this.YEt(t,this.lp)},C=O,d.HierarchyNode=C,R.prototype.ijt=function(t,n){this.hjt=t?new i.RemoteDataTransport(t):new e.LocalDataTransport({data:n||[]})},R.prototype.rjt=function(t){var n,e;"json"===(e=(t=t||{}).type||"json")?n=new r.JsonReader(t):"columnJson"===e?n=new o.ColumnJsonReader(t):"csv"===e?n=new a.CsvReader(t):"xml"===e&&(n=new u.XmlReader(t)),this.djt=n},R.prototype.ajt=function(){this._data={},this.vjt=0,this.DEt=[]},R.prototype.mjt=function(t,n,e){var i,r,o,a,u,i=this,r={};for(o in i._data)i._data.hasOwnProperty(o)&&(a=i._data[o],0!==n?(u=a.data.splice(t,n),r[o]={data:u}):t>=a.data.length?a.data[t]=e[o]:a.data.splice(t,0,e[o]));return i.vjt=i.vjt-n,e&&i.vjt++,E(r,n)},R.prototype.gjt=function(t,n){var e,i,r,o,e=this,i={};for(r in e._data)e._data.hasOwnProperty(r)&&(o=e._data[r],i[r]={data:o.data.slice(t,n)});return E(i,n-t)},R.prototype.pjt=function(t,n,e){var i,r;if(!(0,b.isNullOrUndefined)(n))if(i=this,e)for(r in n)Object.prototype.hasOwnProperty.call(i._data,r)&&(i._data[r].data[t]=n[r]);else for(r in i._data)i._data.hasOwnProperty(r)&&(i._data[r].data[t]=n[r])},R.prototype.bjt=function(t){var n,e,i,n=this,e={};for(i in n._data)n._data.hasOwnProperty(i)&&(e[i]=n._data[i].data[t]);return e},R.prototype.yjt=function(t){var t,n,e;return!(!t||!t.reload)||(n=(t=this).wjt,0===(e=t.vjt))||((0,b.isNullOrUndefined)(n),!1)},R.prototype.Mjt=function(t,n){var e,i,e=this.tjt;return e[t]||(i=void 0,n?i=s.Common.ct.yU(t,n):(i=new Date(t),isNaN(i)&&(i=new Date(t.replace(" ","T")))),e[t]=i),e[t]},R.prototype.Cjt=function(t,n){return n?0===n.split("|").indexOf(t):!!t},R.prototype.Sjt=function(t,n){return+(t=(t=n?t.replace(n,"."):t).replace(/,/g,""))||0},R.prototype.Tjt=function(t,n,e,i){if("rowOrder"===n)return t;if(i){if(!n||"number"===n)return t;t+=""}return"date"===n?"NULL"===t||""===t?null:this.Mjt(t,e):"boolean"===n?this.Cjt(t,e):"number"===n?this.Sjt(t,e):t},R.prototype.Ajt=function(t,n){var e="number"==typeof t;return(0,b.isNullOrUndefined)(n)||(0,b.isNullOrUndefined)(t)||"string"!=typeof t&&!b.isNumber?t:this.Tjt(t,n.dataType,n.dataPattern,e)},R.prototype.Ijt=function(t,n){var e,i,r,o;for(e in t)t.hasOwnProperty(e)&&(i=t[e])&&(o="number"==typeof(r=n[e]),(0,b.isNullOrUndefined)(r)||"string"!=typeof r&&!o||(n[e]=this.Tjt(r,i.dataType,i.dataPattern,o)))},R.prototype.xjt=function(t,n,e){for(var i,r,o,a,i=this._data[t].data,r=0;r<i.length;r++)a="number"==typeof(o=i[r]),(0,b.isNullOrUndefined)(o)||"string"!=typeof o&&!a||(i[r]=this.Tjt(o,n,e,a));this.isHierarchy()&&"rowOrder"===n&&(this.ejt=!0)},R.prototype.Njt=function(t,n){var e,i;t===n||(0,b.isNullOrEmpty)(n)||((e=this)._data[n]=e._data[t],delete e._data[t],i=e.kjt(t),e.Djt(t,(0,b.isNullOrEmpty)(i)?t:i,n))},R.prototype.kjt=function(t){var n,e=this.LEt.schema,i,e,r;if(!((0,b.isNullOrUndefined)(e)||(0,b.isNullOrUndefined)(e.columns)||(e=(i=e.columns)[t],(0,b.isNullOrUndefined)(e))||(r=e.dataName,(0,b.isNullOrEmpty)(r))))return r},R.prototype.Djt=function(t,n,e){var i=this,r=i.LEt.schema,i,r;(0,b.isNullOrUndefined)(r)&&(i.LEt.schema=r={}),i=r.columns,(0,b.isNullOrUndefined)(i)&&(r.columns=i={}),r=i[t],(0,b.isNullOrUndefined)(r)&&(i[t]=r={}),(0,b.isNullOrEmpty)(r.dataName)&&(r.dataName=n),(0,b.isNullOrEmpty)(e)||(i[e]=i[t],delete i[t])},R.prototype._jt=function(t){var n;return t=this.Ejt(t,{isServerToClient:!0})},R.prototype.jjt=function(t){var n=this;return t=(0,b.clone)(t,!0),n.Ojt(t),t=n.Ejt(t)},R.prototype.Ejt=function(t,n){var e,i,r,n,o,a,u,i=(e=this).LEt.schema,r=(n=n||{}).isServerToClient,n=n.isClone;if(!(0,b.isNullOrUndefined)(t)&&!(0,b.isNullOrUndefined)(i)&&!(0,b.isNullOrUndefined)(i.columns)){for(u in o=i.columns,a=[],o)(0,b.isNullOrUndefined)(o[u].dataName)||o[u].dataName===u||a.push(r?[o[u].dataName,u]:[u,o[u].dataName]);0<a.length&&(t=n?(0,b.clone)(t,!0):t,(0,b.isArray)(t)?t.forEach(function(t){e.Rjt(a,t)}):(0,b.isObject)(t)&&e.Rjt(a,t))}return t},R.prototype.Rjt=function(t,e){t.forEach(function(t){var n=t[0],t=t[1];e[t]=e[n],delete e[n]})},R.prototype.Bjt=function(){var t,n,e,i,r,o,t,n=this.LEt.schema;if((0,b.isNullOrUndefined)(n)||(0,b.isNullOrUndefined)(n.columns))return[{},{}];for(o in i={},r={},e=n.columns)e.hasOwnProperty(o)&&((0,b.isNullOrUndefined)(e[o].dataName)||(i[e[o].dataName]=o),e[o].dataType||e[o].dataPattern)&&(r[o]={dataType:e[o].dataType,dataPattern:e[o].dataPattern});return[i,r]},R.prototype.Ljt=function(){var t,n,e,i,r,o,t,n=this.LEt.schema,e=[];if(!(0,b.isNullOrUndefined)(n)&&!(0,b.isNullOrUndefined)(n.columns))for(r in i=n.columns)i.hasOwnProperty(r)&&(o=i[r]).isPrimaryKey&&e.push(r);return e},R.prototype.Ojt=function(t){var n,e,n,i,n=this;!(0,b.isNullOrUndefined)(t)&&n.isHierarchy()&&"Level"===n.Fjt()&&(e=n.Pjt(),(0,b.isNumber)(e))&&(i=t[n=n.Gjt()],t[n]=i-e)},R.prototype.Ujt=function(e){var t,n;return this.njt.map(function(t,n){t.lp=n,e||(t.sequence=n+1);var n=t._data;return t._data=y,n})},R.prototype.Hjt=function(t){var n=this,e=n.zjt,i=n.njt=[];return(0,b.traversalTree)(e,function(t){t.level=t.parent.level+1,i.push(t)},t?{isOrderChildren:!0,getValue:function(t){return t.qEt}}:y),n.Ujt(t)},R.prototype.Vjt=function(t,n,e,i,r){var o,a,u,s,c,f,l,h,d,v,m,g,o=this,a=!(0,b.isNullOrEmpty)(i),u=n,s=i;for(n=o.Yjt(n),e=o.Yjt(e),i=o.Yjt(i),c={},f=0;f<t.length;f++)l=t[f],h=new C(o.Zjt({data:l,idField:u,sequenceField:s})),d=l[n],c[h.id=d]=h,a&&(h.sequence=l[i]);for((v=new C({isRoot:!0})).level=r-1,f=0;f<t.length;f++)d=t[f][n],m=t[f][e],h=c[d],(0,b.isNullOrUndefined)(g=c[m])?(v.id=m,h.parent=v):h.parent=g;return o.zjt=v,o.Hjt(a)},R.prototype.Wjt=function(t,n,e,i,r){var o,a,u,s,c,f,l,h,d,v,m,g,p,o=this,a=!(0,b.isNullOrEmpty)(i),u=n,s=i;for(n=o.Yjt(n),e=o.Yjt(e),i=o.Yjt(i),c=y,f=0;f<t.length;f++)((l=t[f][e])<c||c===y)&&(c=l);for((h=o.zjt=new C({isRoot:!0})).level=c+r-1,d=[h],f=0;f<t.length;f++){for(v=t[f],m=new C(o.Zjt({data:v,idField:u,sequenceField:s})),g=(0,b.isNullOrEmpty)(n)?A(f):v[n],l=v[e]+r,m.id=g,a&&(m.sequence=v[i]),p=d[d.length-1];p.level>=l;)p=d.pop().parent;m.parent=p,d.push(m)}return o.Hjt(a)},R.prototype.Qjt=function(t,e,n,i,r){var r,o,a,u,s,c,f,l,o=this,a=o.njt=[],u=!(0,b.isNullOrEmpty)(i),s=e,c=i;return e=o.Yjt(e),n=o.Yjt(n),i=o.Yjt(i),(f=o.zjt=new C({isRoot:!0})).level=r-1,l=[f],(0,b.traversalTree)(((r={})[n]=t,r),{invoking:function(t){var n=new C(o.Zjt({data:t,idField:s,sequenceField:c}));n.id=(0,b.isNullOrEmpty)(e)?A(a.length):t[e],u&&(n.sequence=t[i]),n.parent=l[l.length-1],a.push(n),l.push(n)},invoked:function(){l.pop()}},u?i:y,n),o.Ujt(u)},R.prototype.Kjt=function(t,n,e,i,r,o){var a,u,s,c,f,l,h,d,v,m,g,p,p,a=this,u=!(0,b.isNullOrEmpty)(r),s=n,c=r;for(n=a.Yjt(n),e=a.Yjt(e),r=a.Yjt(r),f={},l=0;l<t.length;l++)h=t[l],d=new C(a.Zjt({data:h,idField:s,sequenceField:c})),v=h[e],d.id=(0,b.isNullOrEmpty)(n)?A(l):h[n],f[v]=d,u&&(d.sequence=h[r]);for(m=a.Bjt(),(g=new C({isRoot:!0})).level=o-1,l=0;l<t.length;l++)d=f[v=t[l][e]],p=i(a.Jjt(t[l],m,l)),(0,b.isNullOrUndefined)(p=f[p])?d.parent=g:d.parent=p;return a.zjt=g,a.Hjt(u)},R.prototype.Jjt=function(a,e,t){var u=this,t={index:t};return Object.defineProperty(t,"data",{get:function(){var i,r,o,t,n,i=e[0],r=e[1],o={},t=function(t){var n,e;a.hasOwnProperty(t)&&(n=a[t],e=i[t]||t,Object.defineProperty(o,e,{get:function(){return u.Ajt(n,r[e])}}))};for(n in a)t(n);return o}}),t},R.prototype.Zjt=function(t){var n=this;return{data:t.data,idField:t.idField,sequenceField:t.sequenceField,getData:n.bjt.bind(n),getFieldData:n.Xjt.bind(n)}},R.prototype.qjt=function(t){var n,e,i,r,n,o,a,u,s,c,f,l,h,r,e=this,i=e.LEt.schema;return e.isHierarchy()&&(r=i.hierarchy.type.trim(),n=null==(n=i.hierarchy.column)?void 0:n.trim(),o=i.hierarchy.levelOffset||0,a=e.Ljt(),u=e.$jt(t),"Parent"===r?(s=a[0],t=e.Vjt(t,s,n,u,o)):"Level"===r?(s=a[0],t=e.Wjt(t,s,n,u,o)):"ChildrenPath"===r?(s=a[0],t=e.Qjt(t,s,n,u,o)):"Custom"===r&&(s=a[0],r=i.hierarchy.parse,t=e.Kjt(t,s,n,r,u,o)),e.t7t(),e.ejt=!1),t},R.prototype.t7t=function(){var t,n,e,i,r,t=this,n=t.$jt(),e=t.njt.slice();for((0,b.isNullOrEmpty)(n)||e.sort(function(t,n){return t.sjt()-n.sjt()}),i=0;i<e.length;i++)(r=e[i]).prev=e[i-1],r.next=e[i+1]},R.prototype.$jt=function(t){var n,e,i,r,o,n=this,e=n.LEt.schema;if(!(0,b.isNullOrUndefined)(e)&&!(0,b.isNullOrUndefined)(e.columns))for(r in i=e.columns)if(Object.prototype.hasOwnProperty.call(i,r)&&"rowOrder"===(o=i[r]).dataType&&(o.n7t||n.e7t(r,t)))return o.n7t=!0,r},R.prototype.e7t=function(t,n){var e,i,r;if(!(0,b.isNullOrUndefined)(t)&&(0,b.isArray)(n)){if(0===n.length)return!0;for(t=(e=this).Yjt(t),i=0;i<n.length;i++)if(r=n[i][t],!(0,b.isNullOrUndefined)(r))return(0,b.isNumber)(r)}},R.prototype.qX=function(){var t=this;return!(!t.isHierarchy()||"Parent"===t.Fjt()&&(0,b.isNullOrUndefined)(t.$jt()))},R.prototype.i7t=function(){return this.options.schema.hierarchy.summaryFields},R.prototype.Pjt=function(){return this.options.schema.hierarchy.levelOffset},R.prototype.r7t=function(){return this.options.schema.hierarchy.unparse},R.prototype.Gjt=function(){return this.options.schema.hierarchy.column},R.prototype.Fjt=function(){return this.options.schema.hierarchy.type},R.prototype.o7t=function(){var t,n;return this.Ljt()[0]},R.prototype.isHierarchy=function(){var t,t,n,n=this.options.schema;return!(0,b.isNullOrUndefined)(n)&&!(0,b.isNullOrUndefined)(n.hierarchy)&&!(0,b.isNullOrUndefined)(null==(t=n.hierarchy.type)?void 0:t.trim())&&!(0,b.isNullOrUndefined)(null==(t=n.hierarchy.column)?void 0:t.trim())&&("Custom"!==n.hierarchy.type||(0,b.isFunction)(n.hierarchy.parse)&&(0,b.isFunction)(n.hierarchy.unparse))},R.prototype.a7t=function(){return this.ejt},R.prototype.u7t=function(){this.ejt=!0},R.prototype.SEt=function(t){var n=this;return t=n.s7t(t),n.c7t(t)},R.prototype.c7t=function(t){var n,e;return this.njt[t]},R.prototype.f7t=function(){return this.zjt},R.prototype.l7t=function(t){var n,e=this.i7t();if(!(0,b.isNullOrUndefined)(e))return e[t]},R.prototype.h7t=function(t,n){var e,t,e,e=this,t=e.l7t(t);if(!(0,b.isNullOrEmpty)(t)&&(e=e.SEt(n),!(0,b.isNullOrUndefined)(e))&&0<e.children.length)return t},R.prototype.Yjt=function(t){var n,e,i,r,n,e=this.LEt.schema;if(!(0,b.isNullOrUndefined)(e)&&!(0,b.isNullOrUndefined)(e.columns))for(r in i=e.columns)if(r===t)return i[r].dataName||t;return t},R.prototype.d7t=function(t,n,e){var i=this;return i.v7t(e,(0,b.isNumber)(t)?i.s7t(t):t,i.s7t(n))},R.prototype.v7t=function(t,n,e){var i=this,r=i.njt,o=i.$jt(),a,u=function(t){return i.isHierarchy()?i.njt[t].sequence:i._data[o].data[t]};return t?(n=r[e].next&&r[e].next.lp,(0,b.isNullOrUndefined)(n)?(a=u(e),Math.floor(a)===a?a+=.5:a=(a+Math.ceil(a))/2):a=(u(e)+u(n))/2):(n=r[e].prev&&r[e].prev.lp,a=(0,b.isNullOrUndefined)(n)?(a=u(e))<=1?a/2:a-.5:(u(n)+u(e))/2),a},R.prototype.Mue=function(){return this.wue},R.prototype.Cue=function(t){this.wue=t},R.prototype.m7t=function(t,n,e,i){var r,o,a,u,s,c,n,f,l,c,h,d,c,r,o,d,h,a=this,u=a.$jt(),s=a.isHierarchy();if((0,b.isNullOrUndefined)(u)&&!s||n===e||(0,b.isNullOrUndefined)(n)||(0,b.isNullOrUndefined)(e))return!1;if(e=a.s7t(e),i=(0,b.isNumber)(i)?a.s7t(i):i,n=a.s7t(n),l=(f=a.njt)[n],c=f[e],s){if(c.parent!==l.parent)return!1;r=0,(t=(d=(h=l.parent.children).indexOf(l))<(c=h.indexOf(c)))?(r=null==(o=l.getNextSibling())?void 0:o.lp,h.splice(c+1,0,l),h.splice(d,1)):(r=n,h.splice(d,1),h.splice(c,0,l)),"Custom"===a.Fjt()&&a.g7t(r),!(0,b.isNullOrUndefined)(i)&&(o=f[i],d=l.parent===o,h=l.parent.parent===o.parent,d||h)&&(i=y)}return c=a.v7t(t,i,e),s&&(0,b.isNullOrUndefined)(u)&&(l.sequence=c),a.p7t(t,e,n),a.b7t(n,((r={})[u]=c,r)),!0},R.prototype.p7t=function(t,n,e){var i,r,e,i,i=this,r;i.isHierarchy()&&(e=i.c7t((0,b.isNumber)(e)?e:i.njt.length-1),i=i.c7t(n),(0,b.isNullOrUndefined)(e.prev)||(e.prev.next=e.next),(0,b.isNullOrUndefined)(e.next)||(e.next.prev=e.prev),t?(e.prev=i,e.next=i.next,(0,b.isNullOrUndefined)(i.next)||(i.next.prev=e),i.next=e):(e.next=i,e.prev=i.prev,(0,b.isNullOrUndefined)(i.prev)||(i.prev.next=e),i.prev=e))},R.prototype.y7t=function(t,n){var e,i,r,e=this,i;if(e.isHierarchy())for(n=n||1,r=0;r<n;r++)e.w7t(r+t)},R.prototype.w7t=function(t){var n,t=this.c7t(t);(0,b.isNullOrUndefined)(t.prev)||(t.prev.next=t.next),(0,b.isNullOrUndefined)(t.next)||(t.next.prev=t.prev)},R.prototype.M7t=function(t){var n,e,e,i,r,o,a,u,r,n,s,c,f,l;if(this.isHierarchy()&&(r=(i=this).njt,o=i.Gjt(),!(a=r[t=i.s7t(t)]).parent.isRoot)){for(u=i.Fjt(),r=a.parent.children.slice(a.getCurrentIndex()+1),n=a.parent.parent,a.promote(n),"Parent"===u?i.b7t(t,((n={})[o]=x(a.parentId),n)):"Level"===u&&i.C7t(t),s=0,c=r;s<c.length;s++)(f=c[s]).parent=a,l=f.lp,"Parent"===u?i.b7t(l,((e={})[o]=a.id,e)):"Level"===u&&i.b7t(l,((e={})[o]=f.level,e));"Custom"===u&&i.g7t(t)}},R.prototype.S7t=function(t,n){this.T7t(t,n)},R.prototype.T7t=function(t,n,e){var n,n,n,i,r,o,a,e,u,e;this.isHierarchy()&&(n=!1!==n,r=(i=this).njt,o=i.Gjt(),t=e?t:i.s7t(t),e=(a=r[t]).getPrevSibling(),(0,b.isNullOrUndefined)(e)||(u=a.children.slice(),a.demote(e,n),e=i.Fjt(),n?"Parent"===e?i.b7t(t,((n={})[o]=x(a.parentId),n)):"Level"===e?i.C7t(t):"Custom"===e&&i.g7t(t):"Parent"===e?(i.b7t(t,((n={})[o]=x(a.parentId),n)),u.forEach(function(t){var t;i.b7t(t.lp,((t={})[o]=x(a.parentId),t))})):"Level"===e?i.b7t(t,((n={})[o]=r[t].level,n)):"Custom"===e&&i.g7t(t)))},R.prototype.b7t=function(t,n,e,i){this.A7t(t,n,e,i)},R.prototype.A7t=function(t,n,e,i){var r;this.I7t({action:d.UPDATE,index:t,item:n,x7t:!0,N7t:!0}),e&&e({type:d.UPDATE,success:!0})},R.prototype.C7t=function(t,n,e){for(var i,r,o,a,u,s,c,r=this,o=r.njt,a=r.Gjt(),u=o[t].getChildrenIndexes().concat(t),s=0;s<u.length;s++)c=u[s],r.b7t(c,((i={})[a]=o[c].level,i),n,e)},R.prototype.g7t=function(i,r,o){var a=this,u=!1,s=a.Gjt();(0,b.traversalTree)(a.zjt,function(t){var n,e,n,t;(u=i===t.lp?!0:u)&&(n=t.lp,t=a.k7t(t),(0,b.isNullOrUndefined)(t)||a.b7t(n,((n={})[s]=t,n),r,o))})},R.prototype.k7t=function(t){var n,e,i,r,e,i,n=this,e=n.Gjt(),i=n.r7t(),r,e=t.data[e],i=i(n.D7t(t));if(e!==i)return i},R.prototype.D7t=function(t){var n={};return Object.defineProperty(n,"data",{get:function(){return t.data}}),Object.defineProperty(n,"index",{get:function(){return t.getCurrentIndex()}}),Object.defineProperty(n,"parentData",{get:function(){return t.parent.isRoot?v:t.parent.data}}),n},R.prototype._7t=function(t,n,e){var i=this,t=i.c7t(t);return i.E7t(t.parent,n?t.getCurrentIndex():t.getCurrentIndex()+1,e)},R.prototype.j7t=function(t){var n=this,t=n.c7t(t),e=t.getPrevSibling(),n,n=(0,b.isNullOrUndefined)(e)?n.v7t(!1,y,t.lp):n.v7t(!1,e.lp,t.lp);return{sequence:n,offset:0}},R.prototype.O7t=function(t,n){var e,i,n,e=this;return t=e.s7t(t),i=e.j7t(t).sequence,(n=e._7t(t,!0,n)).sequence=i,e.p7t(!1,t),n},R.prototype.R7t=function(t){var n=this,t=n.c7t(t),e=t.getNextSibling(),e,e=(0,b.isNullOrUndefined)(e)?n.v7t(!0,y,t.lp):n.v7t(!0,e.lp,t.lp);return{sequence:e,offset:n.B7t(t)}},R.prototype.L7t=function(t,n){var e,i,n,e=this;return t=e.s7t(t),i=e.R7t(t).sequence,(n=e._7t(t,!1,n)).sequence=i,e.p7t(!0,t),n},R.prototype.F7t=function(t,n){var e,i,n,e=this;return t=e.s7t(t),i=e.j7t(t).sequence,(n=e._7t(t,!0,n)).sequence=i,e.T7t(t,!0,!0),e.p7t(!1,t),n},R.prototype.P7t=function(t){var n,t,e,i,e,e,n=this,t=n.c7t(t),e=t.children,e=0<e.length?(e=e[e.length-1],i=n.v7t(!0,y,e.lp),n.B7t(t)):(i=n.v7t(!0,y,t.lp),1);return{sequence:i,offset:e}},R.prototype.G7t=function(t,n){var e,i,n,e=this;return t=e.s7t(t),i=e.P7t(t).sequence,(n=e._7t(t,!1,n)).sequence=i,e.U7t(e.njt.length-1),e.p7t(!0,t),n},R.prototype.U7t=function(t){var n,t,e,n,t=this.c7t(t),e=t.getPrevSibling();(0,b.isNullOrUndefined)(e)||t.demote(e)},R.prototype.E7t=function(t,n,e){var i,r,o,a,a,i,i=this,r=i.njt,o=i.o7t(),a=i.$jt(),a=new C(i.Zjt({idField:o,sequenceField:a})),i=i.vjt+1;return(0,b.isNullOrUndefined)(e)||(0,b.isNullOrUndefined)(e[o])?a.id=A(i):a.id=e[o],a.lp=i-1,a.setParent(t,n),r.push(a),a},R.prototype.H7t=function(t){var n,e,i,r,o,a,i,n,e,r=this,o=r.$jt(),a=r.Gjt(),i=r.Fjt();return"Parent"===i?((n={})[a]=x(t.parentId),n=n):"Level"===i?((e={})[a]=t.level,n=e):"Custom"===i&&(e=r.k7t(t),(0,b.isNullOrUndefined)(e)||((i={})[a]=e,n=i)),(0,b.isNullOrEmpty)(o)||((n=n||{})[o]=t.sjt()),n},R.prototype.z7t=function(t,n,e){var i,t,r,n,i=this,t=i.SEt(t);return n?(n=t.getNextSibling(),(0,b.isNullOrUndefined)(n)||(r=!1===e?n:t)):r=!1===e?t:t.getPrevSibling(),i.B7t(r)},R.prototype.B7t=function(t){var n,e,i,n=1,e=function(t){return t.children.reduce(function(t,n){return t+e(n)},t.children.length)};return(0,b.isNullOrUndefined)(t)?0:(i=e(t))+1},R.prototype.V7t=function(t){var n=this,t=n.SEt(t);return n.B7t(t)},R.prototype.Y7t=function(t){var n,e,e,n=this;n.isHierarchy()&&(e=n.o7t(),!(0,b.isNullOrUndefined)(e)&&I(t[e])&&(t[e]=y),"Parent"===n.Fjt())&&I(t[e=n.Gjt()])&&(t[e]=y)},R.prototype.Z7t=function(t){var n,e,i,r,o,a,n=this;n.isHierarchy()&&"Parent"===n.Fjt()&&(e=n.o7t(),(0,b.isNullOrUndefined)(e)||(r=(i=n.c7t(t)).children,o=i.id=i.JEt=n.Xjt(e,t),a=n.Gjt(),r.forEach(function(t){var t;t.XEt=o,n.updateItemValues(t.lp,((t={})[a]=o,t))})))},R.prototype.Sue=function(t){for(var n,e,i,r,o,n=[],e,i=0,r=(0,b.keys)(t);i<r.length;i++)t[o=r[i]].spread&&n.push(o);return n},R.prototype.Tue=function(t,n,e){var i,r,o,a,u,s,c,f,l,h,d,i=(0,b.keys)(t);if(0===i.length)return t;for(r={},o=0,a=i;o<a.length;o++)if(s=t[u=a[o]],0<=n.indexOf(u))for(c={},e&&(e[u]=c),h=f=(l=0,b.keys)(s);l<h.length;l++)d=h[l],0<=i.indexOf(d)?(r[u+"_"+d]=s[d],e&&(c[u+"_"+d]=d)):(r[d]=s[d],e&&(c[d]=d));else r[u]=s,e&&(e[u]=u);return r},R.prototype.Aue=function(t,e){var i,n,n,r,i=this,n=i.LEt,n=n&&n.schema&&n.schema.columns;return t=n&&0<(r=i.Sue(n)).length?t.map(function(t,n){return i.Tue(t,r,0===n?e:y)}):t},R.prototype.Iue=function(t){var n,e,e,e,n=this,e=n.LEt,e=e&&e.schema&&e.schema.columns;return t=e&&0<(e=n.Sue(e)).length?n.Tue(t,e):t},R.prototype.xue=function(t,n){var e,i,r,o,a,u,s,c,f,l,h,e=(0,b.keys)(n);if(0===e.length)return t;for(i={},r=0,o=e;r<o.length;r++)if("object"==typeof(u=n[a=o[r]]))for(i[a]=s={},l=c=(f=0,b.keys)(u);f<l.length;f++)s[u[h=l[f]]]=t[h];else"string"==typeof u&&(i[a]=t[u]);return i},R.prototype.Nue=function(t){var n,e,n=this,e=n.kue;return t=e?t&&n.xue(t,e):t},R.prototype.load=function(c){var f,n,l,f=this,n=f.options.remote,l=f.W7t(c);return f.yjt(l)?(f.ojt=!0,f.Q7t(l).then(function(t){var t={type:"read",data:n&&n.read&&!(0,b.isFunction)(n.read)?N(n.read.adapter,t):t};return f.ki(p,t)?Promise.reject({cancel:!0,type:"read",step:m}):f.djt.parse(t.data)}).then(function(t){return f.wjt=f.djt.total(t),f.djt.read(t)}).then(function(t){var n,e,i,r,o,a,u,s;if(f._data=(!c||!c.reload)&&f._data||{},f.vjt=f.vjt||0,f.DEt=(!c||!c.reload)&&f.DEt||[],t){for(t=(0,b.isArray)(t)?t:[t],t=f.qjt(t),f.kue={},t=f.Aue(t,f.kue),n=0,i=(e=f.Bjt())[0],r=e[1],o=0,a=t.length;o<a;o++)for(u in t[o])s=t[o][u],u=i[u]||u,f._data[u]||(f._data[u]={data:[]},f.DEt.push(u)),f._data[u].data[0+o]=f.Ajt(s,r[u]);f.vjt=0+t.length,t=f.K7t(l).data,f.ki(d.ONCHANGE,{action:d.INSERT,index:0,items:t})}return f.wjt=f.vjt,f.ki(w,{type:"read",success:!0,items:t}),t}).catch(function(t){var t=t&&!0===t.cancel?M+t.step:f.J7t(t);return f.ki(w,{type:"read",success:!1,reason:t}),Promise.reject(t)})):Promise.resolve(f.K7t(l).data)},R.prototype.Que=function(t,n){for(var e,i,r,o,a,u,s,c,f,e=[],i=0,r=n.fields;i<r.length;i++)for(u=0,s=a=t[o=r[i]].data;u<s.length;u++)c=s[u],(f={})[n.as]=o,f[n.valueAs]=c,e.push(f);return e},R.prototype.AP=function(t){for(var n,e,i,r,o,a,u,n=[],e,i=0,r=Object.keys(t);i<r.length;i++)for(a=t[o=r[i]].data,u=0;u<a.length;u++)n[u]||(n[u]={}),n[u][o]=a[u];return n},R.prototype.loadSync=function(t,n){var e,i,n,r,n,o,a,u,s,c,f,e=this;if(e.ojt=!0,i=(0,b.isNullOrUndefined)(t)?n?e.AP(e._data):(n=e.hjt.getDataSync(),e.wjt=e.djt.total(n),e.djt.readSync(n)):e.Que(e._data,t),e._data={},e.vjt=0,e.DEt=[],i){for(i=(0,b.isArray)(i)?i:[i],r=0,o=(n=e.Bjt())[0],a=n[1],u=0,s=i.length;u<s;u++)for(c in i[u])f=i[u][c],c=o[c]||c,e._data[c]||(e._data[c]={data:[]},e.DEt.push(c)),e._data[c].data[0+u]=e.Ajt(f,a[c]);return e.vjt=0+i.length,i=e.K7t().data,e.wjt=e.vjt,i}return[]},R.prototype.length=function(){return"number"==typeof this.wjt?this.wjt:this.vjt},R.prototype.setLength=function(t){var n=this,e=n._data,i;n.wjt?this.wjt=t:e&&(this.vjt=t)},R.prototype.K7t=function(t){var n,e,i,r,o,a,u,n=this,e=n.X7t(),i=0,r=n.vjt,o=e?n.s7t(0):0,a=n.q7t||[];for(e||(a=[]),u=[];0<r&&o<n.vjt;)a[o]||(u.push(n.bjt(o)),r--),o++;return{data:u}},R.prototype.$7t=function(t,n){var e,i,r,o,a,u,s,c,e=this,i=e.X7t(),r=0,o=e.vjt,a=i?e.s7t(0):0,u=e.q7t||[];for(i||(u=[]),s=[],c=0;0<o&&a<e.vjt;)u[a]||(-1<t.indexOf(c)&&(s[c]=e.bjt(a)),c++,o--),a++;return{data:s}},R.prototype.tOt=function(t){return(t?this.$7t(t):this.K7t()).data},R.prototype.nOt=function(t,n){var e,i,e,i,e,r,o,a,u,s,i=this,e=i.Fjt(),r=[];if(!(0,b.isNullOrUndefined)(n)&&t.length===n.length)if("Level"===e)for(o=0;o<t.length;o++)a=t[o],r.push(k(a,n[o]));else"ChildrenPath"===e&&(u=i.Yjt(i.Gjt()),s=[((e={})[u]=r,e)],D(((i={})[u]=t,i),((e={})[u]=n,e),u,function(t,n){var t,n,t=k(t,n);delete t[u],n=s[s.length-1],(0,b.isArray)(n[u])||(n[u]=[]),n[u].push(t),s.push(t)},function(){s.pop()}));return r},R.prototype.eOt=function(t){var n,e,i,r,i,o,a,n,u,s,c,f,l,e,h,d,e,r=this,i=r.Fjt();if(!(0,b.isNullOrUndefined)(t)){if(o=r.f7t(),u=r.Gjt(),"Level"===i){for(a="children",c=r.Yjt(u),(n={})[a]=[],n.data={},f=[n=n],l=0;l<t.length;l++){for(h=(e=t[l])[c],d=f[f.length-1];d.data.level>=h;)f.pop(),d=f[f.length-1];(e={data:e})[a]=[],e=e,d[a].push(e),f.push(e)}s=function(t){return t.data}}else"ChildrenPath"===i&&((i={})[a=u]=t,n=i,s=function(t){return t});D(o,n,{childrenField2:a},function(t,n){r._jt(s(n)),r.pjt(t.lp,s(n))})}},R.prototype.iOt=function(e,i,r,n){var o=this;return o.rOt({body:e},i).then(function(t){var n,t,t,n="batch"===i,t={type:i,batch:n,data:o.nOt(e,t)};return o.ki(p,t)?Promise.reject({cancel:!0,type:i,batch:n,step:p}):(e=t.data,o.eOt(e),t={type:i,success:!0,batch:n,items:(0,b.isArray)(e)?e:[e]},delete o.oOt,delete o.q7t,delete o.aOt,delete o.uOt,r&&r(t),o.ki(w,t),n?Promise.resolve(o.K7t()):y)}).catch(function(t){var t,t,t=t&&!0===t.cancel?M+t.step:o.J7t(t),t={type:i,success:!1,reason:t};o.ki(g,{type:t}),n&&n(t)})},R.prototype.sOt=function(){var t,t,t=this;if(t.isHierarchy())return"Level"===(t=t.Fjt())||"ChildrenPath"===t},R.prototype.cOt=function(e,i,t,n){var r,o,r,a,u,s,c,f,l,o=this,r=o.Fjt();return i=i||o.q7t||[],"Level"===r?(a=o.f7t(),u=[],(0,b.traversalTree)(a,function(t){var t,n,t=t.lp;i[t]||(n=o.bjt(t),("create"===e||"batch"===e&&o.isInserted(t,!0))&&o.Y7t(n),n=o.jjt(n),u.push(n))}),o.iOt(u,e,t,n)):"ChildrenPath"===r?(a=o.f7t(),s=o.Gjt(),c=o.Yjt(s),l=[((r={})[c]=f=[],r)],(0,b.traversalTree)(a,{invoking:function(t){var t,n,t,t=t.lp;i[t]||(n=o.bjt(t),("create"===e||"batch"===e&&o.isInserted(t,!0))&&o.Y7t(n),delete n[s],n=o.jjt(n),0<l.length&&(t=l[l.length-1],(0,b.isArray)(t[c])||(t[c]=[]),t[c].push(n)),l.push(n))},invoked:function(t){i[t.lp]||l.pop()}}),o.iOt(f,e,t,n)):Promise.resolve(void 0)},R.prototype.fOt=function(){var t,n,e,i,r,o,a,t,u,s,c,i,n=this;if(n.isHierarchy()){for(e=n.njt,i=n.f7t(),r=e.reduce(function(t,n){return(t[n.JEt]=n).id=n.JEt,n.sequence=n.$Et,n.parent=v,t},((t={})[i.JEt]=i,t)),o=0;o<e.length;o++)n.isInserted(o,!0)||((a=e[o]).parent=r[a.XEt]);if(t=n.options.schema.hierarchy.levelOffset||0,i.level=t-1,"Level"===n.Fjt()){for(u=n.Gjt(),s=y,o=0;o<e.length;o++)!n.isInserted(o,!0)&&(c=n.lOt(o)[u],(c=(0,b.isNumber)(c)?c:n.Xjt(u,o))<s||s===y)&&(s=c);i.level=s+t-1}n.njt=[],i=!(0,b.isNullOrEmpty)(n.$jt()),n.Hjt(i)}},R.prototype.cancelChanges=function(){var e,t,i,r,o,a,e=this,t=e.getHeldActions();t&&0!==t.length&&(e.fOt(),i=e.aOt,r=e.q7t||[],o=e.oOt||[],a=[],(0,b.forEach)(t,function(t){var n=t.sourceIndex,t=t.type;t===d.UPDATE?(e.pjt(n,i[n]),o[n]=[!!o[n]&&o[n][0],!1]):t===d.DELETE?(r[n]=y,o[n]&&o[n][0]?a.push(n):o[n]&&o[n][1]&&(e.pjt(n,i[n]),o[n]=[!1,!1]),(0,b.isNullOrUndefined)(e.wjt)||(e.wjt+=1)):t===d.INSERT&&a.push(n)}),(0,b.forEachRight)(a,function(t){e.mjt(t,1),o.splice(t,1),(0,b.isNullOrUndefined)(e.wjt)||--e.wjt}),e.clearBatchCache_())},R.prototype.getChanges=function(){return this.hOt(!1)},R.prototype.isDataLengthChanged=function(){return this.getChanges().some(function(t){return"delete"===t.type||"insert"===t.type})},R.prototype.submitChanges=function(r){var o,n,a,u,s,c,f,l,o=this;return o.hasCachedActions()?o.sOt()?(n=(o.q7t||[]).slice(),o.cOt("batch",y,function(){for(var t=o.vjt-1;0<=t;t--)!0===n[t]&&(o.mjt(t,1),o.njt[t].parent=v,o.njt.splice(t,1));o.njt.forEach(function(t,n){t.lp=n})})):(a=o.aOt,u=o.q7t||[],s=o.oOt||[],c=o.getHeldActions(),f=[],l=d.UPDATE,(0,b.isNullOrUndefined)(c)||c.forEach(function(t){t.dataItem=o.Nue(o.jjt(t.dataItem)),t.oldDataItem=o.Nue(o.jjt(t.oldDataItem))}),o.rOt({body:c},"batch").then(function(t){var t,e,i,t,t={type:l,batch:!0,data:t};return o.ki(p,t)?Promise.reject({cancel:!0,type:l,batch:!0,step:p}):(((e=t.data)||[]).forEach(function(t){t.succeed&&t.data&&(o._jt(t.data),t.data=o.Iue(t.data))}),e.length,c.length,i=[],(0,b.forEach)(c,function(t,n){var n=e[n];n.succeed?t.type===d.UPDATE?(a&&(a[t.sourceIndex]=y),s[t.sourceIndex][1]=y):t.type===d.INSERT?(s[t.sourceIndex]=[],a[t.sourceIndex]=y,n.data&&(o.pjt(t.sourceIndex,n.data),o.Z7t(t.sourceIndex))):t.type===d.DELETE&&f.push(t.sourceIndex):i.push({localAction:t,response:n})}),(0,b.forEachRight)(f,function(t){u.splice(t,1),o.mjt(t,1),a&&a.splice(t,1),s.splice(t,1),o.isHierarchy()&&(o.njt[t].parent=v,o.njt.splice(t,1))}),o.isHierarchy()&&o.njt.forEach(function(t,n){t.lp=n}),0<i.length?(t={type:l,errorData:i},o.ki(g,{type:t})||(o.uOt=[],(0,b.forEach)(i,function(t,n){var e=t.response,t=t.localAction,i=t.sourceIndex;t.type===d.DELETE&&(u[i]=y),o.dOt(i,{type:t.type,success:!1,reason:e.reason}),r(i,e.reason,t.type)}))):delete o.uOt,Promise.resolve(o.K7t()))}).catch(function(t){var t,n,t=t&&!0===t.cancel?M+t.step:o.J7t(t),n;o.ki(g,{type:{type:l,reason:t}})})):Promise.resolve(void 0)},R.prototype.getHeldActions=function(){var t=this;return t.hasCachedActions()?t.hOt(!0):v},R.prototype.hOt=function(t){for(var n,e,i,r,o,a,u,s,c,f,l,n=this,e=[],i=n.oOt||[],r=n.q7t||[],o=n.aOt,s=0;s<n.vjt;s++){if(a=i[s],!(u=null)===r[s])u={type:d.DELETE,dataItem:n.bjt(s)};else if(a&&a[0])u={type:d.INSERT,dataItem:n.bjt(s)},t&&n.isHierarchy()&&n.Y7t(u.dataItem);else if(a&&a[1]){if(c=o[s],f=n.bjt(s),!t)for(l in c=h({},c))c.hasOwnProperty(l)&&c[l]===f[l]&&(delete c[l],delete f[l]);u={type:d.UPDATE,dataItem:f,oldDataItem:c}}u&&(t?u.sourceIndex=s:u.index=this.TEt(s),e.push(u))}return e},R.prototype.clearBatchCache_=function(){var t=this;delete t.q7t,delete t.aOt,delete t.uOt},R.prototype.hasCachedActions=function(){var t,n,t,e,i,r,o,a,u,t=this;if(t.X7t()&&(n=t.oOt,t=t.q7t,n||t)){if(t)for(e=0,i=t;e<i.length;e++)if(r=i[e])return!0;if(n)for(o=0,a=n;o<a.length;o++)if((u=a[o])&&(!0===u[0]||!0===u[1]))return!0}return!1},R.prototype.bind=function(t,n){var e,i,r,o,a,u,s,e=this;if(n)for(o=i=(r=0,b.isArray)(t)?t:[t];r<o.length;r++)a=o[r],(u=(0,b.isFunction)(n)?n:n[a])&&(s=e._events[a]=e._events[a]||new c.Event).addHandler(u,e)},R.prototype.unbind=function(t,n){var e,t,e=this;(0,b.isNullOrUndefined)(t)?((0,b.forEach)(e._events,function(t){t.removeAllHandlers()}),e._events={}):(t=e._events[t])&&(n?t.removeHandler(n,e):t.removeAllHandlers())},R.prototype.ki=function(t,n){var e,i,e=this,i=e._events[t];return!!i&&((n=n||{}).cancel=!1,n.eventName=t,i.raise(e,n),n.cancel)},R.prototype.vOt=function(t){var n=this;return n._events.hasOwnProperty(t)&&n._events[t].hasHandlers},R.prototype.W7t=function(t){return t=h({},t)},R.prototype.mOt=function(t){return t},R.prototype.getDirtyIndexes=function(){var t,n=this.oOt||[];return(0,b.keys)(n).map(function(t){return parseInt(t,10)})},R.prototype.gOt=function(t,n){var e=this,i;return(e.oOt||[])[t=n?t:e.s7t(t)]||[]},R.prototype.isInserted=function(t,n){return this.gOt(t,n)[0]},R.prototype.isUpdated=function(t){return this.gOt(t)[1]},R.prototype.getErrorInfo=function(t){var n=this,e=n.uOt;if(!(0,b.isNullOrUndefined)(e))return e[t=n.s7t(t)]},R.prototype.dOt=function(t,n){var e=this,i;(e.uOt=e.uOt||[])[t]=n},R.prototype.pOt=function(){this.oOt=y,this.q7t=y,this.aOt=y,this.uOt=y},R.prototype.lOt=function(t){var n=this,e;return(n.aOt=n.aOt||[])[t]},R.prototype.insertItem=function(t,n,e,i){var r=this;t=r.s7t(t),r.I7t({action:d.INSERT,index:t,item:n,N7t:!0}),r.isHierarchy()&&"Custom"===r.Fjt()&&r.g7t(t),e&&e({type:d.CREATE,success:!0})},R.prototype.updateItem=function(t,n,e,i){var r;this.I7t({action:d.UPDATE,index:t,item:n}),e&&e({type:d.UPDATE,success:!0})},R.prototype.updateItemValues=function(t,n,e,i){var r;this.I7t({action:d.UPDATE,index:t,item:n,x7t:!0}),e&&e({type:d.UPDATE,success:!0})},R.prototype.resetItem=function(t,n,e){var i,r,o,i=this,r,o=(i.aOt=i.aOt||[])[t=i.s7t(t)];i.isHierarchy()&&(o=i.bOt(t,o)),i.pjt(t,o),i.clearChangedStatus(t),i.dOt(t),n&&n({type:d.UPDATE,success:!0})},R.prototype.bOt=function(t,n){var e,i,t,r,o,e,a,e=this,i;return e.isHierarchy()?(t=e.bjt(t),r=e.Fjt(),o=e.Gjt(),e=e.$jt(),a=h({},n),"Parent"!==r&&"Level"!==r&&"Custom"!==r||(a[o]=t[o]),(0,b.isNullOrEmpty)(e)||(a[e]=t[e]),a):n},R.prototype.saveItem=function(t,n,e){var i,r,o,a,u,s,o,c,i=this;t=i.s7t(t),a=(o=(r=i.oOt||[])[t]||[])[0],u=o[1],0<o.length&&(a||u)&&(i.isHierarchy()&&(c=!(o=(s=i.njt)[t].parent).isRoot&&r[o.lp]&&r[o.lp][0])?e&&e({type:d.CREATE,success:!1}):i.yOt(t,i.bjt(t),a?d.INSERT:d.UPDATE,n,e))},R.prototype.yOt=function(n,e,t,i,r){var o=this,t=t===d.INSERT,a=t?d.CREATE:d.UPDATE,u=o.X7t(),s=o.wOt(a),c=o.MOt();u||!s||c?c&&(o.oOt[n]=[],o.aOt[n]=y,i)&&i({type:a,success:!0}):o.sOt()?o.cOt(t?d.CREATE:d.UPDATE,y,i,r):(t&&o.Y7t(e),e=o.jjt(e),e=o.Nue(e),o.rOt({body:e},t?d.CREATE:d.UPDATE).then(function(t){var t,t,t={type:a,data:k(e,t)};return o.ki(p,t)?Promise.reject({cancel:!0,type:a,step:p}):(o._jt(t.data),t.data=o.Iue(t.data),o.pjt(n,t.data),o.oOt[n]=[],o.aOt[n]=y,o.dOt(n),t={type:a,success:!0,items:[t.data]},a===d.CREATE&&o.Z7t(n),i&&i(t),o.ki(w,t),y)}).catch(function(t){var t,t,t=t&&!0===t.cancel?M+t.step:o.J7t(t),t={type:a,success:!1,reason:t};o.dOt(n,t),o.ki(g,{type:t}),r(t)}))},R.prototype.I7t=function(t){var n,e,i,r,o,a,u,s,c,f,l,l,n=this,e=n.X7t(),i=n.aOt=n.aOt||[];e&&(r=n.q7t=n.q7t||[]),o=t.action,a=t.index,u=t.item,s=t.x7t,a=(c=t.N7t)?a:n.s7t(a),n.oOt=n.oOt||[],f=n.oOt,o===d.INSERT?(0===n.vjt&&0===n.DEt.length&&n.COt(),n.vjt<a&&(n.vjt=a),(0,b.isNullOrUndefined)(l=a)&&(l=n.vjt),n.mjt(l,0,u),i.length>=a?i.splice(a,0,h({},u)):i[a]=h({},u),e&&(r.length>=a?r.splice(a,0,y):r[a]=y),f.length>=a?f.splice(a,0,[!0]):f[a]=[!0],(0,b.isNullOrUndefined)(n.wjt)||(n.wjt+=1),n.ki(d.ONCHANGE,{action:o,index:a,items:[t.item]})):o===d.UPDATE&&(l=n.bjt(a),i[a]||(i[a]=h({},l)),n.pjt(a,u,s),n.oOt[a]?n.oOt[a]=[n.oOt[a][0],!0]:n.oOt[a]=[!1,!0],_(u,i[a])&&n.clearChangedStatus(a),n.ki(d.ONCHANGE,{action:o,index:a,items:[t.item],oldItems:[l]}))},R.prototype.clearChangedStatus=function(t){var n=this;!(n.oOt[t][1]=!1)!==n.oOt[t][0]&&(n.aOt[t]=y)},R.prototype.get=function(t){var n,e,i,r,o,a,n=this,e=n._data;if(t=n.s7t(t),e&&t<n.vjt){for(i={},r=0,o=n.DEt;r<o.length;r++)i[a=o[r]]=e[a].data[t];return i}return y},R.prototype.Xjt=function(t,n){var e=this,i=e._data;return i&&i[t]&&n<e.vjt?i[t].data[n]:y},R.prototype.getFieldValue=function(t,n){var e=this,i=e._data;return n=e.s7t(n),i&&i[t]&&n<e.vjt?i[t].data[n]:y},R.prototype.getFieldOriginalValue=function(t,n){var e,i,e,e=this,i=e._data;return n=e.s7t(n),i&&i[t]&&n<e.vjt?(e=e.lOt(n),(0,b.isNullOrUndefined)(e)?i[t].data[n]:e[t]):y},R.prototype.SOt=function(n,e,i){var r,t,o,a,u,s,c,u,r=this,t;r.X7t()||!r.wOt(d.DELETE)||r.MOt()||r.isInserted(n)||!r.sOt()?r.isHierarchy()&&(n=r.s7t(n),o=r.c7t(n),u=(c=o.getChildrenIndexes(!0).concat(n)).map(function(e){return function(t,n){r.TOt(e,1,t,n)}}),(0,b.promiseSerialExecute)(u).then(function(t){r.X7t()||(c.sort(function(t,n){return n-t}),c.forEach(function(t){r.tX(t,1,!1)}),r.njt.forEach(function(t,n){t.lp=n})),"Custom"===r.Fjt()&&r.g7t(n+(r.X7t()?c.length:0));var t=t[t.length-1];t.removedCount=c.length,e&&e(t)}).catch(function(t){i&&i(t)})):(n=r.s7t(n),o=r.c7t(n),u=(a=o.getChildrenIndexes(!0).concat(n)).reduce(function(t,n){return t[n]=!0,t},[]),r.bind(p,s=function(){a.forEach(function(t){r.tX(t,1,!1)}),r.njt.forEach(function(t,n){t.lp=n})}),r.cOt(d.DELETE,u,function(t){r.unbind(p,s),t.removedCount=a.length,e&&e(t)},function(t){r.unbind(p,s),i&&i(t)}))},R.prototype.remove=function(t,n,e,i){var r=this;r.isHierarchy()?r.SOt(t,e,i):r.TOt(t,n,e,i)},R.prototype.TOt=function(e,i,r,n){var o,a,t,u,o=this;e<0||e>=o.length()||(a=d.DELETE,o.X7t()||!o.wOt(d.DELETE)||o.MOt()||o.isInserted(e)?(!o.X7t()&&o.isHierarchy()||o.tX(e,i),r&&r(t={type:a,success:!0})):(u=o.gjt(e,e+i),o.Ejt(u),u=u.map(function(t){return o.Nue(t)}),o.rOt({body:u},d.DELETE).then(function(t){var n;return o.ki(p,{type:a,data:u})?Promise.reject({cancel:!0,type:a,step:p}):(o.isHierarchy()||o.tX(e,i),o.Ejt(u,{isServerToClient:!0}),u=u.map(function(t){return o.Iue(t)}),o.dOt(e),n={type:a,success:!0,items:[u]},r&&r(n),o.ki(w,n),y)}).catch(function(t){var t,t,t=t&&!0===t.cancel?M+t.step:o.J7t(t),t={type:a,success:!1,reason:t};o.dOt(e,t),o.ki(g,{type:t}),n(t)})))},R.prototype.tX=function(t,n,e){var i,r,o,a,u,r,s,c,f,l,h,r,i=this,r=i.X7t(),a=i.oOt||[],u=i.aOt||[];if(r){for(r=void 0,s=i.q7t=i.q7t||[],c=n,f=[],o=[],r=i.s7t(t),i.isHierarchy()&&((l=i.njt)[r].parent=v,i.y7t(t,n)),h=r;h<i.vjt&&(!0!==s[h]&&o.length<n&&(o.push(i.bjt(h)),f.push(h),s[h]=!0,--c),0!==c);h++);(0,b.forEachRight)(f,function(t){a[t]&&a[t][0]&&(s.splice(t,1),a.splice(t,1),u.splice(t,1),i.mjt(t,1))})}else o=i.mjt(t,n),a.splice(t,n),u.splice(t,n),i.isHierarchy()&&((l=i.njt)[t].parent=v,i.y7t(t,n),l.splice(t,n),!1!==e)&&l.forEach(function(t,n){t.lp=n});r=o.length,(0,b.isNullOrUndefined)(i.wjt)||(i.wjt-=r,i.wjt=Math.max(i.wjt,0)),i.ki(d.ONCHANGE,{action:d.DELETE,items:o})},R.prototype.COt=function(){var t,n,e,i,n=this,e=null==(t=n.options.schema)?void 0:t.columns;if(e)for(i in e)Object.prototype.hasOwnProperty.call(e,i)&&(n._data[i]={data:[]},n.DEt.push(i))},R.prototype.MOt=function(){return(0,b.isNullOrUndefined)(this.options.remote)},R.prototype.X7t=function(){var t;return!!this.options.batch&&!this.MOt()},R.prototype.wOt=function(t){var n,e,n,n=this,e=n.options,n=n.hjt;return!!e.autoSync&&!(0,b.isNullOrUndefined)(n.LEt[t])},R.prototype.rOt=function(t,n){var e,i,e=this,i=n||d.UPDATE;return!(t=e.hjt.setupRequestOptions(t,n||d.UPDATE))||e.ki(m,{type:i,requestParams:t})?Promise.reject({cancel:!0,type:i,step:m}):e.hjt.postData(t)},R.prototype.Q7t=function(t){var n=this;return t=n.mOt(t),!(t=n.hjt.setupRequestOptions(t,"read"))||n.ki(m,{type:"read",requestParams:t})?Promise.reject({cancel:!0,type:"read",step:m}):n.hjt.getData(t)},R.prototype.J7t=function(t){return(0,b.isString)(t)?t:t instanceof Error?t.message:"some error happened"},R.prototype.s7t=function(t){var n,e,i,r,o,n=this.q7t;if((0,b.isNullOrUndefined)(n)||0===n.length)return t;for(r=i=e=0,o=n.length;r<=o;r++)if(n[r])i+=1;else{if(e===t)break;e+=1}return t+i},R.prototype.TEt=function(t){var n,e,i,n=this.q7t;if(!(0,b.isNullOrUndefined)(n)&&0!==n.length)for(e=0,i=Math.min(n.length,t);e<=i;e++)n[e]&&--t;return t},d.DataSource=R},"./dist/src/dataSource/dataTransport/localDataTransport.js":function(t,n){"use strict";var e,i;function r(t){t&&(this._data=t.data,this.LEt=e({},t))}e=this&&this.__assign||function(){return(e=Object.assign||function(t){for(var n,e,i,r,e=1,i=arguments.length;e<i;e++)for(r in n=arguments[e])Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r]);return t}).apply(this,arguments)},Object.defineProperty(n,"__esModule",{value:!0}),n.LocalDataTransport=void 0,r.prototype.getData=function(t){var n;return Promise.resolve(this._data)},r.prototype.getDataSync=function(){return this._data},r.prototype.postData=function(t){var n;return Promise.resolve(this._data)},r.prototype.setupRequestOptions=function(t,n){return{}},n.LocalDataTransport=r},"./dist/src/dataSource/dataTransport/remoteDataTransport.js":function(t,n,e){"use strict";var s,a,u,i,c,f,l,h,d,v,m,r;function o(t){var n;this.LEt=s({},t)}s=this&&this.__assign||function(){return(s=Object.assign||function(t){for(var n,e,i,r,e=1,i=arguments.length;e<i;e++)for(r in n=arguments[e])Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r]);return t}).apply(this,arguments)},Object.defineProperty(n,"__esModule",{value:!0}),n.RemoteDataTransport=void 0,e("./node_modules/whatwg-fetch/fetch.js"),a=e("./node_modules/fetch-jsonp/build/fetch-jsonp.js"),u=e("./dist/src/dataSource/utils.js"),i=null,c=void 0,f="jsonp",l="read",h="create",d="update",v="delete",m="Content-Type",o.prototype.getData=function(t){var n,e,i,r,o,n=this,e,i=this.LEt[t.requestType],r=t.dataType,o=r===f?a:fetch;return t.requestData=c,(t.requestType=c,u.isFunction)(i)?i(t):o(t.url,t).then(function(t){if(t.ok)return n.AOt(r)?t.json():t.text();throw t})},o.prototype.postData=function(t){var n,e,i,r,o,n=this,e,i=this.LEt[t.requestType],r=t.dataType,o=t.requestData;return t.requestData=c,(t.requestType=c,u.isFunction)(i)?i(o,t):fetch(t.url,t).then(function(t){if(t.ok)return n.AOt(r)?t.json():t.text();throw t})},o.prototype.AOt=function(t){return void 0===t||"json"===t||t===f},o.prototype.setupRequestOptions=function(t,n){var e,i,r,o,a,u,e;if(t=t||{},i=(e=this).LEt[n])return r=i.body,(o=t.body)?(t.headers=t.headers||{},e.LEt.dataConverter?(t.body=o=e.LEt.dataConverter(o,n||l),t.headers[m]="application/plain;"):(t.body="string"==typeof o?o:JSON.stringify(o),t.headers[m]="application/json; charset=utf-8")):r&&(t.body="string"==typeof r?r:JSON.stringify(r),t.headers={},t.headers[m]="application/json; charset=utf-8"),e=i.method,n===l?(i.dataType===f&&(a={mode:"no-cors"}),u={method:e||"GET"}):n===h||n===d||"batch"===n?u={method:e||"POST"}:n===v&&(u={method:e||"DELETE"}),s(s(s(s(s({},i),u),a),t),{requestType:n,requestData:o})},n.RemoteDataTransport=o},"./dist/src/dataSource/event.js":function(t,n){"use strict";var r,s,e;function i(t,n,e){var i=this;i.handler=t,i.owner=n,i.priority=e}function o(){this.IOt=[]}Object.defineProperty(n,"__esModule",{value:!0}),n.Event=n.EventHandler=void 0,r=i,n.EventHandler=r,s=null,Object.defineProperty(o.prototype,"hasHandlers",{get:function(){return 0<this.IOt.length},enumerable:!1,configurable:!0}),o.prototype.addHandler=function(t,n,e){var i=this,t=new r(t,n,e=void 0===e?1:e);i.IOt.push(t),i.sortHandlers()},o.prototype.removeHandler=function(t,n){for(var e,i,r,o,a,e=this,i=e.IOt,r=i.length,o=0;o<r;o++)if((a=i[o]).handler===t&&a.owner===n){e.IOt.splice(o,1);break}},o.prototype.sortHandlers=function(){this.IOt.sort(function(t,n){var t=t.priority,n=n.priority;return t<n?1:n<t?-1:0})},o.prototype.removeHandlersByPriority=function(t){for(var n,e,i,r,o,a,u,n=this,e=n.IOt,i=e.length,r=s,o=s,a=0;a<i;a++)if((u=e[a]).priority===t)r===s&&(r=a),o=a;else if(r!==s)break;r!==s&&o!==s&&n.IOt.splice(r,o-r+1)},o.prototype.removeAllHandlers=function(){this.IOt.length=0},o.prototype.raise=function(t,n){var e,i,i,r,o,a,u,e=!1,i=function(){e=!0};for(n===s?n={stopPropagation:i}:n.stopPropagation=i,r=(i=this).IOt.length,o=i.IOt.slice(0,r),a=0;a<r&&!e;a++)(u=o[a]).handler.call(u.owner,t,n)},n.Event=o},"./dist/src/dataSource/utils.js":function(B,u,t){"use strict";var r,a,s,c,f,l;function n(t){return t&&!(0,u.isArray)(t)&&"object"==typeof t}function e(t){return"function"==typeof t}function i(t){return"number"==typeof t}function o(t){return"boolean"==typeof t}function h(t,n){var e,i,r,o,a;if((0,u.isArray)(t))for(e=0;e<t.length;e++)n(t[e],e,t);else for(r=0,o=i=Object.keys(t);r<o.length;r++)n(t[a=o[r]],a,t)}function d(t,n){var e,i,r,o,a;if((0,u.isArray)(t))for(e=t.length-1;0<=e;e--)n(t[e],e,t);else for((i=Object.keys(t)).reverse(),r=0,o=i;r<o.length;r++)n(t[a=o[r]],a,t)}function v(t){return Object.keys(t)}function m(t,n,e){if((0,u.isArray)(t))return t.reduce(n,e);throw new Error("NOT SUPPORT")}function g(t,n,e){return t.indexOf(n,e=void 0===e?0:e)}function p(t,n){for(var e=0,i=t.length;e<i;e++)if(n(t[e],e,t))return e;return-1}function b(t,n){var e,i,r,o,a,u,s;if(void 0===n&&(n=!1),!A(t)&&"object"==typeof t){if(t&&t instanceof Array)return t.map(function(t){return b(t,n)});if(t&&"object"==typeof t){for(e={},r=0,o=i=v(t);r<o.length;r++)u=t[a=o[r]],n?(s=x(u),e[a]="object"===s||"array"===s?b(u,n):u):e[a]=u;return e}}return t}function y(t,n){var e,i,r;for(void 0===t&&(t=[]),void 0===n&&(n=[]),e={},i=Math.min(t.length,n.length),r=0;r<i;r++)e[t[r]]=n[r];return e}function w(t){return"string"==typeof t}function M(t,n){var e,i,r,o;if(w(n))return t[n];for(e={},i=0,r=n;i<r.length;i++)e[o=r[i]]=t[o];return e}function C(t,n){if((0,u.isArray)(t))return t.map(n);throw new Error("NOT SUPPORT")}function S(t){return void 0===t}function T(t){return null===t}function A(t){return S(t)||T(t)}function I(t){return""===t||A(t)}function x(t){var n;return Object.prototype.toString.call(t).match(/\[\w+\s(\w+)\]/)[1].toLowerCase()}function N(t,n,e,i){n<0||n>t.length||e<0||e>t.length||n===e||i<=0||t.splice.apply(t,r([e-(n<e?i-1:0),0],t.splice(n,i),!1))}function k(t,n){var t=t.parent;t&&(n(t),k(t,n))}function D(t,n,e,i){var r,o,a,u,s,c,f,l,h,d,v,r=t[i||"children"]||[];for(I(e)?o=r.slice():(c=s=void 0,"string"==typeof e?a=e:"function"==typeof e?u=e:"object"==typeof e&&(a=e.field,u=e.getValue,s=e.compareFn,c=e.isOrderChildren),o=c?r:r.slice(),a?o.sort(function(t,n){return t[a]-n[a]}):u?o.sort(function(t,n){return u(t)-u(n)}):s&&o.sort(s)),"object"==typeof(f=n)&&(f=n.invoking,l=n.invoked),d=0;d<o.length;d++){if(v=o[d],f&&(h=f(v,t))&&h.cancel)return h;if((h=h&&h.cancelDeepRecursion?h:D(v,n,e,i))&&h.cancel)return h;if(l&&(h=l(v,t))&&h.cancel)return h}}function L(t){return t}function _(e){return void 0===e&&(e=0),new Promise(function(t,n){setTimeout(function(){t("timeout")},e)})}function E(t){var n=t.callback,e=t.timeout,e=void 0===e?5e3:e,t=t.retryCount,i=void 0===t?1:t;return Promise.race([n(),_(e)]).then(function(t){if("timeout"!==t)return Promise.resolve(t);if(0<i)return E({callback:n,retryCount:--i});throw"timeout"})}function j(t,n){return O(t.map(function(t){return function(){return new Promise(t)}}),n)}function O(t,e){var i=[];return t.reduce(function(t,n){return t.then(function(t){return i.push(Promise.resolve(t)),e?E({callback:n,timeout:e.timeout,retryCount:e.retryCount}):n()})},Promise.resolve({})).then(function(t){return i.shift(),i.push(Promise.resolve(t)),Promise.all(i)})}function R(t){return"string"==typeof t&&("="===t.charAt(0)||0<=t.indexOf("{{")&&0<=t.indexOf("}}"))}function F(n,t){var e,e,i,r,o;if(A(n)||""===n)return"";if(e=R(t),!t||"General"===t||e)return"boolean"==typeof n||n instanceof Boolean?(n=s?n?s.getBoolean().boolean_true:s.getBoolean().boolean_false:n).toString().toUpperCase():n instanceof Date?(i=(e=c.Fe(c.culture()).DateTimeFormat).shortDatePattern,0===n.getHours()&&0===n.getMinutes()&&0===n.getSeconds()&&0===n.getMilliseconds()||(i=e.defaultDatePattern),l.Pe(n,i)):(n="number"==typeof n?f.Ge(n.toString()):n).toString();try{return(r=a.Formatter&&a.Formatter.GeneralFormatter)?(o=null,(o="string"==typeof t?new r(t):t).format(n,{})):n.toString()}catch(t){return n.toString()}}function P(t,n){var e,i;if(!A(t)&&!A(n))for(e=n.split(".");0<e.length;)t=t[i=e.shift()];return t}function G(t){var n,e,i,r,o;if(t&&0<t.length){for(n={},e=[],i=0,r=t;i<r.length;i++)n[o=r[i]]||(n[o]=!0,e.push(o));return e}return t}r=this&&this.__spreadArray||function(t,n,e){if(e||2===arguments.length)for(var i=0,r=n.length,o;i<r;i++)!o&&i in n||((o=o||Array.prototype.slice.call(n,0,i))[i]=n[i]);return t.concat(o||Array.prototype.slice.call(n))},Object.defineProperty(u,"__esModule",{value:!0}),u.getUniqueArray=u.q$=u.format=u.promiseAllSerial=u.promiseSerialExecute=u.traversalTree=u.bubbleTree=u.swapArrayItems=u.getActualType=u.isNullOrEmpty=u.isNullOrUndefined=u.isNull=u.isUndefined=u.map=u.pick=u.isString=u.zipObject=u.clone=u.findIndex=u.indexOf=u.reduce=u.keys=u.forEachRight=u.forEach=u.isBoolean=u.isNumber=u.isFunction=u.isObject=u.isArray=void 0,a=t("Common"),s=t("CalcEngine"),c=a.Common.CultureManager,f=a.Common.st,l=a.Common.ct,u.isArray=Array.isArray,u.isObject=n,u.isFunction=e,u.isNumber=i,u.isBoolean=o,u.forEach=h,u.forEachRight=d,u.keys=v,u.reduce=m,u.indexOf=g,u.findIndex=p,u.clone=b,u.zipObject=y,u.isString=w,u.pick=M,u.map=C,u.isUndefined=S,u.isNull=T,u.isNullOrUndefined=A,u.isNullOrEmpty=I,u.getActualType=x,u.swapArrayItems=N,u.bubbleTree=k,u.traversalTree=D,u.promiseSerialExecute=j,u.promiseAllSerial=O,u.format=F,u.q$=P,u.getUniqueArray=G},"./dist/src/interfaces/conditionalFormatOptions.js":function(t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.c=void 0,n.c=0},"./dist/src/interfaces/interface.js":function(t,n){"use strict";var e,i,r,o,a,a,a,a;Object.defineProperty(n,"__esModule",{value:!0}),n.RelationshipMap=n.RowColumnStates=n.StateRuleDirection=n.ViewArea=n.DEFAULT_VIEW_NAME=void 0,n.DEFAULT_VIEW_NAME="defaultView",(a=e=n.ViewArea||(n.ViewArea={}))[a.colHeader=1]="colHeader",a[a.viewport=3]="viewport",(a=i=n.StateRuleDirection||(n.StateRuleDirection={}))[a.none=0]="none",a[a.row=1]="row",a[a.column=2]="column",a[a.both=3]="both",(a=r=n.RowColumnStates||(n.RowColumnStates={}))[a.hover=1]="hover",a[a.readonly=4]="readonly",a[a.active=16]="active",a[a.selected=32]="selected",a[a.dirty=64]="dirty",a[a.inserted=128]="inserted",a[a.updated=256]="updated",a[a.pin=1024]="pin",a[a.primaryKey=2048]="primaryKey",a[a.required=4096]="required",(a=o=n.RelationshipMap||(n.RelationshipMap={}))[a.OneToOne=0]="OneToOne",a[a.OneToMany=1]="OneToMany"},"./dist/src/interfaces/styleOptions.js":function(t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.s=void 0,n.s=0},"./dist/src/interfaces/validatorOptions.js":function(t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.v=void 0,n.v=0},"./dist/src/query.js":function(t,n,e){"use strict";var n,Y,Z,u,a,i,r,W;function _(t,n){var e,i,r,o,a;if(n&&0<(e=(0,Y.keys)(n)).length)for(i=0,r=e;i<r.length;i++)a=n[o=r[i]],t=t.replace(new RegExp("\\[@"+o+"\\]","g"),a.substring(1));return t}function Q(t){for(var n,e,n=[],e=0;e<t.length;e++)n[t[e]]=e;return n}function J(t,n){for(var e,i,r,o,a,u,s,c,f,l,h,d,e=[t],i=0;i<n;){for(r=0,o=e.length;r<o;r++)if((a=e.shift()).children)for(u=0,s=a.children;u<s.length;u++)c=s[u],e.push(c);i++}for(f=[],l=0,h=e;l<h.length;l++)f.push((d=h[l]).recordIndexes[0]);return{indexMap:f,queue:e}}function h(t,n,e){var i,t,i=t?n:e,t=t?e:n;return(0,Y.isNullOrUndefined)(i)&&(0,Y.isNullOrUndefined)(t)?0:(0,Y.isNullOrUndefined)(i)?-1:(0,Y.isNullOrUndefined)(t)?1:"number"==typeof i||i instanceof Date?i-t:t<i?1:i<t?-1:0}function o(t,n,u){for(var e,i,r,o,a,s,c,f,l,e=[t],i=0;i<n.length;){for(r=0,o=e.length;r<o;r++)if((a=e.shift()).sort(function(t,n){for(var e,i,r,o,a,e=0,i=0,r=u;i<r.length;i++)if(a=(o=r[i]).field,0===(e=h(o.ascending,t[a],n[a])))return e;return e}),i<n.length-1)for(s=n[i+1].field,c=0,f=a;c<f.length;c++)l=f[c],e.push(l[s]);i++}}function M(t,n,e,i){for(var r,o,a,u,s,c,r,o={},a=0,u=(0,Y.keys)(t);a<u.length;a++)s=u[a],-1!==e.indexOf(s)?(c=i(s))!==s&&(t[c]=t[s],delete t[s]):-1===n.indexOf(s)&&(o[s]=t[s],delete t[s]);return o}function C(t,n,e,i){for(var r,o,r=i;0<=r;r--)if(t[o=e[r].field]!==n[o])return;return 1}function s(y,w){var t,n;if(2<=w.length)for(t=function(e){for(var t,n,i,r,o,a,u,s,c,f,l,h,d,v,m,g,p,b,t=e===w.length-1?"$rows":w[e+1].field,n=[],i=w[e-1].field,r=w[e].field,o=w[e].summaryFields,a=o.map(function(t){return t.caption}),u=o.map(function(t){var n=(0,Z.Kue)(e);return t.caption+"_"+t.slice+n}),s=function(t){var n=(0,Z.Kue)(e);return n?t.substring(0,t.lastIndexOf(n)):t},c=0,f=y;c<f.length;c++)if(h=(l=f[c])[i],0!==n.length&&C(n[n.length-1],l,w,e-1)){for(M(l,a.concat(r,t),u,s),p=0,b=a;p<b.length;p++)g=b[p],n[n.length-1][g]+=l[g];n[n.length-1][r].push(l)}else{for((d=M(l,a.concat(r,t),u,s))[i]=h,v=0,m=a;v<m.length;v++)d[g=m[v]]=l[g];d[r]=[l],n.push(d)}y=n},n=w.length-1;0<n;n--)t(n);return y}function K(t,n,e,i){var i,r;n=s(n,e),i&&o(n,e,i),n&&0<n.length&&(t[r=(i=e[0]).caption||i.field]=n)}function X(t,n){var e,i,r,o,a,u,s,c,f,k,l,h,d,v,m,o,D,g,p,b,y,w,a,M,o,C,S,T,T,A,e={},i=[],o=t.select;if(o&&(a=o.fields,r=o.limit,a))for(u=0,s=a;u<s.length;u++)c=s[u],(0<=n.indexOf(c)||0<=c.indexOf("."))&&i.push({value:c}),e[c]=!0;if(f=[],k=t.calculate)for(d=l=(h=0,Y.keys)(k);h<d.length;h++)v=d[h],m=k[v],f.push({caption:v,value:m}),e[v]&&(delete e[v],e[m]=!0);if(o=t.groups,D=[],o)for(g=function(t){for(var n,c,e,i,r,f,o,a,u,s,l,h,d,v,m,g,p,b,y,w,M,C,S,T,A,S,I,x,N,T,n=[],c=[],e=void 0,i=void 0,r=[],f={},o,a=0,u=(0,Y.keys)(t);a<u.length;a++)for(l=t[s=u[a]],h=[s],v=h="="!==s[d=0]&&0<=s.indexOf(",")?s.split(","):h;d<v.length;d++){if(g={field:m=v[d],summaryFields:[],caption:l.caption},l.aggregate&&(g.summaryFields=l.aggregate.map(function(t){for(var n,e,i,r,o,a,u,s,n,o=0,a=(0,Y.keys)(t);o<a.length;o++)"having"===(u=a[o])?(s=_(t[u],k),c.push(s)):"sliceBy"===u?i=t[u]:(e=_(t[u],k),f[r=u]=!0);return{formula:e,slice:i,caption:r}})),p=l.calculate)for(w=b=(y=0,Y.keys)(p);y<w.length;y++)C=_(p[M=w[y]],k),r.push({caption:M,value:C});if((S=l.order)&&(e={field:T=(0,Y.keys)(S)[0],ascending:A="ASC"===S[T]}),i=l.includeDetailRows,S=l.attributes)for(I=0,x=S;I<x.length;I++)N=x[I],f[N]=!0;n.push(g),T=l.caption||m,f[T]=!0}D.push({groupByInfos:n,havingInfos:c,groupSortInfo:e,includeDetailRows:i,groupCalculateInfos:r,groupSelectFields:f})},p=0,b=o;p<b.length;p++)g(y=b[p]);if((a=t.where)&&(w=_(a,k)),M=[],o=t.orderBy)for(C=0,S=o;C<S.length;C++)A="ASC"===(T=S[C])[T=(0,Y.keys)(T)[0]],M.push({field:T,ascending:A});return{selectFields:e,relatedColumns:i,calculateColumns:f,limit:r,filterExpression:w,groupInfos:D,sortInfos:M}}function q(t,n,e,i,r,o,a,u,s){var c,f,l,h,d,c=[],f=s.length;if(0<=(a=void 0===a?0:a))for(h=(l=0)===a?f:Math.min(a,f);l<h;l++)c.push((0,Z.Jue)(t,n,e,i,r,s[l],o,!0,!0,u));else for(l=f-1,d=Math.max(0,f+a);d<=l;l--)c.push((0,Z.Jue)(t,n,e,i,r,s[l],o,!0,!0,u));return c}function $(t){for(var n,e,n=[],e=0;e<t;e++)n[e]=e;return n}function tt(t){var n,e,i,r,r;if(0===t.length)return"";if(1===t.length)return t[0];for(n=[],e=0,i=t;e<i.length;e++)r="="===(r=i[e])[0]?r.slice(1):r,n.push(r);return"=AND("+n.join(",")+")"}function nt(t,n,e){var i,r,o,a,u,i=[],r=0;if("string"==typeof n)for(o=t.Ywt(n,0,0),a=0;a<e.length;a++)u=e[a],!0===t.nMt(o,u,0)&&(i[r]=u,r++);return i}function et(e,t,n,i,r){var o=(0,a.Xue)(e,t,n,r,i);r.sort(function(t,n){return o(e,i,t,n)})}function c(t,n){var t=new i.FieldManager(W,t);return n=t.prepareFields(n),{fieldMgr:t,columnInfos:n}}function f(t,n){var t=t.POt;return new r.GroupManager(n,t.wEt.bind(t))}function it(t,n,e,i){var i,r,i,t,o,e,a,e,i=c(t,i),r=i.fieldMgr,i=i.columnInfos,t=f(t,n),o=r.buildGroupFields(n,e),e=t.groupBy(o,e),a=e.rootNode,e=e.indexMap;return r.transposeSliceFields(o),{rootNode:a,newIndexMap:e,fieldMgr:r,groupMgr:t,columnInfos:i=(0,u.que)(i,r,n)}}Object.defineProperty(n,"__esModule",{value:!0}),n=e("./dist/src/dataManager.js"),Y=e("./dist/src/dataSource/utils.js"),Z=e("./dist/src/view/view.js"),u=e("./dist/src/view/view-group.js"),a=e("./dist/src/view/view-sort.js"),i=e("./dist/src/viewField/fieldManager.js"),r=e("./dist/src/viewField/groupManager.js"),W=void 0,n.DataManager.prototype.query=function(t){var n,e,i,r,o,B,t,a,u,s,c,f,l,h,d,v,m,g,p,L,b,t,F,P,G,y,w,M,C,S,T,A,w,I,x,N,k,D,U,_,N,I,H,E,x,N,D,k,j,O,R,z,V,C,n=this,e=n.tables[t.tableName];if(e){if(i=!1,t.unpivot&&(i=!0,e._dataSource.$ue=e._dataSource._data,e.fetchSync(t.unpivot)),r=$(e.length()),o=(0,Z.tse)(e),a=(t=X(t,B=n.relationships.filter(function(t){return t.sourceTable.name===e.name}).map(function(t){return t.sourceRelationshipName}))).selectFields,u=t.relatedColumns,s=t.calculateColumns,c=t.limit,f=t.filterExpression,l=t.groupInfos,h=t.sortInfos,0<u.length)for(d=0,v=u;d<v.length;d++)m=v[d],o.push(m);if(0<s.length)for(g=0,p=s;g<p.length;g++)L=p[g],o.push(L);if(f&&(r=nt(e,f,r)),h&&0<h.length&&l.length<=0&&et(e,o,W,h,r),b={},0<(0,Y.keys)(a).length&&(t=q(e,o,W,W,W,a,c,!1,r))&&0<t.length&&(b.$r=t),0<l.length)for(F=Q(r),P=r.slice(0),G=o.slice(0),y=0;y<l.length;y++){if(M=(w=l[y]).groupByInfos,C=w.groupSelectFields,S=w.groupCalculateInfos,T=w.havingInfos,A=w.groupSortInfo,w=w.includeDetailRows,x=(I=it(e,M,r,o)).rootNode,N=I.newIndexMap,k=I.fieldMgr,D=I.groupMgr,r=N,o=U=I.columnInfos,0<(_=void 0,Y.keys)(C).length){if(I=(N=J(x,M.length)).indexMap,H=N.queue,_=q(e,o,D,k,M,C,0,!0,r=I),w&&b.$r)for(E=0;E<_.length;E++)_[E].$rows=H[E].recordIndexes.map(function(t){return F[t]});if(x=void 0,A?x=[A]:h&&0<h.length&&(x=h),0<S.length||0<T.length||x){for(N=e.name+"_VirtualTable1",(D=n.addTable(N,{data:_})).fetchSync(),k=$(D.length()),j=(0,Z.tse)(D),O=0,R=S;O<R.length;O++)z=R[O],j.push(z);0<T.length&&(k=nt(D,V=tt(T),k)),C=q(D,j,W,W,W,W,0,!1,k),n.removeTable(D.name),K(b,C,M,x)}else K(b,_,M)}r=P,o=G}return i&&(e._dataSource._data=e._dataSource.$ue,e.fetchSync(W,!0)),b}}},"./dist/src/relationship.js":function(t,n,e){"use strict";var i,f,r,o;function a(t,n,e,i,r,o){this.sourceTable=t,this.sourceFieldName=n,this.sourceRelationshipName=e,this.targetTable=i,this.targetFieldName=r,this.targetRelationshipName=o,e&&(this.sourceField=t.xOt(n,e,i,r,this)),o&&(this.targetField=i.xOt(r,o,t,n,this))}Object.defineProperty(n,"__esModule",{value:!0}),n.Relationship=void 0,i=e("./dist/src/interfaces/interface.js"),f=e("./dist/src/dataSource/utils.js"),r=void 0,a.prototype.NOt=function(t){return t===this.targetRelationshipName},a.prototype.VP=function(){this.sourceTable&&this.sourceTable.kOt(this),this.targetTable&&this.targetTable.kOt(this)},a.prototype.DOt=function(t){return this.relationshipMap===i.RelationshipMap.OneToMany&&t===this.sourceRelationshipName?i.RelationshipMap.OneToOne:this.relationshipMap},a.prototype._Ot=function(){var t,n,t=this.sourceTable,n=this.sourceFieldName;if(t.EOt())return t.jOt(n)&&!t.OOt()?i.RelationshipMap.OneToOne:i.RelationshipMap.OneToMany},a.prototype.ROt=function(t){var n=this.relationshipMap;return(0,f.isNullOrUndefined)(n)&&(n=this.relationshipMap=this._Ot()),(0,f.isNullOrUndefined)(n)?t:n===i.RelationshipMap.OneToOne?{uit:"object"}:{uit:"array"}},a.prototype.BOt=function(){var e,i,r,t,o,n,a,u,s;function c(t,n,e){t[n]?(t[n].push(e),t.uit="array"):t[n]=[e]}for(e=this.sourceField.LOt={uit:"object"},i=this.targetField.LOt=this.ROt({}),r=this.ROt({uit:"object"}),t=this.sourceTable.getDataSync(),o=this.targetTable.getDataSync(),n=0;n<t.length;n++)a=t[n][this.sourceFieldName],(0,f.isNullOrUndefined)(a)||c(r,a,n);for(u=function(n){var t=o[n][s.targetFieldName];(0,f.isNullOrUndefined)(t)||r[t]&&(i[n]=r[t],r[t].forEach(function(t){c(e,t,n)}))},s=this,n=0;n<o.length;n++)u(n);this.targetField.type=r.uit,this.sourceField.type=e.uit},a.prototype.dl=function(){this.sourceField.LOt=r,this.targetField.LOt=r,this.targetTable.FOt(),this.sourceTable.FOt()},n.Relationship=a},"./dist/src/table/calcField.js":function(t,n,e){"use strict";var i,r,o,a,u,s;function c(t,n){var e,i,e=s.call(this)||this;e.calcSource=n.POt,e.calcService=e.calcSource.getCalcService(),e.GOt=t;try{i=e.expression=e.calcService.parse(e.calcSource,t,0,0),e.calcService&&i&&(e.w3=e.calcService.getGlobalSourceModel(),e.w3.cyt(e,0,0,i,i,!0))}catch(t){}return e.Tl=[],e}i=this&&this.__extends||(u=function(t,n){return(u=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(t,n){t.__proto__=n}:function(t,n){for(var e in n)Object.prototype.hasOwnProperty.call(n,e)&&(t[e]=n[e])}))(t,n)},function(t,n){if("function"!=typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function e(){this.constructor=t}u(t,n),t.prototype=null===n?Object.create(n):(e.prototype=n.prototype,new e)}),Object.defineProperty(n,"__esModule",{value:!0}),n.CalcField=void 0,r=e("CalcEngine"),o=e("./dist/src/dataSource/utils.js"),s=r.BaseCalc,i(c,s),c.prototype.getKey=function(){var t=this;return"T:"+t.calcSource.nM.name+":"+t.GOt},c.prototype.vyt=function(){this.c_t().I3(this,3)},c.prototype.c_t=function(){return this.calcService},c.prototype.P6t=function(){this.C8()},c.prototype.C8=function(){this.Tl=[]},c.prototype.getValue=function(t){var n;return this.expression?(n=this.Tl[t],(0,o.isUndefined)(n)&&(this.calcSource.pe(t),n=this.Tl[t]=this.calcService.evaluateExpression(this.calcSource,this.expression,{row:t,col:0})),n):"Invalid Formula"},c.prototype.getValues=function(t,n){for(var e,i,r,e=[],i=n=n||0,r=t.length;i<r;i++)e.push(this.getValue(t[i]));return e},n.CalcField=c},"./dist/src/table/hierarchyField.js":function(t,n,e){"use strict";var i,r,o,a;function u(t,n){this.GOt=t,this.nM=n,this.UOt=new r.CalcField(this.l7t(),n),this.HOt=new o.TableField(t,n)}Object.defineProperty(n,"__esModule",{value:!0}),n.HierarchyField=void 0,i=e("./dist/src/dataSource/utils.js"),r=e("./dist/src/table/calcField.js"),o=e("./dist/src/table/tableField.js"),u.prototype.getKey=function(){return this.UOt.getKey()},u.prototype.vyt=function(){this.UOt.vyt()},u.prototype.c_t=function(){return this.UOt.c_t()},u.prototype.P6t=function(){this.C8()},u.prototype.l7t=function(){return this.nM.isHierarchy()?this.nM._dataSource.l7t(this.GOt):void 0},u.prototype.C8=function(){var t=this.l7t();(0,i.isNullOrEmpty)(t)?this.UOt=null:(0,i.isNullOrUndefined)(this.UOt)||t!==this.UOt.GOt?this.UOt=new r.CalcField(t,this.nM):this.UOt.C8(),this.HOt=new o.TableField(this.GOt,this.nM)},u.prototype.zOt=function(t){var n,n,n=this.nM;if(n.isHierarchy())return n=n.SEt(t),!(0,i.isNullOrUndefined)(n)&&0<n.children.length},u.prototype.getValue=function(t){return(!(0,i.isNullOrUndefined)(this.UOt)&&this.zOt(t)?this.UOt:this.HOt).getValue(t)},u.prototype.getValues=function(t,n){for(var e,i,r,e=[],i=n=n||0,r=t.length;i<r;i++)e.push(this.getValue(t[i]));return e},u.prototype.setValue=function(t,n){return this.HOt.setValue(t,n)},u.prototype.setItemValue=function(t,n,e,i){this.HOt.setItemValue(t,n,e,i)},u.prototype.hasItem=function(t){this.HOt.hasItem(t)},u.prototype.insertItem=function(t,n){this.HOt.insertItem(t,n)},u.prototype.getOriginalValue=function(t){return this.HOt.getOriginalValue(t)},u.prototype.getRelatedTable=function(){return this.HOt.getRelatedTable()},u.prototype.getRelationMaps=function(){return this.HOt.getRelationMaps()},u.prototype.getHostTableIndexes=function(t){return this.HOt.getHostTableIndexes(t)},n.HierarchyField=u},"./dist/src/table/table.entry.js":function(t,n,e){"use strict";var i,r,i=this&&this.__createBinding||(Object.create?function(t,n,e,i){void 0===i&&(i=e);var r=Object.getOwnPropertyDescriptor(n,e);r&&("get"in r?n.__esModule:!r.writable&&!r.configurable)||(r={enumerable:!0,get:function(){return n[e]}}),Object.defineProperty(t,i,r)}:function(t,n,e,i){t[i=void 0===i?e:i]=n[e]}),r=this&&this.__exportStar||function(t,n){for(var e in t)"default"===e||Object.prototype.hasOwnProperty.call(n,e)||i(n,t,e)};Object.defineProperty(n,"__esModule",{value:!0}),r(e("./dist/src/table/tableEvents.js"),n),r(e("./dist/src/table/table.js"),n)},"./dist/src/table/table.js":function(t,n,e){"use strict";var i,r,p,o,a,s,u,c,f,l,h,d;function v(t,n,e){var i={syncDone:!1,asyncCount:0,args:void 0,succeededArgs:void 0,failedArgs:void 0,onSucceeded:t,onFailed:n,onEnd:e,invoke:function t(){0===i.asyncCount&&i.syncDone&&(i.failedArgs?i.onFailed&&i.onFailed(i.failedArgs):i.onSucceeded&&i.onSucceeded(i.succeededArgs),i.onEnd)&&i.onEnd(i.succeededArgs||i.failedArgs)},execute:function t(n){n&&(i.onEnd=n),i.syncDone=!0,i.invoke()},suspend:function t(){return i.asyncCount++,{succeed:function t(n){i.succeededArgs=n,i.resume()},fail:function t(n){i.failedArgs=n,i.resume()}}},resume:function t(){i.asyncCount--,i.invoke()}};return i}function m(t,n){var e,i,r,o;for(e in t)if(t.hasOwnProperty(e))for(r in i=t[e],n)if(n.hasOwnProperty(r)&&i===(o=n[r])&&i.rb)return!0}function g(t,n){return m(n.views,t.VOt)}function b(t,n,e,i){var r,o,a,u,s,c,f;if(0!==n){for(a=e&&e.dataType,u=e&&e.dataMap,s=!!a,c=0;c<n;c++)f=i(c),u&&!(0,p.isNullOrUndefined)(u[f])&&(f=u[f]),s||(0,p.isNullOrUndefined)(f)||(o=f,s=!0),(r=r||{})[f=f instanceof Date?f.toISOString():f]||(r[f]=[]),r[f]&&r[f].push(c);return r.K$=a||(s?typeof o:"object"),r}}function y(t,n,e,i){var r,o,a,a,u;for(r in t)t.hasOwnProperty(r)&&(o=t[r],a=(a=i&&i[r])&&a.dataMap,o)&&(u=e[r],o[u=(u=a&&!(0,p.isNullOrUndefined)(a[u])?a[u]:u)instanceof Date?u.toISOString():u]?o[u].push(n):o[u]=[n])}function w(t,n,e,i,r,o){var t,e,o,t=t[e],e=o&&o.dataMap;t&&r!==i&&(e&&((0,p.isNullOrUndefined)(e[i])||(i=e[i]),(0,p.isNullOrUndefined)(e[r])||(r=e[r])),i instanceof Date&&(i=i.toISOString()),r instanceof Date&&(r=r.toISOString()),o=t[i])&&(1<o.length?o.splice(o.indexOf(n),1):delete t[i],t[r]?t[r].push(n):t[r]=[n])}function M(t,n,e){var i,r,o,a,u;for(i in t)if(t.hasOwnProperty(i)&&(r=t[i]))for(o in r)if(r.hasOwnProperty(o)&&(0,p.isArray)(r[o])&&(a=r[o],(0,p.isArray)(a))){for(u=0;u<a.length;u++)a[u]>=n+e?a[u]-=e:a[u]>=n&&a[u]<n+e&&(a.splice(u,1),u--);0===a.length&&delete r[o]}}function C(t,n){var t;this.YOt={},this.ZOt={},this.WOt=0,Object.defineProperty(this,"name",{get:function(){return this.Zc},set:function(t){var n,e,i,r,e,n=this.Zc;if(this.Zc=t,e=this.QOt){for(i in this.VOt)this.VOt.hasOwnProperty(i)&&(r=this.VOt[i]).KOt(n,t);delete(e=e.tables)[n],e[t]=this}}}),Object.defineProperty(this,"options",{get:function(){return this._dataSource.options},set:function(t){this.JOt=!0,this._dataSource.options=t}}),this.name=t,t=n instanceof i.DataSource?n:new i.DataSource(n),this._dataSource=t,this.views={},this.VOt={},this.Pq=[],this.XOt={},this.qOt=[],this.JOt=!0,this.aT={}}function S(t){var n,t,e,i,n={data:t.data,remote:t.remote,autoSync:t.autoSync,batch:t.batch,schema:t.schema},t=t.remote;return t&&(e=n.remote={},(i=t.read)&&!(0,p.isFunction)(i)&&(e.read=i),(i=t.create)&&!(0,p.isFunction)(i)&&(e.create=i),(i=t.update)&&!(0,p.isFunction)(i)&&(e.update=i),(i=t.delete)&&!(0,p.isFunction)(i)&&(e.delete=i),i=t.batch)&&!(0,p.isFunction)(i)&&(e.batch=i),n}Object.defineProperty(n,"__esModule",{value:!0}),n.Table=n.updateFilterIndexesCacheOnRemove=n.updateFilterIndexesCacheOnUpdate=n.updateFilterIndexesCacheOnInsert=n.generateFilterIndexCache=void 0,i=e("./dist/src/dataSource/dataSource.js"),r=e("./dist/src/calculation/calcSource.js"),p=e("./dist/src/dataSource/utils.js"),o=e("./dist/src/view/view.js"),a=e("./dist/src/interfaces/interface.js"),s=e("./dist/src/table/tableEvents.js"),u=e("./dist/src/table/calcField.js"),c=e("./dist/src/table/tableField.js"),f=e("./dist/src/table/hierarchyField.js"),l=null,h=void 0,n.generateFilterIndexCache=b,n.updateFilterIndexesCacheOnInsert=y,n.updateFilterIndexesCacheOnUpdate=w,n.updateFilterIndexesCacheOnRemove=M,C.prototype._Et=function(t,n,e){var i,r,n;"="===(n=!(0,p.isNullOrUndefined)(n)&&""!==n?n:"*")[0]?(i=this.bEt(n)).Iwt(0,t,e):(r=(r=this.aT[n])||(this.aT[n]={}),n=t.getKey(),e?r[n]=t:delete r[n])},C.prototype.o_t=function(t){var n,e,n=function(t){for(var n in t)t.hasOwnProperty(n)&&t[n].vyt()};if((0,p.isNullOrUndefined)(t))for(e in this.aT)this.aT[e]&&n(this.aT[e]);else-1<t.indexOf(".")&&(t=t.split(".")[0]),n(this.aT[t]),n(this.aT["*"])},C.prototype.REt=function(t){var n,e;if(this.QOt=t)this.POt=new r.DataManagerCalcSource(t.Lp,this);else for(n in this.POt=l,this.VOt)this.VOt.hasOwnProperty(n)&&(e=this.VOt[n]).$Ot(this)},C.prototype.Ywt=function(t,n,e){var i=this.POt;return i.getCalcService().parse(i,t,n||0,e||0)},C.prototype.nMt=function(t,n,e){var i=this.POt;return i.pe(n),i.getCalcService().evaluateExpression(i,t,{row:n||0,col:e||0})},C.prototype.kfe=function(t,n,e){var i=this.POt;return i.pe(n,h,e),i.getCalcService().evaluateExpression(i,t,{row:n||0,col:0})},C.prototype.getDataSync=function(t){return this._dataSource.tOt(t)},C.prototype.NEt=function(t,n){var e,i,r,o,a,u,e=this;if(t){if(0<=t.indexOf(e))return l}else{if(e.tRt)return e.tRt;i=!0,t=[],n=[]}for(t.push(e),n.push(new Promise(function(t){if(e.JOt)return e.fetch().then(t);t(null)})),r=e.Pq,o=0;o<r.length;o++)(u=(a=r[o]).targetTable)&&u.NEt(t,n);if(i)return e.tRt=Promise.all(n),e.tRt},C.prototype.fetch=function(n){var e,i,r,e=this;return e.BEt&&(i=e.columns),r=e.length(),e._dataSource.load({reload:n}).then(function(t){return e.nse(r,i,n),Promise.resolve(t)})},C.prototype.cPt=function(t){var n,e,i,r,o,a,u,s,n=this,e={};if(t&&(i=n.columns))for(a=r=(o=0,p.keys)(i);o<a.length;o++)(s=i[u=a[o]]).value&&"="===s.value[0]&&(e[u]=s);return e},C.prototype.nse=function(t,e,n){var i,r,o,o,a,u,s,c,f,l,h,i=this,r=i._dataSource.options.schema;if((i.JOt||n)&&(o=i.get(0),(o=(0,p.isNullOrUndefined)(o)&&r&&r.columns?r.columns:o)&&(o=(0,p.keys)(o),a=i.columns=i.cPt(!0),u=i.Pq,o.forEach(function(t){var n=e&&e[t];a[t]=i.nRt(t,n),u.push({name:t})})),i.JOt=!1),n&&i.ARt(),r&&r.columns){for(f in c=[],s=r.columns)s[f]&&s[f].indexed&&c.push(f);i.eRt(c)}if(n&&i.clearIndexes(),i.createIndexes(i.qOt),i.BEt=!1,i.dl(),n)for(h in i._dataSource.pOt(),l=i.views)l.hasOwnProperty(h)&&l[h].iM(t!==i.length())},C.prototype.fetchSync=function(t,n){var e,i,n,e=this,i=e.length(),n=e._dataSource.loadSync(t,n);return e.nse(i,h,!(0,p.isNullOrUndefined)(t)),n},C.prototype.nRt=function(t,n){var o,e,i,r,o=this,e={name:t,value:t,jOt:!1};if(!(0,p.isNullOrUndefined)(n)){for(r in n.value=void 0,n.name=void 0,n)n.hasOwnProperty(r)&&!(0,p.isNullOrUndefined)(n[r])&&(e[r]=n[r]);i=n.W5,delete n.W5,n.jOt&&(e.jOt=n.jOt)}return Object.defineProperty(e,"dataType",{get:function(){return i},set:function(t){var t;i!==t&&("rowOrder"!==i&&"rowOrder"!==t||!o.isHierarchy()||o.setHierarchyOptionChanged(),i=t,o._dataSource.xjt(this.name,this.dataType,this.dataPattern),t=this.value,o.dl(t),o.rRt(t))}}),Object.defineProperty(e,"isPrimaryKey",{get:function(){return this.jOt},set:function(t){this.jOt!==t&&(this.jOt=t,o.qOt.slice().sort().join(",")!==o.Ljt(!0).slice().sort().join(","))&&o.createIndexes(o.qOt)}}),Object.defineProperty(e,"mappedName",{get:function(){return this.value},set:function(n){var e;this.value===n||(0,p.isNullOrEmpty)(n)||(e=this.value,o._dataSource.Njt(e,n),o.dl(e),o.rRt(n),o.oRt(e,n),o.aRt(e,n),o.Pq.forEach(function(t){t.name===e&&(t.name=n)}),o.qOt=o.qOt.map(function(t){return t===e?n:t}),o.columns[n]=o.columns[e],delete o.columns[e],this.name=this.value=n)}}),Object.defineProperty(e,"relationship",{get:function(){for(var t,n,e,i,t,n=0,e=o.QOt.relationships;n<e.length;n++){if((i=e[n]).sourceTable===o&&i.sourceFieldName===this.value)return{table:i.targetTable,field:i.targetFieldName,sourceName:i.sourceRelationshipName,targetName:i.targetRelationshipName};if(i.targetTable===o&&i.targetFieldName===this.value)return{table:i.sourceTable,field:i.sourceFieldName,sourceName:i.sourceRelationshipName,targetName:i.targetRelationshipName}}},set:function(t){for(var n,e,i,r,n,e=0,i=o.QOt.relationships;e<i.length;e++)if((r=i[e]).sourceRelationshipName===t.sourceName){o.QOt.removeRelationship(r.sourceRelationshipName);break}t.table&&t.field&&o.QOt.addRelationship(o,this.value,t.sourceName,t.table,t.field,t.targetName)}}),e},C.prototype.length=function(){return this._dataSource.length()},C.prototype.getDirtyIndexes=function(){return this._dataSource.getDirtyIndexes()},C.prototype.isInserted=function(t){return this._dataSource.isInserted(t)},C.prototype.isUpdated=function(t){return this._dataSource.isUpdated(t)||this.uRt(t)},C.prototype.getErrorInfo=function(t){return this._dataSource.getErrorInfo(t)},C.prototype.uRt=function(t){var n,e,i,r,o,r,a,u,s,n=this,e=n.Pq;for(n.WOt++,i=0;i<e.length;i++)if(o=(r=e[i]).targetTable,r=r.LOt,o&&g(o,n)&&r&&r[t]&&!o.WOt)for(a=0,u=r[t];a<u.length;a++)if(s=u[a],o.isUpdated(s))return n.WOt--,!0;n.WOt--},C.prototype.insertItem=function(n,e,i,t){var r,o,r=this,o={index:n,data:e};this.ki(s.Events.ItemInserting,o),this._dataSource.insertItem(n,e,function(t){r.sRt(n,e),r.cRt(n,e),r.dl(),r.ki(s.Events.ItemInserted,o),i&&i(t)},t)},C.prototype.updateItem=function(t,n,e,i){this._dataSource.updateItem(t,n,e,i)},C.prototype.fRt=function(n,e,i,r,o,a){var u=this;return function(t){u.lRt(n,e,i),u.hRt(n,r,e,i),u.dl(),u.ki(s.Events.ItemUpdated,o),a&&a(t)}},C.prototype.dRt=function(t,n,e,i,r,o){var a,u,a=n[e],u={index:t,data:n,field:e,originalValue:i,newValue:a};this.ki(s.Events.ItemUpdating,u),this._dataSource.updateItem(t,n,this.fRt(t,i,a,e,u,r),o)},C.prototype.updateItemValue=function(t,n,e,i,r){var o,a,u,u,a=this._getValueByField(n,t),u=this.vRt(t);u[n]=e,this.ki(s.Events.ItemUpdating,u={index:t,data:u,field:n,originalValue:a,newValue:e}),this._dataSource.updateItemValues(t,((o={})[n]=e,o),this.fRt(t,a,e,n,u,i),r)},C.prototype.resetItem=function(n,t,e){var i,t,e,r,e,o,a,i=this,t=v(t,e);this.mRt(n,t.suspend),this._dataSource.isUpdated(n)&&(e=t.suspend(),r=e.succeed,e=e.fail,o=this.vRt(n),a=this.gRt(n),this.ki(s.Events.ItemResetting,{index:n}),this._dataSource.resetItem(n,function(t){i.pRt(n,o,a),i.dl(),i.ki(s.Events.ItemReset,{index:n,originalData:o,dataBeforeChanged:a}),r(t)},e)),t.execute()},C.prototype.pRt=function(t,n,e){var i,r,o,a,a,i=this,r=i.columns;if(!(0,p.isNullOrUndefined)(n)&&!(0,p.isNullOrUndefined)(e))for(o in r)r.hasOwnProperty(o)&&(a=(a=r[o]).value instanceof Function?a.value.name:a.value,i.hRt(t,a,n[a],e[a]))},C.prototype.mRt=function(s,c){var f,l,t,n,f=this,l=f.Pq;for(f.WOt++,t=function(t){var t,i,t,n,e,r,o,a,u,a,t=l[t],i=t.targetTable,t=t.LOt;if(i&&g(i,f)&&t&&t[s]&&!i.WOt){for(n=[],e=0,r=t[s];e<r.length;e++)o=r[e],i.isInserted(o)?n.push(o):i.isUpdated(o)&&(u=(a=c()).succeed,a=a.fail,i.resetItem(o,u,a));0<n.length&&(n.sort(function(t,n){return n-t}),n.forEach(function(t){var n=c(),e=n.succeed,n=n.fail;i.qCt(t,1,e,n)}))}},n=0;n<l.length;n++)t(n);f.WOt--},C.prototype.saveItem=function(n,t,e){var i,t,e,r,e,r,o,e,i=this,t=v(t,e),e=t.suspend(),r=e.succeed,e=e.fail;this.bRt(n,r,e),(this._dataSource.isUpdated(n)||this._dataSource.isInserted(n))&&(r=t.suspend(),o=r.succeed,e=r.fail,this.ki(s.Events.ItemSaving,{index:n}),this._dataSource.saveItem(n,function(t){i.dl(),i.ki(s.Events.ItemSaved,{index:n}),o(t)},e)),t.execute()},C.prototype.bRt=function(t,n,e){var n,i,r,o,a,u,s,u,c,f,l,h,d,h,n=v(n,e),i=n.suspend,r=this,o=r.Pq;for(r.WOt++,a=0;a<o.length;a++)if(s=(u=o[a]).targetTable,u=u.LOt,s&&g(s,r)&&u&&u[t]&&!s.WOt)for(c=0,f=u[t];c<f.length;c++)l=f[c],(s.isUpdated(l)||s.isInserted(l))&&(d=(h=i()).succeed,h=h.fail,s.saveItem(l,d,h));n.execute(function(){return r.WOt--})},C.prototype.get=function(t){return this._dataSource.get(t)},C.prototype.remove=function(t,n,e,i){var r,o,a,u,a,r=this;void 0===n&&(n=1),u=(a=(o=v(function(){r.qCt(t,n,e,i)},i)).suspend()).succeed,a=a.fail,this.yRt(t,n,u,a),o.execute()},C.prototype.qCt=function(n,e,i,t){var r,o,r=this,o={index:n,count:e};this.ki(s.Events.ItemRemoving,o),this._dataSource.remove(n,e,function(t){r.wRt(),r.MRt(n,e),r.ki(s.Events.ItemRemoved,o),i&&i(t)},t)},C.prototype.yRt=function(s,c,t,n){var t,f,e,l,i,r,t=v(t,n),f=t.suspend,e=this,l=e.Pq;for(e.WOt++,i=function(t){var t,i,n,e,n,t,n,r,o,a,u,t=l[t],i=t.targetTable,n=t.CRt,e=t.LOt;if(i&&n.NOt(t.name)&&e&&e[s]&&!i.WOt){for(t=(n=f()).succeed,n=n.fail,r=[],o=void 0,a=function(t){var n=e[s+t];r=r.concat(Object.keys(n).map(function(t){return n[t]}))},u=0;u<c;u++)a(u);r.sort(function(t,n){return n-t}),o=r.map(function(e){return function(t,n){i.remove(e,1,t,n)}}),(0,p.promiseSerialExecute)(o).then(t).catch(n)}},r=0;r<l.length;r++)i(r);t.execute(function(){return e.WOt--})},C.prototype.getChanges=function(){return this._dataSource.getChanges()},C.prototype.isDataLengthChanged=function(){return this._dataSource.isDataLengthChanged()},C.prototype.submitChanges=function(t,i,r){var o=this;return new Promise(function(n,e){o.SRt(t,function(t){n(t),i&&i(t)},function(t){e(t),r&&r(t)})})},C.prototype.SRt=function(i,n,e){var r,t,o,a,o,r=this,t=v(function(){r.wRt(),r.ki(s.Events.ChangesSubmitting,h),r._dataSource.submitChanges(function(t,n,e){i?i(t,n,e):r.ki(s.Events.ChangesSubmittedRowFailed,{index:t,reason:n,type:e})}).then(function(t){r.ki(s.Events.ChangesSubmitted,t),n(t)}).catch(function(t){e(t)})}),o=t.suspend(),a=o.succeed,o=o.fail;this.TRt(a,o),t.execute()},C.prototype.TRt=function(t,n){var t,e,i,r,o,a,u,a,a,s,a,t=v(t,n),e=t.suspend,i=this,r=i.Pq;for(i.WOt++,o=0;o<r.length;o++)u=(a=r[o]).targetTable,a=a.LOt,u&&a&&!u.WOt&&(s=(a=e()).succeed,a=a.fail,u.submitChanges(h,s,a));t.execute(function(){return i.WOt--})},C.prototype.cancelChanges=function(n,t){var e,i,e=this,i=v(function(){var t={isDataLengthChanged:e.isDataLengthChanged()};e.ki(s.Events.ChangesCancelling,h),e._dataSource.cancelChanges(),e.wRt(),e.ARt(),e.ki(s.Events.ChangesCancelled,t),n&&n(h)});this.IRt(i.suspend),i.execute()},C.prototype.IRt=function(t){var n,e,i,r,o,r,r,a,r,n=this,e=n.Pq;for(n.WOt++,i=0;i<e.length;i++)o=(r=e[i]).targetTable,r=r.LOt,o&&r&&!o.WOt&&(a=(r=t()).succeed,r=r.fail,o.cancelChanges(a,r));n.WOt--},C.prototype.xRt=function(t){return t instanceof u.CalcField||t instanceof f.HierarchyField},C.prototype.NRt=function(){var t,e,n,i,r,o,t=this.options.schema.hierarchy.column,e=[new RegExp("(\\[@)(".concat(t,")\\]|(PARENT)|(CHILDREN)|(ONLYCHILDREN)|(LEVEL)|(LEVELROWNUMBER)"))];for(n in this.XOt)Object.prototype.hasOwnProperty.call(this.XOt,n)&&(i=this.XOt[n])instanceof f.HierarchyField&&(i.C8(),e.push(new RegExp("(\\[@)(".concat(i.GOt,")\\]"))));for(n in r=function(t){var n;Object.prototype.hasOwnProperty.call(o.XOt,t)&&(n=o.XOt[t])instanceof u.CalcField&&e.some(function(t){return t.test(n.GOt)})&&n.C8()},(o=this).XOt)r(n)},C.prototype.FOt=function(){var t,n;for(t in this.XOt)Object.prototype.hasOwnProperty.call(this.XOt,t)&&(n=this.XOt[t],this.xRt(n)?n.C8():this.XOt[t]=h)},C.prototype.dl=function(t,n){var e,i,r;if(t){for(e=this.XOt[t],this.xRt(e)?e.C8():this.XOt[t]=h,i=0;i<this.Pq.length;i++)if(t===(r=this.Pq[i]).name||t===r.sourceField)return void(r.LOt&&r.CRt.dl())}else for(this.FOt(),i=0;i<this.Pq.length;i++)(r=this.Pq[i]).CRt&&r.CRt.dl()},C.prototype.primaryKey=function(t){var t,n,e,i,r,o,a,u,s,c;if(0===arguments.length)return 0===this.qOt.length&&(this.Ljt(),this.createIndexes(this.qOt)),this.qOt.join(",");if(!(0,p.isNullOrUndefined)(t)&&(this.qOt=this.qOt.concat(t.split(",")),t=this._dataSource.options.schema,!(0,p.isNullOrUndefined)(t))){for(i in e=[],n=t.columns=t.columns||{})Object.prototype.hasOwnProperty.call(n,i)&&(r=n[i]).isPrimaryKey&&e.push(i);if(0===e.length)this.qOt.forEach(function(t){n[t]=n[t]||{},n[t].isPrimaryKey=!0});else{for(o=0;o<e.length;o++)this.columns[a=e[o]]&&(this.columns[a].isPrimaryKey=!0);for(u=this.qOt.slice().sort(),e.sort(),s=e,c=0;c<u.length||c<s.length;c++)if(u[c]!==s[c])return void(this.qOt=s)}}},C.prototype.getIndexes=function(){return(0,p.keys)(this.YOt)},C.prototype.kRt=function(){return(0,p.keys)(this.ZOt)},C.prototype.createIndexes=function(t){for(var n,e,i,r,n=this.YOt,e=0,i=t;e<i.length;e++)n[r=i[e]]||(n[r]=this.DRt(r))},C.prototype.eRt=function(t,n){for(var e,i,r,o,e=this.ZOt,i=0,r=t;i<r.length;i++)e[o=r[i]]&&!n||(e[o]=this._Rt(o))},C.prototype.dropIndexes=function(t){for(var n,e,i,r,n=this.YOt,e=0,i=t;e<i.length;e++)n[r=i[e]]&&delete n[r]},C.prototype.clearIndexes=function(){this.YOt={}},C.prototype.oRt=function(t,n){var e=this.YOt;(0,p.isNullOrUndefined)(e[t])||(e[n]=e[t],delete e[t])},C.prototype.ARt=function(){this.ZOt={}},C.prototype.aRt=function(t,n){var e=this.ZOt;(0,p.isNullOrUndefined)(e[t])||(e[n]=e[t],delete e[t])},C.prototype.wRt=function(){this.dl();var t=this.getIndexes();this.clearIndexes(),this.createIndexes(t)},C.prototype.ERt=function(){var t=this.kRt();this.ARt(),this.eRt(t)},C.prototype.DRt=function(t){for(var n,e,i,r,o,e=this.length(),i=0;i<e;i++)(n=n||{})[o="string"!=typeof(o=(r=this.get(i))[t])?String(o):o]||(n[o]=[]),n[o]&&n[o].push(i);return n},C.prototype._Rt=function(n){var e=this;return b(n,this.length(),this.jRt(n),function(t){return e._getValueByField(n,t)})},C.prototype.ORt=function(t){return!!this.YOt[t]},C.prototype.search=function(t,n){if(!(0,p.isNullOrUndefined)(t)&&!(0,p.isNullOrUndefined)(n))return(0,p.isString)(t)||(t=String(t)),this.ORt(n)?this.RRt(t,n):this.BRt(t,n)},C.prototype.mEt=function(t){var e,n,i,r,o,a,e=this.primaryKey().split(",");if(0===e.length||!this.YOt[e[0]])return[];if(1===e.length)return this.YOt[e[0]][t];if((t=t.split("|")).length!==e.length)return[];for(n=0;n<t.length;n++)t[n]=t[n].trim();for(i={},r={},this.YOt[e[0]][t[0]].forEach(function(t){i[t]=1}),o=function(n){a.YOt[e[n]]&&a.YOt[e[n]][t[n]].forEach(function(t){i[t]===n&&(r[t]=n)}),i=r,r={}},a=this,n=1;n<t.length;n++)o(n);return Object.keys(i)},C.prototype.kEt=function(t,n,e){var i,r,o,a,u,s,c,f,l,h,d,v,m,g;if(e){for(i={},r=0;r<n.length;r++)o=n[r],a=this._dataSource._data[o],i[o]=a&&a.data[t];for(s=0,c=u=this.QOt.relationships;s<c.length;s++)if((f=c[s]).sourceTable===this&&f.targetTable!==this){for(l={},h=f.sourceRelationshipName+".",m=d=(v=0,p.keys)(f.targetTable.columns);v<m.length;v++)l[g=m[v]]=f.sourceTable._getValueByField(h+g,t);i[f.sourceRelationshipName]=l}}else for(i=[],r=0;r<n.length;r++)a=this._dataSource._data[n[r]],i.push(a&&a.data[t]);return i},C.prototype.ASt=function(t,n,e,i){for(var r,o,a,u,r=[],o=this.length(),a=0;a<o;a++)u=n&&this._dataSource._data[n].data[a],n!==l&&u!==t&&String(u)!==t||r.push(this.kEt(a,e||this._dataSource.DEt,i));return r},C.prototype.BRt=function(t,n){for(var e,i,r,o,a,e=[],i=this.length(),r=0;r<i;r++)(a=(o=this.get(r))[n])!==t&&String(a)!==t||e.push(o);return e},C.prototype.RRt=function(t,n){var e,i,n,r,o,a,u,e,i,n=this.YOt[n][t],r=[];if(n)for(o=0,a=n;o<a.length;o++)u=a[o],r.push(this.get(u));return r},C.prototype.sRt=function(t,n){var e,i,r,o,e=this.YOt;for(i in e)e.hasOwnProperty(i)&&(r=e[i])&&(r[o=n[i]]?r[o].push(t):r[o]=[t])},C.prototype.cRt=function(t,n){var e=this._dataSource.options.schema;y(this.ZOt,t,n,e&&e.columns)},C.prototype.lRt=function(t,n,e){var i,r,o,a,i=this.YOt;for(r in i)i.hasOwnProperty(r)&&(o=i[r])&&e!==n&&((a=o[n])&&1<a.length?a.splice(a.indexOf(t),1):delete o[n],o[e]?o[e].push(t):o[e]=[t])},C.prototype.hRt=function(t,n,e,i){w(this.ZOt,t,n,e,i,this.jRt(n))},C.prototype.MRt=function(t,n){M(this.ZOt,t,n)},C.prototype.LRt=function(t,n){var e,i,r,o,e=this.ZOt,i=e&&e[t];if(i)for(r in i)if(i.hasOwnProperty(r)&&(o=i[r],(0,p.isArray)(o))&&o.some(function(t){return t===n}))return r},C.prototype.jOt=function(t){return 0<=this.Ljt().indexOf(t)},C.prototype.OOt=function(){return 1<this.Ljt().length},C.prototype.EOt=function(){return 0<this.Ljt().length},C.prototype.Ljt=function(t){var t,n,e,i,r,o,a,u;if(0===this.qOt.length||t)if(t=this._dataSource.options.schema,(0,p.isNullOrUndefined)(t)||(0,p.isNullOrUndefined)(t.columns)||0===Object.keys(t.columns).length)for(n in this.qOt=[],this.columns)this.columns[n].isPrimaryKey&&this.qOt.push(n);else{for(n in i=[],e=t.columns=t.columns||{})e.hasOwnProperty(n)&&(r=e[n]).isPrimaryKey&&i.push(n);for(o=this.qOt.slice().sort(),i.sort(),a=i,u=0;u<o.length||u<a.length;u++)if(o[u]!==a[u]){this.qOt=a;break}}return this.qOt},C.prototype.defaultView=function(){var i=this;return i.FRt?Promise.resolve(i.FRt):new Promise(function(e,t){i.fetch().then(function(t){var n,n,n,n=i.get(0),n=(0,p.keys)(n),n=i.addView(a.DEFAULT_VIEW_NAME,n);i.FRt=n,e(n)})})},C.prototype.addView=function(t,n,e,i){var n=new o.View(t,n,e,i);return n.PRt(this),this.views[t]=n},C.prototype.GRt=function(t,n){var n=new o.View(t,n);return n.PRt(this),this.QOt.rV[t]=n},C.prototype.removeView=function(t){var n=this.views;n[t].PRt(l),delete n[t],this.URt(t)},C.prototype.URt=function(t){var n,e,i,n=this.QOt.tables;for(e in n)n.hasOwnProperty(e)&&delete(i=n[e]).VOt[t]},C.prototype.HRt=function(t){return this.views[t]},C.prototype.zRt=function(t){for(var n,e,n=0;n<this.Pq.length;n++)if((e=this.Pq[n]).name===t)return e;return null},C.prototype.VRt=function(t){var n,e,i,n=this.getDataSync(t),e=[];if(t)for(i=0;i<t.length;i++)e.push(n[t[i]]);else for(i=0;i<n.length;i++)e.push(n[i]);return e},C.prototype.vRt=function(t){return this.VRt([t])[0]},C.prototype.gRt=function(t){return this._dataSource.lOt(t)},C.prototype.YRt=function(t,n){for(var e,i,e=[],i=0;i<n.length;i++)e.push(this._getValueByField(t,n[i]));return e},C.prototype.bEt=function(t){return this.XOt[t]||!this.CEt()||(0,p.isNullOrEmpty)(this._dataSource.l7t(t))||(this.XOt[t]=new f.HierarchyField(t,this)),this.XOt[t]||(this.XOt[t]=new("="===t[0]?u.CalcField:c.TableField)(t,this)),this.XOt[t]},C.prototype.ZRt=function(t){var t=this.XOt[t];return t&&t.setValue},C.prototype.WRt=function(t,n,e){this.rRt(t);var i=this.XOt[t];return this.o_t(t),i&&i.setValue&&i.setValue(n,e)},C.prototype.QRt=function(t,n,e,i,r){this.rRt(t);var o=this.XOt[t];return this.o_t(t),o&&o.setItemValue&&o.setItemValue(n,e,i,r)},C.prototype.KRt=function(t,n){this.rRt(t);var t=this.XOt[t];return t&&t.hasItem&&t.hasItem(n)},C.prototype.JRt=function(t,n,e,i,r){this.rRt(t);var o=this.XOt[t];return this.o_t(t),o&&o.insertItem&&o.insertItem(n,e,i,r)},C.prototype._getValueByField=function(t,n){return this.rRt(t),this.XOt[t].getValue(n)},C.prototype.XRt=function(t,n){return this.rRt(t),this.XOt[t].getOriginalValue(n)},C.prototype.qRt=function(t){return this.rRt(t),this.XOt[t].getRelatedTable()},C.prototype.$Rt=function(t){return this.rRt(t),this.XOt[t].getRelationMaps()},C.prototype.tBt=function(t){for(var n,e,i,r,o,a,n=this,e,i,r=0,o=n.QOt.relationships;r<o.length;r++){if((a=o[r]).sourceTable===n&&a.sourceFieldName===t)return a.targetTable;if(a.targetTable===n&&a.targetFieldName===t)return a.sourceTable}},C.prototype.nBt=function(t,n){return this.rRt(t),this.XOt[t].getHostTableIndexes(n)},C.prototype.rRt=function(t){this.XOt[t]||this.bEt(t)},C.prototype.xOt=function(t,n,e,i,r){var n={name:n,sourceField:t,targetTable:e,targetField:i,CRt:r};return this.Pq.push(n),n},C.prototype.kOt=function(t){for(var n=this.Pq.length-1;0<=n;n--)this.Pq[n].CRt===t&&this.Pq.splice(n,1)},C.prototype.eBt=function(){for(var t,n,e,i,t=[this],n=this.Pq,e=0;e<n.length;e++)i=n[e].targetTable,-1===t.indexOf(i)&&t.push(i);return t},C.prototype.iBt=function(n){var e,t,i,e=this,t=e.Pq,i={};return t.forEach(function(t){var t=t.name;i[t]=e._getValueByField(t,n)}),i},C.prototype.rBt=function(t){var t=this.jRt(t);return t&&t.dataType},C.prototype.jRt=function(t){var n,e,i,n=this,e=n._dataSource.options.schema;return e&&e.columns&&e.columns[t]?i=e.columns[t]:(0,p.isNullOrUndefined)(n.columns)||(i=n.columns[t]),i},C.prototype.oBt=function(t){var n,e,t;return 0===t.length?[]:((t=(e=(n=this).zRt(t[0]))&&e.targetTable?e.targetTable.oBt(t.slice(1)):[]).unshift(e),t.filter(function(t){return!(0,p.isNullOrUndefined)(t)}))},C.prototype.toJSON=function(){var t,n,e,t=this.views,n=[];for(e in t)t.hasOwnProperty(e)&&n.push(t[e].toJSON());return{name:this.name,dataSourceOption:S(this._dataSource.options),primaryKey:this.primaryKey(),views:n,columns:this.aBt(this.columns)}},C.prototype.fromJSON=function(t){for(var n,e,i,r,o,n,e=0,i=t.views;e<i.length;e++)r=i[e],(o=this.addView(r.name,r.columns,!1,r.options)).fromJSON(r);this.columns=t.columns,this.primaryKey(t.primaryKey)},C.prototype.bind=function(t,n){this._dataSource.bind(t,n)},C.prototype.unbind=function(t,n){this._dataSource.unbind(t,n)},C.prototype.ki=function(t,n){return this._dataSource.ki(t,n)},C.prototype.vOt=function(t){return this._dataSource.vOt(t)},C.prototype.aBt=function(t){var n,e;for(n in t)t.hasOwnProperty(n)&&!(0,p.isNullOrUndefined)(t[n])&&((e=t[n]).W5=e.dataType);return t},C.prototype.z7t=function(t,n,e){return this._dataSource.z7t(t,n,e)},C.prototype.V7t=function(t){return this._dataSource.V7t(t)},C.prototype.d7t=function(t,n,e){return this._dataSource.d7t(t,n,e)},C.prototype.uBt=function(){return this._dataSource.$jt()},C.prototype.qX=function(){return this._dataSource.qX()},C.prototype.m7t=function(t,n,e,i){return this.CEt()&&this.NRt(),this._dataSource.m7t(t,n,e,i)},C.prototype.CEt=function(){return this._dataSource.isHierarchy()},C.prototype.isHierarchy=function(){return this.CEt()},C.prototype.getHierarchyType=function(){return this._dataSource.Fjt()},C.prototype.isHierarchyOptionChanged=function(){return this._dataSource.a7t()},C.prototype.setHierarchyOptionChanged=function(){this._dataSource.u7t()},C.prototype.SEt=function(t){return this._dataSource.SEt(t)},C.prototype.f7t=function(){return this._dataSource.f7t()},C.prototype.getHierarchyRootNode=function(){return this.f7t()},C.prototype.M7t=function(t){this._dataSource.M7t(t),this.NRt()},C.prototype.S7t=function(t,n){this._dataSource.S7t(t,n),this.NRt()},C.prototype.O7t=function(t,n){return this._dataSource.O7t(t,n)},C.prototype.L7t=function(t,n){return this._dataSource.L7t(t,n)},C.prototype.F7t=function(t,n){return this._dataSource.F7t(t,n)},C.prototype.G7t=function(t,n){return this._dataSource.G7t(t,n)},C.prototype.H7t=function(t){return this._dataSource.H7t(t)},C.prototype.h7t=function(t,n){return this._dataSource.h7t(t,n)},C.prototype.isColumnSpreadChanged=function(){return this._dataSource.Mue()},C.prototype.setColumnSpreadChanged=function(t){this._dataSource.Cue(t)},n.Table=C},"./dist/src/table/tableEvents.js":function(t,n){"use strict";var e;function i(){}Object.defineProperty(n,"__esModule",{value:!0}),n.Events=void 0,i.ItemInserting="ItemInserting",i.ItemInserted="ItemInserted",i.ItemUpdating="ItemUpdating",i.ItemUpdated="ItemUpdated",i.ItemResetting="ItemResetting",i.ItemReset="ItemReset",i.ItemSaving="ItemSaving",i.ItemSaved="ItemSaved",i.ItemRemoving="ItemRemoving",i.ItemRemoved="ItemRemoved",i.ChangesSubmitting="ChangesSubmitting",i.ChangesSubmittedRowFailed="ChangesSubmittedRowFailed",i.ChangesSubmitted="ChangesSubmitted",i.ChangesCancelling="ChangesCancelling",i.ChangesCancelled="ChangesCancelled",n.Events=i},"./dist/src/table/tableField.js":function(t,n,e){"use strict";var c,s,i,r;function f(a,u,s){return function(t,n,e,i){var r=a.map[t],o=r;return(0,c.isNullOrUndefined)(o)&&(r=a.map[t]=[]),n[u.targetField]=s._getValueByField(u.sourceField,t),a.relatedTable.JRt(a.subField,void 0,n,function(t){r.push(t.index),t.index=r.length-1,e&&e(t)},i)}}function o(t,a){var r,u,o,t,r=this,u="string"==typeof t?t.split("."):t,o=u[0]&&a.zRt(u[0]);o&&o.targetTable?(this.relatedTable=o.targetTable,this.map=o.LOt,this.setValue=null,this.map||(o.CRt.BOt(),this.map=o.LOt),this.getRelationMaps=function(){var t=[{name:o.name,relationshipMap:o.CRt.DOt(o.name)}];if(this.relatedTable)return this.subField?t.concat(this.relatedTable.$Rt(this.subField)):t},this.getHostTableIndexes=function(t){var n,e,t,e,i,n=[t];return this.relatedTable?(this.subField&&(n=this.relatedTable.nBt(this.subField,t)),t=void 0,t=(e=o.CRt).targetTable===this.relatedTable?e.targetRelationshipName:e.sourceRelationshipName,e=this.relatedTable.zRt(t),i=e.LOt,n.reduce(function(t,n){return t.concat(i[n])},[])):n},"object"===o.type?1===u.length?(this.getValue=function(t){var t=r.map[t];return(0,c.isNullOrUndefined)(t)?s:r.relatedTable.vRt(t[0])},this.setValue=function(t){var n=t[u[0]];return t[o.sourceField]=n?n[o.targetField]:null,t}):(this.subField=u.slice(1).join("."),this.getValue=function(t){var t=r.map[t];return(0,c.isNullOrUndefined)(t)?s:r.relatedTable._getValueByField(r.subField,t[0])},this.getOriginalValue=function(t){var t=this.map[t];return(0,c.isNullOrUndefined)(t)?s:this.relatedTable.XRt(this.subField,t[0])},this.setItemValue=function(t,n,e,i){var t=r.map[t];return(0,c.isNullOrUndefined)(t)?s:r.relatedTable.QRt(r.subField,t[0],n,e,i)},this.hasItem=function(t){var t=r.map[t];return!(0,c.isNullOrUndefined)(t)&&r.relatedTable.KRt(r.subField,t[0])},this.insertItem=f(this,o,a)):1===u.length?this.getValue=function(t){var t=r.map[t];return(0,c.isNullOrUndefined)(t)?[]:r.relatedTable.VRt(t)}:(t=u[1]-1,isNaN(t)?(this.subField=u.slice(1).join("."),this.getValue=function(t){var t=r.map[t];return(0,c.isNullOrUndefined)(t)?s:r.relatedTable.YRt(r.subField,t)},this.getOriginalValue=function(t){var t=this.map[t];return(0,c.isNullOrUndefined)(t)?s:this.relatedTable.XRt(this.subField,t)},this.hasItem=function(t){var t=r.map[t];return t&&0<t.length},this.insertItem=f(this,o,a)):2===u.length?(this.arrayFieldIndex=u[1]-1,this.getValue=function(t){var t,t,t=r.map[t],t=t&&t[r.arrayFieldIndex];return(0,c.isNullOrUndefined)(t)?s:r.relatedTable.vRt(t)}):(this.arrayFieldIndex=t,this.subField=u.slice(2).join("."),this.getValue=function(t){var t,t,t=r.map[t],t=t&&t[r.arrayFieldIndex];return(0,c.isNullOrUndefined)(t)?s:r.relatedTable._getValueByField(r.subField,t)},this.getOriginalValue=function(t){var t,t,t=this.map[t],t=t&&t[this.arrayFieldIndex];return(0,c.isNullOrUndefined)(t)?s:this.relatedTable.XRt(this.subField,t)},this.setItemValue=function(t,n,e,i){var t,t,t=r.map[t],t=t&&t[r.arrayFieldIndex];if(!(0,c.isNullOrUndefined)(t))return r.relatedTable.QRt(r.subField,t,n,e,i)}))):(0===u.length?this.getValue=function(t){return a._dataSource.get(t)}:1===u.length?(this.getValue=function(t){return a._dataSource.getFieldValue(u[0],t)},this.getOriginalValue=function(t){return a._dataSource.getFieldOriginalValue(u[0],t)},this.getRelatedTable=function(){return a},this.setItemValue=function(t,n,e,i){return a.updateItemValue(t,u[0],n,e,i)},this.hasItem=function(t){return a._dataSource.length()>t},this.insertItem=function(t,n,e,i){var r=(0,c.isNullOrUndefined)(t)?a.length():t;return a.insertItem(r,n,function(t){t.index=r,e&&e(t)},i)}):(this.getValue=function(t){for(var n,e,n=a._dataSource.getFieldValue(u[0],t),e=1;n&&e<u.length;e++)n=n instanceof Array?n[u[e]-1]:n[u[e]];return n},this.setItemValue=function(t,n,e,i){var r,o,o,o=a._getValueByField(u[0],t);if(!(0,c.isNullOrUndefined)(o))return o=(0,c.clone)(o,!0),this.setValue(((r={})[u[0]]=o,r),n),a.updateItemValue(t,u[0],o,e,i)}),this.setValue=function(t,n){for(var e,i,r,o,e=t,i=t,r=u.length,o=0;i&&o<r;o++)e=i instanceof Array?i[u[o]-1]:i[u[o]],o!==r-1&&(i=e);return i!==e&&(e!==n||(0,c.isNullOrUndefined)(e)&&(0,c.isNullOrUndefined)(n))&&(i[u[r-1]]=n),t})}Object.defineProperty(n,"__esModule",{value:!0}),n.TableField=void 0,c=e("./dist/src/dataSource/utils.js"),s=null,i=void 0,o.prototype.getValue=function(t){return null},o.prototype.getValues=function(t,n){for(var e,i,r,e=[],i=n=n||0,r=t.length;i<r;i++)e.push(this.getValue(t[i]));return e},o.prototype.setValue=function(t,n){return null},o.prototype.setItemValue=function(t,n,e,i){},o.prototype.hasItem=function(t){},o.prototype.insertItem=function(t,n){},o.prototype.getOriginalValue=function(t){return null},o.prototype.getRelatedTable=function(){if(this.relatedTable)return this.subField?this.relatedTable.qRt(this.subField):this.relatedTable},o.prototype.getRelationMaps=function(){return[]},o.prototype.getHostTableIndexes=function(t){return[t]},n.TableField=o},"./dist/src/viewField/fieldManager.js":function(t,n,e){"use strict";var o,s,_,a,E,b,u,I;function r(i,r,o,a){return function(t,n){var n,e,n=i.getField(n),e=o&&!(0,u.isGroupSlice)(n.name)&&n.extra&&n.extra.caption||n.name;return a&&n instanceof b.ColumnDataReaderField||(t[e]=n.getValue(r)),t}}function i(t,n){this.Pq=[],this.positionOfField=[],this.keysOfBaseField=[],this.sBt=t,this.cBt={},this.nM=n}function c(t,n){for(var n,e,i,r,o,a,u,s,n=n.valueRelation,e=n.split("."),i=t(n),r="",o=!1,a=!1,u=0;u<e.length;u++)s=i[u],(0,_.isNullOrEmpty)(e[u])||(r+=".".concat(e[u])),!a&&s&&"array"===s.type&&s.name===e[u]&&(o=a=!0,r+=".".concat(E.RelationTemplateToken));return{isOneToMany:o,relationTemplate:r.slice(1)}}function f(t,n,e,i){var r,o,r=R(t),o;return{valueRelation:t,valueCaption:n||r,valueIndex:e,valueCrossKey:i}}function j(t){for(var n,e,i,r,o,n=t.columns,e=t.crossKeys,i=t.initialOptionIndex,r=[],o=0;o<n.length;o++)r.push(f(n[o].value,n[o].caption,i+o,e[o]));return r}function O(t,n){return l(t,n,"")}function l(t,n,e){return!(0,_.isNullOrEmpty)(n)&&0<=t.indexOf(n)?l(t=t.replace(n,e),n,e):t}function y(t){var t=t.value;return"string"==typeof t?t:"function"==typeof t?t.name:void 0}function h(t){var t,t="string"==typeof t||(0,_.isNullOrUndefined)(t)?t:"function"==typeof t?t.name:t.value;return(t||"").split(".")}function R(t){var t=h(t);return t[t.length-1]}function B(t){if(!(0,_.isNullOrEmpty)(t.formatter))return t.formatter}function L(t){var t=h(t);return t[t.length-2]}function F(t,n){var t=h(t);return n&&t.splice(t.length-1,0,""),t.slice(0,t.length-1).join(".")}function P(t){return"string"==typeof t?[t]:t||[]}function w(t){for(var n,e,i,r,o,n=0,e={},i=0;i<t.length;i++)r=t[i].caption,(0,_.isArray)(r)?(t[i].caption=r.map(function(t){return null==t?void 0:t.toString()}),e[i]=r.length,n<e[i]&&(n=e[i])):t[i].caption=null==r?void 0:r.toString();for(i in e)if(e[i]<n)for(o=n-e[i],r=t[i].caption;0<o;)r.unshift(),o--;for(i=0;i<t.length;i++)r=t[i].caption,(0,_.isArray)(r)&&1===r.length&&(t[i].caption=r[0])}function d(t,n){var t,t,t,e,t=t.qRt(n);if(!((0,_.isNullOrUndefined)(t)||(t=t._dataSource.options.schema,(0,_.isNullOrUndefined)(t))||(t=t.columns,(0,_.isNullOrUndefined)(t))||(e=t[R(n)],(0,_.isNullOrUndefined)(e))))return e.lookup}function v(t,n){return m(t,n)||g(t,n)}function m(t,n){return(0,_.isArray)(d(t,n))}function g(t,n){var e,i,r,o,n,e=d(t,n);if((0,_.isObject)(e)&&(e=e.name),(0,_.isString)(e))return i=t.qRt(n),r=R(n),o=R(e),n=t.QOt.relationships.find(function(t){return t.sourceTable===i&&t.sourceFieldName===r&&t.sourceRelationshipName===o}),!(0,_.isNullOrUndefined)(n)}function p(t,n,e){var i=R(e),e=T(t,function(t){return t.sourceFieldName===i&&t.sourceTable===n});return e?{relationTable:e.targetTable,relationPrimaryKey:e.targetFieldName,relationTableName:e.sourceRelationshipName}:{}}function M(t,n,e){var i,n,r,o,n,o,n,r,o,i,i=n.over,n=n.attributes;return!((0,_.isNullOrEmpty)(i)||(0,_.isNullOrEmpty)(e)||e===i||C(t,e)||(r=h(e),n=!(o=m(t,i))&&g(t,i)&&n&&0<n.length,!o&&!n)||(o=p(t,S(t,i),i),-1<r.indexOf(o.relationTableName)))&&(n=t.$Rt(i),r=t.$Rt(e),!(!n.every(function(t){return t.relationshipMap===a.RelationshipMap.OneToOne})||!r.every(function(t){return t.relationshipMap===a.RelationshipMap.OneToOne}))||(o=(0,_.findIndex)(n,function(t){return t.relationshipMap===a.RelationshipMap.OneToMany}),i=(0,_.findIndex)(r,function(t){return t.relationshipMap===a.RelationshipMap.OneToMany}),-1<o&&o===i&&n[o].name===r[i].name?n.slice(o+1).every(function(t){return t.relationshipMap===a.RelationshipMap.OneToOne})&&r.slice(o+1).every(function(t){return t.relationshipMap===a.RelationshipMap.OneToOne}):void 0))}function C(t,n){var e=S(t,n),i=R(n);return e.jOt(i)||T(t,function(t){return t.sourceTable===e&&t.sourceFieldName===i||t.targetTable===e&&t.targetFieldName===i})}function S(t,n){return t.qRt(n)}function T(t,n){return t.QOt.relationships.find(n)}function A(t){var i=t.ascending,e=t.compare;return e?function(t,n){return e(t.extra.caption,n.extra.caption,i)}:function(t,n){var t=t.extra.caption,n=n.extra.caption,e=i?t:n,n=i?n:t;return n<e?1:e<n?-1:0}}o=this&&this.__spreadArray||function(t,n,e){if(e||2===arguments.length)for(var i=0,r=n.length,o;i<r;i++)!o&&i in n||((o=o||Array.prototype.slice.call(n,0,i))[i]=n[i]);return t.concat(o||Array.prototype.slice.call(n))},Object.defineProperty(n,"__esModule",{value:!0}),n.isValidCross=n.isLookupRelationField=n.isLookupListField=n.isLookupField=n.getLookupBy=n.FieldManager=void 0,s=e("CalcEngine"),_=e("./dist/src/dataSource/utils.js"),a=e("./dist/src/interfaces/interface.js"),E=e("./dist/src/viewField/utils.js"),b=e("./dist/src/viewField/fields.js"),u=e("./dist/src/viewField/groupManager.js"),i.prototype.fBt=function(t,n){return this.nM._getValueByField(t,n)},i.prototype.lBt=function(t,n){return this.nM.XRt(t,n)},i.prototype.hBt=function(t){return this.nM.iBt(t)},i.prototype.dBt=function(t){return T(this.nM,t)},i.prototype.vBt=function(t){return S(this.nM,t)},i.prototype.mBt=function(t){return this.nM._dataSource._data[t].data},i.prototype.gBt=function(t){return!(0,_.isNullOrUndefined)(this.nM._dataSource._data[t])},i.prototype.oBt=function(t){return this.nM.oBt(t.split("."))},i.prototype.pBt=function(){return this.nM.POt},i.prototype.bBt=function(t){return d(this.nM,t)},i.prototype.yBt=function(t){return v(this.nM,t)},i.prototype.wBt=function(t){return m(this.nM,t)},i.prototype.MBt=function(t){return g(this.nM,t)},i.prototype.getField=function(t){return this.Pq[t]},i.prototype.getFieldByPosition=function(t){return this.getField(this.positionOfField[t])},i.prototype.getFieldByName=function(n){return this.Pq.filter(function(t){return t.name===n})[0]},i.prototype.getFields=function(t){return this.Pq.filter(t)},i.prototype.getFieldValues=function(t,n,e){var i=this;return i.positionOfField.reduce(r(i,t,n,e),{})},i.prototype.CBt=function(t){var n=this;return n.positionOfField.filter(function(t){return-1===n.keysOfBaseField.indexOf(t)}).reduce(r(n,t),{})},i.prototype.moveFields=function(t,n,e){(0,_.swapArrayItems)(this.Pq,t,n,e)},i.prototype.moveFieldsByIndexes=function(t){var n=this;t.forEach(function(t){t.field=n.Pq[t.oldIndex]}),t.forEach(function(t){n.Pq[t.newIndex]=t.field})},i.prototype.removeFields=function(t,n){this.Pq.splice(t,n||1)},i.prototype.reset=function(){var e=this;e.positionOfField=e.keysOfBaseField.slice(),e.Pq=e.Pq.reduce(function(t,n){return-1<e.keysOfBaseField.indexOf(n.key)?t.concat(n):t},[])},i.prototype.SBt=function(t){var n=this,e=n.cBt,i=e[t],r=n.pBt(),o=r.getCalcService(),i=i||(e[t]=n.fixExpression(o.parse(r,t,0,0)));return function(t,n){return r.pe(t,n),o.evaluateExpression(r,i,{row:0,col:0})}},i.prototype.TBt=function(t,n){var e=this,i=e.cBt,r=i[t],o=n||e.pBt(),a=o.getCalcService(),r=r||(i[t]=e.fixExpression(a.parse(o,t,0,0)));return function(t,n){o.pe(t,n);var t=a.MX.evaluateExpression(r,o.getEvaluatorContext({row:0,col:0},!1),!1,!0);return(0,_.isNullOrUndefined)(t.toArray)?[]:t.toArray()}},i.prototype.fixExpression=function(t){var n,e,i,r,o,a,u,n=this;if(t.function)for(t.function.isReverseArgs&&t.function.isReverseArgs()&&t.arguments.reverse(),e=0,i=t.arguments;e<i.length;e++)r=i[e],n.fixExpression(r);else for(o=0,a=Object.getOwnPropertyNames(t);o<a.length;o++)t[u=a[o]]instanceof s.Expression&&n.fixExpression(t[u]);return t},i.prototype.ABt=function(t){var n=this;return t.key=n.Pq.length,n.Pq.push(t),t},i.prototype.addDataBaseField=function(t,n,e){var i=this,t=i.addColumnDataField(t,n,e);return i.IBt(t)},i.prototype.addReaderBaseField=function(t,n,e){var i,t,i=this,t=i.addColumnDataReaderField(t,"function"==typeof n?n:function(t){return i.fBt(n,t)},e);return i.IBt(t)},i.prototype.IBt=function(t){var n=this,e=t.key;return n.keysOfBaseField.push(e),n.positionOfField.push(e),t},i.prototype.addColumnDataField=function(t,n,e){return this.ABt(new b.ColumnDataField(t,n,e))},i.prototype.addColumnDataReaderField=function(t,n,e){return this.ABt(new b.ColumnDataReaderField(t,n,e))},i.prototype.addDataField=function(t,n){return this.ABt(new b.DataField(t,n))},i.prototype.addFormulaField=function(t,n){return this.ABt(this.xBt(t,n))},i.prototype.xBt=function(t,n){return new b.FormulaField(t,n,this.SBt(n))},i.prototype.addCategoryFormulaField=function(t,n){return this.ABt(this.NBt(t,n))},i.prototype.NBt=function(t,n){return new b.CategoryFormulaField(t,n,this.SBt(n))},i.prototype.addCategoryField=function(t,n){return this.ABt(this.kBt(t,n))},i.prototype.kBt=function(t,n){return new b.CategoryField(t,n)},i.prototype.addSliceCategoryField=function(t){return this.ABt(new b.SliceCategoryField(t))},i.prototype.DBt=function(t,n,e,i,r){for(var o,a,u,s,c,f,f,l,h,d,o=this,a=t.fieldExtra,u=t.field,h=0,d=e.length;h<d;h++)c=(f=e[h]).result,f=f.key,l=t.sliceFields[f],(0,_.isUndefined)(l)&&(s=u.getValueByKey(f),(l=o.addSliceCategoryField((0,E.combineName)(s,t.sliceKeys.length,n.name))).setFieldExtra(a),t.sliceFields[f]=l,t.sliceKeys.push(l.key)),l.setData(c,i,r)},i.prototype._Bt=function(n,t,e,i){var r=this;return(0,E.isField)(n)?r.getFieldByName(n):(0,E.isFormula)(n)?r.EBt("".concat(i,"_formula_source"),t,n,e):(0,E.isRelated)(n)?new b.ColumnDataReaderField("".concat(i,"_related_source"),function(t){return r.fBt(n,t)},null):r.getFieldByName(n)},i.prototype.EBt=function(t,n,e,i){var r,t=this.xBt((0,E.combineName)(t,n),e);return t.evaluateFormulaBy(i),t},i.prototype.buildGroupFields=function(t,u){var s=this,e,c,f=[];return t.forEach(function(t,n){var a,n,n;(0,_.isNullOrEmpty)(t.field)||(c=(0,_.isNullOrUndefined)(c)?e={}:c.group={},a=(0,E.combineName)(t.field,n),n=s._Bt(t.field,a,u,"group_field"),(n=s.addCategoryField(a,n)).setFieldExtra(t),f.push(n.key),c.field=n,(0,_.isNullOrUndefined)(t.summaryFields))||t.summaryFields.forEach(function(t,n){var n,e,i,e,r,o,n,o,n;(0,_.isNullOrEmpty)(t.formula)||(n=(0,E.combineName)(t.formula,n,a),(e=s.addCategoryFormulaField(n,t.formula)).setFieldExtra(t),(0,_.isNullOrUndefined)(c.formulas)&&(c.formulas=[]),i=c.formulas.push(e)-1,f.push(e.key),(0,_.isNullOrUndefined)(t.slice))||(e=t.slice,o=(r=(0,_.isString)(e))?e:e.field,n=(0,E.combineName)(o,n),o=s._Bt(o,n,u,"slice"),o=s.kBt((0,E.combineName)("slice_category",n),o),(0,_.isNullOrUndefined)(c.slices)&&(c.slices=[]),n=s.NBt((0,E.combineName)("slice_formula_result",n),t.formula),c.slices.push({field:o,formula:n,formulaIndex:i,sliceKeys:[],fieldExtra:r?{}:e,sliceFields:{},addSliceField:s.DBt.bind(s)}))})}),s.positionOfField=f.concat(s.keysOfBaseField),e},i.prototype.transposeSliceFields=function(n){var e=this,i,r;n.slices&&n.slices.forEach(function(t){var t;i=e.positionOfField.indexOf(n.formulas[t.formulaIndex].key),r=t.sliceKeys,(0,_.isNullOrUndefined)(t.fieldExtra.sort)||(r=r.map(function(t){return e.getField(t)}).sort(A(t.fieldExtra.sort)).map(function(t){return t.key})),(t=e.positionOfField).splice.apply(t,o([i+1,0],r,!1))}),n.group&&e.transposeSliceFields(n.group)},i.prototype.prepareFields=function(a){for(var u,s,c,f,t,n,e,i,r,o,r,l,h,d,v,m,g,p,u=this,s=[],c=0,f=0;c<a.length;c++,f++)if(n=y(t=a[c]),e=t.value,i=t.cross){if(o=(r=u.jBt(a,c)).crossColumnOptions,r=r.endColIndex,l=o.columns.length,0!==(h=u.OBt(o))){for(d=function(t,n){var e,i,e,r,o,e=f+t,i=c+n,e=u.getField(e);e.setFieldExtra(a[i]),r={value:e.name,name:e.name,isCross:!0,RBt:i},e.isReadonly()&&(r.readonly=!0),(o=e.extra)&&(0,b.setFieldExtraProperties)(function(t){o[t]&&(r[t]=o[t])}),s.push(r),v=++t,m=n=l<=++n?0:n},p=g=0;g<h;)d(g,p),g=v,p=m;c=r,f+=h-1}}else u.gBt(n)?u.addDataBaseField(n,u.mBt(n),t):u.addReaderBaseField(n,e,t),s.push(a[c]);return w(s),s},i.prototype.jBt=function(t,n){var e,i,r,o,r,a,u,e=this,i=n,r=t[n],o=r.cross,r=e.BBt(o,[r],i);if("string"==typeof o){for(u=a=n;n<t.length&&!(++u<t.length&&o!==t[u].cross);)n++;r=e.BBt(o,t.slice(a,u),i)}return{crossColumnOptions:r,endColIndex:n}},i.prototype.BBt=function(t,n,e){var t="string"==typeof t?this.sBt.cross[t]:t;return{initialOptionIndex:e,crossKeys:n.map(function(t){return t.LBt}),cross:t,columns:n,lookup:this.FBt(t,n)}},i.prototype.FBt=function(n,t){var e=this;return t.every(function(t){return e.isValidCross(n,t.value)})&&this.bBt(n.over)},i.prototype.isValidCross=function(t,n){return M(this.nM,t,n)},i.prototype.OBt=function(t){var n=this,e=t.lookup,i=0;return(0,_.isArray)(e)?i=n.PBt(t):((0,_.isString)(e)||(0,_.isObject)(e))&&(i=n.GBt(t)),i},i.prototype.GBt=function(t){var n,e,i,r,o,a,u,s,c,f,l,t,h,d,v,m,g,h,p,e,b,y,w,M,C,S,T,A,I,x,N,k,D,x,k,n=this,e=t.cross,i=n.sBt.showCrossValueHeader,r=P(e.caption),o=0,a=j(t),u=e.over,s=R(u),c=u,f=e.attributes||[],l=f.length,t=F(f[0],!0),h=n.UBt(n.vBt(c),c),d=h.relationTableName||L(f[0]),v=h.relationTable||n.HBt(d),m=v.length(),g=h.relationPrimaryKey||n.zBt(d,s),h=e.filter?n.TBt(O(e.filter,t),v.POt):null;for((0,_.isNullOrUndefined)(h)||0<(e=h(null)).length&&(p=e.reduce(function(t,n){var e;return t["object"==typeof n?n[g]:n]=!0,t},{})),b=[],y=0;y<l;y++)w=R(f[y]),M=B(f[y]),b.push({fieldName:w,formatter:M});for(C=0;C<m;C++)if(S=v._getValueByField(g,C),(0,_.isNullOrUndefined)(p)||p[S]){for(T=r.slice(),y=0;y<l;y++)w=b[y].fieldName,A=v._getValueByField(w,C),M=b[y].formatter,(0,_.isNullOrUndefined)(M)||(A=(0,_.format)(A,M)),T.push(A);for(I=0;I<a.length;I++)N=(x=a[I]).valueRelation,k=x.valueCaption,D=x.valueIndex,x=x.valueCrossKey,k=i?T.concat(k):T,n.VBt({path:k,value:(0,E.combineName)(N,S,u,x),valueRelation:N,dimRelationPath:c,dimRelationKey:s,dimTableName:d,dimTableKeyFieldValue:S,initialOptionIndex:D}),o++}return o},i.prototype.PBt=function(t){for(var n,e,i,r,o,a,u,s,c,f,l,h,d,v,m,g,p,b,y,g,b,n=this,e=t.cross,i=t.lookup,r=n.sBt.showCrossValueHeader,o=P(e.caption),a=0,u=j(t),s=e.over,c=R(s),f=s,l=i.length,h=0;h<l;h++)for(d=o.slice(),v=i[h],d.push(v),m=0;m<u.length;m++)p=(g=u[m]).valueRelation,b=g.valueCaption,y=g.valueIndex,g=g.valueCrossKey,b=r?d.concat(b):d,n.VBt({path:b,value:(0,E.combineName)(p,v,s,g),valueRelation:p,dimRelationPath:f,dimRelationKey:c,dimTableKeyFieldValue:v,initialOptionIndex:y}),a++;return a},i.prototype.setCrossFieldValues=function(t){var n,e,i,r,o,a,u,s,c,n=this,e=n.Pq,i=t.length,r=e.filter(function(t){return t instanceof b.CrossField});if(0<r.length)for(o=0;o<i;o++)for(a=t[o],u={},s=0;s<r.length;s++)c=r[s],n.YBt(c,a,u)},i.prototype.YBt=function(t,n,e){var i,r,o,a,i=this,r=t.dimRelationPath,o=e[r];if((0,_.isNullOrUndefined)(o)&&t.isOneToMany&&(o=e[r]=i.fBt(r,n)),(0,_.isArray)(o))for(a=0;a<o.length;a++)if(t.ZBt(o[a],t.dimTableKeyFieldValue)&&(0,_.isNullOrUndefined)(t.getValueIndex(n))){t.setValueIndex(n,a);break}},i.prototype.zBt=function(n,e){var t=this,i=t.dBt(function(t){return t.sourceFieldName===e&&t.sourceRelationshipName===n});return i?i.targetFieldName:(i=t.dBt(function(t){return t.targetFieldName===e&&t.targetRelationshipName===n}))?i.sourceFieldName:void 0},i.prototype.HBt=function(n){var t,e=this.dBt(function(t){return t.sourceRelationshipName===n||t.targetRelationshipName===n})||{},e=e.sourceRelationshipName===n?e.sourceField:e.targetField;return e?e.targetTable:{length:function(){return 0}}},i.prototype.UBt=function(t,n){return p(this.nM,t,n)},i.prototype.WBt=function(t){var n=this,t=new b.CrossField(t,n.fBt.bind(n),n.lBt.bind(n),n.hBt.bind(n));return n.ABt(t),n.IBt(t),t},i.prototype.VBt=function(t){var n,t,n,e,n,n=this,t=n.WBt(t);t.isReadonly()||(e=(n=c(n.oBt.bind(n),t)).isOneToMany,n=n.relationTemplate,e&&(t.isOneToMany=e,t.valueArrayRelation=n))},i.prototype.isCrossField=function(t){return t instanceof b.CrossField},i.prototype.clearCrossFieldData=function(){for(var t,n,e,i,t,n=this.Pq,e=0;e<n.length;e++)(i=n[e])instanceof b.CrossField&&i.clearData()},i.prototype.resetCrossFieldRowValues=function(t){for(var n,e,i,r,o,n=this,e=n.Pq,i={},r=0;r<e.length;r++)(o=e[r])instanceof b.CrossField&&(o.clearValue(t),n.YBt(o,t,i))},i.prototype.removeCrossFieldValues=function(t,n){for(var e,i,r,o,e,i=this.Pq,r=0;r<i.length;r++)(o=i[r])instanceof b.CrossField&&o.removeData(t,n)},i.prototype.setCrossFieldInsertedIndex=function(t,n,e){for(var i,r,o,a,u,i,r=this.Pq,o=F(t.valueRelation,!0),a=0;a<r.length;a++)(u=r[a])instanceof b.CrossField&&u.isOneToMany&&t.dimTableKeyFieldValue===u.dimTableKeyFieldValue&&(0,_.isNullOrUndefined)(u.getValueIndex(n))&&o===F(u.valueRelation,!0)&&u.setValueIndex(n,e)},n.FieldManager=i,n.getLookupBy=d,n.isLookupField=v,n.isLookupListField=m,n.isLookupRelationField=g,n.isValidCross=M},"./dist/src/viewField/fields.js":function(t,n,e){"use strict";var i,u,s,e,r,o,a,c,r,f,l,h,d,v,m,g,p,b,y,w,M;function C(t){["caption","width","style","headerStyle","conditionalFormats","validator","headerFit"].forEach(t)}function S(t){this.name=t}function T(t,n){var t=v.call(this,t)||this;return t.data=n||[],t}function A(t,n,e){var t=m.call(this,t,n)||this;return t.column=e,t}function I(t,n,e){var t=g.call(this,t)||this;return t.column=e,t.getValue=n,t}function x(t,n,e){var t=p.call(this,t)||this;return t.formula=n,t.P6t=e,t}function N(t,n){return t._error||t._code?"Calc Error ".concat(n,":").concat(t._error,",").concat(t._code):t}function k(t,n){var t=b.call(this,t)||this;return t.QBt=n,t.KBt={},t.Oit=[],t}function D(t,n,e){var t=y.call(this,t)||this;return t.P6t=e,t.formula=n,t}function _(t){return w.call(this,t)||this}function E(t,n,e,i){var r=M.call(this,t.value)||this;return r.path=t.path,r.valueRelation=t.valueRelation,r.dimRelationPath=t.dimRelationPath,r.dimRelationKey=t.dimRelationKey,r.dimTableName=t.dimTableName,r.isDateDimValue=t.dimTableKeyFieldValue instanceof Date,r.dimTableKeyFieldValue=r.isDateDimValue?t.dimTableKeyFieldValue.getTime():t.dimTableKeyFieldValue,r.initialOptionIndex=t.initialOptionIndex,r.getValueByField=j(t,i,n),r.getOriginalValueByField=j(t,i,e),r.data=[],r}function j(t,e,i){return(0,u.isFunction)(t.valueRelation)?function(t,n){return(0,u.isFunction)(t)?t(e(n)):i(t,n)}:i}i=this&&this.__extends||(d=function(t,n){return(d=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(t,n){t.__proto__=n}:function(t,n){for(var e in n)Object.prototype.hasOwnProperty.call(n,e)&&(t[e]=n[e])}))(t,n)},function(t,n){if("function"!=typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function e(){this.constructor=t}d(t,n),t.prototype=null===n?Object.create(n):(e.prototype=n.prototype,new e)}),Object.defineProperty(n,"__esModule",{value:!0}),n.CrossField=n.SliceCategoryField=n.CategoryFormulaField=n.CategoryField=n.FormulaField=n.ColumnDataReaderField=n.ColumnDataField=n.DataField=n.Field=n.setFieldExtraProperties=void 0,u=e("./dist/src/dataSource/utils.js"),s=e("./dist/src/viewField/utils.js"),n.setFieldExtraProperties=C,S.prototype.setFieldExtra=function(n){var e,t,e=this;(0,u.isUndefined)(e.extra)&&(e.extra={}),C(function(t){e.JBt(t,n)}),(0,u.isNullOrUndefined)(n.caption)&&0<=(t=e.name.indexOf(s.FieldNameDelimiter))&&(e.extra.caption=e.name.substring(0,t))},S.prototype.JBt=function(t,n){var e,n=n[t];n&&(this.extra[t]=n)},S.prototype.getValue=function(t){return this.data[t]},S.prototype.getOriginalValue=function(t){return this.getValue(t)},S.prototype.XBt=function(t,n,e){var i,r,o,a,i=this;for(i.data||(i.data=[]),o=e=e||0,a=t.length;o<a;o++)r=t[o],i.data[r]=n;return i.data},S.prototype.qBt=function(t,n){var e,i,r,o,e=this;for(e.data||(e.data=[]),r=0,o=t.length;r<o;r++)i=t[r],e.data[i]=n(i);return e.data},n.Field=e=S,i(T,v=e),n.DataField=r=T,i(A,m=r),n.ColumnDataField=A,i(I,g=e),n.ColumnDataReaderField=I,i(x,p=r),x.prototype.evaluateFormulaBy=function(t){var n=this,e=n.formula,i=n.P6t;return n.qBt(t,function(t){return N(i(t),e)})[t[0]]},n.FormulaField=x,i(k,b=e),k.prototype.getKey=function(t){return this.KBt[t]},k.prototype.getMap=function(){return this.KBt},k.prototype.getValueByKey=function(t){return this.Oit[t]},k.prototype.$Bt=function(t,n){this.KBt[n]=t,this.Oit[t]=n},k.prototype.getValue=function(t){var n=this;return n.data&&0<n.data.length?n.Sl(t):n.QBt?n.QBt.getValue(t):void 0},k.prototype.Sl=function(t){var n=this;return n.Oit[n.data[t]]},k.prototype.addKey=function(t,n){var e=this,i=e.getKey(t);return(0,u.isUndefined)(i)&&e.$Bt(i=n,t),i},n.CategoryField=r=k,i(D,y=r),D.prototype.evaluateFormulaBy=function(t,n){var e,i,e=this,i=e.P6t(t,n=n||0);return e.XBt(t,e.addKey(i,t[n]),n),i},n.CategoryFormulaField=D,i(_,w=r),_.prototype.setData=function(t,n,e){var i=this,t=i.addKey(t,n[e]);i.XBt(n,t,e)},n.SliceCategoryField=_,i(E,M=e),E.prototype.setFieldExtra=function(t){M.prototype.setFieldExtra.call(this,t),this.extra.caption=this.path},E.prototype.ZBt=function(t,n){var e,i;return this.isDateDimValue&&t instanceof Date?t.getTime()===n:t===n},E.prototype.tLt=function(t,n){var e=this,i=e.isOneToMany,r=e.dimRelationPath,o=e.dimTableKeyFieldValue;return!i&&e.ZBt(n(r,t),o)?t:this.data[t]},E.prototype.getDimValue=function(){var t=this,n=t.isDateDimValue,t=t.dimTableKeyFieldValue;return n?new Date(t):t},E.prototype.getValueIndex=function(t){return this.tLt(t,this.getValueByField)},E.prototype.setValueIndex=function(t,n){this.data[t]=n},E.prototype.clearData=function(){this.data=[]},E.prototype.clearValue=function(t){this.data[t]=void 0},E.prototype.removeData=function(t,n){this.data.splice(t,n)},E.prototype.isReadonly=function(){return(0,s.isFormula)(this.valueRelation)||(0,u.isFunction)(this.valueRelation)},E.prototype.Sl=function(t,n){var e,i,r,o,e,a,e=this,i=e.isOneToMany,r=e.valueArrayRelation,o=e.valueRelation,e=e.tLt(t,n);if((0,u.isNumber)(e))return a=void 0,n(a=i?r.replace(s.RelationTemplateToken,e+1):o,t)},E.prototype.getValue=function(t){return this.Sl(t,this.getValueByField)},E.prototype.getOriginalValue=function(t){return this.Sl(t,this.getOriginalValueByField)},E.prototype.getRelationField=function(t){var n=this,e=n.isOneToMany,i=n.valueArrayRelation,r=n.valueRelation,n=n.getValueIndex(t);return e?(0,u.isNumber)(n)?i.replace(s.RelationTemplateToken,n+1):void 0:r},n.CrossField=E},"./dist/src/viewField/groupManager.js":function(t,n,e){"use strict";var u,r,i;function o(t,n){var e,i,r,o,a;if((0,u.isNullOrUndefined)(t)||(0,u.isNullOrUndefined)(n))return t===n;if(e=Object.keys(t),i=Object.keys(n),e.length!==i.length)return!1;for(r=0,o=e;r<o.length;r++)if(t[a=o[r]]!==n[a])return!1;return!0}function a(t){for(var n,e,i,n=[],e=t.split(r.FieldNameDelimiter).reverse(),i=0;i<e.length;i+=2)n.push(e[i]);return n}function s(t){return 1===a(t).length}function c(t){return 2===a(t).length}function f(t){return 3===a(t).length}function l(t){return 2===t.split(r.FieldNameDelimiter).length}function h(t){var t=t.split(r.FieldNameDelimiter);return t[t.length-2]}function d(t,n){this.LEt=t,this.wEt=n}Object.defineProperty(n,"__esModule",{value:!0}),n.GroupManager=n.getGroupFieldName=n.isGroupField=n.isGroupSlice=n.isGroupSummary=n.isGroupCategory=n.getGroupOptionIndexesFrom=void 0,u=e("./dist/src/dataSource/utils.js"),r=e("./dist/src/viewField/utils.js"),n.getGroupOptionIndexesFrom=a,n.isGroupCategory=s,n.isGroupSummary=c,n.isGroupSlice=f,n.isGroupField=l,n.getGroupFieldName=h,d.prototype.isGrouped=function(t){return o(t,this.LEt)},d.prototype.groupBy=function(t,n){var e=this,i=e.nLt(t,n);return{rootNode:i,indexMap:e.eLt(n,function(){return e.iLt(t,i)})}},d.prototype.eLt=function(t,n){var e,i,i,e=this,i=e.LEt;return e.DJ={path:[],groupOptions:i,entireScope:t},e.wEt(e.DJ),i=n(),e.DJ=null,e.wEt(e.DJ),i},d.prototype.nLt=function(t,n){for(var e,i,r,o,a,e={},o=0,a=n.length;o<a;o++)r=n[o],this.rLt(e,t,r);return e},d.prototype.rLt=function(t,n,e){var i,r,o,r,a,i=this,r=n.field,o=r.getValue(e),r=r.addKey(o,e),a=i.oLt(t,r);n.slices&&n.slices.forEach(function(t,n){(0,u.isUndefined)(a.slices)&&(a.slices=[]),(0,u.isUndefined)(a.slices[n])&&(a.slices[n]={});var n=a.slices[n];i.rLt(n,t,e)}),n.group?i.rLt(a,n.group,e):((0,u.isUndefined)(a.recordIndexes)&&(a.recordIndexes=[]),a.recordIndexes.push(e))},d.prototype.oLt=function(t,n){(0,u.isUndefined)(t.children)&&(t.childrenMap={},t.children=[]);var e=t.childrenMap[n];return(0,u.isUndefined)(e)&&(t.childrenMap[n]=e=t.children.length,t.children.push({key:n})),t.children[e]},d.prototype.iLt=function(t,n){var e,i,r,o,e=this,i=n.children,r=[];for(o in i)i.hasOwnProperty(o)&&e.aLt(i[o],t,r);return r},d.prototype.aLt=function(t,n,e){var i,r,o,a,u,s,c,f,l,h,d,v,m,g,p,b,i=this,r=e.length,o=t.recordIndexes;if(i.uLt(t),o)for(a=0,u=o.length;a<u;a++)e[r+a]=o[a];else for(c=0,f=s=t.children;c<f.length;c++)l=f[c],i.aLt(l,n.group,e);if(i.sLt(n.formulas,e,r),t.slices)for(a=0,d=(h=t.slices).length;a<d;a++){for(v=h[a],g=(m=n.slices[a]).formula,p=0,b=s=v.children;p<b.length;p++)(l=b[p]).result=i.cLt(g,l.recordIndexes);m.addSliceField(m,n.formulas[m.formulaIndex],s,e,r)}i.fLt()},d.prototype.sLt=function(t,n,e){if(t)for(var i=0,r=t.length;i<r;i++)t[i].evaluateFormulaBy(n,e)},d.prototype.cLt=function(t,n){if(t)return t.evaluateFormulaBy(n)},d.prototype.uLt=function(t){this.DJ.path.push(t)},d.prototype.fLt=function(){this.DJ.path.pop()},n.GroupManager=d},"./dist/src/viewField/utils.js":function(t,e){"use strict";function n(){for(var t,n,t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];return t.join(e.FieldNameDelimiter)}function i(t){return"="===t[0]}function r(t){return-1<t.indexOf(".")}function o(t){return-1<t.indexOf(e.FieldNameDelimiter)}Object.defineProperty(e,"__esModule",{value:!0}),e.isField=e.isRelated=e.isFormula=e.combineName=e.RelationTemplateToken=e.CaptionDelimiter=e.FieldNameDelimiter=void 0,e.FieldNameDelimiter="__",e.CaptionDelimiter="\\",e.RelationTemplateToken="{{}}",e.combineName=n,e.isFormula=i,e.isRelated=r,e.isField=o},"./dist/src/viewField/viewField.entry.js":function(t,n,e){"use strict";var i,r,i=this&&this.__createBinding||(Object.create?function(t,n,e,i){void 0===i&&(i=e);var r=Object.getOwnPropertyDescriptor(n,e);r&&("get"in r?n.__esModule:!r.writable&&!r.configurable)||(r={enumerable:!0,get:function(){return n[e]}}),Object.defineProperty(t,i,r)}:function(t,n,e,i){t[i=void 0===i?e:i]=n[e]}),r=this&&this.__exportStar||function(t,n){for(var e in t)"default"===e||Object.prototype.hasOwnProperty.call(n,e)||i(n,t,e)};Object.defineProperty(n,"__esModule",{value:!0}),r(e("./dist/src/viewField/groupManager.js"),n),r(e("./dist/src/viewField/fieldManager.js"),n),r(e("./dist/src/viewField/fields.js"),n),r(e("./dist/src/viewField/utils.js"),n)},"./dist/src/view/view-cross.js":function(t,n,e){"use strict";var n,i,r,o,e,a;Object.defineProperty(n,"__esModule",{value:!0}),n=e("Common"),i=e("./dist/src/view/view.js"),r=e("./dist/src/dataSource/utils.js"),o=e("./dist/src/viewField/fieldManager.js"),e=n.Common.lt.Dh,a=void 0,e(i.View.prototype,{YBt:function(){var t=this;t.lLt.setCrossFieldValues(t.iRt)},hLt:function(){var t=this;t.lLt&&(t.lLt.clearCrossFieldData(),t.YBt())},dLt:function(t,n){var e=this;e.lLt&&e.lLt.removeCrossFieldValues(t,n)},vLt:function(t){var n=this;n.lLt&&n.lLt.resetCrossFieldRowValues(t)},mLt:function(t,n){var e,i;return"string"==typeof t&&(e=!0,i=t,e=!(!(0,r.isNullOrUndefined)(this.LEt.cross)&&(t=this.LEt.cross[i],!(0,r.isNullOrUndefined)(t)))&&e)&&(t={over:i,attributes:[""]}),(0,o.isValidCross)(this.gLt,t,n)},pLt:function(){return this.bLt()&&(0,r.isNullOrUndefined)(this.lLt)},bLt:function(){return this.yLt.some(function(t){return t.cross})},wLt:function(t){for(var e,i,n,r,o,a,u,s,c,f,l,h,d,v,e=this,i=[],n=function(n,t){i.push({newIndex:t,columnInfos:e.yLt.filter(function(t){return t.RBt===n}),fields:e.lLt?e.lLt.getFields(function(t){return t.initialOptionIndex===n}):[]})},r=0,o=t;r<o.length;r++)n(u=(a=o[r]).oldIndex,s=a.newIndex);for(c=function(t,n,e){t.forEach(function(t){return t.RBt=e}),n.forEach(function(t){return t.initialOptionIndex=e})},f=0,l=i;f<l.length;f++)c(d=(h=l[f]).columnInfos,v=h.fields,s=h.newIndex)},MLt:function(){var n=this,t;return n.CLt.map(function(t){return n.SLt(t)})},TLt:function(t,n){var e,i,r,r,o,a,o,a,u,o,e=this,i=e.MLt(),r=e.ALt(i);if(0<r.length&&(t=r[t],n=r[n]),(r=e.ILt[t])&&"string"==typeof r.cross){if(o=e.ILt[t-1]||{},a=e.ILt[t+1]||{},o.cross===r.cross||a.cross===r.cross)return!0;if(o=e.ILt[n],a=e.ILt[t<n?n+1:n-1]||{},o.cross===r.cross||a.cross===r.cross)return!0}return u=function(t,n){return-1<i.indexOf(t)?u(t+n,n):t},(o=function(t,n){var t=e.ILt[u(t,-1)]||{},n=e.ILt[u(n,1)]||{};if("string"==typeof t.cross&&t.cross===n.cross)return!0})(t-1,t+1)||(t<n?o(n,n+1):o(n-1,n))},xLt:function(t){for(var e,i,n,r,e=this,i=0,n=function(t){return t&&0===t.length?a:t},r=function(){var n=e.yLt[i];n.RBt===t?(e.NLt=e.NLt&&e.NLt.filter(function(t){return t.field!==n.value}),e.kLt=e.kLt&&e.kLt.filter(function(t){return t.field!==n.value}),e.DLt=e.DLt&&e.DLt.filter(function(t){return t.field!==n.value}),e._Lt=e._Lt&&e._Lt.filter(function(t){return t.field!==n.value}),e.yLt.splice(i,1),e.lLt&&e.lLt.removeFields(i)):i++};i<e.yLt.length;)r();e.NLt=n(e.NLt),e.kLt=n(e.kLt),e.DLt=n(e.DLt),e._Lt=n(e._Lt)},ELt:function(){var e=this;e.ILt.forEach(function(t,n){(0,r.isNullOrUndefined)(t.cross)||((0,r.isNullOrUndefined)(t.LBt)&&(t.LBt=n),e.yLt[n].LBt=t.LBt)})}})},"./dist/src/view/view-event.js":function(t,n,e){"use strict";var n,g,p,i,b,e,r,y;function o(n){var t,e,i,r,o,a,u,t=[],e=[],i=Object.keys(p.Events);if((0,g.isArray)(n))for(r=function(n){(i.some(function(t){return t===n})?t:e).push(n)},o=0,a=n;o<a.length;o++)r(u=a[o]);else i.some(function(t){return t===n})&&t.push(n);return[t,e]}Object.defineProperty(n,"__esModule",{value:!0}),n=e("Common"),g=e("./dist/src/dataSource/utils.js"),p=e("./dist/src/table/tableEvents.js"),i=e("./dist/src/view/view.js"),b=e("./dist/src/view/view-util.js"),e=n.Common.lt.Dh,r=null,y=void 0,e(i.View.prototype,{bind:function(t,n){var e=this,t=o(t),i=t[0],t=t[1];0<t.length&&(e.jLt(t,n),this.gLt.bind(t,n)),0<i.length&&this.D3(i,this.OLt(n))},D3:function(t,n){var e,n,e=this,n=e.RLt(n);e.jLt(t,n),e.gLt.bind(t,n)},unbind:function(t,n){this.gLt.unbind(t,n)},ki:function(t,n){return this.gLt.ki(t,n)},vOt:function(t){return this.gLt.vOt(t)},jLt:function(t,n,e){var i,r,o,a,u,s,c,f,l,i=this;if(n)for(r=(e||i.gLt).name,u=o=(a=0,g.isArray)(t)?t:[t];a<u.length;a++)s=u[a],(c=(0,g.isFunction)(n)?n:n[s])&&(l=(f=i.BLt[r]=i.BLt[r]||{})[s]=f[s]||[]).push(c)},OLt:function(o){var a=this;return function(t,n){var e,i,r;if(a.LLt(n),(0,g.isArray)(o))for(e=0,i=o;e<i.length;e++)(r=i[e]).call(a,t,n);else o&&o.call(a,t,n)}},LLt:function(t){var n=this;t.hasOwnProperty("row")||Object.defineProperty(t,"row",{get:function(){return(0,g.isNumber)(t.Ky)||(t.Ky=n.FLt(t.index)),t.Ky}})},RLt:function(e){var i=this;return function(t,n){i.PLt()&&e.call(i,t,n)}},PLt:function(t){return(0,g.isBoolean)(t)&&(this.rb=!t),!this.rb},GLt:function(n,e){var i=this;return i.PLt(!1),{success:function(t){i.PLt(!0),n&&n(t)},fail:function(t){i.PLt(!1),e&&e(t)}}},v7:function(){var o=this;o.D3(p.Events.ItemInserting,function(t,n){var e=n.index,n=n.data;o.ULt(n),e===o.length()&&o.Dit()&&o.HLt(n,e)}),o.D3(p.Events.ItemInserted,function(t,n){var e=n.index,n=n.data;o.zLt(e,n)}),o.D3(p.Events.ItemUpdating,function(t,n){var e=n.data,i=n.index,r=n.field,n=n.originalValue;o.VLt(e,n,r,i)}),o.D3(p.Events.ItemUpdated,function(t,n){var e=n.index,i=n.field,r=n.originalValue,n=n.newValue;o.YLt(e,i,r,n)}),o.D3(p.Events.ItemReset,function(t,n){var e=n.index,i=n.originalData,n=n.dataBeforeChanged;o.ZLt(e,i,n)}),o.D3(p.Events.ItemRemoved,function(t,n){var e=n.index,n=n.count;o.WLt(e,n)}),o.D3(p.Events.ChangesSubmitted,function(t,n){o.QLt()}),o.D3(p.Events.ChangesCancelled,function(t,n){o.KLt(n.isDataLengthChanged)})},wpt:function(){var t,n,e,i,r,o,a,u,s,c,t=this,n=t.BLt;for(e in n)if(n.hasOwnProperty(e))for(r in i=n[e])if(i.hasOwnProperty(r))for(a=0,u=o=i[r];a<u.length;a++)s=u[a],(c=t.gLt.QOt.tables[e]).unbind(r,s);t.BLt={}},$Ot:function(t){var n,e,i,r,o,a,u,s,c,n,e=this.BLt,i=t.name,r=e[i];for(o in r)if(r.hasOwnProperty(o))for(u=0,s=a=r[o];u<s.length;u++)c=s[u],t.unbind(o,c);e[i]=y},KOt:function(t,n){var e,i,r,e,i=this.BLt,r=i[t];delete i[t],i[n]=r},JLt:function(){var t,n,e,i,r,o,a,u,u;if(this.XLt())for(e=(n=t=this).name,i=t.yLt,r=t.gLt,o=0,a=i;o<a.length;o++)u=a[o],(0,g.isFunction)(u.value)||(0,b.isFormula)(u.value)||!(0,b.isRelation)(u.value)||(u=r.qRt(u.value),!(0,g.isNullOrUndefined)(u)&&(0,g.isNullOrUndefined)(u.VOt[e])&&(u.VOt[e]=n,t.qLt(u)))},qLt:function(e){var v,m,t,h,d,t,o,v=this,m=v.gLt,t=m.QOt.relationships.reduce(function(t,n){return n.sourceTable===m&&n.targetTable===e?{relationshipName:n.sourceRelationshipName,relationFieldName:n.sourceFieldName}:n.sourceTable===e&&n.targetTable===m?{relationshipName:n.targetRelationshipName,relationFieldName:n.targetFieldName}:t},{}),h=t.relationshipName,d=t.relationFieldName,t=function(t,l){var n=v.RLt(function(o,a){var n,t,e,u,e,i,r,s,c,f,n=function(t,n){var t=t.value.split(".");return t[t.length-1-n]},t=v.ILt.filter(function(t){return(0,b.isRelation)(t.value)&&n(t,1)===h}),e=t;if(a.eventName!==p.Events.ItemUpdating&&a.eventName!==p.Events.ItemUpdated||(e=e.filter(function(t){return n(t,0)===a.field})),u=[y],e.forEach(function(n){var t,e,i,r,t=!(0,g.isNullOrUndefined)(n.cross);t?(i=("string"==typeof n.cross?v.LEt.cross[n.cross]:n.cross).over,(0,g.isNullOrUndefined)(v.NLt)||-1<(r=(0,g.findIndex)(v.NLt,function(t){return-1<t.field.indexOf(n.value)&&-1<t.field.indexOf(i)}))&&(e=v.NLt[r].field)):v.$Lt(n.value)&&u.push(n.value),l.call(v,n.value,t,e)(o,a)}),a.eventName===p.Events.ItemInserted||a.eventName===p.Events.ItemRemoved||a.eventName===p.Events.ItemUpdated){if(a.eventName===p.Events.ItemUpdated&&(e=d===a.field,i=t.some(function(t){var n;if(!(0,g.isNullOrUndefined)(t.cross)&&("string"==typeof t.cross?v.LEt.cross[t.cross]:t.cross).over.split(".").pop()===a.field)return!0;return!1}),e||i))for(c=r=m.nBt(t[s=0].value,a.index);s<c.length;s++)f=c[s],v.vLt(f);u.forEach(function(t){v.tFt(y,!0,t,y)})}});v.jLt(t,n,e),e.bind(t,n)},o=function(t,n,e,i){var r,r,r,o,a,u,s,c,f,l,f,h,d;if(v.Dit())for(a=0,u=o=i.relatedViewIndexes||m.nBt(t,i.index);a<u.length;a++)s=u[a],l=f=c=void 0,l=n?(v.vLt(s),c=m.LRt(e,s),(r={})[e]=c,f=r,v.nFt(s,((r={})[e]=!0,r))[e]):(c=m.LRt(t,s),(r={})[t]=c,f=r,m._getValueByField(t,s)),f=v.eFt(s,f).data,v.iFt(f,c,t,s),v.hRt(s,t,c,l),m.hRt(s,t,c,l);else if(n)for(h=0,d=o=i.relatedViewIndexes||m.nBt(t,i.index);h<d.length;h++)s=d[h],v.vLt(s)};t(p.Events.ItemRemoving,function(e,i){return function(t,n){i&&(n.relatedViewIndexes=m.nBt(e,n.index))}}),t(p.Events.ItemRemoved,function(e,i,r){return function(t,n){o(e,i,r,n)}}),t(p.Events.ItemInserted,function(e,i,r){return function(t,n){o(e,i,r,n)}}),t(p.Events.ItemUpdating,function(c,f,l){return function(t,n){var e,e,i,r,o,a,u,s,s;if(v.Dit())for(i=n.relatedViewIndexes=m.nBt(c,n.index),n.relatedViewValues=[],r=0,o=i;r<o.length;r++)a=o[r],s=u=void 0,f?u=(s=v.nFt(a,((e={})[l]=!0,e)))[l]:(u=m._getValueByField(c,a),(e={})[c]=u,s=e),s=v.eFt(a,s).data,n.relatedViewValues[a]=u,v.iFt(s,u,c,a)}}),t(p.Events.ItemUpdated,function(c,f,l){return function(t,n){var e,i,r,o,a,u,s;if(v.Dit())for(r=0,o=i=n.relatedViewIndexes||m.nBt(c,n.index);r<o.length;r++)a=o[r],u=n.relatedViewValues[a],s=void 0,f?(s=v.nFt(a,((e={})[l]=!0,e))[l],c=l):s=m._getValueByField(c,a),v.hRt(a,c,u,s),m.hRt(a,c,u,s)}})}})},"./dist/src/view/view-filter.js":function(t,n,e){"use strict";var v,o,m,n,d,i;function g(t){return r(t[0])}function r(t){return t&&void 0!==t.Vce}function a(t,n){for(var e,i,r,e=["field","value","operator","relation"],i=0;i<e.length;i++)if(t[r=e[i]]!==n[r])return!1;return t.ort===n.ort}function p(t,n){for(var e,i,r,o,a,e={},i=0;i<t.length;i++)if(!e[r=t[i].field]){for(o=e[r]=[],a=i;a<t.length;a++)t[a].field===r&&o.push(t[a]);n(r,o)}}Object.defineProperty(n,"__esModule",{value:!0}),v=e("./dist/src/dataSource/utils.js"),o=e("./dist/src/table/table.js"),m=e("./dist/src/view/view-util.js"),n=e("Common"),d=e("./dist/src/view/view.js"),(i=n.Common.lt.Dh)(d.View.prototype,{buildInFilter:function(u){var s,c,f,l,t,h,n,e,i,r,e,o,a,s=this.gLt,c={};if(1<u.length){for(f=[],l=[],t=function(i){var t,n,e,r,t,o,a,t=u[i],n=t.field,e=t.operator,r=t.value,t=t.relation,o=c[n];o=o||(c[n]=s.jRt(n)),l.push(t),a=(0,d.rFt)(h.gLt,h.yLt,h.lLt,n,u[i]),a=(0,m.mapGetValueFunc)(o,a),a=(0,m.oFt)(h,e,r,a),f.push(function(t,n,e){return a(t,e,n[i])})},h=this,n=0;n<u.length;n++)t(n);return(0,m.aFt)(f,l)}return i=(e=u[0]).field,r=e.operator,e=e.value,o=s.jRt(i),a=(0,d.rFt)(this.gLt,this.yLt,this.lLt,i,u[0]),a=(0,m.mapGetValueFunc)(o,a),a=(0,m.oFt)(this,r,e,a,i),function(t,n,e){return a(t,e,n[0])}},uFt:function(t){var n=this,e=n.ZOt,i;return n.gLt.ZOt[t]||e[t]},eRt:function(t,n){var e=this,i=e.gLt,r=e.yLt,o,a=[],u=[];t.forEach(function(n){(o=r.filter(function(t){return t.value===n})[0])&&((0,m.isViewColumn)(o)?a:u).push(n)}),i.eRt(u,n),e.sFt(a)},sFt:function(t){for(var n,e,i,r,o,n,e=this.ZOt,i=0,r=t;i<r.length;i++)e[o=r[i]]||(e[o]=this._Rt(o))},cFt:function(){this.ZOt={}},_Rt:function(t){var n=this.lLt.getFieldByName(t);return(0,o.generateFilterIndexCache)(t,(0,v.isNullOrUndefined)(n)?0:this.length(),this.jRt(t),function(t){return n.getValue(t)})},cRt:function(t,n){var e=this,i,r=e.gLt._dataSource.options.schema;e.Yce(t),(0,o.updateFilterIndexesCacheOnInsert)(this.ZOt,t,n,r&&r.columns)},hRt:function(t,n,e,i){var r=this;r.Yce(t,!1,n),(0,o.updateFilterIndexesCacheOnUpdate)(r.ZOt,t,n,e,i,r.jRt(n))},pRt:function(t,n,e){var i,r,o,a,u,u,i=this,r=i.yLt;if(!(0,v.isNullOrUndefined)(n)&&!(0,v.isNullOrUndefined)(e))for(o=0,a=r;o<a.length;o++)u=(u=a[o]).value instanceof Function?u.value.name:u.value,i.hRt(t,u,n[u],e[u])},MRt:function(t,n){var e=this;e.Zce(t,n),(0,o.updateFilterIndexesCacheOnRemove)(e.ZOt,t,n)},fFt:function(t){var e,i,r,n,o,a,u,s,c,f,l,h,d;if(t){if(i=(e=this).iRt,r=[],o=(n=e.lFt).length,n&&0<o&&(r=i.slice(0,o)),a=o,"string"==typeof t)for(u=e.Ywt(t,0,0),s=o;s<i.length;s++)c=i[s],!0===e.nMt(u,c,0)&&(r[a]=c,a++);else if("function"==typeof t)for(s=o;s<i.length;s++)c=i[s],t(e.getRowData(c,!0))&&(r[a]=c,a++);else{if(i.length!==e.length())return e.Wce(),void e.Qce(t,r,i);for(d in(0,v.isArray)(t)||(t=[t]),(0,v.isNullOrUndefined)(e.Jce)&&(e.Jce={}),f=e.isHierarchy(),e.qce(t,function(t,n){e.Qce(n,r,i.slice()),f&&g(n)&&e.rfe(n),e.tfe(t,n)}),l=[],h=function(n){t.some(function(t){return t.field===n})?f&&g(e.Jce[n].options)||l.push(n):delete e.Jce[n]},e.Jce)h(d);r=e.nfe(l)}e.iRt=r}},Qce:function(t,i,n){var r,e,o,a,u,s,c,f,l,h,d,r=this,e=(r.lFt||[]).length,o=e;for((0,v.isArray)(t)||(t=[t]),u=[],s=[],c=0;c<t.length;c++)f=t[c],((0,m.isFieldListFilterInfo)(f)?u:s).push(f);if(l=i,h=n,0<u.length&&(l=i.slice(),p(t=u,function(t,n){var t=t,e=r.uFt(t);e||(r.eRt([t]),e=r.uFt(t)),(0,m.hFt)(l,o,e,n,h),h=l,l=i.slice()}),l=h),0<s.length)for(l=i.slice(),t=s,a=this.buildInFilter(t),c=e;c<h.length;c++){d=h[c];try{a(r.gLt,t,d)&&(l[o]=d,o++)}catch(t){}}r.iRt=l},tfe:function(t,n){var e,i,r,o,e=this;if(!(0,v.isNullOrUndefined)(t))for(i=e.lFt||[],r=e.Jce[t]={options:n,count:e.iRt.length-i.length},o=i.length;o<e.iRt.length;o++)r[e.iRt[o]]=!0},rfe:function(e){for(var i,r,t,n,o,a,u,s,c,f,l,h,d,v,i=this,r=[],t=function(t){var n=e[t];r.push(i.yLt.find(function(t){return t.value===n.field}))},n=0;n<e.length;n++)t(n);for(o=i.lFt||[],a=i.iRt.slice(0,o.length),n=o.length;n<i.iRt.length;n++)if(u=i.iRt[n],0===(s=i.getHierarchyNode(u,!0)).children.length)for(c=0;c<e.length;c++){for(f=e[c],l=s,h=0;h<f.Vce.length&&(d=f.Vce[h],(v=i.ofe(r[c],l.modalIndex))===d);h++)l=l.parent;if(h===f.Vce.length){a.push(u);break}}i.iRt=a},Wce:function(){this.Jce=null},Yce:function(t,n,e){var i,r,o,a,u,s,c,f,l,i=this,r=i.Jce;if(r&&!(-1<(o=i.lFt||[]).indexOf(t))){for(u in a=i.iRt,r)!(0,v.isNullOrUndefined)(e)&&u!==e||(c=(s=r[u]).options,f=a.slice(0,o.length),l=a.slice(0,o.length).concat(t),i.Qce(c,f,l),-1<i.iRt.indexOf(t)?s[t]||(s[t]=!0,s.count+=1):s[t]&&(delete s[t],--s.count));i.iRt=a}},Zce:function(t,n){var e,i,r,o,a,u,s,c,f,e=this,i=e.Jce;if(i&&!(-1<(r=e.lFt||[]).indexOf(t)))for(o in i)if(i.hasOwnProperty(o)){for(u=(a=i[o]).options,delete a.options,delete a.count,s=Object.keys(a),c=0;c<s.length;c++)t+n<=(f=+s[c])?s[c]=f-n:t<=f&&f<t+n&&(s.splice(c,1),c--);(a=s.reduce(function(t,n){return t[n]=!0,t},{})).options=u,a.count=s.length,i[o]=a}},nfe:function(t){var n,e,i,r,o,a,u,s,n=this;if(0<t.length){if(e=n.lFt||[],i=n.iRt,r=n.Jce,1===t.length&&i.length-e.length===r[t[0]].count)return i;for(o=i.slice(0,e.length),a=e.length;a<i.length;a++){for(u=i[a],s=0;s<t.length&&r[t[s]][u];s++);s===t.length&&o.push(u)}return o}return n.iRt},dFt:function(){var t,n,e,i,r,o,a,u,t=this.iRt,e=this.lFt,i=e.length;for(e&&0<i&&(n=t.slice(0,i)),r=[],o=this.length(),u=a=0;u<o;u++)(!n||n.indexOf(u)<0)&&(r[a]=u,a++);n&&0<n.length?this.iRt=n.concat(r):this.iRt=r,this.cFt()},HLt:function(t,n){var e=this,i=e.NLt;e.Dit()&&e.autoFilter&&(0,m.addFilterInfoForFieldValue)(i,t,e,void 0,void 0,n)},iFt:function(t,n,e,i){var r=this,o=r.NLt;r.Dit()&&r.autoFilter&&(0,m.addFilterInfoForFieldValue)(o,t,r,n,e,i)},vFt:function(){var t=this;t.mFt()&&t.filter(t.NLt)},mFt:function(){return this.autoFilter&&this.NLt},Dit:function(){var t,n=this.NLt;return(0,v.isArray)(n)&&0<n.length},filter:function(t){var n=this;return n.iRt||n.gFt(),t?(n.isHierarchy()&&n.$ce(),n.fFt(t),n.isHierarchy()&&n.yFt(!0)):n.isHierarchy()?n.gFt():this.dFt(),this.NLt=(0,v.isArray)(t)&&0<t.length?t:null,this.iRt.length},$ce:function(){var e=this;e.bFt().forEach(function(t){var n;e.getHierarchyNode(t,!0).modalIndex=t})},yFt:function(t){var n,e,i,r,o,a,u,s,c,t,f,n=this,e=n.iRt;if(!(0,v.isNullOrUndefined)(e)&&0!==e.length){for(t||n.$ce(),i=[],r=1,o=0;o<e.length;o++)a=e[o],(u=n.getHierarchyNode(a,!0)).visit=r,(0,v.bubbleTree)(u,function(t){t.isRoot||(t.visit=r)}),(0,v.traversalTree)(u,function(t){t.visit=r});for(c in n.Jce)if(g(n.Jce[c].options)){s=n.Jce[c];break}if(!(0,v.isNullOrUndefined)(s)){for(a in r=2,t=s.options,f=s.count,delete s.options,delete s.count,s)s.hasOwnProperty(a)&&(u=n.getHierarchyNode(+a,!0),(0,v.isNumber)(u.visit))&&(u.visit=r,(0,v.bubbleTree)(u,function(t){t.isRoot||(t.visit=r)}));s.options=t,s.count=f}(0,v.traversalTree)(n.getHierarchyRootNode(),function(t){t.visit===r&&(i.push(t.modalIndex),delete t.visit,delete t.modalIndex)}),n.iRt=i}},bFt:function(){var t=this,n=t.iRt,e,i=t.isHierarchy(),e=t.wFt;return i&&!(0,v.isNullOrUndefined)(e)||(t.gFt(),t.sort(t.kLt),e=t.iRt,t.iRt=n,i&&(t.wFt=e)),e},qce:function(t,r){var o=this;(0,v.isNullOrUndefined)(o.Jce)&&(o.Jce={}),p(t,function(t,e){var n=o.Jce[t],i;!(0,v.isNullOrUndefined)(n)&&n.options.length===e.length&&n.options.every(function(n){return e.some(function(t){return a(n,t)})})||r(t,e)})}})},"./dist/src/view/view-group.js":function(t,n,e){"use strict";var i,r,p,u,b,y,w,e,o,f;function s(s,c,f){for(var l,h,d,v,m,t,n,g,e,i,r,l=[],h=-1,d=-1,v=w.GROUP_COLUMN_WIDTH,m={},t=function(t){for(var n,e,i,r,n=s[t],e=0,i=f;e<i.length;e++)r=i[e],n.value===r.field&&(n.GFt=!0,m[(0,y.combineName)(n.value,(0,p.findIndex)(f,function(t){return t.field===n.value}))]={colInfo:n,index:t})},n=0;n<s.length;n++)t(n);for(e=function(t,n){var e,i,r,o,a,u,e=c.getField(g[t]),i=e.name,r,o={caption:e.extra.caption,value:i,name:i,isGroup:!0};-1<(d=(0,p.findIndex)(f,function(t,n){return(0,y.combineName)(t.field,n)===i}))&&(v=(0,w.getGroupColumnWidth)(f[d].field,s),h=d,o.DFt=!0,a=m[i],(0,p.isNullOrUndefined)(a)||(a.colInfo._Ft=t,o._Ft=a.index+n)),o.OFt=h,o.width=v,(u=e.extra)&&(0,b.setFieldExtraProperties)(function(t){u[t]&&(o[t]=u[t])}),l.push(o)},i=0,r=(g=c.positionOfField).length-c.keysOfBaseField.length;i<r;i++)e(i,r);return l}Object.defineProperty(n,"__esModule",{value:!0}),n.que=void 0,i=e("Common"),r=e("./dist/src/view/view.js"),p=e("./dist/src/dataSource/utils.js"),u=e("./dist/src/viewField/groupManager.js"),b=e("./dist/src/viewField/fields.js"),y=e("./dist/src/viewField/utils.js"),w=e("./dist/src/view/view-util.js"),e=i.Common.lt.Dh,o=null,f=void 0,n.que=s,e(r.View.prototype,{groupBy:function(t){var n,e,n=this;return 0===arguments.length||!(0,p.isArray)(t)||n.hasHierarchyColumn()||0===(t=0<(e=n.yLt.filter(function(t){return t.isCross})).length?t.filter(function(n){return!e.some(function(t){return t.value===n.field})}):t).length?n.MFt:(n.iRt||n.gFt(),n.CFt(t),n.SFt(),n.TFt(t),void(this.MFt=t))},removeGroupBy:function(){var t=this;t.isHierarchy()||(t.AFt(),t.IFt(),t.SFt(),t.MFt=o,t.xFt(),t.NFt())},AFt:function(){var t;this.kFt()},IFt:function(){var t,n,e,i,r,o,a,u,s,c,t=this,n=t.gLt,e=t.NLt,i=t.ZOt,r=t.getColumnInfos();if(e){for(c=e.length-1;0<=c;c--)o=e[c],(a=r.filter(function(t){return t.name===o.field})[0]).DFt?(u=(0,w.getColumnName)(r[a._Ft]),(s=i[o.field])&&(n.ZOt[u]=i[o.field],delete i[o.field]),o.field=u):a.isGroup&&(e.splice(c,1),delete i[o.field]);t.NLt=0===e.length?f:e}},xFt:function(){var t,n,e,i,r,t=this;if(t.kLt){for(n=[],e=0,i=t.kLt;e<i.length;e++)delete(r=i[e]).EFt,r.jFt?(0,u.isGroupField)(r.field)&&(delete r.jFt,delete r.OFt,r.field=(0,u.getGroupFieldName)(r.field),n.push(r)):n.push(r);t.kLt=0===n.length?f:n}t._Lt=f,t.DLt=t.kLt},CFt:function(t){var n,e,i,r,o,t,o,r,e;t&&(this.kFt(),e=(n=this).iRt,i=n.lLt||n.RFt(),r=n.BFt||n.LFt(t),o=e,n.length()>e.length?((0,p.isNullOrUndefined)(n.Dfe)&&(n.Dfe=n.qFt()),o=n.Dfe):n.Dfe=f,t=i.buildGroupFields(t,o),r=(o=r.groupBy(t,e)).rootNode,e=o.indexMap,n.FFt=r,n.iRt=e,i.transposeSliceFields(t))},kFt:function(){var t,n,n=this;(n.BFt=null)!=(t=n.lLt)&&t.reset(),n.FFt=null},PFt:function(t){var n=this;n.autoGroup&&n.MFt&&(!(0,p.isString)(t)||n.$Lt(t))&&n.CFt(n.MFt)},$Lt:function(n){var t=this;return t.MFt&&t.MFt.some(function(t){return t.field===n||t.summaryFields&&t.summaryFields.some(function(t){return t.formula&&-1<t.formula.indexOf(n)||t.slice&&("string"==typeof t.slice?-1<t.slice.indexOf(n):t.slice.field&&-1<t.slice.field.indexOf(n))})})},LFt:function(t){var n=this,e,i=n.gLt.POt;return n.BFt=new u.GroupManager(t,i.wEt.bind(i)),n.BFt},SFt:function(){for(var t,n,e,i,t=this,n=t.getColumnInfos(),e=n.length-1;0<=e;e--)(i=n[e]).isGroup&&n.splice(e,1),i.GFt&&(i.GFt=f,i._Ft=f);t.setColumnInfos(n)},TFt:function(t){for(var n,e,i,r,o,a,u,n=this,e=s(n.yLt,n.lLt,t),i=n.UFt,r,o=0,a=n.getColumnInfos();o<a.length;o++)u=a[o],i||(u.visible=!1),e.push(u);n.setColumnInfos(e)},HFt:function(t){var e,n,i,r,o,a,u,s,c,f;if(t){for(n=(e=this).FFt,i=[],r=e.yLt,o=Array.isArray(t)?t:[t],a=[],u=[],s=function(t){var n,t,n=o[t],t=r.filter(function(t){return t.value===n.field})[0];(t&&(0,p.isNumber)(t.OFt)?(n.jFt=!0,n.EFt=e.zFt([n]),n.OFt=t.OFt,a):u).push(n)},c=0;c<o.length;c++)s(c);f=e.zFt(u),u.forEach(function(t){return t.EFt=f}),e.VFt(n,i,0,a,u),e.iRt=i}},VFt:function(t,n,e,i,r){var o,t,a,u,s,c,f,l,h,d,v,o=this,t=t.children;if(t)for(1<t.length&&0<i.length&&0<(s=i.filter(function(t){return t.OFt===e})).length&&(c=s[0].EFt,t.sort(function(t,n){return c(o.gLt,s,t.key,n.key)})),f=0,l=t;f<l.length;f++)if(u=(h=l[f]).recordIndexes)for(1<u.length&&0<r.length&&(c=(s=r)[0].EFt,u.sort(function(t,n){return c(o.gLt,s,t,n)})),a=n.length,d=0,v=u.length;d<v;d++)n[a+d]=u[d];else o.VFt(h,n,e+1,i,r)},setGroupSliceColumnSettings:function(t,n){var e=this,i=t[n];t.isGroup&&e.isGroupSliceColumn(t)&&e.getGroupSliceColumns(t).forEach(function(t){return t[n]=i})},isGroupSliceColumn:function(t){return t.isGroup&&(0,u.isGroupSlice)(t.value)},getGroupSliceColumns:function(t){var n,e,i,r,o,a,n,e=[],i=t.OFt,r=this.yLt;if(t.isGroup)for(o=0;o<r.length;o++)(a=r[o]).OFt===i&&(0,u.isGroupSlice)(a.value)&&e.push(a);return e},updateColumnSettingToGroupOptions:function(t,i){var n,e,r,o,a,n,e=this.MFt;if(e&&t.isGroup)switch(o=function(n,e){(0,b.setFieldExtraProperties)(function(t){!(0,p.isNullOrUndefined)(i)&&i!==t||(n[t]=e[t])})},(r=(0,u.getGroupOptionIndexesFrom)(t.value)).length){case 1:o(e[r[0]],t);break;case 2:o(e[r[0]].summaryFields[r[1]],t);break;case 3:o(a="string"==typeof(a=e[r[0]].summaryFields[r[1]].slice)?e[r[0]].summaryFields[r[1]].slice={field:a}:a,t)}},detailColumnsVisible:function(t){var n,e,n,i,n=this;if(0===arguments.length)return n.UFt;if(n.UFt!==t&&(n.UFt=t,n.BFt))for(e=n.getColumnInfos(),i=(n=n.lLt).positionOfField.length-n.keysOfBaseField.length;i<e.length;i++)e[i].visible=t}})},"./dist/src/view/view-sort.js":function(t,n,e){"use strict";var i,d,v,m,e;function u(i){return i.iRt.reduce(function(t,n){var e=i.getHierarchyNode(n,!0);return(0,d.isNullOrUndefined)(e)||(t[e.id]=n),t},{})}function s(n,e){return function(t){(0,d.isNullOrUndefined)(n[t.id])||e.push(n[t.id])}}function g(t,n,e,i,r){for(var o,a,u,s,o={},a=(0,v.rFt)(t,n,e,r,o),u=0;u<i.length;u++)if(s=a(o,u,o),!(0,d.isNullOrUndefined)(s))return s;return null}function p(t,n,e,i,r,o){var a,u,s,c,f,l,h;if(1===r.length)return o=o||0,a=r[0],u=(0,v.rFt)(t,n,e,a.field,a),s=void 0,s=a.compare?function(t,n,e,i){var e,t,e=u(t,e,n[o]),t=u(t,i,n[o]);return n[o].compare(e,t,n[o].ascending)}:null===(c=g(t,n,e,i,a.field))?function(){return 0}:(f=a.ascending,function(t,n,e,i){var e,t,e=u(t,e,n[o]),t=u(t,i,n[o]);return(0,m.compareValue)(f,c,e,t)});for(l=0;l<r.length;l++)a=r[l],(h=(0,v.ZFt)(t,n,a.field)).isGroup&&(0,d.isNullOrUndefined)(a.ascending)&&(a.compare=function(t,n){return t===n?0:1}),a.WFt=p(t,n,e,i,[a],l);return m.multiSort}Object.defineProperty(n,"__esModule",{value:!0}),n.Xue=void 0,i=e("Common"),d=e("./dist/src/dataSource/utils.js"),v=e("./dist/src/view/view.js"),m=e("./dist/src/view/view-util.js"),e=i.Common.lt.Dh,n.Xue=p,e(v.View.prototype,{zFt:function(t,n){return p(this.gLt,this.yLt,this.lLt,this.iRt,t,n)},QFt:function(t){var n;t&&((n=this).isHierarchy()?(n.wFt=null,n.DLt=(0,m.getSortInfos)(t),n.KFt(t)):n.MFt?(n._Lt=(0,m.getSortInfos)(t),n.HFt(t)):(n.DLt=(0,m.getSortInfos)(t),n.JFt(t)))},JFt:function(t){var e,n,i,r,o,a,u,r,o,t,o,r,o,t,n,r;t&&(n=(e=this).iRt,o=(r=e.lFt).length,r&&0<o&&(i=n.slice(0,o),n=n.slice(o)),a=Array.isArray(t)?t:[t],u=e.zFt(a),t=void 0===(o=(r=a[0]).startRow)?0:o,r=void 0===(o=r.endRow)?e.length():o,o=n.slice(0,t),(t=n.slice(t,r)).sort(function(t,n){return u(e.gLt,a,t,n)}),n=n.slice(r),r=o.concat(t,n),i&&0<i.length?e.iRt=i.concat(r):e.iRt=r)},XFt:function(){var t,n,e,t=this,n=t.gLt.uBt();return!(0,d.isNullOrUndefined)(n)&&(0,d.isNullOrUndefined)(t.kLt)?((!t.iRt||t.iRt.length<t.length())&&(t.iRt=t.qFt()),t.iRt&&0<t.iRt.length&&(e={field:n,ascending:!0},t.isHierarchy()?t.KFt(e):t.JFt(e)),!0):(0,d.isNullOrUndefined)(n)&&(0,d.isNullOrUndefined)(t.kLt)&&t.isHierarchy()?((!t.iRt||t.iRt.length<t.length())&&(t.iRt=t.qFt()),t.iRt&&0<t.iRt.length&&t.$Ft(),!0):void 0},KFt:function(e){var i,t,n,r,o,a;e&&(t=(i=this).getHierarchyRootNode(),n=[],r=Array.isArray(e)?e:[e],o=u(i),a=i.zFt(r),r.forEach(function(t){return t.EFt=a}),(0,d.traversalTree)(t,s(o,n),{compareFn:function(t,n){return a=(e=r)[0].EFt,(0,d.isNullOrUndefined)(o[t.id])||(0,d.isNullOrUndefined)(o[n.id])?0:a(i.gLt,e,o[t.id],o[n.id])}}),i.iRt=n)},$Ft:function(){var t,n,e,i,t=this,n=t.getHierarchyRootNode(),e=[],i=u(t);(0,d.traversalTree)(n,s(i,e),{field:"sequence",isOrderChildren:!1}),t.iRt=e},NFt:function(){var t=this;t.tPt()&&t.sort(t.kLt)},tPt:function(){return this.autoSort&&this.kLt},sort:function(t){var n=this;n.iRt||n.gFt(),n.QFt(t),this.kLt=t},nPt:function(t){var n=this,e=n.autoSort,i=n.DLt&&0<n.DLt.length,r=n._Lt&&0<n._Lt.length;e&&i&&(n.isHierarchy()?n.KFt(n.DLt):n.JFt(n.DLt)),n.PFt(t),e&&r&&n.HFt(n._Lt)}})},"./dist/src/view/view-style.js":function(t,n,e){"use strict";var n,e,i;Object.defineProperty(n,"__esModule",{value:!0}),n=e("Common"),e=e("./dist/src/view/view.js"),(i=n.Common.lt.Dh)(e.View.prototype,{getStyleRules:function(){return this.LEt.styleRules},getStyleRule:function(t){var n=this.getStyleRules();return t?n[t]:n},addStyleRule:function(t,n,e){var i,r;t&&(i={},n&&(i.style=n),e&&(i.rule=e),(r=this.getStyleRules())[t]=i)},removeStyleRule:function(t){var n;delete this.getStyleRules()[t]},clearStyleRules:function(){this.LEt.styleRules={}}})},"./dist/src/view/view-util.js":function(B,r,t){"use strict";var y,c,I,u,s,f,w,x;function n(t,n,e,i){var r,t,r=t?e:i,t=t?i:e;return(0,I.isNullOrUndefined)(r)&&(0,I.isNullOrUndefined)(t)?0:(0,I.isNullOrUndefined)(r)?-1:(0,I.isNullOrUndefined)(t)?1:"number"==typeof n||n instanceof Date?r-t:t<r?1:r<t?-1:0}function e(t,n,e,i,r){var o,a;if(e instanceof Date)if(-1<u.indexOf(n))e=e.getTime(),o=i,i=function(t,n,e){return o(t,n,e)&&o(t,n,e).getTime()};else{if(-1<s.indexOf(n))return function(){return!1};if(-1<f.indexOf(n))return function(){return!0}}return a=l(t,n,e,r),function(t,n,e){return a(i(t,n,e))}}function l(t,n,e,i){var r,o,a,u,s,s,s,r=e+"",o=r&&r.length;switch((0,I.isString)(e)&&(a=c.Common.$T.jJ(e)),u=t.gLt,n){case"eq":return s=function(t){return t===e},(0,I.isNullOrUndefined)(e)&&(s=function(t){return t===w||t===x}),a?function(t){return new RegExp("^"+a+"$").test(t)}:s;case"neq":return s=function(t){return t!==e},(0,I.isNullOrUndefined)(e)&&(s=function(t){return t!==w&&t!==x}),a?function(t){return!new RegExp("^"+a+"$").test(t)}:s;case"lt":return function(t){return null!==t&&t<e};case"lte":return function(t){return null!==t&&t<=e};case"gt":return function(t){return e<t};case"gte":return function(t){return e<=t};case"startswith":return a?function(t){return new RegExp("^"+a).test(t)}:function(t){return"string"==typeof(t+"")&&(t+"").substr(0,o)===e};case"doesnotstartwith":return a?function(t){return!new RegExp("^"+a).test(t)}:function(t){return"string"==typeof(t+"")&&(t+"").substr(0,o)!==e};case"endswith":return a?function(t){return new RegExp(a+"$").test(t)}:function(t){return"string"==typeof(t+"")&&-1!==(t+"").indexOf(e,(t+"").length-o)};case"doesnotendwith":return a?function(t){return!new RegExp(a+"$").test(t)}:function(t){return"string"==typeof(t+"")&&-1===(t+"").indexOf(e,(t+"").length-o)};case"contains":return a?function(t){return new RegExp(a).test(t)}:function(t){return"string"==typeof(t+"")&&0<=(t+"").indexOf(e)};case"doesnotcontain":return a?function(t){return!new RegExp(a).test(t)}:function(t){return"string"==typeof(t+"")&&(t+"").indexOf(e)<0};case"top":case"bottom":return(s=t.uFt(i))||(t.eRt([i]),s=t.uFt(i)),e=h(Object.keys(s),n,e),function(t){return-1<e.indexOf(t)};case"above":return e=d(u._dataSource._data[i].data,u.jRt(i)),function(t){return e<t};case"below":return e=d(u._dataSource._data[i].data,u.jRt(i)),function(t){return t<e};case"quarter":return function(t){return v(e,t)};case"month":return function(t){return(t&&t.getMonth())===e};default:return function(){return!1}}}function h(t,n,e){for(var i,r,o,a,i=[],r=0,o=t;r<o.length;r++)a=o[r],isNaN(a)||i.push(parseFloat(a));return e>=i.length||("top"===n?i=m(i,e):"bottom"===n&&(i=b(i,e))),i}function d(t,n){var e,i,r,o,a,e=0;if(!t||0===t.length)return e;for(i=n&&n.dataMap,r=0,o=t;r<o.length;r++)a=o[r],"number"==typeof(a=i&&"number"==typeof i[a]?i[a]:a)&&(e+=a);return e/t.length}function v(t,n){var e=n&&n.getMonth();switch(t){case 0:return e<=2;case 1:return 3<=e&&e<=5;case 2:return 6<=e&&e<=8;case 3:return 9<=e;default:return!1}}function i(t,n,e,i){for(var r,o,a,u,r=0,o=0,a=n.length;o<a&&0===(r=(u=n[o]).WFt(t,n,e,i));o++);return r}function o(t){return Array.isArray(t)?t:[t]}function a(t,n){var e,i;if(0===t.length)return[];for(e=t.slice(0),i=0;i<n;i++)-1===t.indexOf(i)&&e.push(i);return e}function m(t,n){for(var e,i,r,e=g(t.slice(0,n)),i=n;i<t.length;i++)t[i]>e[0]&&(r=e[0],e[0]=t[i],t[i]=r,g(e));return e}function g(t){for(var n,e,n=t.length,e=Math.floor(n/2);0<=e;e--)p(t,e,n);return t}function p(t,n,e){var i,r,o,i,i=2*n+1,r=2*n+2,o=n;i<e&&t[i]<t[o]&&(o=i),n!==(o=r<e&&t[r]<t[o]?r:o)&&(i=t[n],t[n]=t[o],t[o]=i,p(t,o,e))}function b(t,n){for(var e,i,r,e=M(t.slice(0,n)),i=n;i<t.length;i++)t[i]<e[0]&&(r=e[0],e[0]=t[i],t[i]=r,M(e));return e}function M(t){for(var n,e,n=t.length,e=Math.floor(n/2);0<=e;e--)C(t,e,n);return t}function C(t,n,e){var i,r,o,i,i=2*n+1,r=2*n+2,o=n;i<e&&t[i]>t[o]&&(o=i),n!==(o=r<e&&t[r]>t[o]?r:o)&&(i=t[n],t[n]=t[o],t[o]=i,C(t,o,e))}function S(t,n){for(var e,i,r,o,e=0,i=t;e<i.length;e++)if(o=n(r=i[e]))return o}function T(t){var n,t,e,i,n=t.style,t=(t=(n=n||(t.style={})).cellButtons)||(n.cellButtons=[]),e=(e=n.dropDowns)||(n.dropDowns=[]);(i=S(t,function(t){return"openDateTimePicker"===t.command}))||t.push({imageType:"dropdown",command:"openDateTimePicker",useButtonStyle:!1,buttonBackColor:"transparent"}),(i=S(e,function(t){return"dateTimePicker"===t.type}))||e.push({type:"dateTimePicker",option:{showTime:!1,calendarPage:"day",startDay:"sunday"}})}function A(n,t){var e,i,e=(0,I.findIndex)(t,function(t){return N(t)===n});return-1<e&&(i=t[e]).width||r.GROUP_COLUMN_WIDTH}function N(t){var t=t.value;return"string"==typeof t?t:"function"==typeof t?t.name:void 0}function k(t){return!t.JOt}function D(t){var n,e,i,r,o,n=k(t);if(n){for(t.WOt++,i=0,r=e=t.eBt();i<r.length&&(!(o=r[i])||o.WOt||(n=D(o)));i++);t.WOt--}return n}function _(t){return t.isGroup||t.isCross}function E(t){return j(t[0])}function j(t){return t.operator===x}function O(t){return t[0].operator!==x&&t[0].ort}function R(t){return"="===t[0]}function L(t){return-1<t.indexOf(".")}function F(l,h,d,v,m,g){for(var p,b,t,n,e,i,p=d.isHierarchy(),b={},t=function(n){var t,e,i,r,o,a,u,s,c,f;if(n&&!b[n.field]){if(b[n.field]=!0,(t=d.uFt(n.field))||(d.eRt([n.field]),t=d.uFt(n.field)),e=t&&Object.keys(t),r=void 0,(i=h[n.field])instanceof Date){for((o=new Date(i)).setHours(0,0,0,0),a=o.toISOString().slice(0,10),r=!0,u=0,s=e;u<s.length;u++)if((c=s[u]).startsWith(a)){r=!1;break}}else r=(0,I.isNullOrUndefined)(i)?-1===e.indexOf("null")&&-1===e.indexOf("undefined"):-1===e.indexOf(i+"");if(!l.some(function(t){return t.field===n.field&&t.value===i})&&r&&(E(l)?(l.push(y(y({},n),{value:i,isAdded:!0})),p&&P(d,l[l.length-1],m,i,g)):(O(l)||i===v&&void 0===v)&&l.push(y(y({},n),{value:i,operator:"eq",relation:"or",isAdded:!0}))),-1<e.indexOf(v+"")&&1===t[v].length&&v!==i)for(f=0;f<l.length;f++)if(l[f].value===v&&l[f].isAdded){l.splice(f,1);break}}},n=0,e=l;n<e.length;n++)t(i=e[n])}function P(t,n,e,i,r){var e,o,a,u;if(n.field===e||(0,I.isNullOrUndefined)(e)){if(e=void 0,n.Vce)(e=n.Vce.slice())[0]=i;else{for(a=(o=t.getHierarchyNode(r,!0)).parent,u=[i];!a.isRoot;)u.push(a.getFieldValue(n.field)),a=a.parent;e=u}n.Vce=e}}function G(t){var n,e,i,r,r;if((0,I.isNullOrUndefined)(t))return t;for(n=[],e=0,i=t;e<i.length;e++)r=i[e],(r=y({},r)).getValue&&delete r.getValue,n.push(r);return n}function U(i,r){var t,o,a,t,o=function(n,e,i,t){return t.every(function(t){return t(n,e,i)})},a=function(){for(var t,n,e,t=[],n=[i[0]],e=1;e<i.length;e++)"or"===r[e]?(t.push(n),n=[i[e]]):n.push(i[e]);return 0<n.length&&t.push(n),t}();return function(n,e,i){return a.some(function(t){return o(n,e,i,t)})}}function H(t,i){var r;return t&&t.dataMap?(r=JSON.parse(JSON.stringify(t.dataMap)),function(t,n,e){var t=i(t,n,e);return void 0!==r[t]?r[t]:t}):i}function z(t,n,e,i,r){var o,a,u,i,s,c,f,l,h,d,v,m,g,p,b,y,o=[],a=!1,u=!1,i=i.map(function(t){var n=t.value;return n===w&&(a=!0),n===x&&(u=!0),t.value});for(a&&!u&&i.push(x),u&&!a&&i.push(w),s=0,c=i;s<c.length;s++)for(f=c[s],h=0,d=l=e&&e[f]||[];h<d.length;h++)o[v=d[h]]=!0;for(m=n,g=t.reduce(function(t,n){return t[n]=!0,t},{}),p=0,b=r;p<b.length;p++)!o[y=b[p]]||0<n&&g[y]||(t[m]=y,m++)}function V(t,n,e,i,r,o,a){var u,s,c,f,l,h,d,v,m,g,p,b,y,w,M,C,S,T,A,u=[],s=i.map(function(t,n){return n}),c=[];if(r&&r.length&&(f=!(s=[]),i.forEach(function(t,n){-1<o.indexOf(n)?(u.push(n),s.push(x)):(u.push(x),s.push(n)),t.isCross&&(f=!0)}),t=r[t],n=r[n],f)){for(l=[],h=[],d=0;d<i.length;d++)(i[d].isCross?(l[i[d].RBt]||(l[i[d].RBt]=[],c.push(l[i[d].RBt])),v=l[i[d].RBt]):c).push(d),t===d&&(t=c.length-1),n===d&&(n=c.length-1);for(m=0,g=o;m<g.length;m++)p=g[m],h.push(c.indexOf(p));u=[],s=[],c.forEach(function(t,n){-1<h.indexOf(n)?(u.push(n),s.push(x)):(u.push(x),s.push(n))}),e=1}if((0,I.swapArrayItems)(s,t,n,e),s=s.filter(function(t){return!(0,I.isNullOrUndefined)(t)}),r&&r.length){for(d=0;d<u.length;d++)void 0===u[d]&&(u[d]=s.shift());if(c&&c.length){for(b=[],y=0;y<u.length;y++)if(w=u[y],Array.isArray(c[w]))if("string"==typeof(M=a[y].cross)){for(C=[u[y]];y+1<a.length&&M===a[y+1].cross;)C=C.concat(u[y+1]),y++;for(S=c[C[0]].length,T=[],A=0;A<S;A++)for(d=0;d<C.length;d++)T.push(c[C[d]][A]);b=b.concat(T)}else b=b.concat(c[w]);else b.push(c[w]);u=b}}else u=s;return u}y=this&&this.__assign||function(){return(y=Object.assign||function(t){for(var n,e,i,r,e=1,i=arguments.length;e<i;e++)for(r in n=arguments[e])Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r]);return t}).apply(this,arguments)},Object.defineProperty(r,"__esModule",{value:!0}),r.ePt=r.hFt=r.mapGetValueFunc=r.aFt=r.removeExtraInfos=r.addFilterInfoForFieldValue=r.isRelation=r.isFormula=r.isFieldListFilterInfo=r.isFieldListFilter=r.isViewColumn=r.isTableDataReady=r.getColumnName=r.getGroupColumnWidth=r.applyDateTimePicker=r.array_find=r.generatePinnedColumnIndexMap=r.getSortInfos=r.multiSort=r.oFt=r.compareValue=r.GROUP_COLUMN_WIDTH=void 0,c=t("Common"),I=t("./dist/src/dataSource/utils.js"),u=["eq","neq","lt","lte","gt","gte"],s=["startswith","doesnotstartwith","endswith","contains"],f=["doesnotendwith","doesnotcontain"],w=null,x=void 0,r.GROUP_COLUMN_WIDTH=100,r.compareValue=n,r.oFt=e,r.multiSort=i,r.getSortInfos=o,r.generatePinnedColumnIndexMap=a,r.array_find=S,r.applyDateTimePicker=T,r.getGroupColumnWidth=A,r.getColumnName=N,r.isTableDataReady=D,r.isViewColumn=_,r.isFieldListFilter=E,r.isFieldListFilterInfo=j,r.isFormula=R,r.isRelation=L,r.addFilterInfoForFieldValue=F,r.removeExtraInfos=G,r.aFt=U,r.mapGetValueFunc=H,r.hFt=z,r.ePt=V},"./dist/src/view/view.entry.js":function(t,n,e){"use strict";var i,r,i=this&&this.__createBinding||(Object.create?function(t,n,e,i){void 0===i&&(i=e);var r=Object.getOwnPropertyDescriptor(n,e);r&&("get"in r?n.__esModule:!r.writable&&!r.configurable)||(r={enumerable:!0,get:function(){return n[e]}}),Object.defineProperty(t,i,r)}:function(t,n,e,i){t[i=void 0===i?e:i]=n[e]}),r=this&&this.__exportStar||function(t,n){for(var e in t)"default"===e||Object.prototype.hasOwnProperty.call(n,e)||i(n,t,e)};Object.defineProperty(n,"__esModule",{value:!0}),r(e("./dist/src/view/view.js"),n),r(e("./dist/src/view/view-style.js"),n),r(e("./dist/src/view/view-event.js"),n),r(e("./dist/src/view/view-group.js"),n),r(e("./dist/src/view/view-sort.js"),n),r(e("./dist/src/view/view-filter.js"),n),r(e("./dist/src/view/view-cross.js"),n)},"./dist/src/view/view.js":function(t,n,e){"use strict";var b,h,y,a,d,i,w,r,l,v,o,u;function s(t){return{rule:{area:a.ViewArea.colHeader,direction:a.StateRuleDirection.column,state:t},style:{decoration:{icons:[{src:""}]}}}}function c(t){(0,y.isNullOrUndefined)(t.styleRules)&&(t.styleRules=(0,y.clone)(o,!0))}function f(t){return t instanceof Date&&!isNaN(t.valueOf())}function m(t){return r.Common.ct.Q0(t)}function g(t){var n=r.Common.ct.dJ(t);return n&&!f(n)&&(n=r.Common.ct.iPt(t)),f(n)?n:null}function p(t){var n,e,i,r,n=[],e=t.columns;if(e)for(i in e)e.hasOwnProperty(i)&&(r=e[i],n.push((0,y.clone)(r)));return n}function M(t){return 0===t?"":"_"+t}function C(o,f,t,a,e,u,s,c,n,i){var l,h,d,r,v,m,g,p,l={},h=[],d=!!t;if(f.forEach(function(t,n){var e,n,i,r,n,e=t.value;s&&!s[e]||(t.isCross?l[t.value]=a.getFieldByPosition(n).getValue(u):e&&!t.isGroup&&("string"==typeof e?(n=0<=e.indexOf("."),i="="===e[0],r=o.XOt&&(0,y.isNullOrUndefined)(o.XOt[e]),(!d||n||i||r)&&(n=c&&t.caption||e,l[n]=S(o,t,u))):"function"==typeof e&&h.push({name:e.name,caption:t.caption,value:e})))}),0<h.length&&(r=o.iBt(u),h.forEach(function(t){l[t.name]=t.value(r)})),d){for(m in v=a.getFieldValues(u,c,n))!v.hasOwnProperty(m)||n&&s&&!s[m]||(l[m]=v[m]);if(e&&i)for(g=function(s){for(var c,t,n,c=e[s].summaryFields,t=function(e){var t,n,t,i,r,o,a,u,t=c[e];if(t&&t.slice){for(n=M(s),t=t.caption+"_"+t.slice+n,i={},o=0,a=r=f.filter(function(t){var n=(0,w.getGroupOptionIndexesFrom)(t.value);return t.isGroup&&3===n.length&&+n[0]===s&&+n[1]===e});o<a.length;o++)i[(u=a[o]).caption]=v[u.value];l[t]=i}},n=0;n<c.length;n++)t(n)},p=0;p<e.length;p++)g(p)}return l}function S(t,n,e){return T(t._getValueByField(n.value,e),n)}function T(t,n){var n=n&&n.dataMap;return t=n?n[t]||t:t}function A(t,n,e){for(var i,r,i=0;i<n.length;i++)if((r=n[i]).value===e||r.caption===e)return t.columns[r.value]?r.value:(0,d.isViewColumn)(r)?{value:r.value,isGroup:r.isGroup,isCross:r.isCross}:{value:r.value};return e===t.uBt()?e:l}function I(n,t,e,i,r){var o,a,u,o=A(n,t,i);return r?(0,d.isViewColumn)(o)?(r.getValue=e.getFieldByName(o.value),function(t,n,e){return e.getValue.getValue(n)}):o.value?(r.getValue=n.XOt[o.value],(0,y.isNullOrUndefined)(r.getValue)&&(r.getValue={getValue:function(t){return n._getValueByField(o.value,t)}}),function(t,n,e){return e.getValue.getValue(n)}):(r.getValue=n._dataSource._data[o].data,function(t,n,e){return e.getValue[n]}):(a=String(o.value),u=String(o),o.value?function(t,n){return t._getValueByField(a,n)}:function(t,n){return t._dataSource._data[u].data[n]})}function x(t,n,e,i){void 0===e&&(e=!0),void 0===i&&(i={}),this.rPt=10,this.lFt=[],this.CLt=[],this.oPt=[],this.ZOt={},this.rb=!1,this.BLt={};var r=this;r.name=t,Object.defineProperty(r,"tableName",{get:function(){var t;return null==(t=r.gLt)?void 0:t.name}}),r.ILt=(0,y.clone)(n=n||[]),r.yLt=n.map(function(t){return"string"==typeof t?t={name:t,value:t}:t.name||"string"!=typeof t.value||(t.name=t.value),t.value&&"="===t.value[0]&&(t.readonly=!0),t}),r.aPt=e,r.autoSort=!0,r.autoFilter=!1,r.autoGroup=!0,r.UFt=!0,c(i),(r.LEt=i).styleRules||r.clearStyleRules()}b=this&&this.__assign||function(){return(b=Object.assign||function(t){for(var n,e,i,r,e=1,i=arguments.length;e<i;e++)for(r in n=arguments[e])Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r]);return t}).apply(this,arguments)},h=this&&this.__spreadArray||function(t,n,e){if(e||2===arguments.length)for(var i=0,r=n.length,o;i<r;i++)!o&&i in n||((o=o||Array.prototype.slice.call(n,0,i))[i]=n[i]);return t.concat(o||Array.prototype.slice.call(n))},Object.defineProperty(n,"__esModule",{value:!0}),n.View=n.rFt=n.ZFt=n.Jue=n.Kue=n.tse=void 0,y=e("./dist/src/dataSource/utils.js"),a=e("./dist/src/interfaces/interface.js"),d=e("./dist/src/view/view-util.js"),i=e("./dist/src/viewField/fieldManager.js"),w=e("./dist/src/viewField/groupManager.js"),r=e("Common"),l=null,v=void 0,o={pin:s(a.RowColumnStates.pin),primaryKey:s(a.RowColumnStates.primaryKey),readonly:s(a.RowColumnStates.readonly),required:s(a.RowColumnStates.required)},n.tse=p,n.Kue=M,n.Jue=C,n.ZFt=A,n.rFt=I,x.prototype.XLt=function(){var t,n=this.gLt;return(0,d.isTableDataReady)(n)},x.prototype.Ywt=function(t,n,e){var i=this.gLt;return i&&i.Ywt(t,n,e)},x.prototype.nMt=function(t,n,e){var n=this.RJ(n),e=this.uPt(e);return this.sPt(t,n,e)},x.prototype.sPt=function(t,n,e){return this._fe(t,n,(0,y.isNumber)(e)?(0,d.getColumnName)(this.yLt[e]):v)},x.prototype._fe=function(t,n,e){var i,r,t,i=this.gLt;if(i)return!(r=!1,y.isNullOrEmpty)(e)&&(0,y.isNullOrUndefined)(i.XOt[e])&&(r=!0,i.XOt[e]=this.lLt.getFieldByName(e)),t=i.kfe(t,n,e),r&&delete i.XOt[e],t},x.prototype.cPt=function(){var t=this,n=t.gLt;n&&(t.aPt&&t.yLt.length<=0&&(t.yLt=p(n)),t.fPt(),t.lPt())},x.prototype.PRt=function(t){var n=this;t?(n.gLt=t,n.JLt(),n.bLt()?n.XLt()&&(n.RFt(),n.cPt()):n.cPt(),n.XLt()&&(n.hPt(),n.dPt=!0),n.v7()):(n.wpt(),n.gLt=t)},x.prototype.fPt=function(){var t,t,n,t,e,i,r,o,a,u,s,c,f,l,n=null==(t=null==(t=this.gLt._dataSource.options)?void 0:t.schema)?void 0:t.columns;if(n)for(t=this.yLt,i=(e=this.isHierarchy())&&this.gLt._dataSource.options.schema.hierarchy.column,r=["caption","width","style","conditionalFormats","validator","isPrimaryKey","readonly","required","defaultValue","headerStyle","visible","headerFit","indexed","allowSort","allowFilterByValue","allowFilterByList","dataMap","lookup"],o=0,a=t;o<a.length;o++)if("string"==typeof(u=a[o]).value&&(s=n[u.value])){for(c=0,f=r;c<f.length;c++)(0,y.isNullOrUndefined)(u[l=f[c]])&&(u[l]=s[l]);u.dataType=s.dataType,"date"===s.dataType&&(0,d.applyDateTimePicker)(u),!e||u.value!==i&&"rowOrder"!==s.dataType||(u.readonly=!0),s.n7t&&"rowOrder"!==s.dataType&&(u.readonly=!1,delete s.n7t)}},x.prototype.lPt=function(){for(var t,n,e,i,r,t=this.LEt.defaultColumnWidth||60,n,e=0,i=this.yLt;e<i.length;e++)r=i[e],(0,y.isNullOrUndefined)(r.width)&&(r.width=t)},x.prototype.gFt=function(t){this.XFt()||(this.iRt=this.qFt(t))},x.prototype.qFt=function(t){var n,e,i,t,r,o,n=[],e=t||this.length(),i=this.lFt,t=i.length;for(0<t&&(n=i.slice(0)),r=t,o=0;o<e;o++)-1===i.indexOf(o)&&(n[r]=o,r++);return n},x.prototype.jRt=function(t){return v},x.prototype.RFt=function(){var t=this,n=t.gLt;return t.iRt||t.gFt(),t.lLt=new i.FieldManager(t.LEt,n),t.ELt(),t.yLt=t.lLt.prepareFields(t.yLt),t.YBt(),t.lLt},x.prototype.getLookup=function(t){return(0,i.getLookupBy)(this.gLt,t)},x.prototype.isLookupField=function(t){return(0,i.isLookupField)(this.gLt,t)},x.prototype.isLookupListField=function(t){return(0,i.isLookupListField)(this.gLt,t)},x.prototype.isLookupRelationField=function(t){return(0,i.isLookupRelationField)(this.gLt,t)},x.prototype.RJ=function(t){return this.iRt||this.gFt(),this.iRt[t]},x.prototype.FLt=function(t){return this.iRt||this.gFt(),this.iRt.indexOf(t)},x.prototype.length=function(){return this.gLt.length()},x.prototype.visibleLength=function(){return this.iRt||this.gFt(),this.iRt.length},x.prototype.getDirtyIndexes=function(){var n=this;return n.gLt.getDirtyIndexes().map(function(t){return n.FLt(t)})},x.prototype.isInserted=function(t){var n=this,t=n.RJ(t);return n.vPt(t)},x.prototype.vPt=function(t){return this.gLt.isInserted(t)},x.prototype.isUpdated=function(t){var n,t,t,n=this,t=n.RJ(t);return n.rb=!0,t=n.gLt.isUpdated(t),n.rb=!1,t},x.prototype.getErrorInfo=function(t){var n,t=this.RJ(t);return this.gLt.getErrorInfo(t)},x.prototype.insertItem=function(t,n,e,i){var r,o,r=this;if(!r.isHierarchy())return r.mPt(t,n,e,i);t<(o=r.visibleLength())?r.addHierarchyItemBefore(t,n,e,i):r.addHierarchyItemAfter(o-1,n,e,i)},x.prototype.mPt=function(n,t,e,i){var r,e,o,i,e,a,u,t,s,c,f,l,a,h,d,r=this,e=r.GLt(e,i),o=e.success,i=e.fail,e=r.visibleLength();return n=e<n?e:n,a=r.RJ(n),u=r.gPt(t),r.ULt(u),(0,y.isNullOrUndefined)(a)&&(r.Dit()?(a=r.length(),r.HLt(u,a)):a=n),t=r.gLt.uBt(),s=!(0,y.isNullOrUndefined)(t),c=r.isHierarchy(),f=a,l=n<e,s&&!c&&(h=a=void 0,d=!1,l?(a=r.RJ(n-1),h=f):(h=r.RJ(n-1),d=!0),u[t]=r.gLt.d7t(a,h,d)),(s||c)&&(f=r.Dit()?r.length():e),r.gLt.insertItem(f,u,function(t){r.zLt(f,u,l,n),o&&o(t)},i)},x.prototype.zLt=function(t,n,e,i){var r,e,o,a,i,e,r=this;e?(e=r.length()-1,r.cRt(e,n),o=r.autoFilter,(a=!(0,y.isNullOrUndefined)(r.NLt))&&(r.autoFilter=!0),(0,y.isNumber)(i)&&!r.tPt()?r.iRt.splice(i,0,e):r.iRt.push(e),r.tFt(v,!a),a&&(r.autoFilter=o)):(r.cRt(t,n),i=r.length(),(e=!r.autoFilter&&!!r.iRt)&&r.iRt.push(i-1),r.tFt(i,e))},x.prototype.gPt=function(t){var n,e,i,r,o,a,u,a,n={};if(this.isHierarchy())for(e in t)t.hasOwnProperty(e)&&(n[e]=t[e]);for(r=0,o=i=this.yLt;r<o.length;r++)u=t[e=(a=o[r]).value instanceof Function?a.value.name:a.value],(0,y.isUndefined)(u)||("string"==typeof(a=a.value)?n[a]=u:a(n,u));return n},x.prototype.pPt=function(n,t,e){var i,i,r,o,r,a,t,u,s,c,r=this,o=r.lLt,r=r.gLt,a=o.getFieldByPosition(t),t=r.KRt(a.valueRelation,n);if(a.isOneToMany){if(!(t=t&&(0,y.isNumber)(a.getValueIndex(n)))&&(u=!1,r.JRt(a.valueRelation,n,((i={})[a.dimRelationKey]=a.getDimValue(),i),function(t){o.setCrossFieldInsertedIndex(a,n,t.index),u=!0},e),!u))return}else if(t){if(c=!1,r.QRt(a.dimRelationPath,n,a.getDimValue(),function(){c=!0},e),!c)return}else if(s=!1,r.JRt(a.valueRelation,n,((i={})[a.dimRelationKey]=a.getDimValue(),i),function(){s=!0},e),!s)return;return a.getRelationField(n)},x.prototype.updateItem=function(t,n,e,i,r){var o,a,o,u,s,a,o,c,a,f,o,a,a=r&&r.hasAddNewRowData,o=r&&r.currentModelIndex,u=this,s=a?o:u.RJ(t),a=u.eFt(s,n),o=a.colIndex,c;return a.isCross&&(a=u.lLt,(f=a.getFieldByPosition(o)).isOneToMany||0<(o=a.getFields(function(t){return t.initialOptionIndex===f.initialOptionIndex&&t.name!==f.name&&!(0,y.isNullOrUndefined)(t.getValueIndex(s))})).length&&(a=o[0].name,u.dRt(t,((o={})[a]=l,o),l,l,r))),u.dRt(t,n,e,i,r)},x.prototype.dRt=function(t,n,e,i,r){var o,r,a,e,u,i,s,e,c,f,l,o,r,t,n,e,o=r&&r.hasAddNewRowData,r=r&&r.currentModelIndex,a=this,e=a.GLt(e,i),u=e.success,i=e.fail,s=o?r:a.RJ(t),e=a.eFt(s,n),c=e.data,f=e.originValueOfField,l=e.field,o=e.colIndex,r=e.isCross,t=e.isValueFunction,n=c[l],e=l;if(r){if(a.vPt(s))return void i();if(e=a.pPt(s,o,i),(0,y.isNullOrUndefined)(e))return void i()}return t?(a.VLt(c,f,e,s),a.gLt.dRt(s,c,l,f,function(t){a.YLt(s,l,f,c[l]),u(t)},i)):(a.VLt(c,f,e,s),a.gLt.QRt(e,s,n,function(t){a.YLt(s,l,f,c[l]),u(t)},i))},x.prototype.VLt=function(t,n,e,i){var r=this;r.ULt(t),r.iFt(t,n,e,i)},x.prototype.YLt=function(t,n,e,i){var r=this;r.hRt(t,n,e,i),r.tFt(v,!0,n,v)},x.prototype.eFt=function(t,n){for(var t,e,i,r,o,a,u,s,c,f,l,h,d,v,m,g,p,t=this.getRowData(t,!0),e=b({},t),i,a=0,u=0,s=!1,c=!1,f=0,l=this.yLt;f<l.length;f++){if(v=n[d=(h=l[f]).value instanceof Function?h.value.name:h.value],!(0,y.isUndefined)(v))if("string"==typeof(m=h.value)){if(g=h.dataMap)for(p in g)v===g[p]&&(v=isNaN(p)?p:+p);r=e[m],e[m]=v,o=m,u=a,s=h.isCross}else c=!0,m(e,v);a++}return{data:e,originValueOfField:r,field:o,colIndex:u,isCross:s,isValueFunction:c}},x.prototype.efe=function(t,n,e){var i,r,i=this;for(r in t)t[r]!==n[r]&&i.VLt(t,n[r],r,e)},x.prototype.resetItem=function(t,n,e){var i=this,n=i.GLt(n,e),r=n.success,e=n.fail,o=i.RJ(t),a=this.getRowData(o,!0),u=i.bPt(o);if(!(0,y.isNullOrUndefined)(t)&&!(0,y.isNullOrUndefined)(o))return i.efe(u,a,o),i.gLt.resetItem(o,function(t){i.ZLt(o,a,u),r(t)},e);e()},x.prototype.ZLt=function(t,n,e){var i=this;i.vLt(t),i.pRt(t,n,e),i.tFt(v,!0,v,v)},x.prototype.saveItem=function(t,n,e){var i=this,n=i.GLt(n,e),r=n.success,e=n.fail,n=i.RJ(t);return i.gLt.saveItem(n,function(t){r(t)},e)},x.prototype.getRowData=function(t,n,e,i,r,o){var a,n,a=this,n=n?t:a.RJ(t);return a.nFt(n,e,i,r,o)},x.prototype.yPt=function(t){return this.isHierarchy()&&this.wPt(t)},x.prototype.wPt=function(t,n){var e=this,i=e.gLt.uBt(),r,i=e.isHierarchy()||!(0,y.isNullOrUndefined)(i),o=(0,y.isNullOrUndefined)(e.MFt),t=!(0<e.lFt.length)||e.lFt.length<t&&(!(0,y.isNumber)(n)||e.lFt.length<n);return i&&o&&t},x.prototype.MPt=function(){var t=this;return!!(0,y.isNullOrUndefined)(t.kLt)||!!t.kLt[0].ascending},x.prototype.CPt=function(t,n){var e,i,r,o,e=this,r=e.getHierarchyNode(t).parent;if(n){for(o=t+1;o<e.visibleLength();o++)if(e.getHierarchyNode(o).parent===r){i=o;break}}else for(o=t-1;0<=o;o--)if(e.getHierarchyNode(o).parent===r){i=o;break}return i},x.prototype.m7t=function(t,n){var e,i,r,o,o,a,u,s,c,f,l,i,e=this;if(t!==n&&e.wPt(t,n)){if(o=(r=t<n)?n+1:n-1,(i=e.isHierarchy())&&1===Math.abs(t-n)&&(n=e.CPt(t,r)),o=e.gLt.m7t(r,e.RJ(t),e.RJ(n),e.RJ(o))){if(a=e.iRt,s=1,c=[u=e.RJ(t)],i)for(c=[],l=(f=t)+(s=e.gLt.V7t(u));f<l;f++)c.push(e.RJ(f));r?(i=e.gLt.V7t(e.RJ(n)),a.splice.apply(a,h([n+i,0],c,!1)),a.splice(t,s)):(a.splice(t,s),a.splice.apply(a,h([n,0],c,!1))),e.wFt=v}return o}},x.prototype.moveUp=function(t){var n,e=1;0<t&&this.m7t(t,t-1)},x.prototype.moveDown=function(t){var n=this,e=1;t<n.visibleLength()-1&&n.m7t(t,t+1)},x.prototype.SPt=function(){for(var t,n,e,i,r,o,a,t=this,n=t.gLt._dataSource.options.schema.hierarchy.outlineColumn,e=t.yLt,i=-1,r=-1,o=0;o<e.length;o++){if(a=e[o],!(0,y.isNullOrEmpty)(a.outlineColumn)){i=o;break}-1!==r||a.value!==n&&((0,y.isNullOrUndefined)(n)||a.value!==n.value)||(r=o)}return-1!==i?{index:i,options:e[i].outlineColumn}:{index:r,options:n}},x.prototype.getHierarchyColumnOptions=function(){return this.SPt().options},x.prototype.getHierarchyColumnIndex=function(){return this.SPt().index},x.prototype.hasHierarchyColumn=function(t){var n=this,e=n.isHierarchy(),n=e&&n.getHierarchyColumnIndex();return(0,y.isNumber)(t)?e&&n===t:!(!e||-1===n)},x.prototype.isHierarchy=function(){return this.gLt.CEt()},x.prototype.getHierarchyNode=function(t,n){var e,n,e=this;if(e.isHierarchy())return n=n?t:e.RJ(t),e.gLt.SEt(n)},x.prototype.getHierarchyRootNode=function(){var t=this;if(t.isHierarchy())return t.gLt.f7t()},x.prototype.promoteHierarchyLevel=function(t){var n;this.isHierarchy()&&this.gLt.M7t(this.RJ(t))},x.prototype.demoteHierarchyLevel=function(t,n){var e=this;e.isHierarchy()&&e.gLt.S7t(e.RJ(t),n)},x.prototype.hasRowOrder=function(){var t;return!(0,y.isNullOrUndefined)(this.gLt.uBt())},x.prototype.hasHierarchyRowOrder=function(){return this.gLt.qX()},x.prototype.addHierarchyItemBefore=function(t,n,e,i){var r,o,r=this;r.yPt(t)&&(o=r.gLt.O7t(r.RJ(t),n),r.APt(n,o),r.mPt(t,n,e,i))},x.prototype.addHierarchyItemAfter=function(t,n,e,i){var r,o,a,r=this;if(r.yPt(t))return o=r.gLt.V7t(r.RJ(t)),a=r.gLt.L7t(r.RJ(t),n),r.APt(n,a),r.mPt(t+o,n,e,i),o},x.prototype.addHierarchyItemAbove=function(t,n,e,i){var r,o,r=this;r.yPt(t)&&(o=r.gLt.F7t(r.RJ(t),n),r.APt(n,o),r.mPt(t,n,e,i))},x.prototype.addHierarchyItemBelow=function(t,n,e,i){var r,o,a,r=this;if(r.yPt(t))return o=r.gLt.V7t(r.RJ(t)),a=r.gLt.G7t(r.RJ(t),n),r.APt(n,a),r.mPt(t+o,n,e,i),o},x.prototype.APt=function(t,n){var e,i,r,e,i=this.gLt.H7t(n);if(!(0,y.isNullOrUndefined)(i))for(r in i)i.hasOwnProperty(r)&&(t[r]=i[r])},x.prototype.h7t=function(t,n){if(this.isHierarchy())return this.gLt.h7t(t,n)},x.prototype.fetch=function(n){var e,i,t,t,e=this,i=e.gLt.QOt.tables,t=(0,y.keys)(i);if(0<t.length)return t=t.map(function(t){var t=i[t];return t&&t.fetch(n)}),Promise.all(t).then(function(t){e.JLt(),e.pLt()&&(e.RFt(),e.cPt()),e.dPt||e.hPt();var n=e;return(n.dp||n.vp)&&(n.dp&&n.dp(),n.vp)&&n.vp(),t})},x.prototype.iM=function(t){var n=this;n.Wce(),n.cFt(),t&&n.gFt(),n.hLt(),n.tFt(v,!0)},x.prototype.hPt=function(){for(var t,n,e,i,r,o,t,n=0,e=this.yLt;n<e.length;n++)(i=e[n]).cross||(r=i.lookup,(0,y.isArray)(r)?"string"==typeof i.value&&-1===i.value.indexOf(".")&&0<(r=(0,y.getUniqueArray)(r)).length&&((o=(o=i.style)||(i.style={})).cellType||(o.cellType={type:"combobox",items:r})):(0,y.isString)(r)&&r?this.IPt(i,r):(0,y.isObject)(r)&&this.IPt(i,r.name,r.columns))},x.prototype.IPt=function(t,n,e){var i,t,r,i,o,i,o,n,i,i=t.style,t=(t=(i=i||(t.style={})).cellButtons)||(i.cellButtons=[]),r=(r=i.dropDowns)||(i.dropDowns=[]),i=(0,d.array_find)(t,function(t){return"openMultiColumn"===t.command}),o=(0,d.array_find)(r,function(t){return"multiColumn"===t.type});i||o||(o=(i=this.xPt(n)).table,n=i.field,o&&n&&o!==this.gLt&&(i=o.columns)&&(t.push({imageType:"ellipsis",command:"openMultiColumn",useButtonStyle:!0}),r.push({type:"multiColumn",option:{dataSource:o.views[a.DEFAULT_VIEW_NAME]||o.addView(a.DEFAULT_VIEW_NAME),bindingInfos:this.NPt(i,e),key:n}})))},x.prototype.xPt=function(t){for(var n,e,i,r,o,a,i,r=0,o=this.gLt.QOt.relationships;r<o.length;r++)if((a=o[r]).sourceRelationshipName===t){n=a.targetTable,e=a.targetFieldName;break}return{table:n,field:e}},x.prototype.NPt=function(n,t){return t?t.map(function(t){return(0,y.isString)(t)?{name:t,width:"*"}:{name:t.value,width:(0,y.isNullOrUndefined)(t.width)?"*":t.width,displayName:t.caption,visible:t.visible}}):(0,y.keys)(n).map(function(t){var t=n[t];return{name:t.value,width:(0,y.isNullOrUndefined)(t.width)?"*":t.width,displayName:t.caption,visible:t.visible}})},x.prototype.oV=function(){for(var t,n,e,i,t=this,n=t.gLt.length(),e=[],i=0;i<n;i++)e.push(t.nFt(i));return e},x.prototype.ULt=function(t){for(var n,e,i,r,o,a,u,r,n,e=0,i=this.yLt;e<i.length;e++)if(o=(r=i[e]).dataMap,"string"==typeof(a=r.value)){if(o)for(u in o)t[a]===o[u]&&(t[a]=isNaN(u)?u:+u);t.hasOwnProperty(a)&&(r=this.gLt.bEt(a))&&r.relatedTable&&r.setValue&&r.setValue(t)}},x.prototype.kPt=function(t,n){var e,i,r,e=this.lFt;if(e&&0<e.length){for(i=0;i<n;i++)-1<(r=e.indexOf(t+i))&&e.splice(r,1);for(i=0;i<e.length;i++)e[i]>t&&(e[i]-=n)}},x.prototype.removeRowData=function(n,e,t,i){var r,t,o,i,t,a,r=this,t=r.GLt(t,i),o=t.success,i=t.fail,t=r.gLt,a=r.RJ(n);(0,y.isNullOrUndefined)(n)||(0,y.isNullOrUndefined)(a)||(0,y.isNullOrUndefined)(e)?i():t.remove(a,e,function(t){r.WLt(a,t.removedCount||e,n),o(t)},i)},x.prototype.WLt=function(t,n,e){var r,o,i,a,u,r=this;for(r.kPt(t,n),(0,y.isNumber)(e)||(e=r.FLt(t)),o=r.iRt.slice(e,e+n),i=function(t,n){var e,i,e=r.iRt[t],i=o.reduce(function(t,n){return n<e?t+1:t},0);0<i&&(r.iRt[t]-=i)},a=0,u=r.iRt.length;a<u;a++)i(a,u);r.iRt.splice(e,n),r.dLt(t,n),r.MRt(t,n),r.tFt(void 0,!0)},x.prototype.getChanges=function(){for(var t,n,e,i,r,t,n=this.gLt.getChanges(),e=0,i=n;e<i.length;e++)(r=i[e]).index=this.FLt(r.index);return n},x.prototype.isDataLengthChanged=function(){return this.gLt.isDataLengthChanged()},x.prototype.submitChanges=function(i){var r=this,t=r.GLt(),n=t.success,t=t.fail,e;return r.gLt.submitChanges(function(t,n,e){var t;i&&(t=r.FLt(t),i(t,n,e))}).then(function(){r.QLt(),n()}).catch(t)},x.prototype.QLt=function(){},x.prototype.cancelChanges=function(){var t,n,e,n,i,t=this,n=t.GLt(),e=n.success,n=n.fail,i=t.isDataLengthChanged();t.gLt.cancelChanges(function(){t.KLt(i),e()},n)},x.prototype.KLt=function(t){this.iM(t)},x.prototype.DPt=function(t,n){var e,i,r,t,o,e=this,i=e.TLt(t,n),r=e.ILt.map(function(t,n){return{index:n,option:t}}),t=e._Pt(t,n);if(r=t.map(function(t){return r[t]}),e.ILt=r.map(function(t){return t.option}),i)return i;o=[],r.forEach(function(t,n){(0,y.isNullOrUndefined)(t.option.cross)||t.index===n||o.push({oldIndex:t.index,newIndex:n})}),e.wLt(o)},x.prototype.EPt=function(){var e,t,i,e=this,t=e.CLt;return t&&0<t.length?(i=[],t.forEach(function(t,n){i.push(e.yLt[t].value)}),i):[]},x.prototype.jPt=function(t){var n,e=this.yLt;return(0,y.isNullOrUndefined)(t)?[]:t.map(function(n){return(0,y.findIndex)(e,function(t){return t.value===n})})},x.prototype.OPt=function(t,n,e){var i,r,t,n,o,a,u,s,c,f,f,l,h,i=this;if(i.yLt.forEach(function(t,n){t.RPt=n}),r=i.oPt,t=(0,d.ePt)(t,n,e,i.yLt,i.oPt,i.CLt,i.ILt),n=i.CLt.map(function(t){return i.yLt[t]}),i.yLt=t.map(function(t){return i.yLt[t]}),n&&n.length){for(o=[],a=i.yLt.length,u=-1,s=0,c=n;s<c.length;s++)f=c[s],f=i.yLt.indexOf(f),u=Math.max(f,u),o.push(f);for(l=0;l<a;l++)-1===o.indexOf(l)&&o.push(l);i.oPt=o,i.CLt=o.slice(0,n.length)}return h=i.yLt.reduce(function(t,n,e){return n.RPt!==e&&t.push({oldIndex:n.RPt,newIndex:e}),delete n.RPt,t},[]),i.yLt.forEach(function(t){for(var n,e,i,r,i,n=0,e=h;n<e.length;n++)if(r=(i=e[n]).oldIndex,i=i.newIndex,t._Ft===r){t._Ft=i;break}}),i.lLt&&i.lLt.moveFieldsByIndexes(h),h.map(function(t){return t.oldIndex=i.BPt(t.oldIndex,r),t.newIndex=i.BPt(t.newIndex),t})},x.prototype.SLt=function(t){var n,e,n,i,n=this,e=n.yLt,n=n.ILt,i=e[t];return i.isCross?i.RBt:(0,y.findIndex)(n,function(t){return t.value===i.value})},x.prototype.ALt=function(t){var n=this,e=n.CLt,i=n.ILt;return t=t||e.map(function(t){return n.SLt(t)}),(0,d.generatePinnedColumnIndexMap)(t,i.length)},x.prototype._Pt=function(t,n){var e,i,r,o,i,i,a;if(t!==n)return i=(e=this).CLt,r=e.ILt.map(function(t,n){return{index:n}}),o=i.map(function(t){return e.SLt(t)}),0<(i=(0,d.generatePinnedColumnIndexMap)(o,r.length)).length&&(t=i[t],n=i[n]),i=o.map(function(t){var t=r[t];return t.LPt=!0,t}),(0,y.swapArrayItems)(r,t,n,1),a=r.filter(function(t){return!t.LPt}),i.forEach(function(t,n){a.splice(o[n],0,t)}),a.map(function(t){return t.index})},x.prototype.getColumnInfos=function(e,i,r){for(var o,a,u,s,t,c,n,o=[],a=this.yLt,u=this.oPt,s=this.gLt,t=function(t){var t,n,t,t=!(0<u.length)||r||(0,y.isNullOrUndefined)(u[t])?t:u[t],n=a[t];if(s.jOt(n.value)&&(n.isPrimaryKey=!0),!e||!n.isGroup){if(i&&n.isCross&&(t=n.RBt,(n=c.ILt[t]).RBt=t,o.some(function(t){return t===n})))return"continue";o.push(n)}},c=this,n=0;n<a.length;n++)t(n);return o},x.prototype.ife=function(t){var n=this;return(0,d.getColumnName)((0,y.isNumber)(t)?n.getColumn(t):t)},x.prototype.FPt=function(t){var t=this.gLt.qRt(t);return!(0,y.isNullOrUndefined)(t)&&t!==this.gLt},x.prototype.setColumnInfos=function(t,n){this.yLt=t,this.PPt(),this.Pfe(),n&&this.cPt()},x.prototype.Pfe=function(){for(var t,n,e,i,r,o,a,t=this.ILt,n=0;n<t.length;n++)for(e=t[n],i=this.yLt,r=0;r<i.length;r++)if(o=i[r],e.value===o.value){for(a in o)o.hasOwnProperty(a)&&"_"!==a.charAt(0)&&(e[a]=o[a]);break}},x.prototype.PPt=function(){for(var t,n,e,i,r,o,a,u,t=this.ILt,n=t.length-1;0<=n;n--)"string"==typeof(e=t[n].value)&&"="===e[0]&&t.splice(n,1);for(i=this.yLt,r=n=0;n<i.length;)o=i[n],a=t[r],o.isGroup||o.isCross?n++:a&&a.cross?r++:(u=o.value)===(e=a&&a.value)?(n++,r++):"string"==typeof u&&"="===u[0]?(t.splice(r,0,o),n++,r++):n++},x.prototype.GPt=function(t){var n;return!!this.gLt.ZRt(t)},x.prototype.togglePinnedRows=function(t){var n,e,i,r,o,a,u,s,c,f,l,h,d,v,m,g,p;if((0,y.isNullOrUndefined)(t)||this.hasHierarchyColumn())return this.lFt&&this.lFt.length;for(n=this.lFt,e=this.iRt,i=t.length,r=[],o=[],a=n.length,u=0;u<i;u++)-1<(s=e[t[u]])&&(-1<(c=n.indexOf(s))?o.push(c):r.push(s));if(n.length-(l=o.length)+(f=r.length)>this.rPt)return-1;if(0<l)for(o.sort(),u=l-1;0<=u;u--)n.splice(o[u],1);for(u=0;u<f;u++)n.push(r[u]);if(0<l||0<f){for(h=[],d=e.length,0<(v=n.length)&&(h=n.slice(0)),s=v,u=0;u<d;u++)-1===n.indexOf(e[u])&&(h[s]=e[u],s++);if(!this.mFt()&&!this.tPt())for(u=0;u<l;u++)m=e[o[u]],g=h.indexOf(m),p=this.UPt(m,a,h),h.splice(g,1),h.splice(p=g<p?p-1:p,0,m),v<a&&a--;this.iRt=h,this.NFt(),this.Wce(),this.vFt()}return n.length},x.prototype.togglePinnedColumns=function(t){var n,e,i,r,o,a,u,s,c,f,l,h,n=this;if((0,y.isNullOrUndefined)(t))return this.CLt&&this.CLt.length;for(e=this.oPt,i=0<e.length,t=t.filter(function(t){var t=i?e[t]:t;return!n.yLt[t].isCross}),r=this.CLt,o=t.length,a=[],u=[],s=0;s<o;s++)-1<(c=i?e[t[s]]:t[s])&&(-1<(f=r.indexOf(c))?u.push(f):a.push(c));if(r.length-(h=u.length)+(l=a.length)>this.rPt)return-1;if(0<h)for(u.sort(),s=h-1;0<=s;s--)r.splice(u[s],1);for(s=0;s<l;s++)r.push(a[s]);return(0<l||0<h)&&(this.oPt=(0,d.generatePinnedColumnIndexMap)(r,this.yLt.length)),r.length},x.prototype.uPt=function(t){var n,e=this.oPt;return e&&0<e.length?e[t]:t},x.prototype.BPt=function(t,n){var e;return(n=n||this.oPt)&&0<n.length?n.indexOf(+t):+t},x.prototype.getRowDataAsync=function(e){var i=this;return i.fetch().then(function(t){var n=i.RJ(e);return i.nFt(n)})},x.prototype.UPt=function(t,n,e){for(var i=n;i<e.length;i++)if(e[i]>t)return i;return e.length},x.prototype.nFt=function(t,n,e,i,r){var o=this;return C(o.gLt,o.yLt,o.BFt,o.lLt,o.MFt,t,n,e,i,r)},x.prototype.ofe=function(t,n){return S(this.gLt,t,n)},x.prototype.bPt=function(a){var u,t,s,c,f,l,n,e,i,u=this,t=u.yLt,s={},c=[],f=!!u.BFt,l=u.gLt;if(t.forEach(function(t,n){var e,n,i,r,o,e=t.value;t.isCross?s[t.value]=u.lLt.getFieldByPosition(n).getOriginalValue(a):e&&!t.isGroup&&("string"==typeof e?(n=0<=e.indexOf("."),i="="===e[0],r=l.XOt&&(0,y.isNullOrUndefined)(l.XOt[e]),(!f||n||i||r)&&(s[e]=T(i?l._getValueByField(e,a):l.XRt(e,a),t))):"function"==typeof e&&c.push({name:e.name,caption:t.caption,value:e}))}),0<c.length&&(n=l.iBt(a),c.forEach(function(t){s[t.name]=t.value(n)})),f)for(i in e=this.lLt.CBt(a))e.hasOwnProperty(i)&&(s[i]=e[i]);return s},x.prototype.addColumn=function(t){"string"==typeof t?t={name:t,value:t}:t.name||"string"!=typeof t.value||(t.name=t.value),"="===t.value[0]&&(t.readonly=!0),this.yLt.push(t)},x.prototype.getColumn=function(t){var n=this.getColumnInfos();return(0,y.isNullOrUndefined)(t)?n:n[t]},x.prototype.removeColumn=function(t){for(var n,e,i,n=this.yLt,e=0;e<n.length;e++)if((i=n[e]).value===t){n.splice(e,1);break}},x.prototype.tFt=function(t,n,e,i){n||this.gFt(t);var n=this.NLt;n&&this.autoFilter&&this.filter(),this.NLt=n,this.vFt(),this.nPt(e),this.wFt=v,this.Dfe=v},x.prototype.excludeInsertedPinnedRows=function(){for(var t,n,e,i,t=this,n=t.lFt,e=[],i=0;i<n.length;i++)t.isInserted(i)||e.push(n[i]);return e},x.prototype.toJSON=function(){var e,t,i,n,r,e=this,t={};if(e._Lt&&(t={sortBefore:(0,d.removeExtraInfos)(e.DLt),sortAfter:(0,d.removeExtraInfos)(e._Lt)}),0===(i=e.ILt).length)0===e.yLt.length&&e.cPt(),i=e.ILt=e.yLt;else for(n=function(n){var t,t,t,t=i[n].cross;(0,y.isNullOrUndefined)(t)&&(t=e.yLt.filter(function(t){return t.value===i[n].value})[0])&&(i[n]=t),(t=i[n].validator)&&"date"===t.type&&(f(t.value1)&&(t.value1=m(t.value1)),f(t.value2))&&(t.value2=m(t.value2))},r=0;r<i.length;r++)n(r);return b(b({},t),{name:e.name,options:e.LEt,columns:e.ILt,indexMap:e.iRt,columnIndexMap:e.oPt,autoSort:e.autoSort,sortInfo:(0,d.removeExtraInfos)(e.kLt),autoFilter:e.autoFilter,filterInfo:(0,d.removeExtraInfos)(e.NLt),autoGroup:e.autoGroup,groupInfo:e.MFt,detailColumnsVisible:e.UFt,pinnedRows:e.excludeInsertedPinnedRows(),pinnedColumns:e.CLt})},x.prototype.fromJSON=function(t){var n,e,i,r,o,a,n=this;if(n.iRt=t.indexMap,e=t.columnIndexMap,i=n.yLt,e&&i&&0<e.length&&e.length<i.length)for(r=e.length;r<i.length;r++)e[r]=r;for(r=0;r<i.length;r++)(o=i[r].validator)&&"date"===o.type&&("string"==typeof o.value1&&(a=g(o.value1))&&(o.value1=a),"string"==typeof o.value2)&&(a=g(o.value2))&&(o.value2=a);n.oPt=e,n.autoSort=t.autoSort,n.kLt=t.sortInfo,n.DLt=t.sortInfo,t.sortAfter&&(n.DLt=t.sortBefore,n._Lt=t.sortAfter),n.autoFilter=t.autoFilter,n.NLt=t.filterInfo,n.autoGroup=t.autoGroup,n.MFt=t.groupInfo,n.UFt=t.detailColumnsVisible,n.lFt=t.pinnedRows,n.CLt=t.pinnedColumns},n.View=x},"./node_modules/fetch-jsonp/build/fetch-jsonp.js":function(t,n){var e,i,n,r,o,a;r=this,void 0!==(n="function"==typeof(e=o=function(t,n){"use strict";var e,i=5e3,r="callback",o=null;function l(){return"jsonp_"+Date.now()+"_"+Math.ceil(1e5*Math.random())}function h(n){try{delete window[n]}catch(t){window[n]=void 0}}function d(t){var t=document.getElementById(t);t&&document.getElementsByTagName("head")[0].removeChild(t)}function a(o){var a,u,s,c,f,a=arguments.length<=1||void 0===arguments[1]?{}:arguments[1],u=o,s=a.timeout||i,c=a.jsonpCallback||r,f=void 0;return new Promise(function(t,n){var e,i,r,e=a.jsonpCallbackFunction||l(),i=c+"_"+e;window[e]=function(n){t({ok:!0,json:function t(){return Promise.resolve(n)}}),f&&clearTimeout(f),d(i),h(e)},u+=-1===u.indexOf("?")?"?":"&",(r=document.createElement("script")).setAttribute("src",""+u+c+"="+e),a.charset&&r.setAttribute("charset",a.charset),r.id=i,document.getElementsByTagName("head")[0].appendChild(r),f=setTimeout(function(){n(new Error("JSONP request to "+o+" timed out")),h(e),d(i),window[e]=function(){h(e)}},s),r.onerror=function(){n(new Error("JSONP request to "+o+" failed")),h(e),d(i),f&&clearTimeout(f)}})}n.exports=a})?e.apply(n,i=[n,t]):e)&&(t.exports=n)},"./node_modules/whatwg-fetch/fetch.js":function(t,n,e){"use strict";var u,i,r,o,a,s;function c(t){return t&&DataView.prototype.isPrototypeOf(t)}function f(t){if("string"!=typeof t&&(t=String(t)),/[^a-z0-9\-#$%&'*+.^_`|~]/i.test(t))throw new TypeError("Invalid character in header field name");return t.toLowerCase()}function l(t){return t="string"!=typeof t?String(t):t}function h(n){var t={next:function(){var t=n.shift();return{done:void 0===t,value:t}}};return u.iterable&&(t[Symbol.iterator]=function(){return t}),t}function d(n){this.map={},n instanceof d?n.forEach(function(t,n){this.append(n,t)},this):Array.isArray(n)?n.forEach(function(t){this.append(t[0],t[1])},this):n&&Object.getOwnPropertyNames(n).forEach(function(t){this.append(t,n[t])},this)}function v(t){if(t.bodyUsed)return Promise.reject(new TypeError("Already read"));t.bodyUsed=!0}function m(e){return new Promise(function(t,n){e.onload=function(){t(e.result)},e.onerror=function(){n(e.error)}})}function g(t){var n,e,n=new FileReader,e=m(n);return n.readAsArrayBuffer(t),e}function p(t){var n,e,n=new FileReader,e=m(n);return n.readAsText(t),e}function b(t){for(var n,e,i,n=new Uint8Array(t),e=new Array(n.length),i=0;i<n.length;i++)e[i]=String.fromCharCode(n[i]);return e.join("")}function y(t){var n;return t.slice?t.slice(0):((n=new Uint8Array(t.byteLength)).set(new Uint8Array(t)),n.buffer)}function w(){return this.bodyUsed=!1,this.HPt=function(t){(this.zPt=t)?"string"==typeof t?this.VPt=t:u.blob&&Blob.prototype.isPrototypeOf(t)?this.YPt=t:u.formData&&FormData.prototype.isPrototypeOf(t)?this.ZPt=t:u.searchParams&&URLSearchParams.prototype.isPrototypeOf(t)?this.VPt=t.toString():u.arrayBuffer&&u.blob&&c(t)?(this.WPt=y(t.buffer),this.zPt=new Blob([this.WPt])):u.arrayBuffer&&(ArrayBuffer.prototype.isPrototypeOf(t)||r(t))?this.WPt=y(t):this.VPt=t=Object.prototype.toString.call(t):this.VPt="",this.headers.get("content-type")||("string"==typeof t?this.headers.set("content-type","text/plain;charset=UTF-8"):this.YPt&&this.YPt.type?this.headers.set("content-type",this.YPt.type):u.searchParams&&URLSearchParams.prototype.isPrototypeOf(t)&&this.headers.set("content-type","application/x-www-form-urlencoded;charset=UTF-8"))},u.blob&&(this.blob=function(){var t=v(this);if(t)return t;if(this.YPt)return Promise.resolve(this.YPt);if(this.WPt)return Promise.resolve(new Blob([this.WPt]));if(this.ZPt)throw new Error("could not read FormData body as blob");return Promise.resolve(new Blob([this.VPt]))},this.arrayBuffer=function(){return this.WPt?v(this)||Promise.resolve(this.WPt):this.blob().then(g)}),this.text=function(){var t=v(this);if(t)return t;if(this.YPt)return p(this.YPt);if(this.WPt)return Promise.resolve(b(this.WPt));if(this.ZPt)throw new Error("could not read FormData body as text");return Promise.resolve(this.VPt)},u.formData&&(this.formData=function(){return this.text().then(S)}),this.json=function(){return this.text().then(JSON.parse)},this}function M(t){var n=t.toUpperCase();return-1<o.indexOf(n)?n:t}function C(t,n){var e=(n=n||{}).body;if(t instanceof C){if(t.bodyUsed)throw new TypeError("Already read");this.url=t.url,this.credentials=t.credentials,n.headers||(this.headers=new d(t.headers)),this.method=t.method,this.mode=t.mode,this.signal=t.signal,e||null==t.zPt||(e=t.zPt,t.bodyUsed=!0)}else this.url=String(t);if(this.credentials=n.credentials||this.credentials||"same-origin",!n.headers&&this.headers||(this.headers=new d(n.headers)),this.method=M(n.method||this.method||"GET"),this.mode=n.mode||this.mode||null,this.signal=n.signal||this.signal,this.referrer=null,("GET"===this.method||"HEAD"===this.method)&&e)throw new TypeError("Body not allowed for GET or HEAD requests");this.HPt(e)}function S(t){var e=new FormData;return t.trim().split("&").forEach(function(t){var t,n,t;t&&(n=(t=t.split("=")).shift().replace(/\+/g," "),t=t.join("=").replace(/\+/g," "),e.append(decodeURIComponent(n),decodeURIComponent(t)))}),e}function T(t){var e,n,e=new d,n;return t.replace(/\r?\n[\t ]+/g," ").split(/\r?\n/).forEach(function(t){var t,n,t,t=t.split(":"),n=t.shift().trim();n&&(t=t.join(":").trim(),e.append(n,t))}),e}function A(t,n){n=n||{},this.type="default",this.status=void 0===n.status?200:n.status,this.ok=200<=this.status&&this.status<300,this.statusText="statusText"in n?n.statusText:"OK",this.headers=new d(n.headers),this.url=n.url||"",this.HPt(t)}e.r(n),e.d(n,{DOMException:function(){return s},Headers:function(){return d},Request:function(){return C},Response:function(){return A},fetch:function(){return I}}),(u={searchParams:"URLSearchParams"in self,iterable:"Symbol"in self&&"iterator"in Symbol,blob:"FileReader"in self&&"Blob"in self&&function(){try{return new Blob,!0}catch(t){return!1}}(),formData:"FormData"in self,arrayBuffer:"ArrayBuffer"in self}).arrayBuffer&&(i=["[object Int8Array]","[object Uint8Array]","[object Uint8ClampedArray]","[object Int16Array]","[object Uint16Array]","[object Int32Array]","[object Uint32Array]","[object Float32Array]","[object Float64Array]"],r=ArrayBuffer.isView||function(t){return t&&-1<i.indexOf(Object.prototype.toString.call(t))}),d.prototype.append=function(t,n){t=f(t),n=l(n);var e=this.map[t];this.map[t]=e?e+", "+n:n},d.prototype.delete=function(t){delete this.map[f(t)]},d.prototype.get=function(t){return t=f(t),this.has(t)?this.map[t]:null},d.prototype.has=function(t){return this.map.hasOwnProperty(f(t))},d.prototype.set=function(t,n){this.map[f(t)]=l(n)},d.prototype.forEach=function(t,n){for(var e in this.map)this.map.hasOwnProperty(e)&&t.call(n,this.map[e],e,this)},d.prototype.keys=function(){var e=[];return this.forEach(function(t,n){e.push(n)}),h(e)},d.prototype.values=function(){var n=[];return this.forEach(function(t){n.push(t)}),h(n)},d.prototype.entries=function(){var e=[];return this.forEach(function(t,n){e.push([n,t])}),h(e)},u.iterable&&(d.prototype[Symbol.iterator]=d.prototype.entries),o=["DELETE","GET","HEAD","OPTIONS","POST","PUT"],C.prototype.clone=function(){return new C(this,{body:this.zPt})},w.call(C.prototype),w.call(A.prototype),A.prototype.clone=function(){return new A(this.zPt,{status:this.status,statusText:this.statusText,headers:new d(this.headers),url:this.url})},A.error=function(){var t=new A(null,{status:0,statusText:""});return t.type="error",t},a=[301,302,303,307,308],A.redirect=function(t,n){if(-1===a.indexOf(n))throw new RangeError("Invalid status code");return new A(null,{status:n,headers:{location:t}})},s=self.DOMException;try{new s}catch(t){(s=function(t,n){this.message=t,this.name=n;var n=Error(t);this.stack=n.stack}).prototype=Object.create(Error.prototype),s.prototype.constructor=s}function I(o,a){return new Promise(function(e,t){var n,i,n=new C(o,a);if(n.signal&&n.signal.aborted)return t(new s("Aborted","AbortError"));function r(){i.abort()}(i=new XMLHttpRequest).onload=function(){var t,n,t={status:i.status,statusText:i.statusText,headers:T(i.getAllResponseHeaders()||"")};t.url="responseURL"in i?i.responseURL:t.headers.get("X-Request-URL"),n="response"in i?i.response:i.responseText,e(new A(n,t))},i.onerror=function(){t(new TypeError("Network request failed"))},i.ontimeout=function(){t(new TypeError("Network request failed"))},i.onabort=function(){t(new s("Aborted","AbortError"))},i.open(n.method,n.url,!0),"include"===n.credentials?i.withCredentials=!0:"omit"===n.credentials&&(i.withCredentials=!1),"responseType"in i&&u.blob&&(i.responseType="blob"),n.headers.forEach(function(t,n){i.setRequestHeader(n,t)}),n.signal&&(n.signal.addEventListener("abort",r),i.onreadystatechange=function(){4===i.readyState&&n.signal.removeEventListener("abort",r)}),i.send(void 0===n.zPt?null:n.zPt)})}I.polyfill=!0,self.fetch||(self.fetch=I,self.Headers=d,self.Request=C,self.Response=A)},CalcEngine:function(t){"use strict";t.exports=e("CalcEngine")},Common:function(t){"use strict";t.exports=e("Common")}},o={},u.d=function(t,n){for(var e in n)u.o(n,e)&&!u.o(t,e)&&Object.defineProperty(t,e,{enumerable:!0,get:n[e]})},u.o=function(t,n){return Object.prototype.hasOwnProperty.call(t,n)},u.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},a=u("./dist/src/dataManager.entry.js"),(i={}).Data=a,t.exports=i.Data},"./node_modules_local/@grapecity/js-data-manager/index.js":function(t,n,e){t.exports=e("./node_modules_local/@grapecity/js-data-manager/dist/gc.data.js")},"./node_modules_local/@grapecity/js-sheets-common/dist/gc.spread.common.js":function(t){var a;!function(){"use strict";var e,i,t,n,r;function o(t){var n,n,n=i[t];return void 0!==n||(n=i[t]={exports:{}},e[t].call(n.exports,n,n.exports,o)),n.exports}e={"./src/common/common.entry.ts":function(t,n,e){var i,r,o,a,u,s,c,f,l,h,d,v,i=this&&this.__createBinding||(Object.create?function(t,n,e,i){void 0===i&&(i=e);var r=Object.getOwnPropertyDescriptor(n,e);r&&("get"in r?n.__esModule:!r.writable&&!r.configurable)||(r={enumerable:!0,get:function(){return n[e]}}),Object.defineProperty(t,i,r)}:function(t,n,e,i){t[i=void 0===i?e:i]=n[e]}),r=this&&this.__exportStar||function(t,n){for(var e in t)"default"===e||Object.prototype.hasOwnProperty.call(n,e)||i(n,t,e)};Object.defineProperty(n,"__esModule",{value:!0}),n.B3=n.rbush=n.CultureManager=n.CultureInfo=n.zf=n.$T=n.st=n.ct=n.Uf=n.lt=n.ft=void 0,o=e("./src/common/util/colorhelper.ts"),Object.defineProperty(n,"ft",{enumerable:!0,get:function(){return o.ft}}),a=e("./src/common/util/types.ts"),Object.defineProperty(n,"lt",{enumerable:!0,get:function(){return a.lt}}),u=e("./src/common/util/arrayhelper.ts"),Object.defineProperty(n,"Uf",{enumerable:!0,get:function(){return u.Uf}}),s=e("./src/common/util/datetimehelper.ts"),Object.defineProperty(n,"ct",{enumerable:!0,get:function(){return s.ct}}),Object.defineProperty(n,"B3",{enumerable:!0,get:function(){return s.getSR}}),c=e("./src/common/util/numberhelper.ts"),Object.defineProperty(n,"st",{enumerable:!0,get:function(){return c.st}}),f=e("./src/common/util/regexhelper.ts"),Object.defineProperty(n,"$T",{enumerable:!0,get:function(){return f.$T}}),l=e("./src/common/util/stringhelper.ts"),Object.defineProperty(n,"zf",{enumerable:!0,get:function(){return l.zf}}),h=e("./src/common/util/rbush.ts"),Object.defineProperty(n,"rbush",{enumerable:!0,get:function(){return h.rbush}}),d=e("./src/common/util/common.ts"),Object.defineProperty(n,"HandleExcelSpecialDate",{set:function(t){d.HandleExcelSpecialDate=t},get:function(){return d.HandleExcelSpecialDate}}),r(e("./src/common/util/common.ts"),n),v=e("./src/common/culture/cultureInfo.ts"),Object.defineProperty(n,"CultureInfo",{enumerable:!0,get:function(){return v.CultureInfo}}),Object.defineProperty(n,"CultureManager",{enumerable:!0,get:function(){return v.CultureManager}}),r(e("./src/common/util/functionhelper.ts"),n)},"./src/common/culture/cultureInfo.ts":function(B,t,n){var e,i,u,a,r,c,o,s,f,i,l,n,h,d,v,m,L,n,i,g,e,p,b,y,w,F,M,i,C,S,T,A;function I(t){return t.split("\xa0").join(" ").toUpperCase()}function x(t){for(var n,e,i,n=[],e=0,i=t.length;e<i;e++)n[e]=I(t[e]);return n}function N(t,n,e){var t=I(t),n=n.indexOf(t);return n=-1===n?e.indexOf(t):n}function P(t){if(t){var t=t.charCodeAt(0);if(11904<=t&&t<12032||8208<=t&&t<8252||12288<=t&&t<40960||43360<=t&&t<43392||44032<=t&&t<55215||63744<=t&&t<64256||65280<=t&&t<65535)return!0}return!1}function k(t,n,e){var i;return" "===t||e&&"\u3000"===t?0:(i=e&&e(t),n.lineBreakingForbidStart&&-1!==n.lineBreakingForbidStart.indexOf(t)?!e||i?7:6:n.lineBreakingForbidEnd&&-1!==n.lineBreakingForbidEnd.indexOf(t)?!e||i?5:4:i?2:n.lineBreakingChar&&-1!==n.lineBreakingChar.indexOf(t)?3:1)}function D(t,n,e){var i,r,o,a,u,s;if(!t)return[];for(i=[t[0]],o=k(t[r=0],n,e),a=1;a<t.length;a++)u=k(t[a],n,e),v[s=o+""+u]&&i[++r]===c&&(i[r]=""),i[r]+=t[a],o=u;return i}function _(){this.NumberFormat={currencyDecimalDigits:2,currencyDecimalSeparator:".",currencyGroupSeparator:",",currencyGroupSizes:[3],currencyNegativePattern:0,currencyPositivePattern:0,currencySymbol:"\xa4",digitSubstitution:1,isReadOnly:!0,numberGroupSizes:[3],nanSymbol:"NaN",nativeDigits:["0","1","2","3","4","5","6","7","8","9"],numberNegativePattern:1,negativeInfinitySymbol:"-Infinity",negativeSign:"-",numberDecimalDigits:2,numberDecimalSeparator:".",numberGroupSeparator:",",positiveInfinitySymbol:"Infinity",positiveSign:"+",percentDecimalDigits:2,percentDecimalSeparator:".",percentGroupSeparator:",",percentGroupSizes:[3],percentNegativePattern:0,percentPositivePattern:0,percentSymbol:"%",perMilleSymbol:"\u2030",listSeparator:",",arrayListSeparator:",",arrayGroupSeparator:";",dbNumber:{},standardDictionaryNumbers:{Hundreds:"Hundreds",Thousands:"Thousands",Millions:"Millions",Billions:"Billions",Trillions:"Trillions"}},this.DateTimeFormat={abbreviatedDayNames:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],abbreviatedMonthGenitiveNames:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec",""],abbreviatedMonthNames:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec",""],amDesignator:"AM",calendarIsReadOnly:!0,calendarWeekRule:0,Calendar:{MinSupportedDateTime:"@-62135568000000@",MaxSupportedDateTime:"@253402300799999@",AlgorithmType:1,CalendarType:1,Eras:[1],TwoDigitYearMax:2029,isReadOnly:!0},dateSeparator:"/",dayNames:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],defaultDatePattern:"MM/dd/yyyy H:mm:ss",firstDayOfWeek:0,fullDateTimePattern:"dddd, dd MMMM yyyy HH:mm:ss",longDatePattern:"dddd, dd MMMM yyyy",longTimePattern:"HH:mm:ss",monthDayPattern:"MMMM dd",monthGenitiveNames:["January","February","March","April","May","June","July","August","September","October","November","December",""],monthNames:["January","February","March","April","May","June","July","August","September","October","November","December",""],nativeCalendarName:"Gregorian Calendar",pmDesignator:"PM",rfc1123Pattern:"ddd, dd MMM yyyy HH':'mm':'ss 'GMT'",shortDatePattern:"MM/dd/yyyy",shortestDayNames:["Su","Mo","Tu","We","Th","Fr","Sa"],shortTimePattern:"HH:mm",sortableDateTimePattern:"yyyy'-'MM'-'dd'T'HH':'mm':'ss",timeSeparator:":",universalSortableDateTimePattern:"yyyy'-'MM'-'dd HH':'mm':'ss'Z'",yearMonthPattern:"yyyy MMMM",filterDialogDateFormatter:"yyyy/mmmm/dd",preselectedFormatters:[],eraFormatter:["ge/M/d","ge-M-d","ge.M.d","gee/MM/dd"]},this.name=function(){return""},this.id=-1,this.LocalNumberFormat={},this.displayName="",this.predefinedFormats={},this.TimelineDateOrder=[d.quarterOrMonth,d.date,d.year],this.TimelineDateSuffix={year:"",quarter:"",month:"",date:""},this.TextFormat={lineBreakingChar:[" ","-"]}}function E(){}function j(){var t,n,t=C.call(this)||this;return O.call(t,"NumberFormat",["currencySymbol","isReadOnly"],["$",!1]),O.call(t,"DateTimeFormat",["fullDateTimePattern","longDatePattern","longTimePattern","shortDatePattern","shortTimePattern","yearMonthPattern","calendarIsReadOnly","preselectedFormatters"],["dddd, MMMM dd, yyyy h:mm:ss tt","dddd, MMMM dd, yyyy","h:mm:ss tt","M/d/yyyy","h:mm tt","MMMM, yyyy",!(n=["MMM yyyy","MMMM yyyy"]),n]),t.DateTimeFormat.defaultDatePattern=t.DateTimeFormat.shortDatePattern+" H:mm:ss",t.name=function(){return"en-US"},t.displayName="English (United States)",t.id=1033,t.predefinedFormats={Accounting:'_([$$-409]* #,##0.00_);_([$$-409]* (#,##0.00);_([$$-409]* "-"??_);_(@_)',Comma:'_(* #,##0.00_);_(* (#,##0.00);_(* "-"??_);_(@_)',Currency:["[$$-409]#,##0","[$$-409]#,##0;[Red][$$-409]#,##0","[$$-409]#,##0_);([$$-409]#,##0)","[$$-409]#,##0_);[Red]([$$-409]#,##0)"],Date:["m/d/yyyy","[$-409]dddd, mmmm dd, yyyy","m/d;@","m/d/yy;@","mm/dd/yy;@","[$-409]d-mmm;@","[$-409]d-mmm-yy;@","[$-409]mmm-yy;@","[$-409]mmmm-yy;@","[$-409]mmmm d, yyyy;@","[$-409]m/d/yy h:mm AM/PM;@","m/d/yy h:mm;@","[$-409]mmmmm;@","[$-409]mmmmm-yy;@","m/d/yyyy;@","[$-409]d-mmm-yyyy;@"],Time:["[$-409]h:mm:ss AM/PM","h:mm;@","[$-409]h:mm AM/PM;@","h:mm:ss;@","[$-409]h:mm:ss AM/PM;@","mm:ss.0;@","[h]:mm:ss;@","[$-409]m/d/yy h:mm AM/PM;@","m/d/yy h:mm;@"],Special:{"Zip Code":"00000","Zip Code + 4":"00000-0000","Phone Number":"[<=9999999]###-####;(###) ###-####","Social Security Number":"000-00-0000"}},t}function G(){var t,n,e,i,r,i,t=S.call(this)||this,n,e;return O.call(t,"NumberFormat",["currencyDecimalDigits","currencyNegativePattern","currencySymbol","isReadOnly","nanSymbol","negativeInfinitySymbol","percentNegativePattern","percentPositivePattern","positiveInfinitySymbol","dbNumber","standardDictionaryNumbers"],[0,1,"\xa5",!1,"NaN (\u975e\u6570\u5024)","-\u221e",1,1,"+\u221e",{1:{letters:["\u5146","\u5343","\u767e","\u5341","\u4ebf","\u5343","\u767e","\u5341","\u4e07","\u5343","\u767e","\u5341",""],numbers:["\u3007","\u4e00","\u4e8c","\u4e09","\u56db","\u4e94","\u516d","\u4e03","\u516b","\u4e5d"]},2:{letters:["\u5146","\u9621","\u767e","\u62fe","\u5104","\u9621","\u767e","\u62fe","\u842c","\u9621","\u767e","\u62fe",""],numbers:["\u3007","\u58f1","\u5f10","\u53c2","\u56db","\u4f0d","\u516d","\u4e03","\u516b","\u4e5d"]},3:{letters:o,numbers:["\uff10","\uff11","\uff12","\uff13","\uff14","\uff15","\uff16","\uff17","\uff18","\uff19"]}},{Hundreds:"\u767e",Thousands:"\u5343",Millions:"\u767e\u4e07",Billions:"\u5341\u5104",Trillions:"\u5146"}]),O.call(t,"DateTimeFormat",["abbreviatedDayNames","abbreviatedMonthGenitiveNames","abbreviatedMonthNames","amDesignator","calendarIsReadOnly","dayNames","fullDateTimePattern","longDatePattern","longTimePattern","monthDayPattern","monthGenitiveNames","monthNames","nativeCalendarName","pmDesignator","shortDatePattern","shortestDayNames","shortTimePattern","yearMonthPattern","filterDialogDateFormatter","preselectedFormatters","EraFilterDialogDateFormatter"],[["\u65e5","\u6708","\u706b","\u6c34","\u6728","\u91d1","\u571f"],i=["1","2","3","4","5","6","7","8","9","10","11","12",""],i,"\u5348\u524d",!(i=["yyyy\u5e74M\u6708d\u65e5","yyyy\u5e74M\u6708dd\u65e5","yyyy\u5e74MM\u6708d\u65e5","yyyy\u5e74MM\u6708dd\u65e5"]),["\u65e5\u66dc\u65e5","\u6708\u66dc\u65e5","\u706b\u66dc\u65e5","\u6c34\u66dc\u65e5","\u6728\u66dc\u65e5","\u91d1\u66dc\u65e5","\u571f\u66dc\u65e5"],"yyyy'\u5e74'M'\u6708'd'\u65e5' H:mm:ss","yyyy'\u5e74'M'\u6708'd'\u65e5'","H:mm:ss","M'\u6708'd'\u65e5'",r=["1\u6708","2\u6708","3\u6708","4\u6708","5\u6708","6\u6708","7\u6708","8\u6708","9\u6708","10\u6708","11\u6708","12\u6708",""],r,"\u897f\u66a6 (\u65e5\u672c\u8a9e)","\u5348\u5f8c","yyyy/MM/dd",["\u65e5","\u6708","\u706b","\u6c34","\u6728","\u91d1","\u571f"],"H:mm","yyyy'\u5e74'M'\u6708'","yyyy\u5e74/mmmm/d\u65e5",i,"ggge/mmmm/d\u65e5"]),t.DateTimeFormat.eras=!0,t.DateTimeFormat.defaultDatePattern=t.DateTimeFormat.shortDatePattern+" "+t.DateTimeFormat.longTimePattern,t.QPt=['gggee"\u5e74"MM"\u6708"dd"\u65e5','gggee"\u5e74"M"\u6708"d"\u65e5','ge"\u5e74"M"\u6708"d"\u65e5','ggge"\u5e74"M"\u6708"d"\u65e5','ggee"\u5e74"M"\u6708"d"\u65e5','gge"\u5e74"M"\u6708"d"\u65e5'],t.name=function(){return"ja-JP"},t.id=1041,t.displayName="Japanese (Japan)",t.isJCKCulture=!0,t.predefinedFormats={Accounting:'_-[$\xa5-411]* #,##0.00_-;-[$\xa5-411]* #,##0.00_-;_-[$\xa5-411]* "-"??_-;_-@_-',Comma:'_-* #,##0.00_-;-* #,##0.00_-;_-* "-"??_-;_-@_-',Currency:["[$\xa5-411]#,##0","[$\xa5-411]#,##0;[Red][$\xa5-411]#,##0","[$\xa5-411]#,##0;-[$\xa5-411]#,##0","[$\xa5-411]#,##0;[Red]-[$\xa5-411]#,##0"],Date:['yyyy"\u5e74"m"\u6708"d"\u65e5";@','yyyy"\u5e74"m"\u6708";@','m"\u6708"d"\u65e5";@',"yyyy/m/d;@","[$-409]yyyy/m/d h:mm AM/PM;@","yyyy/m/d h:mm;@","m/d;@","m/d/yy;@","mm/dd/yy;@","[$-409]d-mmm;@","[$-409]d-mmm-yy;@","[$-409]dd-mmm-yy;@","[$-409]mmm-yy;@","[$-409]mmmm-yy;@","[$-409]mmmmm;@","[$-409]mmmmm-yy;@"],Time:["h:mm;@","[$-409]h:mm AM/PM;@","h:mm:ss;@","[$-409]h:mm:ss AM/PM;@","[$-409]yyyy/m/d h:mm AM/PM;@","yyyy/m/d h:mm;@",'h"\u6642"mm"\u5206";@','h"\u6642"mm"\u5206"ss"\u79d2";@'],Special:{"\u90f5\u4fbf\u756a\u53f7":"[<=999]000;[<=9999]000-00;000-0000","\u96fb\u8a71\u756a\u53f7\uff08\u6771\u4eac)":"[<=99999999]####-####;(00) ####-####","\u6b63\u8ca0\u8a18\u53f7 \uff08+ = \u25b3; - = \u25b2)":'"\u25b3" #,##0;"\u25b2" #,##0',"\u6f22\u6570\u5b57\uff08\u5341\u4e8c\u4e07\u4e09\u5343\u56db\u767e\uff09":"[DBNum1][$-411]General","\u5927\u5b57 (\u58f1\u62fe\u5f10\u842c\u53c2\u9621\u56db\u767e)":"[DBNum2][$-411]General","\u5168\u89d2 (\uff11\uff12\uff13\uff14\uff15)":"[DBNum3][$-411]0","\u5168\u89d2 \u6841\u533a\u5207\u308a\uff08\uff11\uff12,\uff13\uff14\uff15\uff09":"[DBNum3][$-411]#,##0"}},t.TimelineDateOrder=[d.year,d.quarterOrMonth,d.date],t.TimelineDateSuffix={year:"\u5e74",quarter:"",month:"\u6708",date:"\u65e5"},t}function U(){var t,n,e,i,r,i,t=T.call(this)||this,n,e;return O.call(t,"NumberFormat",["currencyNegativePattern","currencySymbol","isReadOnly","nanSymbol","negativeInfinitySymbol","percentNegativePattern","percentPositivePattern","positiveInfinitySymbol","dbNumber","standardDictionaryNumbers"],[2,"\xa5",!1,"\u975e\u6570\u5b57","\u8d1f\u65e0\u7a77\u5927",1,1,"\u6b63\u65e0\u7a77\u5927",{1:{letters:["\u5146","\u5343","\u767e","\u5341","\u4ebf","\u5343","\u767e","\u5341","\u4e07","\u5343","\u767e","\u5341",""],numbers:["\u25cb","\u4e00","\u4e8c","\u4e09","\u56db","\u4e94","\u516d","\u4e03","\u516b","\u4e5d"]},2:{letters:["\u5146","\u4edf","\u4f70","\u62fe","\u4ebf","\u4edf","\u4f70","\u62fe","\u4e07","\u4edf","\u4f70","\u62fe",""],numbers:["\u96f6","\u58f9","\u8d30","\u53c1","\u8086","\u4f0d","\u9646","\u67d2","\u634c","\u7396"]},3:{letters:o,numbers:["\uff10","\uff11","\uff12","\uff13","\uff14","\uff15","\uff16","\uff17","\uff18","\uff19"]}},{Hundreds:"\u767e",Thousands:"\u5343",Millions:"\u767e\u4e07",Billions:"\u5341\u4ebf",Trillions:"\u5146"}]),O.call(t,"DateTimeFormat",["abbreviatedDayNames","abbreviatedMonthGenitiveNames","abbreviatedMonthNames","amDesignator","calendarIsReadOnly","dayNames","firstDayOfWeek","fullDateTimePattern","longDatePattern","longTimePattern","monthDayPattern","monthGenitiveNames","monthNames","nativeCalendarName","pmDesignator","shortDatePattern","shortestDayNames","shortTimePattern","yearMonthPattern","filterDialogDateFormatter","preselectedFormatters"],[["\u5468\u65e5","\u5468\u4e00","\u5468\u4e8c","\u5468\u4e09","\u5468\u56db","\u5468\u4e94","\u5468\u516d"],i=["1\u6708","2\u6708","3\u6708","4\u6708","5\u6708","6\u6708","7\u6708","8\u6708","9\u6708","10\u6708","11\u6708","12\u6708",""],i,"\u4e0a\u5348",!(i=["yyyy\u5e74M\u6708","M\u6708d\u65e5","yyyy\u5e74M\u6708d\u65e5","h\u65f6mm\u5206","h\u65f6mm\u5206ss\u79d2"]),["\u661f\u671f\u65e5","\u661f\u671f\u4e00","\u661f\u671f\u4e8c","\u661f\u671f\u4e09","\u661f\u671f\u56db","\u661f\u671f\u4e94","\u661f\u671f\u516d"],1,"yyyy'\u5e74'M'\u6708'd'\u65e5' H:mm:ss","yyyy'\u5e74'M'\u6708'd'\u65e5'","H:mm:ss","M'\u6708'd'\u65e5'",r=["\u4e00\u6708","\u4e8c\u6708","\u4e09\u6708","\u56db\u6708","\u4e94\u6708","\u516d\u6708","\u4e03\u6708","\u516b\u6708","\u4e5d\u6708","\u5341\u6708","\u5341\u4e00\u6708","\u5341\u4e8c\u6708",""],r,"\u516c\u5386","\u4e0b\u5348","yyyy/M/d",["\u65e5","\u4e00","\u4e8c","\u4e09","\u56db","\u4e94","\u516d"],"H:mm","yyyy'\u5e74'M'\u6708'","yyyy\u5e74/mmmm/d\u65e5",i]),t.DateTimeFormat.defaultDatePattern=t.DateTimeFormat.shortDatePattern+" "+t.DateTimeFormat.longTimePattern,t.name=function(){return"zh-cn"},t.id=2052,t.displayName="Chinese (China)",t.isJCKCulture=!0,t.localeCompare=function(t,n){return t.localeCompare(n,"zh")},t.predefinedFormats={Accounting:'_ [$\xa5-804]* #,##0.00_ ;_ [$\xa5-804]* -#,##0.00_ ;_ [$\xa5-804]* "-"??_ ;_ @_ ',Comma:'_ * #,##0.00_ ;_ * -#,##0.00_ ;_ * "-"??_ ;_ @_ ',Currency:["[$\xa5-804]#,##0","[$\xa5-804]#,##0;[Red][$\xa5-804]#,##0","[$\xa5-804]#,##0;[$\xa5-804]-#,##0","[$\xa5-804]#,##0;[Red][$\xa5-804]-#,##0"],Date:["yyyy-mm-dd;@",'[DBNum1][$-804]yyyy"\u5e74"m"\u6708"d"\u65e5";@','[DBNum1][$-804]yyyy"\u5e74"m"\u6708";@','[DBNum1][$-804]m"\u6708"d"\u65e5";@',"[$-409]yyyy/m/d h:mm AM/PM;@",'yyyy"\u5e74"m"\u6708"d"\u65e5";@','yyyy"\u5e74"m"\u6708";@','m"\u6708"d"\u65e5";@',"mm/dd/yy;@","m/d/yy;@","yyyy/m/d h:mm AM/PM;@","yyyy/m/d h:mm;@","[$-409]d-mmm;@","[$-409]d-mmm-yy;@","[$-409]dd-mmm-yy;@","[$-409]mmm-yy;@","[$-409]m","[$-409]m-d;@"],Time:["h:mm;@","[$-409]h:mm AM/PM;@","h:mm:ss;@",'h"\u65f6"mm"\u5206";@','h"\u65f6"mm"\u5206"ss"\u79d2";@','[$-804]\u4e0a\u5348/\u4e0b\u5348h"\u65f6"mm"\u5206";@','[$-804]\u4e0a\u5348/\u4e0b\u5348h"\u65f6"mm"\u5206"ss"\u79d2";@','[DBNum1][$-804]h"\u65f6"mm"\u5206";@','[DBNum1][$-804]\u4e0a\u5348/\u4e0b\u5348h"\u65f6"mm"\u5206";@'],Special:{"\u90ae\u653f\u7f16\u7801":"000000","\u4e2d\u6587\u5c0f\u5199\u5b57\u6bcd":"[DBNum1][$-804]General","\u4e2d\u6587\u5927\u5199\u5b57\u6bcd":"[DBNum2][$-804]General"}},t.TimelineDateOrder=[d.year,d.quarterOrMonth,d.date],t.TimelineDateSuffix={year:"\u5e74",quarter:"",month:"",date:"\u65e5"},t.TextFormat={lineBreakingChar:[" ","\u3000","-"],lineBreakingForbidStart:["!","%",")",",",".",":",";","?","]","}","\uff01","\uff05","\uff09","\uff0c","\uff0e","\uff1a","\uff1b","\uff1f","\uff3d","\uff5d"],lineBreakingForbidEnd:["(","[","{","\uff08","\uff3b","\uff5b"],lineBreakingStrategy:function(t,n){return D(t,n,P)}},t}function H(){var t,n,e,i,i,t=A.call(this)||this,n,e;return O.call(t,"NumberFormat",["currencyDecimalDigits","currencyNegativePattern","currencySymbol","isReadOnly","dbNumber","standardDictionaryNumbers"],[0,1,"\u20a9",!1,{1:{letters:["\u5146","\u5343","\u767e","\u5341","\u5104","\u5343","\u767e","\u5341","\u4e07","\u5343","\u767e","\u5341",""],numbers:["\uff10","\u4e00","\u4e8c","\u4e09","\u56db","\u4e94","\uf9d1","\u4e03","\u516b","\u4e5d"]},2:{letters:["\u5146","\u9621","\u767e","\uf973","\u5104","\u9621","\u767e","\uf973","\u842c","\u9621","\u767e","\uf973",""],numbers:["\uf9b2","\u58f9","\u8cb3","\uf96b","\u56db","\u4f0d","\uf9d1","\u4e03","\u516b","\u4e5d"]},3:{letters:["\u5146","\u5343","\u767e","\u5341","\u5104","\u5343","\u767e","\u5341","\u4e07","\u5343","\u767e","\u5341",""],numbers:["\uff10","\uff11","\uff12","\uff13","\uff14","\uff15","\uff16","\uff17","\uff18","\uff19"]},4:{letters:["\uc870","\ucc9c","\ubc31","\uc2ed","\uc5b5","\ucc9c","\ubc31","\uc2ed","\ub9cc","\ucc9c","\ubc31","\uc2ed",""],numbers:["\u25cb","\uc77c","\uc774","\uc0bc","\uc0ac","\uc624","\uc721","\uce60","\ud314","\uad6c"]}},{Hundreds:"\ubc31",Thousands:"\ucc9c",Millions:"\ubc31\ub9cc",Billions:"10\uc5b5",Trillions:"\uc870"}]),O.call(t,"DateTimeFormat",["abbreviatedDayNames","abbreviatedMonthGenitiveNames","abbreviatedMonthNames","amDesignator","calendarIsReadOnly","dayNames","firstDayOfWeek","fullDateTimePattern","longDatePattern","longTimePattern","monthDayPattern","monthGenitiveNames","monthNames","nativeCalendarName","pmDesignator","shortDatePattern","shortestDayNames","shortTimePattern","yearMonthPattern","filterDialogDateFormatter"],[["\uc77c","\uc6d4","\ud654","\uc218","\ubaa9","\uae08","\ud1a0"],i=["1","2","3","4","5","6","7","8","9","10","11","12",""],i,"\uc624\uc804",!(i=["1\uc6d4","2\uc6d4","3\uc6d4","4\uc6d4","5\uc6d4","6\uc6d4","7\uc6d4","8\uc6d4","9\uc6d4","10\uc6d4","11\uc6d4","12\uc6d4",""]),["\uc77c\uc694\uc77c","\uc6d4\uc694\uc77c","\ud654\uc694\uc77c","\uc218\uc694\uc77c","\ubaa9\uc694\uc77c","\uae08\uc694\uc77c","\ud1a0\uc694\uc77c"],1,"yyyy'\ub144' M'\uc6d4' d'\uc77c' dddd h:mm:ss","yyyy'\ub144' M'\uc6d4' d'\uc77c' dddd","h:mm:ss","M'\uc6d4' d'\uc77c'",i,i,"\uc11c\uae30","\uc624\ud6c4","yyyy-MM-dd",["\uc77c","\uc6d4","\ud654","\uc218","\ubaa9","\uae08","\ud1a0"],"tt h:mm","yyyy'\ub144' M'\uc6d4'","yyyy\ub144/mmmm/d\uc77c"]),t.DateTimeFormat.defaultDatePattern=t.DateTimeFormat.shortDatePattern+" "+t.DateTimeFormat.longTimePattern,t.name=function(){return"ko-kr"},t.id=1042,t.displayName="Korean (Korea)",t.isJCKCulture=!0,t.predefinedFormats={Accounting:'_-[$\u20a9-412]* #,##0.00_-;-[$\u20a9-412]* #,##0.00_-;_-[$\u20a9-412]* "-"??_-;_-@_-',Comma:'_-* #,##0.00_-;-* #,##0.00_-;_-* "-"??_-;_-@_-',Currency:["[$\u20a9-412]#,##0","[$\u20a9-412]#,##0;[Red][$\u20a9-412]#,##0","[$\u20a9-412]#,##0;-[$\u20a9-412]#,##0","[$\u20a9-412]#,##0;[Red]-[$\u20a9-412]#,##0"],Date:["yyyy-mm-dd;@",'yyyy"\ub144" m"\uc6d4" d"\uc77c";@','yy"\u5e74" m"\u6708" d"\u65e5";@','yyyy"\ub144" m"\uc6d4";@','m"\uc6d4" d"\uc77c";@',"yy-m-d;@","yy-m-d h:mm;@",'m"\u6708"d"\u65e5";@',"[$-412]yy-m-d AM/PM h:mm;@","yy/m/d;@","yyyy/m/d h:mm;@","m/d;@","m/d/yy;@","mm/dd/yy;@","[$-409]d-mmm;@","[$-409]d-mmm-yy;@","[$-409]dd-mmm-yy;@","[$-409]mmm-yy;@","[$-409]m","[$-409]m-d;@"],Time:["h:mm;@","h:mm:ss;@","[$-412]AM/PM h:mm;@","[$-412]AM/PM h:mm:ss;@","[$-409]h:mm AM/PM;@","[$-409]h:mm:ss AM/PM;@",'yyyy"-"m"-"d h:mm;@','[$-412]yyyy"-"m"-"d AM/PM h:mm;@','[$-409]yyyy"-"m"-"d h:mm AM/PM;@','h"\uc2dc" mm"\ubd84";@','h"\uc2dc" mm"\ubd84" ss"\ucd08";@','[$-412]AM/PM h"\uc2dc" mm"\ubd84";@','[$-412]AM/PM h"\uc2dc" mm"\ubd84" ss"\ucd08";@'],Special:{"\uc6b0\ud3b8 \ubc88\ud638":"000-000","\uc804\ud654 \ubc88\ud638 (\uad6d\ubc88 4\uc790\ub9ac)":"[<=999999]####-####;(0##) ####-####","\uc804\ud654 \ubc88\ud638 (\uad6d\ubc88 3\uc790\ub9ac)":"[<=9999999]###-####;(0##) ###-####","\uc8fc\ubbfc\ub4f1\ub85d\ubc88\ud638":"000000-0000000","\uc22b\uc790(\ud55c\uc790)":"[DBNum1][$-412]General","\uc22b\uc790(\ud55c\uc790-\uac16\uc740\uc790)":"[DBNum2][$-412]General","\uc22b\uc790(\ud55c\uae00)":"[DBNum4][$-412]General"}},t.TimelineDateOrder=[d.year,d.quarterOrMonth,d.date],t.TimelineDateSuffix={year:"\ub144",quarter:"",month:"\uc6d4",date:"\uc77c"},t}function O(t,n,e){for(var i,r,o,a,i=this,o=0,a=n.length;o<a;o++)r=n[o],i[t][r]=e[o]}function z(t,n){var e;"object"==typeof document&&("function"!=typeof CustomEvent?(e=document.createEvent("CustomEvent")).initCustomEvent("cultureChanged",!1,!1,void 0):e=new CustomEvent("cultureChanged",{}),e.cultureInfo=t,r.gcCultureInfo=t,r.gcCultureObj=n,document.dispatchEvent(e))}function R(){this.KPt=1,this.JPt={}}e=this&&this.__extends||(M=function(t,n){return(M=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(t,n){t.__proto__=n}:function(t,n){for(var e in n)Object.prototype.hasOwnProperty.call(n,e)&&(t[e]=n[e])}))(t,n)},function(t,n){if("function"!=typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function e(){this.constructor=t}M(t,n),t.prototype=null===n?Object.create(n):(e.prototype=n.prototype,new e)}),Object.defineProperty(t,"__esModule",{value:!0}),t.CultureManager=t.XPt=t.CultureInfo=t.TimelineDateOrder=void 0,i=n("./src/common/util/types.ts"),u=n("./src/common/util/common.ts"),a=n("./src/common/util/arrayhelper.ts"),r="undefined"!=typeof window?window:n.g,c=void 0,o=null,s=i.lt.y0,f=i.lt.Dh,n=["MM-dd-yyyy","MM-d-yyyy","M-dd-yyyy","M-d-yyyy","yy-MM-dd","yy-MM-d","yy-M-dd","yy-M-d","yyyy-MM-dd","yyyy-MM-d","yyyy-M-dd","yyyy-M-d","dd-MMMM-yy","dd-MMM-yy"],h=(i=["MM/dd/yyyy","MM/d/yyyy","M/dd/yyyy","M/d/yyyy","yy/MM/dd","yy/MM/d","yy/M/dd","yy/M/d","yyyy/MM/dd","yyyy/MM/d","yyyy/M/dd","yyyy/M/d"]).concat(l=["hh:mm:ss","hh:mm:s","hh:m:ss","hh:m:s","h:mm:ss","h:mm:s","h:m:ss","h:m:s","hh:mm:ss tt","hh:mm:s tt","hh:m:ss tt","hh:m:s tt","h:mm:ss tt","h:mm:s tt","h:m:ss tt","h:m:s tt","hh:mm","hh:m","h:mm","h:m","hh:mm tt","hh:m tt","h:mm tt","h:m tt"]),s(i,function(t,e){s(l,function(t,n){t<l.length-4&&h.push(e+" "+n)})}),h=h.concat(n),s(n,function(t,e){s(l,function(t,n){t<l.length-4&&h.push(e+" "+n)})}),(i=d=t.TimelineDateOrder||(t.TimelineDateOrder={}))[i.year=1]="year",i[i.quarterOrMonth=2]="quarterOrMonth",i[i.date=3]="date",v={"00":1,"01":1,"02":1,"03":1,"04":1,"05":1,"06":1,"07":1,12:1,15:1,21:1,22:1,23:1,24:1,25:1,31:1,32:1,33:1,34:1,35:1,36:1,37:1,62:1,65:1,71:1,72:1,73:1,74:1,75:1},_.prototype.lse=function(t){var n;return this.TextFormat&&this.TextFormat.lineBreakingStrategy?(n={lineBreakingChar:this.TextFormat.lineBreakingChar,lineBreakingForbidEnd:this.TextFormat.lineBreakingForbidEnd,lineBreakingForbidStart:this.TextFormat.lineBreakingForbidStart},this.TextFormat.lineBreakingStrategy(t,n)):D(t,this.TextFormat||{lineBreakingChar:[" ","-"]})},_.prototype.qPt=function(){var t,n,n,e;return this.$Pt||(n=(n=[n=(t=this.DateTimeFormat).shortDatePattern.replace(/m/g,"M"),n+" h:mm",n+" h:mm:ss",n+" h:mm:ss.0","MMMdd","MMMd","MMM dd","MMM d"]).concat(h),1041===this.id&&(e=t.eraFormatter,n=(n=n.concat(this.QPt)).concat(e)),n=n.concat(t.preselectedFormatters),this.$Pt=n),this.$Pt},_.prototype.tGt=function(t){var n=this;return n.nGt||(n.nGt=x(n.DateTimeFormat.monthNames),n.eGt=x(n.DateTimeFormat.monthGenitiveNames)),N(t,n.nGt,n.eGt)},_.prototype.iGt=function(t){var n=this;return n.rGt||(n.rGt=x(n.DateTimeFormat.abbreviatedMonthNames),n.oGt=x(n.DateTimeFormat.abbreviatedMonthGenitiveNames)),N(t,n.rGt,n.oGt)},_.prototype.aGt=function(t){var n=this;return n.uGt||(n.uGt=x(n.DateTimeFormat.dayNames)),n.uGt.indexOf(I(t))},_.prototype.sGt=function(t){var n=this;return n.cGt||(n.cGt=x(n.DateTimeFormat.abbreviatedDayNames)),n.cGt.indexOf(I(t))},m=_,t.CultureInfo=m,E.fGt=function(t){return t>=E.lGt()&&t<=E.hGt()},E.dGt=function(){var t,n,e,t=m.eras;if(t===c)return this.vGt;for(n=[],e=0;e<t.length;e++)n[e]=new Date(t[e].startDate.replace(/-/g,"/"));return n},E.mGt=function(t){var n,e,i,r,o;switch(t){case"g":n="symbol",e=E.gGt;break;case"gg":n="abbreviation",e=E.pGt;break;case"ggg":n="name",e=E.DEt;break;default:return[]}if(r=[],(i=m.eras)===c)return e;for(o=0;o<i.length;o++)r[o]=i[o][n];return r},E.hGt=function(){var t,t,t=m.eras;return t!==c&&0<t.length?((t=new Date(t[t.length-1].startDate.replace(/-/g,"/"))).setFullYear(t.getFullYear()+99),t):this.bGt},E.lGt=function(){var t=m.eras;return t!==c&&0<t.length?new Date(t[0].startDate.replace(/-/g,"/")):this.yGt},E.wGt=function(){var t=m.eras;return t!==c?t.length:this.MGt},E.CGt=function(){var t,n,e,i,r,t=m.eras;if(t===c)return this.SGt;for(n=[],e=1;e<t.length;e++)i=new Date(t[e-1].startDate.replace(/-/g,"/")),r=new Date(t[e].startDate.replace(/-/g,"/")),n[e-1]=r.getFullYear()-i.getFullYear()+1;return n[e-1]=99,n},E.TGt=function(t){var n,e,i,n={AGt:-1,IGt:-1};if(!E.fGt(t)){if(!(t>E.hGt()))return n;t=E.hGt()}for(e=0;e<E.wGt();e++)if(t<(i=e+1!==E.wGt()?E.dGt()[e+1]:E.xGt(E.hGt(),1))){n.AGt=e,n.IGt=t.getFullYear()-E.dGt()[e].getFullYear()+1;break}return n},E.xGt=function(t,n){var t=new Date(t.getFullYear(),t.getMonth(),t.getDate(),t.getHours(),t.getMinutes(),t.getSeconds());return t.setMilliseconds(t.getMilliseconds()+n),new Date(t.valueOf())},E.NGt=function(t,n){var e;return E.dGt()[t].getFullYear()+n-1},E.kGt=function(t,n){var e,i;for(n=n.toUpperCase(),e=E.mGt(t),i=0;i<e.length;i++)if(e[i]===n)return i;return-1},E.DGt=function(t,n,e){var i,n,r,i,i,r,i=E,n=i.TGt(n),r=n.AGt;if(0<=r&&0<(i=i.mGt(t)).length)return i[r];if(0<=(i=n.IGt)){if("1"===(r=i.toString())&&e)return r="\u5143";if("ee"===t)return r=1===r.length?"0"+r:r;if("e"===t)return r}return""},E.vGt=[new Date(1868,8,8),new Date(1912,6,30),new Date(1926,11,25),new Date(1989,0,8),new Date(2019,4,1)],E.MGt=5,E.SGt=[45,15,64,31,99],E.bGt=new Date(2117,11,31,23,59,59),E.yGt=new Date(1868,8,8),E._Gt=["1,m","2,t","3,s","4,h","5,r"],E.EGt=[0,1,2,3,0,1,2,3],E.DEt=["\u660e\u6cbb","\u5927\u6b63","\u662d\u548c","\u5e73\u6210","\u4ee4\u548c"],E.gGt=["M","T","S","H","R"],E.pGt=["\u660e","\u5927","\u662d","\u5e73","\u4ee4"],E.jGt=99,E.eraExcelFormatter="[$-ja-JP-x-gannen]",E.eraInternalFormatter="[$-411]",t.XPt=E,e(j,C=m),n=j,e(G,S=m),i=G,e(U,T=m),g=U,e(H,A=m),e=H,p={invariant:new m,"en-us":new n,"ja-jp":new i,"zh-cn":new g,"ko-kr":new e},b={},y=["lsru","lsde","ls1","ls2","ls3","ls4","ls5","ls6","ls7","ls8"],w=["wmk1","wmk2"],R.instance=function(){return this.OGt||(this.OGt=new this)},R.prototype.culture=function(t){if(0===arguments.length)return R.RGt;t&&R.RGt!==t&&(R.RGt=t.toLowerCase(),this.KPt++,z(R.RGt,R.OGt.getCultureInfo()))},R.prototype.addCultureInfo=function(t,n,e){var i,r,o,a,i;if(n&&n instanceof m){if(i=n.NumberFormat&&n.NumberFormat.numberDecimalSeparator,r=n.NumberFormat.arrayListSeparator,o=n.NumberFormat.arrayGroupSeparator,i===n.NumberFormat.listSeparator||o===r)throw(a=new u.ResourceManager(u.SR)).getResource().Exp_Separator;p[t.toLowerCase()]=n}e&&"object"==typeof e&&(i=t.toLowerCase(),b[i]=f(!0,{},e),this.KPt++)},R.prototype.getCultureInfoDict=function(){return p},R.prototype.getCultureInfo=function(t){var n,e,i;if(0===arguments.length)return p[R.RGt];for(i in"string"==typeof t&&(t=t.toLowerCase()),e=o,n=p)if(i===t||n[i].id!==c&&n[i].id===t){e=n[i];break}return e},R.prototype.getLanguage=function(t){var t;return"string"==typeof t?(t=t.toLowerCase(),b[t]):o},R.prototype.getResources=function(t){var n,n,n=this.culture().toLowerCase();return"string"==typeof(t=t!==o&&t!==c?t:n)&&(n=t.toLowerCase(),this.JPt[n])?this.BGt(this.JPt[n]):o},R.prototype.BGt=function(t){var n,e,i,r,o,t,n,n="PivotTables",e="Sheets",i="CalcEngine",r="Functions",o="TableFunctions",t=f(!0,{},t);return t[n]&&this.LGt(t[n],w),t[e]&&this.LGt(t[e],y),(n=t[i])&&(t[r]=n.wmt,t[o]=n.d2t,delete n.wmt,delete n.d2t),t},R.prototype.LGt=function(t,n){for(var e,i,r,e=0,i=n;e<i.length;e++)delete t[r=i[e]]},R.prototype.FGt=function(t,n,e){var i,r,o,i=b[t.toLowerCase()];for(r in n)a.Uf.OS(y,r)||null!==(o=this.PGt(i,r,e))&&"string"==typeof o&&"string"==typeof n[r]&&(n[r]=o);n.wmt&&i.Functions&&this.GGt(i.Functions,n.wmt),n.d2t&&i.TableFunctions&&f(!0,n.d2t,i.TableFunctions)},R.prototype.PGt=function(t,n,e){var i,r;if(t.hasOwnProperty(n))return t[n];if(e&&(i=t[e])&&"object"==typeof i&&i.hasOwnProperty(n))return i[n];for(r in t)if((i=t[r])&&"object"==typeof i&&i.hasOwnProperty(n))return i[n];return null},R.prototype.GGt=function(t,n){var e,i,r,o,a,u,s,c,e={};for(i in n)if(t.hasOwnProperty(i))for(s in r=n[i],o=t[i],a=r.parameters,u=o.parameters,r.description=o.description,a)u.hasOwnProperty(s)&&"string"==typeof(c=u[s])&&(a[s].name=c);return e},R.prototype.Fe=function(t){var t=this.getCultureInfo(t),t;return t=(t=t||p[R.RGt])||new m},R.prototype.xat=function(t,n){var e,t,i,e,t=(this.getCultureInfo(t)||this.getCultureInfo("en-US")).DateTimeFormat,i=t.filterDialogDateFormatter;return i=0<=n.indexOf("g")||0<=n.indexOf("e")?t.EraFilterDialogDateFormatter||i:i},R.RGt="en-us",t.CultureManager=R.instance()},"./src/common/util/arrayhelper.ts":function(t,n){var r,o,e;function a(t,n){var e,i;for(e in n)n.hasOwnProperty(e)&&(i=n[e],Array.isArray(i)?(t[e]=[],a(t[e],n[e])):i!==r&&"object"==typeof i?(t[e]={},a(t[e],n[e])):t[e]=n[e])}function i(){}Object.defineProperty(n,"__esModule",{value:!0}),n.Uf=void 0,r=null,o=void 0,i.Eit=function(t,n,e){t.splice(n,0,e)},i.ZP=function(t,n){t.push(n)},i.OS=function(t,n){return-1<t.indexOf(n)},i.VP=function(t,n){var n=t.indexOf(n);-1<n&&t.splice(n,1)},i.UGt=function(t,n){return t.slice(0,n).concat(t.slice(n+1))},i.hD=function(t,n,e){return t.indexOf(n,e)},i.d5=function(t,n,e){if(!(n<0))for(var i=0;i<e&&n+i<t.length;i++)t[n+i]=r},i.N2t=function(t,n){for(var e,i,i=e=(n=n<0?-1:n)+1;i<t.length;i++)if(t[i]!==o&&t[i]!==r)return i;return-1},i.tR=function(t){return t&&t.length},i.Gf=function(t){var n=[];return a(n,t),n},n.Uf=i},"./src/common/util/colorhelper.ts":function(t,n,e){var e,o,s,c,a,f,i,r,u;function l(t,n,e){return e<0&&(e+=240),240<e&&(e-=240),e<40?t+((n-t)*e+20)/40:e<120?n:e<160?t+((n-t)*(160-e)+20)/40:t}function h(t,n,e){var i,r,o,a,u;return 0===e?i=r=o=f(255*n/240+"",10):(u=a=void 0,i=d(a=2*n-(u=n<=120?f((n*(240+e)+120)/240+""):n+e-f((n*e+120)/240+"")),u,t+80),r=d(a,u,t),o=d(a,u,t-80)),{a:255,r:i,g:r,b:o}}function d(t,n,e){return s(f((255*l(t,n,e)+120)/240+""),255)}function v(t){var n,e,i,t,r,o,a,o,a,u,t,n=this,e=t.r,i=t.g,t=t.b,r=c(c(e,i),t),o=s(s(e,i),t),a=r+o;n.HGt=f((240*a+255)/510+"",10),0==(o=r-o)?(n.zGt=0,n.wv=160):(n.HGt<=120?n.zGt=f((240*o+a/2)/a+"",10):n.zGt=f((240*o+(510-a)/2)/(510-a)+"",10),a=(40*(r-e)+o/2)/o,u=(40*(r-i)+o/2)/o,t=(40*(r-t)+o/2)/o,n.wv=f(e===r?t-u+"":i===r?80+a-t+"":160+u-a+"",10),n.wv<0&&(n.wv+=240),240<n.wv&&(n.wv-=240))}function m(t){var n,e,n,n;return/^#[A-Fa-f0-9]+$/.test(t)?(n=t.replace(/^#/,""),e=n.length,(n=(n=n.split(3===e?/(.)/:/(..)/)).filter(Boolean).map(function(t){return 3===e?parseInt(t+t,16):parseInt(t,16)}))[0]||(n[0]=0),n[1]||(n[1]=0),n[2]||(n[2]=0),[n[0],n[1],n[2],1]):null!==(n=r.exec(t))?[n[1],n[2],n[3],1]:null}function g(){}Object.defineProperty(n,"__esModule",{value:!0}),n.ft=void 0,e=e("./src/common/util/numberhelper.ts"),o=e.st.VGt,s=Math.min,c=Math.max,a=Math.abs,f=parseInt,v.prototype.YGt=function(t){var n,e,i,n=this,e=n.HGt,i=n.ZGt(n.HGt,500,!0);return h(n.wv,e+(i-e)*t,n.zGt)},v.prototype.ZGt=function(t,n,e){if(0!==n){if(e)return 0<n?(t*(1e3-n)+241*n)/1e3:t*(n+1e3)/1e3;240<(t=(t+=240*n/1e3)<0?0:t)&&(t=240)}return t},i=v,r=/rgb[a]?\((\d{1,3})\s*,\s*(\d{1,3})\s*,\s*(\d{1,3})(\s*,\s*(\d{0,1}))?\)/,g.j=function(t){var n,e,i,r,n=t.a,e=t.r,i=t.g,r=t.b;return 3===arguments.length&&(n=255,e=t,i=arguments[1],r=arguments[2]),4===arguments.length&&(n=t,e=arguments[1],i=arguments[2],r=arguments[3]),255===n?"#"+o(e,!0,2)+o(i,!0,2)+o(r,!0,2):"rgba("+e+","+i+","+r+","+n+")"},g.Tv=function(t,n){return t.stops||t.type?JSON.stringify(t)===JSON.stringify(n):t.a===n.a&&t.r===n.r&&t.g===n.g&&t.b===n.b},g.rp=function(t){return(299*t.r+587*t.g+114*t.b)/1e3},g.Km=function(t,n){var e,i,r,t,o,e=255-a(t.r-n.r),i=255-a(t.g-n.g),r=255-a(t.b-n.b),t=a(t.a-n.a);return!!(.9<=(o=((e/=255)+(i/=255)+(r/=255))/3)&&t<=.05)},g.Uv=function(t){var n,e,i,n=255^t.r,e=255^t.g,i=255^t.b;return g.j(t.a,n,e,i)},g.WGt=function(t){var n,e,e;return"object"!=typeof document?m(t):((n=g.xf)||(e=document.createElement("canvas"))&&e.getContext&&(n=g.xf=e.getContext("2d",{willReadFrequently:!0})),n?(n.clearRect(1,1,1,1),n.fillStyle=t,n.fillRect(1,1,1,1),(e=n.getImageData(1,1,1,1))?e.data:null):t)},g._=function(t){var n,e,i,r,t;return t instanceof g||null!==t&&"object"==typeof t?t:(r=i=e=n=0,t&&(t=g.WGt(t))&&(e=t[0],i=t[1],r=t[2],n=t[3]),{a:n,r:e,g:i,b:r})},g.Cv=function(t,n){var t,n;return 0===n?t:(t=new i(t),n=f((0<n?(240-t.HGt)*n:t.HGt*n)+"",10),g.QGt(t.wv,t.HGt+n,t.zGt))},g.YGt=function(t,n){var t,e,t,t=g._(t),e,t=new i(t).YGt(n);return g.j(t)},g.Dz=l,g.QGt=h,n.ft=g},"./src/common/util/common.ts":function(t,n,e){var r,i,e,o,a;function u(t,n){this.res=t,this.KGt=n,this.JPt=r.CultureManager.JPt,this.cachedResource=this.JGt(t,!0),this.XGt(this.cachedResource,n),this.KPt=0}function s(t,n,e,i){var r,o,a,u,s;if(t&&0<=e&&e<n){for(r=[],a=o=void 0,a=e;a<n;a++)void 0!==t[a]&&r.push(a);for(o=r.length,a=0;a<o;a++)s=t[u=r[o-a-1]],t[u]=null,t[Math.floor(u)+i]=s}}function c(t,n,e,i){var r,o,a,u,s,c;if(t&&0<=e&&e<n){for(r=[],a=e+i,u=o=void 0,u=e;u<n;u++)void 0!==t[u]&&(e<=u&&u<a?t[u]=null:a<=u&&r.push(u));for(o=r.length,u=0;u<o;u++)c=t[s=r[u]],t[s]=null,t[Math.floor(s)-i]=c}}function f(t,n){return t.hasOwnProperty(n)}function l(t,n){return t instanceof n}Object.defineProperty(n,"__esModule",{value:!0}),n.ut=n.kh=n.X8=n.J8=n.ResourceManager=n.SR=void 0,r=e("./src/common/culture/cultureInfo.ts"),i=e("./src/common/util/util.res.en.ts"),e=e("./src/common/util/types.ts"),n.SR={en:i},o=e.lt.Dh,u.prototype.getResource=function(){var t=this.JGt(this.res,!this.cachedResource);return t&&(this.cachedResource=t),this.XGt(this.cachedResource,this.KGt),this.cachedResource},u.prototype.XGt=function(t,n){var e,i;n&&(i=(e=r.CultureManager.culture()).toLowerCase(),this.JPt[i]=this.JPt[i]||{},this.JPt[i][n]=t,r.CultureManager.JPt=this.JPt)},u.prototype.JGt=function(t,n){var e,i,n,i,e=r.CultureManager.culture();return t&&e?(i=r.CultureManager.KPt,this.KPt!==i||n?(this.KPt=i,r.CultureManager.getLanguage(e)?(n=o(!0,{},t.en),r.CultureManager.FGt(e,n,this.KGt),n):(i=e.substr(0,2).toLowerCase(),t.hasOwnProperty(i)?t[i]:t.en)):void 0):{}},n.ResourceManager=u,n.J8=s,n.X8=c,n.kh=f,n.ut=l},"./src/common/util/datetimehelper.ts":function(t,_,n){var e,x,d,E,n,a,j,N,k,D,i,O,R,n,o,r;function B(t,n){if(e.HandleExcelSpecialDate)return e.HandleExcelSpecialDate.apply(null,[t,n]);switch(n){case 0:return t.getFullYear();case 1:return t.getMonth();case 2:return t.getDate();default:return}}function L(t,n,e,i){var r,o,a,u,s,c,f,l,h,d,v,m,g,p,b,y,w,M,w,C,S,T,A,I,x,N,r=e.DateTimeFormat,o=r.Calendar.convert;if(!n||!n.length)return e&&e.name.length?o?L(t,r.fullDateTimePattern,e):t.toLocaleString():t.toString();function k(){return f||l||(f=h.test(n),l=!0),f}function D(t,n){return m?m[n]:B(t,n)}for(a=r.eras,s="",h=/([^d]|^)(d|dd)([^d]|$)/g,d=0,v=G(),!(u="s"===n)&&o&&(m=o.fromGregorian(t)),p=g=-2,b={y4:""},y=0;w=v.lastIndex,M=v.exec(n),w=n.slice(w,M?M.index:n.length),b.y4="",d+=F(w,b),s+=b.y4,M;y++)if(d%2==1)s+=M[0];else switch(C=D(t,0),S=t.getDay(),T=t.getHours(),A=t.getMinutes(),I=t.getSeconds(),x=t.getMilliseconds(),N=t.getTimezoneOffset(),M[0]){case"dddd":s+=r.dayNames[S];break;case"ddd":s+=r.abbreviatedDayNames[S];break;case"dd":f=!0,s+=j(D(t,2),2);break;case"d":f=!0,s+=D(t,2);break;case"MMMM":s+=(r.monthGenitiveNames&&k()?r.monthGenitiveNames:r.monthNames)[D(t,1)];break;case"MMM":s+=(r.abbreviatedMonthGenitiveNames&&k()?r.abbreviatedMonthGenitiveNames:r.abbreviatedMonthNames)[D(t,1)];break;case"MM":s+=j(D(t,1)+1,2);break;case"M":s+=D(t,1)+1;break;case"yyyy":case"yyy":s+=0<=g?E.XPt.DGt("ee",t,i):j(m?m[0]:C,4);break;case"yy":s+=0<=g?E.XPt.DGt("ee",t,i):j((m?m[0]:C)%100,2);break;case"y":s+=0<=g?E.XPt.DGt("e",t,i):((m?m[0]:C)%100).toString();break;case"hh":s+=j(c=0===(c=T%12)?12:c,2);break;case"h":s+=c=0===(c=T%12)?12:c;break;case"HH":s+=j(T,2);break;case"H":s+=T.toString();break;case"mm":s+=j(A,2);break;case"m":s+=A.toString();break;case"ss":s+=j(I,2);break;case"s":s+=I.toString();break;case"tt":s+=T<12?r.amDesignator:r.pmDesignator;break;case"t":s+=(T<12?r.amDesignator:r.pmDesignator).charAt(0);break;case"f":case"0":s+=j(x,3).charAt(0);break;case"ff":case"00":s+=j(x,3).substr(0,2);break;case"fff":case"000":s+=j(x,3);break;case"z":s+=((c=N/60)<=0?"+":"-")+O(R(c));break;case"zz":s+=((c=N/60)<=0?"+":"-")+j(O(R(c)),2);break;case"zzz":s+=((c=N/60)<=0?"+":"-")+j(O(R(c)),2)+":"+j(R(N%60),2);break;case"g":case"gg":case"ggg":a&&(g=(g===y-1||(s+=E.XPt.DGt(M[0],t,i)),y));break;case"e":case"ee":a?p=(p===y-1||(s+=E.XPt.DGt(M[0],t,i)),y):s+=j(m?m[0]:C,4);break;case"/":s+=r.dateSeparator;break;case"[h]":case"[hh]":case"[H]":case"[HH]":case"[mm]":case"[m]":case"[ss]":case"[s]":s+=M[0];break;default:throw new Error((0,_.getSR)().Exp_InvalidDateFormat)}return s.toString()}function F(t,n){for(var e,i,r,o,a,e=0,i=D,r=0,o=t.length;r<o;r++)switch(a=t.charAt(r)){case'"':i?n.y4+="'":e++,i=D;break;case"\\":i&&(n.y4+="\\"),i=!i;break;default:n.y4+=a,i=D}return e}function P(t,n){var e,i,e,e=new Date,i;return t.DateTimeFormat.eras&&n<100&&(n+=(e=E.XPt.TGt(e).IGt)-e%100)>t.DateTimeFormat.Calendar.TwoDigitYearMax&&(n-=100),n}function G(){return/\/|dddd|ddd|dd|d|MMMM|MMM|MM|M|yyyy|yyy|yy|y|hh|h|HH|H|mm|m|ss|s|tt|t|fff|ff|f|000|00|0|zzz|zz|z|ggg|gg|g|ee|e|\[H\]|\[HH\]|\[h\]|\[hh\]|\[mm\]|\[m\]|\[ss\]|\[s\]/g}function U(t,n,e){var i,r,o,a,u,s,c,f,l,h,h;if(t.qGt){if(t.qGt[n])return t.qGt[n]}else t.qGt={};for(i=(i=(i=n).replace("%M","M")).replace(/([\^\$\.\*\+\?\|\[\]\(\)\{\}])/g,"\\\\$1"),r="^",o={y4:""},a=[],s=u=0,c=G();(f=c.exec(i))!==N;)if(o.y4="",l=i.slice(u,f.index),u=c.lastIndex,s+=F(l,o),r+=o.y4,s%2==1)r+=f[0];else{switch(f[0]){case"dddd":case"ddd":case"MMMM":case"MMM":case"gggg":case"ggg":case"gg":case"g":r+="(\\D+)";break;case"tt":case"t":r+="(\\D*)";break;case"dd":case"d":case"MM":case"M":case"yy":case"y":case"HH":case"H":case"hh":case"h":case"mm":case"m":case"ss":case"s":r+="(\\d\\d?\\d?)";break;case"eee":case"ee":case"e":r+=e?"(\\u5143|\\d\\d?)":"(\\d\\d?)";break;case"yyy":case"yyyy":r+="(\\d{2}|\\d{4})";break;case"fff":case"000":r+="(\\d{3})";break;case"ff":case"00":r+="(\\d{2})";break;case"f":case"0":r+="(\\d)";break;case"zzz":r+="([+-]?\\d\\d?:\\d{2})";break;case"zz":case"z":r+="([+-]?\\d\\d?)";break;case"/":r+="/"===t.dateSeparator?"(\\/)":"([\\/\\"+t.dateSeparator+"])";break;default:throw new Error((0,_.getSR)().Exp_InvalidDateFormat)}d.Uf.ZP(a,f[0])}return o.y4="",F(i.slice(u),o),h={$Gt:h=(r=r+o.y4+"$").toString().replace(/\s+/g,"\\s+"),QMt:a,tUt:new RegExp(h)},t.qGt[n]=h}function u(t){var t=t.getTimezoneOffset();return t=-507===(t=-321===(t=-485===t?-485-43/60:t)?-321-10/60:t)?-507-52/60:t}function s(){}Object.defineProperty(_,"__esModule",{value:!0}),_.ct=_.getSR=void 0,e=n("./src/common/util/common.ts"),x=n("./src/common/util/stringhelper.ts"),d=n("./src/common/util/arrayhelper.ts"),E=n("./src/common/culture/cultureInfo.ts"),n=n("./src/common/util/types.ts"),a=n.lt.ht,j=x.zf.B9t,N=null,k=parseInt,i=!(D=!1),O=Math.floor,R=Math.abs,n=new e.ResourceManager(e.SR,"Common"),_.getSR=n.getResource.bind(n),o={},s.L9t=function(t,n,e,i){return L(t,n,e=e||E.CultureManager.Fe(),i)},s.Pe=function(t,n,e){return L(t,n,e||E.CultureManager.Fe())},s.Mjt=function(t,n,e){var i,r,o,o,a,u=D,a=e;for(a.slice(1).forEach(function(t){t&&(u=!0)}),r=(a=u?a:a.concat(n.qPt())).length,i=1;i<r;i++)if((o=a[i])&&(u=!0,o=s.nUt(t,o,n)))return o;return N},s.yU=function(t,n,e){var i,r;return(n||e||void 0===(r=o[t]))&&(i=n?[t,n]:[t],r=s.Mjt(t,e||E.CultureManager.Fe(),i),n||e||(o[t]=r)),r&&new Date(r)},s.Z6t=function(t,n){return s.Mjt(t,E.CultureManager.Fe("invariant"),[t,n])},s.nUt=function(t,n,e){var i,r,n,o,a,u,s,c,f,l,h,d,v,m,g,p,b,y,w,M,C,S,S,T,T,n,t,A,I,n;if(t=t.trim(),(o=(n=U(i=e.DateTimeFormat,n,r=1041===e.id)).tUt.exec(t))===N)return N;for(a=n.QMt,p=l=f=c=s=u=N,y=b=D,w=g=m=v=h=0,M=a.length;w<M;w++)if(C=o[w+1])switch(a[w]){case"dd":case"d":if((f=k(C,10))<1||31<f)return N;break;case"MMMM":if((c=e.tGt(C))<0||11<c)return N;break;case"MMM":if((c=e.iGt(C))<0||11<c)return N;break;case"M":case"MM":case"%M":if((c=k(C,10)-1)<0||11<c)return N;break;case"e":case"ee":if((s=r&&"\u5143"===C?1:P(e,k(C,10)))<0||9999<s)return N;break;case"y":case"yy":case"yyy":case"yyyy":if((s=k(C,10))<0||9999<s)return N;break;case"h":case"hh":case"H":case"HH":if((h=k(C,10))<0)return N;break;case"m":case"mm":if((v=k(C,10))<0||59<v)return N;break;case"s":case"ss":if((m=k(C,10))<0||59<m)return N;break;case"tt":case"t":if(b=(S=C.toUpperCase())===i.pmDesignator.toUpperCase(),y=S===i.amDesignator.toUpperCase(),b||y)break;return N;case"f":case"0":if((g=100*k(C,10))<0||999<g)return N;break;case"ff":case"00":if((g=10*k(C,10))<0||999<g)return N;break;case"fff":case"000":if((g=k(C,10))<0||999<g)return N;break;case"dddd":if((l=e.aGt(C))<0||6<l)return N;break;case"ddd":if((l=e.sGt(C))<0||6<l)return N;break;case"zzz":if(2!==(S=C.split(/:/)).length)return N;if((d=k(S[0],10))<-12||13<d)return N;if((T=k(S[1],10))<0||59<T)return N;p=60*d+(x.zf.fJ(C,"-")?-T:T);break;case"z":case"zz":if((d=k(C,10))<-12||13<d)return N;p=60*d;break;case"g":case"gg":case"ggg":if(!(T=C)||!i.eras)return N;if((u=E.XPt.kGt(a[w],T))<0)return N}if(t=(n=/^(\d|\d\d|\d\d\d):/.test(t))?new Date(1899,11,30):new Date,(I=i.Calendar.convert)&&(A=I.fromGregorian(t)),I||(A=[t.getFullYear(),t.getMonth(),t.getDate()]),s===N?s=A[0]:s<100&&(i.eras&&u!==N?s=E.XPt.NGt(u||0,s):s+=30<=s?1900:2e3),c===N&&(c=A[1]),f===N&&(f=n?A[2]:1),I){if((t=I.toGregorian(s,c,f))===N)return N}else{if(t.setFullYear(s,c,f),t.getDate()!==f)return N;if(l!==N&&t.getDay()!==l)return N}return b&&h<12?h+=12:y&&12===h&&(h=0),t.setHours(h,v,m,g),p!==N&&(n=t.getMinutes()-(p+t.getTimezoneOffset()),t.setHours(t.getHours()+n/60,n%60)),t},s.Y0=function(t){var n,e,i,n,t,i,r,o,a,t,n=t-25569,e,i=0<=n?1:-1,n=u(new Date(864e5*n)),t=(864e5*t*1440+i-3181192704e6+864e5*n)/1440,i=new Date(t),r=0<=n?1:-1,o,a=u(new Date(t+36e5*r));if(60<=R(n-a))if(t=new Date(t+60*(a-n)*1e3),a<n){if(-1==r||a===u(i))return t=999===t.getMilliseconds()?new Date(t.valueOf()+1):t}else if(n<a&&(1==r||a===u(i)))return t=999===t.getMilliseconds()?new Date(t.valueOf()+1):t;return i=999===i.getMilliseconds()?new Date(i.valueOf()+1):i},s.dJ=function(t){var t;if("/OADate("===t.substr(0,8))return t=parseFloat(t.substr(8,t.length-10)),s.Y0(t)},s.Q0=function(t){return"/OADate("+s.o0(t)+")/"},s.o0=function(t){var n;return a(t)?0:(n=u(t="number"==typeof t?new Date(t):t),(1440*t.getTime()+3181192704e6-864e5*n)/124416e6)},s.iPt=function(t){var n,e,i,r,o,n=N,e=!0;if(a(t)?n=s.Y0(0):t instanceof Date?n=new Date(t.valueOf()):"string"==typeof t?((i=s.yU(t))||(isNaN(t)?!s.u6t(t)&&(i=new Date(t),isNaN(i.valueOf())&&(e=D),!(o=(r=/^[-+=\s]*(\d+)\W+(\d+)\W+(\d+)$/).exec(t.replace(/ |\n/g,"").trim()))||4!==o.length||-1!==o.indexOf(i.getFullYear().toString())&&-1!==o.indexOf((i.getMonth()+1).toString())&&-1!==o.indexOf(i.getDate().toString()))||(e=D):(i=s.Y0(parseFloat(t)))||(e=D)),n=i):"number"==typeof t?n=s.Y0(t):e=D,e)return n;throw(0,_.getSR)().Exp_InvalidCast},s.u6t=function(t){var n,i,e,r,o,n=E.CultureManager.Fe().DateTimeFormat,i=s.eUt,e=function(n,t){var e=0;return t.forEach(function(t){t&&-1<n.indexOf(t)&&e++}),1<e},r=function(t,n){var t,e;return!!(t&&-1<t.indexOf(" "))&&2<=(e=(t=t.split(" ")).length)&&n.indexOf(t[e-2])<=-1&&!isNaN(t[e-1])},o=function(n){var e=!1;return i.forEach(function(t){-1<n.indexOf(t)&&(e=!0)}),e};return e(t,n.monthNames)||e(t,n.abbreviatedMonthNames)||e(t,n.dayNames)||e(t,n.abbreviatedDayNames)||r(t,n.monthNames.concat(n.abbreviatedMonthNames))||o(t)},s.W0=function(t){return t&&(t.constructor===Date||t.getUTCDate&&t.setFullYear)},s.eUt=["@","#","!","`","^","$","*","(",")","&"],_.ct=s},"./src/common/util/functionhelper.ts":function(t,n){var H,z,V;function c(t){return t}function f(t,n,e,i,r,o,a,u,s,B,c){var f,l,h,d,v,m,g,p,b,y,w,M,C,S,T,A,I,x,N,L,F,P,G,k,D,_,E,j,U,O,R,I=e[z],x=e[V],N=n[z],L=n[V],F=i[z],P=i[V],G=1===x,k=1===L;if(N===I&&L===x){for(g=I*x,f=j=E=_=D=0;f<I;f++)for(l=0;l<x;l++){if(d=o(e[f][l]),v=o(n[f][l]),t&&(H(d)||H(v)))return s;D+=d,_+=d*d,E+=v=B(v),j+=d*v}for(U=g*j-D*E,m=r?U/(g*_-D*D):j/_,p=r?(E*_-D*j)/(g*_-D*D):0,b=[],f=0;f<F;f++)for(b[f]=[],l=0;l<P;l++){if(d=o(i[f][l]),t&&H(d))return s;b[f][l]=0==U?n[0][0]:c(m*d+p)}return a?new a(b):b}if(k&&N===I||1===N&&L===x){for(d=[],v=[],T=x+1,A=x+2,f=0;f<I;f++){if(p=o(w=k?n[f][0]:n[0][f]),t&&H(p))return s;v[f]=G?B(p):p}for(f=0;f<I;f++)for(d[f]=[],l=0;l<x;l++){if(p=o(e[f][l]),t&&H(p))return s;d[f][l]=p}for(O=[],m=0;m<T;m++)for(O[m]=[],g=0;g<A;g++)O[m][g]=0;for(h=0;h<I;h++)for(O[0][T]+=v[h],f=0;f<x;f++)for(O[0][w=f+1]+=d[h][f],O[w][0]=O[0][w],O[w][T]+=d[h][f]*v[h],l=f;l<x;l++)O[C=l+1][w]+=d[h][f]*d[h][l],O[w][C]=O[C][w];for(O[0][0]=I,y=R=r?0:1;y<T;y++){if(t){if(0===O[y][y]){for(S=!1,l=y+1;!S&&l<T;l++)if(0!==O[l][y]){for(h=0;h<A;h++)C=O[y][h],O[y][h]=O[l][h],O[l][h]=C;S=!0}if(!S)return u}}else{for(f=y;f<T&&0===O[f][y];)f++;if(T<=f)return u;for(M=R;M<A;M++)w=O[y][M],O[y][M]=O[f][M],O[f][M]=w}for(w=1/O[y][y],M=R;M<A;M++)O[y][M]*=w;for(f=R;f<T;f++)if(f!==y)for(w=-O[f][y],M=0;M<A;M++)O[f][M]+=w*O[y][M];r||(O[0][T]=0)}for(b=[],k||(b[0]=[]),f=0;f<F;f++){for(k&&(b[f]=[]),w=O[0][T],l=0;l<x;l++){if(p=o(k?i[f][l]:i[l][f]),t&&H(p))return s;w+=O[l+1][T]*p}k?b[f][0]=c(w):b[0][f]=c(w)}return a?new a(b):b}return u}function e(t,n,e,i,r,o,a,u){return f(!0,t,n,e,i,r,o,u,a,c,c)}function i(t,n,e,i,r,o,a){for(var u,s,u=0;u<t[z];u++)for(s=0;s<t[V];s++)if(t[u][s]<=0)return o;return f(!1,t,n,e,i,c,r,a,null,Math.log,Math.exp)}Object.defineProperty(n,"__esModule",{value:!0}),n.iit=n.eit=void 0,H=isNaN,z="rowCount",V="colCount",n.eit=e,n.iit=i},"./src/common/util/numberhelper.ts":function(B,t,n){var e,i,r,c,o,f,I,l,p,a,h,d,b,x,u,y,s,w,v,m,g,N,M,n,C,A,k,D,S,T,_;function L(t,n,e,i){return n&&0!==n.length&&"i"!==n?F(t,n,e.NumberFormat,i):e&&0<e.name.length?t.toLocaleString():t.toString()}function F(t,n,e,i){var r;return K(t,G(n),e,i)}function E(t,n){for(var e,i,t,r,n,o,a,r,o,a,e=u(y(t)),i={iUt:1,rUt:0};10<=e;)e/=10,i.iUt++;return r=(t=t.toString()).search(/e/gi),n=t.indexOf(n),-1!==r?(a=N(t,0,r),r=N(t,r+1),o=0,-1!==n&&(o=N(a,n+1).length),a=d(r),i.rUt=o=(o=o-a)<0?0:o):(o=0,-1!==n&&(o=N(t,n+1).length),i.rUt=o),i}function P(t){for(var n,e,i,n={oUt:t.charAt(0),aUt:0,tUt:0},e="",i=1;i<t.length;i++)if("+"===(e=t.charAt(i)))n.aUt=1;else{if("-"!==e){if("0"!==e)throw new Error(C().Exp_InvalidExponentFormat);n.tUt=t.length-i;break}n.aUt=-1}return n}function G(t){for(var n,e,i,r,o,a,u,s,c,f,l,h,d,v,m,g,n={uUt:p,sUt:p,rCt:b,fxt:0,d0:0,cUt:0,fUt:p},e="",i=b,r=b,o=b,a=b,u=b,s=b,f=p,l=[],h=0;h<t.length;h++){if(c=t.charAt(h),i)e+=c,'"'===c&&(l.push(e),e="",i=b);else if(r){if("E"===f||"e"===f){if(!(0<=["+","-","0"].indexOf(c))){r=b,h--;continue}e+=c}else if("+"===f||"-"===f){if("0"!==c){r=b,h--;continue}e+=c}else if("0"===f){if("0"!==c){r=b,u||(u=x,n.fUt=P(e)),h--;continue}e+=c}}else if("*"!==f&&"_"!==f&&"\\"!==f||""===e)if("*"===c||"_"===c||"\\"===c)s=b,""!==e&&(l.push(e),e=""),e+=c;else if("'"===c)s=b,""!==e&&(l.push(e),e=""),l.push(c);else if('"'===c)s=b,i=x,""!==e&&(l.push(e),e=""),e+=c;else if(0<=T.indexOf(c))s=x,T.indexOf(f)<0&&""!==e&&(l.push(e),e=""),e+=c;else if("."!==c||o)if("%"===c)s=b,n.d0++,""!==e&&(l.push(e),e=""),l.push(c);else if("\u2030"===c)s=b,n.cUt++,""!==e&&(l.push(e),e=""),l.push(c);else if(","===c)if(s){for(d=void 0,""!==e&&(l.push(e),e=""),v=x,m="",g=h+1;g<t.length;g++)if(d=t.charAt(g),'"'===m)'"'===d&&(m="");else if("\\"===m||"_"===m)m="";else{if(0<=T.indexOf(d)){v=b;break}if("."===d||";"===d)break;m=d}v?n.fxt++:o||(d=t.charAt(h+1))&&0<=T.indexOf(d)&&(a=x)}else e+=c;else"E"===c||"e"===c?(s=b,r=x,""!==e&&(l.push(e),e="")):(s=b,0<=T.indexOf(f)&&""!==e&&(l.push(e),e="")),e+=c;else""!==e&&(l.push(e),e=""),n.uUt=l,l=[],o=x,s=b;else e+=c,l.push(e),e="";f=c}return""!==e&&(r&&!u&&(n.fUt=P(e)),l.push(e)),a&&(n.rCt=x),o?n.sUt=l:n.uUt=l,n}function U(t,n,e,i){for(var r,o,a,u,s,c,f,l,h,d,r=n[0],o=1,a=0,u=b,s=t.length,c=0;c<s;c++)if("number"===(f=t[c].type)){for(l="",d=(h=t[c].value).length-1;0<=d;){if(!(1<=r&&r<=9||0===r&&o===n.length))throw new Error(C().Exp_InvalidNumberGroupSize);/\d/gi.test(h[d])?(u&&(l&&t.push({type:"number",value:l}),t.push({type:"groupSeparator",value:e}),l="",u=b),a++):a=0,l=h[d]+l,a===r&&0<r&&(u=x,a=0,o<n.length)&&(r=n[o],o++),d--}l&&t.push({type:f,value:l})}else"fillingChar"===f&&(i.infillIndex=t.length-s),t.push({type:f,value:t[c].value});t.splice(0,s)}function H(t,n,e,i,r,o){var a,a,u,s,u,a=$(t,-n),a=(u=(a=(t=a=isFinite(a)?a:t).toString()).split(/e/i))[0],s=1<u.length?h(u[1],10):0;return a=(u=a.split("."))[0],u=1<u.length?u[1]:"",0<s?(a+=(u=l(u,s)).slice(0,s),u=N(u,s)):s<0&&(s=-s,u=(a=t<0?o+I(a.replace(o,""),1+s):I(a,1+s)).slice(-s,a.length)+u,a=a.slice(0,-s)),a+(u=0<n?r+(u=u.length>n?u.slice(0,n):l(u,n)):"")}function z(t,n,e,i){var t=t;return 0<n&&(t=R(t*s(100,n),15)),0<e&&(t=R(t*s(1e3,e),15)),t=0<i?R(t/s(1e3,i),15):t}function V(t){var n,e,i,n=p;if(t)for(n="",e=0;e<t.length;e++)i=t[e],/^(0|#|\?)+/g.test(i)&&(n+=i);return n}function Y(t,n){var e,i,e=16777216,i;return t===n||y(t-n)<y(t)/(e*e)||(t=R(t,15),n=R(n,15),y(t-n)<y(t)/(e*e))}function Z(t,n,e){var i,r,o,a,e,u,t,i={value:t,exponentValue:0},r,o=E(t,".").iUt,a=y(t),e=e?e.length:1;if(1<=a)e<o?(i.value=t/s(10,o-=e),i.exponentValue=o):i.exponentValue=0,-1===n.aUt&&(n.aUt=0);else if(a<1&&0<a){for(n.aUt=-1,u=s(10,e);10*a<u&&!Y(10*a,u);)a*=10,i.exponentValue++;t=s(10,i.exponentValue),i.value*=v<t?0:t}return i}function W(t,n,e,i,r,o,a,u){var s,c,f,l,h,d,u,v,m,g,p,b,y,w,M,C,S,T,A,s=u.numberGroupSizes,c=u.numberGroupSeparator,f=u.negativeSign,l=u.percentSymbol,h=u.perMilleSymbol,d=i.fUt,u=N(n,0,1);for(n=0===(v=1===(n=u===f?N(n,1):n).length&&"0"===n?0:n.length)?"":n,m=0,g="",p=t.length-1;0<=p;p--)if(b="",y=t[p],/^(0|#|\?)+/g.test(y)){if(g!==e){for(w=y.length,M=v-m-1;0<=M&&0<w;M--)b=(C=n.charAt(M))+b,w--,m++;for(S=w-1;0<=S;S--)m++,"0"===(T=y[S])?b=T+b:"?"===T&&(""!==b&&(o.push({type:"number",value:b}),b=""),o.push({type:"numberPlaceholder",value:T}));""!==(b=(g=y+g)===e&&m<v?n.substr(0,v-m)+b:b)&&o.push({type:"number",value:b})}}else i.fUt&&!a.replaceExponent&&/^((E(\+|-)?|e(\+|-)?)\d+)/g.test(y)?(a.replaceExponent=x,A="",A=(A=(A+=d.oUt)+D[d.aUt])+I(r.toString(),d.tUt),o.push({type:"exponent",value:A})):"_"===y[0]?o.push({type:"placeholder",value:y[1]}):"*"===y[0]?a.hasInfilling||(o.push({type:"fillingChar",value:y[1]}),a.hasInfilling=!0,a.infillIndex=o.length-1):"\\"===y[0]?2===y.length&&o.push({type:"text",value:y[1]}):'"'===y[0]&&'"'===y[y.length-1]?2<y.length&&o.push({type:"text",value:y.substr(1,y.length-2)}):y===l?o.push({type:"percent",value:y}):y===h?o.push({type:"permille",value:y}):_[y]?o.push({type:"currency",value:y}):o.push({type:"text",value:y});u===f&&e&&o.push({type:"text",value:u}),i.rCt===x&&U(o,s,c,a),o.reverse(),a.infillIndex=o.length-1-a.infillIndex}function Q(t,n,e,i,r,o,a,u,s){var c,f,l,s,h,d,v,m,g,p,b,y,w,M,C,S,T,c=s.numberDecimalSeparator,f=s.percentSymbol,l=s.perMilleSymbol,s=n.indexOf(c),h=r.fUt;for((0<s||i!==A||e!==k)&&a.push({type:"decimalSeparator",value:c}),d=-1!==s?n.substring(s+1):"",m="",g=v=0;g<t.length;g++)if(p=t[g],/^(0|#|\?)+/g.test(p)){if(b="",m!==e){for(y=p.length,w=0,M=v;0<y&&0<d.length-v;)b+=d.charAt(M),y--,v++,w++,M++;for(C=w;0<y;)S=p[C],C++,v++,y--,"0"===S?b+=S:"?"===S&&(""!==b&&(a.push({type:"number",value:b}),b=""),a.push({type:"numberPlaceholder",value:S}));""!==b&&a.push({type:"number",value:b}),m+=p}}else h&&!u.replaceExponent&&/^((E(\+|-)?|e(\+|-)?)\d+)/g.test(p)?(u.replaceExponent=x,T="",T=(T=(T+=h.oUt)+D[h.aUt])+I(o.toString(),h.tUt),a.push({type:"exponent",value:T})):"_"===p[0]?a.push({type:"placeholder",value:p[1]}):"*"===p[0]?(a.push({type:"fillingChar",value:p[1]}),u.hasInfilling&&a.splice(u.infillIndex,1),u.hasInfilling=!0,u.infillIndex=a.length-1):"\\"===p[0]?2===p.length&&a.push({type:"text",value:p[1]}):'"'===p[0]&&'"'===p[p.length-1]?2<p.length&&a.push({type:"text",value:p.substr(1,p.length-2)}):p===f?a.push({type:"percent",value:p}):p===l?a.push({type:"permille",value:p}):_[p]?a.push({type:"currency",value:p}):a.push({type:"text",value:p})}function J(t,n){var e,i,e=t,i;return e=-1!==t.indexOf(n)?t.replace(/0+$/,""):e}function K(t,n,e,i){var r,o,a,u,s,c,c,f,l,h,d,v,m,t,f,l,g,r=[];return t=z(t,n.d0,n.cUt,n.fxt),o=n.uUt,a=n.sUt,(o||a)&&(u=V(o),s=(s=V(a))||"",n.fUt&&(t=(c=Z(t,n.fUt,u)).value,c=c.exponentValue),f=E(t,"."),1<y(t)&&15<f.iUt+f.rUt&&(t=R(t,15)),l=e.numberGroupSizes,h=e.numberGroupSeparator,d=e.numberDecimalSeparator,v=e.negativeSign,t=H(t,m=w(f.rUt,s.length),l,h,d,v),""===(t=i?t:J(t,d))?r.push({type:"text",value:(o?o.join(""):"")+(a?a.join(""):"")}):(f={hasInfilling:b,infillIndex:-1,replaceExponent:b},"10"!==(l=t.split(d)[0])||isNaN(c)||(l="1",c+=(g=n&&n.fUt&&-1===n.fUt.aUt)?-1:1),o&&W(o,l,u,n,c,r,f,e),"0"!==l&&""===u&&a&&r.push({type:"number",value:l}),a&&Q(a,t,s,u,n,c,r,f,e))),r}function X(t,n){var n,e,i,r,o,t,a,e,u,o,i,e,a,s,i,r,e;return(t=f(t)?"":c.zf.s6t(t,"")).match(/^[+-]?infinity$/i)?d(t):t.match(/^0x[a-f0-9]+$/i)?h(t,10):(r=(i=j(t,n=n.NumberFormat,e=n.numberNegativePattern))[0],o=i[1],""===r&&1!==e&&(r=(i=j(t,n,1))[0],o=i[1]),""===r&&(r="+"),t=(e=(e=(o=o[0]===n.currencySymbol?N(o,1):o).indexOf("e"))<0?o.indexOf("E"):e)<0?(a=o,p):(a=N(o,0,e),N(o,e+1)),o=(i=a.indexOf("."))<0?(u=a,p):(u=N(a,0,i),N(a,i+".".length)),u=u.split(",").join(""),a=r+(u=","!==(e=",".replace(/\u00A0/g," "))?u.split(e).join(""):u),o!==p&&(a+="."+o),(s=a[a.length-1])===n.percentSymbol&&(a=N(a,0,a.length-1),-1===(i=(a=c.zf.s6t(a,"")).indexOf("."))&&(i=a.length),r="",a=r=(r=(r=r+N(a,0,i-2)+".")+N(a,i-2,2))+N(a,i+1)),t!==p&&(""===(e=j(t,n,1))[0]&&(e[0]="+"),a+="e"+e[0]+e[1]),a.match(/^[+-]?\d*\.?\d*(e[+-]?\d+)?$/)?d(a):NaN)}function j(t,n,e){var i,n,i=n.negativeSign,n=n.positiveSign;if(4!==e&&2!==e||(i=" "+i,n=" "+n),4===e||3===e){if(c.zf.dT(t,i))return["-",N(t,0,t.length-i.length)];if(c.zf.dT(t,n))return["+",N(t,0,t.length-n.length)]}else if(2===e||1===e){if(c.zf.fJ(t,i))return["-",N(t,i.length)];if(c.zf.fJ(t,n))return["+",N(t,n.length)]}else{if(0!==e)throw new Error("");if(c.zf.fJ(t,"(")&&c.zf.dT(t,")"))return["-",N(t,1,t.length-2)]}return["",t]}function q(t,n,e){if(0!==y(u(t)-t))throw new Error(C().Exp_BadFormatSpecifier);var t=(0<=t?t:S+t+1).toString(16),t=n?t.toLowerCase():t.toUpperCase();return!f(e)&&t.length<e?I(t,e):t}function $(t,n){var e,i;return t=+t,n=+n,isNaN(t)||n%1!=0?NaN:(t=(e=t<0)?-t:t,typeof n===a||0===n?(t=Math.round(t),e?-t:t):(i=t.toString().split("e"),t=Math.round(+(i[0]+"e"+(i[1]?+i[1]-n:-n))),+((i=(t=e?-t:t).toString().split("e"))[0]+"e"+(i[1]?+i[1]+n:n))))}function O(t){var n=o.CultureManager.Fe().NumberFormat;return n="string"==typeof t?o.CultureManager.Fe(t).NumberFormat:n}function tt(t){var n,e,i,r,n="";if(Array.isArray(t)&&0<t.length)for(e=0;e<t.length;e++)i=t[e].type,r=t[e].value,"placeholder"===i?n+=" ":"fillingChar"!==i&&(n+="numberPlaceholder"===i?" ":r);return n}function R(t,n){return t="number"==typeof t&&t.toString().length>=n?+t.toPrecision(n):t}Object.defineProperty(t,"__esModule",{value:!0}),t.st=void 0,e=n("./src/common/util/common.ts"),i=n("./src/common/util/types.ts"),r=n("./src/common/util/regexhelper.ts"),c=n("./src/common/util/stringhelper.ts"),o=n("./src/common/culture/cultureInfo.ts"),f=i.lt.ht,I=c.zf.B9t,l=c.zf.lUt,p=null,a=void 0,h=parseInt,d=parseFloat,x=!(b=!1),u=Math.floor,y=Math.abs,s=Math.pow,w=Math.min,v=Number.MAX_VALUE,m="#dot#",g="#group#",N=function(t,n,e){return t.substr(n,e)},M=function(t){return r.$T.qT(t)},n=new e.ResourceManager(e.SR),C=n.getResource.bind(n),A="##################0",k="################",D={1:"+",0:"","-1":"-"},S=4294967295,T=["0","#","?"],_={"\xa4":"\xa4",Br:"Br",Fdj:"Fdj",Nfk:"Nfk",R:"R",$:"$",FCFA:"FCFA","GH\u20b5":"GH\u20b5","\u1265\u122d":"\u1265\u122d","\u0631.\u0633.\u200f":"\u0631.\u0633.\u200f",XDR:"XDR","\u062f.\u0625.\u200f":"\u062f.\u0625.\u200f","\u062f.\u0628.\u200f":"\u062f.\u0628.\u200f","\u062f.\u062c.\u200f":"\u062f.\u062c.\u200f","\u062c.\u0645.\u200f":"\u062c.\u0645.\u200f","\u20aa":"\u20aa","\u062f.\u0639.\u200f":"\u062f.\u0639.\u200f","\u062f.\u0627.\u200f":"\u062f.\u0627.\u200f","\u0641.\u062c.\u0642.\u200f":"\u0641.\u062c.\u0642.\u200f","\u062f.\u0643.\u200f":"\u062f.\u0643.\u200f","\u0644.\u0644.\u200f":"\u0644.\u0644.\u200f","\u062f.\u0644.\u200f":"\u062f.\u0644.\u200f","\u062f.\u0645.\u200f":"\u062f.\u0645.\u200f","\u0623.\u0645.\u200f":"\u0623.\u0645.\u200f","\u0631.\u0639.\u200f":"\u0631.\u0639.\u200f","\u0631.\u0642.\u200f":"\u0631.\u0642.\u200f","\u062c.\u0633.":"\u062c.\u0633.",S:"S","\xa3":"\xa3","\u0644.\u0633.\u200f":"\u0644.\u0633.\u200f","\u062f.\u062a.\u200f":"\u062f.\u062a.\u200f","\u0631.\u064a.\u200f":"\u0631.\u064a.\u200f","\u20b9":"\u20b9",TSh:"TSh","\u20ac":"\u20ac","\u20bc":"\u20bc","\u20bd":"\u20bd",K:"K","\u043b\u0432.":"\u043b\u0432.","\u20a6":"\u20a6",CFA:"CFA","\u09f3":"\u09f3","\xa5":"\xa5",KM:"KM","\u041a\u041c":"\u041a\u041c",USh:"USh","K\u010d":"K\u010d","kr.":"kr.",Ksh:"Ksh",CHF:"CHF","\u0783.":"\u0783.","Nu.":"Nu.",EC$:"EC$",P:"P",US$:"US$",D:"D",Rp:"Rp",Ar:"Ar",MOP$:"MOP$",Rs:"Rs",MK:"MK",RM:"RM","\u20b1":"\u20b1",RF:"RF",SR:"SR",SDG:"SDG",Le:"Le","NAf.":"NAf.",E:"E",T$:"T$",VT:"VT",WS$:"WS$",Bs:"Bs","\u20a1":"\u20a1",Q:"Q",L:"L",C$:"C$","B/.":"B/.","S/.":"S/.","\u20b2":"\u20b2","Bs.":"Bs.","\u0631\u064a\u0627\u0644":"\u0631\u064a\u0627\u0644",FG:"FG",UM:"UM",kr:"kr",FBu:"FBu",FC:"FC",DA:"DA",G:"G",CF:"CF",DH:"DH",FCFP:"FCFP",LS:"LS",DT:"DT",kn:"kn",HUF:"HUF","\u058f":"\u058f",ISK:"ISK","\u20be":"\u20be","\u200b":"\u200b","\u20b8":"\u20b8","\u17db":"\u17db","\u20a9":"\u20a9","\u0441\u043e\u043c":"\u0441\u043e\u043c",Kz:"Kz","\u20ad":"\u20ad",MTn:"MTn","\u0434\u0435\u043d":"\u0434\u0435\u043d","\u20ae":"\u20ae","\u0930\u0941":"\u0930\u0941","Afl.":"Afl.","\u07d6\u07d5.":"\u07d6\u07d5.","\u0440\u0443\u0431.":"\u0440\u0443\u0431.","z\u0142":"z\u0142","\u060b":"\u060b",R$:"R$",Db:"Db",RON:"RON","\u20b4":"\u20b4",MAD:"MAD","\u0dbb\u0dd4.":"\u0dbb\u0dd4.","Lek\xeb":"Lek\xeb",den:"den",RSD:"RSD","\u0434\u0438\u043d.":"\u0434\u0438\u043d.","\u0720.\u0723.\u200f":"\u0720.\u0723.\u200f","Rs.":"Rs.","\u0441\u043c\u043d":"\u0441\u043c\u043d","\u0e3f":"\u0e3f","m.":"m.","\u20ba":"\u20ba","\u2d37\u2d54":"\u2d37\u2d54","so\u02bbm":"so\u02bbm","\u0441\u045e\u043c":"\u0441\u045e\u043c","\u20ab":"\u20ab",HK$:"HK$",MOP:"MOP",NT$:"NT$"},t.st={yU:function(t){return X(t,o.CultureManager.Fe())},Z6t:function(t){return X(t,o.CultureManager.Fe("invariant"))},L9t:function(t,n,e,i){return L(t,n,e=e||o.CultureManager.Fe(),i)},Ge:function(t,n){var n,e,n;return t="string"==typeof t&&(e=(n=O(n)).numberDecimalSeparator,n=n.numberGroupSeparator,"."!==e&&(t=t.replace(M("[.]"),m)),","!==n&&(t=t.replace(M("[,]"),g)),"."!==e&&(t=t.replace(M(m),e)),","!==n)?t.replace(M(g),n):t},Jf:function(t,n){var n,e,n;return t="string"==typeof t&&(e=(n=O(n)).numberDecimalSeparator,n=n.numberGroupSeparator,"."!==e&&(t=t.replace(M("["+e+"]"),m)),","!==n&&(t=t.replace(M("["+n+"]"),g)),"."!==e&&(t=t.replace(M(m),".")),","!==n)?t.replace(M(g),","):t},hUt:function(t,n){var n,e,n;return!("string"==typeof t&&(e=(n=O(n)).numberDecimalSeparator,n=n.numberGroupSeparator,"."!==e&&"."!==n&&0<=t.indexOf(".")||","!==e&&","!==n&&0<=t.indexOf(",")))},dUt:function(t,n){return d(this.Jf(t,n))},VGt:q,v0:G,vUt:K,mUt:tt,gUt:A,pUt:k,E8:R}},"./src/common/util/rbush.ts":function(t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.rbush=void 0;var o=Math.max,a=Math.min,h=Number.POSITIVE_INFINITY;function e(t,n){this.bUt=o(4,t||9),this.yUt=o(2,Math.ceil(.4*this.bUt)),n&&this.wUt(n),this.clear()}function f(t,n,e){if(!e)return n.indexOf(t);for(var i=0;i<n.length;i++)if(e(t,n[i]))return i;return-1}function u(t,n){l(t,0,t.children.length,n,t)}function l(t,n,e,i,r){(r=r||w(null)).minX=h,r.minY=h,r.maxX=-h,r.maxY=-h;for(var o=n,a=void 0;o<e;o++)a=t.children[o],d(r,t.leaf?i(a):a);return r}function d(t,n){t.minX=a(t.minX,n.minX),t.minY=a(t.minY,n.minY),t.maxX=o(t.maxX,n.maxX),t.maxY=o(t.maxY,n.maxY)}function s(t,n){return t.minX-n.minX}function c(t,n){return t.minY-n.minY}function v(t){return(t.maxX-t.minX)*(t.maxY-t.minY)}function m(t){return t.maxX-t.minX+(t.maxY-t.minY)}function g(t,n){return(o(n.maxX,t.maxX)-a(n.minX,t.minX))*(o(n.maxY,t.maxY)-a(n.minY,t.minY))}function p(t,n){var e=o(t.minX,n.minX),i=o(t.minY,n.minY),r=a(t.maxX,n.maxX),t=a(t.maxY,n.maxY);return o(0,r-e)*o(0,t-i)}function b(t,n){return t.minX<=n.minX&&t.minY<=n.minY&&(0<=n.maxX&&n.maxX<=t.maxX||t.maxX<0)&&(0<=n.maxY&&n.maxY<=t.maxY||t.maxY<0)}function y(t,n){return(-1===t.minY||-1===n.minY||t.minY<=n.maxY&&n.minY<=t.maxY)&&(-1===t.minX||-1===n.minX||t.minX<=n.maxX&&n.minX<=t.maxX)}function w(t){return{children:t,height:1,leaf:!0,minX:h,minY:h,maxX:-h,maxY:-h}}(n.rbush=e).prototype={all:function(){return this.QP(this.data,[])},search:function(t){var n,e,i,r,o,a,u,s,n=this.data,e=[],i=this.toBBox;if(y(t,n))for(r=[];n;){for(o=0,a=n.children.length;o<a;o++)u=n.children[o],y(t,s=n.leaf?i(u):u)&&(n.leaf?e.push(u):b(t,s)?this.QP(u,e):r.push(u));n=r.pop()}return e},collides:function(t){var n,e,i,r,o,a,u,n=this.data,e=this.toBBox;if(y(t,n))for(i=[];n;){for(r=0,o=n.children.length;r<o;r++)if(a=n.children[r],y(t,u=n.leaf?e(a):a)){if(n.leaf||b(t,u))return!0;i.push(a)}n=i.pop()}return!1},insert:function(t){return t&&this.Eit(t,this.data.height-1),this},clear:function(){return this.data=w([]),this},remove:function(t,n){if(t)for(var e=this.data,i=this.toBBox(t),r=[],o=[],a,u,s,c;e||r.length;){if(e||(e=r.pop(),u=r[r.length-1],a=o.pop(),c=!0),e.leaf&&-1!==(s=f(t,e.children,n)))return e.children.splice(s,1),r.push(e),this.MUt(r),this;c||e.leaf||!b(e,i)?u?(a++,e=u.children[a],c=!1):e=null:(r.push(e),o.push(a),e=(u=e).children[a=0])}return this},toBBox:function(t){return t},compareMinX:s,compareMinY:c,toJSON:function(){return this.data},fromJSON:function(t){return this.data=t,this},QP:function(t,n){for(var e=[];t;)t.leaf?n.push.apply(n,t.children):e.push.apply(e,t.children),t=e.pop();return n},CUt:function(t,n,e,i){for(var r,o,a,u,s,c,f,l;i.push(n),!n.leaf&&i.length-1!==e;){for(f=l=h,r=0,o=n.children.length;r<o;r++)s=v(a=n.children[r]),(c=g(t,a)-s)<l?(l=c,f=s<f?s:f,u=a):c===l&&s<f&&(f=s,u=a);n=u||n.children[0]}return n},Eit:function(t,n,e){var i,e,r,i,i=this.toBBox,e=e?t:i(t),r=[],i=this.CUt(e,this.data,n,r);for(i.children.push(t),d(i,e);0<=n&&r[n].children.length>this.bUt;)this.SUt(r,n),n--;this.TUt(e,r,n)},SUt:function(t,n){var e,i,r,r,i,e=t[n],i=e.children.length,r=this.yUt;this.AUt(e,r,i),r=this.IUt(e,r,i),(i=w(e.children.splice(r,e.children.length-r))).height=e.height,i.leaf=e.leaf,u(e,this.toBBox),u(i,this.toBBox),n?t[n-1].children.push(i):this.xUt(e,i)},xUt:function(t,n){this.data=w([t,n]),this.data.height=t.height+1,this.data.leaf=!1,u(this.data,this.toBBox)},IUt:function(t,n,e){for(var i,r,o,a,r,u,s,c,u=s=h,i=n;i<=e-n;i++)a=p(r=l(t,0,i,this.toBBox),o=l(t,i,e,this.toBBox)),r=v(r)+v(o),a<u?(u=a,c=i,s=r<s?r:s):a===u&&r<s&&(s=r,c=i);return c},AUt:function(t,n,e){var i=t.leaf?this.compareMinX:s,r=t.leaf?this.compareMinY:c,o,a;this.NUt(t,n,e,i)<this.NUt(t,n,e,r)&&t.children.sort(i)},NUt:function(t,n,e,i){t.children.sort(i);for(var r=this.toBBox,o=l(t,0,n,r),a=l(t,e-n,e,r),u=m(o)+m(a),s,c,s=n;s<e-n;s++)c=t.children[s],d(o,t.leaf?r(c):c),u+=m(o);for(s=e-n-1;n<=s;s--)c=t.children[s],d(a,t.leaf?r(c):c),u+=m(a);return u},TUt:function(t,n,e){for(var i=e;0<=i;i--)d(n[i],t)},MUt:function(t){for(var n=t.length-1,e=void 0;0<=n;n--)0===t[n].children.length?0<n?(e=t[n-1].children).splice(e.indexOf(t[n]),1):this.clear():u(t[n],this.toBBox)},wUt:function(t){var n=["return a"," - b",";"];this.compareMinX=new Function("a","b",n.join(t[0])),this.compareMinY=new Function("a","b",n.join(t[1])),this.toBBox=new Function("a","return {minX: a"+t[0]+", minY: a"+t[1]+", maxX: a"+t[2]+", maxY: a"+t[3]+"};")}}},"./src/common/util/regexhelper.ts":function(t,n,e){var r,i,o,a;function c(){}Object.defineProperty(n,"__esModule",{value:!0}),n.$T=void 0,r=e("./src/common/util/stringhelper.ts"),i=!0,o="empty",c.bue=function(t,n){var e;if(n&&c.yue[n]&&c.yue[n][t])e=c.yue[n][t];else try{null==n?(e=new RegExp(t),n=o):e=new RegExp(t,n),c.yue[n]||(c.yue[n]={}),c.yue[n][t]=e}catch(t){return null}return e.lastIndex=0,e},c.qT=function(t){var n=c.kUt[t],n;return(n=n||(c.kUt[t]=new RegExp(t,"g"))).lastIndex=0,n},c.OJ=function(t){var n=c.DUt[t],n;return(n=n||(c.DUt[t]=new RegExp(t,"gi"))).lastIndex=0,n},c.jJ=function(t,n,e){var i,r,o,a,u,s;if(c._Ut[t])return c.EUt[t];if(c.qT(i="[~?*]+").test(t)){for(r=[],o=t.split(""),u={".":!(a=void 0),"+":!0,$:!0,"^":!0,"[":!0,"]":!0,"(":!0,")":!0,"{":!0,"}":!0,"|":!0,"/":!0,"\\":!0},s=0;s<o.length;s++)"~"===(a=o[s])&&s<o.length-1?("*"===(a=o[++s])||"?"===a?r.push("\\"):n&&r.push("~"),r.push(a)):"?"===a?r.push("."):"*"===a?(r.push("[\\s\\S]"),r.push(e?"+":"*")):(u[a]&&r.push("\\"),r.push(a));return r.join("")}return null},c.tbt=function(t,n,e){var t=c.jJ(t,n,e),t;return t=t&&"^"+t+"$"},c.jUt=function(t,n){for(var e,i,e="#"+t+"0#",i=1;0<n.indexOf(e);)e=r.zf.qS(e,"#"+t+(i-1)+"#","#"+t+i+"#"),i++;return e},c.D9t=function(t){return t.replace(/([\~\!\@\#\$\%\^\&\*\(\)\-\_\+\=\[\]\{\}\|\\\;\:\'\"\,\.\/\<\>\?])/,"\\$1")},c.kUt={},c.DUt={},c.yue={},c._Ut={},c.EUt={},n.$T=c},"./src/common/util/stringhelper.ts":function(t,r,n){Object.defineProperty(r,"__esModule",{value:!0}),r.zf=void 0;var o=n("./src/common/util/regexhelper.ts");function a(t,n,e){return t.substr(n,e)}function u(t){return null==t}function i(t,n,e,i){var r,n;if(u(n))throw new Error;return""===n||!(n.length>t.length)&&(r=t,n=n,e&&(r=t.toLowerCase(),n=n.toLowerCase()),i(r,n))}r.zf={OS:function(t,n,e){return e&&(t=t.toLowerCase(),n=n.toLowerCase()),""===n||0<=t.indexOf(n)},hD:function(t,n,e){var e,i;return e?(e=t.toLowerCase(),i=n.toLowerCase(),e.indexOf(i)):t.indexOf(n)},cJ:function(t,n){if(!n)return t;for(var e=t;a(e,0,n.length)===n;)e=a(e,n.length);return e},s6t:function(t,n){if(!n)return t;for(var e=t;a(e,e.length-n.length,n.length)===n;)e=a(e,0,e.length-n.length);return e},Eit:function(t,n,e){var i,r;if(n<0||n>t.length||u(e))throw new Error;return(i=a(t,0,n))+e+(r=a(t,n,t.length-n))},VP:function(t,n,e){var i,r;if(u(e)&&(e=t.length-n),n<0||e<0||n+e>t.length)throw new Error;return(i=a(t,0,n))+(r=a(t,n+e,t.length-n-e))},fJ:function(t,n,e){return i(t,n,e=void 0===e?!1:e,function(t,n){return t.slice(0,n.length)===n})},dT:function(t,n,e){return i(t,n,e=void 0===e?!1:e,function(t,n){return t.slice(-n.length)===n})},Vi:function(t,n,e,i){if(n)return e=(""+e).replace(/\$/g,"$$$$"),t.replace(new RegExp(n,"g"+(i?"i":"")),e);throw new Error},OUt:function(t,n,e,i){return n=o.$T.D9t(n),r.zf.Vi(t,n,e,i)},gmt:function(t,n){var n=t.indexOf(n);return n<0||n>=t.length?t:a(t,0,n)},DU:function(t,n){for(var e=0,i=t.indexOf(n);0<=i;)e+=1,i=t.indexOf(n,i+1);return e},qS:function(t,n,e){return t.split(n).join(e)},I5:function(t,n){for(var e,i,r,e=t,i=0;i<n.length;i++)r=new RegExp("\\{"+i+"\\}","g"),e=e.replace(r,n[i]);return e},RUt:function(t,n,e){for(var i,r,i=t.toString(),r=i.length;r<n;r++)i=e?"0"+i:i+"0";return i},B9t:function(t,n){return r.zf.RUt(t,n,!0)},lUt:function(t,n){return r.zf.RUt(t,n,!1)},Dbt:function(t,n){return t===n||!t&&!n||t&&n&&t.toLowerCase()===n.toLowerCase()},Gmt:function(t){return t.toUpperCase()},j0:function(t){var n,e,n={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#x27;","`":"&#x60;"},e=o.$T.qT("(?:&|<|>|\"|'|`)");return e.test(t)?t.replace(e,function(t){return n[t]}):t},dI:function(t){var n,e,n={"&amp;":"&","&lt;":"<","&gt;":">","&quot;":'"',"&#x27;":"'","&#x60;":"`"},e=o.$T.qT("(?:&amp;|&lt;|&gt;|&quot;|&#x27;|&#x60;)");return e.test(t)?t.replace(e,function(t){return n[t]}):t},TY:function(t){var n;return t.replace(/javascript:/gi,"")}}},"./src/common/util/types.ts":function(t,l){Object.defineProperty(l,"__esModule",{value:!0}),l.lt=void 0,l.lt={BUt:null,y0:function(t,n){var e,i,r,o;if(l.lt.Gh(t))for(i=0,r=t.length;i<r&&!1!==(e=n.call(t[i],i,t[i]));i++);else for(o in t)if(t.hasOwnProperty(o)&&!1===(e=n.call(t[o],o,t[o])))break;return t},_h:function(t){return!t||"object"==typeof t&&0===Object.keys(t).length},Eh:function(t){return"function"===l.lt.Oh(t)},Nh:function(t){return Array.isArray?Array.isArray(t):"array"===l.lt.Oh(t)},jh:function(t){return l.lt.OMt(t)&&(t=parseFloat(t)),!isNaN(t)&&isFinite(t)},OMt:function(t){return"string"==typeof t},Oh:function(t){var n,e,i,r,o,a;if(null===t)return"null";if(!(n=l.lt.BUt))for(n=l.lt.BUt={},i=0,r=(e=["Boolean","Number","String","Function","Array","Date","RegExp","Object","Error"]).length;i<r;i++)n["[object "+e[i]+"]"]=e[i].toLowerCase();return o=n.toString,"object"==(a=typeof t)||"function"==a?n[o.call(t)]||"object":a},Rh:function(t,n,e){var i,r;if(n){if(r=[].indexOf)return r.call(n,t,e);for(i=n.length,e=(e=l.lt.ht(e)?0:e)<0?Math.max(0,i+e):e;e<i;e++)if(e in n&&n[e]===t)return e}return-1},Bh:function(t,n){var e=n.length,i=t.length,r=0;if("number"==typeof e)for(;r<e;r++)t[i]=n[r],i++;else for(;void 0!==n[r];)t[i]=n[r],i++,r++;return t.length=i,t},Lh:function(t,n,e){var i,r,o,a,u,r=[];if(l.lt.Gh(t))for(o=0,a=t.length;o<a;o++)null!==(i=n(t[o],o,e))&&(r[r.length]=i);else for(u in u=void 0,t)t.hasOwnProperty(u)&&null!==(i=n(t[u],u,e))&&(r[r.length]=i);return r.concat([])},Dh:function(){for(var t,n,e,i,r,o,a,i,u,s,c,f,t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];for(c=t.length,f=!(s=1),"boolean"==typeof(u=t[0]||{})&&(f=u,u=t[1]||{},s=2),"object"==typeof u||l.lt.Eh(u)||(u={}),c===s&&(u=this,--s);s<c;s++)if(!l.lt.ht(a=t[s]))for(o in a)e=u[o],u!==(r=a[o])&&(i=l.lt.Nh(r),f&&r&&(l.lt.Ph(r)||i)?(i=i?e&&l.lt.Nh(e)?e:[]:e&&l.lt.Ph(e)?e:{},u[o]=l.lt.Dh(f,i,r)):void 0!==r&&(u[o]=r));return u},Fh:function(t,n){for(var e in n)n.hasOwnProperty(e)&&(t[e]=n[e]);function i(){this.constructor=t}i.prototype=n.prototype,t.prototype=new i},Uh:function(t){return null!==t&&t===t.window},Ph:function(t){var n,e;if(!t||"object"!==l.lt.Oh(t)||t.nodeType||l.lt.Uh(t))return!1;n={}.hasOwnProperty;try{if(t.constructor&&!n.call(t,"constructor")&&!n.call(t.constructor.prototype,"isPrototypeOf"))return!1}catch(t){return!1}for(e in t);return void 0===e||n.call(t,e)},Gh:function(t){var n,e;return!l.lt.ht(t)&&(n=t.length,e=l.lt.Oh(t),!l.lt.Uh(t))&&(!(1!==t.nodeType||!n)||"array"===e||"function"!==e&&(0===n||"number"==typeof n&&0<n&&n-1 in t))},Hh:function(t,n){var n=n||[];return null!==t&&(l.lt.Gh(Object(t))?l.lt.Bh(n,"string"==typeof t?[t]:t):[].push.call(n,t)),n},dt:null,ht:function(t){return null==t},q8:null,uJ:null,tv:function(t){if(!t)return t;if("number"==typeof t||"string"==typeof t||"boolean"==typeof t||l.lt.ht(t))return t;if(t.clone)return t.clone();if(t instanceof Date)return new Date(t.valueOf());var n,e,i,n=t instanceof Object?new t.constructor:new t.constructor(t.valueOf());for(e in t)t.hasOwnProperty(e)&&(i=t[e],t.hasOwnProperty(e))&&n[e]!==i&&(n[e]="object"==typeof i?l.lt.tv(i):i);return n.toString=t.toString,n.valueOf=t.valueOf,n}}},"./src/common/util/util.res.en.ts":function(t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.Exp_Separator=n.Exp_InvalidCast=n.Exp_InvalidNumberFormat=n.Exp_BadFormatSpecifier=n.Exp_InvalidNumberGroupSize=n.Exp_InvalidSemicolons=n.Exp_InvalidExponentFormat=n.Exp_InvalidDateFormat=void 0,n.Exp_InvalidDateFormat="Invalid date format pattern",n.Exp_InvalidExponentFormat="invalid exponent format",n.Exp_InvalidSemicolons="invalid format : too many semicolons",n.Exp_InvalidNumberGroupSize="NumberGroupSize must be between 1 and 9, except for the last element, which can be zero.",n.Exp_BadFormatSpecifier="Bad Format Specifier",n.Exp_InvalidNumberFormat="Invalid number format pattern",n.Exp_InvalidCast="InvalidCastException",n.Exp_Separator="numberDecimalSeparator, listSeparator and arrayListSeparator should be different in culture info."},"./src/plugins/commands/commands.entry.ts":function(t,n,e){var i,r;Object.defineProperty(n,"__esModule",{value:!0}),n.UndoManager=n.CommandManager=n.Key=void 0,i=e("./src/plugins/commands/commands.ts"),Object.defineProperty(n,"Key",{enumerable:!0,get:function(){return i.Key}}),Object.defineProperty(n,"CommandManager",{enumerable:!0,get:function(){return i.CommandManager}}),r=e("./src/plugins/commands/undomanager.ts"),Object.defineProperty(n,"UndoManager",{enumerable:!0,get:function(){return r.UndoManager}})},"./src/plugins/commands/commands.ts":function(t,n){var a,s,e,i;function r(t,n,e){var i,r;this.jS=t,this.LUt=n,this.Zc=e,i=this,Object.defineProperty(i,"shortcutKey",{get:function(){return i.FUt},set:function(t){var n,n,e,n=i.FUt;n!==t&&((n=(r=i.jS.PUt)[n])&&0<=(e=n.indexOf(i))&&n.splice(e,1),i.FUt=t)&&((n=r[t])||(r[t]=n=[]),n.splice(0,0,i))}})}function o(t){this.DJ=t,this.aT={},this.GUt={},this.PUt={}}Object.defineProperty(n,"__esModule",{value:!0}),n.CommandManager=n.Key=void 0,(i=a=n.Key||(n.Key={}))[i.left=37]="left",i[i.right=39]="right",i[i.up=38]="up",i[i.down=40]="down",i[i.tab=9]="tab",i[i.enter=13]="enter",i[i.shift=16]="shift",i[i.ctrl=17]="ctrl",i[i.space=32]="space",i[i.altkey=18]="altkey",i[i.home=36]="home",i[i.end=35]="end",i[i.pup=33]="pup",i[i.pdn=34]="pdn",i[i.backspace=8]="backspace",i[i.del=46]="del",i[i.esc=27]="esc",i[i.a=65]="a",i[i.c=67]="c",i[i.v=86]="v",i[i.x=88]="x",i[i.z=90]="z",i[i.y=89]="y",r.prototype.canUndo=function(){var t;return this.LUt.canUndo},r.prototype.execute=function(t,n,e){var i,r,o,a,i=this,o=!0;i.LUt&&n&&i.LUt.canUndo&&i.jS.UUt({command:n,result:r,vM:e,actionType:e});try{o=!1!==(r=(a=i.LUt.execute||i.LUt)(t,n,1===e))}catch(t){o=!1}return n&&o&&i.jS.HUt({command:n,result:r,vM:e,actionType:e}),r},s=r,o.prototype.register=function(t,n,e,i,r,o,a){var u,n,u=this,n=new s(u,n,t);u[t]=n,e&&(n.shortcutKey=u.getShortcutKey(e,i,r,o,a))},o.prototype.getCommand=function(t){return this[t]},o.prototype.execute=function(t){var n=this[t.cmd];if(n)return n.execute(this.DJ,t,0)},o.prototype.setShortcutKey=function(t,n,e,i,r,o){var a,t,t,u,s,a=this;if(t)(t=a[t])&&(t.shortcutKey=a.getShortcutKey(n,e,i,r,o));else if(t=a.getShortcutKey(n,e,i,r,o),u=a.getCommands(t))for(s=u.length-1;0<=s;s--)u[s].shortcutKey=void 0},o.prototype.getShortcutKey=function(t,n,e,i,r){var o,o;if(t)return(o=(o="A".charCodeAt(0)<=t&&t<="Z".charCodeAt(0)?String.fromCharCode(t):a[t])||t)+(n?"+ctrl":"")+(e?"+shift":"")+(i?"+alt":"")+(r?"+window":"")},o.prototype.getCommands=function(t){return this.PUt[t]},o.prototype.addListener=function(t,n){this.aT[t]=n},o.prototype.removeListener=function(t){delete this.aT[t]},o.prototype.HUt=function(t){var n,e,n=this.aT;for(e in n)n.hasOwnProperty(e)&&n[e](t)},o.prototype.cM=function(t,n){this.GUt[t]=n},o.prototype.zUt=function(t){delete this.GUt[t]},o.prototype.UUt=function(t){var n,e,n=this.GUt;for(e in n)n.hasOwnProperty(e)&&n[e](t)},o.prototype.L0=function(){this.DJ=null},n.CommandManager=o},"./src/plugins/commands/undomanager.ts":function(t,n){var e;function i(t,n,e){var i=this;i.DJ=t,i.VUt=n=n<0?2147483647:n,i.Hw=e,i.Nmt=[],i.kmt=[],i.YUt=!1}Object.defineProperty(n,"__esModule",{value:!0}),n.UndoManager=void 0,i.prototype.dM=function(t,n){var e,i,r,o,e=this;if(t){if(1===n)e.kmt.push(t);else{if(i=e.VUt,r=e.Nmt.length,0<i&&i<=r)for(o=0;o<r-i+1;o++)e.Nmt.shift();e.Nmt.push(t),0===n&&(e.kmt=[])}e.YUt=!0}},i.prototype.canUndo=function(){return 0<this.Nmt.length},i.prototype.undo=function(){var t,n,e,i,r,t=this,n=t.Nmt,e=!0;if(t.Hw&&t.canUndo()){i=n[n.length-1];try{(r=t.DJ.commandManager()[i.cmd])&&(i.hM=!0,e=r.execute(t.DJ,i,1))}catch(t){e=!1}delete i.hM,!1!==e&&(n.pop(),t.YUt=!0,t.kmt.push(i))}return e},i.prototype.canRedo=function(){return 0<this.kmt.length},i.prototype.redo=function(){var t,n,e,i,r,t=this,n=t.kmt,e=!0;if(t.Hw&&t.canRedo()){i=n[n.length-1];try{(r=t.DJ.commandManager()[i.cmd])&&(i.hM=!0,e=r.execute(t.DJ,i,2))}catch(t){e=!1}delete i.hM,!1!==e&&(n.pop(),t.YUt=!0,t.Nmt.push(i))}return e},i.prototype.getRedoStack=function(){return this.kmt.slice()},i.prototype.getUndoStack=function(){return this.Nmt.slice()},i.prototype.maxSize=function(t){var n=this;return arguments.length<1?n.VUt:(0<=t&&(n.VUt=t),n)},i.prototype.clear=function(){this.Nmt=[],this.kmt=[]},i.prototype.aL=function(t){this.Nmt=this.Nmt.filter(t),this.kmt=this.kmt.filter(t)},i.prototype.L0=function(){this.DJ=null},i.prototype.setNewChangeStatus=function(t){this.YUt=t},i.prototype.getNewChangeStatus=function(){return this.YUt},n.UndoManager=i},"./src/plugins/formatter/formatter.entry.ts":function(t,n,e){var i,r,i=this&&this.__createBinding||(Object.create?function(t,n,e,i){void 0===i&&(i=e);var r=Object.getOwnPropertyDescriptor(n,e);r&&("get"in r?n.__esModule:!r.writable&&!r.configurable)||(r={enumerable:!0,get:function(){return n[e]}}),Object.defineProperty(t,i,r)}:function(t,n,e,i){t[i=void 0===i?e:i]=n[e]}),r=this&&this.__exportStar||function(t,n){for(var e in t)"default"===e||Object.prototype.hasOwnProperty.call(n,e)||i(n,t,e)};Object.defineProperty(n,"__esModule",{value:!0}),r(e("./src/plugins/formatter/formatter.ts"),n)},"./src/plugins/formatter/formatter.res.en.ts":function(t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.Exp_InvalidCast=n.Exp_ValueIllegal=n.Exp_TokenIllegal=n.Exp_DuplicatedDescriptor=n.Exp_ValueIsNull=n.Exp_FormatIllegal=n.Exp_InvalidBackslash=n.Exp_TokenIsNull=void 0,n.Exp_TokenIsNull="token is null",n.Exp_InvalidBackslash="the '\\' cannot be evaluated",n.Exp_FormatIllegal="format is illegal.",n.Exp_ValueIsNull="value is null",n.Exp_DuplicatedDescriptor="The type of descriptor was added.",n.Exp_TokenIllegal="token is illegal.",n.Exp_ValueIllegal="value is illegal.",n.Exp_InvalidCast="InvalidCastException"},"./src/plugins/formatter/formatter.ts":function(m,t,n){var g,b,p,y,e,w,i,n,n,c,M,C,S,f,F,P,G,l,U,H,z,V,Y,T,Z,s,W,Q,J,K,X,A,I,u,x,h,q,N,d,k,$,tt,nt,et,i,it,rt,ot,at,ut,st,ct,ft,lt,ht,dt,vt,mt;function r(t,n){var n,t,e,i;if(kt.call(this,n),(n=this).Jq=t,e=R((t=n.Jq)[0],"$",!1),i=t.indexOf("-"),!(e&&-1<i))throw new Error(c().Exp_TokenIllegal);n.ZUt=j(t,1,i-1),0<(t=b.zf.VP(t,0,i+1)).length&&(n.Iat=parseInt(t,16))}function o(t,n){this.formatCached=t,this.cultureName=n,this.typeName=""}function gt(t,n){var i,e,r,o,a,u,s,r;for(kt.call(this,n),i=this,u=0,s=(a=["<=","<>",">=",">","<","="]).length;u<s;u++)if(b.zf.fJ(t,e=a[u],!0)){r=b.zf.VP(t,0,e.length),r=parseFloat(r),A(r)||(o=r);break}if(o===M&&o===C)throw new Error(c().Exp_TokenIllegal);i.value=o,i.WUt=e,i.isMeetCondition=function(t){var n=i.WUt,e=i.value;switch(n){case"<=":return t<=e;case"<>":return t!==e;case">=":return e<=t;case">":return e<t;case"<":return t<e;case"=":return t===e}}}function D(t,n){kt.call(this,n);var n=this;if(n.token=t,n.type=parseInt(b.zf.VP(t,0,"dbnum".length),10),n.type<0||4<n.type)throw new Error(c().Exp_TokenIllegal)}function _(t,n,e,i,r,o){Nt.call(this,n,e,i,o);var n=this;n.pU=n.QUt(At(t)),n.KUt=r,n.JUt=2,n.Hc()}function pt(t,n){var n,t,e;if(kt.call(this,n),n=this,"h"===(t=h(t)[0]))e=3600;else if("m"===t)e=60;else{if("s"!==t)throw new Error(c().Exp_TokenIllegal);e=1}n.XUt=function(t){var t=t/1e3/e;return Math.abs(t-Math.round(t))<1e-6?Math.round(t):Math.floor(t)}}function bt(t,n){var n,n;kt.call(this,n),null!==(n=Y.exec(t))&&(n=Number(n[1]),0<=--n)&&n<V.length&&(t=V[n]),this.foreColor=t}function E(t,n,e,i){var e,i,r,t,n,t;function o(t,n){var e,i,r,o,a,u,s,e=[],i='"';if(t!==M&&""!==t){for(r=!1,a=!(o=[]),u=0;u<t.length;u++)'"'!==(s=t[u])||r||(a=!a),r||a||s!==n?o.push(s):(e.push(o.join("")),o=[]),r="\\"===s&&!r;e.push(o.join(""))}return e}Nt.call(this,n,e,i),(e=this).qUt=!1,e.JUt=1,e.$Ut=Ct(t),i=At(t),-1<(r=(i=Ct(i=n?O(i,e.j9t.Nat,e.j9t.currencySymbol()):i)).indexOf("/"))&&(t=o(i,"/"))&&2===t.length&&(e.tHt=t[1],n=t[0])&&(-1<(t=n.lastIndexOf(" "))?(e.nHt=j(n,0,t),e.eHt=j(n,t+1,n.length-t-1)):e.eHt=n),e.iHt=i}function a(t,n,e,i){Nt.call(this,n,e,i),0<arguments.length?(a.rHt(t)||N(),this.$Ut=t):this.$Ut="General",this.JUt=0}function v(t,n,e,i){var r,e,r=this;Nt.call(r,n,e,i),e=At(t,!1),e=Tt(e=Ct(e=n?O(e,r.j9t.Nat,r.j9t.currencySymbol()):e)),r.pU=e,r.JUt=3}function j(t,n,e){return t.substr(n,e)}function yt(t){return y.lt.ht(t)?"":"boolean"==typeof t?t?"TRUE":"FALSE":"string"==typeof t?t:t.toString()}function wt(t,n){if("\\"===t[n])throw new Error(c().Exp_InvalidBackslash);if(0<n-1&&n-1<t.length&&"\\"===t[n-1]){if(n-2<0)return 1;if(0<n-2&&n-2<t.length)return"\\"!==t[n-2]}}function Mt(t){if(t)return"["+t+"]";throw new Error(c().Exp_TokenIsNull)}function Ct(t){var n,e,i,r,o;if(t===C||t===M||""===t)return t;for(n="",i=!1,r=e=0;r<t.length;r++)'"'===(o=t[r])?(i=!i,n+=o):i?n+=o:"["===o?e++:"]"===o?--e<0&&(e=0):0===e&&(n+=o);return n.toString()}function St(t){return t=O(t,"[",""),O(t,"]","")}function O(t,n,e){return!t||t===k.oHt||R(n,e,!0)?t:(n=n.replace(H,"\\$1"),t.replace(new RegExp(n,"g"),e))}function Tt(t){for(var n,e,i,r,o,n=t.length,e=!1,i="",r=0;r<n;r++)"\\"===(o=t.charAt(r))?(e=!e)&&"@"!==t.charAt(r+1)||(i+=o):(e=!1,i+=o);return i}function R(t,n,e){return e?h(t)===h(n):t===n}function At(t,n){var e,i,r,o;for(1===arguments.length&&(n=!0),e=!1,i="",r=0;r<t.length;r++){if('"'===(o=t[r]))e=!e;else if(!e&&!n&&"/"===o&&!wt(t,r))continue;i+=o}return i}function It(t){for(var n,e,i,r,o,n="",e=!1,i=0,r=t.length;i<r;i++)'"'===(o=t[i])&&(e=!e),"E"===o||e||(n+=h(o));return n}function xt(t,n){var e,i,r,o;if(t&&t!==k.oHt)for(i=It(e=At(t)),r=0;r<n.length;r++)if(0===(o=i.indexOf(n[r]))||0<o&&"_"!==i[o-1]&&"*"!==i[o-1])return!0;return!1}function Nt(t,n,e,i){this.j9t=t,this.aHt=n,this.cultureName=e,this.O9t=i}function kt(t){this.Nat=t}function Dt(t){var n,t,e,t=St(t);return t&&t!==k.oHt&&(e=t[0],-1<["<",">","="].indexOf(e)?(n=it).Name="ConditionalFormatPart":b.zf.fJ(t,"DBNum",!0)?(n=rt).Name="DBNumberFormatPart":R(t[0],"$",!1)&&-1<t.indexOf("-")?(n=et).Name="LocaleIDFormatPart":Et(t)?(n=at).Name="ABSTimeFormatPart":t.indexOf("$")<0&&3<=t.length&&((n=ut).Name="ColorFormatPart")),n}function _t(t,n){var e,t,e=!1,t=xt(t=t?t.toString():k.oHt,["general"])?ct:ot.a0(t)?ot:xt(t,["E+","E-","#",".",",","%","0","/","?"])||n?(e=!0,st):(e=!0,ft);return{uHt:e,uit:t}}function Et(t){var n,e,i,n=h(t),e=n[0];if("h"===e||"m"===e||"s"===e){for(i=1;i<n.length;i++)if(e!==n[i])return;return 1}}function jt(t,n,e){var t,e,t=t?t.cultureInfo():I(e);return(n<4||4===n&&("ko-kr"===e||"ko-kr"===t.name()))&&(e=t.NumberFormat.dbNumber)?e[n]:M}function Ot(t,n,e,i,r){var o,e,o=t;if(!X(i)&&n instanceof Date){if(!(e=jt(e,i.type,r)))return t;o=i.sHt(o,e,!0),o=(o=(o=1===i.type?o.replace(new RegExp(P,"g"),G):o).replace("@"+f.cHt,p.ct.Pe(n,f.cHt))).replace("@"+f.fHt,p.ct.Pe(n,f.fHt)),o=i.sHt(o,e,!1)}return o}function Rt(t,n,e,i,r){var o,a,u,s,c,f,l;if(!X(i)&&(o=jt(e,i.type,r),!X(o)))for(a=!1,u=void 0,s=I(r),c=void 0,f=0,l=t.length;f<l;f++)"decimalSeparator"===t[f].type&&(a=!0,t[f].value=i.sHt(t[f].value,o,n),u=t[f].value),"number"===t[f].type&&(t[f].value=a?i.sHt(u+t[f].value,o,n).slice(1):i.sHt(t[f].value,o,n),"ja-JP"===s.name())&&1<t[f].value.length&&("\u4e00\u5343"!==(c=t[f].value.substr(0,2))&&"\u4e00\u767e"!==c&&"\u4e00\u5341"!==c||(t[f].value=t[f].value.substr(1)));return t}function B(t,n){var e=this;0===arguments.length?(e.formatCached="General",e.E9t=new ct):e.Hc(t,n)}function L(t,n){var e,i,e=mt.call(this,t,n)||this,i=e;return i.lHt=!0,i.PropertyChanged=[],k.Ji(t)&&(t="General"),i.formatCached=t,i.cultureName=n,i.init(),e}function Bt(t){for(var n,e,i,r,o,n=[],e=0,i=0,r=t.length,o=0;o<r;o++)"_"===t[o]?e++:(";"!==t[o]||0!==e&&e%2!=0||(n.push(t.substring(i,o)),i=o+1),e=0);return i<=r&&n.push(t.substring(i,r)),n}g=this&&this.__extends||(vt=function(t,n){return(vt=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(t,n){t.__proto__=n}:function(t,n){for(var e in n)Object.prototype.hasOwnProperty.call(n,e)&&(t[e]=n[e])}))(t,n)},function(t,n){if("function"!=typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function e(){this.constructor=t}vt(t,n),t.prototype=null===n?Object.create(n):(e.prototype=n.prototype,new e)}),Object.defineProperty(t,"__esModule",{value:!0}),t.GeneralFormatter=t.Hf=t.FormatterBase=void 0,b=n("./src/common/util/stringhelper.ts"),p=n("./src/common/util/datetimehelper.ts"),y=n("./src/common/util/types.ts"),e=n("./src/common/util/numberhelper.ts"),w=n("./src/common/culture/cultureInfo.ts"),i=n("./src/common/util/common.ts"),n=n("./src/plugins/formatter/formatter.res.en.ts"),y.lt.Dh(i.SR.en,n),n=new i.ResourceManager(i.SR),c=n.getResource.bind(n),y.lt.dt=function(t,n){if(y.lt.ht(t))return"null"===n;if(n){if(n instanceof Function&&t instanceof n)return!0;if(typeof t===n)return!0;if("function"===n&&/^\s*\bfunction\b/.test(""+t))return!0;if(Object.prototype.toString.call(t).slice(8,-1).toLowerCase()===n.toLowerCase())return!0;if("DateTime"===n)return t instanceof Date;var t;if("TimeSpan"===n)return t instanceof Date&&0<=(t=p.ct.o0(t))&&t<1;"string"==typeof n&&"undefined number boolean string".indexOf(n)}return!1},y.lt.q8=function(t,n){return!!e.st.hUt(t,n)&&("string"!=typeof t||-1===t.search(/[\r\n\t]/g))&&(t=e.st.Jf(t,n),y.lt.dt(t,"number")||y.lt.dt(t,"DateTime")||y.lt.dt(t,"TimeSpan")||t&&!y.lt.dt(t,"boolean")&&!isNaN(t)&&!isNaN(parseFloat(t))&&!(2<=t.length&&"0"===t[0]&&"x"===t[1]))},y.lt.uJ=function(t){return y.lt.ht(t)||""===t?0:y.lt.dt(t,"number")?t:y.lt.dt(t,"string")&&!isNaN(t)?e.st.yU(t):y.lt.dt(t,"boolean")?t?1:0:y.lt.dt(t,"DateTime")?p.ct.o0(t):y.lt.dt(t,"TimeSpan")?Math.floor(p.ct.o0(t)):parseFloat(t)},M=null,C=void 0,S=Math.abs,f={fHt:"yy",hHt:"y",cHt:"yyyy",dHt:"m",vHt:"mm",mHt:"mmm",gHt:"mmmm",pHt:"mmmmm",bHt:"d",yHt:"dd",wHt:"aaa",MHt:"aaaa",CHt:"h",SHt:"hh",THt:"m",AHt:"mm",IHt:"s",xHt:"ss",IGt:"e",NHt:"AM/PM",kHt:"A/P",DHt:"@mmmmm",_Ht:new Date(1899,11,30,0,0,0,0)},F=[f.hHt,f.fHt,f.cHt,f.dHt,f.vHt,f.mHt,f.gHt,f.pHt,f.bHt,f.yHt,f.wHt,f.MHt,f.CHt,f.SHt,f.THt,f.AHt,f.IHt,f.xHt,"ggg","gg","g","ee","e"],P="\u4e00\u5341",G="\u5341",l={EHt:0,jHt:1,OHt:2,_text:3},U=[{EHt:0,jHt:0,OHt:0,_text:0},{EHt:0,jHt:1,OHt:0,_text:0},{EHt:0,jHt:1,OHt:2,_text:0},{EHt:0,jHt:1,OHt:2,_text:3}],H=new RegExp("([.+?*$^\\[\\](){}|/])","g"),z=[["M/d","MMM/d","MMMM/d","d/M","d/MMM","d/MMMM","M-d","MMM-d","MMMM-d","d-M","d-MMM","d-MMMM"],["M/y","MMM/y","M/yyyy","MMM/yyyy","M-y","MMM-y","M-yyyy","MMM-yyyy"],["M/d/y","MMM/d/y","MMMM/d/y","M/d/yyyy","MMM/d/yyyy","MMMM/d/yyyy","d/M/y","d/MMM/y","d/MMMM/y","d/M/yyyy","d/MMM/yyyy","d/MMMM/yyyy","yyyy/M/d","M-d-y","MMM-d-y","MMMM-d-y","M-d-yyyy","MMM-d-yyyy","MMMM-d-yyyy","d-M-y","d-MMM-y","d-MMMM-y","d-M-yyyy","d-MMM-yyyy","d-MMMM-yyyy","yyyy-M-d"],["H:m","h:m tt"],["H:m:s","H:m:s"],["H:m:s.FFF","h:m:s.FFF tt"],["h:m:s tt","h:mm:ss tt"],["M/d H:m","MMM/d H:m","MMMM/d H:m","d/M H:m","d/MMM H:m","d/MMMM H:m","M/y H:m","MMM/y H:m","M/yyyy H:m","MMM/yyyy H:m","M/d/y H:m","MMM/d/y H:m","MMMM/d/y H:m","M/d/yyyy H:m","MMM/d/yyyy H:m","MMMM/d/yyyy H:m","M-d H:m","MMM-d H:m","MMMM-d H:m","d-M H:m","d-MMM H:m","d-MMMM H:m","M-y H:m","MMM-y H:m","M-yyyy H:m","MMM-yyyy H:m","M-d-y H:m","MMM-d-y H:m","MMMM-d-y H:m","M-d-yyyy H:m","MMM-d-yyyy H:m","MMMM-d-yyyy H:m","M/d h:m tt","MMM/d h:m tt","MMMM/d h:m tt","d/M h:m tt","d/MMM h:m tt","d/MMMM h:m tt","M/y h:m tt","MMM/y h:m tt","M/yyyy h:m tt","MMM/yyyy h:m tt","M/d/y h:m tt","MMM/d/y h:m tt","MMMM/d/y h:m tt","M/d/yyyy h:m tt","MMM/d/yyyy h:m tt","MMMM/d/yyyy h:m tt","M-d h:m tt","MMM-d h:m tt","MMMM-d h:m tt","d-M h:m tt","d-MMM h:m tt","d-MMMM h:m tt","M-y h:m tt","MMM-y h:m tt","M-yyyy h:m tt","MMM-yyyy h:m tt","M-d-y h:m tt","MMM-d-y h:m tt","MMMM-d-y h:m tt","M-d-yyyy h:m tt","MMM-d-yyyy h:m tt","MMMM-d-yyyy h:m tt","d/M/y H:m","d/MMM/y H:m","d/MMMM/y H:m","d/M/yyyy H:m","d/mmm/yyyy H:m","d/MMMM/yyyy H:m","yyyy/M/d H:m","d-M-y H:m","d-MMM-y H:m","d-MMMM-y H:m","d-M-yyyy H:m","d-MMM-yyyy H:m","d-MMMM-yyyy H:m","yyyy-M-d H:m","d/M/y h:m tt","d/MMM/y h:m tt","d/MMMM/y h:m tt","d/M/yyyy h:m tt","d/mmm/yyyy h:m tt","d/MMMM/yyyy h:m tt","yyyy/M/d h:m tt","d-M-y h:m tt","d-MMM-y h:m tt","d-MMMM-y h:m tt","d-M-yyyy h:m tt","d-MMM-yyyy h:m tt","d-MMMM-yyyy h:m tt","yyyy-M-d h:m tt"],["M/d H:m:s","MMM/d H:m:s","MMMM/d H:m:s","d/M H:m:s","d/MMM H:m:s","d/MMMM H:m:s","M/y H:m:s","MMM/y H:m:s","M/yyyy H:m:s","MMM/yyyy H:m:s","M/d/y H:m:s","MMM/d/y H:m:s","MMMM/d/y H:m:s","M/d/yyyy H:m:s","MMM/d/yyyy H:m:s","MMMM/d/yyyy H:m:s","d/M/y H:m:s","d/MMM/y H:m:s","d/MMMM/y H:m:s","d/M/yyyy H:m:s","d/MMM/yyyy H:m:s","d/MMMM/yyyy H:m:s","yyyy/M/d H:m:s","M-d H:m:s","MMM-d H:m:s","MMMM-d H:m:s","d-M H:m:s","d-MMM H:m:s","d-MMMM H:m:s","M-y H:m:s","MMM-y H:m:s","M-yyyy H:m:s","MMM-yyyy H:m:s","M-d-y H:m:s","MMM-d-y H:m:s","MMMM-d-y H:m:s","M-d-yyyy H:m:s","MMM-d-yyyy H:m:s","MMMM-d-yyyy H:m:s","d-M-y H:m:s","d-MMM-y H:m:s","d-MMMM-y H:m:s","d-M-yyyy H:m:s","d-MMM-yyyy H:m:s","d-MMMM-yyyy H:m:s","yyyy-M-d H:m:s","M/d h:m:s tt","MMM/d h:m:s tt","MMMM/d h:m:s tt","d/M h:m:s tt","d/MMM h:m:s tt","d/MMMM h:m:s tt","M/y h:m:s tt","MMM/y h:m:s tt","M/yyyy h:m:s tt","MMM/yyyy h:m:s tt","M/d/y h:m:s tt","MMM/d/y h:m:s tt","MMMM/d/y h:m:s tt","M/d/yyyy h:m:s tt","MMM/d/yyyy h:m:s tt","MMMM/d/yyyy h:m:s tt","d/M/y h:m:s tt","d/MMM/y h:m:s tt","d/MMMM/y h:m:s tt","d/M/yyyy h:m:s tt","d/MMM/yyyy h:m:s tt","d/MMMM/yyyy h:m:s tt","yyyy/M/d h:m:s tt","M/d/yyyy h:mm:ss tt","M-d h:m:s tt","MMM-d h:m:s tt","MMMM-d h:m:s tt","d-M h:m:s tt","d-MMM h:m:s tt","d-MMMM h:m:s tt","M-y h:m:s tt","MMM-y h:m:s tt","M-yyyy h:m:s tt","MMM-yyyy h:m:s tt","M-d-y h:m:s tt","MMM-d-y h:m:s tt","MMMM-d-y h:m:s tt","M-d-yyyy h:m:s tt","MMM-d-yyyy h:m:s tt","MMMM-d-yyyy h:m:s tt","d-M-y h:m:s tt","d-MMM-y h:m:s tt","d-MMMM-y h:m:s tt","d-M-yyyy h:m:s tt","d-MMM-yyyy h:m:s tt","d-MMMM-yyyy h:m:s tt","yyyy-M-d h:m:s tt","M/d/yyyy H:m:s","M-d-yyyy H:m:s","M/d/yyyy h:m:s tt","M-d-yyyy H:m:s tt"],["M/d H:m:s.FFF","MMM/d H:m:s.FFF","MMMM/d H:m:s.FFF","d/M H:m:s.FFF","d/MMM H:m:s.FFF","d/MMMM H:m:s.FFF","M/y H:m:s.FFF","MMM/y H:m:s.FFF","M/yyyy H:m:s.FFF","MMM/yyyy H:m:s.FFF","M/d/y H:m:s.FFF","MMM/d/y H:m:s.FFF","MMMM/d/y H:m:s.FFF","MMM/d/yyyy H:m:s.FFF","MMMM/d/yyyy H:m:s.FFF","d/M/y H:m:s.FFF","d/MMM/y H:m:s.FFF","d/MMMM/y H:m:s.FFF","d/M/yyyy H:m:s.FFF","d/MMM/yyyy H:m:s.FFF","d/MMMM/yyyy H:m:s.FFF","yyyy/M/d H:m:s.FFF","M-d H:m:s.FFF","MMM-d H:m:s.FFF","MMMM-d H:m:s.FFF","d-M H:m:s.FFF","d-MMM H:m:s.FFF","d-MMMM H:m:s.FFF","M-y H:m:s.FFF","MMM-y H:m:s.FFF","M-yyyy H:m:s.FFF","MMM-Yyyy H:m:s.FFF","M-d-y H:m:s.FFF","MMM-d-y H:m:s.FFF","MMMM-d-y H:m:s.FFF","MMM-d-yyyy H:m:s.FFF","MMMM-d-yyyy H:m:s.FFF","D-M-y H:m:s.FFF","d-MMM-y H:m:s.FFF","d-MMMM-y H:m:s.FFF","D-M-yyyy H:m:s.FFF","d-MMM-yyyy H:m:s.FFF","d-MMMM-yyyy H:m:s.FFF","yyyy-M-d H:m:s.FFF","M/d h:m:s.FFF tt","MMM/d h:m:s.FFF tt","MMMM/d h:m:s.FFF tt","d/M h:m:s.FFF tt","d/MMM h:m:s.FFF tt","d/MMMM h:m:s.FFF tt","M/y h:m:s.FFF tt","MMM/y h:m:s.FFF tt","M/yyyy h:m:s.FFF tt","MMM/yyyy h:m:s.FFF tt","M/d/y h:m:s.FFF tt","MMM/d/y h:m:s.FFF tt","MMMM/d/y h:m:s.FFF tt","MMM/d/yyyy h:m:s.FFF tt","MMMM/d/yyyy h:m:s.FFF tt","d/M/y h:m:s.FFF tt","d/MMM/y h:m:s.FFF tt","d/MMMM/y h:m:s.FFF tt","d/M/yyyy h:m:s.FFF tt","d/MMM/yyyy h:m:s.FFF tt","d/MMMM/yyyy h:m:s.FFF tt","yyyy/M/d h:m:s.FFF tt","M-d h:m:s.FFF tt","MMM-d h:m:s.FFF tt","MMMM-d h:m:s.FFF tt","d-M h:m:s.FFF tt","d-MMM h:m:s.FFF tt","d-MMMM h:m:s.FFF tt","M-y h:m:s.FFF tt","MMM-y h:m:s.FFF tt","M-yyyy h:m:s.FFF tt","MMM-Yyyy h:m:s.FFF tt","M-d-y h:m:s.FFF tt","MMM-d-y h:m:s.FFF tt","MMMM-d-y h:m:s.FFF tt","MMM-d-yyyy H:m:s.FFF tt","MMMM-d-yyyy h:m:s.FFF tt","d-M-y h:m:s.FFF tt","d-MMM-y h:m:s.FFF tt","d-MMMM-y h:m:s.FFF tt","d-M-yyyy h:m:s.FFF tt","d-MMM-yyyy h:m:s.FFF tt","d-MMMM-yyyy h:m:s.FFF tt","yyyy-M-d h:m:s.FFF tt"]],V=["#000000","#FFFFFF","#FF0000","#00FF00","#0000FF","#FFFF00","#FF00FF","#00FFFF","#800000","#008000","#000080","#808000","#800080","#008080","#C0C0C0","#808080","#9999FF","#993366","#FFFFCC","#CCFFFF","#660066","#FF8080","#0066CC","#CCCCFF","#000080","#FF00FF","#FFFF00","#00FFFF","#800080","#800000","#008080","#0000FF","#00CCFF","#CCFFFF","#CCFFCC","#FFFF99","#99CCFF","#FF99CC","#CC99FF","#FFCC99","#3366FF","#33CCCC","#99CC00","#FFCC00","#FF9900","#FF6600","#666699","#969696","#003366","#339966","#003300","#333300","#993300","#993366","#333399","#333333"],Y=new RegExp("color\\s*(\\d+)","i"),T=y.lt.dt,Z=y.lt.Nh,s=e.st,W=s.gUt+"."+s.pUt,Q=s.mUt,J=s.L9t,K=s.E8,X=y.lt.ht,A=isNaN,I=function(t){return w.CultureManager.Fe(t)},u=function(t){return I(t).DateTimeFormat},x=function(t){return I(t).NumberFormat},h=function(t){return t&&t.toLowerCase()},q=function(t){return t&&t.toUpperCase()},N=function(){throw new Error(c().Exp_FormatIllegal)},d=function(){return w.CultureManager.booleanMapping},k={oHt:"",I5:function(){for(var t,n,e,i,r,o,a,t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];for(e=[],i=0;i<arguments.length;i++)e[i]=arguments[i];if(0===arguments.length)return M;for(r=e[0],o=1;o<arguments.length;o++)a=new RegExp("\\{"+(o-1)+"\\}","gm"),r=r.replace(a,arguments[o]);return r},Ji:function(t){return!t||t===k.oHt}},tt=function(t){var t=t.charCodeAt(0);return 48<=t&&t<=57},nt=function(t){var t=t.charCodeAt(0);return 9<=t&&t<=13||32===t||133===t||160===t},r.prototype.cultureInfo=function(){var t=this;return t.RHt||(t.RHt=I(t.Iat)),t.RHt},r.prototype.currencySymbol=function(){return this.ZUt?b.zf.Vi(this.ZUt,"\\.",'"."'):k.oHt},r.prototype.allowScience=function(){if(this.RHt)return!this.RHt.isJCKCulture},r.prototype.toString=function(){return this.Jq?Mt(this.Jq):k.oHt},r.Name="LocaleIDFormatPart",et=r,o.prototype.format=function(t){return M},o.prototype.parse=function(t){return M},o.prototype.formatString=function(t){return this.formatCached},o.prototype.toJSON=function(){var t,n,t={};for(n in this)this.hasOwnProperty(n)&&(t[n]=this[n]);return t},o.prototype.fromJSON=function(t){if(t)for(var n in t)t[n]!==C&&(this[n]=t[n])},t.FormatterBase=i=o,gt.prototype.toString=function(){return Mt(this.WUt+this.value.toString())},it=gt,D.prototype.sHt=function(t,n,e){var i,r,o,a,u,s,c,f,l,h;if(!t||t===k.oHt)return t;for(u=!(a=o=-1),l=(r=i=t).length-1;0<=l;l--)h=r[l],!A(h)&&!R(h," ",!1)||R(h,".",!1)&&!u?(R(h,".",!1)&&(u=!0),-1===o&&(o=l),a=l):-1<a&&-1<o&&(s=j(r,a,o-a+1),c=parseFloat(s),A(c)||(f=D.numberString(s,n,e),i=b.zf.VP(i,a,o-a+1),i=b.zf.Eit(i,a,f)),u=!(a=o=-1));return-1<a&&-1<o&&(s=j(r,a,o-a+1),c=parseFloat(s),A(c)||(f=D.numberString(s,n,e),i=b.zf.VP(i,a,o-a+1),i=b.zf.Eit(i,a,f))),i},D.prototype.toString=function(){if(-1<this.type)return Mt("DBNum"+this.type);throw new Error},D.numberString=function(t,n,e){var i,t,r,o,i=D.formatNumberString,t=t.split(".");if(t){if(1===t.length)return i(t[0],n.numbers,e?n.letters:M);if(2===t.length)return(r=i(t[0],n.numbers,e?n.letters:M))+"."+(o=i(t[1],n.numbers))}throw new Error(c().Exp_ValueIllegal)},D.formatNumberString=function(t,n,e){var i,r,o,a,u,s,c,f,l,h,d,v,m,g,p,b,y,w,i=t,r=0,a=0;if(2===arguments.length){for(u="";r<i.length;r++)o=j(i,r,1),u+=n[a=parseInt(o,10)];return u}if(3===arguments.length){if(!e)return D.formatNumberString(t,n);for(s=0,c="",f=i.length,l=!1,h=[];r<f;r++)-1<(d=e.length-1-r)?h.push(e[d].toString()):h.push(k.oHt);for(v=[],m=h.length-1;0<=m;m--)v[h.length-m-1]=h[m];for(h=v,g=!1,m=0;m<f;m++)o=j(i,m,1),a=parseInt(o,10),p=void 0,b=k.oHt,0<f-m-16?(p=n[a],g=!(b="")):m!==f-1&&m!==f-5&&m!==f-9&&m!==f-13?"0"===o?(b=p="",s+=1):s=(b=(p="0"!==o&&0!==s?n[0]+n[a]:n[a],h[m]),0):"0"!==o&&0!==s?(p=n[0]+n[a],b=h[m],s=0):"0"!==o&&0===s||g?(p=n[a],b=h[m],s=0,g=!1):("0"===o&&3<=s?b=p="":11<=f?p="":(p="",b=h[m]),s+=1),(y=p+b===k.oHt)||(l=!1),m!==f-13||l||(b=h[m],l=!0),m!==f-9||l||(b=h[m],l=!0),m===f-1&&(b=h[m],l=!0),c=c+p+b;return 0===(w=parseInt(t,10))?n[0]:c}},rt=D,_.prototype.Hc=function(){var t,n,e,i,r,o,a,t=this,n={y4:t.pU},e;if(_.a0(n.y4)){if(i=t.BHt(n),r=u(this.cultureName).amDesignator&&u(this.cultureName).pmDesignator,t.hasJD=t.Vi(n.y4,f.pHt,'"'+f.DHt+'"',!0,!1,n,!1),t.Vi(n.y4,f.gHt,"MMMM",!0,!1,n,!1),t.Vi(n.y4,f.mHt,"MMM",!0,!1,n,!1),t.LHt(n.y4,n,"mm","MM"),t.LHt(n.y4,n,"m","M"),t.Vi(n.y4,f.wHt,"ddd",!0,!0,n,!0),t.Vi(n.y4,f.MHt,"dddd",!0,!0,n,!0),i&&r||(t.Vi(n.y4,f.CHt,"H",!0,!0,n,!1),t.Vi(n.y4,f.SHt,"HH",!0,!0,n,!1)),t.aHt&&(t.j9t||I(t.cultureName).NumberFormat.dbNumber)&&(t.FHt=t.FHt||t.Vi(n.y4,f.cHt,'"@'+f.cHt+'"',!0,!1,n,!0),t.FHt=t.FHt||t.Vi(n.y4,f.fHt,'"@'+f.fHt+'"',!0,!1,n,!0)),t.KUt)for(o=0;o<t.KUt.length;o++)a=t.KUt[o],t.Vi(n.y4,a.Nat,"@"+a.Nat,!0,!0,n,!0);t.PHt=n.y4}else N()},_.prototype.formatString=function(){return this.pU},_.prototype.format=function(n){var t,e,i,r,o,a,u,s,c,t=this,e=k.oHt,i=M;try{if((i=(i=p.ct.iPt(n))&&A(i.valueOf())?M:i)?n=i:e=n.toString(),i&&(e=p.ct.L9t(i,t.PHt,t.j9t&&t.j9t.cultureInfo()||I(t.cultureName),t.O9t),t.hasJD&&(r=I(t.cultureName).DateTimeFormat.monthNames[i.getMonth()],e=b.zf.Vi(e,f.DHt,j(r,0,1))),t.KUt))for(o=24*(p.ct.o0(i)-p.ct.o0(f._Ht))*60*60*1e3,a=0;a<t.KUt.length;a++)s=(u=t.KUt[a]).XUt(o),X(s)||(c=u.Nat.replace("[","\\[").replace("]","\\]"),e=b.zf.Vi(e,"@"+c,s))}catch(t){e=yt(n)}return Ot(e,n,t.j9t,t.aHt,t.cultureName)},_.prototype.parse=function(n){var t,n,e,e,i;if(!n||n===k.oHt)return M;if(t=this,"true"===(e=h(n=n)))return!0;if("false"===e)return!1;if(t.PHt&&(e=p.ct.nUt(n,t.PHt,I(t.cultureName))))return e;try{return(i=p.ct.iPt(n))&&!A(i)?i:(i=new Date(n),A(i.valueOf())?n:i)}catch(t){return n}},_.prototype.QUt=function(t){for(var n,e,i,r,o,a,n=t,e="",i=!1,r=0;r<n.length;r++)'"'===(o=n[r])?i=!i:i||"Y"!==o&&"D"!==o&&"S"!==o&&"E"!==o&&"G"!==o&&("M"!==o||R("A",a=n[r-1],!0)||R("P",a,!0))||(o=h(o)),e+=o;return e},_.prototype.BHt=function(t){var n,e,i,r,o,a,n=u(this.cultureName).amDesignator,e=u(this.cultureName).pmDesignator,i=[f.NHt];for(i.push(n&&e?n+"/"+e:f.NHt),i.push(f.kHt),r=["tt","tt","t"],o=t.y4,a=0;a<3;a++){if(b.zf.OS(o,r[a]))return!0;if(b.zf.OS(o,i[a],!0))return t.y4=b.zf.Vi(o,i[a],r[a],!0),!0}return!1},_.prototype.LHt=function(t,n,e,i){for(var r,o,a,u,s,c,r="",o=t.length,a=0,u=0;u<o;u++)if('"'===t[u]&&(a=(a+1)%2),"m"!==t[u]||a)r+=t[u];else{for(s="m";u+1<o&&"m"===t[u+1];)u++,s+="m";r+=s===e?i:s}c=new RegExp("".concat(i,"(?=[^yYdDhHmM]*[Ss])|").concat(i,"(?=.0)"),"g"),r=(r=r.replace(c,e)).split("").reverse().join(""),c=new RegExp("".concat(i,"(?=[^mM]*[Hh])"),"g"),r=(r=r.replace(c,e)).split("").reverse().join(""),n.y4=r},_.prototype.Vi=function(t,n,e,i,r,o,a){var u,s,c,f,l,h,d,v,m,g,p;if(i||r){for(u=[],s=!0,!_.hasDate(t)&&_.hasTime(t)&&(s=!1),c=!1,f=0;f<t.length;f++){if(l=t[f],_.hasTime(l)&&!c?s=!1:_.hasDate(l)&&!c&&(s=!0),i&&R(l,n[0],a)&&s||r&&R(l,n[0],a)&&!s){for(h=!0,d=0;d<n.length;d++)if(d+f>=t.length||!R(n[d],t[d+f],a)){h=!1;break}if(v=f+n.length-1,h&&1+v<t.length){for(m=t[v],g=-1,g=1+v;g<t.length&&R(m,t[g],a);g++);1+v<g&&(f=g,h=!1)}h&&!c&&u.splice(0,0,f)}'"'===l&&(c=!c)}if(o.y4=t,0<u.length){for(f=0;f<u.length;f++)o.y4=b.zf.VP(o.y4,p=u[f],n.length),o.y4=b.zf.Eit(o.y4,p,e);return!0}}return!1},_.hasTime=function(t){return-1<b.zf.hD(t,f.CHt[0],!0)||-1<b.zf.hD(t,f.IHt[0],!0)},_.hasDate=function(t){return-1<b.zf.hD(t,f.fHt[0],!0)||-1<b.zf.hD(t,f.bHt[0],!0)},_.a0=function(t,n){return xt(t,n||F)},ot=_,t.Hf=ot,pt.Name="ABSTimeFormatPart",at=pt,bt.prototype.toString=function(){return Mt(this.foreColor)},bt.Name="ColorFormatPart",ut=bt,E.prototype.formatString=function(){return this.$Ut},E.prototype.format=function(t){var n,e,t,i,r,o,a,u,s,c,f,l,h,h,h,d,v,v,m,g,g,v;return T(t,"boolean")?t.toString().toUpperCase():(n=this,e=y.lt.uJ(t),A(e)||!isFinite(e)||A(t)?"string"==typeof t?t:M:(t=I(n.cultureName),n.eHt&&n.tHt?(c={value:0},f={value:0},l={value:0},h=n.GHt(),E.getFraction(e,h,c,f,l)?(1<(h=E.getGCD(f.value,l.value))&&(f.value/=h,l.value/=h),n.nHt?(s="",1===l.value&&(c.value+=f.value,f.value=0,l.value=0),(h=Q(J(c.value,n.nHt,t)))&&"0"!==h&&(s=s+h+" "),0===c.value&&e<0&&(s+=t.NumberFormat.negativeSign),0===e&&(s+="0"),r=n.tHt,o=parseFloat(r),!A(o)&&0<o&&(0!==f.value&&0!==l.value&&(f.value*=o/l.value),l.value=o,r=r.replace(/^\d+/,E.toNumberPlaceholder(o)),u=(a=Math.ceil(f.value))-f.value,f.value=u<=.5&&0<=u?parseFloat(a.toString()):parseFloat((a-1).toString())),d=n.eHt,v=parseFloat(d),A(v)||0!==v||(v=d.length,(g=(m=f.value.toString()).length)<v?d=d.substr(0,v-(v-g)):v<g&&(m=m.substr(0,g-(g-v)),f.value=parseInt(m,10))),g=n.UHt(f.value,l.value,d,r,t),0===f.value&&(g=g.replace(/./g," "),""===h)?"0 "+g:""===(s+=g)?"0":s):(s="",v=c.value*l.value+f.value,r=n.tHt,0<(o=parseFloat(r))?(v*=o/l.value,l.value=o,s+=(v=(u=(a=Math.ceil(v))-v)<=.5&&0<=u?parseFloat(a.toString()):parseFloat((a-1).toString()))+"/"+l.value):s+=n.UHt(v,l.value,n.eHt,n.tHt,t),0===v?"0":s)):e.toString()):Rt(i=J(e,n.iHt,t),n.qUt,n.j9t,n.aHt,n.cultureName)))},E.prototype.parse=function(t){var n,e,e,i,e,i,e,i,e,t,i,n=this;return t&&t!==k.oHt?!!("TRUE"===(e=q(t))||e===d()&&d().boolean_true)||!("FALSE"===e||e===d()&&d().boolean_false)&&(e=n.eHt&&n.tHt,i=n.zHt(n.iHt).HHt,(e||i)&&0<(e=t.indexOf("/"))&&e<t.length-1&&(i=parseInt(t.substr(0,e),10),e=parseInt(t.substr(e+1),10),!isNaN(i))&&!isNaN(e)&&0!==e?i/e:(t=n.VHt(t),t=n.YHt(t),e=(i=n.zHt(t)).HHt,t=i.$6t,n.ZHt(t)&&(t=b.zf.OUt(t,x(n.cultureName).numberGroupSeparator,"",!1),i=s.dUt(t,n.cultureName),!A(i))&&isFinite(i)?e?K(i/100,15):i:M)):M},E.prototype.GHt=function(){var t,n,e,i,r,t,n=this.tHt,e=0;if(n)for(i=n.length,r=0;r<i&&n[r].match(/[#?\d]/);r++)e++;return e},E.prototype.ZHt=function(t){for(var n,e,i,r,o,a,u,n="",e=0,i=0,r=0,o=M,a=x(this.cultureName),u=t.length-1;-1<u;u--){if(t[u]===a.numberDecimalSeparator)e++,0<r&&(o=!1),n="";else if("e"===h(t[u])){if(i++,n="",u===t.length-1)return!1}else if(t[u]===a.numberGroupSeparator)o=3===n.length,r++,n="";else if("-"===t[u]||"+"===t[u]){if(0<u&&"e"!==h(t[u-1]))return!1}else{if(!tt(t[u]))return!1;if(n+=t[u],0===u&&0===parseInt(n,10)&&o)return!1}if(1<e||1<i||!1===o)return!1}return!0},E.prototype.VHt=function(t){for(var n,e,i,t,r,o,a,a,u,n=t,e=[],i=0;i<n.length;i++)tt(n[i])&&e.push(i);for(r=[(t=x(this.cultureName)).currencyDecimalSeparator,t.currencyGroupSeparator,t.currencySymbol,t.nanSymbol,t.negativeInfinitySymbol,t.negativeSign,t.numberDecimalSeparator,t.numberGroupSeparator,t.percentDecimalSeparator,t.percentGroupSeparator,t.percentSymbol,t.perMilleSymbol,t.positiveInfinitySymbol,t.positiveSign],o=n.length-1;-1<o;o--)if(a=n[o],nt(a)&&r.indexOf(a.toString())<=-1)(o<e[0]||e[e.length-1]<o)&&(n=b.zf.VP(n,o,1));else if(("-"===a||"+"===a)&&(a=0<o?n[o-1].toString():M,(u=["e","E","(",x(this.cultureName).currencySymbol]).indexOf(a)<0))break;return n},E.prototype.YHt=function(t){var n,e,n=x(this.cultureName).currencySymbol,e=b.zf.fJ(t,n)?b.zf.VP(t,0,n.length):t;return e.indexOf(n)<0?e:t},E.prototype.zHt=function(t){var n,e,i,n=x(this.cultureName).percentSymbol,e=!0,i=t;return b.zf.fJ(t,n)?i=b.zf.VP(t,0,n.length):b.zf.dT(t,n)?i=b.zf.VP(t,t.length-n.length,n.length):e=!1,{$6t:i,HHt:e=b.zf.OS(i,n)?!1:e}},E.prototype.UHt=function(t,n,e,i,r){var o,a,u,s,r,o,o=Q(J(t,e,r)),a,u,s=Q(J("0."+n,"#."+i,r,!0)),r=r&&r.NumberFormat&&r.NumberFormat.numberDecimalSeparator||".",o=o+"/"+s.substr(s.indexOf(r)+1);return""===e&&(o=t+o),""===i&&(o+=n),o},E.getGCD=function(t,n){var e,i,r;if(0===t)return S(n);if(0===n)return S(t);for(r=(e=Math.max(t,n))%(i=Math.min(t,n));0!==r;)r=(e=i)%(i=r);return S(i)},E.getFraction=function(t,n,e,i,r){var o,a,u,s,c,c,f,l,h,d,v,m,g,p,o=0,a=0,u=0,s=0,c=Math.ceil;for(0<t?o=1===(s=t-c(t)+1)?(s=0,t):c(t)-1:t<0&&(o=c(t),s=c(t)-t),c=Math.pow(10,n-1),(f=Math.pow(10,n)-1)<2&&(f=2),l=!1,h=0,d=c=c<2?2:c;d<=f&&(m=Math.round(v=d*s),p=S((g=m/d)-s),!((!l||p<S(h-s))&&(l=!0,h=g,a=m,u=d,p<1e-6)));d++);return e.value=o,i.value=a,r.value=u,l},E.toNumberPlaceholder=function(t){return t.toString().replace(/\d/g,"?")},st=E,a.rHt=function(t){for(var n,e,i,r,o,a,n="",e=!1,i=-1,r=t.length,o=0;o<r;o++)'"'===(a=t[o])?i=(e=!e)?o:-1:e||(n+=a);return 0<i&&(n+=t.substring(i,r)),!(0<=n.indexOf("0")||0<=n.indexOf("#")||0<=n.indexOf(".")||0<=n.indexOf("@"))},a.prototype.WHt=function(){var t,n,t=this;return t.QHt||(n=O(n=t.$Ut,"General",W),t.QHt=new st(n,t.j9t,t.aHt,t.cultureName),t.QHt.qUt=!0),t.QHt},a.prototype.KHt=function(){var t=this;return t.JHt||(t.JHt=new st("0.#####E+00",t.j9t,t.aHt,t.cultureName),t.JHt.qUt=!0),t.JHt},a.prototype.formatString=function(){return b.zf.Vi(this.$Ut,"@NumberFormat","General")},a.prototype.format=function(t){var n,e,i,r,n=this;if(y.lt.q8(t,n.cultureName)){if(e=!n.j9t||n.j9t.allowScience(),(i=y.lt.uJ(t))!==C&&i!==M)return(99999999999<S(i)&&e||S(i)<1e-11&&0!==i?n.KHt():n.WHt()).format(t)}else{if(T(t,"string"))return r=Tt(r=b.zf.Vi(n.formatString(),'"',"")),t;if(T(t,"boolean"))return t.toString().toUpperCase()}return""},a.prototype.parse=function(t){var n,e,i,i,r,o,a,u,r,s,n,u,o,a;return k.Ji(t)?M:"number"==typeof t?t:(n=!1,e=t.trim(),0<(i=b.zf.hD(e,"-",!1))&&!R(e.charAt(i-1),"E",!0)&&(n=!0),o=(r=(i=I(this.cultureName)).DateTimeFormat).dateSeparator,a=r.timeSeparator,u=r.monthNames,r=r.abbreviatedMonthNames,s=function(t,n){var e,i,r;if(!n||0===n.length)return!1;for(e=!1,i=0,r=n.length;i<r;i++)if(b.zf.OS(t,n[i],!0)){e=!0;break}return e},(n||b.zf.OS(e,o,!1)||b.zf.OS(e,a,!1)||b.zf.OS(e,"/",!1)||b.zf.OS(e,":",!1)||b.zf.OS(e,"-",!1)||b.zf.OS(e,"\u5e74",!1)||b.zf.OS(e,"\u6708",!1)||b.zf.OS(e,"\u65e5",!1)||s(e,u)||s(e,r)||"ja-JP"===i.name()&&0<=w.XPt.gGt.indexOf(e[0].toUpperCase())&&b.zf.OS(e,".",!1))&&(n=p.ct.yU(e))?n:((a="("===(e=(o="-"===e.charAt(0))?b.zf.VP(e,0,1):e).charAt(0)&&")"===e.charAt(e.length-1))&&(e=e.substring(1,e.length-1)),(u=this.WHt().parse(e))!==M&&u!==C?(a||o)&&T(u,"number")?-1*S(u):u:t))},ct=a,v.prototype.format=function(t,n){var e,i,r,o,e=this;try{return r=i=void 0,r=t instanceof Date?p.ct.o0(t).toString():yt(t),o=e.XHt(e.pU),i=e.qHt(r,o.formatTokens,t,o.hasAtPart,n)}catch(t){return""}},v.prototype.parse=function(t){return t||""},v.prototype.formatString=function(){return this.pU},v.prototype.XHt=function(t){for(var n,e,i,r,o,a,u,n=[],e=!1,i="",r=!1,a=M,u=0;u<t.length;u++)o=t.charAt(u),r?('"'!==o?i+=o:(n.push(i+=o),i="",r=!1),a=o):"*"!==a&&"_"!==a&&"\\"!==a||""===i?"*"===o||"_"===o||"\\"===o?(a=o,""!==i&&(n.push(i),i=""),i+=o):"@"===o?(a=o,""!==i&&(n.push(i),i=""),n.push(o),e=!0):'"'===o?(a=o,""!==i&&n.push(i),i=o,r=!0):(i+=o,a=o):(n.push(i+=o),i="");return""!==i&&n.push(i),{formatTokens:n,hasAtPart:e}},v.prototype.qHt=function(t,n,e,i,r){var o,a,u,s,o=[],a=!1;if("string"!=typeof e||i||r)for(u=n.length-1;0<=u;u--)"*"===(s=n[u])[0]?a||(a=!0,o.push({type:"fillingChar",value:s[1]})):"_"===s[0]?o.push({type:"placeholder",value:s[1]}):'"'===s[0]&&'"'===s[s.length-1]?2<=s.length&&o.push({type:"text",value:s.substr(1,s.length-2)}):"\\@"===s?o.push({type:"text",value:"@"}):"@"===s[0]?o.push({type:"text",value:t}):o.push({type:"text",value:s});else o.push({type:"text",value:e});return o.reverse()},ft=v,lt=function(){return{pattern:z,formatter:["d-mmm","mmm-yy",u().shortDatePattern,"h:mm","h:mm:ss","h:mm:ss.0","h:mm:ss tt",u().shortDatePattern+" h:mm",u().shortDatePattern+" h:mm:ss",u().shortDatePattern+" h:mm:ss.0"]}},B.prototype.Hc=function(t,n){var e,i,r,o,a,u,s,c,f,l,h,d,d,v,m,g,m;for(t!==M&&t!==C||N(),(i=this).formatCached=e=t,o=r="",s=u=a=!1,c=[],f=0;f<t.length;f++)'"'===(l=t[f])?(u=!u,o+=l):u?o+=l:"["===l?(a&&N(),o&&(r=r||"",r+=o),o=l.toString(),a=!0):"]"===l?(a||N(),o?(h=(o+=l).toString(),(d=Dt(o.toString()))?"ABSTimeFormatPart"===d.Name?(c.push(new d(B.preProcessPart(h),h)),r+=o):h===w.XPt.eraExcelFormatter?(i.addPart(d,w.XPt.eraInternalFormatter),s=!0):i.addPart(d,h):(r+=d=B.partToNormalStr(h),e=O(t,h,d)),o=""):N(),a=!1):o+=l;o?a?N():r+=o:r=r||i.$Ht(),i.localeIDFormatPart&&(n=i.localeIDFormatPart.cultureInfo().name()),g=(m=_t(r,v=i.conditionalFormatPart)).uit,m=m.uHt?e:r,g?i.E9t=new g(m,i.localeIDFormatPart,i.dbNumberFormatPart,n,0<c.length?c:M,s):N()},B.prototype.$Ht=function(){var n,t,e,n=this,t="";return t=n.dbNumberFormatPart&&!(e=B.proNames.some(function(t){return"dbNumberFormatPart"!==t&&n[t]}))?"General":t},B.prototype.formatString=function(){for(var t,n,e,i,r,t=this,n="",e=0,i=B.proNames.length;e<i;e++)t[r=B.proNames[e]]&&(n+=t[r].toString());return n+=t.E9t.formatString()},B.prototype.addPart=function(t,n){for(var e,i,r,o,a,u,e=this,i=B.proNames,r=B.preProcessPart(n),o=0,a=i.length;o<a;o++)if(R(u=i[o],t.Name,!0)){if(e[u])throw new Error(c().Exp_DuplicatedDescriptor);e[u]=new t(r,n)}},B.prototype.format=function(t,n){return this.E9t.format(t,n)},B.prototype.parse=function(t){return this.E9t.parse(t)},B.checkFormatter=function(t){if(!t||t===k.oHt)throw new Error(c().Exp_TokenIllegal)},B.preProcessPart=function(t){B.checkFormatter(t);var t=St(t);return B.checkFormatter(t),t},B.partToNormalStr=function(t){var t=B.preProcessPart(t);return'"'+(t="$"===t[0]?t.slice(1):t)+'"'},B.proNames=["colorFormatPart","conditionalFormatPart","dbNumberFormatPart","localeIDFormatPart"],ht=B,g(L,mt=i),L.prototype.toJSON=function(){var t,n,t=this,n={formatCached:t.formatCached};return t.cultureName&&(n.customerCultureName=t.cultureName),"general"===h(t.formatCached)&&delete n.formatCached,n},L.prototype.hasFormattedColor=function(){var t,n,e,t=this;for(n in l)if(l.hasOwnProperty(n)&&(e=t.getFormatter(l[n]))&&e.colorFormatPart)return!0;return!1},L.prototype.formatString=function(t){var n,e,i,r,o,n=this;if(0===arguments.length){for(e=k.oHt,i=0,r=n.formatters.length;i<r;i++)e+=(o=n.formatters[i]).formatString(),i!==r-1&&(e+=";");return e}if(t)return n.formatters=M,n.formatCached=t,n.init(),n.tzt("formatString"),n;throw new Error(c().Exp_ValueIsNull)},L.prototype.getFormatter=function(t){var n=this;return n.formatters&&n.formatters[t]},L.prototype.getPreferredEditingFormatter=function(t){var n,e,i,n,n=u(this.cultureName),e=L.defFormatter;return T(t,"TimeSpan")?e(n.longTimePattern):T(t,"DateTime")?(i=0===t.getHours()&&0===t.getMinutes()&&0===t.getSeconds()&&0===t.getMilliseconds()?"":" h:mm:ss",e(n.shortDatePattern+i)):y.lt.q8(t,this.cultureName)?1e20<=(n=y.lt.uJ(t))||n<=1e-17&&0<n||n<=-1e20||n<0&&-1e-17<=n?e("0.##E+00"):e(W):e("General")},L.prototype.getPreferredDisplayFormatter=function(t,n){var e,i,n,r,o,a,u,o,s,c,c,s,c,f,l,h,d,d,s,o,c,e,s,v,m,g,c,e=this,i=L.defFormatter;if((n=n||{value:M}).value=M,k.Ji(t))return new L;if(r=n.value=e.parse(n=t),T(r,"DateTime")||T(r,"TimeSpan")){for(a=(o=lt()).pattern,u=o.formatter,0<(c=(s=(o=I(e.cultureName)).DateTimeFormat).preselectedFormatters).length&&(a=a.concat([c]),u=u.concat([c[0]])),"ja-JP"===o.name()&&(a=a.concat([s.eraFormatter]),u=u.concat(["ge.M.d"]),c=o.QPt.filter(function(t){return"ggge"===t.substr(0,4)}),a=a.concat([c]),u=u.concat(['ggge"\u5e74"M"\u6708"d"\u65e5']),s=o.QPt.filter(function(t){return"gge"===t.substr(0,3)}),a=a.concat([s]),u=u.concat(['gge"\u5e74"M"\u6708"d"\u65e5']),c=o.QPt.filter(function(t){return"ge"===t.substr(0,2)}),a=a.concat([c]),u=u.concat(['ge"\u5e74"M"\u6708"d"\u65e5'])),f=0;f<a.length;f++)for(l=a[f],h=0;h<l.length;h++)if(d=l[h],(d=p.ct.yU(t,d))&&d-r==0)return new L(u[f])}else if(y.lt.q8(r,e.cultureName)){if(o=(s=x(e.cultureName)).currencySymbol,c=s.numberDecimalSeparator,e=s.percentSymbol,s=s.numberGroupSeparator,v="E",c=(g=(m=b.zf.OS)(n,c))?".00":"",n[0]===o)return i(k.I5("{0}#,##0{1};[Red]({0}#,##0{1})",o,c));if(m(n,"E",!0))return i("0.00E+00");if(n[0].toString()===e||n[n.length-1].toString()===e)return i(k.I5("0{0}%",c));if(m(n,s))return i(k.I5("#,##0{0}",c))}return i("General")},L.prototype.format=function(n,t){var e,i,r,o,i,a,u;if(T(n,"boolean"))return(n=d()?n?d().boolean_true:d().boolean_false:n).toString().toUpperCase();if(r=0,o=(e=this).vn(n)){i=o.colorFormatPart,t&&i&&(t.conditionalForeColor=t.value=i.foreColor),(i=y.lt.q8(n,e.cultureName))&&(r=y.lt.uJ(n)),a=k.oHt;try{i&&o===e.getFormatter(l.jHt)&&0!==this.expressionNumber?(a=o.format(o.considerNegSymbol?r:S(r)))===M&&T(n,"string")&&(a=n):(a=o.value)===C&&(u=!e.lHt&&o===e.getFormatter(l._text),a=o.format(n,i||u)),t&&(t.content=Z(a)?a:[{type:"text",value:a}]),Z(a)&&(a=s.mUt(a))}catch(t){T(n,"string")&&(a=n.toString())}return a}return i&&r<0?"-".toString():!T(n,"string")&&(n===C||n===M)?k.oHt:n.toString()},L.prototype.parse=function(t){var n=this;return n.formatters&&0<n.formatters.length?n.formatters[0].parse(t):M},L.prototype.init=function(){var t,n,e,i,r,t=this,n=t.formatCached;for(k.Ji(n)&&N(),t.formatters=[],e=Bt(n),t.lHt=1===e.length,(!e||e.length<1||4<e.length)&&N(),i=0;i<e.length;i++)-1!==e[i].indexOf("@")&&-1===e[i].indexOf("\\@")&&(i!==e.length-1?N():this.hasAt=!0),r=new ht(e[i],t.cultureName),t.formatters.push(r);t.getFormatter(l.EHt)||N(),this.nzt()},L.prototype.nzt=function(){this.expressionNumber=this.formatters.length-(this.hasAt?1:0);var t=(0===this.expressionNumber?1:this.expressionNumber)-1;l=y.lt.Dh({},U[t]),this.hasAt&&0!==this.expressionNumber&&(l._text=this.formatters.length-1)},L.prototype.vn=function(t){var n,e,i,r,r,o,t,a,u,s,c,f,n=this;if(n.nzt(),i=(e=n.getFormatter(l.EHt))&&e.conditionalFormatPart,r=n.getFormatter(l._text),i&&(l.OHt=2,this.hasAt||(l._text=3)),"string"==typeof t&&A(t))return r||(i?t:e);if(y.lt.q8(t,n.cultureName)||T(t,"boolean")){if(r=n.getFormatter(l.jHt),o=n.getFormatter(l.OHt),t=y.lt.uJ(t),a=i&&e.conditionalFormatPart.isMeetCondition(t),s=(u=r&&r.conditionalFormatPart)&&r.conditionalFormatPart.isMeetCondition(t),c=void 0,n.lHt||(i?a:0<t||0===t&&!o))c=e;else if(u?s:t<0)c=r;else if(o)c=o;else if(r){if(i&&u)return{value:f=t+""};c=r}return c&&(!i||u||c!==r||o||(c.considerNegSymbol=!0),i&&u&&c===r&&r.conditionalFormatPart&&r.conditionalFormatPart.isMeetCondition(1e-10)&&(c.considerNegSymbol=!0),this.expressionNumber<=1)&&(c.considerNegSymbol=!0),c}return M},L.prototype.tzt=function(t){var n,e,i,n=this;if(n.PropertyChanged)for(e=0;e<n.PropertyChanged.length;e++)"function"==typeof(i=n.PropertyChanged[e])&&i(n,t)},L.defFormatter=function(t){var n=L[t];return n||(n=new L(t),L[t]=n),n},t.GeneralFormatter=L},"./src/plugins/slicer/slicer.entry.ts":function(t,n,e){var i,r,i=this&&this.__createBinding||(Object.create?function(t,n,e,i){void 0===i&&(i=e);var r=Object.getOwnPropertyDescriptor(n,e);r&&("get"in r?n.__esModule:!r.writable&&!r.configurable)||(r={enumerable:!0,get:function(){return n[e]}}),Object.defineProperty(t,i,r)}:function(t,n,e,i){t[i=void 0===i?e:i]=n[e]}),r=this&&this.__exportStar||function(t,n){for(var e in t)"default"===e||Object.prototype.hasOwnProperty.call(n,e)||i(n,t,e)};Object.defineProperty(n,"__esModule",{value:!0}),r(e("./src/plugins/slicer/slicer.ts"),n)},"./src/plugins/slicer/slicer.ts":function(t,n,e){var e,N,k,a,r,o,i,u,s,D,c,e,e;function p(t){return t&&t.text!==N}function f(){}function l(t,n){var e,i,t;if(t!==k&&t!==N){if(I(t)===a)n.value=t;else if(I(t)===o)n.value=t?1:0;else if(t instanceof Date)n.value=D.o0(t);else{if(I(t)!==r)return;if(0===_(t=t.trim()))return;if(e=!1,"%"===t.charAt(_(t)-1)&&(e=!0,t=t.substr(0,_(t)-1)),2<=_(t)&&"0"===t[0]&&"x"===t[1])return;if(i=Number(t).valueOf(),isNaN(i)||!isFinite(i)){if(t=new Date(t),isNaN(t))return;i=D.o0(t)}e&&(i/=100),n.value=i}return 1}}function b(t){var n,e,i,r,o,a,u,s,c,f,l,h,d,v,m,g,n=t.ezt;for(n||(t.izt=[],t.rzt=[]),e=n?t.ozt:t.izt,i=t.azt,r=t.uzt,o=n?t.szt:t.rzt,a=t.Mct,u=t.czt,s=t.fzt,c=_(t.data),l={},h=0;h<c;h++){for(d=!1,v=void 0,m=0;m<_(a)&&(v=a[m],n&&v===t.lzt||(r[v]?(A(l[g=t.columnNames[v]])&&(l[g]=t.getColumnIndex(g)),f=t.fue(l[g],h),d=!r[v][f]):i[v]&&(d=!i[v][h]),!d));m++);!d&&n&&(u?(A(l[g=t.columnNames[v]])&&(l[g]=t.getColumnIndex(g)),d=!u[f=t.fue(l[g],h)]):s&&(d=!s[h])),d||(e[h]=!0)}for(m=0;m<_(e);m++)e[m]&&o.push(m)}function v(t){return"string"==typeof t?t.toLowerCase():t instanceof Date?D.o0(t):t}function h(t){var n,e,i,n=t.hzt={};for(t.dzt=[],t.vzt=[],t.mzt=[],t.gzt=[],e=t.columnNames,i=0;i<_(e);i++)n[(e[i]+"").toUpperCase()]=i}function y(t,n){var e,i,r,o,a,u,s,c,f,l,l,h,h,d,e=t.dzt,i=t.vzt,r=t.pzt,o=t.mzt,a=t.gzt,u=t.data,s=a[n]=[];for(t.bzt=[],e[n]=[],i[n]=[],r[n]={},o[n]=[],c={},f=0;f<_(u);f++)l=p(l=u[f][n])?l.text.trim():l,e[n].push(l),(h=c[v(l)])?(h.list.push(f),s[f]=h.index):(h=[f],i[n].push(l),o[n].push(h),d=_(o[n])-1,r[n][l]=d,s[f]=d,c[v(l)]={list:h,index:d})}function d(t,n,e){var i,r,o,a,u,s,c,f,l,l,h,d,v,m,g,i=t.yzt,r=t.getColumnIndex(n),o=[];if(r&&(a=t.ezt?t.wzt:t.Mzt[r],u=t.izt,a)){for(i[r]||t.Czt(r),s=[],c=i[r],f=0;f<_(c);f++)l=p(l=t.data[f][r])?l.value:l,s[c[f]]=l;for(h=t.Szt[r],f=0;f<_(a);f++){for(d=a[f],v=!1,g=(m=t.Tzt(s,d)).start;g<=m.end;g++)if(u[h[g]]){v=!0;break}v!==e&&o.push(d)}}return o}function m(t,n){var e,i,r,o,a,u,e=[],i=t.getColumnIndex(n);if(0<=i){for(r=_(t.getData(n)),o=t.ezt?t.ozt:t.izt,a=0;a<r;a++)o[a]||(u=t.fue(i,a),-1===e.indexOf(u)&&e.push(u));return e}}function g(t,n){var e,i,r,o,a,u,s,c,f,l,e=[],i={},r=t.getColumnIndex(n);if(0<=r)for(o=t.czt||t.fzt,a=t.uzt[r]||t.azt[r],u=t.ezt&&r===t.lzt?o:a,c=_((s=!!t.azt[r])?t.getData(n):t.getExclusiveData(n)),f=0;f<c;f++)!u||u[f]||i[l=s?t.fue(r,f):f]||(i[l]=!0,e.push(l));return e}function w(t,n){for(var e,i,r,o,a,u,s,c,f,l,h,d,e={},i=t.columnNames,o=_(i),r=0;r<o;r++)if(i[r]!==n)for(a=g(t,i[r]),u=0;u<_(a);u++)for(s=t.getRowIndexes(i[r],a[u]),c=0;c<_(s);c++)e[s[c]]||(e[s[c]]=!0);for(f={},o=_(t.data),r=0;r<o;r++)l=t.getExclusiveRowIndex(n,r),e[r]||(f[l]=!0);for(h=_(t.getExclusiveData(n)),d=[],r=0;r<h;r++)f[r]||d.push(r);return d}function M(t,n,e,i){var r,n,o,a,u,s,s,c,f,l,r=t.getColumnIndex(n),n=t.yzt;for(n[r]||t.Czt(r),o=[],a=n[r],u=0;u<_(a);u++)s=p(s=t.data[u][r])?s.value:s,o[a[u]]=s;for(c=[],u=0;u<_(e);u++)for(f=t.Tzt(o,e[u]),l=0;l<_(a);l++)a[l]>=f.start&&a[l]<=f.end&&(c[l]=!0);i?(t.fzt=c,t.wzt=e):(t.Mzt[r]=e,t.azt[r]=c,delete t.uzt[r],delete t.Azt[r]),b(t)}function C(t,n,e,i){for(var n,r,o,n=t.getColumnIndex(n),r=[],o=0;o<_(e);o++)r[e[o]]=!0;i?t.czt=r:(t.uzt[n]=r,t.Azt[n]=e,delete t.Mzt[n],delete t.azt[n]),b(t)}function S(t,n){t.ezt=!1,t.czt=[],t.szt=[],t.ozt=[],t.fzt=[],n&&t.onFiltered()}function T(t,n){var e,i,e=this;for(e.hzt={},e.dzt=[],e.vzt=[],e.pzt=[],e.mzt=[],e.gzt=[],e.uzt=[],e.Azt=[],e.azt=[],e.Mzt=[],e.izt=[],e.rzt=[],e.Mct=[],e.szt=[],e.ozt=[],e.ezt=!1,e.aT=[],e.Upt=0,e.bzt=[],e.Szt=[],e.yzt=[],e.lue=0,e.Izt(t,n),i=0;i<_(e.data);i++)e.izt[i]=!0,e.rzt.push(i)}function A(t){return t===k||t===N}function I(t){return typeof t}function _(t){return t?t.length:0}Object.defineProperty(n,"__esModule",{value:!0}),n.GeneralSlicerData=n.xzt=n.SlicerAggregateType=n.FilteredOutDataType=void 0,e=e("./src/common/util/datetimehelper.ts"),N=void 0,k=null,a="number",r="string",o="boolean",i=e.ct.o0,(e=u=n.FilteredOutDataType||(n.FilteredOutDataType={}))[e.all=0]="all",e[e.byCurrentColumn=1]="byCurrentColumn",e[e.byOtherColumns=2]="byOtherColumns",(e=s=n.SlicerAggregateType||(n.SlicerAggregateType={}))[e.average=1]="average",e[e.count=2]="count",e[e.counta=3]="counta",e[e.max=4]="max",e[e.min=5]="min",e[e.product=6]="product",e[e.stdev=7]="stdev",e[e.stdevp=8]="stdevp",e[e.sum=9]="sum",e[e.vars=10]="vars",e[e.varp=11]="varp",f.o0=function(t){return i(t)},f.quickSort=function(t){for(var n,e,i,n=_(t),e=[],i=0;i<n;i++)e[i]={index:i,value:t[i]};return f.quickSortImp(e)},f.quickSortImp=function(t){var n,e,i,r,o,a,u,s,c,n=t.length;if(n<=1)return t;for(e=f,r=t[i=Math.floor(n*Math.random())],o=[],a=[],u=[],s=0;s<n;s++)(i===s?u:(c=e.sortCompare(t[s].value,r.value))<0?o:0<c?a:u).push(t[s]);return e.quickSortImp(o).concat(u,e.quickSortImp(a))},f.isEquals=function(t,n){return!(!A(t)&&""!==t||!A(n)&&""!==n)||(t instanceof Date&&n instanceof Date?t.valueOf()===n.valueOf():I(t)===r&&I(n)===r?t.toLowerCase()===n.toLowerCase():t===n)},f.isGreaterThan=function(t,n){var e=I(t),i=I(n);return e===o?t=t?1:0:t instanceof Date&&(t=f.o0(t)),i===o?n=n?1:0:n instanceof Date&&(n=f.o0(n)),e===i||e!==a&&i!==a?e===r&&i===r?t.toLowerCase()>n.toLowerCase():n<t:i===a},f.sortCompare=function(t,n){var e,i,r,o,e=f,i=-1,r=A(t)||""===t||I(t)===a&&isNaN(t),o=A(n)||""===n||I(n)===a&&isNaN(n);return r&&o?i=0:r?i=1:o?i=-1:e.isEquals(t,n)?i=0:e.isGreaterThan(t,n)&&(i=1),i},D=f,n.xzt=D,T.prototype.inPreview=function(){return this.ezt},T.prototype.Izt=function(t,n){var e=this;e.data=t,e.columnNames=n,h(e)},T.prototype.due=function(t){var n=this;n.vue&&0===n.lue&&(n.Nzt("onDataChanged",t),n.vue=!1)},T.prototype.mue=function(){this.lue++},T.prototype.gue=function(){var t=this;t.lue--,t.lue<=0&&(t.lue=0,t.due())},T.prototype.onDataChanged=function(t){for(var n,e,i,r,o,a,u,s,c,f,l,c,l,f,h,d,v,m,n=this,e=new Array(_(n.columnNames)),i=n.Azt,r=n.vzt,o=n.uzt,a=n.dzt,s={},u=0;u<_(t);u++)f=(c=t[u]).data,l=c.columnName,c=c.row,A(s[l])&&(s[l]=n.getColumnIndex(l)),l=s[l],c>=n.data.length&&n.onRowsAdded(c,1,!1),f=p(n.data[c][l]=f)?f.text:f,a[l]&&(a[l][c]=f),e[l]=!0;for(h=0;h<_(e);h++)if(e[h]){for(d=i[h],i[h]=d?[]:void 0,o[h]=d?[]:void 0,v=[],u=0;d&&u<_(d);u++)v.push(r[h][d[u]]);for(y(n,h),u=0;u<_(v);u++)m=n.pzt[h][v[u]],i[h].push(m),o[h][m]=!0}b(n),n.vue=!0,n.due(t)},T.prototype.Nzt=function(t){for(var n,e,i,r,o,n=[],e=1;e<arguments.length;e++)n[e-1]=arguments[e];for(i=this.aT||[],r=0;r<_(i);r++)(o=i[r])[t]&&o[t].apply(o,n)},T.prototype.onColumnNameChanged=function(t,n){var e,i,r,e=this,i=e.hzt,r=e.getColumnIndex(t);r<0||(e.columnNames[r]=n,delete i[t.toUpperCase()],i[n.toUpperCase()]=r,e.Nzt("onColumnNameChanged",t,n))},T.prototype.onRowsAdded=function(t,n,e){var i,r,o,a,u,s,c,f,l,h,d,v,m,g,p,b,y,w,M,C,S,T,A,I,x,i=this,r=_(i.columnNames),o=i.data,a=i.dzt,u=i.vzt,s=i.mzt,c=i.gzt,f=i.uzt,l=i.Azt,h=i.izt,d=i.rzt,v=i.Mct;for(i.bzt=[],m=0;m<n;m++)o.splice(t,0,new Array(r));for(g=0;g<r;g++){for(m=0;m<n;m++)a[g]&&a[g].splice(t,0,N);if(y=void 0,b=u[g]){for(w=k,M=0;M<_(b);M++){for(C=s[g][M],S=0;S<_(C);S++)C[S]>=t&&(C[S]+=n);D.isEquals(b[M],k)&&(w=C,y=M)}for(w||(w=[],b.push(k),y=_(b)-1,i.pzt[g].null=y,s[g].push(w),f[g]&&-1===v.indexOf(g)&&(f[g][y]=!0,l[g].push(y))),T=t;T<t+n;T++)w.push(T);for(p=t;p<t+n;p++)c[g].splice(p,0,y)}}for(A=!0,m=0;m<_(v);m++)I=c[g=v[m]][t],!0!==f[g][I]&&(A=!1);for(m=0;m<_(d);m++)d[m]>=t&&(d[m]+=n);for(p=_(o)-1;t+n<=p;p--)h[p]=h[p-n];for(x=0<_(v),p=t;p<t+n;p++)A&&d.push(p),h[p]=!x;e||i.Nzt("onRowsChanged",t,n,!0)},T.prototype.onRowsRemoved=function(t,n){this.kzt(t,n,!0)},T.prototype.kzt=function(t,n,e){var i,r,o,a,u,s,c,f,l,h,d,v,m,g,p,i=this,r=i.Azt,o=i.vzt,a=i.uzt,u=i.data,s=_(i.columnNames),c=i.dzt;for(u.splice(t,n),l=0;l<s;l++){if(c[l]&&c[l].splice(t,n),d=[],(h=r[l])&&e){for(f=0;f<_(h);f++){for(v=i.getRowIndexes(i.columnNames[l],h[f]),m=!0,g=0;g<_(v);g++)if(v[g]<t||v[g]>=t+n){m=!1;break}m||d.push(o[l][h[f]])}r[l]=[],a[l]=[]}if(y(i,l),h&&e)for(f=0;f<_(d);f++)p=i.pzt[l][d[f]],r[l].push(p),a[l][p]=!0}e&&b(i),i.Nzt("onRowsChanged",t,n,!1)},T.prototype.onColumnsRemoved=function(t,n){for(var e,i,r,o,a,u,s,c,f,l,h,d,v,e=this,i=e.data,r=[],o=e.Mct,a=t+n,u=t;u<a;u++)(s=e.columnNames[u])&&(c=u,r.push(s),-1!==o.indexOf(c))&&e.doUnfilter(s);for(f=e.uzt||e.azt,l=e.Azt||e.Mzt,h=e.hzt,u=0;u<_(i);u++)i[u].splice(t,n);for(d in e.bzt=[],e.columnNames.splice(t,n),e.dzt.splice(t,n),e.vzt.splice(t,n),e.pzt.splice(t,n),e.mzt.splice(t,n),e.gzt.splice(t,n),f.splice(t,n),l.splice(t,n),h)h[d]>=t+n&&(h[d]-=n);for(u=0;u<_(r);u++)delete h[(s=r[u]).toUpperCase()],t=e.getColumnIndex(s),-1!==(v=o.indexOf(t))&&o.splice(v,1),e.Nzt("onColumnRemoved",r[u])},T.prototype.Dzt=function(){return this.bzt},T.prototype._zt=function(){return this.Szt},T.prototype.Czt=function(t){var n,e,i,r,o,a,a,u,s,c,f,l,h,n=this,e=n.data;for(n.dzt[t]||y(n,t),i=_(e),r=[],o=0;o<i;o++)a=p(a=e[o][t])?a.value:a,r.push(a);for(u=D.quickSort(r),s=n.bzt[t]=[],c=n.Szt[t]=[],f=n.yzt[t]=[],l=0;l<_(u);l++)h=u[l],s.push(h.value),c.push(h.index),f[h.index]=l},T.prototype.getColumnIndex=function(t){var t=this.hzt[t.toUpperCase()];return void 0===t?-1:t},T.prototype.getFilteredRowIndexes=function(){var t=this;return t.ezt?t.szt:t.rzt},T.prototype.getFilteredOutRowIndexes=function(){for(var t,n,e,i,r,t=this,n=_(t.data),e=t.ezt?t.ozt:t.izt,i=[],r=0;r<n;r++)e[r]||i.push(r);return i},T.prototype.getData=function(t,n){var e,i,r,o,t,t,n,a,u,s,e=this,i=e.dzt,r=e.getColumnIndex(t);if(0<=r){if(n){for(e.bzt[r]||e.Czt(r),o=i[r],t=e.bzt[r],n=(t=e.Tzt(t,n)).start,a=t.end,u=[],s=n;s<=a;s++)u.push(o[e.Szt[r][s]]);return u}return i[r]||y(e,r),i[r]}return[]},T.prototype.aggregateData=function(t,n,e){var i,t,r,e,t,o,e,o,i,t,r,i=this,t=i.getColumnIndex(t);return t<0?N:(i.bzt[t]||i.Czt(t),o=_(t=i.bzt[t]),r=(e=i.Tzt(t,e)).start,e=e.end,5===n?o<=r?N:t[r]:4===n?e<0?N:t[e]:3===n?e<r?0:e-r+1:(i=(o=i.Ezt(t,n,r,e)).data1,t=o.data2,r=o.data3,1===n?i/=t:7===n||10===n?(i=(r*t-i*i)/(r*(r-1)),i=7===n?Math.sqrt(i):i):8!==n&&11!==n||(i=(r*t-i*i)/(r*r),i=8===n?Math.sqrt(i):i),i))},T.prototype.Ezt=function(t,n,e,i){for(var r,o,a,u,s,c,r=6===n?1:0,o=0,a=0,u=e;u<=i;u++)(s=t[u])===k&&s===N||l(s,c={value:k})&&(s=c.value,1===n?(r+=s,o++):2===n?r++:9===n?r+=s:6===n?r*=s:7!==n&&8!==n&&10!==n&&11!==n||(r+=s,o+=s*s,a++));return{data1:r,data2:o,data3:a}},T.prototype.Tzt=function(t,n){var e=_(t),i,r,o,a;if(n){if(n.min===-1/0)i=0;else for(o=0;o<e;o++)if(a=t[o],D.isEquals(n.min,a)||D.isGreaterThan(a,n.min)){i=o;break}if(i===N&&(i=e),r===1/0)r=e-1;else{for(o=e-1;0<=o;o--)if(a=t[o],D.isEquals(a,n.max)||D.isGreaterThan(n.max,a)){r=o;break}r===N&&(r=-1)}}else i=0,r=e-1;return{start:i,end:r}},T.prototype.getExclusiveData=function(t){var n=this,e=n.vzt,t=n.getColumnIndex(t);return 0<=t?(e[t]||y(n,t),e[t]):[]},T.prototype.getRowIndexes=function(t,n){var e=this,t=e.getColumnIndex(t);return 0<=t?(e.gzt[t]||y(e,t),e.mzt[t][n]):[]},T.prototype.getExclusiveRowIndex=function(t,n){var e=this,t=e.getColumnIndex(t);return e.fue(t,n)},T.prototype.fue=function(t,n){var e=this,i=e.gzt;return 0<=t?(i[t]||y(e,t),i[t][n]):-1},T.prototype.getFilteredIndexes=function(t){var n=[],e;return this.jzt(t,n,{}),n},T.prototype.jzt=function(t,n,e){for(var i,r,o,a,u,u,i=this,r=i.ezt?i.szt:i.rzt,o=i.getColumnIndex(t),a=0;a<_(r);a++)u=r[a],A(u=i.fue(o,u))||(e[u]?e[u]++:(e[u]=1,n.push(u)))},T.prototype.getFilteredRanges=function(t){return d(this,t,!1)},T.prototype.getFilteredOutRanges=function(t){return d(this,t,!0)},T.prototype.getFilteredOutIndexes=function(t,n){var e=this;return(0===n?m:1===n?g:w)(e,t)},T.prototype.attachListener=function(t){-1===this.aT.indexOf(t)&&this.aT.push(t)},T.prototype.detachListener=function(t){for(var n,e,n=this.aT||[],e=0;e<_(n);e++)if(n[e]===t){n.splice(e,1);break}},T.prototype.suspendFilteredEvents=function(){this.Upt++},T.prototype.resumeFilteredEvents=function(){var t=this;t.Upt--,0===t.Upt&&t.onFiltered()},T.prototype.doFilter=function(t,n,e){this.Ozt(t,n,e),this.onFiltered()},T.prototype.Ozt=function(t,n,e){var i,r,o,i=this,r=i.Mct,o=i.getColumnIndex(t);o<0||(e?(i.ezt=!0,i.lzt=o):i.ezt&&S(i,!1),r.indexOf(o)<0&&r.push(o),n.ranges?M(i,t,n.ranges,e):C(i,t,n.exclusiveRowIndexes,e))},T.prototype.clearPreview=function(){S(this,!0)},T.prototype.doUnfilter=function(t){this.Rzt(t),this.onFiltered()},T.prototype.Rzt=function(t){var n,t,t,n=this;n.ezt&&S(n,!1),(t=n.getColumnIndex(t))<0||(delete n.Mzt[t],delete n.azt[t],delete n.uzt[t],delete n.Azt[t],b(n),0<=(t=n.Mct.indexOf(t))&&n.Mct.splice(t,1))},T.prototype.onFiltered=function(){var t=this;0===t.Upt&&t.Nzt("onFiltered",{rowIndexes:t.getFilteredRowIndexes(),isPreview:t.ezt})},T.prototype.getListener=function(){return this.aT},n.GeneralSlicerData=T},"./src/plugins/sparkline/sparkline.entry.ts":function(t,n,e){var i,r,i=this&&this.__createBinding||(Object.create?function(t,n,e,i){void 0===i&&(i=e);var r=Object.getOwnPropertyDescriptor(n,e);r&&("get"in r?n.__esModule:!r.writable&&!r.configurable)||(r={enumerable:!0,get:function(){return n[e]}}),Object.defineProperty(t,i,r)}:function(t,n,e,i){t[i=void 0===i?e:i]=n[e]}),r=this&&this.__exportStar||function(t,n){for(var e in t)"default"===e||Object.prototype.hasOwnProperty.call(n,e)||i(n,t,e)};Object.defineProperty(n,"__esModule",{value:!0}),r(e("./src/plugins/sparkline/sparkline.ts"),n)},"./src/plugins/sparkline/sparkline.ts":function(n,l,e){var i,r,h,d,it,Z,v,m,rt,F,O,nt,_,I,ot,at,et,E,H,ut,z,B,st,ct,ft,lt,o,bt,ht,yt,dt,x,W,V,Y,N,J,g,P,G,K,X,q,$,j,tt,wt,Mt,Ct,R,L,k,St,Tt,At,a,S,It,xt,p,b,y,w,M,Nt,T,kt,Dt,_t,Et,jt,Ot,Rt,C,u,s,c;function Bt(t){this.x=t.x,this.y=t.y}function Lt(t){this.x=t.x,this.y=t.y,this.width=t.width,this.height=t.height}function A(t,n){return{x:t,y:n}}function Ft(t,n,e,i){return{x:t,y:n,width:e,height:i}}function Pt(t,n){for(var e,i,r,o,a,e=t[0],i=e&&e.value?e.value:e,o=1,a=t.length;o<a;o++)r=(e=t[o])&&e.value?e.value:e,(n&&r<i||!n&&i<r)&&(i=r);return i}function U(t,n,e,i,r,o,a){o&&(t.strokeStyle=o),a&&(t.lineWidth=a),t.beginPath(),t.moveTo(n,e),t.lineTo(i,r),t.stroke()}function Gt(t,n,e,i,r,o,a){t.save(),o&&(t.strokeStyle=o),a&&(t.lineWidth=a),t.beginPath(),t.moveTo(n,e),t.lineTo(i,r),t.closePath(),t.stroke(),t.restore()}function Ut(t,n,e,i,r,o,a,u){var s,c,f,l,h,d,v,m,g;if(t.save(),s=[o,a],t.setLineDash)t.beginPath(),t.strokeStyle=u,t.setLineDash(s),t.stroke(),t.moveTo(n,e),t.lineTo(i,r);else for(t.beginPath(),t.lineWidth=1,t.strokeStyle=u,l=(i-n)/(c=H(E(i-n,2)+E(r-e,2))),h=(r-e)/c,v=d=0;d<c;)d+=m=ot(s[v%2],c-d),(g=++v%2)&&t.moveTo(n,e),n+=m*l,e+=m*h,g&&t.lineTo(n,e);t.stroke(),t.restore()}function vt(t,n,e,i,r,o,a,u,s,c,f,l){n?U(t,e,i,r,o,f,l):U(t,a,u,s,c,f,l)}function D(t,n,e,i,r,o,a,u){t.save(),a&&(t.fillStyle=a),t.textBaseline=u||q,t.beginPath(),t.font=r,t.textAlign=o,t.fillText(i="string"==typeof i?i:i+"",n,e),t.restore()}function Ht(t){return h.ft.rp(v(t))<127.5?x:W}function mt(t,n,e,i,r,o,a,u){var s,c,f,l,u,s=u;return it(u)&&(s=r),u=a?(c=n+s+o,l=i-2*s,f=t+r,e-2*r):(c=t+s,l=e-2*s,f=n+r,i-2*r),{left:c,top:f,width:l,height:u}}function zt(t,n){for(var e,i,r,e=0,i=0,r=t.length;i<r;i++)e+=n&&!n(t[i])?0:t[i];return e}function Vt(t){return t*nt/180}function Yt(t,n,e,i){for(var r,o,a,u,s,r=[],a=0,u=0,s=t.length;a<s;a++)n?(n(t[a])?r[u]=e?e(t[a]):t[a]:r[u]=0,u++):(o=ft(t[a]),!ct(o)&&isFinite(o)&&(r[u]=o,u++));return i&&i(r),r}function gt(t,n,e,i,r,o){var a=et(n+i),u=et(e+r);n=et(n),e=et(e),i=et(a-n),r=et(u-e),t.beginPath(),t.fillStyle=o,t.fillRect(n,e,i,r),t.fill()}function Zt(t,n,e){return t=ot(t,n),t=at(t,e)}function pt(t,n,e,i,r){t.save(),t.rect(n,e,i,r),t.clip()}function Wt(t,n){var e,i,r,o;return t&&n&&(e=at(t.x+t.width,n.x+n.width),i=at(t.y+t.height,n.y+n.height),r=ot(t.x,n.x),o=ot(t.y,n.y),e-r<=t.width+n.width)&&i-o<=t.height+n.height}function Qt(t,n,e,i,r,o){var a,u,s,c,f,l,h,d,v,m,g,p,b,y,w,a=e+r/2,u=i+o/2,s=5,c=ot(r,o)/2-5,f=-.5*nt,h=a+c*I(f),d=u+c*_(f),v=[],m=[];if(!(c<=0)){for(b=Jt(p=(g=Yt(n.values,function(t){return!it(t)&&!ct(t)&&isFinite(t)},function(t){return ut(t)},function(t){1===t.length&&(t[1]=1-t[0])})).length,n.colors),y=zt(g),t.save(),w=0;w<p;w++)l=f+g[w]/y*2*nt,t.beginPath(),t.moveTo(a,u),t.lineTo(h,d),t.arc(a,u,c,f,l,!1),t.lineTo(a,u),t.fillStyle=b[w],t.fill(),v.push(h),m.push(d),h=a+c*I(f=l),d=u+c*_(f);for(w=0;w<p;w++)U(t,a,u,v[w],m[w],x);t.restore()}}function Jt(t,n){var e,i,r,o,a,u,s,c,e=[],i=n.length;if(t<=i)e=n.slice(0,t);else{for(0===i?(e.push("darkgray"),i=1):e=n.slice(0),r=[],a=t-i+1,u=o=void 0,u=0;u<i;u++)r[u]=v(e[u]);for(u=i;u<t;u++){for(s in o=r[u%i])o.hasOwnProperty(s)&&(c=o[s],o[s]=O(c-c/a*(u/i)));o.a=255,e[u]=h.ft.j(o)}}return e}function Kt(t){var n=c.call(this,A(t.x,t.y))||this;return n.value=t.value,n}function Xt(t,n,e){return{x:t,y:n,value:e}}function qt(e,t,n,i,r,o){var a,u,s,c,f,l,h,d,v,m,g,p,b,y,w,M,C,S,t,s,t,T,A,I,x,N,k,D,_,E,j,O;for(e.save(),a=t.points,u=t.mini,s=t.maxi,c=t.line1,f=t.line2,l=t.colorPositive,h=t.colorNegative,d=5,a=Yt(a,function(t){return!it(t)&&!ct(t)&&isFinite(t)}),l=it(l)?"#787878":l,h=it(h)?ht:h,t=Pt(a,!1),s=it(s)?t:s,m=at(s,t),s=Pt(a,!0),u=it(u)?s:u,v=ot(u,s),g=(g=(m=m<0?0:m)<(g=0)?m:0)<(v=0<v?0:v)?v-1:g,p=a.length,t=mt(n,i,r,o,5),b=t.left,y=t.top,w=t.width,M=t.height,C=w/(p-1),T=[],k=y+(m-g)/(S=(m-v)/M),E=0;E<p;E++)A=a[E],D=b+C*E,_=y+(m-A)/S,0===E&&T.push(new Dt(Xt(D,k,g))),0<E&&A*a[E-1]<0&&(x=T[T.length-1])&&(N=$t(x.x,x.y,D,_,k),T.push(new Dt(Xt(N,k,g)))),T.push(new Dt(Xt(D,_,A))),E===p-1&&T.push(new Dt(Xt(D,k,g)));for(e.beginPath(),j=0,O=T.length;j<O;j++)(I=T[j])&&(0===j?e.moveTo(I.x,I.y):e.lineTo(I.x,I.y),x=T[j-1],I.value===g)&&x&&(e.fillStyle=x.value>g?l:h,e.fill(),j!==O-1)&&(e.beginPath(),e.moveTo(I.x,I.y));function R(t){var t,n,t;t===rt&&typeof t!==B||(t=Zt(t,m,v),t=et(y+(n=0!=S?(m-t)/S:M/2))-.5,U(e,b,t,b+w,t,V))}R(c),R(f),e.restore()}function $t(t,n,e,i,r){return((n-r)*e+(r-i)*t)/(n-i)}function tn(r,t,n,B,L,F){var e,i,P,G,U,H,o,a,u,s,c,f,z,l,V,h,d,Y,Z,v,m,g,p,b,y,w,M,C,W,Q,J,M,S,T,A,I,x,N,k,D,_,t,E,j,O,R,t,e,i,n,e=t.points1,i=t.points2,P=t.minX,G=t.maxX,U=t.minY,H=t.maxY,o=t.hLine,a=t.vLine,u=t.xMinZone,s=t.xMaxZone,c=t.yMinZone,f=t.yMaxZone,z=t.tags,l=t.drawSymbol,V=t.drawLines,h=t.color1,d=t.color2,Y=t.dash,Z=4,t=mt(n,B,L,F,5),E=t.left,j=t.top,O=t.width,R=t.height;if(e&&!(e.length<=0)&&!((v=on(e)).length<=0||i&&0<i.length&&(m=on(i)).length<=0)){for(pt(r,n,B,L,F),r.beginPath(),l=!!it(l)||l,h=it(h)?bt:h,d=it(d)?ht:d,X(v,U,H,P,G),!it(u)&&!it(s)&&!it(c)&&!it(f)&&b<=u&&u<=y&&b<=s&&s<=y&&g<=c&&c<=p&&g<=f&&f<=p&&(t=at(b,u),e=ot(y,s),i=at(g,c),n=ot(p,f),gt(r,E+(t-b)*O/(y-b),j+(p-(n=n<=i?i+1:n))*R/(p-g),((e=e<=t?t+1:e)-t)*O/(y-b),(n-i)*R/(p-g),dt)),N=x=-lt,D=k=lt,C=v.length,w=0;w<C-1;w++)K(v,w,h,$),z&&(0===w&&(N<T&&(x=S,N=T),T<D)&&(k=S,D=T),N<I&&(x=A,N=I),I<D)&&(k=A,D=I);if(m&&0<m.length)for(X(m,g,p,b,y),C=m.length,w=0;w<C-1;w++)K(m,w,d,tt);z&&(q(x,N,ht),q(k,D,"#0000FF")),!it(o)&&g<=o&&o<=p&&(_=et(j+(p-o)*R/(p-g))-.5,rn(r,E,_,E+O,_,ht)),!it(a)&&b<=a&&a<=y&&(_=et(E+(a-b)*O/(y-b))-.5,rn(r,_,j,_,j+R,ht)),r.restore()}function K(t,n,e,i){M=t[n],W=M.x,Q=M.y,M=t[n+1],J=M.x,M=M.y,S=E+(W-b)*O/(y-b),A=E+(J-b)*O/(y-b),T=j+(p-Q)*R/(p-g),I=j+(p-M)*R/(p-g),V&&rn(r,S,T,A,I,e,Y),l&&(0===n&&i(S,T),i(A,I))}function X(t,n,e,i,r){var o,t,o=nn(t,!0),t=nn(t,!1);g=it(U)?o.y:n,p=it(H)?t.y:e,b=it(P)?o.x:i,y=(y=it(G)?t.x:r)<=b?b+1:y,p=p<=g?g+1:p}function q(t,n,e){r.beginPath(),r.arc(t-2,n-2,2,0,2*nt,!1),r.fillStyle=e,r.fill()}function $(t,n){r.beginPath(),r.strokeStyle=h,r.arc(t-2,n-2,2,0,2*nt,!1),r.stroke()}function tt(t,n){r.beginPath(),r.strokeStyle=d,r.strokeRect(t-2,n-2,4,4)}}function nn(t,n){for(var e,i,r,o,a,u,e=n?1:-1,i=n?ot:at,r=new T(A(e*lt,e*lt)),o=t.length,u=0;u<o;u++)a=t[u],r.x=i(r.x,a.x),r.y=i(r.y,a.y);return r}function en(t,n,e,i){return e/i*(n-t)+t}function rn(t,n,e,i,r,o,a){var u,s,c,f,l,h,d,v,m,g,p,b,y,w,M,C,S;if(a){for(u=H(E(i-n,2)+E(r-e,2)),c=6,f=2,l=4,g=m=v=d=void(s=0),g=n<=i?(v=i,m=d=n,e):(v=n,m=d=i,r),b=e-(p=(r-e)/(i-n))*n,(h=[]).push(new T(A(m,g))),y=[6,4,2,4];s<u;)for(w=0,M=y.length;w<M;w++)(s+=y[w])<=u&&(m=en(d,v,s,u),h.push(new T(A(m,g=p*m+b))));for(C=0,S=h.length;C<S-1;C+=2)U(t,h[C].x,h[C].y,h[C+1].x,h[C+1].y,o)}else U(t,n,e,i,r,o)}function on(t){var n,e,i,r,o,n=[],e=t.length;if(0<e)if(e<(i=t[0].length)){if(2<=e)for(r=0;r<i;r++)n.push(new T(A(t[0][r],t[1][r])))}else if(2<=i)for(o=0;o<e;o++)n.push(new T(A(t[o][0],t[o][1])));return n}function an(a,t,u,s,c,f){var n,e,i,r,o,l,h,d,v,m,g,p,b,y,w,M,C,t,g,S,T,A,S,I,x,b,N,k,i,y,r,d,D,_,E,n=t.measure,e=t.target,i=t.maxi,r=t.good,o=t.bad,l=t.forecast,h=t.tickUnit,d=t.colorScheme,v=t.vertical,m=5,g=t.measureColor,p=t.targetColor,b=t.maxiColor,y=t.goodColor,w=t.badColor,M=t.forecastColor,C=t.allowMeasureOverMaxi,t=t.barSize;if(!(it(i)||i<0)&&(it(t)||!(ct(t)||t<=0))){if(1<t&&(t=1),n=it(n)||n<0?0:n,r=it(r)||r<0?0:r,o=it(o)||o<0?0:o,e=it(e)?0:e,l=it(l)?0:l,h=it(h)?0:h,d=it(d)?"#A0A0A0":d,g=it(g)?"#252525":g,i<n&&!C&&(n=i,g=ht),i<r&&(r=i,g=ht),i<o&&(o=i,g=ht),i<e&&(e=0,g=ht),i<l&&(l=i,g=ht),S=mt(u,s,c,f,5,f-10,v),T=S.left,A=S.width,a.save(),S=it(t)?.2:(1-t)/2,I=it(t)?.6:t,x=C?at(i,n):i,j(it(b)?Z(d,1.66):b,i,x,S,I),j(it(y)?Z(d,1.33):y,r,x,S,I),j(it(w)?d:w,o,x,S,I),b=.25*t/.6,j(g,n,x,N=it(t)?.375:(1-b)/2,k=it(t)?.25:b),0<l&&(i=T,A<(y=A*(l/x))&&(y=A),r=it(t)?3:3*t/.6,vt(a,v,u+.5*c,i,u+.5*c,i-y,i,s+.5*f,i+y,s+.5*f,it(M)?"#3690BF":M,r)),0<e&&(d=et(T-(v?1:-1)*A*(e/x))-.5,vt(a,v,u+c*S,d,u+c*(1-S),d,d,s+f*S,d,s+f*(1-S),it(p)?ht:p,1)),0<h)for(D=O(x/h),_=void 0,E=0;E<=D;E++)_=et(T-A/x*h*(v?1:-1)*E)-.5,vt(a,v,u,_,u+.05*c,_,_,s+f,_,s+.95*f,yt,1);a.restore()}function j(t,n,e,i,r){var o,t,n;a.fillStyle=t,A<(t=A*(n/e))&&!C&&(t=A),n=new kt(v?Ft(u+c*i,T-t,c*r,t):Ft(T,s+f*i,t,f*r)),a.fillRect(n.x,n.y,n.width,n.height)}}function un(t,n,e,i,r,o){var a,u,s,c,f,l,h,d,n,v,n,v,m,g,p,b,y,w,M,C,S,T,A,I,x,I,N,k,D,_,E,a=n.spreadData,u=n.showAverage,s=n.scaleStart,c=n.scaleEnd,f=n.style,l=n.colorScheme,h=n.vertical,d=5,n=a.length;if(!(n<=0)){for(v=a[0].key,n=a[n-1].key,s=it(s)?v:s,c=it(c)?n:c,f=it(f)?4:f,l=it(l)?yt:l,m=(v=mt(e,i,r,o,5,o-10,h)).left,g=v.width,p=v.top,b=v.height,pt(t,e,i,r,o),t.beginPath(),t.strokeStyle=l,t.fillStyle=l,M=Pt(a,!(t.lineWidth=2)),S=0,T=a.length;S<T;S++)if(I=(A=a[S]).key,x=A.value,y=m+(h?-1:1)*g*(I-s)/(c-s),y=h?(y=ot(y,m),at(y,m-g)):(y=at(y,m),ot(y,m+g)),y=et(y),1===f)vt(t,h,I=p+b/2-(C=(C=x/2*b/M)<.5?.5:C),y,N=p+b/2+C,y,y,I,y,N);else if(4===f)vt(t,h,p,y,p+(C=(C=x*b/M)<1?1:C),y,y,p+b,y,p+b-C);else if(6===f)vt(t,h,p,y,p+b,y,y,p,y,p+b);else for(k=2,D=1;D<=x;D++){switch(f){case 2:w=p+b/2-5-(x/2-D)*b/M;break;case 3:w=p+b-5-(_=sn(x,b,3,A.randomNumbers))[D-1];break;default:w=p+b-D*b/M}w=et(w),t.beginPath(),t.fillRect(h?w:y,h?y:w,2,2)}u&&vt(t,h,p-5,y=m-(h?1:-1)*g*((E=cn(a))-s)/(c-s),p+b+5,y,y,p-5,y,p+b+5,ht),t.restore()}}function sn(t,n,e,i){for(var r,o,a,u,s,c,r=[],o=at(100,10*t),a=0,u=[],s=0;r.length<t;)c=O(i[s]*n),s++,(o<a||fn(c,u))&&(r.push(c),u.push([c-e,c+e])),a++;return r}function cn(t){for(var n,e,i,r,o,n=0,e=0,i=0,r=t.length;i<r;i++)e+=(o=t[i]).value,n+=o.key*o.value;return 0===e?0:n/e}function fn(t,n){for(var e,i,r,e=0,i=n.length;e<i;e++)if((r=n[e])[0]<=t&&t<=r[1])return;return 1}function ln(r,t,n,e,i,o,a){var u,s,c,f,l,h,d,v,m,g,B,p,b,y,L,w,t,t,M,C,S,T,A,I,x,N,k,D,I,_,E,j,O,u=t.points,s=u&&u.length,c=t.colorRange,f=t.labelRange,l=t.maximum,h=t.targetRed,d=t.targetGreen,v=t.targetBlue,m=t.targetYellow,g=t.color,B=t.highlightPosition,p=t.vertical,b=t.textOrientation,y=t.textSize,L=5;if(!(it(u)||s<=0)){if(g=it(g)?yt:g,it(c)||c.length!==s||hn(c))for(c=[],w=0;w<s;w++)c.push(Z(g,1+w/s));for(t=zt(u,function(t){return 0<t}),l=it(l)||l<t?t:l,b=it(b)?0:b,y=it(y)||y<=0?10:y,y=ct(y)?y:y*a.zoomFactor,t=mt(n,e,i,o,5,o-10,p),M=t.left,C=t.width,S=t.top,T=t.height,r.save(),A=M,_=0,E=s;_<E;_++)(I=u[_])<=0||(I=I/l*C,D=p?(x=n+.15*i,k=.7*i,N=A-I,I):(x=A,k=I,N=e+.15*o,.7*o),j=_+1===B?ht:c[_],r.save(),r.fillStyle=j,r.fillRect(x,N,k,D),(O=f&&f[_])&&(r.save(),r.fillStyle=Ht(j),r.textBaseline=$,r.textAlign=K,r.font=y+tt,r.rect(x,N,k,D),r.clip(),1===b?(r.translate(x+k/2,N),r.rotate(Math.PI/2),r.fillText(O,D/2,0)):r.fillText(O,x+k/2,N+D/2),r.restore()),A+=(p?-1:1)*I,r.restore());R(J,h,function(t){return 0<t}),R(Y,d),R(V,v),R("yellow",m),r.restore()}function R(t,n,e){var i,e;n!==rt&&n!==F&&(n=l<n?l:n,!e||e(n))&&(e=(n=n<0?0:n)/l*C,p?(i=et(M-e)-.5,U(r,S,i,S+T,i,t)):(i=et(M+e)-.5,U(r,i,S,i,S+T,t)))}}function hn(t){for(var n=0,e=t.length;n<e;n++)if(it(t[n]))return 1}function dn(t,n,e,i,r,o){U(t,f(n),f(e),f(i),f(r),it(o)?W:o,1)}function vn(e,i,r,t,n){var t,o,a,u,s,c,t=.4*t;switch(i=f(i),r=f(r),e.beginPath(),e.moveTo(i,r),o=t/2,a=H(3)*t/2,u=t/H(3),n){case 0:s=[-o,0,o],c=[a,u,a];break;case 2:s=[-o,0,o],c=[-a,-u,-a];break;case 3:s=[a,u,a],c=[-o,0,o];break;case 1:s=[-a,-u,-a],c=[-o,0,o];break;default:s=[],c=[]}s.forEach(function(t,n){e.lineTo(f(i+t),f(r+c[n]))}),e.lineTo(i,r),e.closePath(),e.fillStyle=x,e.fill()}function mn(t,n,e,i,r,o,a){var u,s,c,f,e,l,h,d,v,m,g,p,b,y,u,f,w,e,b,e,e,t,M,u=e.value,s=e.colorScheme,c=e.axisVisible,f=e.barHeight,e=e.barWidth,l=5,h=5,d=!1,u=ft(u);if(!ct(u)){if(it(f=0===t?f:e))w=.7;else{if(ct(f)||f<=0)return;w=Math.min(1,f)}1<u?(u=1,d=!0):u<-1&&(u=-1,d=!0),s=it(s)?"grey":s,c=!!it(c)||c,n.save(),0===t?(e=o-10,b=a*w,b=0<=u?(d&&(v=new T(A(i+5+e-5,r+a/2))),m=new kt(Ft(i+5,r+a*(1-w)/2,e*u,b)),g=new T(A(i+5,r+1)),p=new T(A(i+5,r+a)),1):(e=ut(e*u),d&&(v=new T(A(i+5+5,r+a/2))),m=new kt(Ft(i+o-5-e,r+a*(1-w)/2,e,b)),g=new T(A(i+o-5,r+1)),p=new T(A(i+o-5,r+a)),3),y=it(f)?a:a*w):1===t&&(e=a-10,t=o*w,p=0<=u?(m=new kt(Ft(i+(1-w)/2*o,r+a-5-(M=e*u),t,M)),d&&(v=new T(A(i+o/2,r+a-5-M+5)),b=0),g=new T(A(i+1,r+a-5)),new T(A(i+o,r+a-5))):(u=ut(u),m=new kt(Ft(i+(1-w)/2*o,r+5,t,e*u)),d&&(v=new T(A(i+o/2,r+5+e-5)),b=2),g=new T(A(i+1,r+5)),new T(A(i+o,r+5))),y=it(f)?o:o*w),n.beginPath(),m&&(gt(n,m.x,m.y,m.width,m.height,s),pt(n,m.x,m.y,m.width,m.height)),v&&vn(n,v.x,v.y,y,b),n.restore(),c&&g&&dn(n,g.x,g.y,p.x,p.y),n.restore()}}function f(t){return et(t)-.5}function gn(t,n,e,i,r,o){mn(0,t,n,e,i,r,o)}function pn(t,n,e,i,r,o){mn(1,t,n,e,i,r,o)}function bn(y,t,w,M,C,S,n){var e,i,r,o,a,u,T,s,c,A,I,f,l,h,x,N,e,B,L,k,F,d,v,D,n,t,m,m,m,t,_,E,l,l,g,p,b,s,e=t.variance,i=t.reference,r=t.mini,o=t.maxi,a=t.mark,u=t.tickUnit,T=t.legend,s=t.colorPositive,c=t.colorNegative,A=t.vertical,B=.5,L=.25,F=5,d=ht,v=bt,D=13*n.zoomFactor,n=ft(e);if(!(ct(n)||(c=it(c)?J:c,s=it(s)?Y:s,u=it(u)?0:u,o=it(o)?1:o,r=it(r)?-1:r,(e=!it(i))||(i=0),h=A?(I=M+S-5,f=S-10,l=C-20,-1):(I=w+5,f=C-10,l=S-20,1),T&&(t=ft(t.variance),ct(t)||(m=(m=t.toString()).substr(m.indexOf(".")+1).length,x=2<=m?(100*t).toFixed(m-2)+"%":(100*t).toFixed(0)+"%")),o<n&&(n=o,k=!0),n<r&&(n=r,k=!0),i=Zt(i,o,r),k&&(N=Zt(l,60,15)),t=f/(m=ut(o-r)),_=I+h*ut(r-i)*t,(E=ut(n-i)*t)>ut(m)*t&&(E=ut(m+r)*t),l=I+h*f,A&&_<l)||!A&&l<_)){if(pt(y,w,M,C,S),i<n?j(s,0,5-f,f-5,0,1,M-_,q,X,_-w-C,P,G,-1,ut(o-n)*t):(E>ut(m)*t&&(E=ut(m+r)*t,_=I),j(c,1,-5,5,2,3,_-M-S,X,q,w-_,G,P,1,ut(r-n)*t)),e&&(l=I+h*(Math.abs(r-i)*t),R(w,l,w+C,l,l,M,l,M+S)),0<u)for(y.beginPath(),g=m/u,p=0;p<=g;p++)R(w,b=I+f/g*p*h,w+.1*C,b,b,M+.9*S,b,M+S,v,v);!it(a)&&r<=a&&a<=o&&(y.beginPath(),s=I-(A?1:-1)*ut(r-a)*t,R(w,s,w+.33*C,s,s,M+.66*S,s,M+S,d,d),y.fill()),y.restore()}function j(t,n,e,i,r,o,a,u,s,c,f,l,h,d){var v,m,g,p,b,n;A?gt(y,v=w+.25*C,m=0===n?_-E:_,g=.5*C,p=E,t):gt(y,v=0===n?_:_-E,m=M+.25*S,g=E,p=.5*S,t),k&&(pt(y,v,m,g,p),A?vn(y,w+C/2,I+e,N,r):vn(y,I+i,M+S/2,N,o),y.restore()),T&&(b=void 0,n=0,k&&(n=.4*N*H(3)/2+5+2),y.save(),y.beginPath(),y.font=D+tt,y.fillStyle=W,A?(y.textAlign=K,O(b=D+E+a,d,t,u,s,v,m,g,p,A),y.fillText(x,w+C/2,_+h*(E-n))):(y.textBaseline=$,O(b=y.measureText(x).width+E+c,d,t,f,l,v,m,g,p,A),y.fillText(x,_+h*(n-E),M+S/2)),y.restore())}function O(t,n,e,i,r,o,a,u,s,c){c?y.textBaseline=i:y.textAlign=i,0<t&&n<E&&(y.rect(o,a,u,s),y.clip(),c?y.textBaseline=r:y.textAlign=r,y.fillStyle=Ht(e))}function R(t,n,e,i,r,o,a,u,s,c){A?dn(y,t,n,e,i,s):dn(y,r,o,a,u,c)}}function yn(c,t,B,L,F,n){var e,i,P,r,o,a,u,s,f,l,G,h,d,v,m,r,o,a,u,g,p,b,y,w,U,B,L,F,n,H,M,C,S,z,V,Y,Z,T,A,I,x,N,k,D,W,Q,_,E,_,E,_,J,r,o,u,K,X,q,j,r,o,O,R,$,u,t,t,tt,e=t.points,i=t.boxPlotClass,P=t.showAverage,r=t.scaleStart,o=t.scaleEnd,a=t.acceptableStart,u=t.acceptableEnd,s=t.style,f=t.colorScheme,l=t.vertical,G=5,h=Pt(e,!1),d=Pt(e,!0);if(!(it(e)||(e=Yt(e)).length<=0)){for((i=i===rt||typeof i!==st?Et:i.toLocaleLowerCase())!==Et&&i!==_t&&i!==jt&&i!==Ot&&i!==Rt&&(i=Et),v=ft(r),v=ct(v)?d:v,m=ft(o),m=ct(m)?h:m,r=ft(a),o=ft(u),f!==rt&&typeof f===st||(f="#D2D2D2"),(s===rt||0!==s&&1!==s)&&(s=0),a=ht,d<v&&(f=a,v=d),m<h&&(f=a,m=h),pt(c,B,L,F,n),c.lineWidth=2,g=(u=mt(B,L,F,n,5,n-10,l)).left,p=u.width,b=u.top,y=u.height,w=l?-1:1,U=t.perc02,B=t.perc09,L=t.perc10,F=t.perc90,n=t.perc91,H=t.perc98,M=t.q1,z=d,V=h,Z=Y=1.5*(S=(C=t.q3)-M),T=t.stDev,A=zt(e)/at(1,e.length),x=I=0,N=b+.1*y,k=.7*y,D=ut(m-v),W=0,Q=e.length;W<Q;W++)(_=e[W])<M&&M-1.5*S<=_&&_-(M-1.5*S)<Y&&(Y=_-(M-1.5*S),z=_),C<_&&_<=C+1.5*S&&C+1.5*S-_<Z&&(Z=C+1.5*S-_,V=_),E=!1,I=g+p*((_-v)/D)*w,i===jt&&(_<=M-1.5*S||C+1.5*S<=_)&&(E=!0,x=_<=M-3*S||C+3*S<=_?0:1),i===_t&&(_<=U||H<=_)&&(E=!0,x=1),i===Rt&&(_<=A-2*T||A+2*T<=_)&&(E=!0,x=_<=A-3*T||A+3*T<=_?0:1),_=bt,E&&(1===s?1===x?et(.2,.8,I,_):et(.3,.7,I,_):((E=.1*y)<2&&(E=2),c.beginPath(),c.strokeStyle=_,_=b+.45*y,J=I,c.arc(l?_:J,l?J:_,E/2,0,2*Math.PI),c.stroke()));switch((r<v||m<o)&&(f="#C0FF00"),r=at(v,r),(o=ot(m,o))<r?f=a:r<o&&vt(c,l,u=b+.9*y,r=g+p*((r-v)/D)*w,u,o=g+p*((o-v)/D)*w,r,u,o,u,yt),X=ut(g+p*((C-v)/D)*w-(K=g+p*((M-v)/D)*w)),j=g+p*(((q=t.median)-v)/D)*w,i){case _t:O=U,R=H;break;case jt:O=z,R=V;break;case Rt:X=ut(g+p*((A+T-v)/D)*w-(K=g+p*((A-T-v)/D)*w)),j=g+p*((A-v)/D)*w,O=v<($=A-2*T)?$:d,R=($=A+2*T)<m?$:h,P=!1;break;default:O=d,R=h}r=g+p*((O-v)/D)*w,o=g+p*((R-v)/D)*w,u=bt,1===s?nt("#F2F2F2",N,o,k,r-o,r,N,o-r,k):vt(c,l,t=b+.45*y,r,t,o,r,t,o,t,u),nt(f,N,K-X,k,X,K,N,X,k),vt(c,l,N,j,N+k,j,j,N,j,N+k,u),0===s&&(vt(c,l,N+.3*k,o,N+.7*k,o,o,N+.3*k,o,N+.7*k,u),vt(c,l,N+.3*k,r,N+.7*k,r,r,N+.3*k,r,N+.7*k,u)),i!==_t&&i!==Ot||(tt=t=void 0,R=i===_t?(O=B,n):(O=L,F),t=g+p*((O-v)/D)*w,et(.3,.7,tt=g+p*((R-v)/D)*w,u),et(.3,.7,t,u)),P&&et(.2,.8,I=g+p*((A-v)/D)*w,a),c.restore()}function nt(t,n,e,i,r,o,a,u,s){l?gt(c,n,e,i,r,t):gt(c,o,a,u,s,t)}function et(t,n,e,i){vt(c,l,N+k*t,e,N+k*n,e,e,N+k*t,e,N+k*n,i)}}function wn(t,n,e,i,r){n=et(n),e=et(e),n===(i=et(i))&&(n=i-=.5),e===(r=et(r))&&(e=r-=.5),t.moveTo(n,e),t.lineTo(i,r)}function Q(t,n,e,i,r,o,a,u,s,c,f){t.beginPath(),t.strokeStyle=e,n?wn(t,i,r,o,a):wn(t,u,s,c,f),t.stroke()}function Mn(t,n,e,i,r){t.rect(n,e,i,r),t.clip()}function Cn(t,n,e,i,r,o){var a,u,s,c,f,l,h,d,v,m,g,p,b,o,a=o.labelText,u=o.fontSize,s=o.startBox,c=o.endBox,f=o.boxColor,l=o.isInRightOrTopOfBox,h=o.fillStyle;t.save(),t.beginPath(),t.font=u+tt,g=1,h=it(h)?W:h,o.vertical?(p=K,l?0<(d=u+c-(s-e))&&s-c-e<c?(b=X,h=Ht(f),m=s-c+1,Mn(t,n,s-c,i,c)):(b=q,m=s-c-1):m=0<(d=u-(e+r-s))&&e+r-s<c?(Mn(t,n,s-c,i,c),b=q,h=Ht(f),s-1):(b=X,s+1),t.textAlign=p,t.textBaseline=b,t.fillStyle=h,t.fillText(a,n+i/2,m)):(b=$,o=t.measureText(a),l?v=0<(d=o.width+c-(n+i-s))&&n+i-(s+c)<c?(Mn(t,s,e,c,r),p=G,h=Ht(f),s+c-1):(p=P,s+c+1):0<(d=o.width-(s-n))&&s-n<c?(Mn(t,s,e,c,r),v=s+1,p=P,h=Ht(f)):(p=G,v=s-1),t.textAlign=p,t.textBaseline=b,t.fillStyle=h,t.fillText(a,v,e+r/2)),t.restore()}function Sn(t,n,e,i,r,o,B){var a,u,L,s,c,f,l,h,F,n,P,B,d,v,L,f,l,G,m,g,p,b,y,w,M,C,S,T,U,A,H,I,x,z,N,V,k,D,s,c,c,s,_,E,c,j,Y,_,D,k,O,j,D,N,R,O,R,n,O,a=n.points,u=n.labels,L=n.pointIndex,s=n.minimum,c=n.maximum,f=n.colorPositive,l=n.colorNegative,h=n.vertical,F=n.itemTypeRange,n=n.colorTotal,P=5,B=13*B.zoomFactor;if(!it(a)&&!((d=a.length)<=0||(v=parseInt(L,10),ct(v))||v<=0||d<v)){for(u=it(u)?[]:u,l!==rt&&typeof l===st||(l="#D6604D"),typeof n!==st&&(n=rt),f=Z(L=f=f!==rt&&typeof f===st?f:"#8CBF64",1.3),G=Z(l=l,1.3),m=1,w=[],T=C=M=y=b=p=g=0,U=d;T<U;T++)C=a[T],S=F[T],A=!1,H=1===m,(I=!it(S))&&(S===Mt?C=ut(C):S===wt?C=-ut(C):S===Ct?(A=!0,H?g=C:C=g):I=!1),w[m]=[],x=w[m],ct(C)?(x[0]=0,x[1]=g,x[2]=0):(x[0]=ut(C),g=A?g:C+g,x[1]=0<C?p:g,x[2]=C),x[3]=m,b=ot(p,b),y=at(p,y),((z=m===d)&&!I||A)&&(M=b<0?-b:0,x[1]=0<C?0:C),I&&A&&!H||(p=C+p,z&&I&&(b=ot(p,b),y=at(p,y))),m++;N=!1,it(S)||(N=-1===(V=[wt,Mt,Ct]).indexOf(S)),(it(S)||N)&&(g-=C),s=ft(s),ct(s)||0<s||b<s?s=k=b:M=-(k=s),c=ft(c),ct(c)||c<0||c<y?D=y:(D=c,M=-s),s=(c=mt(e,i,r,o,5,o-10,h)).left,_=c.width,E=c.top,c=c.height,j=h?-1:1,_=_/(Y=D-k),pt(t,e,i,r,o),t.beginPath(),t.lineWidth=1,k=(D=w[v])[2],O=F[v-1],j=s+j*(D[1]+M)*_,D=D[0]*_,R=O===Ct,O=(it(O)||N)&&v===d||R,N=n&&O?n:1===v||O?0<=k?L:l:0<=k?f:G,h?gt(t,E,j-D,c,D,N):gt(t,j,E,D,c,N),h?(1!==v&&(v!==d?Q(t,0<k,dt,e,j,E+c,j,e,j-D,E+c,j-D):Q(t,!0,dt,e,R=s-(g+M)*_,E+c,R)),v!==d&&Q(t,0<k,dt,E,j-D,e+r,j-D,E,j,e+r,j)):(1!==v&&(v!==d?Q(t,0<k,dt,j,i,j,E+c,j+D,i,j+D,E+c):Q(t,!0,dt,n=s+(g+M)*_,i,n,E+c)),v!==d&&Q(t,0<k,dt,j+D,E,j+D,i+o,j,E,j,i+o)),O=u[v-1],0<u.length&&!it(O)&&""!==O&&Cn(t,e,i,r,o,{labelText:O,vertical:h,isInRightOrTopOfBox:0<k,fontSize:B,startBox:j,endBox:D,boxColor:N}),Q(t,h,W,e,s-M*_,e+r,s-M*_,s+M*_,i,s+M*_,i+o),t.restore()}}function Tn(e,t,i,r,o,a,n){var u,s,c,f,l,h,d,v,n,m,g,p,t,b,y,s,w,M,C,S,T,A,I,b,B,d,x,N,t,b,k,d,D,_,E,j,h,O,c,R,u=t.points,s=t.pointIndex,c=t.colorRange,f=t.target,l=t.target2,h=t.highlightPosition,d=t.label,v=t.vertical,n=13*n.zoomFactor,m=t.targetColor,g=t.target2Color,p=t.labelColor,t=t.barSize;if(!it(u)&&(it(t)||!(ct(t)||t<=0))&&(1<t&&(t=1),!((b=u.length)<=0||(y=parseInt(s,10),ct(y))||y<=0||b<y))){for(c=it(c)?[]:c,s=parseInt(d,10),s=ct(s)?0:s,w=1,C=[],S=M=0,T=u.length;S<T;S++)A=u[S],C[w]=[],I=C[w],A<0||ct(A)||it(A)?(I[0]=1===w?0:M,I[1]=0):(M+=A,I[0]=1===w?0:M-A,I[1]=A),w++;B=5,b=it(t)?5:v?o*(1-t)/2:a*(1-t)/2,d=mt(i,r,o,a,b,a-10,v,5),x=d.left,N=d.width,t=d.top,b=d.height,k=v?-1:1,d=N/M,pt(e,i,r,o,a),e.beginPath(),e.lineWidth=1,_=(D=C[y])[1],E=x+k*D[0]*d,j=D[1]*d,h=y===h?ht:0===c.length||typeof c[y-1]!==st?bt:c[y-1],v?gt(e,t,E-j,b,j,h):gt(e,E,t,j,b,h),1===s?O=(D[0]+_)/M*1e3:2===s&&(O=_/M*1e3),c=et(O)/10+"%",1!==s&&2!==s||!c||Cn(e,i,r,o,a,{labelText:c,vertical:v,isInRightOrTopOfBox:(D[0]+D[1])*d<N/2,fontSize:n,startBox:E,endBox:j,boxColor:h,fillStyle:p}),R=[it(m)?"#8CBF64":m,it(g)?"#EE5D5D":g],[f,l].forEach(function(t,n){var t,t,t=L(t),t=z(x+k*N*t);Q(e,v,R[n],i,t,i+o,t,t,r,t,r+a)}),e.restore()}function L(t){var t=ft(t),t;return t=1<(t=(t=ct(t)?0:t)<0?0:t)?1:t}}function An(t,n){switch(n){case 2:var e;return t%4==0&&t%100!=0||t%400==0?29:28;case 4:case 6:case 9:case 11:return 30;default:return 31}}function In(t,n,e){var n,e,i,r,o,n;return 1<(t=t<0?0:t)&&(t=1),n=v(n),e=v(e),i=n.a*(1-t)+e.a*t,r=n.r*(1-t)+e.r*t+"",o=n.g*(1-t)+e.g*t+"",n=n.b*(1-t)+e.b*t+"","rgba("+parseInt(r,10)+","+parseInt(o,10)+","+parseInt(n,10)+","+ft(i/255+"")+")"}function xn(t,n,e){return t===n&&t===e?1:t<=n?0:e<=t?1:(t-n)/(e-n)}function Nn(t,n,e,i,r,o){var a=(o+r)/2;return r<=i&&i<=a?In(xn(i,r,a),t,n):In(xn(i,a,o),n,e)}function kn(t){var n=lt,e=-lt;return t.forEach(function(t){t!==rt&&t!==F&&(t<n&&(n=t),e<t)&&(e=t)}),{min:n,max:e}}function Dn(t,e,i,r,o,a,u){var n,s,c;r?t.forEach(function(t,n){0!==t&&t!==rt&&t!==F&&(e[i+n]=r[n]||e[i+n])}):(n=kn(t),s=n.min,c=n.max,t.forEach(function(t,n){0!==t&&t!==rt&&t!==F&&(e[i+n]=Nn(o,a,u,t,s,c))}))}function _n(t,n,e,i,r,o){for(var a,u,s,c,f,l,h,d,v,m,g,p,b,y,w,M,C,S,T,a=n.year,u=n.month,s=n.values,c=n.emptyColor||"lightgray",f=n.startColor,l=n.middleColor,h=n.endColor,d="white",v=6,m=7,g=2,p=(r-14)/6,b=(o-16)/7,y=[],w=new Date(a,u-1,1).getDay(),M=0;M<42;M++)!(M<w)&&M<w+An(a,u)?y[M]=c:y[M]=d;for(Dn(s,y,w,n.colors,f,l,h),t.save(),t.rect(e,i,r,o),t.clip(),t.beginPath(),S=C=0;S<6;S++)for(T=0;T<7;T++)t.fillStyle=y[C],C++,t.fillRect(e+S*p+2*(S+1),i+T*b+2*(T+1),p,b);t.restore()}function En(t){for(var n,e,i,r,n=t.getFullYear(),e=t.getMonth(),i=t.getDate(),r=1;r<e+1;r++)i+=An(n,r);return i}function jn(t,n,e,i,r,o,a){for(var u,s,c,f,l,h,d,B,v,m,g,p,b,s,n,y,w,f,l,L,M,C,S,T,A,I,x,N,k,D,_,E,j,j,O,R,u=n.year,s=n.values,c=n.emptyColor||"lightgray",f=n.startColor,l=n.middleColor,h=n.endColor,d="white",B=7,v=parseInt(366/7+"",10)+2,m=[],g=new Date(u,0,1).getDay(),p=En(new Date(u,11,31)),b=0;b<7*v;b++)m[b]=!(b<g)&&b<g+p?c:d;for(Dn(s,m,g,n.colors,f,l,h),t.save(),t.rect(e,i,r,o),t.clip(),y=e+(n=15*(s=a.zoomFactor)),w=i,f=r-n,l=o,t.save(),t.translate(e+n/2,w+l),t.rotate(-Math.PI/2),t.font=13*s+tt,t.fillStyle="black",t.textBaseline="middle",t.textAlign="center",t.fillText(u+"",l/2,0),t.restore(),M=(f-(L=2)*(v+1))/v,C=(l-16)/7,x=[],A=S=0;A<v;A++)for(T=0;T<7;T++)x[S]=I={x:y+A*M+2*(A+1),y:w+T*C+2*(T+1),w:M,h:C},t.fillStyle=m[S],S++,t.fillRect(I.x,I.y,I.w,I.h);for(N=[],k={},D=0;D<12;D++)k[D]=En(new Date(u,D,1))-1+g;for(_=k[11]+An(u,12)-1,A=S=0;A<v;A++)for(T=0;T<7;T++)g<=S&&S<g+p&&(j=(E=new Date(u,0,S-g+1)).getMonth(),I=x[S],(j=k[j])<=S&&S<7+j&&N.push({x1:I.x,y1:I.y-1,x2:I.x,y2:I.y+I.h+1}),S!==j&&0!==E.getDay()||N.push({x1:I.x-1,y1:I.y,x2:I.x+I.w+1+(S===j?2:0),y2:I.y}),_-7<S&&S<=_&&N.push({x1:I.x+I.w,y1:I.y-1,x2:I.x+I.w,y2:I.y+I.h+1}),S!==_&&6!==E.getDay()||N.push({x1:I.x-1-(S===_?2:0),y1:I.y+I.h,x2:I.x+I.w+1,y2:I.y+I.h})),S++;for(t.strokeStyle="black",t.lineWidth=2,O=0;O<N.length;O++)R=N[O],t.beginPath(),t.moveTo(R.x1,R.y1),t.lineTo(R.x2,R.y2),t.stroke();t.restore()}function On(t){var n,e,i,r,o,a,u,s,c,f,n=Vt(t.minAngle-90),e=Vt(t.maxAngle-90),i=t.minValueOption.value,r=t.maxValueOption.value,o=t.ranges,a=g,u=(e-n)/(r-i),s=[];return 0<o.length&&o.forEach(function(t){c=t.start,f=t.end,s.push({start:u*(c-i)+n,end:u*(f-i)+n,color:t.color})}),s.unshift({start:n,end:e,color:a}),{paintRanges:s,fillColor:a,targetValueRadian:u*(t.targetValueOption.value-i)+n,currentValueRadian:u*(t.currentValueOption.value-i)+n,minValueRadian:n,maxValueRadian:e}}function Rn(t,n,e,i,r,o,a){var o,u,s,c,f,l,o,h,f,d,v,m,g,p,l,b,a,o=o.zoomFactor,u=t.currentValueOption.normalFontHeight*o,s=t.minValueOption.normalFontHeight*o,c=t.maxValueOption.normalFontHeight*o,f=t.minAngle,l=t.maxAngle,o=t.currentValueOption.normalFontWidth*o,h=90<ut(f)||90<ut(l),f=120<ut(f)||120<ut(l),l=M*ot(i,r);return a?(d=O(i/2*w),v=O(r*w),a=.03*(g=ot(d,m=h?v/2:v)),p={x:n+i/2,y:e+r/2+(h?0:g/2),outerRadius:g,innerRadius:g*t.radiusRatio,currentValuePoint:F,enoughShowCurrentLabel:!1,enoughShowTargetLabel:!0,enoughShowMinLabel:s<(b=(r-(h?2*g:g))/2),enoughShowMaxLabel:c<b,moreThanSemiCircle:h},h?f?2*u/3<b-a-at(c,s)&&o<i-2*l&&(p.currentValuePoint={x:p.x,y:p.y+g+a+u/2+at(c,s)},p.enoughShowCurrentLabel=!0):2*u/3<r/2-a&&o<i-2*l&&(p.currentValuePoint={x:p.x,y:p.y+2*a+u},p.enoughShowCurrentLabel=!0):u<b-a&&o<i-2*l&&(p.currentValuePoint={x:p.x,y:p.y+u},p.enoughShowCurrentLabel=!0)):(d=O(i/2*y),v=O(r*y),g=ot(d,m=h?v/2:v),p={x:n+i/2,y:e+r/2+(h?0:g/2),outerRadius:g,innerRadius:g*t.radiusRatio}),p}function Bn(t,n,e,i){return{x:t+I(e)*i,y:n+_(e)*i}}function Ln(t,n){return ut(n.x-t.x)<.01?{x:n.x,y:n.y,textAlign:K}:n.x>t.x?{x:n.x+a,y:n.y,textAlign:P}:n.x<t.x?{x:n.x-a,y:n.y,textAlign:G}:{x:n.x,y:n.y,textAlign:P}}function Fn(n,t,e,i,r,o,a){var u,s,e,i,c,f,a,l,h,d,v,m,v,g,v,v,s,p,b,y,w,M,C,S,T,A,a,C,M,y,a,p,C,w,M,b,S,y,u=a.zoomFactor,s=!!it(t.showLabel)||t.showLabel,e=Rn(t,e,i,r,o,a,s);if(!(e.outerRadius<=0))return i={showTargetLabel:!1,showCurrentLabel:!1,showMinLabel:!1,showMaxLabel:!1},c=e.innerRadius,f=e.outerRadius,a=e.currentValuePoint,l=e.moreThanSemiCircle,h={x:e.x,y:e.y},v=(d=On(t)).paintRanges,m=d.fillColor,n.save(),v.forEach(function(t){n.beginPath(),n.strokeStyle=x,n.moveTo(h.x,h.y),n.fillStyle=t.color||m,n.arc(h.x,h.y,f,t.start,t.end,!1),n.lineTo(h.x,h.y),n.closePath(),n.fill(),n.stroke(),n.beginPath(),n.fillStyle=x,n.strokeStyle=x,n.moveTo(h.x,h.y),n.arc(h.x,h.y,c,t.start-Nt,t.end+Nt,!1),n.lineTo(h.x,h.y),n.closePath(),n.fill(),n.stroke()}),n.beginPath(),n.moveTo(h.x,h.y),n.fillStyle=W,n.arc(h.x,h.y,f*R,0,2*nt,!1),n.fill(),v=Bn(h.x,h.y,d.targetValueRadian,c),g=Bn(h.x,h.y,d.targetValueRadian,f*k),Ut(n,v.x,v.y,g.x,g.y,Tt,At,N),v=Bn(h.x,h.y,d.currentValueRadian,f*k),U(n,h.x,h.y,v.x,v.y,W,L*f),s&&(n.save(),n.beginPath(),n.textAlign=j,n.fillStyle=N,v=t.minValueOption.normalFontHeight*u,s=t.maxValueOption.normalFontHeight*u,p=t.minValueOption.normalFontWidth*u,b=t.maxValueOption.normalFontWidth*u,y=d.minValueRadian,w=d.maxValueRadian,M=t.currentValueOption.normalFontHeight*u,C=t.currentValueOption.normalFontWidth*u,A=T=S=void 0,e.enoughShowCurrentLabel&&(D(n,a.x,a.y,t.currentValueOption.label,t.currentValueOption.fontAfterZoom,K),i.showCurrentLabel=!0,S={x:a.x-C/2,y:a.y-M,width:C,height:M}),e.enoughShowMinLabel&&ut(I(y)*f)+p<r/2-xt&&(a=Bn(h.x,h.y,d.minValueRadian,f),Wt(T={x:(C=Ln(h,a)).x-p,y:C.y,width:p,height:v},S)||(D(n,C.x,C.y+O(v),t.minValueOption.label,t.minValueOption.fontAfterZoom,G),i.showMinLabel=!0)),e.enoughShowMaxLabel&&ut(I(w)*f)+b<r/2-xt&&(M=Bn(h.x,h.y,d.maxValueRadian,f),Wt(A={x:(y=Ln(h,M)).x,y:y.y,width:b,height:s},S)||(D(n,y.x,y.y+O(s),t.maxValueOption.label,t.maxValueOption.fontAfterZoom,P),i.showMaxLabel=!0)),e.enoughShowTargetLabel&&(a=t.targetValueOption.normalFontWidth*u,p=t.targetValueOption.normalFontHeight*u,C=t.targetValueOption.label,g=Bn(h.x,h.y,d.targetValueRadian,w=f+3*p/2),M=Ln(h,g),b=d.targetValueRadian,S=l?(o-2*w)/2+w:o-(o-f)/2,ut(I(b)*w)+a<r/2-xt)&&ut(_(b)*w)+p/2+xt/2<S&&(y=at(v,s)/2,D(n,M.x,M.y-(nt<b?y:-y),C,t.targetValueOption.fontAfterZoom,M.textAlign),i.showTargetLabel=!0),n.restore()),n.restore(),i}function Pn(t,n,e,i,r,o){var o,a,u,s,c,f,l,h,d,t,v,m,o,n,o=o.zoomFactor,a=t.showLabel,u=t.minValueOption.normalFontHeight*o,s=t.maxValueOption.normalFontHeight*o,c=t.targetValueOption.normalFontHeight*o,f=t.currentValueOption.normalFontHeight*o,l=t.minValueOption.normalFontWidth*o,h=t.maxValueOption.normalFontWidth*o,d=t.targetValueOption.normalFontWidth*o,t=t.currentValueOption.normalFontWidth*o,o=.05*i,v=O(r*p),m=O(i*b),n={x:n+i*(1-b)/2,y:e+r*(p+(1-p)/2),graphWidth:m,graphHeight:v,targetValuePoint:F,currentValuePoint:F,minValuePoint:F,maxValuePoint:F};return a&&(u<(r-v)/2&&l<(i-m)/2-o&&(n.minValuePoint={x:n.x-l,y:n.y+u/3},n.enoughShowMinLabel=!0),s<(r-v)/2&&h<(i-m)/2-o&&(n.maxValuePoint={x:n.x-h,y:n.y-v+s/3},n.enoughShowMaxLabel=!0),(c<(r-v)/2||c/2<v)&&d<(i-m)/2-o-at(l,h)&&(n.targetValuePoint={x:n.x-d-at(l,h),y:F},n.enoughShowTargetLabel=!0),f<(r-v)/2||f/2<v)&&t<(i-m)/2-o&&(n.currentValuePoint={x:n.x+m+o,y:F},n.enoughShowCurrentLabel=!0),n}function Gn(t,n){var e,i,r,o,a,u,s,c,e=t.minValueOption.value,i=t.maxValueOption.value,r=t.ranges,o=g,a=n.graphHeight/(i-e),u=[];return 0<r.length&&r.forEach(function(t){s=t.start,c=t.end,u.push({start:n.y-a*(s-e),height:a*(c-s),color:t.color})}),u.unshift({start:n.y,height:n.graphHeight,color:o}),{paintRanges:u,fillColor:o,targetValueY:n.y-a*(t.targetValueOption.value-e),currentValueY:n.y-a*(t.currentValueOption.value-e)}}function Un(n,t,e,i,r,o,a){var u,s,c,f,l,h,e,d,r,a,v,m,g,p,b,t,y,w,M,C,S,u=a.zoomFactor,s=t.showLabel,c=t.minValueOption,f=t.maxValueOption,l=t.currentValueOption,h=t.targetValueOption,e=Pn(t,e,i,r,o,a),d=e.graphWidth,r=e.graphHeight;if(!(d<=0||r<=0))return a={showTargetLabel:!1,showCurrentLabel:!1,showMinLabel:!1,showMaxLabel:!1},v=e.currentValuePoint,m=e.targetValuePoint,g=e.minValuePoint,p=e.maxValuePoint,b={x:e.x,y:e.y},y=(t=Gn(t,e)).paintRanges,w=l.normalFontHeight*u,M=h.normalFontHeight*u,C=t.targetValueY,S=t.currentValueY,n.save(),y.forEach(function(t){gt(n,b.x,t.start,d,-t.height,t.color)}),Ut(n,b.x-(k-1)*d,C,b.x+d,C,Tt,At,N),U(n,b.x,S,b.x+d*k,S,W,St*r),s&&(n.save(),n.beginPath(),e.enoughShowMinLabel&&(D(n,g.x,g.y,c.label,c.fontAfterZoom,P,N),a.showMinLabel=!0),e.enoughShowMaxLabel&&(D(n,p.x,p.y,f.label,f.fontAfterZoom,P,N),a.showMaxLabel=!0),e.enoughShowTargetLabel&&!(o<C-i+M/2||C-i-It<0)&&(D(n,m.x,t.targetValueY+h.normalFontHeight*u/3,h.label,h.fontAfterZoom,P,N),a.showTargetLabel=!0),e.enoughShowCurrentLabel&&!(o<S-i+w/2||S-i-It<0)&&(D(n,v.x,t.currentValueY+l.normalFontHeight*u/3,l.label,l.fontAfterZoom,P,N),a.showCurrentLabel=!0),n.restore()),n.restore(),a}function Hn(t,n,e,i,r,o){var o,a,u,s,c,f,l,h,d,t,v,m,o,n,o=o.zoomFactor,a=t.showLabel,u=t.minValueOption.normalFontHeight*o,s=t.maxValueOption.normalFontHeight*o,c=t.targetValueOption.normalFontHeight*o,f=t.currentValueOption.normalFontHeight*o,l=t.minValueOption.normalFontWidth*o,h=t.maxValueOption.normalFontWidth*o,d=t.currentValueOption.normalFontWidth*o,t=t.targetValueOption.normalFontWidth*o,o=.1*ot(i,r),v=O(r*b),m=O(i*p),n={x:n+i*(1-p)/2,y:e+r*(1-b)/2,graphWidth:m,graphHeight:v,targetValuePoint:F,currentValuePoint:F,minValuePoint:F,maxValuePoint:F};return a&&((d<3*(i-m)/4||d<m)&&f<(r-v)/2-xt&&(n.currentValuePoint={x:F,y:n.y-f/2},n.enoughShowCurrentLabel=!0),(t<3*(i-m)/4||t<m)&&c<(r-v)/2-at(u,s)&&(n.targetValuePoint={x:F,y:n.y+v+at(u,s)+c/4*3},n.enoughShowTargetLabel=!0),l<3*(i-m)/4&&u<(r-v)/2-o&&(n.minValuePoint={x:n.x-l/2,y:n.y+v+u},n.enoughShowMinLabel=!0),h<3*(i-m)/4)&&s<(r-v)/2-o&&(n.maxValuePoint={x:n.x+m-h/2,y:n.y+v+s},n.enoughShowMaxLabel=!0),n}function zn(t,n){var e,i,r,o,a,u,s,c,e=t.minValueOption.value,i=t.maxValueOption.value,r=t.ranges,o=g,a=n.graphWidth/(i-e),u=[];return 0<r.length&&r.forEach(function(t){s=t.start,c=t.end,u.push({start:n.x+a*(s-e),width:a*(c-s),color:t.color||o})}),u.unshift({start:n.x,width:n.graphWidth,color:o}),{paintRanges:u,fillColor:o,targetValueX:n.x+a*(t.targetValueOption.value-e),currentValueX:n.x+a*(t.currentValueOption.value-e)}}function Vn(n,t,e,i,r,o,a){var u,s,c,f,l,h,i,o,d,a,v,m,g,p,b,t,y,w,M,C,t,u=a.zoomFactor,s=t.showLabel,c=t.minValueOption,f=t.maxValueOption,l=t.currentValueOption,h=t.targetValueOption,i=Hn(t,e,i,r,o,a),o=i.graphWidth,d=i.graphHeight;if(!(o<=0||d<=0))return a={showTargetLabel:!1,showCurrentLabel:!1,showMinLabel:!1,showMaxLabel:!1},v=i.currentValuePoint,m=i.targetValuePoint,g=i.minValuePoint,p=i.maxValuePoint,b={x:i.x,y:i.y},y=(t=zn(t,i)).paintRanges,w=l.normalFontWidth*u,M=h.normalFontWidth*u,C=t.targetValueX,t=t.currentValueX,n.save(),y.forEach(function(t){gt(n,t.start,b.y,t.width,d,t.color)}),Ut(n,C,b.y,C,b.y+d*k,Tt,At,N),Gt(n,t,b.y+d-1,t,b.y-d*(k-1)-1,W,o*St),s&&(n.save(),i.enoughShowMinLabel&&(D(n,g.x,g.y,c.label,c.fontAfterZoom,P,N),a.showMinLabel=!0),i.enoughShowMaxLabel&&(D(n,p.x,p.y,f.label,f.fontAfterZoom,P,N),a.showMaxLabel=!0),i.enoughShowTargetLabel&&!(r<C-e+M/2+S||C-e-M/2-S<0)&&(D(n,C-h.normalFontWidth*u/2,m.y,h.label,h.fontAfterZoom,P,N),a.showTargetLabel=!0),i.enoughShowCurrentLabel&&!(r<t-e+w/2+S||t-e-w/2-S<0)&&(D(n,t-l.normalFontWidth*u/2,v.y,l.label,l.fontAfterZoom,P,N),a.showCurrentLabel=!0),n.restore()),n.restore(),a}function Yn(t,n,e,i,r,o,a){t.save(),t.rect(e,i,r,o),t.clip(),0===n.gaugeType?Fn(t,n,e,i,r,o,a):1===n.gaugeType?Un(t,n,e,i,r,o,a):2===n.gaugeType&&Vn(t,n,e,i,r,o,a),t.restore()}function Zn(t,n,e,i,r,o,a,u){var s,c,f,a,l,h,d,v,m,g,s=[],c=t.length,f=0,a=a.fontPixelSize;if(o&&(f=a+3),0!==c){for(l=i/c,h=t[0].value,d=1;d<c;d++)h=Math.max(h,t[d].value);for(v=0;v<c;v++)g=t[v].value/h*(r-f),s.push({x:n+v*l+l*(1-u)/2,textX:n+v*l,y:(m=e+r-f)-(g=g<0?0:g),width:l*u,textWidth:l,height:g,axis:t[v].axis})}return s}function Wn(t,n,e,i){t.save(),t.fillStyle=e;for(var r=0;r<n.length;r++)t.fillRect(n[r].x,n[r].y,n[r].width,n[r].height);t.restore()}function Qn(t,n,e,i){var r,o,a,u,s;for(t.save(),r=e.fontPixelSize,o=qn(e),t.textAlign="center",t.fillStyle=i,a=0;a<n.length;a++)s=u=void 0,u=n[a].x+n[a].width/2,s=n[a].y+n[a].height+5+r,t.save(),t.font=o,t.beginPath(),t.rect(n[a].textX,n[a].y+n[a].height+1,n[a].textWidth,r+3),t.clip(),t.textBaseline="bottom",t.fillText(n[a].axis,u,s),t.restore();t.restore()}function Jn(t,n,e,i){var r,o,a,u,s,o;if("none"!==i){for(t.save(),t.lineWidth=1,t.strokeStyle=i,t.beginPath(),r=0;r<n.length;r++)a=(o=n[r]).x,u=o.y,s=o.width,0===(o=o.height)||0===s||(U(t,a,u,a+s,u),U(t,a,u+o,a+s,u+o),n[r-1]&&n[r-1].height>=o&&1===e||U(t,a,u,a,u+o),n[r+1]&&n[r+1].height>o&&1===e)||U(t,a+s,u,a+s,u+o);t.stroke(),t.closePath(),t.restore()}}function Kn(t,n,e,i,r){var o,a,u,s,c,f,o=!1;for(t.save(),t.font=r,u=(e-6)/(a=n.length),s=0,c=n;s<c.length;s++)if(f=c[s],t.measureText(f.axis).width>u){o=!0;break}return t.restore(),o}function Xn(t,n,e,i,r,o,a){var u,s,c,f,l,h,d,n,v,e,i,u=n.barColor,s=n.values,c=n.paintLabel,f=n.barWidth,l=n.labelFontStyle,h=n.afterZoomFontStyle,d=n.edgeColor,n=n.labelColor;it(l)||(o<3*(v=h.fontPixelSize)||Kn(t,s,r,o,qn(h)))&&(c=!1),Wn(t,i=Zn(s,e+3,i+3,r-6,o-6,c=c&&it(l)&&(e=Math.floor(12<=o/3?12:Math.floor(o/3)),h.fontPixelSize=e,h.fontSize=e+"px",Kn(t,s,r,o,qn(h)))?!1:c,h,f),u,d),Jn(t,i,f,d),c&&Qn(t,i,h,n)}function qn(t){return"".concat(t.fontStyle," ").concat(t.fontWeight," ").concat(t.fontSize," ").concat(t.fontFamily)}function $n(t,n,e,i,r,o,a){var e,i,r,o,u,s,c,f,n;t.save(),t.rect(e,i,r,o),t.clip(),e=n.clipX,i=n.clipY,r=n.clipWidth,o=n.clipHeight,u=n.paintX,s=n.paintY,c=n.paintWidth,f=n.paintHeight,n=n.img,0<r&&0<o&&0<c&&0<f&&t.drawImage(n,e,i,r,o,u,s,c,f),t.restore()}function te(t,n,e,i){this.X=t,this.Y=n,this.Width=e,this.Height=i,this.Left=this.X,this.Right=this.Left+this.Width,this.Top=this.Y,this.Bottom=this.Y+this.Height}function t(){this.Bzt=2,this.Lzt=o,this.Fzt=o,this.Pzt=lt,this.Gzt=-lt}i=this&&this.__extends||(s=function(t,n){return(s=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(t,n){t.__proto__=n}:function(t,n){for(var e in n)Object.prototype.hasOwnProperty.call(n,e)&&(t[e]=n[e])}))(t,n)},function(t,n){if("function"!=typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function e(){this.constructor=t}s(t,n),t.prototype=null===n?Object.create(n):(e.prototype=n.prototype,new e)}),Object.defineProperty(l,"__esModule",{value:!0}),l.SparklineExRenders=l.SparklineRender=l.Uzt=l.Hzt=l.zzt=l.oCt=void 0,r=e("./src/common/util/types.ts"),h=e("./src/common/util/colorhelper.ts"),d=e("./src/common/util/arrayhelper.ts"),it=r.lt.ht,Z=h.ft.YGt,v=h.ft._,m=d.Uf.hD,l.oCt={},rt=null,F=void 0,O=Math.floor,nt=Math.PI,_=Math.sin,I=Math.cos,ot=Math.min,at=Math.max,et=Math.round,E=Math.pow,H=Math.sqrt,ut=Math.abs,z=Math.ceil,B="undefined",st="string",ct=isNaN,ft=parseFloat,lt=Number.MAX_VALUE,o=new Date(""),bt="#969696",ht="#CB0000",yt="#646464",dt="#DCDCDC",x="white",W="black",V="blue",Y="green",N="grey",J="red",g="lightgrey",P="left",G="right",K="center",X="top",q="bottom",$="middle",j="start",tt="px Arial",wt="-",Mt="+",Ct="=",R=.05,L=.03,k=1.06,St=.02,Tt=4,a=At=5,S=3,It=10,xt=8,p=.8,b=.25,y=.9,w=.7,M=.1,Nt=1/45*nt,kt=Lt,i(Kt,c=T=Bt),Dt=Kt,_t="7ns",Et="5ns",jt="tukey",Ot="bowley",Rt="sigma3",l.zzt=Fn,l.Hzt=Un,l.Uzt=Vn,C=te,t.prototype.paint=function(t,n,e,i,r,o){var a,u,s,c,a=this;a.options=n,a.setting=n.settings,u=n.values,s=n.dateValues,c=n.zoomFactor,t.save(),t.rect(e,i,r,o),t.clip(),t.beginPath(),0===n.sparklineType&&a.c6(t,e,i,r,o,u,s,c),a.Vzt(t,e,i,r,o,u,s,c),a.Yzt(t,e,i,r,o,u,s,c),t.restore()},t.prototype.Zzt=function(t){return 0===this.options.sparklineType?3+this.Wzt(t)+1:3},t.prototype.Qzt=function(t,n){var e,i,r,o,a,a,u,s,c,f,e=this.Kzt;if(!e)if(e=this.Kzt=[],i=t.length,this.options.displayDateAxis){for(a=n.length,u=[],(u=0<(a=ot(i,a))?n.slice(0,a):u).sort(function(t,n){return t===n?0:(t=t===l.oCt?0:t)-(n=n===l.oCt?0:n)}),s=u.length,f=c=void 0,r=0;r<s;r++)if(typeof(c=u[r])!==B&&c!==rt){for(f=m(n,c);d.Uf.OS(e,f);)f=m(n,c,f+1);isNaN(c)||(o=t[f])!==F&&o!==rt&&isNaN(o)&&o!==l.oCt||e.push(f)}}else for(r=0;r<i;r++)typeof(o=t[r])!==B&&o!==rt&&isNaN(o)&&o!==l.oCt||e.push(r);return e},t.prototype.Sl=function(t,n){var n=n[t];return typeof n===B||n===rt?1===this.setting.options.displayEmptyCellsAs&&(n=0):n===l.oCt&&(n=0),n},t.prototype.c6=function(t,n,e,i,r,o,a,u){var s,c,f,l,h,d,v,m,g,p,b,g,y,w,M,C,S,T,s=this,c=s.Qzt(o,a),d=c.length-1;for(d<0&&(d=0),v=s.setting.options,m=s.linePos=[],w=v.displayEmptyCellsAs,f=0;f<d;f++)if(typeof(g=s.Sl(c[f],o))!==B&&g!==rt){if(typeof(p=s.Sl(c[b=f+1],o))===B||p===rt)if(1===w)p=0;else if(2===w)for(b=f+2;b<=d;b++)if(typeof(M=o[c[b]])!==B&&M!==rt){p=M;break}typeof p!==B&&p!==rt?(g=s.Jzt(c[f],{Width:i,Height:r},o,a,u),y=s.Jzt(c[b],{Width:i,Height:r},o,a,u),C=g.Width/2,l={X:g.X+C,Y:g.Y+C},h={X:y.X+C,Y:y.Y+C},m[f]={P1:l,P2:h}):f++}if(0<(S=m.length))for(t.strokeStyle=s.options.getColor(v.seriesColor),t.lineCap="round",t.lineWidth=s.Wzt(u),f=0;f<S;f++)(T=m[f])&&(t.beginPath(),l=T.P1,h=T.P2,t.moveTo(n+l.X,e+l.Y),t.lineTo(n+h.X,e+h.Y),t.stroke(),t.closePath())},t.prototype.Xzt=function(t,n,e){var i,r,o,a,u,e,s,c,f,l,n,i=this,r=i.options,o=i.setting.options,a=rt,u=i.Sl(t,n),e=i.Qzt(n,e),s=e.length,c=r.getColor.bind(i);return typeof u!==B&&u!==rt&&(i.Pzt!==lt&&i.Gzt!==-lt||i.qzt(n),u===i.Pzt&&o.showLow&&(a=c(o.lowMarkerColor)),typeof(a=u!==i.Gzt||!o.showHigh||typeof a!==B&&a!==rt?a:c(o.highMarkerColor))!==B&&a!==rt||(r.displayDateAxis?0===(f=m(e,t))&&o.showFirst&&(a=c(o.firstMarkerColor)):0===t&&o.showFirst&&(a=c(o.firstMarkerColor))),typeof a!==B&&a!==rt||(r.displayDateAxis?(l=m(e,t))===s-1&&o.showLast&&(a=c(o.lastMarkerColor)):t===s-1&&o.showLast&&(a=c(o.lastMarkerColor))),typeof(a=u<0&&o.showNegative&&(typeof a===B||a===rt)?c(o.negativeColor):a)!==B&&a!==rt||(0===(n=r.sparklineType)?o.showMarkers&&(a=c(o.markersColor)):1!==n&&2!==n||(a=c(o.seriesColor)))),a===F||a===rt?"Transparent":a},t.prototype.Vzt=function(t,n,e,i,r,o,a,u){for(var s,c,f,l,h,d,v,d,v,m,v,m,g,d,p,s=this,c={Width:i,Height:r},f=s.Qzt(o,a),l=f.length,h=s.options.sparklineType,p=0;p<l;p++)d=f[p],v=s.Xzt(d,o,a),d=s.Jzt(d,c,o,a,u),t.fillStyle!==v&&(t.fillStyle=v),0===h?(t.save(),v=n+d.X+d.Width/2,m=e+d.Y+d.Height/2,t.translate(v,m),t.rotate(45*nt/180),t.fillRect(0-d.Width/2,0-d.Height/2,d.Width,d.Height),t.restore()):(v=n+d.X+d.Width/4,v=O(v),m=e+d.Y,g=d.Width/2,d=d.Height,t.fillRect(v,m,g,d))},t.prototype.Yzt=function(t,n,e,i,r,o,a,u){var s,c,a,i,r,a,o,s,c,s=this,c=s.setting&&s.setting.options;c&&c.displayXAxis&&s.$zt(o,a)&&(a={Width:i,Height:r},i=s.Zzt(u),r=a.Width-s.Zzt(u),o=a=O(s.tVt(a,o,u))+.5,s=s.options.getColor(c.axisColor),(c=u)<1&&(c=1),t.strokeStyle!==s&&(t.strokeStyle=s),t.lineWidth!==c&&(t.lineWidth=c),t.beginPath(),t.moveTo(n+i,e+a),t.lineTo(n+r,e+o),t.stroke())},t.prototype.nVt=function(t){var n,t,n=this.eVt(t);return n===-lt||(t=this.iVt(t))===lt||n===t||n*t<=0},t.prototype.$zt=function(t,n){var e,i,r,o,a,u,e=this.nVt(t);if(2===this.options.sparklineType&&(r=(i=this.Qzt(t,n)).length,!e)&&0<r)for(u=0;u<r;u++)if(typeof(a=t[o=i[u]])!==B&&a!==rt)return!0;return e},t.prototype.rVt=function(t,n){var e=this.Lzt;return isNaN(e&&e.valueOf())&&this.oVt(t,n),this.Lzt},t.prototype.aVt=function(t,n){var e=this.Fzt;return isNaN(e&&e.valueOf())&&this.oVt(t,n),this.Fzt},t.prototype.oVt=function(t,n){for(var e,i,r,o,a,u,s,u,c,e=this,i=new Date(0,0,0),r=lt,o=e.Qzt(t,n),a=o.length,c=0;c<a;c++)s=n[u=o[c]],isNaN(s)||(u=e.Sl(u,t))!==rt&&typeof u===B||isNaN(u)||typeof s!==B&&s!==rt&&(i<s&&(i=s),s<r)&&(r=s);e.Fzt=i,e.Lzt=r},t.prototype.uVt=function(t,n,e,i){for(var r,o,a,u,s,c,f,l,h,d,v,m,g,n,r=this,o=r.rVt(n,e),a=r.aVt(n,e),u=[],l=r.Qzt(n,e),h=l.length,s=0;s<h;s++)(c=e[f=l[s]])&&!isNaN(c)&&u.push(c);if(u.sort(function(t,n){return t-n}),1<(d=u.length)&&o!==a){for(v=lt,g=void(m=0),s=1;s<d;s++)(c=(g=u[s])-u[s-1])<v&&0<c&&(v=c),m+=c;return n=(n=(t.Width-r.Zzt(i)-r.Zzt(i))*v/m/2)<2?2:n}return(t.Width-r.Zzt(i)-r.Zzt(i))/2},t.prototype.sVt=function(t,n,e,i){var r,n,r=this;return r.options.displayDateAxis?r.uVt(t,n,e,i):(n=r.Qzt(n,e).length,(t.Width-r.Zzt(i)-r.Zzt(i))/n)},t.prototype.cVt=function(t,n,e,i,r){var o,a,u,s,c,f,l,s,f,h,o=this,u=o.Zzt(r);return o.options.displayDateAxis?(a=o.sVt(t,e,i,r),(s=o.aVt(e,i))===(c=o.rVt(e,i))?u+a/2:(f=i[n])?(l=t.Width-u-o.Zzt(r),l-=a,s=s.valueOf()-c.valueOf(),u+O((f.valueOf()-c.valueOf())/s*l)):0):(a=o.sVt(t,e,i,r),f=m(o.Qzt(e,i),n),O(h=u+a*f))},t.prototype.fVt=function(t,n){var e,i,t,e=this,i=t.Width-e.Zzt(n)-e.Zzt(n);return i=at(i,0),t=t.Height-e.Zzt(n)-e.Zzt(n),{Width:i,Height:t=at(t,0)}},t.prototype.qzt=function(t){for(var n,e,i,r,n=this,e=t.length,r=0;r<e;r++)typeof(i=t[r])!==B&&i!==rt&&((i="number"!=typeof i?0:i)<n.Pzt&&(n.Pzt=i),i>n.Gzt)&&(n.Gzt=i)},t.prototype.eVt=function(t){var n,t,e,n=this;return n.Gzt!==-lt&&n.Gzt||n.qzt(t),0===(e=(t=n.setting.options).maxAxisType)?n.Gzt:1===e?t.groupMaxValue:2===e?t.manualMax:n.Gzt},t.prototype.iVt=function(t){var n,t,e,n=this;return n.Pzt!==lt&&n.Pzt||n.qzt(t),0===(e=(t=n.setting.options).minAxisType)?n.Pzt:1===e?t.groupMinValue:2===e?t.manualMin:void 0},t.prototype.lVt=function(t,n,e,i){var t=this.fVt(t,i),i=this.eVt(e),r=this.iVt(e),o=i-r,a,u;if(i===r){if(0===i)return 0;o=ut(i)}return(a=(a=e[n])||0)*(u=t.Height/o)},t.prototype.hVt=function(t,n,e,i){var r,o,a,o,o,r=this,o=r.options.sparklineType;if(0===o)return r.lVt(t,n,e,i);if(1!==o)return 2===o?typeof(a=e[n])===B||a===rt||0===a||isNaN(a)?0:(o=r.fVt(t,i),0<=a?o.Height/2:-o.Height/2):void 0;if(a=e[n],1===r.setting.options.displayEmptyCellsAs&&(typeof a===B||a===rt))return 0;if((o=r.lVt(t,n,e,i))>-r.Bzt&&o<r.Bzt){if(0<a)return o+r.Bzt;if(a<0)return o-r.Bzt}return o},t.prototype.dVt=function(t,n,e){var i,r,o,n,a,n,i=this,r=i.fVt(t,e),o=i.eVt(n),n=i.iVt(n);if(o===-lt||n===lt)return t.Height/2;if(a=o-n,o===n){if(0===o)return t.Height/2;(a=o)<0&&(o=0)}return n=r.Height/a,i.Zzt(e)+o*n},t.prototype.tVt=function(t,n,e){return 2===this.options.sparklineType?t.Height/2:this.dVt(t,n,e)},t.prototype.vVt=function(t,n,e,i){var r,t,i,o,a,t,a,u,r=this,t=r.fVt(t,i),i=r.eVt(e),o=r.iVt(e),a=i-o;if(i===o){if(0===i)return 0;a=i}return t=t.Height/a,typeof(a=r.Sl(n,e))!==B&&a!==rt||(a=0),i!==o&&0<i*o?(u=0)<=a?(a-o)*t:(a-i)*t:a*t},t.prototype.mVt=function(t,n,e,i){var r,o,a,u,s,r=this,o=r.options.sparklineType;return 0===o?r.vVt(t,n,e,i):1===o?(a=r.vVt(t,n,e,i),-(u=r.Bzt)<a&&a<u&&0!==(s=typeof(s=r.Sl(n,e))!==B&&s!==rt?s:0)?0<s?a+u:a-u:a):2===o?r.hVt(t,n,e,i):void 0},t.prototype.gVt=function(t,n,e,i,r){var o,a,i,u,s,c,f,c,f,s,t,e,o=this,a=o.sVt(n,e,i,r),i=o.cVt(n,t,e,i,r);return(a=O(a=a<0?0:a))%2==1&&(a+=1),u=o.hVt(n,t,e,r),s=o.tVt(n,e,r),c=o.eVt(e),f=o.iVt(e),c=c<(c=0)&&f<0?at(o.Zzt(r),s):0<=u?s-u:s,f=o.mVt(n,t,e,r),s=new C(i,c,a,ut(f)),0!==u&&(t=o.Zzt(r),s.Y<t&&s.Bottom<t+1?s.Height=O(s.Height+1):(e=n.Height-o.Zzt(r),s.Bottom>e&&s.Y>e-1&&(s.Y=e-f,s.Height=f))),s},t.prototype.Wzt=function(t){var t=this.setting.options.lineWeight*t;return t=t<1?1:t},t.prototype.Jzt=function(t,n,e,i,r){var o,a,i,r,t,u,e,o=this,a=o.Wzt(r);return++a<2&&(a=2),i=o.gVt(t,n,e,i,r),0===o.options.sparklineType&&(i.X=i.X+(i.Width-a)/2,typeof(r=o.Sl(t,e))!==B&&r!==rt?(0<=r?i.Y-=a/2:i.Y=i.Bottom-a/2,i.Width=a,i.Height=a):(i.Width=0,i.Height=0)),o.setting.options.rightToLeft&&(t=i.X,e=(u=n.Width-t)-i.Width,i=new C(e,i.Y,i.Width,i.Height)),i},l.SparklineRender=t,l.SparklineExRenders={PIESPARKLINE:Qt,AREASPARKLINE:qt,SCATTERSPARKLINE:tn,BULLETSPARKLINE:an,SPREADSPARKLINE:un,STACKEDSPARKLINE:ln,HBARSPARKLINE:gn,VBARSPARKLINE:pn,VARISPARKLINE:bn,BOXPLOTSPARKLINE:yn,CASCADESPARKLINE:Sn,PARETOSPARKLINE:Tn,MONTHSPARKLINE:_n,YEARSPARKLINE:jn,GAUGEKPISPARKLINE:Yn,HISTOGRAMSPARKLINE:Xn,IMAGESPARKLINE:$n}}},i={},o.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(t){if("object"==typeof window)return window}}(),n=t={},Object.defineProperty(n,"__esModule",{value:!0}),n.Slicers=n.Sparklines=n.Formatter=n.Commands=n.Common=void 0,r=o("./src/common/common.entry.ts"),n.Common=r,r=o("./src/plugins/commands/commands.entry.ts"),n.Commands=r,r=o("./src/plugins/formatter/formatter.entry.ts"),n.Formatter=r,r=o("./src/plugins/sparkline/sparkline.entry.ts"),n.Sparklines=r,r=o("./src/plugins/slicer/slicer.entry.ts"),n.Slicers=r,(a={}).Spread=t}(),t.exports=a.Spread},"./node_modules_local/@grapecity/js-sheets-common/index.js":function(t,n,e){t.exports=e("./node_modules_local/@grapecity/js-sheets-common/dist/gc.spread.common.js")},DataManager:function(t){"use strict";t.exports=GC.Data},Common:function(t){"use strict";t.exports=GC.Spread},CalcEngine:function(t){"use strict";t.exports=GC.Spread.CalcEngine},Core:function(t){"use strict";t.exports=GC.Spread.Sheets},Bindings:function(t){"use strict";t.exports=GC.Spread.Sheets.Bindings},SheetsCalc:function(t){"use strict";t.exports=GC.Spread.Sheets.CalcEngine},CellTypes:function(t){"use strict";t.exports=GC.Spread.Sheets.CellTypes},ConditionalFormatting:function(t){"use strict";t.exports=GC.Spread.Sheets.ConditionalFormatting},ContextMenu:function(t){"use strict";t.exports=GC.Spread.Sheets.ContextMenu},Filters:function(t){"use strict";t.exports=GC.Spread.Sheets.Filter},Sparkline:function(t){"use strict";t.exports=GC.Spread.Sheets.Sparklines},Touch:function(t){"use strict";t.exports=GC.Spread.Sheets.Touch}},i={},t=r("./all.entry.js"),(GC=void 0===GC?{}:GC).Spread=t}(),function(t){"object"==typeof module&&"object"==typeof module.exports?module.exports=t:"function"==typeof define&&define.amd?define("@grapecity/spread-sheets",[],function(){return t}):"object"==typeof exports&&(exports.Spread=t.Spread)}(GC||{});